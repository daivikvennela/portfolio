/*! For license information please see 88.7617075a.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{18815:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(18816),i=n(15402),o=n(13085),a=n(12999),s=n(18818),u=n(18819),c=n(12345),l=n(18820),p=n(17777),g=n(18821),v=n(18825),d=n(12246);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var O=function(){function e(t,n,f,m){var h=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.environmentStore=t,this.aiHostedModelsHttpClient=n,this.loggingService=f,this.copilotAssistantHttpClient=m,this.learnFormulaFromExamplesAsync=e=>{var t=this.environmentStore.currentEnvironmentName,n=this.aiHostedModelsHttpClient.learnFormulaFromExamplesAsync({environmentName:t,request:e}).then(e=>e.data);return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.learnFormulaFromExamplesStart,eventEndName:o.a.learnFormulaFromExamplesEnd,promise:n})},this.naturalLanguageToFlowAsync=e=>{var t,n=this.environmentStore.currentEnvironmentName;e.crossGeoCallEnabled=null===(t=c.a.currentEnvironment)||void 0===t?void 0:t.crossGeoCopilotDataMovementEnabled;var r=this.aiHostedModelsHttpClient.naturalLanguageToFlowAsync({environmentName:n,request:e}).then(y);return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.naturalLanguageToFlowStart,eventEndName:o.a.naturalLanguageToFlowEnd,promise:r,getStatus:l.b})},this.multiTurnNaturalLanguageToFlowAsync=(e,t)=>{var n=this.environmentStore.currentEnvironmentName,r=this.aiHostedModelsHttpClient.multiTurnNaturalLanguageToFlowAsync({environmentName:n,request:e,ct:t}).then(y);return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.multiTurnNaturalLanguageToFlowStart,eventEndName:o.a.multiTurnNaturalLanguageToFlowEnd,promise:r,getStatus:l.b})},this.getOutputSuggestionsAsync=e=>{var t=this.environmentStore.currentEnvironmentName,n=this.aiHostedModelsHttpClient.getOutputSuggestionsAsync({environmentName:t,request:e}).then(e=>e.data.outputSuggestions.map(e=>e.text));return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.proseGetOutputSuggestionsStart,eventEndName:o.a.proseGetOutputSuggestionsEnd,promise:n,getStatus:l.b})},this.getChatResponseAsync=(e,t)=>{var n;e.supportCheckerOverrides=Object(s.a)(),e.supportedHybridTriggers=Object(u.a)(),e.crossGeoCallEnabled=null===(n=c.a.currentEnvironment)||void 0===n?void 0:n.crossGeoCopilotDataMovementEnabled;var r,a=this.environmentStore.currentEnvironmentName,v=Object(p.a)();if(v){var d=null!=e&&e.connectionReference?Object(g.f)(null==e?void 0:e.connectionReference):void 0,f=this.getCopilotAssistantRequest(e.chatEntries&&e.chatEntries.length>0?e.chatEntries[e.chatEntries.length-1].message:"",e.chatEntries,!!e.isQAndAOnly,e.featureSource,e.clientSource,null==e?void 0:e.chatHistory,null==e?void 0:e.definition,d,Object(l.a)(e));r=this.getChatAssistantPromise(f,a,t,null==e?void 0:e.connectionReference)}else r=this.aiHostedModelsHttpClient.getChatResponseAsync({environmentName:a,request:e,ct:t}).then(y);return Object(i.b)({loggingService:this.loggingService,eventStartName:v?o.a.getCopilotAssistantResponseStart:o.a.getChatResponseStart,eventEndName:v?o.a.getCopilotAssistantResponseEnd:o.a.getChatResponseEnd,promise:r,getStatus:l.b,eventData:this.getTelemetryEventData(e)})},this.getAuthoringAgentStreamAsync=(e,t)=>{var n=null!=e&&e.connectionReference?Object(g.f)(null==e?void 0:e.connectionReference):void 0,r=this.getCopilotAssistantRequest(e.chatEntries&&e.chatEntries.length>0?e.chatEntries[e.chatEntries.length-1].message:"",e.chatEntries,!!e.isQAndAOnly,e.featureSource,e.clientSource,null==e?void 0:e.chatHistory,null==e?void 0:e.definition,n,Object(l.a)(e),null==e?void 0:e.resolvedConnectionReferences);return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.getAuthoringAgentStreamStart,eventEndName:o.a.getAuthoringAgentStreamEnd,promise:this.copilotAssistantHttpClient.getAuthoringAgentStreamAsync(r,this.environmentStore.currentEnvironmentName,t),getStatus:l.b})},this.getFlowRunDebuggingSuggestionsResponseAsync=(e,t)=>{var n,r=this.environmentStore.currentEnvironmentName;e.crossGeoCallEnabled=null===(n=c.a.currentEnvironment)||void 0===n?void 0:n.crossGeoCopilotDataMovementEnabled;var a={},s=this.getCopilotAssistantRequest("",e.chatEntries,!!e.isQAndAOnly,e.featureSource,e.clientSource,e.chatHistory,null==e?void 0:e.definition,a,Object(l.a)(e)),u=this.getChatAssistantPromise(s,r,t,a);return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.getFlowRunDebuggingSuggestionsResponseStart,eventEndName:o.a.getFlowRunDebuggingSuggestionsResponseEnd,promise:u,getStatus:l.b,eventData:this.getTelemetryEventData(e)})},this.evaluateLogicAppsExpressionAsync=e=>{var t=this.environmentStore.currentEnvironmentName,n=this.aiHostedModelsHttpClient.evaluateLogicAppsExpressionAsync({environmentName:t,request:e}).then(e=>e.data);return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.evaluateLogicAppsExpressionStart,eventEndName:o.a.evaluateLogicAppsExpressionEnd,promise:n})},this.getAutocompleteAsync=e=>{var t=this.environmentStore.currentEnvironmentName,n=this.aiHostedModelsHttpClient.getAutocompleteAsync({environmentName:t,request:e}).then(y);return Object(i.b)({loggingService:this.loggingService,eventStartName:o.a.getAutocompleteResponseStart,eventEndName:o.a.getAutocompleteResponseEnd,promise:n})},this.getNaturalLanguageToFlowExpressionAsync=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.d.PowerAutomate,a=arguments.length>2?arguments[2]:void 0,s=h.environmentStore.currentEnvironmentName,u=Object(v.a)();if(u){var c=h.getCopilotAssistantRequest("",[],!1,r.f.expressionAssistant,n,[],void 0,void 0,void 0,void 0,e);t=h.copilotAssistantHttpClient.getCopilotAssistantResponseAsync(c,s,a).then(e=>Object(g.h)(e)).then(y)}else t=h.aiHostedModelsHttpClient.getNaturalLanguageToFlowExpressionAsync({environmentName:s,request:e}).then(e=>({suggestions:e.data.map(e=>({suggestedExpression:e.expression,explanation:e.explanation}))}));return Object(i.b)({loggingService:h.loggingService,eventStartName:o.a.getNaturalLanguageToFlowExpressionResponseStart,eventEndName:o.a.getNaturalLanguageToFlowExpressionResponseEnd,promise:t})},this.getCopilotAssistantRequest=(e,t,n,r,i,o,s,u,c,l,p)=>{var v=null!=o?o:t?null==t?void 0:t.map(e=>Object(g.e)(e)):[],f=Object(d.d)();return{chatContext:{workflowDefinition:s,connectionReferences:u,flowError:c,resolvedConnectionReferences:l,expressionContext:p},chatMessage:e,chatHistory:v,isDebugCopilotEnabled:Object(a.a)().isDebugCopilotEnabled,isQAndAOnly:n,featureSource:r,clientSource:i,userLocale:f}},this.getTelemetryEventData=e=>{var{featureSource:t,clientSource:n}=e;return{featureSource:t,clientSource:n,isCopilotAssistantEnabled:Object(p.a)(),isCopilotTroubleshootingV2Enabled:Object(p.a)(),isDebugCopilotEnabled:Object(a.a)().isDebugCopilotEnabled}}}var t,n,f;return t=e,(n=[{key:"getChatAssistantPromise",value:function(e,t,n,r){return this.copilotAssistantHttpClient.getCopilotAssistantResponseAsync(e,t,n).then(e=>Object(g.g)(e,r)).then(y)}}])&&S(t.prototype,n),f&&S(t,f),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e){var t=Object(g.a)(e.headers);return m(m({},e.data),{},{correlationId:t})}},18816:function(e,t,n){"use strict";var r=n(18817);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),n.d(t,"e",(function(){return r.e})),n.d(t,"f",(function(){return r.f})),n.d(t,"g",(function(){return r.g})),n.d(t,"h",(function(){return r.h})),n.d(t,"i",(function(){return r.i}))},18817:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"e",(function(){return v}));var r=n(12324),i=n(12327),o=e=>Object(i.h)(e,{code:i.k,message:i.k}),a=e=>Object(i.h)(e,{errors:r.isArray}),s=function(e){return e.thumbsUp="thumbsUp",e.thumbsDown="thumbsDown",e}({}),u=function(e){return e.user="user",e.assistant="assistant",e}({}),c=function(e){return e.raw="raw",e.markdown="markdown",e}({}),l=function(e){return e.troubleShooting="troubleShooting",e.expressionAssistant="expressionAssistant",e.chat="chat",e.nl2Flow="nl2Flow",e.descriptionGeneration="descriptionGeneration",e.streamingChat="streamingChat",e}({}),p=function(e){return e.PowerAutomate="PowerAutomate",e.MCS="MCS",e}({}),g=function(e){return e.authoring="authoring",e.runtime="runtime",e}({}),v=function(e){return e.flowEdition="FlowEdition",e.flowCreation="FlowCreation",e.chatGpt="ChatGpt",e.documentation="Documentation",e.greeting="Greeting",e.suggestAction="SuggestAction",e.debugMef="DebugMef",e.debugClassification="DebugClassification",e}({})},18818:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(11808);function i(){var e;return null===(e=Object(r.a)().designerV3SupportCheckOverrides.getConfig().supportCheckOverrides)||void 0===e?void 0:e.slice()}},18819:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(11809),i=n(11896),o=Object(i.a)({teamName:r.a.PowerAutomateClientTeam,owners:["studio-designer-dev"],createdOn:"08/31/2023",description:"Provides list of supported hybrid triggers",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1127226",fallback:{supportedHybridTriggers:[]}}),{getFeatureValue:a}=Object(i.b)(o,"supportedHybridTriggers")},18820:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(13009),i=n(13192);function o(e){var t;if(429===(null==e||null===(t=e.response)||void 0===t?void 0:t.status))return r.e.Success;if(Object(i.isHttp4xxError)(e))return r.e.Warning;var n,o=null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n||null===(n=n.error)||void 0===n||null===(n=n.message)||void 0===n?void 0:n.toString();return o&&(o.includes("MEFParsingErrorException")||o.includes("MEFTooManyTokensException"))?r.e.Success:r.e.Failure}function a(e){if(![e.brokenOperationName,e.documentationURL,e.error,e.errorDescription,e.errorSubject,e.remediation].every(e=>void 0===e))return{brokenOperationName:e.brokenOperationName,documentationURL:e.documentationURL,error:e.error,errorDescription:e.errorDescription,errorSubject:e.errorSubject,remediation:e.remediation,troubleshootingType:e.troubleshootingType}}},18821:function(e,t,n){"use strict";n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return O})),n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return E})),n.d(t,"h",(function(){return j})),n.d(t,"a",(function(){return A})),n.d(t,"c",(function(){return R}));var r=n(18189),i=n.n(r),o=n(18816),a=n(18822),s=n(18824),u=n(13215),c=n(17777),l=n(14888);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){d(o,r,i,a,s,"next",e)}function s(e){d(o,r,i,a,s,"throw",e)}a(void 0)}))}}var m=new i.a;function h(e,t){return{data:S(e.data,t),status:e.status,statusText:e.statusText,headers:e.headers,ok:e.ok,url:e.url}}function S(e,t){var n,r,i,a,s,u,c={author:o.a.assistant,message:null==e?void 0:e.chatResult,format:(r=null!==(n=null==e?void 0:e.chatResult)&&void 0!==n?n:"",i=m.render(r).trim(),a=r.trim(),s=i==="<p>".concat(a,"</p>\n")||i==="<p>".concat(a,"</p>"),u=!s&&i!==a,u?o.b.markdown:o.b.raw)},l=null!=e&&e.workflowDefinition?{definition:e.workflowDefinition,connectionReferences:e.connectionReferences||t||{},diffResult:e.diffResult}:void 0;return{answer:c,category:null==e?void 0:e.category,flows:l?[l]:[],chatHistory:null==e?void 0:e.chatHistory,planStep:null==e?void 0:e.flowSuggestion}}function b(e){return{Role:{Label:e.author},Content:e.message}}function O(e){return Object.fromEntries(Object.entries(e).map(e=>{var t,n,r,i,o,[a,s]=e;return[a,{api:{name:null!==(t=null===(n=s.apiDefinition)||void 0===n?void 0:n.name)&&void 0!==t?t:Object(l.b)(null!==(r=s.id)&&void 0!==r?r:"")},connection:{connectionReferenceLogicalName:null!==(i=s.connectionReferenceLogicalName)&&void 0!==i?i:""},runtimeSource:null!==(o=s.source)&&void 0!==o?o:""}]}))}function y(e,t){if(e)return Object.fromEntries(Object.entries(e).map(e=>{var n,r,i,o,a,[u,c]=e;return[u,Object(s.a)(null!==(n=null!==(r=null!==(i=t.getConnectionIdFromDesignerConnectionId(null!==(o=null!==(a=c.connectionName)&&void 0!==a?a:c.connectionReferenceLogicalName)&&void 0!==o?o:""))&&void 0!==i?i:c.connectionName)&&void 0!==r?r:c.connectionReferenceLogicalName)&&void 0!==n?n:"")]}))}function E(e){return w.apply(this,arguments)}function w(){return(w=f((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:TextDecoder,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=e.reader,s=new t,u="",c={};try{var l;do{var p,{done:v,value:d}=yield o.read();if(l=v,d){var f=(u+=s.decode(d,{stream:!0})).split("\n");for(var m of(u=null!==(p=f.pop())&&void 0!==p?p:"",f))if(m.startsWith("data: "))try{var h,b,O=m.substring("data: ".length),y=JSON.parse(O);if(y.isThinking)n(y);else l=!0,c=g(g({},S({workflowDefinition:y.workflowDefinition,chatHistory:null!==(h=y.chatHistory)&&void 0!==h?h:[],chatResult:y.text,category:null!==(b=y.category)&&void 0!==b?b:a.a.Unknown,diffResult:y.diffResult,flowSuggestion:y.stepPlan,connectionReferences:y.connectionReferences},r)),{},{correlationId:e.correlationId})}catch(E){throw i.logWarning("copilotAssistant.helpers.processStream","Error processing data",{error:E}),E}}}while(!l)}catch(E){throw i.logWarning("copilotAssistant.helpers.processStream","Error reading stream",{error:E}),E}finally{o.releaseLock()}return c}))).apply(this,arguments)}function j(e){var{data:t,status:n,statusText:r,headers:i,ok:o,url:a}=e;return{data:{suggestions:null!=t&&t.expressionResult?[t.expressionResult]:[]},status:n,statusText:r,headers:i,ok:o,url:a}}function A(e){var t,n,r,i,o,a;return e instanceof Headers?null!==(t=null==e||null===(n=e.get(u.a.correlationId))||void 0===n?void 0:n.toString())&&void 0!==t?t:null==e||null===(r=e.get(u.a.fallbackCorrelationId))||void 0===r?void 0:r.toString():null!==(i=null==e||null===(o=e[u.a.correlationId])||void 0===o?void 0:o.toString())&&void 0!==i?i:null==e||null===(a=e[u.a.fallbackCorrelationId])||void 0===a?void 0:a.toString()}function R(e){return!(e&&!Object(c.a)())}},18822:function(e,t,n){"use strict";var r=n(18823);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),n.d(t,"e",(function(){return r.e})),n.d(t,"f",(function(){return r.f})),n.d(t,"g",(function(){return r.g})),n.d(t,"h",(function(){return r.h})),n.d(t,"i",(function(){return r.i})),n.d(t,"j",(function(){return r.j})),n.d(t,"k",(function(){return r.k})),n.d(t,"l",(function(){return r.l})),n.d(t,"m",(function(){return r.m}))},18823:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return O})),n.d(t,"j",(function(){return y}));var r=n(12327),i=n(18817);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){return e.Query="query",e.Reply="reply",e.ReplyWithFlow="replyWithFlow",e.ReplyError="replyError",e.ConnectionsSetup="connectionsSetup",e.Greeting="greeting",e.OperationsNeedingAttention="operationsNeedingAttention",e.ReplyWithDebuggingSuggestions="replyWithDebuggingSuggestions",e.ReplyWithNL2FlowResponse="replyWithNL2FlowResponse",e.ExplainError="explainError",e.ReplyWithNL2FlowParametersSuggestionMessage="replyWithNL2FlowParametersSuggestionMessage",e.DeepReasoningMessage="deepReasoningMessage",e}({}),c=function(e){return e.Unknown="Unknown",e.FlowCreation="FlowCreation",e.FlowEdition="FlowEdition",e.DocumentationQuestion="DocumentationQuestion",e.FlowQuestion="FlowQuestion",e.Greeting="Greeting",e.NL2Flow="NL2Flow",e.SuggestAction="SuggestAction",e.ExpressionGeneration="ExpressionGeneration",e.Other="Other",e}({}),l=e=>Object(r.k)(e)&&Object.values(c).includes(e),p=function(e){return e[e.Unavailable=0]="Unavailable",e[e.UndoAvailable=1]="UndoAvailable",e[e.Undone=2]="Undone",e}({}),g=function(e){return e[e.editing=1]="editing",e[e.saving=2]="saving",e}({});function v(e){return{author:m(e)?i.a.user:i.a.assistant,message:e.text,reaction:m(e)?void 0:e.reaction,format:h(e)&&e.isMarkdownText?i.b.markdown:i.b.raw,intent:m(e)?void 0:e.intent,summary:m(e)?void 0:e.summary,flow:m(e)?void 0:e.flow}}function d(e){var t,n,r,i,o=a(a({},e.state),{},{trigger:null!==(t=e.state.trigger)&&void 0!==t?t:null,actions:null!==(n=e.state.actions)&&void 0!==n?n:null,applicable:null!==(r=e.state.applicable)&&void 0!==r?r:null});return{query:e.query,response:e.intentDiscoveryResponse,state:o,summary:null!==(i=e.summary)&&void 0!==i?i:null}}function f(e){return Object(r.h)(e,{date:e=>e instanceof Date,id:r.k,type:r.k})}function m(e){return f(e)&&e.type===u.Query}function h(e){return f(e)&&e.type===u.Reply}function S(e){return f(e)&&e.type===u.ReplyWithFlow}function b(e){return f(e)&&e.type===u.ReplyWithNL2FlowResponse}function O(e){return f(e)&&e.type===u.ExplainError}function y(e){return f(e)&&(e.type===u.Reply||e.type===u.ReplyWithFlow||e.type===u.ReplyWithDebuggingSuggestions||e.type===u.ReplyError||e.type===u.ConnectionsSetup||e.type===u.ExplainError)}},18824:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=e=>e.split("/connections/").pop()||""},18825:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11808),i=n(17777),o=()=>Object(i.a)()&&!!Object(r.a)().isCopilotExpressionAssistantV2Enabled.getConfig().isCopilotExpressionAssistantV2Enabled},18827:function(e,t,n){"use strict";n.d(t,"AiHostedModelsHttpClient",(function(){return v}));var r=n(13215),i=n(12381),o=n(13151),a=n(14829),s=(n(18828),n(18830),n(18832),n(12250)),u=n(13078),c=n(15489);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=p((function e(t,n,l,p,g,v){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.httpClient=n,this.ppapiService=l,this.loggingService=p,this.tokenService=g,this.sessionStore=v,this.storageService=void 0,this.learnFormulaFromExamplesAsync=e=>{var{environmentName:t,request:n}=e,r=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/formulaFromExamples/logicApps");return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FORMULAFROMEXAMPLES/LOGICAPPS",url:r,data:n,responseType:"json"})},this.getChatResponseAsync=e=>{var{environmentName:t,request:n,ct:r}=e,a=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/chat");return n.locale=this.storageService.getItem(c.a.resolvedAppLocaleKey)||s.a.language||"en",this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/CHAT",url:a,data:n,responseType:"json",cancelToken:r})},this.getOutputSuggestionsAsync=e=>{var{environmentName:t,request:n}=e,r=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/formulaFromExamples/outputSuggestions");return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FORMULAFROMEXAMPLES/OUTPUTSSUGGESTIONS",url:r,data:n,responseType:"json"})},this.naturalLanguageToFlowAsync=e=>{var{environmentName:t,request:n}=e,r=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/naturalLanguageToFlow");return n.locale=this.storageService.getItem(c.a.resolvedAppLocaleKey)||s.a.language||"en",this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/NATURALLANGUAGETOFLOW",url:r,data:n,responseType:"json"})},this.multiTurnNaturalLanguageToFlowAsync=e=>{var{environmentName:t,request:n,ct:r}=e;n.locale=this.storageService.getItem(c.a.resolvedAppLocaleKey)||s.a.language||"en";var a=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/naturalLanguageToFlow/multiTurnGrounding");return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/NATURALLANGUAGETOFLOW/MULTITURNGROUNDING",url:a,data:n,responseType:"json",cancelToken:r})},this.getAutocompleteAsync=e=>{var{environmentName:t,request:n}=e,r=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/naturalLanguageToFlow/autocomplete");return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/NATURALLANGUAGETOFLOW/AUTOCOMPLETE",url:r,data:n,responseType:"json"})},this.evaluateLogicAppsExpressionAsync=e=>{var{environmentName:t,request:n}=e,r=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/evaluateLogicAppsExpression");return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/EVALUATELOGICAPPSEXPRESSION",url:r,data:n,responseType:"json"})},this.getNaturalLanguageToFlowExpressionAsync=e=>{var{environmentName:t,request:n}=e,r=Object(i.a)(Object(o.a)({appSettings:this.appSettings,environmentName:t}),"/copilot/expression");return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/COPILOT/EXPRESSION",url:r,data:n,responseType:"json"})},this.storageService=new u.a,[Object(r.f)(p,()=>this.sessionStore.sessionId),Object(a.b)(this.ppapiService,this.appSettings),Object(r.c)(()=>this.tokenService.getAccessToken(this.appSettings.flowAudience))].forEach(e=>this.httpClient.addRequestInterceptor(e)),this.httpClient.addResponseInterceptor(Object(r.g)(this.loggingService,this.sessionStore),Object(r.e)(this.loggingService,this.sessionStore))}))},18828:function(e,t,n){"use strict";n(18829)},18829:function(e,t){},18830:function(e,t,n){"use strict";n(18831)},18831:function(e,t){},18832:function(e,t,n){"use strict";n(18833)},18833:function(e,t){},18835:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(13215),i=n(11795),o=n(13227),a=n(14692),s=n(17295),u=n(17296),c=n(18821);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function f(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=f((function e(t,n,l,g,d){var f=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.httpClient=n,this.sessionStore=l,this.environmentStore=g,this.tokenService=d,this.ppapiDiscovery=void 0,this.getCopilotAssistantResponseAsync=(e,t,n)=>{if(!t){return this.loggingService.logError("CopilotAssistantHttpClient.getCopilotAssistantResponseAsync",new Error("Environment name is undefined")),Promise.reject(new Error("Environment name is undefined"))}var r=this.ppapiDiscovery.getEnvironmentEndpoint(this.environmentStore.currentEnvironmentName),i=Object(s.a)("cloudflowassistantchat",r);return this.httpClient.post({url:i,headers:u.a,eventName:"PPAPI:POST/COPILOTFLOWS/CLOUDFLOWASSISTANTCHAT",data:JSON.stringify(e),cancelToken:n})},this.getAuthoringAgentStreamAsync=function(){var e,t=(e=function*(e,t,n,r){if(!t)return f.loggingService.logError("CopilotAssistantHttpClient.getCopilotAssistantResponseAsync",new Error("Environment name is undefined")),Promise.reject(new Error("Environment name is undefined"));var i=f.ppapiDiscovery.getEnvironmentEndpoint(f.environmentStore.currentEnvironmentName),o=Object(s.a)("cloudflowauthoringagent/stream",i,r),a=new AbortController,l=a.signal;null==n||n.promise.then(()=>a.abort());var g=yield fetch(o,{method:"POST",headers:p(p({},u.a),{},{Authorization:"Bearer ".concat(yield f.tokenService.getAccessToken(f.ppapiDiscovery.getTokenAudience()))}),body:JSON.stringify(e),signal:l});if(!f.isReadableStream(null==g?void 0:g.body))throw new Error("ReadableStream not supported or empty response.");var v=Object(c.a)(g.headers);return{reader:g.body.getReader(),correlationId:v}},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){v(o,r,i,a,s,"next",e)}function s(e){v(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e,n,r,i){return t.apply(this,arguments)}}(),this.isReadableStream=e=>!!e&&"function"==typeof e.getReader;var m,{region:h}=Object(i.h)(),S=Object(o.a)(h,this.environmentStore.currentEnvironment);this.ppapiDiscovery=new a.a(S);try{m=this.ppapiDiscovery.getTokenAudience()}catch(b){this.loggingService.logError("CopilotAssistantHttpClient.constructor",b,{region:h})}[Object(r.f)(t,()=>this.sessionStore.sessionId),Object(r.c)(()=>this.tokenService.getAccessToken(m))].forEach(e=>this.httpClient.addRequestInterceptor(e)),this.httpClient.addResponseInterceptor(Object(r.g)(this.loggingService,this.sessionStore),Object(r.e)(this.loggingService,this.sessionStore))}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/88.7617075a.chunk.js.map