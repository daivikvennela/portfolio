(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{19386:function(n,e,t){"use strict";t.d(e,"a",(function(){return m})),t.d(e,"b",(function(){return v})),t.d(e,"c",(function(){return x})),t.d(e,"d",(function(){return h})),t.d(e,"e",(function(){return w})),t.d(e,"f",(function(){return le})),t.d(e,"g",(function(){return f})),t.d(e,"h",(function(){return ne})),t.d(e,"i",(function(){return ie})),t.d(e,"j",(function(){return ae})),t.d(e,"k",(function(){return fe})),t.d(e,"l",(function(){return Ee})),t.d(e,"m",(function(){return pe})),t.d(e,"n",(function(){return ge})),t.d(e,"o",(function(){return Sn})),t.d(e,"p",(function(){return Zn})),t.d(e,"q",(function(){return M})),t.d(e,"r",(function(){return B})),t.d(e,"s",(function(){return V})),t.d(e,"t",(function(){return Ln})),t.d(e,"u",(function(){return Q})),t.d(e,"v",(function(){return y})),t.d(e,"w",(function(){return p})),t.d(e,"x",(function(){return un})),t.d(e,"y",(function(){return A})),t.d(e,"z",(function(){return yn})),t.d(e,"A",(function(){return wn})),t.d(e,"B",(function(){return q})),t.d(e,"C",(function(){return C})),t.d(e,"D",(function(){return S})),t.d(e,"E",(function(){return sn})),t.d(e,"F",(function(){return Cn})),t.d(e,"G",(function(){return L})),t.d(e,"H",(function(){return Pn})),t.d(e,"I",(function(){return pn})),t.d(e,"J",(function(){return k})),t.d(e,"K",(function(){return cn})),t.d(e,"L",(function(){return T})),t.d(e,"M",(function(){return Bn})),t.d(e,"N",(function(){return an})),t.d(e,"O",(function(){return Yn})),t.d(e,"P",(function(){return H})),t.d(e,"Q",(function(){return K})),t.d(e,"R",(function(){return Tn})),t.d(e,"S",(function(){return In})),t.d(e,"T",(function(){return tn})),t.d(e,"U",(function(){return E})),t.d(e,"V",(function(){return _n})),t.d(e,"W",(function(){return g})),t.d(e,"X",(function(){return b})),t.d(e,"Y",(function(){return I})),t.d(e,"Z",(function(){return Mn})),t.d(e,"ab",(function(){return hn})),t.d(e,"bb",(function(){return on})),t.d(e,"cb",(function(){return fn})),t.d(e,"db",(function(){return z})),t.d(e,"eb",(function(){return J})),t.d(e,"fb",(function(){return U})),t.d(e,"gb",(function(){return ln})),t.d(e,"hb",(function(){return W})),t.d(e,"ib",(function(){return Fn})),t.d(e,"jb",(function(){return nn})),t.d(e,"kb",(function(){return en})),t.d(e,"lb",(function(){return Un})),t.d(e,"mb",(function(){return $})),t.d(e,"nb",(function(){return Rn})),t.d(e,"ob",(function(){return Kn})),t.d(e,"pb",(function(){return Wn}));var o=t(19488),r=t(19483),i=t(19484),a=t(19387);function l(n,e,t,o,r,i,a){try{var l=n[i](a),u=l.value}catch(d){return void t(d)}l.done?e(u):Promise.resolve(u).then(o,r)}function u(n){return function(){var e=this,t=arguments;return new Promise((function(o,r){var i=n.apply(e,t);function a(n){l(i,o,r,a,u,"next",n)}function u(n){l(i,o,r,a,u,"throw",n)}a(void 0)}))}}function d(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function s(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?d(Object(t),!0).forEach((function(e){c(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function c(n,e,t){var o;return(e="symbol"==typeof(o=function(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(e,"string"))?o:String(o))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var v,h,f,p={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:n=>'Node type "'.concat(n,'" not found. Using fallback type "default".'),error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:n=>"The old edge with id=".concat(n," does not exist."),error009:n=>'Marker type "'.concat(n,"\" doesn't exist."),error008:(n,e)=>{var{id:t,sourceHandle:o,targetHandle:r}=e;return"Couldn't create edge for ".concat(n,' handle id: "').concat(o?r:o,'", edge id: ').concat(t,".")},error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:n=>'Edge type "'.concat(n,'" not found. Using fallback type "default".'),error012:n=>'Node with id "'.concat(n,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.'),error013:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"react";return"It seems that you haven't loaded the styles. Please import '@xyflow/".concat(n,"/dist/style.css' or base.css to make sure everything is working properly.")}},g=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],y=["Enter"," ","Escape"];!function(n){n.Strict="strict",n.Loose="loose"}(v||(v={})),function(n){n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal"}(h||(h={})),function(n){n.Partial="partial",n.Full="full"}(f||(f={}));var m,x,w,b={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};!function(n){n.Bezier="default",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n.SimpleBezier="simplebezier"}(m||(m={})),function(n){n.Arrow="arrow",n.ArrowClosed="arrowclosed"}(x||(x={})),function(n){n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom"}(w||(w={}));var P={[w.Left]:w.Right,[w.Right]:w.Left,[w.Top]:w.Bottom,[w.Bottom]:w.Top};function M(n,e){if(!n&&!e)return!0;if(!n||!e||n.size!==e.size)return!1;if(!n.size&&!e.size)return!0;for(var t of n.keys())if(!e.has(t))return!1;return!0}function E(n,e,t){if(t){var o=[];n.forEach((n,t)=>{null!=e&&e.has(t)||o.push(n)}),o.length&&t(o)}}function S(n){return null===n?null:n?"valid":"invalid"}var I=n=>"id"in n&&"source"in n&&"target"in n,z=n=>"id"in n&&"position"in n&&!("source"in n)&&!("target"in n),O=n=>"id"in n&&"internals"in n&&!("source"in n)&&!("target"in n),N=function(n){var e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{width:o,height:r}=an(n),i=null!==(e=n.origin)&&void 0!==e?e:t,a=o*i[0],l=r*i[1];return{x:n.position.x-a,y:n.position.y-l}},T=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===n.size)return{x:0,y:0,width:0,height:0};var t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return n.forEach(n=>{if(void 0===e.filter||e.filter(n)){var o=F(n);t=j(t,o)}}),_(t)},H=function(n,e){var[t,o,r]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=s(s({},nn(e,[t,o,r])),{},{width:e.width/r,height:e.height/r}),u=[];for(var[,d]of n){var c,v,h,f,p,g,{measured:y,selectable:m=!0,hidden:x=!1}=d,w=null!==(c=null!==(v=null!==(h=y.width)&&void 0!==h?h:d.width)&&void 0!==v?v:d.initialWidth)&&void 0!==c?c:null,b=null!==(f=null!==(p=null!==(g=y.height)&&void 0!==g?g:d.height)&&void 0!==p?p:d.initialHeight)&&void 0!==f?f:null;if(!(a&&!m||x)){var P=K(l,W(d)),M=null===w||null===b,E=i&&P>0,S=(null!=w?w:0)*(null!=b?b:0),I=M||E||P>=S;(I||d.dragging)&&u.push(d)}}return u},C=(n,e)=>{var t=new Set;return n.forEach(n=>{t.add(n.id)}),e.filter(n=>t.has(n.source)||t.has(n.target))};function k(n,e){var t=new Map,o=null!=e&&e.nodes?new Set(e.nodes.map(n=>n.id)):null;return n.forEach(n=>{!(n.measured.width&&n.measured.height&&((null==e?void 0:e.includeHiddenNodes)||!n.hidden))||o&&!o.has(n.id)||t.set(n.id,n)}),t}function A(n,e){return D.apply(this,arguments)}function D(){return(D=u((function*(n,e){var t,o,r,{nodes:i,width:a,height:l,panZoom:u,minZoom:d,maxZoom:s}=n;if(0===i.size)return Promise.resolve(!1);var c=T(i),v=tn(c,a,l,null!==(t=null==e?void 0:e.minZoom)&&void 0!==t?t:d,null!==(o=null==e?void 0:e.maxZoom)&&void 0!==o?o:s,null!==(r=null==e?void 0:e.padding)&&void 0!==r?r:.1);return yield u.setViewport(v,{duration:null==e?void 0:e.duration}),Promise.resolve(!0)}))).apply(this,arguments)}function B(n){var e,{nodeId:t,nextPosition:o,nodeLookup:r,nodeOrigin:i=[0,0],nodeExtent:a,onError:l}=n,u=r.get(t),d=u.parentId?r.get(u.parentId):void 0,{x:s,y:c}=d?d.internals.positionAbsolute:{x:0,y:0},v=null!==(e=u.origin)&&void 0!==e?e:i,h=function(n,e){var t,o,r,i;return e&&"parent"!==e?[e[0],[e[1][0]-(null!==(t=null===(o=n.measured)||void 0===o?void 0:o.width)&&void 0!==t?t:0),e[1][1]-(null!==(r=null===(i=n.measured)||void 0===i?void 0:i.height)&&void 0!==r?r:0)]]:e}(u,u.extent||a);if("parent"!==u.extent||u.expandParent)d&&rn(u.extent)&&(h=[[u.extent[0][0]+s,u.extent[0][1]+c],[u.extent[1][0]+s,u.extent[1][1]+c]]);else if(d){var f=u.measured.width,g=u.measured.height,y=d.measured.width,m=d.measured.height;f&&g&&y&&m&&(h=[[s,c],[s+y-f,c+m-g]])}else null==l||l("005",p.error005());var x=rn(h)?V(o,h):o;return{position:{x:x.x-s+u.measured.width*v[0],y:x.y-c+u.measured.height*v[1]},positionAbsolute:x}}function L(n){return Y.apply(this,arguments)}function Y(){return(Y=u((function*(n){var{nodesToRemove:e=[],edgesToRemove:t=[],nodes:o,edges:r,onBeforeDelete:i}=n,a=new Set(e.map(n=>n.id)),l=[],u=function*(n){if(!1===n.deletable)return 1;var e=a.has(n.id),t=!e&&n.parentId&&l.find(e=>e.id===n.parentId);(e||t)&&l.push(n)};for(var d of o)yield*u(d);var s=new Set(t.map(n=>n.id)),c=r.filter(n=>!1!==n.deletable),v=C(l,c),h=function*(n){s.has(n.id)&&!v.find(e=>e.id===n.id)&&v.push(n)};for(var f of c)yield*h(f);if(!i)return{edges:v,nodes:l};var p=yield i({nodes:l,edges:v});return"boolean"==typeof p?p?{edges:v,nodes:l}:{edges:[],nodes:[]}:p}))).apply(this,arguments)}var X=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(n,e),t)},V=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=arguments.length>1?arguments[1]:void 0;return{x:X(n.x,e[0][0],e[1][0]),y:X(n.y,e[0][1],e[1][1])}},R=(n,e,t)=>n<e?X(Math.abs(n-e),1,e)/e:n>t?-X(Math.abs(n-t),1,e)/e:0,Z=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,r=R(n.x,o,e.width-o)*t,i=R(n.y,o,e.height-o)*t;return[r,i]},j=(n,e)=>({x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x2,e.x2),y2:Math.max(n.y2,e.y2)}),G=n=>{var{x:e,y:t,width:o,height:r}=n;return{x:e,y:t,x2:e+o,y2:t+r}},_=n=>{var{x:e,y:t,x2:o,y2:r}=n;return{x:e,y:t,width:o-e,height:r-t}},W=function(n){var e,t,o,r,i,a,l,u,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{x:s,y:c}=O(n)?n.internals.positionAbsolute:N(n,d);return{x:s,y:c,width:null!==(e=null!==(t=null!==(o=null===(r=n.measured)||void 0===r?void 0:r.width)&&void 0!==o?o:n.width)&&void 0!==t?t:n.initialWidth)&&void 0!==e?e:0,height:null!==(i=null!==(a=null!==(l=null===(u=n.measured)||void 0===u?void 0:u.height)&&void 0!==l?l:n.height)&&void 0!==a?a:n.initialHeight)&&void 0!==i?i:0}},F=function(n){var e,t,o,r,i,a,l,u,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{x:s,y:c}=O(n)?n.internals.positionAbsolute:N(n,d);return{x:s,y:c,x2:s+(null!==(e=null!==(t=null!==(o=null===(r=n.measured)||void 0===r?void 0:r.width)&&void 0!==o?o:n.width)&&void 0!==t?t:n.initialWidth)&&void 0!==e?e:0),y2:c+(null!==(i=null!==(a=null!==(l=null===(u=n.measured)||void 0===u?void 0:u.height)&&void 0!==l?l:n.height)&&void 0!==a?a:n.initialHeight)&&void 0!==i?i:0)}},q=(n,e)=>_(j(G(n),G(e))),K=(n,e)=>{var t=Math.max(0,Math.min(n.x+n.width,e.x+e.width)-Math.max(n.x,e.x)),o=Math.max(0,Math.min(n.y+n.height,e.y+e.height)-Math.max(n.y,e.y));return Math.ceil(t*o)},U=n=>J(n.width)&&J(n.height)&&J(n.x)&&J(n.y),J=n=>!isNaN(n)&&isFinite(n),Q=(n,e)=>{0},$=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1];return{x:e[0]*Math.round(n.x/e[0]),y:e[1]*Math.round(n.y/e[1])}},nn=function(n,e){var{x:t,y:o}=n,[r,i,a]=e,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],d={x:(t-r)/a,y:(o-i)/a};return l?$(d,u):d},en=(n,e)=>{var{x:t,y:o}=n,[r,i,a]=e;return{x:t*a+r,y:o*a+i}},tn=(n,e,t,o,r,i)=>{var a=e/(n.width*(1+i)),l=t/(n.height*(1+i)),u=Math.min(a,l),d=X(u,o,r);return{x:e/2-(n.x+n.width/2)*d,y:t/2-(n.y+n.height/2)*d,zoom:d}},on=()=>{var n;return"undefined"!=typeof navigator&&(null===(n=navigator)||void 0===n||null===(n=n.userAgent)||void 0===n?void 0:n.indexOf("Mac"))>=0};function rn(n){return void 0!==n&&"parent"!==n}function an(n){var e,t,o,r,i,a,l,u;return{width:null!==(e=null!==(t=null!==(o=null===(r=n.measured)||void 0===r?void 0:r.width)&&void 0!==o?o:n.width)&&void 0!==t?t:n.initialWidth)&&void 0!==e?e:0,height:null!==(i=null!==(a=null!==(l=null===(u=n.measured)||void 0===u?void 0:u.height)&&void 0!==l?l:n.height)&&void 0!==a?a:n.initialHeight)&&void 0!==i?i:0}}function ln(n){var e,t,o,r,i,a;return void 0!==(null!==(e=null!==(t=null===(o=n.measured)||void 0===o?void 0:o.width)&&void 0!==t?t:n.width)&&void 0!==e?e:n.initialWidth)&&void 0!==(null!==(r=null!==(i=null===(a=n.measured)||void 0===a?void 0:a.height)&&void 0!==i?i:n.height)&&void 0!==r?r:n.initialHeight)}function un(n){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0},t=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,i=t,a=s({},n);i;){var l=o.get(i);if(i=null==l?void 0:l.parentId,l){var u,d,c=l.origin||r;a.x+=l.internals.positionAbsolute.x-(null!==(u=e.width)&&void 0!==u?u:0)*c[0],a.y+=l.internals.positionAbsolute.y-(null!==(d=e.height)&&void 0!==d?d:0)*c[1]}}return a}function dn(n,e){var{snapGrid:t=[0,0],snapToGrid:o=!1,transform:r}=e,{x:i,y:a}=pn(n),l=nn({x:i,y:a},r),{x:u,y:d}=o?$(l,t):l;return s({xSnapped:u,ySnapped:d},l)}var sn=n=>({width:n.offsetWidth,height:n.offsetHeight}),cn=n=>{var e,t;return(null===(e=n.getRootNode)||void 0===e?void 0:e.call(n))||(null===(t=window)||void 0===t?void 0:t.document)},vn=["INPUT","SELECT","TEXTAREA"];function hn(n){var e,t=(null===(e=n.composedPath)||void 0===e||null===(e=e.call(n))||void 0===e?void 0:e[0])||n.target;return vn.includes(null==t?void 0:t.nodeName)||(null==t?void 0:t.hasAttribute("contenteditable"))||!(null==t||!t.closest(".nokey"))}var fn=n=>"clientX"in n,pn=(n,e)=>{var t,o,r,i,a=fn(n),l=a?n.clientX:null===(t=n.touches)||void 0===t?void 0:t[0].clientX,u=a?n.clientY:null===(o=n.touches)||void 0===o?void 0:o[0].clientY;return{x:l-(null!==(r=null==e?void 0:e.left)&&void 0!==r?r:0),y:u-(null!==(i=null==e?void 0:e.top)&&void 0!==i?i:0)}},gn=(n,e,t,o,r)=>{var i=e.querySelectorAll(".".concat(n));return i&&i.length?Array.from(i).map(e=>{var i=e.getBoundingClientRect();return s({id:e.getAttribute("data-handleid"),type:n,nodeId:r,position:e.getAttribute("data-handlepos"),x:(i.left-t.left)/o,y:(i.top-t.top)/o},sn(e))}):null};function yn(n){var{sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:u}=n,d=.125*e+.375*i+.375*l+.125*o,s=.125*t+.375*a+.375*u+.125*r;return[d,s,Math.abs(d-e),Math.abs(s-t)]}function mn(n,e){return n>=0?.5*n:25*e*Math.sqrt(-n)}function xn(n){var{pos:e,x1:t,y1:o,x2:r,y2:i,c:a}=n;switch(e){case w.Left:return[t-mn(t-r,a),o];case w.Right:return[t+mn(r-t,a),o];case w.Top:return[t,o-mn(o-i,a)];case w.Bottom:return[t,o+mn(i-o,a)]}}function wn(n){var{sourceX:e,sourceY:t,sourcePosition:o=w.Bottom,targetX:r,targetY:i,targetPosition:a=w.Top,curvature:l=.25}=n,[u,d]=xn({pos:o,x1:e,y1:t,x2:r,y2:i,c:l}),[s,c]=xn({pos:a,x1:r,y1:i,x2:e,y2:t,c:l}),[v,h,f,p]=yn({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:u,sourceControlY:d,targetControlX:s,targetControlY:c});return["M".concat(e,",").concat(t," C").concat(u,",").concat(d," ").concat(s,",").concat(c," ").concat(r,",").concat(i),v,h,f,p]}function bn(n){var{sourceX:e,sourceY:t,targetX:o,targetY:r}=n,i=Math.abs(o-e)/2,a=o<e?o+i:o-i,l=Math.abs(r-t)/2;return[a,r<t?r+l:r-l,i,l]}function Pn(n){var{sourceNode:e,targetNode:t,selected:o=!1,zIndex:r=0,elevateOnSelect:i=!1}=n;if(!i)return r;var a=o||t.selected||e.selected,l=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(a?l:0)}function Mn(n){var{sourceNode:e,targetNode:t,width:o,height:r,transform:i}=n,a=j(F(e),F(t));a.x===a.x2&&(a.x2+=1),a.y===a.y2&&(a.y2+=1);var l={x:-i[0]/i[2],y:-i[1]/i[2],width:o/i[2],height:r/i[2]};return K(l,_(a))>0}var En=n=>{var{source:e,sourceHandle:t,target:o,targetHandle:r}=n;return"xy-edge__".concat(e).concat(t||"","-").concat(o).concat(r||"")},Sn=(n,e)=>{return n.source&&n.target?((n,e)=>e.some(e=>!(e.source!==n.source||e.target!==n.target||e.sourceHandle!==n.sourceHandle&&(e.sourceHandle||n.sourceHandle)||e.targetHandle!==n.targetHandle&&(e.targetHandle||n.targetHandle))))(t=I(n)?s({},n):s(s({},n),{},{id:En(n)}),e)?e:(null===t.sourceHandle&&delete t.sourceHandle,null===t.targetHandle&&delete t.targetHandle,e.concat(t)):(Q("006",p.error006()),e);var t};function In(n){var{sourceX:e,sourceY:t,targetX:o,targetY:r}=n,[i,a,l,u]=bn({sourceX:e,sourceY:t,targetX:o,targetY:r});return["M ".concat(e,",").concat(t,"L ").concat(o,",").concat(r),i,a,l,u]}var zn={[w.Left]:{x:-1,y:0},[w.Right]:{x:1,y:0},[w.Top]:{x:0,y:-1},[w.Bottom]:{x:0,y:1}},On=(n,e)=>Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2));function Nn(n){var e,t,{source:o,sourcePosition:r=w.Bottom,target:i,targetPosition:a=w.Top,center:l,offset:u}=n,d=zn[r],s=zn[a],c={x:o.x+d.x*u,y:o.y+d.y*u},v={x:i.x+s.x*u,y:i.y+s.y*u},h=(n=>{var{source:e,sourcePosition:t=w.Bottom,target:o}=n;return t===w.Left||t===w.Right?e.x<o.x?{x:1,y:0}:{x:-1,y:0}:e.y<o.y?{x:0,y:1}:{x:0,y:-1}})({source:c,sourcePosition:r,target:v}),f=0!==h.x?"x":"y",p=h[f],g=[],y={x:0,y:0},m={x:0,y:0},[x,b,P,M]=bn({sourceX:o.x,sourceY:o.y,targetX:i.x,targetY:i.y});if(d[f]*s[f]==-1){var E,S;e=null!==(E=l.x)&&void 0!==E?E:x,t=null!==(S=l.y)&&void 0!==S?S:b;var I=[{x:e,y:c.y},{x:e,y:v.y}],z=[{x:c.x,y:t},{x:v.x,y:t}];g=d[f]===p?"x"===f?I:z:"x"===f?z:I}else{var O=[{x:c.x,y:v.y}],N=[{x:v.x,y:c.y}];if(g="x"===f?d.x===p?N:O:d.y===p?O:N,r===a){var T=Math.abs(o[f]-i[f]);if(T<=u){var H=Math.min(u-1,u-T);d[f]===p?y[f]=(c[f]>o[f]?-1:1)*H:m[f]=(v[f]>i[f]?-1:1)*H}}if(r!==a){var C="x"===f?"y":"x",k=d[f]===s[C],A=c[C]>v[C],D=c[C]<v[C];(1===d[f]&&(!k&&A||k&&D)||1!==d[f]&&(!k&&D||k&&A))&&(g="x"===f?O:N)}var B={x:c.x+y.x,y:c.y+y.y},L={x:v.x+m.x,y:v.y+m.y};Math.max(Math.abs(B.x-g[0].x),Math.abs(L.x-g[0].x))>=Math.max(Math.abs(B.y-g[0].y),Math.abs(L.y-g[0].y))?(e=(B.x+L.x)/2,t=g[0].y):(e=g[0].x,t=(B.y+L.y)/2)}return[[o,{x:c.x+y.x,y:c.y+y.y},...g,{x:v.x+m.x,y:v.y+m.y},i],e,t,P,M]}function Tn(n){var{sourceX:e,sourceY:t,sourcePosition:o=w.Bottom,targetX:r,targetY:i,targetPosition:a=w.Top,borderRadius:l=5,centerX:u,centerY:d,offset:s=20}=n,[c,v,h,f,p]=Nn({source:{x:e,y:t},sourcePosition:o,target:{x:r,y:i},targetPosition:a,center:{x:u,y:d},offset:s});return[c.reduce((n,e,t)=>n+=t>0&&t<c.length-1?function(n,e,t,o){var r=Math.min(On(n,e)/2,On(e,t)/2,o),{x:i,y:a}=e;if(n.x===i&&i===t.x||n.y===a&&a===t.y)return"L".concat(i," ").concat(a);if(n.y===a){var l=n.x<t.x?-1:1,u=n.y<t.y?1:-1;return"L ".concat(i+r*l,",").concat(a,"Q ").concat(i,",").concat(a," ").concat(i,",").concat(a+r*u)}var d=n.x<t.x?1:-1,s=n.y<t.y?-1:1;return"L ".concat(i,",").concat(a+r*s,"Q ").concat(i,",").concat(a," ").concat(i+r*d,",").concat(a)}(c[t-1],e,c[t+1],l):"".concat(0===t?"M":"L").concat(e.x," ").concat(e.y),""),v,h,f,p]}function Hn(n){var e;return n&&!!(n.internals.handleBounds||null!==(e=n.handles)&&void 0!==e&&e.length)&&!!(n.measured.width||n.width||n.initialWidth)}function Cn(n){var e,t,o,r,{sourceNode:i,targetNode:a}=n;if(!Hn(i)||!Hn(a))return null;var l,u=i.internals.handleBounds||kn(i.handles),d=a.internals.handleBounds||kn(a.handles),s=Dn(null!==(e=null==u?void 0:u.source)&&void 0!==e?e:[],n.sourceHandle),c=Dn(n.connectionMode===v.Strict?null!==(t=null==d?void 0:d.target)&&void 0!==t?t:[]:(null!==(o=null==d?void 0:d.target)&&void 0!==o?o:[]).concat(null!==(r=null==d?void 0:d.source)&&void 0!==r?r:[]),n.targetHandle);if(!s||!c)return null===(l=n.onError)||void 0===l||l.call(n,"008",p.error008(s?"target":"source",{id:n.id,sourceHandle:n.sourceHandle,targetHandle:n.targetHandle})),null;var h=(null==s?void 0:s.position)||w.Bottom,f=(null==c?void 0:c.position)||w.Top,g=An(i,s,h),y=An(a,c,f);return{sourceX:g.x,sourceY:g.y,targetX:y.x,targetY:y.y,sourcePosition:h,targetPosition:f}}function kn(n){if(!n)return null;var e=[],t=[];for(var o of n){var r,i;o.width=null!==(r=o.width)&&void 0!==r?r:1,o.height=null!==(i=o.height)&&void 0!==i?i:1,"source"===o.type?e.push(o):"target"===o.type&&t.push(o)}return{source:e,target:t}}function An(n,e){var t,o,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.Left,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=(null!==(t=null==e?void 0:e.x)&&void 0!==t?t:0)+n.internals.positionAbsolute.x,u=(null!==(o=null==e?void 0:e.y)&&void 0!==o?o:0)+n.internals.positionAbsolute.y,{width:d,height:s}=null!=e?e:an(n);if(a)return{x:l+d/2,y:u+s/2};var c=null!==(r=null==e?void 0:e.position)&&void 0!==r?r:i;switch(c){case w.Top:return{x:l+d/2,y:u};case w.Right:return{x:l+d,y:u+s/2};case w.Bottom:return{x:l+d/2,y:u+s};case w.Left:return{x:l,y:u+s/2}}}function Dn(n,e){return n&&(e?n.find(n=>n.id===e):n[0])||null}function Bn(n,e){if(!n)return"";if("string"==typeof n)return n;var t=e?"".concat(e,"__"):"";return"".concat(t).concat(Object.keys(n).sort().map(e=>"".concat(e,"=").concat(n[e])).join("&"))}function Ln(n,e){var{id:t,defaultColor:o,defaultMarkerStart:r,defaultMarkerEnd:i}=e,a=new Set;return n.reduce((n,e)=>([e.markerStart||r,e.markerEnd||i].forEach(e=>{if(e&&"object"==typeof e){var r=Bn(e,t);a.has(r)||(n.push(s({id:r,color:e.color||o},e)),a.add(r))}}),n),[]).sort((n,e)=>n.id.localeCompare(e.id))}function Yn(n,e,t,o,r){var i=.5;"start"===r?i=0:"end"===r&&(i=1);var a=[(n.x+n.width*i)*e.zoom+e.x,n.y*e.zoom+e.y-o],l=[-100*i,-100];switch(t){case w.Right:a=[(n.x+n.width)*e.zoom+e.x+o,(n.y+n.height*i)*e.zoom+e.y],l=[0,-100*i];break;case w.Bottom:a[1]=(n.y+n.height)*e.zoom+e.y+o,l[1]=0;break;case w.Left:a=[n.x*e.zoom+e.x-o,(n.y+n.height*i)*e.zoom+e.y],l=[-100,-100*i]}return"translate(".concat(a[0],"px, ").concat(a[1],"px) translate(").concat(l[0],"%, ").concat(l[1],"%)")}var Xn={nodeOrigin:[0,0],elevateNodesOnSelect:!0,defaults:{}},Vn=s(s({},Xn),{},{checkEquality:!0});function Rn(n,e,t){var o=s(s({},Xn),t);for(var r of n.values())r.parentId&&jn(r,n,e,o)}function Zn(n,e,t,o){var r=s(s({},Vn),o),i=new Map(e);e.clear(),t.clear();var a=null!=o&&o.elevateNodesOnSelect?1e3:0;for(var l of n){var u,d,c,v,h=i.get(l.id);if(r.checkEquality&&l===(null===(u=h)||void 0===u?void 0:u.internals.userNode))e.set(l.id,h);else h=s(s(s({},r.defaults),l),{},{measured:{width:null===(d=l.measured)||void 0===d?void 0:d.width,height:null===(c=l.measured)||void 0===c?void 0:c.height},internals:{positionAbsolute:N(l,r.nodeOrigin),handleBounds:l.measured?null===(v=h)||void 0===v?void 0:v.internals.handleBounds:void 0,z:Gn(l,a),userNode:l}}),e.set(l.id,h);l.parentId&&jn(h,e,t,o)}}function jn(n,e,t,o){var r=s(s({},Xn),o),i=n.parentId,a=e.get(i);if(a){var l=t.get(i);l?l.set(n.id,n):t.set(i,new Map([[n.id,n]]));var u=null!=o&&o.elevateNodesOnSelect?1e3:0,{x:d,y:c,z:v}=function(n,e,t,o){var r,i=N(n,t),a=Gn(n,o),l=null!==(r=e.internals.z)&&void 0!==r?r:0;return{x:e.internals.positionAbsolute.x+i.x,y:e.internals.positionAbsolute.y+i.y,z:l>a?l:a}}(n,a,r.nodeOrigin,u),h=n.internals.positionAbsolute,f=d!==h.x||c!==h.y;(f||v!==n.internals.z)&&(n.internals=s(s({},n.internals),{},{positionAbsolute:f?{x:d,y:c}:h,z:v}))}else console.warn("Parent node ".concat(i," not found. Please make sure that parent nodes are in front of their child nodes in the nodes array."))}function Gn(n,e){return(J(n.zIndex)?n.zIndex:0)+(n.selected?e:0)}function _n(n,e,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],r=[],i=new Map;for(var a of n){var l,u,d=e.get(a.parentId);if(d){var s=null!==(l=null===(u=i.get(a.parentId))||void 0===u?void 0:u.expandedRect)&&void 0!==l?l:W(d),c=q(s,a.rect);i.set(a.parentId,{expandedRect:c,parent:d})}}return i.size>0&&i.forEach((e,i)=>{var a,l,{expandedRect:u,parent:d}=e,s=d.internals.positionAbsolute,c=an(d),v=null!==(a=d.origin)&&void 0!==a?a:o,h=u.x<s.x?Math.round(Math.abs(s.x-u.x)):0,f=u.y<s.y?Math.round(Math.abs(s.y-u.y)):0,p=Math.max(c.width,Math.round(u.width)),g=Math.max(c.height,Math.round(u.height)),y=(p-c.width)*v[0],m=(g-c.height)*v[1];(h>0||f>0||y||m)&&(r.push({id:i,type:"position",position:{x:d.position.x-h+y,y:d.position.y-f+m}}),null===(l=t.get(i))||void 0===l||l.forEach(e=>{n.some(n=>n.id===e.id)||r.push({id:e.id,type:"position",position:{x:e.position.x+h,y:e.position.y+f}})}));(c.width<u.width||c.height<u.height||h||f)&&r.push({id:i,type:"dimensions",setAttributes:!0,dimensions:{width:p+(h?v[0]*h-y:0),height:g+(f?v[1]*f-m:0)}})}),r}function Wn(n,e,t,o,r){var i=null==o?void 0:o.querySelector(".xyflow__viewport"),a=!1;if(!i)return{changes:[],updatedInternals:a};var l=[],u=window.getComputedStyle(i),{m22:d}=new window.DOMMatrixReadOnly(u.transform),c=[];for(var v of n.values()){var h=e.get(v.id);if(h)if(h.hidden)h.internals=s(s({},h.internals),{},{handleBounds:void 0}),a=!0;else{var f=sn(v.nodeElement),p=h.measured.width!==f.width||h.measured.height!==f.height;if(!(!f.width||!f.height||!p&&h.internals.handleBounds&&!v.force)){var g=v.nodeElement.getBoundingClientRect();h.measured=f,h.internals=s(s({},h.internals),{},{positionAbsolute:N(h,r),handleBounds:{source:gn("source",v.nodeElement,g,d,h.id),target:gn("target",v.nodeElement,g,d,h.id)}}),h.parentId&&jn(h,e,t,{nodeOrigin:r}),a=!0,p&&(l.push({id:h.id,type:"dimensions",dimensions:f}),h.expandParent&&h.parentId&&c.push({id:h.id,parentId:h.parentId,rect:W(h,r)}))}}}if(c.length>0){var y=_n(c,e,t,r);l.push(...y)}return{changes:l,updatedInternals:a}}function Fn(n){return qn.apply(this,arguments)}function qn(){return(qn=u((function*(n){var{delta:e,panZoom:t,transform:o,translateExtent:r,width:i,height:a}=n;if(!t||!e.x&&!e.y)return Promise.resolve(!1);var l=yield t.setViewportConstrained({x:o[0]+e.x,y:o[1]+e.y,zoom:o[2]},[[0,0],[i,a]],r),u=!!l&&(l.x!==o[0]||l.y!==o[1]||l.k!==o[2]);return Promise.resolve(u)}))).apply(this,arguments)}function Kn(n,e,t){for(var o of(n.clear(),e.clear(),t)){var{source:r,target:i,sourceHandle:a=null,targetHandle:l=null}=o,u="".concat(r,"-source-").concat(a),d="".concat(i,"-target-").concat(l),s=n.get(u)||new Map,c=n.get(d)||new Map,v={edgeId:o.id,source:r,target:i,sourceHandle:a,targetHandle:l};e.set(o.id,o),n.set(u,s.set("".concat(i,"-").concat(l),v)),n.set(d,c.set("".concat(r,"-").concat(a),v))}}function Un(n,e){if(null===n||null===e)return!1;var t=Array.isArray(n)?n:[n],o=Array.isArray(e)?e:[e];if(t.length!==o.length)return!1;for(var r=0;r<t.length;r++)if(t[r].id!==o[r].id||t[r].type!==o[r].type||!Object.is(t[r].data,o[r].data))return!1;return!0}function Jn(n,e){if(!n.parentId)return!1;var t=e.get(n.parentId);return!!t&&(!!t.selected||Jn(t,e))}function Qn(n,e,t){var o=n;do{var r;if(null!==(r=o)&&void 0!==r&&r.matches(e))return!0;if(o===t)return!1;o=o.parentElement}while(o);return!1}function $n(n){var e,{nodeId:t,dragItems:o,nodeLookup:r,dragging:i=!0}=n,a=[];for(var[l,u]of o){var d,c=null===(d=r.get(l))||void 0===d?void 0:d.internals.userNode;c&&a.push(s(s({},c),{},{position:u.position,dragging:i}))}if(!t)return[a[0],a];var v=r.get(t).internals.userNode;return[s(s({},v),{},{position:(null===(e=o.get(t))||void 0===e?void 0:e.position)||v.position,dragging:i}),a]}function ne(n){var{onNodeMouseDown:e,getStoreItems:t,onDragStart:i,onDrag:a,onDragStop:l}=n,d={x:null,y:null},s=0,c=new Map,v=!1,h={x:0,y:0},f=null,p=!1,g=null,y=!1;return{update:function(n){var{noDragClassName:m,handleSelector:x,domNode:w,isSelectable:b,nodeId:P,nodeClickDistance:M=0}=n;function E(n,e){var{x:o,y:r}=n,{nodeLookup:i,nodeExtent:l,snapGrid:u,snapToGrid:s,nodeOrigin:v,onNodeDrag:h,onSelectionDrag:f,onError:p,updateNodePositions:g}=t();d={x:o,y:r};var y=!1,m={x:0,y:0,x2:0,y2:0};if(c.size>1&&l){var x=T(c);m=G(x)}for(var[w,b]of c){var M={x:o-b.distance.x,y:r-b.distance.y};s&&(M=$(M,u));var E=[[l[0][0],l[0][1]],[l[1][0],l[1][1]]];if(c.size>1&&l&&!b.extent){var{positionAbsolute:S}=b.internals,I=S.x-m.x+l[0][0],z=S.x+b.measured.width-m.x2+l[1][0];E=[[I,S.y-m.y+l[0][1]],[z,S.y+b.measured.height-m.y2+l[1][1]]]}var{position:O,positionAbsolute:N}=B({nodeId:w,nextPosition:M,nodeLookup:i,nodeExtent:E,nodeOrigin:v,onError:p});y=y||b.position.x!==O.x||b.position.y!==O.y,b.position=O,b.internals.positionAbsolute=N}if(y&&(g(c,!0),e&&(a||h||!P&&f))){var[H,C]=$n({nodeId:P,dragItems:c,nodeLookup:i});null==a||a(e,c,H,C),null==h||h(e,H,C),P||null==f||f(e,C)}}function S(){return I.apply(this,arguments)}function I(){return(I=u((function*(){if(f){var n,e,{transform:o,panBy:r,autoPanSpeed:i}=t(),[a,l]=Z(h,f,i);if(0!==a||0!==l)d.x=(null!==(n=d.x)&&void 0!==n?n:0)-a/o[2],d.y=(null!==(e=d.y)&&void 0!==e?e:0)-l/o[2],(yield r({x:a,y:l}))&&E(d,null);s=requestAnimationFrame(S)}}))).apply(this,arguments)}function z(n){var o,{nodeLookup:r,multiSelectionActive:a,nodesDraggable:l,transform:u,snapGrid:s,snapToGrid:v,selectNodesOnDrag:h,onNodeDragStart:f,onSelectionDragStart:g,unselectNodesAndEdges:y}=t();(p=!0,h&&b||a||!P)||(null!==(o=r.get(P))&&void 0!==o&&o.selected||y());b&&h&&P&&(null==e||e(P));var m=dn(n.sourceEvent,{transform:u,snapGrid:s,snapToGrid:v});if(d=m,(c=function(n,e,t,o){var r=new Map;for(var[i,a]of n)if((a.selected||a.id===o)&&(!a.parentId||!Jn(a,n))&&(a.draggable||e&&void 0===a.draggable)){var l,u,d=n.get(i);if(d)r.set(i,{id:i,position:d.position||{x:0,y:0},distance:{x:t.x-d.internals.positionAbsolute.x,y:t.y-d.internals.positionAbsolute.y},extent:d.extent,parentId:d.parentId,origin:d.origin,expandParent:d.expandParent,internals:{positionAbsolute:d.internals.positionAbsolute||{x:0,y:0}},measured:{width:null!==(l=d.measured.width)&&void 0!==l?l:0,height:null!==(u=d.measured.height)&&void 0!==u?u:0}})}return r}(r,l,m,P)).size>0&&(i||f||!P&&g)){var[x,w]=$n({nodeId:P,dragItems:c,nodeLookup:r});null==i||i(n.sourceEvent,c,x,w),null==f||f(n.sourceEvent,x,w),P||null==g||g(n.sourceEvent,w)}}g=Object(r.a)(w);var O=Object(o.a)().clickDistance(M).on("start",n=>{var{domNode:e,nodeDragThreshold:o,transform:r,snapGrid:i,snapToGrid:a}=t();y=!1,0===o&&z(n);var l=dn(n.sourceEvent,{transform:r,snapGrid:i,snapToGrid:a});d=l,f=(null==e?void 0:e.getBoundingClientRect())||null,h=pn(n.sourceEvent,f)}).on("drag",n=>{var{autoPanOnNodeDrag:e,transform:o,snapGrid:r,snapToGrid:i,nodeDragThreshold:a}=t(),l=dn(n.sourceEvent,{transform:o,snapGrid:r,snapToGrid:i});if("touchmove"===n.sourceEvent.type&&n.sourceEvent.touches.length>1&&(y=!0),!y){if(!v&&e&&p&&(v=!0,S()),!p){var u,s,g=l.xSnapped-(null!==(u=d.x)&&void 0!==u?u:0),m=l.ySnapped-(null!==(s=d.y)&&void 0!==s?s:0);Math.sqrt(g*g+m*m)>a&&z(n)}(d.x!==l.xSnapped||d.y!==l.ySnapped)&&c&&p&&(h=pn(n.sourceEvent,f),E(l,n.sourceEvent))}}).on("end",n=>{if(p&&!y&&(v=!1,p=!1,cancelAnimationFrame(s),c.size>0)){var{nodeLookup:e,updateNodePositions:o,onNodeDragStop:r,onSelectionDragStop:i}=t();if(o(c,!1),l||r||!P&&i){var[a,u]=$n({nodeId:P,dragItems:c,nodeLookup:e,dragging:!1});null==l||l(n.sourceEvent,c,a,u),null==r||r(n.sourceEvent,a,u),P||null==i||i(n.sourceEvent,u)}}}).filter(n=>{var e=n.target;return!n.button&&(!m||!Qn(e,".".concat(m),w))&&(!x||Qn(e,x,w))});g.call(O)},destroy:function(){var n;null===(n=g)||void 0===n||n.on(".drag",null)}}}function ee(n,e,t,o){var r=null;return[(e[t]||[]).reduce((e,i)=>{if(n.id===o.nodeId&&t===o.handleType&&i.id===o.handleId)r=i;else{var a=An(n,i,i.position,!0);e.push(s(s({},i),a))}return e},[]),r]}function te(n,e){return n||(null!=e&&e.classList.contains("target")?"target":null!=e&&e.classList.contains("source")?"source":null)}var oe=()=>!0;function re(n,e){var{handle:t,connectionMode:o,fromNodeId:r,fromHandleId:i,fromType:a,doc:l,lib:u,flowId:d,isValidConnection:c=oe,handleLookup:h}=e,f="target"===a,p=t?l.querySelector(".".concat(u,'-flow__handle[data-id="').concat(d,"-").concat(null==t?void 0:t.nodeId,"-").concat(null==t?void 0:t.id,"-").concat(null==t?void 0:t.type,'"]')):null,{x:g,y:y}=pn(n),m=l.elementFromPoint(g,y),x=null!=m&&m.classList.contains("".concat(u,"-flow__handle"))?m:p,w={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){var b=te(void 0,x),P=x.getAttribute("data-nodeid"),M=x.getAttribute("data-handleid"),E=x.classList.contains("connectable"),S=x.classList.contains("connectableend");if(!P)return w;var I={source:f?P:r,sourceHandle:f?M:i,target:f?r:P,targetHandle:f?i:M};w.connection=I;var z=E&&S&&(o===v.Strict?f&&"source"===b||!f&&"target"===b:P!==r||M!==i);w.isValid=z&&c(I);var O=null==h?void 0:h.get("".concat(P,"-").concat(b,"-").concat(M));O&&(w.toHandle=s({},O))}return w}var ie={onPointerDown:function(n,e){var t,{connectionMode:o,connectionRadius:r,handleId:i,nodeId:a,edgeUpdaterType:l,isTarget:u,domNode:d,nodeLookup:c,lib:v,autoPanOnConnect:h,flowId:f,panBy:p,cancelConnection:g,onConnectStart:y,onConnect:m,onConnectEnd:x,isValidConnection:b=oe,onReconnectEnd:M,updateConnection:E,getTransform:S,getFromHandle:I,autoPanSpeed:z}=e,O=cn(n.target),N=0,{x:T,y:H}=pn(n),C=null==O?void 0:O.elementFromPoint(T,H),k=te(l,C),A=null==d?void 0:d.getBoundingClientRect();if(A&&k){var D=pn(n,A),B=!1,L=null,Y=!1,X=null,[V,R]=function(n){var{nodeLookup:e,nodeId:t,handleId:o,handleType:r}=n,i=new Map,a={nodeId:t,handleId:o,handleType:r},l=null;for(var u of e.values())if(u.internals.handleBounds){var[d,s]=ee(u,u.internals.handleBounds,"source",a),[c,v]=ee(u,u.internals.handleBounds,"target",a);l=l||(null!=s?s:v),[...d,...c].forEach(n=>i.set("".concat(n.nodeId,"-").concat(n.type,"-").concat(n.id),n))}if(!l){var h=e.get(t);if(null!=h&&h.internals.handleBounds){a.handleType="source"===r?"target":"source";var[,f]=ee(h,h.internals.handleBounds,a.handleType,a);l=f}}return[i,l]}({nodeLookup:c,nodeId:a,handleId:i,handleType:k}),j=s(s({},R),{},{nodeId:a,type:k,position:R.position}),G=c.get(a),_={inProgress:!0,isValid:null,from:An(G,j,w.Left,!0),fromHandle:j,fromPosition:j.position,fromNode:G,to:D,toHandle:null,toPosition:P[j.position],toNode:null};E(_);var W=_;null==y||y(n,{nodeId:a,handleId:i,handleType:k}),O.addEventListener("mousemove",q),O.addEventListener("mouseup",K),O.addEventListener("touchmove",q),O.addEventListener("touchend",K)}function F(){if(h&&A){var[n,e]=Z(D,A,z);p({x:n,y:e}),N=requestAnimationFrame(F)}}function q(n){if(I()&&j){var e=S();D=pn(n,A),t=function(n,e,t){var o=[],r=1/0;for(var i of t.values()){var a=Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2));a<=e&&(a<r?o=[i]:a===r&&o.push(i),r=a)}return o.length?1===o.length?o[0]:o.find(n=>"target"===n.type)||o[0]:null}(nn(D,e,!1,[1,1]),r,V),B||(F(),B=!0);var l=re(n,{handle:t,connectionMode:o,fromNodeId:a,fromHandleId:i,fromType:u?"target":"source",isValidConnection:b,doc:O,lib:v,flowId:f,handleLookup:V});X=l.handleDomNode,L=l.connection,Y=function(n,e){var t=null;return e?t=!0:n&&!e&&(t=!1),t}(!!t,l.isValid);var d=s(s({},W),{},{isValid:Y,to:t&&Y?en({x:t.x,y:t.y},e):D,toHandle:l.toHandle,toPosition:Y&&l.toHandle?l.toHandle.position:P[j.position],toNode:l.toHandle?c.get(l.toHandle.nodeId):null});Y&&t&&W.toHandle&&d.toHandle&&W.toHandle.type===d.toHandle.type&&W.toHandle.nodeId===d.toHandle.nodeId&&W.toHandle.id===d.toHandle.id||(E(d),W=d)}else K(n)}function K(n){(t||X)&&L&&Y&&(null==m||m(L)),null==x||x(n),l&&(null==M||M(n)),g(),cancelAnimationFrame(N),B=!1,Y=!1,L=null,X=null,O.removeEventListener("mousemove",q),O.removeEventListener("mouseup",K),O.removeEventListener("touchmove",q),O.removeEventListener("touchend",K)}},isValid:re};function ae(n){var{domNode:e,panZoom:t,getTransform:o,getViewScale:l}=n,u=Object(r.a)(e);return{update:function(n){var{translateExtent:e,width:r,height:i,zoomStep:d=10,pannable:s=!0,zoomable:c=!0,inversePan:v=!1}=n,h=[0,0],f=Object(a.a)().on("start",n=>{var e,t;"mousedown"!==n.sourceEvent.type&&"touchstart"!==n.sourceEvent.type||(h=[null!==(e=n.sourceEvent.clientX)&&void 0!==e?e:n.sourceEvent.touches[0].clientX,null!==(t=n.sourceEvent.clientY)&&void 0!==t?t:n.sourceEvent.touches[0].clientY])}).on("zoom",s?n=>{var a,u,d=o();if(("mousemove"===n.sourceEvent.type||"touchmove"===n.sourceEvent.type)&&t){var s=[null!==(a=n.sourceEvent.clientX)&&void 0!==a?a:n.sourceEvent.touches[0].clientX,null!==(u=n.sourceEvent.clientY)&&void 0!==u?u:n.sourceEvent.touches[0].clientY],c=[s[0]-h[0],s[1]-h[1]];h=s;var f=l()*Math.max(d[2],Math.log(d[2]))*(v?-1:1),p={x:d[0]-c[0]*f,y:d[1]-c[1]*f},g=[[0,0],[r,i]];t.setViewportConstrained({x:p.x,y:p.y,zoom:d[2]},g,e)}}:null).on("zoom.wheel",c?n=>{var e=o();if("wheel"===n.sourceEvent.type&&t){var r=-n.sourceEvent.deltaY*(1===n.sourceEvent.deltaMode?.05:n.sourceEvent.deltaMode?1:.002)*d,i=e[2]*Math.pow(2,r);t.scaleTo(i)}}:null);u.call(f,{})},destroy:function(){u.on("zoom",null)},pointer:i.a}}var le,ue=n=>({x:n.x,y:n.y,zoom:n.k}),de=n=>{var{x:e,y:t,zoom:o}=n;return a.b.translate(e,t).scale(o)},se=(n,e)=>n.target.closest(".".concat(e)),ce=(n,e)=>2===e&&Array.isArray(n)&&n.includes(2),ve=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},o="number"==typeof e&&e>0;return o||t(),o?n.transition().duration(e).on("end",t):n},he=n=>{var e=n.ctrlKey&&on()?10:1;return-n.deltaY*(1===n.deltaMode?.05:n.deltaMode?1:.002)*e};function fe(n){var{domNode:e,minZoom:t,maxZoom:o,paneClickDistance:l,translateExtent:d,viewport:s,onPanZoom:c,onPanZoomStart:v,onPanZoomEnd:f,onTransformChange:p,onDraggingChange:g}=n,y={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},m=e.getBoundingClientRect(),x=Object(a.a)().clickDistance(!J(l)||l<0?0:l).scaleExtent([t,o]).translateExtent(d),w=Object(r.a)(e).call(x);S({x:s.x,y:s.y,zoom:X(s.zoom,t,o)},[[0,0],[m.width,m.height]],d);var b=w.on("wheel.zoom"),P=w.on("dblclick.zoom");function M(n,e){return w?new Promise(t=>{null==x||x.transform(ve(w,null==e?void 0:e.duration,()=>t(!0)),n)}):Promise.resolve(!1)}function E(){x.on("zoom",null)}function S(n,e,t){return I.apply(this,arguments)}function I(){return(I=u((function*(n,e,t){var o=de(n),r=null==x?void 0:x.constrain()(o,e,t);return r&&(yield M(r)),new Promise(n=>n(r))}))).apply(this,arguments)}function z(){return(z=u((function*(n,e){var t=de(n);return yield M(t,e),new Promise(n=>n(t))}))).apply(this,arguments)}return x.wheelDelta(he),{update:function(n){var{noWheelClassName:e,noPanClassName:t,onPaneContextMenu:o,userSelectionActive:r,panOnScroll:a,panOnDrag:l,panOnScrollMode:u,panOnScrollSpeed:d,preventScrolling:s,zoomOnPinch:m,zoomOnScroll:M,zoomOnDoubleClick:S,zoomActivationKeyPressed:I,lib:z}=n;r&&!y.isZoomingOrPanning&&E();var O=a&&!I&&!r?function(n){var{zoomPanValues:e,noWheelClassName:t,d3Selection:o,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:l,zoomOnPinch:u,onPanZoomStart:d,onPanZoom:s,onPanZoomEnd:c}=n;return n=>{if(se(n,t))return!1;n.preventDefault(),n.stopImmediatePropagation();var v=o.property("__zoom").k||1;if(n.ctrlKey&&u){var f=Object(i.a)(n),p=he(n),g=v*Math.pow(2,p);r.scaleTo(o,g,f,n)}else{var y=1===n.deltaMode?20:1,m=a===h.Vertical?0:n.deltaX*y,x=a===h.Horizontal?0:n.deltaY*y;!on()&&n.shiftKey&&a!==h.Vertical&&(m=n.deltaY*y,x=0),r.translateBy(o,-m/v*l,-x/v*l,{internal:!0});var w=ue(o.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,null==d||d(n,w)),e.isPanScrolling&&(null==s||s(n,w),e.panScrollTimeout=setTimeout(()=>{null==c||c(n,w),e.isPanScrolling=!1},150))}}}({zoomPanValues:y,noWheelClassName:e,d3Selection:w,d3Zoom:x,panOnScrollMode:u,panOnScrollSpeed:d,zoomOnPinch:m,onPanZoomStart:v,onPanZoom:c,onPanZoomEnd:f}):function(n){var{noWheelClassName:e,preventScrolling:t,d3ZoomHandler:o}=n;return function(n,r){if(!t&&"wheel"===n.type&&!n.ctrlKey||se(n,e))return null;n.preventDefault(),o.call(this,n,r)}}({noWheelClassName:e,preventScrolling:s,d3ZoomHandler:b});if(w.on("wheel.zoom",O,{passive:!1}),!r){var N=function(n){var{zoomPanValues:e,onDraggingChange:t,onPanZoomStart:o}=n;return n=>{var r,i,a;if(null===(r=n.sourceEvent)||void 0===r||!r.internal){var l=ue(n.transform);e.mouseButton=(null===(i=n.sourceEvent)||void 0===i?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=l,"mousedown"===(null===(a=n.sourceEvent)||void 0===a?void 0:a.type)&&t(!0),o&&(null==o||o(n.sourceEvent,l))}}}({zoomPanValues:y,onDraggingChange:g,onPanZoomStart:v});x.on("start",N);var T=function(n){var{zoomPanValues:e,panOnDrag:t,onPaneContextMenu:o,onTransformChange:r,onPanZoom:i}=n;return n=>{var a,l,u;e.usedRightMouseButton=!(!o||!ce(t,null!==(a=e.mouseButton)&&void 0!==a?a:0)),null!==(l=n.sourceEvent)&&void 0!==l&&l.sync||r([n.transform.x,n.transform.y,n.transform.k]),!i||null!==(u=n.sourceEvent)&&void 0!==u&&u.internal||null==i||i(n.sourceEvent,ue(n.transform))}}({zoomPanValues:y,panOnDrag:l,onPaneContextMenu:!!o,onPanZoom:c,onTransformChange:p});x.on("zoom",T);var H=function(n){var{zoomPanValues:e,panOnDrag:t,panOnScroll:o,onDraggingChange:r,onPanZoomEnd:i,onPaneContextMenu:a}=n;return n=>{var l,u,d,s;if((null===(l=n.sourceEvent)||void 0===l||!l.internal)&&(e.isZoomingOrPanning=!1,a&&ce(t,null!==(u=e.mouseButton)&&void 0!==u?u:0)&&!e.usedRightMouseButton&&n.sourceEvent&&a(n.sourceEvent),e.usedRightMouseButton=!1,r(!1),i&&(d=e.prevViewport,s=n.transform,d.x!==s.x||d.y!==s.y||d.zoom!==s.k))){var c=ue(n.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{null==i||i(n.sourceEvent,c)},o?150:0)}}}({zoomPanValues:y,panOnDrag:l,panOnScroll:a,onPaneContextMenu:o,onPanZoomEnd:f,onDraggingChange:g});x.on("end",H)}var C=function(n){var{zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:o,panOnDrag:r,panOnScroll:i,zoomOnDoubleClick:a,userSelectionActive:l,noWheelClassName:u,noPanClassName:d,lib:s}=n;return n=>{var c,v=e||t,h=o&&n.ctrlKey;if(1===n.button&&"mousedown"===n.type&&(se(n,"".concat(s,"-flow__node"))||se(n,"".concat(s,"-flow__edge"))))return!0;if(!(r||v||i||a||o))return!1;if(l)return!1;if(se(n,u)&&"wheel"===n.type)return!1;if(se(n,d)&&("wheel"!==n.type||i&&"wheel"===n.type&&!e))return!1;if(!o&&n.ctrlKey&&"wheel"===n.type)return!1;if(!o&&"touchstart"===n.type&&(null===(c=n.touches)||void 0===c?void 0:c.length)>1)return n.preventDefault(),!1;if(!v&&!i&&!h&&"wheel"===n.type)return!1;if(!r&&("mousedown"===n.type||"touchstart"===n.type))return!1;if(Array.isArray(r)&&!r.includes(n.button)&&"mousedown"===n.type)return!1;var f=Array.isArray(r)&&r.includes(n.button)||!n.button||n.button<=1;return(!n.ctrlKey||"wheel"===n.type)&&f}}({zoomActivationKeyPressed:I,panOnDrag:l,zoomOnScroll:M,panOnScroll:a,zoomOnDoubleClick:S,zoomOnPinch:m,userSelectionActive:r,noPanClassName:t,noWheelClassName:e,lib:z});x.filter(C),S?w.on("dblclick.zoom",P):w.on("dblclick.zoom",null)},destroy:E,setViewport:function(n,e){return z.apply(this,arguments)},setViewportConstrained:S,getViewport:function(){var n=w?Object(a.c)(w.node()):{x:0,y:0,k:1};return{x:n.x,y:n.y,zoom:n.k}},scaleTo:function(n,e){return w?new Promise(t=>{null==x||x.scaleTo(ve(w,null==e?void 0:e.duration,()=>t(!0)),n)}):Promise.resolve(!1)},scaleBy:function(n,e){return w?new Promise(t=>{null==x||x.scaleBy(ve(w,null==e?void 0:e.duration,()=>t(!0)),n)}):Promise.resolve(!1)},setScaleExtent:function(n){null==x||x.scaleExtent(n)},setTranslateExtent:function(n){null==x||x.translateExtent(n)},syncViewport:function(n){if(w){var e=de(n),t=w.property("__zoom");t.k===n.zoom&&t.x===n.x&&t.y===n.y||null==x||x.transform(w,e,null,{sync:!0})}},setClickDistance:function(n){var e=!J(n)||n<0?0:n;null==x||x.clickDistance(e)}}}!function(n){n.Line="line",n.Handle="handle"}(le||(le={}));var pe=["top-left","top-right","bottom-left","bottom-right"],ge=["top","right","bottom","left"];function ye(n,e){return Math.max(0,e-n)}function me(n,e){return Math.max(0,n-e)}function xe(n,e,t){return Math.max(0,e-n,n-t)}function we(n,e){return n?!e:e}var be={width:0,height:0,x:0,y:0},Pe=s(s({},be),{},{pointerX:0,pointerY:0,aspectRatio:1});function Me(n,e,t){var o,r,i=e.position.x+n.position.x,a=e.position.y+n.position.y,l=null!==(o=n.measured.width)&&void 0!==o?o:0,u=null!==(r=n.measured.height)&&void 0!==r?r:0,d=t[0]*l,s=t[1]*u;return[[i-d,a-s],[i+l-d,a+u-s]]}function Ee(n){var{domNode:e,nodeId:t,getStoreItems:i,onChange:a,onEnd:l}=n,u=Object(r.a)(e);return{update:function(n){var{controlPosition:e,boundaries:r,keepAspectRatio:d,onResizeStart:c,onResize:v,onResizeEnd:h,shouldResize:f}=n,p=s({},be),g=s({},Pe),y=function(n){return{isHorizontal:n.includes("right")||n.includes("left"),isVertical:n.includes("bottom")||n.includes("top"),affectsX:n.includes("left"),affectsY:n.includes("top")}}(e),m=void 0,x=[],w=void 0,b=void 0,P=void 0,M=Object(o.a)().on("start",n=>{var e,o,r,a,{nodeLookup:l,transform:u,snapGrid:d,snapToGrid:v,nodeOrigin:h}=i();if(m=l.get(t)){var{xSnapped:f,ySnapped:y}=dn(n.sourceEvent,{transform:u,snapGrid:d,snapToGrid:v});for(var[M,E]of(p={width:null!==(e=m.measured.width)&&void 0!==e?e:0,height:null!==(o=m.measured.height)&&void 0!==o?o:0,x:null!==(r=m.position.x)&&void 0!==r?r:0,y:null!==(a=m.position.y)&&void 0!==a?a:0},g=s(s({},p),{},{pointerX:f,pointerY:y,aspectRatio:p.width/p.height}),w=void 0,m.parentId&&("parent"===m.extent||m.expandParent)&&(w=l.get(m.parentId),b=w&&"parent"===m.extent?function(n){return[[0,0],[n.measured.width,n.measured.height]]}(w):void 0),x=[],P=void 0,l))if(E.parentId===t&&(x.push({id:M,position:s({},E.position),extent:E.extent}),"parent"===E.extent||E.expandParent)){var S,I=Me(E,m,null!==(S=E.origin)&&void 0!==S?S:h);P=P?[[Math.min(I[0][0],P[0][0]),Math.min(I[0][1],P[0][1])],[Math.max(I[1][0],P[1][0]),Math.max(I[1][1],P[1][1])]]:I}null==c||c(n,s({},p))}}).on("drag",n=>{var e,{transform:t,snapGrid:o,snapToGrid:l,nodeOrigin:u}=i(),c=dn(n.sourceEvent,{transform:t,snapGrid:o,snapToGrid:l}),h=[];if(m){var{x:M,y:E,width:S,height:I}=p,z={},O=null!==(e=m.origin)&&void 0!==e?e:u,{width:N,height:T,x:H,y:C}=function(n,e,t,o,r,i,a,l){var{affectsX:u,affectsY:d}=e,{isHorizontal:s,isVertical:c}=e,v=s&&c,{xSnapped:h,ySnapped:f}=t,{minWidth:p,maxWidth:g,minHeight:y,maxHeight:m}=o,{x:x,y:w,width:b,height:P,aspectRatio:M}=n,E=Math.floor(s?h-n.pointerX:0),S=Math.floor(c?f-n.pointerY:0),I=b+(u?-E:E),z=P+(d?-S:S),O=-i[0]*b,N=-i[1]*P,T=xe(I,p,g),H=xe(z,y,m);if(a){var C=0,k=0;u&&E<0?C=ye(x+E+O,a[0][0]):!u&&E>0&&(C=me(x+I+O,a[1][0])),d&&S<0?k=ye(w+S+N,a[0][1]):!d&&S>0&&(k=me(w+z+N,a[1][1])),T=Math.max(T,C),H=Math.max(H,k)}if(l){var A=0,D=0;u&&E>0?A=me(x+E,l[0][0]):!u&&E<0&&(A=ye(x+I,l[1][0])),d&&S>0?D=me(w+S,l[0][1]):!d&&S<0&&(D=ye(w+z,l[1][1])),T=Math.max(T,A),H=Math.max(H,D)}if(r){if(s){var B=xe(I/M,y,m)*M;if(T=Math.max(T,B),a){var L=0;L=!u&&!d||u&&!d&&v?me(w+N+I/M,a[1][1])*M:ye(w+N+(u?E:-E)/M,a[0][1])*M,T=Math.max(T,L)}if(l){var Y=0;Y=!u&&!d||u&&!d&&v?ye(w+I/M,l[1][1])*M:me(w+(u?E:-E)/M,l[0][1])*M,T=Math.max(T,Y)}}if(c){var X=xe(z*M,p,g)/M;if(H=Math.max(H,X),a){var V=0;V=!u&&!d||d&&!u&&v?me(x+z*M+O,a[1][0])/M:ye(x+(d?S:-S)*M+O,a[0][0])/M,H=Math.max(H,V)}if(l){var R=0;R=!u&&!d||d&&!u&&v?ye(x+z*M,l[1][0])/M:me(x+(d?S:-S)*M,l[0][0])/M,H=Math.max(H,R)}}}S+=S<0?H:-H,E+=E<0?T:-T,r&&(v?I>z*M?S=(we(u,d)?-E:E)/M:E=(we(u,d)?-S:S)*M:s?(S=E/M,d=u):(E=S*M,u=d));var Z=u?x+E:x,j=d?w+S:w;return{width:b+(u?-E:E),height:P+(d?-S:S),x:i[0]*E*(u?-1:1)+Z,y:i[1]*S*(d?-1:1)+j}}(g,y,c,r,d,O,b,P),k=N!==S,A=T!==I,D=H!==M&&k,B=C!==E&&A;if(D||B||k||A){if((D||B||1===O[0]||1===O[1])&&(z.x=D?H:p.x,z.y=B?C:p.y,p.x=z.x,p.y=z.y,x.length>0)){var L=H-M,Y=C-E;for(var X of x)X.position={x:X.position.x-L+O[0]*(N-S),y:X.position.y-Y+O[1]*(T-I)},h.push(X)}if((k||A)&&(z.width=k?N:p.width,z.height=A?T:p.height,p.width=z.width,p.height=z.height),w&&m.expandParent){var V,R,Z=O[0]*(null!==(V=z.width)&&void 0!==V?V:0);z.x&&z.x<Z&&(p.x=Z,g.x=g.x-(z.x-Z));var j=O[1]*(null!==(R=z.height)&&void 0!==R?R:0);z.y&&z.y<j&&(p.y=j,g.y=g.y-(z.y-j))}var G=function(n){var{width:e,prevWidth:t,height:o,prevHeight:r,affectsX:i,affectsY:a}=n,l=e-t,u=o-r,d=[l>0?1:l<0?-1:0,u>0?1:u<0?-1:0];return l&&i&&(d[0]=-1*d[0]),u&&a&&(d[1]=-1*d[1]),d}({width:p.width,prevWidth:S,height:p.height,prevHeight:I,affectsX:y.affectsX,affectsY:y.affectsY}),_=s(s({},p),{},{direction:G});!1!==(null==f?void 0:f(n,_))&&(null==v||v(n,_),a(z,h))}}}).on("end",n=>{null==h||h(n,s({},p)),null==l||l()});u.call(M)},destroy:function(){u.on(".drag",null)}}}}}]);