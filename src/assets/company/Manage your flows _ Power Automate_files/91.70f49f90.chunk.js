/*! For license information please see 91.70f49f90.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{18842:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(14678),o=r(14679);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c={root:"flowListPage",commandBar:{root:n.a.commandBar,createFlowButton:"flowMenu_new_flow_menu",createNl2FlowButton:"flowMenu_new_NL2_flow_menu",searchTextField:"searchTextField",createFlowContextualMenu:{root:"createFlowContextualMenu",createAutomated:"flowMenu_create_automated",createBusinessProcessFlow:"flowMenu_create_bpf",createDesktopFlow:"flowMenu_create_desktopFlow",createFromBlank:"flowMenu_create_blank",createFromBuildYourOwnWizard:"flowMenu_create_buildYourOwnWizard",createFromNaturalLanguage:"flowMenu_create_NaturalLanguage",createFromTemplate:"flowMenu_create_template",createFromTemplateWizard:"flowMenu_create_templateWizard",createFromVisioTemplate:"flowMenu_create_visio_template",createInstant:"flowMenu_create_instant",createScheduled:"flowMenu_create_scheduled"}},suspendedFlowContactAdminMessageBar:{root:"suspendedFlowContactAdmin",submitRequestButton:"submitRequestButton",buyNowButton:"buyNowButton"},suspendedFlowContactAdminSuccessMessageBar:{root:"suspendedFlowContactAdminSuccess"},copySuccessfullyCreatedMessageBar:{root:"copySuccessfullyCreatedMessageBar"},flowList:"ListCell",flowInstallButton:"flowInstallButton",flowInstallContextualMenu:{root:"flowInstallContextualMenu",installPadLink:"installPadLink",installGatewayLink:"installGatewayLink"},tabs:{root:"desktopFlowListTabContainer",personalCloudFlowsTab:"personalCloudFlowsTab",sharedCloudFlowsTab:"sharedCloudFlowsTab",businessProcessFlowsTab:"businessProcessFlowsTab",desktopFlowsTab:"desktopFlowsTab",copilotFlowsTab:"copilotFlowsTab"},desktopFlowDetailsList:{root:"desktopFlowDetailsList",columns:o.q,desktopFlowNameAnchor:"desktopFlowNameAnchor",warningIconFlowDisplay:"warningIconFlowDisplay",desktopFlowTypeText:"desktopFlowTypeText",desktopFlowTypeTooltip:"desktopFlowTypeTooltip",accessText:"accessText",accessTooltip:"accessTooltip",accessInfoIcon:"accessInfoIcon",overflowButton:n.a.buttons.actionMenuOverflowButton,contextualMenu:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({root:n.a.contextualMenus.actionOverflowContextualMenu},n.a.buttons.desktopFlowActionButtons),desktopFlowTypeFilterContextualMenu:{root:"desktopFlowTypeFilterContextualMenu",typeFilterButton:"typeFilterButton"},desktopFlowNameSortContextualMenu:{root:"desktopFlowNameSortContextualMenu"},modificationDateSortContextualMenu:{root:"modificationDateSortContextualMenu"},accessFilterContextualMenu:{root:"accessFilterContextualMenu",ownerFilterButton:"ownerFilterButton",sharedWithMeFilterButton:"sharedWithMeFilterButton"},freeUserEmptyStates:{root:"desktopFlowListFreeUserEmptyState",startTrialButton:"startTrialButton",termsAndConditionsButton:"termsAndConditionsButton",requestButton:"requestButton",launchPadButton:"launchPadButton",downloadPadButton:"downloadPadButton"},msaUserEmptyState:{root:"desktopFlowListMsaUserEmptyState",learnMore:n.a.anchors.learnMoreAnchor,launchPadButton:"launchPadButton",downloadPadButton:"downloadPadButton"}},createDesktopFlowModals:{paidUserCreateDesktopFlowModal:{root:"paidUserCreateDesktopFlowModal",flowNameTextField:"flowNameTextField",launchPadButton:"launchPadButton",cancelButton:n.a.buttons.cancelDialogButton},sovereignUserCreateDesktopFlowModal:{root:"sovereignUserCreateDesktopFlowModal"},msaUserCreateDesktopFlowModal:{root:"msaUserCreateDesktopFlowModal",description:"msaUserDescription",launchPadButton:"launchPadButton",cancelButton:n.a.buttons.cancelDialogButton},freeUserCreateDesktopFlowModal:{root:"freeUserCreateDesktopFlowModal",description:"freeUserDescription",termsAndConditions:"termsAndConditions",termsAndConditionsLink:"termsAndConditionsLink",requestLicenseButton:"requestLicenseButton",startFreeTrialButton:"startFreeTrialButton",startTrialErrorMessage:"startTrialErrorMessage"}},saveAsModal:{root:"saveAsModal",desktopFlowNameTextField:"desktopFlowNameTextField",saveButton:"saveButton",cancelButton:"cancelButton"}}},18935:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return c}));var n=r(11766),o=r(16835),i=n.createContext(void 0);function a(e){return Object(o.a)(i,e)}var c=()=>{var e=n.useContext(i);if(!e)throw new Error("useFlowReactContext must be used within a component which is wrapped in FlowReactContext.Provider.");return e}},18950:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return c}));var n=r(11766),o=r(16835),i=n.createContext(void 0);function a(e){return Object(o.a)(i,e)}var c=()=>{var e=n.useContext(i);if(!e)throw new Error("useFlowCreatorReactContext must be used within a component which has called injectFlowCreatorContext.");return e}},18951:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n,o,i=r(11766),a=r(14337),c=r(11773),s=r(14343),l=r(18952),u=r(12728),p=r(18954);function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var w=Object(a.c)((O((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(a,e);var t,r,n,o=v(a);function a(){var e;d(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).renderIcon=()=>{var{iconUri:t,brandColor:r}=e.props.connectionReference;return i.createElement(s.a,{brandColor:r,iconUri:t,size:s.b.xLarge,cdnService:e.props.cdnService})},e.renderContent=()=>{var{clientResources:t,connectionReference:r}=e.props;return i.createElement(l.a,{connectionReference:r,clientResources:t})},e}return t=a,(r=[{key:"render",value:function(){return i.createElement(p.a,{title:this.title,onRenderIcon:this.renderIcon,onRenderContent:this.renderContent,primaryButtonProps:this.primaryButtonProps,onDismiss:this.props.dismiss})}},{key:"title",get:function(){return this.props.connectionReference.displayName||""}},{key:"primaryButtonProps",get:function(){var{clientResources:e,dismiss:t}=this.props;return{primary:!0,text:e.Common.Close,ariaLabel:e.Dialogs.ViewPermissions.Button.CloseAriaLabel,onClick:t}}}])&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.Component)).prototype,"title",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"title"),o.prototype),O(o.prototype,"primaryButtonProps",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"primaryButtonProps"),o.prototype),n=o))||n;function E(e,t,r,n){e.spawn({key:Object(u.a)("flow-connection-permission-surface"),render:e=>i.createElement(w,f({connectionReference:t,clientResources:r,cdnService:n},e))})}},18952:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(12706),i=r(18953);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(){var e;a(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=p.call(this,...r)).getClassNames=Object(o.a)(),e}return t=f,(r=[{key:"render",value:function(){return n.createElement(n.Fragment,null,this.renderDescription(),this.renderScopes())}},{key:"renderDescription",value:function(){var e=this.getClassNames(i.a);return n.createElement("p",{className:e.description},this.props.connectionReference.apiDefinition.properties.description)}},{key:"renderScopes",value:function(){return n.createElement(n.Fragment,null,this.renderScopeWill(),this.renderScopeWont())}},{key:"renderScopeWill",value:function(){var e,{clientResources:{Dialogs:{ViewPermissions:t}},connectionReference:r}=this.props,o=(null===(e=r.apiDefinition)||void 0===e||null===(e=e.properties.scopes)||void 0===e?void 0:e.will)||[],a=this.getClassNames(i.a);return o.length>0&&n.createElement("div",{className:a.scope},n.createElement("h4",null,t.ConnectionScopeWill),n.createElement("ul",null,o.map((e,t)=>n.createElement("li",{key:"will-".concat(t)},e))))}},{key:"renderScopeWont",value:function(){var e,{clientResources:{Dialogs:{ViewPermissions:t}},connectionReference:r}=this.props,o=(null===(e=r.apiDefinition)||void 0===e||null===(e=e.properties.scopes)||void 0===e?void 0:e.wont)||[],a=this.getClassNames(i.a);return o.length>0&&n.createElement("div",{className:a.scope},n.createElement("h4",null,t.ConnectionScopeWont),n.createElement("ul",null,o.map((e,t)=>n.createElement("li",{key:"wont-".concat(t)},e))))}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},18953:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({description:["fl-PermissionSurface-description"],scope:["fl-PermissionSurface-scope",{marginTop:12,selectors:{h4:{marginBottom:12}}}]})},18954:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r(12706),i=r(12811),a=r(12961),c=r(12850),s=r(18955),l=r(16813);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(v,e);var t,r,d,y=b(v);function v(){var e;p(this,v);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=y.call(this,...r)).getClassNames=Object(o.a)(),e.renderFooter=()=>{var{primaryButtonProps:t,secondaryButtonProps:r}=e.props,o=e.getClassNames(s.a);return t||r?n.createElement(c.a,{className:o.footer},t&&n.createElement(a.a,u({primary:!0},t)),r&&n.createElement(a.a,r)):null},e}return t=v,(r=[{key:"render",value:function(){var{className:e,onDismiss:t}=this.props,r=this.getClassNames(s.a);return n.createElement(l.a,{className:Object(i.a)(r.root,e),hidden:!1,onDismiss:t},this.renderHeader(),this.renderContent())}},{key:"renderHeader",value:function(){var{onRenderIcon:e,title:t}=this.props,r=this.getClassNames(s.a);return n.createElement("div",{className:r.header},n.createElement("div",null,e()),n.createElement("h2",null,t))}},{key:"renderContent",value:function(){var e=this.getClassNames(s.a);return n.createElement("div",{className:e.content},this.props.onRenderContent(),this.renderFooter())}}])&&f(t.prototype,r),d&&f(t,d),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component)},18955:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>({root:["fl-DialogWithIconHeader",{selectors:{".ms-Dialog-main":{maxWidth:504,minWidth:318,overflow:"hidden",backgroundColor:Object(n.Y)().palette.white}}}],header:["fl-DialogWithIconHeader-header",{padding:"20px 20px 0",display:"flex",selectors:{h2:{marginLeft:10,lineHeight:48,overflowWrap:"break-word"}}}],content:["fl-DialogWithIconHeader-content",{padding:20}],footer:["fl-DialogWithIconHeader-footer",{textAlign:"right"}]})},18959:function(e,t,r){"use strict";r.d(t,"e",(function(){return m})),r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return y})),r.d(t,"f",(function(){return v})),r.d(t,"i",(function(){return h})),r.d(t,"c",(function(){return O})),r.d(t,"l",(function(){return w})),r.d(t,"k",(function(){return E})),r.d(t,"g",(function(){return C})),r.d(t,"h",(function(){return S})),r.d(t,"d",(function(){return P})),r.d(t,"j",(function(){return j}));var n=r(11955),o=r.n(n),i=r(14895),a=r(14902),c=r(11891),s=r(14867),l=r(12324),u=r.n(l);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){return"/providers/Microsoft.PowerApps/apis/".concat(e,"/connections/").concat(t)}function b(e){return{properties:{connectionParameters:e}}}function y(e){return{properties:{connectionParametersSet:{name:"oAuthClientCredentials",values:f({},function(e){return u.a.reduce(e,(e,t,r)=>(e[r]={value:t},e),{})}(e))}}}}function v(e){var t=!1;return e&&(t=e.some(e=>Object(c.a)(e.status,"error"))),t}function h(e){var t=!1;return e.properties.statuses&&(t=e.properties.statuses.some(e=>function(e){return e.error&&e.error.code&&(Object(c.a)(e.error.code,i.a.Unauthenticated)||Object(c.a)(e.error.code,i.a.Unauthorized))}(e))),t}function g(e){return Object(a.b)(e).apis}function O(e){return Object(a.c)(e).apis}function w(e,t){var r=g(e);return!t.some(e=>Object(c.a)(e,r))}function E(e){return!!P(e)}function C(e){var t=e.properties;return t.statuses.length>0&&Object(c.a)(t.statuses[0].status,"connected")}function S(e){return Object(c.a)(e,"connected")}function P(e){var t=function(e){return e&&e.properties&&e.properties.connectionParameters||{}}(e);for(var r in t)if(o()(t[r])&&t[r].gatewayObjectId)return t[r].gatewayObjectId;return null}function j(e,t,r){if(Object(s.b)(t)){var n=t.properties.connectionReferences||{};return Object.keys(n).some(t=>r?n[t].connectionReferenceLogicalName===e:n[t].connectionName===e)}return!1}},18960:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(18961);function o(e){return Object(n.a)({},e)}},18961:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(18962);function o(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];if(!r)return e;for(var i of r)if(i)for(var a of Object.keys(i))e[a]=Object(n.a)(i[a]);return e}},18962:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(18963),o=r(18960);function i(e){return Array.isArray(e)?Object(n.a)(e):e instanceof Date?new Date(e.valueOf()):e&&"object"==typeof e?Object(o.a)(e):e}},18963:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(18962);function o(e){return e?e.map(e=>Object(n.a)(e)):null}},18964:function(e,t,r){"use strict";function n(e,t){return e&&t&&!e.startsWith(t)?"".concat(t).concat(e):e}r.d(t,"a",(function(){return n}))},18966:function(e,t,r){"use strict";r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return p}));var n=r(16808);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){return e.POST_CALL_FAILED="PostCallFailed",e}({}),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(s,e);var t,r,n,i=c(s);function s(e,t,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i.call(this,"Host.ServiceException",e,t,r)}return t=s,r&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.a)},18971:function(e,t,r){"use strict";r.d(t,"i",(function(){return s})),r.d(t,"j",(function(){return l})),r.d(t,"l",(function(){return u})),r.d(t,"o",(function(){return p})),r.d(t,"q",(function(){return f})),r.d(t,"r",(function(){return d})),r.d(t,"s",(function(){return m})),r.d(t,"f",(function(){return b})),r.d(t,"m",(function(){return y})),r.d(t,"a",(function(){return v})),r.d(t,"p",(function(){return h})),r.d(t,"c",(function(){return g})),r.d(t,"t",(function(){return O})),r.d(t,"g",(function(){return w})),r.d(t,"k",(function(){return E})),r.d(t,"h",(function(){return C})),r.d(t,"n",(function(){return S})),r.d(t,"e",(function(){return P})),r.d(t,"d",(function(){return j})),r.d(t,"b",(function(){return k}));var n=r(14890),o=r(18972),i=r(18974),a=r(18975),c=["builtin/as2","builtin/rosettanet"];function s(e){return!!e&&e.startsWith("/subscriptions/")}var l=e=>!c.includes(e)&&!s(e),u=e=>{var t=e.split("/");return 9===t.length&&(!!Object(a.m)(t[1],"subscriptions")&&(!!Object(a.m)(t[3],"resourcegroups")&&(!!Object(a.m)(t[5],"providers")&&(!!Object(a.m)(t[6],"microsoft.web")&&!!Object(a.m)(t[7],"customApis")))))},p=e=>{var t=e.split("/");return 11===t.length&&(!!Object(a.m)(t[1],"subscriptions")&&(!!Object(a.m)(t[3],"resourcegroups")&&(!!Object(a.m)(t[5],"providers")&&(!!Object(a.m)(t[6],"microsoft.logic")&&(!!Object(a.m)(t[7],"integrationserviceenvironments")&&!!Object(a.m)(t[9],"managedapis"))))))},f=e=>{var t=e.split("/");return 9===t.length&&(!!Object(a.m)(t[1],"subscriptions")&&(!!Object(a.m)(t[3],"providers")&&(!!Object(a.m)(t[4],"microsoft.web")&&(!!Object(a.m)(t[5],"locations")&&!!Object(a.m)(t[7],"managedapis")))))},d=e=>{var t=e.split("/");return 5===t.length&&(!!Object(a.m)(t[1],"providers")&&(!!Object(a.m)(t[2],n.d)&&(!!Object(a.m)(t[3],"apis")&&!!t[4].startsWith("shared_"))))};function m(e){var t=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&e.properties){var n=void 0!==e.properties.connectionParameterSets?b(e,t):e.properties.connectionParameters;return n?Object.keys(n||{}).filter(e=>!y(n,e,r)).map(e=>n[e]).filter(e=>Object(a.m)(e.type,t)):[]}return[]}(e,o.b.oauthSetting);return!!t&&t.length>0&&!!t[0].oAuthSettings&&!!t[0].oAuthSettings.identityProvider&&(Object(a.m)(t[0].oAuthSettings.identityProvider,"aadcertificate")||Object(a.m)(t[0].oAuthSettings.identityProvider,"aad"))}function b(e,t){for(var r of null!==(n=null===(o=e.properties)||void 0===o||null===(o=o.connectionParameterSets)||void 0===o?void 0:o.values)&&void 0!==n?n:[]){var n,o;for(var i in r.parameters)if(r.parameters[i].type===t)return r.parameters}return{}}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=h(t)&&g(e);return r===n&&E(e[t])}var v={CONFIG_ITEM_KEYS:{TOKEN_CLIENT_ID:"token:clientId",TOKEN_CLIENT_SECRET:"token:clientSecret",TOKEN_RESOURCE_URI:"token:resourceUri",TOKEN_GRANT_TYPE:"token:grantType",TOKEN_TENANT_ID:"token:tenantId"},CONFIG_ITEM_KEYS_PREFIX:"token:",GRANT_TYPE_VALUES:{CODE:"code",CLIENT_CREDENTIALS:"client_credentials"}};function h(e){return Object.values(v.CONFIG_ITEM_KEYS).map(e=>e.toLowerCase()).includes(e.toLowerCase())}function g(e){return Object(a.x)(e,v.CONFIG_ITEM_KEYS.TOKEN_CLIENT_ID)&&Object(a.x)(e,v.CONFIG_ITEM_KEYS.TOKEN_CLIENT_SECRET)&&Object(a.x)(e,v.CONFIG_ITEM_KEYS.TOKEN_RESOURCE_URI)&&Object(a.x)(e,v.CONFIG_ITEM_KEYS.TOKEN_GRANT_TYPE)&&Object(a.x)(e,v.CONFIG_ITEM_KEYS.TOKEN_TENANT_ID)}function O(e){var t;return"ManagedServiceIdentity"===(null==e||null===(t=e.authentication)||void 0===t||null===(t=t.uiDefinition)||void 0===t||null===(t=t.schema)||void 0===t||null===(t=t["x-ms-editor-options"])||void 0===t||null===(t=t.supportedAuthTypes)||void 0===t?void 0:t[0])}function w(e,t){var r=[];if(!e)return r;var{type:n,userAssignedIdentities:o}=e,c=t("Utils.SystemAssigned");if((Object(a.m)(n,i.a.SYSTEM_ASSIGNED)||Object(a.m)(n,i.a.SYSTEM_ASSIGNED_USER_ASSIGNED))&&r.push({key:"SystemAssigned_Managed_Identity",text:c}),Object(a.m)(n,i.a.USER_ASSIGNED)||Object(a.m)(n,i.a.SYSTEM_ASSIGNED_USER_ASSIGNED))for(var s of Object.keys(null!=o?o:{})){var l;r.push({key:s,text:null!==(l=s.split("/").slice(-1)[0])&&void 0!==l?l:s})}return r}var E=e=>{var t;return Object(a.m)("".concat(null==e||null===(t=e.uiDefinition)||void 0===t||null===(t=t.constraints)||void 0===t?void 0:t.hidden).trim(),"true")},C=(e,t)=>{for(var r=new Set(e.map(e=>e.split("::")[0].toLowerCase())),n=0,o=t;r.has(o.toLowerCase());)o="".concat(t,"-").concat(++n);return{name:o,index:n}},S=e=>!!e&&(Object(a.m)(e.type,i.a.SYSTEM_ASSIGNED_USER_ASSIGNED)||Object(a.m)(e.type,i.a.SYSTEM_ASSIGNED)||Object(a.m)(e.type,i.a.USER_ASSIGNED)&&!!e.userAssignedIdentities&&Object.keys(e.userAssignedIdentities).length>0);function P(e){var t,r;return(null!==(t=null==e||null===(r=e.properties)||void 0===r?void 0:r.statuses)&&void 0!==t?t:[]).filter(e=>"error"===e.status.toLowerCase())}function j(e){var t="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoJLnN0MHtmaWxsOiM0RTRGNEY7fQ0KCS5zdDF7ZmlsbDojRkZGRkZGO30NCjwvc3R5bGU+DQo8ZyBpZD0iWE1MSURfMzM4XyI+DQoJPHJlY3QgeD0iMCIgeT0iMCIgY2xhc3M9InN0MCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIi8+DQo8L2c+DQo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMTEuODgsNXY1LjVIOS4xM3Y0LjEzYzAsMy41NiwyLjcyLDYuNDksNi4xOSw2Ljg0VjI3aDEuMzd2LTUuNTNjMy40Ny0wLjM1LDYuMTktMy4yOCw2LjE5LTYuODRWMTAuNWgtMi43NVY1DQoJaC0xLjM4djUuNWgtNS41VjVIMTEuODh6IE0yMS41LDE0LjYzYzAsMy4wMy0yLjQ3LDUuNS01LjUsNS41cy01LjUtMi40Ny01LjUtNS41di0yLjc1aDExVjE0LjYzeiIvPg0KPC9zdmc+DQo=";return null!=e&&e.includes("/Content/retail/assets/default-connection-icon")?t:null!=e?e:t}var T={TOKEN_CLIENT_CERTIFICATE_SECRET:"token:clientCertificateSecret"};function k(e){return Object(a.x)(e,T.TOKEN_CLIENT_CERTIFICATE_SECRET)}},18972:function(e,t,r){"use strict";var n=r(18973);r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return n.b}))},18973:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n={blob:"blob",composite:"composite",tabular:"tabular",gateway:"gateway",cloud:"cloud",vnetgateway:"vnetgateway",general:"general"},o={array:"array",bool:"bool",clientCertificate:"clientCertificate",connection:"connection",gatewaySetting:"gatewaySetting",int:"int",managedIdentity:"managedIdentity",oauthSetting:"oauthSetting",object:"object",secureObject:"secureObject",secureString:"secureString",string:"string"}},18974:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={SYSTEM_ASSIGNED:"SystemAssigned",USER_ASSIGNED:"UserAssigned",SYSTEM_ASSIGNED_USER_ASSIGNED:"SystemAssigned, UserAssigned",NONE:"None"}},18975:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return s})),r.d(t,"m",(function(){return l})),r.d(t,"z",(function(){return u})),r.d(t,"I",(function(){return p})),r.d(t,"p",(function(){return f})),r.d(t,"t",(function(){return d})),r.d(t,"s",(function(){return m})),r.d(t,"L",(function(){return b})),r.d(t,"k",(function(){return v})),r.d(t,"j",(function(){return h})),r.d(t,"n",(function(){return g})),r.d(t,"x",(function(){return O})),r.d(t,"F",(function(){return w})),r.d(t,"A",(function(){return E})),r.d(t,"C",(function(){return C})),r.d(t,"B",(function(){return S})),r.d(t,"G",(function(){return P})),r.d(t,"D",(function(){return j})),r.d(t,"H",(function(){return T})),r.d(t,"Q",(function(){return k})),r.d(t,"e",(function(){return R})),r.d(t,"f",(function(){return x})),r.d(t,"P",(function(){return N})),r.d(t,"g",(function(){return _})),r.d(t,"q",(function(){return D})),r.d(t,"r",(function(){return I})),r.d(t,"O",(function(){return A})),r.d(t,"l",(function(){return F})),r.d(t,"h",(function(){return L})),r.d(t,"i",(function(){return M})),r.d(t,"d",(function(){return B})),r.d(t,"K",(function(){return U})),r.d(t,"y",(function(){return z})),r.d(t,"J",(function(){return G})),r.d(t,"w",(function(){return W})),r.d(t,"v",(function(){return H})),r.d(t,"o",(function(){return K})),r.d(t,"M",(function(){return q})),r.d(t,"u",(function(){return Y})),r.d(t,"E",(function(){return X})),r.d(t,"a",(function(){return Q})),r.d(t,"N",(function(){return Z}));var n=r(15883),o=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){return(e||[]).reduce((e,t)=>e.concat(t),[])}function s(e,t){return e&&t?e.length===t.length&&e.every((e,r)=>e===t[r]):e===t}function l(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return r?!(C(e)||C(t)||e.toLowerCase()!==t.toLowerCase()&&e.toUpperCase()!==t.toUpperCase()):!C(e)&&!C(t)&&e===t}function u(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return r?!C(e)&&!C(t)&&e.toLowerCase().indexOf(t.toLowerCase())>-1:!C(e)&&!C(t)&&e.indexOf(t)>-1}function p(e,t,r){return e&&0!==e.length?!r||Number.isNaN(r)||r<=1?e.lastIndexOf(t):e.lastIndexOf(t,p(e,t,r-1)-1):-1}function f(e,t){for(var r of t)if(e(r))return r}function d(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e||{};if("__proto__"===t||"constructor"===t)throw new Error("attempting to access protected properties");var o=n[t];if(void 0!==o)return o;for(var i of Object.keys(n))if(l(i,t,r))return n[i]}function m(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e||{};for(var o of t)n=d(n,o,r);return n}function b(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.includes("__proto__")||t.includes("constructor"))throw new Error("attempting to access protected properties");if(!t.length)return r;for(var o=e||{},i=o,a=0;a<t.length-1;a++){var c=i,s=t[a];"object"!=typeof(i=d(i,s))&&(i={},c[s]=i)}var u=t[t.length-1];for(var p of Object.keys(i))if(l(p,u)){u=p;break}return n?"object"==typeof i[u]&&"object"==typeof r?i[u]=y(i[u],r):"body"===u&&"object"==typeof i[u]?i[u]=y(i[u],r.properties):i[u]=r:i[u]=r,o}var y=(e,t)=>o()(e,t,{arrayMerge:(e,t,r)=>t});function v(e,t){if(t.includes("__proto__")||t.includes("constructor"))throw new Error("attempting to access protected properties");if(t.length&&e){for(var r=e,n=0;n<t.length-1;n++)if(!(r=d(r,t[n])))return;var o=t[t.length-1];o&&delete r[o]}}function h(e,t){if(t.length&&e)for(var r of t)v(e,r)}function g(e,t,r){var n=R(e);return v(n,t),m(n,r)}function O(e,t){return"object"==typeof e&&Object.keys(e).some(e=>l(e,t))}function w(e){return"string"==typeof e}function E(e){return"boolean"==typeof e}function C(e){return null==e}function S(e){return"object"==typeof e?!e||!Object.keys(e).length:!e}function P(e){return void 0===e||""===e}function j(e){return"[object Object]"===Object.prototype.toString.call(e)}function T(e,t){if(!t)throw new Error("key required");var r=e||[],n={};for(var o of r.filter(e=>Object.prototype.hasOwnProperty.call(e,t))){n[o[t]]=o}return n}function k(e,t){var r=e||{};return Object.keys(r).map(e=>{var n=r[e];return t&&(n[t]=e),n})}function R(e){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return x({copyNonEnumerableProps:!1},e,...r)}({},e)}function x(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];if(!n)return t;for(var i of n)if(i){var a=e.copyNonEnumerableProps?new Set(Object.getOwnPropertyNames(i)):Object.keys(i);for(var c of a)t[c]=L(i[c],e)}return t}function N(e){for(var t=[],r={},n=0,o=e.length;n<o;++n)Object.prototype.hasOwnProperty.call(r,e[n])||(t.push(e[n]),r[e[n]]=1);return t}function _(e,t){return e?e.map(e=>L(e,t)):null}function D(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=/\{[a-zA-Z$_\d]*\}/g,i=/\{(\d+)\}/g,a=!1,c=e;if(r&&1===r.length&&r[0]&&"object"==typeof r[0]){var s=r[0];c=e.replace(o,e=>{var t=e.substring(1,e.length-1);return Object.prototype.hasOwnProperty.call(s,t)?(a=!0,s[t]):e})}return a||(c=e.replace(i,(e,t)=>r.length>t?r[t]:e)),c}function I(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={},i=n?"".concat(e,"_").concat(r):e;for(var a of t)o[a]=!0;for(var c=r;d(o,i);)i="".concat(e,"_").concat(c++);return i}function A(e,t){var r="".concat(e);return!!r&&!!t&&l(r.substring(0,t.length),t)}function F(e,t){var r="".concat(e);return!!r&&!!t&&l(r.substr(r.length-t.length),t)}function L(e,t){return Array.isArray(e)?_(e,t):e instanceof Date?new Date(e.valueOf()):e&&"object"==typeof e?x(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({copyNonEnumerableProps:!1},t),{},e):e}function M(e,t){if(void 0===e&&void 0===t)return!0;var r=Object.keys(null!=e?e:{}),n=Object.keys(null!=t?t:{});if(r.length!==n.length||!e||!t)return!1;for(var o of r){var i=e[o],a=t[o];if(j(i)&&j(a)?!M(i,a):JSON.stringify(i)!==JSON.stringify(a))return!1}return!0}function B(e,t,r){return Math.min(Math.max(e,t),r)}function U(e){var t=document.createElement("a");t.href=e;var{pathname:r,search:n}=t;return{pathname:"/".concat(decodeURIComponent(r.replace(/(^\/+)/g,""))),queryKey:V(n)}}function V(e){var t={},r=e.slice("?"===e[0]?1:0);if(!r)return t;for(var n=/(?:^|&)([^&=]*)=?([^&]*)/g,o=n.exec(r);null!==o;){var[,i,a]=o;t[decodeURIComponent(i)]=decodeURIComponent(a),o=n.exec(r)}return t}function z(e,t){if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e)){var r=e.substring(1).split("");3===r.length&&(r=[r[0],r[0],r[1],r[1],r[2],r[2]]);var n=Number.parseInt("0x".concat(r.join("")),16);return"rgba(".concat([n>>16&255,n>>8&255,255&n].join(","),", ").concat(null!=t?t:1,")")}throw new Error("Invalid Hex color value")}function G(e,t){return void 0!==t?{[e]:t}:void 0}function W(e,t){return t.some(t=>u(e,t))}function H(e){var t,r,n,o;return null!==(t=null!==(r=null!==(n=null==e?void 0:e.name)&&void 0!==n?n:null==e||null===(o=e.properties)||void 0===o?void 0:o.name)&&void 0!==r?r:null==e?void 0:e.id)&&void 0!==t?t:""}var K=(e,t)=>{var r=Object.entries(e).filter(e=>{var[r,n]=e;return t(r,n)}),n={};return r.forEach(e=>{var[t,r]=e;return n[t]=r}),n},q=(e,t)=>{var r=Object.entries(e).sort((e,r)=>{var[n,o]=e,[i,a]=r;return t(n,o,i,a)}),n={};return r.forEach(e=>{var[t,r]=e;return n[t]=r}),n},Y=(e,t)=>{if(e&&t&&Object.prototype.hasOwnProperty.call(e,t))return e[t]},X=e=>e&&Object.keys(e).length>0,Q=(e,t)=>{for(var r=0,n=t.length-1,o=-1,i=-1;r<=n;){var a=Math.floor((r+n)/2);if(t[a]<e)i=t[a],r=a+1;else{if(!(t[a]>e)){i=t[a],o=t[a];break}o=t[a],n=a-1}}return{nextFailedRepetition:o,prevFailedRepetition:i}},Z=(e,t)=>[e.substring(0,t),e.substring(t+1)]},18986:function(e,t,r){"use strict";var n=r(17247);r.d(t,"d",(function(){return n.a})),r.d(t,"p",(function(){return n.c}));var o=r(18987);r.d(t,"b",(function(){return o.b})),r.d(t,"g",(function(){return o.f})),r.d(t,"l",(function(){return o.k})),r.d(t,"a",(function(){return o.a})),r.d(t,"m",(function(){return o.l})),r.d(t,"e",(function(){return o.d})),r.d(t,"k",(function(){return o.j})),r.d(t,"o",(function(){return o.n})),r.d(t,"q",(function(){return o.o})),r.d(t,"j",(function(){return o.i})),r.d(t,"h",(function(){return o.g})),r.d(t,"n",(function(){return o.m})),r.d(t,"i",(function(){return o.h})),r.d(t,"f",(function(){return o.e})),r.d(t,"c",(function(){return o.c}))},18987:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"f",(function(){return o})),r.d(t,"k",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"l",(function(){return c})),r.d(t,"d",(function(){return s})),r.d(t,"j",(function(){return l})),r.d(t,"n",(function(){return u})),r.d(t,"o",(function(){return p})),r.d(t,"i",(function(){return f})),r.d(t,"g",(function(){return d})),r.d(t,"m",(function(){return m})),r.d(t,"h",(function(){return b})),r.d(t,"e",(function(){return y})),r.d(t,"c",(function(){return v}));var n="$",o={ContentOnly:"contentOnly"},i={ReadOnly:"read-only",ReadWrite:"read-write"},a={ChunkTransfer:"chunkTransfer",AcceptUploadChunkSize:"acceptUploadChunkSizeInMB",MinimumUploadChunkSize:"minimumUploadChunkSizeInMB",MaximumUploadChunkSize:"maximumUploadChunkSizeInMB",AcceptDownloadChunkSize:"acceptDownloadChunkSizeInMB",MinimumDownloadChunkSize:"minimumDownloadChunkSizeInMB",MaximumDownloadChunkSize:"maximumDownloadChunkSizeInMB"},c={API:"api",METHOD:"method",RETRYPOLICY:"retryPolicy",AUTHENTICATION:"authentication",HEADERS:"headers",BODY:"body",QUERY:"query",QUERIES:"queries",PATH:"path",PATHTEMPLATE:"pathTemplate",PATHTEMPLATE_PARAMETERS:"parameters",PATHTEMPLATE_TEMPLATE:"template",HOST:"host",URI:"uri",PARAMETERS:"parameters",CONTENT_DISPOSITION:"Content-Disposition"},s={CONTENT:"contentBytes",FILENAME:"name"},l={Body:"body",FormData:"formData",Header:"header",Path:"path",Query:"query"},u={$200:"200",$201:"201",$202:"202",$203:"203",$204:"204",$205:"205",$206:"206",$207:"207",$208:"208",$226:"226",$default:"default"},p={Advanced:"advanced",Internal:"internal",Important:"important",ReadOnly:"read-only"},f={StatusCode:"statusCode",Queries:"queries",Headers:"headers",Body:"body",Outputs:"outputs"},d={Body:"key-body-output",Headers:"key-headers-output",Item:"key-item-output",Outputs:"key-outputs-output",Queries:"key-queries-output",StatusCode:"key-statuscode-output",Name:"key-name-output",Properties:"key-properties-output",PathParameters:"key-pathparameters-output"},m={ConnectionId:"connectionId"},b="key",y="byte",v={Expression:{maxExpressionLimit:8192},TokenValue:{dot:".",comma:",",leftParenthesis:"(",rightParenthesis:")",leftSquareBracket:"[",rightSquareBracket:"]",questionMark:"?",singleQuote:"'"}}},19175:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"h",(function(){return c})),r.d(t,"i",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"c",(function(){return f})),r.d(t,"a",(function(){return d})),r.d(t,"f",(function(){return m})),r.d(t,"e",(function(){return b}));var n=r(17245),o=r(13041),i=r(12333),a={NotSpecified:"NotSpecified",LegacyDynamicValues:"LegacyDynamicValues",DynamicList:"DynamicList",DynamicTree:"DynamicTree"};function c(e){return e.type===a.LegacyDynamicValues}function s(e){return c(e)&&Object(o.e)(e.extension.capability,n.a.FILE_PICKER)}function l(e){return e.type===a.DynamicList}function u(e){return e.type===a.DynamicTree}var p=i.a.object({operationId:i.a.string(),parameters:i.a.record(i.a.object({selectedItemValuePath:i.a.string().optional(),"value-property":i.a.string().optional()})),itemValuePath:i.a.string().optional(),itemTitlePath:i.a.string().optional(),itemIsParent:i.a.string().optional(),itemFullTitlePath:i.a.string().optional(),selectableFilter:i.a.string().optional()}),f=i.a.object({settings:i.a.object({canSelectParentNodes:i.a.boolean(),canSelectLeafNodes:i.a.boolean()}),open:p,browse:p,dynamicState:i.a.any().optional()}),d={NotSpecified:"NotSpecified",LegacyDynamicSchema:"LegacyDynamicSchema",DynamicProperties:"DynamicProperties"};function m(e){return e.type===d.LegacyDynamicSchema}function b(e){return e.type===d.DynamicProperties}},19199:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={Inputs:"inputs",Outputs:"outputs"}},19220:function(e,t,r){"use strict";r.d(t,"k",(function(){return n})),r.d(t,"l",(function(){return o})),r.d(t,"j",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"a",(function(){return c})),r.d(t,"w",(function(){return s})),r.d(t,"s",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"I",(function(){return p})),r.d(t,"p",(function(){return f})),r.d(t,"B",(function(){return d})),r.d(t,"z",(function(){return m})),r.d(t,"f",(function(){return b})),r.d(t,"x",(function(){return y})),r.d(t,"q",(function(){return v})),r.d(t,"D",(function(){return h})),r.d(t,"C",(function(){return g})),r.d(t,"y",(function(){return O})),r.d(t,"H",(function(){return w})),r.d(t,"F",(function(){return E})),r.d(t,"G",(function(){return C})),r.d(t,"m",(function(){return S})),r.d(t,"n",(function(){return P})),r.d(t,"r",(function(){return j})),r.d(t,"u",(function(){return T})),r.d(t,"v",(function(){return k})),r.d(t,"K",(function(){return R})),r.d(t,"J",(function(){return x})),r.d(t,"b",(function(){return N})),r.d(t,"h",(function(){return _})),r.d(t,"d",(function(){return D})),r.d(t,"t",(function(){return I})),r.d(t,"o",(function(){return A})),r.d(t,"e",(function(){return F})),r.d(t,"E",(function(){return L})),r.d(t,"i",(function(){return M})),r.d(t,"A",(function(){return B}));var n={root:"desktopFlowSelectionComponent",desktopFlowDropdown:"desktopFlowDropdown",modifyButton:"modifyButton",desktopFlowDropdownOptions:{root:"desktopFlowDropdownOptions",createNewDesktopFlowButton:"createNewDesktopFlowButton",searchTextField:"searchTextField",refreshButton:"refreshButton",option:"option"},desktopFlowTargetDropdown:"desktopFlowTargetDropdown",desktopFlowTargetDropdownOptions:{root:"desktopFlowTargetDropdownOptions",searchTextField:"searchTextField",refreshButton:"refreshButton",option:"option"}},o={root:"desktopFlowTargetSelectionComponent",desktopFlowTargetDropdown:"desktopFlowTargetDropdown",desktopFlowTargetDropdownOptions:{root:"desktopFlowTargetDropdownOptions",searchTextField:"searchTextField",refreshButton:"refreshButton",option:"option"}},i={unattendedRequirementsWarningMessage:"unattendedRequirementsWarningMessage",attendedRequirementsWarningMessage:"attendedRequirementsWarningMessage"},a={editConnection:"flow-edit-connection-container",createConnections:"flow-create-connection-container",parametersContainer:"flow-connection-parameters-container",editConnectionActions:"flow-edit-connection-actions-container",panelBody:"flow-connections-panel-body",connectionInfo:"flow-connection-info",connectionDisplay:{changeButton:"flow-change-connection-button",infoLabels:"flow-connection-info-labels"}},c={connectorLabel:"flow-panel-connector-label",connectorName:"flow-panel-connector-name",aboutName:"flow-panel-about-name",description:"flow-panel-description",descriptionLabel:"flow-panel-description-label",aboutDescription:"flow-panel-about-description",aboutContainer:"flow-panel-about-container",tags:"flow-panel-tags",tagsLabel:"flow-panel-tags-label",aboutTags:"flow-panel-about-tags"},s={header:"flow-panel-header",contents:"flow-panel-contents",moreButton:"flow-panel-header-more-options",closeButton:"flow-panel-header-close",collapseButton:"flow-panel-header-collapse-nav",aiFlowsRunHistoryButton:"flow-panel-header-aiFlowsRunHistory-button",cardTitleContainer:"flow-panel-card-title-container",actionHeader:"flow-app-action-header",contentContainer:"flow-panel-content-container",containerNested:"flow-panel-container-nested",menu:"flow-panel-menu",inputsOutputsHeader:"flow-trace-inputs-outputs-header",inputsOutputs:"flow-trace-inputs-outputs",displayName:"flow-trace-value-display-name",label:"flow-trace-value-label",nodeDetailsPanel:"flow-node-details-panel"},l={selectionBox:"flow-selection-box"},u={canvas:"flow-designer-canvas"},p={tools:"flow-designer-tools"},f={errorCard:{errorCard:"flow-error-card"},errorCategory:{title:"flow-error-category-title"},errorBanner:{cardError:"flow-panel-card-error",rootError:"msla-panel-root-Error"}},d={searchBoxInput:"flow-search-box"},m={connectorSummary:{display:"flow-connector-summary-display",image:"flow-connector-summary-image"},searchList:"flow-result-list"},b={option:"flow-combobox-option",comboboxes:"flow-combobox",container:"flow-combobox-container",customOption:"flow-combobox-custom-option",loading:"flow-combobox-loading"},y={inputLabel:"flow-input-parameter-label",inputError:"flow-input-parameter-error"},v={editorContainer:"flow-filepicker-editor-container",body:"flow-filepicker-body",item:"flow-filepicker-item",itemSplit:"flow-filepicker-item-split",itemSplitChevron:"flow-filepicker-item-split-chevron"},h={settingSection:"flow-setting-section-settings",settingSliderBar:"flow-setting-slider",settingSliderInput:"flow-setting-slider-input"},g={addAllButton:"flow-add-all-button",removeAllButton:"flow-remove-all-button",searchableDropdown:"flow-searchable-dropdown-with-buttons"},O={recurrenceDescription:"flow-recurrence-friendly-desc"},w={container:"flow-token-picker",addOrUpdateButton:"flow-token-picker-expression-addorupdate-button",header:{close:"flow-token-picker-header-close",container:"flow-token-picker-header",paste:"flow-token-picker-header-paste",info:"flow-token-picker-header-info",expand:"flow-token-picker-header-expand"},expressionEditor:"flow-expression-editor",expressionEditorContainer:"flow-expression-editor-container",pickerSection:"flow-token-picker-section",pickerSections:"flow-token-picker-sections",search:"flow-token-picker-search",entryPointButtonExpression:"flow-token-picker-entrypoint-button-expression",entryPointButtonContainer:"flow-token-picker-entrypoint-button-container",entryPointButtonDynamicContent:"flow-token-picker-entrypoint-button-dynamic-content",sectionHeaderButton:"flow-token-picker-section-header-button",sectionOption:"flow-token-picker-section-option",footer:"flow-token-picker-footer",optionTitle:"flow-token-picker-option-title"},E={inputToken:"flow-token flow-input-token",delete:"flow-token-delete"},C={htmlEditor:"flow-setting-token-editor-htmleditor",combobox:"flow-setting-token-editor-combobox",stringEditor:"flow-setting-token-editor-stringeditor",filepickerEditor:"flow-setting-token-editor-filepickereditor",floatingActionMenuOutputs:"flow-setting-token-editor-floatingActionMenuOutputs",arrayEditor:"flow-setting-token-editor-arrayeditor",dictionaryEditor:"flow-setting-token-editor-dictionaryeditor",dropdownEditor:"flow-setting-token-editor-dropdowneditor",tableEditor:"flow-setting-token-editor-tableEditor",cityToken:"flow-input-token-City"},S={container:"flow-dictionary-editor-container",containerExpanded:"flow-dictionary-editor-container-expanded",collapsed:"flow-dictionary-editor-collapsed",item:"flow-dictionary-editor-item",itemDelete:"flow-dictionary-item-delete"},P={container:"flow-dropdown-editor-container"},j={addInputMenuButton:"flow-floating-action-menu-add-input-button",menuItems:"flow-menu-item-logo",param:{textField:"flow-dynamic-added-param-value-TextField",value:"flow-dynamic-added-param-value",title:"flow-dynamic-added-param-title",container:"flow-dynamic-added-param-container",footer:"flow-dynamic-added-param-footer",description:"flow-dynamic-added-param-description",icon:"flow-dynamic-added-param-icon",inputsContainer:"flow-dynamic-added-param-inputs-container",menuContainer:"flow-dynamic-add-param-menu-container"},paramsContainer:"flow-dynamic-added-params-container",items:{allItems:"flow-floating-action-menu-items",close:"flow-floating-action-menu-items-close",container:"flow-floating-action-menu-items-container"}},T={container:"flow-op-group-detail-page",header:"flow-op-group-header",operationGroupTitle:"flow-op-group-title",itemContainer:"flow-op-group-item-container",subHeader:"flow-sub-heading-container",seeMoreButton:"flow-op-group-see-more-button"},k={result:"flow-op-search-result"},R={rawButton:"flow-show-raw-button"},x={downloadLink:"flow-trace-download-link"},N={container:"flow-array-editor-container",item:"flow-array-item",label:"flow-array-editor-label",containerExpanded:"flow-array-editor-container-expanded"},_={menuOption:"flow-copy-menu-option"},D={title:"flow-card-title",headerMenuButton:"flow-card-header-menu-button",openPanelButton:"flow-card-header-open-panel-button",openMenuButton:"flow-card-header-open-menu-button"},I={toolbar:"flow-html-editor-toolbar"},A={button:"flow-editor-toggle-button",input:"flow-editor-input"},F={menuOption:"flow-code-view-menu-option"},L={menuOption:"flow-setting-menu-option"},M={menuOption:"flow-delete-menu-option"},B={menuOption:"flow-rename-menu-option"}},19292:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i}));var n=e=>{switch(e.toUpperCase()){case"ACTIONS":case"ACTIONOUTPUTS":case"ACTIONBODY":case"OUTPUTS":case"BODY":case"MULTIPARTBODY":case"FORMDATAMULTIVALUES":case"FORMDATAVALUE":return!0;default:return!1}},o=e=>{switch(e.toUpperCase()){case"TRIGGER":case"TRIGGEROUTPUTS":case"TRIGGERBODY":case"TRIGGERFORMDATAVALUE":case"TRIGGERMULTIPARTBODY":case"TRIGGERFORMDATAMULTIVALUES":return!0;default:return!1}},i=e=>{switch(e.toUpperCase()){case"ITEM":case"ITEMS":case"ITERATIONINDEXES":return!0;default:return!1}}},19684:function(e,t,r){"use strict";r.d(t,"n",(function(){return I})),r.d(t,"m",(function(){return A})),r.d(t,"i",(function(){return F})),r.d(t,"s",(function(){return B})),r.d(t,"k",(function(){return U})),r.d(t,"a",(function(){return z})),r.d(t,"b",(function(){return H})),r.d(t,"c",(function(){return K})),r.d(t,"d",(function(){return q})),r.d(t,"e",(function(){return Y})),r.d(t,"f",(function(){return Q})),r.d(t,"g",(function(){return Z})),r.d(t,"h",(function(){return J})),r.d(t,"j",(function(){return $})),r.d(t,"l",(function(){return te})),r.d(t,"o",(function(){return ne})),r.d(t,"p",(function(){return oe})),r.d(t,"q",(function(){return ie})),r.d(t,"r",(function(){return ae}));var n=r(19685),o=r(14885),i=r(14884),a=r(14888),c=r(19686),s=r(13010),l=r(19687),u=r(11892),p=r(12327),f=r(12331),d=r(14890),m=r(12372),b=r(12373),y=r(14889),v=r(17246),h=r(19688),g=r(19689),O=r(13156),w=r(17247),E=r(14838),C=r(12324),S=r(19690),P=r(19692),j=["brandColor","id","isBuiltIn","isHybrid","name"],T=["connectionParameters","connectionParameterSets","iconBrandColor"];function k(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function D(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){_(i,n,o,a,c,"next",e)}function c(e){_(i,n,o,a,c,"throw",e)}a(void 0)}))}}var I=(e,t)=>!!e&&(Object(a.d)(e,t)||V(e)||ne(e,t)),A=(e,t)=>!!Object(S.d)(e,t)||(!!Object(S.b)(e)||Object(S.e)(e));function F(e,t){return L.apply(this,arguments)}function L(){return(L=D((function*(e,t){var r,o,i,a,f,m,b=e.type.toLowerCase(),v=e.kind;if(V(b)){var h;if(null!==(h=e.inputs)&&void 0!==h&&h.host)return{connectorId:e.inputs.host.apiId,operationId:e.inputs.host.operationId};throw new l.a("Unsupported Api operation type '".concat(e.type,"' with undefined inputs host"))}var g=null===(r=e.inputs)||void 0===r||null===(r=r.host)||void 0===r?void 0:r.connection;if(g){var w,E,C=g.name,S=(null===(w=e.inputs)||void 0===w||null===(w=w.operationId)||void 0===w?void 0:w.toLocaleUpperCase())||(null===(E=e.inputs)||void 0===E||null===(E=E.host.operationId)||void 0===E?void 0:E.toLocaleUpperCase()),P=Object(p.k)(g)?g:M(C);if(S&&P&&Object.values(y.a).some(e=>e.includes(P))){var j=y.a[P.toLocaleUpperCase()];if(Object.values(y.c).includes(S))return{connectorId:j,operationId:S};if(Object.keys(y.c).includes(S))return{connectorId:j,operationId:y.c[S]}}}if(!v){var T=n.a[b];if(T)return T}switch(b){case d.e.expression:switch(v){case d.c.ADDTOTIME:case d.c.CONVERTTIMEZONE:case d.c.CURRENTTIME:case d.c.GETFUTURETIME:case d.c.GETPASTTIME:case d.c.SUBTRACTFROMTIME:return{connectorId:d.a.DATETIME,operationId:v};case d.c.INDEXOF:case d.c.SUBSTRING:return{connectorId:d.a.TEXTFUNCTIONS,operationId:v};case d.c.FORMATNUMBER:return{connectorId:d.a.NUMBERFUNCTIONS,operationId:v};case d.c.AIBUILDERPREDICT:return{connectorId:d.a.AIBUILDER,operationId:v};default:throw new l.a("Unsupported operation kind '".concat(v,"' for expression type"))}case d.e.http:return{connectorId:d.a.HTTP,operationId:null!==(o=e.inputs)&&void 0!==o&&null!==(o=o.metadata)&&void 0!==o&&o.apiDefinitionUrl&&Object(u.a)(null===(i=e.inputs)||void 0===i||null===(i=i.metadata)||void 0===i?void 0:i.swaggerSource,"custom")?t?d.c.HTTPSWAGGERTRIGGER:d.c.HTTPSWAGGER:t?d.c.HTTPTRIGGER:d.c.HTTP};case d.e.httpwebhook:return{connectorId:d.a.HTTP,operationId:t?d.c.HTTPWEBHOOKTRIGGER:d.c.HTTPWEBHOOK};case d.e.response:switch(v){case O.c.HTTP:return{connectorId:d.a.REQUEST,operationId:d.c.RESPONSE};case O.c.POWERAPP:return{connectorId:d.a.POWERAPPS,operationId:d.c.POWERAPPSRESPONSE};case d.a.POWERPAGES:return{connectorId:d.a.POWERPAGES,operationId:d.c.POWERPAGESRESPONSE};case d.a.SKILLS:return{connectorId:d.a.SKILLS,operationId:d.c.SKILLSRESPONSE};case d.a.VIRTUALAGENT:return{connectorId:d.a.VIRTUALAGENT,operationId:d.c.VIRTUALAGENTRESPONSE};case d.a.TEAMS:return{connectorId:d.a.SHARED_TEAMS,operationId:d.c.TEAMSTASKMODULERESPONSE};default:throw new l.a("Unsupported operation kind ".concat(v," for response type"))}case d.e.request:switch(v){case O.c.BUTTON:return{connectorId:d.a.FLOW,operationId:d.c.FLOWBUTTON};case O.c.HTTP:return{connectorId:d.a.REQUEST,operationId:d.c.REQUEST};case O.c.POWERAPP:return{connectorId:d.a.POWERAPPS,operationId:d.c.POWERAPPSBUTTON};case O.c.POWERAPPV2:return{connectorId:d.a.POWERAPPS,operationId:d.c.POWERAPPSBUTTONV2};case O.c.SKILLS:return{connectorId:d.a.SKILLS,operationId:d.c.SKILLSBUTTON};case O.c.TEAMSWEBHOOK:return{connectorId:d.a.TEAMS,operationId:d.c.TEAMSINCOMINGWEBHOOKTRIGGER};case O.c.VIRTUALAGENT:return{connectorId:d.a.VIRTUALAGENT,operationId:d.c.VIRTUALAGENTTRIGGER};default:throw new l.a("Unsupported operation kind ".concat(v," for request type"))}case d.e.table:switch(null===(a=e.inputs)||void 0===a||null===(a=a.format)||void 0===a?void 0:a.toLowerCase()){case"csv":return{connectorId:d.a.DATAOPERATION,operationId:d.c.TABLECSV};case"html":return{connectorId:d.a.DATAOPERATION,operationId:d.c.TABLEHTML};default:throw new l.a("Unsupported table format ".concat(null===(f=e.inputs)||void 0===f?void 0:f.format," for table type"))}case d.e.wait:return{connectorId:d.a.SCHEDULE,operationId:null!==(m=e.inputs)&&void 0!==m&&m.until?d.c.DELAYUNTIL:d.c.DELAY};default:throw new c.a(s.b.NotManifestBasedOperation,"[V3] operationManifestService.helper.getOperationInfo: Operation info shouldn't be retrieved from operation manifest for non-manifest based operation type '".concat(e.type,"'."))}}))).apply(this,arguments)}function M(e){var t="@parameters('$connections')['",r=e.indexOf(t),n=e.indexOf("']['connectionId']",r+t.length);if(-1!==r&&-1!==n){var o=e.substring(r+t.length,n).split(/[_-]/);if(o.length>=2)return"".concat(o[0],"_").concat(o[1])}return null}function B(e){var t=e.toUpperCase();return Object(f.b)(t,d.c)?d.c[t].toLowerCase():e}var U=(e,t)=>{var r=Object(i.a)(e),n=Object(a.c)(r,t);return"".concat(n?r.toLowerCase():e.toLowerCase(),"-").concat(t.toLowerCase())};function V(e){return e.toLowerCase()in h.a}var z=e=>{var t,r={externalDocs:e.externalDocs},n={properties:x(x({},e),{},{actions:e.actions,connection:{required:!!e.connectionReference},connector:e.connector?Q(e.connector,r):void 0,inputs:e.inputsDefinition,inputsLocation:null!==(t=e.inputsLocation)&&void 0!==t?t:e.forBuiltin?void 0:["inputs","parameters"],outputs:e.responsesDefinition&&e.responsesDefinition[Object.keys(e.responsesDefinition)[0]]||e.outputsDefinition,settings:ee(e),recurrence:e.trigger?re(e.operationType,e.recurrence):void 0,outputsSchema:e.outputsSchema})};return Object(P.a)(n),G(n),W(n),n},G=e=>{var t=e.properties.inputs,r=null!=t&&t.properties?Object.values(t.properties):void 0;if(r)for(var n of r)n.type===w.c.Object&&n.properties&&delete n.title},W=e=>{var t=e.properties.inputs;t&&t.properties&&0===Object.keys(t.properties).length&&delete e.properties.inputs},H=(e,t)=>{if(Object(u.a)(e.id,b.a.connectorId)&&e.properties.connectionParameterSets){var{enableDesktopFlowConnectivityVNext:r,enableDirectConnectivity:n}=null!=t?t:{};if(n||r){var o=e.properties.connectionParameterSets.values;if(o){var i=o.findIndex(e=>e.name===b.a.connectionParametersSetName.onPremisesDataGateway);-1!==i&&o.splice(i,1)}}else delete e.properties.connectionParameterSets}},K=e=>{var t;return{connectorId:null!==(t=e.apiId)&&void 0!==t?t:"",operationId:e.operationId}},q=(e,t)=>{var r;return null!=e&&null!==(r=e.properties)&&void 0!==r&&r.annotation&&Object(u.a)(e.properties.annotation.status,g.a.Preview)?t.preview:void 0},Y=e=>{var{brandColor:t,id:r,isBuiltIn:n,isHybrid:o,name:i}=e;return{id:r,name:i,properties:x({description:"",iconBrandColor:t},k(e,j)),type:X(r)}},X=e=>{var t=e.split("/");return t.pop(),t.join("/")},Q=(e,t)=>{var{properties:{connectionParameters:r,connectionParameterSets:n,iconBrandColor:o}}=e,i=k(e.properties,T),a=x(x({},e),{},{properties:x(x({},i),{},{displayName:e.properties.displayName||"",iconUri:e.properties.iconUri||"",description:e.properties.description})});return null!=t&&t.externalDocs&&(a.properties.externalDocs=t.externalDocs),o&&(a.properties.brandColor=o),r&&(a.properties.connectionParameters=Object(P.d)(r)),n&&(a.properties.connectionParameterSets=Object(P.c)(n)),a},Z=(e,t,r)=>{if(e){var n=e.default,o=n&&1===Object.keys(e).length,i={properties:{body:{description:r.defaultBodyDescription,title:r.defaultBodyTitle,type:w.c.Object,[w.a.Alias]:"body"},headers:{description:r.defaultHeadersDescription,title:r.defaultHeadersTitle,type:w.c.Object,[w.a.Alias]:"headers"},statusCode:{description:r.defaultStatusCodeDescription,title:r.defaultStatusCodeTitle,type:w.c.Number,[w.a.Alias]:"statusCode"}},type:w.c.Object},a={keyPath:["statusCode"],schemas:Object(C.cloneDeep)(e),defaultSchema:o||!n?i:n};if(o)for(var c=200;c<299;c++)a.schemas[c]=n;return Object(u.a)(t,E.a.OpenApiConnectionWebhook)?void 0:a}},J=(e,t)=>Object(S.e)(e)?{referenceKeyFormat:o.a.OpenApi}:e&&ne(e,t)?{referenceKeyFormat:o.a.HybridTrigger}:void 0,$=e=>{var t;if(e.properties.allowedChildOperations)return[{allowedOperations:null===(t=e.properties.allowedChildOperations)||void 0===t?void 0:t.map(K),executionOrder:Object(u.a)(e.properties.operationType,E.a.Changeset)?o.d.Parallel:o.d.Sequential,allowedSettings:void 0,isOptional:!0}]},ee=e=>{var{forBuiltin:t,operationType:r,pageable:n,isChunkingSupported:i,connector:a}=e;if(t&&e.settings)return e.settings;var c={concurrency:{scopes:[o.h.Trigger]},trackedProperties:{scopes:[o.h.Action]},correlation:{scopes:[o.h.Trigger]},timeout:{scopes:[o.h.Action]}};n&&(c.paging={scopes:[o.h.Action]}),i&&(c.chunking={scopes:[o.h.Action]}),(null==a?void 0:a.id)===m.b&&(c.invokerConnection={scopes:[o.h.Trigger]}),Object(u.a)(r,d.e.request)||Object(u.a)(r,d.e.recurrence)||(c.retryPolicy={scopes:[o.h.Trigger,o.h.Action]});var s=!1,l=!1;return t?(s=oe(r),l=ie(r)):l=s=ae(r),(s||l)&&(c.secureData={scopes:[o.h.Action],options:l?{outputsMode:te(t,r)}:void 0}),c},te=(e,t)=>{if(e)switch(t.toLowerCase()){case v.a.TYPE.COMPOSE:case v.a.TYPE.PARSE_JSON:case v.a.TYPE.RESPONSE:return o.f.LinkedToInputs;default:return}},re=(e,t)=>t||(Object(u.a)(e,d.f.OpenApiConnection)||Object(u.a)(e,d.f.ApiConnection)?{type:o.g.Basic}:void 0),ne=(e,t)=>e.toLowerCase()===d.e.request&&Object(u.a)(t,d.f.ApiConnection),oe=e=>![v.a.TYPE.APPEND_TO_ARRAY_VARIABLE,v.a.TYPE.APPEND_TO_STRING_VARIABLE,v.a.TYPE.DECREMENT_VARIABLE,v.a.TYPE.FOREACH,v.a.TYPE.IF,v.a.TYPE.INCREMENT_VARIABLE,v.a.TYPE.INITIALIZE_VARIABLE,v.a.TYPE.RECURRENCE,v.a.TYPE.SCOPE,v.a.TYPE.SET_VARIABLE,v.a.TYPE.SWITCH,v.a.TYPE.TERMINATE,v.a.TYPE.UNTIL].some(t=>t===e.toLowerCase()),ie=e=>![v.a.TYPE.APPEND_TO_ARRAY_VARIABLE,v.a.TYPE.APPEND_TO_STRING_VARIABLE,v.a.TYPE.COMPOSE,v.a.TYPE.DECREMENT_VARIABLE,v.a.TYPE.FOREACH,v.a.TYPE.IF,v.a.TYPE.INCREMENT_VARIABLE,v.a.TYPE.INITIALIZE_VARIABLE,v.a.TYPE.PARSE_JSON,v.a.TYPE.RECURRENCE,v.a.TYPE.RESPONSE,v.a.TYPE.SCOPE,v.a.TYPE.SET_VARIABLE,v.a.TYPE.SWITCH,v.a.TYPE.TERMINATE,v.a.TYPE.UNTIL,v.a.TYPE.WAIT].some(t=>t===e.toLowerCase()),ae=e=>Object(u.a)(e,O.e.openapiconnectionwebhook)||Object(u.a)(e,O.e.openapiconnection)},19685:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(14890),o={[n.e.if]:{connectorId:n.a.CONTROL,operationId:n.c.IF},[n.e.foreach]:{connectorId:n.a.CONTROL,operationId:n.c.FOREACH},[n.e.until]:{connectorId:n.a.CONTROL,operationId:n.c.UNTIL},[n.e.scope]:{connectorId:n.a.CONTROL,operationId:n.c.SCOPE},[n.e.switch]:{connectorId:n.a.CONTROL,operationId:n.c.SWITCH},[n.e.terminate]:{connectorId:n.a.CONTROL,operationId:n.c.TERMINATE},[n.e.recurrence]:{connectorId:n.a.SCHEDULE,operationId:n.c.RECURRENCE},[n.e.join]:{connectorId:n.a.DATAOPERATION,operationId:n.c.JOIN},[n.e.query]:{connectorId:n.a.DATAOPERATION,operationId:n.c.QUERY},[n.e.parsejson]:{connectorId:n.a.DATAOPERATION,operationId:n.c.PARSEJSON},[n.e.select]:{connectorId:n.a.DATAOPERATION,operationId:n.c.SELECT},[n.e.initializevariable]:{connectorId:n.a.VARIABLE,operationId:n.c.INITIALIZEVARIABLE},[n.e.incrementvariable]:{connectorId:n.a.VARIABLE,operationId:n.c.INCREMENTVARIABLE},[n.e.decrementvariable]:{connectorId:n.a.VARIABLE,operationId:n.c.DECREMENTVARIABLE},[n.e.setvariable]:{connectorId:n.a.VARIABLE,operationId:n.c.SETVARIABLE},[n.e.appendtoarrayvariable]:{connectorId:n.a.VARIABLE,operationId:n.c.APPENDTOARRAYVARIABLE},[n.e.appendtostringvariable]:{connectorId:n.a.VARIABLE,operationId:n.c.APPENDTOSTRINGVARIABLE},[n.e.workflow]:{connectorId:n.a.FLOWSBUILTIN,operationId:n.c.RUNCHILDFLOW},[n.e.compose]:{connectorId:n.a.DATAOPERATION,operationId:n.c.COMPOSE}}},19686:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(13013),o=r(13011);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(l,e);var t,r,n,a=s(l);function l(e,t,r,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.call(this,o.a.Assertion,t,e,n,r)}return t=l,r&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.a)},19687:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(13013);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(s,e);var t,r,n,i=c(s);function s(e,t,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i.call(this,"Common.UnsupportedException",e,t,r)}return t=s,r&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.a)},19688:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={changeset:"changeset",openapiconnection:"openapiconnection",openapiconnectionnotification:"openapiconnectionnotification",openapiconnectionwebhook:"openapiconnectionwebhook"}},19689:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={Preview:"Preview"}},19692:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"d",(function(){return m})),r.d(t,"c",(function(){return b}));var n=r(19693),o=r(17247);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=e=>{l(e.properties.inputs,!0,!0,!0),l(e.properties.outputs,!1,void 0,!0)},l=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&(p(e,n),d(e,!!r,n),f(e,t),u(e,t,!!r,n))},u=(e,t,r,n)=>{if(e.properties)for(var o of Object.keys(e.properties)){var i=e.properties[o];l(i,t,r,n)}e.items&&l(e.items,t,r,n)},p=(e,t)=>{var r=e[o.a.DynamicList];if(r){var n=r.dynamicState?r.dynamicState:r;e[o.a.DynamicList]={builtInOperation:r.builtInOperation,itemValuePath:r.itemValuePath,dynamicState:t?a(a({},n),{},{schemaAlias:e[o.a.Alias]}):n,parameters:y(r)}}},f=(e,t)=>{var r=e[o.a.DynamicProperties];if(r){var n=r.dynamicState?r.dynamicState.extension:r;e[o.a.DynamicProperties]={dynamicState:{extension:n,isInput:t,schemaAlias:e[o.a.Alias]},parameters:y(r)}}},d=(e,t,r)=>{var n=e[o.a.DynamicTree];if(n){var i=n.dynamicState?n.dynamicState.extension:n;e[o.a.DynamicTree]={dynamicState:r?{dynamicExtension:i,schemaAlias:e[o.a.Alias]}:{dynamicExtension:i},settings:n.settings,open:a(a({},t?n.open:{}),{},{parameters:y(n.open)}),browse:a(a({},t?n.browse:{}),{},{parameters:y(n.browse)})}}},m=e=>{var t={};return Object.keys(e).forEach(r=>{var o,i,c=e[r];t[r]=a(a({},c),{},{uiDefinition:c.uiDefinition?{description:c.uiDefinition.description||"",displayName:c.uiDefinition.displayName||"",schema:a({},c.uiDefinition.schema),constraints:c.uiDefinition.constraints?a(a({},c.uiDefinition.constraints),{},{required:null!==(o=c.uiDefinition)&&void 0!==o&&null!==(o=o.constraints)&&void 0!==o&&o.required?Object(n.a)(c.uiDefinition.constraints.required):void 0,hidden:null!==(i=c.uiDefinition)&&void 0!==i&&null!==(i=i.constraints)&&void 0!==i&&i.hidden?Object(n.a)(c.uiDefinition.constraints.hidden):void 0}):void 0,credentialMapping:c.uiDefinition.credentialMapping?a({},c.uiDefinition.credentialMapping):void 0}:void 0,oAuthSettings:c.oAuthSettings?{clientId:c.oAuthSettings.clientId||"",identityProvider:c.oAuthSettings.identityProvider,redirectUrl:c.oAuthSettings.redirectUrl||"",scopes:c.oAuthSettings.scopes||[],properties:c.oAuthSettings.properties}:void 0})}),t},b=e=>{var t=[];return e.values.forEach((e,r)=>{var n={},o=m(e.parameters);Object.keys(o).forEach(e=>{var t,r,i,a,c,s=o[e];n[e]={type:s.type,uiDefinition:{description:(null===(t=s.uiDefinition)||void 0===t?void 0:t.description)||"",displayName:(null===(r=s.uiDefinition)||void 0===r?void 0:r.displayName)||"",schema:null===(i=s.uiDefinition)||void 0===i?void 0:i.schema,constraints:null===(a=s.uiDefinition)||void 0===a?void 0:a.constraints,credentialMapping:null===(c=s.uiDefinition)||void 0===c?void 0:c.credentialMapping},managedIdentitySettings:s.managedIdentitySettings,oAuthSettings:s.oAuthSettings,gateway:s.gateway}}),t[r]={name:e.name,uiDefinition:e.uiDefinition?e.uiDefinition:{displayName:"",description:""},parameters:n}}),{uiDefinition:e.uiDefinition?e.uiDefinition:{displayName:"",description:""},values:t}},y=e=>{var t={};if(e.parameters)for(var r of Object.keys(e.parameters)){var n=e.parameters[r];if(n.parameterReference){var{parameterReference:o="",required:i}=n;t[r]={parameterReference:o,required:i},void 0===n.required&&(t[r].required=!1)}}return t}},19693:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12327),o=e=>{if(Object(n.k)(e))return"true"===e.toLowerCase().trim()?"true":"false"}},19702:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=new RegExp("^(https?:\\/\\/)?(\\w+:\\w+@)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)*([a-z\\d]([a-z\\d-]*[a-z\\d])*)|((\\d{1,3}\\.){3}\\d{1,3})|(localhost))(\\:\\d+)?(\\/[-a-z\\d%_.~+\\:]*)*(\\?[;&a-z\\d%_.~+=\\:\\/-]*)?(\\#[-a-z\\d_]*)?$","i");function o(e){return!!e&&n.test(e)}},19712:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(14751),o=r.n(n),i=r(19713);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._options=void 0,this._isXrmConnectionReferenceMode=void 0,this._editorContext=Object(i.a)(),!t.config)throw new Error("options.config not specified");this._options=t,this._isXrmConnectionReferenceMode=r}var t,r,n;return t=e,(r=[{key:"config",get:function(){return this._options.config}},{key:"getAntaresResourceBaseUri",value:function(){throw new Error("Not implemented for PowerApps")}},{key:"getApiOperationsUrl",value:function(){return this.config.apiOperationsPath}},{key:"getConfirmConsentCodeUri",value:function(e){return"".concat(e,"/confirmConsentCode")}},{key:"getConnectionProvider",value:function(){return this.config.connectionProvidersPath}},{key:"getConnectionUri",value:function(){return this.config.connectionsPath}},{key:"getConnectionId",value:function(e,t){return"".concat(t,"/connections/").concat(e)}},{key:"getConsentLinkUri",value:function(e){return"".concat(e,"/getConsentLink")}},{key:"getCustomConnectorsUri",value:function(){throw new Error("No custom connectors for PowerApps")}},{key:"getGatewaysPath",value:function(){return this.config.gatewaysPath}},{key:"getInstallGatewayLink",value:function(){return"https://go.microsoft.com/fwlink/?LinkID=820580&clcid=0x409"}},{key:"getFlowsConnectorPath",value:function(){return this.config.flowsConnectorPath}},{key:"getFlowsPath",value:function(){return this.config.flowsPath}},{key:"getListConnectionsUri",value:function(e){return"".concat(e,"/connections")}},{key:"getLocation",value:function(){throw new Error("No location for PowerApps")}},{key:"getQueryForApiOperations",value:function(e,t,r){var n={$filter:e,"api-version":r};return null!==this._options.visibleHideKeys&&void 0!==this._options.visibleHideKeys&&(n.visibleHideKeys=this._options.visibleHideKeys.join(",")),n}},{key:"getQueryForListConnections",value:function(e){return{"api-version":e}}},{key:"getResourceGroup",value:function(){throw new Error("No resource group for PowerApps")}},{key:"getSubscriptionId",value:function(){throw new Error("No subscription ID for PowerApps")}},{key:"getUriForDynamicCalls",value:function(e,t,r,n){var i=e.ConnectorStore.getConnectorRuntimeEndpoint(t),a=o()(e.ConnectionsStore.getConnectionById(n)),c=n;if(this._isXrmConnectionReferenceMode&&(c=this.getConnectionIdFromDesignerConnectionId(n),a&&(a.id=c,a.name=this.getConnectionNameFromId(c))),this._options.allowCoauthoring||this._options.enableProxyForAllFlows){var s=e.ConnectorStore.getConnector(t);return this._options.getUriForDynamicCalls({connectionProvider:s,connection:a})}var l=a?a.name:this.getConnectionNameFromId(c);return"".concat(i,"/").concat(l)}},{key:"serializeConnectionId",value:function(e){return e}},{key:"deserializeConnectionId",value:function(e){return e}},{key:"getConnectionNameFromId",value:function(e){return e.substr(e.lastIndexOf("/")+1)}},{key:"getConnectionIdFromDesignerConnectionId",value:function(e){if(this._isXrmConnectionReferenceMode){var t=this._editorContext.designerConnectionStore.getConnectionIdFromDesignerConnectionId(e);return t||e}return e}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},19713:function(e,t,r){"use strict";function n(){return window._designerEditorContext}function o(e){window._designerEditorContext=e}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}))},19716:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(11766),o=n.createContext(void 0),i=()=>{var e=n.useContext(o);if(!e)throw new Error("useDesignerReactContext must be used within a component which is wrapped in DesignerReactContext.Provider.");return e}},19719:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12330);function o(e){return!!(!Object(n.a)(e)&&Array.isArray(e)&&e.length>0)}},19720:function(e,t,r){"use strict";function n(e){return!!e.match(/@environmentVariables\(".*"\)+/)}function o(e){return!(!e.connectionParameters||!Object.values(e.connectionParameters).some(e=>!!e&&"string"==typeof e&&n(e)))||!(!e.connectionParametersSet||!Object.values(e.connectionParametersSet.values).some(e=>{var{value:t}=e;return!!t&&"string"==typeof t&&n(t)}))}r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}))},19789:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return l})),r.d(t,"b",(function(){return u}));var n=r(12367),o=r(13031),i={PADNameMaxLength:100,NameMaxLength:255,NameMinLength:3,DescriptionMaxLength:1024};function a(e){return t=>(t||"").trim().length>i.NameMaxLength&&Object(o.a)(e.Flow.Error.FlowNameMaxLength,i.NameMaxLength)}function c(e){return t=>{if(t)return t.trim().length<i.NameMinLength&&Object(o.a)(e.Flow.Error.FlowNameMinLength,i.NameMinLength)}}function s(e){return t=>(t||"").trim().length>i.PADNameMaxLength&&Object(o.a)(e.Flow.Error.FlowNameMaxLength,i.PADNameMaxLength)}function l(e,t){return t===n.q.DesktopV2?s(e):a(e)}function u(e){return t=>(t||"").trim().length>i.DescriptionMaxLength&&Object(o.a)(e.EditFlowDetails.Description.Error.MaxLength,i.DescriptionMaxLength)}},19793:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(16808),o=r(16809);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=u(e);if(t){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(l,e);var t,r,n,a=s(l);function l(e,t,r,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.call(this,o.a.ValidationError,t,e,n,r)}return t=l,r&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.a)},19853:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11809),o=r(11896),i=Object(o.a)({teamName:n.a.PowerAutomateClientTeam,owners:["paadminandlifecycle","dhruvmehta"],description:"Flag used to enable save draft functionality from the details page.",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1415267",createdOn:"08/12/2024",fallback:{isSaveDraftFromDetailsPageEnabled:!1}}),{getFeatureValue:a}=Object(o.b)(i,"isSaveDraftFromDetailsPageEnabled")},19855:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(13192),o="@Microsoft.PowerApps.CDS.ErrorDetails.Error";function i(e){var t;return(null==e?void 0:e.extendedData)||(null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t||null===(t=t.error)||void 0===t?void 0:t.extendedData)}function a(e,t){if(Object(n.isHttpClientError)(e)&&e.response&&e.response.data)return a(e.response,t);try{var r,i,s,l,u,p,f=null!=e&&null!==(r=e.data)&&void 0!==r&&null!==(r=r.error)&&void 0!==r&&r[o]?JSON.parse(e.data.error[o]):null;if(null===f)f=c(null==e||null===(p=e.data)||void 0===p||null===(p=p.error)||void 0===p?void 0:p.message);if(null===f){var d,m=JSON.parse(null==e?void 0:e.innerException);f=c(null==m||null===(d=m.error)||void 0===d?void 0:d.message)}return null!==(i=null!==(s=null===(l=f)||void 0===l||null===(l=l.error)||void 0===l?void 0:l.message)&&void 0!==s?s:null===(u=f)||void 0===u?void 0:u.error)&&void 0!==i?i:f}catch(b){null==t||t.logWarning("SolutionFlow.ParseError.Failed","Parsing of solution flow error failed: ".concat(b))}return null}function c(e,t){try{var r,n,o=e.match(/details \"(.+)\"\./);if(!o)return null;var i=o[1];return null!==(r=null===(n=JSON.parse(i).error)||void 0===n?void 0:n.message)&&void 0!==r?r:null}catch(a){return null==t||t.logWarning("SolutionFlow.ParseError.Failed","Parsing of solution flow error failed: ".concat(a)),null}}},19862:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o,i,a=r(11773);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=new(n=a.observable.ref,i=l((o=function(){function e(){var t,r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,r="_command",o=this,(n=i)&&Object.defineProperty(t,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0}),this._listeners=[],this.clear()}var t,r,n;return t=e,(r=[{key:"invokeAngularCommand",value:function(e){this._command=e,this.notifyListeners()}},{key:"getCurrentCommand",value:function(){return this._command}},{key:"addCommandChangedEventListener",value:function(e){this._listeners.includes(e)||this._listeners.push(e)}},{key:"removeCommandChangedEventListener",value:function(e){var t=this._listeners.indexOf(e);t>-1&&this._listeners.splice(t,1)}},{key:"clear",value:function(){this._command=void 0}},{key:"notifyListeners",value:function(){this._listeners.forEach(e=>e())}}])&&c(t.prototype,r),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"_command",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(o.prototype,"invokeAngularCommand",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"invokeAngularCommand"),o.prototype),l(o.prototype,"clear",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"clear"),o.prototype),o)},19863:function(e,t,r){"use strict";r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return m}));var n=r(19864),o=r(19865),i=r(14894),a=r(11891),c=Object(n.createSelector)(e=>e.actions,e=>e.connectionErrors,e=>e.connectionWarnings,e=>e.flowCheckerErrors,e=>e.flowCheckerWarnings,e=>e.parametersErrors,e=>e.triggers,(e,t,r,n,i,c,s)=>function(e,t,r,n,i,c,s){var p=[],f=[];if(s.length>0){var d=s[0],m=u(e.filter(e=>Object(a.a)(e.nodeId,d.nodeId)),d,o.a.error),b=t.filter(e=>Object(a.a)(e.name,d.name)),y=r.filter(e=>Object(a.a)(e.name,d.name)),v=l(n.filter(e=>Object(a.a)(e.operationName,d.name)),d,o.a.error),h=l(i.filter(e=>Object(a.a)(e.operationName,d.name)),d,o.a.warning);p=p.concat(m,b,y,v),f=f.concat(h)}return c.forEach(c=>{var s=u(e.filter(e=>Object(a.a)(e.nodeId,c.nodeId)),c,o.a.error),d=t.filter(e=>Object(a.a)(e.name,c.name)),m=r.filter(e=>Object(a.a)(e.name,c.name)),b=l(n.filter(e=>Object(a.a)(e.operationName,c.name)),c,o.a.error),y=l(i.filter(e=>Object(a.a)(e.operationName,c.name)),c,o.a.warning);p=p.concat(s,d,m,b),f=f.concat(y)}),p.concat(f)}(c,t,r,n,i,e,s)),s=Object(n.createSelector)(e=>e.items,e=>e.clientResources,(e,t)=>function(e,t){var r=0,n=new Map;e.filter(e=>e.type===o.a.error).reduce((e,t)=>{var o=t.nodeId;return n.has(o)?n.get(o).count++:n.set(o,{key:o,name:t.name,count:1,level:1,startIndex:r}),r++,n},n);var i={key:t.Common.Errors,name:t.Common.Errors,startIndex:0,count:r,children:Array.from(n.values()),level:0,ariaLabel:t.Common.Errors+" "+r.toString()},a=new Map;e.filter(e=>e.type===o.a.warning).reduce((e,t)=>{var n=t.nodeId;return a.has(n)?a.get(n).count++:a.set(n,{key:n,name:t.name,count:1,level:1,startIndex:r}),r++,a},a);var c={key:t.Common.Warnings,name:t.Common.Warnings,startIndex:i.count,count:r-i.count,children:Array.from(a.values()),level:0,ariaLabel:t.Common.Warnings+" "+(r-i.count).toString()};return[i,c]}(e,t));function l(e,t,r){var n=[];return e.length>0&&e.forEach(e=>{n.push({name:t.friendlyName,type:r,errorMessage:e.errorDescription,fixInstructions:e.fixInstructions,nodeId:t.nodeId})}),n}function u(e,t,r){var n=[];return e.forEach(e=>{e.errorMessages.length>0&&e.errorMessages.forEach(o=>{n.push({name:t.friendlyName,type:r,errorMessage:o,nodeId:e.nodeId,groupId:e.groupId,parameterId:e.parameterId})})}),n}function p(e,t,r,n){var a=[];return e.forEach(e=>{Object(i.e)(e,r)&&a.push({name:e.name,type:o.a.error,errorMessage:n.FlowChecker.ConnectionNotAuthorized,nodeId:e.nodeId})}),t.forEach(e=>{Object(i.e)(e,r)&&a.push({name:e.name,type:o.a.error,errorMessage:n.FlowChecker.ConnectionNotAuthorized,nodeId:e.nodeId})}),a}function f(e,t,r,n){var a=[];return e.forEach(e=>{Object(i.g)(e,r)&&a.push({name:e.name,type:o.a.warning,errorMessage:n.FlowChecker.PowerAppsTrigger.ConnectionReferencesWarnings,nodeId:e.nodeId})}),t.forEach(e=>{Object(i.g)(e,r)&&a.push({name:e.name,type:o.a.warning,errorMessage:n.FlowChecker.PowerAppsTrigger.ConnectionReferencesWarnings,nodeId:e.nodeId})}),a}function d(e){return e.flowCheckerErrors.length>0||e.parametersErrors.length>0||e.connectionErrors.length>0?"fl-CommandBar-FlowChecker--hasErrors":e.flowCheckerWarnings.length>0||e.connectionWarnings.length>0?"fl-CommandBar-FlowChecker--hasWarnings":""}function m(e,t){return e&&e.length>0||t&&t.length>0?"fl-CommandBar-FlowChecker--hasErrors":""}},19865:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n=function(e){return e.error="Error",e.warning="Warning",e}({}),o=function(e){return e.FlowLicensingChecker="FlowLicensingChecker",e.FlowAiBuilderGptHITLChecker="FlowAiBuilderGptHITLChecker",e.FlowAiBuilderCustomPromptHITLChecker="FlowAiBuilderCustomPromptHITLChecker",e}({})},19868:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(11766),o=r(19869),i=r(13272),a=r(15543),c=r(12839),s=r(12831),l=r(12754),u=r(12854),p=r(15028),f=r(13260),d=r(13223);function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(O,e);var t,r,b,h=v(O);function O(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(t=h.call(this,e)).async=new c.a(g(t)),t.uniqueTooltipId=Object(d.a)(),t.copyButtonContainer=void 0,t.displayCopiedTextUntil=void 0,t.copyButtonContainerRefCallback=e=>{t.copyButtonContainer=e},t.onIconButtonClick=()=>{t.setState({displayTextCopiedTooltip:!0}),t.displayCopiedTextUntil&&t.async.clearTimeout(t.displayCopiedTextUntil);t.displayCopiedTextUntil=t.async.setTimeout(()=>{t.setState({displayTextCopiedTooltip:!1})},1e3)},t.styles=Object(l.db)({root:["fl-CopyableTextField",{position:"relative"}],textField:["fl-CopyableTextField-TextField",{height:E}],iconButtonContainer:["fl-CopyableTextField-IconButtonContainer",{position:"absolute",top:0,right:0}],iconButton:["fl-CopyableTextField-IconButton",{height:C,width:C}]}),t.state={displayTextCopiedTooltip:!1},t}return t=O,(r=[{key:"render",value:function(){var{placeholder:e,value:t,copyButtonAriaLabel:r,clientResources:c}=this.props,{displayTextCopiedTooltip:d}=this.state,{palette:m}=Object(l.Y)(),b={border:"1px solid ".concat(m.neutralSecondary),backgroundColor:m.neutralLight,height:36,paddingRight:36},y=r||c.Common.ClickToCopy,v=d?c.Common.Copied:c.Common.ClickToCopy;return n.createElement(s.a,{className:this.styles.root},n.createElement(p.a,{ariaLabel:t,className:this.styles.textField,disabled:!0,placeholder:e,style:b,value:t,readOnly:!0}),n.createElement(o.CopyToClipboard,{text:t},n.createElement("div",{className:this.styles.iconButtonContainer,ref:this.copyButtonContainerRefCallback},d&&n.createElement(a.a,{message:v}),n.createElement(f.b,{id:this.uniqueTooltipId,text:v,targetElement:this.copyButtonContainer},n.createElement(u.a,{"aria-describedby":this.uniqueTooltipId,ariaLabel:y,className:this.styles.iconButton,iconProps:{iconName:i.a.Copy},onClick:this.onIconButtonClick})))))}},{key:"componentWillUnmount",value:function(){this.async.dispose()}}])&&m(t.prototype,r),b&&m(t,b),Object.defineProperty(t,"prototype",{writable:!1}),O}(n.Component),E=36,C=E},19933:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(11766),o=r(15657),i=r(12706),a=r(12811),c=r(15659),s=r(19934),l=r(19935),u=r(12375),p=["ariaLabel","errorMessage","label","minDate","maxDate","placeholder","required","value","disabled","className","onChanged","onFormatDate","onParseDateFromString"];function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(O,e);var t,r,y,g=h(O);function O(){var e;m(this,O);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=g.call(this,...r)).DayPickerStrings=Object(s.a)(e.props.clientResources,Object(u.a)()),e.getClassNames=Object(i.a)(),e.classNames=e.getClassNames(l.a),e}return t=O,(r=[{key:"render",value:function(){var e=this.props,{ariaLabel:t,errorMessage:r,label:i,minDate:s,maxDate:l,placeholder:u,required:m,value:b,disabled:y,className:v,onChanged:h,onFormatDate:g,onParseDateFromString:O}=e,w=d(e,p),E=Object(a.a)(this.classNames.root,v);return n.createElement(o.a,f({ariaLabel:t,className:E,label:i,isRequired:m,allowTextInput:!0,firstDayOfWeek:c.c.Sunday,strings:this.DayPickerStrings,placeholder:u,value:b,showMonthPickerAsOverlay:!0,disableAutoFocus:!0,onSelectDate:h,minDate:s,maxDate:l,formatDate:g,parseDateFromString:O,textField:{errorMessage:r,required:m},disabled:y},w))}}])&&b(t.prototype,r),y&&b(t,y),Object.defineProperty(t,"prototype",{writable:!1}),O}(n.Component)},19935:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-DatePicker",{margin:"0 0 15px 0"}]})},19936:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}));var n=function(e){return e[e.Month=0]="Month",e[e.Week=1]="Week",e[e.Day=2]="Day",e[e.Hour=3]="Hour",e[e.Minute=4]="Minute",e[e.Second=5]="Second",e}({}),o=function(e){return e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday",e}({})},19940:function(e,t,r){"use strict";var n=r(14846);r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return n.b})),r.d(t,"c",(function(){return n.c}))},19997:function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"d",(function(){return m})),r.d(t,"f",(function(){return h})),r.d(t,"e",(function(){return g})),r.d(t,"c",(function(){return O}));var n=r(12324),o=r(13009),i=r(14895),a=r(12999),c=r(15459),s=r(13005),l=r(12340),u=r(19998);function p(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,c,"next",e)}function c(e){p(i,n,o,a,c,"throw",e)}a(void 0)}))}}r.d(t,"a",(function(){return u.a}));var d="FlowSaveBlockedDueToSolutionsByDefault";function m(e,t,r,n,o,i,a,c){return b.apply(this,arguments)}function b(){return(b=f((function*(e,t,r,n,o,i,s,p){var f=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=Object(a.a)();if(!t)return e.logInfo("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow","Environment does not have an XRM instance. Should not default."),u.a.ShouldNotDefault;if(n)return e.logInfo("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow","Default to solution not supported for MSA users. Should not default."),u.a.ShouldNotDefault;try{yield i.getEnableFlowsInSolutionByDefaultCapability()}catch(j){return e.logWarning("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow",'Retrieving org feature flag "enableFlowsInSolutionByDefault" failed. Should not default. Error: \''.concat(j,"'")),u.a.ShouldNotDefault}var m=c.a.isSolutionFlowByDefaultEnabled(o),b=y(s,d),h=r.isRoadmapContext()&&!v(p),g=!h||b,O=!h||b,w=r.isWidgetPage(),E=Object(l.a)()&&w,C=d.enableSolutionFlowCreationByDefaultForAllowedWidgetScenarios&&r.isPowerappsMakerContext()||E;if(m){if(!w||C)return e.logInfo("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow","Default to solution is enabled: widgetScenario: '".concat(w,"', isEnabledWidgetScenario: '").concat(C,"'. Should default.")),u.a.ShouldDefault;if(g&&f||O&&!f){var S;try{yield i.getEnableProcessStageEntityMerging()}catch(j){e.logWarning("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow",'Retrieving org feature flag "ProcessStageEntityMerging" failed. Will assume a false value for this flag in this helper. Error: \''.concat(j,"'"))}var P=null!==(S=c.a.isProcessStageEntityMergingEnabled(o))&&void 0!==S&&S;return P?(e.logWarning("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow","Default to solution is enabled: isProcessStageEntityMergingEnabledForThisEnvironment: '".concat(P,"', isDefaultingEnabledForDietDesigner: '").concat(g,"', isDefaultingEnabledForNonDietDesigner: '").concat(O,"', isDietDesignerScenario: '").concat(f,"'. Should default.")),u.a.ShouldDefault):(e.logWarning("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow","Default to solution is disabled since isProcessStageEntityMergingEnabledForThisEnvironment: '".concat(P,"'. Should not default.")),u.a.BlockFlowSave)}return e.logInfo("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow","In an unsupported integration scenario. Block flow save."),u.a.BlockFlowSave}return e.logInfo("defaultToSolutionFlowHelper.shouldDefaultToSolutionFlow","Default to solution is disabled. Should not default."),u.a.ShouldNotDefault}))).apply(this,arguments)}function y(e,t){return t.enableAllowlistForSolutionFlowCreationByDefault&&["28881c59-55bf-41ee-80cf-9bd4b69dc60d","1518b31f-2673-4976-94f4-293f4ba91f30","4d5c0fe0-d2af-48e9-bab2-a54eb4a5a9dc","f58c1e2e-95a6-4871-bb2f-5f8505ac6f81"].includes(e)}function v(e){return!!e&&e.localeCompare("9.2.23103.00118")>=0}function h(e){Object.keys(e).forEach(t=>{var r=e[t],n=r.connectionName;delete r.connectionName,r.connectionReferenceLogicalName=n})}function g(e,t){if(e===u.a.BlockFlowSave)throw new o.a(d,t)}function O(e,t,r,o){var a=new Map;t.forEach(e=>{var t=e.connectionid;if(t){var r,n=null!==(r=a.get(t))&&void 0!==r?r:[];n.push(e),a.set(t,n)}});var c=new Map(t.map(e=>[e.connectionreferencelogicalname,e])),l=[];return e.forEach(e=>{var t;null!=e&&e.name&&(c.has(Object(s.a)(e.name))?l.push(e):a.has(e.name)&&(null!==(t=a.get(e.name))&&void 0!==t?t:[]).forEach(t=>{var a,c,s=Object(n.cloneDeep)(e);s&&t&&(r.addDesignerConnectionIdMapEntry(t.connectionreferencelogicalname,e.id),s.id=s.name=t.connectionreferencelogicalname,s.properties.displayName=t.connectionreferencedisplayname,s.properties.testLinks=e.properties.testLinks,(null==e||null===(a=e.properties)||void 0===a||null===(a=a.statuses[0])||void 0===a?void 0:a.status)!==i.c.connected?s.properties.statuses=[{status:i.c.error,error:{code:i.b.configurationNeeded,message:o.XRMConnectionReference.InvalidConnection}}]:null!=e&&null!==(c=e.properties)&&void 0!==c&&c.statuses&&(s.properties.statuses=e.properties.statuses),l.push(s))}))}),l}},19998:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e[e.ShouldDefault=0]="ShouldDefault",e[e.ShouldNotDefault=1]="ShouldNotDefault",e[e.BlockFlowSave=2]="BlockFlowSave",e}({})},19999:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e[e.pending=0]="pending",e[e.ready=1]="ready",e[e.working=2]="working",e[e.failed=3]="failed",e}({})},20008:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return h}));var n=r(12811),o=r(12728),i=r(12838),a=r(12743),c=r(12746),s=r(15356),l=r(12801),u=r(11766),p=r.n(u),f=r(14947),d=r(20009),m=r(20010);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e){var{isOpen:t,onDismiss:r,surveyId:n,getUserContext:o,title:i,closeButtonAriaLabel:a,size:c,customWidth:s,dataAutomationId:l}=e,u=Object(d.a)();return p.a.createElement(f.a,{dataAutomationId:l,isOpen:t,onDismissed:r,isBlocking:!0,isLightDismiss:!1,title:i,closeButtonAriaLabel:a,size:c||f.b.small,customWidth:s,className:u.panel},t&&p.a.createElement(v,{surveyId:n,getUserContext:o}))}var v=e=>{var{surveyId:t,getUserContext:r,fluent9SurveyPanel:o}=e,u=Object(i.a)(),f=Object(a.a)("survey-"),b=p.a.useRef(0),[y,{setTrue:v}]=Object(c.a)(!1);Object(s.a)(()=>{Object(m.a)(),b.current=u.setInterval(()=>{window.SurveyEmbed&&(Object(m.b)(f,t,r()),u.clearInterval(b.current),u.setTimeout(()=>v(),300))},100)}),Object(l.a)(()=>{var e=document.getElementById(f);null==e||e.replaceChildren()});var h=Object(d.a)(o);return p.a.createElement("div",{className:Object(n.a)(h.wrapper,{"is-hidden":!y}),id:f})};function h(e,t){return e.spawn({key:Object(o.a)("embedded-survey-panel"),render:e=>p.a.createElement(y,b({onDismiss:e.dismiss},e,t))})}},20009:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(12706),o=r(12754),i=r(16e3);function a(e){return Object(n.a)()(c,{wrapperDisplayFlex:e})}var c=e=>{var t=Object(o.Y)();return{panel:["fl-EmbeddedSurveyPanelStyles-Panel",{".ba-Panel-headerContainer":{backgroundColor:"".concat(t.palette.neutralLighterAlt," !important"),borderBottom:"1px solid ".concat(t.palette.neutralLight),paddingBottom:"12px !important"},".ms-Panel-content":{flex:"1 1 auto",overflow:"hidden",display:"flex",flexDirection:"column",paddingBottom:0,".ba-Panel-content":{display:"flex",flexDirection:"column",height:"100%",padding:0}}}],wrapper:["fl-EmbeddedSurveyPanelStyles-Wrapper",{height:"100%",width:"100%","&.is-hidden":{visibility:"hidden"},display:null!=e&&e.wrapperDisplayFlex?"flex":"inherit"}]}};Object(i.zb)({drawerHeaderCloseButton:{padding:"".concat(i.Cb.spacingVerticalM," ").concat(i.Cb.spacingHorizontalM)},overlayDrawer:{zIndex:i.Cb.zIndexContent},overlayDrawerBackdrop:{backgroundColor:i.Cb.colorNeutralShadowAmbient}})},20010:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(11893);function o(){var e=document.createElement("script");e.type="text/javascript",e.src=Object(n.b)("https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/Embed.js",n.a.allowlistedStaticUrls),document.body.appendChild(e);var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href="https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/Embed.css",document.body.appendChild(t)}function i(e,t,r){if(!window.SurveyEmbed)throw new Error("SurveyEmbed is not available");new window.SurveyEmbed(t,"https://customervoice.microsoft.com/","https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/","true").renderInline(e,r)}},20014:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(12754);function o(e){var{glintA:t,glintB:r,glintC:o,speedMilliseconds:i,delayMilliseconds:a=0,borderSize:c="2px",glintWidth:s="225px"}=e,l=Object(n.bb)({"0%":{backgroundPosition:"calc(-1 * ".concat(s," + 1px) 0")},"100%":{backgroundPosition:"calc(100% + ".concat(s," + 1px) 0")}});return{position:"relative","::before":{content:'""',position:"absolute",inset:0,zIndex:2,borderRadius:4,backgroundImage:"linear-gradient(130deg, ".concat(t," 0%, ").concat(r," 15%, ").concat(o," 50%, ").concat(r," 85%, ").concat(t," 100%)"),backgroundPosition:"calc(-1 * ".concat(s," + 1px) 0"),backgroundRepeat:"no-repeat",backgroundSize:"".concat(s," 100%"),clipPath:"polygon(0% 100%, ".concat(c," 100%, ").concat(c," ").concat(c,", calc(100% - ").concat(c,") ").concat(c,", calc(100% - ").concat(c,") calc(100% - ").concat(c,"), ").concat(c," calc(100% - ").concat(c,"), ").concat(c," 100%, 100% 100%, 100% 0%, 0% 0%)"),animationName:l,animationDuration:"".concat(i,"ms"),animationTimingFunction:"linear",animationFillMode:"both",animationDelay:"".concat(a,"ms"),"@media (prefers-reduced-motion)":{display:"none"}}}}function i(e){var{textGlowA:t,textGlowB:r,speedMilliseconds:o,delayMilliseconds:i=0}=e,a=Object(n.bb)({"0%":{backgroundPosition:"-80% 0"},"60%":{backgroundPosition:"300% 0"},"100%":{backgroundPosition:"300% 0"}});return{position:"relative","::after":{display:"block",position:"absolute",inset:0,zIndex:0,content:"attr(data-animation-text)",pointerEvents:"none",color:"transparent",backgroundImage:"linear-gradient(130deg, ".concat(t," 5%, ").concat(r," 30%, ").concat(t," 55%)"),backgroundSize:"150px 100%",backgroundRepeat:"no-repeat",backgroundPosition:"-120% 0",backgroundClip:"text",WebkitBackgroundClip:"text",animationName:a,animationDuration:"".concat(o,"ms"),animationTimingFunction:"ease",animationFillMode:"both",animationDelay:"".concat(i,"ms"),"@media (prefers-reduced-motion)":{display:"none"}}}}},20106:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(13005);function o(e){var{previousConnections:t=[],currentConnections:r=[]}=e;return r.filter(e=>{var r=t.find(t=>Object(n.a)(t.name)===Object(n.a)(e.name));return!r||e.properties.lastModifiedTime!==r.properties.lastModifiedTime})}},20107:function(e,t,r){"use strict";r.d(t,"a",(function(){return Z})),r.d(t,"c",(function(){return J})),r.d(t,"b",(function(){return $})),r.d(t,"d",(function(){return re}));var n=r(12330),o=r(20108),i=r(12366),a=r(17266),c=r(13143),s=r(13015),l=r(13009),u=r(19699),p=r(20109),f=r(20110),d=r(13085),m=r(12339),b=r(14697),y=r(20154),v=r(20155),h=r(12999),g=r(12375),O=r(13119),w=r(13144),E=r(15509),C=r(14877),S=r(11891),P=r(12381),j=r(13007),T=r(13223),k=r(19713),R=r(20156),x=r(20660),N=r(17244),_=r(20725),D=r(20733),I=r(20753),A=r(20754),F=r(20755),L=r(20757),M=r(20758),B=r(19712),U=r(20786),V=r(20788),z=r(20789),G=r(20790);function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H(n.key),n)}}function H(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function K(e,t){return(K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=X(e);if(t){var o=X(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Y(this,r)}}function Y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Q=-1!==window.navigator.userAgent.indexOf("MSIE")||window.navigator.appVersion.indexOf("Trident/")>0;navigator.userAgent.toLowerCase().indexOf("safari");function Z(e){return ee(e),new e.designercore.Designer(te(e),e.designerElement)}function J(e){return ee(e),new e.designercore.Monitor(te(e),e.designerElement)}function $(e,t){return ee(e),new e.designercore.ConnectionWizard(te(e),e.designerElement,t)}function ee(e){var{designerHostContextStore:t}=e.context;t.setContext({isDiet:!!e.enableDietDesigner,apiOperationAuthoringBehavior:e.apiOperationAuthoringBehavior})}function te(e){!function(e){Object(k.b)({appSettings:e.context.appSettings,featureFlags:e.context.featureFlags,assetService:e.context.assetService,cdnService:e.context.cdnService,loggingService:e.context.loggingService,dateTimeResources:e.context.dateTimeResources,designerConnectionStore:e.context.designerConnectionStore,designerHostContextStore:e.context.designerHostContextStore,designerResources:e.context.clientResources,easyAutomationPanelStore:e.context.easyAutomationPanelStore,globalResources:e.context.clientResources,graphService:e.context.graphService,sharedComponentResources:e.context.clientResources,telemetryService:e.telemetryService,tokenService:e.context.tokenService,commentingPaneStore:e.context.commentingPaneStore,doNotShowAgainService:e.context.doNotShowAgainService,errorResources:e.context.clientResources,flowService:e.context.flowService,sessionStore:e.context.sessionStore,snippetService:e.context.snippetService,widgetUtilService:e.context.widgetUtilService,environmentStore:e.context.environmentStore,connectionService:e.context.connectionService,connectionStore:e.context.connectionStore,environmentCapabilityService:e.context.environmentCapabilityService,environmentCapabilityStore:e.context.environmentCapabilityStore,flowRunInputsOutputsService:e.context.flowRunInputsOutputsService,flowStore:e.context.flowStore,gatewayService:e.context.gatewayService,gatewayStore:e.context.gatewayStore,machineManagementStore:e.context.machineManagementStore,routeCrafter:e.context.routeCrafter,rpaLocalService:e.context.rpaLocalService,surfaceStore:e.context.surfaceStore,uiFlowService:e.context.uiFlowService,xrmMachineManagementService:e.context.xrmMachineManagementService,licenseManagementService:e.context.licenseManagementService,licenseManagementStore:e.context.licenseManagementStore,consentService:e.context.consentService,userFeaturesStore:e.context.userFeaturesStore,navigationService:e.context.navigationService,planService:e.context.planService,planStore:e.context.planStore,winAutomationService:e.context.winAutomationService,neptuneStore:e.context.neptuneStore,neptuneService:e.context.neptuneService,flowServiceClientResources:e.context.clientResources,desktopFlowStore:e.context.desktopFlowStore,flowRunsService:e.context.flowRunsService,uiFlowRunService:e.context.uiFlowRunService,uiFlowRunStore:e.context.uiFlowRunStore,gptService:e.context.gptService})}(e);var{designercore:t,appSettings:r,featureFlags:H,context:{widgetUtilService:Y,sessionStore:X,clientResources:Z,planStore:J,errorHandlingResources:$}}=e,ee="".concat(r.processSimpleResourceProviderPath,"/apiOperations"),te=e.environment?"".concat(r.processSimpleResourceProviderPath,"/environments/").concat(e.environment.name,"/apiOperations"):ee,re=e.environment?"providers/Microsoft.ProcessSimple/environments/".concat(e.environment.name,"/flows"):N.e,ne={config:{apiOperationsPath:te,connectionsPath:i.L,connectionProvidersPath:i.K,flowsConnectorPath:N.d,flowsPath:re,gatewaysPath:r.gatewaysPath},visibleHideKeys:e.visibleHideKeys};e.allowCoauthoring&&(ne.allowCoauthoring=e.allowCoauthoring),ne.enableProxyForAllFlows=H.enableProxyForAllFlows,ne.getUriForDynamicCalls=t=>{var{connectionProvider:n,connection:o}=t,i=X.user;if(H.enableProxyForAllFlows){var a=e.flowName||"new";return Object(P.a)(Object(w.d)(e.environment.name,r),"/environments/".concat(e.environment.name,"/flows/").concat(a,"/apis/").concat(n.name,"/connections/").concat(o.name,"/proxy/"))}return e.allowCoauthoring&&n&&n.properties&&n.properties.primaryRuntimeUrl&&i&&i.uniqueId&&i.tenantId&&o&&o.properties&&o.properties.createdBy&&Object(S.a)(o.properties.createdBy.id,i.uniqueId)&&Object(S.a)(o.properties.createdBy.tenantId,i.tenantId)?Object(P.a)(n.properties.primaryRuntimeUrl,o.name):Object(P.a)(Object(w.d)(e.environment.name,r),"/environments/".concat(e.environment.name,"/flows/").concat(e.flowName,"/apis/").concat(n.name,"/connections/").concat(o.name,"/proxy"))},H.enableProxyForAllFlows&&(ne.getDynamicCallsUri=(t,n,o,i,a,c)=>{var s=e.flowName||"new";return Object(P.a)(Object(w.d)(e.environment.name,r),"/environments/".concat(e.environment.name,"/flows/").concat(s,"/apis/").concat(t,"/connections/").concat(o,"/proxy/"))});var oe=(Y.isTeamsSolutionExplorerContext()||H.enableHostConnectionService)&&(!e.enableDietDesigner||e.isXrmConnectionReferenceMode)||H.enableProxyForAllFlows?new B.a(ne,!!e.isXrmConnectionReferenceMode):new t.PowerAppsUrlService(ne),ie=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(y,t);var o,i,p,f=q(y);function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=f.call(this,e)).loginWithMfaAndRetryTestConnection=e=>{var{error:r,connection:n,firstPartyLoginUri:o}=e;return t._options?t._options.onFirstPartyConnectionFailureCallback?(t._analytics.logInfo("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","attempting to fix connection",t.getConnectionInfoForLogging(n)),t._options.onFirstPartyConnectionFailureCallback(c.b.mfaTestConnectionError,o).then(()=>t.testConnection(n)).then(()=>t._analytics.logInfo("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","successfully fixed connection",t.getConnectionInfoForLogging(n))).catch(e=>(t._analytics.logError("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection",e,"unable to fix connection",t.getConnectionInfoForLogging(n)),Promise.reject(e)))):(t._analytics.logWarning("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","unable to login with mfa since onFirstPartyConnectionFailureCallback not supplied",t.getConnectionInfoForLogging(n)),Promise.reject(r)):(t._analytics.logWarning("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","unable to login with mfa since _options not supplied",t.getConnectionInfoForLogging(n)),Promise.reject(r))},Object(b.a)()&&t._client.setBeforeRequestHandler(Object(A.a)(e)),t}return o=y,(i=[{key:"getConnectionInfoForLogging",value:function(e){return{connectionName:e&&e.name,apiId:e&&e.properties&&e.properties.apiId}}},{key:"testConnection",value:function(t,o){var i,p,f=null==t||null===(i=t.properties)||void 0===i||null===(i=i.testLinks)||void 0===i?void 0:i[0];if(!(t.id&&f&&f.requestUri&&(p=f.requestUri,/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(p))))return Promise.resolve();var b={url:null==f?void 0:f.requestUri,json:!1,shouldIncludeClientRequestId:!0};return new Promise((o,i)=>{if(f&&Object(m.j)(r,f.requestUri)){var a=Object(T.a)();return this._analytics.profileStart(a,"DesignerHelper.TestConnection.GetRuntimeAccessToken.Start",this.getConnectionInfoForLogging(t)),e.getRuntimeAccessToken().then(e=>{if(Object(n.a)(e))throw new Error(c.b.failureRetrievingRuntimeToken);Object(u.g)(b,"authorization","Bearer ".concat(e)),this._analytics.profileEnd(a,"DesignerHelper.TestConnection.GetRuntimeAccessToken.End",this.getConnectionInfoForLogging(t)),o()}).catch(e=>{this._analytics.logError(d.a.testConnection,Object(G.a)(e),this.getConnectionInfoForLogging(t))})}return o()}).then(()=>this._client.execute(null==f?void 0:f.method,b)).then(e=>{if(e.status>=400&&429!==e.status){var r;if(e.body)try{r=JSON.parse(e.body)}catch(u){throw this._analytics.logError(d.a.testConnection,Object(G.a)(u),this.getConnectionInfoForLogging(t)),new a.a(c.b.testConnectionError,this.clientResources.Error.TestConnectionFailed,u)}var n=Object(s.l)(e.status,r,$),i=new a.a(c.b.testConnectionError,n,r);if(400===e.status&&r&&Object(l.cb)(r)===c.b.AuthenticationError&&o)return this.loginWithMfaAndRetryTestConnection({error:i,connection:t,firstPartyLoginUri:o});throw this._analytics.logWarning(d.a.testConnection,this.getConnectionInfoForLogging(t)),i}return Promise.resolve()}).catch(e=>{throw e&&e.code&&e.code!==c.b.testConnectionError&&this._analytics.logError(d.a.testConnection,Object(G.a)(e),this.getConnectionInfoForLogging(t)),e})}}])&&W(o.prototype,i),p&&W(o,p),Object.defineProperty(o,"prototype",{writable:!1}),y}(t.PowerAppsConnectionService),ae=Object(T.a)(),ce=function(e,t,r,n){var o,i,a,c=e.features,s=n.context.widgetUtilService.isMiniWidget(),l={};c.ALLOW_EMPTY_DEFINITION&&(l[c.ALLOW_EMPTY_DEFINITION]=!1);c.FILTER_RECOMMENDATION&&(l[c.FILTER_RECOMMENDATION]=!1);c.ARRAY_EDITOR_IGNORE_DEFAULT&&(l[c.ARRAY_EDITOR_IGNORE_DEFAULT]=!0);c.HIDE_MULTI_AUTH_DISPLAY_NAME&&(l[c.HIDE_MULTI_AUTH_DISPLAY_NAME]=!0);c.SHOW_TRIGGER_RECURRENCE&&(l[c.SHOW_TRIGGER_RECURRENCE]=!1);c.RAW_MODE&&(l[c.RAW_MODE]=!1);c.SCOPE_REPETITION_API_NOT_SUPPORTED&&(l[c.SCOPE_REPETITION_API_NOT_SUPPORTED]=!1);c.USE_CONNECTION_CONFIGURATION_SERVICE&&(l[c.USE_CONNECTION_CONFIGURATION_SERVICE]=!1);c.BOOLEAN_DROPDOWN_FOR_CONDITION&&(l[c.BOOLEAN_DROPDOWN_FOR_CONDITION]=r.designerBooleanDropdownForCondition);c.CREATE_CONNECTION_TERMS_OF_USE&&(l[c.CREATE_CONNECTION_TERMS_OF_USE]=Object(m.l)(t).termsInCreateConnection);!c.GATEWAY_FOR_CONNECTION||null!==(o=n.context.sessionStore.user)&&void 0!==o&&o.isConsumerDomain||(l[c.GATEWAY_FOR_CONNECTION]=!0);c.ALLOW_CONNECTION_WIZARD_BEFORE_EDITING&&(l[c.ALLOW_CONNECTION_WIZARD_BEFORE_EDITING]=n.containsNativeCDSOperation);c.SHOW_API_RECOMMENDATIONS_FIRST&&(l[c.SHOW_API_RECOMMENDATIONS_FIRST]=!0);c.AUTO_CREATE_FIRST_PARTY_CONNECTION&&(l[c.AUTO_CREATE_FIRST_PARTY_CONNECTION]=!0);c.SHOW_INSERT_ACTION_BUTTON&&(l[c.SHOW_INSERT_ACTION_BUTTON]=!0);c.USE_DICTIONARY_EDITOR&&(l[c.USE_DICTIONARY_EDITOR]=!0);c.TOKEN_COPY_PASTE&&(l[c.TOKEN_COPY_PASTE]=!0);c.SUPPORT_EXPLICIT_BUTTON_BOOLEAN_PARAMETER&&(l[c.SUPPORT_EXPLICIT_BUTTON_BOOLEAN_PARAMETER]=!0);c.SUPPORT_EXPLICIT_BUTTON_DATE_PARAMETER&&(l[c.SUPPORT_EXPLICIT_BUTTON_DATE_PARAMETER]=!0);c.SUPPORT_EXPLICIT_BUTTON_INPUT_SELECTION&&(l[c.SUPPORT_EXPLICIT_BUTTON_INPUT_SELECTION]=!0);c.SUPPORT_EXPLICIT_BUTTON_EMAIL_PARMATER&&(l[c.SUPPORT_EXPLICIT_BUTTON_EMAIL_PARMATER]=!0);c.SUPPORT_EXPLICIT_BUTTON_NUMBER_PARAMETER&&(l[c.SUPPORT_EXPLICIT_BUTTON_NUMBER_PARAMETER]=!0);c.SUPPORT_EXPLICIT_BUTTON_FILE_PARAMETER&&(l[c.SUPPORT_EXPLICIT_BUTTON_FILE_PARAMETER]=!0);c.SUPPORT_EXPLICIT_BUTTON_INPUT_MULTISELECTION&&(l[c.SUPPORT_EXPLICIT_BUTTON_INPUT_MULTISELECTION]=!0);c.SUPPORT_EXPLICIT_BUTTON_REQUIRED_OPTION&&(l[c.SUPPORT_EXPLICIT_BUTTON_REQUIRED_OPTION]=!0);c.SHOW_DESCRIPTION&&(l[c.SHOW_DESCRIPTION]=r.designerShowDescription);c.SHOW_MENU_OPTIONS_WITH_DEPENDENCIES&&(l[c.SHOW_MENU_OPTIONS_WITH_DEPENDENCIES]=!0);c.SHOW_CONNECTIONS_IN_CARD_MENU&&(l[c.SHOW_CONNECTIONS_IN_CARD_MENU]=!0);c.IGNORE_ERROR_WHEN_CONNECTOR_MISSING_SWAGGER&&(l[c.IGNORE_ERROR_WHEN_CONNECTOR_MISSING_SWAGGER]=!0);!c.INTELLISENSE_COMBOBOX||null!==(i=n.context.sessionStore.user)&&void 0!==i&&i.isConsumerDomain||(l[c.INTELLISENSE_COMBOBOX]=!0);c.INITIALIZE_DYNAMIC_CONTENT_ASYNC&&(l[c.INITIALIZE_DYNAMIC_CONTENT_ASYNC]=!0);c.NEW_RECOMMENDATION_CARD&&(l[c.NEW_RECOMMENDATION_CARD]=!0);c.NEW_TOKEN_PICKER&&(l[c.NEW_TOKEN_PICKER]=!0);c.ALLOW_COAUTHORING&&(l[c.ALLOW_COAUTHORING]=n.allowCoauthoring);c.ODATA_PARAMETER_TIP&&(l[c.ODATA_PARAMETER_TIP]=!0);!n.context.widgetUtilService.isWidgetPage()&&c.SHOW_RECOMMENDATION_TIP&&(l[c.SHOW_RECOMMENDATION_TIP]=!0);c.OPERATION_CREATION_ENFORCEMENT&&(l[c.OPERATION_CREATION_ENFORCEMENT]=!0);c.OPTIONAL_TOKEN_IN_REQUIRED_FIELD_TIP&&(l[c.OPTIONAL_TOKEN_IN_REQUIRED_FIELD_TIP]=r.enableOptionalTokenInRequiredFieldTip);c.USE_EDITOR_INPUT&&(l[c.USE_EDITOR_INPUT]=!Q);c.SUPPORT_HTML_EDITOR_CODE_VIEW&&(l[c.SUPPORT_HTML_EDITOR_CODE_VIEW]=!0);c.USE_TEXT_EDITOR&&(l[c.USE_TEXT_EDITOR]=!0);c.USE_NEW_EXPRESSION_PARSER&&(l[c.USE_NEW_EXPRESSION_PARSER]=!0);c.VIEW_CONNECTION_PERMISSIONS_DIALOG&&(l[c.VIEW_CONNECTION_PERMISSIONS_DIALOG]=!0);c.SUPPORT_EXPLICIT_BUTTON_PARAMETERS&&(l[c.SUPPORT_EXPLICIT_BUTTON_PARAMETERS]=!0);c.REQUEST_APICONNECTION_TRIGGER_SUPPORT_EXPLICIT_BUTTON_PARAMETERS&&(l[c.REQUEST_APICONNECTION_TRIGGER_SUPPORT_EXPLICIT_BUTTON_PARAMETERS]=!0);c.CONNECTION_WIZARD_FIRST_PARTY_CONNECTION_AUTO_CREATION&&(l[c.CONNECTION_WIZARD_FIRST_PARTY_CONNECTION_AUTO_CREATION]=!(null!==(a=n.context.sessionStore.user)&&void 0!==a&&a.isConsumerDomain));c.CONNECTION_WIZARD_SIMPLE_CONNECTION_AUTO_CREATION&&(l[c.CONNECTION_WIZARD_SIMPLE_CONNECTION_AUTO_CREATION]=!0);c.DIET_VIEW&&n.enableDietDesigner&&(l[c.DIET_VIEW]=!0);c.DIET_VIEW_WITH_PARAMETERS_CARDS&&n.useDietDesignerParameterCards&&(l[c.DIET_VIEW_WITH_PARAMETERS_CARDS]=!0);c.SHOW_CALLOUT_HINTS&&n.showCalloutHints&&!n.context.widgetUtilService.isWidgetPage()&&(l[c.SHOW_CALLOUT_HINTS]=!0);c.DISABLE_AUTO_FOCUS_PARAMETERS&&(l[c.DISABLE_AUTO_FOCUS_PARAMETERS]=!0);c.SUPPORT_PAN_AND_ZOOM&&(l[c.SUPPORT_PAN_AND_ZOOM]=!s&&r.designerSupportPanAndZoom);c.SUPPORT_PEEK&&(l[c.SUPPORT_PEEK]=!0);c.FX_TOKEN&&(l[c.FX_TOKEN]=!n.enableDietDesigner);c.ADVANCED_PARAMETER&&(l[c.ADVANCED_PARAMETER]=!0);c.FX_TOKEN_FOR_CONDITION&&(l[c.FX_TOKEN_FOR_CONDITION]=!0);c.SHOW_SOFT_LANDING_TIPS&&(l[c.SHOW_SOFT_LANDING_TIPS]=!0);c.SHOW_PARENT_OBJECT_FOR_OUTPUTS&&(l[c.SHOW_PARENT_OBJECT_FOR_OUTPUTS]=!0);c.COLORIZE_MONITORING_INPUTS_OUTPUTS&&(l[c.COLORIZE_MONITORING_INPUTS_OUTPUTS]=!0);c.NEW_SCHEMA_EDITOR&&(l[c.NEW_SCHEMA_EDITOR]=!0);c.SUPPORT_NESTED_FOREACH_UI&&(l[c.SUPPORT_NESTED_FOREACH_UI]=!0);c.DEBOUNCE_EMIT_CHANGE&&(l[c.DEBOUNCE_EMIT_CHANGE]=!0);c.CONCURRENCY&&(l[c.CONCURRENCY]=!0);c.TRIM_SHAREPOINT_SITE_ADDRESS_TO_CORRECT_URL&&(l[c.TRIM_SHAREPOINT_SITE_ADDRESS_TO_CORRECT_URL]=!0);c.NEW_CONDITION_RULES_BUILDER&&(l[c.NEW_CONDITION_RULES_BUILDER]=!0);n.context.widgetUtilService.isMiniWidget()&&c.SKIP_CARD_DELETE_CONFIRMATION&&(l[c.SKIP_CARD_DELETE_CONFIRMATION]=!0);c.SUPPORT_SHAREPOINT_MULTIVALUE_COLUMNS&&(l[c.SUPPORT_SHAREPOINT_MULTIVALUE_COLUMNS]=!0);c.NEW_RECOMMENDATION_CARD_WITH_MODULES&&(l[c.NEW_RECOMMENDATION_CARD_WITH_MODULES]=!0);c.CARD_VIEW_SERVICE&&(l[c.CARD_VIEW_SERVICE]=!0);c.OPEN_API_CONNECTION&&(l[c.OPEN_API_CONNECTION]=Object(O.g)(r,n.environment.features)||n.apiOperationAuthoringBehavior===C.a.OpenApiConnection);c.OPEN_API_MONITORING_VIEW&&(l[c.OPEN_API_MONITORING_VIEW]=!0);c.SHOW_VARIABLE_ACTIONS&&(l[c.SHOW_VARIABLE_ACTIONS]=!0);c.SUPPORT_SIMPLE_CONDITION&&(l[c.SUPPORT_SIMPLE_CONDITION]=!0);c.HTML_EDITOR&&(l[c.HTML_EDITOR]=!0);c.DISABLE_TOKEN_PICKER_COMPACT_MODE&&(l[c.DISABLE_TOKEN_PICKER_COMPACT_MODE]=!1);c.AUTO_CASTING_IN_PARAMETER_FIELD_TIP&&(l[c.AUTO_CASTING_IN_PARAMETER_FIELD_TIP]=!1);c.SHOW_CONNECTION_NAME&&(l[c.SHOW_CONNECTION_NAME]=!1);c.STATIC_RESULT&&(l[c.STATIC_RESULT]=!0);c.COLLAPSE_ALL_CARDS&&(l[c.COLLAPSE_ALL_CARDS]=!0);c.TOKEN_FILTERING_WEIGHTS&&(l[c.TOKEN_FILTERING_WEIGHTS]=!0);c.TOKEN_FILTERING_WEIGHTS_MAIL_KEYWORD&&(l[c.TOKEN_FILTERING_WEIGHTS_MAIL_KEYWORD]=!0);c.ENABLE_ENVIRONMENT_BADGE&&(l[c.ENABLE_ENVIRONMENT_BADGE]=!1);c.SUPPORT_OBFUSCATION&&(l[c.SUPPORT_OBFUSCATION]=!0);c.SUPPRESS_WORKFLOW_HEADERS_ON_RESPONSE&&(l[c.SUPPRESS_WORKFLOW_HEADERS_ON_RESPONSE]=!0);c.VALIDATE_UNKNOWN_PARAMETER_AS_ERROR&&(l[c.VALIDATE_UNKNOWN_PARAMETER_AS_ERROR]=!0);c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER&&(l[c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER]=r.designerValidateExistenceOfOutputReferencedByInputParameter);c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_TRIGGER&&(l[c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_TRIGGER]=r.designerValidateExistenceOfOutputReferencedByInputParameterFromAction);c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_MISSING_TRIGGER&&(l[c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_MISSING_TRIGGER]=r.designerValidateExistenceOfOutputReferencedByInputParameterFromMissingAction);c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_ACTION&&(l[c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_ACTION]=r.designerValidateExistenceOfOutputReferencedByInputParameterFromMissingTrigger);c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_MISING_ACTION&&(l[c.VALIDATE_EXISTENCE_OF_OUTPUT_REFERENCED_BY_INPUT_PARAMETER_FROM_MISING_ACTION]=r.designerValidateExistenceOfOutputReferencedByInputParameterFromTrigger);c.COMPLEX_EDITOR_STATE&&(l[c.COMPLEX_EDITOR_STATE]=Object(y.b)(y.a.designerNewDictionaryEditor)||Object(y.b)(y.a.designerNewArrayEditor)||Object(y.b)(y.a.designerNewTableEditor));c.SUPPORT_OBFUSCATION&&(l[c.SUPPORT_OBFUSCATION]=!0);c.SUPPORT_WORKFLOW_PARAMETERS&&(l[c.SUPPORT_WORKFLOW_PARAMETERS]=n.isSolutionFlow);c.SORT_WORKFLOW_PARAMETERS_ALPHABETICALLY&&(l[c.SORT_WORKFLOW_PARAMETERS_ALPHABETICALLY]=n.isSolutionFlow);c.HIDE_AUTHENTICATION_KEY_PARAMETER&&(l[c.HIDE_AUTHENTICATION_KEY_PARAMETER]=!0);c.ENABLE_DYNAMIC_SCHEMA_OPTIONAL_PARAMETERS&&(l[c.ENABLE_DYNAMIC_SCHEMA_OPTIONAL_PARAMETERS]=r.designerEnableDynamicSchemaOptionalParameters);c.VNET_GATEWAY_FOR_CONNECTION&&(l[c.VNET_GATEWAY_FOR_CONNECTION]=!0);c.FLOW_NEW_SEARCH_VIEW&&(l[c.FLOW_NEW_SEARCH_VIEW]=r.designerNewRecommendationSearchView);c.EDITORS_V2_EXPERIENCE&&(l[c.EDITORS_V2_EXPERIENCE]=Object(y.b)(y.a.designerNewDictionaryEditor)&&Object(y.b)(y.a.designerNewArrayEditor));c.ENABLE_CONNECTIONWIZARD_ONLY_FOR_NATIVE_CONNECTORS&&(l[c.ENABLE_CONNECTIONWIZARD_ONLY_FOR_NATIVE_CONNECTORS]=r.enableConnectionWizardOnlyForNativeConnectors);c.ENABLE_ENUM_INPUT_OUTPUT_OVERWRITE&&(l[V.a.ENABLE_ENUM_INPUT_OUTPUT_OVERWRITE]=r.enableDesignerEnumInputOutputOverwrite);c.ENABLE_CREDENTIALS_MAPPING&&(l[V.a.ENABLE_CREDENTIALS_MAPPING]=r.enableCredentialsManager);return l}(t,r,H,e),se=(r,n)=>new t.PowerAppsBuiltInTypeService(function(e,t){var r={};r[V.a.SHOW_VARIABLE_ACTIONS]=!0,r[V.a.USE_BUTTON_TRIGGER]=!0,r[V.a.USE_CDS_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_CDS_FOR_APPS_FLOWSTEP_TRIGGER]=!0,r[V.a.USE_CDS_FOR_APPS_SELECT_TRIGGER]=!0,r[V.a.USE_DYNAMICSAX_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_EXCEL_FORMATTED_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_HUB_SITE_JOIN_APPROVAL_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_SHAREPOINT_FOR_A_SELECTED_FILE_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_TEAMS_FOR_A_SELECTED_MESSAGE_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_TEAMS_FOR_COMPOSING_A_MESSAGE_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_TEAMS_CARD_RESPONSE_TRIGGER]=!0,r[V.a.USE_TEAMS_TASK_MODULE_RESPONSE]=!0,r[V.a.NEW_RECOMMENDATION_CARD_WITH_MODULES]=!0,r[V.a.NEW_RECOMMENDATION_CARD_WITH_FOR_YOU]=!1,r[V.a.OPEN_API_CONNECTION]=Object(O.g)(e,t.environment.features)||t.apiOperationAuthoringBehavior===C.a.OpenApiConnection,t.loadScenario!==z.a.newFlowFromBlank&&(r[V.a.USE_D365_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_EXCEL_REQUEST_APICONNECTION_TRIGGER]=!0);return r[V.a.USE_GEOFENCE_REQUEST_TRIGGER]=!0,r[V.a.USE_FUNCTIONS]=e.enableFunctions,r[V.a.USE_ODB_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_POWERAPPSV2_TRIGGER]=!0,r[V.a.USE_POWERPAGES_HYBRID_TRIGGER]=e.enablePowerPagesTriggerAction,r[V.a.USE_POWERPAGES_TRIGGER_RESPONSE]=e.enablePowerPagesTriggerAction,r[V.a.USE_SKILLS_TRIGGER]=e.enableSkillsTrigger,r[V.a.USE_TEAMS_INCOMING_WEBHOOK_TRIGGER]=!0,r[V.a.USE_HTTP_OAUTH_TRIGGER]=e.enableHttpOAuthTrigger,r[V.a.USE_VIRTUAL_AGENT_TRIGGER_RESPONSE]=!0,r[V.a.USE_POWERBI_REQUEST_APICONNECTION_TRIGGER]=!0,r[V.a.USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_CASE_HYBRID_TRIGGER]=!0,r[V.a.USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_RISKY_USER_HYBRID_TRIGGER]=!0,r[V.a.USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_ITEM_HYBRID_TRIGGER]=!0,r[V.a.USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_CC_ITEM_HYBRID_TRIGGER]=!0,r[V.a.USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_PRIVACY_CASE_HYBRID_TRIGGER]=!0,r[V.a.USE_POWERVIRTUALAGENTS_HYBRID_TRIGGER]=!0,r[V.a.USE_MICROSOFT365_APPS_HEALTH_FOR_SELECTED_ADVISORY_HYBRID_TRIGGER]=!0,r[V.a.USE_DYNAMICSSMBSAAS_FOR_SELECTED_RECORD_HYBRID_TRIGGER]=!0,r}(H,e),n),le={getArmAccessToken:e.getArmAccessToken,getRuntimeAccessToken:e.getRuntimeAccessToken,getConsentServerAccessToken:e.getConsentServerAccessToken,oauthService:e.oAuthService,urlService:oe,baseUrl:Object(w.b)(e.environment.name,r).flowRP,apiVersion:e.environment?r.processSimpleResourceProviderApiVersionWithEnvironments:r.processSimpleResourceProviderApiVersion,logicFlowsRuntimeApiVersion:N.f,host:window.location.host,hostEnvironment:t.Host.ProcessSimple,hostVersion:o.a,sessionId:X.sessionId,designerSessionId:ae,telemetryBaseUrl:r.azureResourceManagementUri,telemetryVersion:N.g,startTelemetryPublish:Object(m.l)(r).startPublishingTelemetry,settings:{"ui.recommendation.tiers_to_display":["Premium"],"core.defaultRecurrence":Object(E.b)(J.userPlans),promotedServicesForActions:[...Object(m.l)(r).promotedServicesForActions],promotedServicesForTriggers:[...Object(m.l)(r).promotedServicesForTriggers],"ui.recommendation.search_debounce_rate":H.useNewDebounceRateConfigForOperationsRecommendationSearch?r.operationsRecommendationSearchDebounceRateInMillisec:null},features:ce,prefetchedData:e.prefetchedData,builtInTypeServiceFactory:se,connectionServiceFactory:t=>{var n,o={getAccessToken:e.getArmAccessToken,getConsentServerAccessToken:e.getConsentServerAccessToken,getPPAPIAccessToken:e.getPPAPIAccessToken,baseUrl:Object(j.a)(Object(w.c)(r).powerAppsRP),apiVersion:e.environment?r.powerAppsResourceProviderApiVersionWithEnvironments:r.powerAppsResourceProviderApiVersion,analytics:t,oauthService:e.oAuthService,ppapiService:e.ppapiService,urlService:oe,environment:{name:e.environment.name},showViewPermissionsDialog:e.showViewPermissionsDialog,locale:Object(g.a)(),onFirstPartyConnectionFailureCallback:e.onFirstPartyConnectionFailureCallback,template:e.templateName};return e.allowCoauthoring&&(o.allowCoauthoring=!0,o.getFlowConnectionsPath=()=>Object(P.a)(function(){throw new Error("Function not implemented.")}(),e.flowName+"/connections"),o.flowConnectionsApiVersion=r.processSimpleResourceProviderApiVersionWithEnvironments,o.isCoauthoredConnection=e.isCoauthoredConnection),!(Y&&Y.isTeamsSolutionExplorerContext()||H.enableHostConnectionService)||e.enableDietDesigner&&!e.isXrmConnectionReferenceMode?new ie(o):new I.a(o,null!==(n=e.solutionId)&&void 0!==n?n:"",e.getRuntimeAccessToken,e.isXrmConnectionReferenceMode)},connectionOperationsServiceFactory:n=>new t.PowerAppsConnectionOperationsService({getAccessToken:e.getArmAccessToken,baseUrl:Object(w.b)(e.environment.name,r).flowRP,apiVersion:e.environment?r.processSimpleResourceProviderApiVersionWithEnvironments:r.processSimpleResourceProviderApiVersion,analytics:n,urlService:oe,environment:e.environment,canAddOperation:e.canAddOperation,locale:Object(g.a)()}),runInstanceServiceFactory:e.runInstanceServiceFactory,runServiceFactory:e.runServiceFactory,userPreferenceServiceFactory:e.userPreferenceServiceFactory,dietViewServiceFactory:e.dietViewServiceFactory,analyticsServiceFactory:t=>{var{analyticsService:r}=e.context;return r.setContextData({designerSessionId:ae,designerVersion:t}),ce.DIET_VIEW&&r.setContextData({isDietView:!0}),r},azureADServiceFactory:e.azureADServiceFactory,documentationLinkServiceFactory:e.documentationLinkServiceFactory,operationResultSchemaServiceFactory:e.operationResultSchemaServiceFactory,hostServiceFactory:()=>new f.a(r,H,Z,e.context.gatewayService,e.context.gatewayStore,!!e.isSolutionFlow,!!e.isXrmConnectionReferenceMode,e.context.xrmMachineManagementService,e.context.machineManagementStore,e.context.rpaLocalService,e.context.surfaceStore,e.context.widgetUtilService,e.context.widgetService,e.context.assetService,e.context.environmentStore,e.context.loggingService),flowManagementServiceFactory:e.flowManagementServiceFactory,validationServiceFactory:e.validationServiceFactory,suggestionInfo:V.b,connectionWizardUIConfig:e.connectionWizardUIConfig||{},connectorV2ServiceFactory:e.connectorV2ServiceFactory,operationManifestServiceFactory:e.operationManifestServiceFactory,recommendationServiceFactory:e.recommendationServiceFactory||((t,n)=>{var o={analytics:t,featureFlags:H,apiOperationAuthoringBehavior:e.apiOperationAuthoringBehavior,userFeatures:e.context.userFeaturesStore.currentUserFeatures,builtInTypeService:se(0,n),canAddOperation:e.canAddOperation,environmentName:e.environment.name,environmentFeatures:e.environment.features,flowRPApiVersion:r.processSimpleResourceProviderApiVersionWithEnvironments,flowRPBaseUrl:Object(w.c)(r).flowRP,functionRPApiVersion:r.functionsResourceProviderApiVersion,functionRPBaseUrl:r.functionsResourceProviderManagementEndpoint,getFlowRPAccessToken:e.getArmAccessToken,getFunctionsRPAccessToken:e.getFunctionsRPAccessToken,isSolutionFlow:e.isSolutionFlow,locale:Object(g.a)(),operationManifestService:e.operationManifestServiceFactory&&e.operationManifestServiceFactory(),apiOperationService:e.apiOperationService,promotedConnectorsForActions:Object(m.l)(r).promotedServicesForActions,promotedConnectorsForTriggers:Object(m.l)(r).promotedServicesForTriggers,schemaVersion:n,useMyClipboard:H.cardViewServiceV2||!!ce.CARD_VIEW_SERVICE,visibleHideKeys:e.visibleHideKeys,universalSearchService:e.context.universalSearchService,setRecommendationContext:e.setRecommendationContext,assetService:e.context.assetService,cdnService:e.context.cdnService,clientResources:e.context.clientResources,flowServiceResources:e.context.clientResources,telemetryService:e.telemetryService,sharedComponentResources:e.context.clientResources};return new M.a(o)}),functionServiceFactory:t=>new p.a({analytics:t,baseUrl:r.functionsResourceProviderManagementEndpoint,apiVersion:r.functionsResourceProviderApiVersion,getAccessToken:e.getFunctionsRPAccessToken})};return le.editorServiceFactory=e.editorServiceFactory||(t=>new R.a(!!e.enableDietDesigner&&H.forceBetaDesignerEditorsForDietDesigner,e.context.widgetUtilService,H.enableEasyAutomationDataTrainingExperience,H.enableDefaultEditorCoachmark)),le.tokenPickerServiceFactory=e.tokenPickerServiceFactory||(e=>new U.a(Object(v.a)())),le.connectionParameterEditorServiceFactory=e.connectionParameterEditorServiceFactory||(t=>{return new x.a(H,{appSettings:(r=e.context).appSettings,featureFlags:r.featureFlags,loggingService:r.loggingService,telemetryService:r.telemetryService,xrmEntityHttpClient:r.xrmEntityHttpClient,flowHttpClient:r.flowHttpClient,flowRpHttpClient:r.flowRpHttpClient,desktopFlowAIHttpClient:r.desktopFlowAIHttpClient,neptuneHttpClient:r.neptuneHttpClient,desktopFlowRuntimeHttpClient:r.desktopFlowRuntimeHttpClient,azureResourceGraphHttpClient:r.azureResourceGraphHttpClient},e.context.clientResources,e.context.routeCrafter,{environmentStore:e.context.environmentStore,environmentCapabilityStore:e.context.environmentCapabilityStore});var r}),(ce.CARD_VIEW_SERVICE||Object(h.a)().cardViewServiceV2)&&(Object(h.a)().enableEasyAutomationDataTrainingExperience&&e.getWorkflowForEasyAutomation&&(e.context.easyAutomationPanelStore.getWorkflowDefinitionFunction=e.getWorkflowForEasyAutomation),le.cardViewServiceFactory=()=>Object(D.a)(e.invokerStateStore)),le.cardViewHeaderServiceFactory=e.cardViewHeaderServiceFactory||(()=>Object(_.a)(H,e.context.commentingPaneStore,e.context.clientResources,e.telemetryService,e.context.doNotShowAgainService,e.context.flowService,e.context.widgetUtilService)),le.customHookServiceFactory=()=>Object(L.a)(e.invokerStateStore),le.connectorServiceFactory=n=>new F.a(new t.ConnectorService({urlService:oe,analytics:n,baseUrl:Object(w.d)(e.environment.name,r),getAccessToken:e.getArmAccessToken,locale:Object(g.a)()}),n,r,H,e.getRuntimeAccessToken,Y,e.context.hostCommunicationService),le.dynamicCallApiVersion=r.processSimpleResourceProviderApiVersionWithEnvironments,le}function re(e,t){return e.allowCoauthoring?{validateParameter:(r,n,o,i,a)=>t.validateParameter(r,n,o,i,a,e.flowName)}:t}},20108:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="".concat("0.0.20250723.2-2507.3-prod"," ").concat("beafaf28f48e4b83781c35937489c9fc4a8d4d2e"," ").concat("2507.3"," (").concat("Wed, 23 Jul 2025 22:20:14 GMT",")")},20109:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(19699);function o(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function c(e){o(a,n,i,c,s,"next",e)}function s(e){o(a,n,i,c,s,"throw",e)}c(void 0)}))}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._options=void 0,this._client=void 0,this._analytics=void 0,!t.baseUrl)throw new Error("Functions : options.baseUrl required");if(!t.apiVersion)throw new Error("Functions : options.apiVersion required");if(!t.getAccessToken)throw new Error("Functions : options.getAcessToken required");if(!t.analytics)throw new Error("Functions : analytics service required");this._options=t,this._analytics=t.analytics,this._client=new n.e({analytics:this._analytics,baseUrl:this._options.baseUrl,getAccessToken:this._options.getAccessToken})}var t,r,o,c,s;return t=e,(r=[{key:"getFunctionAppSwagger",value:(s=i((function*(e){var t=yield this._client.post({path:"".concat(e,"/swagger"),query:{"api-version":this._options.apiVersion}});if(t.ok)return t.body;throw new Error("Error getting swagger for function app- ".concat(e))})),function(e){return s.apply(this,arguments)})},{key:"getFunctionApp",value:(c=i((function*(e){var t=yield this._client.get({path:e,query:{"api-version":this._options.apiVersion}});if(t.ok)return t.body;throw new Error("Error getting function group- ".concat(e))})),function(e){return c.apply(this,arguments)})}])&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20110:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(20111),o=r(20113),i=r(20149),a=r(20151),c=r(12366),s=r(17266),l=r(13143),u=r(19720),p=r(12339),f=r(12344),d=r(14918),m=r(20116),b=r(13031),y=r(18968);function v(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var O=function(){function e(t,r,n,o,c,u,f,d,m,y,h,g,O,w,E,C){var S=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.featureFlags=r,this.clientResources=n,this.gatewayService=o,this.gatewayStore=c,this.isSolutionFlow=u,this.isXrmConnectionReferenceMode=f,this.machineManagementService=d,this.machineManagementStore=m,this.rpaLocalService=y,this.surfaceStore=h,this.widgetUtilService=g,this.widgetService=O,this.assetService=w,this.environmentStore=E,this.loggingService=C,this.rpaConnectors=void 0,this.fetchAndDisplayContent=this.widgetUtilService.isWidgetPage()?void 0:(e,t,r,n)=>(Object(i.a)(this.surfaceStore,n,t,r),Promise.resolve()),this.retryScriptLoad=function(){var e,t=(e=function*(e){for(var t=Object(p.l)(S.appSettings).versionTag,r=Object(p.l)(S.appSettings).versions[t],n="/Content/Scripts/designer/".concat(t,"/v").concat(r,"/"),o=S.appSettings.retryCountForAsyncWebpackChunksLoading,i=0;i<=o;)try{return yield e()}catch(a){S.loggingService.logWarning("HostService.retryScriptLoad","Load failed",{retryCount:i,designerScriptsLocalPath:n,error:a}),window.publicPath=n}finally{++i}throw new s.a(l.b.hostServiceRetryScriptLoadFailed,Object(b.a)(S.clientResources.HostService.RetryScriptLoad.Failed,o))},function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){v(i,n,o,a,c,"next",e)}function c(e){v(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),this.rpaConnectors=Object(a.c)(n,this.assetService)}var t,r,g;return t=e,(r=[{key:"canGenerateConnectionDisplayName",value:function(e){return Object(y.b)(e)}},{key:"generateConnectionDisplayName",value:function(e,t,r){if(Object(y.b)(e))return Promise.resolve().then(()=>t?this.generateConnectionDisplayNameForDesktopFlowsLEGACYAsync(t):r?this.generateConnectionDisplayNameForDesktopFlowsAsync(r):this.desktopFlowConnectorName).catch(()=>this.desktopFlowConnectorName);throw new s.a(l.b.hostServiceCannotGenerateConnectionDisplayName,Object(b.a)(this.clientResources.HostService.CannotGenerateConnectionDisplayName,e))}},{key:"getMonitorFooterType",value:function(e){return o.a}},{key:"getConnectionCreationHeaderType",value:function(e){return Object(y.b)(e)?n.a:void 0}},{key:"getMissingGatewayTroubleshootDetails",value:function(){return{linkText:this.clientResources.HostService.MissingGatewayTroubleshootLinkText,linkUrl:"https://go.microsoft.com/fwlink/?linkid=2147532"}}},{key:"getConnectionParameterDefaultValue",value:function(e,t){try{if(e===c.B.connectorId){if(t===c.B.connectionParameterKey.username||t===c.B.connectionParametersSetConfigKey.username)return this.rpaLocalService.getCurrentUserName();t!==c.B.connectionParameterKey.gateway&&t!==c.B.connectionParametersSetConfigKey.gateway||this.rpaLocalService.setGatewayRegionName(this.environmentStore.currentEnvironment.environmentGatewayRegion)}else if(e===c.y.connectorId){if(t===c.y.connectionParameterKey.database||t===c.y.connectionParameterKey.server)return this.widgetService.getSQLFilterConnectionValues(e,t);if(t===c.y.connectionParameterKey.connectionName)return this.widgetService.getSQLFilterConnectionValues(e,c.y.connectionParameterKey.database)}}catch(r){}return Promise.resolve(void 0)}},{key:"getCustomRetrySettings",value:function(e,t){if(e&&t&&this.rpaConnectors[e]&&Object.values(a.b).some(e=>e===t)){var r=[{value:"default",title:this.clientResources.HostService.RpaActions.Retry.OptionPicker.Default},{value:"none",title:this.clientResources.HostService.RpaActions.Retry.OptionPicker.None},{value:"fixed",title:this.clientResources.HostService.RpaActions.Retry.OptionPicker.Custom}],n=this.clientResources.HostService.RpaActions.Retry.Interval.ErrorMessage;return{description:this.clientResources.HostService.RpaActions.Retry.DescriptionGA,placeholder:this.clientResources.HostService.RpaActions.Retry.PlaceholderText,customOptions:r,minValue:this.appSettings.rpaActionRetryMinValue,maxValue:this.appSettings.rpaActionRetryMaxValue,validation(e){var t=Object(d.Q)(e.interval);if(t<1||t>600)return{key:"RetryIntervalInvalid",message:n,shouldRenderBelowConfigurationsSections:!1}}}}}},{key:"getCustomTimeoutSettings",value:function(e,t){if(e&&t){var r=this.clientResources.HostService.RpaActions.Timeout.ErrorMessage;return this.rpaConnectors[e]&&Object.values(a.b).some(e=>e===t)?{description:this.clientResources.HostService.RpaActions.Timeout.DescriptionGA,placeholder:this.clientResources.HostService.RpaActions.Timeout.Placeholder,validation(e){var t=Object(d.Q)(e);if(t<60||t>86400)return{key:"TimeoutValueInvalid",message:r,shouldRenderBelowConfigurationsSections:!1}}}:void 0}}},{key:"getNewConnectionCreationLabel",value:function(){return this.isXrmConnectionReferenceMode&&(this.widgetUtilService.isTeamsSolutionExplorerContext()||this.featureFlags.enableUIChangesForXRMConnectionReferences)?this.clientResources.Designer.NewConnectionReferenceLabel:this.clientResources.Designer.AddNewConnectionLabel}},{key:"getNewConnectionMenuItemLabel",value:function(){return this.isXrmConnectionReferenceMode&&(this.widgetUtilService.isTeamsSolutionExplorerContext()||this.featureFlags.enableUIChangesForXRMConnectionReferences)?this.clientResources.Designer.ConnectionReferenceMenuTitleLabel:this.clientResources.Manage.Connections.MyConnections}},{key:"getCoAuthoredConnectionMenuItemLabel",value:function(){return this.isXrmConnectionReferenceMode&&(this.widgetUtilService.isTeamsSolutionExplorerContext()||this.featureFlags.enableUIChangesForXRMConnectionReferences)?this.clientResources.Designer.OtherConnectionReferenceMenuTitleLabel:this.clientResources.Manage.Connections.OtherConnections}},{key:"blockTokensForTrigger",value:function(e,t){if(this.isSolutionFlow&&this.featureFlags.enableEnvironmentVariablesForAllTriggers)switch(e){case c.f.SCHEDULE:return!0;default:return!1}if(e===c.f.HTTP&&"httpwebhook"===t)return!1;if(this.isSolutionFlow)switch(e){case c.f.COMMON_DATA_SERVICE:case c.f.COMMON_DATA_SERVICE_FOR_APPS:case c.f.SHAREPOINT:case c.f.SQL:return!1;default:return!0}return!0}},{key:"getTokenGroupWorkflowParameterLabel",value:function(){return this.isSolutionFlow?this.clientResources.TokenGroup.EnvironmentVariables.Label:this.clientResources.TokenGroup.Parameters.Label}},{key:"generateConnectionDisplayNameForDesktopFlowsLEGACYAsync",value:function(e){var t=Object(m.a)(e,c.B.connectionParameterKey.gateway),r=Object(m.a)(e,c.B.connectionParameterKey.username);return this.generateGatewayConnectionDisplayNameForDesktopFlowsAsync(t.id,r)}},{key:"generateConnectionDisplayNameForDesktopFlowsAsync",value:function(e){var t=e.values[c.B.connectionParametersSetKey.username].value;if(t&&Object(u.b)(t))return Promise.resolve(void 0);switch(e.name){case c.B.connectionParametersSetName.azureRelay:var r=e.values[c.B.connectionParametersSetKey.targetId].value;return this.generateAzureRelayConnectionDisplayNameForDesktopFlowsAsync(r,t);case c.B.connectionParametersSetName.onPremisesDataGateway:var n=e.values[c.B.connectionParametersSetKey.gateway].value.id;return this.generateGatewayConnectionDisplayNameForDesktopFlowsAsync(n,t);default:return Promise.resolve(this.desktopFlowConnectorName)}}},{key:"generateGatewayConnectionDisplayNameForDesktopFlowsAsync",value:function(e,t){var r=Object(m.c)(e),n=this.environmentStore.currentEnvironmentName;return this.gatewayService.getGateway({gatewayName:r,environmentName:n}).then(()=>this.gatewayStore.gateways.getEntity(r).displayName).then(e=>"".concat(t," (").concat(e,")"))}},{key:"generateAzureRelayConnectionDisplayNameForDesktopFlowsAsync",value:function(e,t){return this.machineManagementService.getMachineGroupDetails(e).then(()=>this.machineManagementStore.machineGroups.getEntity(e).properties.displayName).then(e=>Object(b.a)(this.clientResources.HostService.MachineConnectionDisplayName,t,e))}},{key:"desktopFlowConnectorName",get:function(){return Object(f.d)(this.featureFlags)?this.clientResources.DesktopFlowConnectorName:this.clientResources.DesktopFlowConnectorNamePreview}}])&&h(t.prototype,r),g&&h(t,g),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20111:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(11766),o=r(12706),i=r(20112),a=r(15995),c=r(14346),s=r(19713);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(b,e);var t,r,p,m=d(b);function b(){var e;l(this,b);for(var t=arguments.length,r=new Array(t),u=0;u<t;u++)r[u]=arguments[u];return(e=m.call(this,...r)).classNames=Object(o.a)()(i.a),e._editorContext=Object(s.a)(),e.renderSegmentHandler=(t,r)=>{var{designerResources:o}=e._editorContext;switch(t.type){case a.b.LITERAL:return n.createElement("span",{key:r},t.value);case a.b.PLACEHOLDER:return n.createElement(c.a,{key:r,ariaLabel:o.Designer.ConnectionCreationHeader.UIFlow.LearnMoreLinkText,href:"https://go.microsoft.com/fwlink/?linkid=2118059",target:c.b.blank},o.Designer.ConnectionCreationHeader.UIFlow.LearnMoreLinkText);default:return null}},e}return t=b,(r=[{key:"render",value:function(){var{designerResources:e}=this._editorContext;return n.createElement("div",{className:this.classNames.headerContentContainer},n.createElement(a.a,{formatText:e.Designer.ConnectionCreationHeader.UIFlow.HeaderText,onRenderSegment:this.renderSegmentHandler}))}}])&&u(t.prototype,r),p&&u(t,p),Object.defineProperty(t,"prototype",{writable:!1}),b}(n.Component)},20112:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({headerContentContainer:[".fl-UIFlowConnectionCreationHeader",{margin:"0 8px",fontSize:n.k.small}]})},20113:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(11766),o=r(13275),i=r(20114),a=r(20148);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(d,e);var t,r,l,f=p(d);function d(){return c(this,d),f.apply(this,arguments)}return t=d,(r=[{key:"render",value:function(){return n.createElement(o.a,{gap:10,padding:10},n.createElement("div",null,this.renderConnectionDetails(),this.renderUIFlowRunDetails()))}},{key:"renderConnectionDetails",value:function(){return n.createElement(i.a,{connection:this.props.connection,connectorId:this.props.connectorId,outputsLink:this.props.outputsLink})}},{key:"renderUIFlowRunDetails",value:function(){return n.createElement(a.a,{inputs:this.props.inputs,outputs:this.props.outputs,inputsLink:this.props.inputsLink,outputsLink:this.props.outputsLink,connectorId:this.props.connectorId})}}])&&s(t.prototype,r),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),d}(n.Component)},20114:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var n,o,i=r(14876),a=r(11766),c=r(12812),s=r(13275),l=r(12706),u=r(14337),p=r(11773),f=r(20115),d=r(12728),m=r(19713),b=r(13260),y=r(14346),v=r(14895),h=r(13272),g=r(14901),O=r(11891),w=r(12366),E=r(20116),C=r(20117),S=r(20118),P=r(20147),j=r(18968);function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R(n.key),n)}}function R(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function N(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=D(e);if(t){var o=D(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _(this,r)}}function _(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var A=Object(u.c)((I((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(u,e);var t,r,n,o=N(u);function u(){var e;T(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).classNames=Object(l.a)()(f.b),e.connectionToolTipId=Object(d.a)("fl-footerConnectionDetails"),e._editorContext=Object(m.a)(),e}return t=u,(r=[{key:"componentDidMount",value:function(){this._editorContext.connectionService.getConnections({forceRefresh:!1})}},{key:"render",value:function(){return this.isPersonalConnection?a.createElement("div",null,this.renderConnectionDetails()):null}},{key:"renderConnectionDetails",value:function(){var e,{connection:t}=this.props,{designerResources:r}=this._editorContext,n=t&&t.properties&&t.properties.displayName,o=null==t||null===(e=t.properties)||void 0===e||null===(e=e.statuses[0])||void 0===e?void 0:e.status,i=this.hasGateway()?this.classNames.displayConnectionAndGatewayContainer:this.classNames.displayOnlyConnectionContainer;return a.createElement(s.a,{gap:10,padding:10,horizontal:!0},a.createElement("div",null,r.RunFlow.Connection.Link.Text,":"),a.createElement("div",{className:i},a.createElement(b.b,{text:n,id:this.connectionToolTipId},a.createElement(y.a,{ariaLabel:n,href:this.connectionRoute(),target:y.b.blank,dataAutomationId:P.a.connectionAnchor},n))),a.createElement(c.a,{iconName:o===v.c.connected?h.a.Connected:h.a.ConnectionError,styles:o===v.c.connected?f.c:f.a}),this.hasGateway()&&this.renderGatewayLink(),this.isUsingMachine&&this.renderMachineLink())}},{key:"renderGatewayLink",value:function(){var{connectorId:e}=this.props;return a.createElement(C.a,{connectorId:e,gatewayName:this.gatewayName})}},{key:"renderMachineLink",value:function(){var{outputsLink:e}=this.props;return a.createElement(S.a,{outputsLink:e})}},{key:"connectionRoute",value:function(){var{connection:e}=this.props,{routeCrafter:t}=this._editorContext,r=e&&e.name,n=e&&e.properties&&e.properties.apiId,o=n&&n.substr(n.lastIndexOf("/")+1)||"";return Object(g.c)({crafter:t,apiName:o,connectionName:r})}},{key:"hasGateway",value:function(){return!Object(i.a)(this.gatewayName)}},{key:"isUsingMachine",get:function(){var{connection:e,connectorId:t}=this.props;if(Object(j.b)(t)){var r,n=e&&e.name&&this._editorContext.connectionStore.connections.getEntity(e.name);if(null!=n&&null!==(r=n.properties)&&void 0!==r&&r.connectionParametersSet)switch(n.properties.connectionParametersSet.name){case w.B.connectionParametersSetName.onPremisesDataGateway:return!1;case w.B.connectionParametersSetName.azureRelay:default:return!0}}return!1}},{key:"isPersonalConnection",get:function(){var e,{connection:t}=this.props,{sessionStore:r}=this._editorContext,n=r.user&&r.user.uniqueId,o=null==t||null===(e=t.properties)||void 0===e||null===(e=e.createdBy)||void 0===e?void 0:e.id;return!Object(i.a)(n)&&!Object(i.a)(o)&&Object(O.a)(n,o)}},{key:"gatewayName",get:function(){var e,{connection:t,connectorId:r}=this.props;if(Object(j.b)(r)){var n,o=t&&t.name&&this._editorContext.connectionStore.connections.getEntity(t.name);if(null!=o&&null!==(n=o.properties)&&void 0!==n&&n.connectionParametersSet)switch(o.properties.connectionParametersSet.name){case w.B.connectionParametersSetName.onPremisesDataGateway:var i=Object(E.b)(o.properties.connectionParametersSet);return i&&Object(E.c)(i);case w.B.connectionParametersSetName.azureRelay:default:return}}var a=null==t||null===(e=t.properties)||void 0===e?void 0:e.connectionParameters,c=a&&Object(E.a)(a,w.B.connectionParameterKey.gateway);return c&&Object(E.c)(c.id)}}])&&k(t.prototype,r),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(a.Component)).prototype,"isUsingMachine",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"isUsingMachine"),o.prototype),I(o.prototype,"isPersonalConnection",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"isPersonalConnection"),o.prototype),I(o.prototype,"gatewayName",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"gatewayName"),o.prototype),n=o))||n},20115:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{displayOnlyConnectionContainer:["fl-footerConnectionDetailsOnly",{width:"calc(100% - 10px)",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:e.themePrimary}],displayConnectionAndGatewayContainer:["fl-footerConnectionAndGatewayDetails",{width:"calc(100% - 10px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:e.themePrimary}]}},i={root:{color:Object(n.Y)().palette.green}},a={root:{color:Object(n.Y)().palette.red}}},20116:function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c}));var n=r(12366),o=r(14883);function i(e){return e&&e.split("/").pop()}function a(e,t){for(var r of Object.keys(e))if(Object(o.e)(r,t))return e[r]}function c(e){var t=function(e){if(e&&e.name===n.B.connectionParametersSetName.onPremisesDataGateway)return e.values&&e.values[n.B.connectionParametersSetKey.gateway]||void 0}(e);return t&&t.value&&t.value[n.B.connectionParametersSetValuesKey.gateway.gatewayObjectId]}},20117:function(e,t,r){"use strict";r.d(t,"a",(function(){return N}));var n,o,i,a,c=r(13275),s=r(12706),l=r(12728),u=r(14876),p=r(12328),f=r.n(p),d=r(11773),m=r(14337),b=r(11766),y=r(14346),v=r(13260),h=r(14901),g=r(19713),O=r(20115),w=r(18968);function E(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=R(e);if(t){var o=R(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return T(this,r)}}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var N=Object(m.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(p,e);var t,r,n,o=j(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=o.call(this,e)).classNames=Object(s.a)()(O.b),t.gatewayToolTipId=Object(l.a)("fl-GatewayDetails"),t._editorContext=Object(g.a)(),E(t,"isGatewayLoading",i,k(t)),E(t,"setIsGatewayLoading",a,k(t)),t.setIsGatewayLoading(!0),t}return t=p,(r=[{key:"render",value:function(){return b.createElement("div",null,this.renderGatewayLink())}},{key:"renderGatewayLink",value:function(){var{gatewayName:e,connectorId:t}=this.props,{designerResources:r,routeCrafter:n}=this._editorContext;if(Object(w.b)(t)&&e){var o=this.classNames.displayConnectionAndGatewayContainer;return b.createElement("div",null,!this.isGatewayLoading&&!!this.gateway&&b.createElement(c.a,{tokens:{childrenGap:10},horizontal:!0},b.createElement("div",null,r.RunFlow.Gateway.Link.Label,":"),b.createElement(v.b,{text:this.gatewayDisplayName,id:this.gatewayToolTipId},b.createElement(y.a,{ariaLabel:this.gatewayDisplayName,href:Object(h.o)(n,{gatewayName:this.gateway.name}),target:y.b.blank},!Object(u.a)(this.gateway.displayName)&&b.createElement("div",{className:o},this.gatewayDisplayName)))))}return null}},{key:"componentDidMount",value:function(){var{connectorId:e,gatewayName:t}=this.props;Object(w.b)(e)&&t&&(this.setIsGatewayLoading(!0),this.getGatewayForUIFlow().then(()=>{this.setIsGatewayLoading(!1)}).catch(()=>{this.setIsGatewayLoading(!0)}))}},{key:"getGatewayForUIFlow",value:function(){var e=this.props.gatewayName,{gatewayService:t,environmentStore:r}=this._editorContext;return t.getGateway({gatewayName:e,environmentName:r.currentEnvironmentName}).then(()=>this.gateway)}},{key:"gatewayDisplayName",get:function(){return Object(u.a)(this.gateway.machineName)?this.gateway.displayName:"".concat(this.gateway.displayName," (").concat(this.gateway.machineName,")")}},{key:"gateway",get:function(){var{gatewayName:e}=this.props,{gatewayStore:t}=this._editorContext,r=t.gateways.getEntity(e);return f()(r,"Gateway ".concat(e," does not exist in the store!")),r}}])&&C(t.prototype,r),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(b.Component),i=x(o.prototype,"isGatewayLoading",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x(o.prototype,"gatewayDisplayName",[d.computed],Object.getOwnPropertyDescriptor(o.prototype,"gatewayDisplayName"),o.prototype),x(o.prototype,"gateway",[d.computed],Object.getOwnPropertyDescriptor(o.prototype,"gateway"),o.prototype),a=x(o.prototype,"setIsGatewayLoading",[d.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isGatewayLoading=e}}}),n=o))||n},20118:function(e,t,r){"use strict";r.d(t,"a",(function(){return D}));var n,o,i,a,c,s,l=r(13275),u=r(12706),p=r(11773),f=r(14337),d=r(11766),m=r.n(d),b=r(16841),y=r(20119),v=r(15396),h=r(15212),g=r(19713),O=r(20136),w=r(20137),E=r(20138);function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function S(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j(n.key),n)}}function j(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=N(e);if(t){var o=N(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R(this,r)}}function R(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var D=Object(f.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(f,e);var t,r,n,o=k(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=o.call(this,e)).classNames=Object(u.a)()(w.a),t._editorContext=Object(g.a)(),S(t,"initializationOperation",i,x(t)),S(t,"uiFlowRunId",a,x(t)),S(t,"initialize",c,x(t)),S(t,"setUIFlowRunId",s,x(t)),Object(p.runInAction)("footerMachineDetails.constructor",()=>{t.initializationOperation=h.b.AboutToStart(),t.uiFlowRunId=null}),t}return t=f,(r=[{key:"render",value:function(){if(this.props.outputsLink&&this.uiFlowRunId){var e=this.targetRender;if(e){var{designerResources:t}=this._editorContext,r=this.classNames.displayConnectionAndGatewayContainer;return m.a.createElement("div",null,m.a.createElement(l.a,{horizontal:!0,tokens:{childrenGap:10}},m.a.createElement("div",null,t.RunFlow.Gateway.Target.Label,":"),m.a.createElement("div",{className:r},e)))}}return null}},{key:"componentDidMount",value:function(){Object(v.d)({promise:this.initialize(),eventName:O.b.machineDetails,sourcePage:O.a.RunDetails,loggingService:this._editorContext.loggingService})}},{key:"targetRender",get:function(){if(this.uiFlowRun)return this.machine&&this.machineGroup?void 0!==this.machineGroup.properties.managementType&&this.machineGroup.properties.managementType===b.o.Managed?this.renderMachineGroup:this.renderMachine:!this.machine&&this.machineGroup?this.renderMachineGroup:void 0}},{key:"renderMachine",get:function(){var{flowServiceClientResources:e,machineManagementStore:t,uiFlowRunStore:r,routeCrafter:n,telemetryService:o,featureFlags:i,assetService:a,environmentCapabilityStore:c,environmentStore:s}=this._editorContext,l={flowServiceClientResources:e,machineManagementStore:t,uiFlowRunsStore:r,routeCrafter:n,telemetryService:o,featureFlags:i,assetService:a,environmentCapabilityStore:c,environmentStore:s};return m.a.createElement(y.a,C({uiFlowRunId:this.uiFlowRunId,canUseNoContextStore:!1},l))}},{key:"renderMachineGroup",get:function(){return m.a.createElement(E.a,{uiFlowRunId:this.uiFlowRunId})}},{key:"uiFlowRun",get:function(){var{uiFlowRunStore:e}=this._editorContext;if(null!==this.uiFlowRunId)return e.getUIFlowRunEntityContext(this.uiFlowRunId)}},{key:"machine",get:function(){var{machineManagementStore:e}=this._editorContext;if(this.uiFlowRun&&this.uiFlowRun._machineid_value)return e.machines.getEntity(this.uiFlowRun._machineid_value)}},{key:"machineGroup",get:function(){var{machineManagementStore:e}=this._editorContext;if(this.uiFlowRun&&this.uiFlowRun._machinegroupid_value)return e.machineGroups.getEntity(this.uiFlowRun._machinegroupid_value)}}])&&P(t.prototype,r),n&&P(t,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(m.a.Component),i=_(o.prototype,"initializationOperation",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=_(o.prototype,"uiFlowRunId",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=_(o.prototype,"initialize",[p.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{outputsLink:e}=this.props,{flowRunInputsOutputsService:t,uiFlowRunService:r,xrmMachineManagementService:n,environmentCapabilityService:o}=this._editorContext;return this.initializationOperation=Object(h.d)(t.getFlowRunActionOutputFromLink(e||"").then(e=>{this.setUIFlowRunId(e),null!==this.uiFlowRunId&&void 0!==this.uiFlowRunId&&r.loadUiFlowRun({flowName:void 0,environmentName:void 0,runName:this.uiFlowRunId}).then(()=>o.batchFetchControlCenterCapabilities()).then(()=>{this.uiFlowRun&&this.uiFlowRun._machineid_value&&n.getMachineDetails(this.uiFlowRun._machineid_value),this.uiFlowRun&&this.uiFlowRun._machinegroupid_value&&n.getMachineGroupDetails(this.uiFlowRun._machinegroupid_value)})})),this.initializationOperation.promise}}}),_(o.prototype,"targetRender",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"targetRender"),o.prototype),_(o.prototype,"renderMachine",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"renderMachine"),o.prototype),_(o.prototype,"renderMachineGroup",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"renderMachineGroup"),o.prototype),_(o.prototype,"uiFlowRun",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"uiFlowRun"),o.prototype),_(o.prototype,"machine",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"machine"),o.prototype),_(o.prototype,"machineGroup",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"machineGroup"),o.prototype),s=_(o.prototype,"setUIFlowRunId",[p.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.uiFlowRunId=e}}}),n=o))||n},20136:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n=function(e){return e.RunDetails="CloudFlowRunDetails",e}({}),o=function(e){return e.default="default",e.machineDetails="DS_UI_Footer_MachineDetails",e}({})},20137:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({displayConnectionAndGatewayContainer:["fl-footerConnectionAndGatewayDetails",{width:"calc(100% - 10px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:Object(n.Y)().palette.themePrimary}]})},20138:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o=r(14337),i=r(11766),a=r.n(i),c=r(20139),s=r(19713),l=r(20120);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=Object(o.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(i,e);var t,r,n,o=b(i);function i(){var e;p(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r))._editorContext=Object(s.a)(),e}return t=i,(r=[{key:"render",value:function(){var{uiFlowRunId:e}=this.props,{uiFlowRunStore:t,flowServiceClientResources:r,machineManagementStore:n,routeCrafter:o,telemetryService:i,featureFlags:s,environmentStore:p,environmentCapabilityStore:f,assetService:d,neptuneStore:m}=this._editorContext,b=t.getUIFlowRunEntityContext(e),y={flowServiceClientResources:r,machineManagementStore:n,routeCrafter:o,telemetryService:i,featureFlags:s,environmentStore:p,environmentCapabilityStore:f,assetService:d,neptuneStore:m};return b&&b._machinegroupid_value?a.a.createElement(c.a,u({machineGroupName:b._machinegroupid_value,showStateIcons:!1},y)):l.a}}])&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a.Component))||n},20147:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={root:"cloudFlowRunDetailsPage",desktopFlowRunAnchor:"desktopFlowRunAnchor",connectionAnchor:"connectionAnchor"}},20148:function(e,t,r){"use strict";r.d(t,"a",(function(){return D}));var n,o,i,a,c,s,l,u,p,f,d=r(11766),m=r(13275),b=r(14337),y=r(11773),v=r(19713),h=r(13029),g=r(14346),O=r(13240),w=r(14900),E=r(20147),C=r(18968);function S(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j(n.key),n)}}function j(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=N(e);if(t){var o=N(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R(this,r)}}function R(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var D=Object(b.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(b,e);var t,r,n,o=k(b);function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),S(t=o.call(this,e),"uiFlowId",i,x(t)),S(t,"uiFlowRunId",a,x(t)),S(t,"isInputsLoading",c,x(t)),S(t,"isOutputsLoading",s,x(t)),t._editorContext=Object(v.a)(),t.onClickUIFlowRunLink=()=>{t._editorContext.telemetryService.tagEvent(O.c.UIFlowRunLinkClicked)},S(t,"setUIFlowId",l,x(t)),S(t,"setUIFlowRunId",u,x(t)),S(t,"setIsInputsLoading",p,x(t)),S(t,"setIsOutputsLoading",f,x(t)),t.setIsInputsLoading(!0),t.setIsOutputsLoading(!0),t}return t=b,(r=[{key:"render",value:function(){return d.createElement("div",null,this.renderUIFlowRunLink())}},{key:"renderUIFlowRunLink",value:function(){var{connectorId:e}=this.props,{designerResources:t}=this._editorContext;return Object(C.b)(e)?d.createElement("div",null,!this.isInputsLoading&&!this.isOutputsLoading&&d.createElement(m.a,{gap:10,padding:10},d.createElement(g.a,{ariaLabel:t.RunFlow.UIFlowRun.Link.Label,href:this.uiFlowRunLinkRoute(),target:h.a.blank,onClick:this.onClickUIFlowRunLink,dataAutomationId:E.a.desktopFlowRunAnchor},t.RunFlow.UIFlowRun.Link.Label))):null}},{key:"componentDidMount",value:function(){var{inputs:e,outputs:t,inputsLink:r,outputsLink:n,connectorId:o}=this.props,{flowRunInputsOutputsService:i,loggingService:a}=this._editorContext;Object(C.b)(o)&&(this.setIsInputsLoading(!0),i.getFlowRunActionInputFromLink(r||"").then(e=>{this.setUIFlowId(e),this.setIsInputsLoading(!1)}).catch(e=>{a.logError("FooterUIFlowRunLink.componentDidMount.LoadInputsError",e),this.setIsInputsLoading(!0)}),this.setIsOutputsLoading(!0),i.getFlowRunActionOutputFromLink(n||"").then(e=>{this.setUIFlowRunId(e),this.setIsOutputsLoading(!1)}).catch(e=>{a.logError("FooterUIFlowRunLink.componentDidMount.LoadOutputsError",e),this.setIsOutputsLoading(!0)}))}},{key:"uiFlowRunLinkRoute",value:function(){var{routeCrafter:e}=this._editorContext;return Object(w.n)(e,{flowName:this.uiFlowId,runName:this.uiFlowRunId,isUIFlow:!0,isLegacyShared:!1,solutionId:void 0})}}])&&P(t.prototype,r),n&&P(t,n),Object.defineProperty(t,"prototype",{writable:!1}),b}(d.Component),i=_(o.prototype,"uiFlowId",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=_(o.prototype,"uiFlowRunId",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=_(o.prototype,"isInputsLoading",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=_(o.prototype,"isOutputsLoading",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=_(o.prototype,"setUIFlowId",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.uiFlowId=e}}}),u=_(o.prototype,"setUIFlowRunId",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.uiFlowRunId=e}}}),p=_(o.prototype,"setIsInputsLoading",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isInputsLoading=e}}}),f=_(o.prototype,"setIsOutputsLoading",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isOutputsLoading=e}}}),n=o))||n},20149:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f}));var n=r(12728),o=r(11766),i=r(16834),a=r(20150);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=Object(i.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({flowRunInputsOutputsService:e.flowRunInputsOutputsService,loggingService:e.loggingService,sharedComponentResources:e.sharedComponentResources,surfaceStore:e.surfaceStore,telemetryService:e.telemetryService},t))(a.b);function p(e,t,r,i,a,s){e.spawn({key:Object(n.a)("raw-operation-io-value-surface"),hideOnDismiss:!0,render:e=>o.createElement(u,c({contentType:t,title:r,url:i,panelAutomationId:a,valueAutomationId:s,dataLoadingFailureTelemetryEventNamePrefix:"DesignerV1RawOperationIoValueSurface"},e))})}function f(e,t,r,i,s,l,u,p,f,d){e.spawn({key:Object(n.a)("raw-operation-io-value-surface"),hideOnDismiss:!0,render:n=>o.createElement(a.b,c({sharedComponentResources:s,telemetryService:l,loggingService:u,flowRunInputsOutputsService:p,surfaceStore:e,contentType:t,title:r,url:i,panelAutomationId:f,valueAutomationId:d,dataLoadingFailureTelemetryEventNamePrefix:"DesignerV3RawOperationIoValueSurface"},n))})}},20150:function(e,t,r){"use strict";r.d(t,"b",(function(){return T}));var n=r(19199);r.d(t,"a",(function(){return n.a}));var o,i,a,c,s,l,u=r(11766),p=r(14337),f=r(11773),d=r(14947),m=r(13241),b=r(14346),y=r(20057);function v(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return C(e)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var j=function(e){return e[e.Loading=0]="Loading",e[e.Fail=1]="Fail",e[e.Success=2]="Success",e}(j||{}),T=Object(p.c)((i=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(p,e);var t,r,o,i=w(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),v(t=i.call(this,e),"loadState",a,C(t)),v(t,"rawValue",c,C(t)),v(t,"setRawValue",s,C(t)),v(t,"setLoadState",l,C(t)),Object(f.runInAction)(()=>{t.loadState=j.Loading,t.rawValue=void 0}),t}return t=p,(r=[{key:"render",value:function(){return u.createElement(d.a,{dismissOnEscape:!0,isOpen:!0,title:this.props.title,onDismissed:this.props.dismiss,onOuterClick:this.props.dismiss,hasCloseButton:!0,size:d.b.medium,stretchContentHeight:!0,dataAutomationId:this.props.panelAutomationId},u.createElement("span",null,this.props.title),this.renderContent())}},{key:"renderContent",value:function(){switch(this.loadState){case j.Loading:return u.createElement(m.a,{size:m.b.medium});case j.Fail:return u.createElement("div",null,u.createElement(b.a,{ariaLabel:this.props.sharedComponentResources.RawInputsOutputs.LinkToRawValueAria,href:this.props.url,target:b.b.blank},this.props.url));case j.Success:var e;try{if(this.rawValue){var t=JSON.parse(this.rawValue);e=JSON.stringify(t,null,4)}}catch(r){e=this.rawValue}return u.createElement(y.a,{loggingService:this.props.loggingService,value:e,options:{readOnly:!0,automaticLayout:!0},width:"100%",height:"100%",automationId:this.props.valueAutomationId,dataLoadingFailureTelemetryEventNamePrefix:this.props.dataLoadingFailureTelemetryEventNamePrefix});default:return null}}},{key:"componentDidMount",value:function(){(this.props.contentType===n.a.Inputs?this.props.flowRunInputsOutputsService.getFlowActionRawInputsFromLink(this.props.url):this.props.flowRunInputsOutputsService.getFlowActionRawOutputsFromLink(this.props.url)).then(e=>{200!==e.status?this.setLoadState(j.Fail):(e.data.host&&e.data.host.apiId&&delete e.data.host.apiId,this.setRawValue(JSON.stringify(e.data)),this.setLoadState(j.Success))}).catch(e=>{this.setLoadState(j.Fail),this.props.loggingService.logError("".concat(this.props.dataLoadingFailureTelemetryEventNamePrefix,"_rawOperationIOValueSurface.componentDidMount"),e)})}}])&&h(t.prototype,r),o&&h(t,o),Object.defineProperty(t,"prototype",{writable:!1}),p}(u.Component),a=P(i.prototype,"loadState",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=P(i.prototype,"rawValue",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=P(i.prototype,"setRawValue",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.rawValue=e}}}),l=P(i.prototype,"setLoadState",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.loadState=e}}}),o=i))||o},20151:function(e,t,r){"use strict";r.d(t,"b",(function(){return D})),r.d(t,"a",(function(){return M})),r.d(t,"c",(function(){return U})),r.d(t,"g",(function(){return V})),r.d(t,"e",(function(){return z})),r.d(t,"d",(function(){return G})),r.d(t,"f",(function(){return W})),r.d(t,"h",(function(){return H}));var n=r(12754),o=r(12999),i=r(20152),a=r(12344);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u={getSelector:{type:"string","x-ms-visibility":Object(o.a)().enableRpaGetSelector?void 0:"internal"}},p=e=>({selector:{type:"object",title:e.RpaOperations.SelectParameter.Title,description:e.RpaOperations.SelectParameter.Description,"x-ms-visibility":"advanced"}}),f=e=>({selectors:{type:"array",title:e.RpaOperations.SelectorsParameter.Title,description:e.RpaOperations.SelectorsParameter.Description,"x-ms-visiblity":"advanced"}}),d=e=>({waitAfterAction:{type:"string",title:e.RpaOperations.WaitAfterActionParameter.Title,description:e.RpaOperations.WaitAfterActionParameter.Description,"x-ms-visibility":"advanced"}}),m=e=>({value:{type:"string",title:e.RpaOperations.ValueParameter.Title,description:e.RpaOperations.ValueParameter.Description}}),b=e=>({value:{type:"string",format:"xml",title:e.RpaOperations.XMLValueParameter.Title,description:e.RpaOperations.XMLValueParameter.Description}}),y=e=>({keyboardInitialState:{type:"object",properties:{capsLock:{type:"boolean",title:e.RpaOperations.KeyboardInitialState.CapsLockParameter.Title,description:e.RpaOperations.KeyboardInitialState.CapsLockParameter.Description,"x-ms-visibility":"advanced"},numLock:{type:"boolean",title:e.RpaOperations.KeyboardInitialState.NumLockParameter.Title,description:e.RpaOperations.KeyboardInitialState.NumLockParameter.Description,"x-ms-visibility":"advanced"},scrollLock:{type:"boolean",title:e.RpaOperations.KeyboardInitialState.ScrollLockParameter.Title,description:e.RpaOperations.KeyboardInitialState.ScrollLockParameter.Description,"x-ms-visibility":"advanced"},kanaLock:{type:"boolean",title:e.RpaOperations.KeyboardInitialState.KanaLockParameter.Title,description:e.RpaOperations.KeyboardInitialState.KanaLockParameter.Description,"x-ms-visibility":"advanced"}}}}),v={rpaActionScreenshot:{type:"string"}},h="propertyName",g=e=>({[h]:{type:"string",title:e.RpaOperations.PropertyNameParameter.Title,description:e.RpaOperations.PropertyNameParameter.Description}}),O="propertyValue",w=e=>({[O]:{type:"string",title:e.RpaOperations.PropertyValueParameter.Title,description:e.RpaOperations.PropertyValueParameter.Description}}),E="methodName",C=e=>({[E]:{type:"string",title:e.RpaOperations.MethodNameParameter.Title,description:e.RpaOperations.MethodNameParameter.Description}}),S="methodParameters",P=e=>({[S]:{type:"array",title:e.RpaOperations.MethodParamsParameter.Title,description:e.RpaOperations.MethodParamsParameter.Description}}),j="processPath",T=e=>({[j]:{type:"string",title:e.RpaOperations.Action.RunWinAutomation.Inputs.ProcessPath.Title,description:e.RpaOperations.Action.RunWinAutomation.Inputs.ProcessPath.Description}}),k=e=>({commandLineArguments:{type:"string",title:e.RpaOperations.Action.RunWinAutomation.Inputs.CommandLineArguments.Title,description:e.RpaOperations.Action.RunWinAutomation.Inputs.CommandLineArguments.Description}});function R(e){var t=document.createElement("a");return t.href=e,t.href}var x=n.Y&&Object(n.Y)().palette.themePrimary,N=n.Y&&Object(n.Y)().palette.redDark||"#a80000",_="#f9a022",D={RPA_RECORDING:"rpaRecording",RPA_LAUNCH_APPLICATION:"rpaLaunchApplication",RPA_CLOSE_APPLICATION:"rpaCloseApplication",RPA_RIGHT_CLICK:"rpaMouseRightClick",RPA_SEND_KEYS:"rpaSendKeys",RPA_KEYBOARD_INPUT:"rpaSendKeysV2",RPA_LEFT_CLICK_ON_ELEMENT:"rpaLeftClickOnElement",RPA_GET_ELEMENT_TEXT:"rpaGetElementText",RPA_POST_ELEMENT_TEXT:"rpaPostElementText",RPA_GET_ELEMENT_ENABLED:"rpaGetElementEnabled",RPA_CLEAR_ELEMENT:"rpaClearElement",RPA_WAIT_FOR_SECONDS:"rpaWaitForSeconds",RPA_TRIGGER:"rpaTrigger",RPA_LOGIN_REMOTE_DESKTOP:"rpaLoginRemoteDesktop",RPA_GET_ELEMENT_TEXT_WITH_OCR:"rpaGetElementTextWithOCR",RPA_GET_CLIPBOARD_TEXT:"rpaGetClipboardText",RPA_SET_PROPERTY:"rpaSetProperty",RPA_CALL_METHOD:"rpaCallMethod",RPA_RUN_WINAUTOMATION:"rpaRunWinAutomation"},I="rpaLeftClickOnElementOld",A="rpaMouseRightClickOld",F="rpaGetElementTextWithOCROld",L="rpaPostElementTextOld",M=(D.RPA_LEFT_CLICK_ON_ELEMENT,D.RPA_RIGHT_CLICK,D.RPA_GET_ELEMENT_TEXT_WITH_OCR,D.RPA_POST_ELEMENT_TEXT,D.RPA_LEFT_CLICK_ON_ELEMENT,D.RPA_RIGHT_CLICK,D.RPA_GET_ELEMENT_TEXT_WITH_OCR,D.RPA_POST_ELEMENT_TEXT,{RPA_RECORDER:"connectionProviders/rpaRecorder",RPA_MANUAL_ACTIONS:"connectionProviders/rpaManualActions",RPA_SAP_ACTIONS:"connectionProviders/rpaSapActions",RPA_WINAUTOMATION_ACTIONS:"connectionProviders/rpaWinAutomationActions"}),B={RPA_RECORDER:"rpaRecorder",RPA_MANUAL_ACTIONS:"rpaManualActions",RPA_SAP_ACTIONS:"rpaSapActions",RPA_WINAUTOMATION_ACTIONS:"rpaWinAutomationActions"},U=(e,t)=>({[M.RPA_MANUAL_ACTIONS]:{id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,brandColor:x,properties:{iconUri:R(t.rpa.connectorManualActions),displayName:e.RpaConnectors.ManualActions.DisplayName,connectionParameters:{dummyConnection:{}}}},[M.RPA_RECORDER]:{id:M.RPA_RECORDER,name:B.RPA_RECORDER,brandColor:N,properties:{iconUri:R(t.rpa.connectorRecorder),displayName:e.RpaConnectors.Recorder.DisplayName,connectionParameters:{dummyConnection:{}}}},[M.RPA_SAP_ACTIONS]:{id:M.RPA_SAP_ACTIONS,name:B.RPA_SAP_ACTIONS,brandColor:x,properties:{iconUri:R(t.rpa.connectorSapActions),displayName:e.RpaConnectors.SapActions.DisplayName,connectionParameters:{dummyConnection:{}}}},[M.RPA_WINAUTOMATION_ACTIONS]:{id:M.RPA_WINAUTOMATION_ACTIONS,name:B.RPA_WINAUTOMATION_ACTIONS,brandColor:_,properties:{iconUri:R(t.rpa.winAutomationLogo),displayName:e.RpaOperations.WinAutomationActions.DisplayName,connectionParameters:{dummyConnection:{}}}}}),V=(e,t,r)=>[{id:D.RPA_TRIGGER,name:D.RPA_TRIGGER,description:t.RpaOperations.Trigger.NameGA,type:"RpaScript",properties:{api:{displayName:Object(a.d)(e)?t.RpaOperations.Trigger.DisplayNameGA:t.RpaOperations.Trigger.DisplayNamePreview,id:D.RPA_TRIGGER,name:D.RPA_TRIGGER,iconUri:R(r.rpa.triggerIcon),brandColor:x},description:t.RpaOperations.Trigger.NameGA,summary:t.RpaOperations.Trigger.NameGA,visibility:"important",operationType:"RpaScript"}}],z=(e,t)=>[{id:D.RPA_RECORDING,name:D.RPA_RECORDING,description:e.RpaOperations.RecordingOnlyAction.Description,location:"",properties:{api:{displayName:e.RpaOperations.RecordingOnlyAction.DisplayName,id:M.RPA_RECORDER,name:B.RPA_RECORDER,iconUri:R(t.rpa.rpaRecording),brandColor:N},description:e.RpaOperations.RecordingOnlyAction.Description,summary:e.RpaOperations.RecordingOnlyAction.Summary,visibility:"important",inputs:{type:"object",format:"rpaRecordingIdFormat",properties:{recordingId:{type:"string",format:"rparecordingidformat",title:"recordingId",description:e.RpaOperations.RecordingOnlyAction.RecordingId.Description,"x-ms-property-name-alias":"recordingId"}}}}}].map(e=>(e.type=e.properties.operationType=e.id,e)),G=(e,t)=>[{id:D.RPA_CLOSE_APPLICATION,name:D.RPA_CLOSE_APPLICATION,description:e.RpaOperations.Action.CloseApplication.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.CloseApplication.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaCloseApplication),brandColor:x},description:e.RpaOperations.Action.CloseApplication.Description,summary:e.RpaOperations.Action.CloseApplication.Summary,visibility:"important",inputs:{type:"object",properties:s(s({},v),d(e))},settings:{timeout:{scopes:[i.d.Action]}}}},{id:D.RPA_RIGHT_CLICK,name:D.RPA_RIGHT_CLICK,description:e.RpaOperations.Action.RightClick.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.RightClick.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaRightClick),brandColor:x},description:e.RpaOperations.Action.RightClick.Description,summary:e.RpaOperations.Action.RightClick.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s({},v),u),d(e)),p(e)),f(e))},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_SEND_KEYS,name:D.RPA_SEND_KEYS,description:e.RpaOperations.Action.SendKeys.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.SendKeys.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaSendKeys),brandColor:x},description:e.RpaOperations.Action.SendKeys.Description,summary:e.RpaOperations.Action.SendKeys.Summary,visibility:Object(o.a)().hideRPASendKeysV1?"internal":"important",inputs:{type:"object",properties:s(s(s(s(s(s({},v),u),d(e)),m(e)),p(e)),f(e))},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_KEYBOARD_INPUT,name:D.RPA_KEYBOARD_INPUT,description:e.RpaOperations.Action.KeyboardInput.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.KeyboardInput.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaKeyboardInput),brandColor:x},description:e.RpaOperations.Action.KeyboardInput.Description,summary:e.RpaOperations.Action.KeyboardInput.Summary,visibility:Object(o.a)().hideRPASendKeysV1?"important":"internal",inputs:{type:"object",properties:s(s(s(s(s(s(s({},v),d(e)),b(e)),y(e)),u),p(e)),f(e))},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_LEFT_CLICK_ON_ELEMENT,name:D.RPA_LEFT_CLICK_ON_ELEMENT,description:e.RpaOperations.Action.LeftClickOnElement.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.LeftClickOnElement.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaLeftClickOnElement),brandColor:x},description:e.RpaOperations.Action.LeftClickOnElement.Description,summary:e.RpaOperations.Action.LeftClickOnElement.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s({},v),u),d(e)),p(e)),f(e))},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_GET_ELEMENT_TEXT,name:D.RPA_GET_ELEMENT_TEXT,description:e.RpaOperations.Action.GetElementText.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.GetElementText.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaGetElementText),brandColor:x},description:e.RpaOperations.Action.GetElementText.Description,summary:e.RpaOperations.Action.GetElementText.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s({},v),u),d(e)),p(e)),f(e))},outputs:{type:"object",properties:{value:{type:"string",title:e.RpaOperations.Action.GetElementText.Output.Title,description:e.RpaOperations.Action.GetElementText.Output.Description}}},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_POST_ELEMENT_TEXT,name:D.RPA_POST_ELEMENT_TEXT,description:e.RpaOperations.Action.PostElementText.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.PostElementText.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaPostElementText),brandColor:x},description:e.RpaOperations.Action.PostElementText.Description,summary:e.RpaOperations.Action.PostElementText.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s(s({},v),u),d(e)),p(e)),f(e)),m(e))},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_GET_ELEMENT_ENABLED,name:D.RPA_GET_ELEMENT_ENABLED,description:e.RpaOperations.Action.GetElementEnabled.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.GetElementEnabled.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaGetElementEnabled),brandColor:x},description:e.RpaOperations.Action.GetElementEnabled.Description,summary:e.RpaOperations.Action.GetElementEnabled.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s({},v),u),d(e)),p(e)),f(e))},outputs:{type:"object",properties:{value:{type:"boolean",title:e.RpaOperations.Action.GetElementEnabled.Output.Title,description:e.RpaOperations.Action.GetElementEnabled.Output.Description}}},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_CLEAR_ELEMENT,name:D.RPA_CLEAR_ELEMENT,description:e.RpaOperations.Action.ClearElement.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.ClearElement.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaClearElement),brandColor:x},description:e.RpaOperations.Action.ClearElement.Description,summary:e.RpaOperations.Action.ClearElement.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s({},v),u),d(e)),p(e)),f(e))},settings:{timeout:{scopes:[i.d.Action]},retryPolicy:{scopes:[i.d.Action]}}}},{id:D.RPA_GET_ELEMENT_TEXT_WITH_OCR,name:D.RPA_GET_ELEMENT_TEXT_WITH_OCR,description:e.RpaOperations.Action.RpaGetClipboardText.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.RpaGetElementTextWithOCR.DisplayName,id:M.RPA_MANUAL_ACTIONS,name:B.RPA_MANUAL_ACTIONS,iconUri:R(t.rpa.rpaExtractText),brandColor:x},description:e.RpaOperations.Action.RpaGetElementTextWithOCR.Description,summary:e.RpaOperations.Action.RpaGetElementTextWithOCR.Summary,visibility:"internal",inputs:{type:"object",properties:s(s(s(s(s({},d(e)),v),u),f(e)),p(e))},outputs:{type:"object",properties:{value:{type:"string",title:e.RpaOperations.Action.RpaGetElementTextWithOCR.Output.Title,description:e.RpaOperations.Action.RpaGetElementTextWithOCR.Output.Description}}},settings:{timeout:{scopes:[i.d.Action]}}}}].map(e=>(e.type=e.properties.operationType=e.id,e)),W=(e,t)=>[{id:D.RPA_SET_PROPERTY,name:D.RPA_SET_PROPERTY,description:e.RpaOperations.Action.SetProperty.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.SetProperty.DisplayName,id:M.RPA_SAP_ACTIONS,name:B.RPA_SAP_ACTIONS,iconUri:R(t.rpa.rpaSetProperty),brandColor:x},description:e.RpaOperations.Action.SetProperty.Description,summary:e.RpaOperations.Action.SetProperty.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s(s(s({},v),u),d(e)),p(e)),f(e)),g(e)),w(e)),required:[h,O]}}},{id:D.RPA_CALL_METHOD,name:D.RPA_CALL_METHOD,description:e.RpaOperations.Action.CallMethod.Description,location:"",properties:{api:{displayName:e.RpaOperations.Action.CallMethod.DisplayName,id:M.RPA_SAP_ACTIONS,name:B.RPA_SAP_ACTIONS,iconUri:R(t.rpa.rpaCallMethod),brandColor:x},description:e.RpaOperations.Action.CallMethod.Description,summary:e.RpaOperations.Action.CallMethod.Summary,visibility:"important",inputs:{type:"object",properties:s(s(s(s(s(s(s({},v),u),d(e)),p(e)),f(e)),C(e)),P(e)),required:[E,S]}}}].map(e=>(e.type=e.properties.operationType=e.id,e)),H=(e,t)=>[{id:D.RPA_RUN_WINAUTOMATION,name:D.RPA_RUN_WINAUTOMATION,description:e.RpaOperations.Action.RunWinAutomation.DescriptionGA,location:"",properties:{api:{displayName:e.RpaOperations.Action.RunWinAutomation.DisplayName,id:M.RPA_WINAUTOMATION_ACTIONS,name:B.RPA_WINAUTOMATION_ACTIONS,iconUri:R(t.rpa.winAutomationLogo),brandColor:_},description:e.RpaOperations.Action.RunWinAutomation.DescriptionGA,summary:e.RpaOperations.Action.RunWinAutomation.Summary,swaggerExternalDocs:{description:e.Common.LearnMore,url:e.RpaOperations.Action.RunWinAutomation.ExternalDocs.Url},visibility:"important",inputs:{type:"object",properties:s(s(s({},T(e)),k(e)),d(e)),required:[j]}}}].map(e=>(e.type=e.properties.operationType=e.id,e))},20152:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(20153);r.d(t,"d",(function(){return n.b})),r.d(t,"c",(function(){return n.a}));var o=function(e){return e.Parallel="parallel",e.Sequential="sequential",e}({}),i=function(e){return e.OpenApi="openapi",e.HybridTrigger="hybridtrigger",e}({})},20153:function(e,t,r){"use strict";var n=r(14885);r.d(t,"a",(function(){return n.f})),r.d(t,"b",(function(){return n.h}))},20154:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(12999),o=function(e){return e[e.designerNewCustomDropdownEditor=0]="designerNewCustomDropdownEditor",e[e.designerNewTokenPickerV2=1]="designerNewTokenPickerV2",e[e.designerNewTokenPickerV2Feedback=2]="designerNewTokenPickerV2Feedback",e[e.designerNewConditionEditor=3]="designerNewConditionEditor",e[e.designerNewAdaptiveCardEditor=4]="designerNewAdaptiveCardEditor",e[e.designerNewExpressionEditor=5]="designerNewExpressionEditor",e[e.designerNewDropdownEditor=6]="designerNewDropdownEditor",e[e.designerNewTableEditor=7]="designerNewTableEditor",e[e.designerNewHtmlEditor=8]="designerNewHtmlEditor",e[e.designerNewPAResponseEditor=9]="designerNewPAResponseEditor",e[e.designerNewOdataEditor=10]="designerNewOdataEditor",e[e.designerNewDictionaryEditor=11]="designerNewDictionaryEditor",e[e.designerNewArrayEditor=12]="designerNewArrayEditor",e}({});function i(e){var t=Object(n.a)();switch(e){case o.designerNewCustomDropdownEditor:return t.designerNewCustomDropdownEditor;case o.designerNewTokenPickerV2:return t.designerNewTokenPickerV2;case o.designerNewTokenPickerV2Feedback:return t.designerNewTokenPickerV2Feedback;case o.designerNewConditionEditor:return t.designerNewConditionEditor;case o.designerNewAdaptiveCardEditor:return t.designerNewAdaptiveCardEditor;case o.designerNewExpressionEditor:return t.designerNewExpressionEditor;case o.designerNewDropdownEditor:return t.designerNewDropdownEditor;case o.designerNewTableEditor:return t.designerNewTableEditor;case o.designerNewHtmlEditor:return t.designerNewHtmlEditor;case o.designerNewPAResponseEditor:return t.designerNewPAResponseEditor;case o.designerNewOdataEditor:return t.designerNewOdataEditor;case o.designerNewDictionaryEditor:return t.designerNewDictionaryEditor;case o.designerNewArrayEditor:return t.designerNewArrayEditor;default:return!1}}},20155:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12999),o=r(11808),i=()=>Object(n.a)().enableFormulaFromExamples||!!Object(o.a)().expressionFromExamples.getConfig().isExpressionFromExamplesEnabled},20156:function(e,t,r){"use strict";r.d(t,"c",(function(){return M})),r.d(t,"b",(function(){return B})),r.d(t,"a",(function(){return U}));var n=r(17244),o=r(20157),i=r(20420),a=r(20326),c=r(20322),s=r(20422),l=r(20427),u=r(20428),p=r(20438),f=r(20439),d=r(20444),m=r(20445),b=r(20453),y=r(20459),v=r(20460),h=r(20470),g=r(20474),O=r(20475),w=r(20476),E=r(20482),C=r(20488),S=r(20588),P=r(20593),j=r(12999),T=r(20598),k=r(12366),R=r(20599),x=r(20154),N=r(20633),_=r(20650),D=r(18968),I=r(20657),A=r(20659);function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L(n.key),n)}}function L(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var M=["query.$.$filter","inputs.$.$filter"],B=["query.$.$filter","inputs.$.$filter","inputs.$.subscriptionRequest.subscriptionRequest/filterexpression"],U=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.forceEnableBetaEditors=t,this.widgetUtilService=r,this.enableEasyAutomationDataTrainingExperience=n,this.enableDefaultEditorCoachmark=o,this.DefaultEditor=void 0,this.DefaultEditor=n?a.b:o?T.a:a.a}var t,r,L;return t=e,(r=[{key:"getEditorType",value:function(e,t,r,a){var T=a?a.type:void 0,F=a?a.format:void 0,L=Object(j.a)();if("string"===T&&"mquery"===F)return u.a;if("connectionProviders/geofenceGroup"===e&&"geofence_request"===t&&r.includes("serializedGeofence"))return l.a;if(e.startsWith("/providers/Microsoft.PowerApps/apis/shared_teams"))switch(t){case"DesignAndPostUserAdaptiveCard":case"SubscribeUserFlowContinuation":case"SubscribeChannelFlowContinuation":if((Object(x.b)(x.a.designerNewAdaptiveCardEditor)||this.forceEnableBetaEditors)&&r.endsWith("messageBody"))return o.a;break;case"ComposeAMessage":case"ComposeAMessageV2":case"ForASelectedMessage":case"ForASelectedMessageV2":if(L.designerNewAdaptiveCardTriggerEditor&&r.endsWith("inputsAdaptiveCard"))return O.a;break;case"WebhookMessageReactionTrigger":if(Object(A.a)()&&"inputs.$.reactionKey"===r)return I.a}if(L.enableRochdale&&Object(D.b)(e)&&r.endsWith("$.uiFlowId")&&"RunUIFlow_V2"===t&&L.enableCreateWAUIFlow)return R.a;if(Object(x.b)(x.a.designerNewOdataEditor)&&"/providers/Microsoft.PowerApps/apis/shared_sharepointonline"===e){if(M.includes(r))return C.a;switch(r){case"inputs.$.$orderby":case"query.$.$orderby":return this.DefaultEditor}}if(L.designerNewOdataEditorInDataverse&&Object(S.c)(e,t)&&B.includes(r))return C.a;if("connectionProviders/control"===e)switch(t){case"foreach":case"switch":return this.DefaultEditor;case"if":return Object(x.b)(x.a.designerNewConditionEditor)?d.a:void 0;case"until":if("builtin.$.expression.$relationship"===r)return;return Object(x.b)(x.a.designerNewConditionEditor)?d.a:void 0;case"switchcase":return p.a;default:return}if("connectionProviders/dataOperation"===e&&"query"===t){if("builtin.$.where.$relationship"===r)return;return Object(x.b)(x.a.designerNewConditionEditor)?d.a:void 0}if((Object(x.b)(x.a.designerNewPAResponseEditor)||this.forceEnableBetaEditors)&&"connectionProviders/powerappsGroup"===e&&"powerappsresponse"===t)return y.a;if("string"===T&&"email"===F)return f.a;if((Object(x.b)(x.a.designerNewHtmlEditor)||this.forceEnableBetaEditors)&&"string"===T&&"html"===F)return v.a;if(this.forceEnableBetaEditors&&L.enableVariableEditor&&t===n.a.NODE.TYPE.INITIALIZE_VARIABLE)return P.a;if(e===k.f.COMMON_DATA_SERVICE_FOR_APPS&&"aibuilderpredict_gptpromptengineering"===t&&"inputs.$.item.item/requestv2.item/requestv2/prompt"===r)return N.a;if(this.widgetUtilService.isWidgetPage()&&(this.widgetUtilService.isExcelSDXContext()||this.widgetUtilService.isTeamsContext())&&"connectionProviders/schedule"===e)return _.a;if(a){if((Object(x.b)(x.a.designerNewCustomDropdownEditor)||this.forceEnableBetaEditors)&&Object(g.a)(a))return h.a;if(L.designerNewFolderPickerEditor&&Object(g.b)(a))return E.a;switch(a[n.a.Swagger.EXTENSION.EDITOR]){case n.a.Editors.Array:return Object(x.b)(x.a.designerNewArrayEditor)?b.a:void 0;case n.a.Editors.Copyable:return i.a;case n.a.Editors.Default:return this.DefaultEditor;case n.a.Editors.Dictionary:return Object(x.b)(x.a.designerNewDictionaryEditor)?c.a:void 0;case n.a.Editors.Dropdown:return Object(x.b)(x.a.designerNewDropdownEditor)||this.forceEnableBetaEditors?s.a:void 0;case n.a.Editors.Schema:return m.a;case n.a.Editors.String:return p.a;case n.a.Editors.Table:return Object(x.b)(x.a.designerNewTableEditor)||this.forceEnableBetaEditors?w.a:void 0;default:return}}}},{key:"getDefaultEditor",value:function(){return this.DefaultEditor}},{key:"_getDefaultEditor",value:function(){return this.DefaultEditor}}])&&F(t.prototype,r),L&&F(t,L),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20157:function(e,t,r){"use strict";r.d(t,"b",(function(){return E})),r.d(t,"c",(function(){return C})),r.d(t,"a",(function(){return j}));var n=r(11766),o=(r(20158),r(20160),r(20162)),i=r(20321),a=r(13223),c=r(20313),s=r(20322),l=r(20412),u=r(20413),p=r(16824),f=r(13016),d=r(20415),m=r(20419),b=r(19713);function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E="-ms-tokens",C="{}",S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(v,e);var t,r,c,m=g(v);function v(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=m.call(this,e))._childEditorRef=null,t._editorContext=Object(b.a)(),t.setComponentRef=e=>t._childEditorRef=e,t.getDictStateFromEditorProps=()=>({complexValue:{type:"dictionary",editorState:{items:t.state.dictionaryItems,inCodeViewMode:!1,toggleMode:()=>{},addDictionaryItem:()=>{t.state.dictionaryItems.push(t.constructDictionaryItem("",""))}}},value:[]}),t.getDictionaryItemById=e=>t.state.dictionaryItems.filter(t=>t.id===e)[0],t.deleteRow=e=>{var r=t.state.dictionaryItems.filter(t=>t.data!==e);t.setState({dictionaryItems:r})},t.constructDictionaryItem=(e,r)=>{var n=t.props.editorContext.getService(i.a.PARAMETER),o=Object(a.a)(),c={key:{id:"key-".concat(o),value:n.getValueSegmentsFromRawValue(e)},value:{id:"value-".concat(o),value:n.getValueSegmentsFromRawValue(r)}},s=t.getDictionaryItemById(o).data;return{id:o,data:c,delete:()=>t.deleteRow(c),updateKey:e=>{s.key&&(s.key.value=e)},updateValue:e=>{s.value.value=e}}},t.getDictOptions=()=>({displayName:t.props.editorOptions.displayName,readonly:!1,showTokenPicker:!0,validationErrors:[],summary:"",options:{addDictionaryItem:()=>{t.state.dictionaryItems.push(t.constructDictionaryItem("",""))}}}),t.onAdaptiveCardEditorReadyError=e=>{t.setState({errorMessage:e})},t.onLaunchButtonClick=()=>{t.setState({isEditing:!0,errorMessage:void 0})},t.onSave=e=>{var r=t.props.editorContext.getService(i.a.PARAMETER).getValueSegmentsFromRawValue(e);t.setState({value:e}),t.props.onChange({value:r})},t.onCancel=()=>{t.setState({isEditing:!1})};var r,n=Object(o.j)(t.props.editorState.value),c=""===n.trim()?C:n,s={"":""};try{c!==C&&(s=JSON.parse(c)[E],JSON.stringify(s)===C&&(s={"":""}))}catch(u){r=t._editorContext.designerResources.AdaptiveCardEditor.errorJsonParsing}var l=s?Object.keys(s).map(e=>t.constructDictionaryItem(e,s[e])):[];return t.state={isEditing:!1,value:c,shouldRenderCardEditor:!0,dictionaryItems:l,errorMessage:r},t}return t=v,(r=[{key:"render",value:function(){var{value:e,isEditing:t}=this.state,{editorOptions:r}=this.props;return n.createElement("div",null,n.createElement(s.a,{editorState:this.getDictStateFromEditorProps(),editorOptions:this.getDictOptions(),editorContext:this.props.editorContext,onChange:e=>{},hideToggle:!0,ref:this.setComponentRef}),n.createElement(l.a,{contentErrorMessage:this.state.errorMessage,buttonMode:e===C?u.b.Create:u.b.Edit,isContentLoading:!1,parameterName:this._editorContext.designerResources.AdaptiveCardEditor.title,readonly:r.readonly,isEditing:t,onPanelClose:this.onCancel,onLaunchedButtonClick:this.onLaunchButtonClick,editorType:u.c.AdaptiveCard},this.renderError(),n.createElement(d.a,{key:JSON.stringify(this.state.dictionaryItems),value:e,dictionaryItems:this.state.dictionaryItems,onSave:this.onSave,onAdaptiveCardEditorReadyError:this.onAdaptiveCardEditorReadyError,bindTokens:!0})))}},{key:"focus",value:function(){this._childEditorRef&&this._childEditorRef.focus()}},{key:"renderError",value:function(){var e=this.state.errorMessage;return e?n.createElement(p.a,{type:f.c.error,ariaLabel:e,message:e}):null}}])&&y(t.prototype,r),c&&y(t,c),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component),P=Object(m.a)((e,t)=>!!t.editorState&&Object(c.c)(e.editorState.value,t.editorState.value))(S),j=e=>n.createElement(P,e)},20162:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"e",(function(){return d})),r.d(t,"l",(function(){return m})),r.d(t,"k",(function(){return b})),r.d(t,"h",(function(){return y})),r.d(t,"u",(function(){return v})),r.d(t,"v",(function(){return h})),r.d(t,"t",(function(){return g})),r.d(t,"g",(function(){return O})),r.d(t,"m",(function(){return w})),r.d(t,"c",(function(){return E})),r.d(t,"z",(function(){return P})),r.d(t,"i",(function(){return x})),r.d(t,"s",(function(){return N})),r.d(t,"f",(function(){return D})),r.d(t,"x",(function(){return I})),r.d(t,"y",(function(){return F})),r.d(t,"j",(function(){return L})),r.d(t,"b",(function(){return M})),r.d(t,"d",(function(){return B})),r.d(t,"w",(function(){return U})),r.d(t,"r",(function(){return V})),r.d(t,"p",(function(){return z})),r.d(t,"q",(function(){return G})),r.d(t,"n",(function(){return W})),r.d(t,"o",(function(){return H}));var n=r(20163),o=r(20312),i=r(20313),a=r(17266),c=r(13143),s=r(17244),l=r(12728),u=(r(12328),r(20317)),p=s.a.UIConstants.ZeroWidthChar,f={HTML:"text/html",TEXT:"text/plain",IE_TEXT:"text"};function d(e){return console.debug("Editor State",e.toJS()),e}function m(e){var t,r;return Object(i.q)(e)&&e.token?null!==(t=e.token.title)&&void 0!==t?t:"":null!==(r=e.tokenExpression)&&void 0!==r?r:""}function b(e,t){var r,o,i,a=e.getBlocksAsArray(),c=function(e){e.findEntityRanges(e=>t===e.getEntity(),(t,n)=>{r=t,o=n,i=e.getKey()})};for(var s of a)c(s);if(void 0!==r&&void 0!==o&&void 0!==i)return new n.SelectionState({anchorOffset:r,anchorKey:i,focusOffset:o,focusKey:i,isBackward:!1,hasFocus:!0})}function y(e,t){return t&&e?e.getCurrentContent().getEntity(t):null}function v(e){return!!e&&e.getType()===s.a.DraftJS.EntityTypePlaceholder}function h(e){return!!e&&e.getType()===s.a.DraftJS.EntityTypeToken}function g(e){return!!e&&e.getType()===s.a.DraftJS.EntityTypeToken&&void 0!==e.getData().expression}function O(e,t){var r=n.EditorState.createEmpty(t);return A(r,r.getSelection(),e,!1)}function w(e,t){var r=e.getCurrentContent(),n=r.getBlockMap(),a=t.getStartKey(),c=t.getEndKey(),s=n.get(c),l=n.toSeq().filter(e=>!!e).skipUntil((e,t)=>t===a).takeUntil((e,t)=>t===c).concat(o.Iterable({endKey:s})).toList(),u=[];return l.forEach(e=>{var n,o,s=e.getKey(),l=e.getText();s===a?n=t.getStartOffset():(n=0,u.push(Object(i.g)())),o=s===c?t.getEndOffset():l.length;for(var p=(e,t,r)=>{if(t>e){var n=function(e){return e.replace(/\u2060/g,"")}(r.substring(e,t));n.length>0&&u.push(Object(i.f)(n))}},f=n,d=n,m=n;m<o;++m){var b=e.getEntityAt(m);if(b){p(f,d,l);var y=r.getEntity(b);h(y)&&u.push(y.getData().expression),f=d=m+1}else++d}p(f,d,l)}),u.length>0?u:[Object(i.f)("")]}function E(e){var t=e.getCurrentContent(),r=t.getFirstBlock(),o=t.getLastBlock();return new n.SelectionState({anchorKey:r.getKey(),anchorOffset:0,focusKey:o.getKey(),focusOffset:o.getLength(),isBackward:!1,hasFocus:!1})}function C(e,t){var r=S(e.getCurrentContent(),t),o=n.EditorState.push(e,r,"remove-range");return n.EditorState.forceSelection(o,r.getSelectionAfter())}function S(e,t){var r=n.Modifier.removeRange(e,t,"forward"),o=r.getSelectionAfter(),i=o.getStartOffset(),a=r.getBlockForKey(o.getStartKey()),c=0===i?void 0:i-1,s=i===a.getText().length?void 0:i,l=void 0!==c&&a.getEntityAt(c),u=void 0!==s&&a.getEntityAt(s);return(l||u)&&(r=R(r,o)),r}function P(e,t,r,n,o){var i=o?_(e,e=>C(e,t)):C(e,t),a=i.getCurrentContent();return A(i,a.getSelectionAfter(),r,n)}function j(e,t){var r=e.getBlockForKey(t).getText(),o=new n.SelectionState({anchorKey:t,anchorOffset:r.length,focusKey:t,focusOffset:r.length,isBackward:!1,hasFocus:!1});return n.Modifier.splitBlock(e,o)}function T(e,t,r){if(Object(i.p)(e))t=j(t,r.getEndKey());else if(Object(i.o)(e)&&e.tokenExpression){e.tokenExpression.split("\n").forEach((e,o)=>{0!==o&&(t=j(t,r.getEndKey()),r=t.getSelectionAfter()),t=n.Modifier.insertText(t,r,e),r=t.getSelectionAfter()})}else Object(i.q)(e)&&(t=k(s.a.DraftJS.EntityTypeToken,{expression:e},t,r));return t}function k(e,t,r,o){var i=(r=r.createEntity(e,"IMMUTABLE",t)).getLastCreatedEntityKey(),a=e===s.a.DraftJS.EntityTypeToken;return a&&(o=(r=R(r,o)).getSelectionAfter()),r=n.Modifier.insertText(r,o,s.a.DraftJS.EntityTokenCharacter,void 0,i),a&&(o=r.getSelectionAfter(),r=R(r,o)),r}function R(e,t){return n.Modifier.insertText(e,t,p)}function x(e,t,r){var n,o,a=new u.a;try{n=a.parseExpression(t,e),o="".concat(n.functionName,"(...)")}catch(c){n={type:u.b.Invalid,value:""},o=t.length>7?"".concat(t.substring(0,7),"..."):t}return{tokenKey:r||Object(l.a)(),type:i.b.TOKEN,tokenExpression:t,token:Object(i.e)(t,n,o)}}function N(e,t,r,n){return P(e,t,[x(n,r)],!0,!0)}function _(e,t){var r=n.EditorState.set(e,{allowUndo:!1}),o=t(r);return o&&(r=o),n.EditorState.set(r,{allowUndo:!0})}function D(e){return new n.SelectionState({anchorKey:e.getEndKey(),focusKey:e.getEndKey(),anchorOffset:e.getEndOffset()-1,focusOffset:e.getEndOffset()-1,isBackwards:!1})}function I(e,t){var r=e.getCurrentContent(),o=function(e,t){for(var r=e,o=function(e){return Object.values(n.convertToRaw(e).entityMap)}(r),i=0;i<o.length;i++){var a=o[i],c=a.data?a.data.entityKey:void 0;if(c&&a.type===s.a.DraftJS.EntityTypePlaceholder&&c!==t){var l=b(r,c);if(l){r=S(r,l);break}}}return r}(r);if(r!==o){var i=_(e,e=>n.EditorState.push(e,o,"apply-entity"));return t?n.EditorState.forceSelection(i,i.getSelection()):i}return e}function A(e,t,r,o){var i=e.getCurrentContent();for(var a of r)t=(i=T(a,i,t)).getSelectionAfter();return _(e,e=>{var t=n.EditorState.push(e,i,"insert-characters");return o?n.EditorState.forceSelection(t,t.getCurrentContent().getSelectionAfter()):t})}function F(e,t){var r=b(e.getCurrentContent(),t);return r?C(e,r):e}function L(e){var t="";for(var r of e)if(Object(i.o)(r))t+=r.tokenExpression;else if(Object(i.p)(r))t+="\n";else if(Object(i.q)(r))t+="@{".concat(r.tokenExpression,"}");else if(Object(i.m)(r));else if(Object(i.l)(r));else if(!Object(i.r)(r))throw new a.a(c.b.DesignerUnsupportedValueSegmentType,"Unsupported value segment type ".concat(r.type));return t}function M(e,t){var r=e.getSelection();if(r.getHasFocus()){!function(e,t,r){window.clipboardData&&window.clipboardData.getData?e.clipboardData.setData(f.IE_TEXT,t):e.clipboardData.setData(f.TEXT,t),e.clipboardData.setData(f.HTML,r)}(t,L(w(e,r)),"")}}function B(e,t){var r=e.getSelection();if(r.getHasFocus()){M(e,t);var o=e.getCurrentContent();return n.EditorState.push(e,n.Modifier.removeRange(o,r,"forward"),"remove-range")}return e}function U(e,t,r){var n=r.getValueSegmentsFromRawValue(e);return P(t,t.getSelection(),n,!0)}function V(e){var t=n.Modifier.splitBlock(e.getCurrentContent(),e.getSelection()),r=t.getSelectionAfter(),o=r.getStartKey(),i=(t=q(K(t,o),o,!0)).getKeyBefore(o);t=q(K(t,i),i,!1);var a=n.EditorState.push(e,t,"split-block");return n.EditorState.forceSelection(a,r)}function z(e){var t,r=e.getSelection(),o=r.getStartKey(),i=r.getStartOffset(),a=e.getCurrentContent(),c=Y(a,o,i,!0,X);if(c<0){var s=a.getKeyBefore(r.getStartKey());if(!s)return;var l=Z(a,s);t=new n.SelectionState({anchorKey:s,anchorOffset:l.length+1,focusKey:s,focusOffset:l.length+1,isBackward:!1,hasFocus:!0})}else t=new n.SelectionState({anchorKey:o,anchorOffset:c,focusKey:o,focusOffset:c,isBackward:!1,hasFocus:!0});return n.EditorState.forceSelection(e,t)}function G(e){var t=e.getSelection(),r=t.getStartKey(),o=t.getStartOffset(),i=e.getCurrentContent(),a=i.getBlockForKey(r).getText();if(!(r===i.getLastBlock().getKey())||-1!==Q(a,o,!1,X)){var c,s;if(o===a.length?c=-1:-1===(c=Q(a,o,!1,X))&&(c=a.length),-1===c){var l=i.getKeyAfter(r);if(!l)return;s=new n.SelectionState({anchorKey:l,anchorOffset:-1,focusKey:l,focusOffset:-1,isBackward:!1,hasFocus:!0})}else s=new n.SelectionState({anchorKey:r,anchorOffset:c-1,focusKey:r,focusOffset:c-1,isBackward:!1,hasFocus:!0});return n.EditorState.forceSelection(e,s)}}function W(e){var t=e.getSelection(),r=t.getStartKey(),o=e.getCurrentContent();if(t.isCollapsed()){if(0===Z(o,r).length||0===t.getStartOffset()&&o.getFirstBlock().getKey()===r)return;return function(e){var t,r,o=e.getSelection(),i=o.getStartKey(),a=o.getStartOffset(),c=e.getCurrentContent(),s=c.getBlockForKey(i).getText(),l=!1,u=Q(s,a,!0,X);-1===u?(t=i,r=0,i!==c.getFirstBlock().getKey()&&(l=!0)):(t=i,r=u);var p=new n.SelectionState({anchorKey:t,anchorOffset:r,focusKey:i,focusOffset:a,isBackward:!1,hasFocus:!0}),f=C(e,p);return l?function(e){var t=e.getCurrentContent(),r=e.getSelection().getStartKey(),o=t.getKeyBefore(r);if(!o)return e;var i=t.getBlockForKey(o).getText(),a=new n.SelectionState({anchorKey:o,anchorOffset:i.length,focusKey:r,focusOffset:0,isBackward:!1,hasFocus:!0});return C(e,a)}(f):f}(e)}return C(e,t)}function H(e){var t=e.getSelection();return t.isCollapsed()?function(e){var t,r,o=e.getSelection(),i=o.getEndKey(),a=o.getEndOffset(),c=e.getCurrentContent(),s=c.getBlockForKey(i),l=s.getText(),u=!1,p=Q(l,a,!1,X);-1===p?(t=i,r=l.length,i===c.getLastBlock().getKey()||s.getEntityAt(a)||(u=!0)):(r=p,(t=i)!==i||X(l[a])||++r);var f=new n.SelectionState({anchorKey:i,anchorOffset:a,focusKey:t,focusOffset:r,isBackward:!1,hasFocus:!0}),d=C(e,f);return u?function(e){var t=e.getCurrentContent(),r=e.getSelection().getEndKey(),o=t.getKeyAfter(r);if(!o)return e;var i=t.getBlockForKey(r).getText(),a=new n.SelectionState({anchorKey:r,anchorOffset:i.length,focusKey:o,focusOffset:0,isBackward:!1,hasFocus:!0});return C(e,a)}(d):d}(e):C(e,t)}function K(e,t){var r=e;r.getBlockForKey(t).getEntityAt(0)&&(r=R(r,new n.SelectionState({anchorKey:t,anchorOffset:0,focusKey:t,focusOffset:0,isBackward:!1,hasFocus:!1})));var o=r.getBlockForKey(t),i=o.getText();i.length>0&&o.getEntityAt(i.length-1)&&(r=R(r,new n.SelectionState({anchorKey:t,anchorOffset:i.length,focusKey:t,focusOffset:i.length,isBackward:!1,hasFocus:!1})));return r}function q(e,t,r){var o=Z(e,t);if(0===o.length)return e;var i=r?1:o.length-1;if(X(o[i]))return e;var a=Y(e,t,r?i-1:i,!r,X);-1===a&&(a=r?o.length:0);var c=!r,s=r?i:a,l=r?a:i;if(s===l)return e;var u=new n.SelectionState({anchorKey:t,anchorOffset:s,focusKey:t,focusOffset:l,isBackward:c,hasFocus:!1});return n.Modifier.removeRange(e,u,c?"backward":"forward")}function Y(e,t,r,n,o){var i=Q(Z(e,t),r,n,o);return-1!==i&&n?i+1:i}function X(e){return e!==p}function Q(e,t,r,n){return r?function(e,t,r){do{--t}while(t>=0&&!r(e[t],t));return t}(e,t,n):function(e,t,r){do{++t}while(t<e.length&&!r(e[t]));return t>=e.length?-1:t}(e,t,n)}function Z(e,t){return e.getBlockForKey(t).getText()}},20313:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return d})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return b})),r.d(t,"n",(function(){return y})),r.d(t,"c",(function(){return v})),r.d(t,"o",(function(){return h})),r.d(t,"q",(function(){return g})),r.d(t,"l",(function(){return O})),r.d(t,"m",(function(){return w})),r.d(t,"r",(function(){return E})),r.d(t,"p",(function(){return C})),r.d(t,"f",(function(){return S})),r.d(t,"d",(function(){return P})),r.d(t,"g",(function(){return j})),r.d(t,"e",(function(){return k})),r.d(t,"h",(function(){return R})),r.d(t,"i",(function(){return x}));r(14751);var n=r(20314),o=r.n(n),i=r(17227),a=r.n(i),c=r(13223),s=r(11891),l=r(20317),u=r(20319),p=r(20320),f=function(e){return e[e.FX=0]="FX",e[e.ITEM=1]="ITEM",e[e.ITERATIONINDEX=2]="ITERATIONINDEX",e[e.PARAMETER=3]="PARAMETER",e[e.VARIABLE=4]="VARIABLE",e}({}),d=function(e){return e.LITERAL="literal",e.TOKEN="token",e.ENUM="enum",e.FUNCTION="function",e.UNSUPPORTED="unsupported",e.NEW_LINE="new_line",e}({});function m(e){if(!e)return!1;for(var t of e)if(g(t)||T(t))return!0;return!1}function b(e){return!(e&&e.length&&(1!==e.length||e[0].tokenExpression&&e[0].tokenExpression.trim()))}function y(e){return e&&!!e.token&&!!e.token.expression&&g(e)&&e.token.tokenType===f.FX&&e.token.expression.type===l.b.Invalid}function v(e,t){return!(!e&&!t)&&(!e||!t||e.length!==t.length||e.some((e,r)=>{var n,o,i,c,l,u,p,m,b,y,v=t[r];if(a()(e)||a()(v)||e.type!==v.type)return!0;switch(e.type){case d.FUNCTION:case d.LITERAL:case d.NEW_LINE:case d.UNSUPPORTED:return e.tokenExpression!==v.tokenExpression;case d.ENUM:var h=null===(n=e.token)||void 0===n?void 0:n.title,g=e.tokenExpression,O=null===(o=v.token)||void 0===o?void 0:o.title;return g!==v.tokenExpression||h!==O;case d.TOKEN:var w=null===(i=e.token)||void 0===i?void 0:i.name,E=null===(c=e.token)||void 0===c?void 0:c.step,C=null===(l=e.token)||void 0===l?void 0:l.tokenType,S=null===(u=e.token)||void 0===u?void 0:u.value,P=null===(p=v.token)||void 0===p?void 0:p.name,j=null===(m=v.token)||void 0===m?void 0:m.step,T=null===(b=v.token)||void 0===b?void 0:b.tokenType,k=null===(y=v.token)||void 0===y?void 0:y.value;if(C!==T)return!0;switch(C){case f.FX:return S!==k;case f.PARAMETER:case f.VARIABLE:return!Object(s.a)(S,k);case f.ITEM:case f.ITERATIONINDEX:case void 0:return a()(w)||a()(P)?!w&&!!P||!!w&&!P:!Object(s.a)(w,P)||(a()(E)||a()(j)?!E&&!!j||!!E&&!j:!Object(s.a)(E,j));default:throw new TypeError("Unexpected token type ".concat(C))}default:throw new TypeError("Unexpected value segment type ".concat(e.type))}}))}function h(e){return e.type===d.LITERAL}function g(e){return e.type===d.TOKEN}function O(e){return e.type===d.ENUM}function w(e){return e.type===d.FUNCTION}function E(e){return e.type===d.UNSUPPORTED}function C(e){return e.type===d.NEW_LINE}function S(e,t){return{tokenKey:t||Object(c.a)(),type:d.LITERAL,tokenExpression:e}}function P(e,t,r){return{tokenKey:r||Object(c.a)(),type:d.ENUM,tokenExpression:e,token:{title:t}}}function j(){return{tokenKey:Object(c.a)(),type:d.NEW_LINE,tokenExpression:"\n"}}function T(e){return!!e&&e.tokenType===f.FX}function k(e,t,r){return{tokenType:f.FX,value:e,expression:t,title:r,brandColor:u.a.FX_TOKEN,icon:p.a}}function R(e,t){var r=o()(e,e=>e.tokenKey===t);return r&&g(r)&&T(r.token)?t:""}function x(e,t){if(t){var r=e.find(e=>e.tokenKey===t);return r?r.tokenExpression:void 0}}},20317:function(e,t,r){"use strict";r.d(t,"b",(function(){return y})),r.d(t,"a",(function(){return v})),r.d(t,"c",(function(){return E}));var n=r(13031),o=r(16808),i=r(20318);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function c(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){return e.NOT_EXPRESSION="NotExpression",e.SEGMENT_NOT_TERMINATED="SegmentNotTerminated",e.UNEXPECTED_DEREFERENCE="UnexpectedDereference",e}({}),b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(r,e);var t=p(r);function r(e,n){return l(this,r),t.call(this,"Workflow.ExpressionParserException",e,n)}return c(r)}(o.a),y=function(e){return e.NullLiteral="NullLiteral",e.BooleanLiteral="BooleanLiteral",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.Function="Function",e.StringInterpolation="StringInterpolation",e.Invalid="Invalid",e}({}),v=function(){function e(){l(this,e)}return c(e,[{key:"parseTemplateExpression",value:function(t,r){if(!e.isTemplateExpression(t))throw new b(Object(n.a)(r.WorkflowError.NotExpression,t),m.NOT_EXPRESSION);return"@"===t.charAt(0)&&"{"!==t.charAt(1)?"@"===t.charAt(1)?O(t.substring(1)):this.parseExpression(t.substring(1),r):this._parseStringInterpolationExpression(t,r)}},{key:"parseExpression",value:function(e,t){var r=new i.a(e,t),n=this._parseExpressionRecursive(r,t);return r.getToken(i.b.EndOfData),n}},{key:"_parseStringInterpolationExpression",value:function(e,t){for(var r=0,n=0,o=[];n<e.length-1;)if("@"===e.charAt(n)&&"{"===e.charAt(n+1)){if(r<n){var i=e.substring(r,n);o.push(O(i))}if(n>0&&"@"===e.charAt(n-1))r=++n;else{for(var a=n,c=!1,s=!1;n<e.length;){if("'"===e.charAt(n))c=!c;else if(!c&&"}"===e.charAt(n)){s=!0;break}++n}if(!s)throw new b(t.WorkflowError.ExpressionSegmentNotTerminated,m.SEGMENT_NOT_TERMINATED);o.push(this.parseExpression(e.substring(a+2,n),t)),r=++n}}else++n;return r<e.length&&o.push(O(e.substring(r))),E(o)}},{key:"_parseExpressionRecursive",value:function(e,t){var r,n;return(r=e.tryGetToken(i.b.StringLiteral))?O(r.value):(r=e.tryGetToken(i.b.IntegerLiteral))||(r=e.tryGetToken(i.b.FloatLiteral))?g(r.value):(r=e.tryGetIdentifier("null"))?(n=r.value,{type:y.NullLiteral,value:n}):(r=e.tryGetIdentifier("true"))||(r=e.tryGetIdentifier("false"))?h(r.value):this._parseFunctionExpression(e,t)}},{key:"_parseFunctionExpression",value:function(e,t){var r=e.getToken(i.b.Identifier),n=r.startPosition,o=r.value;e.getToken(i.b.LeftParenthesis);var a=[];if(!(r=e.tryGetToken(i.b.RightParenthesis))){do{a.push(this._parseExpressionRecursive(e,t))}while(e.tryGetToken(i.b.Comma));r=e.getToken(i.b.RightParenthesis)}for(var c=[];;){var s=e.tryAcceptToken(i.b.QuestionMark);if(e.tryAcceptToken(i.b.Dot))r=e.getToken(i.b.Identifier),c.push(w(s,!0,O(r.value)));else{if(!e.tryAcceptToken(i.b.LeftSquareBracket)){if(s)throw new b(t.WorkflowError.UnexpectedDereference,m.UNEXPECTED_DEREFERENCE);break}var l=this._parseExpressionRecursive(e,t);r=e.getToken(i.b.RightSquareBracket),c.push(w(s,!1,l))}}return function(e,t,r,n,o,i){return{type:y.Function,expression:e,startPosition:t,endPosition:r,functionName:n,functionArguments:o,dereferences:i}}(e.expression,n,r.endPosition,o,a,c)}}],[{key:"isTemplateExpression",value:function(e){return!(!e||e.length<2)&&("@"===e.charAt(0)||e.indexOf("@{")>0)}}]),e}();function h(e){return{type:y.BooleanLiteral,value:e}}function g(e){return{type:y.NumberLiteral,value:e}}function O(e){return{type:y.StringLiteral,value:e}}function w(e,t,r){return{isSafe:e,isDotNotation:t,expression:r}}function E(e){return{type:y.StringInterpolation,segments:e}}},20318:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return h}));var n=r(14883),o=r(13031),i=r(13084),a=r(16808);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function s(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){return e.LIMIT_EXCEEDED="LimitExceeded",e.STRING_LITERAL_NOT_TERMINATED="StringLiteralNotTerminated",e.TOKEN_NOT_FOUND="TokenNotFound",e.UNEXPECTED_CHARACTER="UnexpectedCharacter",e}({}),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(r,e);var t=f(r);function r(e,n){return u(this,r),t.call(this,"Workflow.ExpressionScannerException",e,n)}return s(r)}(a.a),v=function(e){return e.Dot="Dot",e.Comma="Comma",e.LeftParenthesis="LeftParenthesis",e.RightParenthesis="RightParenthesis",e.LeftSquareBracket="LeftSquareBracket",e.RightSquareBracket="RightSquareBracket",e.QuestionMark="QuestionMark",e.StringLiteral="StringLiteral",e.IntegerLiteral="IntegerLiteral",e.FloatLiteral="FloatLiteral",e.Identifier="Identifier",e.EndOfData="EndOfData",e}({}),h=function(){function e(t,r,n){u(this,e),this._options=void 0,this._expression=void 0,this._startPosition=void 0,this._currentToken=void 0,this.clientResources=void 0;if(this.clientResources=r,t.length>8192)throw new y(Object(o.a)(this.clientResources.WorkflowError.ExpressionScannerLimitExceeded,t.length,8192),b.LIMIT_EXCEEDED);this._options=n||{},this._expression=t,this._startPosition=0,this._options.doNotPrefetch||this._moveNext()}return s(e,[{key:"expression",get:function(){return this._expression}},{key:"getToken",value:function(e){var t=this.tryGetToken(e);if(!t)throw new y(Object(o.a)(this.clientResources.WorkflowError.ExpressionScannerTokenNotFound,e),b.TOKEN_NOT_FOUND);return t}},{key:"getNextToken",value:function(){return this._moveNext(),this._currentToken}},{key:"tryGetToken",value:function(e){if(this._currentToken.type===e){var t=this._currentToken;return this._moveNext(),t}}},{key:"tryGetIdentifier",value:function(e){if(this._currentToken.type===v.Identifier&&Object(n.e)(e,this._currentToken.value)){var t=this._currentToken;return this._moveNext(),t}}},{key:"tryAcceptToken",value:function(e){return void 0!==this.tryGetToken(e)}},{key:"tryAcceptIdentifier",value:function(e){return!(this._currentToken.type!==v.Identifier||!Object(n.e)(e,this._currentToken.value))&&(this._moveNext(),!0)}},{key:"_moveNext",value:function(){this._currentToken=this._readNext()}},{key:"_readNext",value:function(){for(var e=this._expression,t=this._startPosition,r=t;r<e.length&&Object(i.a)(e.charAt(r));)r++;var a=r;if(!(r<e.length))return this._startPosition=r,this._createEndOfData(t,this._startPosition);switch(e.charAt(r)){case".":return this._startPosition=r+1,this._createDot(t,this._startPosition);case",":return this._startPosition=r+1,this._createComma(t,this._startPosition);case"(":return this._startPosition=r+1,this._createLeftParenthesis(t,this._startPosition);case")":return this._startPosition=r+1,this._createRightParenthesis(t,this._startPosition);case"[":return this._startPosition=r+1,this._createLeftSquareBracket(t,this._startPosition);case"]":return this._startPosition=r+1,this._createRightSquareBracket(t,this._startPosition);case"?":return this._startPosition=r+1,this._createQuestionMark(t,this._startPosition);case"'":for(;r<e.length&&(r=this._scanForward(r+1,e=>"'"!==e))+1<e.length&&"'"===e.charAt(r+1);)r++;if(r>=e.length)throw new y(this.clientResources.WorkflowError.ExpressionScannerStringLiteralNotTerminated,b.STRING_LITERAL_NOT_TERMINATED);this._startPosition=r+1;var c=e.substring(a+1,r).replace(/''/g,"'");return this._createStringLiteral(c,t,this._startPosition);default:var s=e.charAt(r);if("+"===s||"-"===s||this._isDigit(s)){r="+"===s||"-"===s?r+1:r;var l=!1;if((r=this._scanForward(r,e=>this._isDigit(e)))<e.length&&"."===e.charAt(r)&&(l=!0,r=this._scanForward(r+1,e=>this._isDigit(e))),r+1<e.length&&Object(n.e)(e.charAt(r),"e")&&(l=!0,r="+"===(s=e.charAt(r+1))||"-"===s?r+2:r+1,r=this._scanForward(r,e=>this._isDigit(e))),r<e.length&&this._isSupportedIdentifierCharacter(e.charAt(r)))throw new y(Object(o.a)(this.clientResources.WorkflowError.ExpressionScannerUnexpectedCharacter,e.charAt(r)),b.UNEXPECTED_CHARACTER);this._startPosition=r;var u=e.substring(a,r);return l?this._createFloatLiteral(u,t,this._startPosition):this._createIntegerLiteral(u,t,this._startPosition)}if(this._isSupportedIdentifierCharacter(s)){this._startPosition=this._scanForward(r,e=>this._isSupportedIdentifierCharacter(e));var p=e.substring(a,this._startPosition);return this._createIdentifier(p,t,this._startPosition)}throw new y(Object(o.a)(this.clientResources.WorkflowError.ExpressionScannerUnexpectedCharacter,s),b.UNEXPECTED_CHARACTER)}}},{key:"_scanForward",value:function(e,t){for(var r=this._expression;e<r.length&&t(r.charAt(e));)e++;return e}},{key:"_isSupportedIdentifierCharacter",value:function(e){if("$"===e||"_"===e||this._isDigit(e))return!0;if(Object(i.a)(e))return!1;switch(e){case".":case",":case"(":case")":case"[":case"]":case"?":case"'":case"{":case"}":case"@":return!1;default:return!0}}},{key:"_isDigit",value:function(e){switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return!0;default:return!1}}},{key:"_createEndOfData",value:function(e,t){return{type:v.EndOfData,value:"",startPosition:e,endPosition:t}}},{key:"_createDot",value:function(e,t){return{type:v.Dot,value:".",startPosition:e,endPosition:t}}},{key:"_createComma",value:function(e,t){return{type:v.Comma,value:",",startPosition:e,endPosition:t}}},{key:"_createLeftParenthesis",value:function(e,t){return{type:v.LeftParenthesis,value:"(",startPosition:e,endPosition:t}}},{key:"_createRightParenthesis",value:function(e,t){return{type:v.RightParenthesis,value:")",startPosition:e,endPosition:t}}},{key:"_createLeftSquareBracket",value:function(e,t){return{type:v.LeftSquareBracket,value:"[",startPosition:e,endPosition:t}}},{key:"_createRightSquareBracket",value:function(e,t){return{type:v.RightSquareBracket,value:"]",startPosition:e,endPosition:t}}},{key:"_createQuestionMark",value:function(e,t){return{type:v.QuestionMark,value:"?",startPosition:e,endPosition:t}}},{key:"_createIntegerLiteral",value:function(e,t,r){return{type:v.IntegerLiteral,value:e,startPosition:t,endPosition:r}}},{key:"_createFloatLiteral",value:function(e,t,r){return{type:v.FloatLiteral,value:e,startPosition:t,endPosition:r}}},{key:"_createStringLiteral",value:function(e,t,r){return{type:v.StringLiteral,value:e,startPosition:t,endPosition:r}}},{key:"_createIdentifier",value:function(e,t,r){return{type:v.Identifier,value:e,startPosition:t,endPosition:r}}}]),e}()},20319:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={FX_TOKEN:"#AD008C",VARIABLE:"#770BD6"}},20320:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAzNCAzNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiA8cmVjdCB3aWR0aD0iMzQiIGhlaWdodD0iMzQiIGZpbGw9IiNhZDAwOGMiLz4NCiA8cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMTMuNDg3LDEzLjI0OGE3LjA1NCw3LjA1NCwwLDAsMSwxLjg0OS0zLjY5QTUuMyw1LjMsMCwwLDEsMTguNTkzLDcuOWMuOTg1LDAsMS40NjcuNTg1LDEuNDQ3LDEuMDY5YTEuNTUxLDEuNTUxLDAsMCwxLS43NDQsMS4xNDkuNDA2LjQwNiwwLDAsMS0uNTQzLS4wNjFjLS41NDMtLjY2NS0xLjAwNS0xLjA2OS0xLjM2Ny0xLjA2OS0uNC0uMDItLjc2NC4yODItMS40MDcsNC4yNTVoMi4zMzJsLS40MjIuODA3LTIuMDkuMTYxYy0uMzQyLDEuODM1LS42LDMuNjMtMS4xNDYsNS45MDgtLjc4NCwzLjMyNy0xLjY4OCw0LjY1OC0zLjEsNS44MjdBMy43NDYsMy43NDYsMCwwLDEsOS4zNDcsMjdDOC42ODMsMjcsOCwyNi41NTYsOCwyNi4wMzJhMS42OTIsMS42OTIsMCwwLDEsLjcyNC0xLjE0OWMuMTYxLS4xMjEuMjgxLS4xNDEuNDIyLS4wNGEyLjg3MywyLjg3MywwLDAsMCwxLjU2OC43MDYuNjc1LjY3NSwwLDAsMCwuNjYzLS41LDI3LjQyNywyNy40MjcsMCwwLDAsLjg0NC00LjE3NGMuNDYyLTIuNzYyLjc0NC00LjY1OCwxLjA4NS02LjY1NEgxMS43bC0uMS0uMi42ODMtLjc2NloiLz4NCiA8cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMTcuMzIxLDE4LjljLjgxMi0xLjE4MywxLjY1NC0xLjg3NCwyLjIzNi0xLjg3NC40OSwwLC43MzUuNTIyLDEuMDU3LDEuNDlsLjIzLjcyMmMxLjE2NC0xLjY3NSwxLjczMS0yLjIxMiwyLjQtMi4yMTJhLjc0Mi43NDIsMCwwLDEsLjc1MS44NDUuOTIyLjkyMiwwLDAsMS0uOC44NzYuNDE0LjQxNCwwLDAsMS0uMjkxLS4xNjkuNDc3LjQ3NywwLDAsMC0uMzY4LS4xODRjLS4xNTMsMC0uMzM3LjEwOC0uNjEzLjM4NGE4LjU0Nyw4LjU0NywwLDAsMC0uODczLDEuMDc1bC42MTMsMS45NjZjLjE4NC42My4zNjcuOTUyLjU2Ny45NTIuMTg0LDAsLjUwNi0uMjQ2LDEuMDQyLS44OTFsLjMyMi4zODRjLS45LDEuNDI5LTEuNzYxLDEuOTItMi4zNDMsMS45Mi0uNTIxLDAtLjg1OC0uNDMtMS4xOC0xLjQ5bC0uMzUyLTEuMTY4Yy0xLjE3OSwxLjkyLTEuNzQ2LDIuNjU4LTIuNTQzLDIuNjU4YS44MTUuODE1LDAsMCwxLS44MTItLjg3NS45LjksMCwwLDEsLjc2Ni0uOTIyLjQ5My40OTMsMCwwLDEsLjI5MS4xNTQuNTE0LjUxNCwwLDAsMCwuMzY4LjE2OWMuMzM3LDAsLjk1LS42NzYsMS43MTUtMS44NTlsLS40LTEuMzY3Yy0uMjc2LS45MDYtLjQxNC0xLjAxNC0uNTY3LTEuMDE0LS4xMzgsMC0uNDE0LjItLjg4OC44MTRaIi8+DQo8L3N2Zz4NCg=="},20321:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n={PARAMETER:"PARAMETER",TOKEN:"TOKEN",VARIABLE:"VARIABLE"},o=function(e){return e[e.TOKEN=0]="TOKEN",e[e.EXPRESSION=1]="EXPRESSION",e}({})},20322:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r(11766),o=r(13262),i=r(12706),a=r(20323),c=r(20325),s=r(20404),l=r(20410),u=r(20411),p=r(13223),f=r(20321),d=r(13259),m=r(17266),b=r(13272),y=r(19713),v=r(13240);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(C,e);var t,r,p,O=E(C);function C(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,C),(t=O.call(this,e)).getClassNames=Object(i.a)(),t._editorContext=Object(y.a)(),t._childEditorRef=void 0,t._childKey=j(),t.onRenderEditor=()=>{var e,{editorOptions:{readonly:r,summary:i}}=t.props,a=null===(e=t.props.editorState.complexValue)||void 0===e?void 0:e.editorState,u=t.state.isCodeView?n.createElement(c.a,{key:t._childKey,editorContext:t.props.editorContext,valueSegments:t.state.valueSegments,readOnly:r,summary:null!=i?i:"",onChange:t.handleCodeEditorChange,ref:t.setComponentRef}):n.createElement(s.a,{key:t._childKey,addItem:a.addDictionaryItem,editorContext:t.props.editorContext,editorOptions:t.props.editorOptions,items:t.state.items,readOnly:r,ref:t.setComponentRef}),p=t.state.isCodeView?t._editorContext.designerResources.DictionaryEditor.KeyValueButton:t._editorContext.designerResources.DictionaryEditor.CodeViewButton,f=t.state.isCodeView?b.a.PageHeaderEdit:b.a.CodeEdit,m=t.getClassNames(l.a);return n.createElement("div",{className:m.root},!t.props.hideToggle&&n.createElement(o.a,{content:p},n.createElement(d.a,{disabled:!t.state.toggleEnabled,iconName:f,onClick:t.handleToggleModeClicked,title:p})),n.createElement("div",{className:m.editor},u))},t.setComponentRef=e=>{e&&(t._childEditorRef=e)},t.handleCodeEditorChange=e=>{t.props.onChange({value:e}),t._childKey=j();var r,n,o=t.getToggleEnabled(e),{complexValue:i}=t.props.editorState;i&&o&&(null===(r=(n=i.editorState).updateViewModel)||void 0===r||r.call(n));t.setState({toggleEnabled:o,valueSegments:e})},t.handleToggleModeClicked=()=>{var{complexValue:e}=t.props.editorState;e&&t.state.toggleEnabled&&(e.editorState.toggleMode(),t._editorContext.telemetryService.tagEvent(v.c.DictionaryEditorToggledModeClicked,{mode:t.state.isCodeView?"TableView":"CodeView"}))},!t.props.editorState.complexValue)throw new m.a(void 0,"This is unexpected. complexValue should not be null.");var r=t.props.editorState.complexValue.editorState,a=r.inCodeViewMode?t.props.editorState.value:Object(u.a)(r.items);return t.state={isCodeView:r.inCodeViewMode,items:r.items,toggleEnabled:t.getToggleEnabled(a),valueSegments:a},t._editorContext.telemetryService.tagEvent(v.c.DictionaryEditorRendered),t}return t=C,p=[{key:"getDerivedStateFromProps",value:function(e,t){if(e.editorState.complexValue){var r=e.editorState.complexValue.editorState,n=r.items;if(Object(u.b)(t.items,n)||t.isCodeView!==r.inCodeViewMode)return{isCodeView:r.inCodeViewMode,items:n,toggleEnabled:t.toggleEnabled,valueSegments:t.toggleEnabled?Object(u.a)(n):t.valueSegments}}return null}}],(r=[{key:"render",value:function(){return n.createElement(a.a,h({},this.props,{onRenderEditor:this.onRenderEditor}))}},{key:"focus",value:function(){this._childEditorRef&&this._childEditorRef.focus()}},{key:"scrollIntoView",value:function(){this._childEditorRef&&this._childEditorRef.scrollIntoView()}},{key:"getToggleEnabled",value:function(e){if(Object(u.c)(e))return!1;var t=this.props.editorContext.getService(f.a.PARAMETER),r=t&&t.getParameterInfo(),n=r&&r.validationErrors;return!n||0===n.length}}])&&g(t.prototype,r),p&&g(t,p),Object.defineProperty(t,"prototype",{writable:!1}),C}(n.Component);function j(){return Object(p.a)()}},20323:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r(12706),i=r(12811),a=r(20324),c=r(20321),s=r(19713),l=r(13262),u=r(12812),p=r(20154);function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(v,e);var t,r,d,y=b(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=y.call(this,e)).getClassNames=Object(o.a)(),t.classNames=t.getClassNames(a.a),t.useNewTokenPicker=void 0,t._tipTarget=n.createRef(),t.parameterService=void 0,t.parameterInfo=void 0,t._editorContext=Object(s.a)(),t.renderEditor=e=>{var r=Object(i.a)({[t.classNames.editor]:t.useNewTokenPicker}),o=t.props.onRenderEditor({containerClassName:e,editorClassName:r,parameterInfo:t.parameterInfo,useNewStyle:t.useNewTokenPicker});return t.useNewTokenPicker?o:n.createElement("div",{className:"msla-input-parameter-content-wrapper"},o,t.renderErrors())},t.renderEditorLabel=()=>{var{editorOptions:{displayName:e,hideLabel:r,isRequired:o},labelId:i,labelTooltip:a,required:c}=t.props;if(r)return null;var s="msla-input-parameter-label";t.props.labelTooltip&&(s+=" msla-label-with-tooltip");return n.createElement("div",{className:s},n.createElement("label",{className:"msla-label",title:null!=e?e:"",id:i},(o||c)&&t.renderRequiredIcon(),e))},t.renderRequiredIcon=()=>n.createElement("span",{className:"msla-label-required-parameter","aria-label":t._editorContext.globalResources.Common.Required},"*"),t.renderTooltip=()=>{var{labelTooltip:e}=t.props;return n.createElement(l.a,{content:e,hostClassName:"msla-label-tooltip"},n.createElement(u.a,{className:"msla-label-tooltip-icon",ariaLabel:e,iconName:"info"}))},t.useNewTokenPicker=Object(p.b)(p.a.designerNewTokenPickerV2),t.parameterService=e.editorContext.getService(c.a.PARAMETER),t}return t=v,(r=[{key:"render",value:function(){if(this.parameterInfo=this.parameterService.getParameterInfo(),!this.parameterInfo)return null;var e=Object(i.a)("msla-input-parameter",this.props.className),t=Object(i.a)({[this.classNames.content]:this.useNewTokenPicker,"msla-input-parameter-content":!this.useNewTokenPicker});return this.useNewTokenPicker?n.createElement("div",{className:e,ref:this._tipTarget},this.renderEditorLabel(),n.createElement("div",{className:"msla-input-parameter-content-wrapper"},this.renderEditor(t),this.useNewTokenPicker&&this.renderErrors())):n.createElement("div",{className:e,ref:this._tipTarget},this.renderEditorLabel(),this.renderEditor(t),this.useNewTokenPicker&&this.renderErrors())}},{key:"renderErrors",value:function(){var{validationErrors:e}=this.props.editorOptions;return e&&e.length?e.map(e=>n.createElement(g,{className:this.useNewTokenPicker?this.classNames.error:"",errorMessage:e,key:e,useNewStyle:this.useNewTokenPicker,removePadding:this.parameterInfo&&this.parameterInfo.isSchemaEditor})):null}}])&&f(t.prototype,r),d&&f(t,d),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component);function g(e){var{className:t,key:r,errorMessage:o,removePadding:a,useNewStyle:c}=e,s=Object(i.a)({"msla-input-parameter-error":!c,"msla-label":!c,"msla-schema-label":a},t);return n.createElement("span",{key:r,className:s,"aria-live":"assertive"},o)}},20324:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{root:["fl-Parameter",{}],label:["fl-Parameter-Label",{color:e.black,fontSize:n.k.medium,fontWeight:n.l.semibold,height:24}],labelIcon:["fl-Parameter-Label-Icon",{color:e.redDark,paddingLeft:2}],content:["fl-Parameter-Content",{width:"100%"}],editor:["fl-Editor",{width:"100%"}],error:["fl-Parameter-Error",{display:"block",color:e.red,fontSize:n.k.size12}]}}},20325:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r(11769),i=r.n(o),a=r(20326),c=r(12706),s=r(20403),l=r(20400);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(b,e);var t,r,o,f=m(b);function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(t=f.call(this,e)).getClassNames=Object(c.a)(),t.classNames=t.getClassNames(s.a),t.defaultEditorRef=n.createRef(),t.onChange=e=>{t.props.onChange(null==e?void 0:e.value)},t._onFocus=e=>{t.setState({isFocused:!0})},t._onBlur=e=>{var r=i.a.findDOMNode(y(t)),n=e.relatedTarget instanceof Node&&(null==r?void 0:r.contains(e.relatedTarget));Object(l.b)(e)||n||t.setState({isFocused:!1})},t.state={isFocused:!1},t}return t=b,(r=[{key:"render",value:function(){var e={editorState:{value:this.props.valueSegments},editorOptions:{displayName:null,locale:null,hideLabel:!0,readonly:this.props.readOnly,validationErrors:[],summary:this.props.summary,showTokenPicker:this.state.isFocused},editorContext:this.props.editorContext,onChange:this.onChange};return n.createElement(a.a,u({className:this.classNames.root,ref:this.defaultEditorRef,onBlur:this._onBlur,onFocus:this._onFocus},e))}},{key:"focus",value:function(){this.defaultEditorRef&&this.defaultEditorRef.current&&this.defaultEditorRef.current.focus()}},{key:"scrollIntoView",value:function(){this.defaultEditorRef&&this.defaultEditorRef.current&&this.defaultEditorRef.current.scrollIntoView()}}])&&p(t.prototype,r),o&&p(t,o),Object.defineProperty(t,"prototype",{writable:!1}),b}(n.Component)},20326:function(e,t,r){"use strict";r.d(t,"a",(function(){return U})),r.d(t,"b",(function(){return V}));var n=r(12706),o=r(12811),i=r(20163),a=r(20402),c=r(11766),s=r(20327),l=r(20365),u=r(13240),p=r(20155),f=r(20154),d=r(12999),m=r(20368),b=r(17244),y=r(20321),v=r(20313),h=r(20369),g=r(20370),O=r(20162),w=r(20373),E=r(20376),C=r(20397),S=r(20399),P=r(20400),j=r(19713),T=r(20323),k=r(20401);function R(){return(R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D(n.key),n)}}function _(e,t,r){return t&&N(e.prototype,t),r&&N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}function A(e,t){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function F(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=M(e);if(t){var o=M(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return L(this,r)}}function L(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=function(e){return e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.None=2]="None",e}(B||{}),U=function(e){I(r,e);var t=F(r);function r(e){var s;x(this,r),(s=t.call(this,e)).getClassNames=Object(n.a)(),s.classNames=s.getClassNames(k.a),s.customKeyBindingFn=void 0,s.customKeyHandlers=void 0,s.editorContext=Object(j.a)(),s.formulaFromExamplesRef=c.createRef(),s.parameterService=void 0,s.textControlRef=c.createRef(),s.textElementRef=c.createRef(),s.tokenCalloutRef=c.createRef(),s.tokenRefMap=new Map,s.renderEditor=e=>{var t,r,n=null==e?void 0:e.editorClassName,i=null==e?void 0:e.useNewStyle,{editorOptions:{readonly:a},className:l,ignoreWrapperComponent:u}=s.props,{editorState:p}=s.state,f=Object(o.a)({"msla-text-editor":!0,[b.a.UIClassNames.TokenPickerNonDismissible]:!0,[b.a.UIClassNames.InputBox]:!u,[b.a.UIClassNames.InputControl]:!u,[s.classNames.useNewInputControl]:!!i},s.classNames.textElement,s.classNames.focusWithin&&!u,l,n);return c.createElement("div",{className:s.classNames.root},c.createElement(g.a,{htmlRef:s.textElementRef,ref:s.textControlRef,ariaLabel:null!==(t=s.props.editorOptions.displayName)&&void 0!==t?t:"",className:f,editorState:p,keyBindingFn:s.customKeyBindingFn,keyHandlers:s.customKeyHandlers,readOnly:a,summary:null!==(r=s.props.editorOptions.summary)&&void 0!==r?r:"",onBlur:s.handleOnBlur,onChange:s.handleDraftEditorStateChanged,onCopy:s.handleCopy,onCut:s.handleCut,onFocus:s.handleOnFocus,onPaste:s.handlePastedText}),s.renderTokenBar())},s.renderTokenPickerLegacy=()=>{var{editorContext:e,editorOptions:{displayName:t,displayTokenPickerInline:r,schema:n,showTokenPicker:o},editorState:{value:i}}=s.props,{selectedEntityKey:a,editorState:l}=s.state,u=e.getService(y.a.TOKEN),p="";if(a){var f=Object(O.h)(l,a);if(f&&!Object(O.u)(f)){var{expression:d}=f.getData();p=Object(v.h)(i,d.tokenKey)}}var m=p?{id:p,value:Object(v.i)(i,p)}:void 0,h=null!=t?t:void 0,g=n&&n.type?{schema:n,displayName:h}:{schema:{type:b.a.Swagger.TYPE.ANY},displayName:h};return c.createElement(P.a,{activeSelectedSegmentInfo:m,displayInline:null!=r&&r,parameterContext:g,tokenService:u,visible:null!=o&&o,handleTokenSelection:s.handleTokenSelectionFromPickerLegacy,handleTokenPickerOKClicked:s.handleTokenSelectionFromPickerLegacy,getCustomTokenPickerSections:s.getCustomTokenPickerLegacySections})},s.getCustomTokenPickerLegacySections=void 0,s.onFormulaFromExamplesOptionClicked=()=>{var e,{editorOptions:{displayName:t,schema:r}}=s.props,n=null!=r&&r.type?{schema:r,displayName:null!=t?t:void 0}:{schema:{type:b.a.Swagger.TYPE.ANY},displayName:null!=t?t:void 0};null===(e=s.formulaFromExamplesRef.current)||void 0===e||e.initializeAndOpen({parameter:n,onApply:e=>s.onFormulaFromExamplesApply(e),onCancel:()=>s.onFormulaFromExamplesCancelled()})},s.onFormulaFromExamplesCancelled=()=>{var e,{editorContext:t}=s.props,r=t.getService(y.a.TOKEN),{editorState:n}=s.state,o=Object(O.x)(n);s.setState({editorState:o,selectedEntityKey:void 0,previousTokenOperation:B.None},()=>{r.setTokenPickerVisibility(!1),s.commitChanges(o),s.onSetStateCompleted()}),null===(e=s.formulaFromExamplesRef.current)||void 0===e||e.close()},s.onFormulaFromExamplesApply=e=>{var t,{expression:r}=e;s.onNewExpressionValue(r),null===(t=s.formulaFromExamplesRef.current)||void 0===t||t.close()},s.onWatchFormulaFromExamplesTutorial=()=>{var e;null===(e=s.formulaFromExamplesRef.current)||void 0===e||e.openTutorial()},s.renderTokenPicker=()=>{var{editorContext:e,editorOptions:{showTokenPicker:t}}=s.props;if(t||s.state.selectedEntityKey){var r,{attachTokenPickerToRef:n,editorState:o,selectedEntityKey:i,tokenPickerModeOverride:a}=s.state,l=e.getService(y.a.TOKEN);if(i){var u=Object(O.h)(o,i);if(u){var{expression:p}=u.getData();if(p){var f=Object(O.m)(o,Object(O.c)(o)),d=Object(v.h)(f,p.tokenKey);r=d?{id:d,value:Object(v.i)(f,d)}:void 0}}}return c.createElement(S.a,{activeSelectedSegmentInfo:r,attachTokenPickerTo:n,calloutProps:{onBlur:s.handleOnBlur,onRestoreFocus:()=>{},setInitialFocus:!0},calloutRef:s.tokenCalloutRef,defaultTokenCalloutMode:a,formulaFromExamplesRef:s.formulaFromExamplesRef,onCancel:()=>s.closeTokenPicker(!0),onExpressionSave:s.onNewExpressionValue,onTokenSelect:s.handleTokenSelectionFromPicker,parameterService:s.parameterService,showCloseXButton:!0,tokenService:l})}},s.renderTokenBar=()=>{var{editorOptions:{readonly:e,showTokenPicker:t}}=s.props;return Object(f.b)(f.a.designerNewTokenPickerV2)&&t&&!s.isTokenPickerVisible()?c.createElement(C.a,{disableTokenPickerActions:e,isFloatingPosition:!0,onAddDynamicContentClick:()=>s.openTokenPicker("dynamic"),onAddExpressionClick:()=>s.openTokenPicker("expression"),onBlur:s.handleOnBlur},s.props.renderMenubarChildren?s.props.renderMenubarChildren():null):null},s.forceFocus=()=>{s.textControlRef.current&&(document.activeElement&&document.activeElement.blur(),s.textControlRef.current.focus())},s.focus=()=>{s.textControlRef.current&&s.textControlRef.current.focus()},s.closeTokenPicker=e=>{s.isTokenPickerVisible()&&(s.updateTokenPickerVisible(!1),e&&s.focus())},s.openTokenPicker=e=>{s.updateTokenPickerVisible(e||"dynamic")},s.getIsReadOnly=()=>s.props.editorOptions.readonly,s.getSelectionState=()=>{var{editorState:e,selectedEntityKey:t}=s.state;return t?Object(O.k)(e.getCurrentContent(),t):e.getSelection()},s.updateTokenPickerVisible=e=>{if(!s.props.editorOptions.readonly){var t=e?s.textElementRef:void 0;s.state.attachTokenPickerToRef!==t&&s.setState({attachTokenPickerToRef:t,selectedEntityKey:e?s.state.selectedEntityKey:void 0,tokenPickerModeOverride:e||void 0},s.onSetStateCompleted)}},s.handleDraftEditorStateChanged=e=>{s.setState({editorState:e},s.onSetStateCompleted)},s.handleOnFocus=e=>{s.parameterExists()&&s.props.editorContext.getService(y.a.TOKEN).setTokenPickerVisibility(!0);s.props.onFocus&&s.props.onFocus(e)},s.handleOnBlur=e=>{var t,r=Object(E.c)(e)||Object(P.b)(e)||Object(C.c)(e)||Object(E.b)(e),n=s.isFocusWithinOwnEditor(e)&&(Object(w.b)(e)||Object(g.b)(e));if(!(r||n)){if(null===(t=s.tokenCalloutRef.current)||void 0===t||!t.preventDismissOnLostFocus)if(s.commitChanges(s.state.editorState),Object(f.b)(f.a.designerNewTokenPickerV2))s.props.editorContext.getService(y.a.TOKEN).setTokenPickerVisibility(!1),s.closeTokenPicker(!1);s.props.onBlur&&s.props.onBlur(e)}},s.isFocusWithinOwnEditor=e=>!(!s.textElementRef.current||!e.relatedTarget)&&Object(m.a)(s.textElementRef.current,e.relatedTarget),s.isTokenPickerVisible=()=>!!s.state.attachTokenPickerToRef,s.onNewExpressionValue=e=>{if(e){var{editorState:t}=s.state,r=t,n=s.getSelectionState();if(n){r=Object(O.s)(t,n,e,s.editorContext.designerResources);var o=Object(O.i)(s.editorContext.designerResources,e),i=Object(v.n)(o);s.editorContext.telemetryService.tagEvent(u.c.InvalidExpressionInserted,null,{isInvalid:i,editorType:"DefaultEditor",message:"User saved an invalid expression from the expression editor"}),s.setState({editorState:r},()=>{s.commitChanges(r),s.onSetStateCompleted(),Object(f.b)(f.a.designerNewTokenPickerV2)&&s.closeTokenPicker(!0)})}}},s.commitChanges=e=>{if(s.parameterExists()){var t=Object(O.m)(e,Object(O.c)(e));s.props.onChange({value:t})}},s.handleTokenSelectionFromPicker=e=>{var{editorState:t}=s.state,n=s.getSelectionState();if(n){var{segment:o}=e,i=[o],a=Object(O.z)(t,n,i,!0,!0);a=Object(O.x)(a),s.setState({selectedEntityKey:void 0,editorState:a,previousTokenOperation:B.Insert},()=>{s.commitChanges(s.state.editorState),s.onSetStateCompleted(),Object(f.b)(f.a.designerNewTokenPickerV2)&&s.closeTokenPicker(!1),setTimeout(s.forceFocus,r.FORCE_FOCUS_TIMEOUT)})}},s.handleTokenSelectionFromPickerLegacy=e=>{var{editorState:t}=s.state,{segment:n}=e,o=[n],i=Object(O.z)(t,t.getSelection(),o,!0);s.setState({attachTokenPickerToRef:void 0,selectedEntityKey:void 0,previousTokenOperation:B.Insert,editorState:i},()=>{s.commitChanges(s.state.editorState),s.onSetStateCompleted(),setTimeout(()=>s.forceFocus(),r.FORCE_FOCUS_TIMEOUT)})},s.onSetStateCompleted=()=>{s.fireDraftEditorStateOnChange(s.state.editorState)},s.fireDraftEditorStateOnChange=e=>{var{onEditorStateChange:t}=s.props;t&&t(e)},s.deleteEntityFromEditorState=(e,t)=>(s.tokenRefMap.delete(t),Object(O.y)(e,t)),s.handleTokenDelete=e=>{var{editorOptions:t}=s.props;if(!t.readonly){var{attachTokenPickerToRef:r,editorState:n}=s.state,{inputKey:o}=e,i=s.deleteEntityFromEditorState(n,o);s.setState({attachTokenPickerToRef:Object(f.b)(f.a.designerNewTokenPickerV2)?r:void 0,editorState:i,selectedEntityKey:void 0,previousTokenOperation:B.Delete},()=>{s.commitChanges(i),s.onSetStateCompleted()})}},s.handleTokenSelect=e=>{var{editorOptions:t}=s.props;if(!t.readonly){var{editorState:r}=s.state,{inputKey:n}=e;if(Object(f.b)(f.a.designerNewTokenPickerV2)){var o=s.tokenRefMap.get(n)||void 0;s.setState({attachTokenPickerToRef:o,selectedEntityKey:n},s.onSetStateCompleted)}else{var a=Object(O.k)(r.getCurrentContent(),n);if(a){var c=i.EditorState.forceSelection(r,a),l=n?s.tokenRefMap.get(n):void 0;s.setState({attachTokenPickerToRef:l,editorState:c,selectedEntityKey:n},()=>{s.props.editorContext.getService(y.a.TOKEN).setTokenPickerVisibility(!0),s.onSetStateCompleted()})}}}},s.handleCopy=e=>{e.preventDefault(),Object(O.b)(s.state.editorState,e)},s.handleCut=e=>{e.preventDefault();var t=Object(O.d)(s.state.editorState,e);s.setState({editorState:t},s.onSetStateCompleted)},s.handlePastedText=(e,t)=>{var r=s.state.editorState,n=Object(O.w)(e,r,s.parameterService);return s.setState({editorState:n},s.onSetStateCompleted),"handled"},s.parameterExists=()=>!!s.parameterService.getParameterInfo();var{editorContext:d,editorState:{value:T}}=e;s.parameterService=d.getService(y.a.PARAMETER),s.tokenRefMap.set(b.a.DraftJS.EntityTypePlaceholder,c.createRef());var R=new i.CompositeDecorator([{component:w.a,props:{getTokenDataForDisplay:O.l,onDelete:s.handleTokenDelete,onSelect:s.handleTokenSelect,readOnly:s.getIsReadOnly,tokenRefMap:s.tokenRefMap},strategy:(e,t,r)=>e.findEntityRanges(e=>{var t=e.getEntity(),n=t?r.getEntity(t):void 0;return!!Object(O.v)(n)&&(Object(O.t)(n)&&s.tokenRefMap.set(t,c.createRef()),!0)},t)}]);return s.state={areExpressionsDifferent:Object(a.a)((e,t)=>Object(v.c)(e,t)),attachTokenPickerToRef:void 0,editorState:Object(O.g)(T,R),selectedEntityKey:void 0,previousTokenOperation:B.None,value:T},Object(f.b)(f.a.designerNewTokenPickerV2)&&(s.customKeyBindingFn=Object(h.b)(h.a.OpenDynamicContentPicker,h.a.OpenExpressionEditor,h.a.DebugEditorState),s.customKeyHandlers={[h.a.DebugEditorState]:O.e,[h.a.OpenDynamicContentPicker]:()=>s.openTokenPicker("dynamic"),[h.a.OpenExpressionEditor]:()=>s.openTokenPicker("expression")}),s.getCustomTokenPickerLegacySections=Object(p.a)()?Object(l.a)({onFormulaFromExamplesOptionClicked:s.onFormulaFromExamplesOptionClicked,loggingService:s.editorContext.loggingService,resources:s.editorContext.designerResources.ExpressionFromExamples.TokenPicker}):void 0,s}return _(r,[{key:"render",value:function(){var{editorContext:e}=this.props,t=Object(f.b)(f.a.designerNewTokenPickerV2),r=e.getService(y.a.TOKEN);return c.createElement(c.Fragment,null,this.props.ignoreWrapperComponent?this.renderEditor({useNewStyle:t}):c.createElement(T.a,R({},this.props,{onRenderEditor:this.renderEditor})),t?this.renderTokenPicker():this.renderTokenPickerLegacy(),c.createElement(s.a,{designerEditorContext:this.editorContext,tokenService:r,ref:this.formulaFromExamplesRef}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(t.areExpressionsDifferent(e.editorState.value,t.value)){var r,n=t.editorState,o=n.getCurrentContent(),a=Object(O.z)(n,Object(O.c)(n),e.editorState.value,!1);if(t.previousTokenOperation===B.Insert)r=o.getSelectionAfter();else if(t.previousTokenOperation===B.Delete){var c=o.getSelectionAfter();r=Object(O.f)(c)}return r&&(a=i.EditorState.forceSelection(a,r)),{attachTokenPickerToRef:t.attachTokenPickerToRef,areExpressionsDifferent:t.areExpressionsDifferent,editorState:a,selectedEntityKey:t.selectedEntityKey,value:e.editorState.value,previousTokenOperation:B.None}}return t}}]),r}(c.Component);U.FORCE_FOCUS_TIMEOUT=500;var V=function(e){I(r,e);var t=F(r);function r(){var e;x(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call(this,...o)).editorContext=Object(j.a)(),e}return _(r,[{key:"componentDidMount",value:function(){if(Object(d.a)().enableEasyAutomationDataTrainingExperience&&this.editorContext.easyAutomationPanelStore){var e=this.props.editorContext.getService(y.a.TOKEN),t=0;this.editorContext.easyAutomationPanelStore.tokenContext=e.getTokenGroupDefinitions().map(e=>e.tokens.map(e=>{var r,n,o,i,a;return{nodeId:e.data.nodeId,tokenKey:e.data.tokenKey,title:e.title,description:null!==(r=e.description)&&void 0!==r?r:"",format:null!==(n=null===(o=e.schema)||void 0===o?void 0:o.format)&&void 0!==n?n:"",type:null!==(i=null===(a=e.schema)||void 0===a?void 0:a.type)&&void 0!==i?i:"",value:e.data.value||"$"+t++,tokenType:e.data.tokenType}}))}}},{key:"componentWillUnmount",value:function(){Object(d.a)().enableEasyAutomationDataTrainingExperience&&this.editorContext.easyAutomationPanelStore&&(this.editorContext.easyAutomationPanelStore.tokenContext=void 0)}},{key:"render",value:function(){return c.createElement(U,this.props)}}]),r}(c.Component)},20327:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(14337),o=r(11766),i=r.n(o),a=r(20008),c=r(13192),s=r(18827),l=r(18815),u=r(12339),p=r(20328),f=r(20344),d=r(20356),m=r(20363),b=r(14689),y=r(18835),v=Object(n.c)(i.a.forwardRef((e,t)=>{var{designerEditorContext:r,tokenService:n}=e,[o]=i.a.useState(()=>{var e=Object(u.b)(),t=new s.AiHostedModelsHttpClient(e,new c.HttpClient,new b.a(Object(u.b)(),r.environmentStore,r.sessionStore),r.loggingService,r.tokenService,r.sessionStore),o=new y.a(r.loggingService,new c.HttpClient,r.sessionStore,r.environmentStore,r.tokenService),i=new l.a(r.environmentStore,t,r.loggingService,o),a={getTokenExpression:e=>n._createTokenValueSegment(e).tokenExpression};return new d.a(i,r.environmentStore,r.loggingService,r.sessionStore,a)});i.a.useImperativeHandle(t,()=>o,[o]);var v=r.designerResources.ExpressionFromExamples;return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{store:o,cdnService:r.cdnService,resources:v}),i.a.createElement(p.a,{isOpen:o.isInputPanelOpen,onDismiss:o.onInputPanelDismiss,onTokenSelected:o.onInputTokenSelected,tokenService:n,resources:v.DynamicContentPanel}),i.a.createElement(m.a,{isOpen:o.isTutorialOpen,onDismiss:o.closeTutorial,resources:v.Tutorials}),i.a.createElement(a.a,{isOpen:o.isFeedbackPanelOpen,onDismiss:o.onFeedbackPanelDismiss,surveyId:o.FEEDBACK_SURVEY_ID,getUserContext:o.getFeedbackSurveyUserContext,title:v.FeedbackPanel.Title,closeButtonAriaLabel:v.FeedbackPanel.CloseButtonAriaLabel}))}))},20328:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(12754),o=r(20329),i=r(14337),a=r(11766),c=r.n(a),s=r(20330),l=r(20332),u=r(14947),p=r(20342);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){return c.a.useCallback((t,r)=>Object(l.b)(t.filter(t=>function(e,t){var r;return[void 0,p.f.string,p.f.any,p.f.integer,p.f.number].includes(null===(r=e.schema)||void 0===r?void 0:r.type)&&!t.shouldAddForeachBeforeUsingToken(e)}(t,e)),r),[e])}var y=Object(i.c)(e=>{var{isOpen:t,onDismiss:r,onTokenSelected:n,tokenService:i,resources:a,_isBlocking:p=!0}=e,f=c.a.useCallback(e=>{n(e.token)},[n]),m=o.a.tokenPanel,y=b(i);return function(e,t){c.a.useEffect(()=>{if(t){s.a.setTokenGroupDefinitions(e.getTokenGroupDefinitions());var r=e.onTokenGroupDefinitionsChanged(()=>s.a.setTokenGroupDefinitions(e.getTokenGroupDefinitions()));return()=>r.unsubscribe()}},[t,e])}(i,t),c.a.createElement(u.a,{dataAutomationId:m.root,isOpen:t,onDismissed:r,isBlocking:p,isLightDismiss:!1,title:a.Title,closeButtonAriaLabel:a.CloseButtonAriaLabel,size:u.b.medium},c.a.createElement("div",{className:v.panelContent},c.a.createElement("div",{className:v.description},a.Description),t&&c.a.createElement("div",{"data-automation-id":m.tokenGroupDefinitionsList},c.a.createElement(l.a,{filterAndSortTokens:y,onTokenSelected:f,onSearchEscape:r,resources:d(d({},a.SearchBoxResources),{},{NoDynamicValuesTitle:a.NoDynamicValuesTitle,NoDynamicValuesDetails:a.NoDynamicValuesDetails})}))))}),v=Object(n.db)({panelContent:{display:"flex",flexDirection:"column",margin:"0px -16px"},description:{padding:"0px 16px"}})},20329:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(14678),o={panel:{root:"formulaFromExamplesPanel",closeButton:"closeButton",exampleInput:"exampleInput",exampleOutput:"exampleOutput",addExampleButton:"addExampleButton",getFormulaButton:"getFormulaButton",loadingResult:"loadingResult",successfulResult:"successfulResult",failedResult:"failedResult",testInput:"testInput",testOutput:"testOutput",testButton:"testButton",applyFormulaButton:"applyFormulaButton",cancelButton:"cancelButton",applyFormulaConfirmationDialog:{root:"applyFormulaConfirmationDialog",doNotShowAgainCheckbox:"doNotShowAgainCheckbox",applyButton:"applyButton",cancelButton:"cancelButton"},resources:{root:"resources",resourceButton:"resourceButton"}},tokenPanel:{root:"formulaFromExamplesTokenPanel",closeButton:"closeButton",tokenGroupDefinitionsList:"tokenGroupDefinitionsList"},teachingBubble:{root:"formulaFromExamplesTeachingBubble",closeButton:n.a.buttons.teachingBubbleCloseButton,watchTutorialButton:n.a.buttons.teachingBubblePrimaryButton},tutorialModal:{root:"formulaFromExamplesTutorialModal",closeButton:n.a.buttons.modalCloseButton,nextButton:"nextButton",backButton:"backButton"}}},20330:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(20331).a)},20331:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o,i=r(11773);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var l=(o=s((n=function(){function e(){var t,r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,r="tokenGroupDefinitions",i=this,(n=o)&&Object.defineProperty(t,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}var t,r,n;return t=e,(r=[{key:"setTokenGroupDefinitions",value:function(e){this.tokenGroupDefinitions=e}},{key:"getTokenGroupDefinitions",value:function(){return this.tokenGroupDefinitions}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"tokenGroupDefinitions",[i.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),s(n.prototype,"setTokenGroupDefinitions",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setTokenGroupDefinitions"),n.prototype),n)},20332:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return h}));var n=r(12838),o=r(12746),i=r(12706),a=r(14337),c=r(11766),s=r(14681),l=r(12366),u=r(20330),p=r(20333),f=r(20334),d=r(20336),m=r(20341);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=(e,t)=>{var r=t?Object(f.e)(e,t):e;return{initialTokens:r,allTokens:r}},h=Object(a.c)(e=>{var t,r,o,{hideSearch:a,onSearchEscape:f,autoFocusSearch:d=!1,filterAndSortTokens:h=v,onTokenSelected:O,resources:w,maxHeight:E}=e,C=(t={maxHeight:E},Object(i.a)()(m.a,{maxHeight:t.maxHeight})),[S,P]=function(){var[e,t]=c.useState(""),r=Object(n.a)();return[e,c.useMemo(()=>r.debounce(t,l.h.search),[r])]}(),j=(r=d,o=c.useRef(!1),c.useCallback(e=>{e&&(r&&!o.current&&e.focus(),o.current=!0)},[r])),T=S.trim().toLocaleLowerCase(),k=u.a.getTokenGroupDefinitions(),R=c.useCallback(e=>h(e.tokens.map(t=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({operationTitle:e.title},t)),T),[h,T]),x=0===k.length&&""===S,N=k.map(e=>R(e)).every(e=>0===e.initialTokens.length);return c.createElement(c.Fragment,null,!a&&c.createElement("div",{className:C.searchBox},c.createElement(s.a,{componentRef:j,placeholder:w.SearchPlaceholder,onEscape:f,onChange:P,disabled:x})),c.createElement("div",{className:C.list},x?c.createElement(p.a,{message:w.NoDynamicValuesTitle,details:w.NoDynamicValuesDetails}):N?c.createElement(p.a,{message:w.SearchEmptyResultsTitle,details:w.SearchEmptyResultsDetails}):k.map(e=>{var{initialTokens:t,allTokens:r}=R(e);return c.createElement(g,{key:e.title,tokenGroup:e,initialTokens:t,allTokens:r,onTokenSelected:O,searchText:T})})))}),g=e=>{var{tokenGroup:t,initialTokens:r,allTokens:n,onTokenSelected:i,searchText:a}=e,{title:s,brandColor:l,iconUri:u}=t,[p,{toggle:f,setFalse:m}]=Object(o.a)(!1);return c.useEffect(()=>{m()},[a,m]),c.createElement(d.a,{title:s,brandColor:l,iconUri:u,initialTokens:r,allTokens:n,handleTokenSelection:i,collapsed:p,onToggleCollapse:f,tokenGroupType:d.b.Dynamic})}},20333:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11766),o=r(14950),i=r(13272),a=e=>{var{message:t,details:r,buttonText:a,buttonProps:c,hideIcon:s,icon:l}=e;return n.createElement(o.a,{icon:s?void 0:l||i.a.List,primaryMessage:t,secondaryMessage:r,callToActionText:a,callToActionProps:c})}},20334:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return m}));var n=r(14883),o=r(20335),i=r(20026),a=r.n(i),c=r(17244),s=function(e){return e[e.TOKEN=0]="TOKEN",e[e.EXPRESSION=1]="EXPRESSION",e[e.EXPRESSION_TOKEN=2]="EXPRESSION_TOKEN",e}({}),l={Advanced:"advanced",Internal:"internal",Important:"important",ReadOnly:"read-only"};function u(e){var{searchText:t,tokenPickerMode:r,tokens:n}=e;return t?m(n,t):r===s.TOKEN?function(e){var{tokens:t,isExpandedList:r}=e;return r?t:function(e){var{parameterType:t,parameterFormat:r,tokens:n}=e;return t===c.a.Swagger.TYPE.ANY||t===c.a.Swagger.TYPE.OBJECT||t===c.a.Swagger.TYPE.STRING&&r===c.a.Swagger.FORMAT.JAVASCRIPT?n:n.filter(e=>e.schema&&t===e.schema.type&&(void 0===r||r===e.schema.format))}(e)}(e):r===s.EXPRESSION||r===s.EXPRESSION_TOKEN?d(e):[]}function p(e){var{searchText:t,tokenPickerMode:r,tokens:n}=e;return t?m(n,t):r===s.TOKEN?function(e){var{parameterType:t,parameterFormat:r,tokens:n,isExpandedList:i,isExpressionEditor:a}=e,c=n.map(e=>({ref:e,weight:Object(o.a)(t,r,e,!0)})).sort(f),s=a?c:c.filter(e=>-1!==e.weight);return i?s.map(e=>n.find(t=>t===e.ref)).filter(e=>!!e):s.filter(e=>e.weight===s[0].weight).map(e=>n.find(t=>t===e.ref)).filter(e=>!!e)}(e):r===s.EXPRESSION||r===s.EXPRESSION_TOKEN?d(e):[]}function f(e,t){return e.weight>t.weight?-1:e.weight<t.weight?1:0}function d(e){var{tokens:t,isExpandedList:r}=e;return r?t:function(e){var{tokens:t}=e;return function(e){return!e.some(e=>!Object(n.e)(e.data&&e.data.visibility,l.Advanced))}(t)?t:t.filter(e=>!Object(n.e)(e.data&&e.data.visibility,l.Advanced))}(e)}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2;t=t.trim();var n=new a.a(e,{keys:["description","title","operationTitle"],threshold:r});return n.search(t)}},20335:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(17244),o=r(14883),i={[n.a.Swagger.TYPE.ANY]:{[n.a.Swagger.TYPE.ANY]:2,[n.a.Swagger.TYPE.ARRAY]:2,[n.a.Swagger.TYPE.BOOLEAN]:2,[n.a.Swagger.TYPE.FILE]:2,[n.a.Swagger.TYPE.INTEGER]:2,[n.a.Swagger.TYPE.NUMBER]:2,[n.a.Swagger.TYPE.OBJECT]:2,[n.a.Swagger.TYPE.STRING]:2},[n.a.Swagger.TYPE.ARRAY]:{[n.a.Swagger.TYPE.ANY]:0,[n.a.Swagger.TYPE.ARRAY]:2,[n.a.Swagger.TYPE.BOOLEAN]:0,[n.a.Swagger.TYPE.INTEGER]:0,[n.a.Swagger.TYPE.NUMBER]:0,[n.a.Swagger.TYPE.OBJECT]:0,[n.a.Swagger.TYPE.STRING]:0},[n.a.Swagger.TYPE.BOOLEAN]:{[n.a.Swagger.TYPE.ANY]:0,[n.a.Swagger.TYPE.BOOLEAN]:2},[n.a.Swagger.TYPE.FILE]:{[n.a.Swagger.TYPE.ANY]:0,[n.a.Swagger.TYPE.BOOLEAN]:0,[n.a.Swagger.TYPE.FILE]:2,[n.a.Swagger.TYPE.INTEGER]:0,[n.a.Swagger.TYPE.NUMBER]:0,[n.a.Swagger.TYPE.OBJECT]:0,[n.a.Swagger.TYPE.STRING]:0},[n.a.Swagger.TYPE.OBJECT]:{[n.a.Swagger.TYPE.ANY]:2,[n.a.Swagger.TYPE.ARRAY]:2,[n.a.Swagger.TYPE.BOOLEAN]:2,[n.a.Swagger.TYPE.FILE]:2,[n.a.Swagger.TYPE.INTEGER]:2,[n.a.Swagger.TYPE.NUMBER]:2,[n.a.Swagger.TYPE.OBJECT]:2,[n.a.Swagger.TYPE.STRING]:2},[n.a.Swagger.TYPE.STRING]:{[n.a.Swagger.TYPE.ANY]:0,[n.a.Swagger.TYPE.BOOLEAN]:2,[n.a.Swagger.TYPE.INTEGER]:2,[n.a.Swagger.TYPE.NUMBER]:2,[n.a.Swagger.TYPE.STRING]:2}},a={[n.a.Swagger.FORMAT.BINARY]:{[n.a.Swagger.FORMAT.BINARY]:2,[n.a.Swagger.FORMAT.BYTE]:2},[n.a.Swagger.FORMAT.BYTE]:{[n.a.Swagger.FORMAT.BINARY]:2,[n.a.Swagger.FORMAT.BYTE]:2},[n.a.Swagger.FORMAT.DATE]:{[n.a.Swagger.FORMAT.DATE]:2,[n.a.Swagger.FORMAT.DATETIME]:2},[n.a.Swagger.FORMAT.DATETIME]:{[n.a.Swagger.FORMAT.DATETIME]:2}},c=function(e){return e[e.TypeIntegerFormatUndefined=0]="TypeIntegerFormatUndefined",e[e.TypeIntegerFormatInt32=1]="TypeIntegerFormatInt32",e[e.TypeIntegerFormatInt64=2]="TypeIntegerFormatInt64",e[e.TypeNumberFormatUndefined=3]="TypeNumberFormatUndefined",e[e.TypeNumberFormatFloat=4]="TypeNumberFormatFloat",e[e.TypeNumberFormatDouble=5]="TypeNumberFormatDouble",e}(c||{}),s=[[2,2,2,1,-1,-1],[3.5,4,3,1,-1,-1],[4,4,4,1,-1,-1],[2,2,2,2,2,2],[3.5,4,3,3.5,4,3],[4,4,4,4,4,4]];function l(e,t,r,c){var l,p,f=null===(l=r.schema)||void 0===l?void 0:l.format,d=null===(p=r.schema)||void 0===p?void 0:p.type,m=r.title;if(d){if(e===n.a.Swagger.TYPE.INTEGER||e===n.a.Swagger.TYPE.NUMBER)return function(e,t,r,i){if(Object(o.e)(r,n.a.Swagger.TYPE.ANY))return 0;var a=u(e,t),c=u(r,i);return void 0!==a&&void 0!==c?s[a][c]:-1}(e,t,d,f);if(!t)return function(e,t){if(Object(o.e)(e,t))return 2;if(Object.keys(i).indexOf(e)>-1&&Object.keys(i[e]).indexOf(t)>-1)return i[e][t];return-1}(e,d);if(c&&Object(o.e)(e,n.a.Swagger.TYPE.STRING)&&Object(o.e)(t,n.a.Swagger.FORMAT.EMAIL))return function(e,t,r){if(Object(o.e)(t,n.a.Swagger.TYPE.STRING)&&r&&Object(o.e)(r,n.a.Swagger.FORMAT.EMAIL))return 4;var i=Object(o.e)(t,n.a.Swagger.TYPE.STRING)?2:0;if(e&&e.toLowerCase().indexOf("mail")>-1)return i+=2;if((Object(o.e)(t,n.a.Swagger.TYPE.STRING)||Object(o.e)(t,n.a.Swagger.TYPE.ANY))&&!r)return i;return-1}(m,d,f);if(t&&!f)return Object(o.e)(e,d)?2:Object(o.e)(d,n.a.Swagger.TYPE.ANY)?0:-1;if(t&&f){var b=Object(o.e)(e,d)?2:-1;if(-1!==b){var y=function(e,t){if(Object(o.e)(e,t))return 2;if(Object.keys(a).indexOf(e)>-1&&Object.keys(a[e]).indexOf(t)>-1)return a[e][t];return-1}(t,f);b=-1!==y?b+y:-1}return b}}return-1}function u(e,t){return Object(o.e)(e,n.a.Swagger.TYPE.INTEGER)&&!t?c.TypeIntegerFormatUndefined:Object(o.e)(e,n.a.Swagger.TYPE.INTEGER)&&t&&Object(o.e)(t,n.a.Swagger.FORMAT.INT32)?c.TypeIntegerFormatInt32:Object(o.e)(e,n.a.Swagger.TYPE.INTEGER)&&t&&Object(o.e)(t,n.a.Swagger.FORMAT.INT64)?c.TypeIntegerFormatInt64:Object(o.e)(e,n.a.Swagger.TYPE.NUMBER)&&!t?c.TypeNumberFormatUndefined:Object(o.e)(e,n.a.Swagger.TYPE.NUMBER)&&t&&Object(o.e)(t,n.a.Swagger.FORMAT.FLOAT)?c.TypeNumberFormatFloat:Object(o.e)(e,n.a.Swagger.TYPE.NUMBER)&&t&&Object(o.e)(t,n.a.Swagger.FORMAT.DOUBLE)?c.TypeNumberFormatDouble:void 0}},20336:function(e,t,r){"use strict";r.d(t,"b",(function(){return w})),r.d(t,"a",(function(){return E}));var n=r(11766),o=r(12706),i=r(20337),a=r(12812),c=r(20338),s=r(20340),l=r(13272),u=r(14343),p=r(18886),f=r(17244),d=r(19713);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){return e.Functions="functions",e.Dynamic="dynamic",e}({}),E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(O,e);var t,r,y,g=h(O);function O(){var e;m(this,O);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=g.call(this,...r)).getClassNames=Object(o.a)(),e.classNames=e.getClassNames(i.a),e._editorContext=Object(d.a)(),e.renderCell=(t,r)=>r?n.createElement(c.a,{className:e.props.collapsed?"ms-motion-slideUpOut":"ms-motion-slideDownIn",token:r,key:null==r?void 0:r.title,onTokenSelect:e.props.handleTokenSelection,tokenGroupType:e.props.tokenGroupType}):null,e.renderHeader=t=>{var{brandColor:r,iconUri:o,title:i,onToggleCollapse:c,collapsed:s,tokenGroupType:d}=e.props,m={backgroundColor:d===w.Functions?r:Object(p.a)(r,f.a.UIConstants.HeaderAndTokenOpacity)};return n.createElement("div",{"aria-expanded":!s,"aria-label":i,className:e.classNames.header,style:m,"data-is-focusable":"true",role:"button",onClick:c,tabIndex:0},o?n.createElement(u.a,{className:e.classNames.icon,size:u.b.small,brandColor:r,iconUri:o,cdnService:e._editorContext.cdnService}):void 0,n.createElement("span",{className:e.classNames.title},i),n.createElement(a.a,{className:e.classNames.icon,iconName:s?l.a.ChevronDown:l.a.ChevronUp}))},e}return t=O,(r=[{key:"render",value:function(){var{initialTokens:e,allTokens:t,title:r,collapsed:o}=this.props,i=[{count:e.length,hasMoreData:t.length>e.length,isCollapsed:o,key:r,name:r,startIndex:0}];return e.length?n.createElement("div",{className:this.classNames.root},n.createElement(s.a,{items:t,onRenderCell:this.renderCell,groups:i,groupProps:{onRenderHeader:this.renderHeader,showAllProps:{showAllLinkText:this._editorContext.globalResources.Common.SeeMore}}})):null}}])&&b(t.prototype,r),y&&b(t,y),Object.defineProperty(t,"prototype",{writable:!1}),O}(n.Component)},20337:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(17244),i=e=>{var t=Object(n.Y)();return{root:[o.a.UIClassNames.TokenGroup,{selectors:{".ms-GroupShowAll":{width:"100%",height:30,padding:0},".ms-GroupShowAll button.ms-Link":{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",fontWeight:n.l.regular,fontSize:n.k.medium},".ms-GroupShowAll button.ms-Link:hover,button.ms-Link:focus":{border:0,backgroundColor:t.palette.neutralLight}}}],header:["fl-Designer-TokenGroup-Header",{alignItems:"center",backgroundColor:t.palette.neutralLighter,borderBottom:"1px solid ".concat(t.palette.neutralTertiaryAlt),cursor:"pointer",display:"flex",height:48,padding:"0 8px",selectors:{"&:hover,&:focus":{backgroundColor:t.palette.neutralLight}}}],icon:["fl-Designer-TokenGroup-Header-Icon",{margin:"0 8px 0 4px",fontSize:n.k.icon}],title:["fl-Designer-TokenGroup-Header-Title",{color:t.palette.black,flexGrow:1,fontSize:n.k.medium,fontWeight:n.l.semibold}]}}},20338:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(11766),o=r(12706),i=r(12811),a=r(20339),c=r(12812),s=r(13272),l=r(14343),u=r(19713),p=r(20336);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(v,e);var t,r,f,m=g(v);function v(){var e;b(this,v);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=m.call(this,...r)).getClassNames=Object(o.a)(),e.classNames=e.getClassNames(a.a),e._editorContext=Object(u.a)(),e.handleSelect=t=>{e.props.onTokenSelect(d({token:e.props.token},t))},e}return t=v,(r=[{key:"render",value:function(){var e,{className:t,token:r,tokenGroupType:o}=this.props;return e=o===p.b.Functions?n.createElement(l.a,{className:this.classNames.apiIcon,size:l.b.small,brandColor:r.brandColor,iconUri:r.iconUri,cdnService:this._editorContext.cdnService}):n.createElement(c.a,{className:this.classNames.icon,iconName:r.schema?this.getIconName(r.schema):void 0}),n.createElement("div",{"aria-label":r.title,className:Object(i.a)(this.classNames.root,t),"data-is-focusable":"true",role:"gridcell",onClick:this.handleSelect},n.createElement("div",{className:this.classNames.body},e,n.createElement("div",{className:this.classNames.textContainer},n.createElement("div",{className:this.classNames.titleText},r.title),n.createElement("div",{className:this.classNames.subtitleText},r.description?r.description:""))))}},{key:"getIconName",value:function(e){switch(e.type){case"integer":case"number":return s.a.Number;case"array":return s.a.List;case"string":switch(e.format){case"date":case"date-time":return s.a.DateTime;default:return s.a.Text}default:return s.a.Text}}}])&&y(t.prototype,r),f&&y(t,f),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component)},20339:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(12754);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=()=>{var e=Object(n.Y)(),t={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"};return{root:["fl-Designer-TokenGroupListItem",{height:48,borderBottom:"1px solid ".concat(e.palette.neutralLighter),cursor:"pointer",selectors:{"&:hover, &:focus":{backgroundColor:e.palette.neutralLight}}}],body:["fl-Designer-TokenGroupListItem-Body",{height:"100%",display:"flex",alignItems:"center"}],icon:["fl-Designer-TokenGroupListitem-Icon",{color:e.palette.black,flex:"0 0 ".concat(40,"px"),fontSize:n.k.icon,margin:"0 0 0 4px",textAlign:"center",width:40}],apiIcon:["fl-Designer-TokenGroup-Header-ApiIcon",{margin:"0 8px 0 12px",fontSize:n.k.icon}],textContainer:["fl-Designer-TokenGroupListitem-TextContainer",{flexGrow:1,overflow:"hidden"}],titleText:["fl-Designer-TokenGroupListitem-Title",i(i(i({},t),e.fonts.medium),{},{color:e.palette.black})],subtitleText:["fl-Designer-TokenGroupListitem-Subtitle",i(i(i({},t),e.fonts.small),{},{color:e.palette.neutralSecondary})]}}},20341:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(13274),i=e=>{var t=Object(n.Y)(),{palette:r}=t;return{root:["fl-DynamicContentList",{display:"flex",flexDirection:"column",height:Object(o.b)()?e.maxHeight:void 0,maxHeight:e.maxHeight,overflowY:"auto"}],list:["fl-DynamicContentList-Content",{borderTop:"1px solid ".concat(r.neutralTertiaryAlt),display:"flex",flexDirection:"column",flexGrow:1,overflowY:"auto",".ba-EmptyState":{marginTop:48,"> i":{border:"none",background:r.themePrimary,color:r.white},".ba-EmptyState-PrimaryMessage":{fontWeight:n.l.semibold}}}],searchBox:["fl-DynamicContentList-SearchBox",{borderTop:"1px solid ".concat(r.neutralLight),padding:"16px 12px"}]}}},20342:function(e,t,r){"use strict";var n=r(20343);r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return n.b})),r.d(t,"c",(function(){return n.c})),r.d(t,"d",(function(){return n.d})),r.d(t,"e",(function(){return n.e})),r.d(t,"f",(function(){return n.f})),r.d(t,"g",(function(){return n.g}))},20343:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return s})),r.d(t,"g",(function(){return l}));var n=function(e){return e.AccessCode="accessCode",e.Application="application",e.Implicit="implicit",e.PasswordBased="password",e}({}),o={upsert:"upsert"},i={get:"get",delete:"delete",post:"post",put:"put",head:"head",options:"options",patch:"patch"},a={http:"http",https:"https"},c={object:"object",any:"any",integer:"integer",number:"number",string:"string",array:"array",boolean:"boolean",null:"null",file:"file"},s={host:"host",path:"path",query:"query",header:"header",body:"body"},l={Global:"Global",GlobalPerConnector:"GlobalPerConnector"}},20344:function(e,t,r){"use strict";r.d(t,"b",(function(){return B})),r.d(t,"a",(function(){return z}));var n=r(15577),o=r(12746),i=r(12743),a=r(17001),c=r(15539),s=r(12854),l=r(12940),u=r(12812),p=r(14965),f=r(13243),d=r(13242),m=r(13262),b=r(12706),y=r(12811),v=r(20329),h=r(12324),g=r(14337),O=r(11766),w=r.n(O),E=r(14343),C=r(15524),S=r(14346),P=r(15941),j=r(13016),T=r(16824),k=r(14947),R=r(20345),x=r(15027),N=r(13192),_=r(13272),D=r(13031),I=r(20347),A=r(20348),F=r(20349),L=r(20351),M=r(20352);function B(){return Object(b.a)()(A.a)}var U=e=>{var{token:t,onChangeToken:r,cdnService:n}=e,o=B();return w.a.createElement(c.a,{className:o.tokenButton,onClick:r},w.a.createElement(E.a,{className:o.tokenIcon,size:E.b.medium,brandColor:t.brandColor,iconUri:t.iconUri,cdnService:n,iconAriaLabel:t.title}),w.a.createElement("span",{className:o.tokenText},w.a.createElement("b",null,null==t?void 0:t.title),null==t?void 0:t.description),w.a.createElement(u.a,{iconName:_.a.Edit,className:o.tokenEditIcon}))},V=e=>{var{strings:t}=e,r=B(),[n,{toggle:a}]=Object(o.a)(!1),c=Object(i.a)("callout-button"),u=Object(i.a)("callout-label"),p=Object(i.a)("callout-description");return w.a.createElement(w.a.Fragment,null,w.a.createElement(s.a,{className:r.infoCalloutButton,id:c,iconProps:{iconName:_.a.Info},"aria-label":t.ProvideExampleInfoLabel,onClick:a}),n&&w.a.createElement(l.a,{className:r.infoCallout,ariaLabelledBy:u,ariaDescribedBy:p,target:"#".concat(c),onDismiss:a,setInitialFocus:!0},w.a.createElement("div",{id:u,className:r.infoCalloutTitle},t.ProvideExampleTitle),w.a.createElement("p",{id:p},t.ProvideExampleInfoDescription),w.a.createElement("dl",null,w.a.createElement("dt",null,t.ProvideExampleInfoExampleValue),w.a.createElement("dd",null,t.ProvideExampleInfoExampleValue1),w.a.createElement("dt",null,t.ProvideExampleInfoDesiredOutput),w.a.createElement("dd",null,t.ProvideExampleInfoDesiredOutput1)),w.a.createElement("dl",null,w.a.createElement("dt",null,t.ProvideExampleInfoExampleValue),w.a.createElement("dd",null,t.ProvideExampleInfoExampleValue2),w.a.createElement("dt",null,t.ProvideExampleInfoDesiredOutput),w.a.createElement("dd",null,t.ProvideExampleInfoDesiredOutput2)),w.a.createElement("dl",null,w.a.createElement("dt",null,t.ProvideExampleInfoExampleValue),w.a.createElement("dd",null,t.ProvideExampleInfoExampleValue3),w.a.createElement("dt",null,t.ProvideExampleInfoDesiredOutput),w.a.createElement("dd",null,t.ProvideExampleInfoDesiredOutput3))))},z=Object(g.c)(e=>{var{store:t,_isBlocking:r=!0,cdnService:o,resources:i}=e,a=B(),l=i.Panel,b=v.a.panel,g=w.a.useCallback(e=>{var r=t.examples[e];if(r){if(r.isDuplicateInput)return l.ExampleInputDuplicateError;if(r.isNotSupportedType)return Object(D.a)(l.ExampleInputNotSupportedTypeFormat,t.expectedTokenType)}},[t.examples,t.expectedTokenType,l.ExampleInputDuplicateError,l.ExampleInputNotSupportedTypeFormat]);return w.a.createElement(k.a,{dataAutomationId:b.root,isOpen:t.isOpen,onDismissed:t.onDismiss,isBlocking:r,isLightDismiss:!1,title:l.Title,closeButtonAriaLabel:l.CloseButtonAriaLabel,footerButtons:[{dataAutomationId:b.applyFormulaButton,text:l.ApplyButton,disabled:!t.canApplyFormula,dismissableOnClick:e=>{t.onApplyFormula()},primary:!0},{dataAutomationId:b.cancelButton,text:l.CancelButton,dismissableOnClick:e=>e()}],size:k.b.medium,className:Object(y.a)(a.panel,t.isFeedbackPanelOpen&&"is-hidden")},w.a.createElement(G,null,t.selectedToken&&w.a.createElement(w.a.Fragment,null,w.a.createElement(U,{token:t.selectedToken,onChangeToken:t.openInputPanel,cdnService:o}),w.a.createElement(p.a,{className:a.separator})),w.a.createElement("div",{className:a.card,ref:t.examplesSectionRef},w.a.createElement("div",{className:a.cardHeader},w.a.createElement("h2",{className:a.cardTitle},l.ProvideExampleTitle),w.a.createElement(V,{strings:l})),w.a.createElement(P.b,{interpolatedString:l.DescriptionFormat,links:[{text:l.LearnMore,href:"https://go.microsoft.com/fwlink/?linkid=2208107",target:S.b.blank}],className:a.description}),w.a.createElement("table",{className:a.table},w.a.createElement("thead",null,w.a.createElement("tr",null,w.a.createElement("th",null,w.a.createElement(C.a,{text:t.selectedToken?Object(D.a)(l.ExampleInputColumnNameFormat,t.selectedToken.title):l.ExampleInputColumnName})),w.a.createElement("th",null,w.a.createElement(C.a,{text:l.ExampleOutputColumnName})))),w.a.createElement("tbody",null,t.examples.map((e,r)=>{var{input:n,output:o,outputSuggestions:i=[],uniqueKey:a}=e;return w.a.createElement("tr",{key:a},w.a.createElement("td",null,w.a.createElement(x.b,{dataAutomationId:b.exampleInput,placeholder:l.ExampleInputPlaceholder,value:null!=n?n:"",onChange:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.onExampleInputChanged(r,n)},type:"text",disabled:!t.canEditExample,onFocus:()=>t.onExampleInputFocus(r),onBlur:e=>t.onExampleInputBlur(r),errorMessage:g(r)})),w.a.createElement("td",null,w.a.createElement(R.a,{dataAutomationId:b.exampleOutput,searchString:null!=o?o:"",setSearchString:e=>t.onExampleOutputChanged(r,e),suggestionsHeaderLabel:l.ExampleOutputSuggestionHeader,placeholder:l.ExampleOutputPlaceholder,onSuggestionClick:(e,n)=>t.onExampleOutputChanged(r,e,n),isDisabled:!t.canEditExample,onSearch:h.noop,minimumSearchLength:0,isSearchDisabled:!1,suggestions:t.suggestions,onChange:e=>t.getOutputSuggestions(e,i)})))}))),w.a.createElement(c.a,{"data-automation-id":b.addExampleButton,iconProps:{iconName:_.a.Add},onClick:t.addEmptyExample,disabled:!t.canAddExample,text:l.AddExampleButton,className:a.actionButton})),w.a.createElement(n.LoadingPrimaryButton,{"data-automation-id":b.getFormulaButton,text:t.learningOperation.isRunning?l.GetSuggestionButtonLoading:l.GetSuggestionButton,onClick:t.learnAsync,disabled:!t.canLearn,className:a.primaryButton,loading:t.learningOperation.isRunning}),(t.learningOperation.isRunning||t.learningOperation.succeeded||t.learningOperation.failed)&&w.a.createElement(w.a.Fragment,null,w.a.createElement(p.a,{className:a.separator},w.a.createElement(u.a,{iconName:_.a.Down,className:a.separatorIcon})),t.learningOperation.isRunning&&w.a.createElement(W,{dataAutomationId:b.loadingResult,title:l.ResultTitle},w.a.createElement(f.a,{className:a.resultSpinner,label:l.ResultSpinner,size:d.a.large})),t.learningOperation.succeeded&&w.a.createElement(W,{dataAutomationId:b.successfulResult,title:l.ResultTitle,isSuccessResult:!!t.formula},t.formula?w.a.createElement(w.a.Fragment,null,t.evaluationOperation.failed&&w.a.createElement(T.a,{ariaLabel:l.TestFailedNeedToAddExamples,className:a.messageBar,type:j.c.error,message:Object(N.isHttp4xxError)(t.evaluationOperation.error)?Object(D.a)(l.ConcatenateWithSpaceFormat,l.TestFailedInvalidInput,l.TestFailedNeedToAddExamples):l.ResultErrorTitle}),w.a.createElement("pre",{className:a.formulaContainer},w.a.createElement("span",{className:a.formula},t.formula),w.a.createElement(m.a,{content:l.CopyToClipboard,hostClassName:a.formulaCopy},w.a.createElement(s.a,{iconProps:{iconName:"Copy"},name:l.CopyToClipboard,ariaLabel:l.CopyToClipboard,onClick:t.copyToClipboard}))),w.a.createElement(P.b,{className:a.resultFormulaDescription,interpolatedString:l.ResultFormulaDescriptionFormat,links:[{text:l.ResultFormulaDescriptionAddExamplesLink,onClick:t.addExampleFromResultCard}]}),w.a.createElement(M.a,{store:t,strings:l})):w.a.createElement("div",{className:a.empty},w.a.createElement("div",{className:a.emptyIconWrapper},w.a.createElement(L.a,{className:a.emptyIcon})),w.a.createElement("h3",{className:a.emptyTitle},l.ResultNotFoundTitle),w.a.createElement(P.b,{interpolatedString:l.ResultEmptyFormat,links:[{text:l.ResultEmptyLearnMore,href:"https://go.microsoft.com/fwlink/?linkid=2208107",target:S.b.blank}],className:a.description}))),t.learningOperation.failed&&w.a.createElement(W,{dataAutomationId:b.failedResult,title:l.ResultTitle},w.a.createElement("div",{className:a.empty},w.a.createElement("div",{className:a.emptyIconWrapper},w.a.createElement(L.a,{className:a.emptyIcon})),w.a.createElement("h3",{className:a.emptyTitle},l.ResultErrorTitle),w.a.createElement("pre",{className:a.formulaContainer},w.a.createElement("span",{className:a.formula},t.errorMessage,w.a.createElement("div",{className:a.sessionIdContainer},w.a.createElement("span",{className:a.sessionId},l.SessionId),t.sessionId))))),w.a.createElement(I.a,{isOpen:t.isApplyConfirmationDialogOpen,onConfirm:t.onApplyConfirmed,onDismiss:t.onApplyDismissed,resources:i.ApplyFormulaConfirmation}))),w.a.createElement(F.a,{title:l.ResourcesTitle,links:[{iconName:"TextDocument",text:l.SeeDocumentation,href:"https://go.microsoft.com/fwlink/?linkid=2208107",onClick:t.onDocumentationLinkClicked},{iconName:"MSNVideos",text:l.WatchTutorials,onClick:t.openTutorial},{iconName:"Feedback",text:l.GiveFeedback,onClick:t.openFeedbackPanel}]}))}),G=e=>{var{children:t}=e,r=B();return w.a.createElement("div",{className:r.panelSection},t)};var W=e=>{var t,{children:r,dataAutomationId:n,title:o,isSuccessResult:i}=e,c=B(),s=(t=w.a.useRef(!1),Object(a.a)(e=>{setTimeout(()=>{t.current||(e.scrollIntoView({behavior:"smooth"}),e.focus({preventScroll:!0}),t.current=!0)},100)}));return w.a.createElement("div",{"data-automation-id":n,className:Object(y.a)(c.card,i&&"is-result"),ref:s},w.a.createElement("h2",{className:Object(y.a)(c.cardTitle,i&&"is-result"),"data-animation-text":o},o),r)}},20345:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(12746),o=r(12743),i=r(12821),a=r(12862),c=r(12860),s=r(12754),l=r(15028),u=r(12305),p=r(14337),f=r(11766),d=r.n(f),m=r(13259),b=r(20346);var y=Object(p.c)((function(e){var{searchString:t,setSearchString:r,onSearch:p,suggestions:f,onChange:y,onSuggestionClick:v,getHistoryEntries:h,onHistoryEntryClick:g,suggestionsHeaderLabel:O,searchButtonLabel:w,placeholder:E,minimumSearchLength:C,isDisabled:S,isSearchDisabled:P,autoFocus:j,dataAutomationId:T,styles:k}=e,[R,{setTrue:x,setFalse:N}]=Object(n.a)(!1),[_,{setTrue:D,setFalse:I}]=Object(n.a)(!1),[A,{setTrue:F}]=Object(n.a)(t.trim().length>0),L=d.a.useRef(null),M=d.a.useRef(null),B=Object(b.a)(),U=Object(s.eb)(B.root,null==k?void 0:k.root),V=Object(s.eb)(B.pendingSearch,null==k?void 0:k.pendingSearch),z=Object(s.db)(B.textField,null==k?void 0:k.textField),G=Object(s.db)(B.button,null==k?void 0:k.button),W=Object(s.db)(B.iconButton,null==k?void 0:k.iconButton),H=d.a.useCallback(()=>{I(),N()},[I,N]),K=d.a.useCallback(e=>{var t=e.trim();return!P&&t.length>=C},[P,C]),q=d.a.useCallback(()=>{var e;H(),null===(e=L.current)||void 0===e||e.blur()},[H]),Y=d.a.useCallback(e=>{K(e)&&(e=e.trim(),r(e),p(e),q())},[K,p,q,r]),X=d.a.useCallback((e,t)=>{v(e,t),q()},[v,q]),Q=d.a.useCallback((e,t)=>{g&&(g(e,t),q())},[g,q]),Z=d.a.useMemo(()=>{var e=[];t.length>0&&e.push({key:"search-input",text:t,onClick:()=>Y(t),className:V});var r=h&&g?h(t).map((e,t)=>({key:"history-".concat(t),text:e,onClick:()=>Q(e,t),iconProps:{iconName:"Clock",style:{color:"unset"}}})):[],n=(null!=f?f:[]).map((e,t)=>({key:"suggestion-".concat(t),text:e,onClick:()=>X(e,t)}));return e.push({key:"section",itemType:a.a.Section,sectionProps:{topDivider:!0,bottomDivider:!0,title:O,items:[...r,...n]}}),e},[h,g,Q,X,V,Y,t,O,f]),J=Object(o.a)("search-box-with-suggestions");return d.a.createElement("div",{id:J,className:U,"data-automation-id":T},d.a.createElement(l.a,{componentRef:L,value:t,placeholder:E,onChange:(e,t)=>{var n=null!=t?t:"";n.trim().length>0&&F(),_||S||D(),r(n),y(n)},autoFocus:j,onBlur:e=>{var t,r;null!==(t=M.current)&&void 0!==t&&t.contains(e.relatedTarget)&&!R&&(null===(r=L.current)||void 0===r||r.focus())},onKeyDown:e=>{switch(e.which){case u.a.down:_&&x(),e.preventDefault(),e.stopPropagation();break;case u.a.enter:Y(t),e.preventDefault(),e.stopPropagation();break;case u.a.escape:_&&(e.preventDefault(),e.stopPropagation()),H();break;default:e.defaultPrevented&&e.stopPropagation()}},disabled:S,type:"text",autoComplete:"off",role:"searchbox",styles:z}),A&&w&&d.a.createElement(m.a,{title:w,onClick:()=>{Y(t),H()},iconProps:{iconName:"Forward"},disabled:S||!K(t),styles:G,iconButtonStyles:W}),d.a.createElement(c.a,{ref:M,items:Z,hidden:!_,target:"#".concat(J),onDismiss:H,shouldFocusOnMount:R,directionalHintFixed:!0,directionalHint:i.a.bottomLeftEdge,useTargetWidth:!0,gapSpace:1}))}))},20346:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var{palette:e}=Object(n.Y)();return{root:["fl-SearchBoxWithSuggestions",{display:"flex",alignItems:"center"}],textField:{root:{width:"100%",minWidth:0,flexShrink:0,[n.m]:{border:"solid 1px"}},fieldGroup:{paddingRight:32},field:{backgroundColor:e.white,":disabled":{color:e.neutralSecondary}}},pendingSearch:["fl-SearchBoxWithSuggestionsPendingSearch",{selectors:{span:{fontStyle:"italic"}},textDecoration:"underline",textDecorationColor:e.neutralLight}],button:{root:{position:"relative",right:32,flexShrink:0}},iconButton:{root:[{width:28,height:28,background:"transparent"}]}}}},20347:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(12746),o=r(12960),i=r(12961),a=r(15501),c=r(12719),s=r(12850),l=r(20329),u=r(11766),p=r.n(u),f=e=>{var{isOpen:t,onDismiss:r,onConfirm:u,resources:f}=e,[m,{toggle:b}]=Object(n.a)(!1),y=l.a.panel.applyFormulaConfirmationDialog;return p.a.createElement(c.a,{hidden:!t,onDismiss:r,modalProps:{isBlocking:!0,focusTrapZoneProps:{"data-automation-id":y.root}},minWidth:380,dialogContentProps:{title:f.Title,subText:f.Description,styles:d}},p.a.createElement(a.a,{"data-automation-id":y.doNotShowAgainCheckbox,label:f.DoNotShowAgain,onChange:b,checked:m}),p.a.createElement(s.a,null,p.a.createElement(o.a,{"data-automation-id":y.applyButton,onClick:()=>u(m),text:f.Confirm}),p.a.createElement(i.a,{"data-automation-id":y.cancelButton,onClick:r,text:f.Cancel})))},d={subText:{padding:0},content:{label:{margin:0}}}},20348:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(20014),i=()=>{var e=Object(n.Y)();return{panel:["fl-FormulaFromExamplesPanel-Panel",{"&.is-hidden":{visibility:"hidden"},".ms-Panel-main":{backgroundColor:e.palette.neutralLighterAlt},".ba-Panel-headerContainer":{backgroundColor:"".concat(e.palette.neutralLighterAlt," !important"),borderBottom:"1px solid ".concat(e.palette.neutralLight),paddingBottom:"12px !important"},".ms-Panel-content":{display:"flex",paddingTop:16},".ba-Panel-content":{display:"flex",flexDirection:"column",width:"100%"},".ms-Panel-footer":{backgroundColor:e.palette.neutralLighterAlt}}],panelSection:["fl-FormulaFromExamplesPanel-PanelSection",{flex:"1 1 auto"}],tokenButton:["fl-FormulaFromExamplesPanel-TokenButton",{width:"100%",padding:0,".ms-Button-flexContainer":{width:"100%"}}],tokenIcon:["fl-FormulaFromExamplesPanel-TokenIcon",{flex:"0 0 auto",marginRight:8,"> div":{boxSizing:"border-box"}}],tokenText:["fl-FormulaFromExamplesPanel-TokenText",{flex:"1 1 auto",textAlign:"left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",margin:"0px 8px",color:e.palette.neutralSecondary,b:{display:"block",color:e.palette.neutralPrimary,fontWeight:n.l.semibold,overflow:"hidden",textOverflow:"ellipsis"}}],tokenEditIcon:["fl-FormulaFromExamplesPanel-TokenEditIcon",{flex:"0 0 auto",display:"flex",width:32,height:32,alignItems:"center",fontSize:n.k.mediumPlus}],card:["fl-FormulaFromExamplesPanel-Card",{marginBottom:24,borderRadius:4,padding:16,background:e.palette.white,boxShadow:e.effects.elevation4,"&.is-result":Object(o.a)({glintA:"rgba(255, 255, 255, 0.00)",glintB:"rgba(202, 119, 255, 0.20)",glintC:"rgba(81, 193, 255, 0.50)",speedMilliseconds:800,delayMilliseconds:250})}],cardHeader:["fl-FormulaFromExamplesPanel-CardHeader",{display:"flex"}],cardTitle:["fl-FormulaFromExamplesPanel-CardTitle",{width:"100%",margin:"0 0 12px",padding:0,lineHeight:"normal",fontSize:n.k.mediumPlus,fontWeight:n.l.semibold,letterSpacing:"normal","&.is-result":Object(o.b)({textGlowA:"rgba(202, 119, 255, 0.75)",textGlowB:"rgba(81, 193, 255, 0.80)",speedMilliseconds:8e3,delayMilliseconds:250})}],description:["fl-FormulaFromExamplesPanel-Description",{margin:"0 0 12px",padding:0,color:e.palette.neutralSecondary,fontSize:n.k.medium,span:{color:"inherit"}}],messageBar:["fl-FormulaFromExamplesPanel-MessageBar",{marginBottom:"10px","&.ms-MessageBar":{padding:0}}],table:["fl-FormulaFromExamplesPanel-Table",{width:"100%",marginBottom:8,borderSpacing:"0",thead:{th:{width:"50%",textAlign:"left",paddingBottom:8,borderBottom:"none",":first-child":{paddingRight:6},":last-child":{paddingLeft:6}}},tbody:{"tr:hover":{background:"none !important",cursor:"default !important"},td:{paddingBottom:6,verticalAlign:"top",":hover":{background:"none !important",cursor:"default !important"},":first-child":{paddingRight:6},":last-child":{paddingLeft:6}}}}],outputFieldPendingOption:["fl-FormulaFromExamplesPanel-OutputFieldPendingOption",{borderBottom:"1px solid ".concat(e.palette.neutralLight)}],primaryButton:["fl-FormulaFromExamplesPanel-PrimaryButton",{width:"100%"}],separator:["fl-FormulaFromExamplesPanel-Separator",{margin:"8px 0","::before":{backgroundColor:e.palette.neutralQuaternaryAlt},'[role="separator"]:not(:empty)':{display:"inline-flex",width:22,height:22,margin:"8px 0",padding:0,justifyContent:"center",alignItems:"center",border:"1px solid ".concat(e.palette.neutralQuaternaryAlt),borderRadius:"50%"}}],separatorIcon:["fl-FormulaFromExamplesPanel-SeparatorIcon",{fontSize:n.k.small}],formulaContainer:["fl-FormulaFromExamplesPanel-FormulaContainer",{margin:0,border:"1px solid ".concat(e.palette.neutralLight),background:e.palette.neutralLighterAlt,padding:20,whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:n.k.medium,lineHeight:"1.5",display:"flex",flexDirection:"row",alignItems:"center",":not(:last-child)":{marginBottom:16}}],formula:["fl-FormulaFromExamplesPanel-Formula",{flex:"1 1 auto"}],sessionIdContainer:["fl-FormulaFromExamplesPanel-SessionIdContainer",{marginTop:"15px"}],sessionId:["fl-FormulaFromExamplesPanel-SessionId",{marginRight:"5px",fontWeight:n.l.semibold}],formulaCopy:["fl-FormulaFromExamplesPanel-FormulaCopy",{flex:"0 0 auto"}],empty:["fl-FormulaFromExamplesPanel-Empty",{textAlign:"center"}],emptyTitle:["fl-FormulaFromExamplesPanel-EmptyTitle",{margin:"0 0 20px 0",padding:0,lineHeight:"normal",fontSize:n.k.large,fontWeight:n.l.semibold}],emptyIcon:["fl-FormulaFromExamplesPanel-EmptyIcon",{position:"absolute",top:21,left:2,width:74,height:"auto",color:e.palette.white,opacity:.8,filter:"drop-shadow(0 2px 4px ".concat(e.palette.themeDarker,")")}],actionButton:["fl-FormulaFromExamplesPanel-ActionButton",{":not([disabled])":{color:e.palette.themePrimary}}],emptyIconWrapper:["fl-FormulaFromExamplesPanel-EmptyIconWrapper",{position:"relative",display:"inline-block",width:100,height:100,margin:"24px 0",background:e.palette.accent,borderRadius:"50%",boxShadow:e.effects.elevation4}],infoCallout:["fl-FormulaFromExamplesPanel-InfoCallout",{width:340,padding:"20px 24px",fontSize:n.k.small,p:{margin:"0 0 1em 0",padding:0,fontSize:"inherit"},dl:{margin:"0 0 1em 0",padding:0,fontSize:"inherit",":last-child":{marginBottom:0},dt:{display:"inline",margin:"0 0.5em 0 0",padding:0,fontWeight:n.l.semibold},dd:{display:"inline",margin:0,padding:0,"::after":{content:'"\\a"',whiteSpace:"pre"}}}}],infoCalloutTitle:["fl-FormulaFromExamplesPanel-InfoCalloutTitle",{margin:"0 0 12px 0",fontSize:n.k.large}],infoCalloutButton:["fl-FormulaFromExamplesPanel-InfoCalloutButton",{flex:"0 0 auto",top:-4,borderRadius:"50%",".ms-Button-icon":{color:e.palette.neutralPrimary}}],exampleOutputComboBoxButton:["fl-FormulaFromExamplesPanel-ExampleOutputComboBoxButton",{display:"none"}],resultSpinner:["fl-FormulaFromExamplesPanel-ResultLoadingContent",{minHeight:248}],resultFormulaDescription:["fl-FormulaFromExamplesPanel-ResultFormulaDescription",{paddingBottom:8}]}}},20349:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(15539),o=r(12706),i=r(20329),a=r(11766),c=r.n(a),s=r(14346),l=r(20350);var u=e=>{var{title:t,links:r}=e,a=Object(o.a)()(l.a),u=i.a.panel.resources;return c.a.createElement("div",{"data-automation-id":u.root,className:a.root},c.a.createElement("h3",{className:a.title},t),r.map(e=>e.hidden?c.a.createElement(c.a.Fragment,null):c.a.createElement(n.a,{"data-automation-id":u.resourceButton,key:e.text,iconProps:{iconName:e.iconName},text:e.text,onClick:e.onClick,href:e.href,target:e.href?s.b.blank:void 0})))}},20350:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({root:["fl-FormulaFromExamples-ResourcesSection",{marginTop:24,display:"flex",flexDirection:"column",alignItems:"flex-start"}],title:["fl-FormulaFromExamples-ResourcesSectionTitle",{margin:"0 0 8px 0",padding:0,lineHeight:"normal",fontSize:n.k.medium,fontWeight:n.l.semibold}]})},20351:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(11766),o=r.n(n),i=e=>o.a.createElement("svg",{width:"20",height:"19",viewBox:"0 0 20 19",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",className:e.className},o.a.createElement("path",{d:"M10.5605 6.64844H8.37305L6.82031 13.9043C6.70964 14.4121 6.52083 14.9297 6.25391 15.457C5.98698 15.9779 5.6582 16.4531 5.26758 16.8828C4.88346 17.306 4.44076 17.6543 3.93945 17.9277C3.44466 18.1947 2.91406 18.3281 2.34766 18.3281C2.17839 18.3281 2.00586 18.3118 1.83008 18.2793C1.6543 18.2467 1.49479 18.1914 1.35156 18.1133C1.20833 18.0352 1.08789 17.931 0.990234 17.8008C0.899089 17.6641 0.853516 17.4948 0.853516 17.293C0.853516 17.0326 0.931641 16.8112 1.08789 16.6289C1.25065 16.4401 1.46875 16.3457 1.74219 16.3457C1.90495 16.3457 2.05143 16.3815 2.18164 16.4531C2.31185 16.5247 2.42904 16.6159 2.5332 16.7266C2.63737 16.8372 2.73177 16.9609 2.81641 17.0977C2.90104 17.2344 2.98242 17.3646 3.06055 17.4883L3.12891 17.6055C3.33724 17.5924 3.52604 17.5208 3.69531 17.3906C3.86458 17.2604 4.01432 17.0977 4.14453 16.9023C4.28125 16.707 4.40169 16.4889 4.50586 16.248C4.61003 16.0007 4.70117 15.7565 4.7793 15.5156C4.85742 15.2682 4.92253 15.0339 4.97461 14.8125C5.0332 14.5846 5.07878 14.3926 5.11133 14.2363L6.74219 6.64844H5.02344L5.21875 5.85742H6.9082L7.02539 5.25195C7.12956 4.73112 7.30534 4.20703 7.55273 3.67969C7.80664 3.15234 8.1224 2.67708 8.5 2.25391C8.8776 1.83073 9.31055 1.48893 9.79883 1.22852C10.2936 0.961589 10.834 0.828125 11.4199 0.828125C11.5892 0.828125 11.7617 0.844401 11.9375 0.876953C12.1133 0.909505 12.2728 0.964844 12.416 1.04297C12.5658 1.12109 12.6862 1.22852 12.7773 1.36523C12.8685 1.49544 12.9141 1.66146 12.9141 1.86328C12.9141 2.13672 12.8392 2.36784 12.6895 2.55664C12.5462 2.73893 12.3281 2.83008 12.0352 2.83008C11.8268 2.83008 11.6543 2.79102 11.5176 2.71289C11.3809 2.62826 11.2637 2.52409 11.166 2.40039C11.0684 2.27669 10.9772 2.13997 10.8926 1.99023C10.8145 1.84049 10.7331 1.69401 10.6484 1.55078C10.4076 1.5638 10.1927 1.65495 10.0039 1.82422C9.8151 1.99349 9.64583 2.21159 9.49609 2.47852C9.35286 2.73893 9.22917 3.02865 9.125 3.34766C9.02083 3.66667 8.92969 3.98568 8.85156 4.30469C8.77995 4.61719 8.7181 4.91341 8.66602 5.19336C8.61393 5.4668 8.57161 5.68815 8.53906 5.85742H10.7461L10.5605 6.64844ZM17.0449 7.27344C16.8822 7.40365 16.7096 7.57617 16.5273 7.79102C16.3451 8.00586 16.166 8.23372 15.9902 8.47461C15.821 8.70898 15.6582 8.94661 15.502 9.1875C15.3522 9.42839 15.2253 9.63997 15.1211 9.82227C15.1862 10.0892 15.248 10.3529 15.3066 10.6133C15.3652 10.8737 15.4303 11.1374 15.502 11.4043C15.5671 11.6452 15.6387 11.8958 15.7168 12.1562C15.8014 12.4167 15.9121 12.6576 16.0488 12.8789C16.1855 13.0938 16.3548 13.2728 16.5566 13.416C16.7585 13.5527 17.0124 13.6211 17.3184 13.6211C17.3965 13.6211 17.4876 13.6178 17.5918 13.6113C17.696 13.5983 17.8001 13.5853 17.9043 13.5723C18.015 13.5527 18.1191 13.5332 18.2168 13.5137C18.321 13.4876 18.4089 13.4583 18.4805 13.4258L18.3242 14.002C18.1289 14.0866 17.9434 14.1647 17.7676 14.2363C17.5983 14.3079 17.429 14.3698 17.2598 14.4219C17.0905 14.474 16.9115 14.5163 16.7227 14.5488C16.5404 14.5749 16.3418 14.5879 16.127 14.5879C15.8405 14.5879 15.6029 14.5488 15.4141 14.4707C15.2318 14.3861 15.0788 14.2721 14.9551 14.1289C14.8379 13.9792 14.7402 13.8001 14.6621 13.5918C14.584 13.3835 14.5059 13.1556 14.4277 12.9082C14.3366 12.6217 14.2552 12.3385 14.1836 12.0586C14.112 11.7786 14.0404 11.4922 13.9688 11.1992C13.7214 11.5898 13.474 11.9674 13.2266 12.332C12.9792 12.6901 12.709 13.0449 12.416 13.3965C12.2858 13.5527 12.1556 13.7025 12.0254 13.8457C11.8952 13.9889 11.752 14.1159 11.5957 14.2266C11.446 14.3372 11.2832 14.4251 11.1074 14.4902C10.9316 14.5553 10.7363 14.5879 10.5215 14.5879C10.248 14.5879 10.0202 14.5098 9.83789 14.3535C9.66211 14.1973 9.57422 13.9759 9.57422 13.6895C9.57422 13.5202 9.60677 13.3737 9.67188 13.25C9.73698 13.1198 9.82487 13.0124 9.93555 12.9277C10.0462 12.8431 10.1732 12.7812 10.3164 12.7422C10.4596 12.6966 10.6094 12.6738 10.7656 12.6738C10.9609 12.6738 11.1465 12.7096 11.3223 12.7812C11.5046 12.8529 11.6901 12.9147 11.8789 12.9668C12.25 12.5957 12.5951 12.2018 12.9141 11.7852C13.2396 11.3685 13.526 10.9323 13.7734 10.4766L13.7539 10.3789C13.7279 10.2552 13.6888 10.0892 13.6367 9.88086C13.5846 9.67253 13.526 9.44792 13.4609 9.20703C13.4023 8.95964 13.334 8.70898 13.2559 8.45508C13.1777 8.20117 13.0964 7.9668 13.0117 7.75195C12.9336 7.53711 12.849 7.35156 12.7578 7.19531C12.6732 7.03255 12.5885 6.92513 12.5039 6.87305C12.2826 6.74284 12.0319 6.67773 11.752 6.67773C11.5762 6.67773 11.3939 6.69727 11.2051 6.73633C11.0163 6.76888 10.8405 6.82096 10.6777 6.89258L10.834 6.30664C10.9251 6.26758 11.0618 6.21224 11.2441 6.14062C11.4264 6.06901 11.6152 5.9974 11.8105 5.92578C12.0059 5.85417 12.1947 5.79232 12.377 5.74023C12.5592 5.68815 12.696 5.66211 12.7871 5.66211C13.0736 5.66211 13.3112 5.70768 13.5 5.79883C13.6953 5.88997 13.8581 6.01693 13.9883 6.17969C14.1185 6.34245 14.2259 6.53125 14.3105 6.74609C14.3952 6.96094 14.4733 7.19206 14.5449 7.43945C14.6165 7.69336 14.6816 7.95378 14.7402 8.2207C14.8053 8.48112 14.8639 8.74154 14.916 9.00195L14.9355 9.08008C14.9355 9.0931 14.9355 9.10286 14.9355 9.10938C14.9421 9.11589 14.9453 9.12565 14.9453 9.13867C15.069 8.94336 15.2025 8.72201 15.3457 8.47461C15.4889 8.22721 15.6452 7.97331 15.8145 7.71289C15.9837 7.45247 16.1628 7.19857 16.3516 6.95117C16.5469 6.69727 16.752 6.47266 16.9668 6.27734C17.1816 6.08203 17.4095 5.92578 17.6504 5.80859C17.8913 5.6849 18.1452 5.62305 18.4121 5.62305C18.666 5.62305 18.8809 5.70768 19.0566 5.87695C19.2389 6.04622 19.3301 6.26107 19.3301 6.52148C19.3301 6.68424 19.2975 6.82747 19.2324 6.95117C19.1673 7.07487 19.0794 7.17904 18.9688 7.26367C18.8646 7.34831 18.7409 7.41341 18.5977 7.45898C18.4609 7.49805 18.3177 7.51758 18.168 7.51758C17.9987 7.51758 17.8099 7.49154 17.6016 7.43945C17.3932 7.38086 17.2077 7.32552 17.0449 7.27344Z",fill:"currentColor"}))},20352:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(20329),o=r(14337),i=r(11766),a=r.n(i),c=r(20353),s=r(15524),l=r(15027),u=r(13272),p=r(20354),f=r(20344),d=Object(o.c)(e=>{var t,r,{store:o,strings:i}=e,d=Object(f.b)(),m=n.a.panel;return a.a.createElement(a.a.Fragment,null,a.a.createElement("table",{className:d.table},a.a.createElement("thead",null,a.a.createElement("th",null,a.a.createElement(s.a,{text:i.TestInputLabelName})),a.a.createElement("th",null,a.a.createElement(s.a,{text:i.TestOutputLabelName}))),a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement(l.b,{dataAutomationId:m.testInput,type:"text",placeholder:i.TestInputLabelPlaceholder,disabled:o.evaluationOperation.isRunning,value:null!==(t=o.evaluationInput)&&void 0!==t?t:"",onChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.onEvaluationInputChanged(t)},onKeyPress:e=>{Object(p.k)(e.nativeEvent)&&o.evaluateExpression()}})),a.a.createElement("td",null,a.a.createElement(l.b,{dataAutomationId:m.testOutput,type:"text",placeholder:i.TestOutputLabelPlaceholder,readOnly:!0,disabled:o.evaluationOperation.isRunning,value:null!==(r=o.evaluationResult)&&void 0!==r?r:""}))))),a.a.createElement(c.a,{"data-automation-id":m.testButton,text:i.TestButton,iconName:u.a.Test,onClick:o.evaluateExpression,disabled:!o.canEvaluateExpression,className:d.actionButton}))})},20354:function(e,t,r){"use strict";r.d(t,"l",(function(){return i})),r.d(t,"m",(function(){return a})),r.d(t,"k",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return l})),r.d(t,"f",(function(){return u})),r.d(t,"e",(function(){return p})),r.d(t,"d",(function(){return f})),r.d(t,"c",(function(){return d})),r.d(t,"g",(function(){return m})),r.d(t,"h",(function(){return b})),r.d(t,"i",(function(){return y})),r.d(t,"j",(function(){return v}));var n=r(20355),o=r.n(n),i=o()("shift+tab"),a=o()("tab"),c=(o()("space"),o()("return")),s=o()("esc"),l=o()("backspace"),u=o()("mod+space"),p=o()("mod+shift+space"),f=o()("mod+d"),d=o()("mod+c"),m=o()("mod+v"),b=o()("mod+x"),y=o()("mod+y"),v=o()("mod+z")},20356:function(e,t,r){"use strict";r.d(t,"a",(function(){return ge}));var n,o,i,a,c,s,l,u,p,f,d,m,b,y,v,h,g,O,w,E,C,S,P,j,T,k,R,x,N,_,D,I,A,F,L,M,B,U,V,z,G,W=r(20329),H=r(17929),K=r.n(H),q=r(11773),Y=r(11766),X=r.n(Y),Q=r(17244),Z=r(11795),J=r(20357),$=r(12366),ee=r(20361),te=r(13240),re=r(12375),ne=r(15212),oe=r(14883),ie=r(20362);function ae(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function ce(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ae(i,n,o,a,c,"next",e)}function c(e){ae(i,n,o,a,c,"throw",e)}a(void 0)}))}}function se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?se(Object(r),!0).forEach((function(t){ue(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ue(e,t,r){return(t=de(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pe(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,de(n.key),n)}}function de(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function me(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var be=e=>!!e.input,ye=e=>!!e.output,ve=e=>ye(e)&&be(e)&&!e.isDuplicateInput&&!e.isNotSupportedType,he=e=>(e=>{var t;return!(null===(t=e.input)||void 0===t||!t.trim())})(e)||(e=>{var t;return!(null===(t=e.output)||void 0===t||!t.trim())})(e),ge=(o=me((n=function(){function e(t,r,n,W,H){var Y=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.STORAGE_KEY_IGNORE_APPLY_CONFIRMATION="formula-from-example-do-not-confirm",pe(this,"isOpen",o,this),this.panelCorrelationId=void 0,pe(this,"isInputPanelOpen",i,this),this.inputPanelCorrelationId=void 0,pe(this,"isApplyConfirmationDialogOpen",a,this),pe(this,"isTutorialOpen",c,this),pe(this,"isFeedbackPanelOpen",s,this),this.isFeedbackPanelCorrelationId=void 0,pe(this,"examples",l,this),pe(this,"suggestions",u,this),pe(this,"learningOperation",p,this),pe(this,"selectedToken",f,this),pe(this,"selectedTokenExpression",d,this),pe(this,"formula",m,this),this.formulaApplied=!1,pe(this,"evaluationOperation",b,this),pe(this,"evaluationInput",y,this),pe(this,"evaluationResult",v,this),this.examplesSectionRef=X.a.createRef(),this.aiHostedModelsService=void 0,this.environmentStore=void 0,this.loggingService=void 0,this.tokenService=void 0,this.sessionStore=void 0,this.editorContext=void 0,pe(this,"initializeAndOpen",h,this),pe(this,"close",g,this),pe(this,"reset",O,this),pe(this,"resetLearning",w,this),pe(this,"resetEvaluation",E,this),pe(this,"learnAsync",C,this),pe(this,"onDismiss",S,this),pe(this,"getOutputSuggestions",P,this),pe(this,"onExampleInputChanged",j,this),this.refreshExampleInputError=K()(e=>{var t=this.examples[e].input,r=this.examples.filter(be).reduce((e,r,n)=>{var o,i,a=null!==(i=e[o=r.input])&&void 0!==i?i:e[o]={count:0,lastErrorIndex:void 0,lastIndex:n};return a.count+=1,a.lastIndex=n,r.isDuplicateInput&&r.input!==t&&(a.lastErrorIndex=n),e},{}),n=this.examples.map((n,o)=>{var i=!1;if(n.input&&r[n.input].count>1)if(n.input===t)i=o===e;else{var{lastIndex:a,lastErrorIndex:c}=r[n.input];i=o===(null!=c?c:a)}var s=!this.isExampleTypeSupported(n);return le(le({},n),{},{isDuplicateInput:i,isNotSupportedType:s})});Object(q.runInAction)(()=>{this.examples=n})},$.h.search),pe(this,"onExampleOutputChanged",T,this),pe(this,"addEmptyExample",k,this),pe(this,"onExampleInputFocus",R,this),pe(this,"addExampleFromResultCard",x,this),this.isExampleTypeSupported=e=>{var t,r=e.input,n=null===(t=this.selectedToken)||void 0===t?void 0:t.schema;if(r&&n)switch(n.type){case Q.a.Swagger.TYPE.INTEGER:case Q.a.Swagger.TYPE.NUMBER:return!isNaN(Number(r));case Q.a.Swagger.TYPE.ARRAY:return Array.isArray(r);case Q.a.Swagger.TYPE.STRING:switch(n.format){case Q.a.Swagger.FORMAT.DATE:case Q.a.Swagger.FORMAT.DATETIME:return!!Object(J.b)(r);default:return!0}default:return!0}return!0},pe(this,"onExampleInputBlur",N,this),pe(this,"onApplyFormula",_,this),pe(this,"onApplyConfirmed",D,this),pe(this,"onApplyDismissed",I,this),this.applyFormula=()=>{var e;this.logEvent(te.c.EasyAutomationDataReshapingApply),null===(e=this.editorContext)||void 0===e||e.onApply({expression:this.formula}),this.formulaApplied=!0},pe(this,"openInputPanel",A,this),pe(this,"onInputPanelDismiss",F,this),pe(this,"onInputTokenSelected",L,this),this.copyToClipboard=()=>{var e;this.logEvent(te.c.EasyAutomationDataReshapingCopyToClipboard),window.navigator.clipboard.writeText(null!==(e=this.formula)&&void 0!==e?e:"")},pe(this,"onEvaluationInputChanged",M,this),pe(this,"evaluateExpression",B,this),pe(this,"openTutorial",U,this),pe(this,"closeTutorial",V,this),pe(this,"openFeedbackPanel",z,this),pe(this,"onFeedbackPanelDismiss",G,this),this.FEEDBACK_SURVEY_ID="v4j5cvGGr0GRqy180BHbRz-bTP0CJopMuF7bKY6HpVRUNDNEWVhJSERGRlFGTFhSNEYxQzVYUTA4NyQlQCN0PWcu",this.getFeedbackSurveyUserContext=()=>{var e,t,r,n;return{UserId:null!==(e=null===(t=this.sessionStore.minimalUserInfo)||void 0===t?void 0:t.uniqueId)&&void 0!==e?e:"",TenantId:null!==(r=null===(n=this.sessionStore.minimalUserInfo)||void 0===n?void 0:n.tenantId)&&void 0!==r?r:"",SessionId:this.sessionStore.sessionId,Location:Object(Z.h)().location,Region:Object(Z.h)().region,EnvironmentId:this.environmentStore.currentEnvironmentName,locale:Object(re.a)()}},this.onDocumentationLinkClicked=()=>{this.logEvent(te.c.EasyAutomationDataReshapingOpenTutorial)},this.learnInternalAsync=ce((function*(){if(!Y.canLearn)throw new Error("Cannot learn");Object(q.runInAction)(()=>{Y.formula=null,Y.formulaApplied=!1,Y.examples=Y.examples.filter(he),Y.resetEvaluation()});var e=yield Y.aiHostedModelsService.learnFormulaFromExamplesAsync({examples:Y.examples.filter(be).map(e=>({inputs:[e.input],output:e.output})),tokens:[{value:Y.selectedTokenExpression}],locales:Y.getUniqueLocales()});Object(q.runInAction)(()=>{Y.formula=e.formula})})),this.getUniqueLocales=()=>{var e,t=new Set([Object(re.a)(),navigator.language,...navigator.languages]),r=null===(e=this.environmentStore.environmentClaim)||void 0===e?void 0:e.dataverseDefaultLocaleId;return r&&ee.a[r]&&t.add(ee.a[r]),Array.from(t)},this.track=(e,t,r)=>Object(ne.e)(e(),this.loggingService,t,()=>le(le({},this.telemetryData),{},{data:null==r?void 0:r()})),this.evaluateExpressionInternalAsync=ce((function*(){if(!Y.formula||!Y.evaluationInput||!Y.selectedTokenExpression)throw new Error("Cannot evaluate expression");Object(q.runInAction)(()=>{Y.evaluationResult=void 0});var e="@{".concat(Object(oe.g)(Y.formula,Y.selectedTokenExpression,"variables('input1')"),"}"),t={variables:{input1:Y.evaluationInput}},r=yield Y.aiHostedModelsService.evaluateLogicAppsExpressionAsync({expression:e,values:t});Object(q.runInAction)(()=>{Y.evaluationResult=r.result})})),this.aiHostedModelsService=t,this.environmentStore=r,this.loggingService=n,this.sessionStore=W,this.tokenService=H,this.reset()}var t,r,n;return t=e,(r=[{key:"canLearn",get:function(){var e=this.examples.filter(he);return!this.learningOperation.isRunning&&!this.learningOperation.succeeded&&!!this.selectedToken&&!!this.selectedTokenExpression&&e.length>0&&e.every(ve)}},{key:"canAddExample",get:function(){return!this.learningOperation.isRunning&&this.examples.every(be)&&this.examples.some(ye)}},{key:"canEditExample",get:function(){return!this.learningOperation.isRunning}},{key:"canApplyFormula",get:function(){return this.learningOperation.succeeded&&!!this.formula}},{key:"noResultFound",get:function(){return this.learningOperation.succeeded&&!this.formula}},{key:"canEvaluateExpression",get:function(){return!this.evaluationOperation.isRunning&&!!this.evaluationInput}},{key:"errorMessage",get:function(){if(this.learningOperation.error){var e,t=this.learningOperation.error;return(null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e||null===(e=e.error)||void 0===e?void 0:e.message)||t.message}return""}},{key:"sessionId",get:function(){return this.sessionStore.sessionId}},{key:"telemetryData",get:function(){var e,t,r,n,o;return{parameterSchemaType:null===(e=this.editorContext)||void 0===e||null===(e=e.parameter)||void 0===e||null===(e=e.schema)||void 0===e?void 0:e.type,parameterSchemaFormat:null===(t=this.editorContext)||void 0===t||null===(t=t.parameter)||void 0===t||null===(t=t.schema)||void 0===t?void 0:t.format,tokenSelected:!!this.selectedToken,tokenSchemaType:null===(r=this.selectedToken)||void 0===r||null===(r=r.schema)||void 0===r?void 0:r.type,tokenSchemaFormat:null===(n=this.selectedToken)||void 0===n||null===(n=n.schema)||void 0===n?void 0:n.format,examplesCount:this.examples.filter(he).length,expressionFound:!!this.formula,expressionLength:null===(o=this.formula)||void 0===o?void 0:o.length,expressionApplied:!!this.formulaApplied,expressionEvaluationSucceeded:this.evaluationOperation.succeeded,expressionEvaluationFailed:this.evaluationOperation.failed}}},{key:"expectedTokenType",get:function(){var e,t=null===(e=this.selectedToken)||void 0===e?void 0:e.schema;return t?t.type===Q.a.Swagger.TYPE.INTEGER||t.type===Q.a.Swagger.TYPE.NUMBER?Q.a.Swagger.TYPE.NUMBER:t.type===Q.a.Swagger.TYPE.ARRAY?Q.a.Swagger.TYPE.ARRAY:t.type!==Q.a.Swagger.TYPE.STRING||t.format!==Q.a.Swagger.FORMAT.DATE&&t.format!==Q.a.Swagger.FORMAT.DATETIME?Q.a.Swagger.TYPE.STRING:Q.a.Swagger.FORMAT.DATE:Q.a.Swagger.TYPE.STRING}},{key:"logEvent",value:function(e,t){this.loggingService.logInfo(e,"",le(le({},this.telemetryData),{},{data:t}),this.panelCorrelationId)}}])&&fe(t.prototype,r),n&&fe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"isOpen",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=me(n.prototype,"isInputPanelOpen",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=me(n.prototype,"isApplyConfirmationDialogOpen",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=me(n.prototype,"isTutorialOpen",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=me(n.prototype,"isFeedbackPanelOpen",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=me(n.prototype,"examples",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=me(n.prototype,"suggestions",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=me(n.prototype,"learningOperation",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=me(n.prototype,"selectedToken",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=me(n.prototype,"selectedTokenExpression",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=me(n.prototype,"formula",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=me(n.prototype,"evaluationOperation",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=me(n.prototype,"evaluationInput",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=me(n.prototype,"evaluationResult",[q.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me(n.prototype,"canLearn",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"canLearn"),n.prototype),me(n.prototype,"canAddExample",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"canAddExample"),n.prototype),me(n.prototype,"canEditExample",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"canEditExample"),n.prototype),me(n.prototype,"canApplyFormula",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"canApplyFormula"),n.prototype),me(n.prototype,"noResultFound",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"noResultFound"),n.prototype),me(n.prototype,"errorMessage",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"errorMessage"),n.prototype),me(n.prototype,"sessionId",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"sessionId"),n.prototype),h=me(n.prototype,"initializeAndOpen",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.reset(),this.editorContext=e,this.isOpen=!0,this.selectedToken||(this.isInputPanelOpen=!0),this.panelCorrelationId=this.loggingService.profileStart(te.c.EasyAutomationDataReshapingPanel,this.telemetryData)}}}),g=me(n.prototype,"close",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.loggingService.profileEndWithSuccess(this.panelCorrelationId,te.c.EasyAutomationDataReshapingPanel,this.telemetryData),this.isOpen=!1,this.reset()}}}),O=me(n.prototype,"reset",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isTutorialOpen=!1,this.isInputPanelOpen=!1,this.isFeedbackPanelOpen=!1,this.isApplyConfirmationDialogOpen=!1,this.selectedToken=void 0,this.selectedTokenExpression=void 0,this.examples=[Object(ie.a)()],this.resetLearning(),this.resetEvaluation()}}}),w=me(n.prototype,"resetLearning",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.learningOperation=ne.b.NotStarted(),this.formula=null,this.formulaApplied=!1}}}),E=me(n.prototype,"resetEvaluation",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.evaluationOperation=ne.b.NotStarted(),this.evaluationInput=void 0,this.evaluationResult=void 0}}}),C=me(n.prototype,"learnAsync",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>(this.logEvent(te.c.EasyAutomationDataReshapingLearnClicked),this.learningOperation=this.track(this.learnInternalAsync,te.c.EasyAutomationDataReshapingLearnOperation),this.learningOperation.promise)}}),S=me(n.prototype,"onDismiss",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e;this.logEvent(te.c.EasyAutomationDataReshapingCancelClicked),null===(e=this.editorContext)||void 0===e||e.onCancel()}}}),P=me(n.prototype,"getOutputSuggestions",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{if(e){var r=null==e?void 0:e.toLowerCase(),n=r?t.filter(e=>e.toLowerCase().includes(r)).sort((e,n)=>{var o=e.toLowerCase(),i=n.toLowerCase();if(o!==i){if(o===r)return-1;if(i===r)return 1}return t.indexOf(e)-t.indexOf(n)}):t.slice();this.suggestions=n.slice(0,10)}else this.suggestions=[]}}}),j=me(n.prototype,"onExampleInputChanged",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.logEvent(te.c.EasyAutomationDataReshapingEditExampleInput,{exampleIndex:e,exampleLength:t.length}),this.examples[e]=le(le({},this.examples[e]),{},{input:t}),this.refreshExampleInputError(e),this.resetLearning()}}}),T=me(n.prototype,"onExampleOutputChanged",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,r)=>{void 0!==r?this.logEvent(te.c.EasyAutomationDataReshapingSelectSuggestedExample,{suggestionChoiceIndex:r,suggestionChoiceLength:t.length,exampleIndex:e}):this.logEvent(te.c.EasyAutomationDataReshapingEditExampleOutput,{exampleIndex:e,exampleLength:t.length}),this.examples[e]=le(le({},this.examples[e]),{},{output:t}),this.resetLearning()}}}),k=me(n.prototype,"addEmptyExample",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.logEvent(te.c.EasyAutomationDataReshapingAddExample),this.examples.push(Object(ie.a)())}}}),R=me(n.prototype,"onExampleInputFocus",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.refreshExampleInputError(e)}}}),x=me(n.prototype,"addExampleFromResultCard",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.logEvent(te.c.EasyAutomationDataReshapingAddExampleFromResultCard);var e=this.evaluationOperation.succeeded||this.evaluationOperation.failed?this.evaluationInput:void 0;this.examples.push({input:e,output:void 0,uniqueKey:Object(ie.b)()});var t=this.examples.length-1;this.resetLearning(),this.refreshExampleInputError(t),this.onExampleInputBlur(t),setTimeout(()=>{var r=this.examplesSectionRef.current;if(r){var n=r.querySelectorAll(e?'[data-automation-id="'.concat(W.a.panel.exampleOutput,'"] input'):'input[data-automation-id="'.concat(W.a.panel.exampleInput,'"]')).item(t);null==n||n.scrollIntoView({behavior:"smooth"}),null==n||n.focus({preventScroll:!0})}},100)}}}),me(n.prototype,"expectedTokenType",[q.computed],Object.getOwnPropertyDescriptor(n.prototype,"expectedTokenType"),n.prototype),N=me(n.prototype,"onExampleInputBlur",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;if(null!==(t=this.examples[e])&&void 0!==t&&t.input){var r=this.examples[e].input;this.examples[e]=le(le({},this.examples[e]),{},{outputSuggestions:void 0}),this.track(()=>this.aiHostedModelsService.getOutputSuggestionsAsync({inputString:this.examples[e].input,suggestionLocales:this.getUniqueLocales()}),te.c.EasyAutomationDataReshapingOuputSuggestionOperation).promise.then(t=>{r===this.examples[e].input&&Object(q.runInAction)(()=>{this.examples[e]=le(le({},this.examples[e]),{},{outputSuggestions:t})})})}}}}),_=me(n.prototype,"onApplyFormula",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.logEvent(te.c.EasyAutomationDataReshapingApplyClicked),!this.formula)throw new Error("No formula to apply");localStorage.getItem(this.STORAGE_KEY_IGNORE_APPLY_CONFIRMATION)?this.applyFormula():this.isApplyConfirmationDialogOpen=!0}}}),D=me(n.prototype,"onApplyConfirmed",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logEvent(te.c.EasyAutomationDataReshapingApplyConfirmed),this.isApplyConfirmationDialogOpen=!1,e&&localStorage.setItem(this.STORAGE_KEY_IGNORE_APPLY_CONFIRMATION,JSON.stringify(!0)),this.applyFormula()}}}),I=me(n.prototype,"onApplyDismissed",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.logEvent(te.c.EasyAutomationDataReshapingApplyDismissed),this.isApplyConfirmationDialogOpen=!1}}}),A=me(n.prototype,"openInputPanel",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isInputPanelOpen=!0,this.inputPanelCorrelationId=this.loggingService.profileStart(te.c.EasyAutomationDataReshapingInputTokenSelectionPanel,this.telemetryData)}}}),F=me(n.prototype,"onInputPanelDismiss",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.loggingService.profileEndWithSuccess(this.inputPanelCorrelationId,te.c.EasyAutomationDataReshapingInputTokenSelectionPanel,this.telemetryData),this.isInputPanelOpen=!1,this.selectedToken||this.onDismiss()}}}),L=me(n.prototype,"onInputTokenSelected",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t=this.tokenService.getTokenExpression(e);t!==this.selectedTokenExpression&&this.reset(),this.selectedToken=e,this.selectedTokenExpression=t,this.isInputPanelOpen=!1,this.loggingService.profileEndWithSuccess(this.inputPanelCorrelationId,te.c.EasyAutomationDataReshapingInputTokenSelectionPanel,this.telemetryData)}}}),M=me(n.prototype,"onEvaluationInputChanged",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logEvent(te.c.EasyAutomationDataReshapingEditEvaluationInput,{inputLength:e.length}),this.evaluationInput=e,this.evaluationResult=void 0,this.evaluationOperation=ne.b.NotStarted()}}}),B=me(n.prototype,"evaluateExpression",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>(this.evaluationOperation=this.track(this.evaluateExpressionInternalAsync,te.c.EasyAutomationDataReshapingEvaluateExpression,()=>{var e,t;return{inputLength:null===(e=this.evaluationInput)||void 0===e?void 0:e.length,resultFound:!!this.evaluationResult,resultLength:null===(t=this.evaluationResult)||void 0===t?void 0:t.length}}),this.evaluationOperation.promise)}}),U=me(n.prototype,"openTutorial",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.logEvent(te.c.EasyAutomationDataReshapingOpenTutorial),this.isTutorialOpen=!0}}}),V=me(n.prototype,"closeTutorial",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isTutorialOpen=!1}}}),z=me(n.prototype,"openFeedbackPanel",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isFeedbackPanelOpen=!0,this.isFeedbackPanelCorrelationId=this.loggingService.profileStart(te.c.EasyAutomationDataReshapingFeedbackPanel,this.telemetryData)}}}),G=me(n.prototype,"onFeedbackPanelDismiss",[q.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.loggingService.profileEndWithSuccess(this.isFeedbackPanelCorrelationId,te.c.EasyAutomationDataReshapingFeedbackPanel,this.telemetryData),this.isFeedbackPanelOpen=!1}}}),n)},20361:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={1027:"ca-ES",1029:"cs-CZ",1030:"da-DK",1031:"de-DE",1061:"et-EE",1033:"en-US",3082:"es-ES",1069:"eu-ES",1036:"fr-FR",1110:"gl-ES",1050:"hr-HR",1040:"it-IT",1062:"lv-LV",1063:"lt-LT",1038:"hu-HU",1043:"nl-NL",1044:"nb-NO",1045:"pl-PL",1046:"pt-BR",2070:"pt-PT",1048:"ro-RO",1051:"sk-SK",1060:"sl-SI",2074:"sr-Latn-CS",1035:"fi-FI",1053:"sv-SE",1066:"vi-VN",1055:"tr-TR",1032:"el-GR",1026:"bg-BG",1087:"kk-KZ",1049:"ru-RU",3098:"sr-Cyrl-CS",1058:"uk-UA",1081:"hi-IN",1054:"th-TH",1042:"ko-KR",2052:"zh-CN",1028:"zh-TW",3076:"zh-HK",1041:"ja-JP",1086:"ms-MY"}},20362:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(13223),o=()=>({input:void 0,output:void 0,uniqueKey:Object(n.a)()}),i=()=>Object(n.a)()},20363:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(12743),o=r(12854),i=r(15910),a=r(12729),c=r(13262),s=r(12706),l=r(20329),u=r(11766),p=r.n(u),f=r(20154),d=r(20364);var m=e=>{var{isOpen:t,onDismiss:r,resources:u}=e,m=Object(s.a)()(d.h),b=Object(s.a)()(d.g),y=Object(s.a)()(d.d),v=Object(s.a)()(d.c),h=Object(s.a)()(d.b),g=Object(s.a)()(d.a),O=Object(s.a)()(d.f),w=Object(s.a)()(d.e),E=Object(n.a)("modal-title"),C=l.a.tutorialModal,S=p.a.useMemo(()=>[{src:Object(f.b)(f.a.designerNewTokenPickerV2)?"https://go.microsoft.com/fwlink/?linkid=2207715":"https://go.microsoft.com/fwlink/?linkid=2197818",title:u.Steps.Step1.Title,description:u.Steps.Step1.Description},{src:Object(f.b)(f.a.designerNewTokenPickerV2)?"https://go.microsoft.com/fwlink/?linkid=2207913":"https://go.microsoft.com/fwlink/?linkid=2197819",title:u.Steps.Step2.Title,description:u.Steps.Step2.Description},{src:Object(f.b)(f.a.designerNewTokenPickerV2)?"https://go.microsoft.com/fwlink/?linkid=2207610":"https://go.microsoft.com/fwlink/?linkid=2197196",title:u.Steps.Step3.Title,description:u.Steps.Step3.Description}],[u.Steps]),[P,j]=p.a.useState(0),T=p.a.useCallback(()=>{P>0&&j(P-1)},[P]),k=p.a.useCallback(()=>{P<S.length-1&&j(P+1)},[P,S]),R=p.a.useMemo(()=>S.map((e,t)=>({key:"".concat(t),text:"".concat(t+1),styles:g})),[S,g]),x=p.a.useCallback((e,t)=>{t&&j(parseInt(t.key,10))},[]);return p.a.createElement(a.a,{isOpen:t,titleAriaId:E,onDismiss:r,styles:b,focusTrapZoneProps:{"data-automation-id":C.root}},p.a.createElement(c.a,{content:u.CloseButtonAriaLabel,styles:y},p.a.createElement(o.a,{"data-automation-id":C.closeButton,iconProps:{iconName:"Cancel"},ariaLabel:u.CloseButtonAriaLabel,onClick:r,styles:v})),p.a.createElement("figure",{className:m.root},p.a.createElement("img",{src:S[P].src,alt:"",className:m.img}),p.a.createElement("figcaption",{className:m.caption},p.a.createElement("h1",{id:E,className:m.title},S[P].title),p.a.createElement("p",{className:m.description},S[P].description),p.a.createElement(i.a,{options:R,selectedKey:"".concat(P),onChange:x,styles:h}))),p.a.createElement(c.a,{content:P>0?u.PreviousTutorialButtonLabel:void 0,styles:O,hostClassName:"is-left"},p.a.createElement(o.a,{"data-automation-id":C.backButton,iconProps:{iconName:"ChevronLeft"},ariaLabel:u.PreviousTutorialButtonLabel,disabled:0===P,onClick:T,styles:w})),p.a.createElement(c.a,{content:P<S.length-1?u.NextTutorialButtonLabel:void 0,styles:O,hostClassName:"is-right"},p.a.createElement(o.a,{"data-automation-id":C.nextButton,iconProps:{iconName:"ChevronRight"},ariaLabel:u.NextTutorialButtonLabel,disabled:P===S.length-1,onClick:k,styles:w})))}},20364:function(e,t,r){"use strict";r.d(t,"g",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return s})),r.d(t,"f",(function(){return l})),r.d(t,"e",(function(){return u})),r.d(t,"h",(function(){return p}));var n=r(12754),o=()=>({main:[{display:"flex",width:"66vw",maxWidth:860,backgroundColor:"transparent",borderRadius:0,boxShadow:"none",overflow:"visible",[Object(n.X)(void 0,n.s)]:{width:"100vw"}}],scrollableContent:[{width:"100%",padding:"40px",overflow:"hidden",[Object(n.X)(void 0,n.t)]:{paddingLeft:0,paddingRight:0}}]}),i=()=>({root:[{position:"absolute",top:0,right:0}]}),a=()=>{var e=Object(n.Y)();return{root:[{background:"rgba(0, 0, 0, 0.8)",borderRadius:"50%",color:e.palette.white,boxShadow:e.effects.elevation16}],rootHovered:[{background:e.palette.black,color:e.palette.white}],rootPressed:[{background:e.palette.black,color:e.palette.white}]}},c=()=>({flexContainer:[{display:"flex",justifyContent:"center",paddingLeft:16}]}),s=()=>({root:[{minHeight:10,margin:0,".ms-ChoiceFieldLabel":{width:0,height:0,overflow:"hidden"}}],field:[{minHeight:10,"::before":{width:10,height:10},"::after":{top:0,left:0,width:10,height:10},":hover::after":{top:0,left:0}}]}),l=()=>({root:[{position:"absolute",top:"50%","&.is-left":{left:0},"&.is-right":{right:0}}]}),u=()=>{var e=Object(n.Y)();return{root:[{color:e.palette.neutralPrimary,background:e.palette.white,borderRadius:"50%",boxShadow:e.effects.elevation16,[Object(n.X)(void 0,n.t)]:{display:"none"}}],rootHovered:[{color:e.palette.neutralDark}],rootPressed:[{color:e.palette.neutralDark}],rootDisabled:[{background:e.palette.neutralQuaternary}]}},p=()=>{var e=Object(n.Y)();return{root:["fl-FormulaFromExamples-TutorialsModalRoot",{height:"100%",margin:0,padding:0,borderRadius:2,background:e.palette.white,overflow:"auto",boxShadow:e.effects.elevation16}],img:["fl-FormulaFromExamples-TutorialsModalImg",{display:"block",width:"100%",aspectRatio:"".concat(1660/960),objectFit:"contain",background:e.palette.themeLighter}],caption:["fl-FormulaFromExamples-TutorialsModalCaption",{padding:24,borderTop:"1px solid ".concat(e.palette.neutralLight),textAlign:"center"}],title:["fl-FormulaFromExamples-TutorialsModalTitle",{margin:"0 0 12px",padding:0,fontSize:n.k.medium,fontWeight:n.l.semibold,lineHeight:"normal"}],description:["fl-FormulaFromExamples-TutorialsModalDescription",{minHeight:40,margin:"0 0 24px",padding:0,lineHeight:"normal",fontSize:n.k.medium}]}}},20365:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));r(11766);var n=r(20334),o=r(13240),i=(r(20366),r(20367)),a="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMTk3NUZGIi8+CjxwYXRoIGQ9Ik0xMi4yNDIyIDExSDguNzU3ODFMOC4wOTM3NSAxM0g3TDEwIDRIMTFMMTMuNTc4MSAxMS43MTg4TDEyLjc1IDEyLjUzOTFMMTIuMjQyMiAxMVpNMTEuOTA2MiAxMEwxMC41IDUuNzgxMjVMOS4wOTM3NSAxMEgxMS45MDYyWk0xNi40NDUzIDExLjAyMzRDMTYuNjY0MSAxMS4wMjM0IDE2Ljg2NzIgMTEuMDYyNSAxNy4wNTQ3IDExLjE0MDZDMTcuMjQ3NCAxMS4yMTM1IDE3LjQxMTUgMTEuMzE3NyAxNy41NDY5IDExLjQ1MzFDMTcuNjg3NSAxMS41ODg1IDE3Ljc5NjkgMTEuNzUgMTcuODc1IDExLjkzNzVDMTcuOTU4MyAxMi4xMTk4IDE4IDEyLjMyMjkgMTggMTIuNTQ2OUMxOCAxMi43NSAxNy45NjA5IDEyLjk0NzkgMTcuODgyOCAxMy4xNDA2QzE3LjgwNDcgMTMuMzMzMyAxNy42OTI3IDEzLjUwMjYgMTcuNTQ2OSAxMy42NDg0TDExLjk0NTMgMTkuMjVMOSAxOS45ODQ0TDkuNzM0MzggMTcuMDM5MUwxNS4zMzU5IDExLjQ0NTNDMTUuNDgxOCAxMS4yOTk1IDE1LjY1MSAxMS4xOTI3IDE1Ljg0MzggMTEuMTI1QzE2LjA0MTcgMTEuMDU3MyAxNi4yNDIyIDExLjAyMzQgMTYuNDQ1MyAxMS4wMjM0Wk0xNi44MzU5IDEyLjk0NTNDMTYuOTQ1MyAxMi44MzU5IDE3IDEyLjcwMzEgMTcgMTIuNTQ2OUMxNyAxMi4zODAyIDE2Ljk0NTMgMTIuMjUgMTYuODM1OSAxMi4xNTYyQzE2LjczMTggMTIuMDU3MyAxNi41OTkgMTIuMDA3OCAxNi40Mzc1IDEyLjAwNzhDMTYuMzY0NiAxMi4wMDc4IDE2LjI5NDMgMTIuMDE4MiAxNi4yMjY2IDEyLjAzOTFDMTYuMTU4OSAxMi4wNTk5IDE2LjA5OSAxMi4wOTY0IDE2LjA0NjkgMTIuMTQ4NEwxMC42NDA2IDE3LjU1NDdMMTAuMzc1IDE4LjYwOTRMMTEuNDI5NyAxOC4zNDM4TDE2LjgzNTkgMTIuOTQ1M1oiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==";function c(e){var{onFormulaFromExamplesOptionClicked:t,loggingService:r,resources:c}=e,s=()=>{r.logInfo(o.c.EasyAutomationDataReshapingEntryPointClicked,"",{source:i.a.LegacyTokenPicker}),t()};return e=>{var{mobile:t,tokenPickerMode:r}=e;switch(r){case n.a.TOKEN:if(!t)return;return{title:c.sectionTitle,sections:[{sectionKey:"easy-automation",title:c.mobileSectionTitle,iconUri:a,brandColor:"#0077ff",items:[{itemKey:"open-formula-from-examples",title:c.mobileItemTitle,onSelect:s}]}]};case n.a.EXPRESSION:case n.a.EXPRESSION_TOKEN:if(t)return;return{sections:[{sectionKey:"easy-automation",title:c.sectionTitle,iconUri:a,brandColor:"#0077ff",items:[{itemKey:"open-formula-from-examples",title:c.itemTitle,description:c.itemDescription,onSelect:s}]}]};default:throw new Error("unknown tokenPickerMode ".concat(r))}}}},20366:function(e,t,r){"use strict";r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return f})),r.d(t,"c",(function(){return b}));var n=r(17934),o=r(20329),i=r(11766),a=r.n(i),c=r(15995),s=r(13272),l=r(17758),u=r(13240),p={ExpressionPivotHeader:"ExpressionPivotHeader",EntryPointOptionItem:"EntryPointOptionItem"},f=e=>{var{target:t,resources:r,loggingService:i,onWatchTutorialClick:c}=e;a.a.useEffect(()=>{i.logInfo(u.c.EasyAutomationDataReshapingFirstRunExperienceTeachingBubble,"",{source:t.source,target:t.location})},[i,t.location,t.source]);var l=o.a.teachingBubble,f=a.a.useMemo(()=>({"data-automation-id":l.watchTutorialButton,text:r.WatchTutorialButton,iconProps:{iconName:s.a.WatchTutorial},onClick:e=>{e.preventDefault(),e.stopPropagation(),i.logInfo(u.c.EasyAutomationDataReshapingFirstRunExperienceWatchTutorialClicked,"",{source:t.source,target:t.location}),c()}}),[l.watchTutorialButton,r.WatchTutorialButton,i,t.source,t.location,c]),b=a.a.useMemo(()=>({"data-automation-id":l.root,shouldDismissOnWindowFocus:!1,dismissOnTargetClick:t.location===p.EntryPointOptionItem}),[l.root,t.location]);return a.a.createElement(n.a,{target:t.element,primaryButtonProps:f,headline:r.Headline,calloutProps:b,hasCloseButton:!0,closeButtonAriaLabel:r.CloseButtonAriaLabel,styles:y},t.location===p.EntryPointOptionItem&&a.a.createElement(m,{resources:r}),t.location===p.ExpressionPivotHeader&&a.a.createElement(d,{resources:r}))},d=e=>{var{resources:t}=e;return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,t.ExpressionPivotContent1),a.a.createElement("p",null,a.a.createElement(c.a,{formatText:t.ExpressionPivotContent2Format})))},m=e=>{var{resources:t}=e;return a.a.createElement(c.a,{formatText:t.EntryPointOptionContent})};function b(e,t){var r=a.a.useRef(!0);a.a.useEffect(()=>()=>{r.current=!1},[]);var[n,o]=a.a.useState(!1);return a.a.useEffect(()=>{if(t){var n=(e=>{switch(e){case"ExpressionPivotHeader":return l.a.ExpressionFromExampleTokenPickerExpressionHeaderCoachmark;case"EntryPointOptionItem":return l.a.ExpressionFromExampleTokenPickerEntryPointCoachmark;default:throw new Error("Unknown location ".concat(e))}})(t);e.isDoNotShowAgain(n).then(t=>{r.current&&(o(!t),t||e.markDoNotShowAgain(n))})}},[e,t]),n}var y={headline:{padding:0},subText:{p:{padding:0}},footer:{justifyContent:"flex-start"}}},20367:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={LegacyTokenPicker:"LegacyTokenPicker",ExpressionEditor:"ExpressionEditor"}},20368:function(e,t,r){"use strict";function n(e,t){for(var r=t;null!=r;){if(r===e)return!0;r=r.parentElement}return!1}r.d(t,"a",(function(){return n}))},20369:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return c}));var n=r(20163),o=r(20354),i={OpenDynamicContentPicker:"open-dynamic-content-picker",OpenExpressionEditor:"open-expression-picker",DebugEditorState:"debug-editor-state"},a={[i.OpenDynamicContentPicker]:e=>Object(o.f)(e.nativeEvent),[i.OpenExpressionEditor]:e=>Object(o.e)(e.nativeEvent),[i.DebugEditorState]:e=>Object(o.d)(e.nativeEvent)};function c(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{for(var r,o=0;o<t.length;o++){var i=t[o];if(a[i](e))return i}return null!==(r=Object(n.getDefaultKeyBinding)(e))&&void 0!==r?r:""}}},20370:function(e,t,r){"use strict";r.d(t,"b",(function(){return O})),r.d(t,"a",(function(){return w}));var n=r(20163),o=r(11766),i=r(12706),a=r(12811),c=r(20371),s=r(20369),l=r(20162),u=r(20372);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=e=>Object(u.b)(e,"public-DraftEditor-content"),w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(d,e);var t,r,u,p=v(d);function d(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=p.call(this,e))._editorRef=o.createRef(),t.getClassNames=Object(i.a)(),t.classNames=t.getClassNames(c.a),t._keyCommandHandlers=void 0,t._handleKeyCommand=e=>{var r=t._keyCommandHandlers[e];if(r){var n=r(t.props.editorState);if(e===s.a.OpenDynamicContentPicker||e===s.a.OpenExpressionEditor)return"handled";if(n)return t.props.onChange(n),"handled"}return"not-handled"},t._handleLeftArrow=()=>{var e=Object(l.p)(t.props.editorState);e&&t.props.onChange(e)},t._handleRightArrow=()=>{var e=Object(l.q)(t.props.editorState);e&&t.props.onChange(e)};var r={"split-block":l.r,backspace:l.n,delete:l.o};return t._keyCommandHandlers=f(f({},r),e.keyHandlers),t}return t=d,(r=[{key:"render",value:function(){var{ariaLabel:e,className:t,editorState:r,keyBindingFn:i,onBlur:c,onChange:s,onCut:l,onCopy:u,onFocus:p,onPaste:f,readOnly:d,summary:m,tooltip:b}=this.props,y=Object(a.a)(this.classNames.root,t,{disabled:!!d});return o.createElement("div",{ref:this.props.htmlRef,"data-automation-id":"designer_textControl_".concat(b||m),className:y,title:b||m,onCopy:u,onCut:l},o.createElement(n.Editor,{ref:this._editorRef,ariaLabel:e,editorState:r,placeholder:m,stripPastedStyles:!0,onLeftArrow:this._handleLeftArrow,onRightArrow:this._handleRightArrow,handleKeyCommand:this._handleKeyCommand,handlePastedText:f,keyBindingFn:i,readOnly:d,onBlur:c,onChange:s,onFocus:p}))}},{key:"focus",value:function(){this._editorRef.current&&this._editorRef.current.focus()}}])&&m(t.prototype,r),u&&m(t,u),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.Component)},20371:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({root:["fl-TextControl",{selectors:{"&.disabled":{backgroundColor:Object(n.Y)().palette.neutralLighter}}}]})},20372:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n=(e,t)=>{var r=a(e),n=document.getElementsByClassName(t);return!!n&&!!n.length&&n[0].contains(r)},o=(e,t,r)=>{var n=document.getElementsByClassName(t);if(n&&n.length)for(var o=0;o<n.length;o++)if(i(e,n[o],r))return!0;return!1},i=(e,t,r)=>{if(!t)return!1;var n=a(e),o=t.contains(n),i=t.contains(e.target);if(r){if("focus"===e.type&&i)return!0;if("blur"===e.type&&o)return!0}else if(o||i)return!0;return!1},a=e=>e.relatedTarget||document.activeElement},20373:function(e,t,r){"use strict";r.d(t,"b",(function(){return j})),r.d(t,"a",(function(){return k}));var n=r(11766),o=r(20313),i=r(17244),a=r(20374),c=r(12706),s=r(12811),l=r(12754),u=r(20375),p=r(13272),f=r(12812),d=r(12854),m=r(19713),b=r(20154),y=r(20372);function v(){return(v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=P(e);if(t){var o=P(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e){return Object(y.b)(e,i.a.UIClassNames.EditorInputToken,!0)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(C,e);var t,r,y,O=E(C);function C(){var e;h(this,C);for(var t=arguments.length,r=new Array(t),b=0;b<t;b++)r[b]=arguments[b];return(e=O.call(this,...r)).getClassNames=Object(c.a)(),e.classNames=void 0,e.isInvalid=void 0,e.valueSegment=void 0,e._editorContext=Object(m.a)(),e.renderEditorInputTokenLegacy=()=>{var{readOnly:t}=e.props,r="function"==typeof t?t():t;return n.createElement(a.a,v({},e.props,{readOnly:r}))},e.renderEditorInputToken=()=>{var{contentState:t,entityKey:r,tokenRef:a}=e.props,c=t.getEntity(r),l=c&&c.getData();return e.valueSegment=l&&l.expression,e.isInvalid=Object(o.n)(e.valueSegment),e.classNames=e.getClassNames(u.a,{valueSegment:e.valueSegment}),e.valueSegment?n.createElement("span",{ref:a,className:Object(s.a)({[e.classNames.invalidExpression]:e.isInvalid,[e.classNames.rootSelected]:e.props.isSelected},e.classNames.root),contentEditable:!1,tabIndex:0,onClick:e.handleSelect},i.a.UIConstants.ZeroWidthChar,e.renderTokenIcon(),e.renderTokenText(),e.renderTokenDeleteButton(),i.a.UIConstants.ZeroWidthChar):null},e.renderTokenText=()=>{var{children:t,getTokenDataForDisplay:r}=e.props,o=e.valueSegment,i=r?r(o):t,a=o.tokenExpression;return n.createElement("div",{className:e.classNames.tokenText,title:a},i)},e.renderTokenIcon=()=>{var t=e.valueSegment;if(Object(o.q)(t)&&t.token){var r,i,a,{token:c}=t,{icon:l}=c;return c&&c.tokenType===o.a.FX?(a=e.classNames.expressionIcon,e.isInvalid?(a=Object(s.a)(a,e.classNames.invalidExpression),r=p.a.Error2):(a=e.classNames.imageIcon,i={src:l})):(a=e.classNames.imageIcon,i={src:l}),n.createElement(f.a,{className:a,iconName:r,imageProps:i})}return null},e.renderTokenDeleteButton=()=>{var{readOnly:t}=e.props,r="function"==typeof t?t():t;return n.createElement(d.a,{"aria-label":e._editorContext.globalResources.Common.Delete,className:e.classNames.deleteButton,disabled:r,iconProps:{iconName:p.a.Close,styles:{root:{fontSize:l.k.small}}},title:e._editorContext.globalResources.Common.Delete,onClick:e.handleDeleteClick,onKeyDownCapture:e.handleOnKeyDown})},e.handleDeleteClick=t=>{var{onDelete:r}=e.props;if(r){t.stopPropagation();var{entityKey:n}=e.props;r({currentTarget:S(e),inputKey:n})}},e.handleSelect=t=>{var{onSelect:r}=e.props;if(r){t.stopPropagation();var{entityKey:n}=e.props;r({currentTarget:S(e),inputKey:n})}},e.handleOnKeyDown=t=>{if(13===t.keyCode||32===t.keyCode){var{onDelete:r}=e.props;if(r){t.stopPropagation();var{entityKey:n}=e.props;r({currentTarget:S(e),inputKey:n})}}},e}return t=C,(r=[{key:"render",value:function(){return Object(b.b)(b.a.designerNewExpressionEditor)?this.renderEditorInputToken():this.renderEditorInputTokenLegacy()}}])&&g(t.prototype,r),y&&g(t,y),Object.defineProperty(t,"prototype",{writable:!1}),C}(n.Component),k=n.forwardRef((e,t)=>{var r,{entityKey:o,tokenRefMap:i}=e;t&&"object"==typeof t?r=t:(r=n.createRef(),"function"==typeof t&&t(r.current));var a=i?i.get(o):r;return n.createElement(T,v({tokenRef:a},e))})},20374:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(11766),o=r(20313),i=r(17244),a=r(18886),c=r(19713);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(b,e);var t,r,u,d=f(b);function b(){var e;s(this,b);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=d.call(this,...r))._editorContext=Object(c.a)(),e._renderTokenDeleteButton=t=>{var{readOnly:r}=e.props;return r?null:n.createElement("button",{title:e._editorContext.globalResources.Common.Delete,"aria-label":t?"".concat(e._editorContext.globalResources.Common.Delete," ").concat(t):e._editorContext.globalResources.Common.Delete,className:"msla-button msla-input-control-token-expression-delete",onClick:e._handleDeleteClick},i.a.UIConstants.DeleteChar)},e._handleDeleteClick=t=>{t.stopPropagation();var{onDelete:r}=e.props;if(r){var{entityKey:n}=e.props;r({currentTarget:m(e),inputKey:n})}},e._handleSelect=t=>{var{onSelect:r}=e.props;if(r){t.stopPropagation();var{entityKey:n}=e.props;r({currentTarget:m(e),inputKey:n})}},e}return t=b,(r=[{key:"render",value:function(){var e,t,{contentState:r,entityKey:c,children:s,tokenRef:l,getTokenDataForDisplay:u}=this.props,p=r.getEntity(c),f=p&&p.getData(),d=f&&f.expression,m=u?u(d):s,b={};if(Object(o.q)(d)){var{token:y,tokenExpression:v}=d,{brandColor:h,icon:g}=y;e=v,b={backgroundColor:h?Object(a.a)(h,i.a.UIConstants.HeaderAndTokenOpacity):i.a.UIConstants.DefaultBrandColor,backgroundImage:'url("'.concat(g,'")')},t=y.title}return n.createElement("span",{ref:l,className:"msla-editor-input-token-wrapper",contentEditable:!1},n.createElement("span",{className:"msla-editor-input-token msla-token",contentEditable:!1,style:b,title:e,onClick:this._handleSelect},n.createElement("span",null,n.createElement("span",{"data-text":"true"},m)),this._renderTokenDeleteButton(t)))}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),b}(n.Component)},20375:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(12754),o=r(14962),i=r(18886),a=r(17244),c=e=>{var t,r=Object(n.Y)().palette,c=null!==(t=e.valueSegment.token)&&void 0!==t&&t.brandColor?e.valueSegment.token.brandColor:a.a.UIConstants.DefaultBrandColor,s=Object(i.a)(c,a.a.UIConstants.HeaderAndTokenOpacity);return{root:[a.a.UIClassNames.EditorInputToken,{alignItems:"center",backgroundColor:s,boxShadow:o.n,cursor:"pointer",display:"inline-flex",height:24,margin:2}],imageIcon:["fl-Designer-EditorInputToken-ImageIcon",{height:24,width:24,selectors:{img:{height:24,width:24}}}],expressionIcon:["fl-Designer-EditorInputToken-ExpressionIcon",{height:24,width:24,alignItems:"center",backgroundColor:r.themePrimary,display:"flex",fontSize:n.k.medium,justifyContent:"center",color:r.white}],deleteButton:[a.a.UIClassNames.TokenDeleteButton,{color:r.neutralSecondary,height:24,width:20,padding:0,":hover":{backgroundColor:c,color:r.neutralLight},i:{fontSize:10}}],invalidExpression:["fl-Designer-EditorInputToken--invalid",{color:r.redDark,selectors:{".fl-Designer-EditorInputToken-ExpressionIcon":{backgroundColor:r.neutralLight}}}],rootSelected:[{borderRadius:2,outline:"2px solid #000"}],tokenText:["fl-Designer-EditorInputToken-TokenText",{padding:"0 8px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",fontSize:n.k.small,maxWidth:"90px"}],tooltipHost:["fl-Designer-EditorInpuToken-TooltipHost",{display:"flex",alignItems:"center"}]}}},20376:function(e,t,r){"use strict";r.d(t,"c",(function(){return M})),r.d(t,"b",(function(){return B})),r.d(t,"a",(function(){return U}));var n=r(12940),o=r(12821),i=r(12754),a=r(12706),c=r(12811),s=r(12330),l=r(12074),u=r.n(l),p=r(11766),f=r(20353),d=r(13259),m=r(14346),b=r(19968),y=r(20377),v=r(13272),h=r(13085),g=r(20154),O=r(20378),w=r(20372),E=r(19713),C=r(17244),S=r(20380),P=r(20383),j=r(20385),T=r(20396);function k(){return(k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){return(t=D(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D(n.key),n)}}function D(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function I(e,t){return(I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=L(e);if(t){var o=L(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return F(this,r)}}function F(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=e=>Object(w.b)(e,C.a.UIClassNames.TokenCallout,!0),B=e=>Object(w.b)(e,"ms-ContextualMenu-container",!0),U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(R,e);var t,r,l,w=A(R);function R(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,R),(t=w.call(this,e)).getClassNames=Object(a.a)(),t.calloutBoundsPadding=8,t.classNames=t.getClassNames(T.a,t.props),t.editorContext=Object(E.a)(),t.calloutBounds=void 0,t.cardBounds=void 0,t.calloutMaxHeight=void 0,t.directionalHint=void 0,t.formulaFromExamplesExpressionEditorButton=void 0,t.isFeedbackPanelCorrelationId=void 0,t.isVerticallyNarrowCallout=!1,t.dirtyExpressionValue=void 0,t.calculateCalloutMaxWidth=u()(e=>Math.min(e.width,C.a.UIConstants.TokenCalloutMaxWidth)),t.generateTitleBarTabs=()=>{var{activeSelectedSegmentInfo:e,formulaFromExamplesRef:r,onCancel:n,onExpressionSave:o,onTokenSelect:i,parameterService:a,showCloseXButton:c,tokenService:s}=t.props,l=t.getFormulaFromExamplesIconButtonProps(),u=t.getFeedbackButtonProps(),f=c?{title:t.editorContext.globalResources.Common.Close,iconName:v.a.Cancel,onClick:n}:null;return[{key:"dynamic",icons:[{title:t.editorContext.globalResources.Common.LearnMore,iconName:v.a.Help,onClick:()=>window.open("https://aka.ms/powerautomatedynamiccontent",m.b.blank)},u,...f?[f]:[]],onClick:e=>{t.setState({preventDismissOnLostFocus:!1},()=>t.onTabClick(e))},render:()=>p.createElement(P.a,{handleTokenSelection:i,parameterService:a,tokenService:s}),text:t.editorContext.designerResources.Designer.Editors.DynamicContentPicker.Title},{action:t.getFormulaFromExamplesActionButtonProps(),key:"expression",icons:[...l?[l]:[],{title:t.editorContext.designerResources.Designer.Editors.ExpressionEditor.LinkText,iconName:v.a.Function,onClick:()=>window.open("https://aka.ms/powerautomateexpressions",m.b.blank)},u,...f?[f]:[]],onClick:e=>{t.setState({preventDismissOnLostFocus:!1},()=>t.onTabClick(e))},render:()=>p.createElement(j.a,{actionButtonElement:t.state.$expressionActionButtonElement,activeSelectedSegmentInfo:e,calloutMaxHeight:t.calloutMaxHeight,dirtyExpressionValue:t.dirtyExpressionValue,formulaFromExamplesController:(null==r?void 0:r.current)||void 0,isVerticallyNarrow:t.isVerticallyNarrowCallout,onExpressionCancel:n,onExpressionChange:t.onExpressionChange,onExpressionSave:o,onRegisterFormulaFromExamplesButton:e=>{t.formulaFromExamplesExpressionEditorButton=e,t.setState({titleBarTabs:t.generateTitleBarTabs()})},onSetPreventDismissOnLostFocus:(e,r)=>{t.setState({preventDismissOnLostFocus:e},r)},parameterService:a,tokenService:s}),text:t.editorContext.designerResources.Designer.Editors.ExpressionEditor.Title}]},t.getFormulaFromExamplesActionButtonProps=()=>{if(!(window.innerWidth<i.s))return t.formulaFromExamplesExpressionEditorButton},t.getFormulaFromExamplesIconButtonProps=()=>{if(window.innerWidth<i.s&&t.formulaFromExamplesExpressionEditorButton)return x(x({},t.formulaFromExamplesExpressionEditorButton),{},{marginWidth:0,title:t.formulaFromExamplesExpressionEditorButton.text})},t.hasTargetElement=()=>!!t.props.targetElement,t.onTabClick=e=>t.setState({selectedTokenMode:e.key}),t.FEEDBACK_SURVEY_ID="v4j5cvGGr0GRqy180BHbR_ESGp89z0FMl_8yYlcmCK5UM0dVWjFWQlJNU0RJODdaQ1pXWFNLUkg2Ri4u",t.openFeedbackPanel=()=>{t.setState({isFeedbackPanelOpen:!0}),t.isFeedbackPanelCorrelationId=t.editorContext.loggingService.profileStart(h.a.TokenPickerV2FeedbackPanel)},t.onFeedbackPanelDismiss=()=>{t.editorContext.loggingService.profileEndWithSuccess(t.isFeedbackPanelCorrelationId,h.a.TokenPickerV2FeedbackPanel),t.setState({isFeedbackPanelOpen:!1}),t.props.onCancel()},t.onExpressionChange=e=>{t.dirtyExpressionValue=e};var r=t.generateTitleBarTabs();return t.state={$expressionActionButtonElement:null,preventDismissOnLostFocus:!1,selectedTokenMode:e.activeSelectedSegmentInfo?"expression":e.defaultTokenCalloutMode||r[0].key,searchText:void 0,titleBarTabs:r,isFeedbackPanelOpen:!1},t.initializeCalloutBounds(),t}return t=R,(r=[{key:"maxHeight",get:function(){return this.calloutMaxHeight-C.a.UIConstants.TokenCalloutTitleHeight}},{key:"preventDismissOnLostFocus",get:function(){return this.state.preventDismissOnLostFocus}},{key:"render",value:function(){return Object(g.b)(g.a.designerNewTokenPickerV2Feedback)&&this.state.isFeedbackPanelOpen?this.renderSurveyPanel():this.renderCallout()}},{key:"renderCallout",value:function(){var{calloutProps:e,targetElement:t}=this.props,r=this.calculateCalloutMaxWidth(this.calloutBounds),o=Math.min(this.cardBounds.width,r);return this.hasTargetElement()?p.createElement(n.a,k({bounds:this.calloutBounds,calloutMaxHeight:this.calloutMaxHeight,calloutMaxWidth:r,calloutMinWidth:o,className:Object(c.a)(this.classNames.root,C.a.UIClassNames.TokenPickerDismissible),contentEditable:!1,coverTarget:!1,directionalHint:this.directionalHint,doNotLayer:!0,isBeakVisible:!0,onBlur:t=>{var r;this.state.preventDismissOnLostFocus||null==e||null===(r=e.onBlur)||void 0===r||r.call(e,t)},preventDismissOnLostFocus:this.state.preventDismissOnLostFocus,preventDismissOnScroll:!0,setInitialFocus:!1,target:t},e),this.renderTitle(),this.renderTabContent()):null}},{key:"renderSurveyPanel",value:function(){return p.createElement(y.a,{isOpen:this.state.isFeedbackPanelOpen,onDismiss:this.onFeedbackPanelDismiss,surveyId:this.FEEDBACK_SURVEY_ID,clientResources:this.editorContext.flowServiceClientResources,environmentStore:this.editorContext.environmentStore,sessionStore:this.editorContext.sessionStore})}},{key:"renderTabContent",value:function(){var{selectedTokenMode:e,titleBarTabs:t}=this.state;return(t.find(t=>t.key===e)||t[0]).render()}},{key:"renderTitle",value:function(){var{selectedTokenMode:e,titleBarTabs:t}=this.state,r=t.find(t=>t.key===e)||t[0];return p.createElement("div",{className:this.classNames.titleContainer},p.createElement(b.a,{containerClassName:this.classNames.pageTabsContainer,selectedTabKey:r.key,setInitialFocus:!1,tabs:t}),r.action&&p.createElement(f.a,k({},r.action,{className:this.classNames.actionButton})),r.icons.map(e=>{var t;return p.createElement(d.a,k({},e,{key:"TokenCallout.tabIcon.".concat(null!==(t=e.uniqueId)&&void 0!==t?t:e.title)}))}))}},{key:"initializeCalloutBounds",value:function(){var e,t,r;if(this.hasTargetElement()){var n=this.props.targetElement;this.cardBounds=Object(S.a)(n);var i=Object(S.b)(),a=this.calloutBoundsPadding,c=null!==(e=i.bottom)&&void 0!==e?e:i.top+i.height,s=null!==(t=i.right)&&void 0!==t?t:i.left+i.width;this.calloutBounds={bottom:c-this.calloutBoundsPadding,top:i.top+this.calloutBoundsPadding,height:i.height-a,left:this.cardBounds.left+this.calloutBoundsPadding,right:s-this.calloutBoundsPadding,width:this.cardBounds.width-a};var l=n.getBoundingClientRect(),u=l.top-this.calloutBounds.top-a,p=c-(null!==(r=l.bottom)&&void 0!==r?r:l.top+l.height)-a,f=Math.max(u,p);this.directionalHint=u>p?o.a.topAutoEdge:o.a.bottomAutoEdge,this.calloutMaxHeight=Math.min(C.a.UIConstants.TokenCalloutMaxHeight,f),this.isVerticallyNarrowCallout=f<T.b}}},{key:"componentDidMount",value:function(){if(this.editorContext.featureFlags.enableTestExpressions){var e=this.editorContext.loggingService.performanceNow(),t=O.a.getTriggerOutputsURI();Object(s.a)(t)?this.editorContext.loggingService.logWarning("tokenCallout.componentDidMount.TestExpressionsFeature","triggerOutputsURI is not defined"):this.editorContext.flowRunsService.getTriggerOutputs({uri:t}).then(r=>{O.a.setTriggerOutputs(r.data.body);var n=O.a.getTriggerOutputs();Object(s.a)(n)?this.editorContext.loggingService.logError("tokenCallout.componentDidMount.TestExpressionsFeature",new Error("No trigger outputs from call to getTriggerOutputsURI API"),{runsAPIFetchDuration:this.editorContext.loggingService.performanceNow()-e,storedTriggerOutputsURI:t}):this.editorContext.loggingService.logInfo("tokenCallout.componentDidMount.TestExpressionsFeature","Successful call to getTriggerOutputsURI API",{storedTriggerOutputsURI:t,numberOfTriggerOutputs:Object.keys(n).length,runsAPIFetchDuration:this.editorContext.loggingService.performanceNow()-e})}).catch(e=>{this.editorContext.loggingService.logError("tokenCallout.componentDidMount.TestExpressionsFeature",e)})}}},{key:"componentWillUnmount",value:function(){this.setState({$expressionActionButtonElement:null})}},{key:"getFeedbackButtonProps",value:function(){return{title:this.editorContext.designerResources.Designer.TokenPicker.GiveFeedbackButtonText,iconName:v.a.Emoji2,onClick:this.openFeedbackPanel}}}])&&_(t.prototype,r),l&&_(t,l),Object.defineProperty(t,"prototype",{writable:!1}),R}(p.Component)},20377:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(11766),o=r(20008),i=r(14947),a=r(14906),c=r(11795),s=r(12375),l=e=>{var{environmentStore:t,sessionStore:r}=e;return n.createElement(o.a,{isOpen:e.isOpen,onDismiss:e.onDismiss,surveyId:e.surveyId,getUserContext:()=>{var e,n,o,i;return{UserId:null!==(e=null===(n=r.minimalUserInfo)||void 0===n?void 0:n.uniqueId)&&void 0!==e?e:"",TenantId:null!==(o=null===(i=r.minimalUserInfo)||void 0===i?void 0:i.tenantId)&&void 0!==o?o:"",SessionId:r.sessionId,Location:Object(c.h)().location,Region:Object(c.h)().region,EnvironmentId:t.currentEnvironmentName,locale:Object(s.a)()}},title:e.clientResources.Designer.FeedbackPanel.FeedbackPanelTitle,closeButtonAriaLabel:e.clientResources.Common.Close,size:Object(a.a)()?i.b.custom:i.b.small,customWidth:"400px"})}},20378:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(20379).a)},20379:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(12330);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastRun=void 0,this.trigger=void 0,this.actions=void 0}var t,r,i;return t=e,(r=[{key:"setLastRun",value:function(e){Object(n.a)(this.lastRun)&&(this.lastRun={}),this.lastRun=e}},{key:"setTriggerOutputsURI",value:function(e){Object(n.a)(this.trigger)&&(this.trigger={}),this.trigger.outputsURI=e}},{key:"setTriggerOutputs",value:function(e){Object(n.a)(this.trigger)&&(this.trigger={}),Object(n.a)(this.trigger.outputValues)&&(this.trigger.outputValues={}),this.trigger.outputValues=e}},{key:"setActions",value:function(e,t,r,o){Object(n.a)(this.actions)&&(this.actions={});for(var i=0;i<e.length;i++){var a={};a.outputsURI=t[i],a.outputValues={},a.outputValues[r[i]]=o[i],this.actions[e[i]]=a}}},{key:"getAction",value:function(e){if(!Object(n.a)(this.actions))return this.actions[e]}},{key:"getTriggerOutputsURI",value:function(){if(!Object(n.a)(this.trigger)&&void 0!==this.trigger.outputsURI)return this.trigger.outputsURI}},{key:"getTriggerOutputs",value:function(){var e,t;if(!Object(n.a)(null===(e=this.trigger)||void 0===e?void 0:e.outputValues))return null===(t=this.trigger)||void 0===t?void 0:t.outputValues}},{key:"getLastRun",value:function(){if(!Object(n.a)(this.lastRun))return this.lastRun}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20380:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c}));var n=r(17244),o=r(20381),i=r(20382);function a(e){return(Object(i.a)(e,e=>e instanceof HTMLElement&&e.classList.contains(n.a.UIClassNames.Card))||document.getElementsByClassName(n.a.UIClassNames.Card)[0]||document.getElementsByClassName(o.b)[0]||document.getElementsByTagName("body")[0]).getBoundingClientRect()}function c(){var e=(document.getElementsByClassName("flow-designer-container")[0]||document.getElementsByClassName(o.b)[0]||document.getElementsByTagName("body")[0]).getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}},20381:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n=function(e){return e[e.fromTemplateDefinition=0]="fromTemplateDefinition",e[e.fromTemplateName=1]="fromTemplateName",e}({}),o="fl-FlowCreatorSurface"},20382:function(e,t,r){"use strict";function n(e,t){for(var r=e;r&&r!==document;r=r.parentNode)if(t(r))return r;return null}r.d(t,"a",(function(){return n}))},20383:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(12839),i=r(20384);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(f,e);var t,r,c,u=l(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=u.call(this,e)).async=new o.a(p(t)),t.state={maxHeight:void 0,searchText:void 0},t}return t=f,(r=[{key:"render",value:function(){var{handleTokenSelection:e,parameterService:t,tokenService:r}=this.props;return n.createElement(i.a,{maxHeight:this.state.maxHeight,parameterService:t,tokenService:r,handleTokenSelection:e,isExpressionEditor:!1})}},{key:"componentWillUnmount",value:function(){this.async.dispose()}}])&&a(t.prototype,r),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20384:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(11766),o=r(19713),i=r(20330),a=r(20334),c=r(20332);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(f,e);var t,r,s,u=m(f);function f(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=u.call(this,e)).tokenChangedSubscription=void 0,t.resources=void 0,t.filterAndSortTokens=(e,r)=>{var n,o=t.props.parameterService.getParameterInfo(),i={parameterType:o.type,parameterFormat:null===(n=o.info)||void 0===n?void 0:n.format,searchText:r,tokenPickerMode:a.a.TOKEN,tokens:e},c=Object(a.d)(l({isExpandedList:!1,isExpressionEditor:t.props.isExpressionEditor},i)),s=Object(a.d)(l({isExpandedList:!0,isExpressionEditor:t.props.isExpressionEditor},i));return{initialTokens:!c.length&&s.length?s:c,allTokens:s}},t.handleSelect=e=>{var{token:r}=e,n=t.props.tokenService;t.props.handleTokenSelection(l({segment:n._createTokenValueSegment(r)},e))};var r=Object(o.a)().designerResources.ExpressionFromExamples.DynamicContentPanel;return t.resources={SearchPlaceholder:r.SearchBoxResources.SearchPlaceholder,SearchEmptyResultsTitle:r.SearchBoxResources.SearchEmptyResultsTitle,SearchEmptyResultsDetails:r.SearchBoxResources.SearchEmptyResultsDetails,NoDynamicValuesTitle:r.NoDynamicValuesTitle,NoDynamicValuesDetails:r.NoDynamicValuesDetails},i.a.setTokenGroupDefinitions(t.props.tokenService.getTokenGroupDefinitions()),t}return t=f,(r=[{key:"render",value:function(){var{hideSearch:e,maxHeight:t,onSearchEscape:r}=this.props;return n.createElement(c.a,{filterAndSortTokens:this.filterAndSortTokens,onTokenSelected:this.handleSelect,hideSearch:e,maxHeight:t,resources:this.resources,onSearchEscape:r})}},{key:"componentDidMount",value:function(){this.tokenChangedSubscription=this.props.tokenService.onTokenGroupDefinitionsChanged(()=>{i.a.setTokenGroupDefinitions(this.props.tokenService.getTokenGroupDefinitions())})}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.tokenChangedSubscription)||void 0===e||e.unsubscribe()}}])&&p(t.prototype,r),s&&p(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20385:function(e,t,r){"use strict";r.d(t,"a",(function(){return N}));var n=r(13275),o=r(12961),i=r(12706),a=r(12839),c=r(12811),s=r(11766),l=r(20057),u=r(20386),p=r(20155),f=r(19713),d=r(17244),m=r(20388),b=r(20384),y=r(20389),v=r(20391),h=r(20392),g=r(20336),O=r(13259),w=r(13272),E=r(20394);function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function P(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=x(e);if(t){var o=x(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return k(this,r)}}function k(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(k,e);var t,r,d,P=T(k);function k(e){var t,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,k),(t=P.call(this,e)).getClassNames=Object(i.a)(),t.async=new a.a(R(t)),t.classNames=t.getClassNames(v.a),t.editorContext=Object(f.a)(),t.editorRef=s.createRef(),t.tokenSections=void 0,t.onFormulaFromExamplesOptionClicked=()=>{var{formulaFromExamplesController:e,parameterService:r}=t.props;if(e){var n=r.getParameterInfo(),o={displayName:n.name,schema:{format:n.info.format,type:n.type}};t.props.onSetPreventDismissOnLostFocus(!0,()=>{e.initializeAndOpen({parameter:o,onApply:r=>{var{expression:n}=r;e.close(),t.replaceExpressionAndFocus(n)},onCancel:()=>{e.close(),t.focusEditor()}})})}},t.renderActionButtons=()=>s.createElement(n.a,{className:t.classNames.actionButtons,horizontal:!0,verticalAlign:"center"},s.createElement(n.a.Item,null,s.createElement(o.a,{ariaLabel:t.editorContext.designerResources.Common.Save,onClick:()=>{t.props.onSetPreventDismissOnLostFocus(!1,()=>{t.props.onExpressionSave(t.state.expression),t.replaceExpression("")})},primary:!0},t.editorContext.designerResources.Common.Save)),s.createElement(n.a.Item,null,s.createElement(o.a,{ariaLabel:t.editorContext.designerResources.Common.Cancel,onClick:()=>{t.props.onSetPreventDismissOnLostFocus(!1,()=>{t.props.onExpressionCancel()})}},t.editorContext.designerResources.Common.Cancel))),t.onChange=e=>{t.setState({expression:e}),t.props.onExpressionChange(e)},t.focusEditor=()=>{t.editorRef.current&&t.editorRef.current.focus()},t.generateTokenSections=()=>{var e;return t.isVerticallyNarrow()&&(e={iconName:w.a.Search,onClick:()=>t.setState({forceSearchShown:!t.state.forceSearchShown}),title:t.editorContext.designerResources.Designer.Editors.DynamicContent.SearchPlaceholder}),[{icons:[],iconName:w.a.Function,itemKey:g.b.Functions,text:t.editorContext.designerResources.Designer.Editors.ExpressionEditor.FormulasTabTitle,onClick:()=>t.onClickTokenSection(g.b.Functions),render:t.renderFunctionList},{icons:e?[e]:[],iconName:w.a.DynamicContent,itemKey:g.b.Dynamic,onClick:()=>t.onClickTokenSection(g.b.Dynamic),render:t.renderDynamicContentList,text:t.editorContext.designerResources.Designer.Editors.ExpressionEditor.DynamicValuesTabTitle}]},t.getCurrentSection=()=>{var{selectedTokenSectionKey:e}=t.state;return t.tokenSections.find(t=>t.itemKey===e)||t.tokenSections[0]},t.handleTokenSelection=e=>{var{segment:r}=e;r.tokenExpression&&t.insertExpressionAndFocus(r.tokenExpression)},t.handleFunctionTokenSelection=e=>{var r;t.insertExpressionAndFocus(e.token.operationTitle+"()"),null===(r=t.editorRef.current)||void 0===r||r.moveCursor(-1)},t.isVerticallyNarrow=()=>t.props.isVerticallyNarrow||!1,t.onClickTokenSection=e=>{t.setState({selectedTokenSectionKey:e})},t.registerTemplateFunctions=e=>{Object(m.a)(t.props.tokenService.getFunctionGroupDefinitions(),t.editorContext.designerResources,e)},t.renderDynamicContentList=()=>{var{forceSearchShown:e}=t.state,{parameterService:r,tokenService:n}=t.props,o=!e&&t.isVerticallyNarrow();return s.createElement(b.a,{autoFocusSearch:!1,handleTokenSelection:t.handleTokenSelection,hideSearch:o,parameterService:r,tokenService:n,isExpressionEditor:!0})},t.renderFunctionList=()=>s.createElement(y.a,{parameterService:t.props.parameterService,tokenService:t.props.tokenService,handleTokenSelection:t.handleFunctionTokenSelection}),t.renderTokenSectionContent=()=>{var e=t.getCurrentSection();return s.createElement("div",{className:t.classNames.tokenSectionTabContent},e.render())},t.renderTokenSectionHeader=()=>{var e=t.getCurrentSection();return s.createElement("div",{className:t.classNames.tokenSectionTabContainer},s.createElement(E.a,{className:t.classNames.tokenSections,items:t.tokenSections,selectedItemKey:t.state.selectedTokenSectionKey}),e.icons.map(e=>{var t;return s.createElement(O.a,C({},e,{key:"ExpressionEditor.sectionHeader.".concat(null!==(t=e.uniqueId)&&void 0!==t?t:e.title)}))}))},r=e.dirtyExpressionValue?e.dirtyExpressionValue:e.activeSelectedSegmentInfo?e.activeSelectedSegmentInfo.value:"",t.tokenSections=t.generateTokenSections(),t.state={dynamicContentIsExpanded:!0,expression:r,forceSearchShown:!1,selectedTokenSectionKey:t.tokenSections[0].itemKey},t}return t=k,(r=[{key:"render",value:function(){return s.createElement("div",{className:Object(c.a)({[this.classNames.root]:!0,[this.classNames.rootNarrow]:this.isVerticallyNarrow()})},s.createElement(l.a,{className:this.classNames.textBoxContainer,editorDidMount:this.focusEditor,editorWillMount:this.registerTemplateFunctions,loggingService:this.editorContext.loggingService,onChange:this.onChange,options:k.monacoEditorOptions,ref:this.editorRef,value:this.state.expression,width:"100%",dataLoadingFailureTelemetryEventNamePrefix:"ExpressionEditor"}),s.createElement(h.a,{expressionText:this.state.expression}),this.renderActionButtons(),this.renderTokenSectionHeader(),this.renderTokenSectionContent())}},{key:"componentDidMount",value:function(){var e,t;Object(p.a)()&&(null===(e=(t=this.props).onRegisterFormulaFromExamplesButton)||void 0===e||e.call(t,u.a({onFormulaFromExamplesButtonClicked:this.onFormulaFromExamplesOptionClicked,loggingService:this.editorContext.loggingService,resources:this.editorContext.designerResources.ExpressionFromExamples.TokenPicker,ref:void 0})))}},{key:"componentWillUnmount",value:function(){this.async.dispose()}},{key:"insertExpressionAndFocus",value:function(e){this.editorRef.current&&(this.editorRef.current.insertText(e),this.focusEditor())}},{key:"replaceExpression",value:function(e){this.editorRef.current&&(this.editorRef.current.replaceText(e),this.focusEditor())}},{key:"replaceExpressionAndFocus",value:function(e){this.editorRef.current&&(this.replaceExpression(e),this.focusEditor())}}])&&S(t.prototype,r),d&&S(t,d),Object.defineProperty(t,"prototype",{writable:!1}),k}(s.Component);N.monacoEditorOptions={automaticLayout:!0,fontSize:13,language:d.a.WorkflowLanguageName,lineNumbers:"off",overviewRulerBorder:!1,scrollBeyondLastLine:!1,wordWrap:"on"}},20386:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(12706),o=(r(11766),r(13272)),i=r(13240),a=r(20387),c=(r(20366),r(20367));function s(e){var{onFormulaFromExamplesButtonClicked:t,loggingService:r,resources:s,ref:l}=e,u=Object(n.a)()(a.a);return{text:s.itemTitle,iconName:o.a.EditStyle,elementRef:l,onClick:()=>{r.logInfo(i.c.EasyAutomationDataReshapingEntryPointClicked,"",{source:c.a.ExpressionEditor}),t()},styles:u}}},20387:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var{palette:e}=Object(n.Y)();return{root:[{marginRight:12,padding:0}],rootHovered:[{color:e.themeDarker,".ms-Button-label":{textDecoration:"underline"}}],icon:[{margin:"0 2px"}],iconHovered:[{color:e.themeDarker}],label:[{marginRight:0}]}}},20388:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(17244),o=r(18965),i=r(20318),a="function-name",c="keywords",s="number-literal",l="string-literal",u=["null","true","false"],p=!1;function f(e,t,r){if(!p){var f=n.a.WorkflowLanguageName,m=function(e){var t=[];for(var r of e)t.push(...r.functions);return t}(e);r.languages.register({id:f}),r.languages.registerCompletionItemProvider(f,function(e,t){return{triggerCharacters:["."],provideCompletionItems:()=>({suggestions:e.map(e=>{var{name:r,description:n,signatures:o}=e,i=o.every(e=>0===e.parameters.length);return{label:r,kind:t.languages.CompletionItemKind.Function,insertText:i?"".concat(r,"()"):r,documentation:n,range:void 0}})})}}(m,r)),r.languages.registerCompletionItemProvider(f,function(e){return{provideCompletionItems:()=>({suggestions:u.map(t=>({label:t,kind:e.languages.CompletionItemKind.Value,insertText:t,range:void 0}))})}}(r)),r.languages.registerSignatureHelpProvider(f,function(e,t){return{signatureHelpTriggerCharacters:[",","("],provideSignatureHelp(r,n){var a=function(e,t,r,n){var a,c,s=new i.a(e,n,{doNotPrefetch:!0}),l=[];try{for(a=c=s.getNextToken();null!==c&&c.type!==i.b.EndOfData;){var{type:u,startPosition:p,endPosition:f}=c;if(t>=p&&t<f)break;u===i.b.LeftParenthesis?a.type===i.b.Identifier&&l.push({name:a.value,argumentsCovered:0}):u===i.b.Comma?l[l.length-1].argumentsCovered+=1:u===i.b.RightParenthesis&&l.pop(),a=c,c=s.getNextToken()}}catch(v){}if(!l.length)return null;var d=c.type===i.b.RightParenthesis&&a.type===i.b.LeftParenthesis,{name:m,argumentsCovered:b}=l.pop(),y=Object(o.c)(r,m);if(!y)return null;return{templateFunction:y,argumentsCovered:b,hasEmptyArgument:d}}(r.getValue(),n.column-1,e,t);return a?function(e){for(var t,r,{templateFunction:n,argumentsCovered:i,hasEmptyArgument:a}=e,c=n.signatures.filter(e=>!d(e)),s=n.signatures.filter(d),l=e=>({label:e.definition,documentation:e.documentation,parameters:e.parameters.map(e=>({label:e.name,documentation:e.documentation}))}),u=n.signatures.map(l),p=0;p<c.length;p++){var f=c[p].parameters.length;if(a&&0===f||f>0&&f>i){t=p,r=i;break}}if(void 0!==t&&void 0!==r)return{dispose(){},value:{signatures:u,activeSignature:t,activeParameter:r}};if(1===s.length){var m=c.map(l),b=function(e,t,r){for(var n=r+1,i=t.parameters.filter(e=>!e.isVariable),a=Object(o.a)(e=>e.isVariable,t.parameters),{name:c,documentation:s,type:l}=a,u=i.map(e=>({label:e.name,documentation:e.documentation})),p=[],f="".concat(e,"(").concat(i.map(e=>"".concat(e.name,": ").concat(e.type)).join(", ")),d=u.length+1,m=d;m<=n;m++){for(var b="".concat(f,", "),y=[],v=d;v<=m;v++){var h="".concat(c,"_").concat(v);b+="".concat(h,": ").concat(l),b+=v!==m?", ":")",y.push({label:h,documentation:s})}p.push({label:b,documentation:t.documentation,parameters:[...u,...y]})}return p}(n.name,s[0],i),y=[...m,...b];return{dispose(){},value:{signatures:y,activeSignature:y.length-1,activeParameter:i}}}return null}(a):null}}}(Object(o.d)(m,"name"),t)),r.languages.setMonarchTokensProvider(f,function(e){var t=u.map(e=>({regex:e,action:{token:c}})),r=e.map(e=>({regex:e.name,action:{token:a}}));r.push({regex:"\\(",action:{token:a}}),r.push({regex:"\\)",action:{token:a}});var n={regex:/'[^']*'/g,action:{token:l}},o=[{regex:/\d*\.\d+([eE][\-+]?\d+)?/,action:{token:s}},{regex:/\d+/,action:{token:s}}];return{tokenizer:{root:[...t,...r,...o,n]},tokenPostfix:"",ignoreCase:!0}}(m)),r.languages.setLanguageConfiguration(f,{autoClosingPairs:[{open:"(",close:")"},{open:"[",close:"]"},{open:"'",close:"'"}]}),p=!0}}function d(e){return e.parameters.some(e=>!!e.isVariable)}},20389:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r(20334),i=r(20336),a=r(12706),c=r(12754),s=r(20390),l=r(20312),u=r(19713);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(v,e);var t,r,d,y=b(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=y.call(this,e)).functionDefinitions=t.props.tokenService.getFunctionGroupDefinitions(),t.editorContext=Object(u.a)(),t.getClassNames=Object(a.a)(),t.state={collapsedStateMap:Object(l.Map)()},t}return t=v,(r=[{key:"render",value:function(){var e=this.getAllFunctionTokenGroupProps(),t=this.props.maxHeight,r=this.getClassNames(s.a,{maxHeight:t});return n.createElement("div",{className:r.root},e.map(e=>n.createElement(i.a,p({},e,{key:e.title}))))}},{key:"getAllFunctionTokenGroupProps",value:function(){return this.functionDefinitions.map(e=>this.getTokenGroupProps(e.name,e.functions))}},{key:"getTokenGroupProps",value:function(e,t){var r=t.map(e=>this.getFunctionToken(e.defaultSignature,e.description,e.name,e.isAdvanced));return{brandColor:Object(c.Y)().palette.neutralLighter,title:e,handleTokenSelection:this.props.handleTokenSelection,initialTokens:this.getFilteredTokens(r,"",!1),allTokens:this.getFilteredTokens(r,"",!0),collapsed:this.state.collapsedStateMap.get(e,!1),onToggleCollapse:()=>this.onToggleCollapse(e),tokenGroupType:i.b.Functions}}},{key:"getFunctionToken",value:function(e,t,r,n){return{brandColor:"",iconUri:this.editorContext.assetService.fxIcon,title:e,description:t,operationTitle:r,data:n?{visibility:o.b.Advanced}:void 0}}},{key:"getFilteredTokens",value:function(e,t,r){var n=this.props.parameterService.getParameterInfo(),i={parameterType:n.info.format,parameterFormat:n.type,searchText:t,tokenPickerMode:o.a.EXPRESSION,tokens:e,isExpandedList:r};return Object(o.c)(i)}},{key:"onToggleCollapse",value:function(e){var t=this.state.collapsedStateMap.update(e,!0,e=>!e);this.setState({collapsedStateMap:t})}}])&&f(t.prototype,r),d&&f(t,d),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component)},20390:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>{var t=Object(n.Y)(),{palette:r}=t;return{root:["fl-ExpressionModeFunctionList",{borderTop:"1px solid ".concat(r.neutralTertiaryAlt),display:"flex",flexDirection:"column",flexGrow:1,maxHeight:e.maxHeight,minHeight:0,overflowY:"auto"}]}}},20391:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(17244),i=()=>{var{palette:e}=Object(n.Y)();return{root:["fl-ExpressionEditor",{display:"flex",flexDirection:"column",minHeight:0,".monaco-editor":{maxHeight:150,minHeight:48}}],rootNarrow:["fl-ExpressionEditorNarrow",{".fl-Designer-TokenGroup-Header":{height:40}}],textBoxContainer:[{flex:1,minHeight:48}],dynamicValueTitle:["fl-ExpressionEditor-dynamicValueTitle",{color:e.neutralPrimary,flexGrow:1,paddingLeft:16,fontWeight:n.l.semibold}],dynamicValueIcon:["fl-ExpressionEditor-dynamicValueIcon",{margin:"0 17px"}],actionButtons:["fl-ExpressionEditor-actionButtons",{gap:8,justifyContent:"end",padding:12}],tokenSectionTabContainer:[{borderTop:"".concat(1,"px solid ").concat(e.neutralLight),display:"flex",minHeight:o.a.UIConstants.TokenCalloutTitleHeight,padding:"0 16px",".ms-Button":{height:o.a.UIConstants.TokenCalloutTitleHeight-1}}],tokenSectionTabContent:[{display:"flex",flex:3,flexDirection:"column",minHeight:0}],tokenSections:["fl-ExpressionEditor-tokenSections",{alignItems:"center",display:"flex",height:o.a.UIConstants.TokenCalloutTitleHeight,width:"initial"}]}}},20392:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(20393),i=r(12706),a=r(12999);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=p.call(this,e)).getClassNames=Object(i.a)(),t.classNames=t.getClassNames(o.a),t}return t=f,(r=[{key:"render",value:function(){var{expressionText:e}=this.props;return Object(a.a)().enableTestExpressions&&e?n.createElement("div",{className:this.classNames.testExpressionsBox},n.createElement("div",null,e)):null}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20393:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({root:[],testExpressionsBox:["fl-TestExpressionsBox",{padding:"10px",height:"48px",backgroundColor:Object(n.Y)().palette.neutralLighter,display:"flex",alignItems:"center"}]})},20394:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(12872),o=r(12866),i=r(12706),a=r(12811),c=r(12804),s=r(11766),l=r(14680),u=r(20395);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function m(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){y(r,e);var t=h(r);function r(){var e;f(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call(this,...o)).getClassNames=Object(i.a)(),e.selectedTabRef=s.createRef(),e}return m(r,[{key:"render",value:function(){var{automationId:e,itemKey:t,iconName:r,isSelected:n,onClick:o,text:i}=this.props,c=this.getClassNames(u.a),p=n||!1;return s.createElement("div",{ref:p?this.selectedTabRef:void 0},s.createElement(l.a,{"aria-selected":p,className:Object(a.a)({[c.item]:!0,[c.selectedItem]:p}),"data-automation-is-selected":p,dataAutomationId:e,iconName:r,key:t,onClick:()=>null==o?void 0:o(this.props),role:"tab",text:i}))}}]),r}(s.Component),E=function(e){y(r,e);var t=h(r);function r(){var e;f(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call(this,...o)).getClassNames=Object(i.a)(),e.selectedTabRef=s.createRef(),e.renderItem=t=>{var{selectedItemKey:r}=e.props;return s.createElement(w,p({},t,{key:t.itemKey,isSelected:t.itemKey===r}))},e}return m(r,[{key:"render",value:function(){var{items:e}=this.props;if(!e.length)return null;var t=this.getClassNames(u.a);return s.createElement(n.a,{className:t.root,direction:o.a.horizontal},e.map(this.renderItem))}},{key:"componentDidMount",value:function(){!1!==this.props.setInitialFocus&&setTimeout(()=>this.setFocusOnSelectedItem())}},{key:"setFocusOnSelectedItem",value:function(){if(this.selectedTabRef.current){var e=Object(c.e)(this.selectedTabRef.current,this.selectedTabRef.current,!0);null==e||e.focus()}}}]),r}(s.Component)},20395:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)(),{palette:t}=e;return{root:["fl-Pills",{alignItems:"center",display:"flex",gap:8,width:"100%",".ms-Button":{borderRadius:16,height:32,padding:"0 12px"}}],item:["fl-Pills-item",{backgroundColor:t.neutralLight,border:"1px solid ".concat(t.neutralQuaternary),color:t.black,minWidth:"auto",textAlign:"left",".ms-Button-label":{fontWeight:"inherit"},":hover":{backgroundColor:t.themePrimary,borderColor:t.themePrimary,color:t.white},":active":{backgroundColor:t.themeDark,borderColor:t.themeDark,color:t.white},":focus":{borderColor:t.themeDark}}],selectedItem:["fl-Pills-selectedItem",{backgroundColor:t.themePrimary,borderColor:t.themePrimary,color:t.white,fontWeight:n.l.semibold}]}}},20396:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r(12754),o=r(17244),i=420,a=e=>{var t,r=Object(n.Y)();return{root:[o.a.UIClassNames.TokenCallout,{border:0,minHeight:o.a.UIConstants.TokenCalloutMinHeight,zIndex:999,".ms-Callout-main":{display:"flex",flexDirection:"column",maxHeight:"inherit !important",minHeight:"inherit !important",overflow:null!==(t=e.calloutProps)&&void 0!==t&&t.hideOverflow?void 0:"visible"}}],titleContainer:["fl-Designer-TokenCallout-TitleContainer",{alignItems:"center",borderBottom:"".concat(1,"px solid ").concat(r.palette.neutralLight),display:"flex",height:o.a.UIConstants.TokenCalloutTitleHeight,padding:"0 12px",".ms-Button":{height:o.a.UIConstants.TokenCalloutTitleHeight-1},".ms-TooltipHost":{marginRight:0}}],titleIcon:["fl-Designer-TokenCallout-TitleIcon",{color:r.palette.neutralPrimaryAlt}],actionButton:{color:r.palette.themePrimary},pageTabsContainer:{flex:1}}}},20397:function(e,t,r){"use strict";r.d(t,"c",(function(){return w})),r.d(t,"b",(function(){return E})),r.d(t,"a",(function(){return C}));var n=r(14965),o=r(12706),i=r(12811),a=r(11766),c=r(13259),s=r(13272),l=r(20154),u=r(20372),p=r(19713),f=r(17244),d=r(20398);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=e=>Object(u.b)(e,f.a.UIClassNames.TokenMenubar,!0),E=e=>Object(u.b)(e,f.a.UIClassNames.TokenMenubarButtonGroup),C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(y,e);var t,r,u,f=h(y);function y(){var e;m(this,y);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=f.call(this,...r)).getClassNames=Object(o.a)(),e.classNames=e.getClassNames(d.a),e.editorContext=Object(p.a)(),e}return t=y,(r=[{key:"render",value:function(){var{children:e,disableTokenPickerActions:t,isFloatingPosition:r,onAddDynamicContentClick:o,onAddExpressionClick:u,onBlur:p}=this.props,{designerHostContextStore:f,designerResources:d}=this.editorContext,m=f.getContext(),b=!!o,y=Object(l.b)(l.a.designerNewTokenPickerV2)&&!m.isDiet&&!!u;return b||y||e?a.createElement("div",{className:Object(i.a)({[this.classNames.root]:!0,[this.classNames.rootFloating]:r})},a.createElement("div",{className:this.classNames.buttonGroup},b?a.createElement(c.a,{ariaLabel:d.Designer.Editors.AddContent,disabled:t,iconName:s.a.DynamicContent,onBlur:e=>null==p?void 0:p(e),onClick:o,title:d.Designer.Editors.DynamicContent.AddContentTooltip}):null,b||y?a.createElement(n.a,{vertical:!0,className:this.classNames.separator}):null,y&&a.createElement(c.a,{ariaLabel:d.Designer.Editors.AddExpression,disabled:t,iconName:s.a.Function,onBlur:e=>null==p?void 0:p(e),onClick:u,title:d.Designer.Editors.DynamicContent.AddExpressionTooltip}),e&&(b||y)?a.createElement(n.a,{vertical:!0,className:this.classNames.separator}):null,e)):null}}])&&b(t.prototype,r),u&&b(t,u),Object.defineProperty(t,"prototype",{writable:!1}),y}(a.Component)},20398:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(12754),o=r(14962),i=r(17244),a=()=>{var e=Object(n.Y)().palette,t=e.white,r=e.themePrimary;return{root:[i.a.UIClassNames.TokenMenubar,{marginTop:-36,height:32,display:"flex",flexDirection:"row",justifyContent:"flex-end",marginBottom:4}],rootFloating:[{bottom:"100%",margin:"0 0 4px",position:"absolute",right:0}],buttonGroup:[i.a.UIClassNames.TokenMenubarButtonGroup,{height:32,display:"flex",flexDirection:"row",justifyContent:"flex-end",backgroundColor:r,verticalAlign:"center",boxShadow:o.n,zIndex:99,color:t,selectors:{button:{color:t,backgroundColor:r,borderRadius:0,paddingTop:8,paddingBottom:8,height:"100%",width:"100%"},".button-checked":{backgroundColor:e.themeDark},"button:hover":{color:t,backgroundColor:e.themeDark}}}],separator:[i.a.UIClassNames.TokenMenubarSeparator,{display:"inline-flex",height:24,backgroundColor:r,padding:0,marginTop:4}]}}},20399:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(20376);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(){return a(this,f),p.apply(this,arguments)}return t=f,(r=[{key:"render",value:function(){var{attachTokenPickerTo:e,calloutRef:t}=this.props;if(!e)return null;var r="current"in e?e.current:e;return r?n.createElement(o.a,i({ref:t,targetElement:r},this.props)):null}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20400:function(e,t,r){"use strict";r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return b}));var n=r(11766),o=r(20372),i=r(17244),a=r(20321);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=e=>Object(o.b)(e,i.a.UIClassNames.LegacyTokenPicker),b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(i,e);var t,r,n,o=p(i);function i(){return c(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"shouldComponentUpdate",value:function(e){var{activeSelectedSegmentInfo:t,visible:r}=this.props;return r!==e.visible||!(!t&&!e.activeSelectedSegmentInfo||t&&e.activeSelectedSegmentInfo&&t.id===e.activeSelectedSegmentInfo.id&&t.value===e.activeSelectedSegmentInfo.value)}},{key:"render",value:function(){var{activeSelectedSegmentInfo:e,displayInline:t,displayMode:r,parameterContext:n,tokenModeFilter:o,tokenService:i,handleTokenSelection:a,handleTokenPickerOKClicked:c,visible:s,getCustomTokenPickerSections:l,renderCoachmark:u}=this.props;return s?i.getTokenPicker(t,n,!0,a,c,e,r,o,u,l):null}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.Component);b.defaultProps={displayMode:a.b.EXPRESSION}},20401:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(12754);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=()=>{var e=Object(n.Y)();return{root:["fl-DefaultEditor-root",{position:"relative"}],textElement:["fl-DefaultEditor",{}],focusWithin:["fl-DefaultEditor-focusWithin",{"&:focus-within":{border:"2px solid "+e.palette.themePrimary}}],useNewInputControl:["fl-DefaultEditor-useNew",{"&.msla-text-editor, .public-DraftEditorPlaceholder-root":i({},e.fonts.medium)}]}}},20403:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-DictionaryCodeEditor",{width:"100%"}]})},20404:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(20405),i=r(17266);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(){var e;a(this,f);for(var t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return(e=p.call(this,...r))._ref=n.createRef(),e.renderItem=(t,r,a)=>{var{key:c,value:s}=t.data;if(!c)throw new i.a(void 0,"Unexpected: key segments should not be null in dictionary editor");return n.createElement(o.a,{key:t.id,countRows:r,editorContext:e.props.editorContext,editorOptions:e.props.editorOptions,isLastItem:t.id===a,keyItem:c,readOnly:e.props.readOnly,valueItem:s,addItem:e.props.addItem,onChangeKey:t.updateKey,onChangeValue:t.updateValue,onDelete:t.delete})},e}return t=f,(r=[{key:"render",value:function(){var e=this.props.items,t=e&&e.length?e[e.length-1].id:"",r=[];for(var o of e)r.push(this.renderItem(o,e.length,t));return n.createElement("div",{ref:this._ref},r)}},{key:"focus",value:function(){this._ref.current&&this._ref.current.focus()}},{key:"scrollIntoView",value:function(){this._ref.current&&this._ref.current.scrollIntoView()}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20405:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r(20406),i=r(12706),a=r(12811),c=r(20407),s=r(20408),l=r(13259),u=r(13272),p=r(19713);function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(v,e);var t,r,d,y=b(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=y.call(this,e)).getClassNames=Object(i.a)(),t.classNames=t.getClassNames(c.a),t._editorContext=Object(p.a)(),t.handleOnFocus=()=>{!t.props.isLastItem||Object(o.f)(t.state.currentKey)&&Object(o.f)(t.state.currentValue)||t.props.addItem()},t.handleChangeKey=e=>{t.setState({currentKey:e},()=>t.props.onChangeKey(e))},t.handleChangeValue=e=>{t.setState({currentValue:e},()=>t.props.onChangeValue(e))},t.state={currentKey:t.props.keyItem.value,currentValue:t.props.valueItem.value},t}return t=v,(r=[{key:"render",value:function(){var e,t,{editorContext:r,editorOptions:o,keyItem:i,valueItem:c,readOnly:p}=this.props,f=this.props.countRows>1&&!this.props.isLastItem;return n.createElement("div",{className:Object(a.a)(this.classNames.root,f?null:this.classNames.noButton),onFocus:this.handleOnFocus},n.createElement(s.a,{key:i.id,editorContext:r,item:i.value,locale:null!==(e=o.locale)&&void 0!==e?e:"",readOnly:p,summary:this._editorContext.designerResources.DictionaryEditor.EnterKey,onChange:this.handleChangeKey}),n.createElement(s.a,{key:c.id,editorContext:r,item:c.value,locale:null!==(t=o.locale)&&void 0!==t?t:"",readOnly:p,summary:this._editorContext.designerResources.DictionaryEditor.EnterValue,onChange:this.handleChangeValue}),f&&n.createElement(l.a,{className:Object(a.a)(this.classNames.deleteButton),iconName:u.a.Delete,title:this._editorContext.designerResources.DictionaryEditor.DeleteRowButton,ariaLabel:this._editorContext.designerResources.DictionaryEditor.DeleteRowButton,onClick:this.props.onDelete}))}}])&&f(t.prototype,r),d&&f(t,d),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component)},20406:function(e,t,r){"use strict";r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"e",(function(){return s})),r.d(t,"a",(function(){return l})),r.d(t,"f",(function(){return u}));var n=r(13223),o=r(20313);function i(e){return e&&e[0]&&e[0].type&&e[0].type===o.b.LITERAL?e[0].tokenExpression:void 0}function a(e){return e&&e[0]&&e[0].type&&e[0].type===o.b.ENUM?e[0].tokenExpression:void 0}function c(e){return e&&e[0]&&e[0].token&&e[0].token.title&&e[0].type&&e[0].type===o.b.ENUM?e[0].token.title:""}function s(e){return[{type:o.b.LITERAL,tokenExpression:e,tokenKey:Object(n.a)()}]}function l(e,t){return e.filter(e=>e.type===o.b.LITERAL||e.type===o.b.NEW_LINE).map(e=>e.type===o.b.NEW_LINE?t||"\n":e.tokenExpression).join("")}function u(e){return!e||!e.length||!e.some(e=>Object(o.q)(e))&&0===l(e).length}},20407:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-DictionaryRow",{display:"flex"}],noButton:["fl-DictionaryRowNoButton",{width:"calc(100% - 32px)"}],deleteButton:["fl-DictionaryRowDelBtn",{width:32}]})},20408:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(11769),i=r.n(o),a=r(20326),c=r(12706),s=r(12811),l=r(20409),u=r(20400);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(y,e);var t,r,o,d=b(y);function y(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=d.call(this,e)).getClassNames=Object(c.a)(),t.classNames=t.getClassNames(l.a),t._onFocus=e=>{t.setState({isFocused:!0})},t._onBlur=e=>{var r=i.a.findDOMNode(v(t)),n=e.relatedTarget instanceof Node&&(null==r?void 0:r.contains(e.relatedTarget));Object(u.b)(e)||n||t.setState({isFocused:!1})};var{item:r}=t.props;return t.state={editorState:{value:r},isFocused:!1},t}return t=y,(r=[{key:"render",value:function(){var{editorContext:e,item:t,locale:r,onChange:o,readOnly:i,summary:c}=this.props,l={editorState:{value:t},editorOptions:{displayName:null,hideLabel:!0,locale:r,readonly:i,showTokenPicker:this.state.isFocused,validationErrors:[],summary:c},editorContext:e,onChange:e=>{o(e.value)},ignoreWrapperComponent:!0};return n.createElement("div",{className:Object(s.a)(this.classNames.root)},n.createElement(a.a,p({onBlur:this._onBlur,onFocus:this._onFocus,className:this.classNames.cell},l)))}}])&&f(t.prototype,r),o&&f(t,o),Object.defineProperty(t,"prototype",{writable:!1}),y}(n.Component)},20409:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["fl-DictionaryCell",{width:"100%",marginTop:"-1px",marginLeft:"-1px",border:"1px solid #989898",wordBreak:"break-all"}],cell:["fl-DictionaryCellDefaultEditor",{width:"100%",selectors:{".msla-label":{width:130}}}]})},20410:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-DictionaryEditor",{paddingBottom:6,display:"flex",flexDirection:"row-reverse"}],editor:["fl-DictionaryEditor-editor",{flexGrow:"1"}]})},20411:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a}));var n=r(20313);function o(e){for(var t=[Object(n.f)("{\n")],r=0;r<e.length;++r){var o,i=e[r],c=null===(o=i.data.key)||void 0===o?void 0:o.value,s=i.data.value.value;t.push(Object(n.f)('    "')),null==c||c.forEach(e=>t.push(e)),t.push(Object(n.f)('": ')),a(s)?s.forEach(e=>t.push(e)):(t.push(Object(n.f)('"')),s.forEach(e=>t.push(e)),t.push(Object(n.f)('"')));var l=r!==e.length-1?",":"";t.push(Object(n.f)("".concat(l,"\n")))}return t.push(Object(n.f)("}")),t}function i(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;++r){var o,i,a=e[r].data,c=t[r].data;if(Object(n.c)(null===(o=a.key)||void 0===o?void 0:o.value,null===(i=c.key)||void 0===i?void 0:i.value)||Object(n.c)(a.value.value,c.value.value))return!0}return!1}function a(e){return 1===(null==e?void 0:e.length)&&e[0].type===n.b.TOKEN||3===(null==e?void 0:e.length)&&""===e[0].tokenExpression&&""===e[2].tokenExpression&&e[1].type===n.b.TOKEN}},20412:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(11766),o=r(20413),i=r(14947),a=r(17142),c=r(19713),s=r(13028);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(b,e);var t,r,p,m=d(b);function b(){var e;l(this,b);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=m.call(this,...r))._editorContext=Object(c.a)(),e.logErrorBoundaryError=(t,r,n)=>{(e._editorContext?e._editorContext:e.context).loggingService.logError(t,r,n)},e}return t=b,(r=[{key:"render",value:function(){var e=this._editorContext?this._editorContext:this.context;return n.createElement(a.a,{onError:this.logErrorBoundaryError,globalResources:"globalResources"in e?e.globalResources:Object(s.a)(),sharedComponentResources:"sharedComponentResources"in e?e.sharedComponentResources:e.clientResources},n.createElement("div",{className:"fl-EditorDialogLauncher"},n.createElement(o.a,{mode:this.props.buttonMode,parameterName:this.props.parameterName,readonly:this.props.readonly,onClick:this.props.onLaunchedButtonClick,editorType:this.props.editorType,designerContext:this.props.designerContext}),this.renderEditor()))}},{key:"renderEditor",value:function(){return n.createElement(i.a,{disableFocusTrap:!0,isOpen:this.props.isEditing,isBlocking:!1,isLoading:this.props.isContentLoading,onDismissed:this.props.onPanelClose,size:i.b.large,title:this.props.parameterName,className:"fl-EditorSidePanel"},this.props.children)}}])&&u(t.prototype,r),p&&u(t,p),Object.defineProperty(t,"prototype",{writable:!1}),b}(n.Component)},20413:function(e,t,r){"use strict";r.d(t,"c",(function(){return v})),r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return g}));var n=r(11766),o=r(14680),i=r(13031),a=r(13240),c=r(19713),s=r(12706),l=r(20414),u=r(19716);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){return e[e.GeoFence=0]="GeoFence",e[e.PowerQuery=1]="PowerQuery",e[e.AdaptiveCard=2]="AdaptiveCard",e}({}),h=function(e){return e[e.Create=0]="Create",e[e.Edit=1]="Edit",e}({});var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(b,e);var t,r,u,f=m(b);function b(e){var t,r,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(o=f.call(this,e)).buttonTexts=void 0,o._editorContext=Object(c.a)(),o.getClassNames=Object(s.a)(),o.classNames=o.getClassNames(l.a);var a=e.designerContext?e.designerContext:o._editorContext?o._editorContext:o.context,u=null===(t=a&&"designerResources"in a?null==a?void 0:a.designerResources:null==a?void 0:a.clientResources)||void 0===t?void 0:t.EditorDialogLauncher;return o.buttonTexts={[h.Create]:Object(i.a)(null!==(r=null==u?void 0:u.Create)&&void 0!==r?r:"Create Adaptive Card",o.props.parameterName),[h.Edit]:Object(i.a)(null!==(n=null==u?void 0:u.Edit)&&void 0!==n?n:"Edit Adaptive Card",o.props.parameterName)},o}return t=b,(r=[{key:"render",value:function(){var e,t,r,i=this.buttonTexts,c={name:(e=this.props.editorType,t=this.props.mode,r="".concat(v[e],"Editor").concat(h[t],"Clicked"),a.c[r]||a.c.EditorDialogLaunchButtonClicked)};return n.createElement("div",{className:this.classNames.root},n.createElement(o.a,{className:"fl-EditorDialogLaunchButton-button",disabled:this.props.readonly,primary:!0,text:i[this.props.mode],onClick:this.props.onClick,telemetryData:c}))}}])&&p(t.prototype,r),u&&p(t,u),Object.defineProperty(t,"prototype",{writable:!1}),b}(n.Component);g.contextType=u.a},20414:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(16817);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=()=>({root:["fl-EditorDialogLaunchButton",i(i(i({},Object(n.h)()),Object(n.g)("row")),{},{justifyContent:"center",selectors:{"&-button":i({},Object(n.f)("center"))}})]})},20415:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(20162),i=r(20157),a=r(11948),c=r.n(a),s=(r(20416),r(19713)),l=r(13085),u=r(13009),p=r(19716);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(v,e);var t,a,p,m=y(v);function v(){var e,t,o;f(this,v);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return(o=m.call(this,...a)).designerContainerRef=n.createRef(),o.markdownService=void 0,o.markdownItDisabledFeatures=["code","image"],o.editorContext=Object(s.a)(),o._editorContext=o.editorContext?o.editorContext:o.context,o.adaptiveCardEditorResources=null===(e="designerResources"in o._editorContext?o._editorContext.designerResources:o._editorContext.clientResources)||void 0===e?void 0:e.AdaptiveCardEditor,o.defaultAdaptiveCardResources=null===(t="designerResources"in o._editorContext?o._editorContext.designerResources:o._editorContext.clientResources)||void 0===t?void 0:t.Default.AdaptiveCard,o.getMarkdownIt=()=>o.markdownService?Promise.resolve(o.markdownService):Promise.resolve().then(r.t.bind(null,18189,7)).then(e=>{var t=c()(e)?e():e.default();return o.markdownService=t.disable(o.markdownItDisabledFeatures),o.markdownService}),o}return t=v,(a=[{key:"componentDidMount",value:function(){var e=this._editorContext.loggingService.profileStart(l.a.adaptiveCardEditorDependencyImport);Promise.all([r.e(265).then(r.t.bind(null,32906,7)),Promise.all([r.e(213),r.e(133)]).then(r.t.bind(null,32152,7))]).then(t=>{var[r,n]=t;this.getMarkdownIt().then(()=>{r.CardDesigner.onProcessMarkdown=(e,t)=>{t.outputHtml=this.markdownService.render(e),t.didProcess=!0}});var o=[new r.LightTeamsContainer("Microsoft Teams","containers/teams-container-light.css")],a=new r.CardDesigner(o),c=new r.ToolbarButton("saveCard",this.adaptiveCardEditorResources.saveCard,"",e=>{var t=a.getCard();t[i.b]=this.props.bindTokens?this.getTokens():{},this.props.onSave(JSON.stringify(t))});a.onCardValidated=(e,t)=>{c.isEnabled=!(t||[]).some(e=>2===e.phase&&0!==e.event&&2!==e.event)},c.separator=!0,a.toolbar.insertElementAfter(c,r.CardDesigner.ToolbarCommands.NewCard),r.GlobalSettings.enableDataBindingSupport=!0,r.GlobalSettings.showDataStructureToolbox=!1,r.GlobalSettings.showSampleDataEditorToolbox=!1,r.GlobalSettings.showTargetVersionMismatchWarning=!1;var s={valueType:"Object",fields:this.getTokensField()};a.dataStructure=r.FieldDefinition.parse(s),a.sampleCatalogueUrl=this._editorContext.cdnService.getCdnUrl("/static/AdaptiveCardSamples/catalogue.json"),this.designerContainerRef.current&&a.attachTo(this.designerContainerRef.current),a.treeViewToolbox.collapse(),a.jsonEditorToolbox.collapse(),a.monacoModuleLoaded(n),this.props.value!==i.c?a.setCard(this.getCard()):a.setCard({$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:this.defaultAdaptiveCardResources.TellUsAboutYourself,weight:"Bolder",size:"Medium"},{type:"TextBlock",text:this.defaultAdaptiveCardResources.DetailsForTrip,isSubtle:!0,wrap:!0},{type:"TextBlock",text:this.defaultAdaptiveCardResources.YourName,wrap:!0},{type:"Input.Text",id:"myName",placeholder:this.defaultAdaptiveCardResources.PlaceHolderName,spacing:"None"},{type:"TextBlock",text:this.defaultAdaptiveCardResources.YourEmail,wrap:!0},{type:"Input.Text",id:"myEmail",placeholder:this.defaultAdaptiveCardResources.PlaceHolderEmail,style:"Email",spacing:"None"},{type:"TextBlock",text:this.defaultAdaptiveCardResources.YourPhoneNumber},{type:"Input.Text",id:"myTel",placeholder:this.defaultAdaptiveCardResources.PlaceHolderPhoneNumber,style:"Tel",spacing:"None"}],actions:[{type:"Action.Submit",title:this.defaultAdaptiveCardResources.Submit}]});var u=document.getElementById("fluent-default-layer-host");u&&(u.style.zIndex="10000"),this._editorContext.loggingService.profileEndWithSuccess(e,l.a.adaptiveCardEditorDependencyImport)}).catch(t=>{this._editorContext.loggingService.profileEnd(e,l.a.adaptiveCardEditorDependencyImport,Object(u.y)(t),t,{dependencies:["adaptivecards-designer","monaco-editor"]}),this.props.onAdaptiveCardEditorReadyError(this.adaptiveCardEditorResources.errorOnLoad)})}},{key:"render",value:function(){return n.createElement("div",{ref:this.designerContainerRef})}},{key:"getTokensField",value:function(){var{dictionaryItems:e}=this.props,t=[];return e.forEach(e=>{if(e.data.key){var r=Object(o.j)(e.data.key.value);""!==r&&t.push({name:r,displayName:r,valueType:"String",sampleValue:r})}}),t}},{key:"getTokens",value:function(){var{dictionaryItems:e}=this.props;return e.reduce((e,t)=>{var r=t.data.key?Object(o.j)(t.data.key.value):"",n=t.data.key?Object(o.j)(t.data.value.value):"";return""===r||(e.hasOwnProperty(r)?this.props.onAdaptiveCardEditorReadyError(this.adaptiveCardEditorResources.errorDuplicateKeys):e[r]=n),e},{})}},{key:"getCard",value:function(){try{if(this.props.value){var e=JSON.parse(this.props.value);return delete e[i.b],e}return{}}catch(t){return this.props.onAdaptiveCardEditorReadyError(this.adaptiveCardEditorResources.errorJsonParsing),{}}}}])&&d(t.prototype,a),p&&d(t,p),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component);g.contextType=p.a},20419:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(11766),o=r(13223);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){return t=>{var r;return(r=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(d,r);var c,u,p,f=l(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=f.call(this,e))._wrappedComponentRef=void 0,t.onRef=e=>{t._wrappedComponentRef=e},t.state={key:Object(o.a)(),previousProps:{}},t}return c=d,p=[{key:"getDerivedStateFromProps",value:function(t,r){var{previousProps:n,key:i}=r;return{previousProps:t,key:e(t,n)?Object(o.a)():i}}}],(u=[{key:"render",value:function(){return n.createElement(t,i({key:this.state.key},this.props,{ref:this.onRef}))}},{key:"focus",value:function(){this._wrappedComponentRef.focus()}}])&&a(c.prototype,u),p&&a(c,p),Object.defineProperty(c,"prototype",{writable:!1}),d}(n.Component)).displayName="withShouldComponentRemount(".concat(t.displayName||t.name,")"),r}}},20420:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r(11766),o=r(15027),i=r(13259),a=r(13272),c=r(20421),s=r(12706),l=r(20419),u=r(20313),p=r(13178),f=r(19713);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(p,e);var t,r,l,u=g(p);function p(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e)).textFieldRef=void 0,t.getClassNames=Object(s.a)(),t.classNames=t.getClassNames(c.a),t._editorContext=Object(f.a)(),t.setTextFieldRef=e=>{e&&(t.textFieldRef=e)},t.onBlur=()=>{var{editorState:e,onChange:r}=t.props,{value:n}=e,o=[...n];o[0]=m(m({},n[0]),{},{tokenExpression:t.state.value}),r(m(m({},e),{},{value:o}))},t.onChange=(e,r)=>{r&&t.setState({value:r})},t.handleClick=()=>{var e=t.textFieldRef;e&&(e.focus(),e.value&&(e.setSelectionRange(0,e.value.length),document.execCommand("Copy")))};var{editorState:r}=t.props,n=(r.value.length&&r.value[0]||{tokenExpression:""}).tokenExpression;return n&&(t.state={value:n}),t}return t=p,(r=[{key:"render",value:function(){var e,t,r=null!==(e=this.props.editorOptions.displayName)&&void 0!==e?e:void 0,c=null!==(t=this.props.editorOptions.summary)&&void 0!==t?t:void 0;return n.createElement("div",{className:this.classNames.root},n.createElement(o.b,{componentRef:this.setTextFieldRef,ariaLabel:r,className:this.classNames.textField,label:r,placeholder:c,readOnly:!0,type:"text",value:this.state.value,onBlur:this.onBlur,onChange:this.onChange}),n.createElement(i.a,{disabled:Boolean(p.isClipboardSupported.value),iconName:a.a.Copy,title:this._editorContext.globalResources.Common.ClickToCopy,onClick:this.handleClick}))}}])&&y(t.prototype,r),l&&y(t,l),Object.defineProperty(t,"prototype",{writable:!1}),p}(n.Component);E.isClipboardSupported=new p.a(()=>{try{return document.queryCommandSupported&&!document.queryCommandSupported("Copy")}catch(e){return!0}});var C=Object(l.a)((e,t)=>!!t.editorState&&Object(u.c)(e.editorState.value,t.editorState.value))(E)},20421:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({root:["fl-CopyableEditor",{alignItems:"flex-end",display:"flex",whiteSpace:"nowrap"}],textField:["fl-CopyableEditor-textField",{overflow:"hidden",width:"calc(100% - 32px)",selectors:{input:{backgroundColor:Object(n.Y)().palette.neutralLight,textOverflow:"ellipsis",whiteSpace:"nowrap"}}}]})},20422:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(11766),o=r(17371),i=r(20323),a=r(20321),c=r(17244),s=r(20423),l=r(20424),u=r(20425),p=r(19713);function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(v,e);var t,r,d,b=g(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=b.call(this,e))._dropdown=null,t._dropdownContainer=null,t._multiselectDropdownRef=n.createRef(),t._parameterService=void 0,t._editorContext=Object(p.a)(),t.renderEditor=e=>{var{editorOptions:{options:r}}=t.props;return r&&r.multiselect?t._renderMultiselectDropdown(r,e):t._renderSimpleDropdown(e)},t._renderSimpleDropdown=e=>{var{editorOptions:{displayName:r,readonly:i,summary:a},editorState:c,onChange:s}=t.props,p=t.props.editorOptions.options||{},f=(null==e?void 0:e.useNewStyle)||p.useNewStyle,d=null==e?void 0:e.containerClassName,m=null==e?void 0:e.editorClassName,b=!!p.isLoading,{value:y}=c,v=1===y.length?y[0].tokenExpression:void 0,h=t._parameterService.getParameterInfo();if(!h.enumValues)throw new Error("DropdownEditor._renderSimpleDropdown: Invalid parameter for ".concat(r));var g=[];b||0===(g=h.enumValues.map(e=>({key:e.value,text:e.displayValue}))).length&&g.push(...t._getOptionsFromMetadataForSimpleDropdown());var O=Object(u.b)(g,v),w=f?void 0:l.b,E=b?t._editorContext.globalResources.Common.Loading:a;return n.createElement("div",{className:d,ref:t.setContainerRef},n.createElement(o.a,{className:m,componentRef:t.setDropdownRef,disabled:b||i,options:g,placeholder:E,selectedKey:null==O?void 0:O.key,styles:w,onChange:(e,r)=>{var n=null==r?void 0:r.key;t._onSimpleDropdownSelectionChanged(String(n),c,s)}}))},t._renderMultiselectDropdown=(e,r)=>{var{editorState:o,editorOptions:{readonly:i}}=t.props,{value:a}=o,l=1===a.length?a[0].tokenExpression:void 0,u=!1,p=[],{editorOptions:{summary:f}}=t.props,d=f,m=e.items;m&&0!==m.length||(m=t._getOptionsFromMetadataForMultiselect());var b=null==r?void 0:r.useNewStyle,y=null==r?void 0:r.containerClassName,v=null==r?void 0:r.editorClassName,h=t._parameterService.getParameterInfo();if(l)try{var g=h.type===c.a.Swagger.TYPE.STRING&&e.valueSeparator?l.split(e.valueSeparator):JSON.parse(l);Array.isArray(g)&&!g.some(e=>"string"!=typeof e&&"number"!=typeof e)?p=g:(u=!0,d=l)}catch(O){d=l,u=!0}return n.createElement("div",{className:y},n.createElement(s.a,{className:v,ref:t._multiselectDropdownRef,calloutMaxHeight:380,disabled:i||u,items:m,initSelectedValues:p,placeholder:d,titleSeparator:e.titleSeparator,onSelectionChanged:t._onMultiselectDropdownSelectionChanged,useNewStyle:b}))},t._onSimpleDropdownSelectionChanged=(e,t,r)=>{var{value:n}=t,o=[...n];o[0]=m(m({},n[0]),{},{tokenExpression:e}),r(m(m({},t),{},{value:o}))},t._onMultiselectDropdownSelectionChanged=e=>{var r,{editorState:n,onChange:o,editorOptions:{options:i,isRequired:a}}=t.props,{value:s}=n,l=t._parameterService.getParameterInfo(),u=[...s];if(!i)throw new Error("dropdownEditor._onMultiselectDropdownSelectionChanged: options is not expected to be empty for multiselect dropdown.");switch(l.type){case c.a.Swagger.TYPE.STRING:r=e.values.join(i.valueSeparator);break;case c.a.Swagger.TYPE.ARRAY:r=a||0!==e.values.length?r=JSON.stringify(e.values):"";break;default:r=JSON.stringify(e.values)}u[0]=m(m({},s[0]),{},{tokenExpression:r}),o(m(m({},n),{},{value:u}))},t._getOptionsFromMetadataForSimpleDropdown=()=>{var e;return null===(e=t.props.editorOptions.options.enumValuesFromMetadata)||void 0===e?void 0:e.map(e=>{var{displayValue:t,value:r}=e;return{key:r,text:t}})},t._getOptionsFromMetadataForMultiselect=()=>{var e;return null===(e=t.props.editorOptions.options.enumValuesFromMetadata)||void 0===e?void 0:e.map(e=>{var{displayValue:t,value:r}=e;return{title:t,value:r}})},t.setDropdownRef=e=>t._dropdown=e,t.setContainerRef=e=>t._dropdownContainer=e,t._parameterService=e.editorContext.getService(a.a.PARAMETER),t}return t=v,(r=[{key:"render",value:function(){var e,t;return n.createElement(i.a,f({},this.props,{labelTooltip:null===(e=this.props.editorOptions)||void 0===e||null===(e=e.options)||void 0===e?void 0:e.labelTooltip,required:null===(t=this.props.editorOptions)||void 0===t||null===(t=t.options)||void 0===t?void 0:t.required,onRenderEditor:this.renderEditor}))}},{key:"focus",value:function(){this._dropdown?this._dropdown.focus():this._multiselectDropdownRef.current&&this._multiselectDropdownRef.current.focus()}},{key:"scrollIntoView",value:function(e){this._dropdownContainer?this._dropdownContainer.scrollIntoView(e):this._multiselectDropdownRef.current&&this._multiselectDropdownRef.current.scrollIntoView(e)}}])&&y(t.prototype,r),d&&y(t,d),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component)},20423:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r(15700),i=r(15697),a=r(12811),c=r(15431),s=r(20424),l=r(19713);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){return e.DIVIDER="%divider%",e.SELECT_ALL="%select-all%",e}(v||{}),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(y,e);var t,r,p,m=d(y);function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=m.call(this,e))._dropdown=null,t._dropdownContainerRef=n.createRef(),t._editorContext=Object(l.a)(),t._handleFocus=e=>{e.stopPropagation();var r=t.props.onFocus;r&&r({currentTarget:b(t)})},t._onRenderTitle=e=>{var r="msla-multiselectdropdown-title-placeholder",{titleSeparator:o,useNewStyle:i}=t.props,{placeholder:c}=t.props,s=null==e?void 0:e.filter(e=>e.key!==v.SELECT_ALL);s&&s.length>0&&(c=s.map(e=>e.text).join(o),r="msla-multiselectdropdown-title-value");var l=Object(a.a)({[r]:!i,"msla-multiselectdropdown-title":!i});return n.createElement("div",{className:l},c)},t._onRenderPlaceholder=e=>{var r=null==e?void 0:e.placeholder,{useNewStyle:o}=t.props,i=Object(a.a)({"msla-multiselectdropdown-title":!o,"msla-multiselectdropdown-title-placeholder":!o});return n.createElement("div",{className:i},r)},t._onChange=(e,r)=>{if(r){var n,{items:o,onSelectionChanged:i}=t.props,{selectedKeys:a}=t.state;if(r.selected)r.key===v.SELECT_ALL?(n=o.map(e=>e.value.toString())).push(v.SELECT_ALL):((n=[...a]).push(r.key.toString()),n.length===o.length&&n.push(v.SELECT_ALL));else if(r.key===v.SELECT_ALL)n=[];else{var s=(n=[...a]).indexOf(r.key.toString());if(s>-1&&n.splice(s,1),n.length===o.length){var l=n.indexOf(v.SELECT_ALL);n.splice(l,1)}}var u=!Object(c.b)(n,a);i&&u&&i({currentTarget:b(t),values:n.filter(e=>e!==v.SELECT_ALL)}),t.setState({selectedKeys:n})}},t._convertPropsToDropdownOptions=e=>{var r=[],{items:n}=e;if(n&&n.length>0)for(var i of(r.push({key:v.SELECT_ALL,text:t._editorContext.globalResources.Common.SelectAll,itemType:o.a.Normal},{key:v.DIVIDER,text:"",itemType:o.a.Divider}),e.items))r.push({key:i.value.toString(),text:i.title,itemType:o.a.Normal});return r},t._getSelectedKeys=e=>{var t=[],{initSelectedValues:r,items:n}=e;if(r){var o=n.map(e=>e.value.toString());for(var i of r)o.indexOf(i.toString())>=0&&t.push(i.toString());t.length===n.length&&t.push(v.SELECT_ALL)}return t},t.setComponentRef=e=>t._dropdown=e,t.state={dropdownOptions:t._convertPropsToDropdownOptions(e),selectedKeys:t._getSelectedKeys(e)},t}return t=y,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){Object(c.f)(this.props.items,e.items,g)&&Object(c.b)(this.props.initSelectedValues,e.initSelectedValues)||this.setState({dropdownOptions:this._convertPropsToDropdownOptions(e),selectedKeys:this._getSelectedKeys(e)})}},{key:"focus",value:function(){this._dropdown&&this._dropdown.focus()}},{key:"scrollIntoView",value:function(e){this._dropdownContainerRef.current&&this._dropdownContainerRef.current.scrollIntoView(e)}},{key:"render",value:function(){var{calloutMaxHeight:e,className:t,disabled:r,id:o,placeholder:c,titleSeparator:l,useNewStyle:u}=this.props,{dropdownOptions:p,selectedKeys:f}=this.state,d=e?{calloutMaxHeight:e}:void 0,m=u?void 0:s.a,b=Object(a.a)({"msla-multiselectdropdown-container":!u});return n.createElement("div",{className:b,onFocus:this._handleFocus,id:o,ref:this._dropdownContainerRef},n.createElement(i.a,{className:t,componentRef:this.setComponentRef,calloutProps:d,disabled:r,multiSelect:!0,multiSelectDelimiter:l,options:p,placeholder:c,selectedKeys:f,styles:m,onChange:this._onChange,onRenderPlaceholder:this._onRenderPlaceholder,onRenderTitle:this._onRenderTitle}))}}])&&u(t.prototype,r),p&&u(t,p),Object.defineProperty(t,"prototype",{writable:!1}),y}(n.Component);function g(e,t){return e&&t?e.title===t.title&&e.value===t.value:e===t}h.defaultProps={disabled:!1,items:[],titleSeparator:","}},20424:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(12754),o={caretDown:{lineHeight:26},caretDownWrapper:{right:10},dropdown:{fontSize:n.k.small,marginBottom:0},dropdownOptionText:{fontSize:n.k.small},label:{fontSize:n.k.small},title:{fontSize:n.k.small,height:26,lineHeight:26,paddingLeft:12}},i={caretDown:{fontSize:n.k.icon,lineHeight:"24px",right:"10px"},dropdownOptionText:{fontSize:n.k.small},title:{border:"1px solid #989898",fontSize:n.k.small,height:"26px",lineHeight:"24px"}}},20425:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return d})),r.d(t,"h",(function(){return m})),r.d(t,"j",(function(){return b})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return g})),r.d(t,"k",(function(){return O})),r.d(t,"c",(function(){return w})),r.d(t,"i",(function(){return E})),r.d(t,"d",(function(){return C}));var n=r(11891),o=r(20426),i=r(17244),a=r(12364),c=r(20313),s=r(20314),l=r.n(s);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f="$CUSTOM_OPTION_KEY$";function d(e,t){var r;for(var o of e){if(o.key===t){r=o;break}Object(n.a)(String(o.key),t)&&(r=o)}return r}function m(e){var t=e.editorOptions&&e.editorOptions.dynamicData,r=e.dropdownProps&&e.dropdownProps.isLoading;return!!t&&t.status===o.a.STARTED||!!r}function b(e){var{schema:t}=e.editorOptions,r=t[i.a.Swagger.EXTENSION.DYNAMIC_VALUES];return!(!r||r.capability)||!(!t[i.a.Swagger.EXTENSION.ENUM_VALUES]&&!t.enum)}function y(e,t){var r,n,{editorOptions:o,dropdownProps:c}=e,s=[],l=!1;if(c&&c.options)n=c.options.map(e=>({displayName:e.text,value:e.key}));else if(o.dynamicData)n=o.dynamicData.values;else if(o.schema&&o.schema[i.a.Swagger.EXTENSION.ENUM_VALUES])n=o.schema[i.a.Swagger.EXTENSION.ENUM_VALUES];else{if(!o.schema||!o.schema.enum)throw new Error("Custom value dropdown options not supported for this editor!");n=o.schema.enum.map(e=>({displayName:"object"==typeof e?e.displayName:e.toString(),value:"object"==typeof e?e.value:e.toString()}))}return((null===(r=o.schema)||void 0===r?void 0:r.name)||"").includes("channelId")&&"/providers/Microsoft.PowerApps/apis/shared_teams"===(null==o?void 0:o.connectorId)&&(l=!0),n.forEach(e=>{var{displayName:r,value:n}=e,i=!0;t&&(Object(a.c)(r,t)||(i=!1)),i&&s.push({key:v(n),text:r,data:{description:l?null:n},disabled:o.readonly})}),s}function v(e){var t;if(null==e)t="";else{if("object"==typeof e)throw new TypeError("normalizeDropdownKeytoString: illegal conversion of object to a key");t="".concat(e)}return t}function h(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({customOption:void 0,customOptionValueSegment:void 0,dropdownOptions:void 0,error:void 0,isEditingCustomItem:!1,prevEditorStateValue:void 0,selectedKey:void 0,searchText:void 0,unfilteredDropdownOptions:void 0},e)}function g(e){var{editorState:{value:t}}=e;return Object(c.k)(t)?void 0:1===t.length?v(t[0].tokenExpression):f}function O(e){var{dropdownProps:t}=e,r=t&&t.options,n=t&&t.isLoading;return!!r||!!n}function w(e,t,r){var n=e.editorState.value,o=t.prevEditorStateValue;return(r&&r===f||O(e))&&(!t.customOptionValueSegment||o&&Object(c.c)(o,n))?n:t.customOptionValueSegment}function E(e,t,r,n){return!(!r||t||d(e,r)&&(r!==f||n))}function C(e,t){var r=e;if(!Object(c.j)(t)){var n=l()(t,e=>!!e.tokenExpression);n&&n.tokenExpression&&(r=n.tokenExpression)}return r}},20426:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e[e.STARTED=0]="STARTED",e[e.SUCCEEDED=1]="SUCCEEDED",e[e.FAILED=2]="FAILED",e}({})},20427:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11766),o=r(13016),i=r(16824),a=()=>n.createElement(i.a,{type:o.c.error,message:"This trigger is deprecated"})},20428:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(20429),i=r(13016),a=r(16824),c=r(20406),s=r(20413),l=r(20434),u=r(20437),p=r(12706),f=r(19713);function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(h,e);var t,r,m,v=y(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=v.call(this,e)).controlOptions=void 0,t.getClassNames=Object(p.a)(),t.classNames=t.getClassNames(u.a),t._editorContext=Object(f.a)(),t.saveValueFromMashupEditor=e=>{try{t.props.onChange({value:Object(c.e)(e)})}catch(r){return r instanceof Error&&t._editorContext.loggingService.logError("PowerQueryEditor.onChange",r),Promise.reject(r)}return t.setState({value:e,isEditing:!1,isMashupLoading:!1}),Promise.resolve({shouldEndFlow:!0})},t.acquireToken=e=>t._editorContext.tokenService.getAccessToken(e),t.onCancel=()=>new Promise((e,r)=>{t.setState({isEditing:!1,isMashupLoading:!1})}),t.open=()=>t.setState({isEditing:!0,isMashupLoading:!0}),t.state={value:Object(c.a)(t.props.editorState.value),isMashupLoading:!0,isEditing:!1},t.controlOptions={onReady:()=>t.setState({isMashupLoading:!1}),onReadyError:e=>{var r;t._editorContext.loggingService.logError(null!==(r=e.code)&&void 0!==r?r:"",e),t.setState({isMashupLoading:!1,mashupErrorMessage:e.message})},onCancel:t.onCancel,onCommit:t.saveValueFromMashupEditor,acquireToken:t.acquireToken},t}return t=h,(r=[{key:"render",value:function(){var{value:e,isEditing:t,isMashupLoading:r}=this.state;return n.createElement("div",{className:"fl-PowerQueryEditor"},n.createElement(l.a,{contentErrorMessage:this.state.mashupErrorMessage,buttonMode:e&&e.length>0?s.b.Edit:s.b.Create,dialogClassName:this.classNames.root,isContentLoading:r,parameterName:this._editorContext.designerResources.PowerQueryEditor.PowerQuery,readonly:this.props.editorOptions.readonly,isEditing:t,onDialogClose:this.onCancel,onLaunchedButtonClick:this.open,editorType:s.c.PowerQuery},this.renderError(),n.createElement(o.a,{editingSession:e,environmentName:this._editorContext.environmentStore.currentEnvironmentName,connectionId:this.props.editorOptions.connectionId,controlOptions:this.controlOptions,sessionId:this._editorContext.sessionStore.sessionId})))}},{key:"renderError",value:function(){var e=this.state.mashupErrorMessage;return e?n.createElement(a.a,{type:i.c.error,ariaLabel:e,message:e}):null}}])&&d(t.prototype,r),m&&d(t,m),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.Component)},20429:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r(11766),o=r(12381),i=r(13223),a=r(17266),c=r(13143),s=r(20430),l=r(14894),u=r(20432),p=r(17719),f=r(12339),d=r(12706),m=r(20433),b=r(19713),y=r(12375),v=r(11795);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function C(e,t){return(C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=j(e);if(t){var o=j(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return P(this,r)}}function P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(E,e);var t,r,h,O=S(E);function E(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E),(t=O.call(this,e)).initialDocument='section Section1;\nshared Server = "" meta [IsParameterQuery=true, Type="Text", IsParameterQueryRequired=true];\nshared Database = "" meta [IsParameterQuery=true, Type="Text", IsParameterQueryRequired=true];',t.sourceQuery="let Source = Sql.Databases(Server), Navigation = Source{[Name = Database]}[Data] in Navigation",t.navigatorTreeRootLabel="SQL",t.getClassNames=Object(d.a)(),t.classNames=t.getClassNames(m.a),t.hostContainerElement=void 0,t.editorClient=void 0,t._editorContext=Object(b.a)(),t.setRef=e=>{t.hostContainerElement=e},t.getAcquireToken=e=>t.props.controlOptions.acquireToken(e||Object(f.b)().mashupEditorAudience),t.onMashupEditorCommit=e=>e.getEditingSessionMashup().then(e=>(t.props.controlOptions.onCommit(JSON.stringify(e)),{shouldEndFlow:!0})),t}return t=E,(r=[{key:"render",value:function(){return n.createElement("div",{className:this.classNames.root,ref:this.setRef})}},{key:"componentDidMount",value:function(){var e={allowedOrigin:this.getEditorAllowedOrigin(),container:this.hostContainerElement,url:Object(o.a)(this.getEditorAllowedOrigin(),Object(f.b)().mashupEditorEndpointUrlPath)},t=Object(l.h)(this._editorContext.designerConnectionStore.getConnectionIdFromDesignerConnectionId(this.props.connectionId)||this.props.connectionId);if(t){var r,{apiName:n,connectionName:s}=t,p=[{provider:"PowerApps",apiName:n,environmentName:this.props.environmentName,connectionName:s,path:void 0,kind:"SQL",authenticationKind:"",credentialDetails:{},audience:void 0,connectionParameters:void 0,adfTokenUrl:void 0,adfLinkedServiceName:void 0,privacyGroup:void 0}],d={type:u.b.Flow,details:{EnvironmentId:this.props.environmentName}},m=!!this.props.editingSession&&this.props.editingSession.length>0;if(m)r=g(g({},r=JSON.parse(this.props.editingSession)),{},{connectionOverrides:p});else{var b=Object(i.a)();r={mashupName:"Untitled",mashupDocument:this.initialDocument,documentLocale:Object(y.a)(),hostContext:d,gatewayObjectId:void 0,connectionOverrides:p,fastCombine:!1,allowNativeQueries:!1,useHostConnectionProvider:!1,queryGroups:[{id:b,name:this._editorContext.designerResources.PowerQueryEditor.ParametersQueryGroup,description:null,parentId:null,order:0}],queriesMetadata:{Server:{queryId:null,queryName:"Server",queryGroupId:b,loadEnabled:!1,entityName:void 0,fieldsMetadata:{},lastKnownResultTypeName:null},Database:{queryId:null,queryName:"Database",queryGroupId:b,loadEnabled:!1,entityName:void 0,fieldsMetadata:{},lastKnownResultTypeName:null}}}}this.updateMashupQueryParametersFromConnectionProperties(r.mashupDocument,n,s).then(t=>{var n,o,i=g(g({},r),{},{mashupDocument:t.mashupDocument,gatewayObjectId:t.gatewayObjectId});m?(n={hostContext:d,kind:"editQuery",queryId:void 0,mashupDefinition:{kind:1,editingSessionMashup:i}},o=this._editorContext.designerResources.MashupEditor.CommitButtonLabel.Update):(n={hostContext:d,kind:"navigate",mashupDefinition:{kind:1,editingSessionMashup:i},sourceQueryMashup:this.sourceQuery,navigatorTreeRootLabel:this.navigatorTreeRootLabel},o=this._editorContext.designerResources.MashupEditor.CommitButtonLabel.Create);var s={sessionId:this.props.sessionId,locale:Object(y.a)(),addFocusTrapZone:!0,showCloseButton:!0,showHeader:!0,themeOverride:this.getPaletteOverride(),queryEditorSettings:{commitButtonLabel:o,validationSettings:{rules:{requireExactlyOneLoadEnabledQuery:!0}},helpSettings:{communityUrl:"https://aka.ms/PQCommunity",submitAnIdeaUrl:"https://go.microsoft.com/fwlink/?linkid=2153923",supportUrl:"https://go.microsoft.com/fwlink/?linkid=2153928"}},allowedSources:[{configurationKind:"Instance",instanceKind:"Navigation",sourceQueryMashup:this.sourceQuery,navigatorTreeRootLabel:this.navigatorTreeRootLabel}]},l={clientSettings:e,editorSettings:s,mappingCallbacks:void 0,mappingEditorCallbacks:void 0,acquireToken:this.getAcquireToken};this.editorClient=new u.d(l),this.editorClient.startFlow(n,this.onMashupEditorCommit,this.props.controlOptions.onCancel).then(this.props.controlOptions.onReady,e=>this.props.controlOptions.onReadyError(new a.a(c.b.mashupEditorOnReadyError,e)))})}}},{key:"componentWillUnmount",value:function(){this.editorClient&&this.editorClient.dispose()}},{key:"updateMashupQueryParametersFromConnectionProperties",value:function(e,t,r){var n=this.getEditorAllowedOrigin()+"/api/powerAppsConnections/updateParameterValues",o=JSON.stringify({mashupDocument:e,environmentName:this.props.environmentName,apiName:t,connectionName:r,parameterNameToConnectionPropertyPath:{Server:"server",Database:"database"}});return this.getAcquireToken().then(e=>Object(s.a)({url:n,method:"POST",headers:{authorization:"Bearer ".concat(e),"x-ms-client-request-id":Object(i.a)(),"x-ms-client-session-id":this.props.sessionId,Accept:"application/json"},contentType:"application/json",data:o},this._editorContext.loggingService))}},{key:"getPaletteOverride",value:function(){return{palette:{themeDarker:p.a.BlueDarken22,themeDark:p.a.BlueDarken12,themeDarkAlt:p.a.BlueDarken5,themePrimary:p.a.Blue,themeSecondary:p.a.BlueLighten6,themeTertiary:p.a.BlueLighten20,themeLight:p.a.BlueLighten35,themeLighter:p.a.BlueLighten42,themeLighterAlt:p.a.BlueLighten46},semanticColors:{}}}},{key:"getEditorAllowedOrigin",value:function(){if("prod"!==Object(v.h)().region||!this._editorContext.environmentStore.currentEnvironment)return Object(f.b)().mashupEditorAllowedOrigin;var e=this._editorContext.environmentStore.currentEnvironment.location;return Object(f.b)().mashupEditorAllowedOrigin.replace(/(https:\/\/)(.+)/,"$1".concat({unitedstates:"us",unitedarabemirates:"uae",unitedkingdom:"uk",southamerica:"brazil"}[e]||e,".$2"))}}])&&w(t.prototype,r),h&&w(t,h),Object.defineProperty(t,"prototype",{writable:!1}),E}(n.Component)},20430:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(17914),o=r(13223),i=r(20431),a=r(12375),c=r(15043),s=r.n(c);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f="x-ms-client-request-id",d="x-ms-request-id",m="x-ms-isauthenticated",b={source:"AjaxHelper.JQuery"};function y(e,t,r){var c=Object(o.a)();e.headers=e.headers||{},null!==e.headers[f]&&(e.headers[f]=c),Object(n.g)(e.url)&&(e.headers["Accept-Language"]=Object(a.a)());var l=!(!e.headers.Authorization&&!e.headers.authorization);t.logHttpRequestStart(r||"OUTGOING_REQUEST_START",e.method,e.url,c,b);var p=t.performanceNow();return e.complete=(n,o)=>{t.logHttpRequestEnd(r||"OUTGOING_REQUEST_END",e.method,e.url,{status:n.status,contentLength:n&&n.responseText&&n.responseText.length||0,serviceRequestId:n.getResponseHeader(d),data:{hasAuthorizationHeaderInRequest:l}},t.performanceNow()-p,e.headers[f],b)},e.error=(n,o,i)=>{t.logHttpRequestEnd(r||"OUTGOING_REQUEST_END",e.method,e.url,{status:n.status,contentLength:n&&n.responseText&&n.responseText.length||0,responseBodyOnError:n.responseText,serviceRequestId:e.headers[d]},t.performanceNow()-p,e.headers[f],u(u({},b),{},{hasAuthorizationHeaderInRequest:l,isAuthenticated:n.getResponseHeader(m)}))},new Promise((t,r)=>{s.a.ajax(e).then((e,r,n)=>t(e),(e,t,n)=>{r(Object(i.a)(e,{status:e.status,textStatus:t,errorThrown:n,clientRequestId:c,hasAuthorizationHeaderInRequest:l,isAuthenticated:e.getResponseHeader(m)}))})})}},20431:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(17266),o=r(13142),i=r(13143),a=r(13034);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){var r;try{r=JSON.parse(e.responseText)}catch(u){r=e.responseText}var c=Object(a.l)(r),l=s(s({},t),{},{error:r});return e&&0===e.status?new n.a(i.b.ClientErrorAborted,c,r,l):r&&r.error&&function(e){if(e&&e.code){return[i.b.failedToGetTokenMultifactorAuthentication,i.b.failedToGetTokenBundleDueToConditionalAccess,i.b.missingAuthorizationHeaderAndClientCertificate].some(t=>t===e.code)}return!1}(r.error)?new o.a(i.b.ajaxRequestFailed,c,r,l):new n.a(i.b.ajaxRequestFailed,c,r,l)}},20433:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-MashupEditor",{selectors:{iframe:{display:"block",border:"none"}}}]})},20434:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r(12328),o=r.n(n),i=r(11766),a=r(12811),c=r(17142),s=r(20413),l=r(15497),u=r(16813),p=r(19713),f=r(12706),d=r(20435);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=C(e);if(t){var o=C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(y,e);var t,r,n,m=w(y);function y(){var e;v(this,y);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=m.call(this,...r))._editorContext=Object(p.a)(),e.getClassNames=Object(f.a)(),e.classNames=e.getClassNames(d.a),e.logErrorBoundaryError=(t,r,n)=>{e._editorContext.loggingService.logError(t,r,n)},e}return t=y,(r=[{key:"render",value:function(){return i.createElement(c.a,{onError:this.logErrorBoundaryError,globalResources:this._editorContext.globalResources,sharedComponentResources:this._editorContext.sharedComponentResources},i.createElement("div",{className:"fl-EditorDialogLauncher"},i.createElement(s.a,{mode:this.props.buttonMode,parameterName:this.props.parameterName,readonly:this.props.readonly,onClick:this.props.onLaunchedButtonClick,editorType:this.props.editorType}),this.renderEditor()))}},{key:"renderEditor",value:function(){var e=this.props.isContentLoading?l.a.hidden:l.a.visible,t={className:Object(a.a)(this.classNames.root,this.props.dialogClassName),contentDisplay:e,hidden:!this.props.isEditing,isLoading:this.props.isContentLoading,clientResources:this._editorContext.globalResources,onDismiss:this.props.onDialogClose};if(this.props.title){var r,n,c=this.props.buttonGroupProps;c&&((c.primaryButtonText||c.onPrimaryButtonClick)&&(n={text:c.primaryButtonText,onClick:c.onPrimaryButtonClick}),(c.secondaryButtonText||c.onSecondaryButtonClick)&&(r={text:c.secondaryButtonText,onClick:c.onSecondaryButtonClick}));var s=b(b({},t),{},{primaryButtonProps:n,secondaryButtonProps:r,title:this.props.title});return i.createElement(l.b,s,this.props.children)}o()(!this.props.buttonGroupProps,"buttonGroupProps is not supported in modal yet.");var p=t;return i.createElement(u.a,p,this.props.children)}}])&&h(t.prototype,r),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(i.Component)},20435:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(20436),o=()=>({root:["fl-EditorDialogLauncher-dialog",{selectors:{".ms-Dialog-main":{width:n.c,height:n.b,maxWidth:"100%"},"&.fl-Dialog .ms-Spinner":{paddingTop:'calc(~"('.concat(n.b," - ").concat(n.a," - ").concat(n.d,')/2")')},"&.fl-Modal .ms-Spinner":{paddingTop:'calc(~"('.concat(n.b," - ").concat(n.d,')/2")')}}}]})},20436:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return a}));var n="85vw",o="85vh",i="60px",a="60px"},20437:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(20436),o=()=>({root:["fl-PowerQueryEditor-dialog",{selectors:{".ms-Dialog-inner":{padding:0},".ms-Dialog-main iframe":{width:n.c,height:n.b}}}]})},20438:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(15027),i=r(20323),a=r(20419),c=r(20313);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=d(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(l,e);var t,r,a,c=b(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=c.call(this,e)).textBoxRef=void 0,t.renderEditor=e=>{var r,{editorOptions:{displayName:i,readonly:a,summary:c}}=t.props,s=null==e?void 0:e.containerClassName,l=null==e?void 0:e.editorClassName;return n.createElement("div",{className:s},n.createElement(o.b,{className:l,componentRef:t.setComponentRef,ariaLabel:null!=i?i:void 0,readOnly:a,placeholder:c,spellCheck:!1,value:null!==(r=t.state.value)&&void 0!==r?r:"",onBlur:t.onBlur,onChange:t.onChange}))},t.setComponentRef=e=>{t.textBoxRef=e},t.onBlur=e=>{t.commitChanges()},t.commitChanges=()=>{var{editorState:e,onChange:r}=t.props,{value:n}=e,o=[...n];o[0]=u(u({},n[0]),{},{tokenExpression:t.state.value}),r(u(u({},e),{},{value:o}))},t.onChange=(e,r)=>{t.setState({value:r})};var{editorState:r}=t.props,i=(r.value.length&&r.value[0]||{tokenExpression:""}).tokenExpression;return t.state={value:i},t}return t=l,(r=[{key:"render",value:function(){return n.createElement(i.a,s({},this.props,{onRenderEditor:this.renderEditor}))}},{key:"focus",value:function(){this.textBoxRef&&this.textBoxRef.focus()}}])&&f(t.prototype,r),a&&f(t,a),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.Component),g=Object(a.a)((e,t)=>!!t.editorState&&Object(c.c)(e.editorState.value,t.editorState.value))(h)},20439:function(e,t,r){"use strict";r.d(t,"b",(function(){return j})),r.d(t,"a",(function(){return k}));var n=r(11766),o=r(11773),i=r(20402),a=r(20313),c=r(20326),s=r(15568),l=r(15515),u=r(20321),p=r(20440),f=r(20442),d=r(13240),m=r(12706),b=r(20443),y=r(12999),v=r(19713);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=function(e){return e.advanced="advanced",e.basic="basic",e}(P||{}),j=function(e){return e.DynamicContent="dynamicContent",e.Expression="expression",e}({}),T=e=>{var t,{editorState:r,editorContext:n}=e,i=!Object(a.j)(r.value)&&r.value.length&&r.value[0].tokenExpression||"",c=n.getService(u.a.PARAMETER).getParameterInfo();return Object(o.runInAction)(()=>{t={key:c&&c.id||"",fieldProps:{type:s.b.Email,description:e.editorOptions?e.editorOptions.summary:void 0},fieldState:new l.FieldState(i)}}),t},k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(l,e);var t,r,o,s=E(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).advancedEditorRef=n.createRef(),t.simpleEditorRef=n.createRef(),t.getClassNames=Object(m.a)(),t.classNames=t.getClassNames(b.a),t._editorContext=Object(v.a)(),t.renderEditor=()=>t.state.mode===P.advanced?n.createElement(n.Fragment,null,t.state.useNewStyle?null:t.renderToggleMode(),n.createElement(c.a,h({renderMenubarChildren:t.renderToggleMode,ref:t.advancedEditorRef},t.props))):n.createElement(p.a,h({ref:t.simpleEditorRef,inputValue:t.state.basicModeParameter,toggleButtonTitle:t._editorContext.designerResources.Designer.Editors.People.AdvancedMode,useNewStyle:t.state.useNewStyle,toggleMode:t.toggleAdvancedMode},t.props)),t.renderToggleMode=()=>{var{editorState:e,editorOptions:{showTokenPicker:r}}=t.props,{designerResources:o}=t._editorContext;return r?n.createElement(f.a,{disabled:Object(a.j)(e.value),title:o.Designer.Editors.People.BasicMode,onClick:t.toggleBasicMode}):null},t.toggleBasicMode=()=>{t._editorContext.telemetryService.tagEvent(d.c.PeopleEditorToggleBasicMode),t.setBasicMode()},t.toggleAdvancedMode=()=>{t._editorContext.telemetryService.tagEvent(d.c.PeopleEditorToggleAdvancedMode),t.setAdvancedMode()},t.setAdvancedMode=()=>{t.setState({mode:P.advanced},()=>{t.focus()})},t.setBasicMode=()=>{t.setState({mode:P.basic},()=>{t.focus()})},t.state={advancedModeParameter:t.props.editorState.value,basicModeParameter:T(e),mode:P.basic,prevMode:void 0,useNewStyle:Object(y.a)().designerNewTokenPickerV2,areExpressionsDifferent:Object(i.a)((e,t)=>Object(a.c)(e,t))},t}return t=l,o=[{key:"getDerivedStateFromProps",value:function(e,t){var r,{editorState:n}=e;if(t){if(t.mode===t.prevMode&&!t.areExpressionsDifferent(t.advancedModeParameter,e.editorState.value))return t;t.useNewStyle?t.mode!==t.prevMode&&(r=t.mode):r=t.mode}return r===P.advanced||Object(a.j)(n.value)?{advancedModeParameter:e.editorState.value,basicModeParameter:T(e),mode:P.advanced,prevMode:t.mode,useNewStyle:t.useNewStyle,areExpressionsDifferent:t.areExpressionsDifferent}:{advancedModeParameter:e.editorState.value,basicModeParameter:T(e),mode:P.basic,prevMode:t.mode,useNewStyle:t.useNewStyle,areExpressionsDifferent:t.areExpressionsDifferent}}}],(r=[{key:"render",value:function(){return n.createElement("div",{className:this.classNames.root},this.renderEditor())}},{key:"focus",value:function(){this.simpleEditorRef.current&&this.simpleEditorRef.current.focus(),this.advancedEditorRef.current&&this.advancedEditorRef.current.focus()}}])&&g(t.prototype,r),o&&g(t,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.Component)},20440:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r(11766),o=r(20323),i=r(20313),a=r(20441),c=r(20321),s=r(20397),l=r(20354),u=r(20442),p=r(20439),f=r(16828),d=r(12999),m=r(19713);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(E,e);var t,r,h,w=O(E);function E(){var e;y(this,E);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=w.call(this,...r)).simplePeoplePickerRef=n.createRef(),e.emailEditorRef=n.createRef(),e._editorContext=Object(m.a)(),e.ignoreTabBlur=!1,e.pendingBlurTimeout=void 0,e.renderTokenBar=()=>{var{editorOptions:{showTokenPicker:t},toggleButtonTitle:r}=e.props;return t?n.createElement(s.a,{isFloatingPosition:!0},n.createElement(u.a,{title:r,onClick:e.handleToggleModeClick})):null},e.renderSimpleEditor=t=>{var r=null==t?void 0:t.containerClassName,{useNewStyle:o,editorOptions:{readonly:i}}=e.props;return n.createElement("div",{ref:e.simplePeoplePickerRef,className:r,onBlur:e.handleSimpleModeBlur,onFocus:e.handleSimpleModeFocus,onKeyDown:o?e.handleSimpleModeKeyDown:void 0},n.createElement(a.a,{ref:e.emailEditorRef,disabled:i,inputParameter:e.props.inputValue,onChange:e.commitSimpleModeChanges,dateTimeResources:e._editorContext.dateTimeResources,globalResources:e._editorContext.globalResources,loggingService:e._editorContext.loggingService,graphService:e._editorContext.graphService,sharedComponentsResources:e._editorContext.sharedComponentResources}),o?e.renderTokenBar():e.renderTokenPickerLegacyButton())},e.renderTokenPickerLegacyButton=()=>{var{editorOptions:{showTokenPicker:t},useNewStyle:r}=e.props,o="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxMyI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMwMDU4YWQ7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5jbGlja2VkIHN0YXRlX2R5bmFtaWMgY29udGVudDwvdGl0bGU+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMCwxLjV2MTNIMTJWMS41SDBabTksN0g3djJINnYtMkg0di0xSDZ2LTJIN3YySDl2MVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTEuNSkiLz48cmVjdCBjbGFzcz0iY2xzLTEiIHg9IjEzIiB3aWR0aD0iMyIgaGVpZ2h0PSIxMyIvPjwvc3ZnPg==";return!r&&t?n.createElement("div",{className:"msla-token-recommendation-v2"},n.createElement("div",{className:"msla-token-recommendation-pull-right"},n.createElement("div",{className:"msla-token-picker-button-container"},n.createElement("div",{className:"msla-token-picker-button"},n.createElement("button",{onClick:e.handleToggleModeClick},n.createElement("span",null,e._editorContext.designerResources.Designer.Editors.DynamicContent.AddContentLegacy),n.createElement(f.b,{src:o,fallbackSrc:o,height:"13",alt:"",cdnService:e._editorContext.cdnService})))))):null},e.renderToggleMode=()=>{var{editorOptions:{readonly:t,showTokenPicker:r},toggleButtonTitle:o,useNewStyle:i}=e.props;return!i&&r?n.createElement(u.a,{disabled:t,title:o,onClick:e.handleToggleModeClick}):null},e.handleToggleModeClick=()=>{e.props.toggleMode()},e.commitSimpleModeChanges=()=>{var{inputValue:t,onChange:r}=e.props;t&&r({value:[Object(i.f)(t.fieldState.value)]})},e.handleSimpleModeFocus=()=>{e.props.editorContext.getService(c.a.TOKEN).setTokenPickerVisibility(!0),e.ignoreTabBlur=!1},e.handleSimpleModeBlur=t=>{e.pendingBlurTimeout&&clearTimeout(e.pendingBlurTimeout),e.pendingBlurTimeout=setTimeout(()=>{Object(s.c)(t)||Object(s.b)(t)||e.ignoreTabBlur||(e.emailEditorRef.current&&e.emailEditorRef.current.completeSuggestion(),Object(d.a)().designerNewTokenPickerV2&&e.props.editorContext.getService(c.a.TOKEN).setTokenPickerVisibility(!1))},E.FORCE_FOCUS_TIMEOUT)},e.handleAddDynamicContentClick=()=>{e.props.editorOptions.readonly||(e.commitSimpleModeChanges(),e.props.toggleMode(p.b.DynamicContent))},e.handleAddExpressionClick=()=>{e.props.editorOptions.readonly||(e.commitSimpleModeChanges(),e.props.toggleMode(p.b.Expression))},e.handleSimpleModeKeyDown=t=>{Object(l.m)(t)||Object(l.l)(t)?e.ignoreTabBlur=!0:Object(l.f)(t)?e.handleAddDynamicContentClick():Object(l.e)(t)?e.handleAddExpressionClick():Object(l.c)(t)||Object(l.h)(t)||Object(l.j)(t)||Object(l.i)(t)||Object(l.g)(t)},e}return t=E,(r=[{key:"render",value:function(){return n.createElement(n.Fragment,null,this.renderToggleMode(),n.createElement(o.a,b({},this.props,{onRenderEditor:this.renderSimpleEditor})))}},{key:"componentDidUpdate",value:function(e){var t,r;!1===e.editorOptions.showTokenPicker&&!0===this.props.editorOptions.showTokenPicker&&(null===(t=this.emailEditorRef.current)||void 0===t||t.focusInput(),null===(r=this.emailEditorRef.current)||void 0===r||r.forceUpdate())}},{key:"componentWillUnmount",value:function(){this.pendingBlurTimeout&&(clearTimeout(this.pendingBlurTimeout),this.pendingBlurTimeout=void 0)}},{key:"focus",value:function(){this.emailEditorRef.current&&this.emailEditorRef.current.focusInput()}}])&&v(t.prototype,r),h&&v(t,h),Object.defineProperty(t,"prototype",{writable:!1}),E}(n.Component);C.FORCE_FOCUS_TIMEOUT=500},20441:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,o,i,a,c=r(11766),s=r(14337),l=r(15519),u=r(11773),p=r(14940),f=r(15522),d=r(12347);function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function b(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=C(e);if(t){var o=C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var P=new(n=function(e){h(r,e);var t=O(r);function r(){var e,n,i,a,c;return v(this,r),e=t.call(this),n=e,i="peoplePickerItems",a=o,c=E(e),a&&Object.defineProperty(n,i,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(c):void 0}),Object(u.runInAction)(()=>{e.peoplePickerItems=new d.d({getKey:e=>e.mail})}),e}return b(r)}(r(15331).a),o=S(n.prototype,"peoplePickerItems",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n),j=Object(s.c)((S((a=function(e){h(r,e);var t=O(r);function r(){var e;v(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call(this,...o)).cancelTokenSource=Object(p.a)(),e.peoplePickerRef=c.createRef(),e.onPeoplePickerFilterChange=t=>(e.cancelTokenSource.cancel("Canceled due to text change"),e.cancelTokenSource=Object(p.a)(),e.props.graphService.getPeoplePickerSuggestions(t,e.cancelTokenSource.token)),e.onChange=t=>{var{inputParameter:{fieldState:r},loggingService:n,onChange:o}=e.props;t.forEach(e=>P.peoplePickerItems.addEntity(e));var i=Object(l.c)({peoplePickerItems:t,loggingService:n});r.onChange(i),o&&o(i)},e}return b(r,[{key:"render",value:function(){var{disabled:e,inputParameter:{fieldProps:t,fieldState:r}}=this.props;return c.createElement(l.a,{ref:this.peoplePickerRef,errorMessage:r.error,isDisabled:e,label:t.label,placeholder:t.description,required:t.isRequired,selectedItems:this.selectedItems,onFilterChange:this.onPeoplePickerFilterChange,onSelectionChange:this.onChange,allowUserSpecifiedValues:!0,sharedComponentsResources:this.props.sharedComponentsResources,loggingService:this.props.loggingService})}},{key:"componentWillUnmount",value:function(){this.cancelTokenSource.cancel("Canceled due to component unmounting")}},{key:"completeSuggestion",value:function(){this.peoplePickerRef.current&&this.peoplePickerRef.current.completeSuggestion()}},{key:"focus",value:function(){this.peoplePickerRef.current&&this.peoplePickerRef.current.focus()}},{key:"focusInput",value:function(){this.peoplePickerRef.current&&this.peoplePickerRef.current.focusInput()}},{key:"selectedItems",get:function(){var{inputParameter:{fieldState:e}}=this.props;return Object(l.b)(e.value).map(e=>P.peoplePickerItems.getEntity(e)||{mail:e,uniqueId:e,text:e,type:f.a.NotSpecified})}}]),r}(c.Component)).prototype,"selectedItems",[u.computed],Object.getOwnPropertyDescriptor(a.prototype,"selectedItems"),a.prototype),i=a))||i},20442:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(11766),o=r(13272),i=r(13259),a={display:"flex",justifyContent:"flex-end"},c=e=>{var{disabled:t,onClick:r,title:c}=e;return n.createElement("div",{style:a},n.createElement(i.a,{disabled:t,iconName:o.a.Switch,title:c,onClick:r}))}},20443:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["fl-Designer-PeoplePickerEditor",{selectors:{".fl-Parameter-Content":{position:"relative"}}}]})},20444:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(20326),i=r(20313),a=r(20419),c=["hideLabel"],s=["editorOptions"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var d=Object(a.a)((e,t)=>!!t.editorState&&Object(i.c)(e.editorState.value,t.editorState.value))(e=>{var{editorOptions:{hideLabel:t}}=e,r=f(e.editorOptions,c),i=f(e,s);return n.createElement(o.a,{editorContext:i.editorContext,editorOptions:u({hideLabel:!0},r),editorState:i.editorState,onChange:i.onChange})})},20445:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n=r(11766),o=r(12706),i=r(12811),a=r(20057),c=r(20323),s=r(20446),l=r(14680),u=r(13016),p=r(20447),f=r(13031),d=r(14883),m=r(20313),b=r(20450),y=r(20452),v=r(17244),h=r(20372),g=r(19713);function O(){return(O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C(n.key),n)}}function C(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=T(e);if(t){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return j(this,r)}}function j(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(T,e);var t,r,C,j=P(T);function T(){var e;w(this,T);for(var t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return(e=j.call(this,...r)).editorRef=n.createRef(),e.getClassNames=Object(o.a)(),e.classNames=e.getClassNames(y.a),e._editorContext=Object(g.a)(),e.state={errorMessage:void 0,isModalOpen:!1,sampleOrSchemaChanged:!1,sampleData:"",value:Object(s.b)(Object(s.a)(e.props.editorState.value))},e.renderEditor=t=>{var r,o=null!==(r=null==t?void 0:t.useNewStyle)&&void 0!==r&&r,c=Object(i.a)({"msla-schema-editor-body":!o,[e.classNames.root]:o}),s=Object(i.a)({"msla-monaco":!o});return n.createElement("div",{className:c,onBlur:e.onBlur},n.createElement(a.a,{ref:e.editorRef,className:s,value:e.state.value,options:e.getEditorOptions(),width:"100%",loggingService:e._editorContext.loggingService,onChange:e.onChange,dataLoadingFailureTelemetryEventNamePrefix:"SchemaEditor"}),n.createElement(l.a,{className:e.classNames.button,disabled:e.state.isModalOpen||e.props.editorOptions.readonly,text:e._editorContext.designerResources.Designer.Editors.Schema.GenerateButtonText,onClick:e.openSampleModal}),e.renderSampleEditor())},e.getSampleEditorMessageBarProps=()=>{var{errorMessage:t,sampleOrSchemaChanged:r,sampleData:n}=e.state;return t?{message:t,type:u.c.error}:r&&n?{message:e._editorContext.designerResources.Designer.Editors.Schema.DialogWarning,type:u.c.warning}:void 0},e.getEditorOptions=()=>({readOnly:e.props.editorOptions.readonly}),e.closeSampleModal=()=>{e.setState({isModalOpen:!1},()=>{e.focus()})},e.openSampleModal=t=>{t.preventDefault(),e.setState({isModalOpen:!0})},e.sampleDialogOkClick=()=>{var{sampleOrSchemaChanged:t,sampleData:r}=e.state;t||e.closeSampleModal();try{var n;if(Object(d.f)(r))n="";else{var o=Object(p.a)(r);n=JSON.stringify(o,null,4)}e.setState({errorMessage:void 0,isModalOpen:!1,sampleOrSchemaChanged:!1,value:n},e.focus)}catch(i){e.setState({errorMessage:Object(f.a)("".concat(e._editorContext.globalResources.Common.Error,": {0}"),i)},()=>{e.focus()})}},e.sampleEditorOnChange=t=>{e.setState({sampleOrSchemaChanged:!0,sampleData:t})},e.onChange=t=>{e.setState({sampleOrSchemaChanged:!0,value:t})},e.onBlur=t=>{Object(h.a)(t,v.a.UIClassNames.SchemaEditorSampleDialog)||Object(h.a)(t,v.a.UIClassNames.SchemaEditorButton)||e.commitChanges()},e.commitChanges=()=>{if(e.state.value){var{onChange:t}=e.props;t({value:[Object(m.f)(e.state.value)]})}},e}return t=T,(r=[{key:"render",value:function(){return n.createElement(c.a,O({},this.props,{onRenderEditor:this.renderEditor}))}},{key:"renderSampleEditor",value:function(){return this.state.isModalOpen?n.createElement(b.a,{messageBarProps:this.getSampleEditorMessageBarProps(),monacoEditorOptions:this.getEditorOptions(),value:this.state.sampleData,onChange:this.sampleEditorOnChange,onConfirm:this.sampleDialogOkClick,onDismiss:this.closeSampleModal}):null}},{key:"focus",value:function(){this.editorRef.current&&this.editorRef.current.focus()}},{key:"scrollIntoView",value:function(){this.editorRef&&this.editorRef.current&&this.editorRef.current.scrollIntoView()}}])&&E(t.prototype,r),C&&E(t,C),Object.defineProperty(t,"prototype",{writable:!1}),T}(n.Component)},20446:function(e,t,r){"use strict";function n(e){var t=e&&e.length&&e[0]&&e[0].tokenExpression?e[0].tokenExpression:"";return"{}"===t?"":t}function o(e){try{return JSON.stringify(JSON.parse(e),null,4)}catch(t){return e}}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}))},20447:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(18962),o=r(18960),i=r(20448);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(i,e);var t,r,n,o=l(i);function i(e,t,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"Common.InvalidJsonSchemaTypeException",e,void 0,t,r)}return t=i,r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(r(16808).a),d="object",m="number",b="string",y="array",v="boolean",h="integer",g="null";function O(e){return w(e?JSON.parse(e):null)}function w(e){var t=typeof e;switch(t){case"number":return{type:Number.isInteger(e)?h:m};case"boolean":return{type:v};case"string":return{type:b};case"object":return null===e?{}:Array.isArray(e)?function(e){var t={type:y};if(e.length){var r=e[0],a=E(r),c=!0;for(var s of e)if(E(s)!==a){c=!1;break}if(c)if(null!==r&&a===d){for(var l=Object.keys(r),u=Object(o.a)(r),p=function(){var t=e[f];l=l.filter(e=>Object.keys(t).indexOf(e)>-1),Object.keys(t).forEach(e=>{void 0===u[e]&&(u[e]=Object(n.a)(t[e]))})},f=1;f<e.length;f++)p();t.items=w(u),t.items.required=l.map(i.f)}else t.items=w(r)}return t}(e):function(e){var t={type:d,properties:{}};if(t.properties)for(var r of Object.keys(e))t.properties[Object(i.f)(r)]=w(e[r]);return t}(e);default:throw new f("Unsupported type '".concat(t,"'."))}}function E(e){var t=typeof e;switch(t){case"number":return Number.isInteger(e)?h:m;case"boolean":return v;case"string":return b;case"object":return null===e?g:Array.isArray(e)?y:d;default:throw new f("Unsupported type '".concat(t,"' in getJsonSchemaType."))}}},20448:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"f",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"g",(function(){return u}));r(12331);var n=r(20317);r(20449),r(17233),r(12327),r(14883);function o(e){return e?"'".concat(null==e?void 0:e.replace(/'/g,"''"),"'"):e}function i(e){return a(e)?"@"===e.charAt(0)?"@".concat(e):e.replace(/@{/g,"@@{"):e}function a(e){return"string"==typeof e&&n.a.isTemplateExpression(e)}function c(e){return e.type===n.b.StringLiteral}function s(e){return e.type===n.b.Function}function l(e){return e.type===n.b.StringInterpolation}function u(e,t){for(var r=[e];r.length>0;){var n=r.shift();if(t(n))return;l(n)?r.unshift(...n.segments):s(n)&&(r.unshift(...n.functionArguments),r.unshift(...n.dereferences.map(e=>{var{expression:t}=e;return t})))}}},20449:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(16808),o=r(13031);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){return e.UNRECOGNIZED_EXPRESSION="UnrecognizedExpression",e.EMPTY_VALUE="EmptyValue",e}({}),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(r,e);var t=u(r);function r(e,n){return s(this,r),t.call(this,"Workflow.ExpressionEvaluatorException",e,n)}return a(r)}(n.a),b=function(){function e(t){s(this,e),this._options=void 0,this._options=t||{}}return a(e,[{key:"evaluate",value:function(e,t){return this._options.fuzzyEvaluation?this._fuzzyEvaluate(e,t):this._evaluate(e,t)}},{key:"_evaluate",value:function(e,t){return this._fuzzyEvaluate(e,t)}},{key:"_fuzzyEvaluate",value:function(e,t){if(!e)throw new m(t.WorkflowError.EmptyExpression,d.EMPTY_VALUE);if(/^@@/.test(e))return e.substr(1);if(/@@{/.test(e))return e.replace(/@@{/g,"@{");if(/^@/.test(e))throw new m(Object(o.a)(t.WorkflowError.UnrecognizedExpression,e),d.UNRECOGNIZED_EXPRESSION);if(/@{/.test(e))throw new m(Object(o.a)(t.WorkflowError.UnrecognizedExpression,e),d.UNRECOGNIZED_EXPRESSION);return e}}]),e}()},20450:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(12366),i=r(16824),a=r(15497),c=r(20057),s=r(20451),l=r(12706),u=r(19713);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(h,e);var t,r,m,v=y(h);function h(){var e;f(this,h);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=v.call(this,...r)).editorRef=n.createRef(),e.getClassNames=Object(l.a)(),e.classNames=e.getClassNames(s.a),e._editorContext=Object(u.a)(),e.focus=()=>{e.editorRef.current&&e.editorRef.current.focus()},e}return t=h,(r=[{key:"render",value:function(){var{messageBarProps:e,monacoEditorOptions:t,value:r,onChange:s,onConfirm:l,onDismiss:u}=this.props;return n.createElement(a.b,{className:this.classNames.root,hidden:!1,maxWidth:o.G,primaryButtonProps:{disabled:!r,primary:!0,onClick:l,text:this._editorContext.globalResources.Common.Done},title:this._editorContext.designerResources.Designer.Editors.Schema.DialogTitle,onDismiss:u},n.createElement("div",{className:this.classNames.container},e&&n.createElement(i.a,p({className:this.classNames.messageBar},e)),n.createElement(c.a,{ref:this.editorRef,editorDidMount:this.focus,value:r,options:t,width:"100%",onChange:s,loggingService:this._editorContext.loggingService,dataLoadingFailureTelemetryEventNamePrefix:"SchemaEditorSampleDialog"})))}}])&&d(t.prototype,r),m&&d(t,m),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.Component)},20451:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(17244),o=()=>({root:[n.a.UIClassNames.SchemaEditorSampleDialog,{}],container:["fl-SchemaEditor-SampleDialog-Container",{width:600}],messageBar:["fl-SchemaEditor-SampleDialog-MessageBar",{marginBottom:10}]})},20452:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(17244),o=()=>({root:["fl-SchemaEditor",{}],button:[n.a.UIClassNames.SchemaEditorButton,{marginTop:10}]})},20453:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r(11766),o=r(13262),i=r(12706),a=r(12811),c=r(20454),s=r(20455),l=r(20458),u=r(14680),p=r(13259),f=r(13272),d=r(17244),m=r(20321),b=r(20323),y=r(17266),v=r(19713),h=r(13240);function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function E(e,t){return(E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function C(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=P(e);if(t){var o=P(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}function S(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(P,e);var t,r,w,S=C(P);function P(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,P),(t=S.call(this,e)).getClassNames=Object(i.a)(),t.arrayRef=n.createRef(),t._editorContext=Object(v.a)(),t.onRenderCodeView=()=>n.createElement(l.a,{arrayRef:t.arrayRef,editorContext:t.props.editorContext,editorOptions:t.props.editorOptions,editorState:{value:t.props.editorState.value},onChange:t.props.onChange,onValidated:e=>t.setState({toggleEnabled:e})}),t.handleDeleteItem=e=>{e.deleteItem(e.key)},t.handleToggleModeClicked=()=>{if(t.state.toggleEnabled){var{complexValue:e}=t.props.editorState;if(!e)throw new y.a(void 0,"This is unexpected, complex Value cannot be undefined");var r=e.editorState;r&&(r.toggleExpand(),t._editorContext.telemetryService.tagEvent(h.c.ArrayEditorToggledModeClicked,{mode:"table"===t.getCurrentViewState()?"TableView":"CodeView"}))}},t.state={isFocused:!1,toggleEnabled:!0};var r=t.props.editorContext.getService(m.a.PARAMETER);return(r&&r.getParameterInfo()).showErrors=!0,t._editorContext.telemetryService.tagEvent(h.c.ArrayEditorRendered),t}return t=P,(r=[{key:"render",value:function(){if(!this.props.editorState.complexValue)throw new y.a(void 0,"This is unexpected, complex Value cannot be undefined");var e=this.props.editorState.complexValue.editorState,t=this.getClassNames(c.a);return n.createElement("div",{className:Object(a.a)(t.root,d.a.UIClassNames.ArrayContainer,"".concat(d.a.UIClassNames.ArrayContainer,"-expanded"))},this.renderToggleViewButton(),this.renderArray(e))}},{key:"getCurrentViewState",value:function(){var e,t=null===(e=this.props.editorState.complexValue)||void 0===e?void 0:e.editorState;return null!=t&&t.collapsed?"code":"table"}},{key:"renderArray",value:function(e){return"code"===this.getCurrentViewState()?this.renderCodeViewArray():this.renderTableViewArray(e)}},{key:"renderCodeViewArray",value:function(){return n.createElement(b.a,g({},this.props,{onRenderEditor:this.onRenderCodeView}))}},{key:"renderTableViewArray",value:function(e){return n.createElement("div",{className:d.a.UIClassNames.ArrayContent,ref:this.arrayRef},this.renderItems(e),n.createElement("div",{className:d.a.UIClassNames.ArrayToolbar},n.createElement(u.a,{className:Object(a.a)(d.a.UIClassNames.ArrayAddItemButton),title:this._editorContext.designerResources.ArrayEditor.AddNewItemButton,text:this._editorContext.designerResources.ArrayEditor.AddNewItemButton,iconName:f.a.Add,onClick:e.addItem})))}},{key:"renderItems",value:function(e){return e.items.map((e,t)=>n.createElement(s.a,{key:e.key,editorContext:this.props.editorContext,editorOptions:this.props.editorOptions,index:t,item:e,onDelete:()=>this.handleDeleteItem(e),onChange:this.props.onChange}))}},{key:"renderToggleViewButton",value:function(){var e="code"===this.getCurrentViewState(),t=e?this._editorContext.designerResources.DictionaryEditor.KeyValueButton:this._editorContext.designerResources.DictionaryEditor.CodeViewButton,r=e?f.a.PageHeaderEdit:f.a.CodeEdit;return n.createElement(o.a,{content:t},n.createElement(p.a,{disabled:!this.state.toggleEnabled,iconName:r,onClick:this.handleToggleModeClicked,title:t}))}},{key:"focus",value:function(){this.arrayRef.current&&this.arrayRef.current.focus()}},{key:"scrollIntoView",value:function(e){this.arrayRef.current&&this.arrayRef.current.scrollIntoView(e)}}])&&O(t.prototype,r),w&&O(t,w),Object.defineProperty(t,"prototype",{writable:!1}),P}(n.Component)},20454:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-ArrayEditor",{border:"1px dashed #989898",display:"flex",flexDirection:"row-reverse",paddingBottom:6,width:"100%",selectors:{"> .msla-input-parameter":{flex:1,padding:"0 5px",selectors:{".msla-input-parameter-content-wrapper":{padding:0}}},".msla-array-content":{flex:1},".msla-array-toolbar":{padding:"5px 5px 0"}}}]})},20455:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n=r(11766),o=r(11769),i=r.n(o),a=r(12706),c=r(12811),s=r(20456),l=r(20457),u=r(20326),p=r(13259),f=r(13272),d=r(17244),m=r(20453),b=r(11891),y=r(19713),v=r(20400);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=R(e);if(t){var o=R(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return T(this,r)}}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(O,e);var t,r,o,h=j(O);function O(){var e;E(this,O);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=h.call(this,...r)).getClassNames=Object(a.a)(),e._editorContext=Object(y.a)(),e.state={focusedParameterId:""},e.handleOnBlur=t=>{var r=i.a.findDOMNode(k(e)),n=t.relatedTarget instanceof Node&&(null==r?void 0:r.contains(t.relatedTarget));Object(v.b)(t)||n||e.setState({focusedParameterId:""})},e.handleOnChange=(e,t,r)=>{t&&r.value&&e(t,r.value)},e.handleOnFocus=t=>{e.setState({focusedParameterId:t})},e}return t=O,(r=[{key:"render",value:function(){var e=this.getClassNames(s.a),{index:t,item:r}=this.props;return n.createElement("div",{key:r.key,className:Object(c.a)(e.root)},this.renderProperties(e,t+1,r.properties,r.updateItem),n.createElement(p.a,{iconName:f.a.Delete,title:this._editorContext.designerResources.ArrayEditor.DeleteItemButton,onClick:this.props.onDelete,styles:{root:{marginTop:"14px"}}}))}},{key:"renderProperties",value:function(e,t,r,o){return n.createElement("div",{className:Object(c.a)(e.nonArrayItemProperties)},r.map((r,i)=>{if(!r)return null;if(Object(l.a)(r))return Object(b.a)(r.visibility,d.a.Swagger.Visibility.Internal)?null:n.createElement("div",{key:r.key},this.renderNonArrayProperty(e,t,r,o));var a={editorState:{complexValue:{editorState:r,type:"array"},value:[]},editorOptions:this.props.editorOptions,editorContext:this.props.editorContext,onChange:this.props.onChange};return n.createElement(m.a,w({},a,{key:i}))}))}},{key:"renderNonArrayProperty",value:function(e,t,r,o){var i=r.parameter;if(!i)return null;var a=i.key||i.id;return n.createElement("div",{className:Object(c.a)(e.nonArrayItemProperty),key:a,title:i.placeholder},n.createElement("span",{className:Object(c.a)(e.nonArrayItemPropertyLabel,d.a.UIClassNames.Label)},i.name," - ",t),this.renderValue(e,i.name,i.id,i.value,o))}},{key:"renderValue",value:function(e,t,r,o,i){var a={value:o},s=g(g({},this.props.editorOptions),{},{showTokenPicker:this.state.focusedParameterId===r}),l=Object(c.a)(d.a.UIClassNames.InputBox,d.a.UIClassNames.TokenPickerNonDismissible,e.nonArrayItemPropertyValue);return n.createElement("div",{title:t,className:l},n.createElement(u.a,{editorContext:this.props.editorContext,editorOptions:s,editorState:a,ignoreWrapperComponent:!0,onBlur:this.handleOnBlur,onChange:e=>this.handleOnChange(i,r,e),onFocus:()=>this.handleOnFocus(r)}))}}])&&C(t.prototype,r),o&&C(t,o),Object.defineProperty(t,"prototype",{writable:!1}),O}(n.Component)},20456:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-ArrayEditorItem",{display:"flex",padding:5}],nonArrayItemProperties:["fl-NonArrayItemProperties",{width:"100%"}],nonArrayItemProperty:["fl-NonArrayItemProperty",{display:"flex",flexDirection:"column",paddingBottom:6}],nonArrayItemPropertyLabel:["fl-NonArrayItemPropertyLabel",{width:"30%"}],nonArrayItemPropertyValue:["fl-NonArrayItemPropertyValue",{width:"100%"}]})},20457:function(e,t,r){"use strict";function n(e){return void 0!==e.parameter}r.d(t,"a",(function(){return n}))},20458:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r(11766),o=r(11769),i=r.n(o),a=r(12811),c=r(17244),s=r(20321),l=r(20400),u=r(20326);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(m,e);var t,r,o,f=g(m);function m(){var e;b(this,m);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=f.call(this,...r)).state={isFocused:!1},e.handleOnBlur=t=>{var r=i.a.findDOMNode(w(e)),n=t.relatedTarget instanceof Node&&(null==r?void 0:r.contains(t.relatedTarget));Object(l.b)(t)||n||e.setState({isFocused:!1})},e.handleOnChange=t=>{var r,n;e.props.onChange(t);var o=e.props.editorContext.getService(s.a.PARAMETER),i=o&&o.getParameterInfo(),a=i&&i.validationErrors||[];null===(r=(n=e.props).onValidated)||void 0===r||r.call(n,!a||0===a.length)},e.handleOnFocus=()=>{e.setState({isFocused:!0})},e}return t=m,(r=[{key:"render",value:function(){var e={editorState:{value:this.props.editorState.value},editorOptions:d(d({},this.props.editorOptions),{},{displayName:null,hideLabel:!0,locale:null,showTokenPicker:this.state.isFocused,validationErrors:[]}),editorContext:this.props.editorContext,onChange:this.handleOnChange};return n.createElement(u.a,p({className:Object(a.a)(c.a.UIClassNames.ArrayContainer,"".concat(c.a.UIClassNames.ArrayContainer,"-collapsed")),onBlur:this.handleOnBlur,onFocus:this.handleOnFocus,ref:this.props.arrayRef},e))}}])&&y(t.prototype,r),o&&y(t,o),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component)},20459:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(11766),o=r(20326),i=["editorOptions"];function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var u=e=>{var{editorOptions:t}=e,r=l(e,i);return n.createElement(o.a,{editorContext:r.editorContext,editorOptions:c(c({},t),{},{hideLabel:!0}),editorState:r.editorState,onChange:r.onChange})}},20460:function(e,t,r){"use strict";r.d(t,"b",(function(){return E})),r.d(t,"a",(function(){return C}));var n=r(11766),o=r(12728),i=r(12839),a=r(20313),c=r(19713),s=r(20461),l=r(20465),u=r(20467);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){return e[e.DefaultView=0]="DefaultView",e[e.CodeView=1]="CodeView",e}({}),C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(m,e);var t,r,o,f=h(m);function m(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=f.call(this,e))._editorContext=Object(c.a)(),t._editorRef=n.createRef(),t._editorRefContainer=n.createRef(),t.async=new i.a(O(t)),t._utility=void 0,t._childKey=S(),t.onChangeMode=(e,r)=>{Object(a.c)(t.state.value,r)&&(t._childKey=S()),t.setState({mode:e,value:r},()=>t.async.setTimeout(t.focus,0))};var r,{editorState:{value:o},editorOptions:{isCodeViewSupportEnabled:s}}=t.props;if(t._utility=new u.a(t._editorContext.loggingService),s){var{enforceFailed:l,wouldMutate:p}=t._utility.wouldHtmlViewChangeContent(o);r=l||p?E.CodeView:E.DefaultView}else r=E.DefaultView;return t.state={mode:r,value:o},t}return t=m,(r=[{key:"render",value:function(){var e=d(d({},this.props),{},{editorState:{value:this.state.value},key:this._childKey,loggingService:this._editorContext.loggingService,onChangeMode:this.onChangeMode,utility:this._utility}),t=this.state.mode===E.CodeView?n.createElement(s.a,p({},e,{ref:this._editorRef})):n.createElement(l.b,p({},e,{ref:this._editorRef}));return n.createElement("div",{className:"msla-html-editor",ref:this._editorRefContainer},t)}},{key:"focus",value:function(){this._editorRef.current&&this._editorRef.current.focus()}},{key:"scrollIntoView",value:function(e){this._editorRefContainer.current&&this._editorRefContainer.current.scrollIntoView(e)}},{key:"componentWillUnmount",value:function(){this.async.dispose()}}])&&b(t.prototype,r),o&&b(t,o),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component);function S(){return Object(o.a)("html-editor")}},20461:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r(11766),o=r(12706),i=r(12811),a=r(12839),c=r(20462),s=r(20162),l=r(20323),u=r(20326),p=r(17244),f=r(20464),d=r(20460),m=["onChangeMode"],b=["editorOptions"];function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function C(e,t){return(C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=j(e);if(t){var o=j(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return P(this,r)}}function P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(E,e);var t,r,v,g=S(E);function E(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E),(t=g.call(this,e))._lastValue=void 0,t._utility=void 0,t._editorRef=n.createRef(),t._async=void 0,t._onEditorStateChange=void 0,t.getClassNames=Object(o.a)(),t.classNames=t.getClassNames(f.a),t.renderEditor=e=>{var r=t.props,{onChangeMode:o}=r,a=O(r,m),{codeViewEnabled:s}=t.state,{editorOptions:l}=a,f=O(a,b),d=p.a.UIClassNames.InputBox,v="";return e&&e.useNewStyle&&(d=Object(i.a)(d,e.containerClassName),v=e.editorClassName),n.createElement("div",{className:d},!l.readonly&&n.createElement(c.a,{codeViewEnabled:s,onCodeViewClick:t._handleSwitchToAlternate}),n.createElement(u.a,y({ref:t._editorRef,className:v,ignoreWrapperComponent:!0,onEditorStateChange:t._onEditorStateChange},f,{editorOptions:h(h({},l),{},{hideLabel:!0})})))},t._handleSwitchToAlternate=()=>{t.props.onChangeMode(d.b.DefaultView,t._lastValue)},t._onEditorStateChangeInternal=e=>{t._lastValue=Object(s.m)(e,Object(s.c)(e));var r=t._shouldEnableCodeViewButton();r!==t.state.codeViewEnabled&&t.setState({codeViewEnabled:r})},t._shouldEnableCodeViewButton=()=>{var{enforceFailed:e,wouldMutate:r}=t._utility.wouldHtmlViewChangeContent(t._lastValue);return!e&&!r},t._async=new a.a,t._onEditorStateChange=t._async.debounce(t._onEditorStateChangeInternal,250),t._lastValue=e.editorState.value,t._utility=e.utility,t.state={codeViewEnabled:t._shouldEnableCodeViewButton()},t}return t=E,(r=[{key:"render",value:function(){return n.createElement(l.a,y({},this.props,{className:this.classNames.root,onRenderEditor:this.renderEditor}))}},{key:"componentWillUnmount",value:function(){this._async.dispose()}},{key:"focus",value:function(){this._editorRef.current&&this._editorRef.current.focus()}}])&&w(t.prototype,r),v&&w(t,v),Object.defineProperty(t,"prototype",{writable:!1}),E}(n.Component)},20462:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(11766),o=r(12811),i=r(20463),a=r(16828),c=r(19713);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,r,u,d=f(m);function m(){var e;s(this,m);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=d.call(this,...r))._editorContext=Object(c.a)(),e}return t=m,(r=[{key:"render",value:function(){var{codeViewEnabled:e}=this.props,{designerResources:t}=this._editorContext;return n.createElement("div",{className:"rdw-editor-toolbar","aria-label":t.Designer.Editors.CodeViewAriaLabel,"aria-hidden":"false"},n.createElement("div",{className:Object(o.a)("rdw-option-wrapper","rdw-option-".concat(e?"active":"disabled")),title:t.Designer.Editors.CodeView,onClick:e?this.props.onCodeViewClick:void 0},n.createElement(a.b,{src:i.a,fallbackSrc:i.a,width:"25",height:"21","aria-selected":"true",cdnService:this._editorContext.cdnService})))}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component)},20463:function(e,t,r){"use strict";t.a="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjA0OHB4IiBoZWlnaHQ9IjIwNDhweCIgdmlld0JveD0iMCAwIDIwNDggMjA0OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PHBhdGggdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwyMDQ4KSBzY2FsZSgxLC0xKSIgZD0gIk0zNyAxMDI0TDQ2NyAxNDUzTDU1NyAxMzYzTDIxOSAxMDI0TDU1NyA2ODVMNDY3IDU5NUwzNyAxMDI0Wk0xNDkxIDEzNjNMMTU4MSAxNDUzTDIwMTEgMTAyNEwxNTgxIDU5NUwxNDkxIDY4NUwxODI5IDEwMjRMMTQ5MSAxMzYzWk04MzUgMjU2TDcwMSAyNTZMMTIxMyAxNzkyTDEzNDcgMTc5Mkw4MzUgMjU2WiI+PC9wYXRoPjwvc3ZnPg=="},20464:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["msla-html-codeview-editor",{position:"relative",selectors:{".msla-token-recommendation-v2":{position:"absolute",right:0},".fl-Designer-TokenMenubar-ButtonGroup":{marginTop:-24}},marginBottom:24}]})},20465:function(e,t,r){"use strict";r.d(t,"a",(function(){return G})),r.d(t,"b",(function(){return H}));r(20096);var n=r(12706),o=r(12839),i=r(12811),a=r(20163),c=r(11766),s=r(13009),l=r(20327),u=r(20365),p=r(13240),f=r(20154),d=r(20155),m=r(20368),b=r(20419),y=r(17244),v=r(20321),h=r(20313),g=r(20369),O=r(20162),w=r(20373),E=r(20376),C=r(20397),S=r(20399),P=r(20400),j=r(19713),T=r(20323),k=r(20463),R=r(20460),x=r(20466),N=r(20467);function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function A(e,t){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function F(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=B(e);if(t){var o=B(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return L(this,r)}}function L(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U={options:["fontFamily","fontSize","inline","colorPicker","list","link"],inline:{options:["bold","italic","underline"]}},V=e=>{if(e.has("UNDERLINE"))return{textDecoration:"underline",textDecorationSkipInk:"none"}},z=e=>{var{ariaLabel:t,onClick:r,title:n}=e;return c.createElement("div",{onClick:r,title:n,"aria-label":t},c.createElement("img",{src:k.a,className:"rdw-option-wrapper msla-codeview-button",role:"presentation",alt:""}))},G={reactDraftWysiwyg:null,draftJsExportHtml:null,draftJsImportHtml:null},W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(L,e);var t,b,k,I=F(L);function L(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,L),(t=I.call(this,e)).getClassNames=Object(n.a)(),t.classNames=t.getClassNames(x.a),t._editorContext=Object(j.a)(),t.async=new o.a(M(t)),t.customKeyBindingFn=void 0,t.customKeyHandlers=void 0,t.formulaFromExamplesRef=c.createRef(),t.parameterService=void 0,t.tokenCalloutRef=c.createRef(),t.tokenRefMap=new Map,t._decorators=void 0,t._editorRef=c.createRef(),t._textElementRef=c.createRef(),t._utility=void 0,t.renderTokenBar=()=>{var{editorOptions:{readonly:e,showTokenPicker:r}}=t.props;return Object(f.b)(f.a.designerNewTokenPickerV2)&&r&&!t.isTokenPickerVisible()?c.createElement(C.a,{disableTokenPickerActions:e,isFloatingPosition:!0,onAddDynamicContentClick:()=>t.openTokenPicker("dynamic"),onAddExpressionClick:()=>t.openTokenPicker("expression"),onBlur:t._handleOnBlur}):null},t.renderEditor=e=>{var{editorOptions:{displayName:r,locale:n,readonly:o,summary:a}}=t.props,{designerResources:s}=t._editorContext,{editorState:l,loading:u}=t.state,p=null==e?void 0:e.editorClassName,f=null==e?void 0:e.useNewStyle;if(u)return null;var d=Object(i.a)({[t.classNames.root]:!0,"msla-input-parameter-box":!0,"msla-html-wysiwyg-editor":!0,[y.a.UIClassNames.TokenPickerNonDismissible]:!f},p),m=[];return m.push(c.createElement(z,{ariaLabel:s.Designer.Editors.CodeView,onClick:t._onEnterCodeViewClicked,title:s.Designer.Editors.CodeView})),c.createElement("div",{className:d,onCopy:t._handleCopyOrCut,onCut:t._handleCopyOrCut,ref:t._textElementRef},c.createElement(G.reactDraftWysiwyg.Editor,{ref:t._editorRef,ariaLabel:null!=r?r:void 0,customDecorators:t._decorators,customStyleFn:V,editorState:l,locale:t._utility.toEditorLocale(n),keyBindingFn:t.customKeyBindingFn,placeholder:a,readOnly:o,toolbar:U,toolbarHidden:o,toolbarCustomButtons:m,onEditorStateChange:t._handleHtmlEditorStateChanged,onFocus:t._handleOnFocus,onBlur:t._handleOnBlur,handlePastedText:t._handlePastedText,handleReturn:t._handleReturn,handleKeyCommand:t._handleKeyCommand}),t.renderTokenBar())},t.renderTokenPickerLegacy=()=>{var{editorContext:e,editorOptions:{displayName:r,displayTokenPickerInline:n,schema:o,showTokenPicker:i},editorState:{value:a}}=t.props,{selectedEntityKey:s,editorState:l}=t.state,u=e.getService(v.a.TOKEN),p="";if(s){var f=Object(O.h)(l,s);if(f&&!Object(O.u)(f)){var{expression:d}=f.getData();p=Object(h.h)(a,d.tokenKey)}}var m=p?{id:p,value:Object(h.i)(a,p)}:void 0,b=null!=r?r:void 0,g=o&&o.type?{schema:o,displayName:b}:{schema:{type:y.a.Swagger.TYPE.ANY},displayName:b};return c.createElement(P.a,{activeSelectedSegmentInfo:m,displayInline:null!=n&&n,parameterContext:g,tokenService:u,visible:null!=i&&i,handleTokenSelection:t._handleTokenSelectionFromPicker,handleTokenPickerOKClicked:t._handleTokenSelectionFromPicker,getCustomTokenPickerSections:t.getCustomTokenPickerLegacySections})},t.renderTokenPicker=()=>{var e,{editorContext:r}=t.props,{attachTokenPickerToElement:n,editorState:o,selectedEntityKey:i,tokenPickerModeOverride:a}=t.state,s=r.getService(v.a.TOKEN);if(i){var l=Object(O.h)(o,i);if(l){var{expression:u}=l.getData();if(u){var p=t._utility.getValueSegmentsFromDraft(o),f=Object(h.h)(p,u.tokenKey);e=f?{id:f,value:Object(h.i)(p,f)}:void 0}}}return c.createElement(S.a,{activeSelectedSegmentInfo:e,attachTokenPickerTo:n,calloutProps:{onBlur:t._handleOnBlur,onRestoreFocus:()=>{},setInitialFocus:!0},calloutRef:t.tokenCalloutRef,defaultTokenCalloutMode:a,formulaFromExamplesRef:t.formulaFromExamplesRef,onCancel:()=>t.closeTokenPicker(!0),onExpressionSave:t.onNewExpressionValue,onTokenSelect:t._handleTokenSelectionFromPicker,parameterService:t.parameterService,showCloseXButton:!0,tokenService:s})},t.closeTokenPicker=e=>{t.isTokenPickerVisible()&&(t.updateTokenPickerVisible(!1),e&&t.focus())},t.openTokenPicker=e=>{t.updateTokenPickerVisible(e||"dynamic")},t.updateTokenPickerVisible=e=>{var r;if(!t.props.editorOptions.readonly){var n=e?null===(r=t._textElementRef)||void 0===r?void 0:r.current:void 0;t.state.attachTokenPickerToElement!==n&&t.setState({attachTokenPickerToElement:n||void 0,selectedEntityKey:e?t.state.selectedEntityKey:void 0,tokenPickerModeOverride:e||void 0})}},t._onEnterCodeViewClicked=()=>{var e=t._utility.getValueSegmentsFromDraft(t.state.editorState);t.props.onChangeMode(R.b.CodeView,e)},t._handleHtmlEditorStateChanged=e=>{var r=t._utility.getValueSegmentsFromDraft(e);t.setState({editorState:e,valueSegments:r})},t._handleOnFocus=e=>{Object(w.b)(e)||t.props.editorContext.getService(v.a.TOKEN).setTokenPickerVisibility(!0)},t._handleOnBlur=e=>{var r,n=Object(E.c)(e)||Object(C.c)(e)||Object(E.b)(e),o=t.isFocusWithinOwnEditor(e),i=n||o,a=t._utility.getValueSegmentsFromDraft(t.state.editorState);(t.props.onChange({value:a}),i||!Object(f.b)(f.a.designerNewTokenPickerV2)||null!==(r=t.tokenCalloutRef.current)&&void 0!==r&&r.preventDismissOnLostFocus)||(t.props.editorContext.getService(v.a.TOKEN).setTokenPickerVisibility(!1),t.closeTokenPicker(!1))},t._handleCopyOrCut=e=>{var{editorState:r}=t.state;r.getSelection().getHasFocus()&&(t._utility.copyDataInClipboard(r,e),e.preventDefault())},t._handlePastedText=(e,r,n)=>{var o=t.props.editorContext.getService(v.a.PARAMETER),i=t._utility.pasteClipboardDataInEditorState(n,r,e,o),a=t._utility.getValueSegmentsFromDraft(i);return t.setState({editorState:i,valueSegments:a},()=>{t._updateValueInStore(a)}),"handled"},t._handleReturn=(e,r)=>{var n=r.getSelection(),o=r.getCurrentContent(),i=n.getStartKey(),c=o.getBlockForKey(i),s=a.Modifier.insertText(o,n,"\n".concat(y.a.UIConstants.ZeroWidthChar),r.getCurrentInlineStyle(),void 0),l=new a.SelectionState({anchorOffset:n.getAnchorOffset()+2,anchorKey:n.getAnchorKey(),focusOffset:n.getFocusOffset()+2,focusKey:n.getFocusKey(),isBackward:!1,hasFocus:!0}),u=a.EditorState.push(r,s,"insert-characters"),p=a.EditorState.forceSelection(u,l),f=t._utility.getValueSegmentsFromDraft(p);return t.setState({editorState:p,valueSegments:f}),t._utility.isListItemBlock(c)?"not-handled":"handled"},t._handleKeyCommand=e=>{var{editorState:r}=t.state,n=r.getSelection(),o=n.getAnchorOffset(),i=n.getFocusOffset();if(n.getAnchorKey()===n.getFocusKey()&&o===i){var{getSelectionToDeleteAfterCursor:a,getSelectionToDeleteBeforeCursor:c}=t._utility;if("backspace"===e){var s=c(r,n);if(s)return t._removeSelection(r,s),"handled"}else if("delete"===e){var l=a(r,n);if(l)return t._removeSelection(r,l),"handled"}}return t.customKeyHandlers&&t.customKeyHandlers[e]?((0,t.customKeyHandlers[e])(t.state.editorState),"handled"):"not-handled"},t._handleTokenSelect=e=>{var r,{editorOptions:n}=t.props;if(!n.readonly){var o=e.inputKey,i=(null===(r=t.tokenRefMap.get(o))||void 0===r?void 0:r.current)||void 0;t.setState({attachTokenPickerToElement:i,selectedEntityKey:o})}},t._handleTokenDelete=e=>{var{inputKey:r}=e,{editorState:n}=t.state,o=Object(O.k)(n.getCurrentContent(),r);o&&t._removeSelection(n,o)},t.isFocusWithinOwnEditor=e=>!(!t._textElementRef.current||!e.relatedTarget)&&Object(m.a)(t._textElementRef.current,e.relatedTarget),t.isTokenPickerVisible=()=>!!t.state.attachTokenPickerToElement,t.onNewExpressionValue=e=>{var{editorState:r,selectedEntityKey:n}=t.state;if(e){var o,i=n?Object(O.h)(r,n):null;if(i){var a=i.getData().expression.tokenKey;o=Object(O.i)(t._editorContext.designerResources,e,a);var c=Object(h.n)(o);t._editorContext.telemetryService.tagEvent(p.c.InvalidExpressionInserted,null,{isInvalid:c,editorType:"HTMLWysiwygEditor",message:"User saved an invalid expression from the expression editor"}),t._utility.updateCachedValueSegment(o)}else o=Object(O.i)(t._editorContext.designerResources,e);t._handleTokenSelectionInternal(o)}},t._handleTokenSelectionInternal=e=>{var{editorState:r,selectedEntityKey:n}=t.state,{addTokenSegmentInSelection:o,getValueSegmentsFromDraft:i,isPlaceholderAtOffset:c}=t._utility,s=r,l=s.getCurrentContent(),u=s.getSelection();if(n?Object(O.h)(r,n):null){var p=Object(O.k)(l,n);p&&(u=(s=a.EditorState.forceSelection(r,p)).getSelection())}var d=u.getStartOffset(),m=u.getEndOffset(),b=0===d||!c(s,u,d-1),y=!c(s,u,m),v=s.getCurrentInlineStyle(),{content:h,selection:g}=o(l,u,e,v,b,y),w=a.EditorState.push(s,h,"insert-characters"),E=i(s=a.EditorState.forceSelection(w,g));t.setState({attachTokenPickerToElement:void 0,selectedEntityKey:"",editorState:s,valueSegments:E},()=>{t._updateValueInStore(E),Object(f.b)(f.a.designerNewTokenPickerV2)&&t.closeTokenPicker(!0)})},t._handleTokenSelectionFromPicker=e=>{t._handleTokenSelectionInternal(e.segment)},t._removeSelection=(e,r)=>{var n=a.Modifier.removeRange(e.getCurrentContent(),r,"forward"),o=a.EditorState.push(e,n,"remove-range"),i=a.EditorState.forceSelection(o,n.getSelectionAfter()),c=t._utility.getValueSegmentsFromDraft(i);t.setState({editorState:i,valueSegments:c},()=>{t._updateValueInStore(c)})},t.getCustomTokenPickerLegacySections=void 0,t.onFormulaFromExamplesOptionClicked=()=>{var e,{selectedEntityKey:r}=t.state,{editorOptions:{displayName:n,schema:o}}=t.props,i=null!=o&&o.type?{schema:o,displayName:null!=n?n:void 0}:{schema:{type:y.a.Swagger.TYPE.ANY},displayName:null!=n?n:void 0};r||t.openTokenPicker(),null===(e=t.formulaFromExamplesRef.current)||void 0===e||e.initializeAndOpen({parameter:i,onApply:e=>t.onFormulaFromExamplesApply(e),onCancel:()=>t.onFormulaFromExamplesCancelled()})},t.onFormulaFromExamplesCancelled=()=>{var e,{editorState:r}=t.state,n=Object(O.x)(r);t.setState({attachTokenPickerToElement:void 0,editorState:n,selectedEntityKey:void 0}),null===(e=t.formulaFromExamplesRef.current)||void 0===e||e.close()},t.onFormulaFromExamplesApply=e=>{var r,{expression:n}=e;t.onNewExpressionValue(n),null===(r=t.formulaFromExamplesRef.current)||void 0===r||r.close()},t.onWatchFormulaFromExamplesTutorial=()=>{var e;null===(e=t.formulaFromExamplesRef.current)||void 0===e||e.openTutorial()},t.parameterService=e.editorContext.getService(v.a.PARAMETER),t.tokenRefMap.set(y.a.DraftJS.EntityTypePlaceholder,c.createRef()),t._utility=e.utility,t._decorators=[{component:w.a,props:{getTokenDataForDisplay:O.l,readOnly:e.editorOptions.readonly,tokenRefMap:t.tokenRefMap,onDelete:t._handleTokenDelete,onSelect:t._handleTokenSelect},strategy:(e,r,n)=>e.findEntityRanges(e=>{var r=e.getEntity();return!(!r||n.getEntity(r).getType()!==N.b)&&(void 0!==n.getEntity(r).getData().expression&&t.tokenRefMap.set(r,c.createRef()),!0)},r)}];var r=e.editorState.value;return t.state={attachTokenPickerToElement:void 0,editorState:a.EditorState.createEmpty(),loading:!0,selectedEntityKey:void 0,valueSegments:r},Object(f.b)(f.a.designerNewTokenPickerV2)&&(t.customKeyBindingFn=Object(g.b)(g.a.OpenDynamicContentPicker,g.a.OpenExpressionEditor,g.a.DebugEditorState),t.customKeyHandlers={[g.a.DebugEditorState]:O.e,[g.a.OpenDynamicContentPicker]:()=>t.openTokenPicker("dynamic"),[g.a.OpenExpressionEditor]:()=>t.openTokenPicker("expression")}),t.getCustomTokenPickerLegacySections=Object(d.a)()?Object(u.a)({onFormulaFromExamplesOptionClicked:t.onFormulaFromExamplesOptionClicked,loggingService:e.loggingService,resources:t._editorContext.designerResources.ExpressionFromExamples.TokenPicker}):void 0,t}return t=L,(b=[{key:"render",value:function(){var e=this.props.editorContext.getService(v.a.TOKEN);return c.createElement(c.Fragment,null,c.createElement(T.a,_({},this.props,{onRenderEditor:this.renderEditor})),Object(f.b)(f.a.designerNewTokenPickerV2)?this.renderTokenPicker():this.renderTokenPickerLegacy(),c.createElement(l.a,{designerEditorContext:this._editorContext,tokenService:e,ref:this.formulaFromExamplesRef}))}},{key:"focus",value:function(){this._textElementRef.current?this._textElementRef.current.focus():this._editorRef.current&&this._editorRef.current.focusEditor()}},{key:"componentDidMount",value:function(){Promise.all([r.e(266).then(r.bind(null,33012)),r.e(267).then(r.bind(null,33023)),r.e(268).then(r.t.bind(null,33032,7))]).then(e=>{var[t,r,n]=e;G.draftJsExportHtml=t,G.draftJsImportHtml=r,G.reactDraftWysiwyg=n;var o=this.props.editorState.value,i=a.EditorState.createEmpty();try{i=this._utility.convertValueSegmentsToEditorState(o)}catch(c){this.props.loggingService.logWarning("HTMLWysiwygEditorEditorStateConversionError",Object(s.z)(c),{stack:Object(s.A)(c)})}this.setState({editorState:i,loading:!1})}).catch(e=>{this.props.loggingService.logError("DesignerEditorLoadFailure",e)})}},{key:"componentWillUnmount",value:function(){this.async.dispose()}},{key:"_updateValueInStore",value:function(e){this.props.onChange({value:e})}}])&&D(t.prototype,b),k&&D(t,k),Object.defineProperty(t,"prototype",{writable:!1}),L}(c.Component),H=Object(b.a)((e,t)=>!!t.editorState&&Object(h.c)(e.editorState.value,t.editorState.value))(W)},20466:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["fl-HtmlWysiwygEditor-root",{position:"relative"}]})},20467:function(e,t,r){"use strict";r.d(t,"b",(function(){return y})),r.d(t,"a",(function(){return h}));var n=r(20163),o=r(14883),i=r(20468),a=r(17244),c=r(20313),s=r(20162),l=r(20469),u=r(20465);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y="LOGICAPP",v=a.a.UIConstants.ZeroWidthChar,h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._isIE=void 0,this._loggingService=void 0,this._segmentsCache=void 0,this.addTokenSegmentInSelection=(e,t,r,o,i,a)=>{var{content:c,selection:s}=i&&o?this.addTextInSelection(e,t,v,1,o):{content:e,selection:t},l=c;l=l.createEntity(y,"IMMUTABLE",{expression:r});var u=this._segmentsCache.size.toString();this._segmentsCache.set(u,r);var p="".concat("S-abcdef1234-S").concat(u).concat("E-abcdef1234-E"),f=n.Modifier.replaceText(l,s,p,o,l.getLastCreatedEntityKey()),d=s.getFocusKey(),m=s.getFocusOffset()+p.length,b=new n.SelectionState({anchorOffset:m,anchorKey:d,focusOffset:m,focusKey:d,isBackward:!1,hasFocus:!0});return a?this.addTextInSelection(f,b,v,1,o):{content:f,selection:b}},this.getSelectionToDeleteBeforeCursor=(e,t)=>{var r=e.getCurrentContent(),o=t.getFocusOffset(),i=t.getFocusKey(),a=r.getBlockForKey(i),c=r.getFirstBlock().getKey()===i,l=a.getText(),u=o-1;if(u>0){for(;l[u]===v;)u--;var p=a.getEntityAt(u);if(p){var f=Object(s.k)(e.getCurrentContent(),p);return f?new n.SelectionState({anchorOffset:f.getAnchorOffset(),anchorKey:f.getAnchorKey(),focusOffset:o,focusKey:f.getFocusKey(),isBackward:!1,hasFocus:!0}):void 0}if(0!==u&&u!==l.length-1&&""!==l[u])return new n.SelectionState({anchorOffset:u,anchorKey:t.getAnchorKey(),focusOffset:u+1,focusKey:i,isBackward:!1,hasFocus:!0})}else if(0===u&&l[0]===v&&this.isListItemBlock(a)&&!c){for(;l[u]===v&&u!==l.length-1;)u++;var d=r.getBlocksAsArray(),m=d.findIndex(e=>e.getKey()===i),b=m>0?d[m-1]:void 0;if(b)return new n.SelectionState({anchorOffset:b.getText().length,anchorKey:b.getKey(),focusOffset:u,focusKey:i,isBackward:!1,hasFocus:!0})}},this.getSelectionToDeleteAfterCursor=(e,t)=>{var r=e.getCurrentContent(),o=t.getFocusOffset(),i=t.getFocusKey(),a=r.getLastBlock().getKey()===i,c=r.getBlockForKey(i),l=c.getText(),u=o;if(u<l.length-1){for(;l[u]===v&&u!==l.length-1;)u++;var p=c.getEntityAt(u);if(p){var f=Object(s.k)(e.getCurrentContent(),p);return f?new n.SelectionState({anchorOffset:o,anchorKey:f.getAnchorKey(),focusOffset:f.getFocusOffset(),focusKey:f.getFocusKey(),isBackward:!1,hasFocus:!0}):void 0}if(u!==l.length-1&&""!==l[u])return new n.SelectionState({anchorOffset:u,anchorKey:t.getAnchorKey(),focusOffset:u+1,focusKey:t.getFocusKey(),isBackward:!1,hasFocus:!0})}else if(u===l.length-1&&l[u]===v&&this.isListItemBlock(c)&&!a){for(;l[u]===v&&u!==l.length-1;)u++;var d=r.getBlocksAsArray(),m=d.findIndex(e=>e.getKey()===i),b=m<d.length?d[m+1]:void 0;if(b)return new n.SelectionState({anchorOffset:o,anchorKey:i,focusOffset:0,focusKey:b.getKey(),isBackward:!1,hasFocus:!0})}},this.getEntitiesInSelection=e=>{for(var t=e.getSelection(),r=t.getAnchorOffset(),n=t.getFocusOffset(),o=e.getCurrentContent(),i=this.getBlocksInSelection(o,t),a=[],c=function(e){i[e].findEntityRanges(e=>{var t=e.getEntity();return null!==t&&(a.push(t),!0)},(t,o)=>{0===e&&o<r&&a.shift(),e===i.length-1&&t>n&&a.pop()})},s=0;s<i.length;s++)c(s);return a},this.getValueSegmentsFromDraft=e=>{var t=u.a.draftJsExportHtml.stateToHTML(e.getCurrentContent(),{inlineStyleFn:this._getInlineStylesFromDraft});return this.convertHtmlToValueSegments(t)},this.updateCachedValueSegment=e=>{var t=e.tokenKey;this._segmentsCache.forEach((r,n)=>{r.tokenKey===t&&this._segmentsCache.set(n,e)})},this.convertHtmlToValueSegments=e=>{for(var t=[],r=e,n=e.indexOf("S-abcdef1234-S"),o=e.indexOf("E-abcdef1234-E"),i=0;r.length;){if(0!==n){var a=(n>-1?r.substring(0,n):r).replace(/\u2060/g,"");t.push(Object(c.f)(a))}if(n>-1&&o>-1){var s=r.substring(n+"S-abcdef1234-S".length,o),l=this._segmentsCache.get(s);l&&(t.push(l),n=(r=r.substr(o+"E-abcdef1234-E".length)).indexOf("S-abcdef1234-S"),o=r.indexOf("E-abcdef1234-E"))}else r="";if(++i>=1e4){this._loggingService.logWarning("DraftHtmlUtility.convertHtmlToValueSegments","Exceeded the maximum number of HTML evaluation iterations (".concat(1e4,")."));break}}return t.length?t:[Object(c.f)("")]},this.convertValueSegmentsToHtml=e=>{var t="";for(var r of e)if(Object(c.q)(r)){var n=this._segmentsCache.size.toString();this._segmentsCache.set(n,r);var o="".concat("S-abcdef1234-S").concat(n).concat("E-abcdef1234-E");t+="&#x2060;",t+='<object custom="'.concat(y,'">').concat(o,"</object>"),t+="&#x2060;"}else t+=r.tokenExpression;return t},this.convertValueSegmentsToEditorState=e=>{var t=this.convertValueSegmentsToHtml(e),r=u.a.draftJsImportHtml.stateFromHTML(t,{customInlineFn:this._getEntityAndStyleFromHtml});return n.EditorState.createWithContent(r)},this.copyDataInClipboard=(e,t)=>{var r=e.getCurrentContent(),n=e.getSelection(),o=this.getTextInSelectedBlocks(r,n),i=this.convertHtmlToValueSegments(o),a=Object(l.c)(i),u="";for(var p of i)u+=Object(c.q)(p)?"@{".concat(p.tokenExpression,"}"):p.tokenExpression;this._isIE?t.clipboardData.setData(s.a.IE_TEXT,u):(t.clipboardData.setData(s.a.HTML,a),t.clipboardData.setData(s.a.TEXT,u))},this.pasteClipboardDataInEditorState=(e,t,r,o)=>{var i=[];!o||!this._isIE&&t?t&&(i=Object(l.b)(t)):i=o.getValueSegmentsFromRawValue(r),i&&i.length||(i=Object(l.a)(r));var a=e.getCurrentInlineStyle(),s=e.getCurrentContent(),u=e.getSelection();for(var p of i){var f,d,m,{content:b,selection:y}=Object(c.q)(p)?this.addTokenSegmentInSelection(s,u,p,a,!0,!0):this.addTextInSelection(s,u,null!==(f=p.tokenExpression)&&void 0!==f?f:"",null!==(d=null===(m=p.tokenExpression)||void 0===m?void 0:m.length)&&void 0!==d?d:0,a);s=b,u=y}var v=n.EditorState.push(e,s,"insert-characters");return n.EditorState.forceSelection(v,u)},this.getTextInSelectedBlocks=(e,t)=>{for(var r=this.getBlocksInSelection(e,t),n=t.getStartOffset(),o=t.getEndOffset(),i="",a=0;a<r.length;a++){var c=r[a].getText();0===a?i+=a!==r.length-1?c.substr(n):c.substring(n,o):a===r.length-1?i+=c.substring(0,o):i+=c}return i},this.wouldHtmlViewChangeContent=e=>{var t=this.convertValueSegmentsToHtml(e),r=this.normalizeHtmlForHtmlView(t,!0);return{enforceFailed:null===r,wouldMutate:t!==r}},this._getEntityAndStyleFromHtml=(e,t)=>{if(Object(o.e)(e.tagName,"object")){var r=e.getAttribute("custom");if(r&&Object(o.e)(r,y)&&e.textContent){var n=e.textContent,i=n.substring("S-abcdef1234-S".length,n.indexOf("E-abcdef1234-E")),a=this._segmentsCache.get(i);return t.Entity(y,{expression:a},"IMMUTABLE")}}var c=e.getAttribute("style");if(c){var s=c.split(";").filter(e=>!!e).map(this.toEditorStyle);return t.Style(s[0])}},this._getInlineStylesFromDraft=e=>{var t=e.filter(e=>!!e&&!this.isBlockStyle(e)).map(this.toHtmlStyle),r={};for(var n of t.toArray())r=f(f({},r),n);return t.size?{element:"span",style:r}:null},this._isIE=/MSIE \d|Trident.*rv:/.test(navigator.userAgent),this._loggingService=t,this._segmentsCache=new Map}var t,r,a;return t=e,(r=[{key:"findLogicAppEntities",value:function(e,t,r){e.findEntityRanges(e=>{var t=e.getEntity();return null!==t&&r.getEntity(t).getType()===y},t)}},{key:"isListItemBlock",value:function(e){var t=e.getType();return"unordered-list-item"===t||"ordered-list-item"===t}},{key:"isPlaceholderAtOffset",value:function(e,t,r){return e.getCurrentContent().getBlockForKey(t.getFocusKey()).getText()[r]===v}},{key:"getBlocksInSelection",value:function(e,t){for(var r=e.getBlocksAsArray(),n=r.map(e=>e.getKey()),o=n.indexOf(t.getStartKey()),i=n.indexOf(t.getEndKey()),a=[],c=o;c<=i;c++)a.push(r[c]);return a}},{key:"addTextInSelection",value:function(e,t,r,o,i){var a=n.Modifier.replaceText(e,t,r,i),c=t.getFocusKey(),s=t.getFocusOffset()+o;return{content:a,selection:new n.SelectionState({anchorOffset:s,anchorKey:c,focusOffset:s,focusKey:c,isBackward:!1,hasFocus:!0})}}},{key:"isBlockStyle",value:function(e){return!!e&&(Object(o.e)(e,"bold")||Object(o.e)(e,"code")||Object(o.e)(e,"italic")||Object(o.e)(e,"strikethrough")||Object(o.e)(e,"underline"))}},{key:"toEditorLocale",value:function(e){if(!e)return"en";switch(e.toLowerCase()){case"en":case"de":case"da":case"es":case"fr":case"it":case"ja":case"ko":case"nl":case"pl":case"ru":return e;case"zh-hans":return"zh";case"zh-hant":return"zh-tw";case"pt-br":case"pt-pt":return"pt";default:return"en"}}},{key:"toHtmlStyle",value:function(e){if(!e)return{};var t=e.split("-"),r=t[0].toLowerCase(),n=t[1].toLowerCase();switch(r){case"fontfamily":r="font-family";break;case"fontsize":r="font-size";break;case"bgcolor":r="background-color"}return r&&n?{[r]:n}:{}}},{key:"toEditorStyle",value:function(e){var t=e.split(":"),r=Object(i.a)(t[0]," ").toLowerCase(),n=Object(i.a)(t[1]," ").toLowerCase();switch(r){case"font-family":r="fontfamily";break;case"font-size":r="fontsize",n=n.substring(0,n.length-2);break;case"background-color":r="bgcolor"}return r&&n?"".concat(r,"-").concat(n):""}},{key:"isAllowedTagForHtmlView",value:function(e,t){if(!e)return!1;var r=new Set(["p","br","strong","em","u","span","ul","li","ol","a","object"]),n=e[3].toLowerCase();if(!r.has(n))return!1;if("object"===n){var o=e[1],i=void 0===o?0:o.length;if(!o||i<"&#x2060;".length)return!1;var a="".concat("S-abcdef1234-S","\\d+").concat("E-abcdef1234-E"),c=".*".concat("&#x2060;",'<object custom="').concat(y,'">').concat(a,"</object>").concat("&#x2060;",".*"),s=new RegExp(c,""),l=e.input.substring(e.index).trim().match(s);if(null===l||l.index>t.lastIndex)return!1}return!0}},{key:"normalizeHtmlForHtmlView",value:function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Set(["p","ul","ol"]),o=new Set(["br","hr"]),i=0,a=!1,c=!1,s=[],l=new RegExp("([^<]*)(</?([^>\\s/]+)\\s*[^>]*/?>)|([^<]+)","ig");t=l.exec(e);){var u=t[1],p=void 0===u?0:u.length,f=t[2],d=t[3];if(r&&d){if(!this.isAllowedTagForHtmlView(t,l))return null;if("object"===d){c&&0!==i||(s.push(t.index),++i,a=!0);var m="&#x2060;".length,b=e.indexOf("&#x2060;",l.lastIndex);l.lastIndex=b+m;continue}}var y=t[4];if(void 0===y){var v="/"===f[1];if(v)v&&i>0&&("p"===d?(i=0,a=!1,c=!1):--i);else{if("p"===d&&(c||a)&&(i=0,a=!1,c=!0),0===i&&!c&&!a){var h=p>0&&-1!==u.search(/\\S/);!h&&n.has(d)||(s.push(t.index),++i,a=!0)}var g="/"===f[f.length-1]||o.has(d);g||(++i,"p"===d&&(c=!0))}}else 0!==i||c||a||(s.push(t.index),++i,a=!0)}if(0===s.length)return e;var O="",w=0,E=0;for(E of s)O+="".concat(e.substring(w,E),"<p>"),w=E;return E<e.length&&(O+=e.substring(E)),O}}])&&m(t.prototype,r),a&&m(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20468:function(e,t,r){"use strict";function n(e,t){var r=e;return r.length<t.length?e:(r.startsWith(t)&&(r=r.length>1?r.substr(t.length):""),r.endsWith(t)&&(r=r.length>1?r.substring(0,r.length-t.length):""),r)}r.d(t,"a",(function(){return n}))},20469:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return p}));var n=r(20313),o=r(12728),i=r(13051);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){try{var t=JSON.parse(e);return function(e){return Object(i.h)(e,{source:i.k,value:i.a})&&"la-draft-clipboard"===e.source}(t)?t.value.map(e=>c(c({},e),{},{tokenKey:Object(o.a)()})):[Object(n.f)(e)]}catch(r){return[Object(n.f)(e)]}}function u(e){var t;try{(t=document.createElement("draft")).innerHTML=e;var r=t.querySelector("clipboard");return r&&r.textContent?l(r.textContent):[]}catch(n){return[]}finally{t=null}}function p(e){var t,r,n=function(e){try{return JSON.stringify({source:"la-draft-clipboard",value:e})}catch(t){return""}}(e);if(!n)return"";try{return t=document.createElement("draft"),(r=document.createElement("clipboard")).textContent=n,t.appendChild(r),t.outerHTML}finally{t=null,r=null}}},20470:function(e,t,r){"use strict";r.d(t,"a",(function(){return D}));var n=r(11766),o=r(12706),i=r(12839),a=r(12728),c=r(12811),s=r(20323),l=r(20313),u=r(20326),p=r(20471),f=r(15497),d=r(20472),m=r(13272),b=r(16889),y=r(14680),v=r(14681),h=r(13259),g=r(20425),O=r(13031),w=r(15646),E=r(14682),C=r(19713),S=r(18968);function P(){return(P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function T(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function k(e,t){return(k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=_(e);if(t){var o=_(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return x(this,r)}}function x(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return N(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(_,e);var t,r,T,x=R(_);function _(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),(t=x.call(this,e)).customValueDropdownRef=n.createRef(),t.getClassNames=Object(o.a)(),t.classNames=t.getClassNames(p.a),t.async=new i.a(N(t)),t.labelId=Object(a.a)("CustomDropdownEditor"),t.transientCustomValueSegment=void 0,t._editorContext=Object(C.a)(),t.renderEditor=e=>{if(!e)return null;var{customOption:r,dropdownOptions:o,selectedKey:i}=t.state,{designerResources:a,globalResources:s}=t._editorContext,{dropdownProps:l}=t.props,u=l&&l.onRenderCustomAddAction,p=l&&l.hasMore,f=o||l&&l.options||[],m=l&&l.onShowMoreClick,b=Object(g.h)(t.props);return n.createElement("div",{className:Object(c.a)(e.containerClassName,t.classNames.container)},n.createElement(d.a,{ref:t.customValueDropdownRef,addCustomItemText:a.Designer.Editors.CustomValue.AddCustomItem,calloutProps:{calloutMinWidth:null!=l&&l.enforceMinimumCalloutWidth?190:void 0,onDismiss:t.onDismissDropdownCallout},className:Object(c.a)(e.editorClassName,t.classNames.customValueDropdown),onRenderAddCustomAction:u,customOptions:r?[r]:void 0,hideCustomAdd:!!r||!!u,isLoading:b,selectedKey:i,hasMoreOptions:p,options:f,placeholder:b?s.Common.Loading:a.Designer.Editors.CustomValue.Placeholder,onClickAddCustomItem:t.onClickAddCustomItem,onChange:t.onDropdownChange,onRenderEmptyResults:t.renderEmpty,onRenderListOption:t.renderListOption,onRenderHeader:t.renderHeader,onShowMoreActionClick:m,labelledById:t.labelId,clientResources:t._editorContext.globalResources,hideInternalValue:t._editorContext.designerHostContextStore.getContext().isDiet}),t.renderEditButton(),t.renderEditCustomItem())},t.renderEmpty=()=>{var e,r,{error:o,searchText:i}=t.state,{designerResources:a,globalResources:c}=t._editorContext;return i?(e=Object(O.a)(a.Designer.Editors.CustomValue.Empty.SearchTitle,i),r=a.Designer.Editors.CustomValue.Empty.SearchMessage):o?(e=a.Designer.Editors.CustomValue.Empty.ErrorTitle,r=o.message||c.Common.SomethingWentWrongShort):(e=a.Designer.Editors.CustomValue.Empty.ItemsTitle,r=a.Designer.Editors.CustomValue.Empty.ItemsMessage),n.createElement("div",{className:t.classNames.emptyResultsContainer},n.createElement("div",{className:t.classNames.emptyResultsTitle},e),n.createElement("div",{className:t.classNames.emptyResultsMessage},r))},t.renderHeader=()=>n.createElement("div",{className:t.classNames.header},n.createElement(v.a,{disabled:!!t.state.error,placeholder:t._editorContext.globalResources.Entity.Search,onChange:t.searchChangeDebounced,onEscape:t.onDismissDropdownCallout,required:!1}),!Object(g.j)(t.props)&&n.createElement(h.a,{title:t._editorContext.globalResources.Common.Refresh,iconName:m.a.Refresh,onClick:t.refreshData})),t.renderListOption=(e,r)=>n.createElement(n.Fragment,null,r&&e&&r(e),t.state.customOption&&e&&t.state.customOption.key===e.key&&t.renderCustomItemOptions(e)),t.renderListItemIcon=()=>n.createElement("div",{className:t.classNames.listItemIcon}),t.renderCustomItemOptions=e=>{var r=[{iconProps:{iconName:m.a.Edit},key:"edit",name:t._editorContext.globalResources.Common.Edit,onClick:t.onClickAddCustomItem,[E.a]:"dropdown-edit"}];return n.createElement(b.a,{className:t.classNames.customItemAction,actions:r,globallyUniquePrefix:Object(a.a)(),overflowActions:[]})},t.renderEditCustomItem=()=>n.createElement(f.b,{className:t.classNames.customItemDialog,hidden:!t.state.isEditingCustomItem,maxWidth:600,primaryButtonProps:{primary:!0,disabled:t.props.editorOptions.readonly,onClick:t.onDialogOk,text:t._editorContext.globalResources.Common.Ok},title:t._editorContext.designerResources.Designer.Editors.CustomValue.AddCustomItem,onDismiss:t.onDialogDismiss},n.createElement(u.a,t.getCustomItemEditorProps())),t.searchChangeDebounced=t.async.debounce(e=>{t.setState({searchText:e})},w.a),t.onDismissDropdownCallout=()=>{t.async.setTimeout(()=>{t.setState({searchText:void 0})},w.a),t.customValueDropdownRef.current&&t.customValueDropdownRef.current.dismissDropdown()},t.refreshData=()=>{var e,{dropdownProps:r}=t.props,n=r&&r.onRefresh;return n?n():null===(e=t.props.editorOptions.dynamicData)||void 0===e?void 0:e.refresh()},t.getCustomItemEditorProps=()=>({editorState:{value:t.state.customOptionValueSegment||[]},editorContext:t.props.editorContext,editorOptions:t.props.editorOptions,onChange:t.customItemEditorOnChange}),t.onDropdownChange=(e,r)=>r&&t.onDropDownChangeInternal(r),t.onDropDownChangeInternal=e=>{e.key===g.a?t.props.onChange({value:t.state.customOptionValueSegment||[]}):t.props.onChange({value:[Object(l.d)(e.key.toString(),e.text)]}),t.setState({selectedKey:e.key.toString(),searchText:void 0})},t.onClickAddCustomItem=()=>{t.transientCustomValueSegment=t.state.customOptionValueSegment,t.setState({isEditingCustomItem:!0})},t.onDialogOk=()=>{t.setState({selectedKey:g.a,customOptionValueSegment:t.transientCustomValueSegment,isEditingCustomItem:!1},()=>{t.state.customOption&&t.onDropDownChangeInternal(t.state.customOption),t.clearTransientCustomValue()})},t.onDialogDismiss=()=>{t.clearTransientCustomValue(),t.setState({isEditingCustomItem:!1})},t.customItemEditorOnChange=e=>{e.value&&e.value[0]&&e.value[0].tokenExpression&&""===e.value[0].tokenExpression.trim()&&(e.value[0].tokenExpression=""),t.transientCustomValueSegment=e.value},t.clearTransientCustomValue=()=>{t.transientCustomValueSegment=[]};var{dynamicData:r}=t.props.editorOptions;return!Object(g.k)(e)&&r&&void 0===r.status&&r.refresh(),t.state=Object(g.f)(),t}return t=_,T=[{key:"getDerivedStateFromProps",value:function(e,t){var r,n,o,i,a,{editorOptions:c,editorState:s}=e,{customOption:l,isEditingCustomItem:u,selectedKey:p,searchText:f}=t,d=f?f.trim():void 0,m=Object(g.f)({isEditingCustomItem:u,prevEditorStateValue:s.value,searchText:d});return Object(g.h)(e)?m:(n=Object(g.e)(e,d),a=Object(g.e)(e),t.unfilteredDropdownOptions&&t.unfilteredDropdownOptions.length!==a.length?(Object(S.b)(c.connectorId)||e.onChange({value:[]}),m.dropdownOptions=a,m.unfilteredDropdownOptions=a,m):(r=l,o=p!==Object(g.g)(e)&&p!==g.a?Object(g.g)(e):p,i=Object(g.c)(e,t,o),Object(g.i)(n,!!d,o,l)&&(r={data:{description:Object(C.a)().designerResources.Designer.Editors.CustomValue.CustomValue},disabled:c.readonly,key:g.a,text:Object(g.d)(Object(C.a)().designerResources.Designer.Editors.CustomValue.CustomValue,i)},o=g.a),m.customOption=r,m.customOptionValueSegment=i,m.dropdownOptions=n,m.error=c.dynamicData&&c.dynamicData.error,m.selectedKey=o,m.unfilteredDropdownOptions=a,m))}}],(r=[{key:"render",value:function(){return n.createElement(s.a,P({},this.props,{onRenderEditor:this.renderEditor,labelId:this.labelId}))}},{key:"renderEditButton",value:function(){var e=Object(g.h)(this.props),{dropdownProps:t}=this.props,r=t&&t.editSelectedOptionButtonProps;return r?n.createElement(y.a,P({},r,{disabled:e||this.props.editorOptions.readonly||!this.state.selectedKey})):null}},{key:"componentWillUnmount",value:function(){this.async.dispose()}}])&&j(t.prototype,r),T&&j(t,T),Object.defineProperty(t,"prototype",{writable:!1}),_}(n.Component)},20471:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{root:["fl-CustomDropdownEditor",{}],container:["fl-CustomDropdownEditor-container",{display:"flex"}],customValueDropdown:["fl-CustomDropdownEditor-customValueDropdown",{flexGrow:1}],emptyResultsContainer:["fl-CustomDropdownEditor-EmptyResultsContainer",{color:e.neutralSecondary,minHeight:150,overflowY:"auto",padding:20,textAlign:"center"}],emptyResultsMessage:["fl-CustomDropdownEditor-EmptyResultsMessage",{fontSize:n.k.smallPlus,margin:10}],emptyResultsTitle:["fl-CustomDropdownEditor-EmptyResultsTitle",{fontWeight:n.l.semibold}],header:["fl-CustomDropdownEditor-Header",{display:"flex",margin:10,selectors:{".fl-SearchBox":{flexGrow:1,width:"calc(100% - 32px)"},[n.m]:{".ms-Button":{backgroundColor:"ButtonFace"}}}}],listItemIcon:["fl-CustomDropdownEditor-ListItem-Icon",{alignItems:"center",display:"flex",justifyContent:"center"}],customItemAction:["fl-CustomDropdownEditor-CustomItem-Action",{".fl-ActionMenu-item":{height:40,backgroundColor:"transparent",":focus, :hover":{backgroundColor:e.neutralLight}},".ms-Button-label":{display:"none"},".ms-Button-icon":{position:"absolute"}}],customItemDialog:["fl-CustomDropdownEditor-Dialog",{selectors:{".ms-Dialog-main":{overflowY:"visible",width:"40%"},".ms-Modal-scrollableContent, .ms-Dialog--close":{display:"initial"},".msla-label":{margin:0}}}]}}},20474:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(17244),o=r(14883);function i(e){if(e.enum)return!0;var t=e[n.a.Swagger.EXTENSION.DYNAMIC_LIST],r=e[n.a.Swagger.EXTENSION.DYNAMIC_VALUES],o=e[n.a.Swagger.EXTENSION.ENUM_VALUES];return!(!t||t.builtInOperation)||(!(!r||r.capability||r.builtInOperation)||(!!o||!!e.schema&&i(e.schema)))}function a(e){var t=e[n.a.Swagger.EXTENSION.DYNAMIC_TREE],r=e[n.a.Swagger.EXTENSION.DYNAMIC_VALUES];return!!(r&&r.capability&&Object(o.e)(r.capability,n.a.Capability.FILE_PICKER))||!!t}},20475:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r(11766),o=(r(20158),r(20160),r(20162)),i=r(20321),a=r(20313),c=r(20412),s=r(20413),l=r(16824),u=r(13016),p=r(20415),f=r(20419),d=r(20157),m=r(19713);function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function v(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=C(e);if(t){var o=C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){g(r,e);var t=w(r);function r(e){var n;b(this,r),(n=t.call(this,e))._childEditorRef=void 0,n._editorContext=Object(m.a)(),n.onAdaptiveCardEditorReadyError=e=>{n.setState({errorMessage:e})},n.onLaunchButtonClick=()=>{n.setState({isEditing:!0,errorMessage:void 0})},n.onSave=e=>{var t=n.props.editorContext.getService(i.a.PARAMETER).getValueSegmentsFromRawValue(e);n.setState({value:e}),n.props.onChange({value:t})},n.onCancel=()=>{n.setState({isEditing:!1})};var a=Object(o.j)(n.props.editorState.value);return n.state={isEditing:!1,value:""===a.trim()?d.c:a,shouldRenderCardEditor:!0},n}return v(r,[{key:"render",value:function(){var{value:e,isEditing:t}=this.state,{editorOptions:r}=this.props;return n.createElement("div",null,n.createElement(c.a,{contentErrorMessage:this.state.errorMessage,buttonMode:e===d.c?s.b.Create:s.b.Edit,isContentLoading:!1,parameterName:this._editorContext.designerResources.AdaptiveCardEditor.title,readonly:r.readonly,isEditing:t,onPanelClose:this.onCancel,onLaunchedButtonClick:this.onLaunchButtonClick,editorType:s.c.AdaptiveCard},this.renderError(),n.createElement(p.a,{value:e,dictionaryItems:[],onSave:this.onSave,bindTokens:!1,onAdaptiveCardEditorReadyError:this.onAdaptiveCardEditorReadyError})))}},{key:"focus",value:function(){this._childEditorRef&&this._childEditorRef.focus()}},{key:"renderError",value:function(){var e=this.state.errorMessage;return e?n.createElement(l.a,{type:u.c.error,ariaLabel:e,message:e}):null}}]),r}(n.Component),P=Object(f.a)((e,t)=>!!t.editorState&&Object(a.c)(e.editorState.value,t.editorState.value))(S),j=function(e){g(r,e);var t=w(r);function r(){return b(this,r),t.apply(this,arguments)}return v(r,[{key:"render",value:function(){return n.createElement(P,this.props)}}]),r}(n.Component)},20476:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(11766),o=r(20323),i=r(20477),a=r(20480),c=r(20321),s=["editorOptions"],l=["hideLabel"];function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(y,e);var t,r,p,d=h(y);function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=d.call(this,e)).firstTableRowRef=n.createRef(),t.parameterService=void 0,t.state={lastSelectedCellId:""},t.renderTableCell=(e,r)=>{var i=t.resolveCell(r.itemKey),a=t.props,{editorOptions:{hideLabel:c}}=a,p=m(a.editorOptions,l),d=m(a,s),b=f({hideLabel:!0},p),y={editorOptions:f({},b)},v=f(f({},y),d);return n.createElement(o.a,u({},v,{onRenderEditor:r=>t.renderEditor(i,e,r)}))},t.renderEditor=(e,r,o)=>{var{editorContext:i,editorOptions:{locale:c,readonly:s,showTokenPicker:l,summary:u}}=t.props,p=l&&e&&t.state.lastSelectedCellId.length>0&&t.state.lastSelectedCellId===e.id;return e?n.createElement(a.a,{key:e.id,editorContext:i,item:e.value,locale:null!=c?c:"en",readOnly:s,summary:null!=u?u:"",showTokenPicker:null!=p&&p,onChange:t=>r(e.id,t),onBlur:r=>t.onTableCellBlur(e,r),onFocus:r=>t.onTableCellFocus(e,r)}):null},t.onTableCellBlur=(e,r)=>{t.props.editorOptions.showTokenPicker||t.state.lastSelectedCellId!==e.id||t.setState({lastSelectedCellId:""})},t.onTableCellFocus=(e,r)=>{t.setState({lastSelectedCellId:e.id})},t.resolveCell=e=>{var r=t.parameterService.getParameterInfo();return r&&r.viewModel?r.viewModel.items[e]:null},t.parameterService=e.editorContext.getService(c.a.PARAMETER),t}return t=y,(r=[{key:"render",value:function(){var e,t=null===(e=this.props.editorState.complexValue)||void 0===e?void 0:e.editorState;return n.createElement("div",{className:"msla-dynamic-table"},this.renderTable(t))}},{key:"renderTable",value:function(e){var{editorOptions:{readonly:t}}=this.props,{addTableItem:r,columns:o,rows:i}=e;return n.createElement("table",{className:"msla-table",style:{borderSpacing:"0 24px"}},this.renderHeader(o),this.renderBody(o,i,t,r))}},{key:"renderHeader",value:function(e){return n.createElement("thead",null,n.createElement("tr",null,e.map(e=>n.createElement("th",{key:e.key},e.title))))}},{key:"renderBody",value:function(e,t,r,o){var a=t&&t.length>0?t[t.length-1].key:null;return n.createElement("tbody",null,t.map((c,s)=>n.createElement(i.a,{ref:0===s&&this.firstTableRowRef.current?this.firstTableRowRef:void 0,key:c.key,id:c.key,columns:e,data:c.data,disabled:r,addItem:o,onDelete:s!==t.length-1?c.onDelete:()=>{},onRenderCell:e=>this.renderTableCell(c.onUpdate,e),isLastItem:c.key===a,countRows:t.length,resolveCell:this.resolveCell})))}},{key:"focus",value:function(){this.firstTableRowRef.current&&this.firstTableRowRef.current.focus()}},{key:"scrollIntoView",value:function(e){this.firstTableRowRef.current&&this.firstTableRowRef.current.scrollIntoView(e)}}])&&b(t.prototype,r),p&&b(t,p),Object.defineProperty(t,"prototype",{writable:!1}),y}(n.Component)},20477:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(12854),o=r(11766),i=r(12706),a=r(20478),c=r(20479),s=r(19713);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y={iconName:"Cancel"},v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(b,e);var t,r,p,m=d(b);function b(){var e;l(this,b);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=m.call(this,...r)).tableRowRef=o.createRef(),e.getClassNames=Object(i.a)(),e.classNames=e.getClassNames(a.a),e._editorContext=Object(s.a)(),e.renderRow=(t,r)=>o.createElement(o.Fragment,null,t.map(t=>o.createElement("td",{className:e.classNames.root,key:t.key},e.props.onRenderCell(r[t.key])))),e.handleDelete=t=>{var{onDelete:r}=e.props;r&&r()},e.onFocus=()=>{var{columns:t,data:r,resolveCell:n}=e.props;e.props.isLastItem&&Object(c.a)(t,r,n)&&e.props.addItem()},e}return t=b,(r=[{key:"render",value:function(){var{columns:e,data:t,disabled:r,id:n}=this.props,i=r?-1:0;return o.createElement("tr",{ref:this.tableRowRef,"aria-disabled":r,className:"msla-table-row",tabIndex:i,onFocus:this.onFocus},this.renderRow(e,t),this.renderDelete(n))}},{key:"renderDelete",value:function(e){var{disabled:t,onDelete:r}=this.props,i=this.props.countRows>1&&!this.props.isLastItem;return t||!i?null:o.createElement("td",{key:"".concat(e,"-delete")},o.createElement(n.a,{"aria-label":this._editorContext.designerResources.Designer.Editors.Table.ClickToDeleteItem,className:"msla-button msla-table-row-delete-button",iconProps:y,title:this._editorContext.designerResources.Designer.Editors.Table.ClickToDeleteItem,onClick:this.handleDelete}))}},{key:"focus",value:function(){this.tableRowRef.current&&this.tableRowRef.current.focus()}},{key:"scrollIntoView",value:function(e){this.tableRowRef.current&&this.tableRowRef.current.scrollIntoView(e)}}])&&u(t.prototype,r),p&&u(t,p),Object.defineProperty(t,"prototype",{writable:!1}),b}(o.Component)},20478:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-TableRow",{verticalAlign:"top",width:"100%",selectors:{"&(tr > td:first-child)":{selectors:{".fl-defaultEditor":{borderLeft:"none"}}}}}]})},20479:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(20406);function o(e,t,r){for(var o=!1,i=0;i<e.length;++i){var a=r(t[e[i].key].itemKey);if(a&&!Object(n.f)(a.value)){o=!0;break}}return o}},20480:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(11766),o=r(20326),i=r(12706),a=r(20481);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,r,u,d=f(m);function m(){var e;s(this,m);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=d.call(this,...r)).getClassNames=Object(i.a)(),e.classNames=e.getClassNames(a.a),e}return t=m,(r=[{key:"render",value:function(){var{editorContext:e,item:t,locale:r,onBlur:i,onChange:a,onFocus:s,readOnly:l,summary:u,showTokenPicker:p}=this.props,f={editorState:{value:t},editorOptions:{displayName:null,hideLabel:!0,locale:r,readonly:l,showTokenPicker:p,validationErrors:[],summary:u},editorContext:e,onChange:e=>{a(e.value)}};return n.createElement("div",{className:this.classNames.root},n.createElement(o.a,c({className:this.classNames.cell,onFocus:s,onBlur:i},f)))}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component)},20481:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-TableCell",{verticalAlign:"top",width:"100%"}],cell:["fl-TableCellDefaultEditor",{width:"100%",selectors:{".fl-DefaultEditor":{borderStyle:"dashed",minHeight:"30px"}}}]})},20482:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r(12940),o=r(12706),i=r(11766),a=r(13259),c=r(13272),s=r(20321),l=r(20313),u=r(20397),p=r(19713),f=r(20326),d=r(20406),m=r(20426),b=r(20483),y=r(20484),v=r(20486);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=P(e);if(t){var o=P(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(P,e);var t,r,O,C=E(P);function P(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,P),(t=C.call(this,e)).getClassNames=Object(o.a)(),t.classNames=t.getClassNames(b.a),t.toggleRef=i.createRef(),t.parameterService=void 0,t._editorContext=Object(p.a)(),t.renderEditor=()=>{var{editorState:e}=t.props,r={editorState:{value:Object(l.l)(e.value[0])?Object(d.e)(Object(d.b)(e.value)):e.value},editorOptions:{displayName:t.props.editorOptions.displayName,locale:null,readonly:t.props.editorOptions.readonly,validationErrors:t.props.editorOptions.validationErrors,summary:t.props.editorOptions.summary,showTokenPicker:t.state.isFocused},editorContext:t.props.editorContext,onChange:t.props.onChange};return i.createElement(f.a,h({},t.props,r,{onFocus:t.handleOnFocus,onBlur:t.handleOnBlur,renderMenubarChildren:t.renderTogglePicker}))},t.renderTogglePicker=()=>i.createElement("div",{ref:t.toggleRef},i.createElement(a.a,{disabled:t.props.editorOptions.readonly,iconName:c.a.FolderSearch,title:t._editorContext.designerResources.Designer.Editors.FolderPicker.TogglePicker,onClick:t.handleTogglePickerClicked})),t.onDismissPicker=()=>{t.setState({showPicker:!1})},t.handleOnFocus=()=>{var{editorState:e,onChange:r}=t.props;r(e),t.setState({isFocused:!0})},t.handleOnBlur=e=>{var{editorState:r,onChange:n}=t.props;n(r),Object(u.b)(e)||t.setState({isFocused:!1})},t.togglePicker=()=>{t.setState({showPicker:!t.state.showPicker})},t.renderPicker=()=>{var{showPicker:e}=t.state;return e?i.createElement(n.a,{target:t.toggleRef.current},i.createElement("div",null,t._editorContext.designerResources.Designer.Editors.FolderPicker.Title),i.createElement("div",{className:t.classNames.folderPicker},t.renderPickerHeader(),t.renderItems())):null},t.renderPickerHeader=()=>{var e,r=null===(e=t.parameterService)||void 0===e||null===(e=e.getParameterInfo())||void 0===e||null===(e=e.pickerInfo)||void 0===e?void 0:e.titleSegments;if(!r||!r.length||r.length<=0)return null;var n=[],o=r.slice(0,r.length-1).map(e=>t.renderTitleSegment(e)),a=t.renderTitleSegment(r.slice(-1)[0],!0);return(n=n.concat(o)).push(a),i.createElement("div",{className:t.classNames.folderPickerTitleContainer},i.createElement("ul",{className:t.classNames.folderPickerTitle},n))},t.renderTitleSegment=(e,r)=>i.createElement("li",{key:e.titleKey,className:t.classNames.folderPickerTitleSegment},i.createElement(v.a,{ref:e.titleKey,titleKey:e.titleKey,isRoot:e.isRoot,title:e.title,value:e.value,navigationEnabled:!r,onSelect:t.onTitleSegmentClicked})),t.renderItems=()=>{var{items:e,isLoading:r}=t.state;return e.length?r?t.renderMessage(t._editorContext.designerResources.Designer.Editors.FolderPicker.Loading.Text):i.createElement("table",{className:t.classNames.folderPickerItemTable},e.map(e=>t.renderPickerItemInTable(e))):t.renderMessage(t._editorContext.designerResources.Designer.Editors.FolderPicker.No.Items)},t.renderPickerItemInTable=e=>i.createElement(y.a,{itemKey:e.key,dynamicState:e.dynamicState,fullyQualifiedDisplayName:e.fullyQualifiedDisplayName,title:e.displayName,value:e.value,onNavigate:t.onNavigateFolderClicked,onSelect:t.onSelectFolderClicked}),t.renderMessage=e=>i.createElement("div",null,e),t.convertToFolderData=()=>{var{dynamicData:e}=t.props.editorOptions,r=e;if(r&&void 0!==r.status&&r.values){var n,o,i=null===(n=t.parameterService)||void 0===n?void 0:n.getParameterInfo(),a="";if((null==i||null===(o=i.pickerInfo)||void 0===o||null===(o=o.titleSegments)||void 0===o?void 0:o.length)>1){for(var c=1;c<i.pickerInfo.titleSegments.length;c++)a+=i.pickerInfo.titleSegments[c].title?"/"+i.pickerInfo.titleSegments[c].title:"";a+="/"}var s=r.values.map(e=>({key:e.value||e.data&&e.data.value&&e.data.value.id,displayName:e.displayName,dynamicState:e.data&&e.data.dynamicState,fullyQualifiedDisplayName:a+e.displayName,title:e.data&&e.data.displayName,value:e.data&&e.data.value}));t.setState({currentPath:a,items:s,isLoading:!1})}},t.handleTogglePickerClicked=e=>{var r,n=null===(r=t.parameterService)||void 0===r?void 0:r.getParameterInfo();n&&n.pickerInfo&&(!n.pickerInfo.titleSegments||0===n.pickerInfo.titleSegments.length)&&n.pickerInfo.onShowPicker&&n.pickerInfo.onShowPicker({currentTarget:S(t),parameterId:n.id,type:n.type}),t.togglePicker()},t.onNavigateFolderClicked=e=>{var r,n=null===(r=t.parameterService)||void 0===r?void 0:r.getParameterInfo();n&&n.pickerInfo&&n.pickerInfo.onFolderNavigated&&n.pickerInfo.onFolderNavigated({parameterId:n.id,value:e})},t.onTitleSegmentClicked=e=>{var r,n=null===(r=t.parameterService)||void 0===r?void 0:r.getParameterInfo();n&&n.pickerInfo&&n.pickerInfo.onTitleSelected&&n.pickerInfo.onTitleSelected({parameterId:n.id,value:e})},t.onSelectFolderClicked=e=>{var r=e.selected.value,n=e.selected.fullyQualifiedDisplayName;t.props.onChange({value:[Object(l.d)(r,n)]}),t.setState({showPicker:!1})},t.state={currentPath:"/",items:[],showPicker:!1,isLoading:!0,isFocused:!1},t.parameterService=t.props.editorContext.getService(s.a.PARAMETER),t}return t=P,(r=[{key:"componentDidMount",value:function(){var{dynamicData:e}=this.props.editorOptions;e&&void 0===e.status&&e.refresh()}},{key:"componentDidUpdate",value:function(e){var{dynamicData:t}=this.props.editorOptions,r=e.editorOptions.dynamicData;t&&t.status===m.a.STARTED&&!this.state.isLoading?this.setState({isLoading:!0}):t&&r&&t.status===m.a.SUCCEEDED&&(t.status!==r.status||t.values.length!==r.values.length)&&this.convertToFolderData()}},{key:"render",value:function(){return i.createElement("div",{className:this.classNames.root},this.renderEditor(),this.renderPicker())}}])&&g(t.prototype,r),O&&g(t,O),Object.defineProperty(t,"prototype",{writable:!1}),P}(i.Component)},20483:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{root:["fl-Designer-FolderPickerEditor",{}],folderPicker:["fl-FolderPicker",{overflow:"auto",maxHeight:300}],folderPickerTitleContainer:["fl-FolderPicker-TitleContainer",{width:"100%",backgroundColor:e.neutralLight,border:"1px solid",borderColor:e.neutralLight,borderCollapse:"collapse"}],folderPickerTitle:["fl-FolderPicker-Title",{display:"inline-block",textOverflow:"ellipsis",padding:"5px"}],folderPickerTitleSegment:["fl-FolderPicker-TitleSegment",{display:"inline-block"}],folderPickerItemTable:["fl-FolderPicker-Item-Table",{display:"inline-block",width:"100%"}]}}},20484:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(12706),i=r(14680),a=r(13272),c=r(13259),s=r(20485),l=r(13031),u=r(19713);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(h,e);var t,r,d,y=b(h);function h(){var e;p(this,h);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=y.call(this,...r)).getClassNames=Object(o.a)(),e.classNames=e.getClassNames(s.a),e._editorContext=Object(u.a)(),e._handleNavigation=t=>{t.preventDefault();var{onNavigate:r}=e.props;r&&r({currentTarget:v(e),selected:e._getItem()})},e._handleSelection=t=>{t.preventDefault();var{onSelect:r}=e.props;r&&r({currentTarget:v(e),selected:e._getItem()})},e}return t=h,(r=[{key:"render",value:function(){return n.createElement("tr",{className:this.classNames.folderPickerItemTableRow},n.createElement("td",{className:this.classNames.folderPickerItemTableLeftCell},n.createElement(i.a,{className:this.classNames.folderPickerItemFolderButton,onClick:this._handleSelection,iconName:a.a.Folder,text:this.props.title,title:Object(l.a)(this._editorContext.designerResources.Designer.Editors.FolderPicker.Select.Folder,this.props.title),ariaLabel:Object(l.a)(this._editorContext.designerResources.Designer.Editors.FolderPicker.Select.Folder,this.props.title)})),n.createElement("td",{className:this.classNames.folderPickerItemTableRightCell},n.createElement(c.a,{className:this.classNames.folderPickerItemNavigationButton,disabled:!1,iconName:a.a.ChevronRight,title:Object(l.a)(this._editorContext.designerResources.Designer.Editors.FolderPicker.Navigate.Folder,this.props.title),onClick:this._handleNavigation,ariaLabel:Object(l.a)(this._editorContext.designerResources.Designer.Editors.FolderPicker.Navigate.Folder,this.props.title)})))}},{key:"_getItem",value:function(){return{itemKey:this.props.itemKey,dynamicState:this.props.dynamicState,fullyQualifiedDisplayName:this.props.fullyQualifiedDisplayName,type:this.props.type,title:this.props.title,value:this.props.value}}}])&&f(t.prototype,r),d&&f(t,d),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.Component)},20485:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{folderPickerItemTableRow:["fl-FolderPicker-Item-TableRow",{display:"inline-block",width:"100%",border:"1px solid",borderColor:e.neutralLight,borderBottom:"0",borderCollapse:"collapse"}],folderPickerItemTableLeftCell:["fl-FolderPicker-Item-TableCell",{display:"inline-block",width:"80%",borderRight:"1px dashed",borderColor:e.neutralLight,borderLeft:"none",borderBottom:"none",borderTop:"none",borderCollapse:"collapse"}],folderPickerItemTableRightCell:["fl-FolderPicker-Item-TableCell",{display:"inline-block",width:"20%",border:"none"}],folderPickerItemFolderButton:["fl-FolderPicker-Item-Button",{display:"inline-block",width:"100%",border:"none",borderCollapse:"collapse",backgroundColor:"transparent",padding:"5px",textAlign:"left",":hover":{backgroundColor:e.neutralLight},".ms-Button-label":{fontWeight:"normal"}}],folderPickerItemNavigationButton:["fl-FolderPicker-Item-Button",{display:"inline-block",width:"100%",border:"none",borderCollapse:"collapse",backgroundColor:"transparent",padding:"5px",":hover":{backgroundColor:e.neutralLight}}],folderPickerItemIcon:["fl-FolderPicker-Item-Icon",{padding:"5px"}]}}},20486:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(11766),o=r(12812),i=r(13272),a=r(12706),c=r(20487);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(b,e);var t,r,u,d=f(b);function b(){var e;s(this,b);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=d.call(this,...r)).getClassNames=Object(a.a)(),e.classNames=e.getClassNames(c.a),e._handleSelection=t=>{t.preventDefault();var{value:r,onSelect:n}=e.props;n&&n({currentTarget:m(e),selected:r})},e}return t=b,(r=[{key:"render",value:function(){var e=this.classNames.folderPickerTitleSegmentNavigation,t=0,r=!1,o=this._handleSelection;this.props.navigationEnabled||(e=this.classNames.folderPickerTitleSegmentText,t=-1,r=!0,o=void 0);var{title:i}=this.props;return n.createElement("div",null,n.createElement("a",{className:e,role:"button",tabIndex:t,"aria-disabled":r,title:i,onClick:o},i),this._renderSeparator())}},{key:"_renderSeparator",value:function(){return this.props.navigationEnabled?n.createElement("span",null,n.createElement(o.a,{iconName:i.a.ChevronRight})):null}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),b}(n.Component)},20487:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{folderPickerTitleSegmentText:["fl-FolderPicker-Title-Segment-Text",{display:"inline-block",color:e.black}],folderPickerTitleSegmentNavigation:["fl-FolderPicker-Title-Segment-Navigation",{display:"inline-block",color:e.blueMid,":hover":{textDecoration:"underline",cursor:"pointer"}}],folderPickerTitleSegmentSeparator:["fl-FolderPicker-Title-Segment-Separator",{display:"inline-block",padding:"2px"}]}}},20488:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(11766),o=r(20323),i=r(20313),a=r(13240),c=r(20489),s=r(20585),l=r(20494),u=r(12728),p=r(20493),f=r(19713);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(h,e);var t,r,u,b=v(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=b.call(this,e)).isQueryValid=void 0,t.childEditorRef=void 0,t.childKey=w(),t._editorContext=Object(f.a)(),t.renderEditor=()=>n.createElement(n.Fragment,null,t.state.mode===p.a.Basic?t.renderExpressionBuilder():t.renderCodeView()),t.renderExpressionBuilder=()=>{var{editorOptions:{readonly:e},editorContext:r}=t.props;return n.createElement(s.a,{editorContext:r,showTokenPicker:!e,value:t.state.value,readOnly:e,onSwitchEditor:t.onChangeMode,onChange:t.handleChildEditorChange,ref:t.setComponentRef,key:t.childKey})},t.renderCodeView=()=>{var{editorOptions:{readonly:e,summary:r},editorContext:o}=t.props;return n.createElement(c.a,{editorContext:o,showTokenPicker:!e,value:t.state.value,readOnly:e,summary:null!=r?r:"",onSwitchEditor:t.onChangeMode,onChange:t.handleChildEditorChange,ref:t.setComponentRef,key:t.childKey})},t.handleChildEditorChange=e=>{var{value:r}=e;t.setState({value:r},()=>t.props.onChange({value:t.state.value}))},t.onChangeMode=e=>{Object(i.c)(t.state.value,e)&&(t.childKey=w()),t.setState({mode:t.state.mode===p.a.Basic?p.a.Advanced:p.a.Basic,value:e},()=>{var e,r;return t._editorContext.telemetryService.tagEvent(a.c.ODataFilterEditorToggle,{mode:t.state.mode,connectorId:null!==(e=t.props.editorOptions.connectorId)&&void 0!==e?e:"",operationId:null!==(r=t.props.editorOptions.operationId)&&void 0!==r?r:""})})},t.setComponentRef=e=>t.childEditorRef=e,t.isQueryValid=Object(l.f)(t.props.editorState.value),t.state={mode:t.isQueryValid?p.a.Basic:p.a.Advanced,value:t.props.editorState.value},t}return t=h,(r=[{key:"render",value:function(){return n.createElement(o.a,d({},this.props,{onRenderEditor:this.renderEditor}))}},{key:"componentDidMount",value:function(){var e,t;this._editorContext.telemetryService.tagEvent(a.c.ODataExperimentalEditorRendered,{mode:this.state.mode,valid:this.state.mode===p.a.Basic,connectorId:null!==(e=this.props.editorOptions.connectorId)&&void 0!==e?e:"",operationId:null!==(t=this.props.editorOptions.operationId)&&void 0!==t?t:""})}},{key:"focus",value:function(){this.childEditorRef&&this.childEditorRef.focus()}}])&&m(t.prototype,r),u&&m(t,u),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.Component);function w(){return Object(u.a)("odataFilter-editor")}},20489:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(12706),i=r(20326),a=r(20490),c=r(20491),s=r(20162),l=r(20493),u=r(20494),p=r(20397);function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(h,e);var t,r,m,v=y(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=v.call(this,e)).getClassNames=Object(o.a)(),t.classNames=t.getClassNames(a.a),t.defaultEditorRef=n.createRef(),t.onSwitchEditorClick=()=>{t.onChange({value:t.state.editorStateValue}),t.props.onSwitchEditor(t.state.editorStateValue)},t.onChange=e=>{var{value:r}=e;if(t.props.onChange){var n=Object(u.g)(r);t.props.onChange({value:n})}},t.onEditorStateChange=e=>{t.setState({editorStateValue:Object(s.m)(e,Object(s.c)(e))})},t.onEditorFocus=e=>{t.setState({isFocused:t.props.showTokenPicker})},t.onEditorBlur=e=>{Object(p.b)(e)||t.setState({isFocused:!1})},t.state={editorStateValue:t.props.value,isFocused:!1},t}return t=h,(r=[{key:"render",value:function(){var e={editorState:{value:this.props.value},editorOptions:{displayName:null,locale:null,hideLabel:!0,readonly:this.props.readOnly,validationErrors:[],summary:this.props.summary,showTokenPicker:this.props.showTokenPicker&&this.state.isFocused},editorContext:this.props.editorContext,onChange:this.onChange};return n.createElement(n.Fragment,null,n.createElement(c.a,{onSwitchEditorClick:this.onSwitchEditorClick,disabled:!Object(u.f)(this.state.editorStateValue),editorMode:l.a.Advanced}),n.createElement(i.a,f({onFocus:this.onEditorFocus,onBlur:this.onEditorBlur,onEditorStateChange:this.onEditorStateChange,ref:this.defaultEditorRef},e)))}},{key:"focus",value:function(){this.defaultEditorRef&&this.defaultEditorRef.current&&this.defaultEditorRef.current.focus()}},{key:"scrollIntoView",value:function(){this.defaultEditorRef&&this.defaultEditorRef.current&&this.defaultEditorRef.current.scrollIntoView()}}])&&d(t.prototype,r),m&&d(t,m),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.Component)},20490:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({toggle:["fl-AdvancedOdataFilterEditor-toggle",{width:"32px",display:"flex",justifyContent:"flex-end"}]})},20491:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(11766),o=r(12706),i=r(13259),a=r(13272),c=r(20492),s=r(20493),l=r(19713);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(y,e);var t,r,f,b=m(y);function y(){var e;u(this,y);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=b.call(this,...r)).getClassNames=Object(o.a)(),e.classNames=e.getClassNames(c.a),e._editorContext=Object(l.a)(),e}return t=y,(r=[{key:"render",value:function(){var{onSwitchEditorClick:e,disabled:t}=this.props,{designerResources:r}=this._editorContext;return n.createElement("div",{className:this.classNames.root},n.createElement(i.a,{ariaLabel:r.Designer.Editors.SwitchEditors.Label,iconName:a.a.Switch,disabled:t,onClick:e,title:this.getTitle()}))}},{key:"getTitle",value:function(){return this.props.editorMode===s.a.Advanced&&this.props.disabled?this._editorContext.designerResources.Designer.Editors.SwitchEditors.Advanced.DisabledTooltip:this.props.editorMode===s.a.Advanced?this._editorContext.designerResources.Designer.Editors.SwitchEditors.Advanced.Tooltip:this._editorContext.designerResources.Designer.Editors.SwitchEditors.Basic.Tooltip}}])&&p(t.prototype,r),f&&p(t,f),Object.defineProperty(t,"prototype",{writable:!1}),y}(n.Component)},20492:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["fl-ToggleButton",{height:"24px",display:"flex",marginLeft:"70px",marginTop:"-24px",selectors:{button:{height:24}}}]})},20493:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.Basic="basic",e.Advanced="advanced",e}({})},20494:function(e,t,r){"use strict";r.d(t,"d",(function(){return p})),r.d(t,"c",(function(){return d})),r.d(t,"h",(function(){return y})),r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return g})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return E})),r.d(t,"g",(function(){return C}));var n=r(20313),o=r(20495),i=r(20496),a=r(20497),c=r(13223),s=r(20584),l=r(20162);function u(e){var t=e.getLeft(),r=e.getOperator(),o=e.getRight();return Object(n.k)(t)&&(h(r)||i.e[r.tokenExpression])?[Object(n.f)("")]:(!Object(n.k)(t)&&h(r)&&(r=Object(n.f)(i.d.eq)),i.e[r.tokenExpression]?f([Object(n.f)("".concat(r.tokenExpression,"(").concat(t[0].tokenExpression,", '"))].concat(o).concat(Object(n.f)("')"))):f(t.concat(r).concat(Object(n.f)("'")).concat(o).concat(Object(n.f)("'"))))}function p(e){var t;return Object(a.isGroupExpression)(e)&&O(e)&&e.subexpressions[0]?u(e.subexpressions[0].state):Object(a.isGroupExpression)(e)?f(e.subexpressions.reduce((r,o)=>{var a=p(o);if(t=e.template.key===i.g.AND?i.f.AND:i.f.OR,!Object(n.k)(a)){a[0].tokenExpression="".concat(t," (").concat(a[0].tokenExpression),a.forEach(e=>r.push(e));var c=r[r.length-1];c.tokenExpression&&Object(n.o)(c)&&!c.tokenExpression.includes(")")?c.tokenExpression+=")":r.push(Object(n.f)(")"))}return r},[])):u(e.state)}function f(e){var t,r;e[0]&&(null!==(t=e[0].tokenExpression)&&void 0!==t&&t.includes("and ")?e[0].tokenExpression=e[0].tokenExpression.replace("and ","").trim():null!==(r=e[0].tokenExpression)&&void 0!==r&&r.includes("or ")&&(e[0].tokenExpression=e[0].tokenExpression.replace("or ","").trim()));var o,a=e.reduce((e,t)=>{var r=e[e.length-1];return Object(n.o)(t)&&!h(t)&&Object(n.o)(e[e.length-1])?!function(e){for(var t in i.d)if(e.tokenExpression==="".concat(t))return!0;return!1}(t)?r.tokenExpression&&t.tokenExpression&&")"===r.tokenExpression[r.tokenExpression.length-1]&&t.tokenExpression.length>3&&("and"===t.tokenExpression.substr(0,3)||"or"===t.tokenExpression.substr(0,2))?r.tokenExpression+=" ".concat(t.tokenExpression.trim()):t.tokenExpression&&(r.tokenExpression+="".concat(t.tokenExpression.trim())):e[e.length-1].tokenExpression+=" ".concat(t.tokenExpression," "):!Object(n.q)(t)&&h(t)||e.push(t),e},[Object(n.f)("")]);a&&a.length>0&&(a[a.length-1].tokenExpression=null===(o=a[a.length-1].tokenExpression)||void 0===o?void 0:o.trim());return a}function d(e,t,r){if(Object(n.k)(t))return Object(a.group)(r.placeholder,r.defaultRow().defaultExpression());var o=Object(l.j)(t),i=Object(s.parse)(o);return i.and||i.or?function e(t,r,o){var i=[];if(r.and)return r.and.forEach(r=>(r.and||r.or?i.push(e(t,r,o)):i.push(m(t,o,[Object(n.f)(r)])),null)),Object(a.group)(o.and,...i);if(r.or)return r.or.forEach(r=>(r.and||r.or?i.push(e(t,r,o)):i.push(m(t,o,[Object(n.f)(r)])),null)),Object(a.group)(o.or,...i);return m(t,o,[Object(n.f)(r)])}(e,i,r):Object(a.group)(r.placeholder,m(e,r,t))}function m(e,t,r){return{template:t.operator,state:new o.a(Object(c.a)(),b(e,r))}}function b(e,t){if(!t||Object(n.k)(t))return{name:[Object(n.f)("")],relationship:Object(n.f)(""),value:[Object(n.f)("")]};var r="",o="",a=Object(l.j)(t),c=[],s=[];for(var u in i.e)if(a.includes("".concat(u))){if(a.includes("".concat(u,"(")))c=a.slice(a.indexOf("("),a.length-1).split(",");else c=a.split(" ".concat(u," "));o=u;break}if(!o)for(var p in i.d)if(a.includes(" ".concat(p," "))){c=a.split(" ".concat(p," ")),r=p;break}var f=c?c[1]:null;if(f&&f.includes("@{")){for(var d=f;d.includes("@{")&&d.includes("}");){var m=d.indexOf("@{"),b=d.indexOf("}"),y=d.substring(0,m);""!==y&&s.push(Object(n.f)(y.replace("'","")));var v=d.substring(m+2,b),h=Object(l.i)(e,v);s.push(h),d=d.substring(b+1)}if(""!==d)if("'"===d[d.length-1]){var g=d.substring(0,d.length-1);s.push(Object(n.f)(g))}else s.push(Object(n.f)(d))}else if(f){var O=f.trim();"'"===O[0]&&(O=O.substring(1)),")"===O[O.length-1]&&(O=O.substring(0,O.length-1)),"'"===O[O.length-1]&&(O=O.substring(0,O.length-1)),s.push(Object(n.f)(O))}else s.push(Object(n.f)(""));var w=o||r;return{name:c&&c[0]?[Object(n.f)(c[0].trim().replace("(",""))]:[Object(n.f)("")],relationship:w?Object(n.f)(w):Object(n.f)(""),value:s}}function y(e,t){if(Object(a.isGroupExpression)(e)){if(O(e)&&!w(e))return Object(a.group)(t.and,...e.subexpressions);if(w(e)&&function(e){return Object(a.isRowExpression)(e)&&Object(a.isRowTemplate)(e.template)}(e.subexpressions[0]))return Object(a.group)(t.placeholder,...e.subexpressions)}return e}function v(e,t){if(O(e)&&!O(t)||!O(e)&&O(t))return!0;if(Object(a.isGroupExpression)(e)&&Object(a.isGroupExpression)(t)){if(e.subexpressions.length!==t.subexpressions.length)return!0;for(var r=0;r<e.subexpressions.length;r++)if(Object(a.isGroupExpression)(e.subexpressions[r])||Object(a.isGroupExpression)(t.subexpressions[r]))return v(e.subexpressions[r],t.subexpressions[r])}return!1}function h(e){return void 0===e.tokenExpression||0===e.tokenExpression.trim().length}function g(e){return Object(n.f)(e.key.toString())}function O(e){return e.template&&e.template.key===i.g.PLACEHOLDER}function w(e){return Object(a.isGroupExpression)(e)&&1===e.subexpressions.length}function E(e){try{var t=Object(l.j)(e);return""===t||Object(s.parse)(t)}catch(Error){return!1}}function C(e){var t=e[e.length-1];if(Object(n.o)(t)&&t.tokenExpression){for(var r=t.tokenExpression.length-1;r>0&&" "===t.tokenExpression[r];)r--;t.tokenExpression=t.tokenExpression.substr(0,r+1)}return e}},20495:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i}));var i=function(){function e(t,r){var{name:n,relationship:o,value:i}=r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.left=void 0,this.operator=void 0,this.right=void 0,this.left=n,this.operator=o,this.right=i}var t,r,o;return t=e,(r=[{key:"setOperator",value:function(e){this.operator=e}},{key:"getOperator",value:function(){return this.operator}},{key:"setLeft",value:function(e){this.left=e}},{key:"getLeft",value:function(){return this.left}},{key:"setRight",value:function(e){this.right=e}},{key:"getRight",value:function(){return this.right}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20496:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return c})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return u}));var n=function(e){return e.eq="eq",e.ne="ne",e.lt="lt",e.gt="gt",e.ge="ge",e.le="le",e}({}),o=function(e){return e.substringof="substringof",e.startswith="startswith",e.endswith="endswith",e.contains="contains",e}({}),i=function(e){return e.eq="eq",e.ne="ne",e.lt="lt",e.gt="gt",e.ge="ge",e.le="le",e.substringof="substringof",e.startswith="startswith",e.endswith="endswith",e}({}),a=function(e){return e.eq="eq",e.ne="ne",e}({}),c=function(e){return e.eq="eq",e.ne="ne",e.lt="lt",e.le="le",e.gt="gt",e.ge="ge",e.contains="contains",e.startswith="startswith",e.endswith="endswith",e}({}),s=function(e){return e.AND="and",e.OR="or",e}({}),l={AND:"and",OR:"or",PLACEHOLDER:"placeholder"};function u(e){return{addButton:e.Designer.Editors.OFilter.ExpressionBuilderResources.AddButton,addRow:e.Designer.Editors.OFilter.ExpressionBuilderResources.AddRow,addGroup:e.Designer.Editors.OFilter.ExpressionBuilderResources.AddGroup,deleteExpression:e.Designer.Editors.OFilter.ExpressionBuilderResources.DeleteExpression,moveUpExpression:e.Designer.Editors.OFilter.ExpressionBuilderResources.MoveUpExpression,moveDownExpression:e.Designer.Editors.OFilter.ExpressionBuilderResources.MoveDownExpression,makeGroup:e.Designer.Editors.OFilter.ExpressionBuilderResources.MakeGroup,ungroup:e.Designer.Editors.OFilter.ExpressionBuilderResources.Ungroup,andGroup:e.Designer.Editors.OFilter.ExpressionBuilderResources.AndGroup,orGroup:e.Designer.Editors.OFilter.ExpressionBuilderResources.OrGroup,addRelatedEntity:e.Designer.Editors.OFilter.ExpressionBuilderResources.AddRelatedEntity,relatedEntityPlaceholder:e.Designer.Editors.OFilter.ExpressionBuilderResources.RelatedEntityPlaceholder,fieldPlaceholder:e.Designer.Editors.OFilter.ExpressionBuilderResources.FieldPlaceholder,containsData:e.Designer.Editors.OFilter.ExpressionBuilderResources.ContainsData,doesNotContainData:e.Designer.Editors.OFilter.ExpressionBuilderResources.DoesNotContainData,doesNotContainDataWarning:e.Designer.Editors.OFilter.ExpressionBuilderResources.DoesNotContainDataWarning,missingRelationshipWarning:e.Designer.Editors.OFilter.ExpressionBuilderResources.MissingRelationshipWarning,errorMalformed:e.Designer.Editors.OFilter.ExpressionBuilderResources.ErrorMalformed,moreCommandsAriaLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.MoreCommandsAriaLabel,rowSelectorAriaLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.RowSelectorAriaLabel,groupCollapserAriaLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.GroupCollapserAriaLabel,groupSelectorAriaLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.GroupSelectorAriaLabel,groupExpandAriaLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.GroupExpandAriaLabel,groupCollapseAriaLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.GroupCollapseAriaLabel,groupExpandAriaDescription:e.Designer.Editors.OFilter.ExpressionBuilderResources.GroupExpandAriaDescription,groupCollapseAriaDescription:e.Designer.Editors.OFilter.ExpressionBuilderResources.GroupCollapseAriaDescription,fieldSelectorControlLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.FieldSelectorControlLabel,operatorSelectorControlLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.OperatorSelectorControlLabel,groupTypeSelectorLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.GroupTypeSelectorLabel,addNewExpressionLabel:e.Designer.Editors.OFilter.ExpressionBuilderResources.AddNewExpressionLabel,expressionLevelDescription:e.Designer.Editors.OFilter.ExpressionBuilderResources.ExpressionLevelDescription,expressionPositionDescription:e.Designer.Editors.OFilter.ExpressionBuilderResources.ExpressionPositionDescription,invalidField:e.Designer.Editors.OFilter.ExpressionBuilderResources.InvalidField,onAddRowAnnouncement:e.Designer.Editors.OFilter.ExpressionBuilderResources.OnAddRowAnnouncement,onAddGroupAnnouncement:e.Designer.Editors.OFilter.ExpressionBuilderResources.OnAddGroupAnnouncement,onDeleteAnnouncement:e.Designer.Editors.OFilter.ExpressionBuilderResources.OnDeleteAnnouncement,onMoveUpAnnouncement:e.Designer.Editors.OFilter.ExpressionBuilderResources.OnMoveUpAnnouncement,onMoveDownAnnouncement:e.Designer.Editors.OFilter.ExpressionBuilderResources.OnMoveDownAnnouncement,onMakeGroupAnnouncement:e.Designer.Editors.OFilter.ExpressionBuilderResources.OnMakeGroupAnnouncement,onUngroupAnnouncement:e.Designer.Editors.OFilter.ExpressionBuilderResources.OnUngroupAnnouncement,manyToOne:"Many to One",oneToMany:"One to Many",manyToMany:"Many to Many",noRelationships:"No relationships of this type",EXPRESSION_CONTROL_GROUP_CONDITION_AND:"And ",EXPRESSION_CONTROL_GROUP_CONDITION_OR:"Or ",EXPRESSION_CONTROL_GROUP_CONDITION_PLACEHOLDER:"Placeholder "}}},20497:function(e,t,r){"use strict";r.d(t,"Controls",(function(){return i}));r(20498),r(20499),r(20504),r(20506),r(20505);var n=r(20500);r.d(t,"group",(function(){return n.a})),r.d(t,"isGroupExpression",(function(){return n.h})),r.d(t,"isRowExpression",(function(){return n.i}));var o=r(20501);r.d(t,"isRowTemplate",(function(){return o.e}));r(20515),r(20517),r(20518),r(20520),r(20521),r(20524),r(20525),r(20528),r(20529),r(20532),r(20537),r(20538),r(20539),r(20540),r(20541),r(20542),r(20543),r(20544),r(20545),r(20526),r(20546),r(20547),r(20548),r(20549),r(20582),r(20565),r(20583);var i=r(20503)},20498:function(e,t,r){},20499:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(11766),o=r(20500),i=r(20503),a=r(20504),c=r(15543);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=n.createContext({announce:()=>null}),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(f,e);var t,r,s,u=m(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=u.call(this,e)).setAnnouncement=e=>{t.setState({announcedText:""}),window.setTimeout(()=>{t.setState({announcedText:e})},0)},t.state={announcedText:""},t}return t=f,(r=[{key:"render",value:function(){var e=this.index(this.props.expression),t=this.canMakeGroup(e),r=this.state.announcedText;return n.createElement(v.Provider,{value:{announce:this.setAnnouncement}},r&&n.createElement(c.a,{id:"expressionBuilderAnnouncement","aria-live":"assertive",message:r}),n.createElement(i.Stack,null,n.createElement(i.Line,{className:"eb-ExpressionBuilder"},n.createElement(a.a,{expression:e,metadata:this.props.environment,root:!0,onChange:e=>this.props.onChange&&this.props.onChange(e),canMakeGroup:()=>t,location:[0],expected:this.props.expected,collapsedPrettyStrings:this.props.collapsedPrettyStrings,customizations:this.props.customizations,htmlId:this.props.htmlId,resources:this.props.resources,isRTL:!!this.props.isRTL&&this.props.isRTL}))))}},{key:"canMakeGroup",value:function(e){return!!Object(o.h)(e)&&(this.hasSelected(e)?e.subexpressions.every(e=>!this.hasSelected(e)):1===e.subexpressions.filter(e=>this.canMakeGroup(e)).length)}},{key:"hasSelected",value:function(e){return Object(o.h)(e)&&e.subexpressions.some(e=>!!e.selected)}},{key:"index",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;if(Object(o.h)(e)){var n=l(l({},e),{},{location:t,root:()=>r||n,subexpressions:[]});return n.subexpressions=e.subexpressions.map((e,o)=>this.index(e,t.concat(o),r||n)),n}var i=l(l({},e),{},{location:t,root:()=>r||i});return i}}])&&p(t.prototype,r),s&&p(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component);t.b=h},20500:function(e,t,r){"use strict";r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return p})),r.d(t,"g",(function(){return d})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return b})),r.d(t,"j",(function(){return y})),r.d(t,"c",(function(){return v})),r.d(t,"b",(function(){return h}));var n=r(20501),o=r(20502);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return Object(n.d)(e.template)}function l(e){return Object(n.e)(e.template)}function u(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.defaultExpression?a(a({},e.defaultExpression()),{},{subexpressions:r}):{template:e,subexpressions:r}}function p(e,t){return a(a({},e),{},{subexpressions:(r=t,n=e.subexpressions,o=n.slice(),o.splice(r,1),o)});var r,n,o}function f(e,t,r){if(t+e<0||t+e>=r.length)return r;var n=t+e,o=r[t],i=r[n];if(s(i)){var c=r.slice(0,Math.min(t,n)),l=r.slice(Math.max(t,n)+1,r.length);return c[Math.min(t,n)]=a(a({},i),{},{subexpressions:-1===e?i.subexpressions.concat([o]):[o].concat(i.subexpressions)}),c.concat(l)}var u=r.slice();return u[t]=i,u[t+e]=o,u}function d(e,t,r){return a(a({},e),{},{subexpressions:f(r,t,e.subexpressions)})}function m(e,t,r){var n=e.subexpressions,o=n[r];return a(a({},e),{},{subexpressions:n.slice(0,r).concat(t,p(o,0),n.slice(r+1))})}function b(e,t,r){var n=e.subexpressions,o=n[r];return a(a({},e),{},{subexpressions:n.slice(0,r).concat(p(o,o.subexpressions.length-1),t,n.slice(r+1))})}function y(e,t){var r=e.subexpressions[t];return s(r)?a(a({},e),{},{subexpressions:e.subexpressions.slice(0,t).concat(r.subexpressions,e.subexpressions.slice(t+1))}):e}function v(e,t,r){if(t.template.addedRow){var n=t.template.addedRow(e,t);return Object(o.b)(n).justAdded=!0,a(a({},t),{},{subexpressions:t.subexpressions.concat([n])})}return a(a({},t),{},{subexpressions:t.subexpressions.concat([e.defaultRow(r).defaultExpression(r)])})}function h(e,t,r,n){if(n){var i=n(e,t);return Object(o.b)(i).justAdded=!0,a(a({},t),{},{subexpressions:t.subexpressions.concat([i])})}if(t.template.addedGroup){var c=t.template.addedGroup(e,t);return Object(o.b)(c).justAdded=!0,a(a({},t),{},{subexpressions:t.subexpressions.concat([c])})}var s=e.defaultGroup(r);return a(a({},t),{},{subexpressions:t.subexpressions.concat([u(s,e.defaultRow(r).defaultExpression(r))])})}},20501:function(e,t,r){"use strict";function n(e){return void 0!==e.render}function o(e){return void 0===e.render}function i(e,t){return e.template.prettyString(e,t)}function a(e,t){return!t.template.canAddGroup||t.template.canAddGroup(e,t)}function c(e,t){return!t.template.canAddRow||t.template.canAddRow(e,t)}function s(e){return e.template.errors&&e.template.errors(e)||[]}r.d(t,"e",(function(){return n})),r.d(t,"d",(function(){return o})),r.d(t,"f",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return s}))},20502:function(e,t,r){"use strict";function n(e){throw new Error("Unsupported: ".concat(e))}function o(e,t){return e.reduce((e,r,n)=>(e.push(...t(r,n)),e),new Array)}function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;return!(e.length>t.length)&&e.every((e,n)=>r(e,t[n]))}function a(e,t){window.setTimeout(()=>{var t=document.querySelector(e);t&&t.focus()},void 0!==t?t:100)}function c(e){return e}function s(e){return e}function l(e,t){return void 0===e?t:e}function u(e){return"string"==typeof e&&e.length>0?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function p(e){return!!e.match(/[0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12}/g)}function f(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return null==e?void 0:e.replace(/{(\d+)}/g,(e,t)=>{var n=r[parseInt(t,10)];return void 0===n?e:n})}r.d(t,"k",(function(){return n})),r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"i",(function(){return a})),r.d(t,"g",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"j",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"h",(function(){return p})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return m}));var d=0;function m(e){return(e||"eb-")+ ++d}},20503:function(e,t,r){"use strict";r.r(t),r.d(t,"globalStyles",(function(){return j})),r.d(t,"Label",(function(){return T})),r.d(t,"Button",(function(){return k})),r.d(t,"StringEdit",(function(){return R})),r.d(t,"DatePicker",(function(){return x})),r.d(t,"Dropdown",(function(){return N})),r.d(t,"IconDropdown",(function(){return _})),r.d(t,"ComboBox",(function(){return D})),r.d(t,"Line",(function(){return I})),r.d(t,"Stack",(function(){return A})),r.d(t,"Ignore",(function(){return F})),r.d(t,"ButtonDropdown",(function(){return M})),r.d(t,"HiddenDescription",(function(){return B})),r.d(t,"Ellipsis",(function(){return U}));var n=r(11766),o=r(14650),i=r(12961),a=r(15028),c=r(15657),s=r(15697),l=r(15871),u=r(12754),p=r(12811),f=r(12854),d=r(12860),m=r(12821);function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var j={fontFamily:"'Segoe UI', Tahoma, sans-serif",marginRight:8,flexGrow:1},T=e=>{var{text:t,style:r,className:i}=e;return n.createElement(o.a,{id:"",className:i,style:C(C({},j),{},{padding:"4px",lineHeight:"28px"},r)},t)},k=e=>{var{onClick:t,style:r,text:o,className:a}=e;return n.createElement(i.a,{className:a,style:C(C({},j),{},{width:"32px",minWidth:0,border:"solid 1px #999",padding:10,paddingLeft:30,paddingRight:30},r),text:o,onClick:e=>t&&t()})},R=e=>{var{value:t,onChange:r,style:o,className:i}=e;return n.createElement("div",{style:{marginRight:8}},n.createElement(a.a,{className:i,value:t,style:C(C({},j),{},{fontSize:14,height:30},o),onChange:(e,n)=>n&&n!==t&&r&&r(n)}))},x=e=>{var{value:t,onChange:r,className:o}=e;return n.createElement(c.a,{className:o,value:t,isMonthPickerVisible:!1,onSelectDate:e=>e&&e.getTime()===t.getTime()&&r&&r(e)})},N=e=>{var{options:t,selectedKey:r,onChange:o,onRenderSelectedOption:i,onRenderMenuOption:a,style:c,className:l,ariaDescribedBy:u,ariaLabel:p,disabled:f}=e;return n.createElement(s.a,{ariaLabel:p,"aria-describedby":u,className:l,options:t,selectedKey:r,onChange:(e,t)=>t&&t.key!==r&&o&&o(t),onRenderTitle:i,onRenderOption:a,dropdownWidth:"auto",style:C(C({},j),c),disabled:f})},_=e=>{var{options:t,selectedKey:r,onChange:o,style:i,className:a,ariaDescribedBy:c,ariaLabel:s,disabled:l}=e;return n.createElement(N,{ariaDescribedBy:c,ariaLabel:s,className:a,options:t,selectedKey:r,onChange:o,style:i,disabled:l})},D=e=>{var{options:t,selectedKey:r,onChange:o,style:i,className:a,ariaDescribedBy:c,ariaLabel:s}=e;return n.createElement(l.a,{ariaDescribedBy:c,ariaLabel:s,className:a,options:t,selectedKey:r,allowFreeform:!0,autoComplete:"on",onChange:(e,t)=>t&&t.key!==r&&o&&o(t),style:C(C({},j),i),styles:{root:{height:30}}})},I=e=>n.createElement("div",w({},e,{style:C({display:"flex",flexDirection:"row"},e.style)})),A=e=>n.createElement("div",w({},e,{style:C({display:"flex",flexDirection:"column"},e.style)})),F=e=>n.createElement("div",e),L=Object(u.eb)({selectors:{":focus":{outline:"1px solid #0078D4",border:"none"}}}),M=e=>n.createElement(i.a,w({},e,{className:Object(p.a)(L),disabled:e.isDisabled,id:e.id,style:C(C({},j),{},{border:"solid 1px #999",background:"white"},e.style),menuProps:{items:e.items}})),B=e=>n.createElement("div",{id:e.id,key:e.id,style:{display:"none"}},e.text),U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(a,e);var t,r,o,i=v(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).id=void 0,t.state={menuVisible:!1},t.id="#drop0"+Math.random().toString(),t._onClick=t._onClick.bind(g(t)),t._onDismiss=t._onDismiss.bind(g(t)),t}return t=a,(r=[{key:"render",value:function(){return n.createElement("div",null,n.createElement(f.a,{className:this.props.className,ariaLabel:this.props.resources.moreCommandsAriaLabel,title:this.props.resources.moreCommandsAriaLabel,"aria-describedby":this.props.ariaDescribedBy,onClick:this._onClick,id:this.id,iconProps:{iconName:"More",ariaLabel:this.props.resources.moreCommandsAriaLabel},height:33,style:this.props.style}),this.state.menuVisible?n.createElement(d.a,{shouldFocusOnMount:!0,target:this.state.target||"",onDismiss:this._onDismiss,gapSpace:-32,directionalHint:m.a.rightTopEdge,items:this.props.items}):null)}},{key:"_onClick",value:function(e){this.setState({target:e.currentTarget,menuVisible:!this.state.menuVisible})}},{key:"_onDismiss",value:function(){this.setState({menuVisible:!1})}}])&&b(t.prototype,r),o&&b(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.Component)},20504:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(20501),i=r(20500),a=r(20505),c=r(20502),s=r(20506);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=e=>{var t=e.expression;if(Object(i.i)(t)){var r=p(p({},e),{},{templates:e.templates?e.templates.filter(e=>Object(o.e)(e)):[],expression:p(p({},t),{},{template:t.template})});return r.templates&&0===r.templates.length&&delete r.templates,n.createElement(a.a,r)}if(Object(i.h)(t)){var u=p(p({},e),{},{templates:e.templates?e.templates.filter(e=>Object(o.d)(e)):[],expression:p(p({},t),{},{template:t.template}),rootOnChange:e.rootOnChange||e.onChange});return u.templates&&0===u.templates.length&&delete u.templates,n.createElement(s.a,l({},u,{location:e.location||[0]}))}return Object(c.k)(t)}},20505:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(11766),o=r(20503),i=e=>{var t=(e.templates||e.metadata.rowTemplates).filter(t=>!e.expected||t.applicableType(e.expected)),r=e.expression.template.render(e);return t.length>1?n.createElement(o.Line,{className:"eb-RowExpressionView"},n.createElement(o.IconDropdown,{ariaDescribedBy:e.ariaDescribedBy,ariaLabel:"Expression type selector",className:"eb-RowExpressionView-TemplateSelector",style:{marginRight:-1},options:t.map(e=>({key:e.key,text:e.label.name,data:e.label.iconProps})),selectedKey:e.expression.template.key,onChange:r=>{var n=t.find(e=>e.key===r.key);return n&&e.onChange&&e.onChange(n.defaultExpression(e.expected))}}),r):r}},20506:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(11766),o=r(20503),i=r(20501),a=r(20507),c=r(20510),s=r(20512),l=r(20502);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=e=>{var t=e.expression.template.customizations||e.customizations,r={margin:t&&t.hideGroupContainer?"0 0 0 -4px":void 0,padding:e.root||t&&t.hideGroupContainer?void 0:"10px 10px 15px 10px",background:e.root||t&&t.hideGroupContainer?void 0:"rgba(0,0,0,0.05)"},p=f(f({},e),{},{onChange:t=>{Object(l.b)(t).subexpressions=t.subexpressions.filter(e=>void 0!==e),t.subexpressions.forEach(e=>{Object(l.b)(e).parent=()=>t}),e.onChange(f(f({},t),{},{subexpressions:t.subexpressions}))},disabled:Object(s.b)(e.expression)&&e.expression.template.selectionDisabled,templates:e.metadata.groupTemplates.filter(e=>!(e instanceof s.a))}),d=e.descriptionIds&&"".concat(e.descriptionIds.levelDescriptionId," ").concat(e.descriptionIds.positionDescriptionId),m=t&&(t.hideGroupSelectorCheckbox||t.isReadonly)?null:n.createElement(c.d,u({},e,{ariaDescribedBy:d})),y=n.createElement(c.e,u({},p,{ariaDescribedBy:e.descriptionIds&&e.descriptionIds.levelDescriptionId,disabled:t&&t.isReadonly})),v=f(f({},e),{},{disabled:!(t&&t.enableRootGroupTemplateSelector)}),h="lvl-desc-root-".concat(Object(l.f)(e.htmlId)),g=n.createElement(c.e,u({},v,{ariaDescribedBy:h})),O=n.createElement(o.HiddenDescription,{id:h,text:Object(l.e)(e.resources.expressionLevelDescription,"0")}),w=t&&t.hideCollapser?null:n.createElement(c.b,u({},p,{ariaDescribedBy:d})),E=(!t||!t.hideGroupContextMenu)&&e.controls&&n.cloneElement(e.controls,{ariaDescribedBy:d})||null,C=t&&(t.hideAddControl||t.isReadonly)?null:n.createElement(c.a,p),S=e.collapsedPrettyStrings?n.createElement(o.Line,{className:"eb-PrettyString",style:{lineHeight:"32px",paddingLeft:5}},Object(i.f)(p.expression)):null,P=e.expression.template.renderHeader;return e.expression.collapsed?b(y,S,w,E)&&n.createElement(o.Line,{className:"eb-GroupExpressionView eb-GroupExpressionView-Collapsed",style:f(f({},r),{},{justifyContent:"space-between",width:"100%"})},y,S,w,E):e.root?n.createElement(o.Stack,{className:"eb-GroupExpressionView eb-GroupExpressionView-RootExpression",style:r},b(y,E)&&n.createElement(o.Line,{className:"eb-GroupExpressionView-ControlBar",style:{justifyContent:"space-between",width:"100%"}},P?n.createElement(P,u({},e,{renderGroupTemplateSelector:()=>g})):g,O,E),Object(a.a)(p),C):n.createElement(o.Stack,{className:"eb-GroupExpressionView",style:r},n.createElement(o.Line,{className:"eb-GroupExpressionView-ControlBar",style:{justifyContent:"space-between",width:"100%"}},b(e.dragHandler||null,m,y)&&n.createElement(o.Line,{className:"eb-GroupExpressionView-LeftControls"},e.dragHandler||null,m,P?n.createElement(P,u({},e,{renderGroupTemplateSelector:()=>y})):y),b(w,E)&&n.createElement(o.Line,{className:"eb-GroupExpressionView-RightControls"},w,E)),n.createElement(o.Stack,{className:"eb-GroupExpressionView-Rows",style:{paddingLeft:t&&t.hideGroupSelectorCheckbox?e.dragHandler?18:6:e.dragHandler?52:40}},Object(a.a)(p),C))};function b(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.some(e=>null!==e)||null}},20507:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(11766),o=r(20502),i=r(20500),a=r(20501),c=r(20508),s=r(20503);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){var t=e.expression.subexpressions.filter(e=>void 0!==e);return Object(o.d)(t,(r,l)=>{var p=function(e,t){return u(u({},e),{},{ungroup:()=>e.onChange(Object(i.j)(e.expression,t)),makeGroup:()=>function(e){var t=e.expression.subexpressions.findIndex(e=>!!e.selected),r=e.expression.subexpressions.filter(e=>e.selected).map(e=>u(u({},e),{},{selected:!1})),n=e.expression.subexpressions.filter(e=>!e.selected),i=(e.templates||e.metadata.groupTemplates).find(t=>void 0===e.expected||t.applicableType(e.expected));if(!i)throw new Error("Couldn't find a group to make a group with");if(e.expression.template.addedGroup){var a=e.expression.template.addedGroup(e.metadata,e.expression);Object(o.b)(a).justAdded=!0,e.onChange(u(u({},e.expression),{},{subexpressions:n.slice(0,t).concat(a,n.slice(t))}))}e.onChange(u(u({},e.expression),{},{subexpressions:n.slice(0,t).concat({template:i,subexpressions:r},n.slice(t))}))}(e)})}(e,l),f=function(e,t,r){return u(u({},e),{},{root:!1,moveAbove:e=>t.onChange(Object(i.e)(t.expression,e,r)),moveBelow:e=>t.onChange(Object(i.f)(t.expression,e,r)),ungroup:()=>Object(i.j)(t.expression,r),onChange:e=>t.onChange(u(u({},t.expression),{},{subexpressions:t.expression.subexpressions.slice(0,r).concat(e,t.expression.subexpressions.slice(r+1))}))})}(p,e,l);return function(e,t,r,l,u,p){var f=r.expression.template.rowAllowed||(e=>!r.expression.template.expected||e.applicableType(r.expression.template.expected(r.expression))),d=[],m=l.location&&l.location.length,b=null;if(m){var{levelDescriptionId:y,positionDescriptionId:v,descriptionComponents:h}=function(e,t,r){var{location:i,htmlId:a,resources:c}=e,l="lvl-descr-".concat(i.join("-"),"-").concat(t,"-").concat(Object(o.f)(a)),u=Object(o.e)(c.expressionLevelDescription,i.length),p="pos-descr-".concat(i.join("-"),"-").concat(t,"-").concat(Object(o.f)(a)),f=Object(o.e)(c.expressionPositionDescription,t+1,r),d=n.createElement(n.Fragment,null,n.createElement(s.HiddenDescription,{id:l,text:u}),n.createElement(s.HiddenDescription,{id:p,text:f}));return{levelDescriptionId:l,positionDescriptionId:p,descriptionComponents:d}}(l,t,p);d.push(h),b={levelDescriptionId:y,positionDescriptionId:v}}var g=!Object(i.h)(r.expression)||!r.expression.template.canDeleteExpression||r.expression.template.canDeleteExpression(r.location.length,r.expression);Object(i.i)(e)?d.push(n.createElement(c.b,{key:2*t+1,childProps:l,controlProps:u,rowAllowed:f,expression:e,errors:Object(a.c)(e),index:t,canDelete:!!g,descriptionIds:b})):d.push(n.createElement(c.a,{key:2*t+1,childProps:l,controlProps:u,rowAllowed:f,expression:e,index:t,canDelete:!!g,descriptionIds:b}));return d}(r,l,e,f,p,t.length)})}},20508:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"a",(function(){return y}));var n=r(11766),o=r(20509),i=r(20503),a=r(20502),c=r(20504),s=r(20510),l=r(20506),u=r(20511);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=e=>{var{canDelete:t,childProps:r,controlProps:l,descriptionIds:f,errors:m,expression:b,index:y,rowAllowed:v}=e,h=b.template.customizations||r.customizations,g=!(!h||!h.isReadonly),O=!h||!h.hideTreeLines&&!g,w=!h||!h.hideRowSelectorCheckbox&&!g,E=!h||!h.hideRowContextMenu&&!g,C=f&&"".concat(f.levelDescriptionId," ").concat(f.positionDescriptionId),S={};null!=h&&h.enableDockModeView&&(S={maxWidth:"560px"});var P=b.justAdded;Object(a.b)(b).justAdded=!1;var j=(0,a.g)(n.createElement("div",{"data-id":P?"focusedElement":void 0},n.createElement(i.Line,{className:"eb-RowExpressionView-Container",style:d({margin:O?"10px 0 0":"10px 1px 0",padding:E?"10px 0 10px 10px":"10px",background:"white",width:"max-content",outline:m&&m.length>0?"1px solid #a4262c":void 0,opacity:1},S)},w?n.createElement(s.f,p({},r,{i:y,ariaDescribedBy:C,expression:b,templates:r.metadata.rowTemplates.filter(v),onChange:e=>r.onChange(e)})):null,n.createElement(c.a,p({},r,{i:y,ariaDescribedBy:C,expected:r.expression.template.expected&&r.expression.template.expected(r.expression)||r.expected,expression:b,templates:r.metadata.rowTemplates.filter(v),onChange:e=>r.onChange(e)})),E?n.createElement(s.c,p({},l,{i:y,ariaDescribedBy:C,canDelete:t})):null))),T=m&&m.length>0?n.createElement(o.a,{text:m.join(", ")}):null;return P&&Object(a.i)("[data-id=".concat("focusedElement","] input")),O?n.createElement(u.b,{leftMargin:"10px",topOffset:"10px",length:"20px",isRTL:!!r.isRTL&&r.isRTL},j,T):n.createElement(i.Line,null,j,T)},y=e=>{var t,{canDelete:r,childProps:o,controlProps:c,descriptionIds:f,expression:m,index:b}=e,y=m.template.customizations||o.customizations,v=!(!y||!y.isReadonly),h=!y||!y.hideTreeLines&&!v,g=m.justAdded;Object(a.b)(m).justAdded=!1;var O={margin:"10px 0 0",opacity:1};null!==(t=o.customizations)&&void 0!==t&&t.enableDockModeView&&(O=d(d({},O),{},{maxWidth:"min-content"}));var w=(0,a.g)(n.createElement("div",{"data-id":g?"focusedElement":void 0,className:"eb-GroupExpressionView-Container",style:O},n.createElement(l.a,p({},o,{i:b,key:b,controls:v?void 0:n.createElement(s.c,p({},c,{i:b,canDelete:r})),descriptionIds:f,expected:o.expression.template.expected&&o.expression.template.expected(m)||o.expected,expression:m,location:o.location.concat([b])||[],templates:o.metadata.groupTemplates}))));return g&&Object(a.i)("[data-id=".concat("focusedElement","] input")),h?n.createElement(u.b,{leftMargin:"10px",topOffset:"10px",length:"20px",isRTL:!!o.isRTL&&o.isRTL},w):n.createElement(i.Line,null,w)}},20509:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(11766),o=r(13275),i=r(13262),a=r(12821),c=r(12854);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(d,e);var t,r,l,f=p(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=f.call(this,e)).index=void 0,t.state={open:!1},t.index=String(d.globalIndex++),t}return t=d,(r=[{key:"render",value:function(){var e={onRenderContent:()=>n.createElement("div",null,this.props.text)},t="errorCallout"+this.index;return n.createElement(o.a,{style:{marginLeft:10,marginTop:10,justifyContent:"center"}},n.createElement(i.a,{tooltipProps:e,id:t,directionalHint:a.a.bottomCenter,calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},n.createElement(c.a,{iconProps:{iconName:"error"},ariaLabel:this.props.text,"aria-describedby":t,role:"tooltip",styles:{root:{color:"#a4262c"}}})))}}])&&s(t.prototype,r),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),d}(n.Component);m.globalIndex=0},20510:function(e,t,r){"use strict";r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return y})),r.d(t,"d",(function(){return v})),r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return g})),r.d(t,"c",(function(){return O}));var n=r(11766),o=r(15501),i=r(12854),a=r(20503),c=r(20500),s=r(20501),l=r(20511),u=r(20502),p=r(20499);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=e=>{var t=e.expression.template.customizations||e.customizations,r=(e.templates||e.metadata.groupTemplates).filter(t=>(void 0===e.expected||t.applicableType(e.expected))&&void 0===t.distinctTemplate);return t&&(r.length<=1&&t.hideSingleItemGroupSelector||t.hideGroupTemplateSelector)||e.expression.template.distinctTemplate?null:n.createElement(a.Line,null,n.createElement(a.IconDropdown,{style:{marginBottom:0},ariaDescribedBy:e.ariaDescribedBy,ariaLabel:e.resources.groupTypeSelectorLabel,className:"eb-GroupExpressionView-TemplateSelector",options:r.map(e=>({key:e.key,text:e.label.name,data:e.label.iconProps})),selectedKey:e.expression.template.key,onChange:t=>{var r=e.metadata.groupTemplates.find(e=>e.key===t.key);if(void 0===r)throw new Error("Invalid group template selection");var n=e.expression.subexpressions.every(e=>!r.rowAllowed||r.rowAllowed(e.template))?e.expression.subexpressions:[e.metadata.defaultRow(r.expected&&r.expected(e.expression)).defaultExpression(r.expected&&r.expected(e.expression))];return r&&e.onChange(d(d({},e.expression),{},{template:r,subexpressions:n}))},disabled:e.disabled}))},y=e=>n.createElement(o.a,{className:"eb-RowExpressionView-SelectorCheckbox",styles:{root:{position:"relative",marginRight:10,marginLeft:5,height:32,marginTop:6},input:{selectors:{":focus + label":{selectors:{":before":{selectors:{"@media screen and (-ms-high-contrast: active)":{outline:"1px solid WindowText !important"}}}}}}}},checked:!!e.expression.selected,ariaDescribedBy:e.ariaDescribedBy,ariaLabel:e.resources.rowSelectorAriaLabel,checkmarkIconProps:{styles:{root:{selectors:{"@media screen and (-ms-high-contrast: active)":{background:"highlight"}}}}},onChange:(t,r)=>e.onChange(d(d({},e.expression),{},{selected:r}))}),v=e=>n.createElement(o.a,{className:"eb-GroupExpressionView-SelectorCheckbox",styles:{root:{marginRight:10,marginLeft:5,height:32,marginTop:6},input:{selectors:{":focus + label":{selectors:{":before":{selectors:{"@media screen and (-ms-high-contrast: active)":{outline:"1px solid WindowText !important"}}}}}}}},checked:!!e.expression.selected,ariaDescribedBy:e.ariaDescribedBy,ariaLabel:e.resources.groupSelectorAriaLabel,checkmarkIconProps:{ariaLabel:e.resources.groupSelectorAriaLabel,styles:{root:{selectors:{"@media screen and (-ms-high-contrast: active)":{background:"highlight"}}}}},onChange:(t,r)=>e.onChange(d(d({},e.expression),{},{selected:r}))}),h=e=>{var{collapsed:t,lastExpression:r}=e.expression;return n.createElement(i.a,{"aria-describedby":e.ariaDescribedBy,"aria-expanded":!t,"aria-label":e.resources.groupCollapserAriaLabel,autoFocus:r&&t!==r.collapsed,className:"eb-Collapser",iconProps:{iconName:e.expression.collapsed?"FullScreen":"BackToWindow"},onClick:()=>e.onChange(d(d({},e.expression),{},{collapsed:!e.expression.collapsed,lastExpression:e.expression})),styles:{root:{marginRight:10}},title:t?e.resources.groupExpandAriaLabel:e.resources.groupCollapseAriaLabel})},g=e=>{var t,r=!Object(s.b)(e.location.length,e.expression),o=!Object(s.a)(e.location.length,e.expression),i=n.useContext(p.a),f=e.metadata.groupTemplates.filter(e=>e.distinctTemplate).map(t=>({key:t.key,name:t.label.name,iconProps:t.label.iconProps,isDisabled:r||o||t.distinctTemplate.canBeAdded&&!t.distinctTemplate.canBeAdded(e.expression),onClick:()=>{e.onChange(Object(c.b)(e.metadata,e.expression,e.expected,t.distinctTemplate.onAdd)),i.announce(e.resources.onAddGroupAnnouncement)}})),m=e.expression.template.customizations||e.customizations,b=e.location&&e.location.length;b&&(t=Object(u.e)(e.resources.addNewExpressionLabel,e.location.length));var y="AddMenu"+b,v=n.createElement(a.ButtonDropdown,{className:"eb-AddMenu",style:{flexGrow:0,marginTop:10},id:y,text:e.resources.addButton,"aria-label":t,iconProps:{iconName:"Add"},isDisabled:r,items:[d(d({},e.expression.template.addRowLabel||{name:e.resources.addRow,iconProps:{iconName:"CirclePlus"}}),{},{key:"expression",isDisabled:r,onClick:()=>{e.onChange(Object(c.c)(e.metadata,e.expression,e.expected)),i.announce(e.resources.onAddRowAnnouncement)}}),d(d({},e.expression.template.addGroupLabel||{name:e.resources.addGroup,iconProps:{iconName:"List"}}),{},{key:"group",isDisabled:r||o,onClick:()=>{e.onChange(Object(c.b)(e.metadata,e.expression,e.expected)),i.announce(e.resources.onAddGroupAnnouncement)}}),...f]});return m&&m.hideTreeLines?n.createElement(a.Line,null,v):n.createElement(l.a,{leftMargin:"10px",topOffset:"10px",length:"40px",isRTL:!!e.isRTL&&e.isRTL},v)},O=e=>{var t=d(d({},e.customizations),e.expression.subexpressions[e.i].template.customizations),r=n.useContext(p.a),o=[{key:"delete",id:"Delete_"+e.ariaDescribedBy,name:e.resources.deleteExpression,iconProps:{iconName:"Trash"},isDisabled:!e.canDelete,onClick:t=>{e.onChange(Object(c.d)(e.expression,e.i)),r.announce(e.resources.onDeleteAnnouncement),function(e,t){var r,n=document.getElementsByClassName("eb-GroupExpressionView eb-GroupExpressionView-RootExpression");if(!n)return;for(var o=n[0].getElementsByClassName("eb-ExpressionView-ControlsMenu"),i=null==e||null===(r=e.currentTarget)||void 0===r?void 0:r.id,a=function(e){var r=o[e]&&o[e].hasAttribute("aria-describedby")?o[e].getAttribute("aria-describedby"):"";if(null!==r&&i.indexOf(r)>-1)return 0===e?(!function(e,t,r){for(var n=r||"eb-",o=e.indexOf(n),i=e.substring(0,o),a=1;a<t.length;a++){var c=t[a]&&t[a].hasAttribute("aria-describedby")?t[a].getAttribute("aria-describedby"):"";if(!(null!==c&&c.indexOf(i)>-1))return!1}return!0}(r,o,t)&&e+1<o.length?window.setTimeout(()=>{o[0]&&o[0].focus()},400):window.setTimeout(()=>{var e=n[0].querySelector("#AddMenu1");e&&e.focus()},400),0):(window.setTimeout(()=>{o[e-1]&&o[e-1].focus()},400),0)},c=0;c<o.length&&0!==a(c);c++);}(t,e.htmlId)}},...t&&t.hideMovement?[]:[{key:"up",name:e.resources.moveUpExpression,isDisabled:!e.moveAbove&&0===e.i,iconProps:{iconName:"Up"},onClick:()=>{e.moveAbove&&0===e.i?(e.moveAbove(e.expression.subexpressions[0]),r.announce(e.resources.onMoveUpAnnouncement)):e.onChange(Object(c.g)(e.expression,e.i,-1))}},{key:"down",name:e.resources.moveDownExpression,isDisabled:!e.moveBelow&&e.i===e.expression.subexpressions.length-1,iconProps:{iconName:"Down"},onClick:()=>{e.moveBelow&&e.i===e.expression.subexpressions.length-1?(e.moveBelow(e.expression.subexpressions[e.i]),r.announce(e.resources.onMoveDownAnnouncement)):e.onChange(Object(c.g)(e.expression,e.i,1))}}],{key:"group",name:e.resources.makeGroup,isDisabled:w(e),iconProps:{iconName:"ViewAll"},onClick:()=>{e.makeGroup&&(e.makeGroup(),r.announce(e.resources.onMakeGroupAnnouncement))}}];return!Object(c.h)(e.expression.subexpressions[e.i])||!e.ungroup||t&&t.hideUngrouping||o.push({key:"ungroup",name:e.resources.ungroup,isDisabled:!e.ungroup,iconProps:{iconName:"ViewAll2"},onClick:()=>{e.ungroup&&(e.ungroup(),r.announce(e.resources.onUngroupAnnouncement))}}),n.createElement(n.Fragment,null,n.createElement(a.Ellipsis,{className:"eb-ExpressionView-ControlsMenu",ariaDescribedBy:e.ariaDescribedBy,resources:e.resources,style:e.style,items:o}))};function w(e){return!e.expression.subexpressions[e.i].selected||!e.makeGroup||!e.canMakeGroup()||!Object(s.a)(e.location.length,e.expression)||e.expression.subexpressions.some(e=>!(!e.selected||!Object(s.d)(e.template)||!e.template.distinctTemplate||void 0!==e.template.distinctTemplate.canMakeGroup&&e.template.distinctTemplate.canMakeGroup()))}},20511:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return l}));var n=r(11766),o=r(20503);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=e=>{var{leftMargin:t,topOffset:r,length:i,color:c,gutterStyle:s,barStyle:l,children:u,isRTL:p}=e;return n.createElement(o.Line,{className:"eb-TreeLineGutter",style:a({marginLeft:p?0:t,marginRight:p?t:0,borderLeft:p?"none":"1px solid",borderRight:p?"1px solid":"none",borderColor:c||s&&s.borderColor||"#9BF",justifyContent:"flex-start"},s)},n.createElement("div",{className:"eb-TreeLineGutter-HookContainer",style:{display:"flex",flexDirection:"column",marginTop:r}},n.createElement("div",{style:a(a({width:i,flex:1,borderBottom:"1px solid"},l),{},{borderColor:c||l&&l.borderColor||"#9BF"}),className:"eb-TreeLineGutter-Hook"}),n.createElement("div",{style:{width:i,flex:1}})),u)},l=e=>{var{leftMargin:t,topOffset:r,length:i,color:c,gutterStyle:s,barStyle:l,children:u,isRTL:p}=e;return n.createElement(o.Line,{className:"eb-TreeLineBracket",style:a({marginLeft:p?0:t,marginRight:p?t:0},s)},n.createElement("div",{className:"eb-TreeLineBracket-HookContainer",style:{display:"flex",flexDirection:"column"}},n.createElement("div",{style:a(a({width:i,flex:1,borderLeft:p?"none":"1px solid",borderRight:p?"1px solid":"none",borderBottom:"1px solid"},l),{},{borderColor:c||l&&l.borderColor||"#9BF"}),className:"eb-TreeLineBracket-Hook"}),n.createElement("div",{style:{width:i,flex:1}})),u)}},20512:function(e,t,r){"use strict";r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return f}));var n=r(20500),o=r(20513),i=r(20514);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=u(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e){return Object(n.h)(e)&&e.template instanceof f}var f=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.displayName=r,this.defaultEntityContext=n,this.customizations=o,this.key=void 0,this.selectionDisabled=!0,this.label=void 0,this.label={name:this.displayName},this.key=this.name}var t,r,a;return t=e,(r=[{key:"create",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return{template:this,state:e,subexpressions:r}}},{key:"addedGroup",value:function(e,t){var r=Object(n.a)(e.defaultGroup(),this.addedRow(e,t)),{state:o}=t;return o?c(c({},r),{},{state:r.state.withNewContext(o.entityContext)}):r}},{key:"addedRow",value:function(e,t){var{state:r}=t;if(!r)return e.defaultRow().defaultExpression(new o.a(this.defaultEntityContext));var n=e;return n.row.create(n.row.fieldTemplate.create(r.entityContext,""),n.row.defaultDataType.defaultExpression(),void 0)}},{key:"prettyString",value:function(e){return this.label.name+" ("+e.subexpressions.map(e=>(Object(n.h)(e),e.template.prettyString(e))).join(", ")+")"}},{key:"applicableType",value:function(e){return i.b.boolean.accepts(e)}}])&&l(t.prototype,r),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20513:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityContext=t,this.innerType=r}var t,r,o;return t=e,(r=[{key:"accepts",value:function(e){return!this.innerType||this.innerType.accepts(e)}},{key:"context",get:function(){return this.entityContext}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return e instanceof i}},20514:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return c}));var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t}var t,r,o;return t=e,(r=[{key:"accepts",value:function(e){return a(e)?e.name===this.name:"string"==typeof e?e===this.name:e.accepts(this)}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return e instanceof i}var c={boolean:new i("boolean"),string:new i("string")}},20515:function(e,t,r){"use strict";var n=r(20516);new n.a},20516:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i}));var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,(r=[{key:"accepts",value:function(e){return!0}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20517:function(e,t,r){},20518:function(e,t,r){"use strict";r.d(t,"i",(function(){return u})),r.d(t,"f",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return d})),r.d(t,"g",(function(){return m})),r.d(t,"h",(function(){return b})),r.d(t,"d",(function(){return y})),r.d(t,"e",(function(){return v})),r.d(t,"j",(function(){return h})),r.d(t,"c",(function(){return g})),r.d(t,"m",(function(){return O})),r.d(t,"n",(function(){return w})),r.d(t,"r",(function(){return E})),r.d(t,"o",(function(){return C})),r.d(t,"q",(function(){return S})),r.d(t,"p",(function(){return P})),r.d(t,"l",(function(){return j})),r.d(t,"s",(function(){return T})),r.d(t,"t",(function(){return k})),r.d(t,"k",(function(){return R}));var n=r(20519),o=r(20520),i=r(11766);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u={errorNoValues:"Provide at least one value for the condition",removeButtonAriaLabel:"Remove"},p=s(s({},u),{},{loadingResults:"Loading results...",noResults:"No results found"}),f={equals:"equals",doesNotEqual:"doesn't equal"},d=s(s({},f),{},{greaterThan:"greater than",greaterThanOrEqualTo:"greater than or equal to",lessThan:"less than",lessThanOrEqualTo:"less than or equal to"}),m={contains:"contains",doesNotContain:"doesn't contain",beginsWith:"begins with",doesNotBeginWith:"doesn't begin with",endsWith:"ends with",doesNotEndWith:"doesn't end with"},b={containsData:"contains data",doesNotContainData:"doesn't contain data"},y={inputControlLabel:"value"},v={noValue:"Provide a value for the condition",minValue:"Input value is lower than the minimum value allowed for this field ({0})",maxValue:"Input value is greater than the maximum value allowed for this field ({0})"},h=s(s({},v),{},{maxPrecision:"Input value has a greater precision than the maximum allowed for this field ({0})"}),g={fieldNotSelected:"Select a field"};function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s(s({},m),y);return[{name:"like",displayName:e.contains,valueFormat:"%{0}%",valueComponent:t=>i.createElement(o.a,a({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:k},{name:"not-like",displayName:e.doesNotContain,valueFormat:"%{0}%",valueComponent:t=>i.createElement(o.a,a({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:k},{name:"begins-with",displayName:e.beginsWith,xmlName:"like",valueFormat:"{0}%",valueComponent:t=>i.createElement(o.a,a({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:k},{name:"does-not-begins-with",displayName:e.doesNotBeginWith,xmlName:"not-like",valueFormat:"{0}%",valueComponent:t=>i.createElement(o.a,a({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:k},{name:"ends-with",displayName:e.endsWith,xmlName:"like",valueFormat:"%{0}",valueComponent:t=>i.createElement(o.a,a({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:k},{name:"does-not-ends-with",displayName:e.doesNotEndWith,xmlName:"not-like",valueFormat:"%{0}",valueComponent:t=>i.createElement(o.a,a({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:k}]}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b;return[{name:"not-null",displayName:e.containsData,valueComponent:null},{name:"null",displayName:e.doesNotContainData,valueComponent:null}]}function E(e){return!isNaN(Number(e))}function C(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h,o=[];""===e&&o.push(r.noValue),E(e)&&t&&null!=t.minValue&&t.minValue>Number(e)&&o.push(n.String.Format(r.minValue,t.minValue.toString())),E(e)&&t&&null!=t.maxValue&&t.maxValue<Number(e)&&o.push(n.String.Format(r.maxValue,t.maxValue.toString()));var i=E(e)&&Number(e)%1!=0?e.split(".")[1].length:0;return E(e)&&t&&null!=t.precision&&t.precision<i&&o.push(n.String.Format(r.maxPrecision,t.precision.toString())),o}function S(e,t){return"eq"===e?t?"in":"eq":"ne"===e?t?"not-in":"ne":e}function P(e){return"eq"===e||"in"===e?"eq":"ne"===e||"not-in"===e?"ne":e}function j(e,t,r){var n=e.attributes.value;if(n)return r.create(P(e.attributes.operator),n,t);var o=(e.elements||[]).map(e=>e.elements||[]).map(e=>e[0]&&e[0].text).filter(e=>"string"==typeof e);return r.create(P(e.attributes.operator),o.join(","),t)}function T(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.state.dataType.state.value,n=r.split(",");return!t&&n.length<2?{name:"condition",type:"element",attributes:{attribute:e.state.field.state.selectedFieldName||"",operator:S(e.state.dataType.state.operatorName,!1),value:n[0]}}:{name:"condition",type:"element",attributes:{attribute:e.state.field.state.selectedFieldName||"",operator:S(e.state.dataType.state.operatorName,!0)},elements:n.map(e=>({name:"value",type:"element",elements:[{type:"text",text:e}]}))}}function k(e,t){return!!t&&!!O().find(e=>e.name===t.name)}function R(e){e.attributes.attribute=e.attributes.attribute.concat("name")}},20520:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(11766),o=r(15028),i=["value","onChange"];function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(d,e);var t,r,l,f=p(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=f.call(this,e)).onBlur=e=>{t.props.onChange(e.target.value)},t.onChange=(e,r)=>{t.setState({value:r||""})},t.state={value:t.props.value},t}return t=d,(r=[{key:"render",value:function(){var e=this.props,{value:t,onChange:r}=e,s=c(e,i);return n.createElement(o.a,a({},s,{value:this.state.value,onBlur:this.onBlur,onChange:this.onChange}))}},{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({value:this.props.value})}}])&&s(t.prototype,r),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),d}(n.PureComponent)},20521:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(12754),o=r(12811),i=r(13243),a=r(13242),c=r(12812),s=r(11766),l=r(20503),u=r(20522),p=r(20523);function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=Object(n.eb)({selectors:{"& .ms-BasePicker-input":{height:"30px"}}}),g=Object(n.eb)({selectors:{"& .ms-BasePicker-text":{paddingRight:"24px",fontWeight:"bold"}}}),O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(y,e);var t,r,n,d=b(y);function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=d.call(this,e)).pickerRef=void 0,t.onBlur=()=>t.pickerRef.current&&t.onChange(t.pickerRef.current.items),t.onDropdownClick=()=>t.pickerRef.current&&t.pickerRef.current.focusInput(),t.onEmptyInputFocus=e=>t.onFilterChanged("",e),t.onFilterChanged=(e,r)=>(t.state.cachedResults?Promise.resolve(t.state.cachedResults):t.props.resolver.resolveOptionSetMembers(t.props.entityContext,t.props.fieldContext)).then(r=>(t.setState({cachedResults:r}),r.filter(t=>t.displayName.toLowerCase().indexOf(e.toLowerCase())>=0||t.description&&t.description.toLowerCase().indexOf(e.toLowerCase())>=0))),t.onItemSelected=e=>e&&t.pickerRef.current&&!t.pickerRef.current.items.find(t=>t.value===e.value)?e:null,t.onChange=e=>{e?t.props.onChange(e.map(e=>e.value.toString()).join(","),"(".concat(e.map(e=>e.displayName).join(", "),")")):""!==t.props.value&&t.props.onChange("",void 0)},t.state={cachedResults:void 0},t.pickerRef=s.createRef(),t}return t=y,(r=[{key:"componentDidMount",value:function(){this.props.value&&this.props.resolver.resolveOptionSetMembers(this.props.entityContext,this.props.fieldContext).then(e=>{this.setState({cachedResults:e})})}},{key:"componentDidUpdate",value:function(e){this.props.fieldContext!==e.fieldContext&&(void 0===e.fieldContext||e.fieldContext&&this.props.fieldContext&&this.props.fieldContext.name!==e.fieldContext.name)&&(this.setState({cachedResults:void 0}),this.componentDidMount())}},{key:"render",value:function(){var e,t=this.props.value,r=(t?t.split(","):[]).map(e=>{var t=Number.parseInt(e,10),r=(this.state.cachedResults||[]).find(e=>e.value===t);return{value:t,description:r?r.description:"",displayName:r?r.displayName:""}}),n=!!t&&void 0===this.state.cachedResults;return s.createElement(l.Line,null,s.createElement("div",null,s.createElement(p.a,{className:Object(o.a)(this.props.className,h,!n&&!this.props.disabled&&g),componentRef:this.pickerRef,disabled:n||this.props.disabled,inputProps:{"aria-describedby":this.props.ariaDescribedBy,"aria-label":this.props.ariaLabel},onBlur:this.onBlur,onChange:this.onChange,onEmptyInputFocus:this.onEmptyInputFocus,onItemSelected:this.onItemSelected,onResolveSuggestions:this.onFilterChanged,pickerSuggestionsProps:{loadingText:this.props.labels.loadingResults,noResultsFoundText:this.props.labels.noResults,suggestionsContainerAriaLabel:"".concat(null===(e=this.props.fieldContext)||void 0===e?void 0:e.displayName," ").concat(this.props.ariaLabel)},removeButtonAriaLabel:this.props.labels.removeButtonAriaLabel,selectedItems:n?[]:r}),n&&s.createElement(i.a,{className:"IconDropdown-Spinner",size:a.a.medium,style:{marginTop:"-26px"}})),s.createElement(c.a,{style:this.props.disabled?u.a:u.b,iconName:"ChevronDown",onClick:this.onDropdownClick}))}}])&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(s.PureComponent)},20522:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return s}));var a={color:"#666",fontSize:"12px",lineHeight:"32px",marginLeft:"-24px",marginRight:"10px"},c=o(o({},a),{},{cursor:"pointer"}),s=o(o({},a),{},{cursor:"default"})},20523:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(12754),o=r(15532),i=r(15709),a=r(14650),c=r(11766),s=r.n(c);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=d(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=Object(n.eb)({padding:0}),O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(i,e);var t,r,n,o=y(i);function i(){return m(this,i),o.apply(this,arguments)}return t=i,r&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(o.a);O.defaultProps={onRenderItem:e=>{var t=u(u({},e),{},{item:{key:"",name:""},onItemChange:()=>null,removeButtonAriaLabel:e.removeButtonAriaLabel,title:e.item.displayName});return s.a.createElement(i.a,t,e.item.displayName)},onRenderSuggestionsItem:e=>s.a.createElement("div",{style:{textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"60",padding:"7px 12px"}},s.a.createElement(a.a,{className:g},e.displayName))}},20524:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(11766),o=r(15871),i=r(13243),a=r(13242);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,r,u,d=f(m);function m(){return s(this,m),d.apply(this,arguments)}return t=m,(r=[{key:"render",value:function(){return n.createElement("div",{style:{position:"relative"}},n.createElement(o.a,c({},this.props,{autoComplete:"on",styles:{root:{float:"left"},label:{display:"none"}}})),this.props.isLoading&&n.createElement(i.a,{size:a.a.small,styles:{root:{position:"absolute",left:"16px",top:"1px"},circle:{marginLeft:-2,marginTop:7}}}))}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.PureComponent)},20525:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r(11766),o=r(12754),i=r(12812),a=r(20522),c=r(20503),s=r(20502),l=r(20526),u=r(20527);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){m(i,n,o,a,c,"next",e)}function c(e){m(i,n,o,a,c,"throw",e)}a(void 0)}))}}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=Object(o.eb)({selectors:{"& .ms-BasePicker-input":{height:"30px"},"& .ms-BasePicker-text":{paddingRight:"24px",fontWeight:"bold"}}}),C=Object(o.eb)({selectors:{"& .ms-BasePicker-input":{height:"30px"}}}),S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(m,e);var t,r,o,p,d=g(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=d.call(this,e)).pickerRef=void 0,t.onBlur=()=>{t.pickerRef.current&&t.onChange(t.pickerRef.current.items)},t.onChange=e=>{t.props.onChange(e||[],e?"(".concat(e.map(e=>e.displayName).join(", "),")"):void 0)},t.onDropdownClick=()=>t.pickerRef.current&&t.pickerRef.current.focusInput(),t.getInitialSelectedLookups=b((function*(){if(!t.state.finishedInitialLoading&&t.selectedItems().some(e=>!e.displayName)){var e=t.isPolymorphicLookup(),r=yield t.getRelations(e),n=t.gatherLookupTargets();if(t.props.entityContext){var o=yield t.props.resolver.resolveLookupRecordsById(t.props.entityContext,n,t.selectedItems().map(e=>e.id));o=t.processPolymorphicLookupRecords(e,o,r),t.setState({previouslySelectedItems:o,finishedInitialLoading:!0})}}})),t.onEmptyInputFocus=e=>t.getFilteredLookups("",e),t.getFilteredLookups=function(){var e=b((function*(e,r){var n=t.state.cachedResults.get(e);if(Array.isArray(n))return n;var o=t.isPolymorphicLookup(),i=yield t.getRelations(o),a=t.gatherLookupTargets();if(t.props.entityContext){var c=yield t.props.resolver.resolveLookupRecordsSimple(t.props.entityContext,a,{searchString:e,searchDefaultLookupView:!0});return 0===c.length&&Object(s.h)(e.toLowerCase())&&c.push({id:e.toLowerCase(),displayName:e.toLowerCase(),entityLogicalName:"",unmatchedRecord:!0}),t.processLookupRecords(c,o,i,e)}return[]}));return function(t,r){return e.apply(this,arguments)}}(),t.onItemSelected=e=>e&&t.pickerRef.current&&!t.pickerRef.current.items.find(t=>t.id===e.id)?e:null,t.state={cachedResults:new Map,previouslySelectedItems:[],finishedInitialLoading:!1},t.pickerRef=n.createRef(),t}return t=m,(r=[{key:"componentDidMount",value:function(){this.getInitialSelectedLookups()}},{key:"componentDidUpdate",value:function(){this.componentDidMount()}},{key:"render",value:function(){var e=this.selectedItems();return n.createElement(c.Line,null,n.createElement(u.a,{className:this.props.disabled?C:E,componentRef:this.pickerRef,onEmptyInputFocus:this.onEmptyInputFocus,onResolveSuggestions:this.getFilteredLookups,onItemSelected:this.onItemSelected,selectedItems:e,onChange:this.onChange,onBlur:this.onBlur,resolveDelay:500,inputProps:{"aria-describedby":this.props.ariaDescribedBy,"aria-label":this.props.labels.inputControlLabel},pickerSuggestionsProps:{loadingText:this.props.labels.loadingResults,noResultsFoundText:this.props.labels.noResults},itemLimit:this.props.singleSelect?1:void 0,disabled:this.props.disabled,removeButtonAriaLabel:this.props.labels.removeButtonAriaLabel}),n.createElement(i.a,{style:this.props.disabled?a.a:a.b,iconName:"ChevronDown",onClick:this.onDropdownClick}))}},{key:"selectedItems",value:function(){var e=this.props.value;return(e&&Array.isArray(e)?e:[]).map(e=>{if(!e.displayName){var t=this.state.previouslySelectedItems.find(t=>t.id.toLowerCase()===e.id.toLowerCase());if(t)return t;if(this.state.finishedInitialLoading)return f(f({},e),{},{displayName:e.id,unmatchedRecord:!0})}return e})}},{key:"getRelations",value:(p=b((function*(e){var t=e&&this.props.entityContext?yield this.props.resolver.resolveRelatedEntities(this.props.entityContext):[],r=new Map;return t.forEach(e=>{r.set(e[0].name.toLowerCase(),e[0])}),r})),function(e){return p.apply(this,arguments)})},{key:"isPolymorphicLookup",value:function(){return this.props.fieldContext&&this.props.fieldContext.targets&&this.props.fieldContext.targets.length>1}},{key:"gatherLookupTargets",value:function(){return this.props.fieldContext&&this.props.entityContext&&Object(l.e)(this.props.fieldContext)?[this.props.entityContext.name.toLowerCase()]:this.props.fieldContext&&this.props.fieldContext.targets?[...this.props.fieldContext.targets]:[]}},{key:"processLookupRecords",value:function(e,t,r,n){return e=this.processPolymorphicLookupRecords(t,e,r),n&&this.setState({cachedResults:this.state.cachedResults.set(n,e)}),e}},{key:"processPolymorphicLookupRecords",value:function(e,t,r){return e&&(t=t.map(e=>{var t=r.get(e.entityLogicalName);return f(f({},e),{},{entityDisplayName:t?t.displayName:e.entityLogicalName})})),t}}])&&y(t.prototype,r),o&&y(t,o),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.PureComponent)},20526:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"b",(function(){return c}));var n=function(e){return e.String="String",e.MultilineText="Memo",e.WholeNumber="Integer_None",e.Date="DateTime",e.OptionSet="Picklist",e.MultiOptionSet="MultiSelectPicklistType",e.TwoOptions="Boolean",e.Lookup="Lookup",e.Customer="Customer",e.Owner="Owner",e.Currency="Money",e.Float="Double",e.Decimal="Decimal",e.Language="Integer_Language",e.UniqueIdentifier="UniqueIdentifier",e.Duration="Integer_Duration",e}({});function o(e){return e.dataType===n.Lookup}function i(e){return e.dataType===n.Owner}function a(e){return e.dataType===n.UniqueIdentifier}function c(e,t){return!!e.targets&&e.targets.indexOf(t.toLowerCase())>=0}},20527:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(12754),o=r(15532),i=r(15709),a=r(13243),c=r(13242),s=r(14650),l=r(11766),u=r.n(l);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=Object(n.eb)({padding:0}),E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(i,e);var t,r,n,o=h(i);function i(){return y(this,i),o.apply(this,arguments)}return t=i,r&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(o.a);E.defaultProps={onRenderItem:e=>{var t=f(f({},e),{},{item:{key:"",name:""},onItemChange:()=>null,removeButtonAriaLabel:e.removeButtonAriaLabel,title:e.item.displayName});return u.a.createElement(i.a,t,e.item.displayName?e.item.displayName:u.a.createElement(a.a,{size:c.a.xSmall,styles:{root:{marginTop:7}}}))},onRenderSuggestionsItem:e=>u.a.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"60",padding:"7px 12px"}},u.a.createElement(s.a,{className:w},e.displayName," ",e.entityDisplayName?"(".concat(e.entityDisplayName,")"):void 0))}},20528:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(11766),o=r(15749),i=r(15705),a=r(15646);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(d,e);var t,r,l,f=p(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=f.call(this,e)).onGetErrorMessage=e=>{t.props.value===e&&""===e&&t.props.onChange("")},t.onBlurred=e=>{t.props.onChange(void 0!==e?String(e):"")},t.onBlurUseLastValid=()=>{t.props.onChange(void 0!==t.state.lastValidValue?String(t.state.lastValidValue):""),t.setState({rerenderIndicator:!t.state.rerenderIndicator})},t.onFormUpdated=(e,r)=>{if(r){r=r.trim();var n=t.props.formatter?t.props.formatter.parseNumberFromString(r):void 0;if((n||0===n)&&n!==t.state.lastValidValue){Number.isInteger(n)||(n=Math.trunc(n));var o="";t.props.formatter&&(o=t.props.formatter.formatNumber(n)),t.setState({lastValidValue:n,formattedValue:o})}}else t.setState({lastValidValue:"",formattedValue:""})},t.makeStateFromProps=e=>{var t="",r="";return e.value&&e.formatter&&((t=parseFloat(e.value))||0===t?r=e.formatter.formatNumber(t):t=""),{lastValidValue:t,formattedValue:r,rerenderIndicator:!1}},t.state=t.makeStateFromProps(e),t}return t=d,(r=[{key:"render",value:function(){return this.props.formatter?n.createElement(a.b,{onUpdated:this.onFormUpdated,key:"wholeNumberForm_"+this.state.rerenderIndicator.toString()},n.createElement("div",null,n.createElement(i.a,{inputKey:"wholeNumberInput",value:this.state.formattedValue,textFieldProps:{onBlur:this.onBlurUseLastValid,ariaLabel:this.props.ariaLabel,"aria-describedby":this.props.ariaDescribedBy,suffix:this.props.valueSuffix,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1}}))):n.createElement(o.a,c({},this.props,{value:""!==this.props.value?Number(this.props.value):void 0,onBlurred:this.onBlurred,textFieldProps:{ariaLabel:this.props.ariaLabel,"aria-describedby":this.props.ariaDescribedBy,suffix:this.props.valueSuffix,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1}}))}}])&&s(t.prototype,r),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),d}(n.PureComponent)},20529:function(e,t,r){"use strict";r(11766),r(20526);var n=r(20518);r(20530),r(20531);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i(i(i(i({},n.a),n.h),{},{incorrectDataType:"Provided value should be a monetary value"},n.d),n.j)},20530:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(15646),i=r(15705),a=r(15749);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=p.call(this,e)).onGetErrorMessage=e=>{t.props.value===e&&""===e&&t.props.onChange("")},t.onBlurred=e=>{t.props.onChange(void 0!==e?String(e):"")},t.onBlurUseLastValid=()=>{t.props.onChange(void 0!==t.state.lastValidValue?String(t.state.lastValidValue):""),t.setState({rerenderIndicator:!t.state.rerenderIndicator})},t.onFormUpdated=(e,r)=>{if(r){r=r.trim();var n=t.props.formatter?t.props.formatter.parseNumberFromString(r):void 0;if((n||0===n)&&n!==t.state.lastValidValue){var o="";t.props.formatter&&(o=t.props.formatter.formatNumber(n)),t.setState({lastValidValue:n,formattedValue:o})}}else t.setState({lastValidValue:"",formattedValue:""})},t.makeStateFromProps=e=>{var t="",r="";return e.value&&e.formatter&&((t=parseFloat(e.value))||0===t?r=e.formatter.formatNumber(t):t=""),{lastValidValue:t,formattedValue:r,rerenderIndicator:!1}},t.state=t.makeStateFromProps(e),t}return t=f,(r=[{key:"render",value:function(){return this.props.formatter?n.createElement(o.b,{onUpdated:this.onFormUpdated,key:"realNumberForm_"+this.state.rerenderIndicator.toString()},n.createElement("div",null,n.createElement(i.a,{inputKey:"RealNumberInput",value:this.state.formattedValue,textFieldProps:{onBlur:this.onBlurUseLastValid,ariaLabel:this.props.ariaLabel,"aria-describedby":this.props.ariaDescribedBy,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1}}))):n.createElement(a.b,{value:""!==this.props.value?Number(this.props.value):void 0,onBlurred:this.onBlurred,textFieldProps:{ariaLabel:this.props.ariaLabel,"aria-describedby":this.props.ariaDescribedBy,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1}})}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.PureComponent)},20531:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(20518),o=(e,t,r)=>t?[]:[n.c.fieldNotSelected]},20532:function(e,t,r){"use strict";var n=r(15657),o=r(15697),i=r(11766),a=r(20519),c=(r(20526),r(20518)),s=(r(20528),r(20533)),l=r(20536);r(20531);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function f(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return(t=w(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}g(g(g({on:"on",equals:"equals",onOrAfter:"on or after",onOrBefore:"on or before",yesterday:"yesterday",today:"today",tomorrow:"tomorrow",nextSevenDays:"next 7 days",lastSevenDays:"last 7 days",nextWeek:"next week",lastWeek:"last week",thisWeek:"this week",nextMonth:"next month",lastMonth:"last month",thisMonth:"this month",nextYear:"next year",lastYear:"last year",thisYear:"this year",lastXHours:"last x hours",nextXHours:"next x hours",lastXDays:"last x days",nextXDays:"next x days",lastXWeeks:"last x weeks",nextXWeeks:"next x weeks",lastXMonths:"last x months",nextXMonths:"next x months",lastXYears:"last x years",nextXYears:"next x years",olderThanXMinutes:"older than x minutes",olderThanXHours:"older than x hours",olderThanXDays:"older than x days",olderThanXWeeks:"older than x weeks",olderThanXMonths:"older than x months",olderThanXYears:"older than x years",containsData:"contains data (any time)",doesNotContainData:"doesn't contain data",inFiscalYear:"in fiscal year",lastFiscalYear:"last fiscal year",thisFiscalYear:"this fiscal year",nextFiscalYear:"next fiscal year",lastXFiscalYears:"last x fiscal years",nextXFiscalYears:"next x fiscal years",inFiscalPeriod:"in fiscal period",lastFiscalPeriod:"last fiscal period",thisFiscalPeriod:"this fiscal period",nextFiscalPeriod:"next fiscal period",lastXFiscalPeriods:"last x fiscal periods",nextXFiscalPeriods:"next x fiscal periods",inFiscalPeriodAndYear:"in fiscal period and year",inOrAfterFiscalPeriodAndYear:"in or after fiscal period and year",inOrBeforeFiscalPeriodAndYear:"in or before fiscal period and year"},{dateQuarter:"Quarter {0}",dateFiscalYear:"FY{0}"}),c.d),c.j);i.PureComponent;function E(e,t){var r=e.toString(),n="";return r.length<t&&(n="0".repeat(t-r.length)),"".concat(n).concat(r)}var C=function(e){d(r,e);var t=b(r);function r(e){var n;return u(this,r),(n=t.call(this,e)).populateOptions=(e,t,r)=>{for(var n=[],o=t;o<=r;o++){var i={key:o,text:a.String.Format(e,o.toString())};n.push(i)}return n},n.onChange=(e,t)=>{t&&(n.props.onChange(t.key.toString()),n.setState({selectedKey:Number(t.key)}))},n.state={selectedKey:Number(n.props.value)},n}return f(r,[{key:"componentWillReceiveProps",value:function(e){e.value&&this.setState({selectedKey:Number(e.value)})}},{key:"render",value:function(){return i.createElement(o.a,{"aria-describedby":this.props.ariaDescribedBy,ariaLabel:this.props.ariaLabel,disabled:this.props.disabled,onChange:this.onChange,options:this.populateOptions(this.props.labels.dateFiscalYear,1970,2038),selectedKey:this.state.selectedKey,style:{width:"110px",marginRight:"8px"}})}}]),r}(i.PureComponent),S=function(e){d(r,e);var t=b(r);function r(e){var n;return u(this,r),(n=t.call(this,e)).populateOptions=(e,t,r)=>{for(var n=[],o=t;o<=r;o++){var i={key:o,text:a.String.Format(e,o.toString())};n.push(i)}return n},n.onChange=(e,t)=>{t&&(n.props.onChange(t.key.toString()),n.setState({selectedKey:Number(t.key)}))},n.state={selectedKey:Number(n.props.value)},n}return f(r,[{key:"componentWillReceiveProps",value:function(e){e.value&&this.setState({selectedKey:Number(e.value)})}},{key:"render",value:function(){return i.createElement(o.a,{"aria-describedby":this.props.ariaDescribedBy,ariaLabel:this.props.ariaLabel,disabled:this.props.disabled,onChange:this.onChange,options:this.populateOptions(this.props.labels.dateQuarter,1,4),selectedKey:this.state.selectedKey})}}]),r}(i.PureComponent);i.PureComponent;Math.floor((new Date).getMonth()/3),(new Date).getFullYear()},20533:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b}));var n=r(11766),o=r(15871),i=r(20534),a=r(20535);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d={iconName:"Clock",className:"icon-style",styles:{root:{backgroundColor:"transparent",top:-3,selectors:{":hover":{backgroundColor:"transparent"}}}}},m=-1,b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=p.call(this,e))._comboBox=void 0,t._comboBoxRef=void 0,t._resolveOptions=e=>{var{options:r}=t.state;if(r&&r.length>0)return r;var{initialOptions:n,initialSelectedKey:o}=t.props,i=[...n];return t.setState({options:i,selectedOptionKey:o===m?void 0:o}),i},t._onChange=(e,r,n,o)=>{var{onChange:a,onParseTime:c,onFormatTime:s,initialSelectedKey:l}=t.props,{options:u}=t.state;if(r)t.setState({selectedOptionKey:r.key,initialDisplayValue:void 0},()=>a(r.key));else if(o){var p=c(o);if(null!==p&&-1!==p)if(u.find(e=>e.key===p))t.setState({selectedOptionKey:p,initialDisplayValue:void 0},()=>a(p));else{var f=s(Object(i.b)(Object(i.c)(new Date),p)),d=[...t.state.options.filter(e=>e.data&&!0===e.data.default),{key:p,text:f,hidden:!0}];d.sort(t._optionComparer),t.setState({options:d,selectedOptionKey:p,initialDisplayValue:void 0},()=>a(p))}else t.setState({selectedOptionKey:l})}},t._comboBoxRef=e=>{t._comboBox=e},t.state={options:[],initialDisplayValue:e.initialDisplayValue},t}return t=f,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.initialDisplayValue&&e.initialDisplayValue!==this.props.initialDisplayValue&&this.setState({initialDisplayValue:e.initialDisplayValue}),e.initialSelectedKey&&e.initialSelectedKey!==this.props.initialSelectedKey&&this.setState({selectedOptionKey:e.initialSelectedKey})}},{key:"componentDidMount",value:function(){this._resolveOptions([]),this._setInputElementDisabled(this.props)}},{key:"componentDidUpdate",value:function(e){e.disabled!==this.props.disabled&&this._setInputElementDisabled(this.props)}},{key:"render",value:function(){var{selectedOptionKey:e,options:t,initialDisplayValue:r}=this.state,{ariaDescribedBy:i,ariaLabel:c,disabled:s,id:l}=this.props,u=Object(a.b)(),p=Object(a.a)(s);return n.createElement(o.a,{selectedKey:e,ariaDescribedBy:i,ariaLabel:c,autoComplete:"on",autofill:this._getAutofillProps(),allowFreeform:!0,options:t,text:r,buttonIconProps:d,styles:u,disabled:s,caretDownButtonStyles:p,useComboBoxAsMenuWidth:!0,onChange:this._onChange,onResolveOptions:this._resolveOptions,id:l,componentRef:this._comboBoxRef,required:this.props.required||void 0})}},{key:"_optionComparer",value:function(e,t){return e.key-t.key}},{key:"_setInputElementDisabled",value:function(e){if(this._comboBox._comboBoxWrapper&&this._comboBox._comboBoxWrapper.current){var t=this._comboBox._comboBoxWrapper.current.querySelector(".ms-ComboBox-Input");t&&(e.disabled?t.setAttribute("disabled","true"):t.removeAttribute("disabled"))}}},{key:"_getAutofillProps",value:function(){return{required:this.props.required}}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20534:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return p}));var n=1440,o=()=>{if(!Intl||!Intl.DateTimeFormat)return!1;var e=new Intl.DateTimeFormat([],{hour:"2-digit",minute:"2-digit",hourCycle:"h23"});return e.resolvedOptions&&e.resolvedOptions().hourCycle};function i(e){var t=new Date(e.getTime());return t.setHours(0,0,0,0),t}function a(e,t){return new Date(e.getTime()+6e4*t)}function c(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(e){return e&&e.length>0&&e.every(e=>null!=e&&""!==e)}function l(e,t){var r=t.map(e=>c(e)).join("|"),n=new RegExp("(?:[\\b\\s]|^)([0-9]{1,2})[".concat(r,"]([0-9]{2})(?:[\\b\\s]|$)")).exec(e);return n&&3===n.length?{hour:Number(n[1]),minute:Number(n[2])}:{hour:-1,minute:-1}}function u(e,t){if(!e||!s(t))return-1;var r=l(e,t);return!r||r.hour<0||r.hour>23||r.minute<0||r.minute>59?-1:60*r.hour+r.minute}function p(e,t,r,n){if(!(e&&s(n)&&s(t)&&s(r)))return-1;var o=function(e,t,r){return s(t)&&s(r)&&e&&-1!==e.search(/\d/)?t.find(t=>e.search("([\\b\\s]|^)".concat(c(t),"([\\b\\s]|$)"))>-1)?"AM":r.find(t=>e.search("([\\b\\s]|^)".concat(c(t),"([\\b\\s]|$)"))>-1)?"PM":null:null}(e,t,r);if(!o)return-1;var i=("AM"===o?t:r).map(e=>c(e)).join("|"),a=new RegExp("\\s?(".concat(i,")\\s?")),u=l(e.replace(a,"").trim(),n);return!u||u.hour<1||u.hour>12||u.minute<0||u.minute>59?-1:"AM"===o?u.hour%12*60+u.minute:60*(u.hour%12+12)+u.minute}},20535:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(12786),o=Object(n.c)(()=>({root:{display:"flex",minWidth:90,border:"1px solid transparent",borderColor:"rgb(118, 118, 118) !important",margin:"-1px 2px",paddingRight:"unset",paddingLeft:"unset",selectors:{":after":{content:"none !important",borderWidth:"0 !important"}}},rootHovered:{borderColor:"rgb(0, 0, 0) !important"},rootFocused:{borderColor:"rgb(0, 0, 0) !important"},rootDisabled:{backgroundColor:"transparent",border:"none",selectors:{":hover":{border:"none"}}},inputDisabled:{backgroundColor:"rgb(255, 255, 255)",color:"rgb(50, 49, 58)",selectors:{":hover":{backgroundColor:"rgb(226, 226, 226)"}}},container:{border:"1px solid transparent",width:"50%",flex:"1 1 auto",selectors:{":focus":{border:"1px solid rgb(0, 0, 0)"},input:{paddingRight:10,paddingLeft:10}}},callout:{border:"1px solid #edebe9",boxShadow:"none"},optionsContainer:{maxHeight:230}})),i=Object(n.c)(e=>({root:[e&&{display:"none"},{position:"initial",fontSize:16,height:"100%"}],icon:{marginLeft:0,marginRight:0,paddingBottom:"2px",paddingLeft:"unset",textAlign:"center",verticalAlign:"middle",flexShrink:0,fontSize:16}}))},20536:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(20533),o=r(20534);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialOptions=void 0,this.timeFormat24H=void 0,this.dateTimeFormatOptions=void 0,this.intlDateTimeFormat=void 0,this.minutesSinceMidnight=void 0,this.adjustedDate=void 0,this.initialDisplayValue=void 0,this.changeHandler=void 0,this.parseTimeHandler=void 0,this.formatTimeHandler=void 0,this.props=void 0,this.props=t,this.timeFormat24H=this._gettimeFormat24H(e.shortTimePattern),this.dateTimeFormatOptions=this._getDateTimeFormatOptions(this.timeFormat24H),this.intlDateTimeFormat=this._getDateTimeFormat(this.dateTimeFormatOptions),this.initialOptions=this._getDefaultOptions(),this.minutesSinceMidnight=0,this.adjustedDate=new Date(t.value),this.changeHandler=this._onChange.bind(this),this.parseTimeHandler=this._parseTime.bind(this),this.formatTimeHandler=this._formatTime.bind(this),this.initialDisplayValue=this._formatTime(this.adjustedDate)}var t,r,a;return t=e,(r=[{key:"updateProps",value:function(e){this.props=e;try{this.adjustedDate=new Date(e.value),this.initialDisplayValue=this._formatTime(this.adjustedDate)}catch(t){}}},{key:"_getDateTimeFormatOptions",value:function(e){if(!e)return{hour:"numeric",minute:"2-digit",hour12:!0};var t=2===e.length?"2-digit":"numeric";return Object(o.d)()?{hour:t,minute:"2-digit",hourCycle:"h23"}:{hour:t,minute:"2-digit",hour12:!1}}},{key:"_gettimeFormat24H",value:function(e){var t=e.match(/(H{1,2})/);return t&&2===t.length?t[1]:""}},{key:"_parseTime",value:function(t){var r=(t||"").replace(/[\u200E\u200F]/g,"");return r===e.NO_VALUE_DEFAULT_STRING?0:this.timeFormat24H?Object(o.e)(r,e.timeSeperators):Object(o.f)(r,e.amDesignators,e.pmDesignators,e.timeSeperators)}},{key:"_formatTime",value:function(t){try{return this.intlDateTimeFormat?this.intlDateTimeFormat.format(t):t.toLocaleTimeString([e.CULTURE_DEFAULT],this.dateTimeFormatOptions)}catch(r){return e.NO_VALUE_DEFAULT_STRING}}},{key:"_getDateTimeFormat",value:function(t){return new Intl.DateTimeFormat([e.CULTURE_DEFAULT],t)}},{key:"_getDefaultOptions",value:function(){for(var t=[],r=Object(o.c)(new Date),n=0;n<o.a;n+=e.OPTION_MINUTE_INCREMENT){var i=Object(o.b)(r,n);t.push({key:n,text:this._formatTime(i),data:{default:!0}})}return t}},{key:"_onChange",value:function(e){if(this.minutesSinceMidnight=e,void 0!==this.minutesSinceMidnight&&this.minutesSinceMidnight!==n.a&&this.adjustedDate){this.adjustedDate=new Date(this.adjustedDate.toDateString());var t=Object(o.b)(this.adjustedDate,this.minutesSinceMidnight),r=t.getDate(),i="";i=r<10?"0"+r.toString():r.toString();var a=t.getMonth()+1,c="";c=a<10?"0"+a.toString():a.toString();var s=t.getFullYear().toString()+"-"+c+"-"+i,l=t.toTimeString().substring(0,8);if(this.props.isISOTime){var u=new Date(s+"T"+l).toISOString().replace(/\.[0-9]{3}/,"");this.props.onChange(u)}else this.props.onChange(s+"T"+l)}}}])&&i(t.prototype,r),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.amDesignators=["AM"],c.pmDesignators=["PM"],c.timeSeperators=[":"],c.shortTimePattern="HH:MM",c.OPTION_MINUTE_INCREMENT=30,c.NO_VALUE_DEFAULT_STRING="---",c.CULTURE_DEFAULT="en-US"},20537:function(e,t,r){"use strict";r(11766);var n=r(20518);r(20526),r(20530),r(20531);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i(i(i(i({},n.a),n.h),{},{incorrectDataType:"Provided value should be a decimal"},n.d),n.j)},20538:function(e,t,r){"use strict";r(11766);var n=r(20518);r(20521),r(20526),r(20520),r(20531);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i(i(i(i(i({},n.b),n.g),n.h),n.d),{},{containValues:"contain values",doesNotContainValues:"doesn't contain values"},n.f)},20539:function(e,t,r){"use strict";r(11766),r(20526);var n=r(20518);r(20530),r(20531);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i(i(i(i({},n.a),n.h),{},{incorrectDataType:"Provided value should be a float"},n.d),n.j)},20540:function(e,t,r){"use strict";var n=r(12754),o=r(15708),i=r(12812),a=r(13243),c=r(13242),s=r(11766),l=r(20503),u=(r(20526),r(20518)),p=r(20522);r(20531);function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return(t=O(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var w=Object(n.eb)({selectors:{"& .ms-BasePicker-input":{height:"30px"}}}),E=h(h(h(h(h({},u.i),u.b),u.h),u.d),{},{equalsCurrentUserLanguage:"equals current user language",noResults:"No results found"});s.PureComponent},20541:function(e,t,r){"use strict";r(20526);var n=r(20518);r(20525),r(20542),r(11766),r(20531);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i(i(i(i(i({isCurrentUser:"equals current user",notCurrentUser:"does not equal current user",isCurrentBusinessUnit:"equals current business unit",notCurrentBusinessUnit:"does not equal current business unit"},n.b),n.g),n.h),n.d),{},{under:"under",notUnder:"not under",above:"above",aboveOrEqual:"above or equal",underOrEqual:"under or equal",isCurrentUserOrReportingHierarchy:"equals current user or his reporting hierarchy",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"equals current user and his teams or his reporting hierarchy and their teams",isCurrentUserTeams:"equals current user's teams",isCurrentUserOrTeams:"equals current user or user's teams"},n.f)},20542:function(e,t,r){"use strict";r.d(t,"d",(function(){return d})),r.d(t,"c",(function(){return m})),r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return v})),r.d(t,"e",(function(){return g}));var n=r(11766),o=r(20526),i=r(20518),a=r(20525),c=r(20520),s=r(20502);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){return!!t&&((Object(o.c)(t)||Object(o.d)(t))&&Object(o.b)(t,"SystemUser")||Object(o.e)(t)&&!!e&&"systemuser"===e.name.toLowerCase())}function p(e,t){return!!t&&(Object(o.c)(t)&&Object(o.b)(t,"BusinessUnit")||Object(o.e)(t)&&!!e&&"businessunit"===e.name.toLowerCase())}function f(e,t,r){return!!t&&!!e&&e.primaryIdField.toLowerCase()===t.name.toLowerCase()&&Object(o.e)(t)&&!!r&&!!r.isHierarchical}function d(e){return[{name:"eq",displayName:e.equals,fetchXmlToExpression:O,xmlName:"in",expressionToFetchXml:w,preserveOldValue:E},{name:"ne",displayName:e.doesNotEqual,fetchXmlToExpression:O,xmlName:"not-in",expressionToFetchXml:w,preserveOldValue:E}]}function m(e){return[{name:"eq-userid",displayName:e.isCurrentUser,valueComponent:null,isApplicable:u},{name:"ne-userid",displayName:e.notCurrentUser,valueComponent:null,isApplicable:u},{name:"eq-businessid",displayName:e.isCurrentBusinessUnit,valueComponent:null,isApplicable:p},{name:"ne-businessid",displayName:e.notCurrentBusinessUnit,valueComponent:null,isApplicable:p}]}var b=e=>t=>n.createElement(a.a,l({},t,{labels:e,singleSelect:!0}));function y(e){return[{name:"under",displayName:e.under,isApplicable:f,valueComponent:b(e),fetchXmlToExpression:O,expressionToFetchXml:w,preserveOldValue:C},{name:"not-under",displayName:e.notUnder,isApplicable:f,valueComponent:b(e),fetchXmlToExpression:O,expressionToFetchXml:w,preserveOldValue:C},{name:"above",displayName:e.above,isApplicable:f,valueComponent:b(e),fetchXmlToExpression:O,expressionToFetchXml:w,preserveOldValue:C},{name:"eq-or-above",displayName:e.aboveOrEqual,isApplicable:f,valueComponent:b(e),fetchXmlToExpression:O,expressionToFetchXml:w,preserveOldValue:C},{name:"eq-or-under",displayName:e.underOrEqual,isApplicable:f,valueComponent:b(e),fetchXmlToExpression:O,expressionToFetchXml:w,preserveOldValue:C}]}function v(e){return[{name:"like",displayName:e.contains,valueFormat:"%{0}%",valueComponent:t=>n.createElement(c.a,l({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:i.t,conditionFetchXmlPostProcessing:i.k},{name:"not-like",displayName:e.doesNotContain,valueFormat:"%{0}%",valueComponent:t=>n.createElement(c.a,l({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:i.t,conditionFetchXmlPostProcessing:i.k},{name:"begins-with",displayName:e.beginsWith,xmlName:"like",valueFormat:"{0}%",valueComponent:t=>n.createElement(c.a,l({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:i.t,conditionFetchXmlPostProcessing:i.k},{name:"does-not-begins-with",displayName:e.doesNotBeginWith,xmlName:"not-like",valueFormat:"{0}%",valueComponent:t=>n.createElement(c.a,l({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:i.t,conditionFetchXmlPostProcessing:i.k},{name:"ends-with",displayName:e.endsWith,xmlName:"like",valueFormat:"%{0}",valueComponent:t=>n.createElement(c.a,l({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:i.t,conditionFetchXmlPostProcessing:i.k},{name:"does-not-ends-with",displayName:e.doesNotEndWith,xmlName:"not-like",valueFormat:"%{0}",valueComponent:t=>n.createElement(c.a,l({},t,{ariaLabel:e.inputControlLabel})),preserveOldValue:i.t,conditionFetchXmlPostProcessing:i.k}]}function h(e,t){return t&&Object(o.d)(t)||!1}function g(e){return[{name:"eq-useroruserhierarchy",displayName:e.isCurrentUserOrReportingHierarchy,valueComponent:null,isApplicable:h},{name:"eq-useroruserhierarchyandteams",displayName:e.isCurrentUserAndTeamsOrReportingHierarchyAndTeams,valueComponent:null,isApplicable:h},{name:"eq-userteams",displayName:e.isCurrentUserTeams,valueComponent:null,isApplicable:h},{name:"eq-useroruserteams",displayName:e.isCurrentUserOrTeams,valueComponent:null,isApplicable:h}]}function O(e,t,r){if(e.attributes.value)return r.create(Object(i.p)(e.attributes.operator),[{displayName:e.attributes.uiname,entityLogicalName:e.attributes.uitype,id:S(e.attributes.value)}],t);var n=(e.elements||[]).map(e=>{var t=e.elements||[{text:""}];return{displayName:e.attributes&&e.attributes.uiname||"",entityLogicalName:e.attributes&&e.attributes.uitype||"",id:t[0]&&t[0].text&&S(t[0].text.toString())}}).filter(e=>"string"==typeof e.displayName&&"string"==typeof e.entityLogicalName&&"string"==typeof e.id);return r.create(Object(i.p)(e.attributes.operator),n,t)}function w(e){var t=e.state.dataType.state.value;return t.length<2?{name:"condition",type:"element",attributes:{attribute:e.state.field.state.selectedFieldName||"",operator:Object(i.q)(e.state.dataType.state.operatorName,!1),value:"{".concat(t[0].id,"}"),uiname:!t[0].unmatchedRecord&&Object(s.c)(t[0].displayName)||void 0,uitype:t[0].entityLogicalName||void 0}}:{name:"condition",type:"element",attributes:{attribute:e.state.field.state.selectedFieldName||"",operator:Object(i.q)(e.state.dataType.state.operatorName,!0)},elements:t.map(e=>({name:"value",type:"element",attributes:{uiname:!e.unmatchedRecord&&Object(s.c)(e.displayName)||void 0,uitype:e.entityLogicalName||void 0},elements:[{type:"text",text:"{".concat(e.id,"}")}]}))}}function E(e,t){return!!t&&["eq","ne"].indexOf(t.name)>=0}function C(e,t){return!!t&&["under","not-under","above","eq-or-above","eq-or-under"].indexOf(t.name)>=0}function S(e){return e.startsWith("{")&&e.endsWith("}")?e.slice(1,-1):e}},20543:function(e,t,r){"use strict";var n=r(20518);r(20519),r(20526),r(20520),r(11766),r(20531);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i(i(i(i(i({},n.b),n.g),n.h),n.d),{},{in:"In",notIn:"Not In",noValue:"Provide a text for the condition",maxLength:"Input text has more characters than the maximum allowed for this field ({0})"})},20544:function(e,t,r){"use strict";r(20528);var n=r(20518);r(20526),r(11766),r(20531);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i(i(i(i(i(i({},n.a),n.h),n.e),n.d),n.j),{},{incorrectDataType:"Provided value should be a whole number",durationUnit:"minutes"})},20545:function(e,t){},20546:function(e,t){},20547:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.OneToMany="OneToManyRelationship",e.ManyToOne="ManyToOneRelationship",e.ManyToMany="ManyToManyRelationship",e}({})},20548:function(e,t,r){},20549:function(e,t,r){"use strict";r(20550),r(20500),r(20502),r(20547),r(20558),r(20565),r(20579),r(20580),r(20568),r(20581)},20558:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(20559),o=r(20561),i=r(20562),a=r(20512),c=r(20563);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.labels=t,this.rowTemplates=void 0,this.groupTemplates=void 0,this.loadingRowTemplate=void 0;var r={displayName:"dummy",metadataId:"dummy",name:"dummy",primaryIdField:"dummy",primaryNameField:"dummy"},s=new c.a;this.rowTemplates=[s],this.groupTemplates=[new n.a("and",t.andGroup,r),new n.a("or",t.orGroup,r),new o.a,new a.a("and","And",r)],this.loadingRowTemplate=new i.a}var t,r,l;return t=e,(r=[{key:"defaultRow",value:function(){return this.rowTemplates[0]}},{key:"defaultGroup",value:function(){return this.groupTemplates[0]}},{key:"group",get:function(){return{and:this.groupTemplates[0],or:this.groupTemplates[1],related:this.groupTemplates[2],root:this.groupTemplates[3]}}},{key:"row",get:function(){return this.rowTemplates[0]}}])&&s(t.prototype,r),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20559:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return d}));var n=r(20500),o=r(20513),i=r(20514),a=r(20560);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e){return Object(n.h)(e)&&e.template instanceof d}var d=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.displayName=r,this.defaultEntityContext=n,this.customizations=o,this.key=void 0,this.label=void 0,this.key=t,this.label={name:r}}var t,r,c;return t=e,(r=[{key:"create",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return s(s({},this.defaultExpression()),{},{state:e,subexpressions:r})}},{key:"defaultExpression",value:function(){return{template:this,subexpressions:[],state:new a.a(this.defaultEntityContext,void 0)}}},{key:"addedGroup",value:function(e,t){var r=e,o=Object(n.a)(r.defaultGroup(),this.addedRow(r,t)),{state:i}=t;return i?s(s({},o),{},{state:o.state.withNewContext(i.entityContext)}):o}},{key:"addedRow",value:function(e,t){var r=e,{state:n}=t;return n?r.row.create(r.row.fieldTemplate.create(n.entityContext,""),r.row.defaultDataType.defaultExpression(),n.relationshipContext):r.defaultRow().defaultExpression(new o.a(this.defaultEntityContext))}},{key:"prettyString",value:function(e){return this.label.name+" ("+e.subexpressions.map(e=>(Object(n.h)(e),e.template.prettyString(e))).join(", ")+")"}},{key:"canDeleteExpression",value:function(e,t){return 1!==e||t.subexpressions.length>1}},{key:"applicableType",value:function(e){return i.b.boolean.accepts(e)}}])&&u(t.prototype,r),c&&u(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20560:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i}));var i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityContext=t,this.relationshipContext=r}var t,r,o;return t=e,(r=[{key:"withNewContext",value:function(t){return new e(t,this.relationshipContext)}},{key:"withNewRelationshipContext",value:function(t){return new e(this.entityContext,t)}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20561:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(15028),o=r(11766),i=r(20500);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=u(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key="related",this.label={name:"Add related entity",iconProps:{iconName:"LookupEntities"}},this.renderHeader=e=>{var{state:t}=e.expression;return t?o.createElement(n.a,{value:t.entityName,disabled:!0}):(console.error("DummyRelatedEntityTemplateExpression missing state"),e.renderGroupTemplateSelector())}}var t,r,a;return t=e,(r=[{key:"create",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return c(c({},Object(i.a)(this,...r)),{},{state:e})}},{key:"applicableType",value:function(){return!0}},{key:"prettyString",value:function(e){return"".concat(e.state&&e.state.entityName," ")+"("+e.subexpressions.map(e=>(Object(i.h)(e),e.template.prettyString(e))).join(", ")+")"}}])&&l(t.prototype,r),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20562:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11766);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key="loading",this.label={name:"Loading"},this.customizations={hideRowContextMenu:!0,hideRowSelectorCheckbox:!0}}var t,r,i;return t=e,(r=[{key:"create",value:function(e){return{template:this,state:e}}},{key:"applicableType",value:function(){return!0}},{key:"prettyString",value:function(e){return e.state}},{key:"defaultExpression",value:function(){return this.create("")}},{key:"render",value:function(e){return n.createElement("div",{style:{marginRight:"16px"}},n.createElement("label",null,e.expression.state))}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20563:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(11766),o=r(20503),i=r(15028),a=r(20564);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key="conditionExpression",this.label={name:"Condition Expression"}}var t,r,s;return t=e,(r=[{key:"create",value:function(e,t,r){return{template:this,state:new a.a(e,t,r)}}},{key:"applicableType",value:function(e){return!0}},{key:"prettyString",value:function(e){return"".concat(e.state.field," ").concat(e.state.condition," ").concat(e.state.value)}},{key:"defaultExpression",value:function(e){return{template:this,state:new a.a("field","condition","value")}}},{key:"render",value:function(e){var t=e.expression.state;return n.createElement(o.Line,null,n.createElement("div",{style:{marginRight:"10px"}},n.createElement(i.a,{value:t.field,disabled:!0})),n.createElement("div",{style:{marginRight:"10px"}},n.createElement(i.a,{value:t.condition,disabled:!0})),n.createElement("div",null,n.createElement(i.a,{value:t.value,disabled:!0})))}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20564:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return a}));var a=o((function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.condition=r,this.value=n}))},20565:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(20566),o=r(20559),i=r(20567),a=r(20512),c=r(20570),s=r(20572),l=r(20574),u=r(20577),p=r(20562);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=function(){function e(t,r){var f=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],m=arguments.length>3&&void 0!==arguments[3]&&arguments[3];b(this,e),this.environment=t,this.rowTemplates=void 0,this.groupTemplates=void 0,this.linkEntitiesNestingLimit=void 0,this.loadingRowTemplate=void 0,this.aliasManager=void 0,this.labels=void 0,this.linkEntitiesConditions=void 0,this.invalidFieldRowTemplate=void 0,this.labels=r,this.linkEntitiesNestingLimit=t.linkEntitiesNestingLimit,this.aliasManager=new n.a,this.linkEntitiesConditions=[];var y=t.dataTypes.reduce((e,r)=>d(d({},e),{},{[r.name]:new s.a(r,t.resolvers,t.isReadonly?{isReadonly:!0}:void 0)}),{}),v=new l.a(t.rootEntity,y,t.resolvers,t.isReadonly?{isReadonly:!0}:void 0),h=new c.a(v,y,t.dataTypes[0].name,t.isReadonly?{isReadonly:!0}:void 0,!!t.isRTL&&t.isRTL);this.invalidFieldRowTemplate=new u.a(r.invalidField,t.isReadonly?{isReadonly:!0}:void 0),this.rowTemplates=[h],this.groupTemplates=[new o.a("and",this.labels.andGroup,t.rootEntity,t.isReadonly?{isReadonly:!0}:void 0),new o.a("or",this.labels.orGroup,t.rootEntity,t.isReadonly?{isReadonly:!0}:void 0),new i.a(t.rootEntity,t.resolvers,this.labels,f,t.linkEntitiesNestingLimit,t.isReadonly?{isReadonly:!0}:void 0,m,t.relationshipTypesToRender),new a.a("and","And",t.rootEntity,t.isReadonly?{isReadonly:!0}:void 0)],this.loadingRowTemplate=new p.a}var t,r,f;return t=e,(r=[{key:"defaultRow",value:function(){return this.rowTemplates[0]}},{key:"defaultGroup",value:function(){return this.groupTemplates[0]}},{key:"group",get:function(){return{and:this.groupTemplates[0],or:this.groupTemplates[1],related:this.groupTemplates[2],root:this.groupTemplates[3]}}},{key:"row",get:function(){return this.rowTemplates[0]}},{key:"invalidFieldRow",get:function(){return this.invalidFieldRowTemplate}}])&&y(t.prototype,r),f&&y(t,f),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20566:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i}));var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.aliasesCount=0,this.entityNameAliases=new Set}var t,r,o;return t=e,(r=[{key:"registerUsedAlias",value:function(t){e.usedAliases.has(t)||e.usedAliases.add(t)}},{key:"addEntityNameAlias",value:function(e){this.entityNameAliases.has(e)||this.entityNameAliases.add(e)}},{key:"hasEntityNameAlias",value:function(e){return!!e&&this.entityNameAliases.has(e)}},{key:"nextUniqueAlias",value:function(){for(var t;!t||e.usedAliases.has(t);){if("zz"===t)return t;var r=String.fromCharCode("a".charCodeAt(0)+this.aliasesCount/25),n=String.fromCharCode("a".charCodeAt(0)+this.aliasesCount%25);this.aliasesCount++,t=r.concat(n)}return this.registerUsedAlias(t),t}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();i.usedAliases=new Set},20567:function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return g}));var n=r(11766),o=r(20500),i=r(20502),a=r(20547),c=r(20513),s=r(20559),l=r(20512),u=r(20568),p=r(20569);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e){return Object(o.h)(e)&&e.template instanceof g}var g=function(){function e(t,r,i,a,c,f){var m=arguments.length>6&&void 0!==arguments[6]&&arguments[6],y=arguments.length>7?arguments[7]:void 0;b(this,e),this.defaultEntityContext=t,this.resolver=r,this.labels=i,this.nestingLimit=c,this.enableAnyLinkType=m,this.relationshipTypesToRender=y,this.key="related",this.groupRelationships=void 0,this.label=void 0,this.customizations=void 0,this.distinctTemplate=void 0,this.renderHeader=e=>{var{state:t}=e.expression;if(!t)return console.error("RelatedEntityTemplateExpression missing state"),e.renderGroupTemplateSelector();var r=e.metadata;return n.createElement(p.a,{key:e.expression.flatIndex,disabled:!(!this.customizations||!this.customizations.isReadonly),enableAnyLinkType:this.enableAnyLinkType,relationshipTypesToRender:this.relationshipTypesToRender,filterTypeName:this.enableAnyLinkType?t.filterType:"and",parentExpression:e.expression.parent&&e.expression.parent(),labels:this.labels,ariaLabel:r.labels.fieldSelectorControlLabel,entityContext:t.entityContext,resolver:this.resolver,selectedEntity:t.relatedEntity,selectedContainsData:t.containsData,selectedRelationship:t.relationshipContext,groupRelationships:this.groupRelationships,canSelectManyToMany:!this.nestingLimit||this.nestingLimit-t.nestingLevel>1,onEntitySelected:n=>{if(null===n){var o=t.withBlankRelatedEntity(),i=d(d({},e.expression),{},{state:o,subexpressions:[]});i.subexpressions.push(this.addedRow(r,i)),e.onChange(i)}else{var[a,c]=n,s=this._findNestingLevel(t,c),l=t.withNewRelatedEntity(a).withNewRelationshipContext(c).withNewNestingLevel(s),u=d(d({},e.expression),{},{state:l,subexpressions:[]});u.subexpressions.push(this.addedRow(r,u)),e.onChange(u)}},onContainsDataSelected:n=>{var o=t.withContainsData(n),i=d(d({},e.expression),{},{state:o,subexpressions:this.enableAnyLinkType?e.expression.subexpressions:[]});this.enableAnyLinkType||(n?i.subexpressions.push(this.addedRow(r,i)):i.subexpressions.push(e.metadata.loadingRowTemplate.create(this.labels.doesNotContainDataWarning))),e.onChange(i)},onFilterTypeChange:r=>{var n=t.withFilterType(r),o=d(d({},e.expression),{},{state:n});e.onChange(o)}})},this.customizations=d(d({},f),{},{hideUngrouping:!0}),this.groupRelationships=a,this.labels=i,this.label={name:this.labels.addRelatedEntity,iconProps:{iconName:"LookupEntities"}},this.distinctTemplate={onAdd:(e,t)=>d(d({},Object(o.a)(this,e.loadingRowTemplate.create(this.labels.relatedEntityPlaceholder))),{},{state:new u.a(t.state&&t.state.relatedEntity||this.defaultEntityContext,void 0).withNewNestingLevel(t.state&&t.state.relatedEntity?t.state.nestingLevel:0)}),canBeAdded:t=>t.template instanceof l.a||m&&t.template instanceof s.a||t.template instanceof e&&(null==this.nestingLimit||!!(t.state&&t.state.nestingLevel<this.nestingLimit)),canMakeGroup:()=>m}}var t,r,f;return t=e,(r=[{key:"createWarning",value:function(e,t,r){var n=[t.loadingRowTemplate.create(Object(i.e)(this.labels.missingRelationshipWarning,e))];return d(d({},Object(o.a)(this,...n)),{},{state:r})}},{key:"create",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return!t||t.containsData||this.enableAnyLinkType||(n=[e.loadingRowTemplate.create(this.labels.doesNotContainDataWarning)]),d(d({},Object(o.a)(this,...n)),{},{state:t})}},{key:"expected",value:function(e){return new c.a(e.state&&e.state.relatedEntity||this.defaultEntityContext)}},{key:"canDeleteExpression",value:function(e,t){return 1!==e||t.subexpressions.length>1}},{key:"applicableType",value:function(){return!0}},{key:"addedGroup",value:function(e,t){var r=Object(o.a)(e.defaultGroup(),this.addedRow(e,t)),{state:n}=t;return n&&n.relatedEntity?d(d({},r),{},{state:r.state.withNewContext(n.relatedEntity).withNewRelationshipContext(n.relationshipContext)}):r}},{key:"addedRow",value:function(e,t){var{state:r}=t;if(!r||!r.relatedEntity)return e.defaultRow().defaultExpression(new c.a(this.defaultEntityContext));var n=e;return n.row.create(n.row.fieldTemplate.create(r.relatedEntity,""),n.row.defaultDataType.defaultExpression(),r.relationshipContext)}},{key:"canAddGroup",value:function(e,t){return!!t.state&&!!t.state.relatedEntity&&(t.state.containsData||this.enableAnyLinkType)}},{key:"canAddRow",value:function(e,t){return!!t.state&&!!t.state.relatedEntity&&(t.state.containsData||this.enableAnyLinkType)}},{key:"prettyString",value:function(e){return"".concat(e.state&&e.state.relatedEntity&&e.state.relatedEntity.displayName||"..."," ")+"("+e.subexpressions.map(e=>(Object(o.h)(e),e.template.prettyString(e))).join(", ")+")"}},{key:"_findNestingLevel",value:function(e,t){return e.relationshipContext&&e.relationshipContext.relationshipType===a.a.ManyToMany?t.relationshipType===a.a.ManyToMany?e.nestingLevel:e.nestingLevel-1:e.relationshipContext&&e.relationshipContext.relationshipType!==a.a.ManyToMany?t.relationshipType===a.a.ManyToMany?e.nestingLevel+1:e.nestingLevel:t.relationshipType===a.a.ManyToMany?e.nestingLevel+2:e.nestingLevel+1}}])&&y(t.prototype,r),f&&y(t,f),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20568:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return a}));var a=function(){function e(t,r,o){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"and";n(this,e),this.entityContext=t,this.relatedEntity=r,this.relationshipContext=o,this.containsData=i,this.nestingLevel=a,this.filterType=c}var t,r,i;return t=e,(r=[{key:"withNewContext",value:function(t){return new e(t,void 0)}},{key:"withBlankRelatedEntity",value:function(){return new e(this.entityContext,void 0)}},{key:"withNewRelatedEntity",value:function(t){return new e(this.entityContext,t)}},{key:"withNewRelationshipContext",value:function(t){return new e(this.entityContext,this.relatedEntity,t)}},{key:"withContainsData",value:function(t){return new e(this.entityContext,this.relatedEntity,this.relationshipContext,t,void 0,this.filterType)}},{key:"withNewNestingLevel",value:function(t){return new e(this.entityContext,this.relatedEntity,this.relationshipContext,this.containsData,t)}},{key:"withFilterType",value:function(t){return new e(this.entityContext,this.relatedEntity,this.relationshipContext,this.containsData,this.nestingLevel,t)}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20569:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(12754),o=r(13275),i=r(12811),a=r(15697),c=r(15700),s=r(20503),l=r(20524),u=r(20547),p=r(20567),f=r(11766),d=r.n(f);function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=Object(n.eb)({minWidth:"180px"}),w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(b,e);var t,r,n,f=v(b);function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(t=f.call(this,e)).onChange=(e,r)=>{r&&(t.setState({showValidationError:!1}),t.props.onEntitySelected(r.data))},t.onBlur=()=>{var{selectedEntity:e,selectedRelationship:r}=t.props;e&&r||t.setState({showValidationError:!0})},t.onChangeData=(e,r)=>{r&&t.props.onContainsDataSelected(r.data)},t.onFilterTypeChange=(e,r)=>{r&&t.props.onFilterTypeChange&&t.props.onFilterTypeChange(r.key)},t.state={entityRelationships:void 0,showValidationError:!1},t}return t=b,(r=[{key:"componentDidMount",value:function(){void 0===this.state.entityRelationships&&this.props.resolver.resolveRelatedEntities(this.props.entityContext).then(e=>this.setState({entityRelationships:e}))}},{key:"componentWillUnmount",value:function(){this.setState({entityRelationships:void 0,showValidationError:!1})}},{key:"shouldShowValidationError",value:function(){var{selectedEntity:e,selectedRelationship:t}=this.props,{showValidationError:r}=this.state;return r&&(!e||!t)}},{key:"render",value:function(){var e,t,{labels:r,selectedEntity:n,selectedContainsData:c,selectedRelationship:u,parentExpression:p,disabled:f,canSelectManyToMany:m,groupRelationships:b,relationshipTypesToRender:y}=this.props,v=this.makeOptions(this.state.entityRelationships,p,r,m,b,n,u,y),h=this.makeDataOptions(),g=S(n,u),w=this.shouldShowValidationError();return d.a.createElement(o.a,{style:{alignItems:"start"}},d.a.createElement(s.Line,null,d.a.createElement(l.a,{styles:{callout:{minWidth:"80px"}},dropdownWidth:"auto",disabled:v.length<=0||f,isLoading:void 0===this.state.entityRelationships,selectedKey:g,options:v,onChange:this.onChange,className:Object(i.a)("eb-RelatedEntitySelector",O),ariaLabel:this.props.ariaLabel,title:null!==(e=null===(t=v.find(e=>e.key===g))||void 0===t?void 0:t.text)&&void 0!==e?e:this.props.ariaLabel,required:!0,errorMessage:w?r.relatedEntityPlaceholder:void 0,onBlur:this.onBlur}),d.a.createElement(a.a,{ariaLabel:r.operatorSelectorControlLabel,disabled:""===g||v.length<=0||f,styles:{dropdown:{minWidth:"80px",marginLeft:"8px",marginRight:"8px"}},dropdownWidth:"auto",selectedKey:c?"not-null":"null",options:h,defaultSelectedKey:"not-null",onChange:this.onChangeData})),d.a.createElement(a.a,{ariaLabel:this.props.enableAnyLinkType&&"or"===this.props.filterTypeName?r.orGroup:r.andGroup,disabled:!this.props.enableAnyLinkType,selectedKey:this.props.enableAnyLinkType?this.props.filterTypeName:"and",options:this.props.enableAnyLinkType?[{key:"and",text:r.andGroup},{key:"or",text:r.orGroup}]:[{key:"and",text:r.andGroup}],styles:{root:{marginTop:"8px",maxWidth:"80px"}},onChange:this.onFilterTypeChange}))}},{key:"makeOptions",value:function(e,t,r,n,o,i,a,s){if(e){var l=t&&t.subexpressions.filter(e=>Object(p.b)(e));e=e.filter(e=>{var[t,r]=e;return!l||!l.some(e=>{var n=e.state;return C([t,r],[n.relatedEntity,n.relationshipContext])})||i&&a&&C([t,r],[i,a])}),s||(s={ManyToManyRelationship:!0,OneToManyRelationship:!0,ManyToOneRelationship:!0});var f=[];if(o){if(s[u.a.ManyToOne]){var d={key:"n1rel",text:r.manyToOne,itemType:c.a.Header},m={key:"emptyN1",text:r.noRelationships,disabled:!0},b=E(e,u.a.ManyToOne,d,m,!1);f=f.concat(b)}if(s[u.a.OneToMany]){var y={key:"1nrel",text:r.oneToMany,itemType:c.a.Header},v={key:"empty1n",text:r.noRelationships,disabled:!0},h=E(e,u.a.OneToMany,y,v,!1);f=f.concat(h)}if(s[u.a.ManyToMany]){var g,O={key:"nnrel",text:r.manyToMany,itemType:c.a.Header},w={key:"emptyNn",text:r.noRelationships,disabled:!0};g=E(e,u.a.ManyToMany,O,w,!n),f=f.concat(g)}return f}return e.map(e=>{var[t,r]=e;return{key:S(t,r),text:"".concat(r.displayName," (").concat(t.displayName,")"),data:[t,r]}})}return[]}},{key:"makeDataOptions",value:function(){return[{key:"not-null",text:this.props.labels.containsData,data:!0},{key:"null",text:this.props.labels.doesNotContainData,data:!1}]}}])&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),b}(d.a.PureComponent);function E(e,t,r,n,o){var i=e.filter(e=>{var[r,n]=e;return n.relationshipType===t}).map(e=>{var[t,r]=e;return{key:S(t,r),text:P([t,r]),data:[t,r],disabled:o}});return 0===i.length&&i.push(n),[r,...i]}function C(e,t){if(!(e[0]&&e[1]&&t[0]&&t[1]))return!1;var r=e[0],n=e[1],o=t[0],i=t[1];return!(r.metadataId!==o.metadataId||r.name!==o.name||n.displayName!==i.displayName||n.referencedFieldName!==i.referencedFieldName||n.relationshipType!==i.relationshipType||n.referencingFieldName!==i.referencingFieldName)}function S(e,t){return e&&t?"".concat(e.name,"_").concat(t.displayName,"_").concat(t.referencedFieldName,"_").concat(t.referencingFieldName,"_").concat(t.isHierarchical,"_").concat(t.relationshipType):""}function P(e){var t=e[0],r=e[1];return r.relationshipType===u.a.OneToMany?"".concat(t.displayName," (").concat(r.displayName,")"):r.relationshipType===u.a.ManyToOne?"".concat(r.displayName," (").concat(t.displayName,")"):r.displayName}},20570:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"a",(function(){return y}));var n=r(11766),o=r(20500),i=r(20501),a=r(20571),c=r(20503),s=r(20505);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e){return Object(o.i)(e)&&e.template instanceof y}var y=function(){function e(t,r,n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fieldTemplate=t,this.dataTypeTemplateMap=r,this.defaultDataTypeName=n,this.customizations=o,this.isRTL=i,this.key="conditionExpression",this.label={name:"Condition Expression"}}var t,r,o;return t=e,(r=[{key:"defaultDataType",get:function(){return this.dataTypeTemplateMap[this.defaultDataTypeName]}},{key:"create",value:function(e,t,r){return{template:this,state:new a.a(e,t,r)}}},{key:"applicableType",value:function(e){return!0}},{key:"prettyString",value:function(e){var t=Object(i.f)(e.state.field),r=Object(i.f)(e.state.dataType);return"".concat(t," ").concat(r)}},{key:"defaultExpression",value:function(e){return{template:this,state:new a.a(this.fieldTemplate.defaultExpression(e),this.dataTypeTemplateMap[this.defaultDataTypeName].defaultExpression(),void 0)}}},{key:"render",value:function(e){var t,r=e.expression.state,o={ariaDescribedBy:e.ariaDescribedBy,canMakeGroup:e.canMakeGroup,metadata:e.metadata,resources:e.resources,customizations:e.customizations},i={};return null!==(t=e.customizations)&&void 0!==t&&t.enableDockModeView&&(i={flexWrap:"wrap",gap:"8px"}),n.createElement(c.Line,{style:i},n.createElement(s.a,l({},o,{expression:e.expression.state.field,onChange:t=>e.onChange(p(p({},e.expression),{},{state:this.newFieldState(e.expression,t)})),isRTL:!!this.isRTL&&this.isRTL})),n.createElement(s.a,l({},o,{expression:e.expression.state.dataType,onChange:t=>e.onChange(p(p({},e.expression),{},{state:r.withDataType(t)})),isRTL:!!this.isRTL&&this.isRTL})))}},{key:"newFieldState",value:function(e,t){var r=e.state,n=r.withField(t);if(t.state.selectedField){var o=this.dataTypeTemplateMap[t.state.selectedField.dataType];if(o){if(t.state.selectedField.name===r.field.state.selectedFieldName&&void 0===r.field.state.selectedField)return n.withDataType(p(p({},r.dataType),{},{state:r.dataType.state.withNewContext({entity:r.entityContext,field:t.state.selectedField,owningRelationship:r.relationshipContext})}));var i=o.defaultExpression(void 0,{entity:r.entityContext,field:t.state.selectedField},null);return n.withDataType(p(p({},i),{},{state:i.state.withNewContext({entity:r.entityContext,field:t.state.selectedField,owningRelationship:r.relationshipContext})}))}throw new Error("Could not find matching data type for field with type "+t.state.selectedField.dataType)}return n.withDataType(this.dataTypeTemplateMap[this.defaultDataTypeName].defaultExpression())}},{key:"errors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.state.dataType.template.errors(e.state.dataType,t)}}])&&d(t.prototype,r),o&&d(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20571:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=c(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return s}));var s=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.dataType=r,this.relationshipContext=n}var t,r,n;return t=e,(r=[{key:"entityContext",get:function(){return this.field.state.entityContext}},{key:"withNewContext",value:function(e){return this.withField(o(o({},this.field),{},{state:this.field.state.withNewContext(e)}))}},{key:"withNewRelationshipContext",value:function(t){return new e(this.field,this.dataType,t)}},{key:"withField",value:function(t){return new e(t,this.dataType,this.relationshipContext)}},{key:"withDataType",value:function(t){return new e(this.field,t,this.relationshipContext)}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20572:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(11766),o=r(15871),i=r(20503),a=r(20514),c=r(20526),s=r(20502),l=r(20573);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataType=t,this.resolver=r,this.customizations=n,this.key=void 0,this.label=void 0,this.key=this.dataType.name,this.label={name:this.dataType.name}}var t,r,u;return t=e,(r=[{key:"create",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.createDataState(e,t,r);if(!n)throw new Error('Invalid value "'.concat(String(t),'" for operator "').concat(e,'" for data type "').concat(this.dataType.name,'"'));return{template:this,state:n}}},{key:"applicableType",value:function(e){return new a.a(this.dataType.name).accepts(e)}},{key:"prettyString",value:function(e){var t=e.state,r=this.dataType.operators.find(t=>t.name===e.state.operatorName),n=r?r.displayName:e.state.operatorName,o=this.getValueComponent(t.operatorName)?t.customPrettyString||t.value:null;return"".concat(n," ").concat(o||"")}},{key:"defaultExpression",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=this.dataType.operators.find(e=>!e.isApplicable||e.isApplicable(t.entity,t.field,t.owningRelationship));if(!n)throw new Error("No applicable operator could be found");return{template:this,state:new l.a(n.name,n.xmlName,Object(s.j)(n.defaultValue,null==r?this.dataType.defaultValue:r),this.getValueFormat(n),{})}}},{key:"render",value:function(e){var t,r,a=e.expression.state,c=e.expression.template.customizations,l=a.operatorName,u=this.makeOperatorOptions(a.context),f=a.value,d=this.getValueComponent(l),m=e.customizations&&e.customizations.enableDockModeView?{display:"flex",flexWrap:"wrap",rowGap:"8px",columnGap:"8px"}:{};return n.createElement(i.Line,{className:"DataTypeTemplate",style:m},n.createElement(o.a,{disabled:c&&c.isReadonly,ariaDescribedBy:e.ariaDescribedBy,ariaLabel:e.resources.operatorSelectorControlLabel,className:"DataTypeTemplate-Operator",dropdownWidth:"auto",styles:{container:{flexShrink:0,minWidth:"15%",marginLeft:null!==(t=e.customizations)&&void 0!==t&&t.enableDockModeView?"0px":"8px",marginRight:null!==(r=e.customizations)&&void 0!==r&&r.enableDockModeView?"0px":"8px"}},options:u,selectedKey:l,onChange:(t,r)=>{if(r){var n=this.dataType.operators.find(e=>e.name===l),o=this.dataType.operators.find(e=>e.name===r.key);if(!o)return void console.error("Could not find operator with name "+r.key);var i=a.withNewOperator(r.key,o.xmlName,this.getValueFormat(o));o.preserveOldValue&&o.preserveOldValue(i.value,n)||(i=i.withNewValue(Object(s.j)(o.defaultValue,this.dataType.defaultValue))),e.onChange(p(p({},e.expression),{},{state:i}))}}}),n.createElement("div",{className:"DataTypeTemplate-Value",style:{minWidth:d?"140px":void 0}},null!==d&&n.createElement(d,{ariaDescribedBy:e.ariaDescribedBy,disabled:c&&c.isReadonly,value:f,resolver:this.resolver,entityContext:a.context.entity,fieldContext:a.context.field,onChange:(t,r)=>e.onChange(p(p({},e.expression),{},{state:a.withNewValue(t).withNewCustomPrettyString(r).withNewHasBeenModified(!0)})),"aria-required":!0})))}},{key:"getValueComponent",value:function(e){var t=this.dataType.operators.find(t=>t.name===e).valueComponent;return void 0!==t?t:this.dataType.defaultValueComponent}},{key:"makeOperatorOptions",value:function(e){return this.dataType.operators.filter(t=>!t.isApplicable||t.isApplicable(e.entity,e.field,e.owningRelationship)).map(e=>({key:e.name,text:e.displayName,data:e}))}},{key:"errors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=e.template;return(e.state.hasBeenModified||t)&&n.dataType.validateInput&&n.getValueComponent(e.state.operatorName)&&r.push(...n.dataType.validateInput(e.state.value,e.state.context.field,e.state.operatorName)),r}},{key:"createDataState",value:function(e,t,r){var n,o,i,a=this.dataType.operators.filter(t=>t.name===e||t.xmlName===e);if("string"!=typeof t||1===a.length&&(null===a[0].valueComponent||void 0===a[0].valueFormat))n=a[0],o=t;else{var s=a.map(r=>{var n="^".concat(this.getValueFormat(r).replace("{0}","(.+)"),"$"),o=t.match(n);if(o){var i=o[1];return"like"!==e&&"not-like"!==e||(i=(i=i.replace(/%/g,"*")).replace(/\[\*\]/g,"%")),i}});if(void 0===(o=s.reduce((e,t)=>e||t)))return;n=a[s.indexOf(o)]}return o&&r.field&&r.field.dataType===c.a.Lookup&&"string"!=typeof t&&(i="(".concat(t.map(e=>e.displayName).join(", "),")")),new l.a(n.name,n.xmlName,o,this.getValueFormat(n),r,!1,i)}},{key:"getValueFormat",value:function(e){if(void 0!==e){if(void 0!==e.valueFormat)return e.valueFormat;if(null===e.valueComponent)return""}return"{0}"}}])&&d(t.prototype,r),u&&d(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20573:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return a}));var a=function(){function e(t,r,o,i,a){var c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6?arguments[6]:void 0;n(this,e),this.operatorName=t,this.xmlName=r,this.value=o,this.format=i,this.context=a,this.hasBeenModified=c,this.customPrettyString=s}var t,r,i;return t=e,(r=[{key:"withNewOperator",value:function(t,r,n){return new e(t,r,this.value,n,this.context,this.hasBeenModified,this.customPrettyString)}},{key:"withNewValue",value:function(t){return new e(this.operatorName,this.xmlName,t,this.format,this.context,this.hasBeenModified,this.customPrettyString)}},{key:"withNewContext",value:function(t){return new e(this.operatorName,this.xmlName,this.value,this.format,t,this.hasBeenModified,this.customPrettyString)}},{key:"withNewHasBeenModified",value:function(t){return new e(this.operatorName,this.xmlName,this.value,this.format,this.context,t,this.customPrettyString)}},{key:"withNewCustomPrettyString",value:function(t){return new e(this.operatorName,this.xmlName,this.value,this.format,this.context,this.hasBeenModified,t)}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20574:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(11766),o=r(20575),i=r(20576),a=r(20513);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultEntityContext=t,this.dataTypeTemplateMap=r,this.resolver=n,this.customizations=o,this.key="field",this.label={name:"Field"}}var t,r,c;return t=e,(r=[{key:"create",value:function(e,t,r){return{template:this,state:new i.a(e,t,r)}}},{key:"applicableType",value:function(e){return!0}},{key:"prettyString",value:function(e){return e.state.selectedField?e.state.selectedField.displayName:e.state.selectedFieldName?e.state.selectedFieldName:"..."}},{key:"defaultExpression",value:function(e){return e&&Object(a.b)(e)?{template:this,state:new i.a(e.context,void 0)}:{template:this,state:new i.a(this.defaultEntityContext,void 0)}}},{key:"render",value:function(e){var t=e.expression.state,r=e.expression.template.customizations;return n.createElement(o.a,{placeHolderLabel:e.resources.fieldPlaceholder,entityContext:t.entityContext,resolver:this.resolver,dataTypeTemplateMap:this.dataTypeTemplateMap,selectedFieldName:t.selectedFieldName,ariaDescribedBy:e.ariaDescribedBy,ariaLabel:e.resources.fieldSelectorControlLabel,selectedField:t.selectedField,onFieldSelected:(r,n)=>e.onChange(s(s({},e.expression),{},{state:t.withNewField(r,n)})),disabled:!(!r||!r.isReadonly)})}}])&&u(t.prototype,r),c&&u(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20575:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(20524),o=r(12754),i=r(12812),a=r(12811),c=r(11766),s=r.n(c);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=Object(o.eb)({minWidth:"180px"}),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(u,e);var t,r,o,c=f(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).onChange=(e,r)=>{r&&t.props.onFieldSelected(r.key,r.data.field)},t.onRenderOption=(e,t)=>{if(!e)return t?t(e):null;var r=e.data;return s.a.createElement("div",{className:"FieldTemplate-FieldSelector-Option"},r&&r.icon&&s.a.createElement(i.a,{style:{display:"inline-block",float:"left",marginTop:"1px",marginRight:"8px"},iconName:r.icon,"aria-hidden":"true",title:r.icon}),s.a.createElement("span",null,e.text))},t.state={fields:void 0,loading:!1,lastLoadedEntity:void 0},t}return t=u,o=[{key:"getDerivedStateFromProps",value:function(e,t){return e.entityContext.name!==t.lastLoadedEntity?{fields:void 0,loading:!1,lastLoadedEntity:e.entityContext.name}:null}}],(r=[{key:"componentDidMount",value:function(){this.loadFields()}},{key:"componentDidUpdate",value:function(){void 0!==this.state.fields||this.state.loading||this.loadFields()}},{key:"componentWillUnmount",value:function(){this.setState({fields:void 0,loading:!1})}},{key:"loadFields",value:function(){this.setState({loading:!0}),this.props.resolver.resolveFields(this.props.entityContext).then(e=>{if(this.props.selectedFieldName&&!this.props.selectedField){var t=e.find(e=>e.name===this.props.selectedFieldName);t&&this.props.onFieldSelected(t.name,t)}return this.setState({fields:e,lastLoadedEntity:this.props.entityContext.name,loading:!1})})}},{key:"makeOptions",value:function(){var{fields:e}=this.state;return e?e.map(e=>{var t;return this.props.dataTypeTemplateMap[e.dataType]&&(t=this.props.dataTypeTemplateMap[e.dataType].dataType.iconName),{key:e.name,text:e.displayName,data:{field:e,icon:t}}}):[]}},{key:"render",value:function(){var e,t,{selectedFieldName:r}=this.props,o=this.makeOptions();return s.a.createElement(n.a,{label:this.props.ariaLabel,className:Object(a.a)("FieldTemplate-FieldSelector",b),dropdownWidth:"auto",options:o,isLoading:o.length<=0,disabled:o.length<=0||this.props.disabled,selectedKey:r||"",onChange:this.onChange,onRenderOption:this.onRenderOption,ariaDescribedBy:this.props.ariaDescribedBy,ariaLabel:this.props.ariaLabel,required:!0,title:null!==(e=null===(t=o.find(e=>e.key===r))||void 0===t?void 0:t.text)&&void 0!==e?e:this.props.ariaLabel})}}])&&l(t.prototype,r),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),u}(s.a.PureComponent)},20576:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i}));var i=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityContext=t,this.selectedFieldName=r,this.selectedField=n}var t,r,o;return t=e,(r=[{key:"withNewContext",value:function(t){return new e(t,void 0)}},{key:"withNewField",value:function(t,r){return new e(this.entityContext,t,r)}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20577:function(e,t,r){"use strict";r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return f}));var n=r(15028),o=r(11766),i=r(20519),a=r(20500),c=r(20503),s=r(20578);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e){return Object(a.i)(e)&&e.template instanceof f}var f=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.invalidFieldLabel=t,this.customizations=r,this.key="conditionExpression",this.label={name:"Condition Expression"}}var t,r,a;return t=e,(r=[{key:"create",value:function(e,t,r){return{template:this,state:new s.a(e,t,r)}}},{key:"applicableType",value:function(e){return!0}},{key:"prettyString",value:function(e){return"".concat(e.state.field," ").concat(e.state.condition," ").concat(e.state.value)}},{key:"defaultExpression",value:function(e){return{template:this,state:new s.a("field","condition","value")}}},{key:"render",value:function(e){var t=e.expression.state;return o.createElement(c.Line,null,o.createElement("div",{style:{marginRight:"10px"}},o.createElement(n.a,{value:t.field,disabled:!0,ariaLabel:t.field})),o.createElement("div",{style:{marginRight:"10px"}},o.createElement(n.a,{value:t.condition,disabled:!0,ariaLabel:t.condition})),o.createElement("div",null,o.createElement(n.a,{value:t.value,disabled:!0,ariaLabel:t.value})))}},{key:"errors",value:function(e){return e.state.condition&&e.state.field&&e.state.value?[i.String.Format(this.invalidFieldLabel,e.state.field)]:[]}}])&&l(t.prototype,r),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20578:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return a}));var a=o((function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.condition=r,this.value=n}))},20579:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return a}));var a=o((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityName=t}))},20580:function(e,t,r){"use strict";r.d(t,"f",(function(){return o})),r.d(t,"h",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"e",(function(){return p}));var n=r(20547),o=f("filter");function i(e){return o(e)&&e.attributes&&e.attributes.isquickfindfields}var a=f("condition");function c(e,t){var r=t[0],o=t[1];if(!(o.relationshipType!==n.a.ManyToMany||e.elements&&u(e.elements[0])))return!1;var i=o.relationshipType===n.a.ManyToMany?o.intersectEntityName:r.name,a=o.relationshipType===n.a.ManyToMany||o.relationshipType===n.a.OneToMany?e.attributes.to:e.attributes.from,c=o.relationshipType===n.a.ManyToMany?e.elements[0].attributes.from:o.relationshipType===n.a.ManyToOne?e.attributes.to:e.attributes.from;return i===e.attributes.name&&o.referencedFieldName===a&&o.referencingFieldName===c}function s(e,t){return t.attributes.name===e.attributes.name&&t.attributes.from===e.attributes.from&&t.attributes.to===e.attributes.to}function l(e){return"".concat(e.attributes.name,":").concat(e.attributes.from,":").concat(e.attributes.to)}var u=f("link-entity"),p=f("fetch","entity","attribute","order","condition");function f(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.some(t=>e.name===t)}}},20581:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return i}));var i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityContext=t,this.originXML=r}var t,r,o;return t=e,(r=[{key:"withNewXML",value:function(t){return new e(this.entityContext,t)}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20582:function(e,t,r){"use strict";r(20519),r(20550),r(20502),r(20547),r(20559),r(20567),r(20512),r(20570),r(20577),r(20580)},20583:function(e,t,r){"use strict";var n=r(11766),o=r(20499),i=r(20513),a=r(20514);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.PureComponent},20584:function(e,t){e.exports=function(){"use strict";function e(t,r,n,o){this.message=t,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,o,i=new Array(e.length);for(t=0;t<e.length;t++)i[t]=(o=e[t],r[o.type](o));if(i.sort(),i.length>0){for(t=1,n=1;t<i.length;t++)i[t-1]!==i[t]&&(i[n]=i[t],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,o={},i={filterExpr:Rn},a=Rn,c=Cn("/",!1),s=function(){return En()},l=Cn("/$count",!1),u=Cn("$filter",!1),p=Cn("filter",!1),f=Cn("$search",!1),d=Cn("search",!1),m=Cn("OR",!1),b=Cn("AND",!1),y=Cn("NOT",!1),v=Cn(".",!1),h=function(e,t,r,n){return function(e,t,r,n){if(r){return da(ma(e,r),n)}return da(e,n)}(e,0,r,n)},g=Cn("$root/",!1),O=Cn("#",!1),w=Cn("$it",!1),E=Cn("$this",!1),C=Cn("any",!1),S=Cn("all",!1),P=Cn("concat",!1),j=Cn("contains",!1),T=Cn("endswith",!1),k=Cn("indexof",!1),R=Cn("length",!1),x=Cn("startswith",!1),N=Cn("substring",!1),_=Cn("tolower",!1),D=Cn("toupper",!1),I=Cn("trim",!1),A=Cn("year",!1),F=Cn("month",!1),L=Cn("day",!1),M=Cn("hour",!1),B=Cn("minute",!1),U=Cn("second",!1),V=Cn("fractionalseconds",!1),z=Cn("totalseconds",!1),G=Cn("date",!1),W=Cn("time",!1),H=Cn("totaloffsetminutes",!1),K=Cn("mindatetime",!1),q=Cn("maxdatetime",!1),Y=Cn("now",!1),X=Cn("round",!1),Q=Cn("floor",!1),Z=Cn("ceiling",!1),J=Cn("geo.distance",!1),$=Cn("geo.length",!1),ee=Cn("geo.intersects",!1),te=Cn("hassubset",!1),re=Cn("hassubsequence",!1),ne=Cn("and",!1),oe=Cn("or",!1),ie=Cn("eq",!1),ae=Cn("ne",!1),ce=Cn("lt",!1),se=Cn("le",!1),le=Cn("gt",!1),ue=Cn("ge",!1),pe=Cn("in",!1),fe=Cn("has",!1),de=Cn("add",!1),me=Cn("sub",!1),be=Cn("mul",!1),ye=Cn("div",!1),ve=Cn("divby",!1),he=Cn("mod",!1),ge=Cn("-",!1),Oe=Cn("not",!1),we=Cn("isof",!1),Ee=Cn("cast",!1),Ce=Cn("{",!1),Se=Cn("%7B",!1),Pe=Cn("}",!1),je=Cn("%7D",!1),Te=Cn("[",!1),ke=Cn("%5B",!1),Re=Cn("]",!1),xe=Cn("%5D",!1),Ne=Cn("%22",!1),_e=Cn("true",!1),De=Cn("false",!1),Ie=Cn("null",!1),Ae=Cn("%2F",!1),Fe=Cn("b",!1),Le=Cn("f",!1),Me=Cn("n",!1),Be=Cn("r",!1),Ue=Cn("t",!1),Ve=Cn("u",!1),ze=Cn(":",!1),Ge=Cn("\\",!1),We=Cn("%5C",!1),He=Cn("0",!1),Ke=Cn("e",!1),qe=Cn("+",!1),Ye=Cn("Collection",!1),Xe=Cn("_",!1),Qe=Cn("Edm.",!1),Ze=Cn("Binary",!1),Je=Cn("Boolean",!1),$e=Cn("Byte",!1),et=Cn("Date",!1),tt=Cn("DateTimeOffset",!1),rt=Cn("Decimal",!1),nt=Cn("Double",!1),ot=Cn("Duration",!1),it=Cn("Guid",!1),at=Cn("Int16",!1),ct=Cn("Int32",!1),st=Cn("Int64",!1),lt=Cn("SByte",!1),ut=Cn("Single",!1),pt=Cn("Stream",!1),ft=Cn("String",!1),dt=Cn("TimeOfDay",!1),mt=Cn("Geography",!1),bt=Cn("Geometry",!1),yt=Cn("LineString",!1),vt=Cn("MultiLineString",!1),ht=Cn("MultiPoint",!1),gt=Cn("MultiPolygon",!1),Ot=Cn("Point",!1),wt=Cn("Polygon",!1),Et=Cn("binary",!1),Ct=Cn("A",!1),St=Cn("E",!1),Pt=Cn("I",!1),jt=Cn("M",!1),Tt=Cn("Q",!1),kt=Cn("U",!1),Rt=Cn("Y",!1),xt=Cn("c",!1),Nt=Cn("g",!1),_t=Cn("k",!1),Dt=Cn("o",!1),It=Cn("s",!1),At=Cn("w",!1),Ft=Cn("4",!1),Lt=Cn("8",!1),Mt=Cn("=",!1),Bt=Cn("==",!1),Ut=Cn("NaN",!1),Vt=Cn("-INF",!1),zt=Cn("INF",!1),Gt=Cn("T",!1),Wt=Cn("Z",!1),Ht=Cn("duration",!1),Kt=Cn("P",!1),qt=Cn("D",!1),Yt=Cn("H",!1),Xt=Cn("S",!1),Qt=/^[1-9]/,Zt=Sn([["1","9"]],!1,!1),Jt=/^[0-5]/,$t=Sn([["0","5"]],!1,!1),er=Cn("1",!1),tr=/^[0-2]/,rr=Sn([["0","2"]],!1,!1),nr=/^[1-2]/,or=Sn([["1","2"]],!1,!1),ir=Cn("3",!1),ar=/^[0-1]/,cr=Sn([["0","1"]],!1,!1),sr=Cn("2",!1),lr=/^[0-3]/,ur=Sn([["0","3"]],!1,!1),pr=Cn("Collection(",!1),fr=Cn("MultiLineString(",!1),dr=Cn("MultiPoint(",!1),mr=Cn("MultiPolygon(",!1),br=Cn("SRID",!1),yr=Cn("geography",!1),vr=Cn("geometry",!1),hr=/^[^}]/,gr=Sn(["}"],!0,!1),Or=Cn("%20",!1),wr=Cn("%09",!1),Er=Cn("@",!1),Cr=Cn("%40",!1),Sr=Cn("%3A",!1),Pr=Cn(",",!1),jr=Cn("%2C",!1),Tr=Cn("%2B",!1),kr=Cn(";",!1),Rr=Cn("%3B",!1),xr=Cn("'",!1),Nr=Cn("%27",!1),_r=Cn("(",!1),Dr=Cn("%28",!1),Ir=Cn(")",!1),Ar=Cn("%29",!1),Fr=Cn("%",!1),Lr=Cn("~",!1),Mr=Cn("$",!1),Br=Cn("&",!1),Ur=Cn("!",!1),Vr=Cn("*",!1),zr=/^[3-9]/,Gr=Sn([["3","9"]],!1,!1),Wr=/^[A-F]/,Hr=Sn([["A","F"]],!1,!1),Kr=/^[0-6]/,qr=Sn([["0","6"]],!1,!1),Yr=/^[8-9]/,Xr=Sn([["8","9"]],!1,!1),Qr=Cn("?",!1),Zr=/^[3-4]/,Jr=Sn([["3","4"]],!1,!1),$r=/^[6-9]/,en=Sn([["6","9"]],!1,!1),tn=Cn("5",!1),rn=/^[A-B]/,nn=Sn([["A","B"]],!1,!1),on=/^[D-F]/,an=Sn([["D","F"]],!1,!1),cn=/^[A-Z]/,sn=Sn([["A","Z"]],!1,!1),ln=/^[a-z]/,un=Sn([["a","z"]],!1,!1),pn=/^[0-9]/,fn=Sn([["0","9"]],!1,!1),dn=Cn('"',!1),mn=Cn(" ",!1),bn=Cn("\t",!1),yn=0,vn=0,hn=[{line:1,column:1}],gn=0,On=[],wn=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');a=i[r.startRule]}function En(){return t.substring(vn,yn)}function Cn(e,t){return{type:"literal",text:e,ignoreCase:t}}function Sn(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Pn(e){var r,n=hn[e];if(n)return n;for(r=e-1;!hn[r];)r--;for(n={line:(n=hn[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return hn[e]=n,n}function jn(e,t){var r=Pn(e),n=Pn(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Tn(e){yn<gn||(yn>gn&&(gn=yn,On=[]),On.push(e))}function kn(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}function Rn(){return Fn()}function xn(){var e;return(e=function(){var e,t,r,n;e=yn,(t=Gi())!==o?((r=Dn())===o&&(r=qo()),r!==o&&(n=Wi())!==o?e=t=[t,r,n]:(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;if(e=yn,(t=Gi())!==o)if((r=Nn())!==o){for(n=[],i=yn,(a=Mi())!==o&&(c=Nn())!==o?i=a=[a,c]:(yn=i,i=o);i!==o;)n.push(i),i=yn,(a=Mi())!==o&&(c=Nn())!==o?i=a=[a,c]:(yn=i,i=o);n!==o&&(i=Wi())!==o?e=t=[t,r,n,i]:(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;return e}())===o&&(e=function(){var e,r,n,i,a;e=yn,r=[],n=yn,47===t.charCodeAt(yn)?(i="/",yn++):(i=o,0===wn&&Tn(c));i!==o&&(a=_n())!==o?n=i=[i,a]:(yn=n,n=o);if(n!==o)for(;n!==o;)r.push(n),n=yn,47===t.charCodeAt(yn)?(i="/",yn++):(i=o,0===wn&&Tn(c)),i!==o&&(a=_n())!==o?n=i=[i,a]:(yn=n,n=o);else r=o;r!==o&&(vn=e,r=r.map((function(e){return e[1]})));return e=r}()),e}function Nn(){var e,t,r,n;return e=yn,(t=Wo())===o&&(t=Wo()),t!==o&&(r=Bi())!==o?((n=Dn())===o&&(n=qo()),n!==o?e=t=[t,r,n]:(yn=e,e=o)):(yn=e,e=o),e}function _n(){var e,t,r;for(e=yn,t=[],r=Hi();r!==o;)t.push(r),r=Hi();return t!==o&&(vn=e,t=s()),e=t}function Dn(){var e,t,r;return e=yn,(t=Fi())!==o&&(r=Wo())!==o?e=t=[t,r]:(yn=e,e=o),e}function In(){var e;return(e=function(){var e,r,n,i;e=yn,"$filter"===t.substr(yn,7)?(r="$filter",yn+=7):(r=o,0===wn&&Tn(u));r===o&&("filter"===t.substr(yn,6)?(r="filter",yn+=6):(r=o,0===wn&&Tn(p)));r!==o&&(n=Bi())!==o&&(i=Fn())!==o?e=r=[r,n,i]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a;e=yn,"$search"===t.substr(yn,7)?(r="$search",yn+=7):(r=o,0===wn&&Tn(f));r===o&&("search"===t.substr(yn,6)?(r="search",yn+=6):(r=o,0===wn&&Tn(d)));r!==o&&(n=Bi())!==o&&(i=Ni())!==o&&(a=An())!==o?e=r=[r,n,i,a]:(yn=e,e=o);return e}()),e}function An(){var e,r,n,i,a,c,s;return e=yn,r=yn,(n=Gi())!==o&&(i=Ni())!==o&&(a=An())!==o&&(c=Ni())!==o&&(s=Wi())!==o?r=n=[n,i,a,c,s]:(yn=r,r=o),r===o&&(r=function(){var e,r,n,i;e=yn,r=yn,"NOT"===t.substr(yn,3)?(n="NOT",yn+=3):(n=o,0===wn&&Tn(y));n!==o&&(i=xi())!==o?r=n=[n,i]:(yn=r,r=o);r===o&&(r=null);r!==o?((n=function(){var e,t,r,n;if(e=yn,(t=_o())!==o){if(r=[],(n=Zi())!==o)for(;n!==o;)r.push(n),n=Zi();else r=o;r!==o&&(n=_o())!==o?e=t=[t,r,n]:(yn=e,e=o)}else yn=e,e=o;return e}())===o&&(n=function(){var e,r;e=[],(r=Ji())===o&&(r=$i())===o&&(r=Mi())===o&&(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r===o&&(r=Ki()));if(r!==o)for(;r!==o;)e.push(r),(r=Ji())===o&&(r=$i())===o&&(r=Mi())===o&&(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r===o&&(r=Ki()));else e=o;return e}()),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o);return e}()),r!==o?((n=function(){var e,r,n,i,a;e=yn,(r=xi())!==o?("OR"===t.substr(yn,2)?(n="OR",yn+=2):(n=o,0===wn&&Tn(m)),n!==o&&(i=xi())!==o&&(a=An())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(n=function(){var e,r,n,i,a;e=yn,(r=xi())!==o?(n=yn,"AND"===t.substr(yn,3)?(i="AND",yn+=3):(i=o,0===wn&&Tn(b)),i!==o&&(a=xi())!==o?n=i=[i,a]:(yn=n,n=o),n===o&&(n=null),n!==o&&(i=An())!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o);return e}()),n===o&&(n=null),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o),e}function Fn(){var e,r,n,i,a;return e=yn,(r=qo())===o&&(r=Oo())===o&&(r=Ln())===o&&(r=Yn())===o&&(r=yo())===o&&(r=Zn())===o&&(r=$n())===o&&(r=eo())===o&&(r=go())===o&&(r=ho())===o&&(r=vo())===o&&(r=Mn()),r!==o?((n=lo())===o&&(n=uo())===o&&(n=po())===o&&(n=fo())===o&&(n=mo())===o&&(n=bo()),n===o&&(n=null),n!==o?((i=to())===o&&(i=ro())===o&&(i=no())===o&&(i=oo())===o&&(i=io())===o&&(i=ao())===o&&(i=so())===o&&(i=co())===o&&(i=Ri()),i===o&&(i=null),i!==o?((a=function(){var e,r,n;e=yn,xi()!==o?("and"===t.substr(yn,3)?(r="and",yn+=3):(r=o,0===wn&&Tn(ne)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e={and:[n]}):(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(a=function(){var e,r,n;e=yn,xi()!==o?("or"===t.substr(yn,2)?(r="or",yn+=2):(r=o,0===wn&&Tn(oe)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e={or:[n]}):(yn=e,e=o)):(yn=e,e=o);return e}()),a===o&&(a=null),a!==o?(vn=e,e=r=h(r,0,i,a)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function Ln(){var e,r,n,i,a;return e=yn,"$root/"===t.substr(yn,6)?(r="$root/",yn+=6):(r=o,0===wn&&Tn(g)),r!==o?(n=yn,(i=Wo())!==o&&(a=xn())!==o?n=i=[i,a]:(yn=n,n=o),n===o&&(n=Wo()),n!==o?((i=Gn())===o&&(i=null),i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function Mn(){var e,r,n,i,a;return(e=Bn())===o&&(e=yn,(r=function(){var e;(e=function(){var e;"$it"===t.substr(yn,3)?(e="$it",yn+=3):(e=o,0===wn&&Tn(w));e===o&&("$this"===t.substr(yn,5)?(e="$this",yn+=5):(e=o,0===wn&&Tn(E)));return e}())===o&&(e=Dn())===o&&(e=Wo());return e}())!==o?(n=yn,47===t.charCodeAt(yn)?(i="/",yn++):(i=o,0===wn&&Tn(c)),i!==o&&(a=Bn())!==o?n=i=[i,a]:(yn=n,n=o),n===o&&(n=null),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o)),e}function Bn(){var e,r,n,i;return e=yn,r=yn,(n=Uo())!==o?(47===t.charCodeAt(yn)?(i="/",yn++):(i=o,0===wn&&Tn(c)),i!==o?r=n=[n,i]:(yn=r,r=o)):(yn=r,r=o),r===o&&(r=null),r!==o?((n=Un())===o&&(n=Yn())===o&&(n=Vn()),n!==o?(vn=e,e=r=n):(yn=e,e=o)):(yn=e,e=o),e}function Un(){var e,t,r;return e=yn,(t=Wo())!==o?((r=zn())===o&&(r=null),r!==o?(vn=e,e=t=[t].concat(ya(r||[]))):(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,(t=Wo())!==o?((r=Gn())===o&&(r=null),r!==o?e=t=[t,r]:(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,(t=Wo())!==o?((r=Wn())===o&&(r=null),r!==o?e=t=[t,r]:(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,(t=Wo())!==o?((r=Kn())===o&&(r=null),r!==o?e=t=[t,r]:(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,(t=Wo())!==o?((r=Hn())===o&&(r=null),r!==o?e=t=[t,r]:(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,(t=Ko())!==o?((r=qn())===o&&(r=null),r!==o?e=t=[t,r]:(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,(t=Wo())!==o?((r=qn())===o&&(r=null),r!==o?e=t=[t,r]:(yn=e,e=o)):(yn=e,e=o))))))),e}function Vn(){var e,r,n;return e=yn,(r=function(){var e,r,n,i,a,c,s;e=yn,(r=Fi())!==o?(n=yn,(i=Go())!==o?(46===t.charCodeAt(yn)?(a=".",yn++):(a=o,0===wn&&Tn(v)),a!==o?n=i=[i,a]:(yn=n,n=o)):(yn=n,n=o),n===o&&(n=null),n!==o&&(i=Wo())!==o?(a=yn,35===t.charCodeAt(yn)?(c="#",yn++):(c=o,0===wn&&Tn(O)),c!==o&&(s=Wo())!==o?a=c=[c,s]:(yn=a,a=o),a===o&&(a=null),a!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())!==o?((n=Hn())===o&&(n=Gn())===o&&(n=Kn())===o&&(n=qn()),n===o&&(n=null),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o),e}function zn(){var e,r,n,i,a;return e=yn,r=yn,47===t.charCodeAt(yn)?(n="/",yn++):(n=o,0===wn&&Tn(c)),n!==o&&(i=Uo())!==o?r=n=[n,i]:(yn=r,r=o),r===o&&(r=null),r!==o?(n=yn,(i=xn())!==o?((a=Gn())===o&&(a=null),a!==o?(vn=n,n=i=i):(yn=n,n=o)):(yn=n,n=o),n===o&&(n=Hn()),n===o&&(n=null),n!==o?(vn=e,e=r=n):(yn=e,e=o)):(yn=e,e=o),e}function Gn(){var e,r,n;return e=yn,47===t.charCodeAt(yn)?(r="/",yn++):(r=o,0===wn&&Tn(c)),r!==o&&(n=Bn())!==o?e=r=[r,n]:(yn=e,e=o),e}function Wn(){var e,r,n,i;return e=yn,r=yn,47===t.charCodeAt(yn)?(n="/",yn++):(n=o,0===wn&&Tn(c)),n!==o&&(i=Vo())!==o?r=n=[n,i]:(yn=r,r=o),r===o&&(r=null),r!==o?((n=Hn())===o&&(n=null),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o),e}function Hn(){var e,r,n,i,a,s,u,p,f;if(e=yn,(r=function(){var e;return"/$count"===t.substr(yn,7)?(e="/$count",yn+=7):(e=o,0===wn&&Tn(l)),e}())!==o){if(n=yn,(i=Gi())!==o)if((a=In())!==o){for(s=[],u=yn,(p=Vi())!==o&&(f=In())!==o?u=p=[p,f]:(yn=u,u=o);u!==o;)s.push(u),u=yn,(p=Vi())!==o&&(f=In())!==o?u=p=[p,f]:(yn=u,u=o);s!==o&&(u=Wi())!==o?n=i=[i,a,s,u]:(yn=n,n=o)}else yn=n,n=o;else yn=n,n=o;n===o&&(n=null),n!==o?e=r=[r,n]:(yn=e,e=o)}else yn=e,e=o;return e===o&&(e=yn,47===t.charCodeAt(yn)?(r="/",yn++):(r=o,0===wn&&Tn(c)),r!==o&&(n=Yn())!==o?e=r=[r,n]:(yn=e,e=o),e===o&&(e=yn,47===t.charCodeAt(yn)?(r="/",yn++):(r=o,0===wn&&Tn(c)),r!==o&&(n=Vn())!==o?e=r=[r,n]:(yn=e,e=o),e===o&&(e=yn,47===t.charCodeAt(yn)?(r="/",yn++):(r=o,0===wn&&Tn(c)),r!==o&&(n=function(){var e,r,n,i,a,c,s,l,u,p;e=yn,"any"===t.substr(yn,3)?(r="any",yn+=3):(r=o,0===wn&&Tn(C));r!==o&&(n=Gi())!==o&&(i=Ni())!==o?(a=yn,(c=Wo())!==o&&(s=Ni())!==o&&(l=Li())!==o&&(u=Ni())!==o&&(p=Fn())!==o?a=c=[c,s,l,u,p]:(yn=a,a=o),a===o&&(a=null),a!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o)):(yn=e,e=o);return e}())!==o?e=r=[r,n]:(yn=e,e=o),e===o&&(e=yn,47===t.charCodeAt(yn)?(r="/",yn++):(r=o,0===wn&&Tn(c)),r!==o&&(n=function(){var e,r,n,i,a,c,s,l,u,p,f;e=yn,"all"===t.substr(yn,3)?(r="all",yn+=3):(r=o,0===wn&&Tn(S));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Wo())!==o&&(c=Ni())!==o&&(s=Li())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o&&(f=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f]:(yn=e,e=o);return e}())!==o?e=r=[r,n]:(yn=e,e=o))))),e}function Kn(){var e,r,n,i,a;return e=yn,r=yn,47===t.charCodeAt(yn)?(n="/",yn++):(n=o,0===wn&&Tn(c)),n!==o&&(i=Vo())!==o?r=n=[n,i]:(yn=r,r=o),r===o&&(r=null),r!==o?(n=yn,47===t.charCodeAt(yn)?(i="/",yn++):(i=o,0===wn&&Tn(c)),i!==o&&(a=Un())!==o?n=i=[i,a]:(yn=n,n=o),n===o&&(n=yn,47===t.charCodeAt(yn)?(i="/",yn++):(i=o,0===wn&&Tn(c)),i!==o&&(a=Yn())!==o?n=i=[i,a]:(yn=n,n=o),n===o&&(n=yn,47===t.charCodeAt(yn)?(i="/",yn++):(i=o,0===wn&&Tn(c)),i!==o&&(a=Vn())!==o?n=i=[i,a]:(yn=n,n=o))),n===o&&(n=null),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o),e}function qn(){var e,r,n;return e=yn,47===t.charCodeAt(yn)?(r="/",yn++):(r=o,0===wn&&Tn(c)),r!==o?((n=Vn())===o&&(n=Yn()),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o),e}function Yn(){var e,r,n,i,a,c,s;return e=yn,(r=Go())!==o?(46===t.charCodeAt(yn)?(n=".",yn++):(n=o,0===wn&&Tn(v)),n!==o?(i=yn,(a=Wo())!==o&&(c=Xn())!==o?((s=zn())===o&&(s=null),s!==o?i=a=[a,c,s]:(yn=i,i=o)):(yn=i,i=o),i===o&&(i=yn,(a=Wo())!==o&&(c=Xn())!==o?((s=Gn())===o&&(s=null),s!==o?i=a=[a,c,s]:(yn=i,i=o)):(yn=i,i=o),i===o&&(i=yn,(a=Wo())!==o&&(c=Xn())!==o?((s=Wn())===o&&(s=null),s!==o?i=a=[a,c,s]:(yn=i,i=o)):(yn=i,i=o),i===o&&(i=yn,(a=Wo())!==o&&(c=Xn())!==o?((s=Kn())===o&&(s=null),s!==o?i=a=[a,c,s]:(yn=i,i=o)):(yn=i,i=o),i===o&&(i=yn,(a=Wo())!==o&&(c=Xn())!==o?((s=Hn())===o&&(s=null),s!==o?i=a=[a,c,s]:(yn=i,i=o)):(yn=i,i=o),i===o&&(i=yn,(a=Wo())!==o&&(c=Xn())!==o?((s=qn())===o&&(s=null),s!==o?i=a=[a,c,s]:(yn=i,i=o)):(yn=i,i=o)))))),i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function Xn(){var e,t,r,n,i,a,c,s;if(e=yn,(t=Gi())!==o){if(r=yn,(n=Qn())!==o){for(i=[],a=yn,(c=Mi())!==o&&(s=Qn())!==o?a=c=[c,s]:(yn=a,a=o);a!==o;)i.push(a),a=yn,(c=Mi())!==o&&(s=Qn())!==o?a=c=[c,s]:(yn=a,a=o);i!==o?r=n=[n,i]:(yn=r,r=o)}else yn=r,r=o;r===o&&(r=null),r!==o&&(n=Wi())!==o?e=t=[t,r,n]:(yn=e,e=o)}else yn=e,e=o;return e}function Qn(){var e,t,r,n;return e=yn,(t=Wo())!==o&&(r=Bi())!==o?((n=Dn())===o&&(n=function(){var e;return(e=Oo())===o&&(e=Fn()),e}()),n!==o?e=t=[t,r,n]:(yn=e,e=o)):(yn=e,e=o),e}function Zn(){var e;return(e=function(){var e,r,n,i,a,c,s,l,u,p,f;e=yn,"indexof"===t.substr(yn,7)?(r="indexof",yn+=7):(r=o,0===wn&&Tn(k));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o&&(f=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"tolower"===t.substr(yn,7)?(r="tolower",yn+=7):(r=o,0===wn&&Tn(_));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"toupper"===t.substr(yn,7)?(r="toupper",yn+=7):(r=o,0===wn&&Tn(D));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"trim"===t.substr(yn,4)?(r="trim",yn+=4):(r=o,0===wn&&Tn(I));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p,f,d,m,b,y;e=yn,"substring"===t.substr(yn,9)?(r="substring",yn+=9):(r=o,0===wn&&Tn(N));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o?(f=yn,(d=Mi())!==o&&(m=Ni())!==o&&(b=Fn())!==o&&(y=Ni())!==o?f=d=[d,m,b,y]:(yn=f,f=o),f===o&&(f=null),f!==o&&(d=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f,d]:(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p,f;e=yn,"concat"===t.substr(yn,6)?(r="concat",yn+=6):(r=o,0===wn&&Tn(P));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o&&(f=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"length"===t.substr(yn,6)?(r="length",yn+=6):(r=o,0===wn&&Tn(R));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"year"===t.substr(yn,4)?(r="year",yn+=4):(r=o,0===wn&&Tn(A));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"month"===t.substr(yn,5)?(r="month",yn+=5):(r=o,0===wn&&Tn(F));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"day"===t.substr(yn,3)?(r="day",yn+=3):(r=o,0===wn&&Tn(L));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"hour"===t.substr(yn,4)?(r="hour",yn+=4):(r=o,0===wn&&Tn(M));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"minute"===t.substr(yn,6)?(r="minute",yn+=6):(r=o,0===wn&&Tn(B));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"second"===t.substr(yn,6)?(r="second",yn+=6):(r=o,0===wn&&Tn(U));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"fractionalseconds"===t.substr(yn,17)?(r="fractionalseconds",yn+=17):(r=o,0===wn&&Tn(V));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"totalseconds"===t.substr(yn,12)?(r="totalseconds",yn+=12):(r=o,0===wn&&Tn(z));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"date"===t.substr(yn,4)?(r="date",yn+=4):(r=o,0===wn&&Tn(G));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"time"===t.substr(yn,4)?(r="time",yn+=4):(r=o,0===wn&&Tn(W));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"round"===t.substr(yn,5)?(r="round",yn+=5):(r=o,0===wn&&Tn(X));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"floor"===t.substr(yn,5)?(r="floor",yn+=5):(r=o,0===wn&&Tn(Q));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"ceiling"===t.substr(yn,7)?(r="ceiling",yn+=7):(r=o,0===wn&&Tn(Z));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p,f;e=yn,"geo.distance"===t.substr(yn,12)?(r="geo.distance",yn+=12):(r=o,0===wn&&Tn(J));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o&&(f=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"geo.length"===t.substr(yn,10)?(r="geo.length",yn+=10):(r=o,0===wn&&Tn($));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"totaloffsetminutes"===t.substr(yn,18)?(r="totaloffsetminutes",yn+=18):(r=o,0===wn&&Tn(H));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Wi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a;e=yn,"mindatetime"===t.substr(yn,11)?(r="mindatetime",yn+=11):(r=o,0===wn&&Tn(K));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Wi())!==o?e=r=[r,n,i,a]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a;e=yn,"maxdatetime"===t.substr(yn,11)?(r="maxdatetime",yn+=11):(r=o,0===wn&&Tn(q));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Wi())!==o?e=r=[r,n,i,a]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a;e=yn,"now"===t.substr(yn,3)?(r="now",yn+=3):(r=o,0===wn&&Tn(Y));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Wi())!==o?e=r=[r,n,i,a]:(yn=e,e=o);return e}())===o&&(e=Jn()),e}function Jn(){var e;return(e=function(){var e,r,n,i;e=yn,"endswith"===t.substr(yn,8)?(r="endswith",yn+=8):(r=o,0===wn&&Tn(T));r!==o&&Gi()!==o&&Ni()!==o&&(n=Fn())!==o&&Ni()!==o&&Mi()!==o&&Ni()!==o&&(i=Fn())!==o&&Ni()!==o&&Wi()!==o?(vn=e,r=ma(n,"endswith ".concat(i)),e=r):(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i;e=yn,"startswith"===t.substr(yn,10)?(r="startswith",yn+=10):(r=o,0===wn&&Tn(x));r!==o&&Gi()!==o&&Ni()!==o&&(n=Fn())!==o&&Ni()!==o&&Mi()!==o&&Ni()!==o&&(i=Fn())!==o&&Ni()!==o&&Wi()!==o?(vn=e,r=ma(n,"startswith ".concat(i)),e=r):(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i;e=yn,"contains"===t.substr(yn,8)?(r="contains",yn+=8):(r=o,0===wn&&Tn(j));r!==o&&Gi()!==o&&Ni()!==o&&(n=Fn())!==o&&Ni()!==o&&Mi()!==o&&Ni()!==o&&(i=Fn())!==o&&Ni()!==o&&Wi()!==o?(vn=e,r=ma(n,"contains ".concat(i)),e=r):(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p,f;e=yn,"geo.intersects"===t.substr(yn,14)?(r="geo.intersects",yn+=14):(r=o,0===wn&&Tn(ee));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o&&(f=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p,f;e=yn,"hassubset"===t.substr(yn,9)?(r="hassubset",yn+=9):(r=o,0===wn&&Tn(te));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o&&(f=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f]:(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p,f;e=yn,"hassubsequence"===t.substr(yn,14)?(r="hassubsequence",yn+=14):(r=o,0===wn&&Tn(re));r!==o&&(n=Gi())!==o&&(i=Ni())!==o&&(a=Fn())!==o&&(c=Ni())!==o&&(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o&&(f=Wi())!==o?e=r=[r,n,i,a,c,s,l,u,p,f]:(yn=e,e=o);return e}()),e}function $n(){var e,t;return e=yn,Gi()!==o&&Ni()!==o&&(t=Fn())!==o&&Ni()!==o&&Wi()!==o?(vn=e,e=t):(yn=e,e=o),e}function eo(){var e,t,r,n,i,a,c,s,l,u,p;if(e=yn,(t=Gi())!==o)if((r=Ni())!==o)if((n=Fn())!==o)if((i=Ni())!==o){for(a=[],c=yn,(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o?c=s=[s,l,u,p]:(yn=c,c=o);c!==o;)a.push(c),c=yn,(s=Mi())!==o&&(l=Ni())!==o&&(u=Fn())!==o&&(p=Ni())!==o?c=s=[s,l,u,p]:(yn=c,c=o);a!==o&&(c=Wi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;else yn=e,e=o;else yn=e,e=o;return e}function to(){var e,r,n;return e=yn,xi()!==o?("eq"===t.substr(yn,2)?(r="eq",yn+=2):(r=o,0===wn&&Tn(ie)),r!==o&&xi()!==o&&(n=fa())!==o?(vn=e,e="eq ".concat(n)):(yn=e,e=o)):(yn=e,e=o),e}function ro(){var e,r,n;return e=yn,xi()!==o?("ne"===t.substr(yn,2)?(r="ne",yn+=2):(r=o,0===wn&&Tn(ae)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e="ne ".concat(n)):(yn=e,e=o)):(yn=e,e=o),e}function no(){var e,r,n;return e=yn,xi()!==o?("lt"===t.substr(yn,2)?(r="lt",yn+=2):(r=o,0===wn&&Tn(ce)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e="lt ".concat(n)):(yn=e,e=o)):(yn=e,e=o),e}function oo(){var e,r,n;return e=yn,xi()!==o?("le"===t.substr(yn,2)?(r="le",yn+=2):(r=o,0===wn&&Tn(se)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e="le ".concat(n)):(yn=e,e=o)):(yn=e,e=o),e}function io(){var e,r,n;return e=yn,xi()!==o?("gt"===t.substr(yn,2)?(r="gt",yn+=2):(r=o,0===wn&&Tn(le)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e="gt ".concat(n)):(yn=e,e=o)):(yn=e,e=o),e}function ao(){var e,r,n;return e=yn,xi()!==o?("ge"===t.substr(yn,2)?(r="ge",yn+=2):(r=o,0===wn&&Tn(ue)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e="ge ".concat(n)):(yn=e,e=o)):(yn=e,e=o),e}function co(){var e,r,n;return e=yn,xi()!==o?("in"===t.substr(yn,2)?(r="in",yn+=2):(r=o,0===wn&&Tn(pe)),r!==o&&xi()!==o&&(n=Fn())!==o?(vn=e,e="in ".concat(n)):(yn=e,e=o)):(yn=e,e=o),e}function so(){var e,r,n,i,a;return e=yn,(r=xi())!==o?("has"===t.substr(yn,3)?(n="has",yn+=3):(n=o,0===wn&&Tn(fe)),n!==o&&(i=xi())!==o&&(a=oi())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o),e}function lo(){var e,r,n,i,a;return e=yn,(r=xi())!==o?("add"===t.substr(yn,3)?(n="add",yn+=3):(n=o,0===wn&&Tn(de)),n!==o&&(i=xi())!==o&&(a=Fn())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o),e}function uo(){var e,r,n,i,a;return e=yn,(r=xi())!==o?("sub"===t.substr(yn,3)?(n="sub",yn+=3):(n=o,0===wn&&Tn(me)),n!==o&&(i=xi())!==o&&(a=Fn())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o),e}function po(){var e,r,n,i,a;return e=yn,(r=xi())!==o?("mul"===t.substr(yn,3)?(n="mul",yn+=3):(n=o,0===wn&&Tn(be)),n!==o&&(i=xi())!==o&&(a=Fn())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o),e}function fo(){var e,r,n,i,a;return e=yn,(r=xi())!==o?("div"===t.substr(yn,3)?(n="div",yn+=3):(n=o,0===wn&&Tn(ye)),n!==o&&(i=xi())!==o&&(a=Fn())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o),e}function mo(){var e,r,n,i,a;return e=yn,(r=xi())!==o?("divby"===t.substr(yn,5)?(n="divby",yn+=5):(n=o,0===wn&&Tn(ve)),n!==o&&(i=xi())!==o&&(a=Fn())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o),e}function bo(){var e,r,n,i,a;return e=yn,(r=xi())!==o?("mod"===t.substr(yn,3)?(n="mod",yn+=3):(n=o,0===wn&&Tn(he)),n!==o&&(i=xi())!==o&&(a=Fn())!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o),e}function yo(){var e,r,n,i;return e=yn,45===t.charCodeAt(yn)?(r="-",yn++):(r=o,0===wn&&Tn(ge)),r!==o&&(n=Ni())!==o&&(i=Fn())!==o?e=r=[r,n,i]:(yn=e,e=o),e}function vo(){var e,r,n,i;return e=yn,"not"===t.substr(yn,3)?(r="not",yn+=3):(r=o,0===wn&&Tn(Oe)),r!==o&&(n=xi())!==o&&(i=Fn())!==o?e=r=[r,n,i]:(yn=e,e=o),e}function ho(){var e,r,n,i,a,c;return e=yn,"isof"===t.substr(yn,4)?(r="isof",yn+=4):(r=o,0===wn&&Tn(we)),r!==o&&Gi()!==o&&Ni()!==o?(n=yn,(i=Fn())!==o&&Ni()!==o&&Mi()!==o&&Ni()!==o?(vn=n,n=i=i):(yn=n,n=o),n===o&&(n=null),n!==o&&(i=Bo())!==o&&Ni()!==o&&Wi()!==o?(vn=e,c=i,e=r=(a=n)?ba({},a,{$type:c}):{$type:c}):(yn=e,e=o)):(yn=e,e=o),e}function go(){var e,r,n,i,a,c,s,l,u;return e=yn,"cast"===t.substr(yn,4)?(r="cast",yn+=4):(r=o,0===wn&&Tn(Ee)),r!==o&&(n=Gi())!==o&&(i=Ni())!==o?(a=yn,(c=Fn())!==o&&(s=Ni())!==o&&(l=Mi())!==o&&(u=Ni())!==o?a=c=[c,s,l,u]:(yn=a,a=o),a===o&&(a=null),a!==o&&(c=Bo())!==o&&(s=Ni())!==o&&(l=Wi())!==o?e=r=[r,n,i,a,c,s,l]:(yn=e,e=o)):(yn=e,e=o),e}function Oo(){var e;return(e=wo())===o&&(e=Eo())===o&&(e=Ro())===o&&(e=So()),e}function wo(){var e,t,r,n,i,a,c,s;if(e=yn,(t=xo())!==o){if(r=yn,(n=Eo())!==o){for(i=[],a=yn,(c=Io())!==o&&(s=Eo())!==o?a=c=[c,s]:(yn=a,a=o);a!==o;)i.push(a),a=yn,(c=Io())!==o&&(s=Eo())!==o?a=c=[c,s]:(yn=a,a=o);i!==o?r=n=[n,i]:(yn=r,r=o)}else yn=r,r=o;r===o&&(r=null),r!==o&&(n=No())!==o?e=t=[t,r,n]:(yn=e,e=o)}else yn=e,e=o;return e}function Eo(){var e,r,n,i,a,c,s,l;if(e=yn,(r=function(){var e,r,n,i;e=yn,(r=Ni())!==o?(123===t.charCodeAt(yn)?(n="{",yn++):(n=o,0===wn&&Tn(Ce)),n===o&&("%7B"===t.substr(yn,3)?(n="%7B",yn+=3):(n=o,0===wn&&Tn(Se))),n!==o&&(i=Ni())!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o);return e}())!==o){if(n=yn,(i=jo())===o&&(i=To())===o&&(i=Po())===o&&(i=Co())===o&&(i=ko()),i!==o){for(a=[],c=yn,(s=Io())!==o?((l=jo())===o&&(l=To())===o&&(l=Po())===o&&(l=Co())===o&&(l=ko()),l!==o?c=s=[s,l]:(yn=c,c=o)):(yn=c,c=o);c!==o;)a.push(c),c=yn,(s=Io())!==o?((l=jo())===o&&(l=To())===o&&(l=Po())===o&&(l=Co())===o&&(l=ko()),l!==o?c=s=[s,l]:(yn=c,c=o)):(yn=c,c=o);a!==o?n=i=[i,a]:(yn=n,n=o)}else yn=n,n=o;n===o&&(n=null),n!==o&&(i=function(){var e,r,n;e=yn,(r=Ni())!==o?(125===t.charCodeAt(yn)?(n="}",yn++):(n=o,0===wn&&Tn(Pe)),n===o&&("%7D"===t.substr(yn,3)?(n="%7D",yn+=3):(n=o,0===wn&&Tn(je))),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o);return e}())!==o?e=r=[r,n,i]:(yn=e,e=o)}else yn=e,e=o;return e}function Co(){var e,t,r,n,i,a;return e=yn,(t=_o())!==o&&(r=Wo())!==o&&(n=_o())!==o&&(i=Do())!==o&&(a=So())!==o?e=t=[t,r,n,i,a]:(yn=e,e=o),e===o&&(e=yn,(t=_o())!==o&&(r=Wo())!==o&&(n=_o())!==o&&(i=Do())!==o&&(a=wo())!==o?e=t=[t,r,n,i,a]:(yn=e,e=o)),e}function So(){var e,t,r,n,i,a,c,s;if(e=yn,(t=xo())!==o){if(r=yn,(n=Ao())!==o){for(i=[],a=yn,(c=Io())!==o&&(s=Ao())!==o?a=c=[c,s]:(yn=a,a=o);a!==o;)i.push(a),a=yn,(c=Io())!==o&&(s=Ao())!==o?a=c=[c,s]:(yn=a,a=o);i!==o?r=n=[n,i]:(yn=r,r=o)}else yn=r,r=o;r===o&&(r=null),r!==o&&(n=No())!==o?e=t=[t,r,n]:(yn=e,e=o)}else yn=e,e=o;return e}function Po(){var e,t,r,n,i,a;return e=yn,(t=_o())!==o&&(r=Wo())!==o&&(n=_o())!==o&&(i=Do())!==o&&(a=Eo())!==o?e=t=[t,r,n,i,a]:(yn=e,e=o),e}function jo(){var e,r,n,i,a,c,s,l,u;return e=yn,(r=_o())!==o&&(n=Fi())!==o&&(i=Go())!==o?(46===t.charCodeAt(yn)?(a=".",yn++):(a=o,0===wn&&Tn(v)),a!==o&&(c=Wo())!==o&&(s=_o())!==o&&(l=Do())!==o?((u=Eo())===o&&(u=wo())===o&&(u=Ao())===o&&(u=So()),u!==o?e=r=[r,n,i,a,c,s,l,u]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function To(){var e,t,r,n,i,a;return e=yn,(t=_o())!==o&&(r=Ko())!==o&&(n=_o())!==o&&(i=Do())!==o&&(a=Ao())!==o?e=t=[t,r,n,i,a]:(yn=e,e=o),e}function ko(){var e;return(e=function(){var e,t,r,n,i,a;e=yn,(t=_o())!==o&&(r=Wo())!==o&&(n=_o())!==o&&(i=Do())!==o&&(a=Ln())!==o?e=t=[t,r,n,i,a]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a;e=yn,(t=_o())!==o&&(r=Wo())!==o&&(n=_o())!==o&&(i=Do())!==o&&(a=Ro())!==o?e=t=[t,r,n,i,a]:(yn=e,e=o);return e}()),e}function Ro(){var e,t,r,n,i,a,c,s;if(e=yn,(t=xo())!==o){if(r=yn,(n=Ln())!==o){for(i=[],a=yn,(c=Io())!==o&&(s=Ln())!==o?a=c=[c,s]:(yn=a,a=o);a!==o;)i.push(a),a=yn,(c=Io())!==o&&(s=Ln())!==o?a=c=[c,s]:(yn=a,a=o);i!==o?r=n=[n,i]:(yn=r,r=o)}else yn=r,r=o;r===o&&(r=null),r!==o&&(n=No())!==o?e=t=[t,r,n]:(yn=e,e=o)}else yn=e,e=o;return e}function xo(){var e,r,n,i;return e=yn,(r=Ni())!==o?(91===t.charCodeAt(yn)?(n="[",yn++):(n=o,0===wn&&Tn(Te)),n===o&&("%5B"===t.substr(yn,3)?(n="%5B",yn+=3):(n=o,0===wn&&Tn(ke))),n!==o&&(i=Ni())!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o),e}function No(){var e,r,n;return e=yn,(r=Ni())!==o?(93===t.charCodeAt(yn)?(n="]",yn++):(n=o,0===wn&&Tn(Re)),n===o&&("%5D"===t.substr(yn,3)?(n="%5D",yn+=3):(n=o,0===wn&&Tn(xe))),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o),e}function _o(){var e;return(e=function(){var e;34===t.charCodeAt(yn)?(e='"',yn++):(e=o,0===wn&&Tn(dn));return e}())===o&&("%22"===t.substr(yn,3)?(e="%22",yn+=3):(e=o,0===wn&&Tn(Ne))),e}function Do(){var e,t,r,n;return e=yn,(t=Ni())!==o&&(r=Li())!==o&&(n=Ni())!==o?e=t=[t,r,n]:(yn=e,e=o),e}function Io(){var e,t,r,n;return e=yn,(t=Ni())!==o&&(r=Mi())!==o&&(n=Ni())!==o?e=t=[t,r,n]:(yn=e,e=o),e}function Ao(){var e;return(e=function(){var e,t,r,n;if(e=yn,(t=_o())!==o){for(r=[],n=Fo();n!==o;)r.push(n),n=Fo();r!==o&&(n=_o())!==o?e=t=[t,r,n]:(yn=e,e=o)}else yn=e,e=o;return e}())===o&&(e=function(){var e,r,n,i,a;e=yn,45===t.charCodeAt(yn)?(r="-",yn++):(r=o,0===wn&&Tn(ge));r===o&&(r=null);r!==o&&(n=function(){var e,r,n,i;48===t.charCodeAt(yn)?(e="0",yn++):(e=o,0===wn&&Tn(He));if(e===o)if(e=yn,(r=Jo())!==o){for(n=[],i=$i();i!==o;)n.push(i),i=$i();n!==o?e=r=[r,n]:(yn=e,e=o)}else yn=e,e=o;return e}())!==o?((i=function(){var e,r,n,i;e=yn,46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v));if(r!==o){if(n=[],(i=$i())!==o)for(;i!==o;)n.push(i),i=$i();else n=o;n!==o?e=r=[r,n]:(yn=e,e=o)}else yn=e,e=o;return e}())===o&&(i=null),i!==o?((a=function(){var e,r,n,i,a;e=yn,101===t.charCodeAt(yn)?(r="e",yn++):(r=o,0===wn&&Tn(Ke));if(r!==o)if(45===t.charCodeAt(yn)?(n="-",yn++):(n=o,0===wn&&Tn(ge)),n===o&&(43===t.charCodeAt(yn)?(n="+",yn++):(n=o,0===wn&&Tn(qe))),n===o&&(n=null),n!==o){if(i=[],(a=$i())!==o)for(;a!==o;)i.push(a),a=$i();else i=o;i!==o?e=r=[r,n,i]:(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;return e}())===o&&(a=null),a!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())===o&&("true"===t.substr(yn,4)?(e="true",yn+=4):(e=o,0===wn&&Tn(_e)),e===o&&("false"===t.substr(yn,5)?(e="false",yn+=5):(e=o,0===wn&&Tn(De)),e===o&&("null"===t.substr(yn,4)?(e="null",yn+=4):(e=o,0===wn&&Tn(Ie))))),e}function Fo(){var e,r,n,i,a;return(e=Qi())===o&&(e=function(){var e;(e=ta())===o&&(58===t.charCodeAt(yn)?(e=":",yn++):(e=o,0===wn&&Tn(ze)),e===o&&(123===t.charCodeAt(yn)?(e="{",yn++):(e=o,0===wn&&Tn(Ce)),e===o&&(125===t.charCodeAt(yn)?(e="}",yn++):(e=o,0===wn&&Tn(Pe)),e===o&&(91===t.charCodeAt(yn)?(e="[",yn++):(e=o,0===wn&&Tn(Te)),e===o&&(93===t.charCodeAt(yn)?(e="]",yn++):(e=o,0===wn&&Tn(Re)))))));return e}())===o&&(e=yn,(r=Lo())!==o?((n=_o())===o&&(n=Lo())===o&&(47===t.charCodeAt(yn)?(n="/",yn++):(n=o,0===wn&&Tn(c)),n===o&&("%2F"===t.substr(yn,3)?(n="%2F",yn+=3):(n=o,0===wn&&Tn(Ae))),n===o&&(98===t.charCodeAt(yn)?(n="b",yn++):(n=o,0===wn&&Tn(Fe)),n===o&&(102===t.charCodeAt(yn)?(n="f",yn++):(n=o,0===wn&&Tn(Le)),n===o&&(110===t.charCodeAt(yn)?(n="n",yn++):(n=o,0===wn&&Tn(Me)),n===o&&(114===t.charCodeAt(yn)?(n="r",yn++):(n=o,0===wn&&Tn(Be)),n===o&&(116===t.charCodeAt(yn)?(n="t",yn++):(n=o,0===wn&&Tn(Ue)),n===o&&(n=yn,117===t.charCodeAt(yn)?(i="u",yn++):(i=o,0===wn&&Tn(Ve)),i!==o&&(a=sa())!==o?n=i=[i,a]:(yn=n,n=o)))))))),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o)),e}function Lo(){var e;return 92===t.charCodeAt(yn)?(e="\\",yn++):(e=o,0===wn&&Tn(Ge)),e===o&&("%5C"===t.substr(yn,3)?(e="%5C",yn+=3):(e=o,0===wn&&Tn(We))),e}function Mo(){var e;return(e=Uo())===o&&(e=Vo())===o&&(e=function e(){var r,n,i;r=yn,(n=Wo())!==o?(46===t.charCodeAt(yn)?(i=".",yn++):(i=o,0===wn&&Tn(v)),i!==o&&Wo()!==o?(vn=r,n=s(),r=n):(yn=r,r=o)):(yn=r,r=o);r===o&&(r=yn,(n=Wo())!==o?(46===t.charCodeAt(yn)?(i=".",yn++):(i=o,0===wn&&Tn(v)),i!==o&&e()!==o?(vn=r,n=s(),r=n):(yn=r,r=o)):(yn=r,r=o));return r}())===o&&(e=zo())===o&&(e=function(){var e,r,n,i,a;e=yn,"Edm."===t.substr(yn,4)?(r="Edm.",yn+=4):(r=o,0===wn&&Tn(Qe));r!==o?("Binary"===t.substr(yn,6)?(n="Binary",yn+=6):(n=o,0===wn&&Tn(Ze)),n===o&&("Boolean"===t.substr(yn,7)?(n="Boolean",yn+=7):(n=o,0===wn&&Tn(Je)),n===o&&("Byte"===t.substr(yn,4)?(n="Byte",yn+=4):(n=o,0===wn&&Tn($e)),n===o&&("Date"===t.substr(yn,4)?(n="Date",yn+=4):(n=o,0===wn&&Tn(et)),n===o&&("DateTimeOffset"===t.substr(yn,14)?(n="DateTimeOffset",yn+=14):(n=o,0===wn&&Tn(tt)),n===o&&("Decimal"===t.substr(yn,7)?(n="Decimal",yn+=7):(n=o,0===wn&&Tn(rt)),n===o&&("Double"===t.substr(yn,6)?(n="Double",yn+=6):(n=o,0===wn&&Tn(nt)),n===o&&("Duration"===t.substr(yn,8)?(n="Duration",yn+=8):(n=o,0===wn&&Tn(ot)),n===o&&("Guid"===t.substr(yn,4)?(n="Guid",yn+=4):(n=o,0===wn&&Tn(it)),n===o&&("Int16"===t.substr(yn,5)?(n="Int16",yn+=5):(n=o,0===wn&&Tn(at)),n===o&&("Int32"===t.substr(yn,5)?(n="Int32",yn+=5):(n=o,0===wn&&Tn(ct)),n===o&&("Int64"===t.substr(yn,5)?(n="Int64",yn+=5):(n=o,0===wn&&Tn(st)),n===o&&("SByte"===t.substr(yn,5)?(n="SByte",yn+=5):(n=o,0===wn&&Tn(lt)),n===o&&("Single"===t.substr(yn,6)?(n="Single",yn+=6):(n=o,0===wn&&Tn(ut)),n===o&&("Stream"===t.substr(yn,6)?(n="Stream",yn+=6):(n=o,0===wn&&Tn(pt)),n===o&&("String"===t.substr(yn,6)?(n="String",yn+=6):(n=o,0===wn&&Tn(ft)),n===o&&("TimeOfDay"===t.substr(yn,9)?(n="TimeOfDay",yn+=9):(n=o,0===wn&&Tn(dt)),n===o&&(n=yn,(i=function(){var e;"Geography"===t.substr(yn,9)?(e="Geography",yn+=9):(e=o,0===wn&&Tn(mt));e===o&&("Geometry"===t.substr(yn,8)?(e="Geometry",yn+=8):(e=o,0===wn&&Tn(bt)));return e}())!==o?((a=function(){var e;"Collection"===t.substr(yn,10)?(e="Collection",yn+=10):(e=o,0===wn&&Tn(Ye));e===o&&("LineString"===t.substr(yn,10)?(e="LineString",yn+=10):(e=o,0===wn&&Tn(yt)),e===o&&("MultiLineString"===t.substr(yn,15)?(e="MultiLineString",yn+=15):(e=o,0===wn&&Tn(vt)),e===o&&("MultiPoint"===t.substr(yn,10)?(e="MultiPoint",yn+=10):(e=o,0===wn&&Tn(ht)),e===o&&("MultiPolygon"===t.substr(yn,12)?(e="MultiPolygon",yn+=12):(e=o,0===wn&&Tn(gt)),e===o&&("Point"===t.substr(yn,5)?(e="Point",yn+=5):(e=o,0===wn&&Tn(Ot)),e===o&&("Polygon"===t.substr(yn,7)?(e="Polygon",yn+=7):(e=o,0===wn&&Tn(wt))))))));return e}())===o&&(a=null),a!==o?n=i=[i,a]:(yn=n,n=o)):(yn=n,n=o)))))))))))))))))),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o);return e}()),e}function Bo(){var e,r,n,i,a;return(e=Mo())===o&&(e=yn,"Collection"===t.substr(yn,10)?(r="Collection",yn+=10):(r=o,0===wn&&Tn(Ye)),r!==o&&(n=Gi())!==o&&(i=Mo())!==o&&(a=Wi())!==o?e=r=[r,n,i,a]:(yn=e,e=o)),e}function Uo(){var e,r;return e=yn,Wo()!==o?(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r!==o&&Wo()!==o?(vn=e,e=s()):(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,Wo()!==o?(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r!==o&&Uo()!==o?(vn=e,e=s()):(yn=e,e=o)):(yn=e,e=o)),e}function Vo(){var e,r;return e=yn,Wo()!==o?(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r!==o&&Wo()!==o?(vn=e,e=s()):(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,Wo()!==o?(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r!==o&&Vo()!==o?(vn=e,e=s()):(yn=e,e=o)):(yn=e,e=o)),e}function zo(){var e,r;return e=yn,Wo()!==o?(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r!==o&&Wo()!==o?(vn=e,e=s()):(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,Wo()!==o?(46===t.charCodeAt(yn)?(r=".",yn++):(r=o,0===wn&&Tn(v)),r!==o&&zo()!==o?(vn=e,e=s()):(yn=e,e=o)):(yn=e,e=o)),e}function Go(){var e,r,n,i,a,c;if(e=yn,(r=Wo())!==o){for(n=[],i=yn,46===t.charCodeAt(yn)?(a=".",yn++):(a=o,0===wn&&Tn(v)),a!==o&&(c=Wo())!==o?i=a=[a,c]:(yn=i,i=o);i!==o;)n.push(i),i=yn,46===t.charCodeAt(yn)?(a=".",yn++):(a=o,0===wn&&Tn(v)),a!==o&&(c=Wo())!==o?i=a=[a,c]:(yn=i,i=o);n!==o?(i=yn,wn++,a=Wo(),wn--,a!==o?(yn=i,i=void 0):i=o,i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)}else yn=e,e=o;return e}function Wo(){var e;return e=yn,function(){var e;(e=Ji())===o&&(95===t.charCodeAt(yn)?(e="_",yn++):(e=o,0===wn&&Tn(Xe)));return e}()!==o&&function(){var e,t;e=[],t=Ho();for(;t!==o;)e.push(t),t=Ho();return e}()!==o?(vn=e,e=s()):(yn=e,e=o),e}function Ho(){var e;return(e=Ji())===o&&(95===t.charCodeAt(yn)?(e="_",yn++):(e=o,0===wn&&Tn(Xe)),e===o&&(e=$i())),e}function Ko(){var e;return(e=Wo())===o&&(e=Wo()),e}function qo(){var e;return(e=function(){var e;"null"===t.substr(yn,4)?(e="null",yn+=4):(e=o,0===wn&&Tn(Ie));return e}())===o&&(e=function(){var e;"true"===t.substr(yn,4)?(e="true",yn+=4):(e=o,0===wn&&Tn(_e));e===o&&("false"===t.substr(yn,5)?(e="false",yn+=5):(e=o,0===wn&&Tn(De)));return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p;e=yn,(r=function(){var e,t,r;e=yn,(t=sa())!==o&&(r=sa())!==o?e=t=[t,r]:(yn=e,e=o);return e}())!==o?(45===t.charCodeAt(yn)?(n="-",yn++):(n=o,0===wn&&Tn(ge)),n!==o&&(i=sa())!==o?(45===t.charCodeAt(yn)?(a="-",yn++):(a=o,0===wn&&Tn(ge)),a!==o&&(c=sa())!==o?(45===t.charCodeAt(yn)?(s="-",yn++):(s=o,0===wn&&Tn(ge)),s!==o&&(l=sa())!==o?(45===t.charCodeAt(yn)?(u="-",yn++):(u=o,0===wn&&Tn(ge)),u!==o&&(p=function(){var e,t,r,n;e=yn,(t=sa())!==o&&(r=sa())!==o&&(n=sa())!==o?e=t=[t,r,n]:(yn=e,e=o);return e}())!==o?e=r=[r,n,i,a,c,s,l,u,p]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c;e=yn,(r=ei())!==o?(45===t.charCodeAt(yn)?(n="-",yn++):(n=o,0===wn&&Tn(ge)),n!==o&&(i=ti())!==o?(45===t.charCodeAt(yn)?(a="-",yn++):(a=o,0===wn&&Tn(ge)),a!==o&&(c=ri())!==o?e=r=[r,n,i,a,c]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p,f,d,m,b,y,h;e=yn,(r=ei())!==o?(45===t.charCodeAt(yn)?(n="-",yn++):(n=o,0===wn&&Tn(ge)),n!==o&&(i=ti())!==o?(45===t.charCodeAt(yn)?(a="-",yn++):(a=o,0===wn&&Tn(ge)),a!==o&&(c=ri())!==o?(84===t.charCodeAt(yn)?(s="T",yn++):(s=o,0===wn&&Tn(Gt)),s!==o&&(l=ni())!==o?(58===t.charCodeAt(yn)?(u=":",yn++):(u=o,0===wn&&Tn(ze)),u!==o&&(p=$o())!==o?(f=yn,58===t.charCodeAt(yn)?(d=":",yn++):(d=o,0===wn&&Tn(ze)),d!==o&&(m=$o())!==o?(b=yn,46===t.charCodeAt(yn)?(y=".",yn++):(y=o,0===wn&&Tn(v)),y!==o&&(h=ca())!==o?b=y=[y,h]:(yn=b,b=o),b===o&&(b=null),b!==o?f=d=[d,m,b]:(yn=f,f=o)):(yn=f,f=o),f===o&&(f=null),f!==o?(90===t.charCodeAt(yn)?(d="Z",yn++):(d=o,0===wn&&Tn(Wt)),d===o&&(d=yn,(m=Ui())!==o&&(b=ni())!==o?(58===t.charCodeAt(yn)?(y=":",yn++):(y=o,0===wn&&Tn(ze)),y!==o&&(h=$o())!==o?d=m=[m,b,y,h]:(yn=d,d=o)):(yn=d,d=o)),d!==o?e=r=[r,n,i,a,c,s,l,u,p,f,d]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(e=function(){var e,r,n,i,a,c,s,l,u,p;e=yn,(r=ni())!==o?(58===t.charCodeAt(yn)?(n=":",yn++):(n=o,0===wn&&Tn(ze)),n!==o&&(i=$o())!==o?(a=yn,58===t.charCodeAt(yn)?(c=":",yn++):(c=o,0===wn&&Tn(ze)),c!==o&&(s=$o())!==o?(l=yn,46===t.charCodeAt(yn)?(u=".",yn++):(u=o,0===wn&&Tn(v)),u!==o&&(p=ca())!==o?l=u=[u,p]:(yn=l,l=o),l===o&&(l=null),l!==o?a=c=[c,s,l]:(yn=a,a=o)):(yn=a,a=o),a===o&&(a=null),a!==o?e=r=[r,n,i,a]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(e=Xo())===o&&(e=Xo())===o&&(e=Xo())===o&&(e=function(){var e,t,r;e=yn,(t=Ui())===o&&(t=null);t!==o&&(r=oa())!==o?e=t=[t,r]:(yn=e,e=o);return e}())===o&&(e=oa())===o&&(e=function(){var e,t,r;e=yn,(t=Ui())===o&&(t=null);t!==o&&(r=ia())!==o?e=t=[t,r]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r;e=yn,(t=Ui())===o&&(t=null);t!==o&&(r=aa())!==o?e=t=[t,r]:(yn=e,e=o);return e}())===o&&(e=Qo())===o&&(e=function(){var e,r,n,i;if(e=yn,zi()!==o)if(Ni()!==o){for(r=yn,n=[],(i=Zo())===o&&(i=Xi());i!==o;)n.push(i),(i=Zo())===o&&(i=Xi());(r=n!==o?t.substring(r,yn):n)!==o&&(n=Ni())!==o&&(i=zi())!==o?(vn=e,e=r):(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;return e}())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"duration"===t.substr(yn,8)?(r="duration",yn+=8):(r=o,0===wn&&Tn(Ht));r===o&&(r=null);r!==o&&(n=zi())!==o&&(i=Ni())!==o&&(a=function(){var e,r,n,i,a,c,s,l,u,p,f,d,m,b;e=yn,(r=Ui())===o&&(r=null);if(r!==o)if(80===t.charCodeAt(yn)?(n="P",yn++):(n=o,0===wn&&Tn(Kt)),n!==o){if(i=yn,a=[],(c=$i())!==o)for(;c!==o;)a.push(c),c=$i();else a=o;if(a!==o?(68===t.charCodeAt(yn)?(c="D",yn++):(c=o,0===wn&&Tn(qt)),c!==o?i=a=[a,c]:(yn=i,i=o)):(yn=i,i=o),i===o&&(i=null),i!==o){if(a=yn,84===t.charCodeAt(yn)?(c="T",yn++):(c=o,0===wn&&Tn(Gt)),c!==o){if(s=yn,l=[],(u=$i())!==o)for(;u!==o;)l.push(u),u=$i();else l=o;if(l!==o?(72===t.charCodeAt(yn)?(u="H",yn++):(u=o,0===wn&&Tn(Yt)),u!==o?s=l=[l,u]:(yn=s,s=o)):(yn=s,s=o),s===o&&(s=null),s!==o){if(l=yn,u=[],(p=$i())!==o)for(;p!==o;)u.push(p),p=$i();else u=o;if(u!==o?(77===t.charCodeAt(yn)?(p="M",yn++):(p=o,0===wn&&Tn(jt)),p!==o?l=u=[u,p]:(yn=l,l=o)):(yn=l,l=o),l!==o){if(u=yn,p=[],(f=$i())!==o)for(;f!==o;)p.push(f),f=$i();else p=o;if(p!==o){if(f=yn,46===t.charCodeAt(yn)?(d=".",yn++):(d=o,0===wn&&Tn(v)),d!==o){if(m=[],(b=$i())!==o)for(;b!==o;)m.push(b),b=$i();else m=o;m!==o?f=d=[d,m]:(yn=f,f=o)}else yn=f,f=o;f===o&&(f=null),f!==o?(83===t.charCodeAt(yn)?(d="S",yn++):(d=o,0===wn&&Tn(Xt)),d!==o?u=p=[p,f,d]:(yn=u,u=o)):(yn=u,u=o)}else yn=u,u=o;u===o&&(u=null),u!==o?a=c=[c,s,l,u]:(yn=a,a=o)}else yn=a,a=o}else yn=a,a=o}else yn=a,a=o;a===o&&(a=null),a!==o?e=r=[r,n,i,a]:(yn=e,e=o)}else yn=e,e=o}else yn=e,e=o;else yn=e,e=o;return e}())!==o&&(c=Ni())!==o&&(s=zi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=oi())===o&&(e=function(){var e,r,n,i,a,c,s;e=yn,"binary"===t.substr(yn,6)?(r="binary",yn+=6):(r=o,0===wn&&Tn(Et));r!==o&&(n=zi())!==o&&(i=Ni())!==o&&(a=function(){var e,r,n;e=yn,r=[],n=ua();for(;n!==o;)r.push(n),n=ua();r!==o?((n=function(){var e,r,n,i;e=yn,(r=la())!==o?(65===t.charCodeAt(yn)?(n="A",yn++):(n=o,0===wn&&Tn(Ct)),n===o&&(69===t.charCodeAt(yn)?(n="E",yn++):(n=o,0===wn&&Tn(St)),n===o&&(73===t.charCodeAt(yn)?(n="I",yn++):(n=o,0===wn&&Tn(Pt)),n===o&&(77===t.charCodeAt(yn)?(n="M",yn++):(n=o,0===wn&&Tn(jt)),n===o&&(81===t.charCodeAt(yn)?(n="Q",yn++):(n=o,0===wn&&Tn(Tt)),n===o&&(85===t.charCodeAt(yn)?(n="U",yn++):(n=o,0===wn&&Tn(kt)),n===o&&(89===t.charCodeAt(yn)?(n="Y",yn++):(n=o,0===wn&&Tn(Rt)),n===o&&(99===t.charCodeAt(yn)?(n="c",yn++):(n=o,0===wn&&Tn(xt)),n===o&&(103===t.charCodeAt(yn)?(n="g",yn++):(n=o,0===wn&&Tn(Nt)),n===o&&(107===t.charCodeAt(yn)?(n="k",yn++):(n=o,0===wn&&Tn(_t)),n===o&&(111===t.charCodeAt(yn)?(n="o",yn++):(n=o,0===wn&&Tn(Dt)),n===o&&(115===t.charCodeAt(yn)?(n="s",yn++):(n=o,0===wn&&Tn(It)),n===o&&(119===t.charCodeAt(yn)?(n="w",yn++):(n=o,0===wn&&Tn(At)),n===o&&(48===t.charCodeAt(yn)?(n="0",yn++):(n=o,0===wn&&Tn(He)),n===o&&(52===t.charCodeAt(yn)?(n="4",yn++):(n=o,0===wn&&Tn(Ft)),n===o&&(56===t.charCodeAt(yn)?(n="8",yn++):(n=o,0===wn&&Tn(Lt))))))))))))))))),n!==o?(61===t.charCodeAt(yn)?(i="=",yn++):(i=o,0===wn&&Tn(Mt)),i===o&&(i=null),i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())===o&&(n=function(){var e,r,n,i;e=yn,(r=Yo())!==o?(65===t.charCodeAt(yn)?(n="A",yn++):(n=o,0===wn&&Tn(Ct)),n===o&&(81===t.charCodeAt(yn)?(n="Q",yn++):(n=o,0===wn&&Tn(Tt)),n===o&&(103===t.charCodeAt(yn)?(n="g",yn++):(n=o,0===wn&&Tn(Nt)),n===o&&(119===t.charCodeAt(yn)?(n="w",yn++):(n=o,0===wn&&Tn(At))))),n!==o?("=="===t.substr(yn,2)?(i="==",yn+=2):(i=o,0===wn&&Tn(Bt)),i===o&&(i=null),i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}()),n===o&&(n=null),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o);return e}())!==o&&(c=Ni())!==o&&(s=zi())!==o?e=r=[r,n,i,a,c,s]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=Ti())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=ai())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=Ti())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=li())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=Ti())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=fi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=Ti())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=mi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=Ti())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=yi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=Ti())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=hi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=Ti())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=Ci())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=ki())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=ai())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=ki())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=li())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=ki())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=fi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=ki())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=mi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=ki())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=yi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=ki())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=hi())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=function(){var e,t,r,n,i,a,c;e=yn,(t=ki())!==o&&(r=zi())!==o&&(n=Ni())!==o&&(i=Ci())!==o&&(a=Ni())!==o&&(c=zi())!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o);return e}())===o&&(e=Ri()),e}function Yo(){var e;return(e=Ji())===o&&(e=$i())===o&&(45===t.charCodeAt(yn)?(e="-",yn++):(e=o,0===wn&&Tn(ge)),e===o&&(95===t.charCodeAt(yn)?(e="_",yn++):(e=o,0===wn&&Tn(Xe)))),e}function Xo(){var e,r,n,i,a,c,s,l,u;if(e=yn,(r=Ui())===o&&(r=null),r!==o){if(n=[],(i=$i())!==o)for(;i!==o;)n.push(i),i=$i();else n=o;if(n!==o){if(i=yn,46===t.charCodeAt(yn)?(a=".",yn++):(a=o,0===wn&&Tn(v)),a!==o){if(c=[],(s=$i())!==o)for(;s!==o;)c.push(s),s=$i();else c=o;c!==o?i=a=[a,c]:(yn=i,i=o)}else yn=i,i=o;if(i===o&&(i=null),i!==o){if(a=yn,101===t.charCodeAt(yn)?(c="e",yn++):(c=o,0===wn&&Tn(Ke)),c!==o)if((s=Ui())===o&&(s=null),s!==o){if(l=[],(u=$i())!==o)for(;u!==o;)l.push(u),u=$i();else l=o;l!==o?a=c=[c,s,l]:(yn=a,a=o)}else yn=a,a=o;else yn=a,a=o;a===o&&(a=null),a!==o?(vn=e,e=r=Number(En())):(yn=e,e=o)}else yn=e,e=o}else yn=e,e=o}else yn=e,e=o;return e===o&&(e=yn,(r=function(){var e,r;e=yn,"NaN"===t.substr(yn,3)?(r="NaN",yn+=3):(r=o,0===wn&&Tn(Ut));r!==o&&(vn=e,r=NaN);(e=r)===o&&(e=yn,"-INF"===t.substr(yn,4)?(r="-INF",yn+=4):(r=o,0===wn&&Tn(Vt)),r!==o&&(vn=e,r=-1/0),(e=r)===o&&(e=yn,"INF"===t.substr(yn,3)?(r="INF",yn+=3):(r=o,0===wn&&Tn(zt)),r!==o&&(vn=e,r=1/0),e=r));return e}())!==o&&(vn=e,r=r),e=r),e}function Qo(){var e,t,r;return e=yn,(t=Ui())===o&&(t=null),t!==o&&(r=function(){var e,t,r,n,i,a,c,s,l,u,p;e=yn,(t=aa())!==o?((r=$i())===o&&(r=null),r!==o?((n=$i())===o&&(n=null),n!==o?((i=$i())===o&&(i=null),i!==o?((a=$i())===o&&(a=null),a!==o?((c=$i())===o&&(c=null),c!==o?((s=$i())===o&&(s=null),s!==o?((l=$i())===o&&(l=null),l!==o?((u=$i())===o&&(u=null),u!==o?((p=$i())===o&&(p=null),p!==o?e=t=[t,r,n,i,a,c,s,l,u,p]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o);return e}())!==o?e=t=[t,r]:(yn=e,e=o),e}function Zo(){var e;return e=yn,zi()!==o&&zi()!==o?(vn=e,e="'"):(yn=e,e=o),e}function Jo(){var e;return Qt.test(t.charAt(yn))?(e=t.charAt(yn),yn++):(e=o,0===wn&&Tn(Zt)),e}function $o(){var e,r,n;return e=yn,Jt.test(t.charAt(yn))?(r=t.charAt(yn),yn++):(r=o,0===wn&&Tn($t)),r!==o&&(n=$i())!==o?e=r=[r,n]:(yn=e,e=o),e}function ei(){var e,r,n,i,a,c,s;if(e=yn,45===t.charCodeAt(yn)?(r="-",yn++):(r=o,0===wn&&Tn(ge)),r===o&&(r=null),r!==o){if(n=yn,48===t.charCodeAt(yn)?(i="0",yn++):(i=o,0===wn&&Tn(He)),i!==o&&(a=na())!==o?n=i=[i,a]:(yn=n,n=o),n===o)if(n=yn,(i=Jo())!==o)if((a=na())!==o){for(c=[],s=$i();s!==o;)c.push(s),s=$i();c!==o?n=i=[i,a,c]:(yn=n,n=o)}else yn=n,n=o;else yn=n,n=o;n!==o?e=r=[r,n]:(yn=e,e=o)}else yn=e,e=o;return e}function ti(){var e,r,n;return e=yn,48===t.charCodeAt(yn)?(r="0",yn++):(r=o,0===wn&&Tn(He)),r!==o&&(n=Jo())!==o?e=r=[r,n]:(yn=e,e=o),e===o&&(e=yn,49===t.charCodeAt(yn)?(r="1",yn++):(r=o,0===wn&&Tn(er)),r!==o?(tr.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(rr)),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o)),e}function ri(){var e,r,n;return e=yn,48===t.charCodeAt(yn)?(r="0",yn++):(r=o,0===wn&&Tn(He)),r!==o&&(n=Jo())!==o?e=r=[r,n]:(yn=e,e=o),e===o&&(e=yn,nr.test(t.charAt(yn))?(r=t.charAt(yn),yn++):(r=o,0===wn&&Tn(or)),r!==o&&(n=$i())!==o?e=r=[r,n]:(yn=e,e=o),e===o&&(e=yn,51===t.charCodeAt(yn)?(r="3",yn++):(r=o,0===wn&&Tn(ir)),r!==o?(ar.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(cr)),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o))),e}function ni(){var e,r,n;return e=yn,ar.test(t.charAt(yn))?(r=t.charAt(yn),yn++):(r=o,0===wn&&Tn(cr)),r!==o&&(n=$i())!==o?e=r=[r,n]:(yn=e,e=o),e===o&&(e=yn,50===t.charCodeAt(yn)?(r="2",yn++):(r=o,0===wn&&Tn(sr)),r!==o?(lr.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(ur)),n!==o?e=r=[r,n]:(yn=e,e=o)):(yn=e,e=o)),e}function oi(){var e,t;return e=yn,(t=zo())===o&&(t=null),t!==o&&zi()!==o&&Ni()!==o&&function(){var e,t,r,n,i,a;if(e=yn,(t=ii())!==o){for(r=[],n=yn,(i=Mi())!==o&&(a=ii())!==o?n=i=[i,a]:(yn=n,n=o);n!==o;)r.push(n),n=yn,(i=Mi())!==o&&(a=ii())!==o?n=i=[i,a]:(yn=n,n=o);r!==o?(vn=e,e=t=t):(yn=e,e=o)}else yn=e,e=o;return e}()!==o&&Ni()!==o&&zi()!==o?(vn=e,e=t=t):(yn=e,e=o),e}function ii(){var e;return(e=Wo())===o&&(e=Qo()),e}function ai(){var e,t,r;return e=yn,(t=gi())!==o&&(r=ci())!==o?e=t=[t,r]:(yn=e,e=o),e}function ci(){var e,r,n,i,a,c,s;if(e=yn,"Collection("===t.substr(yn,11)?(r="Collection(",yn+=11):(r=o,0===wn&&Tn(pr)),r!==o)if((n=si())!==o){for(i=[],a=yn,(c=Mi())!==o&&(s=si())!==o?a=c=[c,s]:(yn=a,a=o);a!==o;)i.push(a),a=yn,(c=Mi())!==o&&(s=si())!==o?a=c=[c,s]:(yn=a,a=o);i!==o&&(a=Wi())!==o?e=r=[r,n,i,a]:(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;return e}function si(){var e;return(e=ci())===o&&(e=ui())===o&&(e=bi())===o&&(e=di())===o&&(e=vi())===o&&(e=Oi())===o&&(e=Si()),e}function li(){var e,t,r;return e=yn,(t=gi())!==o&&(r=ui())!==o?e=t=[t,r]:(yn=e,e=o),e}function ui(){var e,r,n;return e=yn,"LineString"===t.substr(yn,10)?(r="LineString",yn+=10):(r=o,0===wn&&Tn(yt)),r!==o&&(n=pi())!==o?e=r=[r,n]:(yn=e,e=o),e}function pi(){var e,t,r,n,i,a,c;if(e=yn,(t=Gi())!==o)if((r=wi())!==o){if(n=[],i=yn,(a=Mi())!==o&&(c=wi())!==o?i=a=[a,c]:(yn=i,i=o),i!==o)for(;i!==o;)n.push(i),i=yn,(a=Mi())!==o&&(c=wi())!==o?i=a=[a,c]:(yn=i,i=o);else n=o;n!==o&&(i=Wi())!==o?e=t=[t,r,n,i]:(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;return e}function fi(){var e,t,r;return e=yn,(t=gi())!==o&&(r=di())!==o?e=t=[t,r]:(yn=e,e=o),e}function di(){var e,r,n,i,a,c,s,l;if(e=yn,"MultiLineString("===t.substr(yn,16)?(r="MultiLineString(",yn+=16):(r=o,0===wn&&Tn(fr)),r!==o){if(n=yn,(i=pi())!==o){for(a=[],c=yn,(s=Mi())!==o&&(l=pi())!==o?c=s=[s,l]:(yn=c,c=o);c!==o;)a.push(c),c=yn,(s=Mi())!==o&&(l=pi())!==o?c=s=[s,l]:(yn=c,c=o);a!==o?n=i=[i,a]:(yn=n,n=o)}else yn=n,n=o;n===o&&(n=null),n!==o&&(i=Wi())!==o?e=r=[r,n,i]:(yn=e,e=o)}else yn=e,e=o;return e}function mi(){var e,t,r;return e=yn,(t=gi())!==o&&(r=bi())!==o?e=t=[t,r]:(yn=e,e=o),e}function bi(){var e,r,n,i,a,c,s,l;if(e=yn,"MultiPoint("===t.substr(yn,11)?(r="MultiPoint(",yn+=11):(r=o,0===wn&&Tn(dr)),r!==o){if(n=yn,(i=Ei())!==o){for(a=[],c=yn,(s=Mi())!==o&&(l=Ei())!==o?c=s=[s,l]:(yn=c,c=o);c!==o;)a.push(c),c=yn,(s=Mi())!==o&&(l=Ei())!==o?c=s=[s,l]:(yn=c,c=o);a!==o?n=i=[i,a]:(yn=n,n=o)}else yn=n,n=o;n===o&&(n=null),n!==o&&(i=Wi())!==o?e=r=[r,n,i]:(yn=e,e=o)}else yn=e,e=o;return e}function yi(){var e,t,r;return e=yn,(t=gi())!==o&&(r=vi())!==o?e=t=[t,r]:(yn=e,e=o),e}function vi(){var e,r,n,i,a,c,s,l;if(e=yn,"MultiPolygon("===t.substr(yn,13)?(r="MultiPolygon(",yn+=13):(r=o,0===wn&&Tn(mr)),r!==o){if(n=yn,(i=Pi())!==o){for(a=[],c=yn,(s=Mi())!==o&&(l=Pi())!==o?c=s=[s,l]:(yn=c,c=o);c!==o;)a.push(c),c=yn,(s=Mi())!==o&&(l=Pi())!==o?c=s=[s,l]:(yn=c,c=o);a!==o?n=i=[i,a]:(yn=n,n=o)}else yn=n,n=o;n===o&&(n=null),n!==o&&(i=Wi())!==o?e=r=[r,n,i]:(yn=e,e=o)}else yn=e,e=o;return e}function hi(){var e,t,r;return e=yn,(t=gi())!==o&&(r=Oi())!==o?e=t=[t,r]:(yn=e,e=o),e}function gi(){var e,r,n,i,a;return e=yn,"SRID"===t.substr(yn,4)?(r="SRID",yn+=4):(r=o,0===wn&&Tn(br)),r!==o&&(n=Bi())!==o&&(i=ia())!==o&&(a=Vi())!==o?e=r=[r,n,i,a]:(yn=e,e=o),e}function Oi(){var e,r,n;return e=yn,"Point"===t.substr(yn,5)?(r="Point",yn+=5):(r=o,0===wn&&Tn(Ot)),r!==o&&(n=Ei())!==o?e=r=[r,n]:(yn=e,e=o),e}function wi(){var e,t,r,n;return e=yn,(t=Xo())!==o&&(r=ta())!==o&&(n=Xo())!==o?e=t=[t,r,n]:(yn=e,e=o),e}function Ei(){var e,t,r,n;return e=yn,(t=Gi())!==o&&(r=wi())!==o&&(n=Wi())!==o?e=t=[t,r,n]:(yn=e,e=o),e}function Ci(){var e,t,r;return e=yn,(t=gi())!==o&&(r=Si())!==o?e=t=[t,r]:(yn=e,e=o),e}function Si(){var e,r,n;return e=yn,"Polygon"===t.substr(yn,7)?(r="Polygon",yn+=7):(r=o,0===wn&&Tn(wt)),r!==o&&(n=Pi())!==o?e=r=[r,n]:(yn=e,e=o),e}function Pi(){var e,t,r,n,i,a,c;if(e=yn,(t=Gi())!==o)if((r=ji())!==o){for(n=[],i=yn,(a=Mi())!==o&&(c=ji())!==o?i=a=[a,c]:(yn=i,i=o);i!==o;)n.push(i),i=yn,(a=Mi())!==o&&(c=ji())!==o?i=a=[a,c]:(yn=i,i=o);n!==o&&(i=Wi())!==o?e=t=[t,r,n,i]:(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;return e}function ji(){var e,t,r,n,i,a,c;if(e=yn,(t=Gi())!==o)if((r=wi())!==o){for(n=[],i=yn,(a=Mi())!==o&&(c=wi())!==o?i=a=[a,c]:(yn=i,i=o);i!==o;)n.push(i),i=yn,(a=Mi())!==o&&(c=wi())!==o?i=a=[a,c]:(yn=i,i=o);n!==o&&(i=Wi())!==o?e=t=[t,r,n,i]:(yn=e,e=o)}else yn=e,e=o;else yn=e,e=o;return e}function Ti(){var e;return"geography"===t.substr(yn,9)?(e="geography",yn+=9):(e=o,0===wn&&Tn(yr)),e}function ki(){var e;return"geometry"===t.substr(yn,8)?(e="geometry",yn+=8):(e=o,0===wn&&Tn(vr)),e}function Ri(){var e,r,n,i;if(e=yn,(r=function(){var e;123===t.charCodeAt(yn)?(e="{",yn++):(e=o,0===wn&&Tn(Ce));e===o&&("%7B"===t.substr(yn,3)?(e="%7B",yn+=3):(e=o,0===wn&&Tn(Se)));return e}())!==o){for(n=[],hr.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(gr));i!==o;)n.push(i),hr.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(gr));n!==o&&(i=function(){var e;125===t.charCodeAt(yn)?(e="}",yn++):(e=o,0===wn&&Tn(Pe));e===o&&("%7D"===t.substr(yn,3)?(e="%7D",yn+=3):(e=o,0===wn&&Tn(je)));return e}())!==o?e=r=[r,n,i]:(yn=e,e=o)}else yn=e,e=o;return e}function xi(){var e,r;if(e=[],(r=ta())===o&&(r=ra())===o&&("%20"===t.substr(yn,3)?(r="%20",yn+=3):(r=o,0===wn&&Tn(Or)),r===o&&("%09"===t.substr(yn,3)?(r="%09",yn+=3):(r=o,0===wn&&Tn(wr)))),r!==o)for(;r!==o;)e.push(r),(r=ta())===o&&(r=ra())===o&&("%20"===t.substr(yn,3)?(r="%20",yn+=3):(r=o,0===wn&&Tn(Or)),r===o&&("%09"===t.substr(yn,3)?(r="%09",yn+=3):(r=o,0===wn&&Tn(wr))));else e=o;return e}function Ni(){var e,r;for(e=[],(r=ta())===o&&(r=ra())===o&&("%20"===t.substr(yn,3)?(r="%20",yn+=3):(r=o,0===wn&&Tn(Or)),r===o&&("%09"===t.substr(yn,3)?(r="%09",yn+=3):(r=o,0===wn&&Tn(wr))));r!==o;)e.push(r),(r=ta())===o&&(r=ra())===o&&("%20"===t.substr(yn,3)?(r="%20",yn+=3):(r=o,0===wn&&Tn(Or)),r===o&&("%09"===t.substr(yn,3)?(r="%09",yn+=3):(r=o,0===wn&&Tn(wr))));return e}function _i(){var e;return(e=ta())===o&&(e=ra())===o&&("%20"===t.substr(yn,3)?(e="%20",yn+=3):(e=o,0===wn&&Tn(Or)),e===o&&("%09"===t.substr(yn,3)?(e="%09",yn+=3):(e=o,0===wn&&Tn(wr)))),e}function Di(){var e,t,r;return e=yn,(t=_i())!==o&&(r=_i())!==o?e=t=[t,r]:(yn=e,e=o),e}function Ii(){var e,t,r;return e=yn,(t=_i())!==o&&(r=Di())!==o?e=t=[t,r]:(yn=e,e=o),e}function Ai(){var e,t,r;return e=yn,(t=Di())!==o&&(r=Ii())!==o?e=t=[t,r]:(yn=e,e=o),e}function Fi(){var e;return 64===t.charCodeAt(yn)?(e="@",yn++):(e=o,0===wn&&Tn(Er)),e===o&&("%40"===t.substr(yn,3)?(e="%40",yn+=3):(e=o,0===wn&&Tn(Cr))),e}function Li(){var e;return 58===t.charCodeAt(yn)?(e=":",yn++):(e=o,0===wn&&Tn(ze)),e===o&&("%3A"===t.substr(yn,3)?(e="%3A",yn+=3):(e=o,0===wn&&Tn(Sr))),e}function Mi(){var e;return 44===t.charCodeAt(yn)?(e=",",yn++):(e=o,0===wn&&Tn(Pr)),e===o&&("%2C"===t.substr(yn,3)?(e="%2C",yn+=3):(e=o,0===wn&&Tn(jr))),e}function Bi(){var e;return 61===t.charCodeAt(yn)?(e="=",yn++):(e=o,0===wn&&Tn(Mt)),e}function Ui(){var e;return 43===t.charCodeAt(yn)?(e="+",yn++):(e=o,0===wn&&Tn(qe)),e===o&&("%2B"===t.substr(yn,3)?(e="%2B",yn+=3):(e=o,0===wn&&Tn(Tr)),e===o&&(45===t.charCodeAt(yn)?(e="-",yn++):(e=o,0===wn&&Tn(ge)))),e}function Vi(){var e;return 59===t.charCodeAt(yn)?(e=";",yn++):(e=o,0===wn&&Tn(kr)),e===o&&("%3B"===t.substr(yn,3)?(e="%3B",yn+=3):(e=o,0===wn&&Tn(Rr))),e}function zi(){var e;return 39===t.charCodeAt(yn)?(e="'",yn++):(e=o,0===wn&&Tn(xr)),e===o&&("%27"===t.substr(yn,3)?(e="%27",yn+=3):(e=o,0===wn&&Tn(Nr))),e}function Gi(){var e;return 40===t.charCodeAt(yn)?(e="(",yn++):(e=o,0===wn&&Tn(_r)),e===o&&("%28"===t.substr(yn,3)?(e="%28",yn+=3):(e=o,0===wn&&Tn(Dr))),e}function Wi(){var e;return 41===t.charCodeAt(yn)?(e=")",yn++):(e=o,0===wn&&Tn(Ir)),e===o&&("%29"===t.substr(yn,3)?(e="%29",yn+=3):(e=o,0===wn&&Tn(Ar))),e}function Hi(){var e;return(e=qi())===o&&(e=Ki())===o&&(e=function(){var e;36===t.charCodeAt(yn)?(e="$",yn++):(e=o,0===wn&&Tn(Mr));e===o&&(38===t.charCodeAt(yn)?(e="&",yn++):(e=o,0===wn&&Tn(Br)),e===o&&(39===t.charCodeAt(yn)?(e="'",yn++):(e=o,0===wn&&Tn(xr)),e===o&&(61===t.charCodeAt(yn)?(e="=",yn++):(e=o,0===wn&&Tn(Mt)),e===o&&(e=Yi()))));return e}())===o&&(58===t.charCodeAt(yn)?(e=":",yn++):(e=o,0===wn&&Tn(ze)),e===o&&(64===t.charCodeAt(yn)?(e="@",yn++):(e=o,0===wn&&Tn(Er)))),e}function Ki(){var e,r,n,i;return e=yn,37===t.charCodeAt(yn)?(r="%",yn++):(r=o,0===wn&&Tn(Fr)),r!==o&&(n=ea())!==o&&(i=ea())!==o?e=r=[r,n,i]:(yn=e,e=o),e}function qi(){var e;return(e=Ji())===o&&(e=$i())===o&&(45===t.charCodeAt(yn)?(e="-",yn++):(e=o,0===wn&&Tn(ge)),e===o&&(46===t.charCodeAt(yn)?(e=".",yn++):(e=o,0===wn&&Tn(v)),e===o&&(95===t.charCodeAt(yn)?(e="_",yn++):(e=o,0===wn&&Tn(Xe)),e===o&&(126===t.charCodeAt(yn)?(e="~",yn++):(e=o,0===wn&&Tn(Lr)))))),e}function Yi(){var e;return 33===t.charCodeAt(yn)?(e="!",yn++):(e=o,0===wn&&Tn(Ur)),e===o&&(40===t.charCodeAt(yn)?(e="(",yn++):(e=o,0===wn&&Tn(_r)),e===o&&(41===t.charCodeAt(yn)?(e=")",yn++):(e=o,0===wn&&Tn(Ir)),e===o&&(42===t.charCodeAt(yn)?(e="*",yn++):(e=o,0===wn&&Tn(Vr)),e===o&&(43===t.charCodeAt(yn)?(e="+",yn++):(e=o,0===wn&&Tn(qe)),e===o&&(44===t.charCodeAt(yn)?(e=",",yn++):(e=o,0===wn&&Tn(Pr)),e===o&&(59===t.charCodeAt(yn)?(e=";",yn++):(e=o,0===wn&&Tn(kr)))))))),e}function Xi(){var e;return(e=qi())===o&&(e=function(){var e,r,n,i;e=yn,37===t.charCodeAt(yn)?(r="%",yn++):(r=o,0===wn&&Tn(Fr));r!==o?(ar.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(cr)),n===o&&(zr.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(Gr)),n===o&&(Wr.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(Hr)))),n!==o&&(i=ea())!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o);e===o&&(e=yn,37===t.charCodeAt(yn)?(r="%",yn++):(r=o,0===wn&&Tn(Fr)),r!==o?(50===t.charCodeAt(yn)?(n="2",yn++):(n=o,0===wn&&Tn(sr)),n!==o?(Kr.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(qr)),i===o&&(Yr.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(Xr)),i===o&&(Wr.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(Hr)))),i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o));return e}())===o&&(e=Yi())===o&&(36===t.charCodeAt(yn)?(e="$",yn++):(e=o,0===wn&&Tn(Mr)),e===o&&(38===t.charCodeAt(yn)?(e="&",yn++):(e=o,0===wn&&Tn(Br)),e===o&&(61===t.charCodeAt(yn)?(e="=",yn++):(e=o,0===wn&&Tn(Mt)),e===o&&(58===t.charCodeAt(yn)?(e=":",yn++):(e=o,0===wn&&Tn(ze)),e===o&&(64===t.charCodeAt(yn)?(e="@",yn++):(e=o,0===wn&&Tn(Er)),e===o&&(e=_i())===o&&(e=Di())===o&&(e=Ii())===o&&(e=Ai())===o&&(e=function(){var e,t,r;return e=yn,(t=_i())!==o&&(r=Ai())!==o?e=t=[t,r]:(yn=e,e=o),e}())===o&&(e=Ri())))))),e}function Qi(){var e;return(e=qi())===o&&(e=function(){var e,r,n,i;e=yn,37===t.charCodeAt(yn)?(r="%",yn++):(r=o,0===wn&&Tn(Fr));r!==o?(ar.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(cr)),n===o&&(Zr.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(Jr)),n===o&&($r.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(en)),n===o&&(Wr.test(t.charAt(yn))?(n=t.charAt(yn),yn++):(n=o,0===wn&&Tn(Hr))))),n!==o&&(i=ea())!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o);e===o&&(e=yn,37===t.charCodeAt(yn)?(r="%",yn++):(r=o,0===wn&&Tn(Fr)),r!==o?(50===t.charCodeAt(yn)?(n="2",yn++):(n=o,0===wn&&Tn(sr)),n!==o?(ar.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(cr)),i===o&&(zr.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(Gr)),i===o&&(Wr.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(Hr)))),i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e===o&&(e=yn,37===t.charCodeAt(yn)?(r="%",yn++):(r=o,0===wn&&Tn(Fr)),r!==o?(53===t.charCodeAt(yn)?(n="5",yn++):(n=o,0===wn&&Tn(tn)),n!==o?((i=$i())===o&&(rn.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(nn)),i===o&&(on.test(t.charAt(yn))?(i=t.charAt(yn),yn++):(i=o,0===wn&&Tn(an)))),i!==o?e=r=[r,n,i]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)));return e}())===o&&(e=Yi())===o&&(58===t.charCodeAt(yn)?(e=":",yn++):(e=o,0===wn&&Tn(ze)),e===o&&(64===t.charCodeAt(yn)?(e="@",yn++):(e=o,0===wn&&Tn(Er)),e===o&&(47===t.charCodeAt(yn)?(e="/",yn++):(e=o,0===wn&&Tn(c)),e===o&&(63===t.charCodeAt(yn)?(e="?",yn++):(e=o,0===wn&&Tn(Qr)),e===o&&(36===t.charCodeAt(yn)?(e="$",yn++):(e=o,0===wn&&Tn(Mr)),e===o&&(39===t.charCodeAt(yn)?(e="'",yn++):(e=o,0===wn&&Tn(xr)),e===o&&(61===t.charCodeAt(yn)?(e="=",yn++):(e=o,0===wn&&Tn(Mt))))))))),e}function Zi(){var e,t,r;return(e=Qi())===o&&(e=yn,(t=Lo())!==o?((r=Lo())===o&&(r=_o()),r!==o?e=t=[t,r]:(yn=e,e=o)):(yn=e,e=o)),e}function Ji(){var e;return cn.test(t.charAt(yn))?(e=t.charAt(yn),yn++):(e=o,0===wn&&Tn(sn)),e===o&&(ln.test(t.charAt(yn))?(e=t.charAt(yn),yn++):(e=o,0===wn&&Tn(un))),e}function $i(){var e;return pn.test(t.charAt(yn))?(e=t.charAt(yn),yn++):(e=o,0===wn&&Tn(fn)),e}function ea(){var e;return(e=$i())===o&&(Wr.test(t.charAt(yn))?(e=t.charAt(yn),yn++):(e=o,0===wn&&Tn(Hr))),e}function ta(){var e;return 32===t.charCodeAt(yn)?(e=" ",yn++):(e=o,0===wn&&Tn(mn)),e}function ra(){var e;return 9===t.charCodeAt(yn)?(e="\t",yn++):(e=o,0===wn&&Tn(bn)),e}function na(){var e,t,r,n;return e=yn,(t=$i())!==o&&(r=$i())!==o&&(n=$i())!==o?e=t=[t,r,n]:(yn=e,e=o),e}function oa(){var e,t,r,n;return e=yn,(t=$i())!==o?((r=$i())===o&&(r=null),r!==o?((n=$i())===o&&(n=null),n!==o?e=t=[t,r,n]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function ia(){var e,t,r,n;return e=yn,(t=oa())!==o?((r=$i())===o&&(r=null),r!==o?((n=$i())===o&&(n=null),n!==o?e=t=[t,r,n]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function aa(){var e,t,r,n,i,a,c;return e=yn,(t=ia())!==o?((r=$i())===o&&(r=null),r!==o?((n=$i())===o&&(n=null),n!==o?((i=$i())===o&&(i=null),i!==o?((a=$i())===o&&(a=null),a!==o?((c=$i())===o&&(c=null),c!==o?e=t=[t,r,n,i,a,c]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function ca(){var e,t,r,n;return e=yn,(t=aa())!==o?((r=$i())===o&&(r=null),r!==o?((n=$i())===o&&(n=null),n!==o?e=t=[t,r,n]:(yn=e,e=o)):(yn=e,e=o)):(yn=e,e=o),e}function sa(){var e,t,r,n,i;return e=yn,(t=ea())!==o&&(r=ea())!==o&&(n=ea())!==o&&(i=ea())!==o?e=t=[t,r,n,i]:(yn=e,e=o),e}function la(){var e,t,r;return e=yn,(t=Yo())!==o&&(r=Yo())!==o?e=t=[t,r]:(yn=e,e=o),e}function ua(){var e,t,r;return e=yn,(t=la())!==o&&(r=la())!==o?e=t=[t,r]:(yn=e,e=o),e}function pa(){var e;return(e=function(){var e;(e=Mn())===o&&(e=Bn());return e}())===o&&(e=so())===o&&(e=co())===o&&(e=function(){var e;(e=Zn())===o&&(e=Jn())===o&&(e=Yn());return e}()),e}function fa(){var e;return(e=function(){var e;return(e=qo())===o&&(e=Oo())===o&&(e=Ln())===o&&(e=eo()),e}())===o&&(e=$n())===o&&(e=pa())===o&&(e=function(){var e;return(e=yo())===o&&(e=vo())===o&&(e=go()),e}())===o&&(e=function(){var e;return(e=po())===o&&(e=fo())===o&&(e=mo())===o&&(e=bo()),e}())===o&&(e=function(){var e;return(e=lo())===o&&(e=uo()),e}())===o&&(e=function(){var e;return(e=io())===o&&(e=ao())===o&&(e=no())===o&&(e=oo())===o&&(e=ho()),e}()),e}function da(e,t){if(t){var r=t.and?"and":"or",n=[e].concat(ya(t[r]));return ba({},r,n.reduce((function(e,t){return e.concat(t[r]?t[r]:t)}),[]))}return e}function ma(e,t){return Array.isArray(e)?"".concat(e.join("/")," ").concat(t):{property:t}}function ba(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ya(e){return function(e){if(Array.isArray(e))return va(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return va(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return va(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function va(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}if((n=a())!==o&&yn===t.length)return n;throw n!==o&&yn<t.length&&Tn({type:"end"}),kn(On,gn<t.length?t.charAt(gn):null,gn<t.length?jn(gn,gn+1):jn(gn,gn))}}}()},20585:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r(11766),o=r(20499),i=r(20586),a=r(20589),c=r(12831),s=r(20496),l=r(20494),u=r(12706),p=r(20592),f=r(20491),d=r(20493),m=r(19713);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=C(e);if(t){var o=C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(g,e);var t,r,b,v=w(g);function g(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=v.call(this,e)).getClassNames=Object(u.a)(),t.classNames=t.getClassNames(p.a),t._ref=n.createRef(),t.templateModel=void 0,t._editorContext=Object(m.a)(),t.renderOperatorRow=e=>n.createElement(i.a,{operatorState:e.expression.state,editorContext:t.props.editorContext,showTokenPicker:t.props.showTokenPicker,readonly:t.props.readOnly}),t.onBlur=e=>{t.props.onChange({value:Object(l.d)(t.state.internalExpression)})},t.onExpressionChange=e=>{e&&(Object(l.a)(t.state.internalExpression,e)&&t.props.onChange({value:Object(l.d)(e)}),t.setState({internalExpression:Object(l.h)(e,t.templateModel)}))},t.onSwitchEditorClick=()=>{t.props.onSwitchEditor(Object(l.d)(t.state.internalExpression))},t.templateModel=new a.a(t.renderOperatorRow,Object(s.h)(t._editorContext.designerResources)),t.state={internalExpression:t.createExpression()},t}return t=g,(r=[{key:"render",value:function(){var e=this.getCustomizationOptions();return n.createElement(c.a,{className:this.classNames.root},n.createElement(f.a,{onSwitchEditorClick:this.onSwitchEditorClick,disabled:!1,editorMode:d.a.Basic}),n.createElement("div",{ref:this._ref,onBlur:this.onBlur},n.createElement(o.b,{customizations:e,expression:this.state.internalExpression,environment:this.templateModel,resources:Object(s.h)(this._editorContext.designerResources),onChange:this.onExpressionChange})))}},{key:"focus",value:function(){this._ref.current&&this._ref.current.focus()}},{key:"scrollIntoView",value:function(){this._ref.current&&this._ref.current.scrollIntoView()}},{key:"createExpression",value:function(){return Object(l.c)(this._editorContext.designerResources,this.props.value,this.templateModel)}},{key:"getCustomizationOptions",value:function(){return y(y(y({},this.props.readOnly?{isReadonly:!0,hideAddControl:!0}:{}),Object(l.e)(this.state.internalExpression)?{hideGroupTemplateSelector:!0,hideGroupContextMenu:!0,hideGroupSelectorCheckbox:!0,hideRowContextMenu:!0,hideRowSelectorCheckbox:!0,hideTreeLines:!0}:{}),{enableRootGroupTemplateSelector:!0})}}])&&h(t.prototype,r),b&&h(t,b),Object.defineProperty(t,"prototype",{writable:!1}),g}(n.Component)},20586:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(11766),o=r(20497),i=r(20313),a=r(17371),c=r(20326),s=r(20494),l=r(12706),u=r(20587),p=r(20470),f=r(20588),d=r(19713),m=r(20323);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(w,e);var t,r,v,O=g(w);function w(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),(n=O.call(this,e)).getClassNames=Object(l.a)(),n.classNames=n.getClassNames(u.a),n._editorContext=Object(d.a)(),n.onleftValueSegmentsChange=e=>{var t,r,{value:o}=e;o[0]&&o[0].token&&o[0].tokenExpression&&(o[0]=Object(i.f)(o[0].tokenExpression)),n.setState({column:o[0]&&o[0].tokenExpression?o[0].tokenExpression:null!==(t=null===(r=n.props.operatorState.getLeft()[0])||void 0===r?void 0:r.tokenExpression)&&void 0!==t?t:""},()=>n.props.operatorState.setLeft(o))},n.onrightValueSegmentsChange=e=>{var{value:t}=e;n.props.operatorState.setRight(t)},n.onDropdownChange=(e,t)=>{t&&n.setState({operator:t.key},()=>n.props.operatorState.setOperator(Object(s.b)(t)))},n.onFocusValue=e=>{n.setState({isValueFocused:n.props.showTokenPicker})},n.onBlurValue=e=>{n.setState({isValueFocused:!1})},n.state={column:n.isLeftTokenExpressionDefined()&&null!==(t=n.props.operatorState.getLeft()[0].tokenExpression)&&void 0!==t?t:"",operator:null!==(r=n.props.operatorState.getOperator().tokenExpression)&&void 0!==r?r:"",isValueFocused:!1},n}return t=w,(r=[{key:"componentDidUpdate",value:function(){var e,t=this.isLeftTokenExpressionDefined()?this.props.operatorState.getLeft()[0].tokenExpression:"";t!==this.state.column&&this.setState({column:null!=t?t:"",operator:null!==(e=this.props.operatorState.getOperator().tokenExpression)&&void 0!==e?e:""})}},{key:"render",value:function(){return n.createElement(o.Controls.Line,{className:this.classNames.root},this.renderName(),this.renderRelationship(),this.renderValue())}},{key:"renderName",value:function(){var e={dropdownProps:{enforceMinimumCalloutWidth:!0},editorState:{value:this.props.operatorState.getLeft()},editorOptions:{displayName:"Column name",hideLabel:!0,showTokenPicker:!1,readonly:this.props.readonly,validationErrors:[],schema:{},dynamicData:{values:this.columnDropdownOptions,refresh:()=>{},status:void 0}},editorContext:this.props.editorContext,onChange:this.onleftValueSegmentsChange};return n.createElement("div",{className:this.classNames.leftEditor},n.createElement(p.a,e))}},{key:"renderRelationship",value:function(){return n.createElement(a.a,{className:this.classNames.middleEditor,placeholder:this._editorContext.designerResources.Designer.Editors.OFilter.DropdownOption.eq,options:this.options,onChange:this.onDropdownChange,selectedKey:this.state.operator,disabled:this.isColumnEmpty()||this.props.readonly})}},{key:"renderValue",value:function(){var e={editorState:{value:this.props.operatorState.getRight()},editorOptions:{displayName:"Value",locale:null,hideLabel:!0,showTokenPicker:this.props.showTokenPicker&&this.state.isValueFocused,readonly:this.isColumnEmpty()||this.props.readonly,validationErrors:[],summary:this._editorContext.designerResources.Designer.Editors.OFilter.ValueSummary},editorContext:this.props.editorContext,onChange:this.onrightValueSegmentsChange};return n.createElement(m.a,b({},e,{className:this.classNames.rightEditor,onRenderEditor:()=>n.createElement(c.a,b({onFocus:this.onFocusValue,onBlur:this.onBlurValue,className:this.classNames.rightEditorInner},e))}))}},{key:"options",get:function(){var e,t=this.props.operatorState.getLeft()[0]&&null!==(e=this.props.operatorState.getLeft()[0].tokenExpression)&&void 0!==e?e:"";return f.d.getOperatorDropdownOptions(t)}},{key:"isColumnEmpty",value:function(){return""===this.state.column&&Object(i.k)(this.props.operatorState.getLeft())}},{key:"isLeftTokenExpressionDefined",value:function(){return!!(this.props.operatorState.getLeft()&&this.props.operatorState.getLeft()[0]&&this.props.operatorState.getLeft()[0].tokenExpression)}},{key:"columnDropdownOptions",get:function(){return f.d.getColumnDropdownOptions()}}])&&y(t.prototype,r),v&&y(t,v),Object.defineProperty(t,"prototype",{writable:!1}),w}(n.Component)},20587:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["fl-operatorRow"],leftEditor:["fl-operatorRow-columnDefaultEditor",{minWidth:124,width:124,height:34,borderRadius:"2px",".msla-text-editor .public-DraftStyleDefault-block":{margin:"2px"}}],middleEditor:["fl-operatorRow-operatorDropdown",{flex:"0 1 ".concat(124,"px"),minWidth:124,width:124,height:34,borderRadius:"2px",padding:"0 0 0 8px"}],rightEditor:["fl-operatorRow-valueDefaultEditor",{flex:"1 0 ".concat(60,"px"),width:0,"> .msla-input-parameter-content-wrapper":{padding:"0px !important"}}],rightEditorInner:["fl-operatorRow-valueDefaultEditorContent",{borderRadius:"2px",minHeight:32,minWidth:60,paddingLeft:"8px",".msla-text-editor":{lineHeight:"200%",minHeight:"100%",".public-DraftStyleDefault-block":{margin:"0 0 1px"}}}]})},20588:function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return u}));var n=r(20496),o=r(19713);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canUseODataTable=()=>!!Object(o.a)(),this.columnOperators={},this.columnDropdownOptions=[],this.currentTable=void 0}var t,r,a;return t=e,(r=[{key:"getColumnDropdownOptions",value:function(){return this.columnDropdownOptions}},{key:"getOperatorDropdownOptions",value:function(e){return this.columnOperators[e]?this.columnOperators[e]:this.getDefaultOperatorDropdownOptions()}},{key:"processSchemaData",value:function(e,t,r,n){this.canUseODataTable()&&e&&t&&(!this.currentTable||e!==this.currentTable)&&(this.currentTable=e,this.createColumnDropdownOptions(t,r,n))}},{key:"getDefaultOperatorDropdownOptions",value:function(){return this.canUseODataTable()?Object.keys(n.d).map(e=>({key:e,text:Object(o.a)().designerResources.Designer.Editors.OFilter.DropdownOption[n.d[e]]})):[]}},{key:"createColumnDropdownOptions",value:function(e,t,r){for(var n in this.columnDropdownOptions=[],this.columnOperators={},e)if(e[n]["x-ms-capabilities"]&&"object"!==e[n].type){this.columnDropdownOptions.push({value:n,displayName:e[n].title});var o=e[n]["x-ms-capabilities"].filterFunctions;this.columnOperators[n]=this.createOperatorDropdownOptions(o,t,r)}else s(t,r)&&(this.columnOperators[n]=this.getDefaultDataverseOperatorDropdownOptions())}},{key:"createOperatorDropdownOptions",value:function(e,t,r){return e.reduce((e,n)=>{var i=this.getAllDropdownOptions(t,r);return i[n]&&e.push({key:n,text:Object(o.a)().designerResources.Designer.Editors.OFilter.DropdownOption[i[n]]}),e},[])}},{key:"getDefaultDataverseOperatorDropdownOptions",value:function(){return Object.keys(n.c).map(e=>({key:e,text:Object(o.a)().designerResources.Designer.Editors.OFilter.DropdownOption[n.c[e]]}))}},{key:"getAllDropdownOptions",value:function(e,t){return s(e,t)?n.a:n.b}}])&&i(t.prototype,r),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}());function s(e,t){return l(e)&&("ListRecords"===t||"SubscribeWebhookTrigger"===t)}function l(e){return e.includes("shared_commondataserviceforapps")}function u(e,t,r,n){var o=e.table?e.table:null;c.processSchemaData(o,t.properties,r,n)}},20589:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(20590),o=r(20591);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onRenderOperator=t,this.rowTemplates=void 0,this.groupTemplates=void 0,this.operator=void 0,this.and=void 0,this.or=void 0,this.placeholder=void 0,this.operator=new n.a(this.onRenderOperator),this.rowTemplates=[this.operator],this.and=new o.a(r.EXPRESSION_CONTROL_GROUP_CONDITION_AND,o.b.AND,o.b.AND),this.or=new o.a(r.EXPRESSION_CONTROL_GROUP_CONDITION_OR,o.b.OR,o.b.OR),this.placeholder=new o.a(r.EXPRESSION_CONTROL_GROUP_CONDITION_PLACEHOLDER,o.b.PLACEHOLDER,o.b.PLACEHOLDER),this.groupTemplates=[this.and,this.or]}var t,r,a;return t=e,(r=[{key:"defaultRow",value:function(){return this.rowTemplates[0]}},{key:"defaultGroup",value:function(){return this.groupTemplates[0]}}])&&i(t.prototype,r),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20590:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(13223),o=r(20313),i=r(20495);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onRenderOperator=t,this.label={name:"Expression",iconProps:{iconName:"Variable"}},this.key="operator"}var t,r,c;return t=e,(r=[{key:"render",value:function(e){return this.onRenderOperator(e)}},{key:"applicableType",value:function(){return!0}},{key:"prettyString",value:function(e){return"".concat(e.state.getLeft()," ").concat(e.state.getOperator()," ").concat(e.state.getRight())}},{key:"defaultExpression",value:function(){return{template:this,state:new i.a(Object(n.a)(),{name:[Object(o.f)("")],relationship:Object(o.f)(""),value:[Object(o.f)("")]})}}}])&&a(t.prototype,r),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20591:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c}));var n=r(20590);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a={AND:"and",OR:"or",PLACEHOLDER:"placeholder"},c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.key=r,this.operator=n,this.MAX_GROUP_DEPTH=3,this.MAX_GROUP_SUBEXPRESSIONS=10,this.label={name:this.name}}var t,r,i;return t=e,(r=[{key:"prettyString",value:function(){return""}},{key:"canDeleteExpression",value:function(e,t){return e>1||t.subexpressions.length>1}},{key:"applicableType",value:function(){return!0}},{key:"canAddGroup",value:function(e,t){return e<this.MAX_GROUP_DEPTH}},{key:"canAddRow",value:function(e,t){return t.subexpressions.length<this.MAX_GROUP_SUBEXPRESSIONS}},{key:"rowAllowed",value:function(t){return t instanceof e||t instanceof n.a}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20592:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{root:["fl-BasicOdataFilterEditor",{".fl-operatorRow":{flex:1},".eb-TreeLineGutter, .eb-TreeLineGutter-Hook, .eb-TreeLineBracket-Hook":{borderColor:"".concat(e.themePrimary," !important")},".eb-TreeLineGutter-HookContainer + div":{width:"100%"},".eb-GroupExpressionView-Rows":{paddingLeft:"30px !important"},".eb-GroupExpressionView":{flex:1,":not(.eb-GroupExpressionView-RootExpression)":{padding:"10px !important"},".eb-GroupExpressionView-Collapsed > :first-child":{flex:1}},".eb-GroupExpressionView-RootExpression":{flex:1,".eb-RowExpressionView-Container":{marginLeft:"0px !important",paddingRight:"0px !important"},".msla-input-parameter-content-wrapper":{padding:"0px !important"},"> div:not([class]) > div:not([class])":{flex:1}},".eb-GroupExpressionView-TemplateSelector":{},".eb-RowExpressionView-Container":{alignItems:"center",marginLeft:"0px !important",marginTop:"0px !important",paddingLeft:"0px !important",paddingBottom:"0px !important",width:"auto !important",background:"transparent !important"},".eb-RowExpressionView-SelectorCheckbox, .eb-GroupExpressionView-SelectorCheckbox":{alignItems:"center",margin:"0 2px 0 0"}}]}}},20593:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(11766),o=r(20594),i=r(20326),a=r(20422),c=r(20595),s=r(20597);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=e=>{var t,r,l,p,f,d,m=u(u({},e),{},{editorOptions:u(u({},e.editorOptions),{},{summary:null===(t=e.editorOptions.options)||void 0===t?void 0:t.placeholder,isRequired:null===(r=e.editorOptions.options)||void 0===r?void 0:r.required})});if(null!==(l=e.editorOptions.options)&&void 0!==l&&l.isDatepicker)return n.createElement(o.a,m);if(null!==(p=e.editorOptions.options)&&void 0!==p&&p.isToggle)return n.createElement(s.a,m);if(null!==(f=e.editorOptions.options)&&void 0!==f&&f.isSlider)return n.createElement(c.a,m);if(null!==(d=e.editorOptions.options)&&void 0!==d&&d.isEnum)return n.createElement(a.a,m);var b=u(u({},e),{},{editorOptions:u(u({},e.editorOptions),{},{options:void 0})});return n.createElement(i.a,b)}},20594:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(11766),o=r(19933),i=r(20323),a=r(20406),c=r(14918),s=r(19713);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(y,e);var t,r,f,b=m(y);function y(){var e;u(this,y);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=b.call(this,...r))._dateEditorRef=void 0,e._dateEditorContainerRef=void 0,e._designerContext=Object(s.a)(),e._onDateChanged=(t,r)=>{if(t){var n=e.getFormattedDateString(t);n&&r({value:Object(a.e)(n)})}},e.getFormattedDateString=e=>{if(e)return new Date(e.getTime()-60*e.getTimezoneOffset()*1e3).toISOString().split("T")[0]},e.renderEditor=t=>{var r,i,a=null==t?void 0:t.containerClassName,s=null==t?void 0:t.editorClassName,l=null===(r=e.props.editorOptions.options)||void 0===r?void 0:r.datePickerInfo,u=null===(i=e.props.editorOptions.options)||void 0===i?void 0:i.placeholder,{editorOptions:{displayName:p,readonly:f},editorState:{value:d},onChange:m}=e.props,b=1===d.length&&Object(c.M)(d[0].tokenExpression)?new Date(d[0].tokenExpression):void 0,y=null!=l&&l.minDate?new Date(l.minDate):void 0,v=null!=l&&l.maxDate?new Date(l.maxDate):void 0;return n.createElement("div",{className:a,ref:e.setContainerRef},n.createElement(o.a,{className:s,minDate:y,maxDate:v,placeholder:u,componentRef:e.setdateEditorRef,ariaLabel:null!=p?p:void 0,disabled:f,onChanged:t=>{e._onDateChanged(t,m)},value:b,onFormatDate:t=>{var r;return null!==(r=e.getFormattedDateString(t))&&void 0!==r?r:""},clientResources:e._designerContext.globalResources,dateTimeResources:e._designerContext.dateTimeResources}))},e.setdateEditorRef=t=>e._dateEditorRef=t,e.setContainerRef=t=>e._dateEditorContainerRef=t,e}return t=y,(r=[{key:"render",value:function(){var e;return n.createElement(i.a,l({},this.props,{labelTooltip:null===(e=this.props.editorOptions)||void 0===e||null===(e=e.options)||void 0===e?void 0:e.labelTooltip,onRenderEditor:this.renderEditor}))}},{key:"focus",value:function(){this._dateEditorRef&&this._dateEditorRef.focus()}},{key:"scrollIntoView",value:function(e){var t;null===(t=this._dateEditorContainerRef)||void 0===t||t.scrollIntoView(e)}}])&&p(t.prototype,r),f&&p(t,f),Object.defineProperty(t,"prototype",{writable:!1}),y}(n.Component)},20595:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(11766),o=r(16868),i=r(20323),a=r(20406),c=r(20596);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=Object(c.a)(),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(m,e);var t,r,c,p=d(m);function m(){var e;l(this,m);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=p.call(this,...r))._sliderEditorRef=void 0,e._sliderEditorContainerRef=void 0,e._onSliderChanged=(e,t)=>{var r=null==e?void 0:e.toString();t({value:Object(a.e)(r)})},e.renderEditor=t=>{var r,i=null==t?void 0:t.containerClassName,a=null==t?void 0:t.editorClassName,c=null===(r=e.props.editorOptions.options)||void 0===r?void 0:r.sliderInfo,{editorOptions:{displayName:s,readonly:l},editorState:{value:u},onChange:p}=e.props,f=1===u.length&&u[0].tokenExpression?parseFloat(u[0].tokenExpression):void 0;return n.createElement("div",{className:i,ref:e.setContainerRef},n.createElement(o.a,{className:a,componentRef:e.setSliderEditorRef,ariaLabel:null!=s?s:void 0,disabled:l,onChange:t=>{e._onSliderChanged(t,p)},value:f,min:null==c?void 0:c.minValue,max:null==c?void 0:c.maxValue,step:null==c?void 0:c.step,styles:y}))},e.setSliderEditorRef=t=>e._sliderEditorRef=t,e.setContainerRef=t=>e._sliderEditorContainerRef=t,e}return t=m,(r=[{key:"render",value:function(){var e;return n.createElement(i.a,s({},this.props,{labelTooltip:null===(e=this.props.editorOptions)||void 0===e||null===(e=e.options)||void 0===e?void 0:e.labelTooltip,onRenderEditor:this.renderEditor}))}},{key:"focus",value:function(){this._sliderEditorRef&&this._sliderEditorRef.focus()}},{key:"scrollIntoView",value:function(e){var t;null===(t=this._sliderEditorContainerRef)||void 0===t||t.scrollIntoView(e)}}])&&u(t.prototype,r),c&&u(t,c),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component)},20596:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{thumb:{borderColor:e.accent},activeSection:{backgroundColor:e.accent}}}},20597:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(11766),o=r(16898),i=r(20323),a=r(20406);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,r,u,d=f(m);function m(){var e;s(this,m);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=d.call(this,...r))._toggleEditorRef=void 0,e._toggleEditorContainerRef=void 0,e._onToggleChanged=(t,r)=>{var n=t?"true":"false";r({value:Object(a.e)(n)}),setTimeout(()=>{e.focus()},3e3)},e.renderEditor=t=>{var r,i=null==t?void 0:t.containerClassName,a=null==t?void 0:t.editorClassName,c=null===(r=e.props.editorOptions.options)||void 0===r?void 0:r.toggleInfo,{editorOptions:{displayName:s,readonly:l},editorState:{value:u},onChange:p}=e.props,f=1===u.length&&"true"===u[0].tokenExpression;return n.createElement("div",{className:i,ref:e.setContainerRef},n.createElement(o.a,{className:a,componentRef:e.setToggleEditorRef,ariaLabel:null!=s?s:void 0,disabled:l,onChange:(t,r)=>{e._onToggleChanged(null!=r&&r,p)},checked:f,onText:null==c?void 0:c.trueText,offText:null==c?void 0:c.falseText}))},e.setToggleEditorRef=t=>e._toggleEditorRef=t,e.setContainerRef=t=>e._toggleEditorContainerRef=t,e}return t=m,(r=[{key:"render",value:function(){var e;return n.createElement(i.a,c({},this.props,{labelTooltip:null===(e=this.props.editorOptions)||void 0===e||null===(e=e.options)||void 0===e?void 0:e.labelTooltip,onRenderEditor:this.renderEditor}))}},{key:"focus",value:function(){var e;null===(e=this._toggleEditorRef)||void 0===e||e.focus()}},{key:"scrollIntoView",value:function(e){var t;null===(t=this._toggleEditorContainerRef)||void 0===t||t.scrollIntoView(e)}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component)},20598:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r(11766),o=r(17728),i=r(17758),a=r(13240),c=r(20372),s=r(17720),l=r(12821),u=r(20326),p=r(19713),f=r(17244),d=r(12375),m=r(12999);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(E,e);var t,r,h,w=O(E);function E(){var e;y(this,E);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=w.call(this,...r))._editorContext=Object(p.a)(),e.coachmarkRef=n.createRef(),e.isCoachmarkVisible=!1,e.handleOnFocus=t=>{e.setCoachmarkVisibility(),e.props.onFocus&&e.props.onFocus(t)},e.handleOnBlur=t=>{Object(c.b)(t,f.a.UIClassNames.TeachingBubbleContent)||e.setCoachmarkVisible(!1),e.props.onBlur&&e.props.onBlur(t)},e.setCoachmarkVisible=t=>{e.isCoachmarkVisible=t},e.dismissCoachmarkVisibility=()=>{e.setCoachmarkVisible(!1),e._editorContext.doNotShowAgainService&&e._editorContext.doNotShowAgainService.markDoNotShowAgain(i.a.DefaultEditorCoachMark)},e.setCoachmarkVisibility=()=>{if(e._editorContext.doNotShowAgainService){var t=e._editorContext.doNotShowAgainService.isDoNotShowAgain(i.a.ContextualHelpCoachMark),r=e._editorContext.doNotShowAgainService.isDoNotShowAgain(i.a.DefaultEditorCoachMark);Promise.all([t,r]).then(t=>{var[r,n]=t;e._editorContext.telemetryService.tagEvent(a.c.DefaultEditorCoachMarkDoNotShowAgainCheckSucceeded);var o=Object(m.a)().designerNewTokenPickerV2;e.setCoachmarkVisible(r&&!n&&!o)}).catch(t=>{e._editorContext.telemetryService.tagEvent(a.c.DefaultEditorCoachMarkDoNotShowAgainCheckFailed,null,{error:t}),e.setCoachmarkVisible(!1)})}},e}return t=E,(r=[{key:"render",value:function(){return n.createElement(n.Fragment,null,n.createElement("div",{ref:this.coachmarkRef},n.createElement(u.a,b({onFocus:this.handleOnFocus,onBlur:this.handleOnBlur},this.props))),this.isCoachmarkVisible&&n.createElement(s.a,this.getDefaultEditorCoachmarkProps(),n.createElement(o.a,this.getDefaultEditorTeachingBubbleContentProps())))}},{key:"getDefaultEditorCoachmarkProps",value:function(){return{positioningContainerProps:{directionalHint:l.a.rightCenter},onDismiss:()=>{this._editorContext.telemetryService.tagEvent(a.c.DefaultEditorCoachMarkClosed)},target:this.coachmarkRef.current,preventFocusOnMount:!0}}},{key:"getDefaultEditorTeachingBubbleContentProps",value:function(){var{globalResources:e,designerResources:t,telemetryService:r}=this._editorContext;return{headline:t.DefaultEditorCoachmark.Headline,bodyContent:t.DefaultEditorCoachmark.Body,primaryButtonProps:{children:e.Common.LearnMore,onClick:()=>{r.tagEvent(a.c.DefaultEditorTeachingBubbleLinkClicked),window.open("https://docs.microsoft.com/".concat(Object(d.a)(),"/power-automate/multi-step-logic-flow#new-expression-editor-for-actions-experimental-feature"),"_blank")}},hasCloseButton:!0,hasCondensedHeadline:!0,onDismiss:()=>{this.dismissCoachmarkVisibility(),this._editorContext.telemetryService.tagEvent(a.c.DefaultEditorTeachingBubbleContentClosed)}}}}])&&v(t.prototype,r),h&&v(t,h),Object.defineProperty(t,"prototype",{writable:!1}),E}(n.Component)},20599:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(12728),o=r(11766),i=r(20323),a=r(20406),c=r(20600),s=r(20313),l=r(19713);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function d(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(e){b(r,e);var t=v(r);function r(){var e;p(this,r);for(var i=arguments.length,u=new Array(i),f=0;f<i;f++)u[f]=arguments[f];return(e=t.call(this,...u))._editorContext=Object(l.a)(),e.rpaEditorScriptPicker=o.createRef(),e.editorV2Id=Object(n.a)("RpaEditorScriptPickerV2"),e.renderEditorV2=t=>{var{editorState:r,editorOptions:{readonly:n}}=e.props,i=Object(a.c)(r.value)||Object(a.d)(r.value);return o.createElement(c.a,{editorProps:e.props,onRenderEditorOptions:t,ref:e.rpaEditorScriptPicker,onScriptSelected:e.onScriptSelected,readonly:n,selectedUIFlowId:i,labelId:e.editorV2Id,appSettings:e._editorContext.appSettings,environmentStore:e._editorContext.environmentStore,featureFlags:e._editorContext.featureFlags,flowStore:e._editorContext.flowStore,flowServiceClientResources:e._editorContext.designerResources,loggingService:e._editorContext.loggingService,planStore:e._editorContext.planStore,sessionStore:e._editorContext.sessionStore,surfaceStore:e._editorContext.surfaceStore,telemetryService:e._editorContext.telemetryService,uiFlowService:e._editorContext.uiFlowService,desktopFlowStore:e._editorContext.desktopFlowStore})},e.onScriptSelected=(t,r)=>{var{onChange:n}=e.props;n({value:[Object(s.d)(t,r)]})},e}return d(r,[{key:"render",value:function(){return o.createElement(i.a,u({},this.props,{labelId:this.editorV2Id,onRenderEditor:this.renderEditorV2}))}},{key:"focus",value:function(){this.rpaEditorScriptPicker.current&&this.rpaEditorScriptPicker.current.focus()}},{key:"scrollIntoView",value:function(e){this.rpaEditorScriptPicker.current&&this.rpaEditorScriptPicker.current.scrollIntoView(e)}}]),r}(o.Component),w=function(e){b(r,e);var t=v(r);function r(){var e;p(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call(this,...i)).rpaEditorInternal=o.createRef(),e}return d(r,[{key:"render",value:function(){return o.createElement(O,u({ref:this.rpaEditorInternal},this.props))}},{key:"focus",value:function(){this.rpaEditorInternal.current&&this.rpaEditorInternal.current.focus()}},{key:"scrollIntoView",value:function(e){this.rpaEditorInternal.current&&this.rpaEditorInternal.current.scrollIntoView(e)}}]),r}(o.Component)},20600:function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));var n,o=r(12706),i=r(12839),a=r(12728),c=r(12811),s=r(14337),l=r(11766),u=r(20353),p=r(20472),f=r(14680),d=r(13016),m=r(16824),b=r(12366),y=r(13009),v=r(13272),h=r(20601),g=r(13240),O=r(17276),w=r(13031),E=r(20602),C=r(20603),S=r(20626),P=r(20629),j=r(20631),T=r(20632),k=r(19220);function R(){return(R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N(n.key),n)}}function N(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function _(e,t){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=F(e);if(t){var o=F(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return I(this,r)}}function I(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L=Object(s.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(I,e);var t,r,n,N=D(I);function I(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,I),(t=N.call(this,e)).customValueDropdownRef=l.createRef(),t.containerRef=l.createRef(),t.store=void 0,t.getClassNames=Object(o.a)(),t.classNames=t.getClassNames(j.a),t.async=new i.a(A(t)),t.minSearchCharacters=2,t.renderHeader=()=>l.createElement(P.a,{currentSearchText:t.store.currentSearchText,onRefreshList:t.onRefreshUIFlowList,onSearch:t.onSearch,onSearchBoxClear:t.onSearchBoxClear,onSearchChange:t.onSearchChangeDebounced,placeHolderText:Object(w.a)(t.props.flowServiceClientResources.RpaEditorPickerHeader.Searchbox.PlaceholderWithMin,t.minSearchCharacters),clientResources:t.props.flowServiceClientResources,searchBoxAutomationId:k.k.desktopFlowDropdownOptions.searchTextField,buttonAutomationId:k.k.desktopFlowDropdownOptions.refreshButton}),t.renderEmpty=()=>{var{flowServiceClientResources:e}=t.props;return l.createElement(s.a,null,()=>{var r,n,o=t.store.currentCollection;return o&&o.error?(r=e.Designer.Editors.CustomValue.Empty.ErrorTitle,n=Object(w.a)(e.RpaEditorScriptPicker.Error.WorkflowsNotAvailable,Object(y.db)(o.error))||e.Common.SomethingWentWrongShort):t.store.currentSearchText?(r=Object(w.a)(e.Designer.Editors.CustomValue.Empty.SearchTitle,t.store.currentSearchText),n=e.Designer.Editors.CustomValue.Empty.SearchMessage):(r=e.Designer.Editors.CustomValue.Empty.ItemsTitle,n=e.Designer.Editors.CustomValue.Empty.ItemsMessage),l.createElement("div",{className:t.classNames.emptyResultsContainer},l.createElement("div",{className:t.classNames.emptyResultsTitle},r),l.createElement("div",{className:t.classNames.emptyResultsMessage},n))})},t.onChange=(e,r,n)=>{if(r){t.store.setErrorMessage(null);var o=r.key;t.props.onScriptSelected(o,t.store.getScriptDisplayName(o))}},t.onDismissDropdown=()=>{t.async.setTimeout(()=>{t.onSearchBoxClear()},b.h.search)},t.onSearchChangeDebounced=t.async.debounce(e=>{t.searchInternal(e,!1)},b.h.search),t.onSearch=e=>{t.searchInternal(e,!0)},t.searchInternal=(e,r)=>{e&&e.trim()?e.length>=t.minSearchCharacters?t.store.search(e,r):e.length<t.minSearchCharacters&&t.store.search(void 0):t.store.search(void 0)},t.onSearchBoxClear=()=>{t.store.search(void 0)},t.renderCustomAddAction=e=>l.createElement("div",null,l.createElement(u.a,{className:t.classNames.addUIFlowButton,iconName:v.a.Add,title:t.props.flowServiceClientResources.RpaScriptEditor.ComboBox.NewUIFlowButtonGA,onClick:()=>t.onNewScriptOptionClicked(e),text:t.props.flowServiceClientResources.RpaScriptEditor.ComboBox.NewUIFlowButtonGA,dataAutomationId:k.k.desktopFlowDropdownOptions.createNewDesktopFlowButton}),l.createElement("hr",{className:t.classNames.addUIFlowButtonDivider})),t.onRefreshUIFlowList=()=>{void 0===t.store.currentSearchText&&t.loadUIFlowListAndCheckWorkflowAvailability(!0),t.store.search(t.store.currentSearchText,!0)},t.onEditButtonClick=()=>{t.store.setErrorMessage(null);var e=t.props.selectedUIFlowId;t.props.telemetryService.tagEvent(g.c.RpaPowerAutomateDesktopEditButtonClicked,null,{uiFlowId:e,source:h.a.FlowCard}),Object(S.b)({surfaceStore:t.props.surfaceStore,onWizardComplete:t.onWizardEditionComplete,modalPage:S.a.DesktopV2,rpaEditionContext:h.a.FlowCard,processName:t.store.getScriptDisplayName(e),workflowId:e})},t.onNewUIFlowWinAutomationButtonClick=e=>{var{telemetryService:r}=t.props;r.tagEvent(g.c.RpaCreateNewClicked,{source:h.a.NewUIFlowWinAutomationButtonClick}),t.spawnCreateRpaCreationModal(C.b.DesktopV2,e)},t.spawnCreateRpaCreationModal=(e,r)=>{t.props.surfaceStore.spawn({key:Object(a.a)("create-rpa-desktop-modal-surface"),render:r=>l.createElement(E.a,R({dismiss:r.dismiss,onWizardComplete:t.onWizardCreationComplete,modalPage:e,rpaEditionContext:h.a.FlowCard},t.rpaCreationModalInjectedProps)),onDismiss:r})},t.onWizardEditionComplete=e=>{t.props.onScriptSelected(e,t.store.getScriptDisplayName(e)),t.checkWorkflowAvailability()},t.onWizardCreationComplete=e=>{t.props.onScriptSelected(e,t.store.getScriptDisplayName(e)),t.loadUIFlowListAndCheckWorkflowAvailability(!1,e)},t.renderError=e=>{var r=t.store.errorMessage;return r?l.createElement(m.a,{type:d.c.error,ariaLabel:r,message:r,className:e}):null},t.onNewScriptOptionClicked=e=>{t.props.featureFlags.enableCreateWAUIFlow&&t.onNewUIFlowWinAutomationButtonClick(e)},t.checkWorkflowAvailability=()=>{var e;if(t.props.selectedUIFlowId){var{desktopFlowStore:r,selectedUIFlowId:n,loggingService:o,featureFlags:i,flowStore:a,flowServiceClientResources:c}=t.props,s=a.flows.getEntity(n),l=null==r||null===(e=r.desktopFlows)||void 0===e?void 0:e.getEntity(n);if(t.store.setIsSelectedFlowEditable(!s||!s.isUserType),i.enableDFNewSchema&&null!=l&&l.isUsingNewSchema)try{if(!JSON.parse(l.metadata).isvalid){var u=Object(w.a)(c.RpaEditorScriptPicker.Error.WorkflowNotValidGA,n);t.store.setErrorMessage(u)}}catch(p){o.logWarning("RpaEditorScriptPickerV2_MetadataParseFailure","Unable to parse metadata with schema V2")}}},t.store=new T.a(t.props.flowStore,t.props.desktopFlowStore,t.props.uiFlowService,t.props.loggingService,t.props.featureFlags.enableDesktopFlowDLP,t.props.featureFlags.enableDesktopFlowDraftMode,t.props.flowServiceClientResources),t}return t=I,(r=[{key:"componentDidMount",value:function(){this.loadUIFlowListAndCheckWorkflowAvailability()}},{key:"componentDidUpdate",value:function(e){this.props.selectedUIFlowId&&this.props.selectedUIFlowId!==e.selectedUIFlowId&&this.checkWorkflowAvailability()}},{key:"render",value:function(){var{flowServiceClientResources:e,selectedUIFlowId:t,onRenderEditorOptions:r}=this.props;return l.createElement(l.Fragment,null,this.renderError(this.classNames.messageBar),l.createElement("div",{ref:this.containerRef,className:this.classNames.container,"data-automation-id":k.k.root},l.createElement(p.a,{ref:this.customValueDropdownRef,onDismiss:this.onDismissDropdown,className:Object(c.a)(r.editorClassName,this.classNames.customValueDropdown),onRenderAddCustomAction:this.renderCustomAddAction,placeholder:this.store.isReady?e.Designer.Editors.CustomValue.Placeholder:e.Common.Loading,onRenderEmptyResults:this.renderEmpty,onRenderHeader:this.renderHeader,labelledById:this.props.labelId,isLoading:!this.store.isReady,selectedKey:t,onChange:this.onChange,options:this.store.getCurrentCollectionOptionsWithSelection(this.props.selectedUIFlowId),hasMoreOptions:this.store.hasMore,hasMoreMessage:e.RpaEditorScriptPicker.HasMoreMessage,disabled:this.props.disabled,clientResources:e,"aria-label":e.RpaEditorScriptPicker.DropDownAriaLabel,dataAutomationId:k.k.desktopFlowDropdown,calloutDataAutomationId:k.k.desktopFlowDropdownOptions.root}),l.createElement(f.a,{primary:!0,text:this.props.flowServiceClientResources.RpaScriptEditor.EditButton,onClick:this.onEditButtonClick,disabled:!this.store.isReady||!t||!this.store.isSelectedFlowEditable,ariaLabel:e.RpaScriptEditor.EditButtonAriaLabel,dataAutomationId:k.k.modifyButton})))}},{key:"focus",value:function(){this.customValueDropdownRef.current&&this.customValueDropdownRef.current.focusDropdown()}},{key:"scrollIntoView",value:function(e){this.containerRef.current&&this.containerRef.current.scrollIntoView(e)}},{key:"loadUIFlowListAndCheckWorkflowAvailability",value:function(e,t){var{flowServiceClientResources:r}=this.props,n=t||this.props.selectedUIFlowId;O.a.announce(r.RpaEditorScriptPicker.ScreenReader.WorkflowRetrieving),this.store.loadInitialListAsync(n,e).then(()=>{this.checkWorkflowAvailability(),O.a.announce(r.RpaEditorScriptPicker.ScreenReader.WorkflowRetrieved)})}},{key:"rpaCreationModalInjectedProps",get:function(){return{appSettings:this.props.appSettings,environmentStore:this.props.environmentStore,featureFlags:this.props.featureFlags,flowServiceClientResources:this.props.flowServiceClientResources,planStore:this.props.planStore,sessionStore:this.props.sessionStore,surfaceStore:this.props.surfaceStore,telemetryService:this.props.telemetryService}}}])&&x(t.prototype,r),n&&x(t,n),Object.defineProperty(t,"prototype",{writable:!1}),I}(l.Component))||n},20601:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.CreateFlowCard="CreateFlowCard",e.FlowCard="FlowCard",e.MyFlowsCommandBar="MyFlowsCommandBar",e.MyUIFlowsCommandBar="MyUIFlowsCommandBar",e.MyUIFlowsInlineCommand="MyUIFlowsInlineCommand",e.UIFlowDetailsCommandBar="UIFlowDetailsCommandBar",e.UIFlowRunsCommandBar="UIFlowRunsCommandBar",e.UIFlowRunDetailsCommandBar="UIFlowRunDetailsCommandBar",e.UIFlowSaveAsCommand="UIFlowSaveAsCommand",e.MyUIFlowsEmptyStateButton="MyUIFlowsEmptyStateButton",e.NewUIFlowBrowserButtonClick="NewUIFlowBrowserButtonClick",e.NewUIFlowWinAutomationButtonClick="NewUIFlowWinAutomationButtonClick",e.MonitorRunsPage="MonitorRunsPage",e.MonitorRunQueuesEmptyStateButtonClick="MonitorRunQueuesEmptyStateButtonClick",e.DataverseCreationModal="DataverseCreationModal",e.UIFlowRunDetailsRemediationPane="UIFlowRunDetailsRemediationPane",e.ConnectionReferencesCardMessageBar="ConnectionReferencesCardMessageBar",e}({})},20602:function(e,t,r){"use strict";r.d(t,"a",(function(){return R})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return N}));var n,o=r(11766),i=r(14337),a=r(20603),c=r(12706),s=r(12811),l=r(12728),u=r(20604),p=r(13240),f=r(16822),d=r(16834),m=r(19946),b=r(20605),y=r(18842),v=r(20614),h=r(15376),g=r(20624),O=r(20625);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=k(e);if(t){var o=k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return T(this,r)}}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=Object(i.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(l,e);var t,r,n,i=j(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).rpaCreationModalStore=void 0,t.classNames=Object(c.a)()(u.a),t.renderDesktopV2SecondarySection=()=>o.createElement(b.c,null),t.renderDesktopV2Footer=()=>o.createElement(b.a,{rpaCreationModalStore:t.rpaCreationModalStore,dismiss:t.props.dismiss,onWizardComplete:t.props.onWizardComplete,rpaEditionContext:t.props.rpaEditionContext}),t.renderDesktopV2PrimarySection=()=>o.createElement(b.b,{rpaCreationModalStore:t.rpaCreationModalStore,dismiss:t.props.dismiss,onWizardComplete:t.props.onWizardComplete,rpaEditionContext:t.props.rpaEditionContext}),t.onCloseCreateDesktopV2UIFlowModal=()=>{t.props.telemetryService.tagEvent(p.c.RpaCreateModalClosed,{type:a.b.DesktopV2}),t.props.dismiss()},t.rpaCreationModalStore=new a.a(t.props.flowServiceClientResources,t.props.flowServiceClientResources,t.props.flowServiceClientResources,t.props.telemetryService,t.props.modalPage,t.props.solutionId),t}return t=l,(r=[{key:"render",value:function(){var e;return Object(m.c)(this.props.sessionStore)?o.createElement(v.a,{dismiss:this.onCloseCreateDesktopV2UIFlowModal,solutionId:this.props.solutionId}):!Object(m.b)({environmentStore:this.props.environmentStore,featureFlags:this.props.featureFlags,planStore:this.props.planStore,sessionStore:this.props.sessionStore})||null!==(e=this.props.environmentStore.currentEnvironment)&&void 0!==e&&e.properties.isDefault?o.createElement(f.a,{closeButtonText:this.props.flowServiceClientResources.Common.Close,headerTitle:this.props.flowServiceClientResources.RpaWizard.Modal.TitleGA,onRenderPrimarySection:this.renderDesktopV2PrimarySection,onRenderSecondarySection:this.renderDesktopV2SecondarySection,onRenderFooter:this.renderDesktopV2Footer,onDismiss:this.onCloseCreateDesktopV2UIFlowModal,className:this.rpaCreationModalStore.startOnPADV2Start?Object(s.a)(this.classNames.twoThirdsView,this.classNames.footerSpaceBetween):this.classNames.twoThirdsView,dataAutomationId:y.a.createDesktopFlowModals.paidUserCreateDesktopFlowModal.root,isModeless:!1}):Object(h.a)(this.props.appSettings.environment)?o.createElement(g.a,{dismiss:this.onCloseCreateDesktopV2UIFlowModal,featureFlags:this.props.featureFlags}):o.createElement(O.a,{dismiss:this.onCloseCreateDesktopV2UIFlowModal})}}])&&C(t.prototype,r),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component))||n,x=Object(d.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({appSettings:e.appSettings,featureFlags:e.featureFlags,flowServiceClientResources:e.flowServiceClientResources,planStore:e.planStore,sessionStore:e.sessionStore,surfaceStore:e.surfaceStore,telemetryService:e.telemetryService,environmentStore:e.environmentStore},t))(R);function N(e){var{surfaceStore:t,onWizardComplete:r,modalPage:n,rpaEditionContext:i,solutionId:a,onDismiss:c}=e;return t.spawn({key:Object(l.a)("create-rpa-desktop-modal-surface"),render:e=>o.createElement(x,{dismiss:e.dismiss,onWizardComplete:r,modalPage:n,rpaEditionContext:i,solutionId:a}),onDismiss:c})}},20603:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return h}));var n,o,i,a,c=r(11773),s=r(15513),l=r(19789),u=r(15567),p=r(13240),f=r(19702);function d(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var v=function(e){return e.PADV2Start="PADV2Start",e.DesktopV2="DesktopV2",e}({}),h=(o=y((n=function(){function e(t,r,n,p,f,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalResources=t,this.desktopFlowResources=r,this.errorHandlingResources=n,this.telemetryService=p,d(this,"currentPageType",o,this),d(this,"form",i,this),d(this,"solutionId",a,this),this.startOnPADV2Start=void 0,f?this.setCurrentPage(f):this.setCurrentPage(v.PADV2Start),this.startOnPADV2Start=this.currentPageType===v.PADV2Start,Object(c.runInAction)("RpaCreationModalStoreConstructor",()=>{this.form=new s.FormState({flowName:new s.FieldState(void 0).validators(Object(l.c)(this.errorHandlingResources),Object(u.d)({clientResources:this.globalResources})),PADFlowName:new s.FieldState(void 0).validators(Object(l.e)(this.errorHandlingResources)),uri:new s.FieldState(void 0).validators(this.flowURLFormatValidator(this.desktopFlowResources),Object(u.d)({clientResources:this.globalResources}))}),this.solutionId=m}),this.onRpaFlowNameChange=this.onRpaFlowNameChange.bind(this),this.onRpaPADFlowNameChange=this.onRpaPADFlowNameChange.bind(this)}var t,r,n;return t=e,(r=[{key:"setCurrentPage",value:function(e){this.currentPageType=e}},{key:"setPageFromToggle",value:function(){this.telemetryService.tagEvent(p.c.RpaCreationModalSelection,null,{modalPage:this.pageFromToggle}),this.setCurrentPage(this.pageFromToggle)}},{key:"onRpaFlowNameChange",value:function(e,t){this.form.$.flowName.onChange(t)}},{key:"onRpaPADFlowNameChange",value:function(e,t){this.form.$.PADFlowName.onChange(t),this.form.$.PADFlowName.validate()}},{key:"pageFromToggle",get:function(){return v.DesktopV2}},{key:"isDesktopV2NextButtonDisabled",get:function(){return!(!1===this.form.$.PADFlowName.hasError)}},{key:"flowURLFormatValidator",value:function(e){return t=>t&&Object(f.a)(t)?null:e.RpaWizard.Modal.Selenium.UrlError}}])&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"currentPageType",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=y(n.prototype,"form",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=y(n.prototype,"solutionId",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(n.prototype,"setCurrentPage",[c.action],Object.getOwnPropertyDescriptor(n.prototype,"setCurrentPage"),n.prototype),y(n.prototype,"setPageFromToggle",[c.action],Object.getOwnPropertyDescriptor(n.prototype,"setPageFromToggle"),n.prototype),y(n.prototype,"onRpaFlowNameChange",[c.action],Object.getOwnPropertyDescriptor(n.prototype,"onRpaFlowNameChange"),n.prototype),y(n.prototype,"onRpaPADFlowNameChange",[c.action],Object.getOwnPropertyDescriptor(n.prototype,"onRpaPADFlowNameChange"),n.prototype),y(n.prototype,"pageFromToggle",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"pageFromToggle"),n.prototype),y(n.prototype,"isDesktopV2NextButtonDisabled",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"isDesktopV2NextButtonDisabled"),n.prototype),n)},20604:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{optionTitle:[{selectors:{label:{selectors:{span:{fontFamily:"Segoe UI",fontSize:n.k.large,fontWeight:n.l.semibold,lineHeight:28}}},"label::before, label::after":{marginTop:5}}}],optionDescription:[{paddingLeft:26,fontSize:n.k.medium,width:"100%"}],choiceLabel:[{selectors:{".ms-ChoiceFieldGroup":{selectors:{".ms-Label":{color:e.neutralSecondary,fontWeight:n.l.regular}}}}}],getDetailsLink:[{fontFamily:"Segoe UI",fontSize:n.k.medium,lineHeight:20,letterSpacing:"0.005em",color:e.blue,margin:"auto 0"}],twoThirdsView:["fl-rpaCreationModal-twoThirdsView",{selectors:{"@media all and (min-width: 1025px)":{selectors:{".fl-CreateModal-section":{width:"35%"},".fl-CreateModal-section:first-child":{width:"65%"}}},".fl-ButtonGroupV2":{marginRight:"0px"}}}],footerSpaceBetween:["fl-CreateModal-footerSpaceBetween",{selectors:{".fl-CreateModal-footer":{justifyContent:"space-between"}}}],desktopV2:["fl-desktopV2-creationModal",{height:"100%",selectors:{".Carousel-node":{height:"100%",background:e.neutralLighterAlt}}}]}}},20605:function(e,t,r){"use strict";r.d(t,"c",(function(){return z})),r.d(t,"a",(function(){return W})),r.d(t,"b",(function(){return H}));var n,o,i,a=r(15028),c=r(12706),s=r(20603),l=r(17227),u=r.n(l),p=r(11773),f=r(14337),d=r(11766),m=r(20604),b=r(13240),y=r(20606),v=r(16834),h=r(14972),g=r(20354),O=r(20608),w=r(18842);function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D(n.key),n)}}function S(e,t,r){return t&&C(e.prototype,t),r&&C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=R(e);if(t){var o=R(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return k(this,r)}}function k(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return(t=D(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var I,A,F,L,M,B,U=Object(f.c)(n=function(e){P(r,e);var t=T(r);function r(){var e;E(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call(this,...o)).handlePrimarySectionKeyPress=t=>{Object(g.k)(t)&&e.onOpenRpaDesktopLaunchSurface()},e.onOpenRpaDesktopLaunchSurface=()=>{var t,{flowServiceClientResources:r,rpaCreationModalStore:n,rpaEditionContext:o,surfaceStore:i}=e.props;e.props.dismiss(),u()(n.form.$.PADFlowName.value&&n.form.$.PADFlowName.value.trim())&&n.form.$.PADFlowName.onChange(r.Common.Untitled),e.props.telemetryService.tagEvent(b.c.RpaCreateModalNextClicked,{uiFlowType:s.b.DesktopV2,uiFlowEditionOrigin:o}),Object(O.a)(i,N(N({},e.props),{},{processName:null===(t=n.form.$.PADFlowName.value)||void 0===t?void 0:t.trim(),onWizardComplete:e.props.onWizardComplete}))},e}return S(r,[{key:"render",value:function(){return d.createElement(a.a,{label:this.props.flowServiceClientResources.RpaWizard.Modal.FlowName,value:this.props.rpaCreationModalStore.form.$.PADFlowName.value,onChange:this.props.rpaCreationModalStore.onRpaPADFlowNameChange,errorMessage:this.props.rpaCreationModalStore.form.$.PADFlowName.error,placeholder:this.props.flowServiceClientResources.Create.AddAName,onKeyPress:this.handlePrimarySectionKeyPress,"data-automation-id":w.a.createDesktopFlowModals.paidUserCreateDesktopFlowModal.flowNameTextField})}}]),r}(d.Component))||n,V=function(e){P(r,e);var t=T(r);function r(){var e;E(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call(this,...o)).classNames=Object(c.a)()(m.a),e}return S(r,[{key:"render",value:function(){var{desktopFlowsResources:e,assetService:t,featureFlags:r,cdnService:n}=this.props,o=r.enablePADAppRenaming?e.RpaCarousel.Creation.Presentation.PAda:e.RpaCarousel.Creation.Presentation.DesktopV2;return d.createElement("div",{className:this.classNames.desktopV2},d.createElement(y.a,{image:t.rpa.carousel.desktopV2,textTitle:o.Title,textContent:o.Content,imageTitle:o.ImageTitle,imageStyle:{width:"80%",height:"90%",marginTop:"50px"},cdnService:n}))}}]),r}(d.Component),z=Object(v.b)((e,t)=>N({desktopFlowsResources:e.desktopFlowsResources,telemetryService:e.telemetryService,featureFlags:e.featureFlags,assetService:e.assetService,cdnService:e.cdnService},t))(V),G=Object(f.c)((i=function(e){P(r,e);var t=T(r);function r(){var e;E(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call(this,...o)).onOpenRpaDesktopLaunchSurface=()=>{var t,{flowServiceClientResources:r,rpaCreationModalStore:n,rpaEditionContext:o,surfaceStore:i}=e.props;e.props.dismiss(),u()(n.form.$.PADFlowName.value&&n.form.$.PADFlowName.value.trim())&&n.form.$.PADFlowName.onChange(r.Common.Untitled),e.props.telemetryService.tagEvent(b.c.RpaCreateModalNextClicked,{uiFlowType:s.b.DesktopV2,uiFlowEditionOrigin:o}),Object(O.a)(i,N(N({},e.props),{},{processName:null===(t=n.form.$.PADFlowName.value)||void 0===t?void 0:t.trim(),solutionId:n.solutionId,onWizardComplete:e.props.onWizardComplete}))},e.onCancel=()=>{e.props.telemetryService.tagEvent(b.c.RpaCreateModalCancelClicked,{source:s.b.DesktopV2,uiFlowEditionOrigin:e.props.rpaEditionContext}),e.props.dismiss()},e}return S(r,[{key:"render",value:function(){return d.createElement("div",{style:{marginRight:0,marginLeft:"auto"}},d.createElement(h.a,{buttons:this.footerButtons}))}},{key:"footerButtons",get:function(){var{flowServiceClientResources:e,rpaCreationModalStore:t}=this.props;return[{onClick:this.onOpenRpaDesktopLaunchSurface,primary:!0,text:e.Rpa.DesktopV2.Launch.App,disabled:t.isDesktopV2NextButtonDisabled,dataAutomationId:w.a.createDesktopFlowModals.paidUserCreateDesktopFlowModal.launchPadButton},{onClick:this.onCancel,text:e.Common.Cancel,dataAutomationId:w.a.createDesktopFlowModals.paidUserCreateDesktopFlowModal.cancelButton}]}}]),r}(d.Component),I=i.prototype,A="footerButtons",F=[p.computed],L=Object.getOwnPropertyDescriptor(i.prototype,"footerButtons"),M=i.prototype,B={},Object.keys(L).forEach((function(e){B[e]=L[e]})),B.enumerable=!!B.enumerable,B.configurable=!!B.configurable,("value"in B||B.initializer)&&(B.writable=!0),B=F.slice().reverse().reduce((function(e,t){return t(I,A,e)||e}),B),M&&void 0!==B.initializer&&(B.value=B.initializer?B.initializer.call(M):void 0,B.initializer=void 0),void 0===B.initializer&&(Object.defineProperty(I,A,B),B=null),o=i))||o,W=Object(v.b)((e,t)=>N({appSettings:e.appSettings,assetService:e.assetService,cdnService:e.cdnService,environmentStore:e.environmentStore,featureFlags:e.featureFlags,flowServiceClientResources:e.flowServiceClientResources,legacyFeatureFlags:e.legacyFeatureFlags,loggingService:e.loggingService,surfaceStore:e.surfaceStore,telemetryService:e.telemetryService,uiFlowService:e.uiFlowService,winAutomationService:e.winAutomationService,winAutomationStore:e.winAutomationStore},t))(G),H=Object(v.b)((e,t)=>N({appSettings:e.appSettings,assetService:e.assetService,cdnService:e.cdnService,environmentStore:e.environmentStore,featureFlags:e.featureFlags,flowServiceClientResources:e.flowServiceClientResources,legacyFeatureFlags:e.legacyFeatureFlags,loggingService:e.loggingService,surfaceStore:e.surfaceStore,telemetryService:e.telemetryService,uiFlowService:e.uiFlowService,winAutomationService:e.winAutomationService,winAutomationStore:e.winAutomationStore},t))(U)},20606:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(11766),o=r(12754),i=r(12706),a=r(20607),c=r(16828);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,r,u,d=f(m);function m(){var e;s(this,m);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=d.call(this,...r)).classNames=Object(i.a)()(a.a),e}return t=m,(r=[{key:"render",value:function(){return n.createElement("div",{className:this.classNames.root},n.createElement("div",{className:this.classNames.imageBox},n.createElement(c.b,{src:this.props.image,fallbackSrc:this.props.image,className:Object(o.eb)(this.classNames.image,this.props.imageStyle),title:this.props.imageTitle,cdnService:this.props.cdnService})),n.createElement("div",{className:this.classNames.textBox},n.createElement("div",{className:this.classNames.textTitle},this.props.textTitle),n.createElement("div",{className:this.classNames.textContent},this.props.textContent)))}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component)},20607:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["Carousel-node",{width:"100%",display:"block"}],imageBox:["Carousel-node-image-box",{height:"60%",textAlign:"center"}],image:["Carousel-node-image",{objectFit:"contain",width:"90%",height:"100%"}],textBox:["Carousel-node-text-box",{margin:"5% 10%"}],textTitle:["Carousel-node-text-title",{textAlign:"center",fontWeight:"bold"}],textContent:["Carousel-node-text-content",{textAlign:"center",paddingTop:5}]})},20608:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o=r(12728),i=r(14876),a=r(11766),c=r(14337),s=r(20609),l=r(20610),u=r(13223);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=Object(c.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(c,e);var t,r,n,o=m(c);function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).rpaDesktopLaunchSurfaceStore=void 0,t.retryCount=-1,t.onAppLaunch=()=>{var{winAutomationService:e,workflowId:r,solutionId:n,processName:o}=t.props;t.retryCount=t.retryCount+1,t.rpaDesktopLaunchSurfaceStore.setWorkflowId(Object(i.a)(r)?Object(u.a)():r),t.rpaDesktopLaunchSurfaceStore.setCreateNew(!!Object(i.a)(r)),e.launchApp({createNew:t.rpaDesktopLaunchSurfaceStore.createNew,workflowId:t.rpaDesktopLaunchSurfaceStore.workflowId,solutionId:Object(i.a)(n)?void 0:n,processName:Object(i.a)(o)?void 0:o,eventData:{retryCount:t.retryCount}})},t.onCloseModal=()=>{t.rpaDesktopLaunchSurfaceStore.closeWizard(),t.props.dismiss()};var{uiFlowService:r,onWizardComplete:n}=t.props;return t.rpaDesktopLaunchSurfaceStore=new s.a(r,n),t}return t=c,(r=[{key:"render",value:function(){return a.createElement(l.a,{onAppLaunch:this.onAppLaunch,onDismiss:this.onCloseModal,appSettings:this.props.appSettings,assetService:this.props.assetService,cdnService:this.props.cdnService,clientResources:this.props.flowServiceClientResources,featureFlags:this.props.featureFlags,legacyFeatureFlags:this.props.legacyFeatureFlags,loggingService:this.props.loggingService,sharedComponentResources:this.props.flowServiceClientResources,telemetryService:this.props.telemetryService,environmentStore:this.props.environmentStore,winAutomationStore:this.props.winAutomationStore})}},{key:"componentDidMount",value:function(){this.onAppLaunch()}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(a.Component))||n;function h(e,t){e.spawn({key:Object(o.a)("rpa-desktop-launch-surface"),render:e=>e?a.createElement(v,{surfaceKey:e.surfaceKey,dismiss:e.dismiss,appSettings:t.appSettings,assetService:t.assetService,cdnService:t.cdnService,environmentStore:t.environmentStore,flowServiceClientResources:t.flowServiceClientResources,featureFlags:t.featureFlags,legacyFeatureFlags:t.legacyFeatureFlags,loggingService:t.loggingService,telemetryService:t.telemetryService,uiFlowService:t.uiFlowService,winAutomationService:t.winAutomationService,winAutomationStore:t.winAutomationStore,workflowId:t.workflowId,processName:t.processName,solutionId:t.solutionId,onWizardComplete:t.onWizardComplete}):null})}},20609:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o,i,a,c,s=r(11773),l=r(12367);function u(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(n=s.action.bound,i=d((o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uiFlowService=t,this.onWizardComplete=r,u(this,"workflowId",i,this),u(this,"createNew",a,this),u(this,"messageBarProps",c,this),this.setCreateNew(!1)}var t,r,n;return t=e,(r=[{key:"setWorkflowId",value:function(e){this.workflowId=e}},{key:"setCreateNew",value:function(e){this.createNew=e}},{key:"closeWizard",value:function(){return this.onWizardComplete&&(this.workflowId||this.createNew)&&this.onWizardComplete(this.workflowId),this.createNew?this.uiFlowService.loadAllUIFlowsAsync(!0,l.q.DesktopV2):this.workflowId?this.uiFlowService.loadUIFlowAsync(this.workflowId,!0):Promise.resolve()}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"workflowId",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=d(o.prototype,"createNew",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(o.prototype,"setWorkflowId",[s.action],Object.getOwnPropertyDescriptor(o.prototype,"setWorkflowId"),o.prototype),d(o.prototype,"setCreateNew",[s.action],Object.getOwnPropertyDescriptor(o.prototype,"setCreateNew"),o.prototype),d(o.prototype,"closeWizard",[n],Object.getOwnPropertyDescriptor(o.prototype,"closeWizard"),o.prototype),c=d(o.prototype,"messageBarProps",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)},20614:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r.n(n),i=r(20615),a=r(12754),c=r(18842),s=r(20616),l=r(15918),u=r(16822),p=r(15941),f=r(12344),d=r(20621),m=r(20623),b=r(14346),y=r(16833),v=Object(a.db)(Object(i.a)());function h(e){var{dismiss:t,solutionId:r}=e,n=Object(l.a)(),{featureFlags:i}=Object(y.a)();return o.a.createElement(u.a,{className:v.modal,closeButtonText:n.Common.Close,headerTitle:Object(f.d)(i)?n.RpaDesktop.PadForWindowsDialog.Title:n.RpaDesktop.PadForWindowsDialog.TitlePreview,onRenderPrimarySection:()=>o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:v.subtitle},n.RpaDesktop.PadForWindowsDialog.MSA.Subtitle),o.a.createElement(p.a,{interpolatedString:n.RpaDesktop.PadForWindowsDialog.MSA.MsaText,linkProps:{href:d.a.learnMoreLicensing,target:b.b.blank,ariaLabel:n.Common.LearnMorePowerPlatform},className:v.message,dataAutomationId:c.a.createDesktopFlowModals.msaUserCreateDesktopFlowModal.description})),onRenderSecondarySection:m.a,onRenderFooter:()=>o.a.createElement(s.a,{dismiss:t,solutionId:r}),onDismiss:t,dataAutomationId:c.a.createDesktopFlowModals.msaUserCreateDesktopFlowModal.root})}},20615:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({secondaryCanvas:[{display:"flex",flex:1,justifyContent:"center",alignItems:"center",background:Object(n.Y)().palette.neutralLighter}],image:[{width:"75%"}],modal:[{selectors:{".fl-CreateModal-section":{marginBottom:30}}}],message:[{padding:"0 20px 0 20px",lineHeight:"22px",fontSize:n.k.size16,margin:"15px 0"}],subtitle:[{padding:"0 20px 0 20px",margin:"0 0 15px",lineHeight:"28px",fontSize:n.k.xLarge,fontWeight:n.l.semibold}]})},20616:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(11766),o=r.n(n),i=r(15918),a=r(14972),c=r(20617),s=r(16833),l=r(20622),u=r(18842);function p(e){var{dismiss:t,solutionId:r}=e,n=Object(i.a)(),{appSettings:p,environmentStore:f,legacyFeatureFlags:d,telemetryService:m,winAutomationService:b}=Object(s.a)();return o.a.createElement("div",null,o.a.createElement(a.a,{buttons:[{onClick:()=>{m.tagEvent(l.a.CreateDesktopFlowLaunchPadClicked),b.launchAppConsole(r?{solutionId:r}:void 0),t()},primary:!0,text:n.Rpa.DesktopV2.Launch.App,ariaLabel:n.Rpa.DesktopV2.Launch.App,dataAutomationId:u.a.createDesktopFlowModals.msaUserCreateDesktopFlowModal.launchPadButton},{onClick:()=>{m.tagEvent(l.a.CreateDesktopFlowDownloadPadClicked),Object(c.h)(p,f,d,m)},text:n.RpaDesktop.PadForWindowsDialog.DownloadApp,ariaLabel:n.RpaDesktop.PadForWindowsDialog.DownloadApp,dataAutomationId:u.a.createDesktopFlowModals.msaUserCreateDesktopFlowModal.cancelButton}]}))}},20622:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={CreateDesktopFlowStartTrialClicked:"DF_UI_CreateDesktopFlowStartTrialClicked",CreateDesktopFlowRequestLicenseClicked:"DF_UI_CreateDesktopFlowRequestLicenseClicked",CreateDesktopFlowDownloadPadClicked:"DF_UI_CreateDesktopFlowDownloadPadClicked",CreateDesktopFlowLaunchPadClicked:"DF_UI_CreateDesktopFlowLaunchPadClicked"}},20623:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(11766),o=r.n(n),i=r(16833),a=r(16826);function c(){var{assetService:e,cdnService:t,flowServiceClientResources:r}=Object(i.a)();return o.a.createElement(a.a,{imageSrc:e.rpa.carousel.desktopV2,isFullscreen:!0,summaryText:r.RpaDesktop.LaunchPAD.PAda.ImageAlt,useGAStyling:!0,assetService:e,cdnService:t})}var s=()=>o.a.createElement(c,null)},20624:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(11766),o=r.n(n),i=r(20615),a=r(12754),c=r(18842),s=r(15918),l=r(16822),u=r(15941),p=r(12344),f=r(20621),d=r(20623),m=r(14346),b=Object(a.db)(Object(i.a)());function y(e){var t=Object(s.a)();return o.a.createElement(l.a,{className:b.modal,closeButtonText:t.Common.Close,headerTitle:Object(p.d)(e.featureFlags)?t.RpaDesktop.PadForWindowsDialog.Title:t.RpaDesktop.PadForWindowsDialog.TitlePreview,onRenderPrimarySection:()=>o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:b.subtitle},t.RpaDesktop.PadForWindowsDialog.FreeOrgUser.Subtitle),o.a.createElement("p",{className:b.message},o.a.createElement(u.a,{interpolatedString:t.RpaDesktop.PadForWindowsDialog.FreeOrgUser.Text,linkProps:{href:f.a.learnMoreLicensing,target:m.b.blank,ariaLabel:t.Common.LearnMorePowerPlatform},inline:!0})),o.a.createElement("p",{className:b.message},t.Rpa.FreeUserStates.SovereignFreeUser.SubText)),onRenderSecondarySection:d.a,onDismiss:e.dismiss,dataAutomationId:c.a.createDesktopFlowModals.sovereignUserCreateDesktopFlowModal.root})}},20625:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(11766),o=r.n(n),i=r(20615),a=r(12754),c=r(18842),s=r(20623),l=r(15918),u=r(14972),p=r(16822),f=r(15941),d=r(15510),m=r(12337),b=r(12344),y=r(20621),v=r(14346),h=r(16833),g=r(13016),O=r(20622),w=Object(a.db)(Object(i.a)());function E(e){var t=Object(l.a)(),{planService:r,appSettings:n,surfaceStore:i,graphService:a,assetService:E,licenseManagementService:C,licenseManagementStore:S,neptuneService:P,consentService:j,cdnService:T,featureFlags:k,userDetailsStore:R,loggingService:x,telemetryService:N}=Object(h.a)(),[_,D]=o.a.useState(),I=()=>{N.tagEvent(O.a.CreateDesktopFlowStartTrialClicked),r.startOrExtendTrial(i,t,a,E,C,S,P,j,T,R).then(e=>{e?_&&D(void 0):D({message:t.Plans.Trial.FailedToCreateTrialWithContactAdmin,type:g.c.error,dataAutomationId:c.a.createDesktopFlowModals.freeUserCreateDesktopFlowModal.startTrialErrorMessage})})},A=()=>{N.tagEvent(O.a.CreateDesktopFlowRequestLicenseClicked),Object(d.b)(i,t,x,C,S,n,P,a,k,j,E,T,R,e.dismiss)};return o.a.createElement(p.a,{textMessageBarProps:_,className:w.modal,closeButtonText:t.Common.Close,headerTitle:Object(b.d)(k)?t.RpaDesktop.PadForWindowsDialog.Title:t.RpaDesktop.PadForWindowsDialog.TitlePreview,onRenderPrimarySection:()=>o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:w.subtitle},t.RpaDesktop.PadForWindowsDialog.FreeOrgUser.Subtitle),o.a.createElement("p",{className:w.message,"data-automation-id":c.a.createDesktopFlowModals.freeUserCreateDesktopFlowModal.description},o.a.createElement(f.a,{interpolatedString:t.RpaDesktop.PadForWindowsDialog.FreeOrgUser.Text,linkProps:{href:y.a.learnMoreLicensing,target:v.b.blank,ariaLabel:t.Common.LearnMorePowerPlatform},inline:!0})),o.a.createElement("p",{className:w.message,"data-automation-id":c.a.createDesktopFlowModals.freeUserCreateDesktopFlowModal.termsAndConditions},o.a.createElement(f.b,{interpolatedString:t.Rpa.FreeUserStates.FreeOrgUser.SubText,links:[{text:t.UserConsent.TermsAndConditions.Link,dataAutomationId:c.a.createDesktopFlowModals.freeUserCreateDesktopFlowModal.termsAndConditionsLink,href:Object(m.F)(),target:v.b.blank}],inline:!0}))),onRenderSecondarySection:s.a,onRenderFooter:()=>o.a.createElement(u.a,{buttons:[{primary:!0,onClick:A,text:t.Rpa.FreeUserStates.FreeOrgUser.RequestLicenseButton,dataAutomationId:c.a.createDesktopFlowModals.freeUserCreateDesktopFlowModal.requestLicenseButton},{primary:!1,onClick:I,text:t.Rpa.FreeUserStates.FreeOrgUser.StartTrialButton,dataAutomationId:c.a.createDesktopFlowModals.freeUserCreateDesktopFlowModal.startFreeTrialButton}]}),onDismiss:e.dismiss,dataAutomationId:c.a.createDesktopFlowModals.freeUserCreateDesktopFlowModal.root})}},20626:function(e,t,r){"use strict";r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return L}));var n,o,i=r(11766),a=r(14337),c=r(11773),s=r(20627),l=r(12706),u=r(12728),p=r(15497),f=r(13275),d=r(16828),m=r(17266),b=r(13009),y=r(13240),v=r(16834),h=r(20608),g=r(14678),O=r(14682),w=r(15959),E=r(20628);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}function k(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function R(e,t){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=_(e);if(t){var o=_(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return N(this,r)}}function N(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var I=function(e){return e.Desktop="Desktop",e.Selenium="Selenium",e.DesktopV2="DesktopV2",e}({}),A=Object(a.c)((D((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(a,e);var t,r,n,o=x(a);function a(){var e;j(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(l.a)(),e.onCloseEditDesktopV2UIFlowModal=()=>{e.props.telemetryService.tagEvent(y.c.RpaEditModalClosed,{type:I.DesktopV2}),e.props.dismiss()},e.onOpenRpaDesktopLaunchSurface=()=>{var{rpaEditionContext:t,workflowId:r,processName:n}=e.props;e.props.telemetryService.tagEvent(y.c.RpaEditModalLaunchClicked,{uiFlowType:I.DesktopV2,uiFlowEditionOrigin:t}),e.props.dismiss(),Object(h.a)(e.props.surfaceStore,S(S({},e.props),{},{processName:n,workflowId:r,onWizardComplete:e.props.onWizardComplete}))},e.onCancel=()=>{var{rpaEditionContext:t,telemetryService:r}=e.props;r.tagEvent(y.c.RpaEditModalCancelClicked,{uiFlowType:I.DesktopV2,uiFlowEditionOrigin:t}),e.props.dismiss()},e}return t=a,(r=[{key:"render",value:function(){var{assetService:e,cdnService:t,featureFlags:r,modalPage:n,flowServiceClientResources:o}=this.props,a=this.getClassNames(s.a),c=this.props.desktopFlowStore.desktopFlows.getEntity(this.props.workflowId),l={objectId:this.props.workflowId,columnName:w.u.primaryAttributeName,entityName:"Workflow",ismanaged:(null==c?void 0:c.ismanaged)||!1,iscustomizable:(null==c?void 0:c.iscustomizable)||{Value:!1},solutionid:this.props.solutionId||""};switch(n){case I.DesktopV2:var u=r.enablePADAppRenaming?o.RpaCarousel.Edit.Presentation.PAda:o.RpaCarousel.Edit.Presentation.DesktopV2;return i.createElement(p.b,{maxWidth:609,hidden:!1,onDismiss:this.onCloseEditDesktopV2UIFlowModal,title:u.DialogTitle,primaryButtonProps:this.primaryButtonProps,secondaryButtonProps:this.secondaryButtonProps,automationId:g.a.modals.editDesktopFlowDefinitionModal.root},i.createElement(f.a,null,i.createElement(f.a.Item,null,i.createElement(E.a,{entity:l})),i.createElement(f.a.Item,{className:a.imageContainer},i.createElement(d.b,{className:a.image,src:e.rpa.carousel.desktopV2,fallbackSrc:e.placeholder,alt:u.ImageTitle,cdnService:t})),i.createElement(f.a.Item,{className:a.titleText},u.Title),i.createElement(f.a.Item,{className:a.subtext},u.Content)));default:throw new m.a(b.c.rpaEditModalUnexpectedPage,"Invalid page for current page")}}},{key:"primaryButtonProps",get:function(){return Object(O.b)(g.a.modals.editDesktopFlowDefinitionModal.launchPADButton,{onClick:this.onOpenRpaDesktopLaunchSurface,primary:!0,text:this.props.flowServiceClientResources.Rpa.DesktopV2.Launch.App})}},{key:"secondaryButtonProps",get:function(){return Object(O.b)(g.a.modals.editDesktopFlowDefinitionModal.cancelButton,{onClick:this.onCancel,text:this.props.flowServiceClientResources.Common.Cancel})}}])&&T(t.prototype,r),n&&T(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.Component)).prototype,"primaryButtonProps",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"primaryButtonProps"),o.prototype),D(o.prototype,"secondaryButtonProps",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"secondaryButtonProps"),o.prototype),n=o))||n,F=Object(v.b)((e,t)=>S({appSettings:e.appSettings,assetService:e.assetService,cdnService:e.cdnService,environmentStore:e.environmentStore,flowServiceClientResources:e.flowServiceClientResources,featureFlags:e.featureFlags,legacyFeatureFlags:e.legacyFeatureFlags,loggingService:e.loggingService,surfaceStore:e.surfaceStore,telemetryService:e.telemetryService,uiFlowService:e.uiFlowService,winAutomationService:e.winAutomationService,winAutomationStore:e.winAutomationStore,desktopFlowStore:e.desktopFlowStore},t))(A);function L(e){var{surfaceStore:t,onWizardComplete:r,modalPage:n,rpaEditionContext:o,workflowId:a,processName:c,solutionId:s}=e;return t.spawn({key:Object(u.a)("edit-rpa-desktop-modal-surface"),render:e=>i.createElement(F,{dismiss:e.dismiss,onWizardComplete:r,modalPage:n,rpaEditionContext:o,processName:c,workflowId:a,solutionId:s})})}},20627:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({imageContainer:["fl-RpaEditModal-ImageContainer",{maxWidth:"562px",textAlign:"center",background:Object(n.Y)().palette.neutralLighterAlt,marginBottom:"10px"}],image:["fl-RpaEditModal-Image",{maxWidth:"260px",padding:"35px 0 35px 0",objectFit:"contain"}],titleText:["fl-RpaEditModal-Titletext",{textAlign:"center",padding:"10px 10px 0 10px",fontWeight:"bold"}],subtext:["fl-PADLaunchDialog-Subtext",{textAlign:"center",padding:"10px 10px 0 10px"}]})},20629:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o=r(12706),i=r(14337),a=r(11766),c=r(14681),s=r(13259),l=r(13272),u=r(20630);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=Object(i.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(f,e);var t,r,n,i=b(f);function f(){var e;d(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=i.call(this,...r)).getClassNames=Object(o.a)(),e.classNames=e.getClassNames(u.a),e.render=()=>{var{clientResources:t,onSearchChange:r,onSearch:n,onSearchBoxClear:o,currentSearchText:i,onRefreshList:u,placeHolderText:p,searchBoxAutomationId:f,buttonAutomationId:d}=e.props;return a.createElement("div",{className:e.classNames.header},a.createElement(c.a,{placeholder:p,onChange:r,onSearch:n,onClear:o,onEscape:o,value:i,required:!1,dataAutomationId:f}),a.createElement(s.a,{title:t.Common.Refresh,iconName:l.a.Refresh,onClick:u,dataAutomationId:d}))},e}return t=f,r&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(a.Component))||n},20630:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({header:["fl-RpaEditorPicker-Header",{display:"flex",margin:10,selectors:{".fl-SearchBox":{flexGrow:1,width:"calc(100% - 32px)"},[n.m]:{".ms-Button":{backgroundColor:"ButtonFace"}}}}]})},20631:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{addUIFlowButton:["fl-RpaEditorScriptPickerV2-addUIFlowButton",{width:"100%",[n.m]:{backgroundColor:"ButtonFace"}}],addUIFlowButtonDivider:["fl-RpaEditorScriptPickerV2-addUIFlowButtonDivider",{margin:"0 8px"}],container:["fl-RpaEditorScriptPickerV2-container",{display:"flex"}],customValueDropdown:["fl-RpaEditorScriptPickerV2-customValueDropdown",{flexGrow:1,width:"calc(100% - 80px - 2px)"}],emptyResultsContainer:["fl-RpaEditorScriptPickerV2-EmptyResultsContainer",{color:e.neutralSecondary,minHeight:150,overflowY:"auto",padding:20,textAlign:"center"}],emptyResultsMessage:["fl-RpaEditorScriptPickerV2-EmptyResultsMessage",{fontSize:n.k.smallPlus,margin:10}],emptyResultsTitle:["fl-RpaEditorScriptPickerV2-EmptyResultsTitle",{fontWeight:n.l.semibold}],messageBar:["fl-RpaEditorScriptPickerV2-MessageBar",{padding:0,marginBottom:"16px",marginTop:"8px"}]}}},20632:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n,o,i,a,c,s,l,u=r(11773),p=r(12366),f=r(12348),d=r(12364),m=r(13015),b=r(13009),y=r(15424),v=r(12367),h=r(17274),g=r(13085),O=r(17276),w=r(13031),E=r(19220),C=r(14682);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}function k(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function R(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var x=(o=R((n=function(){function e(t,r,n,p,d,m,b){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.flowStore=t,this.desktopFlowStore=r,this.uiFlowService=n,this.loggingService=p,this.dlpDesktopFlowEnabled=d,this.draftModeEnabled=m,this.clientResources=b,j(this,"isEditingScript",o,this),j(this,"isSelectedFlowEditable",i,this),j(this,"_errorMessage",a,this),j(this,"optionsStore",c,this),j(this,"currentSearchText",s,this),this.desktopFlowType=v.q.DesktopV2,this.loadInitialItemsAsync=(e,t)=>this.uiFlowService.loadAllUIFlowsAsync(t,this.desktopFlowType).then(()=>{var t=this.flowStore.flows.getCollection(Object(h.a)(this.desktopFlowType));return e&&t&&!t.hasEntity(e)?this.uiFlowService.loadUIFlowAsync(e).then(()=>{t&&t.list&&!t.hasEntity(e)&&t.addEntity(e,!0)}).catch(()=>{}):Promise.resolve()}),j(this,"search",l,this),Object(u.runInAction)("init",()=>{this.optionsStore=new f.a({getKey:e=>e.key})})}var t,r,n;return t=e,(r=[{key:"getCollectionKey",value:function(e){return"".concat(this.desktopFlowType,"/").concat(e||"")}},{key:"getSelectedOption",value:function(e){return this.optionsStore.getEntity(e)}},{key:"currentCollection",get:function(){return this.optionsStore.getCollection(this.getCollectionKey(this.currentSearchText))}},{key:"currentCollectionOptions",get:function(){return this.currentCollection&&0!==this.currentCollection.length?this.currentCollection.list.map(e=>this.optionsStore.getEntity(e)):[]}},{key:"hasMore",get:function(){if(this.currentSearchText)return this.currentCollectionOptions.length>=p.i;var e=this.flowStore.flows.getCollection(Object(h.a)(this.desktopFlowType));return!(null==e||!e.hasMore)}},{key:"getCurrentCollectionOptionsWithSelection",value:function(e){var t=this.currentCollectionOptions;if(!e||t.some(t=>t&&t.key===e))return t.map(e=>Object(C.b)(E.k.desktopFlowDropdownOptions.option,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e)));var r=this.getSelectedOption(e);return r?t.concat({key:e,text:r.text,hidden:!0}):t}},{key:"isReady",get:function(){return!this.isEditingScript&&!!this.currentCollection&&!this.currentCollection.isLoadingInitially}},{key:"loadInitialListAsync",value:function(e,t){var r=this.loggingService.profileStart(g.a.rpaCardScriptsLoadStart);this.currentSearchText=void 0;var n=this.getCollectionKey();return this.optionsStore.setCollectionLoading(n),this.loadInitialItemsAsync(e,t).then(()=>{var e=this.flowStore.flows.getCollection(Object(h.a)(this.desktopFlowType)),t=e&&e.length>0?e.list.map(e=>{var t=this.flowStore.flows.getEntity(e),r=this.desktopFlowStore.desktopFlows.getEntity(e);return this.convertToOptionFromFlow(t,r)}):[];this.optionsStore.setCollectionLoaded(n,t,{replaceDupe:d.a}),this.loggingService.profileEndWithSuccess(r,g.a.rpaCardScriptsLoadEnd)}).catch(e=>{this.optionsStore.setCollectionError(n,e),this.setErrorMessage(Object(w.a)(this.clientResources.RpaEditorScriptPicker.Error.WorkflowsNotAvailable,Object(m.o)(e)));var t=Object(y.a)(e);this.loggingService.profileEnd(r,g.a.rpaCardScriptsLoadEnd,t?b.e.Warning:Object(b.y)(e),e)})}},{key:"getScriptDisplayName",value:function(e){return this.flowStore.flows.hasEntity(e)?this.flowStore.flows.getEntity(e).properties.displayName:this.optionsStore.hasEntity(e)?this.optionsStore.getEntity(e).text:""}},{key:"setIsSelectedFlowEditable",value:function(e){this.isSelectedFlowEditable=e}},{key:"setEditingState",value:function(e){this.isEditingScript=e}},{key:"errorMessage",get:function(){return this._errorMessage}},{key:"setErrorMessage",value:function(e){this._errorMessage=e}},{key:"convertToOptionFromFlow",value:function(e,t){var{properties:r,name:n}=e,o=this.dlpDesktopFlowEnabled&&e.properties.flowSuspensionReason===v.i.companyDlpViolation,i=this.draftModeEnabled&&t&&t.isInDraftMode||!1;return this.convertToOption(n,r.displayName,o,i)}},{key:"convertToOption",value:function(e,t,r,n){var o=n?Object(w.a)(this.clientResources.Rpa.Editor.Script.Picker.Draft,t):r?Object(w.a)(this.clientResources.Rpa.Editor.Script.Picker.DLP.Suspended,t):t;return Object(C.b)(E.k.desktopFlowDropdownOptions.option,{key:e,text:o,disabled:r||n})}}])&&T(t.prototype,r),n&&T(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"isEditingScript",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=R(n.prototype,"isSelectedFlowEditable",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=R(n.prototype,"_errorMessage",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=R(n.prototype,"optionsStore",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=R(n.prototype,"currentSearchText",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R(n.prototype,"currentCollection",[u.computed],Object.getOwnPropertyDescriptor(n.prototype,"currentCollection"),n.prototype),R(n.prototype,"currentCollectionOptions",[u.computed],Object.getOwnPropertyDescriptor(n.prototype,"currentCollectionOptions"),n.prototype),R(n.prototype,"hasMore",[u.computed],Object.getOwnPropertyDescriptor(n.prototype,"hasMore"),n.prototype),R(n.prototype,"isReady",[u.computed],Object.getOwnPropertyDescriptor(n.prototype,"isReady"),n.prototype),R(n.prototype,"loadInitialListAsync",[u.action],Object.getOwnPropertyDescriptor(n.prototype,"loadInitialListAsync"),n.prototype),R(n.prototype,"setIsSelectedFlowEditable",[u.action],Object.getOwnPropertyDescriptor(n.prototype,"setIsSelectedFlowEditable"),n.prototype),R(n.prototype,"setEditingState",[u.action],Object.getOwnPropertyDescriptor(n.prototype,"setEditingState"),n.prototype),R(n.prototype,"setErrorMessage",[u.action],Object.getOwnPropertyDescriptor(n.prototype,"setErrorMessage"),n.prototype),l=R(n.prototype,"search",[u.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.currentSearchText=t,t){var n=e.getCollectionKey(t),o=e.optionsStore.getCollection(n);!o||!o.isCollectionLoading&&o.error||r?(e.optionsStore.setCollectionLoading(n),e.uiFlowService.searchDesktopFlowsAsync({search:{name:t},filters:{types:[e.desktopFlowType]}}).then(Object(u.action)("saveSearchResults",r=>{var o=r.map(t=>{var r=e.dlpDesktopFlowEnabled&&2===t.statecode&&3===t.statuscode,n=e.draftModeEnabled&&t.isInDraftMode;return e.convertToOption(t.workflowid,t.name,r,n)});e.optionsStore.setCollectionLoaded(n,o,{resetList:!0,replaceDupe:d.a}),t===e.currentSearchText&&O.a.announce(Object(w.a)(e.clientResources.RpaEditorPicker.Search.ScreenReaderAnnouncementFormat,o.length))})).catch(Object(u.action)("searchError",r=>{e.optionsStore.setCollectionError(n,r),t===e.currentSearchText&&O.a.announce(e.clientResources.RpaEditorPicker.Search.Error.ScreenReaderAnnouncement)}))):O.a.announce(Object(w.a)(e.clientResources.RpaEditorPicker.Search.ScreenReaderAnnouncementFormat,e.currentCollectionOptions.length))}}}}),n)},20633:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(11766),o=r.n(n),i=r(20313),a=r(19713),c=r(20326),s=r(20323),l=r(20634);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(y,e);var t,r,n,d=b(y);function y(){var e;p(this,y);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=d.call(this,...r))._editorContext=Object(a.a)(),e.renderParamter=()=>o.a.createElement(s.a,u({},e.props,{onRenderEditor:()=>o.a.createElement(c.a,u({ignoreWrapperComponent:!0},e.props))})),e.onPromptChange=t=>{e.props.onChange({value:[Object(i.f)(t)]})},e}return t=y,(r=[{key:"render",value:function(){return o.a.createElement(l.a,{services:this._editorContext,flowServiceClientResources:this._editorContext.flowServiceClientResources,renderParameter:this.renderParamter,value:this.props.editorState.value,onPromptChange:this.onPromptChange})}}])&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(o.a.Component)},20634:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(12961),o=r(13254),i=r(12754),a=r(17934),c=r(11766),s=r.n(c),l=r(15995),u=r(12378),p=r(13240),f=r(20635),d=r(20636);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(g,e);var t,r,c,y=h(g);function g(){var e;m(this,g);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=y.call(this,...r)).rootRef=s.a.createRef(),e.editorRef=s.a.createRef(),e.state={isPanelOpen:!1,showTeachingBubble:!1},e.renderSparkleIcon=()=>s.a.createElement("div",{className:e.styles.sparkleIcon},s.a.createElement(f.a,null)),e.openInstructionPanel=()=>{e.props.services.telemetryService.tagEvent(p.c.GptOpenInstructionPanel),e.setPanelOpen(!0)},e.setPanelOpen=t=>{e.setState({isPanelOpen:t})},e.renderDisclaimerSegment=e=>e.type===l.b.LITERAL?s.a.createElement(s.a.Fragment,null,e.value):s.a.createElement(o.a,{href:Object(u.a)(),target:"_blank"},e.value),e.onInstructionChosen=t=>{e.setPanelOpen(!1),e.props.onPromptChange(t),e.setState({showTeachingBubble:!0})},e.closeTeachingBubble=()=>{var t;e.setState({showTeachingBubble:!1}),null===(t=e.editorRef.current)||void 0===t||t.focus()},e.styles=Object(i.db)({root:{display:"flex",flexDirection:"column",".msla-text-editor, .editor-input":{borderRadius:2,border:"1px solid ".concat(Object(i.Y)().palette.neutralSecondaryAlt)},".public-DraftEditorPlaceholder-inner":{paddingTop:1,color:Object(i.Y)().palette.neutralTertiary},".public-DraftEditor-content, .msla-setting-token-editor-container .editor-input ":{minHeight:72,paddingTop:1}},usePromptTemplates:{marginTop:12,marginBottom:18,alignSelf:"flex-start",".msla-input-parameter-item &":{marginLeft:131}},disclaimer:{textAlign:"left",color:Object(i.Y)().palette.neutralSecondary},sparkleIcon:{marginRight:8,marginTop:2},teachingBubble:{b:{fontWeight:i.l.bold}}}),e}return t=g,(r=[{key:"render",value:function(){var e,t=this.props.flowServiceClientResources.Designer.Editors.Gpt,r=this.props.flowServiceClientResources.Common,o=this.state.showTeachingBubble?null===(e=this.rootRef.current)||void 0===e?void 0:e.querySelector(".msla-input-parameter-content-wrapper"):void 0;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:this.styles.root,ref:this.rootRef},this.props.renderParameter(),this.state.showTeachingBubble&&s.a.createElement(a.a,{target:o,headline:t.TeachingBubble.Headline,hasSmallHeadline:!0,primaryButtonProps:{text:r.GotIt,onClick:this.closeTeachingBubble},closeButtonAriaLabel:r.Close,onDismiss:this.closeTeachingBubble},s.a.createElement("span",{className:this.styles.teachingBubble},s.a.createElement(l.a,{formatText:t.TeachingBubble.Content}))),s.a.createElement(n.a,{onRenderIcon:this.renderSparkleIcon,onClick:this.openInstructionPanel,className:this.styles.usePromptTemplates},t.CreatePromptButton),s.a.createElement("div",{className:this.styles.disclaimer},s.a.createElement(l.a,{formatText:t.Disclaimer,onRenderSegment:this.renderDisclaimerSegment}))),this.state.isPanelOpen&&s.a.createElement(d.a,{isPanelOpen:this.state.isPanelOpen,setPanelOpen:this.setPanelOpen,onInstructionChosen:this.onInstructionChosen,initialValue:this.props.value,gptService:this.props.services.gptService,telemetryService:this.props.services.telemetryService,strings:t,closeButtonAriaLabel:r.Close}))}}])&&b(t.prototype,r),c&&b(t,c),Object.defineProperty(t,"prototype",{writable:!1}),g}(s.a.Component)},20635:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:14,height:14,viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=o.createElement("path",{d:"M4.39804 9.80882C4.57428 9.93313 4.78476 9.99968 5.00043 9.9993C5.21633 9.99946 5.42686 9.93197 5.60243 9.8063C5.77993 9.67582 5.91464 9.49552 5.98943 9.2883L6.43643 7.9153C6.55086 7.57101 6.74391 7.25811 7.00028 7.00139C7.25665 6.74467 7.56929 6.5512 7.91343 6.4363L9.30443 5.9853C9.45636 5.93095 9.59364 5.84214 9.70551 5.72586C9.81738 5.60957 9.9008 5.46896 9.94924 5.31503C9.99767 5.16111 10.0098 4.99806 9.98468 4.83867C9.95955 4.67927 9.89786 4.52786 9.80443 4.3963C9.67034 4.21038 9.47939 4.07314 9.26043 4.0053L7.88543 3.5583C7.54091 3.44407 7.22777 3.25111 6.97087 2.99472C6.71396 2.73833 6.52035 2.42558 6.40543 2.0813L5.95343 0.693301C5.88113 0.490997 5.74761 0.316236 5.57143 0.193301C5.43877 0.0995741 5.28607 0.0380931 5.12548 0.0137472C4.96489 -0.0105984 4.80083 0.00286224 4.64636 0.0530596C4.49188 0.103257 4.35125 0.188806 4.23564 0.302903C4.12004 0.417 4.03265 0.556497 3.98043 0.710301L3.52343 2.1103C3.40884 2.44513 3.21967 2.74954 2.97022 3.00055C2.72076 3.25157 2.41753 3.44263 2.08343 3.5593L0.692428 4.0073C0.540653 4.0617 0.403522 4.15048 0.291767 4.26669C0.180011 4.3829 0.0966621 4.5234 0.0482407 4.67719C-0.000180673 4.83097 -0.0123605 4.99388 0.0126534 5.15315C0.0376676 5.31243 0.0991972 5.46376 0.192428 5.5953C0.320272 5.77475 0.501046 5.90972 0.709428 5.9813L2.08343 6.4263C2.52354 6.57278 2.90999 6.84713 3.19343 7.2143C3.35585 7.42494 3.4813 7.66164 3.56443 7.9143L4.01643 9.3053C4.08846 9.50859 4.22179 9.68452 4.39804 9.80882ZM4.48343 2.3943L5.01043 1.0173L5.44943 2.3943C5.61312 2.88745 5.88991 3.33546 6.25767 3.70253C6.62544 4.0696 7.07397 4.34554 7.56743 4.5083L8.97343 5.0373L7.59143 5.4853C7.09866 5.6496 6.65095 5.92646 6.28382 6.29393C5.9167 6.66141 5.64026 7.10938 5.47643 7.6023L4.95343 8.9803L4.50443 7.6013C4.34335 7.10803 4.06943 6.65913 3.70443 6.2903C3.3356 5.92226 2.88653 5.64467 2.39243 5.4793L1.01443 4.9573L2.40043 4.5073C2.88672 4.33867 3.32775 4.06051 3.68943 3.6943C4.04901 3.3266 4.32049 2.88211 4.48343 2.3943ZM10.5353 13.8513C10.6713 13.9475 10.8337 13.9992 11.0003 13.9993C11.1654 13.9994 11.3264 13.9484 11.4613 13.8533C11.6008 13.7548 11.7058 13.6149 11.7613 13.4533L12.0093 12.6913C12.0625 12.5329 12.1515 12.3888 12.2693 12.2703C12.3867 12.1518 12.5307 12.063 12.6893 12.0113L13.4613 11.7593C13.619 11.7048 13.7557 11.6024 13.8523 11.4663C13.9257 11.3633 13.9736 11.2444 13.9921 11.1193C14.0106 10.9942 13.9992 10.8665 13.9588 10.7467C13.9184 10.6268 13.8501 10.5183 13.7597 10.4299C13.6692 10.3415 13.5591 10.2759 13.4383 10.2383L12.6743 9.98933C12.5162 9.93676 12.3724 9.84814 12.2544 9.73048C12.1364 9.61281 12.0473 9.46932 11.9943 9.31133L11.7423 8.53833C11.6886 8.38048 11.586 8.24387 11.4493 8.14833C11.3473 8.07538 11.2295 8.02744 11.1056 8.00838C10.9816 7.98932 10.8549 7.99967 10.7357 8.0386C10.6164 8.07753 10.508 8.14395 10.4192 8.23249C10.3304 8.32104 10.2636 8.42923 10.2243 8.54833L9.97731 9.31033C9.92502 9.46798 9.83747 9.61162 9.72131 9.73033C9.60657 9.8468 9.46665 9.93541 9.31231 9.98933L8.53931 10.2413C8.38025 10.2952 8.2422 10.3978 8.1447 10.5346C8.04721 10.6713 7.99522 10.8353 7.99611 11.0032C7.99699 11.1712 8.0507 11.3346 8.14963 11.4703C8.24856 11.606 8.38769 11.7071 8.54731 11.7593L9.31031 12.0063C9.46917 12.0597 9.61358 12.149 9.73231 12.2673C9.85053 12.3856 9.93896 12.5302 9.99031 12.6893L10.2433 13.4633C10.2981 13.6198 10.4001 13.7554 10.5353 13.8513ZM9.62231 11.0583L9.44331 10.9993L9.62731 10.9353C9.92907 10.8304 10.2027 10.6576 10.4273 10.4303C10.6537 10.2013 10.8248 9.92359 10.9273 9.61833L10.9853 9.44033L11.0443 9.62133C11.1463 9.92803 11.3185 10.2067 11.5471 10.4352C11.7757 10.6636 12.0545 10.8356 12.3613 10.9373L12.5563 11.0003L12.3763 11.0593C12.0689 11.1615 11.7898 11.3342 11.5611 11.5636C11.3324 11.793 11.1606 12.0727 11.0593 12.3803L11.0003 12.5613L10.9423 12.3803C10.8409 12.0722 10.6687 11.792 10.4394 11.5625C10.2102 11.3329 9.93033 11.1602 9.62231 11.0583Z",fill:"#212121"})))}r.p},20636:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(12854),o=r(12960),i=r(12961),a=r(14956),c=r(14958),s=r(12754),l=r(11766),u=r.n(l),p=r(13240),f=r(20313),d=r(20637),m=r(20647),b=r(20649);function y(e){var[t,r]=Object(l.useState)(()=>0===g(e.initialValue).length?0:1),[o,i]=Object(l.useState)(()=>g(e.initialValue)),[f,y]=Object(l.useState)(0),{strings:O}=e,w=Object(s.Y)().palette,E={main:{backgroundColor:w.neutralLighterAlt},commands:{borderBottom:"1px solid ".concat(w.neutralLight),backgroundColor:w.neutralLighterAlt,paddingBottom:16,paddingTop:16},footer:{backgroundColor:w.neutralLighterAlt,borderTop:"1px solid ".concat(w.neutralLight)}};return u.a.createElement(a.a,{hasCloseButton:!0,closeButtonAriaLabel:e.closeButtonAriaLabel,isOpen:e.isPanelOpen,customWidth:"600px",type:c.a.custom,onDismiss:()=>e.setPanelOpen(!1),styles:E,onRenderHeader:()=>{var e=Object(s.db)({root:{display:"flex",flex:"1 1 auto",marginLeft:16},title:{flex:"1 1 auto",fontSize:s.k.xLarge,fontWeight:s.l.semibold},rightHeader:{display:"flex",alignItems:"center"},brand:{fontSize:s.k.small,marginRight:5,marginLeft:4}});return u.a.createElement("div",{className:e.root},1===t&&u.a.createElement(n.a,{styles:{root:{marginRight:5}},title:O.CreatePanel.Back,iconProps:{iconName:"Back"},onClick:C}),u.a.createElement("span",{className:e.title},O.CreatePanel.Header),u.a.createElement("div",{className:e.rightHeader},u.a.createElement(b.a,null),u.a.createElement("span",{className:e.brand},O.CreatePanel.AiBuilder)))},isFooterAtBottom:!0,onRenderFooterContent:()=>0===t?u.a.createElement(h,{strings:O,cancel:()=>e.setPanelOpen(!1)}):u.a.createElement(v,{strings:O,confirm:S})},0===t&&u.a.createElement(d.a,{strings:O,templateStartIndex:f,setTemplateStartIndex:y,telemetryService:e.telemetryService,onChosen:e=>{i(e),r(1)}}),1===t&&u.a.createElement(m.a,{instruction:o,onChangeInstruction:i,gptService:e.gptService,telemetryService:e.telemetryService,strings:O}));function C(){r(0),e.telemetryService.tagEvent(p.c.GptInstructionPanelBack)}function S(){e.onInstructionChosen(o),e.telemetryService.tagEvent(p.c.GptInstructionPanelConfirmPrompt)}}function v(e){var t=Object(s.db)({footer:{fontSize:s.k.small},button:{marginTop:16}});return u.a.createElement("div",{className:t.footer},u.a.createElement("span",null,e.strings.ChoosePanel.Footer),u.a.createElement(o.a,{onClick:e.confirm,className:t.button},e.strings.CreatePanel.UseInFlow))}function h(e){var t=e.strings.ChoosePanel,r=Object(s.db)({footer:{fontSize:s.k.small,display:"flex",justifyContent:"space-between",alignItems:"center"}});return u.a.createElement("div",{className:r.footer},u.a.createElement("span",null,t.Footer),u.a.createElement(i.a,{onClick:e.cancel},t.Cancel))}function g(e){return e.map(e=>{var t;switch(e.type){case f.b.ENUM:case f.b.TOKEN:return(null===(t=e.token)||void 0===t?void 0:t.title)||e.tokenExpression||"";case f.b.FUNCTION:case f.b.LITERAL:case f.b.NEW_LINE:case f.b.UNSUPPORTED:default:return e.value||e.tokenExpression||""}}).join("")}},20637:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(12746),o=r(15539),i=r(12854),a=r(12961),c=r(12754),s=r(11766),l=r.n(s),u=r(13240),p=r(20638),f=r(20639),d=r(20640),m=r(20641),b=r(20642),y=r(20643),v=r(20644),h=r(20645),g=r(20646);function O(e){var[t,{toggle:r}]=Object(n.a)(!1),i=Object(c.db)({header:{fontWeight:c.l.semibold,fontSize:c.k.size14,marginBottom:10,paddingTop:12},list:{display:"flex",flexDirection:"column",rowGap:10,alignItems:"strech"}}),a=e.strings.ChoosePanel,s=Object.keys(a.Templates);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:i.header},a.Header),l.a.createElement("div",{className:i.list},l.a.createElement(E,{text:a.StartFromBlank,description:a.StartFromBlankDescription,icon:l.a.createElement(d.a,null),iconBackgroundColor:"#CFF6F9",onChosen:()=>w("StartFromBlankTemplate","")}),s.slice(0,t?s.length:4).map(e=>{var t=a.Templates[e];return l.a.createElement(E,{key:e,text:t.Title,description:t.Description,icon:O(e),onChosen:()=>w(e,t.Content)})})),l.a.createElement(o.a,{iconProps:{iconName:t?"ChevronUp":"ChevronDown"},onClick:r,styles:{root:{marginTop:5,marginLeft:5}}},t?a.ShowLessTemplates:a.ShowMoreTemplates));function O(e){switch(e){case"SummarizeEmails":return l.a.createElement(g.a,null);case"ExtractInformationEmail":return l.a.createElement(b.a,null);case"ClassifyArticles":return l.a.createElement(p.a,null);case"CreateBlogPosts":return l.a.createElement(f.a,null);case"SentimentAnalysisTweets":return l.a.createElement(h.a,null);case"RespondComplaint":return l.a.createElement(v.a,null);case"ExtractActionPointsEmail":return l.a.createElement(m.a,null);case"ReminderEmailMessage":return l.a.createElement(y.a,null);default:return l.a.createElement(d.a,null)}}function w(t,r){e.onChosen(r),e.telemetryService.tagEvent(u.c.GptChoseTemplate,null,{key:t})}}var w=e=>{var{icon:t,iconBackgroundColor:r}=e,{palette:n}=Object(c.Y)(),o={root:{display:"flex",height:36,minWidth:36,backgroundColor:r||n.themeLighter,justifyContent:"center",alignItems:"center"}};return l.a.createElement(i.a,{styles:o,onRenderIcon:()=>t})};function E(e){var{effects:t,palette:r}=Object(c.Y)(),n=Object(c.db)({text:{display:"inline-block",marginLeft:12},title:{fontWeight:c.l.semibold,color:r.neutralDark,textAlign:"start"},subTitle:{textAlign:"start",width:450,fontSize:c.k.small,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}),o={root:{display:"flex",border:"none",height:60,borderRadius:8,boxShadow:t.elevation4}};return l.a.createElement(a.a,{styles:o,onClick:()=>e.onChosen()},l.a.createElement(w,{icon:e.icon,iconBackgroundColor:e.iconBackgroundColor}),l.a.createElement("div",{className:n.text},l.a.createElement("div",{className:n.title},e.text),l.a.createElement("div",{className:n.subTitle},e.description)))}},20638:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:14,height:10,viewBox:"0 0 14 10",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M14 0.5C14 0.223858 13.7761 0 13.5 0H8.5C8.22386 0 8 0.223858 8 0.5C8 0.776142 8.22386 1 8.5 1H13.5C13.7761 1 14 0.776142 14 0.5ZM6 0.5C6 0.223858 5.77614 0 5.5 0H0.5C0.223857 0 0 0.223858 0 0.5C0 0.776142 0.223858 1 0.5 1H5.5C5.77614 1 6 0.776142 6 0.5ZM14 3.5C14 3.22386 13.7761 3 13.5 3H8.5C8.22386 3 8 3.22386 8 3.5C8 3.77614 8.22386 4 8.5 4H13.5C13.7761 4 14 3.77614 14 3.5ZM6 3.5C6 3.22386 5.77614 3 5.5 3H0.5C0.223857 3 0 3.22386 0 3.5C0 3.77614 0.223858 4 0.5 4H5.5C5.77614 4 6 3.77614 6 3.5ZM14 6.5C14 6.22386 13.7761 6 13.5 6H8.5C8.22386 6 8 6.22386 8 6.5C8 6.77614 8.22386 7 8.5 7H13.5C13.7761 7 14 6.77614 14 6.5ZM6 6.5C6 6.22386 5.77614 6 5.5 6H0.5C0.223857 6 0 6.22386 0 6.5C0 6.77614 0.223858 7 0.5 7H5.5C5.77614 7 6 6.77614 6 6.5ZM14 9.5C14 9.22386 13.7761 9 13.5 9H8.5C8.22386 9 8 9.22386 8 9.5C8 9.77614 8.22386 10 8.5 10H13.5C13.7761 10 14 9.77614 14 9.5ZM6 9.5C6 9.22386 5.77614 9 5.5 9H0.5C0.223857 9 0 9.22386 0 9.5C0 9.77614 0.223858 10 0.5 10H5.5C5.77614 10 6 9.77614 6 9.5Z",fill:"#323130"})))}r.p},20639:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:16,height:12,viewBox:"0 0 16 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M0 3C0 1.34315 1.34315 0 3 0H13C14.6569 0 16 1.34315 16 3V9C16 10.6569 14.6569 12 13 12H3C1.34315 12 0 10.6569 0 9V3ZM3 1C1.89543 1 1 1.89543 1 3V9C1 10.1046 1.89543 11 3 11H13C14.1046 11 15 10.1046 15 9V3C15 1.89543 14.1046 1 13 1H3ZM2 3C2 2.44772 2.44772 2 3 2H13C13.5523 2 14 2.44772 14 3V5C14 5.55228 13.5523 6 13 6H3C2.44772 6 2 5.55229 2 5V3ZM13 3H3V5H13V3ZM10 7C9.44772 7 9 7.44772 9 8V9C9 9.55228 9.44772 10 10 10H13C13.5523 10 14 9.55228 14 9V8C14 7.44772 13.5523 7 13 7H10ZM10 8H13V9H10V8ZM2 7.5C2 7.22386 2.22386 7 2.5 7H7.5C7.77614 7 8 7.22386 8 7.5C8 7.77614 7.77614 8 7.5 8H2.5C2.22386 8 2 7.77614 2 7.5ZM2.5 9C2.22386 9 2 9.22386 2 9.5C2 9.77614 2.22386 10 2.5 10H7.5C7.77614 10 8 9.77614 8 9.5C8 9.22386 7.77614 9 7.5 9H2.5Z",fill:"#323130"})))}r.p},20640:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:15,height:15,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M8 0.5C8 0.223858 7.77614 0 7.5 0C7.22386 0 7 0.223858 7 0.5V7H0.5C0.223858 7 0 7.22386 0 7.5C0 7.77614 0.223858 8 0.5 8H7V14.5C7 14.7761 7.22386 15 7.5 15C7.77614 15 8 14.7761 8 14.5V8H14.5C14.7761 8 15 7.77614 15 7.5C15 7.22386 14.7761 7 14.5 7H8V0.5Z",fill:"#323130"})))}r.p},20641:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:15,height:17,viewBox:"0 0 15 17",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M3.00011 0.499875C3.00011 0.267987 2.84067 0.0665279 2.61499 0.0132508C2.38621 -0.0407569 2.15942 0.0747692 2.05148 0.278953C2.0295 0.320845 2.00531 0.361617 1.98053 0.401889C1.92681 0.489179 1.8447 0.612493 1.73468 0.750028C1.51178 1.02865 1.19011 1.34586 0.776503 1.55266C0.529514 1.67616 0.429401 1.97649 0.552896 2.22348C0.676391 2.47047 0.976727 2.57058 1.22372 2.44709C1.52353 2.29718 1.78202 2.11079 2.00011 1.9181V4.49988C2.00011 4.77602 2.22397 4.99988 2.50011 4.99988C2.77625 4.99988 3.00011 4.77602 3.00011 4.49988V0.499875ZM0.646421 6.64639C0.451173 6.84166 0.451196 7.15825 0.646473 7.35349C0.840587 7.54758 1.15457 7.54871 1.35008 7.35691L1.35665 7.35089C1.36458 7.34379 1.37911 7.3312 1.39988 7.31488C1.44165 7.28204 1.50709 7.23533 1.59323 7.18792C1.76518 7.09329 2.01033 7.00073 2.31294 6.99988C2.54021 7.00441 2.72387 7.06465 2.83732 7.14866C2.93306 7.21956 3 7.31935 3 7.49997C3 7.70224 2.92979 7.8191 2.78928 7.93618C2.63792 8.06232 2.44136 8.15961 2.17109 8.29339C2.12524 8.31608 2.07662 8.34015 2.0264 8.36526C1.71266 8.52213 1.32368 8.72875 1.02065 9.06208C0.699189 9.41569 0.5 9.88078 0.5 10.5C0.5 10.7761 0.723858 11 1 11H3.49944C3.77558 11 4 10.7761 4 10.5C4 10.2239 3.77614 9.99999 3.5 9.99999H1.58925C1.63458 9.89327 1.69413 9.80786 1.7606 9.73475C1.92632 9.55245 2.16234 9.41532 2.4736 9.25969C2.51206 9.24046 2.55257 9.22059 2.5946 9.19997C2.85655 9.07147 3.17854 8.91351 3.42947 8.7044C3.75771 8.43086 4 8.04771 4 7.49997C4 6.99553 3.77725 6.60036 3.43244 6.34502C3.10604 6.10332 2.69985 6.00626 2.32563 5.99995L2.31722 5.99988C1.80459 5.99985 1.39261 6.15689 1.11107 6.31184C0.970064 6.38944 0.859422 6.46775 0.781908 6.52868C0.743031 6.55924 0.712117 6.58572 0.689507 6.60596C0.67819 6.6161 0.668917 6.62471 0.661731 6.63152L0.652509 6.64038L0.649072 6.64375L0.647648 6.64516L0.646421 6.64639ZM0.661731 6.63152L0.646421 6.64639C0.646421 6.64639 0.747103 6.55664 0.661731 6.63152ZM2.25011 13.9999C1.97397 13.9999 1.75011 14.2237 1.75011 14.4999C1.75011 14.776 1.97397 14.9999 2.25011 14.9999C2.5929 14.9999 2.78233 15.0966 2.87775 15.183C2.97201 15.2683 3.01072 15.3743 3.00671 15.4811C2.99946 15.6746 2.82083 15.9999 2.25011 15.9999C1.8376 15.9999 1.62396 15.8982 1.52746 15.8339C1.4769 15.8001 1.44973 15.7709 1.43891 15.7579L1.43482 15.7528C1.30449 15.5231 1.01552 15.4332 0.776503 15.5527C0.529514 15.6762 0.429401 15.9765 0.552896 16.2235L0.55361 16.2249L0.554355 16.2264L0.555938 16.2295L0.559484 16.2362L0.56815 16.252C0.574647 16.2635 0.582617 16.2768 0.592216 16.2917C0.611411 16.3216 0.63716 16.3579 0.670686 16.3981C0.737992 16.4789 0.835816 16.5746 0.972759 16.6659C1.25126 16.8516 1.66262 16.9999 2.25011 16.9999C3.27939 16.9999 3.97576 16.3251 4.00601 15.5186C4.01979 15.1511 3.88798 14.7829 3.60959 14.4999C3.88798 14.2168 4.01979 13.8486 4.00601 13.4811C3.97576 12.6746 3.27939 11.9999 2.25011 11.9999C1.66262 11.9999 1.25126 12.1482 0.972759 12.3339C0.835816 12.4251 0.737992 12.5209 0.670686 12.6017C0.63716 12.6419 0.611411 12.6782 0.592216 12.708C0.582617 12.7229 0.574647 12.7363 0.56815 12.7478L0.559484 12.7635L0.555938 12.7703L0.554355 12.7734L0.55361 12.7748L0.552896 12.7763C0.429401 13.0233 0.529514 13.3236 0.776503 13.4471C1.01552 13.5666 1.30449 13.4767 1.43482 13.2469L1.43891 13.2418C1.44973 13.2289 1.4769 13.1996 1.52746 13.1659C1.62396 13.1016 1.8376 12.9999 2.25011 12.9999C2.82083 12.9999 2.99946 13.3251 3.00671 13.5186C3.01072 13.6254 2.97201 13.7314 2.87775 13.8168C2.78233 13.9032 2.5929 13.9999 2.25011 13.9999ZM1.43482 13.2469L1.43279 13.2497L1.43339 13.2488C1.43339 13.2488 1.43583 13.2449 1.43817 13.2408L1.44223 13.2334L1.44465 13.2287L1.44596 13.2262L1.44698 13.2242C1.44309 13.2319 1.43904 13.2395 1.43482 13.2469ZM6.49976 2.99988C6.22361 2.99988 5.99976 3.22374 5.99976 3.49988C5.99976 3.77602 6.22361 3.99988 6.49976 3.99988H14.4998C14.7759 3.99988 14.9998 3.77602 14.9998 3.49988C14.9998 3.22374 14.7759 2.99988 14.4998 2.99988H6.49976ZM6.49976 7.99988C6.22361 7.99988 5.99976 8.22374 5.99976 8.49988C5.99976 8.77602 6.22361 8.99988 6.49976 8.99988H14.4998C14.7759 8.99988 14.9998 8.77602 14.9998 8.49988C14.9998 8.22374 14.7759 7.99988 14.4998 7.99988H6.49976ZM5.99976 13.4999C5.99976 13.2237 6.22361 12.9999 6.49976 12.9999H14.4998C14.7759 12.9999 14.9998 13.2237 14.9998 13.4999C14.9998 13.776 14.7759 13.9999 14.4998 13.9999H6.49976C6.22361 13.9999 5.99976 13.776 5.99976 13.4999Z",fill:"#323130"})))}r.p},20642:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:14,height:16,viewBox:"0 0 14 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M4 0C2.89543 0 2 0.895431 2 2V9H3V2C3 1.44772 3.44772 1 4 1H8V4.5C8 5.32843 8.67157 6 9.5 6H13V14C13 14.5523 12.5523 15 12 15H4C3.44772 15 3 14.5523 3 14V12H2V14C2 15.1046 2.89543 16 4 16H12C13.1046 16 14 15.1046 14 14V5.41421C14 5.01639 13.842 4.63486 13.5607 4.35355L9.64645 0.43934C9.36514 0.158035 8.98361 0 8.58579 0H4ZM12.7929 5H9.5C9.22386 5 9 4.77614 9 4.5V1.20711L12.7929 5ZM4.5 8C4.22386 8 4 8.22386 4 8.5C4 8.77614 4.22386 9 4.5 9H11.5C11.7761 9 12 8.77614 12 8.5C12 8.22386 11.7761 8 11.5 8H4.5ZM0.5 10C0.223858 10 0 10.2239 0 10.5C0 10.7761 0.223858 11 0.5 11H7.5C7.77614 11 8 10.7761 8 10.5C8 10.2239 7.77614 10 7.5 10H0.5ZM4.5 12C4.22386 12 4 12.2239 4 12.5C4 12.7761 4.22386 13 4.5 13H11.5C11.7761 13 12 12.7761 12 12.5C12 12.2239 11.7761 12 11.5 12H4.5Z",fill:"#323130"})))}r.p},20643:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:17,height:16,viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M9.49741 3C9.49741 1.34326 10.8407 0 12.4974 0C14.1541 0 15.4974 1.34326 15.4974 3V5L16.8172 6.11865C17.1727 6.41968 16.9598 7 16.494 7H8.50083C8.0355 7 7.82261 6.41968 8.17759 6.11865L9.49741 5.00024V3ZM12.4974 9C11.8446 9 11.2889 8.58252 11.0829 8H13.912C13.7064 8.58252 13.1507 9 12.4974 9ZM2.5 4H8.49917V3H2.5C1.11929 3 0 4.11929 0 5.5V13.5C0 14.8807 1.11929 16 2.5 16H13.5C14.8807 16 16 14.8807 16 13.5V8H15V13.5C15 14.3284 14.3284 15 13.5 15H2.5C1.67157 15 1 14.3284 1 13.5V6.963L7.74649 10.931L7.82751 10.9693C7.96661 11.0205 8.12311 11.0077 8.25351 10.931L10.8668 9.39318C10.6113 9.17259 10.401 8.90123 10.2516 8.59505L8 9.91991L1 5.802V5.5C1 4.67157 1.67157 4 2.5 4Z",fill:"#323130"})))}r.p},20644:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M8.5 10C9.32843 10 10 10.6716 10 11.5V12C10 13.9714 8.14049 16 5 16C1.85951 16 0 13.9714 0 12V11.5C0 10.6716 0.671573 10 1.5 10H8.5ZM8.5 11H1.5C1.22386 11 1 11.2239 1 11.5V12C1 13.4376 2.43216 15 5 15C7.56784 15 9 13.4376 9 12V11.5C9 11.2239 8.77614 11 8.5 11ZM5 3.5C6.51878 3.5 7.75 4.73122 7.75 6.25C7.75 7.76878 6.51878 9 5 9C3.48122 9 2.25 7.76878 2.25 6.25C2.25 4.73122 3.48122 3.5 5 3.5ZM14 0C15.0544 0 15.9182 0.815878 15.9945 1.85074L16 2V4C16 5.05436 15.1841 5.91817 14.1493 5.99451L14 6H12.499L11.301 7.59979C10.7716 8.30599 9.69652 8.01993 9.52431 7.22426L9.50656 7.11264L9.5008 7L9.5 5.935L9.42237 5.91532C8.69696 5.69685 8.14522 5.07753 8.02463 4.3148L8.00549 4.14926L8 4V2C8 0.945638 8.81588 0.0818349 9.85074 0.00548577L10 0H14ZM5 4.5C4.0335 4.5 3.25 5.2835 3.25 6.25C3.25 7.2165 4.0335 8 5 8C5.9665 8 6.75 7.2165 6.75 6.25C6.75 5.2835 5.9665 4.5 5 4.5ZM14 1H10C9.48716 1 9.06449 1.38604 9.00673 1.88338L9 2V4C9 4.51284 9.38604 4.93551 9.88338 4.99327L10 5H10.5008V7L12 5H14C14.5128 5 14.9355 4.61396 14.9933 4.11662L15 4V2C15 1.48716 14.614 1.06449 14.1166 1.00673L14 1Z",fill:"#323130"})))}r.p},20645:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M11.5 6.5C11.5 5.94772 11.0523 5.5 10.5 5.5C9.94772 5.5 9.5 5.94772 9.5 6.5C9.5 7.05228 9.94772 7.5 10.5 7.5C11.0523 7.5 11.5 7.05228 11.5 6.5ZM6.5 6.5C6.5 5.94772 6.05228 5.5 5.5 5.5C4.94772 5.5 4.5 5.94772 4.5 6.5C4.5 7.05228 4.94772 7.5 5.5 7.5C6.05228 7.5 6.5 7.05228 6.5 6.5ZM6.47361 11.0528C6.22662 10.9293 5.92628 11.0294 5.80279 11.2764C5.67929 11.5234 5.7794 11.8237 6.02639 11.9472C6.60996 12.239 7.3149 12.375 8 12.375C8.6851 12.375 9.39004 12.239 9.97361 11.9472C10.2206 11.8237 10.3207 11.5234 10.1972 11.2764C10.0737 11.0294 9.77338 10.9293 9.52639 11.0528C9.10996 11.261 8.5649 11.375 8 11.375C7.4351 11.375 6.89004 11.261 6.47361 11.0528ZM16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8ZM1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8Z",fill:"#323130"})))}r.p},20646:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o=r(11766);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return o.createElement("svg",i({width:16,height:13,viewBox:"0 0 16 13",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),n||(n=o.createElement("path",{d:"M1 2.5C1.55228 2.5 2 2.05228 2 1.5C2 0.947715 1.55228 0.5 1 0.5C0.447715 0.5 0 0.947715 0 1.5C0 2.05228 0.447715 2.5 1 2.5ZM4 1.5C4 1.22386 4.22386 1 4.5 1H15.5C15.7761 1 16 1.22386 16 1.5C16 1.77614 15.7761 2 15.5 2H4.5C4.22386 2 4 1.77614 4 1.5ZM4 6.5C4 6.22386 4.22386 6 4.5 6H15.5C15.7761 6 16 6.22386 16 6.5C16 6.77614 15.7761 7 15.5 7H4.5C4.22386 7 4 6.77614 4 6.5ZM4.5 11C4.22386 11 4 11.2239 4 11.5C4 11.7761 4.22386 12 4.5 12H15.5C15.7761 12 16 11.7761 16 11.5C16 11.2239 15.7761 11 15.5 11H4.5ZM2 11.5C2 12.0523 1.55228 12.5 1 12.5C0.447715 12.5 0 12.0523 0 11.5C0 10.9477 0.447715 10.5 1 10.5C1.55228 10.5 2 10.9477 2 11.5ZM1 7.5C1.55228 7.5 2 7.05228 2 6.5C2 5.94772 1.55228 5.5 1 5.5C0.447715 5.5 0 5.94772 0 6.5C0 7.05228 0.447715 7.5 1 7.5Z",fill:"#323130"})))}r.p},20647:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(12961),o=r(13243),i=r(13242),a=r(12754),c=r(15028),s=r(11766),l=r.n(s),u=r(13016),p=r(20648),f=r(13240),d=r(13031);function m(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){m(i,n,o,a,c,"next",e)}function c(e){m(i,n,o,a,c,"throw",e)}a(void 0)}))}}function y(e){var[t,r]=Object(s.useState)(!1),[m,y]=Object(s.useState)(""),[v,h]=Object(s.useState)(null),{effects:g,palette:O}=Object(a.Y)(),w=Object(a.db)({panelContainer:{backgroundColor:O.white,padding:"8px 16px",margin:"16px 0",borderRadius:8,boxShadow:g.elevation4},responseActionContainer:{display:"flex",alignItems:"center",margin:"18px 0px"},spinner:{display:"inline-block",marginRight:8}}),{strings:E}=e,C={root:{margin:"5px 0 26px 0"},field:{"&::placeholder":{color:O.neutralTertiary}},fieldGroup:{border:"1px solid ".concat(O.neutralSecondaryAlt),borderRadius:2}},S={root:{display:"flex",width:"100%",justifyContent:"center",border:"1px solid ".concat(O.neutralSecondaryAlt),borderRadius:2},flexContainer:{color:t?O.themePrimary:O.neutralPrimary,fontWeight:a.l.semibold}},P={root:{marginBottom:20},fieldGroup:{border:"1px solid ".concat(O.neutralLight),backgroundColor:O.neutralLighterAlt,borderRadius:2,fontFamily:'Consolas, "Courier New", monospace'},field:{fontSize:13}};return l.a.createElement(l.a.Fragment,null,v&&l.a.createElement(u.a,{type:u.c.error,onRenderBody:()=>T(),ariaLabel:T()}),l.a.createElement("div",{className:w.panelContainer},l.a.createElement(c.a,{label:E.CreatePanel.Label,multiline:!0,required:!0,rows:10,styles:C,value:e.instruction,disabled:t,placeholder:E.CreatePanel.Placeholder,onChange:t=>e.onChangeInstruction(t.currentTarget.value)}),l.a.createElement("div",{className:w.responseActionContainer},l.a.createElement(n.a,{onClick:function(){return j.apply(this,arguments)},disabled:!e.instruction||t,styles:S,onRenderText:()=>{var e=E.CreatePanel;return l.a.createElement(l.a.Fragment,null,t&&l.a.createElement(o.a,{size:i.a.medium,className:w.spinner}),l.a.createElement("span",null,t?e.PrepareResponse:e.TestButton))}}))),!!m&&!t&&!v&&l.a.createElement("div",{className:w.panelContainer},l.a.createElement(c.a,{label:E.CreatePanel.Response,multiline:!0,readOnly:!0,autoAdjustHeight:!0,value:m,styles:P})));function j(){return(j=b((function*(){if(!t){r(!0),h(null);try{e.telemetryService.tagEvent(f.c.GptTestPrompt);var n=yield e.gptService.completePrompt(e.instruction);y(n)}catch(o){h(o)}r(!1)}}))).apply(this,arguments)}function T(){var e,t=E.CreatePanel.Errors,r=Object(p.d)(v);if(r){var n,o;switch(null===(n=r.error)||void 0===n||null===(n=n.properties)||void 0===n?void 0:n.BackendErrorCode){case p.b.ContentFilteredByDependency:case p.b.InputContentFiltered:case p.b.ResponseContentFiltered:return r.clientRequestId?Object(d.a)(t.ErrorWithIdFormat,t.ContentFiltered,"ClientRequestId: ".concat(r.clientRequestId)):t.ContentFiltered}switch(null===(o=r.error)||void 0===o?void 0:o.code){case p.a.ThrottledByDependency:return t.ModelAtCapacity;case p.a.TooManyRequests:return t.TooManyRequests;case p.b.InvalidInferenceInput:case p.b.InvalidPredictionInput:return k(r.error.innerErrors)||E.CreatePanel.GenericError}}return k(null==r||null===(e=r.error)||void 0===e?void 0:e.innerErrors)||E.CreatePanel.GenericError}function k(e){if(e){var t=E.CreatePanel.Errors;for(var r of e)switch(r.code){case p.b.TooManyInputTokens:return t.TooManyInputTokens;case p.b.InputFiltered:return t.ContentFiltered;case p.b.InvalidModelParameters:return t.InvalidModelParameters;case p.b.NullResponse:return t.EmptyResponse}}}}},20649:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o,i,a,c,s=r(11766);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e){return s.createElement("svg",l({width:24,height:24,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},e),s.createElement("mask",{id:"mask0_11549_132886",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:48,height:48},n||(n=s.createElement("path",{d:"M24 2.29167L20.9942 0.569608C20.3784 0.216771 19.6216 0.216772 19.0058 0.569608L5.00578 8.59044C4.38372 8.94683 4 9.6089 4 10.3258V14.0833L1.00578 15.7988C0.383721 16.1552 0 16.8172 0 17.5341V30.9659C0 31.6828 0.383722 32.3448 1.00578 32.7012L8 36.7083V39.9659C8 40.6828 8.38372 41.3448 9.00578 41.7012L19.0058 47.4304C19.6216 47.7832 20.3784 47.7832 20.9942 47.4304L24 45.7083L27.0058 47.4304C27.6216 47.7832 28.3784 47.7832 28.9942 47.4304L38.9942 41.7012C39.6163 41.3448 40 40.6828 40 39.9659V36.7083L46.9942 32.7012C47.6163 32.3448 48 31.6828 48 30.9659V17.5341C48 16.8172 47.6163 16.1552 46.9942 15.7988L44 14.0833V10.3258C44 9.6089 43.6163 8.94683 42.9942 8.59044L28.9942 0.569608C28.3784 0.216772 27.6216 0.216771 27.0058 0.569607L24 2.29167Z",fill:"#C4C4C4"}))),s.createElement("g",{mask:"url(#mask0_11549_132886)"},o||(o=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.0002 0L32.0002 6.875V6.87528L35.9998 9.16667V30.1667L32.0002 32.4581V41.125L20.0002 48L8.00024 41.125V36.7089L0 32.1254V16.3754L3.99976 14.0839V9.16667L19.9998 0L20 0.00013878L20.0002 0Z",fill:"url(#paint0_linear_11549_132886)"})),s.createElement("g",{filter:"url(#filter0_dd_11549_132886)"},s.createElement("mask",{id:"mask1_11549_132886",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:24,y:0,width:24,height:50},i||(i=s.createElement("rect",{x:24,width:24,height:49.5,fill:"#C4C4C4"}))),a||(a=s.createElement("g",{mask:"url(#mask1_11549_132886)"},s.createElement("path",{d:"M28 0L44 9.16667V30.1667L28 39.3333L12 30.1667V9.16667L28 0Z",fill:"url(#paint1_linear_11549_132886)"}),s.createElement("path",{d:"M35.0058 10.0701C35.6216 9.71726 36.3784 9.71726 36.9942 10.0701L48 16.3755V32.1255L36 39.0005L24 32.1255V16.3755L35.0058 10.0701Z",fill:"url(#paint2_linear_11549_132886)"}),s.createElement("path",{d:"M27.0055 21.5696C27.6214 21.2168 28.3781 21.2168 28.994 21.5696L38.994 27.2988C39.616 27.6552 39.9998 28.3172 39.9998 29.0341V41.125L27.9998 48L15.9998 41.125V27.875L27.0055 21.5696Z",fill:"url(#paint3_linear_11549_132886)"}))))),c||(c=s.createElement("defs",null,s.createElement("filter",{id:"filter0_dd_11549_132886",x:20,y:-3,width:32,height:56,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dy:.2}),s.createElement("feGaussianBlur",{stdDeviation:.2}),s.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.24 0"}),s.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_11549_132886"}),s.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dy:1}),s.createElement("feGaussianBlur",{stdDeviation:2}),s.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.32 0"}),s.createElement("feBlend",{mode:"normal",in2:"effect1_dropShadow_11549_132886",result:"effect2_dropShadow_11549_132886"}),s.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect2_dropShadow_11549_132886",result:"shape"})),s.createElement("linearGradient",{id:"paint0_linear_11549_132886",x1:19.9999,y1:49.25,x2:10.9998,y2:205314e-10,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#045B99"}),s.createElement("stop",{offset:1,stopColor:"#0A7EC4"})),s.createElement("linearGradient",{id:"paint1_linear_11549_132886",x1:28,y1:-3.5,x2:44,y2:39.3333,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#5AC5F2"}),s.createElement("stop",{offset:1,stopColor:"#24A7E8"})),s.createElement("linearGradient",{id:"paint2_linear_11549_132886",x1:34,y1:8.00049,x2:43.5,y2:39.0005,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#79D8F9"}),s.createElement("stop",{offset:1,stopColor:"#5AC5F2"})),s.createElement("linearGradient",{id:"paint3_linear_11549_132886",x1:27.9998,y1:21,x2:34.9517,y2:47.4206,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#A3EBFF"}),s.createElement("stop",{offset:1,stopColor:"#79D8F9"})))))}r.p},20650:function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var n=r(11766),o=r(20323),i=r(20419),a=r(20313),c=r(20321),s=r(12706),l=r(20651),u=r(20652),p=r(19713),f=r(17371),d=r(19940),m=r(19936),b=r(15027),y=r(20406),v=r(14918);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return(t=C(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C(n.key),n)}}function C(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=T(e);if(t){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return j(this,r)}}function j(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(g,e);var t,r,i,a=P(g);function g(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=a.call(this,e)).parameterService=void 0,t.getClassNames=Object(s.a)(),t.classNames=t.getClassNames(l.a),t._editorContext=Object(p.a)(),t.renderEditor=e=>{var r,o=null===(r=t.parameterService)||void 0===r?void 0:r.getParameterInfo().parameterName,i=t.state.value,{editorOptions:{locale:a}}=t.props;switch(o){case"interval":return n.createElement(b.b,{ariaLabel:t._editorContext.designerResources.Create.ScheduledIntervalAria,value:i,onChange:t.onIntervalChange,onBlur:t.onRepeatChange});case"frequency":return n.createElement(f.a,{ariaLabel:t._editorContext.designerResources.Create.ScheduledFrequencyAria,options:t.frequencyOptions,selectedKey:i,onChange:t.onFrequencyChange});case"startTime":return n.createElement(u.a,{datePickerAriaLabel:t._editorContext.designerResources.Create.ScheduledStartingDateAria,timePickerAriaLabel:t._editorContext.designerResources.Create.ScheduledStartingTimeAria,value:i&&Object(v.M)(i)?new Date(i):new Date,onChange:t.onStartTimeChange,useHour12:Object(v.L)(a)});default:return null}},t.onStartTimeChange=e=>{if(e){var r=e.toISOString();t.commitChanges(r)}},t.onIntervalChange=(e,r)=>{t.setState({value:r})},t.onRepeatChange=e=>{var r=t.state.value;r&&t.commitChanges(r)},t.onFrequencyChange=(e,r)=>{var n=null==r?void 0:r.key;n&&t.commitChanges(String(n))},t.commitChanges=e=>{t.props.onChange({value:Object(y.e)(e)}),t.setState({value:e})},t.shouldHideLabelForParameter=e=>t._editorContext.widgetUtilService.isWidgetPage()&&t._editorContext.widgetUtilService.isExcelSDXContext()&&"frequency"===e,t.frequencyOptions=Object(d.a)(m.b).map(e=>({key:e,text:t._editorContext.designerResources.Recurrence.Frequency[e],selected:m.b[e]===m.b.Minute,data:e}));var{editorState:r}=t.props,o=(r.value.length&&r.value[0]||{tokenExpression:""}).tokenExpression;return t.state={value:o},t.parameterService=t.props.editorContext.getService(c.a.PARAMETER),t}return t=g,(r=[{key:"render",value:function(){var e,t,r,i=null===(e=this.parameterService)||void 0===e?void 0:e.getParameterInfo().parameterName;switch(i){case"interval":case"frequency":r=this.classNames.inline,t=O(O({},this.props),{},{editorOptions:O(O({},this.props.editorOptions),{},{displayName:this.shouldHideLabelForParameter(i)?" ":this.props.editorOptions.displayName,isRequired:!this.shouldHideLabelForParameter(i)})});break;case"schedule_hours":case"schedule_minutes":case"timeZone":r=this.classNames.noDisplay,t=O({},this.props);break;case"startTime":default:t=this.props,r=this.classNames.row}return n.createElement("div",{className:r},n.createElement(o.a,h({},t,{onRenderEditor:this.renderEditor,required:!this.shouldHideLabelForParameter(i)})))}}])&&E(t.prototype,r),i&&E(t,i),Object.defineProperty(t,"prototype",{writable:!1}),g}(n.Component),R=Object(i.a)((e,t)=>!!t.editorContext&&Object(a.c)(e.editorState.value,t.editorState.value))(k)},20651:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({inline:["fl-ScheduleEditor-Inline",{selectors:{".msla-input-parameter-item &":{}},".msla-input-parameter-item":{},".msla-input-parameter-label":{minHeight:"20.5px"}}],row:["fl-ScheduleEditor-Row",{width:"100%",selectors:{".fl-DateFromToPicker-dateTimeFormInput":{".ms-ComboBox-Input":{height:"100%"}},".fl-DateFromToPicker-dateFormInputElement":{height:"32px",width:"100%"}}}],noDisplay:["fl-ScheduleEditor-NoDisplay",{display:"none"}]})},20657:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(11766),o=r.n(n),i=r(20658),a=r(13028),c=e=>{var t=Object(a.a)();return o.a.createElement(o.a.Suspense,{fallback:o.a.createElement("div",null,t.Common.Loading)},o.a.createElement(i.a,e))}},20658:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(11766),o=r.n(n).a.lazy(()=>Promise.all([r.e(230),r.e(194),r.e(269),r.e(222)]).then(r.bind(null,33033)).then(e=>({default:e.EmojiPickerEditorV1})))},20659:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11809),o=r(11896),i=Object(o.a)({teamName:n.a.PowerAutomateClientTeam,owners:["pautomakersat"],description:"Controls the Emoji Picker experience that will be used for the Reactions trigger in Teams connector.",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1585631",createdOn:"04/15/2025",fallback:{isEmojiPickerEnabled:!1}}),{getFeatureValue:a}=Object(o.b)(i,"isEmojiPickerEnabled")},20660:function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var n=r(14769),o=r(11766),i=r(16962),a=r(20661),c=r(20667),s=r(20665),l=r(15922),u=r(15919),p=r(17887),f=r(15270),d=r(15272),m=r(16749),b=r(15409),y=r(14883),v=r(20701),h=r(20702),g=r(20703),O=r(20714),w=r(20723),E=r(18968),C=r(12366);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}function k(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var R=function(){function e(t,r,s,h,g){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureFlags=t,this.networkContext=r,this.clientResources=s,this.routeCrafter=h,this.environmentContext=g,this.safeLocalStorage=void 0,this.renderCredentialPicker=e=>{var{configItem:t,mappedConfigItems:r,onConfigItemChange:n,onError:i,disabled:a}=e,s=Object(v.a)(r.map(e=>e.parameterCredentialMapping));return o.createElement(this.AppProvidersWrapper,null,o.createElement(c.c,{label:void 0,placeholder:this.clientResources.Designer.Editors.CredentialSwitch.PlaceholderText,selectedCredentialId:t.value.selectedCredentialKey,onChange:(e,r)=>{var o=P(P({},t.value),{},{selectedCredentialKey:e,eventData:r});n({configItem:t,value:o})},onMappingLoaded:e=>{var o=t.credentialMapping.mappingInfos.parametersMappings;r.forEach(t=>{var r,i=(r=t).key.startsWith("PARAMETER:")?r.key.substring("PARAMETER:".length):void 0,a=i&&e&&function(e,t,r){if(r[e])for(var n of r[e]){var o=t[n.credentialKeyName];if(o)return o}return}(i,e,o);n({configItem:t,value:a})})},connectionTypes:s,styles:{root:{width:"100%"}},routeCrafter:this.routeCrafter,environmentStore:this.environmentContext.environmentStore,onError:i,disabled:a}))},this.AppProvidersWrapper=e=>{var{children:t}=e;return o.createElement(u.a.Provider,{value:{useFlowServiceClientResources:()=>this.clientResources}},o.createElement(p.a,{value:this.networkContext},o.createElement(l.a.Provider,{value:this.environmentContext},o.createElement(n.a,{client:d.a},o.createElement(i.a,{client:d.b},o.createElement(f.a.Provider,{value:this.safeLocalStorage},t))))))},this.shouldRenderDesktopFlowTargetIdEditor=(e,t)=>(Object(m.a)()||this.featureFlags.enableDesktopFlowConnectivityVNext)&&!!t&&Object(E.b)(t)&&Object(y.e)(e.key,C.B.connectionParametersSetConfigKey.targetId),this.renderTeachingBubbles=e=>{var{switchButtonRef:t}=e;return o.createElement(this.AppProvidersWrapper,null,o.createElement(a.a,{clientResources:this.clientResources,safeLocalStorage:this.safeLocalStorage,switchButtonRef:t,routeCrafter:this.routeCrafter,telemetryService:this.networkContext.telemetryService}))},this.safeLocalStorage=new b.a(r.loggingService)}var t,r,S;return t=e,(r=[{key:"render",value:function(e){return this.shouldRenderDesktopFlowTargetIdEditor(e.configItem,e.connectorId)?Object(E.c)(e.connectorId)?o.createElement(this.AppProvidersWrapper,null,o.createElement(w.a,e)):this.featureFlags.enableTargetPickerDistantSearch?o.createElement(this.AppProvidersWrapper,null,o.createElement(O.a,e)):o.createElement(this.AppProvidersWrapper,null,o.createElement(g.a,e)):o.createElement(h.a,e)}},{key:"shouldRender",value:function(e,t){return this.shouldRenderDesktopFlowTargetIdEditor(e,t)}},{key:"getCredentialParameterOptions",value:function(e){var{connectorId:t,parameters:r}=e;if(!this.featureFlags.enableCredentialsManager)return[];var n=this.getConnectionParameterSetsCredentialInfos(r);return n&&this.networkContext.telemetryService.tagEvent(s.b.ConnectionParameter_CredentialMappingParsed,{connectorId:t}),n.map(e=>({mappingInfos:e,render:this.renderCredentialPicker}))}},{key:"getConnectionParameterSetsCredentialInfos",value:function(e){var t={},r=this.clientResources.Designer.Editors.CredentialSwitch;for(var[n,o]of Object.entries(e)){var i;if(null!==(i=o.uiDefinition)&&void 0!==i&&i.credentialMapping){var a,c,s,l=o.uiDefinition.credentialMapping.mappingName,u=o.uiDefinition.credentialMapping.displayName||"",p=o.uiDefinition.credentialMapping.tooltip||void 0;null!==(a=t[l])&&void 0!==a||(t[l]={mappingName:l,displayName:u,tooltip:p,useCredentialSwitch:{isVisible:!0,defaultValue:!1,switchOn:{label:r.SwitchOnLabel,tooltip:r.SwitchOnTooltip},switchOff:{label:r.SwitchOffLabel,tooltip:r.SwitchOffTooltip},renderTeachingBubbles:this.renderTeachingBubbles},parametersMappings:{}}),(c=t[l]).displayName||(c.displayName=u),(s=t[l]).tooltip||(s.tooltip=p),t[l].parametersMappings[n]=o.uiDefinition.credentialMapping.values.slice()}}return Object.values(t)}}])&&T(t.prototype,r),S&&T(t,S),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20661:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(12754),o=r(17934),i=r(12821),a=r(11766),c=r.n(a),s=r(20662),l=r(15941),u=r(13029),p=r(14682),f=r(20663),d=r(20666),m=r(14901),b=r(20664),y=r(20665);function v(e){var{clientResources:t,switchButtonRef:r,routeCrafter:a,telemetryService:v}=e,h=Object(d.a)(),g="doNotShowCredentialMappingTeachingBubble",O=!0,{isTeachingBubbleHidden:w,hideTeachingBubble:E}=Object(b.a)(g,O);if(w)return null;var C=t.Designer.Editors.CredentialSwitch.TeachingBubbles,S=Object(n.Y)();return c.a.createElement(o.a,{"data-automation-id":f.a.credentialMappingTeachingBubble.root,headline:C.Title,target:r,calloutProps:{directionalHint:i.a.rightCenter,preventDismissOnEvent:e=>("scroll"===e.type||"resize"===e.type)&&(h(),!0)},primaryButtonProps:Object(p.b)(f.a.credentialMappingTeachingBubble.goToCredentialsButton,{primary:!0,text:C.GoToCredentialButtonText,href:Object(m.j)(a),onClick:()=>{v.tagEvent(y.b.CredentialMappingTeachingBubble_GoToCredentialsButton_Clicked)},target:u.a.blank,styles:{textContainer:{color:"".concat(S.palette.themePrimary," !important")}}}),secondaryButtonProps:Object(p.b)(f.a.credentialMappingTeachingBubble.dismissButton,{text:C.DiscardButtonText,onClick:()=>{v.tagEvent(y.b.CredentialMappingTeachingBubble_DismissButton_Clicked),E()}}),onDismiss:E},c.a.createElement(l.a,{interpolatedString:C.DescriptionFormat,linkProps:{href:s.a.LearnMoreAboutCredentials,target:u.a.blank,ariaLabel:C.LearnMoreAriaLabel,styles:{root:{color:"".concat(S.semanticColors.primaryButtonText," !important")}},onClick:()=>{v.tagEvent(y.b.CredentialMappingTeachingBubble_LearnMoreLink_Clicked)}},textColor:"".concat(S.semanticColors.primaryButtonText)}))}},20663:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={credentialMappingTeachingBubble:{root:"credentialMappingTeachingBubble",goToCredentialsButton:"goToCredentialsButton",dismissButton:"dismissButton"},connectionParameterToggleContent:{root:"connectionParameterToggleContent",button:"connectionParameterToggleContentButton",content:"connectionParameterToggleContentContent"},messageBar:{copilotExplainErrorButton:"copilot-explain-error",group:"designerMessageBarGroup"}}},20701:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(15431);function o(e){var t=e.map(e=>(null==e?void 0:e.values.map(e=>e.typeEnumValue))||[]);return Object(n.d)(t)}},20702:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(15027),o=r(13009),i=r(13031),a=r(11766),c=r(19713);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){f(r,e);var t=m(r);function r(){var e;s(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call(this,...o)).onChange=t=>{e.props.onConfigItemChange({configItem:e.props.configItem,value:t})},e}return u(r,[{key:"render",value:function(){return a.createElement("div",{style:{width:"100%"}},a.createElement(h,{configItemKey:this.props.configItem.key,connectorId:this.props.connectorId,disabled:this.props.disabled,value:this.props.configItem.value,onChange:this.onChange}))}}]),r}(a.Component),h=function(e){f(r,e);var t=m(r);function r(){var e;s(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call(this,...o))._editorContext=Object(c.a)(),e.onChange=(t,r)=>{e.props.onChange&&r&&e.props.onChange(r)},e}return u(r,[{key:"componentDidMount",value:function(){this._editorContext.loggingService.logError("flowDesignerConnectionParameterEditorService.unexpectedDefaultRender",new o.a(o.c.connectionParameterEditorServiceUnexpectedRenderCall,Object(i.a)(this._editorContext.designerResources.ConnectionParameterService.FailedToRenderConfigItem,this.props.configItemKey,this.props.connectorId)))}},{key:"render",value:function(){return a.createElement(n.b,{value:this.props.value||"",onChange:this.onChange,disabled:this.props.disabled})}}]),r}(a.Component)},20703:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(19713),i=r(20704);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(){var e;a(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=p.call(this,...r))._editorContext=Object(o.a)(),e.onTargetSelected=t=>{e.props.onConfigItemChange({configItem:e.props.configItem,value:t})},e}return t=f,(r=[{key:"render",value:function(){return n.createElement("div",{style:{width:"100%"}},n.createElement(i.a,{disabled:this.props.disabled,onTargetSelected:this.onTargetSelected,onError:this.props.onError,selectedTargetId:this.props.configItem.value,ariaLabel:this.props.configItem.label,environmentCapabilityService:this._editorContext.environmentCapabilityService,environmentCapabilityStore:this._editorContext.environmentCapabilityStore,environmentStore:this._editorContext.environmentStore,designerResources:this._editorContext.designerResources,loggingService:this._editorContext.loggingService,machineManagementStore:this._editorContext.machineManagementStore,xrmMachineManagementService:this._editorContext.xrmMachineManagementService}))}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20704:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n,o=r(12706),i=r(12839),a=r(15548),c=r(12754),s=r(14337),l=r(11766),u=r(20705),p=r(20713),f=r(15991),d=r(20472),m=r(15941),b=r(12366),y=r(13029),v=r(17276),h=r(20629);function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=P(e);if(t){var o=P(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=r(14678).a.dropdowns.desktopFlowTargetPicker,T=Object(s.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(C,e);var t,r,n,O=E(C);function C(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,C),(t=O.call(this,e)).store=void 0,t.getClassNames=Object(o.a)(),t.classNames=t.getClassNames(p.a),t.async=new i.a(S(t)),t.renderHeader=()=>l.createElement(h.a,{currentSearchText:t.store.currentSearchText,onRefreshList:t.onRefreshTargetList,onSearch:t.onSearch,onSearchBoxClear:t.onSearchBoxClear,onSearchChange:t.onSearchChangeDebounced,placeHolderText:t.props.designerResources.RpaEditorPickerHeader.Searchbox.PlaceholderDefault,clientResources:t.props.designerResources,searchBoxAutomationId:j.targetsDropdownOptions.searchTextField,buttonAutomationId:j.targetsDropdownOptions.refreshButton}),t.onSearchChangeDebounced=t.async.debounce(e=>{t.searchInternal(e)},b.h.search),t.onSearch=e=>{t.searchInternal(e)},t.onSearchBoxClear=()=>{t.store.search(void 0)},t.searchInternal=e=>{e&&e.trim()?t.store.search(e):t.store.search(void 0)},t.onRefreshTargetList=()=>{t.loadTargetList(),t.store.search(t.store.currentSearchText)},t.renderEmpty=()=>{var{designerResources:e}=t.props;return l.createElement(s.a,null,()=>{var r,n;return t.store.currentSearchText?(r=Object(a.a)(e.Designer.Editors.CustomValue.Empty.SearchTitle,t.store.currentSearchText),n=e.Designer.Editors.CustomValue.Empty.SearchMessage):(r=e.DesktopFlowTargetPicker.EmptyResults.Title,n=e.DesktopFlowTargetPicker.EmptyResults.Description),l.createElement("div",{className:t.classNames.emptyResultsContainer},l.createElement("div",{className:t.classNames.emptyResultsTitle},r),l.createElement("div",{className:t.classNames.emptyResultsMessage},t.store.currentSearchText&&n,!t.store.currentSearchText&&l.createElement(m.a,{textColor:Object(c.Y)().palette.neutralSecondary,interpolatedString:n,linkProps:{ariaLabel:e.Monitor.TargetsListPage.LearnMoreAriaLabel,href:f.a.learnMoreManageMachines,target:y.a.blank}})))})},t.onChange=(e,r,n)=>{r&&t.props.onTargetSelected&&t.props.onTargetSelected(r.key)},t.onDismissDropdown=()=>{t.async.setTimeout(()=>{t.onSearchBoxClear()},b.h.search)},t.store=new u.a(e.xrmMachineManagementService,e.machineManagementStore,e.environmentCapabilityService,e.environmentCapabilityStore,e.environmentStore,e.loggingService,e.designerResources),t}return t=C,(r=[{key:"componentDidMount",value:function(){this.store.loadDataAsync(this.props.onError).catch(e=>{this.props.loggingService.logError("DesktopFlowTargetPicker.loadDataAsync",e)})}},{key:"render",value:function(){var{designerResources:e}=this.props,t=this.store.collection;return l.createElement(d.a,{ariaLabel:this.props.ariaLabel,hideCustomAdd:!0,disabled:this.props.disabled||!this.store.isMachineManagementSupported,isLoading:this.store.isLoading,placeholder:this.store.isLoading?e.Common.Loading:e.DesktopFlowTargetPicker.Dropdown.Placeholder,selectedKey:this.props.selectedTargetId,onChange:this.onChange,options:this.store.getDropdownTargetOptions(this.props.selectedTargetId),hasMoreOptions:t&&t.hasMore,onRenderEmptyResults:this.renderEmpty,onRenderHeader:this.renderHeader,onDismiss:this.onDismissDropdown,clientResources:e,dataAutomationId:j.root,calloutDataAutomationId:j.targetsDropdownOptions.root,label:this.props.label,onRenderLabel:this.props.onRenderLabel,required:this.props.required})}},{key:"loadTargetList",value:function(){var{designerResources:e}=this.props;v.a.announce(e.DesktopFlowTargetPicker.ScreenReader.MachineRetrieving),this.store.loadDataAsync(this.props.onError,!0)}}])&&g(t.prototype,r),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),C}(l.Component))||n},20705:function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var n,o,i,a,c=r(13021),s=r(15548),l=r(14678),u=r(11773),p=r(15991),f=r(20706),d=r(16841),m=r(15985),b=r(20708),y=r(13120),v=r(15992),h=r(13085),g=r(15430),O=r(14682),w=r(17276);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function T(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function k(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var R=(o=k((n=function(){function e(t,r,n,l,u,p,d){var y=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.machineManagementService=t,this.machineManagementStore=r,this.environmentCapabilityService=n,this.environmentCapabilityStore=l,this.environmentStore=u,this.loggingService=p,this.clientResources=d,this.connectorMachineGroupListFilter={filters:{machineGroupTypes:[m.b.Standard,m.b.Default],accessList:[],groupCapacity:[],managementType:[]},orderBy:f.b},this.collectionType=b.b.getMachineGroupCollectionType(this.connectorMachineGroupListFilter),P(this,"currentSearchText",o,this),P(this,"loadDataAsync",i,this),P(this,"search",a,this),this.browseMachineGroups=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=y.loggingService.profileStart(h.a.rpaConnectionCardMachineLoadStart);return y.machineManagementService.browseMachineGroups(y.connectorMachineGroupListFilter,!1,b.b.getMachineGroupCollectionType(y.connectorMachineGroupListFilter),t).then(()=>{y.loggingService.profileEndWithSuccess(r,h.a.rpaConnectionCardMachineLoadEnd)}).catch(t=>{if(e){var n=Object(s.a)(y.clientResources.DesktopFlowTargetPicker.FailedToLoadData,t&&t.message||"");e(n,c.a.error)}throw y.loggingService.profileEnd(r,h.a.rpaConnectionCardMachineLoadEnd,Object(v.i)(t),t),t})}}var t,r,n;return t=e,(r=[{key:"isLoading",get:function(){var e=this.collection;return!e||e.isCollectionLoading}},{key:"collection",get:function(){return this.machineManagementStore.machineGroups.getCollection(this.collectionType)}},{key:"getDropdownTargetOptions",value:function(e){if(this.collection&&this.collection.list){var t=this.collection.list.filter(e=>this.machineManagementStore.machineGroups.hasEntity(e)&&this.machineManagementStore.machineGroups.getEntity(e).properties.type!==d.j.Keyless).map(e=>x(this.machineManagementStore.machineGroups.getEntity(e)));if(this.currentSearchText){var r;if(e&&this.machineManagementStore.machineGroups.hasEntity(e)){var n=this.machineManagementStore.machineGroups.getEntity(e);r=C(C({},x(n)),{},{hidden:!0})}var o=t.filter(e=>e.text.toLowerCase().includes(this.currentSearchText.toLowerCase()));return r&&!o.some(e=>e.key===r.key)?o.concat(r):o}return t}return[]}},{key:"isMachineManagementSupported",get:function(){var e=this.environmentStore.currentEnvironmentName,t=g.a.getEnvironmentCapabilityKey({environmentName:e,capabilityName:y.b.isMachineManagementSupported}),r=this.environmentCapabilityStore.environmentCapabilities.getEntity(t);return r?r.isEnabled:null}}])&&j(t.prototype,r),n&&j(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"currentSearchText",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=k(n.prototype,"loadDataAsync",[u.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.environmentCapabilityService.getIsMachineManagementSolutionSupported().catch(r=>{throw t&&t(e.clientResources.Monitor.UpgradeCdsSolution.FailedToRetrieveOrgInfo,c.a.error),r}).then(()=>{if(null===e.isMachineManagementSupported)return t&&t(e.clientResources.Monitor.UpgradeCdsSolution.FailedToRetrieveOrgInfo,c.a.error),Promise.resolve();if(!1===e.isMachineManagementSupported){if(t){var n=Object(s.a)(e.clientResources.Monitor.UpgradeCdsSolution.DetailsWithLearnMorePlainLinkFormat,p.a.learnMoreUpdateMachineManagementSolution);t(n,c.a.error)}return Promise.resolve()}return e.browseMachineGroups(t,r)})}}}),a=k(n.prototype,"search",[u.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.currentSearchText=e;var t=this.getDropdownTargetOptions();w.a.announce(Object(s.a)(this.clientResources.RpaEditorPicker.Search.ScreenReaderAnnouncementFormat,t.length))}}}),k(n.prototype,"isLoading",[u.computed],Object.getOwnPropertyDescriptor(n.prototype,"isLoading"),n.prototype),k(n.prototype,"collection",[u.computed],Object.getOwnPropertyDescriptor(n.prototype,"collection"),n.prototype),k(n.prototype,"isMachineManagementSupported",[u.computed],Object.getOwnPropertyDescriptor(n.prototype,"isMachineManagementSupported"),n.prototype),n);function x(e){return{key:e.name,text:e.properties.displayName,[O.a]:l.a.dropdowns.desktopFlowTargetPicker.targetsDropdownOptions.option}}},20713:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({emptyResultsContainer:["fl-DesktopFlowTargetPicker-EmptyResultsContainer",{color:Object(n.Y)().palette.neutralSecondary,minHeight:150,overflowY:"auto",padding:20,textAlign:"center"}],emptyResultsMessage:["fl-DesktopFlowTargetPicker-EmptyResultsMessage",{fontSize:n.k.smallPlus,margin:10}],emptyResultsTitle:["fl-DesktopFlowTargetPicker-EmptyResultsTitle",{fontWeight:n.l.semibold}]})},20714:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(19713),i=r(20715);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,s,p=u(f);function f(){var e;a(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=p.call(this,...r))._editorContext=Object(o.a)(),e.onTargetSelected=t=>{e.props.onConfigItemChange({configItem:e.props.configItem,value:t})},e}return t=f,(r=[{key:"render",value:function(){return n.createElement("div",{style:{width:"100%"}},n.createElement(i.a,{disabled:this.props.disabled,onTargetSelected:this.onTargetSelected,onError:this.props.onError,selectedTargetId:this.props.configItem.value,ariaLabel:this.props.configItem.label,environmentCapabilityService:this._editorContext.environmentCapabilityService,environmentCapabilityStore:this._editorContext.environmentCapabilityStore,environmentStore:this._editorContext.environmentStore,flowServiceClientResources:this._editorContext.designerResources,loggingService:this._editorContext.loggingService,machineManagementStore:this._editorContext.machineManagementStore,xrmMachineManagementService:this._editorContext.xrmMachineManagementService}))}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},20715:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n,o=r(12812),i=r(12754),a=r(12706),c=r(12839),s=r(14337),l=r(11766),u=r(15991),p=r(20472),f=r(15941),d=r(12366),m=r(13029),b=r(17276),y=r(13031),v=r(20629),h=r(20716),g=r(20717),O=r(19220);function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function C(e,t){return(C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=T(e);if(t){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return P(this,r)}}function P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return j(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=Object(s.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(P,e);var t,r,n,E=S(P);function P(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,P),(t=E.call(this,e)).store=void 0,t.getClassNames=Object(a.a)(),t.classNames=t.getClassNames(h.a),t.async=new c.a(j(t)),t.renderHeader=()=>l.createElement(v.a,{currentSearchText:t.store.currentSearchText,onRefreshList:t.reloadTargetList,onSearch:t.onSearch,onSearchBoxClear:t.onSearchBoxClear,onSearchChange:t.onSearchChangeDebounced,placeHolderText:t.props.flowServiceClientResources.RpaEditorPickerHeader.Searchbox.PlaceholderDefault,clientResources:t.props.flowServiceClientResources,searchBoxAutomationId:O.l.desktopFlowTargetDropdownOptions.searchTextField,buttonAutomationId:O.l.desktopFlowTargetDropdownOptions.refreshButton}),t.renderOption=e=>l.createElement("div",{className:t.classNames.listItemTextContainer},e&&e.data&&l.createElement("span",{className:t.classNames.listItemIcon},l.createElement(o.a,{iconName:e.data.icon,"aria-hidden":!1,"aria-label":e.data.title,title:e.data.title,styles:{root:{width:16}}})),e&&l.createElement("span",{className:t.classNames.listItemText,title:e.text},e.text)),t.onSearchChangeDebounced=t.async.debounce(e=>{t.searchInternalAsync(e,!1)},d.h.search),t.onSearch=e=>{t.searchInternalAsync(e,!0)},t.onSearchBoxClear=()=>{t.searchInternalAsync(void 0,!1)},t.searchInternalAsync=(e,r)=>e?t.store.searchAsync(e,t.props.onError,t.props.selectedTargetId,r):t.store.searchAsync(void 0,t.props.onError,t.props.selectedTargetId),t.reloadTargetList=()=>{b.a.announce(t.props.flowServiceClientResources.DesktopFlowTargetPicker.ScreenReader.MachineRetrieving),t.store.loadDataAsync(t.props.onError,t.props.selectedTargetId,!0)},t.renderEmpty=()=>{var{flowServiceClientResources:e}=t.props;return l.createElement(s.a,null,()=>{var r,n;return t.store.currentSearchText?(r=Object(y.a)(e.Designer.Editors.CustomValue.Empty.SearchTitle,t.store.currentSearchText),n=e.Designer.Editors.CustomValue.Empty.SearchMessage):(r=e.DesktopFlowTargetPicker.EmptyResults.Title,n=e.DesktopFlowTargetPicker.EmptyResults.Description),l.createElement("div",{className:t.classNames.emptyResultsContainer},l.createElement("div",{className:t.classNames.emptyResultsTitle},r),l.createElement("div",{className:t.classNames.emptyResultsMessage},t.store.currentSearchText&&n,!t.store.currentSearchText&&l.createElement(f.a,{textColor:Object(i.Y)().palette.neutralSecondary,interpolatedString:n,linkProps:{ariaLabel:e.Monitor.TargetsListPage.LearnMoreAriaLabel,href:u.a.learnMoreManageMachines,target:m.a.blank}})))})},t.onChange=(e,r,n)=>{r&&t.props.onTargetSelected&&t.props.onTargetSelected(r.key)},t.onDismissDropdown=()=>{t.async.setTimeout(()=>{t.onSearchBoxClear()},d.h.search)},t.store=new g.a(e.xrmMachineManagementService,e.machineManagementStore,e.environmentCapabilityService,e.environmentCapabilityStore,e.environmentStore,e.loggingService,e.flowServiceClientResources,!1),t}return t=P,(r=[{key:"componentDidMount",value:function(){var{onError:e,selectedTargetId:t,loggingService:r}=this.props;this.store.loadDataAsync(e,t).catch(e=>{r.logError("DesktopFlowTargetPickerWithDistantSearch.loadDataAsync",new Error(null==e?void 0:e.message))})}},{key:"render",value:function(){var{flowServiceClientResources:e}=this.props,t=this.store.collection,r=null!=t&&t.hasMore?e.DesktopFlowTargetPicker.Dropdown.HasMoreMessage:e.DesktopFlowTargetPicker.Dropdown.MachineInBadStateMessage;return l.createElement(p.a,{ariaLabel:this.props.ariaLabel,hideCustomAdd:!0,disabled:this.props.disabled||!this.store.isMachineManagementSupported,isLoading:this.store.isLoading,placeholder:this.store.isLoading?e.Common.Loading:e.DesktopFlowTargetPicker.Dropdown.Placeholder,selectedKey:this.props.selectedTargetId,onChange:this.onChange,options:this.store.getDropdownTargetOptions(this.props.selectedTargetId),hasMoreOptions:0!==(null==t?void 0:t.length),hasMoreMessage:r,onRenderEmptyResults:this.renderEmpty,onRenderHeader:this.renderHeader,onDismiss:this.onDismissDropdown,onRenderListOption:this.renderOption,clientResources:e,dataAutomationId:O.l.desktopFlowTargetDropdown,calloutDataAutomationId:O.l.desktopFlowTargetDropdownOptions.root})}}])&&w(t.prototype,r),n&&w(t,n),Object.defineProperty(t,"prototype",{writable:!1}),P}(l.Component))||n},20716:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{emptyResultsContainer:["fl-DesktopFlowTargetPicker-EmptyResultsContainer",{color:e.neutralSecondary,minHeight:150,overflowY:"auto",padding:20,textAlign:"center"}],emptyResultsMessage:["fl-DesktopFlowTargetPicker-EmptyResultsMessage",{fontSize:n.k.smallPlus,margin:10}],emptyResultsTitle:["fl-DesktopFlowTargetPicker-EmptyResultsTitle",{fontWeight:n.l.semibold}],listItemTextContainer:["fl-DesktopFlowTargetPicker-ListItem-TextContainer",{display:"flex",flexGrow:1,flexDirection:"row",textAlign:"left",width:"100%",padding:"0 6px",overflow:"hidden",color:e.neutralPrimary,[n.m]:{color:"ButtonText",":hover":{color:"HighlightText"}}}],listItemIcon:["fl-DesktopFlowTargetPicker-ListItem-Icon",{marginRight:"8px",fontSize:n.k.icon}],listItemText:["fl-DesktopFlowTargetPicker-ListItem-Text",{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}],operatorHasMoreMessageContainer:["fl-ComputerOperatorTargetPicker-OperatorHasMoreMessageContainer",{margin:"8px",display:"flex"}],manageMachinesLink:["fl-ComputerOperatorTargetPicker-ManageMachinesLink",{color:"".concat(e.themePrimary," !important"),textDecoration:"underline !important",marginLeft:"4px"}]}}},20717:function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n,o,i,a,c=r(11773),s=r(15991),l=r(20718),u=r(16841),p=r(20708),f=r(15985),d=r(13120),m=r(13272),b=r(13085),y=r(15430),v=r(17276),h=r(13031),g=r(13021),O=r(17275),w=r(20706),E=r(15992),C=r(14682),S=r(19220),P=r(15457),j=r(20722);function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){x(i,n,o,a,c,"next",e)}function c(e){x(i,n,o,a,c,"throw",e)}a(void 0)}))}}function _(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function A(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var F=(o=A((n=function(){function e(t,r,n,s,u,p,d,m){var b=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.machineManagementService=t,this.machineManagementStore=r,this.environmentCapabilityService=n,this.environmentCapabilityStore=s,this.environmentStore=u,this.loggingService=p,this.clientResources=d,this.cuaMachinesOnly=m,_(this,"connectorMachineGroupListFilter",o,this),this.connectorMachinesFilter=void 0,_(this,"loadDataAsync",i,this),_(this,"searchAsync",a,this),this.browseMachineGroups=function(){var e=N((function*(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(yield b.machineManagementService.browseMachineGroups(b.connectorMachineGroupListFilter,!0,b.collectionKey,t),e)return b.machineManagementService.getMachineGroupDetails(e)}));return function(t){return e.apply(this,arguments)}}(),this.browseMachinesAsync=N((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];yield b.machineManagementService.browseMachines(b.connectorMachinesFilter,e)})),Object(c.runInAction)("init",()=>{this.connectorMachineGroupListFilter={filters:{machineGroupTypes:[f.b.Standard,f.b.Default],accessList:[],managementType:[],groupCapacity:[l.a.NotEmptyNotBadStateOrProvisionedHostedGroup],machineGroupUsageType:this.cuaMachinesOnly?[f.c.CuaOnly,f.c.RpaAndCua]:[f.c.RpaOnly,f.c.RpaAndCua]},orderBy:{key:w.c.modifiedon,direction:O.a.desc}},this.connectorMachinesFilter={filters:{parentGroupNames:[],accessList:[]},orderBy:{key:w.c.modifiedon,direction:O.a.desc}}})}var t,r,n;return t=e,(r=[{key:"currentSearchText",get:function(){var e;return null===(e=this.connectorMachineGroupListFilter.search)||void 0===e?void 0:e.value}},{key:"isLoading",get:function(){var e=this.collection;return!e||e.isLoadingInitially}},{key:"collectionKey",get:function(){return p.b.getMachineGroupCollectionType(this.connectorMachineGroupListFilter)}},{key:"machineCollectionKey",get:function(){return p.b.getMachinesCollectionType(this.connectorMachinesFilter)}},{key:"collection",get:function(){return this.machineManagementStore.machineGroups.getCollection(this.collectionKey)}},{key:"machineCollection",get:function(){return this.machineManagementStore.machines.getCollection(this.machineCollectionKey)}},{key:"getDropdownTargetOptions",value:function(e){var t,r,n,o=(null===(t=this.collection)||void 0===t?void 0:t.list)||[],i=this.getMachineGroupMachines(),a=o.reduce((e,t)=>{if(this.cuaMachinesOnly){var r=i.get(t);null!=r&&r.isCuaSupported&&e.push(this.getOptionFromTargetId(t,!1))}else e.push(this.getOptionFromTargetId(t,!1));return e},[]);return e&&this.machineManagementStore.machineGroups.hasEntity(e)&&(!this.cuaMachinesOnly||null!==(n=i.get(e))&&void 0!==n&&n.isCuaSupported)&&(r=this.getOptionFromTargetId(e,!0)),r&&a.every(e=>{var t;return e.key!==(null===(t=r)||void 0===t?void 0:t.key)})?a.concat(r):a}},{key:"isMachineManagementSupported",get:function(){var{currentEnvironmentName:e}=this.environmentStore,t=y.a.getEnvironmentCapabilityKey({environmentName:e,capabilityName:d.b.isMachineManagementSupported}),r=this.environmentCapabilityStore.environmentCapabilities.getEntity(t);return r?r.isEnabled:null}},{key:"getOptionFromTargetId",value:function(e,t){var r=this.machineManagementStore.machineGroups.getEntity(e);if(!r)throw new Error("MachineGroupEntity is undefined");var n=r.properties.type===u.j.Default?{icon:m.a.Machine,title:this.clientResources.DesktopFlowTargetPicker.Dropdown.ListItem.SingleMachine}:{icon:r.properties.managementType===u.o.Managed?m.a.HostedMachineGroup:m.a.MachineGroup,title:this.clientResources.DesktopFlowTargetPicker.Dropdown.ListItem.MachineGroup};return Object(C.b)(S.l.desktopFlowTargetDropdownOptions.option,{key:r.name,text:r.properties.displayName,hidden:t,data:n})}},{key:"getMachineGroupMachines",value:function(){var e,t=e=>!(!e||e.properties.type!==u.j.Default&&(!e||e.properties.managementType===u.o.Managed));return((null===(e=this.machineCollection)||void 0===e?void 0:e.list)||[]).reduce((e,r)=>{var n,o,i=this.machineManagementStore.machines.getEntity(r);if(null!=i&&i.properties.machineGroupName){var a=i.properties.machineGroupName,c=e.get(a),s=(null==c?void 0:c.machineGroup)||this.machineManagementStore.machineGroups.getEntity(a);e.set(a,{machineGroup:s,isCuaSupported:(null==c?void 0:c.isCuaSupported)||(n=i.properties.agentVersion,o=Object(j.a)(),(!!o.bypassMachineVersionCheck||!n||new P.a(n).compareTo(new P.a(o.minimumMachineVersion))>=0)&&t(s))})}return e},new Map)}}])&&D(t.prototype,r),n&&D(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"connectorMachineGroupListFilter",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A(n.prototype,"currentSearchText",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"currentSearchText"),n.prototype),i=A(n.prototype,"loadDataAsync",[c.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.environmentCapabilityService.batchFetchControlCenterCapabilities().catch(r=>{throw t&&t(e.clientResources.Monitor.UpgradeCdsSolution.FailedToRetrieveOrgInfo,g.a.error),r}).then(N((function*(){if(null===e.isMachineManagementSupported)return t&&t(e.clientResources.Monitor.UpgradeCdsSolution.FailedToRetrieveOrgInfo,g.a.error),Promise.resolve();if(!1===e.isMachineManagementSupported){if(t){var o=Object(h.a)(e.clientResources.Monitor.UpgradeCdsSolution.DetailsWithLearnMorePlainLinkFormat,s.a.learnMoreUpdateMachineManagementSolution);t(o,g.a.error)}return Promise.resolve()}var i=e.loggingService.profileStart(b.a.rpaConnectionCardMachineLoadStart);try{yield Promise.all([e.browseMachineGroups(r,n),e.cuaMachinesOnly?e.browseMachinesAsync(n):void 0]),e.loggingService.profileEndWithSuccess(i,b.a.rpaConnectionCardMachineLoadEnd)}catch(c){if(t){var a=Object(h.a)(e.clientResources.DesktopFlowTargetPicker.FailedToLoadData,c&&c.message||"");t(a,g.a.error)}throw e.loggingService.profileEnd(i,b.a.rpaConnectionCardMachineLoadEnd,Object(E.i)(c),c),c}})))}}}),a=A(n.prototype,"searchAsync",[c.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=null!=t&&t.length?{value:t,columns:[w.c.name]}:void 0;return e.connectorMachineGroupListFilter=k(k({},e.connectorMachineGroupListFilter),{},{search:i}),e.connectorMachinesFilter=k(k({},e.connectorMachinesFilter),{},{search:i}),e.loadDataAsync(r,n,o).then(()=>{var t=e.getDropdownTargetOptions();v.a.announce(Object(h.a)(e.clientResources.RpaEditorPicker.Search.ScreenReaderAnnouncementFormat,t.length))})}}}),A(n.prototype,"isLoading",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"isLoading"),n.prototype),A(n.prototype,"collectionKey",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"collectionKey"),n.prototype),A(n.prototype,"machineCollectionKey",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"machineCollectionKey"),n.prototype),A(n.prototype,"collection",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"collection"),n.prototype),A(n.prototype,"machineCollection",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"machineCollection"),n.prototype),A(n.prototype,"isMachineManagementSupported",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"isMachineManagementSupported"),n.prototype),n)},20722:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(11808),o=r(11887),i=()=>{var e,t,r=Object(n.a)().cuaSupportedMachineConfig.getConfig();return{bypassMachineVersionCheck:null!==(e=null==r?void 0:r.bypassMachineVersionCheck)&&void 0!==e?e:o.a.bypassMachineVersionCheck,minimumMachineVersion:null!==(t=null==r?void 0:r.minimumMachineVersion)&&void 0!==t?t:o.a.minimumMachineVersion}}},20723:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11766),o=r(19713),i=r(20724),a=e=>{var t=Object(o.a)();return n.createElement("div",{style:{width:"100%"}},n.createElement(i.a,{disabled:e.disabled,onTargetSelected:t=>{e.onConfigItemChange({configItem:e.configItem,value:t})},onError:e.onError,selectedTargetId:e.configItem.value,ariaLabel:e.configItem.label,environmentCapabilityService:t.environmentCapabilityService,environmentCapabilityStore:t.environmentCapabilityStore,environmentStore:t.environmentStore,flowServiceClientResources:t.designerResources,loggingService:t.loggingService,machineManagementStore:t.machineManagementStore,xrmMachineManagementService:t.xrmMachineManagementService}))}},20724:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r(12706),o=r(12839),i=r(12816),a=r(12754),c=r(13285),s=r(13254),l=r(14337),u=r(11766),p=r.n(u),f=r(15991),d=r(20472),m=r(15941),b=r(12366),y=r(13029),v=r(17276),h=r(13031),g=r(20629),O=r(20716),w=r(20717),E=r(19220),C=r(19726),S=r(16811);function P(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}var j=Object(l.c)(e=>{var{flowServiceClientResources:t,disabled:r,selectedTargetId:l,ariaLabel:j,onError:T,onTargetSelected:k,environmentCapabilityService:R,environmentCapabilityStore:x,environmentStore:N,loggingService:_,machineManagementStore:D,xrmMachineManagementService:I}=e,A=Object(u.useMemo)(()=>new w.a(I,D,R,x,N,_,t,!0),[I,D,R,x,N,_,t]),F=Object(n.a)()(O.a),L=Object(u.useRef)(new o.a);Object(u.useEffect)(()=>()=>{L.current.dispose()},[]),Object(u.useEffect)(()=>{(function(){var e,t=(e=function*(){try{yield A.loadDataAsync(T,l,!0)}catch(e){_.logError("ComputerOperatorTargetPicker.loadDataAsync",new Error(null==e?void 0:e.message))}},function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){P(i,n,o,a,c,"next",e)}function c(e){P(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}})()()},[A,T,l,_]);var M=L.current.debounce(e=>{V(e,!1)},b.h.search),B=e=>{V(e,!0)},U=()=>{V(void 0,!1)},V=(e,t)=>e?A.searchAsync(e||void 0,T,l,t):A.searchAsync(void 0,T,l),z=()=>{v.a.announce(t.DesktopFlowTargetPicker.ScreenReader.MachineRetrieving),A.loadDataAsync(T,l,!0)};return p.a.createElement(d.a,{ariaLabel:j,hideCustomAdd:!0,disabled:r||!A.isMachineManagementSupported,isLoading:A.isLoading,placeholder:A.isLoading?t.Common.Loading:t.DesktopFlowTargetPicker.Dropdown.Placeholder,selectedKey:l,onChange:(e,t,r)=>{t&&k&&k(t.key)},options:A.getDropdownTargetOptions(l),hasMoreOptions:!0,onRenderHasMoreMessage:()=>p.a.createElement("div",{className:F.operatorHasMoreMessageContainer},p.a.createElement(c.a,null,t.DesktopFlowTargetPicker.Dropdown.CannotFindAgentMachine),p.a.createElement(s.a,{href:Object(C.a)()+S.qb.replace(":environmentName",N.currentEnvironmentName),underline:!0,target:"_blank",className:F.manageMachinesLink},t.DesktopFlowTargetPicker.Dropdown.CannotFindAgentMachineLink)),onRenderEmptyResults:()=>{var e,r;return A.currentSearchText?(e=Object(h.a)(t.Designer.Editors.CustomValue.Empty.SearchTitle,A.currentSearchText),r=t.Designer.Editors.CustomValue.Empty.SearchMessage):(e=t.DesktopFlowTargetPicker.EmptyResults.Title,r=t.DesktopFlowTargetPicker.EmptyResults.Description),p.a.createElement("div",{className:F.emptyResultsContainer},p.a.createElement("div",{className:F.emptyResultsTitle},e),p.a.createElement("div",{className:F.emptyResultsMessage},A.currentSearchText&&r,!A.currentSearchText&&p.a.createElement(m.a,{textColor:Object(a.Y)().palette.neutralSecondary,interpolatedString:r,linkProps:{ariaLabel:t.Monitor.TargetsListPage.LearnMoreAriaLabel,href:f.a.learnMoreManageMachines,target:y.a.blank}})))},onRenderHeader:()=>p.a.createElement(g.a,{currentSearchText:A.currentSearchText,onRefreshList:z,onSearch:B,onSearchBoxClear:U,onSearchChange:M,placeHolderText:t.RpaEditorPickerHeader.Searchbox.PlaceholderDefault,clientResources:t,searchBoxAutomationId:E.l.desktopFlowTargetDropdownOptions.searchTextField,buttonAutomationId:E.l.desktopFlowTargetDropdownOptions.refreshButton}),onDismiss:()=>{L.current.setTimeout(()=>{U()},b.h.search)},onRenderListOption:e=>p.a.createElement("div",{className:F.listItemTextContainer},e&&e.data&&p.a.createElement("span",{className:F.listItemIcon},p.a.createElement(i.a,{iconName:e.data.icon,"aria-hidden":!1,"aria-label":e.data.title,title:e.data.title,style:{width:16}})),e&&p.a.createElement("span",{className:F.listItemText,title:e.text},e.text)),clientResources:t,dataAutomationId:E.l.desktopFlowTargetDropdown,calloutDataAutomationId:E.l.desktopFlowTargetDropdownOptions.root})})},20725:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(20726);function o(e,t,r,o,i,a,c){return new n.a(e,t,r,o,i,a,c)}},20726:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(20727);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,r,o,i,a,c,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureFlags=t,this.commentingPaneStore=r,this.flowClientResources=o,this.telemetryService=i,this.doNotShowAgainService=a,this.flowService=c,this.widgetUtilService=s,this._isIE=void 0,this.displayBadges=e=>Object(n.a)({options:e,showCommentingIcon:this.shouldShowCommentingIcon(),showContextualHelpIcon:this.shouldShowContextualHelpIcon(),commentingPaneStore:this.commentingPaneStore,doNotShowAgainService:this.doNotShowAgainService,flowClientResources:this.flowClientResources,flowService:this.flowService,telemetryService:this.telemetryService,widgetUtilService:this.widgetUtilService}),this.isCardViewHeaderServiceEnabled=()=>this.shouldShowCommentingIcon()||this.shouldShowContextualHelpIcon(),this._isIE=/MSIE \d|Trident.*rv:/.test(navigator.userAgent)}var t,r,i;return t=e,(r=[{key:"shouldShowCommentingIcon",value:function(){return!0}},{key:"shouldShowContextualHelpIcon",value:function(){return!this.widgetUtilService.isWidgetPage()&&!this._isIE&&this.featureFlags.enableConnectorAndActionHelp}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20727:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o=r(11766),i=r(12706),a=r(20728),c=r(14337),s=r(20729),l=r(20731);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=Object(c.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(f,e);var t,r,n,c=m(f);function f(){var e;u(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=c.call(this,...r)).getClassNames=Object(i.a)(),e}return t=f,(r=[{key:"render",value:function(){var e,{options:{nodeCategory:t,operation:r},showCommentingIcon:n,showContextualHelpIcon:i,commentingPaneStore:c,flowClientResources:u,telemetryService:p,doNotShowAgainService:f,flowService:d,widgetUtilService:m}=this.props,b=this.getClassNames(a.a);return n||i?o.createElement("div",{className:b.root},n&&o.createElement(s.a,{nodeCategory:t,operation:r,commentingPaneStore:c,flowClientResources:u,telemetryService:p,widgetUtilService:m}),i&&o.createElement(l.a,{isCoachmarkVisible:!0,nodeCategory:t,telemetryService:p,doNotShowAgainService:f,flowClientResources:u,flowService:d,friendlyOperatioName:null==this||null===(e=this.props)||void 0===e||null===(e=e.options)||void 0===e||null===(e=e.operation)||void 0===e?void 0:e.friendlyName})):null}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(o.Component))||n;function h(e){return o.createElement(v,e)}},20728:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=()=>({root:["fl-cardBadges",{display:"flex",selectors:{button:{padding:20}}}]})},20729:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,o,i=r(11766),a=r(12706),c=r(14337),s=r(20730),l=r(11773),u=r(13272),p=r(13259),f=r(13240),d=r(13031);function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O,w,E,C,S,P,j=Object(c.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(c,e);var t,r,n,o=v(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).classNames=Object(a.a)()(s.a),t.onClick=()=>{var{commentingPaneStore:e,telemetryService:r}=t.props,n=e.activeContextId;e.isPaneOpen||(e.setIsPaneOpen(!0),r.tagEvent(f.c.CommentingPaneToggled,{paneOpened:!0,context:"icon",flowName:n})),r.tagEvent(f.c.CommentingSelectCommentFromOperationClicked,null,{flowName:n,operationId:t.operationId})},t}return t=c,(r=[{key:"render",value:function(){var e,{flowClientResources:t,commentingPaneStore:r}=this.props,n=null===(e=r.threadCountMap)||void 0===e?void 0:e.get(this.operationId);return r.hasCommentingPaneRendered&&n&&n>0?i.createElement(p.a,{className:this.classNames.root,ariaLabel:Object(d.a)(t.Comments.CardHeader.IconDescription,n),iconName:u.a.ChatSolid,onClick:this.onClick,title:Object(d.a)(t.Comments.CardHeader.IconDescription,n),"data-automation-id":"commenting-icon"},i.createElement("span",{role:"presentation",className:this.classNames.number},n)):null}},{key:"operationId",get:function(){var e,{operation:t}=this.props;return null==t||null===(e=t.definition)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.operationMetadataId}}])&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(i.Component),O=o.prototype,w="operationId",E=[l.computed],C=Object.getOwnPropertyDescriptor(o.prototype,"operationId"),S=o.prototype,P={},Object.keys(C).forEach((function(e){P[e]=C[e]})),P.enumerable=!!P.enumerable,P.configurable=!!P.configurable,("value"in P||P.initializer)&&(P.writable=!0),P=E.slice().reverse().reduce((function(e,t){return t(O,w,e)||e}),P),S&&void 0!==P.initializer&&(P.value=P.initializer?P.initializer.call(S):void 0,P.initializer=void 0),void 0===P.initializer&&(Object.defineProperty(O,w,P),P=null),n=o))||n},20730:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(17719),i=e=>{var t=Object(n.Y)();return{root:["fl-CommentingIcon",{color:o.a.Blue,width:40,height:40,display:"flex",justifyContent:"center",alignItems:"center",position:"relative",selectors:{i:{fontSize:n.k.size24,background:t.palette.themePrimary,paddingTop:2},"&:hover":{backgroundColor:"transparent"}}}],number:["fl-CommentingIcon-number",{position:"absolute",fontSize:n.k.size12,fontWeight:n.l.bold,color:t.palette.white,zIndex:1}]}}},20731:function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));var n,o,i,a,c,s=r(11766),l=r(12706),u=r(12821),p=r(20732),f=r(11773),d=r(14337),m=r(17244),b=r(17720),y=r(17728),v=r(12999),h=r(13259),g=r(13272),O=r(13240),w=r(17758),E=r(17214),C=r(13031);function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return(t=x(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x(n.key),n)}}function x(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function N(e,t){return(N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=A(e);if(t){var o=A(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return D(this,r)}}function D(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return I(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var L=Object(d.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(f,e);var t,r,n,o=_(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=o.call(this,e)).getClassNames=Object(l.a)(),t.coachmarkRef=s.createRef(),k(t,"isCoachmarkVisible",i,I(t)),k(t,"setCoachmarkVisible",a,I(t)),k(t,"dismissCoachmarkVisibility",c,I(t)),t._onHelpIconClick=()=>{var{onHelpIconClick:e}=t.props;e&&e(),t.dismissCoachmarkVisibility(),t.props.telemetryService.tagEvent(O.c.ContextualHelpCoachMarkClosed),t.props.flowService.eventEmitter.emit(E.b.showContextualHelpPanel)},t}return t=f,(r=[{key:"render",value:function(){var e=this.getClassNames(p.a),{coachmarkProps:t}=this.props,{flowClientResources:r}=this.props,n=j(j({},t),this.contextualHelpCoachmarkProps),o=this.props.friendlyOperatioName?Object(C.a)(this.props.flowClientResources.ContextualHelp.Help.AriaLabel,this.props.friendlyOperatioName):this.props.flowClientResources.ContextualHelp.Help.ToolTip;return Object(v.a)().enableConnectorAndActionHelp?s.createElement(s.Fragment,null,s.createElement("div",{className:e.root,ref:this.coachmarkRef},s.createElement(h.a,{ariaLabel:o,className:e.icon,iconName:g.a.Help,onClick:this._onHelpIconClick,title:r.ContextualHelp.Help.ToolTip,"data-automation-id":"contextualhelp-help-icon"})),this.isCoachmarkVisible&&s.createElement(b.a,S({},n,{className:e.teachingBubbleButton}),s.createElement(y.a,this.contextualHelpTeachingBubbleContentProps))):null}},{key:"componentDidMount",value:function(){this.setcoachmarkVisibility()}},{key:"contextualHelpTeachingBubbleContentProps",get:function(){var{flowClientResources:e,telemetryService:t}=this.props;return{headline:e.ContextualHelp.Coachmark.BubbleTitle,bodyContent:e.ContextualHelp.Coachmark.BubbleContent,hasCloseButton:!0,hasCondensedHeadline:!0,onDismiss:()=>{this.dismissCoachmarkVisibility(),t.tagEvent(O.c.ContextualHelpTeachingBubbleContentClosed)}}}},{key:"contextualHelpCoachmarkProps",get:function(){return{positioningContainerProps:{directionalHint:u.a.bottomRightEdge},onDismiss:()=>{this.props.telemetryService.tagEvent(O.c.ContextualHelpCoachMarkClosed)},target:this.coachmarkRef.current,preventFocusOnMount:!0}}},{key:"setcoachmarkVisibility",value:function(){this.props.doNotShowAgainService.isDoNotShowAgain(w.a.ContextualHelpCoachMark).then(e=>{this.props.telemetryService.tagEvent(O.c.ContextualHelpCoachMarkDoNotShowAgainCheckSucceeded),this.setCoachmarkVisible(!e&&this.props.nodeCategory===m.a.NODE.CATEGORY.TRIGGER)}).catch(e=>{this.props.telemetryService.tagEvent(O.c.ContextualHelpCoachMarkDoNotShowAgainCheckFailed,null,{error:e}),this.setCoachmarkVisible(!1)})}}])&&R(t.prototype,r),n&&R(t,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(s.Component),i=F(o.prototype,"isCoachmarkVisible",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F(o.prototype,"contextualHelpTeachingBubbleContentProps",[f.computed],Object.getOwnPropertyDescriptor(o.prototype,"contextualHelpTeachingBubbleContentProps"),o.prototype),a=F(o.prototype,"setCoachmarkVisible",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isCoachmarkVisible=e}}}),c=F(o.prototype,"dismissCoachmarkVisibility",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setCoachmarkVisible(!1),this.props.doNotShowAgainService.markDoNotShowAgain(w.a.ContextualHelpCoachMark)}}}),n=o))||n},20732:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(17719),i=e=>{var t=Object(n.Y)();return{root:["fl-ContextualHelp-root",{}],icon:["fl-ContextualHelp-icon",{color:o.a.Blue,borderRadius:"3",width:32,height:32,display:"flex",justifyContent:"center",alignItems:"center",selectors:{"&:hover":{backgroundColor:"transparent"}}}],teachingBubbleButton:["fl-TeachingBubbleButton",{selectors:{".ms-TeachingBubble-content":{width:286,height:119,selectors:{".ms-TeachingBubble-bodycontent":{padding:0},".ms-TeachingBubble-header":{padding:0,marginBottom:0,marginRight:0,selectors:{p:{paddingTop:16,paddingLeft:20,fontSize:14}}},".ms-TeachingBubble-body":{marginBottom:0,selectors:{".ms-TeachingBubble-subText":{paddingLeft:20,paddingTop:10,paddingRight:20,paddingBottom:16,fontSize:14,color:t.palette.white}}},".ms-TeachingBubble-closebutton":{width:12,height:12,fontSize:12,color:t.palette.white,selectors:{i:{width:12,height:12,fontSize:12,lineHeight:12}}}}}}}]}}},20733:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(20734);function o(e){return new n.a(e)}},20734:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r(20735),o=r(13240),i=r(13272),a=r(20736),c=r(19924),s=r(20750),l=r(13016),u=r(13015),p=r(17214),f=r(20751),d=r(20156),m=r(20588),b=r(12999),y=r(19713),v=r(20154),h=r(20752);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C="EXPRESSIONBUILDER",S=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.invokerStateStore=t,this._editorContext=Object(y.a)()}var t,r,E;return t=e,(r=[{key:"getMenuItemOptions",value:function(e,t,r){return[...this.getCopyMenuItem(e,r),...this._editorContext.commentingPaneStore.hasCommentingPaneRendered?this.getNewCommentMenuItem(e,r):[],...t,...this.getUseInvokerMenuItem(e,r),...Object(b.a)().enableEasyAutomationDataTrainingExperience?this.getEasyAutomationDataTrainingMenuItem(e,r):[]]}},{key:"getComponentType",value:function(e){if(e.selectedCategory&&e.selectedCategory===c.b.MY_CLIPBOARD)return a.a}},{key:"getCardWidthType",value:function(e,t){return Object(v.b)(v.a.designerNewOdataEditor)&&"/providers/Microsoft.PowerApps/apis/shared_sharepointonline"===t&&e&&e.some(e=>d.c.includes(e.parameterKey))||Object(b.a)().designerNewOdataEditorInDataverse&&Object(m.b)(t)&&e&&e.some(e=>d.b.includes(e.parameterKey))?C:void 0}},{key:"getCopyMenuItem",value:function(e,t){var{globalResources:r,designerResources:n,flowService:a,loggingService:c,telemetryService:f}=this._editorContext,d=Object(b.a)().cardViewServiceV2,m=d?t.isTrigger(e):t.GraphStore.isTriggerNode(e);return[{disabled:m,disabledReason:m?n.CardView.MenuItem.CopyTriggerDisabledReason:void 0,key:"copy",iconName:i.a.Copy,title:n.CardView.MenuItem.Copy,type:s.a.Advanced,clickHandler:()=>{try{var n,i,s,b,y,v;if(d)n=t.getActionName(e),i=t.getOperationDefinition(e),s=t.getConnectionReferences(),b=t.getBrandColor(e),y=t.getIcon(e),v=t.getConnectorDisplayName(e);else{n=t.WorkflowActionsStore.getActionById(e).name,i=t.SerializerActions.serializeOperation(e),s=t.ConnectionReferencesStore.getConnectionReferences();var w=t.GraphStore.getConnectorId(e),E=t.OperationParametersStore.getOperationIdForNode(e);b=E?t.OperationStoreUtility.getBrandColor(w,E):t.ConnectorStoreUtility.getBrandColor(w),y=E?t.OperationStoreUtility.getIconUri(w,E):t.ConnectorStoreUtility.getIconUri(w),v=t.ConnectorStore.getConnectorDisplayName(w)}var C=Object.keys(s).reduce((e,t)=>{var r=s[t];return r&&r.connection&&r.connection.id?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({[t]:{connection:{id:r.connection.id}}},e):e},{});this._editorContext.snippetService.addSnippet({brandColor:b,connectionReferences:C,connectorDisplayName:v,icon:y,isTrigger:m,operationName:n,operationDefinition:i}),f.tagEvent(o.c.DesignerMyClipboardCopyMenuItemClicked,null,{connectionReferences:C})}catch(S){c.logError(o.c.DesignerMyClipboardCopyMenuItemError,Object(h.a)(S)),a.eventEmitter.emit(p.b.showMessage,l.c.error,Object(u.o)(S,r.Common.SomethingWentWrong))}}}]}},{key:"getEasyAutomationDataTrainingMenuItem",value:function(e,t){var{easyAutomationPanelStore:r}=this._editorContext;return[{disabled:!1,disabledReason:void 0,key:"new-GPT-data",iconName:i.a.AIBuilder,title:"Add this action data to Easy Automation training set",type:s.a.Advanced,clickHandler:()=>{r.setNodeIds([e.toLowerCase()]),r.setIsTrainingDataSharingPanelOpen(!0)}}]}},{key:"getNewCommentMenuItem",value:function(e,t){var{designerResources:r,globalResources:a,commentingPaneStore:c,flowService:f,loggingService:d,telemetryService:m}=this._editorContext;return[{disabled:!1,disabledReason:void 0,key:"new-comment",iconName:i.a.Chat,title:r.CardView.MenuItem.NewComment,type:s.a.Advanced,clickHandler:()=>{var e=c.activeContextId;try{c.isPaneOpen||(c.setIsPaneOpen(!0),m.tagEvent(o.c.CommentingPaneToggled,{paneOpened:!0,context:"operation",flowName:e})),c.eventDispatcher(n.d.CreateThread),m.tagEvent(o.c.CommentingNewFromDesignerClicked,null,{flowName:e})}catch(t){d.logError(o.c.CommentingNewFromDesignerClicked,t,{flowName:e}),f.eventEmitter.emit(p.b.showMessage,l.c.error,Object(u.o)(t,a.Common.SomethingWentWrong))}}}]}},{key:"getUseInvokerMenuItem",value:function(e,t){var{designerResources:r}=this._editorContext,n=Object(b.a)().cardViewServiceV2,o=n?t.isTrigger(e):t.GraphStore.isTriggerNode(e);if(!this.invokerStateStore||o)return[];var i=n?t.getTriggerConnectionReference():Object(f.a)(t);if(i){var a=n?t.getActionConnectionReference(e):t.ConnectionReferencesStore.getConnectionReferenceForNode(e);if(Object(f.b)(i,a)){var c=n?t.getActionConnectionReferenceKey(e):t.ConnectionReferencesStore.getConnectionReferenceKeyForNode(e),l=!!this.invokerStateStore.getInvokerState(c);return[{key:"invoker",iconUri:l?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNi42MiAxMi41Ij4NCiAgICA8ZGVmcz4NCiAgICAgICAgPHN0eWxlPg0KICAgICAgICAuYSB7DQogICAgICAgICAgICBmaWxsOiAjMDA1OGFkOw0KICAgICAgICB9DQogICAgICAgIDwvc3R5bGU+DQogICAgPC9kZWZzPg0KICAgIDx0aXRsZT5DaGVja01hcmtCbHVlPC90aXRsZT4NCiAgICA8cG9seWdvbiBjbGFzcz0iYSIgcG9pbnRzPSI0LjkyIDEwLjkgMC44IDYuNzggMCA3LjU4IDQuOTIgMTIuNSAxNi42MSAwLjggMTUuODIgMCA0LjkyIDEwLjkiIC8+DQo8L3N2Zz4NCg==":"",title:r.CardView.MenuItem.UseInvokerConnection,type:s.a.Advanced,clickHandler:()=>{this.invokerStateStore&&this.invokerStateStore.updateInvokerState(c,!l)}}]}}return[]}}])&&w(t.prototype,r),E&&w(t,E),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20735:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"a",(function(){return c})),r.d(t,"g",(function(){return s})),r.d(t,"f",(function(){return l}));var n=function(e){return e[e.Container=0]="Container",e[e.Thread=1]="Thread",e[e.Reply=2]="Reply",e}({}),o=function(e){return e[e.Open=0]="Open",e[e.Resolved=1]="Resolved",e}({}),i=function(e){return e.CreateThread="CreateThread",e.DeleteOrphanedComments="DeleteOrphanedComments",e.DeselectThread="DeselectThread",e}({}),a=function(e){return e[e.SolutionNotInstalled=0]="SolutionNotInstalled",e[e.UnknownCode=1]="UnknownCode",e[e.MissingPrivileges=2]="MissingPrivileges",e}({}),c=function(e){return e[e.Flow=0]="Flow",e[e.CanvasApp=1]="CanvasApp",e[e.BotComponent=2]="BotComponent",e[e.ModernAppDesigner=3]="ModernAppDesigner",e[e.Bot=4]="Bot",e[e.PowerPageSite=5]="PowerPageSite",e[e.Undefined=99]="Undefined",e}({}),s=function(e){return e[e.Active=1]="Active",e[e.Inactive=2]="Inactive",e}({}),l=function(e){return e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e}({})},20736:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n,o,i=r(12237),a=r(11766),c=r(14337),s=r(20737),l=r(20739),u=r(12706),p=r(20749),f=r(20746),d=r(13240),m=r(12999),b=r(19713),y=r(13119),v=r(20747);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=Object(c.c)(((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(i,e);var t,r,n,o=E(i);function i(){var e;h(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(u.a)(),e._editorContext=Object(b.a)(),e.onPaste=t=>{var r;t.stopPropagation();var n=null===(r=t.clipboardData)||void 0===r?void 0:r.getData("text");n&&e.doPaste(n)},e.doPaste=t=>{var r="None",n=null;try{if(n=JSON.parse(t),r="Parsed",n&&(r="ParsedAndTruthy",n.id&&n.hasOwnProperty("isTrigger")&&n.operationName&&n.operationDefinition)){var{brandColor:o,connectionReferences:i,connectorDisplayName:a,icon:c,isTrigger:s,operationName:l,operationDefinition:u}=n;e._editorContext.snippetService.addSnippet({brandColor:o,connectionReferences:i,connectorDisplayName:a,icon:c,isTrigger:s,operationName:l,operationDefinition:u}),r="ParsedAndAdded"}}catch(m){r="ParsedInvalidJson";var p=Object(v.a)(m),f=d.c.DesignerMyClipboardSystemClipboardPasteError;e.context.designerContext.Analytics.logError(f,{sanitizedError:p})}e._editorContext.telemetryService.tagEvent(d.c.DesignerMyClipboardSystemClipboardPaste,null,{contentLength:(null==t?void 0:t.length)||0,pasteStatus:r})},e}return t=i,(r=[{key:"render",value:function(){var e=this.getClassNames(p.a),t=this._editorContext.snippetService.getSnippets();return a.createElement("div",{className:e.root},t.length?a.createElement(l.a,{snippets:t,flowDefinitionType:this.getDefinitionType(),apiAuthoringBehavior:this.getApiOperationAuthoringBehavior()}):a.createElement(s.a,null))}},{key:"componentDidMount",value:function(){document.addEventListener("paste",this.onPaste)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("paste",this.onPaste)}},{key:"getDefinitionType",value:function(){return Object(f.b)(this.context.designerContext.SerializerActions.serialize({skipValidation:!0,ignoreNonCriticalErrors:!0}).definition)}},{key:"getApiOperationAuthoringBehavior",value:function(){var e;return Object(f.a)(Object(y.g)(Object(m.a)(),(null===(e=this._editorContext.environmentStore.environmentClaim)||void 0===e?void 0:e.features)||{}),this._editorContext.designerHostContextStore.getContext().apiOperationAuthoringBehavior)}},{key:"focus",value:function(){}}])&&g(t.prototype,r),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.Component)).contextTypes={designerContext:i.any},n=o))||n},20737:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(11766),o=r(12706),i=r(20738),a=r(16828),c=r(13031),s=r(12339),l=r(19713);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(y,e);var t,r,f,b=m(y);function y(){var e;u(this,y);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=b.call(this,...r)).getClassNames=Object(o.a)(),e._editorContext=Object(l.a)(),e}return t=y,(r=[{key:"render",value:function(){var e=this.getClassNames(i.a),{designerResources:t,assetService:r}=this._editorContext,o=Object(s.b)();return n.createElement("div",{className:e.root},n.createElement("div",{className:e.icon},n.createElement(a.b,{src:r.copyPasteZeroDay,fallbackSrc:r.placeholder,alt:t.CopyPaste.ZeroDay.AriaLabel,cdnService:this._editorContext.cdnService})),n.createElement("div",{className:e.copy},n.createElement("h2",null,t.CopyPaste.ZeroDay.Header),n.createElement("p",null,t.CopyPaste.ZeroDay.Paragraph),n.createElement("p",null,Object(c.a)(t.CopyPaste.ZeroDay.Note,o.brandName))))}}])&&p(t.prototype,r),f&&p(t,f),Object.defineProperty(t,"prototype",{writable:!1}),y}(n.Component)},20738:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>({root:["fl-SnippetsDay0View",{display:"flex",alignItems:"stretch",padding:0}],icon:["fl-SnippetsDay0View-icon",{width:"40%",backgroundColor:Object(n.Y)().palette.neutralLighter,selectors:{img:{width:"100%",verticalAlign:"center"}}}],copy:["fl-SnippetsDay0View-title",{marginLeft:11,paddingLeft:8,selectors:{h2:{fontSize:n.k.mediumPlus,fontWeight:n.l.bold,lineHeight:"normal",padding:0,margin:0},p:{fontSize:n.k.medium}}}]})},20739:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(11766),o=r(20740),i=r(13016),a=r(13015),c=r(13240),s=r(17214),l=r(19713),u=r(20747),p=r(12327);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(h,e);var t,r,m,v=y(h);function h(){var e;f(this,h);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=v.call(this,...r))._editorContext=Object(l.a)(),e.onError=t=>{var r,n=Object(u.a)(t);Object(p.j)(p.k,p.m)(n)&&Object(p.k)(n.message)&&(r=n.message),e._editorContext.loggingService.logWarning(c.c.DesignerMyClipboardRecommendationPasteError,r,{sanitizedError:n}),e._editorContext.flowService.eventEmitter.emit(s.b.showMessage,i.c.error,Object(a.o)(t,e._editorContext.globalResources.Common.SomethingWentWrong))},e.onSuccess=(t,r)=>{e._editorContext.telemetryService.tagEvent(c.c.DesignerMyClipboardRecommendationPasteSucceeded,null,{snippetCount:e.props.snippets.length,snippetId:t,snippetIndex:e.props.snippets.findIndex(e=>e.id===t),type:null==r?void 0:r.type})},e}return t=h,(r=[{key:"render",value:function(){var{snippets:e}=this.props;return n.createElement("ul",{className:"fl-SnippetsList"},this.renderSnippets(e))}},{key:"renderSnippets",value:function(e){return n.createElement(n.Fragment,null,e.map(e=>this.renderSnippet(e)))}},{key:"renderSnippet",value:function(e){var{id:t,brandColor:r,connectionReferences:i,connectorDisplayName:a,icon:c,isTrigger:s,operationName:l,operationDefinition:u}=e,{flowDefinitionType:p,apiAuthoringBehavior:f}=this.props;return n.createElement(o.a,{key:t,brandColor:r,onError:this.onError,onSuccess:this.onSuccess,connectionReferences:i,connectorDisplayname:a,icon:c,id:t,isTrigger:s,operationName:l,operationDefinition:u,flowDefinitionType:p,apiAuthoringBehavior:f})}}])&&d(t.prototype,r),m&&d(t,m),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.Component)},20740:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,o,i=r(12237),a=r(11766),c=r(11773),s=r(20741),l=r(12706),u=r(12811),p=r(20745),f=r(16828),d=r(13259),m=r(13272),b=r(20746),y=r(19713),v=r(13240);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=S(e);if(t){var o=S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var j=((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(i,e);var t,r,n,o=E(i);function i(){var e;h(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(l.a)(),e._editorContext=Object(y.a)(),e.onItemClick=()=>{var{designerContext:t}=e.context,{connectionReferences:r,isTrigger:n,id:o,onError:i,onSuccess:a,operationDefinition:l,operationName:u}=e.props,p=Object(c.toJS)(r),f=Object(c.toJS)(l);return e._editorContext.telemetryService.tagEvent(v.c.DesignerMyClipboardRecommendationItemClicked),Object(s.a)({clientResources:e._editorContext.designerResources,designerConnectionStore:e._editorContext.designerConnectionStore,isTrigger:n,connectionReferences:p,designerContext:t,operationDefinition:f,operationName:u}).then(()=>{a(o,f)}).catch(i)},e}return t=i,(r=[{key:"render",value:function(){var e=this.getClassNames(p.a),t=this.props.icon||this._editorContext.assetService.defaultIcon;return a.createElement("li",{className:Object(u.a)(e.root,this.shouldItemBeDisabled?e.disabledItem:""),onClick:this.shouldItemBeDisabled?void 0:this.onItemClick},a.createElement("div",{className:e.icon},a.createElement(f.b,{src:t,fallbackSrc:this._editorContext.assetService.placeholder,alt:this._editorContext.designerResources.CopyPaste.OperationIcon.AriaLabel,cdnService:this._editorContext.cdnService})),a.createElement("div",{className:e.copy},a.createElement("h3",null,this.title),a.createElement("p",null,this.subtitle)),a.createElement("div",null,a.createElement(d.a,{title:this.tooltip,iconName:m.a.Info,ariaLabel:this._editorContext.designerResources.CopyPaste.OperationInfoTooltip.AriaLabel})))}},{key:"title",get:function(){return Object(c.toJS)(this.props.operationName).replace(/_/g," ")}},{key:"subtitle",get:function(){return Object(c.toJS)(this.props.connectorDisplayname)}},{key:"tooltip",get:function(){if(this.shouldItemBeDisabled)return this._editorContext.designerResources.CopyPaste.MixedModeNotSupported;var e=Object(c.toJS)(this.props.operationDefinition);return JSON.stringify(e,null,4)}},{key:"shouldItemBeDisabled",get:function(){return!Object(b.c)(this.props.flowDefinitionType,this.props.operationDefinition.type,this.props.apiAuthoringBehavior)}}])&&g(t.prototype,r),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.Component)).contextTypes={designerContext:i.any},P((n=o).prototype,"title",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"title"),n.prototype),P(n.prototype,"subtitle",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"subtitle"),n.prototype),P(n.prototype,"tooltip",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"tooltip"),n.prototype),P(n.prototype,"shouldItemBeDisabled",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"shouldItemBeDisabled"),n.prototype),n)},20741:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(14751),o=r.n(n),i=r(11891),a=r(18965),c=r(20448),s=r(20742),l=r(20317),u=r(20743),p=r(14883),f=r(14894),d=r(13143),m=r(13142),b=r(20744);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){var{clientResources:t,designerConnectionStore:r,connectionReferences:n,designerContext:a,isTrigger:p,operationDefinition:y,operationName:h}=e,{GraphStore:g,SerializerStore:S,ViewStateActions:P,WorkflowActionsStore:j,WorkflowTriggersStore:T}=a,k=[],R=[],x=[],N=null;return new Promise((e,P)=>{var _=g.getRecommendationNodeId(),D=g.getNode(_);(function(e){return"trigger"===e.getData().category})(D)&&!p&&P(new m.a(d.b.pasteTriggerNotSupported,t.CopyPaste.Error.PasteTriggerNotSupported));var I=D.getGraph().ParentNodeId;x=function(e){var{WorkflowActionsStore:t,WorkflowTriggersStore:r}=e;return t.getActionNames().concat(r.getTriggerNames())}(a);var{topLevelName:A,preppedSnippet:F}=function(e,t,r,n){var a={existingWorkflowNames:new Set(r),renames:{}},{topLevelName:p,preppedSnippet:f}=function(e,t,r,n){var a=r.existingWorkflowNames.has(e)?C(e,r):e;Object(i.a)(a,e)||(r.existingWorkflowNames.add(a),w(r,e,a));var p=o()(t);return function(e,t){Object(b.a)(e,(e,r)=>{if(Object(i.a)(r,"actions")){var n=e[r],a={};for(var c of Object.keys(n)){var s=t.existingWorkflowNames.has(c)?C(c,t):c;t.existingWorkflowNames.add(s),Object(i.a)(c,s)||w(t,c,s),a[s]=o()(n[c])}e[r]=a}return!Object(i.a)(r,"inputs")&&!Object(i.a)(r,"metadata")})}(p,r),function(e,t){if(!e.actions||0===Object.keys(e).length)return;Object(b.a)(e,(e,r)=>{if(Object(i.a)(r,"actions")){var n=e[r];for(var o of Object.keys(n)){var a=n[o];if(a){var c={};for(var s of Object.keys(a.runAfter)){c[E(t,s)||s]=a.runAfter[s]}a.runAfter=c}}}return!Object(i.a)(r,"inputs")&&!Object(i.a)(r,"metadata")})}(p,r),function(e,t,r){var n=new l.a,o=new s.a;Object(b.a)(e,(e,i)=>{if("string"==typeof e[i]){var a=e[i];if(Object(c.e)(a)){var s=n.parseTemplateExpression(a,r);for(var l of Object.keys(t.renames))for(var p of Object.keys(t.renames[l]).reverse()){var f={type:u.a.Action,name:"0"!==p?l+"_"+p:l};s=Object(u.b)(s,f,t.renames[l][p])}e[i]=o.buildTemplateExpression(s,r)}}return!0})}(p,r,n),{topLevelName:a,preppedSnippet:p}}(e,t,a,n);return{topLevelName:p,preppedSnippet:f}}(h,y,x,t),L=g.getAllNodes(),M=D.getPredecessorIds();for(var B of M)O(B,L,k,j,T);var U=function(e,t){var r=o()(e),n={};if(t)for(var i of t){var a=i||null;a&&(n[a]=["Succeeded"])}return r.runAfter=n,r}(F,k);N=a.SerializerActions.serialize({skipValidation:!0,ignoreNonCriticalErrors:!0});var V=function(e,t,r,n,i){var a=o()(n),c=a;if(!c.actions)throw new Error("No actions in definition.");var{underElse:s,definitionNodeName:l}=i(r);if(r&&l){var u=function e(t,r){if(!t||"object"!=typeof t)return null;if(r(t))return t;for(var n of Object.values(t)){var o=e(n,r);if(o)return o}return null}(c,e=>e.actions&&e.actions[l]);if(!u)throw new Error("Failed to find ".concat(l," in definition."));c=u}var p=r&&l&&c.actions?c.actions[l]:c;r&&s&&(p.else?p.else.actions[e]=v({},t):p.else={actions:{[e]:v({},t)}});r&&s||(p.actions[e]=v({},t));return a}(A,U,I,o()(N).definition,e=>function(e,t,r,n){var o=null,a=!1;if(!e)return{underElse:a,definitionNodeName:o};if(e.toLowerCase().endsWith(".else")){var c=e.slice(0,-5),s=r.getActionById(c);if(s){if(!Object(i.a)(s.type,"if"))throw new Error("'else' was not under 'If' condition for ".concat(e));o=s.name,a=!0}}else{var l=n.getSerializedPayload(),u=l.nodes[e];if(u){var p=u.getData();if(Object(i.a)(p.type,"else")){var f=p.parentNodeId,d=l.rootGraph.getNode(f).getId(),m=r.getActionById(d);if(!m)throw new Error("Condition action not found for else, ".concat(e));o=m.name,a=!0}}}if(!a){var b=r.getActionById(e);o=b&&b.name||e}return{underElse:a,definitionNodeName:o}}(e,0,j,S)),z=D.getSuccessorIds();for(var G of z)O(G,L,R,j,T);!function(e,t,r,n,o){if(!e)return;var a=new Set(e.map(e=>e.toUpperCase()));Object(b.a)(n,(e,n)=>{if(Object(i.a)(n,"actions")){var o=e[n];for(var c of Object.keys(o))if(a.has(c.toUpperCase())){var s=o[c];s.runAfter[t]=["Succeeded"],delete s.runAfter[r]}}return!Object(i.a)(n,"inputs")&&!Object(i.a)(n,"metadata")})}(R,A,_,V);var W=a.ConnectionReferencesStore.getConnectionReferences(),H=v(v({},n),W);for(var K of Object.keys(H)){var q=H[K];if(q.connection&&!q.api){var Y=Object(f.b)(q.connection.id);Y||(Y=Object(f.b)(r.getConnectionIdFromDesignerConnectionId(q.connection.id))),q.api={id:Y}}}e({definition:V,connectionReferences:H,properties:{sku:{name:"Standard"}}})}).then(e=>a.DeserializerActions.deserialize(e,{doNotAddRecommendation:!0,skipValidation:!0})).then(()=>new Promise((e,t)=>{setTimeout(()=>{try{!function(e,t,r){var n=new Set(e.map(e=>e.toLowerCase())),o=t.getAllNodes().find(e=>!n.has(e.getId().toLowerCase()));o&&r.setNavigateTo(o.getId())}(g.getAllNodes().map(e=>e.getId()),g,P),e()}catch(r){t(r)}})})).then(()=>Promise.resolve({predecessorNames:k,successorNames:R,existingOperationNames:x,workflowDefinition:N.definition}))}function O(e,t,r,n,o){var a=t.find(t=>Object(i.a)(t.getData().id,e));if(a){var c=a.getData(),s=null;if(!(s=Object(i.a)(c.category,"trigger")?o.getTriggerName(e):n.getActionById(e).name))throw new Error("failed to find name for nodeId ".concat(e," and category ").concat(c.category));r.push(s)}}function w(e,t,r){var n=Object(p.h)(t);e.renames[n.prefix]||(e.renames[n.prefix]=[]),e.renames[n.prefix][n.suffix||0]=r}function E(e,t){var r=Object(p.h)(t);return e.renames[r.prefix]&&e.renames[r.prefix][r.suffix||0]}function C(e,t){var r=[];return t.existingWorkflowNames.forEach(e=>r.push(e)),Object(a.b)(Object(p.h)(e).prefix,r)}},20742:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(16808),o=r(20317),i=r(20448),a=r(13031);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function s(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){return e.INVALID_TYPE="InvalidType",e}({}),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(r,e);var t=f(r);function r(e,n){return u(this,r),t.call(this,"Workflow.ExpressionBuilderException",e,n)}return s(r)}(n.a),v=function(){function e(){u(this,e)}return s(e,[{key:"buildTemplateExpression",value:function(e,t){if(i.d(e))return this._buildSingleString(e.value);if(i.c(e)){var r=this._mergeSegments(e.segments);if(1===r.length&&r[0].type===o.b.StringLiteral)return this._buildSingleString(r[0].value);var n=r.length;return r.map((e,r)=>this._buildSegment(e,n,r,t)).join("")}return"@".concat(this.buildExpression(e,t))}},{key:"buildExpression",value:function(e,t){switch(e.type){case o.b.NullLiteral:case o.b.BooleanLiteral:case o.b.NumberLiteral:return e.value;case o.b.StringLiteral:return i.a(e.value);case o.b.Function:return this._buildFunctionExpression(e,t);default:throw new y(Object(a.a)(t.WorkflowError.InvalidExpressionBuilderType,e.type),b.INVALID_TYPE)}}},{key:"_buildSingleString",value:function(e){return e.length>1&&"@"===e.charAt(0)?"@".concat(e):e.replace(/@{/g,"@@{")}},{key:"_buildSegment",value:function(e,t,r,n){if(i.d(e)){var o=e.value,a=r===t-1;return 0===r&&"@"===o[0]||!a&&"@"===o[o.length-1]?"@{".concat(i.a(o),"}"):o.replace(/@{/g,"@@{")}return"@{".concat(this.buildExpression(e,n),"}")}},{key:"_mergeSegments",value:function(e){var t=[];for(var r of e){if(i.d(r)&&t.length>0){var n=t.length-1,a=t[n];if(i.d(a)){t[n]={type:o.b.StringLiteral,value:a.value+r.value};continue}}t.push(r)}return t}},{key:"_buildFunctionExpression",value:function(e,t){var r=e.functionName,n=e.functionArguments.map(e=>this.buildExpression(e,t)).join(", "),o=e.dereferences.map(e=>this._buildDereference(e,t)).join("");return"".concat(r,"(").concat(n,")").concat(o)}},{key:"_buildDereference",value:function(e,t){var r=e.isSafe?"?":"",n=e.isDotNotation?".":"[",o=e.isDotNotation?e.expression.value:this.buildExpression(e.expression,t),i=e.isDotNotation?"":"]";return"".concat(r).concat(n).concat(o).concat(i)}}]),e}()},20743:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return s}));var n=r(19292),o=r(18960),i=(r(20317),r(20448));function a(e,t,r){var n=!1,a=Object(o.a)(e);return Object(i.g)(a,e=>(Object(i.b)(e)&&c(e,t)&&(!function(e,t){e.functionArguments[0].value=t}(e,r),n=!0),!1)),n?a:e}function c(e,t){return function(e){return e.type===s.Action}(t)&&(Object(n.a)(e.functionName)||Object(n.b)(e.functionName))?e.functionArguments&&1===e.functionArguments.length&&Object(i.d)(e.functionArguments[0])&&e.functionArguments[0].value===t.name:function(e){return e.type===s.Trigger}(t)&&Object(n.c)(e.functionName)}var s=function(e){return e.Trigger="Trigger",e.Action="Action",e}({})},20744:function(e,t,r){"use strict";function n(e,t){if(e&&("object"==typeof e||Array.isArray(e)))for(var r=Object.keys(e).map(t=>({node:e,childKey:t})),n=function(){var e=r.pop();if(e&&t(e.node,e.childKey)){var n=e.node[e.childKey];if(n&&"object"==typeof n||Array.isArray(n))for(var o=Object.keys(n).map(t=>({node:e.node[e.childKey],childKey:t})),i=o.length-1;i>=0;--i)r.push(o[i])}};r.length;)n()}r.d(t,"a",(function(){return n}))},20745:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(17244),i=e=>({root:["fl-MyClipboardRecommendationItem",{display:"flex",alignItems:"flex-start",alignContent:"flex-start",cursor:"pointer",height:48,selectors:{li:{padding:"6px 12px",marginBottom:6}}}],disabledItem:["fl-MyClipboardRecommendationItemDisabled",{opacity:.6}],icon:["fl-MyClipboardRecommendationItem-icon",{selectors:{img:{backgroundColor:e.brandColor||o.a.UIConstants.DefaultBrandColor,borderRadius:3,width:36,height:36,border:0}}}],copy:["fl-MyClipboardRecommendationItem-copy",{display:"flex",flexDirection:"column",flexGrow:1,marginLeft:5,maxWidth:456,padding:0,selectors:{h3:{fontSize:n.k.small,fontWeight:n.l.semibold,lineHeight:"normal",padding:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},p:{fontSize:n.k.small,fontWeight:n.l.regular,lineHeight:"normal",padding:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}]})},20746:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"a",(function(){return p}));var n=r(14837),o=r(14877);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function(e){return e[e.AlreadyMixed=0]="AlreadyMixed",e[e.NoApiOperations=1]="NoApiOperations",e[e.OpenApiConnection=2]="OpenApiConnection",e[e.ApiConnection=3]="ApiConnection",e}({});function l(e){var t=a(a({},e.actions),e.triggers),r=Object.values(t).map(e=>e.type),o=r.some(e=>e===n.a.ApiConnection||e===n.a.ApiConnectionWebhook||e===n.a.ApiConnectionNotification),i=r.some(e=>e===n.a.OpenApiConnection||e===n.a.OpenApiConnectionWebhook||e===n.a.OpenApiConnectionNotification);return o&&i?s.AlreadyMixed:o||i?o?s.ApiConnection:s.OpenApiConnection:s.NoApiOperations}function u(e,t,r){var i=t===n.a.ApiConnection||t===n.a.ApiConnectionWebhook||t===n.a.ApiConnectionNotification,a=t===n.a.OpenApiConnection||t===n.a.OpenApiConnectionWebhook||t===n.a.OpenApiConnectionNotification;return e===s.AlreadyMixed||!i&&!a||i&&r===o.a.ApiConnection||a&&r===o.a.OpenApiConnection}function p(e,t){return t&&t!==o.a.Default?t:e?o.a.OpenApiConnection:o.a.ApiConnection}},20747:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(20748),o=r(12327),i=r(12324),a=/Cannot read properties of undefined \(reading '.*'\)/gi,c=/Failed to find .* in definition/gi,s=e=>{var t=Object(i.cloneDeep)(e);return Object(o.k)(t)?l(t):(Object(n.a)(t,(e,t)=>{var r=e[t];Object(o.k)(r)&&(e[t]=l(r))}),t)},l=e=>(e.match(a)&&(e=e.replace(a,"Cannot read properties of undefined (reading '----scrubbedPII----')")),e.match(c)&&(e=e.replace(c,"Failed to find ----scrubbedPII---- in definition")),e)},20748:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12327),o=r(12331),i=(e,t)=>{a(e,t,new Set)},a=(e,t,r)=>{if(!r.has(e)&&(r.add(e),Object(n.a)(e)||Object(n.g)(e))){var i=e;Object(o.a)(i).forEach(e=>{t(i,e),a(i[e],t,r)})}}},20749:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return{root:["fl-MyClipboardRecommendation",{boxSizing:"border-box",width:"100%",border:"solid ".concat(e.neutralTertiary," 1px"),padding:12}]}}},20750:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.Advanced=3]="Advanced",e}({})},20751:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c}));var n=r(12366),o=r(14835),i=r(13154);function a(e,t,r,a){var c,s,l,u;if(!r&&!e||!t)return!1;var p=(null==e?void 0:e.id)||(null==e||null===(c=e.api)||void 0===c?void 0:c.id),f=(null==e?void 0:e.connectionId)||(null==e||null===(s=e.connection)||void 0===s?void 0:s.id),d=(null==t?void 0:t.id)||(null==t||null===(l=t.api)||void 0===l?void 0:l.id),m=t.connectionId||(null==t||null===(u=t.connection)||void 0===u?void 0:u.id),b=!!(p===n.t||null!=f&&f.startsWith(n.t)||r&&function(e){if(null!=e&&e.WorkflowTriggersStore){var t=e.WorkflowTriggersStore.getAllTriggers(),r=Object.keys(t);if(1===r.length){var n=t[r[0]];return!!((null==n?void 0:n.type)===i.p.manual||n&&Object(o.T)(n)&&((null==n?void 0:n.kind)===i.n.POWERAPP||Object(o.O)(n)||Object(o.E)(n)||Object(o.S)(n)||Object(o.X)(n)))}}return!1}(a)),y=!!(d===n.t||null!=m&&m.startsWith(n.t));return b&&y}function c(e){var t=e.WorkflowTriggersStore.getAllTriggers(),r=Object.keys(t);if(1===r.length){var n=r[0];return e.ConnectionReferencesStore.getConnectionReferenceForNode(n)}}},20752:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(12327),o=r(12324),i=/Cannot create property '([^']*)' on string '@'/g;function a(e){var t=Object(o.cloneDeep)(e);if(!Object(n.j)(n.k,n.m)(t))return t;if(Object(n.j)(n.k,n.m)(t.error)&&Object(n.j)(n.k,n.m)(t.error.data)&&Object(n.k)(t.error.data.alias)){var r=t.error.data.alias;t.error.data.alias="--scrubbedPII--",Object(n.k)(t.error.message)&&t.error.message.match(r)&&(t.error.message=t.error.message.replace(r,"--scrubbedPII--"))}return Object(n.j)(n.k,n.m)(t.error)&&Object(n.k)(t.error.message)&&t.error.message.match(i)&&(t.error.message=t.error.message.replace(i,"Cannot create property '--scrubbedPII--' on string '@'")),t}},20753:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var n=r(12330),o=r(18965),i=r(18960),a=r(18961),c=r(13223),s=r(14883),l=r(13031),u=r(18964),p=r(18966),f=r(12339),d=r(13005),m=r(17266),b=r(13143),y=r(13085),v=r(13009),h=r(12366),g=r(19699),O=r(19713),w=r(12999),E=r(13069),C=r(16749),S=r(14697),P=r(20754),j=r(15402),T=r(19720),k=r(16744),R=r(18968);function x(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){x(i,n,o,a,c,"next",e)}function c(e){x(i,n,o,a,c,"throw",e)}a(void 0)}))}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var A=function(){function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(_(this,e),this._options=void 0,this._solutionId=void 0,this._getRuntimeAccessToken=void 0,this._isXrmConnectionReferenceMode=void 0,this._client=void 0,this._analytics=void 0,this._initConnections=void 0,this._initialized=!1,this._oauthService=void 0,this._editorContext=Object(O.a)(),this.refreshConnections=void 0,this.loginWithMfaAndRetryTestConnection=e=>{var{error:t,connection:r,firstPartyLoginUri:n}=e;return this._options?this._options.onFirstPartyConnectionFailureCallback?(this._analytics.logInfo("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","attempting to fix connection",this.getConnectionInfoForLogging(r)),this._options.onFirstPartyConnectionFailureCallback(b.b.mfaTestConnectionError,n).then(()=>this.testConnection(r)).then(()=>this._analytics.logInfo("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","successfully fixed connection",this.getConnectionInfoForLogging(r))).catch(e=>(this._analytics.logError("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection",e,"unable to fix connection",this.getConnectionInfoForLogging(r)),Promise.reject(e)))):(this._analytics.logWarning("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","unable to login with mfa since onFirstPartyConnectionFailureCallback not supplied",this.getConnectionInfoForLogging(r)),Promise.reject(t)):(this._analytics.logWarning("PowerAppsConnectionService.loginWithMfaAndRetryTestConnection","unable to login with mfa since _options not supplied",this.getConnectionInfoForLogging(r)),Promise.reject(t))},!t.baseUrl)throw new Error("options.baseUrl required");if(!t.urlService)throw new Error("url service required");if(!t.apiVersion)throw new Error("options.apiVersion required");if(!t.getAccessToken)throw new Error("options.getAcessToken required");if(!t.oauthService)throw new Error("options.oauthService required");if(!t.analytics)throw new Error("analytics service required");if(t.allowCoauthoring){if(!t.flowConnectionsApiVersion)throw new Error("flowConnectionsApiVersion required when using allowCoauthoring");if(!t.getFlowConnectionsPath)throw new Error("getFlowConnectionsPath required when using allowCoauthoring");if(!t.isCoauthoredConnection)throw new Error("isCoauthoredConnection required when using allowCoauthoring")}this._options=t,this._solutionId=r,this._getRuntimeAccessToken=n,this._isXrmConnectionReferenceMode=o,this._analytics=t.analytics,this._oauthService=t.oauthService,this._client=g.e.createInstance({analytics:this._analytics,baseUrl:this._options.baseUrl,getAccessToken:this._options.getAccessToken,batchApiVersion:this._options.batchApiVersion,locale:this._options.locale}),Object(S.a)()&&this._client.setBeforeRequestHandler(Object(P.a)(t))}var t,r,x,I;return t=e,(r=[{key:"getConsentUri",value:function(e,t){var r=this.getConnectionIdFromDesignerConnectionId(e),n=this.urlService.getConsentLinkUri(r),o={body:{redirectUrl:t},path:n,query:{"api-version":this._options.apiVersion}};return o=this.addEnvFilterToRequest(o),this._client.post(o).then(e=>{if(e.ok&&e.body)return e.body.consentLink;throw this._formatError(e.body,"error getting consent url. Connection id - ".concat(r,", redirectUrl - ").concat(t))})}},{key:"getFirstPartyLoginUri",value:function(e){var t=this.getConnectionIdFromDesignerConnectionId(e),r=this.urlService.getConsentLinkUri(t),n={body:{redirectUrl:window.location.origin},path:r,query:{"api-version":this._options.apiVersion}};return n=this.addEnvFilterToRequest(n),this._client.post(n).then(e=>{if(e.ok&&e.body&&e.body.firstPartyLoginUri)return e.body.firstPartyLoginUri;throw this._formatError(e.body,"error getting first party login url. Connection id - ".concat(t))})}},{key:"getNewConnectionName",value:function(e,t){var r,n,o=t.ConnectorStore.getConnectorName(e);return o=null===(n=o=null===(r=o)||void 0===r?void 0:r.replace(/_/g,"-"))||void 0===n?void 0:n.substring(0,20),Promise.resolve("".concat(o,"-").concat(Object(c.a)()))}},{key:"consentFirstPartyConnection",value:(I=N((function*(e){var t=this,r=yield this._options.getConsentServerAccessToken(),n=g.e.createInstance({analytics:this._analytics,baseUrl:"",getAccessToken:()=>Promise.resolve(""),batchApiVersion:""}),i=yield n.post({path:e,body:'{ "accessToken" : "'.concat(r,'"}'),json:!1,headers:{"Content-Type":"application/json"}});if(i.ok||!this._options.onFirstPartyConnectionFailureCallback)return i;var a=Object(o.e)(i,this._editorContext.designerResources.Connection.FirstPartyConnectionCreationFailed);try{try{return yield Object(E.b)(Object(f.b)().consentServerAadResourceUri,i.status,i.body,N((function*(){return yield t.consentFirstPartyConnection(e)})))}catch(c){return this._options.onFirstPartyConnectionFailureCallback(a,e)}}catch(s){return i}})),function(e){return I.apply(this,arguments)})},{key:"confirmConsentCode",value:function(e,t){var r=this.getConnectionIdFromDesignerConnectionId(e),n=this.urlService.getConfirmConsentCodeUri(r),o={body:'{ "code" : "'.concat(t,'"}'),path:n,json:!1,headers:{"Content-Type":"application/json"},query:{"api-version":this._options.apiVersion}};return o=this.addEnvFilterToRequest(o),this._client.post(o)}},{key:"oauthService",get:function(){return this._oauthService}},{key:"urlService",get:function(){return this._options.urlService}},{key:"init",value:function(e){return e?(this._initConnections=e.map(e=>{var t=this._copyConnection(e);return this._updateConnection(t),t}),this._initialized=!0,this._initConnections):e}},{key:"updateConnectionProviders",value:function(e){var t=[];return e&&(t=e.map(e=>this._getUpdatedConnectionProvider(e))),t}},{key:"showViewPermissionsDialog",value:function(e){if(!this._options.showViewPermissionsDialog)throw new Error("options.showViewPermissionsDialog required");this._options.showViewPermissionsDialog(e)}},{key:"getGateways",value:function(e){var t={path:this.urlService.getGatewaysPath(),query:{"api-version":this._options.apiVersion,$filter:e}};return t=this.addEnvFilterToRequest(t),this._client.get(t).then(t=>{if(t.ok&&t.body)return t.body;throw this._formatError(t.body,"error getting gateways - filter:".concat(e))}).then(e=>e.value)}},{key:"getConnection",value:function(e,t){var r=this.getConnectionIdFromDesignerConnectionId(e),n={path:r,query:{"api-version":this._options.apiVersion},batch:t};return n=this.addEnvFilterToRequest(n),this._client.get(n).then(e=>{if(e.ok&&e.body)return e.body;throw this._formatError(e.body,"error getting connection - ".concat(r))}).then(t=>(this._isXrmConnectionReferenceMode&&(t.id=t.name=e),this._updateConnection(t),t))}},{key:"getConnections",value:function(e,t){var r;return this._initialized&&(r=e?this._initConnections.filter(t=>Object(s.e)(t.properties.apiId,e)):this._initConnections)&&r.length?Promise.resolve(r):this._fetchConnections(e,t)}},{key:"_fetchConnections",value:function(e,t){var r,n=this.urlService.getQueryForListConnections(this._options.apiVersion);r=e?this.urlService.getListConnectionsUri(e):this.urlService.getConnectionUri();var o=this.addEnvFilterToRequest({cache:!0,path:r,query:n,batch:t});return this._getNextConnections(o,[],e)}},{key:"isCoauthoredConnection",value:function(e){return!!this._options.isCoauthoredConnection&&this._options.isCoauthoredConnection(e)}},{key:"_getNextConnections",value:function(e,t,r){return this._client.get(e).then(e=>{if(e.ok&&e.body&&e.body.value&&e.body.value.length>=0)return this._getConnectionsFromResponse(e.body,t,r);var n;throw n=r?"error fetching connections for connector id ".concat(r):"error fetching connections",this._formatError(e.body,n)})}},{key:"_getConnectionsFromResponse",value:function(e,t,r){if(e.nextLink){var n=this._options.baseUrl,o=e.nextLink;Object(s.i)(o,n)&&(o=o.substr(n.length));var i={cache:!0,path:o};return this._getNextConnections(i,t.concat(e.value),r)}return Promise.resolve(t.concat(e.value))}},{key:"getCoauthoredConnections",value:function(e,t){return this._client.get({cache:!0,path:this._options.getFlowConnectionsPath?this._options.getFlowConnectionsPath():void 0,query:{"api-version":this._options.flowConnectionsApiVersion},batch:t}).then(t=>{if(t.ok&&t.body&&t.body&&t.body.length>=0)return t.body;var r;throw r=e?"error fetching flow connections for connector id ".concat(e):"error fetching flow connections",this._formatError(t.body,r)})}},{key:"createConnection",value:function(e,t,r){var n=this._getRequestForCreateConnection(e,t,r);return n=this.addEnvFilterToRequest(n),Object(j.b)({loggingService:this._editorContext.loggingService,promise:this._client.put(n).then(n=>{if(n.ok&&n.body)return this._processConnectionFromCreate(n.body);if(this._shouldRetryPutWithExistingConnection(n.body))return this._editorContext.loggingService.logInfo("ConnectionService.createConnection","ApiConnectionLimit reached for connector, invoking _retryPutWithExistingConnection",{connectorId:t}),this._retryPutWithExistingConnection(t,r);throw this._formatError(n.body,"error putting connection ".concat(e," for connector ").concat(t))}).catch(r=>{if(r&&r instanceof p.a)throw r;throw this._formatError(null,"error putting connection ".concat(e," for connector ").concat(t))}),eventStartName:"v1Designer.ConnectionService.createConnection_START",eventEndName:"v1Designer.ConnectionService.createConnection_END",eventData:{id:e,connectorId:t,parametersUseEnvironmentVariables:r&&Object(T.a)(r),credentialData:null==r?void 0:r.eventData},getStatus:()=>v.e.Warning})}},{key:"_retryPutWithExistingConnection",value:function(e,t){if(!Object(w.a)().enableRetryCreateXrmConnectionReference)throw this._formatError(null,"this function can only be called when EnableRetryCreateXrmConnectionReference is true");var r;return this._fetchConnections().then(n=>{if(!n)throw this._editorContext.loggingService.logWarning("ConnectionService._retryPutConnection","Failed to fetch all connections",{connectorId:e}),this._formatError(null,"error fetching all connections");var o=n.filter(t=>t&&t.properties&&Object(s.e)(t.properties.apiId,e));if(0===o.length)throw this._editorContext.loggingService.logWarning("ConnectionService._retryPutConnection","Failed to find existing connection",{connectorId:e}),this._formatError(null,"error finding existing connection for connector ".concat(e));if(o.length>1)throw this._editorContext.loggingService.logWarning("ConnectionService._retryPutConnection","Found more than one connection - only supported for single connection limit",{connectorId:e,connectionsFound:o.length}),this._formatError(null,"found more than one connection for connector ".concat(e));var i=o[0];r=i.id,this._editorContext.loggingService.logInfo("ConnectionService._retryPutConnection","Retrying PUT with existing connection",{connectorId:e,userId:i.properties&&i.properties.createdBy?i.properties.createdBy.id:null});var a=this._getRequestForCreateConnection(i.id,e,t);return a=this.addEnvFilterToRequest(a)}).then(e=>this._client.put(e)).then(t=>{if(t.ok&&t.body){var n=this._processConnectionFromCreate(t.body);return this._editorContext.loggingService.logInfo("ConnectionService._retryPutConnection","PUT succeeded with existing connection",{connectorId:e}),n}throw this._editorContext.loggingService.logWarning("ConnectionService._retryPutConnection","PUT failed with existing connection",{connectorId:e,status:t.status}),this._formatError(t.body,"error putting existing connection ".concat(r," for connector ").concat(e))}).catch(t=>{throw this._formatError(null,"error putting existing connection for connector ".concat(e))})}},{key:"_processConnectionFromCreate",value:function(e){if(this._isXrmConnectionReferenceMode){var t=e.properties.createdXrmConnectionReferenceLogicalName;this._editorContext.loggingService.logInfo("ConnectionService._processConnectionFromCreate","Retrieving XRM connection reference logical name from PUT connection",{connectionReferenceLogicalName:t}),Object(n.a)(t)&&(t=this.getXrmLogicalNameFromConnectionId(e.id)),delete e.properties.createdSolutionConnectionReferenceLogicalName,this._editorContext.loggingService.logInfo("ConnectionService._processConnectionFromCreate","Processing connection for designer",{connectionReferenceLogicalName:t,connectionId:e.id}),this.addDesignerConnectionIdMapEntry(t,e.id),e.id=e.name=t}return this._updateConnection(e),e}},{key:"createDependentConnection",value:function(e,t,r,n,o){var i=this.getConnectionIdFromDesignerConnectionId(e);return this.createConnection(i,t,{connectionParameters:{[n]:{connectionId:r,url:this._client.pathCombine(o,r.substr(r.lastIndexOf("/")+1))}}})}},{key:"deleteConnection",value:function(e){var t,r=this.getConnectionIdFromDesignerConnectionId(e);if(this._isXrmConnectionReferenceMode){var n=Object(d.a)(e);t={"api-version":this._options.apiVersion,connectionReferenceLogicalName:n}}else t={"api-version":this._options.apiVersion};var o={path:r,query:t};return o=this.addEnvFilterToRequest(o),this._client.delete(o).then(e=>{if(200!==e.status)throw this._formatError(e.body,"Delete connection failed")})}},{key:"getConnectionInfoForLogging",value:function(e){return{apiId:e&&e.properties&&e.properties.apiId}}},{key:"testConnection",value:function(e,t){var r,o=e.properties.testLinks&&e.properties.testLinks.length>0?e.properties.testLinks[0]:void 0,i=this.getConnectionIdFromDesignerConnectionId(e.id);if(!(i&&o&&o.requestUri&&(r=o.requestUri,/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(r))))return Promise.resolve();var a=this._analytics.profileStart(void 0,y.a.flowTestConnectionStart,{context:"testFlowConnection",designerRevision:"v1",testLink:o,connectionId:i}),c={url:o.requestUri,json:!0,shouldIncludeClientRequestId:!0};return new Promise((t,r)=>Object(f.j)(Object(f.b)(),o.requestUri)?this._getRuntimeAccessToken().then(e=>{if(Object(n.a)(e))throw new Error(b.b.failureRetrievingRuntimeToken);Object(g.g)(c,"authorization","Bearer ".concat(e)),t()}).catch(t=>{this._analytics.logError(y.a.testConnection,t,this.getConnectionInfoForLogging(e))}):t()).then(()=>this._client.execute(o.method,c)).then(r=>{if(r.status>=400&&429!==r.status){var n=r.body,o=Object(v.w)(r.status,n,this._editorContext.errorResources),i=new m.a(b.b.testConnectionError,o,n);if(400!==r.status||!n||Object(v.cb)(n)!==b.b.AuthenticationError||!t)throw this._analytics.logWarning(y.a.testConnection,this.getConnectionInfoForLogging(e)),i;this.loginWithMfaAndRetryTestConnection({error:i,connection:e,firstPartyLoginUri:t})}return this._analytics.profileEnd(a,y.a.flowTestConnectionEnd,{designerRevision:"v1",status:"Success"}),Promise.resolve()}).catch(t=>{throw this._analytics.profileEnd(a,y.a.flowTestConnectionEnd,{designerRevision:"v1",status:"Warning",error:t}),t&&t.code&&t.code!==b.b.testConnectionError?this._analytics.logError(y.a.testConnection,t,this.getConnectionInfoForLogging(e)):t&&t.message&&Object(s.e)(t.message,"Failed to fetch")&&(this._analytics.logWarning(y.a.testConnection,t,this.getConnectionInfoForLogging(e)),t.message=this._editorContext.globalResources.Common.FailedToFetch?Object(l.a)(this._editorContext.errorResources.Error.TestConnectionFailedDetails,this._editorContext.globalResources.Common.FailedToFetch):this._editorContext.errorResources.Error.TestConnectionFailed),t})}},{key:"getConnectors",value:function(e){var t={cache:!0,path:this.urlService.getConnectionProvider(),query:{"api-version":this._options.apiVersion},batch:e};return t=this.addEnvFilterToRequest(t),this._client.get(t).then(e=>{if(e.ok&&e.body)return e.body.value;throw this._formatError(e.body,"error fetching connection providers")}).then(e=>{var t=[],r=e.map(e=>{var r=this._getUpdatedConnectionProvider(e);t.push(r)});return Promise.all(r).then(()=>t)})}},{key:"getConnectionProvidersWithCapability",value:function(e,t){return this.getConnectors(t).then(t=>t.filter(t=>{var{properties:r}=t;return r&&r.capabilities&&r.capabilities.filter(t=>Object(s.e)(t,e)).length>0}).filter(e=>"shared_ftp"!==e.name&&"shared_sftp"!==e.name&&"shared_azurefile"!==e.name))}},{key:"getConnector",value:function(e,t){return this._getProviderWithSwagger(e,t).then(e=>(e=this._filterMultiAuthForDesktopFlowConnector(e),this._getUpdatedConnectionProvider(e)))}},{key:"refresh",value:function(){this._initialized=!1,this._initConnections=[],this.refreshConnections&&this.refreshConnections()}},{key:"dispose",value:function(){this._client.dispose()}},{key:"addEnvFilterToRequest",value:function(e){var t;return this._options.environment&&this._options.environment.name&&(e.query||(e.query={}),t=(t=e.query.$filter)?"".concat(t," and environment eq '").concat(this._options.environment.name,"'"):"environment eq '".concat(this._options.environment.name,"'")),t&&e.query&&(e.query.$filter=t),e}},{key:"_getProviderWithSwagger",value:function(e,t){var r={cache:!0,path:e,query:{"api-version":this._options.apiVersion},batch:t};return r=this.addEnvFilterToRequest(r),this._client.get(r).then(t=>{if(t.ok&&t.body)return t.body;throw this._formatError(t.body,"error fetching connection provider - ".concat(e))})}},{key:"_getUpdatedConnectionProvider",value:function(e){var t=Object(o.c)(e.properties,"generalinformation");if(t){var r=Object(i.a)(e);return(t=Object(o.c)(r.properties,"generalinformation")).id&&(t.id=Object(u.a)(t.id,"/")),r.properties=Object(a.a)(r.properties,t),r}return e}},{key:"_filterMultiAuthForDesktopFlowConnector",value:function(e){var t;return Object(R.b)(e.id)?(Object(C.a)()||Object(w.a)().enableDesktopFlowConnectivityVNext||!e.properties.connectionParameterSets||delete e.properties.connectionParameterSets,null!==(t=e.properties.connectionParameterSets)&&void 0!==t&&t.values&&!Object(k.v)(Object(w.a)())&&(e.properties.connectionParameterSets.values=e.properties.connectionParameterSets.values.filter(e=>e.name!==h.B.connectionParametersSetName.azureRelayRunOwner)),e):e}},{key:"_updateConnection",value:function(e){var t=e.properties,r=Object(o.c)(t,"api");r&&(t.apiId=Object(o.c)(r,"id")),t.apiId=Object(u.a)(t.apiId,"/"),e.id=Object(u.a)(e.id,"/"),t.connectionParameters=Object(a.a)({},t.connectionParameters||{},t.nonSecretParameterValues),e.properties=t}},{key:"_copyConnection",value:function(e){var t=e.properties,r=Object(i.a)(t.connectionParameters);return{name:e.name,id:e.id,type:e.type,properties:{apiId:t.apiId,displayName:t.displayName,iconUri:t.iconUri,createdTime:t.createdTime,statuses:t.statuses,createdBy:t.createdBy,connectionParameters:r,connectionParameterSets:t.connectionParameterSets,testLinks:t.testLinks,accountName:t.accountName}}}},{key:"_getRequestForCreateConnection",value:function(e,t,r){var o,i=null==r?void 0:r.connectionParameters,a=null==r?void 0:r.connectionParametersSet,c=null==r?void 0:r.displayName,s=null==r?void 0:r.credentialId,l=e;if(this._isXrmConnectionReferenceMode){var u=!0;Object(n.a)(this.getConnectionIdFromXrmLogicalName(e))||(u=!1,l=this.getConnectionIdFromXrmLogicalName(e)),o={"api-version":this._options.apiVersion,createConnectionReference:u,solutionId:this._solutionId}}else o={"api-version":this._options.apiVersion};var p={path:l,query:o,body:{properties:{connectionParameters:i,connectionParametersSet:a,displayName:c,credentialId:s}}};return this._options.environment&&(p.body.properties.environment={name:this._options.environment.name}),this._options.template&&(p.query.contextTemplate=this._options.template),p}},{key:"_getUniqueConnectionName",value:function(e,t,r,n){var o=this.urlService.getConnectionId(r,t);return this._testConnectionIdUniqueness(o).then(o=>o?r:(r="".concat(e,"-").concat(n++),this._getUniqueConnectionName(e,t,r,n)))}},{key:"_testConnectionIdUniqueness",value:function(e){var t={path:e,query:{"api-version":this._options.apiVersion}};return t=this.addEnvFilterToRequest(t),this._client.get(t).then(e=>{if(404===e.status)return!0;if(200===e.status)return!1;throw this._formatError(e.body,"Failed to test connection")})}},{key:"_shouldRetryPutWithExistingConnection",value:function(e){return this._isXrmConnectionReferenceMode&&Object(w.a)().enableRetryCreateXrmConnectionReference&&this._isApiConnectionLimit(e)}},{key:"_isApiConnectionLimit",value:function(e){return e&&e.error&&"ApiConnectionLimitExceeded"===e.error.code}},{key:"_formatError",value:function(e,t){var r=e&&e.error,n=r&&r.message?r.message:t;return new p.a(n,p.b.POST_CALL_FAILED,{responseBodyError:r})}},{key:"getConnectionIdFromDesignerConnectionId",value:function(e){var t=this.getConnectionIdFromXrmLogicalName(e);return t||e}},{key:"getConnectionIdFromXrmLogicalName",value:function(e){if(!Object(n.a)(e)&&this._isXrmConnectionReferenceMode)return this._editorContext.designerConnectionStore.getConnectionIdFromDesignerConnectionId(e)}},{key:"getXrmLogicalNameFromConnectionId",value:function(e){if(!Object(n.a)(e)&&this._isXrmConnectionReferenceMode)return this._editorContext.designerConnectionStore.getDesignerConnectionIdFromConnectionId(e)}},{key:"addDesignerConnectionIdMapEntry",value:function(e,t){this._editorContext.designerConnectionStore.addDesignerConnectionIdMapEntry(e,t)}}])&&D(t.prototype,r),x&&D(t,x),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20754:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s}));var n=r(19699),o=r(13085),i=r(11891),a=r(13007);function c(e){return s(e.baseUrl,e.analytics,e.ppapiService,e.getAccessToken,e.getPPAPIAccessToken)}function s(e,t,r,c,s){return l=>{var u=!1;if(!l.url||l.url&&Object(i.a)(e,l.url)){var p=r.extractPPAPIEndpoint(l.path);if(p)u=!0,l.path=l.path.substr(p.length),l.url=Object(a.a)(p);else{var f=r.tryConvertPARPRequest(e,l.path,l.query);f.converted?(u=!0,l.path=f.path,l.query=f.queryParams,l.url=Object(a.a)(f.endpoint)):t.logWarning(o.a.convertPAPPIMappingNotFound,"unable to convert path: ".concat(l.path," to ppapiService"))}}return(u?s():c()).then(e=>(Object(n.g)(l,"authorization","Bearer ".concat(e)),Promise.resolve(l))).catch(e=>(t.logError(n.f,e),Promise.reject(e)))}}},20755:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(12330),o=r(11804),i=r(13143),a=r(13085),c=r(17914),s=r(12339),l=r(20756),u=r(11891),p=r(14903),f=r(11806),d=r(13223);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g=function(){function e(t,r,n,o,i,a,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.designerConnectorService=t,this.analytics=r,this.appSettings=n,this.featureFlags=o,this.getRuntimeAccessToken=i,this.widgetUtilService=a,this.hostCommunicationService=c,this.urlCacheKeys={}}var t,r,m;return t=e,(r=[{key:"execute",value:function(e,t,r,m){if(this.widgetUtilService&&this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.getEnableDynamicSchemaCallback()&&r.path&&this.widgetUtilService.supportedDynamicSchemaPath(r.path))return this.hostCommunicationService.getDataFromHostEvent(o.a.GET_DYNAMIC_SCHEMA).then(e=>Promise.resolve(e)).catch(e=>{this.analytics.logError(a.a.widgetGetDynamicSchemaDataFromHostEvent,e)});if(function(e,t){var r=Object(c.e)(e)||Object(c.f)(e);if(e&&r&&e.indexOf("proxy")>-1){var n=e.split("/");if(n.length>13&&Object(u.a)(n[5],"environments")&&Object(u.a)(n[7],"flows")&&Object(u.a)(n[9],"apis")&&Object(u.a)(n[11],"connections")&&Object(u.a)(n[13],"proxy"))return!0}return!1}(t,this.appSettings)){r.headers=r.headers||{},this.featureFlags.enableProxyForAllFlows&&m&&(r.headers=b(b({},r.headers),{},{"x-ms-flow-is-dynamic-schema":m.isDynamicSchema,"x-ms-flow-value-path":m.valuePath})),r.queries=r.queries||{};var y="";if(Object(u.a)(e,"GET")){var v=Object(l.a)({httpMethod:e,runtimeUrl:t,inputs:r});this.urlCacheKeys[v]?y=this.urlCacheKeys[v]:(y=Object(d.a)(),this.urlCacheKeys[v]=y)}var h=(r.path||"").split("?"),g=Object(p.a)(h[0])||"",O=Object(f.c)(h[1]||"");Object.keys(r.queries).forEach(e=>{O[e]=r.queries[e]}),Object.keys(O).length>0&&(g+="?"+Object(f.b)(O)),r.headers["x-ms-flow-proxy-wildcard"]=g,r.queries={"api-version":this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments},y&&(r.queries._=y),r.path=""}return new Promise((e,o)=>Object(s.j)(this.appSettings,t)?this.getRuntimeAccessToken().then(t=>{if(Object(n.a)(t))throw new Error(i.b.failureRetrievingRuntimeToken);r.headers=r.headers||{},r.headers.authorization="Bearer ".concat(t),e()}).catch(e=>{this.analytics.logError(a.a.designerExecute,e)}):e()).then(()=>this.designerConnectorService.execute(e,t,r)).then(e=>this.featureFlags.enableProxyForAllFlows&&m&&m.isDynamicSchema&&!m.valuePath?e.properties:e)}}])&&v(t.prototype,r),m&&v(t,m),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20756:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(11955),o=r.n(n);function i(e,t){if(o()(e)){"function"==typeof e.toJSON&&(e=e.toJSON());var r=[];for(var n in e)e.hasOwnProperty(n)&&(!t||t&&void 0!==e[n])&&r.push({key:n,value:e[n]});return r.sort((e,t)=>e.key<t.key?-1:1),"{"+r.map(e=>'"'.concat(e.key,'":')+i(e.value,t)).join(",")+"}"}return Array.isArray(e)?"["+e.map(e=>i(e,t)).join(",")+"]":JSON.stringify(e)}},20757:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(18960),o=r(20751),i=r(19713),a=r(12999),c=r(12344);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(e){return e.Invoker="invoker",e}(u||{}),p=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.invokerStateStore=t,this.featureFlags=r,this._editorContext=Object(i.a)()}var t,r,a;return t=e,(r=[{key:"postConnectionReferencesSerializationOperation",value:function(e,t){var r,i=Object(n.a)(e),a=null===(r=this._editorContext.sessionStore.minimalUserInfo)||void 0===r?void 0:r.uniqueId,s=Object(o.a)(t),l=this.featureFlags&&Object(c.b)(this.featureFlags);return this.invokerStateStore&&a&&(l||s)&&Object.keys(e||{}).forEach(r=>{var n=e[r];Object(o.b)(s,n,l,t)&&this.invokerStateStore&&this.invokerStateStore.getInvokerState(r)&&(i[r].impersonation={source:u.Invoker,objectId:a})}),i}}])&&s(t.prototype,r),a&&s(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e){return new p(e,Object(a.a)())}},20758:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var n=r(19924),o=r(20759),i=r(20760),a=r(20762),c=r(20763),s=r(20764),l=r(20765),u=r(20766),p=r(20781),f=r(20782),d=r(20783),m=r(20784),b=r(14877),y=r(14837),v=r(13119),h=r(12366),g=r(12339),O=r(14883),w=r(16808),E=r(16809),C=r(20785),S=r(14875);function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=k(e);if(t){var o=k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return T(this,r)}}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function D(e,t,r){return t&&_(e.prototype,t),r&&_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var A=function(){function e(t){N(this,e),this.options=void 0,this._providers=void 0,this._contextFilter=void 0,this._recommendationContext=void 0,this._resources=void 0,this.canAddOperation=e=>this.options.canAddOperation(e),this.options=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({promotedConnectorsForActions:[],promotedConnectorsForTriggers:[],promotedOperationsForActions:[],promotedOperationsForTriggers:[]},t),this._resources=this.options.flowServiceResources;var r={[n.b.ALL]:this.options.featureFlags.useOperationsV2InDesigner?new u.a(t):new o.a(t),[n.b.BUILT_IN]:this.options.featureFlags.useOperationsV2InDesigner?new p.a(t):new i.a(t),[n.b.STANDARD]:this.options.featureFlags.useOperationsV2InDesigner?new f.a(t):new c.a(t),[n.b.PREMIUM]:this.options.featureFlags.useOperationsV2InDesigner?new d.a(t):new l.a(t),[n.b.CUSTOM]:this.options.featureFlags.useOperationsV2InDesigner?new m.a(t):new s.a(t),[n.b.FUNCTIONS]:new a.a(t),[n.b.RPA]:new C.a(t),[n.b.ACTIONS]:new u.a(t),[n.b.TRIGGERS]:new u.a(t),[n.b.CONNECTORS]:new u.a(t)};this._providers=r,this._recommendationContext={}}return D(e,[{key:"setContext",value:function(e){return this._recommendationContext=e||{},this.options.setRecommendationContext&&this.options.setRecommendationContext(this._recommendationContext),this._getRecommendationContextFilter(e).then(e=>{this._contextFilter=e})}},{key:"clearContext",value:function(){this._contextFilter=void 0,this._recommendationContext={}}},{key:"getCategories",value:function(){var e=[{itemKey:n.b.ALL,linkText:this._resources.Recommendation.Categories.All}],t=[];return this._contextFilter||(t=[{itemKey:n.b.BUILT_IN,linkText:this._resources.Recommendation.Categories.BuiltIn},{itemKey:n.b.STANDARD,linkText:this._resources.Recommendation.Categories.Standard},{itemKey:n.b.PREMIUM,linkText:this._resources.Recommendation.Categories.Premium},{itemKey:n.b.CUSTOM,linkText:this._resources.Recommendation.Categories.Custom}],this.options.useMyClipboard&&t.push({itemKey:n.b.MY_CLIPBOARD,linkText:this._resources.Recommendation.Categories.MyClipboard})),[...e,...t]}},{key:"getConnectorBrandColor",value:function(e,t){return this.getProvider(e).getConnectorBrandColor(t)}},{key:"getConnectorIcon",value:function(e,t){return this.getProvider(e).getConnectorIcon(t)}},{key:"getConnectorTitle",value:function(e,t){return this.getProvider(e).getConnectorTitle(t)}},{key:"getConnectorsByCategory",value:function(e,t,r){var n=this;return this.getProvider(e).getConnectors(t,r).then(e=>{var t=n.removeUnsupportedConnectors(e);return n._contextFilter?n._getFilteredConnectorsResult(t):t})}},{key:"getConnectorsByContinuationToken",value:function(e,t){var r=this;return this.getProvider(e).getConnectorsByContinuationToken(t).then(e=>r.removeUnsupportedConnectors(e))}},{key:"getDefaultCategoryKey",value:function(e){return n.b.ALL}},{key:"getDefaultOperationKind",value:function(e,t){return this.getProvider(e).getDefaultOperationKind(t)}},{key:"getExtraOperations",value:function(e,t){return this.getProvider(e).getExtraOperations(t)}},{key:"getOperationKindsByCategory",value:function(e){return this.getProvider(e).getOperationKinds(this._recommendationContext)}},{key:"getProvider",value:function(e){if(this._providers.hasOwnProperty(e))return this._providers[e];throw new F(e)}},{key:"getOperationsByCategory",value:function(e,t,r){return this._contextFilter?this._getOperationsByCategoryWithContextFilter(e,t,r):this.getProvider(e).getOperations(t,r,this._recommendationContext).then(e=>this.filterUnsupportedOperations(this.coerceOperationType(e)))}},{key:"_getOperationsByCategoryWithContextFilter",value:function(e,t,r){var n=Object.keys(this._contextFilter).map(n=>this.getProvider(e).getOperationsByConnector(n,t,r,this._recommendationContext).then(e=>{var t=this.coerceOperationType(e);return t=this.filterUnsupportedOperations(t),this._getFilteredOperationsResult(t,{[n]:this._contextFilter[n]})}));return Promise.all(n).then(e=>{var t=[],r=[];for(var n of e)t=[...t,...n.value],r=[...r,...n.rawValue];return{value:t,rawValue:r}})}},{key:"getOperationsByConnector",value:function(e,t,r,n){return this.getProvider(e).getOperationsByConnector(t,r,n,this._recommendationContext).then(e=>{var t=this.filterUnsupportedOperations(this.coerceOperationType(e));return this._contextFilter?this._getFilteredOperationsResult(t,this._contextFilter):t})}},{key:"getOperationsByContinuationToken",value:function(e,t){return this.getProvider(e).getOperationsByContinuationToken(t).then(e=>this.filterUnsupportedOperations(this.coerceOperationType(e)))}},{key:"getSearchBoxPlaceholder",value:function(e,t){return this.getProvider(e).getSearchBoxPlaceholder(t)}},{key:"getUserVoicePropsByCategory",value:function(e){return this.getProvider(e).getUserVoiceProps(this._recommendationContext)}},{key:"goBack",value:function(e){return this.getProvider(e).goBack()}},{key:"selectConnector",value:function(e,t,r){return this.getProvider(e).selectConnector(t,r)}},{key:"selectOperation",value:function(e,t,r){return this.getProvider(e).selectOperation(t,r)}},{key:"coerceOperationType",value:function(e){return this.options.apiOperationAuthoringBehavior===b.a.ApiConnection&&(e.value.filter(e=>e&&e.operationType).forEach(e=>{e.operationType=e.operationType.replace(y.a.OpenApiConnection,y.a.ApiConnection).replace(y.a.OpenApiConnectionNotification,y.a.ApiConnectionNotification),e.isNotification&&e.operationType!==y.a.ApiConnectionNotification&&(e.operationType=y.a.ApiConnectionNotification)}),e.rawValue.filter(e=>e&&e.properties&&e.properties.operationType).forEach(e=>{e.properties.operationType=e.properties.operationType.replace(y.a.OpenApiConnection,y.a.ApiConnection).replace(y.a.OpenApiConnectionNotification,y.a.ApiConnectionNotification),e.properties.isNotification&&e.properties.operationType!==y.a.ApiConnectionNotification&&(e.properties.operationType=y.a.ApiConnectionNotification)})),e}},{key:"filterUnsupportedOperations",value:function(e){return(this.options.apiOperationAuthoringBehavior===b.a.ApiConnection||this.options.apiOperationAuthoringBehavior===b.a.Default&&!Object(v.g)(this.options.featureFlags,this.options.environmentFeatures))&&(e.value=e.value.filter(e=>e.id&&!e.id.startsWith(h.c)),e.rawValue=e.rawValue.filter(e=>e.id&&!e.id.startsWith(h.c))),this.options.featureFlags.enableCreateWAUIFlow||(e.value=e.value.filter(e=>e.id&&!e.id.toUpperCase().endsWith(Object(g.b)().rpaPadOperationId.toUpperCase())),e.rawValue=e.rawValue.filter(e=>e.id&&!e.id.toUpperCase().startsWith(Object(g.b)().rpaPadOperationId.toUpperCase()))),e}},{key:"removeUnsupportedConnectors",value:function(e){return(this.options.apiOperationAuthoringBehavior===b.a.ApiConnection||this.options.apiOperationAuthoringBehavior===b.a.Default&&!Object(v.g)(this.options.featureFlags,this.options.environmentFeatures))&&(e.value=e.value.filter(e=>e.id&&!e.id.startsWith(h.c)),e.rawValue=e.rawValue.filter(e=>e.id&&!e.id.startsWith(h.c))),e}},{key:"shouldAllowTriggerSelectionAsAction",value:function(e,t,r,n){var o=this.getProvider(e);return"shouldAllowTriggerSelectionAsAction"in o&&o.shouldAllowTriggerSelectionAsAction(t,r,n)}},{key:"getDefaultTitle",value:function(){}},{key:"_getRecommendationContextFilter",value:function(e){return this._isContextFilteringApplicable(e).then(t=>t&&e?this._getRecommendationContextFilterFromManifest(e):void 0)}},{key:"_getRecommendationContextFilterFromManifest",value:function(e){var t;return this.options.operationManifestService.getOperationManifest(e.connectorId,e.operationId).then(r=>{var n=r.properties.actions,o=n&&n[0]&&n[0].allowedOperations;for(var i of o||[])t?t[e.connectorId]?t[e.connectorId].push(i.operationId):t[e.connectorId]=[i.operationId]:t={[e.connectorId]:[i.operationId]};return t}).catch(()=>{})}},{key:"_isContextFilteringApplicable",value:function(e){if(e&&e.connectorId&&e.operationId&&this.options.operationManifestService&&this.options.apiOperationService){var t=Object(S.e)(e.connectorId);if(t.length>0)return this.options.apiOperationService.getApiOperations(t).then(t=>{var r=t.find(t=>t.name===e.operationId),n=null==r?void 0:r.properties.operationType,o=null==r?void 0:r.kind;return!!n&&this.options.operationManifestService.isSupported(n,o)}).catch(()=>!1)}return Promise.resolve(!1)}},{key:"_getFilteredConnectorsResult",value:function(e){var t=e.value.filter(e=>Object.keys(this._contextFilter).some(t=>Object(O.e)(t,e.id))),r=e.rawValue.filter(e=>Object.keys(this._contextFilter).some(t=>Object(O.e)(t,e.id)));return e.nextLink?this.getConnectorsByContinuationToken(n.b.ALL,e.nextLink).then(e=>this._getFilteredConnectorsResult(e)).then(e=>({value:[...t,...e.value],rawValue:[...r,...e.rawValue]})):Promise.resolve({value:t,rawValue:r})}},{key:"_getFilteredOperationsResult",value:function(e,t){var r=e.value.filter(e=>Object.keys(t).some(r=>Object(O.e)(r,e.connector)&&t[r].some(t=>{var n="".concat(r,"/apiOperations/").concat(t);return Object(O.e)(n,e.id)}))),o=e.rawValue.filter(e=>Object.keys(t).some(r=>Object(O.e)(r,e.properties.api.id)&&t[r].some(t=>Object(O.e)(t,e.name))));return e.nextLink?this.getOperationsByContinuationToken(n.b.ALL,e.nextLink).then(e=>this._getFilteredOperationsResult(e,t)).then(e=>({value:r.concat(e.value),rawValue:o.concat(e.rawValue)})):Promise.resolve({value:r,rawValue:o})}}]),e}(),F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(r,e);var t=j(r);function r(e){return N(this,r),t.call(this,E.a.UnsupportedCategoryException,"Unsupported category '".concat(e,"'"))}return D(r)}(w.a)},20759:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(20760),o=r(19924),i=r(19923),a=r(19928),c=r(20761),s=r(19927),l=r(14827);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){f(i,n,o,a,c,"next",e)}function c(e){f(i,n,o,a,c,"throw",e)}a(void 0)}))}}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(S,e);var t,r,f,b,h,g,O,w,E,C=v(S);function S(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S),(t=C.call(this,e)).options=e,t._builtinConnectorProvider=void 0;var{flowRPApiVersion:r,environmentName:n}=e;if(!r)throw new i.a("apiVersion required");if(!n)throw new i.a("environmentName required");return t._builtinConnectorProvider=t.getBuiltinProvider(e),t}return t=S,(r=[{key:"getConnectors",value:(E=d((function*(e,t){if(this.options.featureFlags.enableApiResultsFromOperationResults)return this.getRecommendationConnectorResultsWithOperations(e,t);var[{rawValue:r,value:n},o]=yield Promise.all([this._builtinConnectorProvider.getConnectors(e,t),this.getConnectorsHttpPromise(e)]);this.throwWhenNotOK(o);var i=yield this.followContinuationTokens(o.body),c=[...r,...i],l=this.getPromotedConnectors(t);return{rawValue:c,value:[...n,...Object(a.a)(l)(i)].sort(s.d)}})),function(e,t){return E.apply(this,arguments)})},{key:"getConnectorsByContinuationToken",value:(w=d((function*(){throw new i.d("This method is not implemented")})),function(){return w.apply(this,arguments)})},{key:"getOperations",value:(O=d((function*(e,t){var{flowRPApiVersion:r,environmentName:n,visibleHideKeys:a}=this.options,c=function(e,t,r,n){var i=r===o.a.TRIGGERS?"properties/trigger neq null":"properties/trigger eq null";i+=t?" and search('".concat(Object(l.a)(t),"')"):" and properties/visibility eq 'important'";var a={"api-version":e,$filter:i};return n&&n.length&&(a.visibleHideKeys=n.join(",")),a}(r,e,t,a),s={cache:!0,path:"/providers/Microsoft.ProcessSimple/environments/".concat(n,"/apiOperations"),query:c},[{rawValue:u,value:p},f]=yield Promise.all([yield this._builtinConnectorProvider.getOperations(e,t),yield this._httpClient.get(s)]);this.throwWhenNotOK(f);var{nextLink:d,value:m}=f.body,{value:b,rawValue:y}=this.getHybridConnectorOperations(e,t,null);return{nextLink:d,rawValue:[...u,...y,...m],value:e&&/\S/.test(e)?[...p,...b,...Object(i.z)(this.options.flowServiceResources)(m)]:[...p.filter(e=>e.important),...Object(i.z)(this.options.flowServiceResources)(m),...p.filter(e=>!e.important),...b]}})),function(e,t){return O.apply(this,arguments)})},{key:"getOperationsByConnector",value:(g=d((function*(e,t,r){if(this._builtinConnectorProvider.isBuiltInConnector(e)){var{rawValue:n,value:o}=yield this._builtinConnectorProvider.getOperationsByConnector(e,t,r);return{rawValue:n,value:o.sort(s.e)}}var{flowRPApiVersion:a,visibleHideKeys:c}=this.options,l=Object(i.y)(a,t,r,c),u=e.split("/")[4],p={cache:!0,path:"/providers/Microsoft.ProcessSimple/environments/".concat(this.options.environmentName,"/apis/").concat(u,"/apiOperations"),query:l},f=yield this._httpClient.get(p);this.throwWhenNotOK(f);var{nextLink:d,value:m}=f.body,{value:b,rawValue:y}=this.getHybridConnectorOperationsByConnector(e,t,r,null),v=[...b,...Object(i.z)(this.options.flowServiceResources)(m).sort(s.e)];return{nextLink:d,rawValue:[...y,...m],value:v}})),function(e,t,r){return g.apply(this,arguments)})},{key:"getOperationsByContinuationToken",value:(h=d((function*(e){var t={cache:!0,url:e},r=yield this._httpClient.get(t);this.throwWhenNotOK(r);var{nextLink:n,value:o}=r.body;return{nextLink:n,rawValue:o,value:Object(i.z)(this.options.flowServiceResources)(o)}})),function(e){return h.apply(this,arguments)})},{key:"getBuiltinProvider",value:function(e){return new n.a(e)}},{key:"shouldAllowTriggerSelectionAsAction",value:function(e,t,r){return!this._builtinConnectorProvider.isBuiltInConnector(e)&&!this._builtinConnectorProvider.isBuiltInOperation(t)||this._builtinConnectorProvider.shouldAllowTriggerSelectionAsAction(e,t,r)}},{key:"getRecommendationConnectorResultsWithOperations",value:(b=d((function*(e,t){var r=this.getPromotedConnectors(t),[{rawValue:n,value:o},i,a]=yield Promise.all([this._builtinConnectorProvider.getConnectors(e,t),this.getConnectorsHttpPromise(e),this.getOperations(e,t)]);this.throwWhenNotOK(i);var s=yield this.followContinuationTokens(i.body);return Object(c.b)(r,n,s,o,a)})),function(e,t){return b.apply(this,arguments)})},{key:"getConnectorsHttpPromise",value:function(e){var{flowRPApiVersion:t,environmentName:r,visibleHideKeys:n}=this.options,o=function(e,t,r){var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({"api-version":e},t?{$filter:"search('".concat(Object(l.a)(t),"')")}:void 0);return r&&r.length&&(n.visibleHideKeys=r.join(",")),n}(t,e,n);return this._httpClient.get({cache:!0,path:"/providers/Microsoft.ProcessSimple/environments/".concat(r,"/apis"),query:o})}}])&&m(t.prototype,r),f&&m(t,f),Object.defineProperty(t,"prototype",{writable:!1}),S}(i.e)},20760:function(e,t,r){"use strict";r.d(t,"a",(function(){return E})),r.d(t,"b",(function(){return P})),r.d(t,"c",(function(){return j}));var n=r(19924),o=r(19923),i=r(20761),a=r(19927),c=r(12339),s=r(11891),l=r(14883);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){d(i,n,o,a,c,"next",e)}function c(e){d(i,n,o,a,c,"throw",e)}a(void 0)}))}}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=new Intl.Collator([],{sensitivity:"base"}),E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(d,e);var t,r,a,c,s,l,u,p,f=h(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=f.call(this,e)).options=e,t}return t=d,(r=[{key:"getConnectors",value:(p=m((function*(e,t){var{promotedConnectorsForActions:r,promotedConnectorsForTriggers:o}=this.options;if(this.options.featureFlags.enableApiResultsFromOperationResults){var a=yield this.getOperations(e,t);return Object(i.a)(a)}var c=this.options.builtInTypeService.getBuiltInConnectors().filter(P).filter(j(e));return{rawValue:c,value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=T(e);return e=>e.map(t)}(t===n.a.TRIGGERS?o:r)(c).sort(C)}})),function(e,t){return p.apply(this,arguments)})},{key:"getConnectorsByContinuationToken",value:(u=m((function*(){throw new o.d("This method is not implemented")})),function(){return u.apply(this,arguments)})},{key:"getOperations",value:(l=m((function*(e,t){var r=this.getBuiltInOperations(t).filter(Object(o.B)(e)),{promotedConnectorsForTriggers:i,promotedConnectorsForActions:a}=this.options,c=t===n.a.TRIGGERS?i:a;return{rawValue:r,value:R(this.options.flowServiceResources,c)(r).sort(S)}})),function(e,t){return l.apply(this,arguments)})},{key:"getOperationsByConnector",value:(s=m((function*(e,t,r){var n=this.getBuiltInOperations(r).filter(Object(o.A)(e)).filter(Object(o.B)(t));return{rawValue:n,value:R(this.options.flowServiceResources)(n).sort(S)}})),function(e,t,r){return s.apply(this,arguments)})},{key:"getOperationsByContinuationToken",value:(c=m((function*(){throw new o.d("This method is not implemented")})),function(){return c.apply(this,arguments)})},{key:"isBuiltInConnector",value:function(e){return Object(o.w)(e)||this.options.builtInTypeService.getBuiltInConnectors().some(t=>t.id===e)}},{key:"isBuiltInOperation",value:function(e){var t=this.options.builtInTypeService.getBuiltInOperationIds();return Object.values(t).some(t=>e===t)}},{key:"shouldAllowTriggerSelectionAsAction",value:function(e,t,r){return r===n.a.ACTIONS}}])&&b(t.prototype,r),a&&b(t,a),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.e);function C(e,t){return Object(a.f)(e.promotionIndex,t.promotionIndex)||w.compare(e.title,t.title)}function S(e,t){return Object(a.f)(e.promotionIndex,t.promotionIndex)||Object(a.c)(!!t.important,!!e.important)||w.compare(e.subtitle,t.subtitle)||w.compare(e.title,t.title)}function P(e){return!!e&&!!e.properties&&!!e.properties.displayName}function j(e){return t=>!e||Object(l.j)(t.properties.displayName,e,0)}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>{var{id:r,properties:{displayName:n,metadata:o,iconUri:i}}=t,{brandColor:a}=o||{brandColor:void 0},c=e.indexOf(r);return{brandColor:a,icon:i,id:r,promotionIndex:-1===c?Number.MAX_VALUE:c,title:n}}}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Object(c.l)(Object(c.b)()).promotedBuiltInOperations;return n=>{var{id:o,properties:{api:i,description:a,summary:c,isNotification:l}}=n,{displayName:u,iconUri:f,id:d,tier:m}=i||{displayName:void 0,iconUri:void 0,id:void 0,tier:void 0},b=-1!==r.indexOf(o),y=t.indexOf(d);return p(p({id:o},d?{connector:d}:void 0),{},{connectorKind:e.Recommendation.Connector.Kind.BuiltIn,description:a,icon:f,isCustomConnectorOperation:!1,important:b,premium:Object(s.a)(m,"Premium"),promotionIndex:-1===y?Number.MAX_VALUE:y,subtitle:u,title:c,isNotification:l})}}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=k(e,t);return e=>e.map(r)}},20761:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(19928),o=r(19927);function i(e){var t=new Set,r=e.rawValue.reduce((e,r)=>{var n=r.properties.api,o=n.id;return t.has(o)||(t.add(o),e.push({id:o,name:n.name,properties:{brandColor:n.brandColor,displayName:n.displayName,iconUri:n.iconUri}})),e},[]);return t.clear(),{rawValue:r,value:e.value.reduce((e,r)=>{var n=r.connector||function(e){if(!e||-1===e.indexOf("/providers/Microsoft.PowerApps/apis/"))return"";return e.split("/").slice(0,5).join("/")}(r.id);return t.has(n)||(t.add(n),e.push({brandColor:r.brandColor,icon:r.icon,id:n,promotionIndex:r.promotionIndex,title:r.subtitle})),e},[])}}function a(e,t,r,a,c){var s=i(c),l=[...s.rawValue,...t,...r],u=new Set(s.value.map(e=>e.id)),p=a.filter(e=>!u.has(e.id));p.forEach(e=>u.add(e.id));var f=Object(n.a)(e)(r).filter(e=>!u.has(e.id)),d=[...p,...f].sort(o.d);return{rawValue:l,value:[...s.value,...d]}}},20762:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(19924),o=r(19923),i=r(19927),a=r(14922),c=r(14837),s=r(19699);function l(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){l(i,n,o,a,c,"next",e)}function c(e){l(i,n,o,a,c,"throw",e)}a(void 0)}))}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=(e,t)=>Object(a.g)(c.a.Function,void 0,e,t),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(O,e);var t,r,a,c,l,f,b,y,h=m(O);function O(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(t=h.call(this,e)).options=e,t._functionsClient=void 0;var{analytics:r,functionRPBaseUrl:n,functionRPApiVersion:o,environmentName:i,getFunctionsRPAccessToken:a,locale:c}=e;if(!o)throw new Error("apiVersion required");if(!i)throw new Error("environmentName required");return t._functionsClient=s.e.createInstance({analytics:r,baseUrl:n,getAccessToken:a,locale:c}),t}return t=O,(r=[{key:"getConnectors",value:(y=u((function*(e,t){var{functionRPApiVersion:r,environmentName:n}=this.options,o={"api-version":r},a={cache:!0,path:"/providers/Microsoft.Functions/environments/".concat(n,"/functionGroups"),query:o},c=yield this._functionsClient.get(a);this.throwWhenNotOK(c);var{nextLink:s,value:l}=c.body,u=l.map(e=>g(this.options.assetService,this.options.flowServiceResources,e)).sort(i.e);return{nextLink:s,rawValue:l,value:u}})),function(e,t){return y.apply(this,arguments)})},{key:"getConnectorsByContinuationToken",value:(b=u((function*(){throw new Error("This method is not implemented")})),function(){return b.apply(this,arguments)})},{key:"getOperations",value:(f=u((function*(e,t){throw new Error("This method is not implemented")})),function(e,t){return f.apply(this,arguments)})},{key:"getOperationsByConnector",value:(l=u((function*(e,t,r){var{functionRPApiVersion:n}=this.options,o={"api-version":n},a={cache:!0,path:"".concat(e,"/functions"),query:o},c=yield this._functionsClient.get(a);this.throwWhenNotOK(c);var s,l,u,{nextLink:p,value:f}=c.body,d=f.map((s=this.options.assetService,l=this.options.flowServiceResources,u=e,e=>({id:e.id,data:{operationId:e.name},description:e.name,functionAppId:u,icon:v(s,l).iconUri,name:e.name,type:"azurefunctionwithswagger"}))),m=d.map(e=>g(this.options.assetService,this.options.flowServiceResources,e)).sort(i.e);return{nextLink:p,rawValue:d,value:m}})),function(e,t,r){return l.apply(this,arguments)})},{key:"getOperationsByContinuationToken",value:(c=u((function*(e){throw new Error("This method is not implemented")})),function(e){return c.apply(this,arguments)})},{key:"getOperationKinds",value:function(){return[{itemKey:n.a.ACTIONS,linkText:this.options.flowServiceResources.Recommendation.Kind.Action}]}},{key:"goBack",value:function(){return o.c.CUSTOM_CATEGORY_SELECTED}},{key:"selectOperation",value:function(e,t){return"SELECT_AZURE_FUNCTION_SWAGGER_ACTION"}}])&&p(t.prototype,r),a&&p(t,a),Object.defineProperty(t,"prototype",{writable:!1}),O}(o.e);function g(e,t,r){var{id:n,name:o}=r;return{id:n,connectorKind:"F",description:o,icon:v(e,t).iconUri,subtitle:o,title:o,isCustomConnectorOperation:!1,isNotification:!1}}},20763:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(19924),o=r(19923),i=r(20761),a=r(19927),c=r(14827);function s(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){s(i,n,o,a,c,"next",e)}function c(e){s(i,n,o,a,c,"throw",e)}a(void 0)}))}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(O,e);var t,r,s,p,m,b,y,h,g=d(O);function O(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(t=g.call(this,e)).options=e;var{flowRPApiVersion:r,environmentName:n}=e;if(!r)throw new o.a("apiVersion required");if(!n)throw new o.a("environmentName required");return t}return t=O,(r=[{key:"getConnectors",value:(h=l((function*(e,t){var r=this.getApiDefinitionsFromRP(e,t,v);if(!this.options.featureFlags.enableApiResultsFromOperationResults)return r;var n=this.getOperations(e,t),[o,{rawValue:a}]=yield Promise.all([n,r]);return Object(i.b)(this.getPromotedConnectors(t),[],a,[],o)})),function(e,t){return h.apply(this,arguments)})},{key:"getConnectorsByContinuationToken",value:(y=l((function*(){throw new o.d("This method is not implemented")})),function(){return y.apply(this,arguments)})},{key:"getOperations",value:(b=l((function*(e,t){var{environmentName:r,flowRPApiVersion:i,visibleHideKeys:a}=this.options,s=function(e,t,r,o){var i=r===n.a.TRIGGERS?"properties/trigger neq null":"properties/trigger eq null";i+=t?" and search('".concat(Object(c.a)(t),"') and properties/api/tier eq 'Standard' and properties/api/isCustomApi eq false"):" and properties/visibility eq 'Important' and properties/api/tier eq 'Standard' and properties/api/isCustomApi eq false";var a={"api-version":e,$filter:i};return o&&o.length&&(a.visibleHideKeys=o.join(",")),a}(i,e,t,a),l={cache:!0,path:"providers/Microsoft.ProcessSimple/environments/".concat(r,"/apiOperations"),query:s},u=yield this._httpClient.get(l);this.throwWhenNotOK(u);var{nextLink:p,value:f}=u.body,{value:d,rawValue:m}=this.getHybridConnectorOperations(e,t,n.b.STANDARD);return{nextLink:p,rawValue:[...m,...f],value:[...Object(o.z)(this.options.flowServiceResources)(f),...d]}})),function(e,t){return b.apply(this,arguments)})},{key:"getOperationsByConnector",value:(m=l((function*(e,t,r){var{flowRPApiVersion:i,visibleHideKeys:c}=this.options,s=Object(o.y)(i,t,r,c),l=e.split("/")[4],u={cache:!0,path:"/providers/Microsoft.ProcessSimple/environments/".concat(this.options.environmentName,"/apis/").concat(l,"/apiOperations"),query:s},p=yield this._httpClient.get(u);this.throwWhenNotOK(p);var{nextLink:f,value:d}=p.body,{value:m,rawValue:b}=this.getHybridConnectorOperationsByConnector(e,t,r,n.b.STANDARD),y=[...m,...Object(o.z)(this.options.flowServiceResources)(d).sort(a.e)];return{nextLink:f,rawValue:[...b,...d],value:y}})),function(e,t,r){return m.apply(this,arguments)})},{key:"getOperationsByContinuationToken",value:(p=l((function*(e){var t={cache:!0,url:e},r=yield this._httpClient.get(t);this.throwWhenNotOK(r);var{nextLink:n,value:i}=r.body;return{nextLink:n,rawValue:i,value:Object(o.z)(this.options.flowServiceResources)(i)}})),function(e){return p.apply(this,arguments)})}])&&u(t.prototype,r),s&&u(t,s),Object.defineProperty(t,"prototype",{writable:!1}),O}(o.e);function v(e,t,r){var n={"api-version":e,$filter:t?"search('".concat(Object(c.a)(t),"') and properties/tier eq 'Standard' and properties/isCustomApi eq false"):"properties/tier eq 'Standard' and properties/api/isCustomApi eq false"};return r&&r.length&&(n.visibleHideKeys=r.join(",")),n}},20764:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(19924),o=r(19923),i=r(20761),a=r(14827);function c(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){c(i,n,o,a,s,"next",e)}function s(e){c(i,n,o,a,s,"throw",e)}a(void 0)}))}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=new Intl.Collator([],{sensitivity:"base"}),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(O,e);var t,r,c,u,d,m,b,y,g=f(O);function O(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(t=g.call(this,e)).options=e;var{flowRPApiVersion:r,environmentName:n}=e;if(!r)throw new o.a("apiVersion required");if(!n)throw new o.a("environmentName required");return t}return t=O,(r=[{key:"getConnectors",value:(y=s((function*(e,t){var r=this.getApiDefinitionsFromRP(e,t,h);if(!this.options.featureFlags.enableApiResultsFromOperationResults)return r;var n=this.getOperations(e,t),[o,{rawValue:a}]=yield Promise.all([n,r]);return Object(i.b)([],[],a,[],o)})),function(e,t){return y.apply(this,arguments)})},{key:"getConnectorsByContinuationToken",value:(b=s((function*(){throw new o.d("This method is not implemented")})),function(){return b.apply(this,arguments)})},{key:"getOperations",value:(m=s((function*(e,t){var{environmentName:r,flowRPApiVersion:i}=this.options,c=function(e,t,r){var o=r===n.a.TRIGGERS?"properties/trigger neq null":"properties/trigger eq null";return o+=t?" and search('".concat(Object(a.a)(t),"') and properties/api/isCustomApi eq true"):" and properties/visibility eq 'Important' and properties/api/isCustomApi eq true",{"api-version":e,$filter:o,$top:"250"}}(i,e,t),s={cache:!0,path:"providers/Microsoft.ProcessSimple/environments/".concat(r,"/apiOperations"),query:c},l=yield this._httpClient.get(s);this.throwWhenNotOK(l);var{nextLink:u,value:p}=l.body;return{nextLink:u,rawValue:p,value:Object(o.z)(this.options.flowServiceResources)(p)}})),function(e,t){return m.apply(this,arguments)})},{key:"getOperationsByConnector",value:(d=s((function*(e,t,r){var n=Object(o.y)(this.options.flowRPApiVersion,t,r,null),i=e.split("/")[4],a={cache:!0,path:"/providers/Microsoft.ProcessSimple/environments/".concat(this.options.environmentName,"/apis/").concat(i,"/apiOperations"),query:n},c=yield this._httpClient.get(a);this.throwWhenNotOK(c);var{nextLink:s,value:l}=c.body;return{nextLink:s,rawValue:l,value:Object(o.z)(this.options.flowServiceResources,[])(l).sort(v)}})),function(e,t,r){return d.apply(this,arguments)})},{key:"getOperationsByContinuationToken",value:(u=s((function*(e){var t={cache:!0,url:e},r=yield this._httpClient.get(t);this.throwWhenNotOK(r);var{nextLink:n,value:i}=r.body;return{nextLink:n,rawValue:i,value:Object(o.z)(this.options.flowServiceResources)(i)}})),function(e){return u.apply(this,arguments)})}])&&l(t.prototype,r),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),O}(o.e);function v(e,t){return b.compare(e.subtitle,t.subtitle)||b.compare(e.title,t.title)}function h(e,t){return{"api-version":e,$filter:t?"search('".concat(Object(a.a)(t),"') and properties/isCustomApi eq true"):"properties/isCustomApi eq true"}}},20765:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(19924),o=r(19923),i=r(20761),a=r(19927),c=r(14827);function s(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){s(i,n,o,a,c,"next",e)}function c(e){s(i,n,o,a,c,"throw",e)}a(void 0)}))}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(O,e);var t,r,s,p,m,b,y,h,g=d(O);function O(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(t=g.call(this,e)).options=e;var{flowRPApiVersion:r,environmentName:n}=e;if(!r)throw new o.a("apiVersion required");if(!n)throw new o.a("environmentName required");return t}return t=O,(r=[{key:"getConnectors",value:(h=l((function*(e,t){var r=this.getApiDefinitionsFromRP(e,t,v);if(!this.options.featureFlags.enableApiResultsFromOperationResults)return r;var n=this.getOperations(e,t),[o,{rawValue:a}]=yield Promise.all([n,r]);return Object(i.b)(this.getPromotedConnectors(t),[],a,[],o)})),function(e,t){return h.apply(this,arguments)})},{key:"getConnectorsByContinuationToken",value:(y=l((function*(){throw new o.d("This method is not implemented")})),function(){return y.apply(this,arguments)})},{key:"getOperations",value:(b=l((function*(e,t){var{environmentName:r,flowRPApiVersion:i,visibleHideKeys:a}=this.options,s=function(e,t,r,o){var i=r===n.a.TRIGGERS?"properties/trigger neq null":"properties/trigger eq null";i+=t?" and search('".concat(Object(c.a)(t),"') and properties/api/tier eq 'Premium'"):" and properties/visibility eq 'Important' and properties/api/tier eq 'Premium'";var a={"api-version":e,$filter:i};return o&&o.length&&(a.visibleHideKeys=o.join(",")),a}(i,e,t,a),l={cache:!0,path:"providers/Microsoft.ProcessSimple/environments/".concat(r,"/apiOperations"),query:s},u=yield this._httpClient.get(l);this.throwWhenNotOK(u);var{nextLink:p,value:f}=u.body,{value:d,rawValue:m}=this.getHybridConnectorOperations(e,t,n.b.PREMIUM);return{nextLink:p,rawValue:[...m,...f],value:[...Object(o.z)(this.options.flowServiceResources)(f),...d]}})),function(e,t){return b.apply(this,arguments)})},{key:"getOperationsByConnector",value:(m=l((function*(e,t,r){var{flowRPApiVersion:i,visibleHideKeys:c}=this.options,s=Object(o.y)(i,t,r,c),l=e.split("/")[4],u={cache:!0,path:"/providers/Microsoft.ProcessSimple/environments/".concat(this.options.environmentName,"/apis/").concat(l,"/apiOperations"),query:s},p=yield this._httpClient.get(u);this.throwWhenNotOK(p);var{nextLink:f,value:d}=p.body,{value:m,rawValue:b}=this.getHybridConnectorOperationsByConnector(e,t,r,n.b.PREMIUM),y=[...m,...Object(o.z)(this.options.flowServiceResources)(d).sort(a.e)];return{nextLink:f,rawValue:[...b,...d],value:y}})),function(e,t,r){return m.apply(this,arguments)})},{key:"getOperationsByContinuationToken",value:(p=l((function*(e){var t={cache:!0,url:e},r=yield this._httpClient.get(t);this.throwWhenNotOK(r);var{nextLink:n,value:i}=r.body;return{nextLink:n,rawValue:i,value:Object(o.z)(this.options.flowServiceResources)(i)}})),function(e){return p.apply(this,arguments)})}])&&u(t.prototype,r),s&&u(t,s),Object.defineProperty(t,"prototype",{writable:!1}),O}(o.e);function v(e,t,r){var n={"api-version":e,$filter:t?"search('".concat(Object(c.a)(t),"') and properties/tier eq 'Premium'"):"properties/tier eq 'Premium'"};return r&&r.length&&(n.visibleHideKeys=r.join(",")),n}},20766:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(19924),o=r(20767),i=r(20781);function a(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(m,e);var t,r,s,p,f,d=u(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=d.call(this,e,n.b.ALL)).options=e,t._builtinConnectorProvider=void 0,t._builtinConnectorProvider=new i.a(e),t}return t=m,(r=[{key:"getConnectors",value:(p=function*(e,t){var r=this.getDesignerOperationsFromRP(this.categoryName,e,t,this.maxOperationsPageSize),n=this.getDesignerOperationGroupsFromRP(this.categoryName,e,t),[i,{value:a}]=yield Promise.all([n,r]),{rawValue:c,value:s}=Object(o.e)(Object(o.c)(a),this.toRecommendationConnectorResults(i.value,i.nextLink));return{rawValue:c,value:s,nextLink:i.nextLink}},f=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=p.apply(e,t);function i(e){a(o,r,n,i,c,"next",e)}function c(e){a(o,r,n,i,c,"throw",e)}i(void 0)}))},function(e,t){return f.apply(this,arguments)})},{key:"shouldAllowTriggerSelectionAsAction",value:function(e,t,r){return!Object(o.d)(e)&&!this.isSupportedBuiltInOrHybridRecommendationOperation(t)||this._builtinConnectorProvider.shouldAllowTriggerSelectionAsAction(e,t,r)}},{key:"getDesignerOperationsRequestOptions",value:function(e,t,r){return this.getBaseDesignerOperationsRequestOptions(e,t,r)}},{key:"getDesignerOperationGroupsRequestOptions",value:function(e,t,r){return this.getBaseDesignerOperationGroupsRequestOptions(e,t,r)}}])&&c(t.prototype,r),s&&c(t,s),Object.defineProperty(t,"prototype",{writable:!1}),m}(o.a)},20767:function(e,t,r){"use strict";r.d(t,"b",(function(){return L})),r.d(t,"a",(function(){return M})),r.d(t,"d",(function(){return B})),r.d(t,"c",(function(){return V})),r.d(t,"e",(function(){return z}));var n=r(17233),o=r(20768),i=r(19699),a=r(20777),c=r(20779),s=r(13085),l=r(12339),u=r(14875),p=r(13119),f=r(14877),d=r(11891),m=r(13031),b=r(20759),y=r(19927),v=r(19924),h=r(19923),g=r(19907),O=r(19931),w=r(15375);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function j(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){P(i,n,o,a,c,"next",e)}function c(e){P(i,n,o,a,c,"throw",e)}a(void 0)}))}}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}function k(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var R="foreach",x="if",N="scope",_="switch",D="until",I=function(e){return e.DEFAULT="DEFAULT",e}(I||{}),A=function(e){return e.DEFAULT="DEFAULT",e.SELECT_SCOPE_OPERATION="SELECT_SCOPE_OPERATION",e}(A||{}),F=function(e){return e.DEFAULT="DEFAULT",e}(F||{}),L={powerApps:"powerappsGroup",powerappsresponse:"powerappsGroup",virtualAgent:"virtualagentGroup"},M=function(){function e(t,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.httpClient=void 0,this.universalSearchService=void 0,this.operationsPageSize=50,this.maxOperationsPageSize=250,this.categoryName=void 0,this.appSettings=void 0,this.hardcodedBuiltInMap={},this.withClientTelemetry=function(){var e=j((function*(e,t){var{analytics:r}=o.options,n=C(C({},t),{},{context:"RecommendationProviderV2"}),i=r.profileStart(void 0,"searchText"===t.queryType?s.a.searchOperationsQueryStart:s.a.searchOperationsAllStart,n);try{var a=yield e;return r.profileEnd(i,"searchText"===t.queryType?s.a.searchOperationsQueryEnd:s.a.searchOperationsAllEnd,C(C({},n),{},{success:!0})),a}catch(c){throw r.profileEnd(i,"searchText"===t.queryType?s.a.searchOperationsQueryEnd:s.a.searchOperationsAllEnd,C(C({},n),{},{success:!1})),c}}));return function(t,r){return e.apply(this,arguments)}}();var{analytics:a,flowRPBaseUrl:c,getFlowRPAccessToken:u,locale:p,flowRPApiVersion:f,environmentName:d}=t;if(!a)throw new n.a("analytics required");if(!c)throw new n.a("baseUrl required");if(!u)throw new n.a("getAccessToken required");if(!f)throw new n.a("apiVersion required");if(!d)throw new n.a("environmentName required");if(this.httpClient=i.e.createInstance({analytics:a,baseUrl:c,getAccessToken:u,locale:p}),this.universalSearchService=t.universalSearchService,this.options.builtInTypeService){var m=new b.a(t);this.hardcodedBuiltInMap=m._getOperations(v.a.TRIGGERS).concat(m._getOperations(v.a.ACTIONS)).reduce((e,t)=>(t.id.startsWith("http")&&t.properties&&"single"===t.properties.trigger?e["".concat(t.id).concat(v.a.TRIGGERS)]=t:e[t.id]=t,e),{})}this.categoryName=r,this.appSettings=Object(l.b)()}var t,r,E,S,P,k,L,M,U,H,K;return t=e,(r=[{key:"getConnectorBrandColor",value:function(e){return e&&e.properties&&e.properties.brandColor}},{key:"getConnectorIcon",value:function(e){return e&&e.properties&&e.properties.iconUri}},{key:"getConnectorTitle",value:function(e){return e&&e.properties&&e.properties.displayName}},{key:"getConnectors",value:(K=j((function*(e,t){var r=this.getDesignerOperationsFromRP(this.categoryName,e,t,this.maxOperationsPageSize);if(!e){var n=this.getDesignerOperationGroupsFromRP(this.categoryName,e,t),[o,{value:i}]=yield Promise.all([n,r]),{rawValue:a,value:c}=z(V(this.filterDisabledAiBuilderOperations(i)),this.toRecommendationConnectorResults(o.value,o.nextLink));return{rawValue:a,value:c,nextLink:o.nextLink}}var{value:s,nextLink:l}=yield r,{rawValue:u,value:p}=V(s);return{rawValue:u,value:p,nextLink:l}})),function(e,t){return K.apply(this,arguments)})},{key:"getConnectorsByContinuationToken",value:(H=j((function*(e){var t={cache:!0,url:e},r=yield this.httpClient.post(t);this.throwWhenNotOK(r);var{value:n,nextLink:o}=r.body;if(-1!==e.indexOf("/operations")){var{rawValue:i,value:a}=V(n);return{rawValue:i,value:a,nextLink:o}}return this.toRecommendationConnectorResults(n,o)})),function(e){return H.apply(this,arguments)})},{key:"filterDisabledAiBuilderOperations",value:function(e){var t=e.findIndex(e=>"aibuilderpredict_gptpromptengineering"===e.name||"aibuilderpredict_customprompt"===e.name),r=!Object(O.a)()&&Object(w.a)();return t>-1&&!r&&e.splice(t,1),e}},{key:"getDefaultOperationKind",value:function(e){return e?v.a.TRIGGERS:v.a.ACTIONS}},{key:"getExtraOperations",value:function(e){return[]}},{key:"getOperationKinds",value:function(e){return[{itemKey:v.a.TRIGGERS,linkText:this.options.flowServiceResources.Recommendation.Kind.Trigger},{itemKey:v.a.ACTIONS,linkText:this.options.flowServiceResources.Recommendation.Kind.Action},...this.shouldDisplayHelpTab(e)?[{itemKey:v.a.HELP,linkText:this.options.flowServiceResources.Recommendation.Kind.Help}]:[]]}},{key:"getOperations",value:(U=j((function*(e,t,r){if(t===v.a.HELP)return this.getHelpRecommendations(r);var{nextLink:n,value:o}=yield this.getDesignerOperationsFromRP(this.categoryName,e,t,this.operationsPageSize);return this.toRecommendationOperationResults(this.filterDisabledAiBuilderOperations(o),n)})),function(e,t,r){return U.apply(this,arguments)})},{key:"getOperationsByConnector",value:(M=j((function*(e,t,r,n){var o;if(r===v.a.HELP)return this.getHelpRecommendations(n);var i=Object(u.c)(e),{environmentName:a,flowRPApiVersion:s,visibleHideKeys:l}=this.options,p=C(C({},this.getDesignerOperationsRequestOptions(t,l,r)),{},{operationGroupName:i});p.allTagsToInclude=null===(o=p.allTagsToInclude)||void 0===o?void 0:o.filter(e=>e!==c.a.Important);var f={cache:!0,cacheKey:"Operations-".concat(this.categoryName,"-").concat(i,":").concat(r,"-").concat(t),path:"providers/Microsoft.ProcessSimple/environments/".concat(a,"/operations"),query:{"api-version":s,$top:this.operationsPageSize},body:p},d=yield this.httpClient.post(f);this.throwWhenNotOK(d);var{nextLink:m,value:b}=d.body;return this.toRecommendationOperationResults(this.filterDisabledAiBuilderOperations(b),m)})),function(e,t,r,n){return M.apply(this,arguments)})},{key:"getOperationsByContinuationToken",value:(L=j((function*(e){var t={cache:!0,url:e},r=yield this.httpClient.post(t);this.throwWhenNotOK(r);var{nextLink:n,value:o}=r.body;return this.toRecommendationOperationResults(this.filterDisabledAiBuilderOperations(o),n)})),function(e){return L.apply(this,arguments)})},{key:"getSearchBoxPlaceholder",value:function(e){return e===v.a.TRIGGERS?this.options.flowServiceResources.Recommendation.Search.Placeholder.Triggers:this.options.flowServiceResources.Recommendation.Search.Placeholder.Actions}},{key:"getUserVoiceProps",value:function(e){var t={segments:[{text:this.options.flowServiceResources.Recommendation.User.Voice.Text},{href:"https://go.microsoft.com/fwlink/?linkid=837836",text:this.options.flowServiceResources.Recommendation.User.Voice.Link.Text}]};return e&&e.userSelections&&e.userSelections.operationKind===v.a.HELP?void 0:t}},{key:"goBack",value:function(){return I.DEFAULT}},{key:"selectConnector",value:function(e,t){return F.DEFAULT}},{key:"selectOperation",value:function(e,t){switch(e){case R:case x:case N:case _:case D:return A.SELECT_SCOPE_OPERATION;default:return A.DEFAULT}}},{key:"shouldAllowTriggerSelectionAsAction",value:function(e,t,r){return!0}},{key:"throwWhenNotOK",value:function(e){if(!e)throw new h.f(this.options.flowServiceResources.Recommendation.Unexpected.Http.Response);if(!e.ok){var{body:t}=e;if(!t)throw new h.f(Object(m.a)(this.options.flowServiceResources.Recommendation.Unexpected.Http.ResponseCode,e.status));var{error:r}=t;if(!r)throw new h.f(Object(m.a)(this.options.flowServiceResources.Recommendation.Unexpected.Http.ResponseCode,e.status));var{message:n}=r;if(!n)throw new h.f(Object(m.a)(this.options.flowServiceResources.Recommendation.Unexpected.Http.ResponseCode,e.status));throw new h.f(n)}}},{key:"toRecommendationOperationResults",value:function(e,t){return{nextLink:t,rawValue:e.map(e=>{if(e.properties&&e.properties.operationGroup&&(e.properties.operationGroup.isBuiltIn||e.properties.operationGroup.isHybrid)){var t=g.a[e.id];if(t){if(e.id.startsWith("providers/Microsoft.ProcessSimple/operationGroups/Http/operations/Http")&&e.id.endsWith("Trigger")&&"".concat(t).concat(v.a.TRIGGERS)in this.hardcodedBuiltInMap)return this.hardcodedBuiltInMap["".concat(t).concat(v.a.TRIGGERS)];if(t in this.hardcodedBuiltInMap)return this.hardcodedBuiltInMap[t]}return null}return Object(u.n)(e)}).filter(e=>!!e),value:e.map(e=>function(e,t){var{id:r,properties:{annotation:n,externalDocs:o,operationGroup:i,description:a,summary:c,visibility:s,operationType:l,iconUri:u,brandColor:p,isNotification:f,usage:m}}=e,{status:b}=n||{status:void 0},{displayName:v,id:h,brandColor:O,iconUri:w,isCustomApi:E,isBuiltIn:S,isHybrid:P,tier:j}=i,T=0===y.a.compare(null!=s?s:"","important");if((S||P)&&!(r in g.a))return null;var k=!!E||Object(d.a)(j,"Premium");return C(C({id:S||P?g.a[r]:r},h&&!E?{connector:h}:void 0),{},{connectorKind:G(i,t),description:a,icon:u||w,brandColor:p||O,isCustomConnectorOperation:E,important:T,premium:k,preview:"Preview"===b,externalDocs:o,subtitle:v,title:c,operationType:l,isNotification:f,usage:m})}(e,this.options.flowServiceResources)).filter(e=>!!e).map(e=>e)}}},{key:"toRecommendationConnectorResults",value:function(e,t){var r=new Set,n=e.filter(e=>!(e.properties.isBuiltIn||e.properties.isHybrid)||B(e.id)).reduce((e,t)=>(r.has(t.name)||(r.add(t.name),e.push(t)),e),[]);return r.clear(),{rawValue:n,value:e.filter(e=>!(e.properties.isBuiltIn||e.properties.isHybrid)||B(e.id)).reduce((e,t)=>(r.has(t.name)||(r.add(t.name),e.push(function(e){var{id:t,properties:{displayName:r,iconUri:n,brandColor:o,tier:i}}=e;return{id:t,icon:n,brandColor:o,title:r,tier:i}}(t))),e),[]),nextLink:t}}},{key:"getBaseDesignerOperationGroupsRequestOptions",value:function(e,t,r){var n=[a.a.ToS];return this.options.isSolutionFlow||n.push(a.a.SolutionFlow),(this.options.apiOperationAuthoringBehavior===f.a.ApiConnection||this.options.apiOperationAuthoringBehavior===f.a.Default&&!Object(p.g)(this.options.featureFlags,this.options.environmentFeatures))&&n.push(a.a.OpenApi),{searchText:e,visibleHideKeys:t,usage:r===v.a.ACTIONS?v.c.ACTION:v.c.TRIGGER,allTagsToInclude:[],anyTagsToExclude:n}}},{key:"getBaseDesignerOperationsRequestOptions",value:function(e,t,r){var n=[],o=[c.a.Deprecated];return this.options.isSolutionFlow||o.push(c.a.SolutionFlow),(this.options.apiOperationAuthoringBehavior===f.a.ApiConnection||this.options.apiOperationAuthoringBehavior===f.a.Default&&!Object(p.g)(this.options.featureFlags,this.options.environmentFeatures))&&o.push(c.a.OpenApi),r===v.a.TRIGGERS?n.push(c.a.Trigger):(n.push(c.a.Action),o.push(c.a.Trigger)),e||n.push(c.a.Important),{searchText:e,visibleHideKeys:t,allTagsToInclude:n,anyTagsToExclude:o}}},{key:"isSupportedBuiltInOrHybridRecommendationOperation",value:function(e){return e in this.hardcodedBuiltInMap}},{key:"getDesignerOperationGroupsFromRP",value:(k=j((function*(e,t,r,n){var{environmentName:o,flowRPApiVersion:i,visibleHideKeys:a}=this.options,c={cache:!0,cacheKey:"OperationGroups-".concat(e,":").concat(r,"-").concat(t,"-").concat(n),path:"providers/Microsoft.ProcessSimple/environments/".concat(o,"/operationGroups"),query:C({"api-version":i},n?{$top:n}:void 0),body:this.getDesignerOperationGroupsRequestOptions(t,a,r)},s=yield this.withClientTelemetry(this.httpClient.post(c),{category:e,isGroups:!0,kind:r,queryType:t&&t.length>0?"searchText":"list",top:n});return this.throwWhenNotOK(s),s.body})),function(e,t,r,n){return k.apply(this,arguments)})},{key:"getDesignerOperationsFromRP",value:(P=j((function*(e,t,r,n){var{environmentName:o,flowRPApiVersion:i,visibleHideKeys:a}=this.options,c={cache:!0,cacheKey:"Operations-".concat(e,":").concat(r,"-").concat(t,"-").concat(n),path:"providers/Microsoft.ProcessSimple/environments/".concat(o,"/operations"),query:{"api-version":i,$top:n},body:this.getDesignerOperationsRequestOptions(t,a,r)},s=yield this.withClientTelemetry(this.httpClient.post(c),{category:e,isGroups:!1,kind:r,queryType:t&&t.length>0?"searchText":"list",top:n});return this.throwWhenNotOK(s),s.body})),function(e,t,r,n){return P.apply(this,arguments)})},{key:"getHelpRecommendations",value:(S=j((function*(e){var t=this.prepareHelpSearchQuery(e),r={searchText:null!=t?t:"",designerResources:this.options.flowServiceResources,appSettings:Object(l.b)(),assetService:this.options.assetService,cdnService:this.options.cdnService,clientResources:this.options.clientResources,sharedComponentResources:this.options.sharedComponentResources,telemetryService:this.options.telemetryService};return t&&(r.universalSearchResults=yield this.universalSearchService.searchSupport(t)),{rawValue:[],value:[],resultsRenderer:Object(o.a)(r)}})),function(e){return S.apply(this,arguments)})},{key:"prepareHelpSearchQuery",value:function(e){var t=null==e?void 0:e.userSelections;if(t){var r=[];return t.filterText&&r.push(W(t.filterText)),t.connector&&t.connector.label&&r.push(W(t.connector.label)),r.join(" | ")}}},{key:"shouldDisplayHelpTab",value:function(e){return this.options.featureFlags.designerHelpTab&&!!e&&!!this.prepareHelpSearchQuery(e)}}])&&T(t.prototype,r),E&&T(t,E),Object.defineProperty(t,"prototype",{writable:!1}),e}();function B(e){return Object.keys(g.a).some(t=>t.startsWith(e))}function U(e){return Object.keys(g.a).some(t=>t===e)}function V(e){var t=new Set,r=e.filter(e=>!(e.properties.operationGroup.isBuiltIn||e.properties.operationGroup.isHybrid)||U(e.id)).reduce((e,r)=>{var n=r.properties.operationGroup;return t.has(n.name)||(t.add(n.name),e.push({id:n.id,name:n.name,properties:{brandColor:n.brandColor,displayName:n.displayName,iconUri:n.iconUri,tier:n.tier}})),e},[]);return t.clear(),{rawValue:r,value:e.filter(e=>!(e.properties.operationGroup.isBuiltIn||e.properties.operationGroup.isHybrid)||U(e.id)).reduce((e,r)=>{var n=r.properties.operationGroup;return t.has(n.name)||(t.add(n.name),e.push({id:n.id,brandColor:n.brandColor,icon:n.iconUri,title:n.displayName,tier:n.tier})),e},[])}}function z(e,t){var r=new Set(e.value.map(e=>Object(u.c)(e.id))),n=t.rawValue.filter(e=>!r.has(Object(u.c)(e.id))),o=t.value.filter(e=>!r.has(Object(u.c)(e.id)));return{rawValue:[...e.rawValue,...n],value:[...e.value,...o]}}function G(e,t){return e.isCustomApi?t.Recommendation.Connector.Kind.Custom:Object(d.a)(e.tier,"Premium")?t.Recommendation.Connector.Kind.Premium:e.isBuiltIn||e.isHybrid?t.Recommendation.Connector.Kind.BuiltIn:void 0}function W(e){return"(".concat(e.replace(/(\B[-]|[*]\B|[+|"()'\\])/g,"\\$&"),")")}},20768:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(12706),o=r(11766),i=r(20769),a=r(20776);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){p(r,e);var t=d(r);function r(){var e;c(this,r);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call(this,...i)).classNames=Object(n.a)()(a.a),e}return l(r,[{key:"render",value:function(){var e=this.props.universalSearchResults&&this.props.universalSearchResults.value,{appSettings:t,clientResources:r,telemetryService:n,assetService:a,cdnService:c,sharedComponentResources:s}=this.props,l={remediationData:{universalSearchResults:e||{},searchText:this.props.searchText},noHelpResults:{actionText:this.props.designerResources.Recommendation.Help.NoResultsAction,description:this.props.designerResources.Recommendation.Help.NoResultsDescription,header:this.props.designerResources.Recommendation.Help.NoResultsHeader},appSettings:t,clientResources:r,telemetryService:n,assetService:a,cdnService:c,sharedComponentResources:s};return o.createElement("div",{className:this.classNames.container},o.createElement("div",{className:this.classNames.root},o.createElement(i.a,l)))}}]),r}(o.Component),v=e=>function(t){p(n,t);var r=d(n);function n(){return c(this,n),r.apply(this,arguments)}return l(n,[{key:"render",value:function(){return o.createElement(y,e)}}]),n}(o.Component)},20769:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n,o,i=r(11766),a=r(12706),c=r(20770),s=r(11773),l=r(14337),u=r(13240),p=r(13272),f=r(20771),d=r(20772),m=r(20340),b=r(14346),y=r(20775),v=r(13031),h=r(12375);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=k(e);if(t){var o=k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return T(this,r)}}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var x=Object(l.c)((R((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(s,e);var t,r,n,o=j(s);function s(){var e;E(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).telemetryEventNames={renderHelpPane:u.c.RecommendationHelpClicked,itemClicked:u.c.RecommendationHelpItemClicked,seeMoreClicked:u.c.RecommendationHelpSeeMoreClicked,noResults:u.c.RecommendationHelpNoResults},e.classNames=Object(a.a)()(c.b),e.resultItemOverridedClassNames=Object(a.a)()(c.a),e.mapHelpItems=(e,t)=>r=>O({key:r.id,icon:e,category:t},r),e.onRenderHeader=t=>t&&t.group?i.createElement("div",{className:e.classNames.groupHeader},t.group.name):null,e.onRenderShowAll=t=>{if(!t||!t.group)return null;var r="";switch(t.group.key){case f.a.community:r=e.props.sharedComponentResources.RemediationPane.HelpPane.ShowMoreCommunity;break;case f.a.articles:r=e.props.sharedComponentResources.RemediationPane.HelpPane.ShowMoreDocumentation;break;case f.a.blogs:r=e.props.sharedComponentResources.RemediationPane.HelpPane.ShowMoreBlogs;break;default:r=e.props.clientResources.List.ShowMore}return i.createElement(b.a,{className:e.classNames.helpShowMore,onClick:r=>{t&&t.group&&(t.onToggleSummarize(t.group),e.props.telemetryService.tagEvent(e.telemetryEventNames.seeMoreClicked,null,{groupCategory:t.group.key,initialItemCount:t.group.count}),r.stopPropagation(),r.preventDefault())}},r)},e.getGroupName=t=>{switch(t){case f.a.community:return e.props.sharedComponentResources.View.Header.Learn.Community;case f.a.articles:return e.props.sharedComponentResources.View.Header.Learn.Documentation;case f.a.blogs:return e.props.sharedComponentResources.View.Header.Learn.Blog;default:return""}},e.renderTroubleshootCell=(t,r,n)=>{var{assetService:o,cdnService:a,telemetryService:c}=e.props;return r?i.createElement(d.a,{title:r.name,subTitle:e.getSubtitle(r),url:r.properties.url,searchText:e.searchText,type:y.a.support,linkTarget:b.b.blank,icon:r.icon,styleOverrides:e.resultItemOverridedClassNames,eventName:e.telemetryEventNames.itemClicked,assetService:o,cdnService:a,telemetryService:c}):null},e.getSubtitle=t=>{switch(t.category){case f.a.articles:if(t.properties.url)return new URL(t.properties.url).pathname}return Object(v.a)(e.props.sharedComponentResources.OfficeHeader.ItemModified,new Intl.DateTimeFormat(Object(h.a)()||"en-us",{month:"2-digit",day:"2-digit",year:"2-digit"}).format(new Date(t.properties.modified)))},e}return t=s,(r=[{key:"render",value:function(){var e={showEmptyGroups:!1,onRenderHeader:this.onRenderHeader,onRenderShowAll:this.onRenderShowAll};return this.helpItems.length>0?i.createElement(m.a,{className:this.classNames.root,groupProps:e,groups:this.helpGroups,items:this.helpItems,onRenderCell:this.renderTroubleshootCell}):i.createElement("div",{className:this.classNames.noResults},i.createElement("div",{className:this.classNames.noResultsHeader},this.noResultsHeader),i.createElement("div",{className:this.classNames.noResultsDescription},this.noResultsDescription," ",i.createElement("span",{className:this.classNames.noResultsAction},i.createElement(b.a,{href:this.noResultsActionUri,target:b.b.blank},this.noResultsActionText))))}},{key:"componentDidMount",value:function(){this.props.telemetryService.tagEvent(this.telemetryEventNames.renderHelpPane,null,{hasSearchText:!!this.searchText,article:this.articleItems.length,blog:this.blogItems.length,community:this.communityItems.length}),0===this.helpItems.length&&this.props.telemetryService.tagEvent(this.telemetryEventNames.noResults,null,{hasSearchText:!!this.searchText})}},{key:"communityItems",get:function(){return this.props.remediationData.universalSearchResults?(this.props.remediationData.universalSearchResults.community||[]).map(this.mapHelpItems(p.a.Community,f.a.community)):[]}},{key:"articleItems",get:function(){return this.props.remediationData.universalSearchResults?(this.props.remediationData.universalSearchResults.article||[]).map(this.mapHelpItems(p.a.Documentation,f.a.articles)):[]}},{key:"blogItems",get:function(){return this.props.remediationData.universalSearchResults?(this.props.remediationData.universalSearchResults.blog||[]).map(this.mapHelpItems(p.a.Blog,f.a.blogs)):[]}},{key:"helpItems",get:function(){return[...this.articleItems,...this.communityItems,...this.blogItems]}},{key:"helpGroups",get:function(){var e=0,t=(t,r)=>{var n;return r&&r.length&&(n={key:t,name:this.getGroupName(t),ariaLabel:this.getGroupName(t),startIndex:e,count:Math.min(r.length,3),level:0,hasMoreData:r.length>3},e+=r.length),n};return[t(f.a.articles,this.articleItems),t(f.a.community,this.communityItems),t(f.a.blogs,this.blogItems)].filter(e=>e)}},{key:"searchText",get:function(){return this.props.remediationData.searchText||this.props.remediationData.errorDescription||""}},{key:"noResultsHeader",get:function(){var{sharedComponentResources:e,noHelpResults:t}=this.props;return t&&t.header||e.RemediationPane.HelpPane.NoResultsHeader}},{key:"noResultsDescription",get:function(){var{sharedComponentResources:e,noHelpResults:t}=this.props;return t&&t.description||e.RemediationPane.HelpPane.NoResultsDescription}},{key:"noResultsActionText",get:function(){var{sharedComponentResources:e,noHelpResults:t}=this.props;return t&&t.actionText||e.RemediationPane.HelpPane.NoResultsAction}},{key:"noResultsActionUri",get:function(){var{appSettings:e,noHelpResults:t}=this.props;return t&&t.actionUri||e.communityUrl}}])&&C(t.prototype,r),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(i.Component)).prototype,"communityItems",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"communityItems"),o.prototype),R(o.prototype,"articleItems",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"articleItems"),o.prototype),R(o.prototype,"blogItems",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"blogItems"),o.prototype),R(o.prototype,"helpItems",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"helpItems"),o.prototype),R(o.prototype,"helpGroups",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"helpGroups"),o.prototype),R(o.prototype,"searchText",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"searchText"),o.prototype),R(o.prototype,"noResultsHeader",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"noResultsHeader"),o.prototype),R(o.prototype,"noResultsDescription",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"noResultsDescription"),o.prototype),R(o.prototype,"noResultsActionText",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"noResultsActionText"),o.prototype),R(o.prototype,"noResultsActionUri",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"noResultsActionUri"),o.prototype),n=o))||n},20770:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(12754),o=e=>{var t=Object(n.Y)().palette;return{root:["fl-remediationHelp-root",{paddingTop:5,color:t.black}],groupHeader:["fl-remediationHelp-groupHeader",{fontWeight:"bold",fontSize:"14px",paddingBottom:5}],helpShowMore:["fl-remediationHelp-helpShowMore",{fontSize:"12px",paddingBottom:15,paddingTop:10}],noResults:["fl-remediationHelp-noResults",{color:t.black,paddingBottom:8}],noResultsIcon:["fl-remediationHelp-noResultsIcon",{padding:20,textAlign:"center"}],noResultsHeader:["fl-remediationHelp-noResultsHeader",{fontSize:"14px",fontWeight:"bold",paddingBottom:5,paddingTop:10}],noResultsDescription:["fl-remediationHelp-noResultsDescription",{paddingTop:5,paddingBottom:5,display:"flex",flexDirection:"column"}],noResultsAction:["fl-remediationHelp-noResultsAction",{color:t.blue}]}},i=e=>({root:["fl-remediationHelp-ResultItem-root",{display:"block",selectors:{":hover, :focus, :active":{textDecoration:"none"}}}],content:["fl-remediationHelp-ResultItem-content",{width:"inherit",backgroundColor:"transparent",display:"flex",justifyContent:"flex-start",cursor:"pointer",overflow:"hidden",padding:"8px 16px 8px 0px",selectors:{":hover, :focus, :active":{textDecoration:"none"}}}]})},20771:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.all="all",e.flows="flows",e.templates="templates",e.articles="articles",e.community="community",e.blogs="blogs",e}({})},20772:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r(11766),o=r(12812),i=r(12706),a=r(12728),c=r(14346),s=r(13240),l=r(20773),u=r(13260),p=r(14343),f=r(20774);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=C(e);if(t){var o=C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(g,e);var t,r,m,y=w(g);function g(){var e;v(this,g);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=y.call(this,...r)).getClassNames=Object(i.a)(),e.tooltipId=Object(a.a)("fl-OfficeHeaderSearch-tooltip"),e.onClickItem=()=>{e.props.telemetryService.tagEvent(e.props.eventName||s.c.OfficeHeaderItemClicked,null,{name:e.props.title,url:e.props.url,hasSearchText:!!e.props.searchText,type:e.props.type})},e}return t=g,(r=[{key:"render",value:function(){var e=this.getClassNames(l.a),t=b(b({},this.props),{},{location:void 0,styles:void 0});return n.createElement("div",{role:"row","data-automation-id":f.a.remediationSidePanel.troubleshootItem},n.createElement("div",{role:"cell"},n.createElement(u.b,{id:this.tooltipId,text:t.title},n.createElement(c.a,{href:t.url,className:this.props.styleOverrides&&this.props.styleOverrides.root||e.root,onClick:this.onClickItem,target:t.linkTarget,dataAutomationId:f.a.remediationSidePanel.troubleshootItemAnchor},n.createElement("div",{className:this.props.styleOverrides&&this.props.styleOverrides.content||e.content},n.createElement("div",{className:e.iconContainer},t.iconInfo&&t.iconInfo.length>0?n.createElement(p.a,d({className:e.apiIcon,size:p.b.medium,iconUri:t.iconInfo[0].iconUri||this.props.assetService.connection,cdnService:this.props.cdnService},t.iconInfo[0])):n.createElement("div",{className:e.icon},n.createElement(o.a,{iconName:t.icon}))),n.createElement("div",{className:e.titleContainer},n.createElement("span",{className:e.title},t.title),n.createElement("span",{className:e.subTitle},t.subTitle)))))))}}])&&h(t.prototype,r),m&&h(t,m),Object.defineProperty(t,"prototype",{writable:!1}),g}(n.Component)},20773:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>{var t=Object(n.Y)();return{root:["fl-OfficeHeaderResultItem-root",{display:"block"}],content:["fl-OfficeHeaderResultItem-content",{width:"inherit",backgroundColor:"transparent",display:"flex",justifyContent:"flex-start",cursor:"pointer",overflow:"hidden",padding:"8px 16px"}],iconContainer:["fl-OfficeHeaderResultItem-iconContainer",{marginRight:"12px"}],icon:["fl-OfficeHeaderResultItem-icon",{margin:"4px 0",boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.15)",borderRadius:"3px",backgroundColor:t.palette.neutralLighter,width:32,height:32,display:"flex",justifyContent:"center",alignItems:"center",selectors:{i:{fontSize:n.k.mediumPlus,lineHeight:n.k.mediumPlus,color:t.palette.neutralSecondary}}}],apiIcon:["fl-OfficeHeaderResultItem-apiIcon",{height:"100%",padding:0,boxSizing:"border-box"}],titleContainer:["fl-OfficeHeaderResultItem-titleContainer",{display:"flex",justifyContent:"space-around",flexDirection:"column"}],title:["fl-OfficeHeaderResultItem-title",{overflow:"hidden",textOverflow:"ellipsis",fontSize:n.k.medium,display:"block",color:t.palette.neutralPrimary,lineHeight:"normal"}],subTitle:["fl-OfficeHeaderResultItem-subTitle",{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:n.k.small,display:"block",color:t.palette.neutralSecondary,lineHeight:"normal",maxWidth:350}]}}},20775:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.flow="flow",e.template="template",e.support="support",e.api="api",e}({})},20776:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>{Object(n.Y)().palette;return{root:["fl-helpResults-root",{overflow:"auto",marginTop:12,padding:"0 12px"}],container:["fl-helpResults-container",{overflow:"auto"}]}}},20777:function(e,t,r){"use strict";var n=r(20778);r.d(t,"a",(function(){return n.a}))},20778:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.BuiltIn="BuiltIn",e.Api="Api",e.Custom="Custom",e.Standard="Standard",e.Premium="Premium",e.Enterprise="Enterprise",e.OpenApi="OpenApi",e.SolutionFlow="SolutionFlow",e.ToS="ToS",e}({})},20781:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(19924),o=r(20779),i=r(20777);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,r,c,u=l(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e,n.b.BUILT_IN)).options=e,t}return t=p,(r=[{key:"shouldAllowTriggerSelectionAsAction",value:function(e,t,r){return r===n.a.ACTIONS}},{key:"getDesignerOperationsRequestOptions",value:function(e,t,r){var n=this.getBaseDesignerOperationsRequestOptions(e,t,r);return n.allTagsToInclude.push(o.a.BuiltIn),n.anyTagsToExclude.push(o.a.Custom,o.a.Api),n}},{key:"getDesignerOperationGroupsRequestOptions",value:function(e,t,r){var n=this.getBaseDesignerOperationGroupsRequestOptions(e,t,r);return n.allTagsToInclude.push(i.a.BuiltIn),n.anyTagsToExclude.push(i.a.Custom,i.a.Api),n}}])&&a(t.prototype,r),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),p}(r(20767).a)},20782:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(20777),o=r(20779),i=r(19924);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,r,c,u=l(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e,i.b.STANDARD)).options=e,t}return t=p,(r=[{key:"getDesignerOperationsRequestOptions",value:function(e,t,r){var n=this.getBaseDesignerOperationsRequestOptions(e,t,r);return n.allTagsToInclude.push(o.a.Standard,o.a.Api),n.anyTagsToExclude.push(o.a.Custom),n}},{key:"getDesignerOperationGroupsRequestOptions",value:function(e,t,r){var o=this.getBaseDesignerOperationGroupsRequestOptions(e,t,r);return o.allTagsToInclude.push(n.a.Standard,n.a.Api),o.anyTagsToExclude.push(n.a.Custom),o}}])&&a(t.prototype,r),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),p}(r(20767).a)},20783:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(20777),o=r(20779),i=r(19924);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,r,c,u=l(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e,i.b.PREMIUM)).options=e,t}return t=p,(r=[{key:"getDesignerOperationsRequestOptions",value:function(e,t,r){var n=this.getBaseDesignerOperationsRequestOptions(e,t,r);return n.allTagsToInclude.push(o.a.Premium),n.anyTagsToExclude.push(o.a.Custom),n}},{key:"getDesignerOperationGroupsRequestOptions",value:function(e,t,r){var o=this.getBaseDesignerOperationGroupsRequestOptions(e,t,r);return o.allTagsToInclude.push(n.a.Premium),o.anyTagsToExclude.push(n.a.Custom),o}}])&&a(t.prototype,r),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),p}(r(20767).a)},20784:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(19924),o=r(20779),i=r(20777);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,r,c,u=l(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e,n.b.CUSTOM)).options=e,t}return t=p,(r=[{key:"getDesignerOperationsRequestOptions",value:function(e,t,r){var n=this.getBaseDesignerOperationsRequestOptions(e,t,r);return n.allTagsToInclude.push(o.a.Custom),n}},{key:"getDesignerOperationGroupsRequestOptions",value:function(e,t,r){var n=this.getBaseDesignerOperationGroupsRequestOptions(e,t,r);return n.allTagsToInclude.push(i.a.Custom),n}}])&&a(t.prototype,r),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),p}(r(20767).a)},20785:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(20760),o=r(19927),i=r(19924),a=r(19928),c=r(19923),s=r(12999),l=r(11891),u=r(20151);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(y,e);var t,r,f,b=m(y);function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=b.call(this,e))._isInScope=void 0,t._isInScope=!1,t}return t=y,(r=[{key:"getConnectors",value:function(e,t){var r=this._getRpaConnectors().filter(n.b).filter(Object(n.c)(e)),i=Object(a.a)([])(r).sort(o.d);return Promise.resolve({rawValue:r,value:i})}},{key:"getConnectorsByContinuationToken",value:function(){throw new c.d("Not implemented")}},{key:"getOperations",value:function(e,t){var r=this._getRpaOperations(t).filter(Object(c.B)(e)),n=Object(c.z)(this.options.flowServiceResources,[u.a.RPA_MANUAL_ACTIONS])(r).sort(o.e);return Promise.resolve({rawValue:r,value:n})}},{key:"getOperationsByConnector",value:function(e,t,r){var n=this._getRpaOperations(r,e).filter(Object(c.A)(e)).filter(Object(c.B)(t)),i=Object(c.z)(this.options.flowServiceResources,void 0)(n).sort(o.e);return Promise.resolve({rawValue:n,value:i})}},{key:"getOperationsByContinuationToken",value:function(){throw new c.d("Not implemented")}},{key:"setIsInScope",value:function(e){this._isInScope=e}},{key:"shouldAllowTriggerSelectionAsAction",value:function(e,t,r){return r===i.a.ACTIONS}},{key:"_getRpaConnectors",value:function(){return this._isInScope?[...Object(s.a)().enableRpaBuiltinOperations?[Object(u.c)(this.options.flowServiceResources,this.options.assetService)[u.a.RPA_RECORDER]]:[],Object(u.c)(this.options.flowServiceResources,this.options.assetService)[u.a.RPA_MANUAL_ACTIONS],...Object(s.a)().enableSAPActions?[Object(u.c)(this.options.flowServiceResources,this.options.assetService)[u.a.RPA_SAP_ACTIONS]]:[],...Object(s.a)().enableRpaWinAutomationAction?[Object(u.c)(this.options.flowServiceResources,this.options.assetService)[u.a.RPA_WINAUTOMATION_ACTIONS]]:[]]:[Object(u.c)(this.options.flowServiceResources,this.options.assetService)[u.a.RPA_RECORDER],...Object(s.a)().enableRpaWinAutomationAction?[Object(u.c)(this.options.flowServiceResources,this.options.assetService)[u.a.RPA_WINAUTOMATION_ACTIONS]]:[]]}},{key:"_getRpaOperations",value:function(e,t){return e===i.a.TRIGGERS?t||this._isInScope?[]:[...Object(u.g)(this.options.featureFlags,this.options.flowServiceResources,this.options.assetService)]:this._isInScope?[...Object(s.a)().enableRpaBuiltinOperations?Object(u.e)(this.options.flowServiceResources,this.options.assetService):[],...this._filterInternalOperations(Object(u.d)(this.options.flowServiceResources,this.options.assetService)),...Object(s.a)().enableSAPActions?this._filterInternalOperations(Object(u.f)(this.options.flowServiceResources,this.options.assetService)):[],...Object(s.a)().enableRpaWinAutomationAction?this._filterInternalOperations(Object(u.h)(this.options.flowServiceResources,this.options.assetService)):[]]:[...Object(u.e)(this.options.flowServiceResources,this.options.assetService),...Object(s.a)().enableRpaWinAutomationAction?this._filterInternalOperations(Object(u.h)(this.options.flowServiceResources,this.options.assetService)):[]]}},{key:"_filterInternalOperations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter(e=>!e.properties||!Object(l.a)("internal",e.properties.visibility))}}])&&p(t.prototype,r),f&&p(t,f),Object.defineProperty(t,"prototype",{writable:!1}),y}(c.e)},20786:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(20787);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enableFormulaFromExamples=t}var t,r,i;return t=e,(r=[{key:"getTokenPickerType",value:function(){if(this.enableFormulaFromExamples)return n.a}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20787:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(11766),o=r.n(n),i=r(20327),a=r(20365),c=r(19713),s=r(20321),l=r(20162),u=r(20400),p=e=>{var{editorContext:t,displayInline:r,displayMode:n,initialExpression:p,showTokens:f,tokenModeFilter:d,onTokenPickerOKClicked:m,onTokenSelection:b}=e,y=o.a.useRef(Object(c.a)()),v=o.a.useRef(null),h=t.getService(s.a.TOKEN),g=o.a.useMemo(()=>{var e=t.getService(s.a.PARAMETER).getParameterInfo();return{displayName:null==e?void 0:e.name,schema:{format:null==e?void 0:e.info.format,type:null==e?void 0:e.type}}},[t]),O=o.a.useMemo(()=>{var e=e=>{var t,{expression:r}=e,n=Object(l.i)(y.current.designerResources,r);null==m||m({segment:n}),h.setTokenPickerVisibility(!1),null===(t=v.current)||void 0===t||t.close()},t=()=>{var e;null===(e=v.current)||void 0===e||e.close()};return Object(a.a)({onFormulaFromExamplesOptionClicked:()=>{var r;null===(r=v.current)||void 0===r||r.initializeAndOpen({parameter:g,onApply:e,onCancel:t})},loggingService:y.current.loggingService,resources:y.current.designerResources.ExpressionFromExamples.TokenPicker})},[m,g,h]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.a,{activeSelectedSegmentInfo:p,displayInline:null!=r&&r,displayMode:n,parameterContext:g,tokenModeFilter:d,tokenService:h,visible:f,handleTokenSelection:b,handleTokenPickerOKClicked:m,getCustomTokenPickerSections:O}),o.a.createElement(i.a,{designerEditorContext:y.current,tokenService:h,ref:v}))}},20788:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n={ENABLE_CREDENTIALS_MAPPING:"ENABLE_CREDENTIALS_MAPPING",ENABLE_ENUM_INPUT_OUTPUT_OVERWRITE:"ENABLE_ENUM_INPUT_OUTPUT_OVERWRITE",NEW_RECOMMENDATION_CARD_WITH_MODULES:"NEW_RECOMMENDATION_CARD_WITH_MODULES",NEW_RECOMMENDATION_CARD_WITH_FOR_YOU:"NEW_RECOMMENDATION_CARD_WITH_FOR_YOU",OPEN_API_CONNECTION:"OPEN_API_CONNECTION",SHOW_VARIABLE_ACTIONS:"SHOW_VARIABLE_ACTIONS",USE_BUTTON_TRIGGER:"USE_BUTTON_TRIGGER",USE_CDS_FOR_APPS_FLOWSTEP_TRIGGER:"USE_CDS_FOR_APPS_FLOWSTEP_TRIGGER",USE_CDS_FOR_APPS_SELECT_TRIGGER:"USE_CDS_FOR_APPS_SELECT_TRIGGER",USE_CDS_REQUEST_APICONNECTION_TRIGGER:"USE_CDS_REQUEST_APICONNECTION_TRIGGER",USE_DYNAMICSAX_REQUEST_APICONNECTION_TRIGGER:"USE_DYNAMICSAX_REQUEST_APICONNECTION_TRIGGER",USE_EXCEL_FORMATTED_REQUEST_APICONNECTION_TRIGGER:"USE_EXCEL_FORMATTED_REQUEST_APICONNECTION_TRIGGER",USE_HUB_SITE_JOIN_APPROVAL_REQUEST_APICONNECTION_TRIGGER:"USE_HUB_SITE_JOIN_APPROVAL_REQUEST_APICONNECTION_TRIGGER",USE_SHAREPOINT_FOR_A_SELECTED_FILE_REQUEST_APICONNECTION_TRIGGER:"USE_SHAREPOINT_FOR_A_SELECTED_FILE_REQUEST_APICONNECTION_TRIGGER",USE_POWERAPPS_RESPONSE_ACTION:"USE_POWERAPPS_RESPONSE_ACTION",USE_GEOFENCE_REQUEST_TRIGGER:"USE_GEOFENCE_REQUEST_TRIGGER",USE_TEAMS_FOR_A_SELECTED_MESSAGE_REQUEST_APICONNECTION_TRIGGER:"USE_TEAMS_FOR_A_SELECTED_MESSAGE_REQUEST_APICONNECTION_TRIGGER",USE_TEAMS_FOR_COMPOSING_A_MESSAGE_REQUEST_APICONNECTION_TRIGGER:"USE_TEAMS_FOR_COMPOSING_A_MESSAGE_REQUEST_APICONNECTION_TRIGGER",USE_TEAMS_CARD_RESPONSE_TRIGGER:"USE_TEAMS_CARD_RESPONSE_TRIGGER",USE_TEAMS_TASK_MODULE_RESPONSE:"USE_TEAMS_TASK_MODULE_RESPONSE",USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_CASE_HYBRID_TRIGGER:"USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_CASE_HYBRID_TRIGGER",USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_RISKY_USER_HYBRID_TRIGGER:"USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_RISKY_USER_HYBRID_TRIGGER",USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_ITEM_HYBRID_TRIGGER:"USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_IRM_ITEM_HYBRID_TRIGGER",USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_CC_ITEM_HYBRID_TRIGGER:"USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_CC_ITEM_HYBRID_TRIGGER",USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_PRIVACY_CASE_HYBRID_TRIGGER:"USE_MICROSOFT365COMPLIANCE_FOR_SELECTED_PRIVACY_CASE_HYBRID_TRIGGER",USE_DYNAMICSSMBSAAS_FOR_SELECTED_RECORD_HYBRID_TRIGGER:"USE_DYNAMICSSMBSAAS_FOR_SELECTED_RECORD_HYBRID_TRIGGER",USE_POWERPAGES_HYBRID_TRIGGER:"USE_POWERPAGES_HYBRID_TRIGGER",USE_POWERPAGES_TRIGGER_RESPONSE:"USE_POWERPAGES_TRIGGER_RESPONSE",USE_SKILLS_TRIGGER:"USE_SKILLS_TRIGGER",USE_HTTP_OAUTH_TRIGGER:"USE_HTTP_OAUTH_TRIGGER",USE_TEAMS_INCOMING_WEBHOOK_TRIGGER:"USE_TEAMS_INCOMING_WEBHOOK_TRIGGER",USE_D365_REQUEST_APICONNECTION_TRIGGER:"USE_D365_REQUEST_APICONNECTION_TRIGGER",USE_EXCEL_REQUEST_APICONNECTION_TRIGGER:"USE_EXCEL_REQUEST_APICONNECTION_TRIGGER",USE_FUNCTIONS:"USE_FUNCTIONS",USE_ODB_REQUEST_APICONNECTION_TRIGGER:"USE_ODB_REQUEST_APICONNECTION_TRIGGER",USE_POWERAPPSV2_TRIGGER:"USE_POWERAPPSV2_TRIGGER",USE_VIRTUAL_AGENT_TRIGGER_RESPONSE:"USE_VIRTUAL_AGENT_TRIGGER_RESPONSE",USE_POWERBI_REQUEST_APICONNECTION_TRIGGER:"USE_POWERBI_REQUEST_APICONNECTION_TRIGGER",USE_POWERVIRTUALAGENTS_HYBRID_TRIGGER:"USE_POWERVIRTUALAGENTS_HYBRID_TRIGGER",USE_MICROSOFT365_APPS_HEALTH_FOR_SELECTED_ADVISORY_HYBRID_TRIGGER:"USE_MICROSOFT365_APPS_HEALTH_FOR_SELECTED_ADVISORY_HYBRID_TRIGGER"},o={text:"Please vote for or make a new suggestion on the ",link:"https://powerusers.microsoft.com/t5/Flow-Ideas/idb-p/FlowIdeas",linkDisplayText:"Flow Ideas forum"}},20789:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e[e.newFlowFromBlank=0]="newFlowFromBlank",e[e.newFlowFromTemplate=1]="newFlowFromTemplate",e[e.editExistingFlow=2]="editExistingFlow",e[e.editFlowDraft=3]="editFlowDraft",e[e.naturalLanguageToFlow=4]="naturalLanguageToFlow",e[e.multiTurnNaturalLanguageToFlow=5]="multiTurnNaturalLanguageToFlow",e[e.flowRun=6]="flowRun",e[e.localAutoSave=7]="localAutoSave",e}({})},20790:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(20748),o=r(12327),i=r(12324),a=e=>{var t=Object(i.cloneDeep)(e);return Object(o.k)(t)?c(t):(Object(n.a)(t,(e,t)=>{var r=e[t];Object(o.k)(r)&&(e[t]=c(r))}),t)},c=e=>e.replace(/AADSTS500021: Access to '[^']*' tenant is denied/g,"AADSTS500021: Access to '--scrubbedPII--' tenant is denied")},20791:function(e,t,r){"use strict";r.d(t,"a",(function(){return X}));var n=r(13069),o=r(14876),i=r(12330),a=r(20792),c=r(20793),s=r(11773),l=r(12364),u=r(13009),p=r(20794),f=r(14924),d=r(14837),m=r(20795),b=r(20796),y=r(19692),v=r(13085),h=r(12339),g=r(20797),O=r(12999),w=r(20798),E=r(20430),C=r(18959),S=r(13144),P=r(14873),j=r(15402),T=r(13146),k=r(20756),R=r(11891),x=r(13031),N=r(13051),_=r(20588),D=r(20799),I=r(19923),A=r(20800),F=r(20801),L=r(13180),M=r(13214),B=r(13186),U=r(13187),V=r(20802);function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){W(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e,t,r){return(t=Y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function K(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){H(i,n,o,a,c,"next",e)}function c(e){H(i,n,o,a,c,"throw",e)}a(void 0)}))}}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y(n.key),n)}}function Y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var X=function(){function e(t,r,n,o,i,a,c,s,l,u,p,m,b,y){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.allowCoauthoring=t,this.clientResources=r,this.flowName=n,this.loggingService=o,this.prefetchedConnections=i,this.graphService=a,this.xrmChildFlowsClient=c,this.environmentStore=s,this.tokenService=l,this.designerConnectionStore=u,this.dynamicListStore=p,this.flowStore=m,this.getSessionUser=b,this.isXrmConnectionReferenceMode=y,this.listDynamicValuesRunFirstPending=Object(T.a)(),this.getTreeDynamicValuesRunFirstPending=Object(T.a)(),this.getDynamicSchemaRunFirstPending=Object(T.a)(),this.powerPlatformApiDiscovery=void 0,this.isValidChildFlow=e=>{var t;try{t=JSON.parse(e.clientdata||"")}catch(o){this.loggingService.logError("ConnectorV2Service.IsValidChildFlow",o)}var r=Object(P.f)(t);if(!r||!r.manual)return this.loggingService.logInfo("ConnectorV2Service.IsValidChildFlow","No matching trigger type found for workflow '".concat(e.workflowid,"'")),!1;var n=r.manual;return!(!Object(R.a)(n.type,d.a.Request)||!(Object(R.a)(n.kind,f.a.Button)||Object(R.a)(n.kind,f.a.Http)||Object(R.a)(n.kind,f.a.PowerApp)||Object(R.a)(n.kind,f.a.PowerAppV2)||Object(R.a)(n.kind,f.a.VirtualAgent)))},this.powerPlatformApiDiscovery=new M.a(Object(A.a)())}var t,r,z,W,H,Y,X,Q,Z,J,$,ee,te,re,ne;return t=e,(r=[{key:"getBuiltinListDynamicValues",value:(ne=K((function*(e,t,r,n,o,i){return this.fetchBuiltInListDynamicValues(e,t,r,o,i)})),function(e,t,r,n,o,i){return ne.apply(this,arguments)})},{key:"getListDynamicValues",value:(re=K((function*(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8&&void 0!==arguments[8]&&arguments[8];return e=this.getConnectionIdFromDesignerConnectionId(e),Object(I.r)(t)?this.fetchBuiltInListDynamicValues(e,t,r,o,i):this.fetchRemoteListDynamicValues(e,t,r,n,o,i,a,c,s)})),function(e,t,r,n,o,i){return re.apply(this,arguments)})},{key:"fetchRemoteListDynamicValues",value:(te=K((function*(e,t,r,n,i,a){var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,p=t.split("/").pop();if(!p)throw new u.a(u.c.ConnectorV2ServiceGetListDynamicValues,this.clientResources.Error.ListDynamicValues,null,{errorDetails:"Argument connectorName: '".concat(Object(k.a)(p),"' is required to fetch list dynamic values")});var f=e.split("/").pop();if(!f)throw new u.a(u.c.ConnectorV2ServiceGetListDynamicValues,this.clientResources.Error.ListDynamicValues,null,{errorDetails:"Argument connectionName: '".concat(Object(k.a)(f),"' is required to fetch list dynamic values")});var d=Object(k.a)(i),m="listDynamicValues-".concat(f,"-").concat(p,"-").concat(n,"-").concat(d),b="listDynamicValues-".concat(f,"-").concat(p,"-").concat(r,"-").concat(n,"-").concat(d),y=Object(o.a)(i)?m:b;return Object(g.b)()&&this.auditDynamicListValueRequest(y),this.loggingService.logInfo(v.a.dynamicListInvokeEvent,"fetchRemoteListDynamicValues.dynamicListInvokeEvent",{connectionName:f,connectorName:p,operationId:r,parameterAlias:n}),yield this.listDynamicValuesRunFirstPending({key:y,action:()=>Object(j.b)({loggingService:this.loggingService,promise:this.fetchDynamicListValues(p,f,i,a,s?l:this.shouldUseFlowCredentials(e),y,c).then(e=>e.value).catch(e=>{throw new u.a(u.c.ConnectorV2ServiceGetListDynamicValues,e.message||this.clientResources.Error.ListDynamicValues,e)}),eventStartName:v.a.dynamicListInvokeStart,eventEndName:v.a.dynamicListInvokeEnd,eventData:G({connectionName:f,connectorName:p,operationId:r,parameterAlias:n},this.getListDynamicValueAudit(y)),getStatus:A.b})})})),function(e,t,r,n,o,i){return te.apply(this,arguments)})},{key:"mapChildFlowToDynamicValue",value:function(e){return{displayName:e.name,value:e.workflowid}}},{key:"mapUserOrGroupToDynamicValue",value:function(e){return{value:e.mail,displayName:e.displayName,description:e.mail}}},{key:"fetchBuiltInListDynamicValues",value:(ee=K((function*(e,t,r,n,o){var i=Object(I.v)(r)?I.h.CHILDFLOW:Object(I.t)(Object(N.h)(o,{builtInOperation:N.k})?o.builtInOperation:"")?I.h.GETUSERSANDGROUPS:"";if(""===i)throw new u.a("connectorV2Service.fetchBuiltInListDynamicValues",this.clientResources.Error.ListDynamicValues,new Error("Unsupported built-in operation '".concat(r,"' for connector '").concat(t,"'")));var a=null,c=null;try{switch(i){case I.h.CHILDFLOW:c=this.loggingService.profileStart(v.a.dynamicChildFlowsListInvokeStart),a=v.a.dynamicChildFlowsListInvokeEnd;var s=!1;if(Object(V.a)()){var l,p=null===(l=this.flowStore)||void 0===l||null===(l=l.flows.getEntity(this.flowName))||void 0===l?void 0:l.xrmWorkflowId;p&&Object(N.k)(p)?s=1===(yield this.xrmChildFlowsClient.getFlow(p)).modernflowtype:this.loggingService.logError("connectorV2Service.fetchBuiltInListDynamicValues","Failed to get workflow reference to check if mcs flow, assuming false")}var f=yield this.xrmChildFlowsClient.getEligibleChildFlows(s);return this.loggingService.profileEnd(c,a,u.e.Success),f.filter(this.isValidChildFlow).map(this.mapChildFlowToDynamicValue);case I.h.GETUSERSANDGROUPS:default:c=this.loggingService.profileStart(v.a.dynamicGetUsersAndGroupsInvokeStart),a=v.a.dynamicGetUsersAndGroupsInvokeEnd;var d=Object(N.h)(o,{filter:N.k})?o.filter:"",m=Object(O.a)(),b=d&&d.length>D.b?m.includeGroupsForGetUsersAndGroupsBuiltinOperation?yield this.graphService.queryUsersAndGroups({searchText:d,excludeGuestUsers:m.disableGuestUserSharing}):yield this.graphService.queryUsers({searchText:d,excludeGuestUsers:m.disableGuestUserSharing}):[];return this.loggingService.profileEnd(c,a,u.e.Success),b.map(this.mapUserOrGroupToDynamicValue)}}catch(y){throw c&&a&&this.loggingService.profileEnd(c,a,Object(u.y)(y),y),new u.a("connectorV2Service.fetchBuiltInListDynamicValues",y.message||this.clientResources.Error.ListDynamicValues,y)}})),function(e,t,r,n,o){return ee.apply(this,arguments)})},{key:"getTreeDynamicValues",value:($=K((function*(e,t,r,n,i,a){var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];e=this.getConnectionIdFromDesignerConnectionId(e);var l=t.split("/").pop();if(!l)throw new u.a(u.c.ConnectorV2ServiceGetTreeDynamicValues,this.clientResources.Error.ListDynamicValues,null,{errorDetails:"Argument connectorName: '".concat(Object(k.a)(l),"' is required to fetch tree dynamic values")});var p=e.split("/").pop();if(!p)throw new u.a(u.c.ConnectorV2ServiceGetTreeDynamicValues,this.clientResources.Error.ListDynamicValues,null,{errorDetails:"Argument connectionName: '".concat(Object(k.a)(p),"' is required to fetch tree dynamic values")});var f=Object(k.a)(i),d="getTreeDynamicValues-".concat(p,"-").concat(l,"-").concat(n,"-").concat(f),m="getTreeDynamicValues-".concat(p,"-").concat(l,"-").concat(r,"-").concat(n,"-").concat(f),b=Object(o.a)(i)?d:m;return this.loggingService.logInfo(v.a.dynamicTreeInvokeEvent,"getTreeDynamicValues.dynamicTreeInvokeEvent",{connectionName:p,connectorName:l,operationId:r,parameterAlias:n}),yield this.getTreeDynamicValuesRunFirstPending({key:b,action:()=>Object(j.b)({loggingService:this.loggingService,promise:this.fetchTreeDynamicValues(l,p,i,a,c?s:this.shouldUseFlowCredentials(e)).then(e=>this.transformTreeItems(e.value,a)).catch(e=>{throw new u.a(u.c.ConnectorV2ServiceGetTreeDynamicValues,e.message||this.clientResources.Error.ListDynamicValues,e)}),eventStartName:v.a.dynamicTreeInvokeStart,eventEndName:v.a.dynamicTreeInvokeEnd,eventData:{connectionName:p,connectorName:l,operationId:r,parameterAlias:n},getStatus:A.b})})})),function(e,t,r,n,o,i){return $.apply(this,arguments)})},{key:"getDynamicSchema",value:(J=K((function*(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8&&void 0!==arguments[8]&&arguments[8];return e=this.getConnectionIdFromDesignerConnectionId(e),Object(I.r)(t)?this.fetchBuiltInDynamicSchema(e,t,r,o,i,c):this.fetchRemoteDynamicSchema(e,t,r,n,o,i,a,c,s)})),function(e,t,r,n,o,i){return J.apply(this,arguments)})},{key:"fetchRemoteDynamicSchema",value:(Z=K((function*(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8&&void 0!==arguments[8]&&arguments[8],l=t.split("/").pop();if(!l)throw new u.a(u.c.ConnectorV2ServiceGetDynamicSchema,this.clientResources.Error.listDynamicSchema,null,{errorDetails:"Argument connectorName: '".concat(Object(k.a)(l),"' is required to fetch dynamic schema")});var p=e.split("/").pop();if(!p)throw new u.a(u.c.ConnectorV2ServiceGetDynamicSchema,this.clientResources.Error.listDynamicSchema,null,{errorDetails:"Argument connectionName: '".concat(Object(k.a)(p),"' is required to fetch dynamic schema")});var f=Object(k.a)(o),d=Object(k.a)(i),m="getDynamicSchema-".concat(p,"-").concat(l,"-").concat(r,"-").concat(n,"-").concat(f,"-").concat(d);if(Object(g.a)()&&this.auditDynamicSchemaValueRequest(m),this.loggingService.logInfo(v.a.dynamicPropertiesInvokeEvent,"fetchRemoteDynamicSchema.dynamicPropertiesInvokeEvent",{connectionName:p,connectorName:l,operationId:r,parameterAlias:n,dynamicState:i}),!Object(N.h)(i,{schemaAlias:Object(N.l)(N.k),isInput:N.m,extension:N.m}))throw new u.a(u.c.ConnectorV2ServiceGetDynamicSchema,this.clientResources.Error.listDynamicSchema,null,{errorDetails:"Argument dynamicState: '".concat(Object(k.a)(i),"' does not contain the required properties for its usage in function fetchRemoteDynamicSchema")});return yield this.getDynamicSchemaRunFirstPending({key:m,action:()=>Object(j.b)({loggingService:this.loggingService,promise:this.fetchDynamicSchema(l,p,n,o,{extension:i.extension,isInput:!!i.isInput},c?s:this.shouldUseFlowCredentials(e),m,a).then(e=>{if(e){var n=i.schemaAlias;n&&(e[b.a.Alias]=n),Object(y.b)(e,!!i.isInput,void 0,c),(t.includes("shared_sharepointonline")&&"GetItems"===r||Object(_.c)(t,r))&&Object(_.a)(o,e,t,r)}return e}).catch(e=>{if(Object(u.M)(e))throw new u.a(u.c.XrmWorkflowNotFound,this.clientResources.Error.GenerativeActionNotFound,e);throw new u.a(u.c.ConnectorV2ServiceGetDynamicSchema,e.message||this.clientResources.Error.listDynamicSchema,e)}),eventStartName:v.a.dynamicPropertiesInvokeStart,eventEndName:v.a.dynamicPropertiesInvokeEnd,eventData:G({connectionName:p,connectorName:l,operationId:r,parameterAlias:n,dynamicState:i},this.getListDynamicSchemaAudit(m)),getStatus:A.b})})})),function(e,t,r,n,o,i){return Z.apply(this,arguments)})},{key:"fetchBuiltInDynamicSchema",value:(Q=K((function*(e,t,r,n,o,i){var a,c=this.loggingService.profileStart(v.a.dynamicChildFlowPropertiesInvokeStart);if(!Object(F.a)(o)||null===(a=o.extension)||void 0===a||!a.operationId)throw new u.a("connectorV2Service.fetchBuiltInDynamicSchema",this.clientResources.Error.listDynamicSchema,new Error("No dynamic schema operation for built-in connector '".concat(t,"'")));if(!Object(m.b)(o.extension.operationId)&&!Object(m.c)(o.extension.operationId))throw new u.a("connectorV2Service.fetchBuiltInDynamicSchema",this.clientResources.Error.listDynamicSchema,new Error("Unknown dynamic schema operation for built-in connector '".concat(t,"' and operation '").concat(o.extension.operationId,"'")));try{var s=n[m.d];if(!s||!Object(N.k)(s))throw new u.a("connectorV2Service.fetchBuiltInDynamicSchema",this.clientResources.Error.listDynamicSchema,new Error("Unable to find valid workflow reference."));var l=yield this.xrmChildFlowsClient.getFlow(s);if(!l||!l.workflowidunique)throw new u.a("connectorV2Service.fetchBuiltInDynamicSchema",this.clientResources.Error.listDynamicSchema,new Error("Unable to find valid Flow name for workflow '".concat(s,"'")));var p="flows/".concat(l.workflowidunique,"/listSwagger"),f={parameters:n},d=yield this.sendRequest(p,f),h=Object(m.b)(o.extension.operationId),g=h?Object(P.d)(d):Object(P.e)(d);if(!g)return h?void this.loggingService.logInfo("connectorV2Service.fetchBuiltInDynamicSchema","Missing manual trigger or input schema for workflow '".concat(s,"'")):{};if(h&&(!g.properties||0===Object.keys(g.properties).length))return;var O=o.schemaAlias;return O&&(g[b.a.Alias]=O),Object(y.b)(g,!!o.isInput,void 0,i),this.loggingService.profileEnd(c,v.a.dynamicChildFlowPropertiesInvokeEnd,u.e.Success),g}catch(w){throw this.loggingService.profileEnd(c,v.a.dynamicPropertiesInvokeEnd,Object(u.N)(w)?u.e.Warning:Object(u.y)(w),w),new u.a("connectorV2Service.fetchBuiltInDynamicSchema",w.message||this.clientResources.Error.listDynamicSchema,w)}})),function(e,t,r,n,o,i){return Q.apply(this,arguments)})},{key:"fetchTreeDynamicValues",value:(X=K((function*(e,t,r,n,o){var i=o?"flows/".concat(this.flowName,"/apis/").concat(e,"/connections/").concat(t,"/listTree"):"apis/".concat(e,"/connections/").concat(t,"/listTree"),a={parameters:r,dynamicInvocationDefinition:n.dynamicExtension,selectionState:n.selectionState};return this.sendRequest(i,a)})),function(e,t,r,n,o){return X.apply(this,arguments)})},{key:"fetchDynamicListValues",value:(Y=K((function*(e,t,r,n,o,a){var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=o?"flows/".concat(this.flowName,"/apis/").concat(e,"/connections/").concat(t,"/listEnum"):"apis/".concat(e,"/connections/").concat(t,"/listEnum"),u={parameters:r,dynamicInvocationDefinition:n},p=yield this.getListDynamicValueFromStoreWithLatency(a);if(!Object(g.b)()||Object(i.a)(p)||c){var f=yield this.sendRequest(l,u);return this.setListDynamicValueCollection(f.value,a),f}return this.loggingService.logInfo(v.a.dynamicListInvokeEvent,"fetchDynamicListValues.dynamicListInvokeEvent",G({connectionName:t,connectorName:e,parameters:r},this.getListDynamicValueAudit(a))),Object(s.toJS)(p)})),function(e,t,r,n,o,i){return Y.apply(this,arguments)})},{key:"getListDynamicValueFromStoreWithLatency",value:function(e){return new Promise(t=>{setTimeout(()=>{var r=this.getListDynamicValueFromStore(e);t(r)},1e3)})}},{key:"fetchDynamicSchema",value:(H=K((function*(e,t,r,n,a,l,u){var p=arguments.length>7&&void 0!==arguments[7]&&arguments[7],f=l?"flows/".concat(this.flowName,"/apis/").concat(e,"/connections/").concat(t,"/listDynamicProperties"):"apis/".concat(e,"/connections/").concat(t,"/listDynamicProperties"),d=Object(o.a)(r)?void 0:r,m={parameters:n,contextParameterAlias:d,dynamicInvocationDefinition:a.extension,location:a.isInput?c.a.Input:c.a.Output},b=yield this.getDynamicSchemaValueFromListDynamicPropertiesStoreWithLatency(u);if(!Object(g.a)()||Object(i.a)(b)||p){var y=yield this.sendRequest(f,m);return this.setListDynamicSchemaCollection(y,u),y}return this.loggingService.logInfo(v.a.dynamicPropertiesInvokeEvent,"fetchDynamicSchema.dynamicPropertiesInvokeEvent",G({connectionName:t,connectorName:e,contextParameterAlias:r,dynamicState:a},this.getListDynamicSchemaAudit(u))),Object(s.toJS)(b)})),function(e,t,r,n,o,i,a){return H.apply(this,arguments)})},{key:"getDynamicSchemaValueFromListDynamicPropertiesStoreWithLatency",value:function(e){return new Promise(t=>{setTimeout(()=>{var r=this.getDynamicSchemaValueFromListDynamicPropertiesStore(e);t(r)},1e3)})}},{key:"sendRequest",value:(W=K((function*(e,t){var r=this,o=Object(h.b)(),i=Object(x.a)("{0}/environments/{1}/{2}?api-version={3}",Object(S.f)(o),this.environmentStore.currentEnvironmentName,e,o.processSimpleResourceProviderApiVersionWithEnvironments);if(Object(L.a)()){var a=this.powerPlatformApiDiscovery.getEnvironmentEndpoint(this.environmentStore.currentEnvironmentName);i="https://".concat(a,"/").concat(U.a.powerAutomate,"/").concat(e,"?api-version=").concat(B.a)}var c=yield this.tokenService.getAccessToken(o.authResource);try{return yield Object(E.a)({method:"POST",url:i,data:JSON.stringify(t),headers:{Authorization:"Bearer ".concat(c),"Content-Type":"application/json"}},this.loggingService)}catch(l){var s;return yield Object(n.b)(Object(h.b)().flowAudience,null==l||null===(s=l.data)||void 0===s?void 0:s.status,l,K((function*(){return yield r.sendRequest(e,t)})))}})),function(e,t){return W.apply(this,arguments)})},{key:"transformTreeItems",value:function(e,t){return e.map(e=>{var r={selectionState:e.selectionState,dynamicExtension:t.dynamicExtension};return{displayName:e.displayName,value:e.value,fullyQualifiedDisplayName:e.fullyQualifiedDisplayName,isParent:Object(R.a)(e.nodeType,a.a.Parent),dynamicState:r}})}},{key:"shouldUseFlowCredentials",value:function(e){if(!this.allowCoauthoring)return!1;if(!this.prefetchedConnections)return!1;var t=this.prefetchedConnections.find(t=>t.id===e);if(!t&&this.isXrmConnectionReferenceMode){var r=this.getXrmLogicalNameFromConnectionId(e);r&&(t=this.prefetchedConnections.find(e=>e.id===r)),t&&this.loggingService.logInfo("connectorV2Service.shouldUseFlowCredentials","Found prefetched connection with id that matches XRM logical name",{connectionId:e,prefetchedConnectionId:t.id,xrmLogicalName:r})}if(!t||!t.properties||!t.properties.createdBy)return!1;if(this.isCurrentUserNotConnectionCreator(t.properties.createdBy.id)&&!Object(i.a)(this.flowStore)&&!Object(i.a)(this.flowName)){var n=this.flowStore.flows.getEntity(this.flowName);return Object(C.j)(t.name,n,this.isXrmConnectionReferenceMode)}return!1}},{key:"isCurrentUserNotConnectionCreator",value:function(e){var t=this.getSessionUser();return e!==t.uniqueId&&e!==t.puid}},{key:"getConnectionIdFromDesignerConnectionId",value:function(e){var t=this.getConnectionIdFromXrmLogicalName(e);return t||e}},{key:"getConnectionIdFromXrmLogicalName",value:function(e){if(!Object(i.a)(e)&&this.isXrmConnectionReferenceMode)return this.designerConnectionStore.getConnectionIdFromDesignerConnectionId(e)}},{key:"getXrmLogicalNameFromConnectionId",value:function(e){if(!Object(i.a)(e)&&this.isXrmConnectionReferenceMode)return this.designerConnectionStore.getDesignerConnectionIdFromConnectionId(e)}},{key:"auditDynamicListValueRequest",value:function(e){try{if(Object(g.b)()){var t,r,n,o=w.a.getCollectionType(e),i=null===(t=this.dynamicListStore.dynamicValuesList.collections)||void 0===t?void 0:t.size,a=this.dynamicListStore.dynamicValuesList.getCollection(o),c=(null==a||null===(r=a.list)||void 0===r?void 0:r.length)||0,s=null==a?void 0:a.lastFetched,u=this.dynamicListStore.dynamicValuesListAudit.get(e);u&&!Object(l.d)(s)?this.dynamicListStore.setDynamicValuesListAudit(e,{totalNumberOfRequest:(null==u?void 0:u.totalNumberOfRequest)+1,totalNumberOfRequestMissedFromStore:0===c?(null==u?void 0:u.totalNumberOfRequestMissedFromStore)+1:null==u?void 0:u.totalNumberOfRequestMissedFromStore,totalNumberOfRequestServedFromStore:c>0?(null==u?void 0:u.totalNumberOfRequestServedFromStore)+1:null==u?void 0:u.totalNumberOfRequestServedFromStore,totalNumberOfEntitiesInCollection:null==a||null===(n=a.list)||void 0===n?void 0:n.length,totalNumberOfCollection:i,lastFetched:s}):this.dynamicListStore.setDynamicValuesListAudit(e,new p.a(1,0,1,0,0,void 0))}}catch(f){this.loggingService.logError("auditDynamicListValueRequest",f)}}},{key:"auditDynamicSchemaValueRequest",value:function(e){try{if(Object(g.a)()){var t,r,n,o=w.a.getCollectionType(e),i=null===(t=this.dynamicListStore.dynamicSchemaList.collections)||void 0===t?void 0:t.size,a=this.dynamicListStore.dynamicSchemaList.getCollection(o),c=(null==a||null===(r=a.list)||void 0===r?void 0:r.length)||0,s=null==a?void 0:a.lastFetched,u=this.dynamicListStore.dynamicSchemaListAudit.get(e);u&&!Object(l.d)(s)?this.dynamicListStore.setDynamicSchemaListAudit(e,{totalNumberOfRequest:(null==u?void 0:u.totalNumberOfRequest)+1,totalNumberOfRequestMissedFromStore:0===c?(null==u?void 0:u.totalNumberOfRequestMissedFromStore)+1:null==u?void 0:u.totalNumberOfRequestMissedFromStore,totalNumberOfRequestServedFromStore:c>0?(null==u?void 0:u.totalNumberOfRequestServedFromStore)+1:null==u?void 0:u.totalNumberOfRequestServedFromStore,totalNumberOfEntitiesInCollection:null==a||null===(n=a.list)||void 0===n?void 0:n.length,totalNumberOfCollection:i,lastFetched:s}):this.dynamicListStore.setDynamicSchemaListAudit(e,new p.a(1,0,1,0,0,void 0))}}catch(f){this.loggingService.logError("auditDynamicSchemaValueRequest",f)}}},{key:"setListDynamicValueCollection",value:function(e,t){try{if(Object(g.b)()){var r=e.map(e=>new p.c(e.displayName,e.description,e.disabled,e.value)),n=w.a.getCollectionType(t),o=this.dynamicListStore.dynamicValuesList.getCollection(n),i=null==o?void 0:o.lastFetched,a=Object(h.b)();Object(l.d)(i)&&(null==r?void 0:r.length)<=a.maxNumberOfEntitiesForDynamicStoreCollection&&(this.dynamicListStore.dynamicValuesList.setCollectionLoading(n),this.loggingService.logInfo(v.a.dynamicListInvokeEvent,"setListDynamicValueCollection.dynamicListInvokeEvent",{collectionLength:null==o?void 0:o.length}),this.dynamicListStore.dynamicValuesList.setCollectionLoaded(n,r,{resetList:!0,replaceDupe:()=>!0}))}}catch(c){this.loggingService.logError("setListDynamicValueCollection",c)}}},{key:"setListDynamicSchemaCollection",value:function(e,t){try{if(Object(g.a)()){var r=new p.b(e,t),n=w.a.getCollectionType(t),o=this.dynamicListStore.dynamicSchemaList.getCollection(n),i=null==o?void 0:o.lastFetched,a=Object(h.b)(),c=[];c.push(r),Object(l.d)(i)&&(null==c?void 0:c.length)<=a.maxNumberOfEntitiesForDynamicStoreCollection&&(this.dynamicListStore.dynamicSchemaList.setCollectionLoading(n),this.loggingService.logInfo(v.a.dynamicListInvokeEvent,"setListDynamicSchemaCollection.dynamicListInvokeEvent",{collectionLength:null==o?void 0:o.length}),this.dynamicListStore.dynamicSchemaList.setCollectionLoaded(n,c,{resetList:!0,replaceDupe:()=>!0}))}}catch(s){this.loggingService.logError("setListDynamicSchemaCollection",s)}}},{key:"getListDynamicValueFromStore",value:function(e){try{var t=w.a.getCollectionType(e),r=this.dynamicListStore.dynamicValuesList.getCollection(t);if(Object(g.b)()&&!Object(l.d)(null==r?void 0:r.lastFetched)){var n,o=[];null==r||null===(n=r.list)||void 0===n||n.forEach(e=>{var t=this.dynamicListStore.dynamicValuesList.getEntity(e);t&&o.push({value:null==t?void 0:t.value,displayName:null==t?void 0:t.displayName,description:null==t?void 0:t.description,disabled:null==t?void 0:t.disabled})});var i={value:Object(s.toJS)(o)};return Object(s.toJS)(i)}}catch(a){this.loggingService.logError("getListDynamicValue",a)}}},{key:"getDynamicSchemaValueFromListDynamicPropertiesStore",value:function(e){try{var t=w.a.getCollectionType(e),r=this.dynamicListStore.dynamicSchemaList.getCollection(t);if(Object(g.a)()&&!Object(l.d)(null==r?void 0:r.lastFetched)){var n,o=[];return null==r||null===(n=r.list)||void 0===n||n.forEach(e=>{var t=this.dynamicListStore.dynamicSchemaList.getEntity(e);t&&o.push(t.schema)}),Object(s.toJS)(o[0])}}catch(i){this.loggingService.logError("getListDynamicSchema",i)}}},{key:"getListDynamicValueAudit",value:function(e){try{if(Object(g.b)())return this.dynamicListStore.dynamicValuesListAudit.get(e)}catch(t){this.loggingService.logError("getListDynamicValueAudit",t)}}},{key:"getListDynamicSchemaAudit",value:function(e){try{if(Object(g.a)())return this.dynamicListStore.dynamicSchemaListAudit.get(e)}catch(t){this.loggingService.logError("getListDynamicSchemaAudit",t)}}}])&&q(t.prototype,r),z&&q(t,z),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20792:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c}));var n=r(12333),o=r(19175),i=n.a.object({dynamicExtension:o.c,schemaAlias:n.a.string().optional()}),a=n.a.object({dynamicState:i,selectionState:n.a.unknown().optional()}),c=(i.extend({selectionState:n.a.unknown().optional()}),function(e){return e.Parent="parent",e.Leaf="leaf",e}({}))},20793:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.Input="input",e.Output="output",e}({})},20794:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return u}));var n=r(11773);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function i(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i((function e(t,r){c(this,e),this.schema=void 0,this.schemaKey=void 0,Object(n.extendObservable)(this,{schema:t,schemaKey:r})})),l=i((function e(t,r,o,i){c(this,e),this.value=void 0,this.displayName=void 0,this.description=void 0,this.disabled=void 0,Object(n.extendObservable)(this,{displayName:t,description:r,disabled:o,value:i})})),u=i((function e(t,r,o,i,a,s){c(this,e),this.totalNumberOfRequest=void 0,this.totalNumberOfRequestServedFromStore=void 0,this.totalNumberOfRequestMissedFromStore=void 0,this.totalNumberOfEntitiesInCollection=void 0,this.totalNumberOfCollection=void 0,this.lastFetched=void 0,Object(n.extendObservable)(this,{totalNumberOfRequest:t,totalNumberOfRequestServedFromStore:r,totalNumberOfRequestMissedFromStore:o,totalNumberOfEntitiesInCollection:i,totalNumberOfCollection:a,lastFetched:s})}))},20795:function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return u}));var n=r(19923),o=r(14837),i=r(11891),a=r(20796),c="workflowReferenceName";function s(e){return Object(i.a)(e,"workflowInputs")}function l(e){return Object(i.a)(e,"workflowOutputs")}function u(e,t){return{properties:{summary:e.ChildFlows.Operation.Summary,description:e.ChildFlows.Operation.Description,api:{id:n.g.FLOWS,displayName:e.ChildFlows.Connector.DisplayName,iconUri:Object(n.k)(t).childFlows,brandColor:n.b.childFlows,tier:"NotSpecified"},inputsDefinition:{type:"object",properties:{host:{type:"object",properties:{workflowReferenceName:{type:"string",title:e.ChildFlows.Operation.Flow.Title,description:e.ChildFlows.Operation.Flow.Description,minLength:1,[a.a.DynamicList]:{dynamicState:{itemTitlePath:"DisplayName",itemValuePath:"Name",itemsPath:"value",operationId:n.h.CHILDFLOW},itemValuePath:"Name"},[a.a.Alias]:c}},[a.a.Alias]:"host",required:[c]},body:{type:"object",[a.a.DynamicProperties]:{itemValuePath:"schema",operationId:"workflowInputs",parameters:{workflowReferenceName:{parameterReference:c,required:!0}}}}},required:["host","body"]},responsesDefinition:{200:{type:"object",properties:{Body:{type:"object",[a.a.DynamicProperties]:{itemValuePath:"schema",operationId:"workflowOutputs",parameters:{workflowReferenceName:{parameterReference:c,required:!0}}}}}}},operationType:o.a.Workflow,inputsLocation:["inputs"]}}}},20796:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={Alias:"x-ms-property-name-alias",DynamicList:"x-ms-dynamic-list",DynamicTree:"x-ms-dynamic-tree",DynamicProperties:"x-ms-dynamic-properties"}},20797:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(11808),o=()=>!!Object(n.a)().dynamicListStore.getConfig().isDynamicListStoreListEnumEnabled,i=()=>!!Object(n.a)().dynamicListStore.getConfig().isDynamicListStoreListDynamicPropertiesEnabled},20798:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,o,i,a,c,s,l,u=r(11773),p=r(12348),f=r(13005);function d(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var v=(o=y((n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"dynamicValuesList",o,this),d(this,"dynamicValuesListAudit",i,this),d(this,"dynamicSchemaList",a,this),d(this,"dynamicSchemaListAudit",c,this),d(this,"setDynamicValuesListAudit",s,this),d(this,"setDynamicSchemaListAudit",l,this),Object(u.runInAction)(()=>{this.dynamicValuesList=new p.a({getKey:e=>"".concat(Object(f.a)("".concat(e.value)))}),this.dynamicSchemaList=new p.a({getKey:e=>"".concat(Object(f.a)("".concat(e.schemaKey)))}),this.dynamicValuesListAudit=new Map,this.dynamicSchemaListAudit=new Map})}var t,r,n;return t=e,n=[{key:"getCollectionType",value:function(e){return"".concat(e)}}],(r=null)&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"dynamicValuesList",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=y(n.prototype,"dynamicValuesListAudit",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=y(n.prototype,"dynamicSchemaList",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=y(n.prototype,"dynamicSchemaListAudit",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=y(n.prototype,"setDynamicValuesListAudit",[u.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.dynamicValuesListAudit.set(e,t)}}}),l=y(n.prototype,"setDynamicSchemaListAudit",[u.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.dynamicSchemaListAudit.set(e,t)}}}),n)},20799:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var i=2,a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graphService=t,this.loggingService=r}var t,r,o;return t=e,(r=[{key:"getUsers",value:function(e){return(e=(e||"").trim()).length<=i?Promise.resolve([]):this.graphService.queryUsers({searchText:e}).then(e=>e.map(e=>({id:e.id,displayName:e.displayName,mail:e.mail,key:e.mail}))).catch(e=>(this.loggingService.logWarning("DesignerAzureADServiceV2.getUsers",e),[]))}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20800:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return u}));var n=r(13009),o=r(13192),i=r(13051),a=r(14694),c=r(11795),s=r(14689),l=e=>{var t=[e,...Object(n.j)(e)];for(var r of t){if(Object(n.N)(r)||Object(o.isHttpClientError)(r)||Object(n.U)(r))return n.e.Warning;var a=Object(i.h)(r,{data:Object(i.j)(i.k,i.m)})?r.data:void 0;if(a&&Object(i.f)(a.status)&&Object(o.isHttp4xxStatusCode)(a.status))return n.e.Warning}return Object(n.y)(e)},u=()=>{var{region:e}=Object(c.h)();return s.c.get(a.b[e])}},20801:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(13051),o=e=>Object(n.h)(e,{extension:Object(n.l)(i),isInput:Object(n.l)(n.m),schemaAlias:Object(n.l)(n.k)}),i=e=>Object(n.h)(e,{operationId:Object(n.l)(n.k),parameters:Object(n.l)(Object(n.j)(n.k,a)),itemValuePath:Object(n.l)(n.k)}),a=e=>Object(n.h)(e,{parameterReference:Object(n.l)(n.k),value:Object(n.l)(n.m),required:Object(n.l)(n.c)})},20802:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11809),o=r(11896),i=Object(o.a)({teamName:n.a.PowerAutomateClientTeam,owners:["bjustice"],description:"Enables child flow mcs filtering",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1559604",createdOn:"02/27/2025",fallback:{isChildFlowMcsFilterEnabled:!1}}),{getFeatureValue:a}=Object(o.b)(i,"isChildFlowMcsFilterEnabled")},20814:function(e,t,r){"use strict";r.d(t,"b",(function(){return B})),r.d(t,"a",(function(){return V}));var n,o,i,a,c,s=r(11766),l=r(12328),u=r.n(l),p=r(11773),f=r(14337),d=r(12706),m=r(12811),b=r(20815),y=r(20816),v=r(12339),h=r(13241),g=r(14867),O=r(20106),w=r(13009),E=r(18951),C=r(20107),S=r(13275),P=r(19997),j=r(20808),T=r(20791);function k(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M(n.key),n)}}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function N(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=I(e);if(t){var o=I(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _(this,r)}}function _(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return D(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e,t,r){return(t=M(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var B=function(e){return e[e.Normal=0]="Normal",e[e.Compact=1]="Compact",e}({});function U(e){return Object.values(e||{}).map(e=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({properties:{}},e.api||e.apiDefinition||e))}var V=Object(f.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(l,e);var t,r,n,o=N(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).designerConnectionWizardHostRef=s.createRef(),t.designerScriptDownloadPromise=void 0,t.designerScripts=void 0,t.designerOnConnectionsChangeSubscription=void 0,t.designerConnectionWizard=void 0,t.previousConnectionWizardConnectionReferences=void 0,t.hasDesignerInitializationBegun=void 0,t.loadDesignerStylesManually=void 0,k(t,"connectionWizardInitialized",i,D(t)),k(t,"failedToLoad",a,D(t)),k(t,"hasConnectionWizardBeenRendered",c,D(t)),t.isXrmConnectionReferenceModeResult=void 0,t.getClassNames=Object(d.a)(),t.handleConnectionReferencesConfirmed=e=>{t.props.onConnectionReferencesConfirmed(Object(g.j)(e))},t.handleConnectionsChanged=()=>{var{designerCreateContext:{loggingService:e},onConnectionsUpdatedByDesigner:r}=t.props,n=t.getConnectionsFromDesignerConnectionStore(),o=Object(O.a)({previousConnections:t.previousConnectionWizardConnectionReferences,currentConnections:n});0!==o.length&&(e.logInfo("ConnectionWizard.handleConnectionsChanged","Detected change in the designer connection store"),t.previousConnectionWizardConnectionReferences=n,r(o))},t.initializeDesignerConnectionWizard=()=>{var{appSettings:e,designerCreateContext:{loggingService:r},connectionReferences:n,xrmConnectionReferenceService:o,onError:i,shouldSkipMergeConnectionsLogic:a}=t.props;t.hasDesignerInitializationBegun=!0,t.designerScriptDownloadPromise.then(e=>(t.designerScripts=e,t.isXrmConnectionReferenceMode(a))).then(e=>(t.setFailedToLoad(!1),t.designerConnectionWizard&&t.designerConnectionWizard.dispose(),t.isXrmConnectionReferenceModeResult=e,t.isXrmConnectionReferenceModeResult?o.getXrmConnectionReferences({forceRefresh:!0}):Promise.resolve())).then(()=>{var r=t.getConnections(t.isXrmConnectionReferenceModeResult),o=t.createDesignerConfig({connections:r});return u()(o,"designerConfig is falsy"),t.designerConnectionWizard=Object(C.b)(o,{}),t.designerConnectionWizard.initializeConnectionReferences(n||{},Object(v.l)(e).definitionSchemaUri)}).then(()=>{t.setConnectionWizardInitialized(!0),t.designerConnectionWizard.render(t.handleConnectionReferencesConfirmed),t.previousConnectionWizardConnectionReferences=t.getConnectionsFromDesignerConnectionStore(),t.subscribeToDesignerConnectionChanges()}).catch(e=>{i(e,"initializeDesignerConnectionWizard_connectionWizard.tsx"),t.setFailedToLoad(!0),r.logError("ConnectionWizard.initializeDesignerConnectionWizard",e)})},t.downloadDesignerScripts=()=>{var{designerCreateContext:{loadDesignerScripts:e}}=t.props;return e()},t.createDesignerConfig=e=>{var{connections:r}=e;if(t.designerScripts){var{appSettings:n,featureFlags:o,oAuthService:i,ppapiService:a,telemetryService:c,designerCreateContext:s,connectionReferences:l,connectionWizardSize:u,registerConnectionConfirmationCallback:p,registerTestConnectionCallback:f,skipTestConnection:d,showConnectionDisplayName:m,hideSwitchConnectionLink:b,dynamicListStore:y}=t.props;return{appSettings:n,featureFlags:o,context:s,designercore:t.designerScripts.designercore,designerElement:t.designerConnectionWizardHostRef.current,environment:{name:s.environmentStore.currentEnvironmentName,features:s.environmentStore.environmentClaim.features},connectorV2ServiceFactory:()=>new T.a(!1,s.clientResources,null,s.loggingService,r,s.graphService,null,s.environmentStore,s.tokenService,s.designerConnectionStore,y,null,()=>s.sessionStore.user,t.isXrmConnectionReferenceModeResult),getArmAccessToken:()=>s.tokenService.getAccessToken(n.authResource),getFunctionsRPAccessToken:()=>s.tokenService.getAccessToken(n.functionsAuthResource),getRuntimeAccessToken:()=>s.tokenService.getAccessToken(n.apiHubsRuntimeResource),getConsentServerAccessToken:()=>s.tokenService.getAccessToken(n.consentServerAadResourceUri),getPPAPIAccessToken:()=>s.tokenService.getAccessToken(a.getTokenAudience()),oAuthService:i,ppapiService:a,prefetchedData:{connections:r,connectionProviders:U(l)},telemetryService:c,connectionWizardUIConfig:{defaultAccountDisplayName:s.sessionStore.user.displayName,displayConnectionReferenceNamesAsConnector:!0,forceNarrowWidth:u===B.Compact,hideConnectionWizardHeader:!0,onConnectionWizardStateChange:t.onConnectionWizardStateChange,hideConnectionDisplayName:!m,hideContinueButton:!0,registerConnectionConfirmationCallback:p,enableFabricStyle:!0,skipTestConnection:d,registerTestConnectionCallback:f,hideSwitchConnectionLink:b},showViewPermissionsDialog:t.handleShowPermissionsDialog,onFirstPartyConnectionFailureCallback:t.handleFirstPartyConnectionFailure,canAddOperation:void 0,visibleHideKeys:void 0,isXrmConnectionReferenceMode:t.isXrmConnectionReferenceModeResult}}},t.onConnectionWizardStateChange=e=>{var{onConnectionWizardStateChange:r}=t.props;r&&r(e),t.setHasConnectionWizardBeenRendered(!0)},t.handleShowPermissionsDialog=e=>{var r={apiDefinition:e,iconUri:e.properties.iconUri,brandColor:e.properties.iconBrandColor,displayName:e.properties.displayName};Object(E.a)(t.props.designerCreateContext.surfaceStore,r,t.props.designerCreateContext.clientResources,t.props.designerCreateContext.cdnService)},t.handleFirstPartyConnectionFailure=(e,r)=>Object(w.S)(e)?t.props.oAuthService.consentFirstPartyUriAfterMFA(r):Promise.reject(new w.a(w.c.ConnectionWizardFirstPartyConnectionFailure,e)),t.hasConnectionReferences=()=>Object.keys(t.props.connectionReferences||{}).length>0,t.designerScriptDownloadPromise=t.downloadDesignerScripts(),t.loadDesignerStylesManually=e.loadDesignerStylesManually||!1,t}return t=l,(r=[{key:"validateConnectionReferencesAndInitializeDesigner",value:function(){var{designerCreateContext:{clientResources:e,loggingService:t},onError:r}=this.props;if(this.hasConnectionReferences())this.initializeDesignerConnectionWizard();else{var n=new w.a(w.c.ConnectionWizardEmptyConnectionReferences,e.ConnectionWizard.Empty.ConnectionReferences);t.logError("ConnectionWizard.validateConnectionReferencesAndInitializeDesigner",n),r(n,"validateConnectionReferencesAndInitializeDesigner_connectionWizard.tsx"),this.setFailedToLoad(!0)}}},{key:"componentDidMount",value:function(){var{connectionsReady:e,designerCreateContext:{loggingService:t}}=this.props;e?this.validateConnectionReferencesAndInitializeDesigner():t.logInfo("ConnectionWizard.componentDidMount","Connections not ready.")}},{key:"render",value:function(){if(this.failedToLoad)return null;var{hideUntilConnectionWizardLoaded:e}=this.props,t=!this.connectionWizardInitialized||e&&!this.hasConnectionWizardBeenRendered?this.renderConnectionListLoading():null,r=Object(m.a)({"fl-ConnectionWizard":!0,[Object(b.a)(this.hasConnectionWizardBeenRendered).connectionWizardRoot]:!0,[Object(y.a)().connectionWizardDesignerRoot]:this.loadDesignerStylesManually},this.getClassNames(b.b).root);return s.createElement(s.Fragment,null,t,s.createElement("div",{className:r,ref:this.designerConnectionWizardHostRef}))}},{key:"renderConnectionListLoading",value:function(){var{designerCreateContext:{clientResources:e},onRenderLoading:t}=this.props;return t?t():s.createElement(S.a,{horizontalAlign:"center",verticalAlign:"center",verticalFill:!0,grow:!0},s.createElement(h.a,{size:h.b.large,ariaLabel:e.ConnectionWizard.Spinner.AriaLabel}))}},{key:"componentDidUpdate",value:function(e){var{connectionsReady:t}=this.props;!this.hasDesignerInitializationBegun&&t&&this.validateConnectionReferencesAndInitializeDesigner()}},{key:"componentWillUnmount",value:function(){this.designerOnConnectionsChangeSubscription&&this.designerOnConnectionsChangeSubscription.unsubscribe(),this.designerConnectionWizard&&this.designerConnectionWizard.dispose()}},{key:"setConnectionWizardInitialized",value:function(e){this.connectionWizardInitialized=e}},{key:"setFailedToLoad",value:function(e){this.failedToLoad=e}},{key:"setHasConnectionWizardBeenRendered",value:function(e){this.hasConnectionWizardBeenRendered=e}},{key:"isXrmConnectionReferenceMode",value:function(e){var t,r,n,o,i,a,{designerCreateContext:{loggingService:c,environmentStore:s,widgetUtilService:l,sessionStore:u,environmentCapabilityService:p},featureFlags:f,solutionId:d}=this.props;return Object(P.d)(c,!(null===(t=s.currentEnvironment)||void 0===t||!t.hasXrmInstance),l,!(null===(r=u.user)||void 0===r||!r.isConsumerDomain),s.currentEnvironmentName,p,null!==(n=null===(o=u.user)||void 0===o?void 0:o.tenantId)&&void 0!==n?n:"",null!==(i=null===(a=s.currentEnvironment)||void 0===a?void 0:a.xrmInstanceVersion)&&void 0!==i?i:"",!1).then(t=>!(e||t!==P.a.ShouldDefault&&!d||!f.enableXRMConnectionReferenceModeForFlowCreateWidget))}},{key:"xrmConnectionReferences",get:function(){var e,{designerCreateContext:{loggingService:t},xrmConnectionReferenceStore:r}=this.props,n=null===(e=this.xrmConnectionReferenceCollection)||void 0===e?void 0:e.list,o=r.xrmConnectionReferences;return n&&o?n.map(e=>{var t;return null===(t=o.getEntity(e))||void 0===t?void 0:t.toJS()}).filter(e=>!!e):(t.logInfo("ConnectionWizard.xrmConnectionReferences","xrmConnectionReferences is undefined. Returning empty list as fallback."),[])}},{key:"xrmConnectionReferenceCollection",get:function(){var{designerCreateContext:{environmentStore:e},xrmConnectionReferenceStore:t}=this.props;return t.xrmConnectionReferences.getCollection(j.a.getCollectionType({environmentName:e.currentEnvironmentName}))}},{key:"getConnections",value:function(e){var{designerCreateContext:{loggingService:t,designerConnectionStore:r,clientResources:n},availableConnections:o}=this.props;if(!o)return[];if(!e)return o;t.logInfo("ConnectionWizard.getConnections","isXrmConnecionReferenceMode is true. Merging xrmConnectionReferences and availableConnections.");var i=this.xrmConnectionReferences;if(!i||i.length<1)return[];var a=Object(P.c)(o,i,r,n);return t.logInfo("ConnectionWizard.getConnections","Processed/merged connections with xrmConnections.",{startingConnectionCount:o.length,xrmConnectionReferencesCount:i.length,mergedConnectionsCount:a.length}),a}},{key:"isXrmConnectionReferencesModeResult",get:function(){return this.isXrmConnectionReferenceModeResult}},{key:"subscribeToDesignerConnectionChanges",value:function(){this.designerConnectionWizard&&this.designerConnectionWizard.Data&&this.designerConnectionWizard.Data.Connections&&this.designerConnectionWizard.Data.Connections.onChanged||this.props.designerCreateContext.loggingService.logError("ConnectionWizard.subscribeToDesignerConnectionChanges",new w.a(w.c.DesignerConnectionWizardRegression,"this.designerConnectionWizard.Data.Connections.onChanged does not exist")),this.designerOnConnectionsChangeSubscription=this.designerConnectionWizard.Data.Connections.onChanged(this.handleConnectionsChanged)}},{key:"getConnectionsFromDesignerConnectionStore",value:function(){return this.designerConnectionWizard&&this.designerConnectionWizard.Data&&this.designerConnectionWizard.Data.Connections&&this.designerConnectionWizard.Data.Connections.getData?(this.designerConnectionWizard.Data.Connections.getData()||[]).slice():(this.props.designerCreateContext.loggingService.logError("ConnectionWizard.getConnectionsFromDesignerConnectionStore",new w.a(w.c.DesignerConnectionWizardRegression,"this.designerConnectionWizard.Data.Connections.getData does not exist")),[])}}])&&R(t.prototype,r),n&&R(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(s.Component),i=A(o.prototype,"connectionWizardInitialized",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=A(o.prototype,"failedToLoad",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=A(o.prototype,"hasConnectionWizardBeenRendered",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A(o.prototype,"setConnectionWizardInitialized",[p.action],Object.getOwnPropertyDescriptor(o.prototype,"setConnectionWizardInitialized"),o.prototype),A(o.prototype,"setFailedToLoad",[p.action],Object.getOwnPropertyDescriptor(o.prototype,"setFailedToLoad"),o.prototype),A(o.prototype,"setHasConnectionWizardBeenRendered",[p.action],Object.getOwnPropertyDescriptor(o.prototype,"setHasConnectionWizardBeenRendered"),o.prototype),n=o))||n},20815:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(12754),o=e=>Object(n.db)({connectionWizardRoot:{visibility:e?"visible":"hidden",opacity:e?1:0,transition:"visibility 0s, opacity 0.25s linear"}}),i=()=>{var e=Object(n.Y)().palette;return{root:["msla-host-processsimple, msla-host-flow-template",{background:"transparent",'input[type="search"]':{boxSizing:"border-box"},"*":{boxSizing:"border-box"},"*::before":{boxSizing:"border-box"},"*::after":{boxSizing:"border-box"},paddingBottom:"10px","input[type=text]":{height:"44px","&.ms-TextField-field":{height:"100%"}},".msla-copy-input-control":{"input[type=text]":{height:"32px"}},"input[type=checkbox]":{"-webkit-appearance":"checkbox",margin:"3px 3px 3px 4px"},label:{margin:"inherit",padding:"inherit"},"table td":{height:"inherit",":hover":{backgroundColor:"inherit",cursor:"inherit"}},"table tbody tr":{height:"inherit",borderBotton:"inherit"},".msla-card-button-primary":{backgroundColor:e.themePrimary,":hover":{backgroundColor:"#005FCB",borderColor:"rgba(0, 0, 0, 0.4)"},":disabled":{color:"rgba(0, 0, 0, .2)",backgroundColor:"rgba(0, 0, 0, .2)",borderColor:"rgba(0, 0, 0, .2)"}},".msla-card-description-icon-button":{height:"90%",width:"44px",verticalAlign:"top",padding:"5px 0",display:"inline-block"},".msla-card-children":{width:"100%"},".msla-card-selected":{boxShadow:"0 0 10px #acacac"},".msla-actionpalette-menu-triangle":{borderBottom:"7px solid "+e.themePrimary,marginRight:"calc(~'(50% + 60px)')"},".msla-actionpalette-menu":{backgroundColor:e.themePrimary,boxShadow:"0 3px 3px "+e.neutralTertiaryAlt,"-webkit-border-radius":0,"-moz-border-radius":0,borderRadius:0,".msla-action-button":{img:{margin:"5px 0 0 0"}},".msla-actionpalette-expanded-menu":{width:"215px",right:"-135px"}},".msla-action-palette-list":{".msla-actionpalette-expanded-menu":{width:"205px",right:"-66px"},".msla-action-button":{padding:"10px 0"}},".msla-condition-branch-header":{".msla-condition-branch-add":{color:e.themePrimary}},".msla-action-button-text":{paddingTop:0},".msla-actionpalette":{margin:0,".buttons-row .msla-action-buttons":{color:e.neutralPrimary},".msla-action-button":{".msla-actionmenu-toggle":{padding:0}}},".msla-connection-link":{".msla-selector":{"div.msla-selector-list-item":{".msla-selector-icon":{margin:"0 7px"}}}},".msla-connection-container":{boxSizing:"content-box"},".msla-connection-selector-options":{".msla-connection-create-button":{backgroundColor:e.themePrimary,borderColor:e.themePrimary},".msla-connection-switch-link":{color:e.themePrimary,borderColor:e.themePrimary},".msla-selector":{margin:"0px 0px 0px 5px"}},".msla-connection-selector":{".msla-connection-switch-link":{":focus":{outline:e.themePrimary+" auto 5px"}}},".msla-connection-view-permissions-link":{color:e.themePrimary,borderColor:e.themePrimary},".msla-connection-container-footer":{".msla-button":{backgroundColor:e.themePrimary,borderColor:e.themePrimary},"button[disabled]":{color:"rgba(0, 0, 0, .2)",backgroundColor:"rgba(0, 0, 0, .2)",borderColor:"rgba(0, 0, 0, .2)"}},".msla-card-config-button-container":{button:{backgroundColor:e.themePrimary,borderColor:e.themePrimary,color:e.white},"button:focus":{border:"1px dashed "+e.white},"button[disabled]":{color:"rgba(0, 0, 0, .2)",backgroundColor:"rgba(0, 0, 0, .2)",borderColor:"rgba(0, 0, 0, .2)"}},".msla-card-config-item":{".msla-label":{padding:0},label:{margin:"2px",width:"100%"},".msla-checkbox-label":{minHeight:"18px",label:{verticalAlign:"middle"}},".msla-checkbox-description-icon-button":{verticalAlign:"middle"},margin:"10px 8px","@media only screen and (max-width: 1161px)":{display:"block",label:{width:"auto"}},".msla-checkbox":{width:"100%"},".msla-combobox-container":{width:"100%"},".msla-dropdown-container":{width:"100%"},".msla-textbox":{width:"100%"},".ms-Stack":{width:"100%"}},".msla-input-parameter-label":{textTransform:"none",".msla-label":{padding:0},"&.msla-label-with-tooltip":{display:"flex",".msla-label-tooltip":{marginLeft:"5px",cursor:"default"}}},".public-DraftEditorPlaceholder-root":{paddingLeft:"0px"},".msla-picker-header":{".msla-picker-title":{".msla-title-segment":{".msla-segment":{".msla-text-navigation":{color:e.themePrimary}}}}},".msla-parameter-picker-button":{width:"43px",height:"39px"},".msla-picker-items":{".msla-item-selected":{backgroundColor:e.themePrimary},".msla-folder":{":hover":{backgroundColor:"transparent"},".msla-selection-section":{":hover":{backgroundColor:"rgba(0, 119, 255, 0.1)"}},".msla-navigate-button":{":hover":{backgroundColor:"rgba(0, 119, 255, 0.1)"}}},".msla-file":{":hover":{backgroundColor:"rgba(0, 119, 255, 0.1)"}}},".msla-picker-command-bar":{".msla-confirm":{backgroundColor:e.themePrimary}},".msla-parameter-picker-input-box":{verticalAlign:"middle"},".msla-condition-branches":{".msla-parameter-picker-input-box":{width:"calc(~'(100% - 75px)')"},".msla-picker-items":{".msla-folder":{".msla-selection-section":{width:"calc(~'(100% - 62px)')"}}},".msla-picker-command-bar":{".msla-confirm":{padding:0},".msla-cancel":{padding:0}}},".msla-edit-parameters-values-text":{color:e.themePrimary},".msla-change-profile-link-text":{color:e.themePrimary},".msla-checkbox-label":{margin:0},".msla-if .msla-condition-expanded > div > div > .msla-card.msla-card-selected":{".msla-card-condition-parameters":{border:"none"}},".msla-if > div > div > div > .msla-card > .msla-card-body > .msla-card-condition-body > .msla-card-condition-branches":{background:"none"},".msla-recommendation-dropdown":{border:"1px solid #cac8c7"},".msla-recommendation-footer":{color:e.black,border:"1px solid #cac8c7",borderTop:"none"},".msla-card-condition-branch .msla-card-condition-parameters-body":{boxShadow:"0 0 10px #acacac"},".msla-card-condition-branch .msla-card-header":{boxShadow:"none",border:"none"},".msla-card-condition-branch .msla-if > div > div > div > .msla-card.msla-card-selected > .msla-card-header":{border:"none",boxShadow:"none"},".msla-comment-box":{borderTop:"solid 1px #d2d2d2",".msla-comment-icon":{img:{width:"22px",height:"22px"}}},".msla-information-box-container":{fontSize:"14px",fontFamily:'"Segoe WP", "Segoe UI", sans-serif'},".msla-html-editor":{".rdw-link-modal":{zIndex:1e3,label:{margin:0,padding:0}}},".msla-recurrence-parameters-container":{".msla-input-parameters-list":{display:"block",".msla-input-parameter-inline-item":{display:"inline-flex"}}},".msla-dynamic-added-param-inputs-container":{".msla-editor-input-control":{width:"100%"},".msla-input-control":{width:"100%"}},".msla-input-parameters-body .msla-token-recommendation-v2":{display:"flex",justifyContent:"flex-end"},".msla-html-codeview-editor":{".msla-input-parameter-error":{marginBottom:"-16px"},".msla-token-recommendation-v2":{marginBottom:"-20px"}},".msla-card-expression-builder":{".msla-input-parameter":{maxWidth:"690px"},".msla-input-parameter-label":{fontSize:"14px",fontWeight:"bold",marginBottom:"2px"},".msla-input-parameter-content-wrapper":{flexBasis:"100%"}},".widget & .msla-connection-container-body":{maxHeight:"none"}}]}}},20816:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)().palette;return Object(n.db)({connectionWizardDesignerRoot:{".msla-connection-container":{maxWidth:"600px",margin:"0 auto",textAlign:"left"},".msla-connection-container-body":{".ms-DetailsRow:hover":{backgroundColor:"unset"},".ms-DetailsRow-cell":{display:"flex",alignItems:"center",paddingLeft:0}},".msla-connection-controls":{marginLeft:"auto",display:"flex",alignItems:"center"},".msla-connection-selector-connector-container":{marginLeft:"16px",minWidth:0,overflow:"hidden"},".msla-connector-display-name":{fontSize:14,fontWeight:600,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",minWidth:0},".msla-connection-status-icon-container":{cursor:"default"},".msla-connection-status-icon-container:last-child":{paddingRight:"8px"},".msla-connection-status-icon":{fontSize:"16px",verticalAlign:"middle"},".msla-connection-status-icon--success":{color:"#107c10"},".msla-connection-status-icon--error":{color:"#d13438"},".msla-connection-switch-link":{fontSize:"16px",color:e.themePrimary,borderColor:e.themePrimary,marginLeft:"4px",i:{verticalAlign:"middle"}},".msla-connection-view-permissions-link":{fontSize:"10px",display:"block",border:"none",background:"transparent",padding:0,":hover":{textDecoration:"underline"}},".msla-connection-selector-icon":{width:"32px",height:"32px",minWidth:"32px",boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.15)",borderRadius:3},"body.dark":{".msla-connection-container-body":{'[class^="ms-List-cell"]':{backgroundColor:"#323130"}},".msla-connection-status-icon--success":{color:"#19c019"},".msla-connection-status-icon--error":{color:"#e4878a"}}}})}},20818:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,o,i=r(11766),a=r(11773),c=r(14337),s=r(11804),l=r(14978),u=r(20819);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var g=Object(c.c)((h((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(a,e);var t,r,n,o=b(a);function a(){return p(this,a),o.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){return i.createElement(l.a,{title:this.titleText,details:this.detailsText,required:!0})}},{key:"titleText",get:function(){var{clientResources:e,widgetUtilService:t,isUserTypeFlow:r}=this.props;return t.getOverrideableString(Object(u.a)()&&r?e.InvokeFlowForm.SigningInConnections.HeaderRunOnly:e.InvokeFlowForm.SigningInConnections.Header,s.b.CONNECTION_REMINDER_TITLE)}},{key:"detailsText",get:function(){var{clientResources:e,widgetUtilService:t,isUserTypeFlow:r}=this.props;return t.getOverrideableString(Object(u.a)()&&r?e.InvokeFlowForm.SigningInConnections.DescriptionRunOnly:e.InvokeFlowForm.SigningInConnections.Description,s.b.CONNECTION_REMINDER_DESCRIPTION)}}])&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.PureComponent)).prototype,"titleText",[a.computed],Object.getOwnPropertyDescriptor(o.prototype,"titleText"),o.prototype),h(o.prototype,"detailsText",[a.computed],Object.getOwnPropertyDescriptor(o.prototype,"detailsText"),o.prototype),n=o))||n},20819:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11896),o=r(11809),i=Object(n.a)({teamName:o.a.PowerAutomateClientTeam,owners:["studio-designer-dev"],description:"Enables different messaging for run only user on run panel and run page.",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1473617",createdOn:"11/15/2024",fallback:{isRunOnlyUserMessagingEnabled:!1}}),{getFeatureValue:a}=Object(n.b)(i,"isRunOnlyUserMessagingEnabled")},20830:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,o=r(11766),i=r(15568),a=r(12706),c=r(14337),s=r(20831),l=r(20832),u=r(20833),p=r(20441),f=r(20834),d=r(20835),m=r(20839),b=r(20840),y=r(20841);function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=C(e);if(t){var o=C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=e=>e?P[e.fieldProps.type]:null,P={[i.b.Boolean]:l.a,[i.b.Date]:u.a,[i.b.Email]:p.a,[i.b.Enum]:f.a,[i.b.File]:d.a,[i.b.ImplicitDate]:null,[i.b.ImplicitLocation]:null,[i.b.MultiSelect]:m.a,[i.b.Number]:b.a,[i.b.Text]:y.a,[i.b.Integer]:b.a,[i.b.ComplexSchema]:y.a},j=Object(c.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(c,e);var t,r,n,i=w(c);function c(){var e;v(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=i.call(this,...r)).getClassNames=Object(a.a)(),e.classNames=e.getClassNames(s.a),e.renderParameters=t=>{var{getInputParameterEditor:r=S}=e.props,n=r(t);return n?o.createElement("div",{className:e.classNames.input,key:t.key},o.createElement(n,{inputParameter:t,globalResources:e.props.globalResources,dateTimeResources:e.props.dateTimeResources,sharedComponentsResources:e.props.sharedComponentResources,graphService:e.props.graphService,loggingService:e.props.loggingService})):null},e}return t=c,(r=[{key:"render",value:function(){var{inputParameters:e}=this.props;return o.createElement(o.Fragment,null,Object.values(e||{}).map(this.renderParameters))}}])&&h(t.prototype,r),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.Component))||n},20831:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({input:["fl-ParameterForm-input",{selectors:{"&:not(:first-child)":{marginTop:8}}}]})},20832:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o=r(11766),i=r(16898),a=r(14337);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=Object(a.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,r,n,a=p(l);function l(){var e;c(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=a.call(this,...r)).onChange=(t,r)=>{e.props.inputParameter.fieldState.onChange(!!r)},e}return t=l,(r=[{key:"render",value:function(){var{inputParameter:{fieldProps:e,fieldState:t}}=this.props;return o.createElement(i.a,{checked:t.value,label:e.label,onChange:this.onChange})}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component))||n},20833:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n,o,i=r(11766),a=r(19933),c=r(14337),s=r(14918),l=r(11773);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v,h,g,O,w,E,C=Object(c.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(c,e);var t,r,n,o=m(c);function c(){var e;u(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).onChange=t=>{var{inputParameter:{fieldState:r}}=e.props;t&&r.onChange(e.onFormatDate(t))},e.onFormatDate=e=>e?Object(s.l)(e,s.a.ISO8601DateOnly):"",e.onParseDateFromString=e=>{var t;return null!==(t=Object(s.P)(e))&&void 0!==t?t:null},e}return t=c,(r=[{key:"render",value:function(){var{inputParameter:{fieldProps:e,fieldState:t}}=this.props;return i.createElement(a.a,{value:this.date,placeholder:e.description,label:e.label,required:e.isRequired,onChanged:this.onChange,onFormatDate:this.onFormatDate,onParseDateFromString:this.onParseDateFromString,errorMessage:t.error,clientResources:this.props.globalResources,dateTimeResources:this.props.dateTimeResources})}},{key:"date",get:function(){var e,{inputParameter:{fieldState:t}}=this.props;return t&&t.value&&null!==(e=this.onParseDateFromString(t.value))&&void 0!==e?e:void 0}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(i.Component),v=o.prototype,h="date",g=[l.computed],O=Object.getOwnPropertyDescriptor(o.prototype,"date"),w=o.prototype,E={},Object.keys(O).forEach((function(e){E[e]=O[e]})),E.enumerable=!!E.enumerable,E.configurable=!!E.configurable,("value"in E||E.initializer)&&(E.writable=!0),E=g.slice().reverse().reduce((function(e,t){return t(v,h,e)||e}),E),w&&void 0!==E.initializer&&(E.value=E.initializer?E.initializer.call(w):void 0,E.initializer=void 0),void 0===E.initializer&&(Object.defineProperty(v,h,E),E=null),n=o))||n},20834:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n,o,i=r(11766),a=r(14337),c=r(17371),s=r(11773);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y,v,h,g,O,w,E=Object(a.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,e);var t,r,n,o=d(a);function a(){var e;l(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).onChange=(t,r)=>{r&&e.props.inputParameter.fieldState.onChange(r.key)},e}return t=a,(r=[{key:"render",value:function(){var{inputParameter:{fieldProps:e,fieldState:t}}=this.props;return i.createElement(c.a,{placeholder:e.description,options:this.options,selectedKey:t.value,onChange:this.onChange,label:e.label,required:e.isRequired,errorMessage:t.error})}},{key:"options",get:function(){return(this.props.inputParameter.fieldProps.options||[]).map(e=>({key:e.trim(),text:e.trim()}))}}])&&u(t.prototype,r),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.Component),y=o.prototype,v="options",h=[s.computed],g=Object.getOwnPropertyDescriptor(o.prototype,"options"),O=o.prototype,w={},Object.keys(g).forEach((function(e){w[e]=g[e]})),w.enumerable=!!w.enumerable,w.configurable=!!w.configurable,("value"in w||w.initializer)&&(w.writable=!0),w=h.slice().reverse().reduce((function(e,t){return t(y,v,e)||e}),w),O&&void 0!==w.initializer&&(w.value=w.initializer?w.initializer.call(O):void 0,w.initializer=void 0),void 0===w.initializer&&(Object.defineProperty(y,v,w),w=null),n=o))||n},20835:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,o=r(11766),i=r(14337),a=r(20836),c=r(13009),s=r(13085);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=Object(i.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(p,e);var t,r,n,i=d(p);function p(){var e;l(this,p);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=i.call(this,...r)).onChange=t=>{var{inputParameter:{fieldProps:r,fieldState:n},loggingService:o}=e.props,i=t?t.item(0):void 0,a=o.profileStart(s.a.invokeFlowInputContentFileReadStart);r.fileReader&&i&&r.fileReader(i).asBase64Encoded().then(e=>{var t;o.profileEndWithSuccess(a,s.a.invokeFlowInputContentFileReadEnd),n.onChange({contentBytes:e,name:null!==(t=null==i?void 0:i.name)&&void 0!==t?t:""})}).catch(e=>{o.profileEnd(a,s.a.invokeFlowInputContentFileReadEnd,Object(c.y)(e),e)})},e}return t=p,(r=[{key:"render",value:function(){var{inputParameter:{fieldProps:e,fieldState:t}}=this.props;return o.createElement(a.a,{acceptedFileExtensions:[""],placeholder:e.description,value:t.value?t.value.name:void 0,importButtonAriaLabel:e.description,textFieldAriaLabel:e.description,onImportFiles:this.onChange,label:e.label,required:e.isRequired,errorMessage:t.error,resources:this.props.globalResources})}}])&&u(t.prototype,r),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(o.Component))||n},20839:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n,o,i=r(11766),a=r(14337),c=r(17371),s=r(11773);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y,v,h,g,O,w,E=Object(a.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,e);var t,r,n,o=d(a);function a(){var e;l(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).onChange=(t,r,n)=>{var{inputParameter:{fieldState:o}}=e.props,i=(o.value||[]).filter(e=>e!==(null==r?void 0:r.key));null!=r&&r.selected&&i.push(r.key),o.onChange(i)},e}return t=a,(r=[{key:"render",value:function(){var{inputParameter:{fieldProps:e,fieldState:t}}=this.props;return i.createElement(c.a,{multiSelect:!0,placeholder:e.description,selectedKeys:t.value.slice(),options:this.options,onChange:this.onChange,label:e.label,required:e.isRequired,errorMessage:t.error})}},{key:"options",get:function(){return(this.props.inputParameter.fieldProps.options||[]).map(e=>({key:e.trim(),text:e.trim()}))}}])&&u(t.prototype,r),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.Component),y=o.prototype,v="options",h=[s.computed],g=Object.getOwnPropertyDescriptor(o.prototype,"options"),O=o.prototype,w={},Object.keys(g).forEach((function(e){w[e]=g[e]})),w.enumerable=!!w.enumerable,w.configurable=!!w.configurable,("value"in w||w.initializer)&&(w.writable=!0),w=h.slice().reverse().reduce((function(e,t){return t(y,v,e)||e}),w),O&&void 0!==w.initializer&&(w.value=w.initializer?w.initializer.call(O):void 0,w.initializer=void 0),void 0===w.initializer&&(Object.defineProperty(y,v,w),w=null),n=o))||n},20840:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o=r(11766),i=r(14337),a=r(15027);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=Object(i.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,r,n,i=p(l);function l(){var e;c(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=i.call(this,...r)).onChange=(t,r)=>{e.props.inputParameter.fieldState.onChange(null!=r?r:"0")},e}return t=l,(r=[{key:"render",value:function(){var{inputParameter:{fieldProps:e,fieldState:t}}=this.props;return o.createElement(a.b,{value:t.value,placeholder:e.description,label:e.label,required:e.isRequired,type:"number",onChange:this.onChange,errorMessage:t.error})}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component))||n},20841:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o=r(11766),i=r(14337),a=r(15027);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=Object(i.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,r,n,i=p(l);function l(){var e;c(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=i.call(this,...r)).onChange=(t,r)=>{e.props.inputParameter.fieldState.onChange(null!=r?r:"")},e}return t=l,(r=[{key:"render",value:function(){var{inputParameter:{fieldState:e,fieldProps:t}}=this.props;return o.createElement(a.b,{value:e.value,placeholder:t.description,label:t.label,required:t.isRequired,multiline:!t.singleLine,resizable:!0,rows:5,onChange:this.onChange,errorMessage:e.error})}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component))||n},20908:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(20909).a)},20909:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n,o,i,a,c,s,l,u,p,f,d,m,b,y,v,h,g,O,w,E=r(11773);function C(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function P(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function j(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var T=(o=j((n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),C(this,"activeContextId",o,this),C(this,"contextWidgetAnchorMap",i,this),C(this,"isPaneOpen",a,this),C(this,"eventDispatcher",c,this),C(this,"hasCommentingPaneRendered",s,this),C(this,"threadCountMap",l,this),C(this,"triggerAnchorId",u,this),C(this,"selectedOperationId",p,this),C(this,"setActiveContextId",f,this),C(this,"setContextWidgetAnchorMap",d,this),C(this,"setIsPaneOpen",m,this),C(this,"setEventDispatcher",b,this),C(this,"setHasCommentingPaneRendered",y,this),C(this,"setThreadCountMap",v,this),C(this,"setTriggerAnchorId",h,this),C(this,"setSelectedOperationId",g,this),C(this,"toggleIsPaneOpen",O,this),C(this,"resetPaneStore",w,this),this.resetPaneStore()}var t,r,n;return t=e,(r=[{key:"currentlySelectedOperationId",get:function(){return this.selectedOperationId||void 0}}])&&S(t.prototype,r),n&&S(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"activeContextId",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=j(n.prototype,"contextWidgetAnchorMap",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=j(n.prototype,"isPaneOpen",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=j(n.prototype,"eventDispatcher",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=j(n.prototype,"hasCommentingPaneRendered",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=j(n.prototype,"threadCountMap",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=j(n.prototype,"triggerAnchorId",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=j(n.prototype,"selectedOperationId",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j(n.prototype,"currentlySelectedOperationId",[E.computed],Object.getOwnPropertyDescriptor(n.prototype,"currentlySelectedOperationId"),n.prototype),f=j(n.prototype,"setActiveContextId",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.activeContextId=e}}}),d=j(n.prototype,"setContextWidgetAnchorMap",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.contextWidgetAnchorMap.set(e,t)}}}),m=j(n.prototype,"setIsPaneOpen",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isPaneOpen=e}}}),b=j(n.prototype,"setEventDispatcher",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.eventDispatcher=e}}}),y=j(n.prototype,"setHasCommentingPaneRendered",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.hasCommentingPaneRendered=e}}}),v=j(n.prototype,"setThreadCountMap",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.threadCountMap=e}}}),h=j(n.prototype,"setTriggerAnchorId",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.triggerAnchorId=e}}}),g=j(n.prototype,"setSelectedOperationId",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedOperationId=e}}}),O=j(n.prototype,"toggleIsPaneOpen",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isPaneOpen=!this.isPaneOpen}}}),w=j(n.prototype,"resetPaneStore",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hasCommentingPaneRendered=!1,this.isPaneOpen=!1,this.selectedOperationId=null,this.threadCountMap=null,this.activeContextId="",this.contextWidgetAnchorMap=new Map,this.triggerAnchorId=null,this.eventDispatcher=()=>{}}}}),n)},20911:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(20912).a)},20912:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return c}));var a={isDiet:!1},c=o((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.designerHostContext=a,this.setContext=e=>{this.designerHostContext=e},this.getContext=()=>this.designerHostContext}))},20913:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,o=r(12345),i=r(13e3),a=r(20914),c=(e,t)=>{var r;return null!==(r=n)&&void 0!==r?r:n=new a.a(i.a,o.a,e,t)}},20914:function(e,t,r){"use strict";r.d(t,"a",(function(){return k})),r.d(t,"b",(function(){return R}));var n,o,i,a,c,s,l,u,p,f,d,m,b,y,v,h=r(11773),g=r(11795),O=r(14837),w=r(13240),E=r(12375);function C(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j(n.key),n)}}function P(e,t,r){return t&&S(e.prototype,t),r&&S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function T(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var k=(o=T((n=P((function e(t,r,n,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionStore=void 0,this.environmentStore=void 0,this.loggingService=void 0,this.telemetryService=void 0,C(this,"getWorkflowDefinitionFunction",o,this),C(this,"tokenContext",i,this),C(this,"nodeIds",a,this),C(this,"isTrainingDataSharingPanelOpen",c,this),C(this,"prompt",s,this),C(this,"setNodeIds",l,this),C(this,"setIsTrainingDataSharingPanelOpen",u,this),C(this,"onTrainingDataSharingPanelDismiss",p,this),C(this,"reset",f,this),C(this,"onCheckboxChange",d,this),C(this,"onPromptChange",m,this),this.sendTrainingData=()=>{var e={prompt:this.prompt,tokenContext:this.tokenContext||[],generatedSchemas:this.getSelectedActionsDefinition()};this.telemetryService.tagEvent(w.c.EasyAutomationTrainingDataEmitted,null,e)},this.getSelectedActionsDefinition=()=>{var e=this.getWorkflowDefinitionFunction&&this.getWorkflowDefinitionFunction(),t={};if(e){var r,n=R(e.definition.actions);Object.keys(null!==(r=e.definition.triggers)&&void 0!==r?r:{}).concat(Object.keys(n)).filter(e=>this.nodeIds.includes(e.toLowerCase())).forEach(r=>Object.assign(t,{[r]:n[r]||e.definition.triggers[r]}))}return JSON.parse(x(JSON.stringify(t)))},C(this,"isFeedbackPanelOpen",b,this),this.isFeedbackPanelCorrelationId=void 0,C(this,"openFeedbackPanel",y,this),C(this,"onFeedbackPanelDismiss",v,this),this.getFeedbackSurveyUserContext=()=>{var e,t,r,n;return{UserId:null!==(e=null===(t=this.sessionStore.minimalUserInfo)||void 0===t?void 0:t.uniqueId)&&void 0!==e?e:"",TenantId:null!==(r=null===(n=this.sessionStore.minimalUserInfo)||void 0===n?void 0:n.tenantId)&&void 0!==r?r:"",SessionId:this.sessionStore.sessionId,Location:Object(g.h)().location,Region:Object(g.h)().region,EnvironmentId:this.environmentStore.currentEnvironmentName,locale:Object(E.a)()}},this.sessionStore=t,this.environmentStore=r,this.loggingService=n,this.telemetryService=h,this.reset()}))).prototype,"getWorkflowDefinitionFunction",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=T(n.prototype,"tokenContext",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=T(n.prototype,"nodeIds",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),c=T(n.prototype,"isTrainingDataSharingPanelOpen",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=T(n.prototype,"prompt",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=T(n.prototype,"setNodeIds",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.nodeIds=e}}}),u=T(n.prototype,"setIsTrainingDataSharingPanelOpen",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isTrainingDataSharingPanelOpen=e}}}),p=T(n.prototype,"onTrainingDataSharingPanelDismiss",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setIsTrainingDataSharingPanelOpen(!1)}}}),f=T(n.prototype,"reset",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isTrainingDataSharingPanelOpen=!1,this.tokenContext=void 0,this.isFeedbackPanelOpen=!1}}}),d=T(n.prototype,"onCheckboxChange",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{if(t)this.nodeIds.includes(e.toLowerCase())||this.nodeIds.push(e.toLowerCase());else{var r=this.nodeIds.indexOf(e.toLowerCase());r>-1&&this.nodeIds.splice(r,1)}}}}),m=T(n.prototype,"onPromptChange",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.prompt=t||""}}}),b=T(n.prototype,"isFeedbackPanelOpen",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=T(n.prototype,"openFeedbackPanel",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isFeedbackPanelOpen=!0,this.isFeedbackPanelCorrelationId=this.loggingService.profileStart(w.c.NL2FlowFeedbackPanel)}}}),v=T(n.prototype,"onFeedbackPanelDismiss",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.loggingService.profileEndWithSuccess(this.isFeedbackPanelCorrelationId,w.c.NL2FlowFeedbackPanel),this.isFeedbackPanelOpen=!1}}}),n);function R(e){if(!e)return{};var t=e;return Object.keys(e).forEach(r=>{var n,o=e[r];switch(o.type){case O.a.Foreach:case O.a.Scope:case O.a.Until:Object.assign(t,R(o.actions));break;case O.a.If:Object.assign(t,R(o.actions)),Object.assign(t,R((null===(n=o.else)||void 0===n?void 0:n.actions)||{}))}}),t}var x=e=>e.replace("@output","@\\\\output").replace("@triggerOutputs","@\\\\triggerOutputs").replace("@parameters","@\\\\parameters")},21028:function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));var n,o,i=r(14337),a=r(11766),c=r(11773),s=r(12728),l=r(21029),u=r(12706),p=r(21031),f=r(21052),d=r(13240),m=r(21056),b=r(11804),y=r(21058),v=r(18935),h=r(13016),g=r(21054),O=r(21035),w=r(21063),E=r(17239);function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_(n.key),n)}}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=T(e);if(t){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return j(this,r)}}function j(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){return(t=_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var D={[f.a.RunCompleted]:p.a,[f.a.TestingConnections]:g.a,[f.a.Consenting]:null,[f.a.ReviewingConnections]:p.b,[f.a.AwaitingRun]:p.d,[f.a.RunStarted]:p.e,[f.a.SigningInConnections]:g.a,[f.a.Loading]:p.e},I={[f.a.RunCompleted]:null,[f.a.TestingConnections]:p.c,[f.a.Consenting]:p.c,[f.a.ReviewingConnections]:null,[f.a.AwaitingRun]:p.c,[f.a.RunStarted]:p.c,[f.a.SigningInConnections]:p.c,[f.a.Loading]:p.c},A=Object(i.c)((k((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(i,e);var t,r,n,o=P(i);function i(e){var t,r,n,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(c=o.call(this,e)).invokeFlowStore=void 0,c.getClassNames=Object(u.a)(),c.onRenderPrimarySection=()=>{var e=D[c.invokeFlowStore.formState];return e&&a.createElement(e,{invokeFlowStore:c.invokeFlowStore,dismiss:c.props.dismiss})},c.onRenderSecondarySection=()=>{var e=I[c.invokeFlowStore.formState];return e&&a.createElement(e,{invokeFlowStore:c.invokeFlowStore})},c.onRenderFooterContent=()=>a.createElement(y.a,{invokeFlowStore:c.invokeFlowStore,surfaceType:c.props.surfaceType});var{telemetryService:s,flowName:l,isTestRun:p,onContentFirstRendered:f,surfaceType:b,loggingService:v,environmentCapabilityService:h,environmentStore:g}=e,O={flowName:l,surfaceType:b,isTestRun:p};return s.tagEvent(d.c.InvokeFlowSurfaceOpened,O),c.invokeFlowStore=new m.a(c.props),Object(E.c)(v,h,g.currentEnvironmentName,null!==(t=null===(r=g.currentEnvironment)||void 0===r?void 0:r.hasXrmInstance)&&void 0!==t&&t,null===(n=g.environmentClaim)||void 0===n||null===(n=n.protectionStatus)||void 0===n?void 0:n.keyManagedBy).then(e=>{c.invokeFlowStore.initialize(l,e).then(()=>{s.tagEvent(d.c.InvokeFlowSurfaceInitialized,O),f&&f()})}),c}return t=i,(r=[{key:"render",value:function(){var{clientResources:e,surfaceStore:t,dismiss:r,hasCloseButton:n,onClose:o,surfaceType:i,surfaceKey:c}=this.props;return a.createElement(l.a,{clientResources:e,surfaceStore:t,surfaceType:i,surfaceKey:c,dismiss:r,hasCloseButton:n,onClosed:o,textMessageBarProps:this.textMessageBarProps,title:this.panelTitle,onRenderFooterContent:this.onRenderFooterContent,onRenderPrimarySection:this.onRenderPrimarySection,onRenderSecondarySection:this.onRenderSecondarySection,horizontalSplitPercentage:60,dataAutomationId:O.a.run_flow_panel,className:this.getSurfaceViewClassName})}},{key:"panelTitle",get:function(){var{clientResources:e}=this.props;switch(this.invokeFlowStore.formState){case f.a.ReviewingConnections:return e.InvokeFlowForm.Title.ConnectionsAndActions;default:return this.defaultTitle}}},{key:"defaultTitle",get:function(){var{clientResources:e,widgetUtilService:t}=this.props;return t.isWidgetPage()&&t.widgetStrings&&t.widgetStrings[b.b.INVOKE_FLOW_HEADER]||e.Dialogs.RunFlow.Button.RunFlow}},{key:"textMessageBarProps",get:function(){var e=this.invokeFlowStore.errorMessage;if(e)return{ariaLabel:e,type:h.c.error,message:e}}},{key:"getSurfaceViewClassName",get:function(){var{widgetUtilService:e}=this.props,t=this.getClassNames(w.a,this.props);if(e.isExcelSDXContext())return t.excelSdxFlowInvokeSurface}}])&&C(t.prototype,r),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.Component)).prototype,"panelTitle",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"panelTitle"),o.prototype),k(o.prototype,"defaultTitle",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"defaultTitle"),o.prototype),k(o.prototype,"textMessageBarProps",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"textMessageBarProps"),o.prototype),k(o.prototype,"getSurfaceViewClassName",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"getSurfaceViewClassName"),o.prototype),n=o))||n,F=Object(v.b)((e,t)=>x({clientResources:e.clientResources,connectionService:e.connectionService,connectionStore:e.connectionStore,consentService:e.consentService,environmentCapabilityService:e.environmentCapabilityService,environmentStore:e.environmentStore,flowRoleService:e.flowRoleService,flowRunsService:e.flowRunsService,flowService:e.flowService,flowStore:e.flowStore,geocodeService:e.geocodeService,hostCommunicationService:e.hostCommunicationService,invokeFlowService:e.invokeFlowService,licenseManagementService:e.licenseManagementService,loggingService:e.loggingService,scenarioLoggingService:e.scenarioLoggingService,surfaceStore:e.surfaceStore,telemetryService:e.telemetryService,userDetailsStore:e.userDetailsStore,widgetUtilService:e.widgetUtilService,sessionStore:e.sessionStore},t))(A);function L(e,t){return e.spawn({key:Object(s.a)("invoke-flow-surface"),render:e=>a.createElement(F,x(x({},e),t))})}},21029:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n,o,i=r(12706),a=r(12811),c=r(16822),s=r(11773),l=r(14337),u=r(11766),p=r(14946),f=r(21030),d=r(13152);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e){return{[d.a.FullPageModal]:p.c.FullPageModal,[d.a.FullPagePanel]:p.c.FullPagePanel,[d.a.Modal]:void 0,[d.a.SmallPanel]:p.c.SmallPanel,[d.a.CustomPanel]:p.c.CustomPanel}[e]}var E,C,S,P,j,T,k=Object(l.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(s,e);var t,r,n,o=h(s);function s(){var e;m(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(i.a)(),e.renderModalBasedSurface=()=>{var{className:t,clientResources:r,dataAutomationId:n,textMessageBarProps:o,additionalTextMessageBarProps:i,title:s,noModalBackground:l,onRenderFooterContent:p,onRenderPrimarySection:d,onRenderSecondarySection:m,forceModalVerticalLayout:b}=e.props,y=e.getClassNames(f.a,e.props),v=Object(a.a)(y.root,t);return u.createElement(c.a,{closeButtonText:r.Common.Close,textMessageBarProps:o,additionalTextMessageBarProps:i,headerTitle:s||"",onDismiss:e.handleClose,onRenderPrimarySection:d,onRenderSecondarySection:m,onRenderFooter:p,className:v,dataAutomationId:n,noModalBackground:l,verticalLayout:b})},e.renderPanelBasedSurface=()=>{var{className:t,dataAutomationId:r,hasCloseButton:n,surfaceType:o,title:i,horizontalSplitPercentage:c,onRenderFooterContent:s,onRenderPrimarySection:l,onRenderSecondarySection:d,textMessageBarProps:m,onRenderSubHeader:b,headerLeftButtonProps:y}=e.props,v=e.getClassNames(f.a,e.props),h=Object(a.a)(v.root,t);return u.createElement(p.b,{textMessageBarProps:m,title:i,onDismissed:e.handleClose,hasCloseButton:n,isBlocking:e.isBlocking,onRenderFooterContent:s,surfaceType:w(o),className:h,horizontalSplitPercentage:c,onRenderPrimarySection:l,onRenderSecondarySection:d,dataAutomationId:r,onRenderSubHeader:b,headerLeftButtonProps:y})},e.handleClose=()=>{var{onClosed:t,dismiss:r}=e.props;t&&t(),r()},e}return t=s,(r=[{key:"render",value:function(){var{surfaceType:e}=this.props;switch(e){case d.a.FullPagePanel:case d.a.SmallPanel:case d.a.FullPageModal:case d.a.CustomPanel:return this.renderPanelBasedSurface();case d.a.Modal:default:return this.renderModalBasedSurface()}}},{key:"isBlocking",get:function(){var{surfaceKey:e,surfaceStore:t}=this.props;return!(!t.mostRecentlyMadeVisibleSurface||t.mostRecentlyMadeVisibleSurface.key!==e)}}])&&b(t.prototype,r),n&&b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(u.Component),E=o.prototype,C="isBlocking",S=[s.computed],P=Object.getOwnPropertyDescriptor(o.prototype,"isBlocking"),j=o.prototype,T={},Object.keys(P).forEach((function(e){T[e]=P[e]})),T.enumerable=!!T.enumerable,T.configurable=!!T.configurable,("value"in T||T.initializer)&&(T.writable=!0),T=S.slice().reverse().reduce((function(e,t){return t(E,C,e)||e}),T),j&&void 0!==T.initializer&&(T.value=T.initializer?T.initializer.call(j):void 0,T.initializer=void 0),void 0===T.initializer&&(Object.defineProperty(E,C,T),T=null),n=o))||n},21030:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",(function(){return a}));var a=e=>{var{padContent:t}=e;return{root:["fl-SurfaceView-root",{".ms-Panel-scrollableContent":o({},!1===t?{paddingLeft:"0px",paddingRight:"0px"}:{}),".ms-Panel-content":{overflowY:"auto"}}]}}},21031:function(e,t,r){"use strict";var n=r(21032);r.d(t,"a",(function(){return n.a}));var o=r(21036);r.d(t,"b",(function(){return o.a}));var i=r(21045);r.d(t,"c",(function(){return i.a}));var a=r(21051);r.d(t,"d",(function(){return a.a}));var c=r(21053);r.d(t,"e",(function(){return c.a}));r(21054)},21032:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(21033),o=r(14346),i=r(11766),a=r(11804),c=r(14900),s=r(13240),l=r(18935);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g={[a.k.flows]:!0,[a.k.flowDetails]:!0,[a.k.flowEdit]:!0,[a.k.flowNew]:!0,[a.k.flowsRuntime]:!1,[a.k.templates]:!1},O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(m,e);var t,r,a,l=d(m);function m(){var e;u(this,m);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=l.call(this,...r)).shouldLinkToWidgetPage=()=>{var{widgetUtilService:t}=e.props;return!!t.isWidgetPage()&&(g[t.widgetInfo.widgetType]&&e.doesHostSupportLinkingToWidgetPage())},e.doesHostSupportLinkingToWidgetPage=()=>{var{widgetUtilService:t}=e.props;return!t.isExcelSDXContext()},e}return t=m,(r=[{key:"render",value:function(){var e,{clientResources:t,invokeFlowStore:r,routeCrafter:a,dismiss:l}=this.props,u=Object(c.p)(a,{solutionId:void 0,flowName:r.flowName,isLegacyShared:(null===(e=r.flowEntity)||void 0===e?void 0:e.isLegacyShared)||!1,isUIFlow:!1},{isWidgetPage:this.shouldLinkToWidgetPage()});return i.createElement(n.a,{interpolatedString:t.InvokeFlowForm.FlowRunStartedMessage,links:[{text:t.InvokeFlowForm.FlowRunStartedHyperlinkText,href:u,onClick:this.shouldLinkToWidgetPage()?l:void 0,target:this.shouldLinkToWidgetPage()?void 0:o.b.blank,telemetryData:{name:s.c.InvokeFlowSurfaceViewRunsClicked,link:u}}]})}}])&&p(t.prototype,r),a&&p(t,a),Object.defineProperty(t,"prototype",{writable:!1}),m}(i.Component),w=Object(l.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({clientResources:e.clientResources,routeCrafter:e.routeCrafter,widgetUtilService:e.widgetUtilService},t))(O)},21033:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(12812),o=r(12754),i=r(12706),a=r(11766),c=r(21034),s=r(15941),l=r(21035),u=r(13272);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(v,e);var t,r,d,y=b(v);function v(){var e;p(this,v);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=y.call(this,...r)).successIconStyles={root:{color:Object(o.Y)().palette.green,fontSize:60,marginTop:40,marginBottom:25}},e.getClassNames=Object(i.a)(),e}return t=v,(r=[{key:"render",value:function(){var e=this.getClassNames(c.a);return a.createElement("div",{className:e.root,tabIndex:0,ref:e=>{var t;return null==e||null===(t=e.focus)||void 0===t?void 0:t.call(e)},"data-automation-id":l.a.action_completed},a.createElement(n.a,{iconName:u.a.Connected,styles:this.successIconStyles}),a.createElement(s.b,this.props))}}])&&f(t.prototype,r),d&&f(t,d),Object.defineProperty(t,"prototype",{writable:!1}),v}(a.PureComponent)},21034:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>({root:["fl-ActionCompletedIcon",{textAlign:"center"}]})},21036:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n,o=r(12706),i=r(11766),a=r(21037),c=r(14337),s=r(21038),l=r(21043),u=r(18935);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var O=Object(c.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(u,e);var t,r,n,c=m(u);function u(){var e;p(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=c.call(this,...r)).getClassNames=Object(o.a)(),e.renderConnectionWizard=()=>{var{clientResources:t,invokeFlowStore:r}=e.props,n=e.getClassNames(a.a);return Object.keys(r.connectionWizardConnectionReferences||{}).length>0&&i.createElement(i.Fragment,null,i.createElement("h3",{className:n.connectionsHeader},t.Header.Connections),i.createElement(l.a,{invokeFlowStore:r}))},e}return t=u,(r=[{key:"render",value:function(){var{clientResources:e,invokeFlowStore:t}=this.props,r=this.getClassNames(a.a);return i.createElement("div",{className:r.root},this.renderConnectionWizard(),i.createElement("h3",{className:r.actionsHeader},e.ListHeader.Actions),i.createElement(s.a,{flowName:t.flowName}))}}])&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Component))||n,w=Object(u.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({clientResources:e.clientResources},t))(O)},21037:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>{var t=Object(n.Y)().palette,r={padding:0,margin:0,fontSize:n.k.icon,color:t.neutralPrimary,lineHeight:"normal",fontWeight:n.l.semibold,paddingBottom:8,selectors:{":not(:first-child)":{paddingTop:16}}};return{actionsHeader:["fl-InvokeFlowConnectionsAndActions-ActionsHeader",r],connectionsHeader:["fl-InvokeFlowConnectionsAndActions-ConnectionsHeader",r],root:["fl-InvokeFlowConnectionsAndActions",{}]}}},21038:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n,o,i=r(12706),a=r(11766),c=r(21039),s=r(14337),l=r(11773),u=r(14343),p=r(13031),f=r(21040),d=r(21041),m=r(18935),b=r(21042);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var P,j,T,k,R,x,N=Object(s.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(s,e);var t,r,n,o=g(s);function s(){var e;y(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(i.a)(),e.classNames=e.getClassNames(c.a),e}return t=s,(r=[{key:"componentDidMount",value:function(){var{flowName:e,flowService:t}=this.props;e&&t.loadFlow(e)}},{key:"render",value:function(){return this.connectors.length>0&&a.createElement("div",{className:this.classNames.root},this.connectors.map(e=>this.renderConnectorDetails(e)))}},{key:"componentDidUpdate",value:function(e){var{flowName:t,flowService:r}=this.props,n=e&&e.flowName;t&&t!==n&&r.loadFlow(t)}},{key:"renderConnectorDetails",value:function(e){return a.createElement("div",{className:this.classNames.connectorContainer,key:e.id},a.createElement("div",{className:this.classNames.connectorHeaderContainer},a.createElement("div",{className:this.classNames.connectorIconContainer},a.createElement(u.a,{brandColor:e.brandColor,iconUri:e.iconUri,size:u.b.medium,cdnService:this.props.cdnService})),a.createElement("h4",{className:this.classNames.connectorTitle},e.displayName)),a.createElement("div",{className:this.classNames.operationsContainer},e.operations.map(e=>this.renderOperationDetails(e))))}},{key:"renderOperationDetails",value:function(e){var{clientResources:t}=this.props;return a.createElement("div",{className:this.classNames.operationContainer,key:e.id},a.createElement("p",{className:this.classNames.operationSummary},Object(p.a)(t.ActionDetails.OperationName,e.summary)),a.createElement("p",{className:this.classNames.operationDescription},e.description),(e.referencedResources||[]).map(e=>this.renderReferencedResource(e)))}},{key:"renderReferencedResource",value:function(e){var{name:t,value:r}=e,{clientResources:n}=this.props;return a.createElement("div",{className:this.classNames.referencedResourcesContainer,key:"".concat(t).concat(r)},a.createElement("p",{className:this.classNames.referencedResourceName},Object(p.a)(n.ActionDetails.ReferencedResourceName,this.getFriendlyResourceName(t))),this.isDynamicResource(r)?a.createElement("p",{className:this.classNames.dynamicReferencedResourceValue},n.RunFlow.DynamicSiteInOperation):a.createElement("p",{className:this.classNames.referencedResourceValue},r))}},{key:"connectors",get:function(){var{flowName:e,flowStore:t}=this.props,r=t.flows.getEntity(e);if(!r)return[];var n=[];return r.definitionSummaryActions.forEach(e=>{var t=e&&e.apiOperation;if(t){var o=t&&t.properties&&t.properties.api;if(o){var i=[];(r.properties.referencedResources||[]).filter(e=>e.referencers&&this.referencerHasApiOperation(e.referencers,t.id)).forEach(e=>{if(e.resource){var t=Object.entries(e.resource).map(e=>{var[t,r]=e;return{name:t,value:r}}).filter(t=>e.service!==d.a.sharepoint||t.name===f.e.site);i=i.concat(t)}});var a={description:t.properties.description,id:t.id,referencedResources:i,summary:t.properties.summary},c=n.find(e=>e.id===o.id);if(c){var s=c.operations.find(e=>e.id===a.id);if(s&&s.referencedResources){var l=(a.referencedResources||[]).filter(e=>!(s.referencedResources||[]).some(t=>t.name===e.name&&t.value===e.value));s.referencedResources=s.referencedResources.concat(l)}else s?s.referencedResources=a.referencedResources:c.operations.push(a)}else n.push({brandColor:o.brandColor,displayName:o.displayName,iconUri:o.iconUri,id:o.id,operations:[a]})}}}),n}},{key:"getFriendlyResourceName",value:function(e){return Object(b.a)(e,this.props.clientResources)||e}},{key:"isDynamicResource",value:function(e){return e===f.d}},{key:"referencerHasApiOperation",value:function(e,t){return"string"==typeof e[0]?-1!==e.indexOf(t):e.some(e=>e&&e.operationId&&e.operationId===t)}}])&&v(t.prototype,r),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(a.Component),P=o.prototype,j="connectors",T=[l.computed],k=Object.getOwnPropertyDescriptor(o.prototype,"connectors"),R=o.prototype,x={},Object.keys(k).forEach((function(e){x[e]=k[e]})),x.enumerable=!!x.enumerable,x.configurable=!!x.configurable,("value"in x||x.initializer)&&(x.writable=!0),x=T.slice().reverse().reduce((function(e,t){return t(P,j,e)||e}),x),R&&void 0!==x.initializer&&(x.value=x.initializer?x.initializer.call(R):void 0,x.initializer=void 0),void 0===x.initializer&&(Object.defineProperty(P,j,x),x=null),n=o))||n,_=Object(m.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({clientResources:e.clientResources,cdnService:e.cdnService,flowService:e.flowService,flowStore:e.flowStore},t))(N)},21039:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(12754),o=r(13274),i=e=>{var t=Object(n.Y)().palette;return{connectorContainer:["fl-ActionDetails-ConnectorContainer",{padding:0,display:"inline-block",selectors:{":not(:first-child)":{paddingTop:14}}}],connectorHeaderContainer:["fl-ActionDetails-ConnectorHeaderContainer",{display:"flex"}],connectorIconContainer:["fl-ActionDetails-ConnectorIconContainer",{padding:0,margin:0,marginRight:8}],connectorTitle:["fl-ActionDetails-ConnectorTitle",{color:t.neutralPrimary,fontSize:n.k.medium,padding:0,display:"flex",alignItems:"center",fontWeight:n.l.semibold}],dynamicReferencedResourceValue:["fl-ActionDetails-DynamicReferencedResourceValue",{fontSize:n.k.medium,padding:0,color:t.neutralPrimary,display:"inline",wordBreak:"break-all",wordWrap:"break-word",fontWeight:n.l.semibold}],operationContainer:["fl-ActionDetails-OperationContainer",{margin:0,padding:0,wordBreak:Object(o.b)()?"break-all":"break-word",selectors:{":not(:first-child)":{paddingTop:19}}}],operationDescription:["fl-ActionDetails-OperationDescription",{fontSize:n.k.medium,padding:0,wordBreak:Object(o.b)()?"break-all":"break-word",wordWrap:"break-word",color:t.neutralPrimary,display:"inline"}],operationSummary:["fl-ActionDetails-OperationSummary",{fontSize:n.k.medium,padding:0,color:t.neutralPrimary,fontWeight:n.l.semibold,display:"inline"}],operationsContainer:["fl-ActionDetails-OperationsContainer",{padding:0,display:"inline-block",paddingTop:8}],referencedResourcesContainer:["fl-ActionDetails-ReferencedResourcesContainer",{padding:0,paddingTop:19}],referencedResourceName:["fl-ActionDetails-ReferencedResourceName",{fontSize:n.k.medium,padding:0,color:t.neutralPrimary,display:"inline"}],referencedResourceValue:["fl-ActionDetails-ReferencedResourceValue",{fontSize:n.k.medium,padding:0,color:t.neutralPrimary,wordBreak:"break-all",wordWrap:"break-word",display:"inline"}],root:["fl-ActionDetails",{margin:0,padding:0}]}}},21040:function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return c}));var n=function(e){return e.site="site",e.list="list",e}({}),o=function(e){return e.organization="organization",e.entity="entity",e}({}),i=function(e){return e.database="database",e.entity="entity",e}({}),a=function(e){return e.fieldId="fieldId",e.table="table",e}({}),c="[DYNAMIC_VALUE]"},21041:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i}));var n=function(e){return e.sharepoint="sharepoint",e.roadmap="roadmap",e}({}),o={sharepointBasePermissions:[{high:0,low:15}]},i={sharepointBasePermissions:[{high:0,low:2079}]}},21042:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(21040);function o(e,t){return{[n.e.site]:t.ReferencedResourceFriendlyName.Site,[n.e.list]:t.ReferencedResourceFriendlyName.List,[n.b.organization]:t.ReferencedResourceFriendlyName.Organization,[n.b.entity]:t.ReferencedResourceFriendlyName.Entity,[n.a.database]:t.ReferencedResourceFriendlyName.Database,[n.a.entity]:t.ReferencedResourceFriendlyName.Entity,[n.c.fieldId]:t.ReferencedResourceFriendlyName.FieldId,[n.c.table]:t.ReferencedResourceFriendlyName.Table}[e]||e}},21043:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,o=r(12706),i=r(11766),a=r(21044),c=r(14337),s=r(18935),l=r(20814);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g=Object(c.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(s,e);var t,r,n,c=d(s);function s(){var e;u(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=c.call(this,...r)).getClassNames=Object(o.a)(),e.handleConnectionsChangedByDesigner=t=>{var{invokeFlowStore:{addConnectionsToStore:r},loggingService:n}=e.props;n.logInfo("InvokeFlowConnectionWizard.handleConnectionsChangedByDesigner","Refreshing connections after designer connection store change detected"),r(t)},e}return t=s,(r=[{key:"render",value:function(){var{invokeFlowStore:e,designerCreateContext:t,appSettings:r,telemetryService:n,featureFlags:o,oAuthService:c,xrmConnectionReferenceStore:s,xrmConnectionReferenceService:u,ppapiService:p,dynamicListStore:f}=this.props,d=this.getClassNames(a.a);return i.createElement("div",{className:d.root},i.createElement(l.a,{availableConnections:e.availableConnections,connectionReferences:e.connectionWizardConnectionReferences,onConnectionReferencesConfirmed:e.onConnectionsConfirmed,onConnectionsUpdatedByDesigner:this.handleConnectionsChangedByDesigner,onConnectionWizardStateChange:e.handleConnectionWizardStateChange,registerConnectionConfirmationCallback:e.registerConnectionConfirmationCallback,onError:e.setErrorMessage,connectionWizardSize:l.b.Compact,connectionsReady:!e.isLoadingConnections,designerCreateContext:t,appSettings:r,featureFlags:o,oAuthService:c,telemetryService:n,xrmConnectionReferenceStore:s,xrmConnectionReferenceService:u,ppapiService:p,dynamicListStore:f,shouldSkipMergeConnectionsLogic:!0,loadDesignerStylesManually:!0}))}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(i.Component))||n,O=Object(s.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({appSettings:e.appSettings,designerCreateContext:e.designerCreateContext,featureFlags:e.featureFlags,oAuthService:e.oAuthService,loggingService:e.loggingService,telemetryService:e.telemetryService,xrmConnectionReferenceStore:e.xrmConnectionReferenceStore,xrmConnectionReferenceService:e.xrmConnectionReferenceService,ppapiService:e.ppapiService,dynamicListStore:e.dynamicListStore},t))(g)},21044:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=e=>{var t={width:"100%"};return{root:["fl-InvokeFlowConnectionWizard",{".msla-card-config-item":{".msla-checkbox":t,".msla-combobox-container":t,".msla-dropdown-container":t,".msla-textbox":t,".ms-Stack":t}}]}}},21045:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o=r(11766),i=r(14337),a=r(21046);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=Object(i.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,r,n,i=p(l);function l(){return c(this,l),i.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){var{invokeFlowStore:e}=this.props;return o.createElement(a.a,{flowName:e.flowName,isExpanded:e.isFlowDescriptionExpanded,onExpandToggled:e.onFlowDescriptionExpandToggled})}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component))||n},21046:function(e,t,r){"use strict";r.d(t,"b",(function(){return P})),r.d(t,"a",(function(){return T}));var n,o,i=r(12706),a=r(11766),c=r(21047),s=r(14337),l=r(11773),u=r(13031),p=r(12367),f=r(18935),d=r(21048),m=r(21050);function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=O(e);if(t){var o=O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function P(e,t,r){if(e){var{useCreatorText:n,maxVisibleOwners:o}=r,i=n?t.FlowContactCard.Creator:e.length>1?t.FlowContactCard.Owners:t.FlowContactCard.Owner;if(!o)return Object(u.a)(i,e.join(", "));var a=Object(u.a)(i,e.slice(0,o).join(", "));return e.length>o&&(a=a.concat(" +".concat(e.length-o))),a}}var j=Object(s.c)((w((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(s,e);var t,r,n,o=h(s);function s(){var e;b(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(i.a)(),e.renderOwnerDisplayNames=t=>{var{allDisplayNames:r,errorMessage:n,visibleDisplayNames:o}=t,{clientResources:i}=e.props,s=e.getClassNames(c.a);if(!n)return a.createElement("h3",{className:s.subtitle,title:r},o);var l=e.graphObjectIds.length>1?i.FlowDetails.Error.Owners:i.FlowDetails.Error.Owner;return a.createElement("h3",{className:s.subtitle,title:l},l)},e}return t=s,(r=[{key:"render",value:function(){var e,{clientResources:t,flowName:r,flowStore:n,graphService:o,isExpanded:i,maxVisibleOwners:s=2,onExpandToggled:l}=this.props,u=null!==(e=n.publishedFlows.getEntity(r))&&void 0!==e?e:n.flows.getEntity(r),p=null==u?void 0:u.displayName,f=null==u?void 0:u.description,b=this.getClassNames(c.a);return a.createElement("div",{className:b.root},a.createElement("h2",{className:b.title},p),this.canFetchGraphDisplayNames&&a.createElement(m.a,{formatString:this.formatString,graphObjectIds:this.graphObjectIds,render:this.renderOwnerDisplayNames,maxVisibleDisplayNames:s,clientResources:t,graphService:o}),f&&f.trim().length>0&&a.createElement("div",{className:b.description},a.createElement(d.a,{isExpanded:i,text:f,onExpandToggled:l,clientResources:t})))}},{key:"componentDidMount",value:function(){var{flowName:e,flowRoleService:t,flowService:r}=this.props;e&&(t.loadFlowRoles({flowName:e,flowRole:p.g.owners}),r.loadFlow(e,!1,void 0,void 0,!1,!0))}},{key:"canFetchGraphDisplayNames",get:function(){var{userDetailsStore:e,sessionStore:t}=this.props;return!(!e.isConsented||!t.user||t.user.isConsumerDomain)}},{key:"formatString",get:function(){var{clientResources:e}=this.props;return this.graphObjectIds.length>1?e.FlowContactCard.Owners:e.FlowContactCard.Owner}},{key:"graphObjectIds",get:function(){var{flowName:e,flowRoleStore:t}=this.props;return e&&t.getRolePrincipalObjectIds(e,p.g.owners)||[]}}])&&y(t.prototype,r),n&&y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(a.Component)).prototype,"canFetchGraphDisplayNames",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"canFetchGraphDisplayNames"),o.prototype),w(o.prototype,"formatString",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"formatString"),o.prototype),w(o.prototype,"graphObjectIds",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"graphObjectIds"),o.prototype),n=o))||n,T=Object(f.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({clientResources:e.clientResources,flowRoleService:e.flowRoleService,flowRoleStore:e.flowRoleStore,flowService:e.flowService,flowStore:e.flowStore,graphService:e.graphService,sessionStore:e.sessionStore,userDetailsStore:e.userDetailsStore},t))(j)},21047:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>{var t=Object(n.Y)().palette;return{root:["fl-FlowDetails",{margin:0,padding:0}],title:["fl-FlowDetails-Title",{padding:0,margin:0,fontSize:16,color:t.neutralPrimary,lineHeight:"normal",fontWeight:n.l.semibold}],subtitle:["fl-FlowDetails-Subtitle",{padding:0,paddingTop:4,fontSize:n.k.medium,color:t.neutralSecondary,lineHeight:"normal",fontWeight:n.l.regular}],description:["fl-FlowDetails-Description",{padding:0,paddingTop:12}]}}},21048:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return y})),r.d(t,"a",(function(){return v}));var n=r(11766),o=r(12706),i=r(21049),a=r(20353),c=r(13272);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=150,y=450,v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,r,u,d=f(m);function m(){var e;s(this,m);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=d.call(this,...r)).getClassNames=Object(o.a)(),e.shouldShowExpandCollapseButton=()=>{var{maxLength:t=b,text:r}=e.props;return!!r&&r.length>t+50},e.onExpandToggled=()=>{var{isExpanded:t,onExpandToggled:r}=e.props;r(!t)},e.getParagraphText=()=>{var{isExpanded:t,maxLength:r=b,text:n}=e.props;return t||!e.shouldShowExpandCollapseButton()?n:"".concat(n.substring(0,r)," ...")},e.getButtonText=()=>{var{isExpanded:t,clientResources:r}=e.props;return t?r.Common.SeeLess:r.Common.SeeMore},e}return t=m,(r=[{key:"render",value:function(){var{isExpanded:e,text:t}=this.props,r=this.getClassNames(i.a,this.props);return t&&t.trim().length>0&&n.createElement("div",{className:r.root},n.createElement("p",{className:r.paragraph,"aria-label":t},this.getParagraphText()),this.shouldShowExpandCollapseButton()&&n.createElement(a.a,{className:r.button,text:this.getButtonText(),iconOnRight:!0,onClick:this.onExpandToggled,iconName:e?c.a.ChevronUp:c.a.ChevronDown,ariaExpanded:!!e}))}}])&&l(t.prototype,r),u&&l(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.PureComponent)},21049:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>{var t=Object(n.Y)().palette;return{root:["fl-CollapsibleParagraph",{}],paragraph:["fl-CollapsibleParagraph-Text",{fontSize:n.k.medium,color:t.neutralSecondary,lineHeight:"normal",padding:0}],button:["fl-CollapsibleParagraph-Button",{height:24,padding:0,selectors:{".ms-Button-icon":{height:14,width:14},".ms-Button-label":{margin:0,color:t.themeDark}}}]}}},21050:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o,i=r(11766),a=r(14337),c=r(11773),s=r(13031),l=r(12347);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=Object(a.c)((v((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(i,e);var t,r,n,o=m(i);function i(){var e;u(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).loadGraphObjects=()=>{var{graphService:t,graphObjectIds:r=[]}=e.props;r.forEach(e=>{t.getDirectoryObjectEntity(e)||t.getObjectsByObjectIds([e])})},e}return t=i,(r=[{key:"render",value:function(){var{clientResources:e,graphObjectIds:t,render:r}=this.props;return t&&0!==t.length?r({allDisplayNames:this.allDisplayNamesText,visibleDisplayNames:this.visibleDisplayNamesText,errorMessage:this.isErrored&&e.GraphDisplayNameList.Error||""}):null}},{key:"componentDidMount",value:function(){this.loadGraphObjects()}},{key:"componentDidUpdate",value:function(e){var{graphObjectIds:t}=this.props;e.graphObjectIds===t||(t||[]).every(t=>-1!==(e.graphObjectIds||[]).indexOf(t))||this.loadGraphObjects()}},{key:"visibleDisplayNamesText",get:function(){var{clientResources:e,formatString:t,maxVisibleDisplayNames:r}=this.props;if(!this.displayNames||0===this.displayNames.length)return e.Common.Loading;var n=e.Common.Loading;return r?(n=this.displayNames.slice(0,r).join(this.delimiter),this.displayNames.length>r&&(n=n.concat(" +".concat(this.displayNames.length-r)))):n=this.displayNames.join(this.delimiter),t?Object(s.a)(t,n):n}},{key:"allDisplayNamesText",get:function(){var{clientResources:e,formatString:t}=this.props;if(!this.displayNames||0===this.displayNames.length)return e.Common.Loading;var r=this.displayNames.join(this.delimiter);return t?Object(s.a)(t,r):r}},{key:"displayNames",get:function(){var{graphService:e,graphObjectIds:t}=this.props;return!t||t.some(t=>!e.getDirectoryObjectEntity(t))?[]:t.map(t=>e.getDirectoryObjectEntity(t).displayName)}},{key:"isErrored",get:function(){var{graphService:e,graphObjectIds:t}=this.props;return(t||[]).some(t=>{var r=e.getDirectoryObjectEntityStatus(t);return r&&r.fetchStatus===l.c.error})}},{key:"delimiter",get:function(){return this.props.delimiter||", "}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(i.Component)).prototype,"visibleDisplayNamesText",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"visibleDisplayNamesText"),o.prototype),v(o.prototype,"allDisplayNamesText",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"allDisplayNamesText"),o.prototype),v(o.prototype,"displayNames",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"displayNames"),o.prototype),v(o.prototype,"isErrored",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"isErrored"),o.prototype),n=o))||n},21051:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,o=r(11766),i=r(14337),a=r(12804),c=r(21052),s=r(20830),l=r(18935);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g=Object(i.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,r,n,i=d(l);function l(){var e;u(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=i.call(this,...r)).inputParametersRoot=o.createRef(),e}return t=l,(r=[{key:"render",value:function(){var{invokeFlowStore:e,clientResources:t,loggingService:r,graphService:n}=this.props;return e.inputParameters?o.createElement("div",{ref:this.inputParametersRoot},o.createElement(s.a,{inputParameters:e.inputParameters,globalResources:t,dateTimeResources:t.DateTime,sharedComponentResources:t,loggingService:r,graphService:n})):null}},{key:"componentDidMount",value:function(){if(this.inputParametersRoot.current&&this.props.invokeFlowStore.previousFormState!==c.a.ReviewingConnections){var e=Object(a.e)(this.inputParametersRoot.current,this.inputParametersRoot.current,!0);e&&e.focus()}}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.Component))||n,O=Object(l.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({clientResources:e.clientResources,graphService:e.graphService,loggingService:e.loggingService},t))(g)},21052:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e[e.Consenting=0]="Consenting",e[e.TestingConnections=1]="TestingConnections",e[e.SigningInConnections=2]="SigningInConnections",e[e.AwaitingRun=3]="AwaitingRun",e[e.RunStarted=4]="RunStarted",e[e.ReviewingConnections=5]="ReviewingConnections",e[e.RunCompleted=6]="RunCompleted",e[e.Loading=7]="Loading",e}({})},21053:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(11766),o=r(13241),i=()=>n.createElement(o.a,{size:o.b.medium})},21054:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,o=r(12706),i=r(11766),a=r(21055),c=r(14337),s=r(21052),l=r(13241),u=r(20818),p=r(21043),f=r(18935),d=r(20819);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C=Object(c.c)(n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(f,e);var t,r,n,c=v(f);function f(){var e;m(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=c.call(this,...r)).getClassNames=Object(o.a)({disableCaching:!0}),e.renderConnectionWizard=()=>{var{invokeFlowStore:t}=e.props,r=e.getClassNames(a.a,e.props);return i.createElement("div",{className:r.connectionWizardContainer},i.createElement(p.a,{invokeFlowStore:t}))},e}return t=f,(r=[{key:"render",value:function(){var e,{clientResources:t,invokeFlowStore:r,widgetUtilService:n}=this.props,o=r.formState===s.a.TestingConnections,a=Object(d.a)()?null===(e=r.flowEntity)||void 0===e?void 0:e.isUserType:void 0;return i.createElement(i.Fragment,null,!o&&i.createElement(u.a,{clientResources:t,widgetUtilService:n,isUserTypeFlow:a}),o&&i.createElement(l.a,{size:l.b.medium}),this.renderConnectionWizard())}}])&&b(t.prototype,r),n&&b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(i.Component))||n,S=Object(f.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({clientResources:e.clientResources,widgetUtilService:e.widgetUtilService},t))(C)},21055:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(21052),o=e=>{var{invokeFlowStore:t}=e;return{connectionWizardContainer:["fl-InvokeFlowSignIn-ConnectionWizardContainer",{display:t.formState===n.a.TestingConnections?"none":"block"}]}}},21056:function(e,t,r){"use strict";r.d(t,"a",(function(){return ce}));var n,o,i,a,c,s,l,u,p,f,d,m,b,y,v,h,g,O,w,E,C,S,P,j,T,k,R,x,N,_,D,I=r(11773),A=r(12328),F=r.n(A),L=r(21052),M=r(19999),B=r(13240),U=r(11804),V=r(17866),z=r(13009),G=r(12367),W=r(13085),H=r(13031),K=r(15378),q=r(12999),Y=r(15422),X=r(17176),Q=r(13154),Z=r(13158),J=r(21057);function $(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,o)}function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){re(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function re(e,t,r){return(t=ie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ne(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ie(n.key),n)}}function ie(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function ae(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var ce=(o=ae((n=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props=t,this.installFlowPromise=void 0,this.didInstallFail=void 0,this.isConnectionWizardConfirmClicked=void 0,ne(this,"errorMessage",o,this),this.previousFormState=void 0,ne(this,"formState",i,this),ne(this,"flowName",a,this),ne(this,"isVersioningEnabled",c,this),ne(this,"enableDetermineLicenseBasedOnContext",s,this),ne(this,"connectionConfirmationCallback",l,this),ne(this,"inputParameters",u,this),ne(this,"isFlowDescriptionExpanded",p,this),ne(this,"isLoadingConnections",f,this),ne(this,"isConsenting",d,this),ne(this,"connectionWizardState",m,this),ne(this,"selectedConnectionReferences",b,this),ne(this,"location",y,this),ne(this,"hasNonRecoverableError",v,this),ne(this,"licenseCategorization",h,this),this.handleRunClicked=()=>{var{telemetryService:e}=this.props;return e.tagEvent(B.c.InvokeFlowSurfaceRunButtonClicked,null,this.getEventData()),this.validateParametersAndRunFlow()},this.handleDoneClicked=()=>{var{onDone:e,telemetryService:t}=this.props;t.tagEvent(B.c.InvokeFlowSurfaceDoneButtonClicked,null,this.getEventData()),e&&e(this.flowEntity&&this.flowEntity.toJS()),this.handleClose()},this.handleCancelClicked=()=>{var{telemetryService:e,onCancel:t,scenarioLoggingService:r}=this.props;e.tagEvent(B.c.InvokeFlowSurfaceCloseButtonClicked,null,this.getEventData()),this.formState===L.a.Consenting&&r.tagEvent(X.c.UserConsentScenario,B.c.UserConsentInterrupted,X.d.End,null,te(te({},this.getEventData()),{},{consentSource:"invokeFlowStore",unconsentedMode:Object(q.a)().enableUnconsentedMode})),t&&t(this.flowEntity&&this.flowEntity.toJS()),this.handleClose()},this.handleBackClicked=()=>{var{telemetryService:e}=this.props;e.tagEvent(B.c.InvokeFlowSurfaceBackButtonClicked,null,this.getEventData()),this.connectionConfirmationCallback?(this.isConnectionWizardConfirmClicked=!0,this.connectionConfirmationCallback()):this.loadAwaitRun()},this.handleClose=()=>{var{onClose:e,dismiss:t}=this.props;e&&e(),t()},this.getEventData=()=>({flowName:this.flowName,formState:L.a[this.formState]}),this.handleContinueSignInClicked=()=>{var{telemetryService:e}=this.props;e.tagEvent(B.c.InvokeFlowSurfaceContinueSignInButtonClicked,null,this.getEventData()),F()(this.connectionConfirmationCallback,"connection wizard continue button should always be defined prior to enabling the continue sign in button"),this.connectionConfirmationCallback&&(this.isConnectionWizardConfirmClicked=!0,this.connectionConfirmationCallback())},ne(this,"setFormState",g,this),ne(this,"setErrorMessage",O,this),ne(this,"setNonRecoverableErrorMessage",w,this),ne(this,"clearErrorMessage",E,this),ne(this,"setSelectedConnectionReferences",C,this),ne(this,"handleConnectionWizardStateChange",S,this),ne(this,"registerConnectionConfirmationCallback",P,this),ne(this,"initialize",j,this),ne(this,"initializeForConsentedUser",T,this),ne(this,"setLicenseCategorization",k,this),this.loadLicenseCategorization=function(){var e,t=(e=function*(e){if(void 0!==e)try{var{licenseManagementService:t,environmentStore:{currentEnvironmentName:n}}=r.props,o=new Promise((e,t)=>{setTimeout(()=>t(new Error("License categorization request timed out after 15 seconds")),Object(J.b)())}),i=yield Promise.race([t.getContextBasedUserLicenseRequest(e,n),o]);r.setLicenseCategorization(i)}catch(a){r.props.loggingService.logWarning("InvokeFlowStore.loadLicenseCategorization","Failed to load license categorization: ".concat(a)),r.setLicenseCategorization(Z.b.NotSpecified)}},function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){$(i,n,o,a,c,"next",e)}function c(e){$(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),ne(this,"onFlowDescriptionExpandToggled",R,this),this.onConnectionsConfirmed=e=>{if(this.isConnectionWizardConfirmClicked){this.isConnectionWizardConfirmClicked=!1;var t=this.selectedConnectionReferences||this.flowEntity.installedConnectionReferences,r=Object.keys(e).some(r=>{var n=t&&t[r];if(!n||!n.connectionName)return!0;var o=e[r];return n.connectionName!==o.connectionName});this.setSelectedConnectionReferences(e),(r||this.flowEntity.properties.installationStatus===G.c.broken)&&this.installFlow({}),this.props.widgetUtilService.shouldWaitAfterInstallingFlow()||this.setFormState(L.a.AwaitingRun)}},this.installFlow=e=>{var{throwOnException:t}=e,{flowService:r,loggingService:n,widgetUtilService:o}=this.props;this.clearErrorMessage(),this.didInstallFail=!1,o.shouldWaitAfterInstallingFlow()&&this.setFormState(L.a.Loading),this.installFlowPromise=r.installFlow({flowName:this.flowName,connectionReferences:this.selectedConnectionReferences||this.flowEntity.installedConnectionReferences,shouldStoreInPublishedCollection:this.isVersioningEnabled}).then(()=>{o.isWidgetPage()&&o.fireFlowInstallSucceededEvent(this.flowEntity.toJS())}).catch(e=>(o.isWidgetPage()&&o.fireFlowInstallFailedEvent(e),this.didInstallFail=!0,n.logError("InvokeFlowStore.installFlow",e),o.shouldWaitAfterInstallingFlow()&&this.loadSignInConnections(),t?Promise.reject(e):Promise.resolve()))},this.getLocation=()=>this.props.geocodeService.getCoordinates(),this.validateParametersAndRunFlow=()=>{var{clientResources:e,hostCommunicationService:t,loggingService:r,widgetUtilService:n}=this.props;if(!this.flowEntity.isStarted)return this.setErrorMessage(e.InvokeFlowForm.ErrorMessage.FlowTurnedOff,"validateParametersAndRunFlow_invokeFlowStore.ts"),Promise.resolve();var o=Object.values(this.inputParameters||{}).filter(e=>!e.fieldState.hasBeenValidated).map(e=>e.fieldState.validate());return this.clearErrorMessage(),Promise.all(o).then(()=>this.areInputParametersValid?n.isWidgetPage()?t.getDataFromHostEvent(U.a.GET_IMPLICIT_DATA,this.flowEntity.entitySchema).then(e=>e?this.runFlow({implicitData:e.implicitData}):(r.logInfo(W.a.widgetFlowRunWithImplicitData,"Response is undefined for the Get Implicit data call for a ".concat(this.flowName),{isMini:n.isMiniWidget()}),this.runFlow({}))):this.runFlow({}):Promise.resolve())},ne(this,"runFlow",x,this),ne(this,"initializeInputParameters",N,this),ne(this,"setIsLoadingConnections",_,this),ne(this,"setIsConsenting",D,this),this.consent=()=>{var{consentService:e,userDetailsStore:t,sessionStore:r,scenarioLoggingService:n,autoConsentUser:o}=this.props,i=te({consentSource:"invokeFlowStore",unconsentedMode:Object(q.a)().enableUnconsentedMode},this.getEventData()),a=o?B.c.UserAutoConsented:B.c.UserConsentAcceptClicked,c=o?X.d.Other:X.d.Resume;n.tagEvent(X.c.UserConsentScenario,a,c,null,i),this.setIsConsenting(!0);var s=n.profileStart(X.c.UserConsentScenario,W.a.reactInvokeFlowConsentStart,X.d.Other,i),l=Object(K.b)(t,r);return e.consent(l).then(()=>(n.profileEndWithSuccess(s,X.c.UserConsentScenario,W.a.reactInvokeFlowConsentEnd,X.d.End,i),Object(q.a)().enableReloadAfterConsentForInvokeFlowStore&&window.location.reload(),this.setIsConsenting(!1),this.initializeForConsentedUser())).catch(e=>{n.profileEnd(s,X.c.UserConsentScenario,W.a.reactInvokeFlowConsentEnd,X.d.End,Object(z.y)(e),e,i),this.setFormState(L.a.Consenting),this.setIsConsenting(!1),this.setErrorMessage(e,"consent_invokeFlowStore.ts")})},this.loadAwaitRun=()=>{this.setFormState(L.a.AwaitingRun)},this.loadReviewConnections=()=>{this.setStateAndLoadConnections({state:L.a.ReviewingConnections,eventStartName:W.a.reactInvokeFlowLoadReviewConnectionsStart,eventEndName:W.a.reactInvokeFlowLoadReviewConnectionsEnd})},this.loadSignInConnections=()=>{this.setStateAndLoadConnections({state:L.a.SigningInConnections,eventStartName:W.a.reactInvokeFlowLoadSignInConnectionsStart,eventEndName:W.a.reactInvokeFlowLoadSignInConnectionsEnd})},this.loadTestConnections=()=>{this.setStateAndLoadConnections({state:L.a.TestingConnections,eventStartName:W.a.reactInvokeFlowLoadTestConnectionsStart,eventEndName:W.a.reactInvokeFlowLoadTestConnectionsEnd,fallbackState:L.a.SigningInConnections})},this.setStateAndLoadConnections=e=>{var{state:t,eventStartName:r,eventEndName:n,fallbackState:o}=e,{clientResources:i,loggingService:a}=this.props,c={flowName:this.flowName,fallbackState:o,state:t},s=a.profileStart(r,c);this.loadConnections().then(()=>{a.profileEndWithSuccess(s,n,c)}).catch(e=>{this.setErrorMessage(i.InvokeFlowForm.ErrorMessage.FailedToLoadConnections,"setStateAndLoadConnections_invokeFlowStore.ts"),a.profileEnd(s,n,Object(z.y)(e),e,c),o&&this.setFormState(o)}),this.setFormState(t)},this.forceRefreshConnections=()=>this.loadConnections(!0).catch(e=>{}),this.addConnectionsToStore=e=>{var{widgetUtilService:t,connectionService:r,environmentStore:{currentEnvironmentName:n}}=this.props,o=t.isRuntimeWidget()?V.a.getCollectionType({environmentName:n,flowName:this.flowName,connectionsByReferenceApi:!0}):V.a.getCollectionType({environmentName:n});r.addConnectionsToStore({connections:e,collectionType:o})},this.loadConnections=e=>{var{widgetUtilService:t,connectionService:r,loggingService:n}=this.props,o=t.isRuntimeWidget()?W.a.reactInvokeFlowWidgetConnectionsLoadStart:W.a.reactInvokeFlowConnectionsLoadStart,i=t.isRuntimeWidget()?W.a.reactInvokeFlowWidgetConnectionsLoadEnd:W.a.reactInvokeFlowConnectionsLoadEnd,a={flowName:this.flowName,forceRefresh:e},c=n.profileStart(o,a);return this.setIsLoadingConnections(!0),(()=>t.isRuntimeWidget()?r.getConnectionsByFlowConnectionReferenceApis({flowName:this.flowName,forceRefresh:e}):r.getConnections({forceRefresh:e}))().then(()=>{n.profileEndWithSuccess(c,i,a),this.setIsLoadingConnections(!1)}).catch(e=>{throw n.profileEnd(c,i,Object(z.y)(e),e,a),this.setIsLoadingConnections(!1),e})},this.setFormState(L.a.Loading)}var t,r,n;return t=e,(r=[{key:"isFlowRunning",get:function(){return this.formState===L.a.RunStarted}},{key:"flowEntity",get:function(){var{flowStore:e,loggingService:t}=this.props,r=!!this.flowName&&(this.isVersioningEnabled?e.publishedFlows.getEntity(this.flowName):e.flows.getEntity(this.flowName))||void 0;return r||t.logWarning("invokeFlowStore.flowEntity","FlowEntity with flowName '".concat(this.flowName,"' was not found in store. IsVersioningEnabled: ").concat(this.isVersioningEnabled)),r}},{key:"areInputParametersLoaded",get:function(){return void 0!==this.flowEntity&&!(this.flowEntity.containsLocationParametersInSchema&&!this.location)&&void 0!==this.inputParameters}},{key:"areInputParametersValid",get:function(){return!(!this.inputParameters||!this.areInputParametersLoaded)&&(Object.keys(this.inputParameters).length<1||Object.values(this.inputParameters).every(e=>!e.fieldState.hasError))}},{key:"footerButtons",get:function(){var{clientResources:e}=this.props,t={allowDisabledFocus:!0,text:e.Dialogs.RunFlow.Button.Cancel,onClick:this.handleCancelClicked,ariaLabel:e.Dialogs.RunFlow.Button.Cancel};switch(this.formState){case L.a.Consenting:return[{allowDisabledFocus:!0,text:this.isConsenting?e.UserConsent.Consenting:e.UserConsent.Continue,primary:!0,disabled:this.isConsenting,onClick:this.consent,ariaLabel:this.isConsenting?e.UserConsent.Consenting:e.UserConsent.Continue},t];case L.a.Loading:return[{allowDisabledFocus:!0,text:e.InvokeFlowForm.ButtonText.Loading,primary:!0,disabled:!0,onClick:void 0,autoFocus:!0,ariaLabel:e.InvokeFlowForm.ButtonText.Loading},t];case L.a.SigningInConnections:return[{allowDisabledFocus:!0,text:e.InvokeFlowForm.ButtonText.SignIn,primary:!0,disabled:!this.isContinueSignInButtonEnabled,onClick:this.handleContinueSignInClicked,ariaLabel:e.InvokeFlowForm.ButtonText.SignIn},t];case L.a.RunCompleted:return[{allowDisabledFocus:!0,text:e.Dialogs.RunFlow.Button.Done,primary:!0,onClick:this.handleDoneClicked,ariaLabel:e.Dialogs.RunFlow.Button.Done}];case L.a.ReviewingConnections:return[{allowDisabledFocus:!0,text:e.InvokeFlowForm.ButtonText.Back,primary:!0,disabled:!this.isBackButtonEnabled,onClick:this.handleBackClicked,ariaLabel:e.InvokeFlowForm.ButtonText.Back}];case L.a.TestingConnections:return[{allowDisabledFocus:!0,text:e.InvokeFlowForm.ButtonText.TestingConnections,primary:!0,disabled:!0,onClick:void 0,ariaLabel:e.InvokeFlowForm.ButtonText.TestingConnections},t];case L.a.AwaitingRun:default:return[{allowDisabledFocus:!0,text:this.runFlowButtonText,primary:!0,disabled:!this.isRunButtonEnabled,onClick:this.handleRunClicked,ariaLabel:this.runFlowButtonText},t]}}},{key:"runFlowButtonText",get:function(){var{clientResources:e,widgetUtilService:t}=this.props;return t.isWidgetPage()&&t.widgetStrings&&t.widgetStrings[U.b.INVOKE_FLOW_RUN_FLOW_BUTTON]||e.Dialogs.RunFlow.Button.RunFlow}},{key:"isRunButtonEnabled",get:function(){return!this.isFlowRunning&&this.areInputParametersValid&&!this.hasNonRecoverableError}},{key:"isContinueSignInButtonEnabled",get:function(){return this.connectionWizardState===M.a.ready}},{key:"isBackButtonEnabled",get:function(){return 0===Object.keys(this.connectionWizardConnectionReferences).length||this.connectionWizardState===M.a.ready||!this.connectionConfirmationCallback}},{key:"connectionWizardConnectionReferences",get:function(){var e=this.flowEntity&&this.flowEntity.invokerConnectionReferences||{};return Object.keys(e).map(t=>this.selectedConnectionReferences&&this.selectedConnectionReferences[t]?{[t]:this.selectedConnectionReferences[t]}:this.flowEntity.installedConnectionReferences&&this.flowEntity.installedConnectionReferences[t]?{[t]:this.flowEntity.installedConnectionReferences[t]}:{[t]:e[t]}).reduce((e,t)=>te(te({},e),t),{})}},{key:"availableConnections",get:function(){var{widgetUtilService:e,connectionStore:t,environmentStore:{currentEnvironmentName:r}}=this.props;if(e.isRuntimeWidget()&&!this.flowName)return[];var n=e.isRuntimeWidget()?V.a.getCollectionType({environmentName:r,flowName:this.flowName,connectionsByReferenceApi:!0}):V.a.getCollectionType({environmentName:r}),o=t.connections.getCollection(n);return(o&&o.list||[]).map(e=>t.connections.getEntity(e).toJS())}},{key:"baseProfileData",get:function(){var{widgetUtilService:e}=this.props;return{flowName:this.flowName,flowUserType:this.flowEntity.userType,triggerName:this.flowEntity.triggerName,flowTriggerUri:this.flowEntity.triggerUri,isMini:e.isMiniWidget()}}}])&&oe(t.prototype,r),n&&oe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"errorMessage",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=ae(n.prototype,"formState",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=ae(n.prototype,"flowName",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=ae(n.prototype,"isVersioningEnabled",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=ae(n.prototype,"enableDetermineLicenseBasedOnContext",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=ae(n.prototype,"connectionConfirmationCallback",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=ae(n.prototype,"inputParameters",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=ae(n.prototype,"isFlowDescriptionExpanded",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=ae(n.prototype,"isLoadingConnections",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=ae(n.prototype,"isConsenting",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=ae(n.prototype,"connectionWizardState",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=ae(n.prototype,"selectedConnectionReferences",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=ae(n.prototype,"location",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=ae(n.prototype,"hasNonRecoverableError",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=ae(n.prototype,"licenseCategorization",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae(n.prototype,"isFlowRunning",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"isFlowRunning"),n.prototype),ae(n.prototype,"flowEntity",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"flowEntity"),n.prototype),ae(n.prototype,"areInputParametersLoaded",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"areInputParametersLoaded"),n.prototype),ae(n.prototype,"areInputParametersValid",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"areInputParametersValid"),n.prototype),ae(n.prototype,"footerButtons",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"footerButtons"),n.prototype),ae(n.prototype,"runFlowButtonText",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"runFlowButtonText"),n.prototype),ae(n.prototype,"isRunButtonEnabled",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"isRunButtonEnabled"),n.prototype),ae(n.prototype,"isContinueSignInButtonEnabled",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"isContinueSignInButtonEnabled"),n.prototype),ae(n.prototype,"isBackButtonEnabled",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"isBackButtonEnabled"),n.prototype),ae(n.prototype,"connectionWizardConnectionReferences",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"connectionWizardConnectionReferences"),n.prototype),ae(n.prototype,"availableConnections",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"availableConnections"),n.prototype),g=ae(n.prototype,"setFormState",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r&&(e.connectionConfirmationCallback=void 0),e.connectionWizardState=void 0,e.previousFormState=e.formState,e.formState=t}}}),O=ae(n.prototype,"setErrorMessage",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var{clientResources:r,loggingService:n}=this.props;n.logWarning("invokeFlowStore.setErrorMessage","ErrorCode: ".concat(t," Error: ").concat(e)),this.errorMessage=Object(z.db)(e,r.Common.SomethingWentWrong)}}}),w=ae(n.prototype,"setNonRecoverableErrorMessage",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.hasNonRecoverableError=!0,this.setErrorMessage(e,t)}}}),E=ae(n.prototype,"clearErrorMessage",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hasNonRecoverableError||(this.errorMessage=void 0)}}}),C=ae(n.prototype,"setSelectedConnectionReferences",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedConnectionReferences=e}}}),S=ae(n.prototype,"handleConnectionWizardStateChange",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{clientResources:t,loggingService:r}=this.props;this.connectionWizardState=e,this.clearErrorMessage(),e===M.a.failed&&(r.logWarning("invokeFlowStore.fixConnectionMessageDisplayed","Displaying message asking user to fix connections."),this.setErrorMessage(t.InvokeFlowForm.ErrorMessage.FixConnections,"handleConnectionWizardStateChange_invokeFlowStore.ts")),e===M.a.ready&&this.formState===L.a.TestingConnections&&this.setFormState(L.a.AwaitingRun),e===M.a.failed&&this.formState===L.a.TestingConnections&&this.setFormState(L.a.SigningInConnections,!1)}}}),P=ae(n.prototype,"registerConnectionConfirmationCallback",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.connectionConfirmationCallback=e}}}),j=ae(n.prototype,"initialize",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var{userDetailsStore:r,widgetUtilService:n,autoConsentUser:o,sessionStore:i,scenarioLoggingService:a}=this.props;if(this.flowName=e,this.isVersioningEnabled=t,this.enableDetermineLicenseBasedOnContext=Object(J.a)(),!e)return Promise.resolve();if(!r.isConsented||Object(K.c)(r,i)){var c={detectionSource:"invokeFlowStore",consentSource:"invokeFlowStore",unconsentedMode:Object(q.a)().enableUnconsentedMode};if(a.tagEvent(X.c.UserConsentScenario,B.c.UserConsentRequired,X.d.Start,null,c),!n.isWidgetPage()){c=te(te({},c),{},{flowName:e});var s=new z.a(z.c.invokeFlowUserNotConsented,"User must be consented if we are not in a widget page");a.logError(X.c.UserConsentScenario,"invokeFlowStore.initialize",X.d.Other,s,c)}return o?(a.logInfo(X.c.UserConsentScenario,"invokeFlowStore.initialize",X.d.Other,"Auto consenting user."),this.consent()):(a.logInfo(X.c.UserConsentScenario,"invokeFlowStore.initialize",X.d.Other,"Auto consent not enabled, prompting user to consent instead."),n.isWidgetPage()&&n.fireConsentPromptLoaded(),this.setFormState(L.a.Consenting),a.tagEvent(X.c.UserConsentScenario,B.c.UserConsentDialogueShown,X.d.Pause,null,{consentSource:"invokeFlowStore",unconsentedMode:Object(q.a)().enableUnconsentedMode}),Promise.resolve())}return this.initializeForConsentedUser()}}}),T=ae(n.prototype,"initializeForConsentedUser",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{widgetUtilService:e,flowRoleService:t,flowService:r,loggingService:n,licenseContext:o}=this.props;this.setFormState(L.a.Loading);var i=Object(q.a)().enableDelegatedAuthorizationWidgetErrorHandling&&e.isRuntimeWidget?Y.l:void 0;n.logInfo("InvokeFlowStore.initializeForConsentedUser","Invoke flow store for flowName ".concat(this.flowName," with versioning enabled: ").concat(this.isVersioningEnabled));var a=t.loadFlowRoles({flowName:this.flowName,flowRole:G.g.owners,parseAndCatchError:i}),c=this.loadLicenseCategorization(null!=o?o:Z.c.PowerAutomate);e.isRuntimeWidget()||this.forceRefreshConnections();var s=r.loadFlow(this.flowName,!0,void 0,void 0,!1,this.isVersioningEnabled).then(()=>{var t=this.flowEntity.containsInvokerConnectionReferences;return e.isRuntimeWidget()&&this.forceRefreshConnections(),this.flowEntity.isInstalled&&t?this.loadTestConnections():!this.flowEntity.isInstalled&&t?this.loadSignInConnections():this.flowEntity.isInstalled||t?this.setFormState(L.a.AwaitingRun):(this.installFlow({}),e.shouldWaitAfterInstallingFlow()||this.setFormState(L.a.AwaitingRun)),this.flowEntity.containsLocationParametersInSchema?this.getLocation():void 0}).then(this.initializeInputParameters).catch(e=>{this.setNonRecoverableErrorMessage(e,"initializeForConsentedUser_invokeFlowStore.ts")});return Promise.all([a,s,c]).then(()=>Promise.resolve())}}}),k=ae(n.prototype,"setLicenseCategorization",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.licenseCategorization=e}}}),R=ae(n.prototype,"onFlowDescriptionExpandToggled",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isFlowDescriptionExpanded=e}}}),x=ae(n.prototype,"runFlow",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t,{implicitData:r}=e,{isTestRun:n,entityData:o,onFlowRunRequestComplete:i,onFlowRunRequestStart:a,onFlowRunRequestError:c,clientResources:s,flowRunsService:l,invokeFlowService:u,loggingService:p,widgetUtilService:f,licenseContext:d}=this.props;a&&a();var m=u.getRequestBody({flowEntity:this.flowEntity,inputParameters:this.inputParameters,entityData:r||o});this.setFormState(L.a.RunStarted);var b={[Q.z.licenseContext]:null!=d?d:Z.c.PowerAutomate,[Q.z.licenseCategorization]:null!==(t=this.licenseCategorization)&&void 0!==t?t:Z.b.NotSpecified},y={flowName:this.flowName,runData:m,isTestRun:n,flowRunHeaders:this.enableDetermineLicenseBasedOnContext?b:void 0},v=te(te({},this.baseProfileData),{},{isTestRun:n}),h=p.profileStart(n?W.a.invokeFlowRequestAsTestStart:W.a.invokeFlowRequestStart,v),g=n?W.a.invokeFlowRequestAsTestEnd:W.a.invokeFlowRequestEnd;return this.didInstallFail&&this.installFlow({throwOnException:!0}),(this.installFlowPromise||Promise.resolve()).then(()=>{if(!this.flowEntity.properties.flowTriggerUri)throw new z.a(z.c.flowTriggerUriMissing,Object(H.a)(s.RunFlow.FlowTriggerUriMissing,this.flowEntity.properties.displayName),null,this.baseProfileData);return l.submitRun(y)}).then(e=>{i&&i(this.flowEntity.toJS(),e),f.isWidgetPage()&&f.widgetCloseOnFlowRunEnabled()?f.fireWidgetCloseEvent():this.setFormState(L.a.RunCompleted),p.profileEndWithSuccess(h,g,v)}).catch(e=>{c&&c(e),p.profileEnd(h,g,Object(z.y)(e),e,v);var t=Object(z.db)(e,s.InvokeFlowForm.ErrorMessage.RunFlowFailed);Object(z.P)(e)&&(t=s.InvokeFlowForm.ErrorMessage.FileContentTooLarge),this.setErrorMessage(t,"runFlow_invokeFlowStore.ts"),this.setFormState(L.a.AwaitingRun)})}}}),ae(n.prototype,"baseProfileData",[I.computed],Object.getOwnPropertyDescriptor(n.prototype,"baseProfileData"),n.prototype),N=ae(n.prototype,"initializeInputParameters",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{clientResources:t,invokeFlowService:r}=this.props;this.location=e,this.inputParameters=r.getInputParametersForFlow({flowEntity:this.flowEntity,location:this.location,clientResources:t})}}}),_=ae(n.prototype,"setIsLoadingConnections",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isLoadingConnections=e}}}),D=ae(n.prototype,"setIsConsenting",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isConsenting=e}}}),n)},21057:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c}));var n=r(11809),o=r(11896),i=Object(o.a)({teamName:n.a.PowerAutomateClientTeam,owners:["paadminandlifecycle"],createdOn:"06/05/2025",description:"Enable license enforcement for license redesign ",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1613533",fallback:{enableDetermineLicenseBasedOnContext:!1,licenseCategorizationTimeoutMs:4e3}}),{getFeatureValue:a}=Object(o.b)(i,"enableDetermineLicenseBasedOnContext"),{getFeatureValue:c}=Object(o.b)(i,"licenseCategorizationTimeoutMs")},21058:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n,o,i=r(12706),a=r(11766),c=r(21059),s=r(14337),l=r(21052),u=r(21060),p=r(21062),f=r(14972),d=r(11773),m=r(13152),b=r(14893);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C,S,P,j,T,k,R={[l.a.RunCompleted]:null,[l.a.TestingConnections]:null,[l.a.Consenting]:p.a,[l.a.ReviewingConnections]:null,[l.a.AwaitingRun]:u.a,[l.a.RunStarted]:null,[l.a.SigningInConnections]:null,[l.a.Loading]:null},x=Object(s.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(s,e);var t,r,n,o=O(s);function s(){var e;y(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(i.a)(),e}return t=s,(r=[{key:"render",value:function(){var{invokeFlowStore:e,surfaceType:t}=this.props,r=this.getClassNames(Object(c.a)(this.props)),n=R[e.formState],o=t===m.a.Modal||t===m.a.FullPageModal;return a.createElement(a.Fragment,null,n&&a.createElement("div",{className:r.root},a.createElement(n,this.props)),a.createElement("div",{className:r.buttonContainer},a.createElement(f.a,{buttons:e.footerButtons,autoFocusFirstButton:this.autoFocusFirstButton,isRightAligned:o})))}},{key:"autoFocusFirstButton",get:function(){var{invokeFlowStore:e}=this.props;return e.formState!==l.a.AwaitingRun||e.previousFormState!==l.a.ReviewingConnections&&Object(b.a)(e.inputParameters)}}])&&v(t.prototype,r),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(a.Component),C=o.prototype,S="autoFocusFirstButton",P=[d.computed],j=Object.getOwnPropertyDescriptor(o.prototype,"autoFocusFirstButton"),T=o.prototype,k={},Object.keys(j).forEach((function(e){k[e]=j[e]})),k.enumerable=!!k.enumerable,k.configurable=!!k.configurable,("value"in k||k.initializer)&&(k.writable=!0),k=P.slice().reverse().reduce((function(e,t){return t(C,S,e)||e}),k),T&&void 0!==k.initializer&&(k.value=k.initializer?k.initializer.call(T):void 0,k.initializer=void 0),void 0===k.initializer&&(Object.defineProperty(C,S,k),k=null),n=o))||n},21059:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(13152),o=e=>{var{surfaceType:t}=e;return{root:["fl-InvokeFlowFooter",{paddingBottom:32,selectors:{":empty":{padding:0}}}],buttonContainer:["fl-InvokeFlowFooter-buttonContainer",t===n.a.FullPageModal||t===n.a.Modal?{display:"flex",justifyContent:"flex-end"}:{}]}}},21060:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n,o,i=r(12706),a=r(12804),c=r(11766),s=r(21061),l=r(14337),u=r(14346),p=r(11773),f=r(21052),d=r(18935),m=r(13031),b=r(14867);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var j=Object(l.c)((E((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(l,e);var t,r,n,o=g(l);function l(){var e;y(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=o.call(this,...r)).getClassNames=Object(i.a)(),e.root=c.createRef(),e}return t=l,(r=[{key:"render",value:function(){var e,{clientResources:t,invokeFlowStore:{loadReviewConnections:r}}=this.props;if(0===((null===(e=this.flowEntity)||void 0===e?void 0:e.uniqueActionDisplayNames)||[]).length)return null;var n=this.getClassNames(s.a);return c.createElement("div",{className:n.root,ref:this.root},c.createElement("p",{className:n.text},this.actionsText),c.createElement(u.a,{className:n.link,onClick:r},t.InvokeFlowForm.ReviewConnectionAndActions.Link))}},{key:"componentDidMount",value:function(){var{invokeFlowStore:e}=this.props;this.root.current&&e.previousFormState===f.a.ReviewingConnections&&Object(a.c)(this.root.current)}},{key:"actionsText",get:function(){var e,{clientResources:t}=this.props,r=(null===(e=this.flowEntity)||void 0===e?void 0:e.uniqueActionDisplayNames)||[];if(0===r.length)return null;var n=!!this.flowEntity&&Object(b.v)(this.flowEntity);return 1===r.length?Object(m.a)(n?t.InvokeFlowForm.ReviewConnectionAndActions.SingleActionTextWithAccountUsedForDataverseConnector:t.InvokeFlowForm.ReviewConnectionAndActions.SingleActionText,r[0]):Object(m.a)(n?t.InvokeFlowForm.ReviewConnectionAndActions.MultiActionTextWithAccountUsedForDataverseConnector:t.InvokeFlowForm.ReviewConnectionAndActions.MultiActionText,r.slice(0,-1).join(", "),r[r.length-1])}},{key:"flowEntity",get:function(){var e,{flowStore:t,invokeFlowStore:{flowName:r}}=this.props;return!!r&&(null!==(e=t.publishedFlows.getEntity(r))&&void 0!==e?e:t.flows.getEntity(r))||void 0}}])&&v(t.prototype,r),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(c.Component)).prototype,"actionsText",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"actionsText"),o.prototype),E(o.prototype,"flowEntity",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"flowEntity"),o.prototype),n=o))||n,T=Object(d.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({clientResources:e.clientResources,flowStore:e.flowStore},t))(j)},21061:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=e=>{var t=Object(n.Y)().palette;return{root:["fl-InvokeFlowAwaitingRunFooter",{}],text:["fl-InvokeFlowAwaitingRunFooter-Text",{padding:0,fontSize:n.k.medium,color:t.neutralPrimary,lineHeight:"normal"}],link:["fl-InvokeFlowAwaitingRunFooter-Link",{padding:0,fontSize:n.k.medium,lineHeight:"normal",selectors:{"&.fl-Link":{color:t.themePrimary,textDecoration:"underline"}}}]}}},21062:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(11766),o=r(17442),i=r(18935);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,r,i,u=l(p);function p(){return a(this,p),u.apply(this,arguments)}return t=p,(r=[{key:"render",value:function(){var{appSettings:e,clientResources:t,consentService:r,sessionStore:i,userDetailsStore:a,telemetryService:c}=this.props;return n.createElement(o.a,{telemetryService:c,consentOnActionName:t.UserConsent.Continue,consentService:r,consentServiceResources:t,appSettings:e,sessionStore:i,userDetailsStore:a})}}])&&c(t.prototype,r),i&&c(t,i),Object.defineProperty(t,"prototype",{writable:!1}),p}(n.Component),y=Object(i.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({appSettings:e.appSettings,clientResources:e.clientResources,consentService:e.consentService,sessionStore:e.sessionStore,userDetailsStore:e.userDetailsStore,telemetryService:e.telemetryService},t))(b)},21063:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(12754),o=()=>{var e=Object(n.Y)();return{excelSdxFlowInvokeSurface:["fl-ExcelSDXFlowInvokeSurface",{".ba-Panel-headerText":{color:"".concat(e.palette.neutralPrimary," !important"),fontSize:"18px"},".ba-Panel-headerContainer":{backgroundColor:"".concat(e.palette.neutralLighter," !important")},".ms-Panel-footer":{backgroundColor:"".concat(e.palette.neutralLighter," !important")},".ms-CommandBarItem-link":{backgroundColor:e.palette.neutralLighter,":hover, :active":{backgroundColor:e.palette.neutralLighter}},".ms-DetailsRow":{backgroundColor:e.palette.neutralLighter,borderBottom:"none"}}]}}},21878:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(20798).a)}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/91.70f49f90.chunk.js.map