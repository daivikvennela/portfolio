/*! For license information please see 19.ad4e010d.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{14347:function(e,t,i){"use strict";var r=i(14348);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b})),i.d(t,"c",(function(){return r.c}))},20006:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.PowerAutomateClientTeam,owners:["flowpartnerembed","tialin"],description:"Enables NL2Flow widget feature",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1236570",createdOn:"02/28/2024",fallback:{isNL2FlowWidgetEnabled:!1}}),{getFeatureValue:a}=Object(n.b)(o,e=>!!e.isNL2FlowWidgetEnabled)},21965:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11766),n=i(15505),o={margin:"16px 0",border:"0",borderTop:"1px solid ".concat(n.o)},a=()=>r.createElement("hr",{style:o})},22264:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var r=i(11766),n=i(14918),o=i(14678),a=i(13260),s=i(15918),l=e=>{var{clientResources:t,startDateTime:i,endDateTime:o}=e,a=Object(n.z)(i,o,t);return r.createElement(u,{duration:a})};function c(e){var{durationInMs:t}=e,i=Object(s.a)().DateTime,o=Object(n.A)(t,i);return r.createElement(u,{duration:o})}function u(e){var{duration:t}=e;return r.createElement(a.b,{id:t,text:t,automationId:o.a.tooltips.runDurationTooltip},r.createElement("span",{"data-automation-id":o.a.texts.durationText},t))}},22268:function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return d}));var r=i(12811),n=i(12754),o=i(12728),a=i(11766),s=i(13260);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var c=function(e){return e.green="rgba(186,216,10,0.2)",e.red="rgba(232,17,35,0.1)",e.yellow="rgba(255,244,206,1)",e.transparent="transparent",e}({}),u=Object(n.db)({root:{alignItems:"center",display:"flex",height:"100%",padding:"0 12px"},content:{overflow:"hidden",textOverflow:"ellipsis"},tooltipHost:{width:"100%",height:"100%"}}),d=e=>{var t={backgroundColor:e.backgroundColor,width:e.width},i=Object(o.a)("fl-StatusInCell-tooltip");return a.createElement(s.b,{id:i,text:e.title,styles:{root:u.tooltipHost},automationId:e.tooltipAutomationId},a.createElement("div",l({className:Object(r.a)("fl-StatusInCell",u.root),style:t,"data-automation-id":e.automationId},e.customAttributes),a.createElement("div",{className:u.content},e.children)))}},22602:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,"a",(function(){return o}));var o=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.loggingService=i,this.storage=void 0,this.inMemoryStorage=void 0;try{this.storage=r||sessionStorage}catch(n){this.loggingService.logWarning("SafeSyncSessionStorage","Failed to initialize sessionStorage",n)}this.inMemoryStorage={}}var t,i,n;return t=e,(i=[{key:"getItem",value:function(e){var t;try{var i=this.getStoredItem(this.getStorageKey(e));i&&(t=JSON.parse(i))}catch(r){this.loggingService.logWarning("SafeSyncSessionStorage-getItem","Failed to parse localStorage content",r)}return t}},{key:"setItem",value:function(e,t){var i=this.getStorageKey(e);try{var r=JSON.stringify(t);try{this.storage.setItem(i,r)}catch(n){this.inMemoryStorage[i]=r}}catch(o){}}},{key:"getStorageKey",value:function(e){return"".concat(this.name,"-").concat(e)}},{key:"getStoredItem",value:function(e){try{return this.storage.getItem(e)}catch(t){return this.inMemoryStorage[e]}}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22769:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11766),n=i(22268),o=i(13154),a=e=>r.createElement(n.a,{title:e.tooltip,backgroundColor:s(e.status),width:e.width},e.children);function s(e){switch(e){case o.u.succeeded:return n.b.green;case o.u.failed:case o.u.cancelled:case o.u.cancelling:return n.b.red;default:return n.b.transparent}}},22770:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var r=function(e){return e.status="status",e.startTime="startTime",e.index="index",e.inputVariable="inputVariable",e.outputVariable="outputVariable",e.logMessage="logMessage",e.duration="duration",e.actionIndex="actionIndex",e.action="action",e.subflow="subflow",e.addColumn="addColumn",e.logLevel="logLevel",e}({}),n=function(e){return e[e.commonMin=100]="commonMin",e[e.commonMax=400]="commonMax",e[e.mediumMin=150]="mediumMin",e[e.mediumMax=300]="mediumMax",e[e.smallMin=55]="smallMin",e[e.smallMax=200]="smallMax",e[e.verySmallMin=30]="verySmallMin",e[e.verySmallMax=100]="verySmallMax",e}({})},22784:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r={learnMore:{automationPanelPresentation:2157212,customConnectorDescription:2157410,forbidden:2150279}}},22925:function(e,t,i){"use strict";var r=i(22926);i.d(t,"a",(function(){return r.a}));i(22937)},22926:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(11766),n=i(12720),o=i(22927),a=i(22936),s=Object(n.a)(o.a,a.a),l=r.memo(s)},22927:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(11766),n=i(22931),o=i(12706),a=i(22928);function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){c(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function c(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u=Object(o.a)(),d=e=>{var{ariaLevel:t,title:i,collapsed:o,indentation:s,children:c,styles:d,className:p,theme:h,roleAsButton:m,onCollapsed:g}=e,{titleProps:f}=e,{titleAs:v=a.a}=e,[b,y]=r.useState(null!=o&&o);r.useEffect(()=>null==g?void 0:g(b),[b]);var w=u(d,{className:p,theme:h});return r.createElement(n.a,{collapsed:b,indent:s,styles:w,title:l(l(l({contentEditable:!1,styles:w.subComponentStyles.title,role:m?void 0:"heading","aria-expanded":!b},m?{}:{role:"heading","aria-level":t||3}),f),{},{onClick:e=>{var t;y(e=>!e),null==f||null===(t=f.onClick)||void 0===t||t.call(f,e)},text:l(l({},null!=f&&f.text&&"object"==typeof f.text?f.text:{}),{},{children:i})}),slots:{title:{component:v}}},b?null:c)}},22936:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=e=>({root:{background:e.theme.semanticColors.bodyBackground,boxShadow:e.theme.effects.elevation4,borderRadius:2,marginLeft:1,marginRight:1,selectors:{"ul, ol":{marginTop:0,marginBottom:0}}},body:{paddingTop:12,paddingRight:16,paddingBottom:12,paddingLeft:16},subComponentStyles:{title:{root:{background:e.theme.semanticColors.bodyBackground,cursor:"pointer",minHeight:44,height:"auto",paddingLeft:16,paddingTop:8,paddingBottom:8},chevron:{fontSize:10,fontWeight:"500",color:e.theme.palette.neutralPrimary},text:{fontSize:14,fontWeight:"500",textAlign:"start",color:e.theme.palette.neutralPrimary}}}})},22937:function(e,t,i){},29086:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(11766),n=i.n(r),o=i(12754);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=p(e);if(t){var n=p(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return d(this,i)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,i,r,l=u(d);function d(){var e;a(this,d);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=l.call(this,...i)).labelColor="#107c10",e.styles=Object(o.db)({premiumLabelContainer:{margin:"7px 0px",textTransform:"uppercase","a:hover &":{textDecoration:"none"}},premiumLabel:{backgroundColor:"white",color:e.labelColor,border:"1px solid ".concat(e.labelColor),fontSize:o.k.xSmall,padding:"3px 6px"}}),e}return t=d,(i=[{key:"render",value:function(){return n.a.createElement("div",{className:this.styles.premiumLabelContainer},n.a.createElement("span",{className:this.styles.premiumLabel},this.props.premiumText))}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(n.a.Component)},31420:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=new RegExp(/^(?:\s|\w+script|data)/,"i");function n(e){return!!e&&!r.test(e)}},31433:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(31434),n=i(12339),o=i(12999);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(){return s(s({featureFlags:s({},Object(o.a)())},Object(n.b)()),r.a)}},31434:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(12059),n=Object(r.d)({packageName:"powerautomate-angularjs",settings:{flowTestingPollInterval:{description:"Gets or sets the polling interval when waiting for a new flow run.",values:{default:5e3}},flowTestingPollTimeout:{description:"Gets or sets a value indicating the maximum amount of time to wait for a new flow run.",values:{default:6e5}},flowTestingPollRetryCount:{description:"Gets or sets a value indicating the number of times to retry when refreshing the list of flow runs fails.",values:{default:3}},flowTestingPollRetryDelay:{description:"Gets or sets a value indicating the delay between poll retries.",values:{default:2e3}}}})},33278:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return v}));var r=i(33279),n=i(11766),o=i(22327),a=(i(33281),i(33286),i(33288),i(33290),i(33325),i(33326)),s=i(33327),l=i(34226),c=i(31433);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=f(e);if(t){var n=f(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return g(this,i)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(f,e);var t,i,p,g=m(f);function f(){var e;u(this,f);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=g.call(this,...i))._container=void 0,e._angularApp=void 0,e}return t=f,(i=[{key:"componentDidMount",value:function(){a.a.constant(s.a.services.logging,this.props.loggingService),a.a.constant(s.a.services.telemetry,this.props.telemetryService),a.a.constant(s.a.services.token,this.props.tokenService),a.a.constant(s.a.services.widgetUtilService,this.props.widgetUtilService),a.a.constant(s.a.services.assetService,this.props.assetService),a.a.constant(s.a.services.routeCrafter,this.props.routeCrafter),a.a.constant(s.a.services.universalSearchService,this.props.universalSearchService),a.a.constant(s.a.services.cdnService,this.props.cdnService),a.a.constant(s.a.services.reactNavigation,this.props.navigationService),a.a.constant(s.a.services.hostCommunicationService,this.props.hostCommunicationService),a.a.constant(s.a.services.markdownService,this.props.markdownService),a.a.constant(s.a.services.policy,this.props.policyService),a.a.constant(s.a.services.storage,this.props.storageService),a.a.constant(s.a.services.flowRoleService,this.props.flowRoleService),a.a.constant(s.a.services.designerDocumentationLinkService,this.props.designerDocumentationLinkService),a.a.constant(s.a.services.analytics,this.props.analyticsService),a.a.constant(s.a.services.gateway,this.props.gatewayService),a.a.constant(s.a.services.xrmMachineManagement,this.props.xrmMachineManagementService),a.a.constant(s.a.services.rpaLocal,this.props.rpaLocalService),a.a.constant(s.a.services.doNotShowAgain,this.props.doNotShowAgainService),a.a.constant(s.a.services.flow,this.props.flowService),a.a.constant(s.a.services.graphService,this.props.graphService),a.a.constant(s.a.services.codeSnippet,this.props.codeSnippetService),a.a.constant(s.a.services.environmentCapability,this.props.environmentCapabilityService),a.a.constant(s.a.services.environmentService,this.props.environmentService),a.a.constant(s.a.services.flowRunInputsOutputs,this.props.flowRunInputsOutputsService),a.a.constant(s.a.services.uiFlow,this.props.uiFlowService),a.a.constant(s.a.services.uiFlowRunService,this.props.uiFlowRunService),a.a.constant(s.a.services.uiFlowRunStore,this.props.uiFlowRunStore),a.a.constant(s.a.services.apiOperation,this.props.apiOperationService),a.a.constant(s.a.services.designerOperations,this.props.designerOperationsService),a.a.constant(s.a.services.connection,this.props.connectionService),a.a.constant(s.a.services.licenseManagement,this.props.licenseManagementService),a.a.constant(s.a.services.neptuneService,this.props.neptuneService),a.a.constant(s.a.services.neptuneHttpClient,this.props.neptuneHttpClient),a.a.constant(s.a.services.azureResourceGraphHttpClient,this.props.azureResourceGraphHttpClient),a.a.constant(s.a.services.oAuthService,this.props.oAuthService),a.a.constant(s.a.services.designerUserPreference,this.props.designerUserPreferenceFactory),a.a.constant(s.a.services.desktopFlowStore,this.props.desktopFlowStore),a.a.constant(s.a.services.designerCoreLoader,new l.a(Object(c.a)(),this.props.loggingService,this.props.designerCoreLoaderFn));var e=this.props.flowServiceClientResources;a.a.constant(s.a.services.clientResources,e),a.a.constant(s.a.services.xrmEntityClient,this.props.xrmEntityHttpClient),a.a.constant(s.a.services.flowHttpClient,this.props.flowHttpClient),a.a.constant(s.a.services.flowRpHttpClient,this.props.flowRpHttpClient),a.a.constant(s.a.services.desktopFlowAIHttpClient,this.props.desktopFlowAIHttpClient),a.a.constant(s.a.services.desktopFlowRuntimeHttpClient,this.props.desktopFlowRuntimeHttpClient),a.a.constant(s.a.services.triggerService,this.props.triggerService),a.a.constant(s.a.services.xrmWorkflowClient,this.props.xrmWorkflowClient),a.a.constant(s.a.services.flowDraftClient,this.props.flowDraftClient),a.a.constant(s.a.services.presenceService,this.props.presenceService),a.a.constant(s.a.services.presenceStore,this.props.presenceStore),a.a.constant(s.a.services.flowUndoService,this.props.flowUndoService),a.a.constant(s.a.services.planService,this.props.planService),a.a.constant(s.a.services.xrmUserService,this.props.xrmUserService),a.a.constant(s.a.services.xrmConnectionReferenceService,this.props.xrmConnectionReferenceService),a.a.constant(s.a.services.xrmConnectionReferenceStore,this.props.xrmConnectionReferenceStore),a.a.constant(s.a.services.designerConnectionStore,this.props.designerConnectionStore),a.a.constant(s.a.services.xrmRecommendation,this.props.xrmRecommendation),a.a.constant(s.a.services.flowrunsService,this.props.flowRunsService),a.a.constant(s.a.services.businessAppPlatformService,this.props.businessAppPlatformService),a.a.constant(s.a.services.flowRoleStore,this.props.flowRoleStore),a.a.constant(s.a.services.planStore,this.props.planStore),a.a.constant(s.a.services.aiHostedModelsService,this.props.aiHostedModelsService),a.a.constant(s.a.services.solutionService,this.props.solutionService),a.a.constant(s.a.services.flowRunHistoryService,this.props.flowRunHistoryService),a.a.constant(s.a.services.flowRunsTriggerOutputsStore,this.props.flowRunsTriggerOutputsStore),a.a.constant(s.a.services.winAutomationService,this.props.winAutomationService),a.a.constant(s.a.services.consentService,this.props.consentService),a.a.constant(s.a.services.ppapiService,this.props.ppapiService),a.a.constant(s.a.services.flowSupportChecker,this.props.flowSupportChecker),a.a.constant(s.a.services.gptService,this.props.gptService),a.a.constant(s.a.services.userDetailsStore,this.props.userDetailsStore),a.a.constant(s.a.services.teamsDeepLinkService,this.props.teamsDeepLinkService),this._angularApp=r.bootstrap(this._container,[a.a.name]),this.props.widgetUtilService.isWidgetPage()&&this.props.widgetUtilService.fireWidgetReady()}},{key:"shouldComponentUpdate",value:function(e){return e.location!==this.props.location&&setTimeout(()=>{var e;null===(e=this._angularApp)||void 0===e||null===(e=e.get("$rootScope"))||void 0===e||e.$digest()},100),!1}},{key:"componentWillUnmount",value:function(){var e,t,i;this._angularApp&&(null!==(e=this._angularApp)&&void 0!==e&&null!==(e=e.get("$rootScope"))&&void 0!==e&&e.$$phase||null===(i=this._angularApp)||void 0===i||null===(i=i.get("$rootScope"))||void 0===i||i.$apply(),null===(t=this._angularApp.get("$rootScope"))||void 0===t||t.$destroy(),this._angularApp=void 0);Object(o.c)()}},{key:"render",value:function(){return n.createElement("div",{style:{flex:1,overflow:"auto",height:"100%",position:"relative"},ref:e=>this._container=e,dangerouslySetInnerHTML:{__html:"<div ng-strict-di><div ng-view></div><ng-commands></ng-commands></div>"},className:"ng-host-container",role:"main"})}}])&&d(t.prototype,i),p&&d(t,p),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},33281:function(e,t,i){var r=i(33282);"string"==typeof r&&(r=[[e.i,r,""]]);var n={hmr:!1,transform:void 0,insertInto:void 0};i(14234)(r,n);r.locals&&(e.exports=r.locals)},33282:function(e,t,i){t=e.exports=i(14233)(!1);var r=i(17307),n=i(33283),o=i(33284),a=i(33285),s=r(n),l=r(o),c=r(a);t.push([e.i,'@charset "UTF-8";\n/*! MWF - v1.6.0+643031 | Copyright 2016 Microsoft Corporation | This software is based on or incorporates material from the files listed below (collectively, "Third Party Code"). Microsoft is not the original author of the Third Party Code. The original copyright notice and the license under which Microsoft received Third Party Code are set forth below together with the full text of such license. Such notices and license are provided solely for your information. Microsoft, not the third party, licenses this Third Party Code to you under the terms in which you received the Microsoft software or the services, unless Microsoft clearly states that such Microsoft terms do NOT apply for a particular Third Party Code. Unless applicable law gives you more rights, Microsoft reserves all other rights not expressly granted under such agreement(s), whether by implication, estoppel or otherwise.*/\n/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;-webkit-box-sizing:content-box;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}@font-face{font-family:MWF-MDL2;src:url('+s+') format("woff"),url('+l+') format("truetype"),url('+c+') format("svg")}.c-heading-1,.h1,.type-h1,h1{font-size:62px;line-height:72px}.c-heading-2,.h2,.type-h2,h2{font-size:46px;line-height:56px}.c-heading-3,.c-subheading-1,.h3,.type-h3,.type-sh1,h3{font-size:34px;line-height:40px}.c-heading-4,.c-subheading-2,.h4,.type-h4,.type-sh2,h4{font-size:24px;line-height:28px}.c-heading-5,.c-paragraph-1,.c-subheading-3,.h5,.type-h5,.type-p1,.type-sh3,h5{font-size:20px;line-height:24px}.c-heading-6,.c-paragraph-2,.c-subheading-4,.h6,.type-h6,.type-p2,.type-sh4,h6{font-size:18px;line-height:24px}.c-paragraph-3,.c-paragraph-4,.c-subheading-5,.c-subheading-6,.type-p3,.type-p4,.type-sh5,.type-sh6,p{font-size:15px;line-height:20px}.c-caption-1,.type-c1{font-size:13px;line-height:16px}.c-caption-2,.type-c2{font-size:11px;line-height:16px}.c-heading-1,.h1,.type-h1,h1{padding:38px 0 6px;font-weight:100;letter-spacing:-.01em}.c-heading-2,.h2,.type-h2,h2{padding:37px 0 3px;font-weight:100;letter-spacing:-.01em}.c-heading-3,.h3,.type-h3,h3{padding:38px 0 2px;font-weight:100}.c-heading-4,.h4,.type-h4,h4{padding:36px 0 4px;font-weight:200}.c-heading-5,.h5,.type-h5,h5{padding:35px 0 5px;font-weight:200}.c-heading-6,.h6,.type-h6,h6{padding:37px 0 3px;font-weight:200}.c-subheading-1,.type-sh1{padding:2px 0;font-weight:100}.c-subheading-2,.type-sh2{padding:4px 0 8px;font-weight:200}.c-subheading-3,.type-sh3{padding:8px 0 4px;font-weight:200}.c-subheading-4,.type-sh4{padding:9px 0 3px;font-weight:200}.c-subheading-5,.c-subheading-6,.type-sh5,.type-sh6{padding:8px 0 0;font-weight:200}.c-paragraph-1,.type-p1{padding:24px 0 4px;font-weight:200}.c-paragraph-2,.type-p2{padding:25px 0 3px;font-weight:200}.c-paragraph-3,.c-paragraph-4,.type-p3,.type-p4,p{padding:24px 0 0;font-weight:400}.c-caption-1,.type-c1{padding:3px 0 1px;font-weight:400}.c-caption-2,.type-c2{padding:4px 0;font-weight:400}@media (max-width:767px){.c-heading-1,.h1,.type-h1,h1{font-size:46px;line-height:56px}.c-heading-2,.h2,.type-h2,h2{font-size:34px;line-height:40px}.c-heading-3,.c-subheading-1,.h3,.type-h3,.type-sh1,h3{font-size:26px;line-height:32px}.c-heading-4,.c-subheading-2,.h4,.type-h4,.type-sh2,h4{font-size:20px;line-height:24px}.c-heading-5,.c-paragraph-1,.c-subheading-3,.h5,.type-h5,.type-p1,.type-sh3,h5{font-size:18px;line-height:24px}.c-heading-6,.c-paragraph-2,.c-subheading-4,.h6,.type-h6,.type-p2,.type-sh4,h6{font-size:16px;line-height:20px}.c-caption-1,.type-c1{font-size:12px;line-height:16px}.c-caption-2,.type-c2{font-size:10px;line-height:12px}.c-heading-1,.h1,.type-h1,h1{padding:37px 0 3px}.c-heading-2,.h2,.type-h2,h2{padding:38px 0 2px}.c-heading-5,.h5,.type-h5,h5{padding:37px 0 3px}.c-heading-6,.h6,.type-h6,h6{padding:39px 0 1px}.c-subheading-1,.type-sh1{padding:9px 0 3px}.c-subheading-2,.type-sh2{padding:8px 0 4px}.c-subheading-3,.type-sh3{padding:4px 0}.c-subheading-4,.type-sh4{padding:7px 0 5px}.c-paragraph-2,.type-p2{padding:27px 0 1px}.c-caption-2,.type-c2{padding:2px 0}}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,:after,:before{-webkit-box-sizing:inherit;box-sizing:inherit}body{font-size:15px;font-family:SegoeUI,Helvetica Neue,Helvetica,Arial,sans-serif;min-width:320px;color:#000;background-color:#fff}.theme-light{color:#000;background-color:#e6e6e6}.theme-dark{color:#fff;background-color:#333}h1,h2,h3,h4,h5,h6,p{margin-top:0;margin-bottom:0}address{font:inherit}ol,ul{margin-top:0;margin-bottom:0;padding:0;list-style:none}dd,dl{margin:0}audio,canvas,img,video{vertical-align:middle}figure{margin:0}a:active,a:focus,a:hover,a:link,a:visited{text-decoration:none;color:inherit}em,i,q,var{font-style:italic}b,strong{font-weight:600}mark{background-color:#fff100;padding:1px 4px 2px}@media screen and (-ms-high-contrast:active){mark{outline:1px solid;color:inherit}}.theme-dark .theme-light del,.theme-dark .theme-light s,.theme-light del,.theme-light s,del,s{color:rgba(0,0,0,.6)}.theme-dark del,.theme-dark s,.theme-light .theme-dark del,.theme-light .theme-dark s{color:hsla(0,0%,100%,.6)}ins,u{text-decoration:none}.theme-dark .theme-light ins,.theme-dark .theme-light u,.theme-light ins,.theme-light u,ins,u{border-bottom:1px solid rgba(0,0,0,.6)}.theme-dark ins,.theme-dark u,.theme-light .theme-dark ins,.theme-light .theme-dark u{border-bottom:1px solid hsla(0,0%,100%,.6)}small,sub,sup{font-size:.8em}abbr,dfn{font-style:normal}.theme-dark .theme-light abbr,.theme-dark .theme-light dfn,.theme-light abbr,.theme-light dfn,abbr,dfn{border-bottom:1px dotted rgba(0,0,0,.6)}.theme-dark abbr,.theme-dark dfn,.theme-light .theme-dark abbr,.theme-light .theme-dark dfn{border-bottom:1px dotted hsla(0,0%,100%,.6)}cite,time{font-style:normal}code,kbd,pre,samp{font-family:Consolas,Courier New,Courier,monospace}kbd{border-radius:2px;padding:1px 4px 2px;background-color:rgba(0,0,0,.6);color:#fff}kbd kbd{padding:0}.theme-dark .theme-light kbd,.theme-light kbd{background-color:rgba(0,0,0,.6);color:#fff}.theme-dark kbd,.theme-light .theme-dark kbd{background-color:hsla(0,0%,100%,.6);color:#000}bdo{direction:rtl}input,input[type=search]{border-radius:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}[data-grid~=container]{max-width:1600px;max-width:calc(1600px + 10%);margin:0 auto;padding-left:5%;padding-right:5%}@media screen and (max-width:1083px){[data-grid~=container]{padding-left:0;padding-right:0}}[data-grid*=col-],[data-grid~=container]{-webkit-box-sizing:border-box;box-sizing:border-box;zoom:1}[data-grid*=col-]:after,[data-grid*=col-]:before,[data-grid~=container]:after,[data-grid~=container]:before{content:" ";display:table}[data-grid*=col-]:after,[data-grid~=container]:after{clear:both}[data-grid*=col-]{float:left;min-height:1px}[data-grid~=pad-12x]>[data-grid]{padding-left:18px;padding-right:18px}@media screen and (max-width:1778px){[data-grid~=pad-12x]>[data-grid]{padding-left:24px;padding-right:24px}}@media screen and (max-width:1083px){[data-grid~=pad-12x]>[data-grid]{padding-left:18px;padding-right:18px}}@media screen and (max-width:767px){[data-grid~=pad-12x]>[data-grid]{padding-left:12px;padding-right:12px}}@media screen and (max-width:539px){[data-grid~=pad-12x]>[data-grid]{padding-left:12px;padding-right:12px}}[data-grid~=pad-6x]>[data-grid]{padding-left:12px;padding-right:12px}[data-grid~=pad-3x]>[data-grid]{padding-left:6px;padding-right:6px}[data-grid~=pad-2x]>[data-grid]{padding-left:4px;padding-right:4px}[data-grid~=col-1]{width:8.3333333333%}[data-grid~=col-2]{width:16.6666666667%}[data-grid~=col-3]{width:25%}[data-grid~=col-4]{width:33.3333333333%}[data-grid~=col-5]{width:41.6666666667%}[data-grid~=col-6]{width:50%}[data-grid~=col-7]{width:58.3333333333%}[data-grid~=col-8]{width:66.6666666667%}[data-grid~=col-9]{width:75%}[data-grid~=col-10]{width:83.3333333333%}[data-grid~=col-11]{width:91.6666666667%}[data-grid~=col-12]{width:100%}[data-grid~=col-1-5]{width:20%}[data-grid~=col-1-8]{width:12.5%}@media screen and (max-width:1778px){[data-grid~=stack-5]>[data-grid]{float:none;width:100%;display:block;padding:inherit 0}}@media screen and (max-width:1399px){[data-grid~=stack-4]>[data-grid]{float:none;width:100%;display:block;padding:inherit 0}}@media screen and (max-width:1083px){[data-grid~=stack-3]>[data-grid]{float:none;width:100%;display:block;padding:inherit 0}}@media screen and (max-width:767px){[data-grid~=stack-2]>[data-grid]{float:none;width:100%;display:block;padding:inherit 0}}@media screen and (max-width:539px){[data-grid*=col-]{float:none;width:100%;display:block;padding:inherit 0}}@-webkit-keyframes fadeIn{0%{opacity:0}1%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}1%{opacity:0}to{opacity:1}}.x-clearfix:after,.x-clearfix:before{content:" ";display:table}.x-clearfix:after{clear:both}.x-float-left{float:left!important}.x-float-right{float:right!important}@media print{.x-visible-print-block{display:block!important}.x-visible-print-inline{display:inline!important}.x-visible-print-inline-block{display:inline-block!important}.x-hidden-print{display:none!important}}@media (max-width:539px){.x-visible-vp1-block{display:block!important}.x-visible-vp1-inline{display:inline!important}.x-visible-vp1-inline-block{display:inline-block!important}.x-hidden-vp1{display:none!important}}@media (min-width:540px) and (max-width:767px){.x-visible-vp2-block{display:block!important}.x-visible-vp2-inline{display:inline!important}.x-visible-vp2-inline-block{display:inline-block!important}.x-hidden-vp2{display:none!important}}@media (min-width:768px) and (max-width:1083px){.x-visible-vp3-block{display:block!important}.x-visible-vp3-inline{display:inline!important}.x-visible-vp3-inline-block{display:inline-block!important}.x-hidden-vp3{display:none!important}}@media (min-width:1084px) and (max-width:1399px){.x-visible-vp4-block{display:block!important}.x-visible-vp4-inline{display:inline!important}.x-visible-vp4-inline-block{display:inline-block!important}.x-hidden-vp4{display:none!important}}@media (min-width:1400px){.x-visible-vp5-block{display:block!important}.x-visible-vp5-inline{display:inline!important}.x-visible-vp5-inline-block{display:inline-block!important}.x-hidden-vp5{display:none!important}}.sr-only,.x-screen-reader{position:absolute!important;overflow:hidden!important;clip:rect(1px,1px,1px,1px)!important;width:1px!important;height:1px!important;border:none!important;padding:0!important;margin:0!important}.x-type-center{text-align:center!important}.x-type-right{text-align:right!important}.x-type-left{text-align:left!important}[class^=m-]{padding-left:12px;padding-right:12px;padding-top:48px}@media only screen and (min-width:540px){[class^=m-]{padding-left:24px;padding-right:24px}}@media only screen and (min-width:768px){[class^=m-]{padding-left:36px;padding-right:36px}}@media only screen and (min-width:1400px){[class^=m-]{padding-left:48px;padding-right:48px}}a.c-action-trigger,button.c-action-trigger{font-size:15px;max-width:374px;min-width:36px;display:inline-block;margin-top:12px;padding:6px 0 8px;color:#0078d7;border:1px solid transparent;background:none;overflow:hidden;white-space:nowrap;vertical-align:bottom;outline:1px dashed transparent}a.c-action-trigger:focus,a.c-action-trigger:hover,button.c-action-trigger:focus,button.c-action-trigger:hover{color:rgba(0,0,0,.6);text-decoration:underline}a.c-action-trigger:focus,button.c-action-trigger:focus{outline:1px dashed rgba(0,0,0,.6)}a.c-action-trigger:active,button.c-action-trigger:active{color:#000;outline:1px solid transparent;text-decoration:none}a.c-action-trigger[disabled],button.c-action-trigger[disabled]{color:rgba(0,0,0,.2);cursor:not-allowed}a.c-action-trigger.c-glyph,button.c-action-trigger.c-glyph{min-width:120px;padding-right:10px}a.c-action-trigger.c-glyph:before,button.c-action-trigger.c-glyph:before{width:16px;height:16px;margin-left:10px;margin-right:10px;vertical-align:middle}a.c-action-trigger.c-glyph.glyph-edit:before,button.c-action-trigger.c-glyph.glyph-edit:before{content:""}a.c-action-trigger.c-glyph.glyph-cancel:before,button.c-action-trigger.c-glyph.glyph-cancel:before{content:""}a.c-action-trigger.c-glyph.glyph-global-nav-button:before,button.c-action-trigger.c-glyph.glyph-global-nav-button:before{content:""}a.c-action-trigger.c-glyph.glyph-shopping-cart:before,button.c-action-trigger.c-glyph.glyph-shopping-cart:before{content:""}a.c-action-trigger.c-glyph.glyph-chevron-left:before,button.c-action-trigger.c-glyph.glyph-chevron-left:before{content:""}a.c-action-trigger.c-glyph.glyph-chevron-right:before,button.c-action-trigger.c-glyph.glyph-chevron-right:before{content:""}a.c-action-trigger.c-glyph.glyph-arrow-htmllegacy-mirrored:before,button.c-action-trigger.c-glyph.glyph-arrow-htmllegacy-mirrored:before{content:""}a.c-action-trigger.c-glyph.glyph-arrow-htmllegacy:before,button.c-action-trigger.c-glyph.glyph-arrow-htmllegacy:before{content:""}a.c-action-trigger.c-glyph.glyph-play:before,button.c-action-trigger.c-glyph.glyph-play:before{content:""}a.c-action-trigger.c-glyph.glyph-info:before,button.c-action-trigger.c-glyph.glyph-info:before{content:""}a.c-action-trigger.c-glyph[aria-label],button.c-action-trigger.c-glyph[aria-label]{min-width:0;margin-right:10px;padding-right:0}.theme-dark .theme-light a.c-action-trigger,.theme-dark .theme-light button.c-action-trigger,.theme-light a.c-action-trigger,.theme-light button.c-action-trigger{color:#000;background:transparent}.theme-dark .theme-light a.c-action-trigger:focus,.theme-dark .theme-light a.c-action-trigger:hover,.theme-dark .theme-light button.c-action-trigger:focus,.theme-dark .theme-light button.c-action-trigger:hover,.theme-light a.c-action-trigger:focus,.theme-light a.c-action-trigger:hover,.theme-light button.c-action-trigger:focus,.theme-light button.c-action-trigger:hover{color:rgba(0,0,0,.6);text-decoration:underline}.theme-dark .theme-light a.c-action-trigger:focus,.theme-dark .theme-light button.c-action-trigger:focus,.theme-light a.c-action-trigger:focus,.theme-light button.c-action-trigger:focus{outline:1px dashed rgba(0,0,0,.6)}.theme-dark .theme-light a.c-action-trigger:active,.theme-dark .theme-light button.c-action-trigger:active,.theme-light a.c-action-trigger:active,.theme-light button.c-action-trigger:active{color:#000;outline:1px solid transparent;text-decoration:none}.theme-dark .theme-light a.c-action-trigger[disabled],.theme-dark .theme-light button.c-action-trigger[disabled],.theme-light a.c-action-trigger[disabled],.theme-light button.c-action-trigger[disabled]{color:rgba(0,0,0,.2);cursor:not-allowed}.theme-dark a.c-action-trigger,.theme-dark button.c-action-trigger,.theme-light .theme-dark a.c-action-trigger,.theme-light .theme-dark button.c-action-trigger{color:#fff;background:transparent}.theme-dark a.c-action-trigger:focus,.theme-dark a.c-action-trigger:hover,.theme-dark button.c-action-trigger:focus,.theme-dark button.c-action-trigger:hover,.theme-light .theme-dark a.c-action-trigger:focus,.theme-light .theme-dark a.c-action-trigger:hover,.theme-light .theme-dark button.c-action-trigger:focus,.theme-light .theme-dark button.c-action-trigger:hover{color:hsla(0,0%,100%,.8);text-decoration:underline}.theme-dark a.c-action-trigger:focus,.theme-dark button.c-action-trigger:focus,.theme-light .theme-dark a.c-action-trigger:focus,.theme-light .theme-dark button.c-action-trigger:focus{outline:1px dashed #fff}.theme-dark a.c-action-trigger:active,.theme-dark button.c-action-trigger:active,.theme-light .theme-dark a.c-action-trigger:active,.theme-light .theme-dark button.c-action-trigger:active{color:#fff;outline:1px solid transparent;text-decoration:none}.theme-dark a.c-action-trigger[disabled],.theme-dark button.c-action-trigger[disabled],.theme-light .theme-dark a.c-action-trigger[disabled],.theme-light .theme-dark button.c-action-trigger[disabled]{color:hsla(0,0%,100%,.6);cursor:not-allowed}.c-age-rating{display:block}.c-age-rating>.c-image{float:left;width:56px;height:auto}.c-age-rating .c-label,.c-age-rating .c-paragraph{font-size:15px;line-height:20px;padding:0;margin:0 0 0 68px}.c-age-rating .c-label{font-weight:700}.c-age-rating .c-content-toggle{margin-left:68px}.c-age-rating .c-content-toggle p{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:200px;padding-top:0}.c-age-rating .c-content-toggle p[data-f-expanded=false]{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:0}.c-auto-suggest{display:block}.c-auto-suggest .c-menu{position:absolute;background:#fff;border-color:currentcolor rgba(0,0,0,.2) rgba(0,0,0,.2);border-top:1px solid rgba(0,0,0,.2)}.c-auto-suggest .c-menu .c-menu-item span{background:#fff}.c-auto-suggest .c-menu .c-menu-item span:hover{background:rgba(0,0,0,.1)}.c-auto-suggest .c-menu[aria-hidden=true]{display:none}.c-auto-suggest .c-menu[data-js-auto-suggest-postion=default]{top:38px}.c-auto-suggest .c-menu[data-js-auto-suggest-postion=above]{bottom:100%}.c-auto-suggest .c-menu.f-auto-suggest-no-results .c-menu-item span{color:rgba(0,0,0,.6)}.c-auto-suggest .c-menu.f-auto-suggest-no-results[data-js-auto-suggest-postion=default]{top:38px}.c-auto-suggest .c-menu.f-auto-suggest-no-results[data-js-auto-suggest-postion=above]{bottom:100%}.c-auto-suggest .c-menu.f-auto-suggest-scroll{overflow-y:auto;max-height:none}.c-label+.c-auto-suggest.c-search{margin-top:0}.c-badge{font-size:13px;display:inline-block;letter-spacing:.075em}.c-badge.f-highlight{background-color:#ffd800;color:#000}.c-badge.f-lowlight{background-color:#333;color:#fff}.c-badge.f-small{padding:0 9px 1px 8px}.c-badge.f-large{padding:3px 13px 5px 12px}ul.c-breadcrumb{display:-ms-flexbox;display:flex;margin-top:12px}ul.c-breadcrumb li{display:inline-block;padding-right:8px}ul.c-breadcrumb li+li:before{content:"\\\\";padding-right:8px;color:rgba(0,0,0,.6)}ul.c-breadcrumb li:last-child a{color:rgba(0,0,0,.6)}ul.c-breadcrumb li a{font-size:13px;line-height:16px;color:#0078d7}.theme-dark .theme-light ul.c-breadcrumb li+li:before,.theme-dark .theme-light ul.c-breadcrumb li:last-child a,.theme-light ul.c-breadcrumb li+li:before,.theme-light ul.c-breadcrumb li:last-child a{color:rgba(0,0,0,.6)}.theme-dark .theme-light ul.c-breadcrumb li a,.theme-light ul.c-breadcrumb li a{color:#000;text-decoration:none}.theme-dark .theme-light ul.c-breadcrumb li a:hover,.theme-light ul.c-breadcrumb li a:hover{text-decoration:underline}.theme-dark ul.c-breadcrumb li+li:before,.theme-dark ul.c-breadcrumb li:last-child a,.theme-light .theme-dark ul.c-breadcrumb li+li:before,.theme-light .theme-dark ul.c-breadcrumb li:last-child a{color:hsla(0,0%,100%,.6)}.theme-dark ul.c-breadcrumb li a,.theme-light .theme-dark ul.c-breadcrumb li a{color:#fff;text-decoration:none}.theme-dark ul.c-breadcrumb li a:hover,.theme-light .theme-dark ul.c-breadcrumb li a:hover{text-decoration:underline}.btn,a.c-button[role=button],button.c-button{font-size:15px;max-width:374px;min-width:120px;display:inline-block;margin-top:12px;padding:9px 12px 10px;background-color:rgba(0,0,0,.2);color:#000;border:1px solid transparent;overflow:hidden;line-height:1;text-align:center;white-space:nowrap;vertical-align:bottom;outline:1px dashed transparent}.btn:focus,a.c-button[role=button]:focus,button.c-button:focus{outline-color:#000}.btn:focus,.btn:hover,a.c-button[role=button]:focus,a.c-button[role=button]:hover,button.c-button:focus,button.c-button:hover{border-color:rgba(0,0,0,.4)}.btn:active,a.c-button[role=button]:active,button.c-button:active{background-color:rgba(0,0,0,.4)}.btn[disabled],a.c-button[role=button][disabled],button.c-button[disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,0,0,.2);cursor:not-allowed}.theme-dark .theme-light .btn,.theme-dark .theme-light a.c-button[role=button],.theme-dark .theme-light button.c-button,.theme-light .btn,.theme-light a.c-button[role=button],.theme-light button.c-button{background-color:transparent;color:#000;border-color:#000}.theme-dark .theme-light .btn:focus,.theme-dark .theme-light a.c-button[role=button]:focus,.theme-dark .theme-light button.c-button:focus,.theme-light .btn:focus,.theme-light a.c-button[role=button]:focus,.theme-light button.c-button:focus{background-color:rgba(0,0,0,.2);outline-color:#000}.theme-dark .theme-light .btn:hover,.theme-dark .theme-light a.c-button[role=button]:hover,.theme-dark .theme-light button.c-button:hover,.theme-light .btn:hover,.theme-light a.c-button[role=button]:hover,.theme-light button.c-button:hover{background-color:rgba(0,0,0,.2)}.theme-dark .theme-light .btn:active,.theme-dark .theme-light a.c-button[role=button]:active,.theme-dark .theme-light button.c-button:active,.theme-light .btn:active,.theme-light a.c-button[role=button]:active,.theme-light button.c-button:active{background-color:rgba(0,0,0,.4)}.theme-dark .theme-light .btn[disabled],.theme-dark .theme-light a.c-button[role=button][disabled],.theme-dark .theme-light button.c-button[disabled],.theme-light .btn[disabled],.theme-light a.c-button[role=button][disabled],.theme-light button.c-button[disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}.theme-dark .btn,.theme-dark a.c-button[role=button],.theme-dark button.c-button,.theme-light .theme-dark .btn,.theme-light .theme-dark a.c-button[role=button],.theme-light .theme-dark button.c-button{background-color:transparent;color:#fff;border-color:#fff}.theme-dark .btn:focus,.theme-dark a.c-button[role=button]:focus,.theme-dark button.c-button:focus,.theme-light .theme-dark .btn:focus,.theme-light .theme-dark a.c-button[role=button]:focus,.theme-light .theme-dark button.c-button:focus{background-color:hsla(0,0%,100%,.2);outline-color:#fff}.theme-dark .btn:hover,.theme-dark a.c-button[role=button]:hover,.theme-dark button.c-button:hover,.theme-light .theme-dark .btn:hover,.theme-light .theme-dark a.c-button[role=button]:hover,.theme-light .theme-dark button.c-button:hover{background-color:hsla(0,0%,100%,.2)}.theme-dark .btn:active,.theme-dark a.c-button[role=button]:active,.theme-dark button.c-button:active,.theme-light .theme-dark .btn:active,.theme-light .theme-dark a.c-button[role=button]:active,.theme-light .theme-dark button.c-button:active{background-color:hsla(0,0%,100%,.4)}.theme-dark .btn[disabled],.theme-dark a.c-button[role=button][disabled],.theme-dark button.c-button[disabled],.theme-light .theme-dark .btn[disabled],.theme-light .theme-dark a.c-button[role=button][disabled],.theme-light .theme-dark button.c-button[disabled]{color:hsla(0,0%,100%,.2);background-color:hsla(0,0%,100%,.2);border-color:hsla(0,0%,100%,.2)}.btn.btn-primary,button.c-button[type=submit]{color:#fff;background-color:#0078d7}.btn.btn-primary:focus,.btn.btn-primary:hover,button.c-button[type=submit]:focus,button.c-button[type=submit]:hover{background-color:#006cc2;border-color:rgba(0,0,0,.4)}.btn.btn-primary:active,button.c-button[type=submit]:active{background-color:#005497;border-color:transparent}.btn.btn-primary[disabled],button.c-button[type=submit][disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,120,215,.2);border-color:transparent}.theme-dark .theme-light .btn.btn-primary,.theme-dark .theme-light button.c-button[type=submit],.theme-light .btn.btn-primary,.theme-light button.c-button[type=submit]{color:#fff;background-color:#000;border-color:transparent}.theme-dark .theme-light .btn.btn-primary:focus,.theme-dark .theme-light button.c-button[type=submit]:focus,.theme-light .btn.btn-primary:focus,.theme-light button.c-button[type=submit]:focus{outline-color:#000;background-color:rgba(0,0,0,.8)}.theme-dark .theme-light .btn.btn-primary:hover,.theme-dark .theme-light button.c-button[type=submit]:hover,.theme-light .btn.btn-primary:hover,.theme-light button.c-button[type=submit]:hover{background-color:rgba(0,0,0,.8)}.theme-dark .theme-light .btn.btn-primary:active,.theme-dark .theme-light button.c-button[type=submit]:active,.theme-light .btn.btn-primary:active,.theme-light button.c-button[type=submit]:active{background-color:rgba(0,0,0,.6)}.theme-dark .theme-light .btn.btn-primary[disabled],.theme-dark .theme-light button.c-button[type=submit][disabled],.theme-light .btn.btn-primary[disabled],.theme-light button.c-button[type=submit][disabled]{background-color:rgba(0,0,0,.2);color:rgba(0,0,0,.2)}.theme-dark .btn.btn-primary,.theme-dark button.c-button[type=submit],.theme-light .theme-dark .btn.btn-primary,.theme-light .theme-dark button.c-button[type=submit]{color:#000;background-color:#fff;border-color:transparent}.theme-dark .btn.btn-primary:focus,.theme-dark button.c-button[type=submit]:focus,.theme-light .theme-dark .btn.btn-primary:focus,.theme-light .theme-dark button.c-button[type=submit]:focus{outline-color:#fff;background-color:hsla(0,0%,100%,.8)}.theme-dark .btn.btn-primary:hover,.theme-dark button.c-button[type=submit]:hover,.theme-light .theme-dark .btn.btn-primary:hover,.theme-light .theme-dark button.c-button[type=submit]:hover{background-color:hsla(0,0%,100%,.8)}.theme-dark .btn.btn-primary:active,.theme-dark button.c-button[type=submit]:active,.theme-light .theme-dark .btn.btn-primary:active,.theme-light .theme-dark button.c-button[type=submit]:active{background-color:hsla(0,0%,100%,.6)}.theme-dark .btn.btn-primary[disabled],.theme-dark button.c-button[type=submit][disabled],.theme-light .theme-dark .btn.btn-primary[disabled],.theme-light .theme-dark button.c-button[type=submit][disabled]{background-color:hsla(0,0%,100%,.2);color:hsla(0,0%,100%,.2)}a.c-call-to-action{font-size:13px;line-height:16px;padding:10px 40px 7px 24px;border:2px solid transparent;color:#fff;background:#0078d7;line-height:1.3;text-decoration:none;text-align:center;letter-spacing:.075em;white-space:nowrap}a.c-call-to-action,a.c-call-to-action span{display:inline-block;max-width:100%;overflow:hidden}a.c-call-to-action span{-o-text-overflow:clip;text-overflow:clip}a.c-call-to-action:after{position:absolute;display:inline-block;margin-left:4px;margin-top:1px;content:"";vertical-align:top}a.c-call-to-action:focus,a.c-call-to-action:hover{background:#006cc2;border-color:rgba(0,0,0,.4)}a.c-call-to-action:focus{outline:1px dashed #000}a.c-call-to-action:hover{outline:none}a.c-call-to-action:active{border-color:transparent;background:#005497}a.c-call-to-action[aria-disabled=true]{cursor:not-allowed;border-color:transparent;background:#cce4f7;color:rgba(0,0,0,.2)}.theme-dark .theme-light a.c-call-to-action,.theme-light a.c-call-to-action{color:#fff;background:#000}.theme-dark .theme-light a.c-call-to-action:focus,.theme-dark .theme-light a.c-call-to-action:hover,.theme-light a.c-call-to-action:focus,.theme-light a.c-call-to-action:hover{background:#333;border-color:#000;outline-color:#000}.theme-dark .theme-light a.c-call-to-action:active,.theme-light a.c-call-to-action:active{background:#666;border-color:transparent}.theme-dark .theme-light a.c-call-to-action[aria-disabled=true],.theme-light a.c-call-to-action[aria-disabled=true]{background:#ccc;border-color:transparent;color:rgba(0,0,0,.2)}.theme-dark a.c-call-to-action,.theme-light .theme-dark a.c-call-to-action{color:#000;background:#fff}.theme-dark a.c-call-to-action:focus,.theme-dark a.c-call-to-action:hover,.theme-light .theme-dark a.c-call-to-action:focus,.theme-light .theme-dark a.c-call-to-action:hover{background:#ccc;border-color:#fff;outline-color:#000}.theme-dark a.c-call-to-action:active,.theme-light .theme-dark a.c-call-to-action:active{background:#999;border-color:transparent}.theme-dark a.c-call-to-action[aria-disabled=true],.theme-light .theme-dark a.c-call-to-action[aria-disabled=true]{background:#4d4d4d;border-color:transparent;color:hsla(0,0%,100%,.2)}a.c-call-to-action.f-secondary{color:#000;background:#ccc}a.c-call-to-action.f-secondary:focus,a.c-call-to-action.f-secondary:hover{border-color:rgba(0,0,0,.4)}a.c-call-to-action.f-secondary:active{border-color:transparent;background:#999}a.c-call-to-action.f-secondary[aria-disabled=true]{background:#ccc;border-color:transparent;color:rgba(0,0,0,.2)}.theme-dark .theme-light a.c-call-to-action.f-secondary,.theme-light a.c-call-to-action.f-secondary{color:#000;background:hsla(0,0%,100%,0);border-color:#000}.theme-dark .theme-light a.c-call-to-action.f-secondary:focus,.theme-dark .theme-light a.c-call-to-action.f-secondary:hover,.theme-light a.c-call-to-action.f-secondary:focus,.theme-light a.c-call-to-action.f-secondary:hover{background:#ccc;border-color:#000}.theme-dark .theme-light a.c-call-to-action.f-secondary:focus,.theme-light a.c-call-to-action.f-secondary:focus{outline-color:#000}.theme-dark .theme-light a.c-call-to-action.f-secondary:active,.theme-light a.c-call-to-action.f-secondary:active{background:#999}.theme-dark .theme-light a.c-call-to-action.f-secondary[aria-disabled=true],.theme-light a.c-call-to-action.f-secondary[aria-disabled=true]{background:#ccc;border-color:rgba(0,0,0,.2);color:rgba(0,0,0,.2)}.theme-dark a.c-call-to-action.f-secondary,.theme-light .theme-dark a.c-call-to-action.f-secondary{background:hsla(0,0%,100%,0);color:#fff;border-color:#fff}.theme-dark a.c-call-to-action.f-secondary:focus,.theme-dark a.c-call-to-action.f-secondary:hover,.theme-light .theme-dark a.c-call-to-action.f-secondary:focus,.theme-light .theme-dark a.c-call-to-action.f-secondary:hover{background:#4d4d4d;border-color:#fff}.theme-dark a.c-call-to-action.f-secondary:focus,.theme-light .theme-dark a.c-call-to-action.f-secondary:focus{outline-color:#fff}.theme-dark a.c-call-to-action.f-secondary:active,.theme-light .theme-dark a.c-call-to-action.f-secondary:active{background:#666}.theme-dark a.c-call-to-action.f-secondary[aria-disabled=true],.theme-light .theme-dark a.c-call-to-action.f-secondary[aria-disabled=true]{background:#4d4d4d;border-color:hsla(0,0%,100%,.2);color:hsla(0,0%,100%,.2)}@-webkit-keyframes hero-content-next{0%{-webkit-transform:translateX(40px);transform:translateX(40px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes hero-content-next{0%{-webkit-transform:translateX(40px);transform:translateX(40px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes hero-content-previous{0%{-webkit-transform:translateX(-40px);transform:translateX(-40px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes hero-content-previous{0%{-webkit-transform:translateX(-40px);transform:translateX(-40px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes hero-background-next{0%{-webkit-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes hero-background-next{0%{-webkit-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes hero-background-previous{0%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes hero-background-previous{0%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes hero-background-next-y-center{0%{-webkit-transform:translate(10px,-50%);transform:translate(10px,-50%)}to{-webkit-transform:translateY(-50%);transform:translateY(-50%)}}@keyframes hero-background-next-y-center{0%{-webkit-transform:translate(10px,-50%);transform:translate(10px,-50%)}to{-webkit-transform:translateY(-50%);transform:translateY(-50%)}}@-webkit-keyframes hero-background-previous-y-center{0%{-webkit-transform:translate(-10px,-50%);transform:translate(-10px,-50%)}to{-webkit-transform:translateY(-50%);transform:translateY(-50%)}}@keyframes hero-background-previous-y-center{0%{-webkit-transform:translate(-10px,-50%);transform:translate(-10px,-50%)}to{-webkit-transform:translateY(-50%);transform:translateY(-50%)}}@-webkit-keyframes hero-background-next-x-center{0%{-webkit-transform:translateX(-49%);transform:translateX(-49%)}to{-webkit-transform:translateX(-50%);transform:translateX(-50%)}}@keyframes hero-background-next-x-center{0%{-webkit-transform:translateX(-49%);transform:translateX(-49%)}to{-webkit-transform:translateX(-50%);transform:translateX(-50%)}}@-webkit-keyframes hero-background-previous-x-center{0%{-webkit-transform:translateX(-51%);transform:translateX(-51%)}to{-webkit-transform:translateX(-50%);transform:translateX(-50%)}}@keyframes hero-background-previous-x-center{0%{-webkit-transform:translateX(-51%);transform:translateX(-51%)}to{-webkit-transform:translateX(-50%);transform:translateX(-50%)}}@-webkit-keyframes hero-background-next-x-center-y-center{0%{-webkit-transform:translate(-49%,-50%);transform:translate(-49%,-50%)}to{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}}@keyframes hero-background-next-x-center-y-center{0%{-webkit-transform:translate(-49%,-50%);transform:translate(-49%,-50%)}to{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}}@-webkit-keyframes hero-background-previous-x-center-y-center{0%{-webkit-transform:translate(-51%,-50%);transform:translate(-51%,-50%)}to{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}}@keyframes hero-background-previous-x-center-y-center{0%{-webkit-transform:translate(-51%,-50%);transform:translate(-51%,-50%)}to{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}}.c-carousel{position:relative}.c-carousel .c-flipper{position:absolute;top:50%;-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%);transform:translateY(-50%);z-index:100;display:none}.c-carousel .c-flipper.f-left,.c-carousel .c-flipper.f-previous{left:0}.c-carousel .c-flipper.f-next,.c-carousel .c-flipper.f-right{right:0}.c-carousel .c-flipper+div{position:relative;overflow:hidden}.c-carousel.f-scrollable-next .c-flipper.f-next,.c-carousel.f-scrollable-next .c-flipper.f-right,.c-carousel.f-scrollable-previous .c-flipper.f-left,.c-carousel.f-scrollable-previous .c-flipper.f-previous{display:block}.c-carousel .c-sequence-indicator{position:absolute;z-index:100;width:100%;text-align:center;bottom:24px}.c-carousel.f-multi-slide .c-flipper{opacity:0;-webkit-transition:opacity .15 cubic-bezier(.16,1,.29,.99);-o-transition:opacity cubic-bezier(.16,1,.29,.99) .15;transition:opacity .15 cubic-bezier(.16,1,.29,.99)}.c-carousel.f-multi-slide:hover .c-flipper{opacity:.8}.c-carousel.f-multi-slide:hover .c-flipper:hover{opacity:1}.c-carousel.f-multi-slide:hover .c-flipper:active{opacity:.8}.c-carousel.f-multi-slide.theme-light .c-flipper{background:#fff;color:#000}.c-carousel.f-multi-slide.theme-dark .c-flipper{background:#000;color:#fff}.c-carousel.f-multi-slide li.hero{display:none;width:100%}.c-carousel.f-multi-slide li.f-active{display:block}.c-carousel.f-single-slide ul{display:inline-block;white-space:nowrap;font-size:0;left:0;width:auto;-webkit-transition:left .667s cubic-bezier(.16,1,.29,.99);-o-transition:left cubic-bezier(.16,1,.29,.99) .667s;transition:left .667s cubic-bezier(.16,1,.29,.99)}.c-carousel.f-single-slide li{font-size:15px;line-height:20px;display:inline-block}@media only screen and (max-width:767px){.c-carousel .f-gallery{display:none}}.c-carousel .f-gallery li{height:201px;width:358px;position:relative;cursor:pointer;display:inline-block;margin-right:12px}@media only screen and (max-width:1399px){.c-carousel .f-gallery li{height:153px;width:272px}}.c-carousel .f-gallery li .c-action-trigger{background:rgba(0,0,0,.6);border:transparent;border-radius:50%;height:48px;width:48px;position:absolute;top:calc(50% - 24px);left:calc(50% - 24px)}.c-carousel .f-gallery li .c-action-trigger:before{color:#fff;font-size:24px;padding-top:5px;padding-left:1px;content:""}.c-carousel .f-gallery li .c-heading-6{color:#000;position:absolute;bottom:9px;right:12px;width:72px;text-align:right}.c-carousel .f-gallery li .c-heading-6:first-child{left:12px;width:238px;text-align:left}@media only screen and (max-width:1399px){.c-carousel .f-gallery li .c-heading-6:first-child{width:152px}}.c-carousel li{position:relative;height:100%;z-index:1}.c-carousel li~li{display:none}.c-carousel li>picture.c-image img{margin:0 auto}.c-carousel li .c-hero>picture img,.c-carousel li .m-hero-item>picture img{min-width:calc(100% + 20px)}.c-carousel li .c-hero.f-x-left>picture img,.c-carousel li .m-hero-item.f-x-left>picture img{right:-10px}.c-carousel li .c-hero.f-x-right>picture img,.c-carousel li .m-hero-item.f-x-right>picture img{left:-10px}.c-carousel li.f-animate-next>picture.c-image img{-webkit-animation:hero-background-next .667s cubic-bezier(.16,1,.29,.99) both;animation:hero-background-next .667s cubic-bezier(.16,1,.29,.99) both}.c-carousel li.f-animate-next>picture.c-image.f-x-center img{-webkit-animation-name:hero-background-next-x-center;animation-name:hero-background-next-x-center}.c-carousel li.f-animate-next>picture.c-image.f-y-center img{-webkit-animation-name:hero-background-next-y-center;animation-name:hero-background-next-y-center}.c-carousel li.f-animate-next>picture.c-image.f-y-center.f-x-center img{-webkit-animation-name:hero-background-next-x-center-y-center;animation-name:hero-background-next-x-center-y-center}.c-carousel li.f-animate-next .c-hero>picture img,.c-carousel li.f-animate-next .m-hero-item>picture img{-webkit-animation:hero-background-next .667s cubic-bezier(.16,1,.29,.99) both;animation:hero-background-next .667s cubic-bezier(.16,1,.29,.99) both}.c-carousel li.f-animate-next .c-hero>div,.c-carousel li.f-animate-next .m-hero-item>div{-webkit-animation:hero-content-next .667s cubic-bezier(.16,1,.29,.99) both;animation:hero-content-next .667s cubic-bezier(.16,1,.29,.99) both}.c-carousel li.f-animate-next .c-hero.f-x-center>picture img,.c-carousel li.f-animate-next .m-hero-item.f-x-center>picture img{-webkit-animation-name:hero-background-next-x-center;animation-name:hero-background-next-x-center}.c-carousel li.f-animate-next .c-hero.f-y-center>picture img,.c-carousel li.f-animate-next .m-hero-item.f-y-center>picture img{-webkit-animation-name:hero-background-next-y-center;animation-name:hero-background-next-y-center}.c-carousel li.f-animate-next .c-hero.f-y-center.f-x-center>picture img,.c-carousel li.f-animate-next .m-hero-item.f-y-center.f-x-center>picture img{-webkit-animation-name:hero-background-next-x-center-y-center;animation-name:hero-background-next-x-center-y-center}.c-carousel li.f-animate-previous>picture.c-image img{-webkit-animation:hero-background-previous .667s cubic-bezier(.16,1,.29,.99) both;animation:hero-background-previous .667s cubic-bezier(.16,1,.29,.99) both}.c-carousel li.f-animate-previous>picture.c-image.f-x-center img{-webkit-animation-name:hero-background-previous-x-center;animation-name:hero-background-previous-x-center}.c-carousel li.f-animate-previous>picture.c-image.f-y-center img{-webkit-animation-name:hero-background-previous-y-center;animation-name:hero-background-previous-y-center}.c-carousel li.f-animate-previous>picture.c-image.f-y-center.f-x-center img{-webkit-animation-name:hero-background-previous-x-center-y-center;animation-name:hero-background-previous-x-center-y-center}.c-carousel li.f-animate-previous .c-hero>picture img,.c-carousel li.f-animate-previous .m-hero-item>picture img{-webkit-animation:hero-background-previous .667s cubic-bezier(.16,1,.29,.99) both;animation:hero-background-previous .667s cubic-bezier(.16,1,.29,.99) both}.c-carousel li.f-animate-previous .c-hero>div,.c-carousel li.f-animate-previous .m-hero-item>div{-webkit-animation:hero-content-previous .667s cubic-bezier(.16,1,.29,.99) both;animation:hero-content-previous .667s cubic-bezier(.16,1,.29,.99) both}.c-carousel li.f-animate-previous .c-hero.f-x-center>picture img,.c-carousel li.f-animate-previous .m-hero-item.f-x-center>picture img{-webkit-animation-name:hero-background-previous-x-center;animation-name:hero-background-previous-x-center}.c-carousel li.f-animate-previous .c-hero.f-y-center>picture img,.c-carousel li.f-animate-previous .m-hero-item.f-y-center>picture img{-webkit-animation-name:hero-background-previous-y-center;animation-name:hero-background-previous-y-center}.c-carousel li.f-animate-previous .c-hero.f-y-center.f-x-center>picture img,.c-carousel li.f-animate-previous .m-hero-item.f-y-center.f-x-center>picture img{-webkit-animation-name:hero-background-previous-x-center-y-center;animation-name:hero-background-previous-x-center-y-center}@media only screen and (max-width:767px){.c-carousel li>picture.c-image.f-x-left img,.c-carousel li>picture.c-image.f-x-right img{left:0;left:50%;right:auto;-ms-transform:translateX(-50%);-webkit-transform:translateX(-50%);transform:translateX(-50%)}.c-carousel li .c-hero>div>div,.c-carousel li .m-hero-item>div>div{padding-bottom:48px}.c-carousel li .c-hero.f-x-left>picture img,.c-carousel li .c-hero.f-x-right>picture img,.c-carousel li .m-hero-item.f-x-left>picture img,.c-carousel li .m-hero-item.f-x-right>picture img{left:0;left:50%;right:auto;-ms-transform:translateX(-50%);-webkit-transform:translateX(-50%);transform:translateX(-50%)}.c-carousel li.f-animate-next .c-hero[class*=f-x][class*=f-y]>picture img,.c-carousel li.f-animate-next .m-hero-item[class*=f-x][class*=f-y]>picture img,.c-carousel li.f-animate-next>picture.c-image[class*=f-x][class*=f-y] img{-webkit-animation-name:hero-background-next-x-center;animation-name:hero-background-next-x-center}.c-carousel li.f-animate-previous .c-hero[class*=f-x][class*=f-y]>picture img,.c-carousel li.f-animate-previous .m-hero-item[class*=f-x][class*=f-y]>picture img,.c-carousel li.f-animate-previous>picture.c-image[class*=f-x][class*=f-y] img{-webkit-animation-name:hero-background-previous-x-center;animation-name:hero-background-previous-x-center}}.c-checkbox .c-label,.checkbox .c-label{font-size:15px;line-height:20px;margin-right:24px;padding-bottom:0;position:relative}.c-checkbox input[type=checkbox],.checkbox input[type=checkbox]{position:absolute;height:20px;opacity:0;width:20px}.c-checkbox input[type=checkbox]+span,.checkbox input[type=checkbox]+span{cursor:pointer;display:inline-block;left:0;padding-left:28px;position:relative;top:0}.c-checkbox input[type=checkbox]+span:after,.c-checkbox input[type=checkbox]+span:before,.checkbox input[type=checkbox]+span:after,.checkbox input[type=checkbox]+span:before{height:20px;left:0;position:absolute;width:20px;top:0}.c-checkbox input[type=checkbox]+span:before,.checkbox input[type=checkbox]+span:before{content:"";-webkit-box-shadow:inset 0 0 0 1px #000,inset 0 0 0 10px transparent;box-shadow:inset 0 0 0 1px #000,inset 0 0 0 10px transparent;top:0}@media screen and (-ms-high-contrast:active){.c-checkbox input[type=checkbox]+span:before,.checkbox input[type=checkbox]+span:before{border:1px solid #767676}}.c-checkbox input[type=checkbox]:not(:disabled):focus+span:before,.c-checkbox input[type=checkbox]:not(:disabled):hover+span:before,.checkbox input[type=checkbox]:not(:disabled):focus+span:before,.checkbox input[type=checkbox]:not(:disabled):hover+span:before{-webkit-box-shadow:inset 0 0 0 1px rgba(0,0,0,.8);box-shadow:inset 0 0 0 1px rgba(0,0,0,.8)}.c-checkbox input[type=checkbox]:focus+span:before,.checkbox input[type=checkbox]:focus+span:before{outline:1px dashed rgba(0,0,0,.8)}.c-checkbox input[type=checkbox]:checked+span:after,.checkbox input[type=checkbox]:checked+span:after{font-family:MWF-MDL2;content:"";color:#fff;font-size:17px;padding-left:1px}.c-checkbox input[type=checkbox]:checked:disabled+span:after,.checkbox input[type=checkbox]:checked:disabled+span:after{-webkit-box-shadow:inset 0 0 0 1px rgba(0,120,215,.05),inset 0 0 0 10px rgba(0,120,215,.2);box-shadow:inset 0 0 0 1px rgba(0,120,215,.05),inset 0 0 0 10px rgba(0,120,215,.2);color:hsla(0,0%,100%,.3)}.c-checkbox input[type=checkbox]:checked:not(:disabled)+span:before,.checkbox input[type=checkbox]:checked:not(:disabled)+span:before{-webkit-box-shadow:inset 0 0 0 10px #0078d7;box-shadow:inset 0 0 0 10px #0078d7}.c-checkbox input[type=checkbox]:checked:not(:disabled):focus+span:before,.c-checkbox input[type=checkbox]:checked:not(:disabled):hover+span:before,.checkbox input[type=checkbox]:checked:not(:disabled):focus+span:before,.checkbox input[type=checkbox]:checked:not(:disabled):hover+span:before{-webkit-box-shadow:inset 0 0 0 1px rgba(0,0,0,.6),inset 0 0 0 10px #0078d7;box-shadow:inset 0 0 0 1px rgba(0,0,0,.6),inset 0 0 0 10px #0078d7}.c-checkbox input[type=checkbox]:indeterminate+span:after,.checkbox input[type=checkbox]:indeterminate+span:after{border:5px solid #000;content:"";height:0;left:5px;top:5px;width:0}.c-checkbox input[type=checkbox]:indeterminate:disabled+span:after,.checkbox input[type=checkbox]:indeterminate:disabled+span:after{border-color:rgba(0,0,0,.2)}.c-checkbox input[type=checkbox]:indeterminate:not(:disabled):hover+span:after,.checkbox input[type=checkbox]:indeterminate:not(:disabled):hover+span:after{border-color:rgba(0,0,0,.6)}.c-checkbox input[type=checkbox]:indeterminate:not(:disabled)+span:before,.checkbox input[type=checkbox]:indeterminate:not(:disabled)+span:before{-webkit-box-shadow:inset 0 0 0 1px #0078d7;box-shadow:inset 0 0 0 1px #0078d7}.c-checkbox input[type=checkbox]:disabled+span,.checkbox input[type=checkbox]:disabled+span{color:rgba(0,0,0,.2);cursor:not-allowed}.c-checkbox input[type=checkbox]:disabled+span:before,.checkbox input[type=checkbox]:disabled+span:before{-webkit-box-shadow:inset 0 0 0 1px rgba(0,0,0,.2);box-shadow:inset 0 0 0 1px rgba(0,0,0,.2)}.c-choice-summary{font-size:13px;position:relative;display:inline-block;list-style-type:none;max-width:100%;background-color:rgba(0,0,0,.1);padding-right:36px;min-width:72px;margin-top:12px;margin-right:12px}.c-choice-summary span{display:inline-block;padding:9px 0 10px 12px;min-width:100%}.c-choice-summary button.c-action-trigger.c-glyph{position:absolute;top:0;right:0;width:36px;height:100%;margin:0;padding:5px 0 9px}.c-choice-summary button.c-action-trigger.c-glyph:before{margin:0;width:auto;height:auto;color:rgba(0,0,0,.6)}.c-choice-summary button.c-action-trigger.c-glyph:hover,.c-choice-summary button.c-action-trigger.c-glyph:hover+span{background-color:rgba(0,0,0,.2)}.c-choice-summary button.c-action-trigger.c-glyph:active,.c-choice-summary button.c-action-trigger.c-glyph:active+span{background-color:rgba(0,0,0,.3)}.c-choice-summary button.c-action-trigger.c-glyph:active:before{color:rgba(0,0,0,.8)}.c-combo{position:relative;min-width:92px;max-width:296px;height:38px;margin-top:20px}.c-combo div{display:block}.c-combo div ul{z-index:1;width:296px;min-width:64px;max-width:368px;padding:0;margin:0;border:1px solid rgba(0,0,0,.2);background-clip:padding-box;position:absolute;top:38px;background:#fff;overflow-y:auto;max-height:none}.c-combo div ul li span{background:#f2f2f2;display:block;padding:11px 12px 13px;outline:0;cursor:pointer}.c-combo div ul li span.active{color:#fff;background:#0078d7}.c-combo div ul li span:hover{color:#000;background:#e6e6e6}.c-combo div ul[aria-hidden=true]{display:none}.c-combo button,.c-combo input[type=text]{float:left;height:100%;outline:0;background:#fff}.c-combo input[type=text]{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;padding:7px 38px 7px 10px;border:1px solid rgba(0,0,0,.6)}.c-combo input[type=text]:hover{border-color:rgba(0,0,0,.8)}.c-combo input[type=text]:active,.c-combo input[type=text]:focus{border-color:#0078d7}.c-combo input[type=text]::-ms-clear{display:none}.c-combo button{position:absolute;top:0;right:0;width:34px;height:34px;margin:2px 1px 1px;padding:9px;-webkit-transition:color .1s,background-color .1s;-o-transition:color .1s,background-color .1s;transition:color .1s,background-color .1s;border:0}.c-combo button:hover{color:#0078d7}.c-combo button:active,.c-combo button:focus{color:#fff;background:#0078d7}.c-combo button:before{content:"";text-indent:0;font-size:16px}.c-content-placement{margin-top:48px;overflow:hidden}.c-content-placement .c-heading{font-size:24px;line-height:28px;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:56px;font-weight:200;padding-top:12px}.c-content-placement .c-badge{margin-bottom:4px}.c-content-placement .c-paragraph{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:80px;padding-top:2px}.c-content-placement .c-call-to-action{color:#0078d7;border-width:2px;padding:10px 44px 7px 24px;margin-left:-24px;margin-right:-24px;margin-top:12px}.c-content-placement .c-call-to-action,.c-content-placement .c-call-to-action:focus,.c-content-placement .c-call-to-action:hover{background:transparent;border-color:transparent}.c-content-placement .c-call-to-action:active{background:transparent;text-decoration:none}.c-content-placement .c-call-to-action span:hover{text-decoration:underline}.theme-dark .theme-light .c-content-placement .c-call-to-action,.theme-light .c-content-placement .c-call-to-action{color:#000;background:transparent;border-color:transparent}.theme-dark .theme-light .c-content-placement .c-call-to-action:active,.theme-light .c-content-placement .c-call-to-action:active{color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-content-placement .c-call-to-action:focus,.theme-light .c-content-placement .c-call-to-action:focus{outline-color:#000}.theme-dark .c-content-placement .c-call-to-action,.theme-light .theme-dark .c-content-placement .c-call-to-action{color:#fff;background:transparent;border-color:transparent}.theme-dark .c-content-placement .c-call-to-action:active,.theme-light .theme-dark .c-content-placement .c-call-to-action:active{color:hsla(0,0%,100%,.6)}.theme-dark .c-content-placement .c-call-to-action:focus,.theme-light .theme-dark .c-content-placement .c-call-to-action:focus{outline-color:#fff}.c-content-placement .c-video{width:100%;max-width:100%;overflow:hidden;left:0}.c-content-placement .c-video video{min-width:100%;width:100%;height:100%}.c-content-placement>picture{display:block;position:relative;overflow:hidden}.c-content-placement>picture img{position:relative;width:100%}.c-content-placement>div{padding-right:24px}.c-content-placement>div>.c-call-to-action{padding-right:0}.c-content-placement>div>.c-call-to-action:focus{padding-right:44px}.c-content-placement>div>.c-group{display:block;overflow:visible;margin-top:12px}.c-content-placement>div>.c-group>.c-call-to-action{margin-top:0}.c-content-placement>div>.c-group>.c-call-to-action+.c-call-to-action:focus{padding-left:24px;margin-left:-24px}@media only screen and (max-width:767px){.c-content-placement>div{padding-right:12px}}@media only screen and (max-width:539px){.c-content-placement .c-heading{font-size:20px;line-height:24px;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:48px;font-weight:400}}.c-content-toggle p{font-size:15px;line-height:20px;padding:24px 0 0;font-weight:400}.c-content-toggle p[data-f-expanded=false]{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:60px}.c-content-toggle button{display:inline-block;color:#0078d7;border:0;background:transparent;padding:0}.c-content-toggle button:hover{text-decoration:underline}.c-content-toggle button:active{text-decoration:none;color:#006cc2}.c-content-toggle button:focus{outline:1px dashed #000}.c-date-time-picker{-webkit-box-shadow:0 0 0 1px rgba(0,0,0,.6) inset;box-shadow:inset 0 0 0 1px rgba(0,0,0,.6);outline:0;background:rgba(0,0,0,.05);position:relative;float:left}.c-date-time-picker button{font-size:15px;line-height:20px;font-weight:400;background:transparent;height:36px;border:0;border-right:1px solid rgba(0,0,0,.6)}.c-date-time-picker button:focus{outline:1px dotted rgba(0,0,0,.6)}.c-date-time-picker:hover{background:rgba(0,0,0,.2)}.c-date-time-picker:active{background:rgba(0,0,0,.4)}.c-date-time-picker[data-date-time-picker=date]{width:296px;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;align-items:center}.c-date-time-picker[data-date-time-picker=date] [data-date-time-picker=month]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:135px;text-align:left}.c-date-time-picker[data-date-time-picker=date] [data-date-time-picker=day]{float:left;-ms-flex:1 1 auto;flex:1 1 auto}.c-date-time-picker[data-date-time-picker=date] [data-date-time-picker=year]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:80px}.c-date-time-picker[data-date-time-picker=time]{width:240px;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;align-items:center}.c-date-time-picker[data-date-time-picker=time] [data-date-time-picker=ampm],.c-date-time-picker[data-date-time-picker=time] [data-date-time-picker=hour],.c-date-time-picker[data-date-time-picker=time] [data-date-time-picker=minute]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:80px}.c-date-time-picker[data-date-time-picker=time24]{width:160px;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;align-items:center}.c-date-time-picker[data-date-time-picker=time24] [data-date-time-picker=hour24],.c-date-time-picker[data-date-time-picker=time24] [data-date-time-picker=minute24]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:80px}.c-date-time-picker [data-date-time-picker=date-selector],.c-date-time-picker [data-date-time-picker=time-selector12],.c-date-time-picker [data-date-time-picker=time-selector24]{width:100%;background:#f2f2f2;position:absolute;top:-157px;left:0;height:396px;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;-ms-grid-row-align:center;align-items:center;overflow:hidden;text-align:center;z-index:300}.c-date-time-picker [data-date-time-picker=date-selector][aria-hidden=true],.c-date-time-picker [data-date-time-picker=time-selector12][aria-hidden=true],.c-date-time-picker [data-date-time-picker=time-selector24][aria-hidden=true]{display:none}.c-date-time-picker [data-date-time-picker=date-selector][aria-hidden=false],.c-date-time-picker [data-date-time-picker=time-selector12][aria-hidden=false],.c-date-time-picker [data-date-time-picker=time-selector24][aria-hidden=false]{display:-ms-flexbox;display:flex}.c-date-time-picker [data-date-time-picker=date-selector]>span,.c-date-time-picker [data-date-time-picker=time-selector12]>span,.c-date-time-picker [data-date-time-picker=time-selector24]>span{position:absolute;z-index:0;top:154px;left:0;height:44px;width:100%;background:#0078d7}.c-date-time-picker [data-date-time-picker=date-selector] [data-date-time-picker=ampm],.c-date-time-picker [data-date-time-picker=time-selector12] [data-date-time-picker=ampm],.c-date-time-picker [data-date-time-picker=time-selector24] [data-date-time-picker=ampm]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:80px;z-index:1;top:0;height:352px}.c-date-time-picker [data-date-time-picker=date-selector] [data-date-time-picker=ampm] button,.c-date-time-picker [data-date-time-picker=time-selector12] [data-date-time-picker=ampm] button,.c-date-time-picker [data-date-time-picker=time-selector24] [data-date-time-picker=ampm] button{position:absolute;left:80px;height:22px;width:100%;background:transparent;border:0;z-index:100}.c-date-time-picker [data-date-time-picker=date-selector] [data-date-time-picker=ampm] button:first-of-type,.c-date-time-picker [data-date-time-picker=time-selector12] [data-date-time-picker=ampm] button:first-of-type,.c-date-time-picker [data-date-time-picker=time-selector24] [data-date-time-picker=ampm] button:first-of-type{top:0}.c-date-time-picker [data-date-time-picker=date-selector] [data-date-time-picker=ampm] button:last-of-type,.c-date-time-picker [data-date-time-picker=time-selector12] [data-date-time-picker=ampm] button:last-of-type,.c-date-time-picker [data-date-time-picker=time-selector24] [data-date-time-picker=ampm] button:last-of-type{top:330px}.c-date-time-picker [data-date-time-picker=date-selector] [data-date-time-picker=ampm] ul,.c-date-time-picker [data-date-time-picker=time-selector12] [data-date-time-picker=ampm] ul,.c-date-time-picker [data-date-time-picker=time-selector24] [data-date-time-picker=ampm] ul{top:154px}.c-date-time-picker [data-date-time-picker=date-selector] [data-date-time-picker=ampm] ul.f-js-pm,.c-date-time-picker [data-date-time-picker=time-selector12] [data-date-time-picker=ampm] ul.f-js-pm,.c-date-time-picker [data-date-time-picker=time-selector24] [data-date-time-picker=ampm] ul.f-js-pm{top:110px}.c-date-time-picker [data-date-time-picker=date-selector]>div,.c-date-time-picker [data-date-time-picker=time-selector12]>div,.c-date-time-picker [data-date-time-picker=time-selector24]>div{font-size:15px;line-height:20px;font-weight:400;color:rgba(0,0,0,.6);-ms-flex-item-align:start;align-self:flex-start;background-clip:content-box;border-right:1px solid rgba(0,0,0,.6);float:left;position:relative;z-index:1}.c-date-time-picker [data-date-time-picker=date-selector]>div:first-of-type button,.c-date-time-picker [data-date-time-picker=time-selector12]>div:first-of-type button,.c-date-time-picker [data-date-time-picker=time-selector24]>div:first-of-type button{left:0;width:inherit}.c-date-time-picker [data-date-time-picker=date-selector]>div:last-of-type,.c-date-time-picker [data-date-time-picker=time-selector12]>div:last-of-type,.c-date-time-picker [data-date-time-picker=time-selector24]>div:last-of-type{border-right:0}.c-date-time-picker [data-date-time-picker=date-selector]>div:last-of-type button,.c-date-time-picker [data-date-time-picker=time-selector12]>div:last-of-type button,.c-date-time-picker [data-date-time-picker=time-selector24]>div:last-of-type button{left:auto;right:0;width:inherit}.c-date-time-picker [data-date-time-picker=date-selector]>div ul,.c-date-time-picker [data-date-time-picker=time-selector12]>div ul,.c-date-time-picker [data-date-time-picker=time-selector24]>div ul{position:relative;top:-66px}.c-date-time-picker [data-date-time-picker=date-selector]>div li,.c-date-time-picker [data-date-time-picker=time-selector12]>div li,.c-date-time-picker [data-date-time-picker=time-selector24]>div li{height:44px;padding:12px 6px 3px}.c-date-time-picker [data-date-time-picker=date-selector]>div li[aria-checked=true],.c-date-time-picker [data-date-time-picker=time-selector12]>div li[aria-checked=true],.c-date-time-picker [data-date-time-picker=time-selector24]>div li[aria-checked=true]{color:#fff}.c-date-time-picker [data-date-time-picker=date-selector]>div li[aria-checked=true]:hover,.c-date-time-picker [data-date-time-picker=time-selector12]>div li[aria-checked=true]:hover,.c-date-time-picker [data-date-time-picker=time-selector24]>div li[aria-checked=true]:hover{background:transparent}.c-date-time-picker [data-date-time-picker=date-selector]>div li[aria-checked=true]:focus,.c-date-time-picker [data-date-time-picker=time-selector12]>div li[aria-checked=true]:focus,.c-date-time-picker [data-date-time-picker=time-selector24]>div li[aria-checked=true]:focus{outline:1px dotted rgba(0,0,0,.6)}.c-date-time-picker [data-date-time-picker=date-selector]>div li.f-js-last,.c-date-time-picker [data-date-time-picker=time-selector12]>div li.f-js-last,.c-date-time-picker [data-date-time-picker=time-selector24]>div li.f-js-last{border-bottom:1px solid rgba(0,0,0,.6)}.c-date-time-picker [data-date-time-picker=date-selector]>div li:hover,.c-date-time-picker [data-date-time-picker=time-selector12]>div li:hover,.c-date-time-picker [data-date-time-picker=time-selector24]>div li:hover{background:#ccc;cursor:pointer}.c-date-time-picker [data-date-time-picker=date-selector]>button,.c-date-time-picker [data-date-time-picker=time-selector12]>button,.c-date-time-picker [data-date-time-picker=time-selector24]>button{width:50%;height:44px;background:#f2f2f2;border:0;border-top:1px solid rgba(0,0,0,.6);position:absolute;bottom:0;z-index:100}.c-date-time-picker [data-date-time-picker=date-selector]>button:focus,.c-date-time-picker [data-date-time-picker=time-selector12]>button:focus,.c-date-time-picker [data-date-time-picker=time-selector24]>button:focus{outline:1px dotted rgba(0,0,0,.6)}.c-date-time-picker [data-date-time-picker=date-selector]>button.glyph-accept:before,.c-date-time-picker [data-date-time-picker=time-selector12]>button.glyph-accept:before,.c-date-time-picker [data-date-time-picker=time-selector24]>button.glyph-accept:before{color:rgba(0,0,0,.6);content:""}.c-date-time-picker [data-date-time-picker=date-selector]>button.glyph-cancel:before,.c-date-time-picker [data-date-time-picker=time-selector12]>button.glyph-cancel:before,.c-date-time-picker [data-date-time-picker=time-selector24]>button.glyph-cancel:before{color:rgba(0,0,0,.6);content:""}.c-date-time-picker [data-date-time-picker=date-selector]>button:hover,.c-date-time-picker [data-date-time-picker=time-selector12]>button:hover,.c-date-time-picker [data-date-time-picker=time-selector24]>button:hover{background:#ccc}.c-date-time-picker [data-date-time-picker=date-selector]>button[data-date-time-picker=apply],.c-date-time-picker [data-date-time-picker=time-selector12]>button[data-date-time-picker=apply],.c-date-time-picker [data-date-time-picker=time-selector24]>button[data-date-time-picker=apply]{left:0}.c-date-time-picker [data-date-time-picker=date-selector]>button[data-date-time-picker=cancel],.c-date-time-picker [data-date-time-picker=time-selector12]>button[data-date-time-picker=cancel],.c-date-time-picker [data-date-time-picker=time-selector24]>button[data-date-time-picker=cancel]{right:0}.c-date-time-picker [data-date-time-picker=month]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:135px;text-align:left;z-index:1}.c-date-time-picker [data-date-time-picker=month] button{position:absolute;left:0;height:22px;width:100%;background:transparent;border:0;z-index:100}.c-date-time-picker [data-date-time-picker=month] button:first-of-type{top:0}.c-date-time-picker [data-date-time-picker=month] button:last-of-type{top:330px}.c-date-time-picker [data-date-time-picker=day]{float:left;-ms-flex:1 1 auto;flex:1 1 auto;z-index:1}.c-date-time-picker [data-date-time-picker=day] button{position:absolute;left:0;height:22px;width:100%;background:transparent;border:0;z-index:100}.c-date-time-picker [data-date-time-picker=day] button:first-of-type{top:0}.c-date-time-picker [data-date-time-picker=day] button:last-of-type{top:330px}.c-date-time-picker [data-date-time-picker=year]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:80px;z-index:1}.c-date-time-picker [data-date-time-picker=year] button{position:absolute;left:135px;height:22px;width:100%;background:transparent;border:0;z-index:100}.c-date-time-picker [data-date-time-picker=year] button:first-of-type{top:0}.c-date-time-picker [data-date-time-picker=year] button:last-of-type{top:330px}.c-date-time-picker [data-date-time-picker=hour24],.c-date-time-picker [data-date-time-picker=hour]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:80px;z-index:1}.c-date-time-picker [data-date-time-picker=hour24] button,.c-date-time-picker [data-date-time-picker=hour] button{position:absolute;left:0;height:22px;width:100%;background:transparent;border:0;z-index:100}.c-date-time-picker [data-date-time-picker=hour24] button:first-of-type,.c-date-time-picker [data-date-time-picker=hour] button:first-of-type{top:0}.c-date-time-picker [data-date-time-picker=hour24] button:last-of-type,.c-date-time-picker [data-date-time-picker=hour] button:last-of-type{top:330px}.c-date-time-picker [data-date-time-picker=minute24],.c-date-time-picker [data-date-time-picker=minute]{float:left;-ms-flex:0 0 auto;flex:0 0 auto;width:80px;z-index:1}.c-date-time-picker [data-date-time-picker=minute24] button,.c-date-time-picker [data-date-time-picker=minute] button{position:absolute;left:0;height:22px;width:100%;background:transparent;border:0;z-index:100}.c-date-time-picker [data-date-time-picker=minute24] button:first-of-type,.c-date-time-picker [data-date-time-picker=minute] button:first-of-type{top:0}.c-date-time-picker [data-date-time-picker=minute24] button:last-of-type,.c-date-time-picker [data-date-time-picker=minute] button:last-of-type{top:330px}.c-dialog[aria-hidden=true]{display:none}.c-dialog [role=dialog]{display:block;position:fixed;left:50%;top:50%;-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background:#fff;border:1px solid #0078d7;margin:0 auto;max-height:760px;max-width:546px;min-width:296px;overflow:auto;padding:24px;z-index:900}.c-dialog [role=dialog]:focus{outline:none}.c-dialog [role=dialog] h2{font-size:20px;line-height:normal;padding:0}.c-dialog [role=dialog] p{padding-top:8px}.c-dialog [role=dialog] .c-group{display:block}.c-dialog [role=dialog] .c-group button{float:right;margin-top:24px;width:50%;max-width:none;margin-right:0}.c-dialog [role=dialog] .c-group button+button{float:left;width:calc(50% - 4px)}.c-dialog.f-flow [role=dialog],.c-dialog.f-lightbox [role=dialog]{padding:36px}.c-dialog.f-flow [role=dialog]>.c-glyph,.c-dialog.f-lightbox [role=dialog]>.c-glyph{position:absolute;width:36px;height:36px;right:0;top:0;color:rgba(0,0,0,.6);cursor:pointer}.c-dialog.f-flow [role=dialog]>.c-glyph:hover,.c-dialog.f-lightbox [role=dialog]>.c-glyph:hover{color:rgba(0,0,0,.8)}.c-dialog.f-flow [role=dialog]>.c-glyph:focus,.c-dialog.f-lightbox [role=dialog]>.c-glyph:focus{outline:1px dashed rgba(0,0,0,.8)}.c-dialog.f-flow [role=dialog]>.c-glyph:active,.c-dialog.f-lightbox [role=dialog]>.c-glyph:active{color:#000}.c-dialog.f-flow [role=dialog]>.c-glyph:before,.c-dialog.f-lightbox [role=dialog]>.c-glyph:before{margin:10px;vertical-align:middle}.c-dialog.f-flow [role=dialog]>.glyph-cancel:before,.c-dialog.f-lightbox [role=dialog]>.glyph-cancel:before{content:""}.c-dialog.f-flow [role=dialog] .c-group button,.c-dialog.f-lightbox [role=dialog] .c-group button{margin-top:36px}.c-dialog.f-lightbox [role=dialog]{background:#2f2f2f;border-color:transparent;max-width:1066px;overflow:visible}.c-dialog.f-lightbox [role=dialog]>.c-glyph{top:-36px;color:hsla(0,0%,100%,.6)}.c-dialog.f-lightbox [role=dialog]>.c-glyph:hover{color:hsla(0,0%,100%,.8)}.c-dialog.f-lightbox [role=dialog]>.c-glyph:focus{outline-color:hsla(0,0%,100%,.6)}.c-dialog.f-lightbox [role=dialog] [role=document] img{width:100%}.c-dialog [role=presentation]{position:fixed;top:0;left:0;bottom:0;right:0;background:rgba(0,0,0,.9);z-index:900}.c-dialog [role=presentation]:focus{outline:none}.theme-dark .theme-light .c-dialog [role=dialog],.theme-light .c-dialog [role=dialog]{background:#fff;border-color:#000}.theme-dark .theme-light .c-dialog [role=dialog] .c-glyph,.theme-light .c-dialog [role=dialog] .c-glyph{color:#000}.theme-dark .theme-light .c-dialog [role=dialog] .c-glyph:hover,.theme-light .c-dialog [role=dialog] .c-glyph:hover{color:rgba(0,0,0,.8)}.theme-dark .theme-light .c-dialog [role=dialog] .c-glyph:focus,.theme-light .c-dialog [role=dialog] .c-glyph:focus{outline-color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-dialog [role=presentation],.theme-light .c-dialog [role=presentation]{background:hsla(0,0%,100%,.9)}.theme-dark .c-dialog [role=dialog],.theme-light .theme-dark .c-dialog [role=dialog]{background:#000;border-color:#fff}.theme-dark .c-dialog [role=dialog] .c-glyph,.theme-light .theme-dark .c-dialog [role=dialog] .c-glyph{color:#fff}.theme-dark .c-dialog [role=dialog] .c-glyph:hover,.theme-light .theme-dark .c-dialog [role=dialog] .c-glyph:hover{color:hsla(0,0%,100%,.8)}.theme-dark .c-dialog [role=dialog] .c-glyph:focus,.theme-light .theme-dark .c-dialog [role=dialog] .c-glyph:focus{outline-color:hsla(0,0%,100%,.6)}@media only screen and (max-width:539px){.c-dialog [role=dialog]{top:0;left:0;-ms-transform:none;-webkit-transform:none;transform:none;margin:12px;max-height:342px}.c-dialog [role=dialog] .c-group{display:block;padding:0}.c-dialog [role=dialog] .c-group button{float:none;margin-top:24px;width:100%;max-width:none;margin-right:0}.c-dialog [role=dialog] .c-group button+button{float:none;width:100%;margin-top:12px}.c-dialog.f-lightbox [role=dialog]{left:50%;top:50%;-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);max-height:none;margin:0}.c-dialog.f-flow [role=dialog]{max-height:100%;bottom:0}.c-dialog.f-flow [role=dialog] .c-group button+button{margin-top:12px}}hr,hr.c-divider{border:0;border-top:1px solid rgba(0,0,0,.2);margin:0}.c-drawer .f-toggle,.c-drawer>button,.c-drawer>header{min-height:44px;position:relative}.c-drawer>header{margin-bottom:8px}@media only screen and (max-width:539px){.c-drawer>header{padding-right:36px}}.c-drawer>header .f-toggle,.c-drawer>header>button{height:100%;position:absolute}.c-drawer>nav.c-link-navigation{height:40px;line-height:40px;margin-top:0;overflow:hidden;text-align:left;width:auto}.c-drawer>nav.c-link-navigation li{display:inline-block;height:auto}.c-drawer>nav.c-link-navigation li a.c-hyperlink{padding:0}.c-drawer>nav.c-link-navigation li:first-child a{margin-left:0}.c-drawer>nav.c-link-navigation ul{white-space:nowrap}.c-drawer .f-toggle,.c-drawer>button,.c-drawer>header .f-toggle,.c-drawer>header>button{font-size:13px;line-height:16px;display:block;border:0;background:transparent;color:rgba(0,0,0,.6);font-weight:400;padding:14px 36px 14px 12px;left:0;text-align:left;width:100%}.c-drawer .f-toggle:after,.c-drawer>button:after,.c-drawer>header .f-toggle:after,.c-drawer>header>button:after{position:absolute;top:calc(50% - 8px);right:12px}.c-drawer .f-toggle[aria-expanded=true]:after,.c-drawer>button[aria-expanded=true]:after,.c-drawer>header .f-toggle[aria-expanded=true]:after,.c-drawer>header>button[aria-expanded=true]:after{content:""}.c-drawer .f-toggle[aria-expanded=false]:after,.c-drawer>button[aria-expanded=false]:after,.c-drawer>header .f-toggle[aria-expanded=false]:after,.c-drawer>header>button[aria-expanded=false]:after{content:""}.c-drawer .f-toggle:focus,.c-drawer>button:focus,.c-drawer>header .f-toggle:focus,.c-drawer>header>button:focus{outline:1px dashed #000}.c-drawer .f-toggle:hover,.c-drawer>button:hover,.c-drawer>header .f-toggle:hover,.c-drawer>header>button:hover{background:rgba(0,0,0,.1)}.c-drawer .f-toggle:active,.c-drawer>button:active,.c-drawer>header .f-toggle:active,.c-drawer>header>button:active{background:rgba(0,0,0,.3)}.c-drawer.f-responsive .f-toggle+div,.c-drawer.f-responsive>button+div,.c-drawer.f-responsive>header+div{border-top:1px solid rgba(0,0,0,.2);margin-top:8px;padding-top:8px}@media only screen and (min-width:540px){.c-drawer.f-responsive.f-show .f-toggle:after,.c-drawer.f-responsive.f-show>button:after,.c-drawer.f-responsive.f-show>header .f-toggle:after,.c-drawer.f-responsive.f-show>header>button:after{display:none}.c-drawer.f-responsive.f-show .f-toggle:hover,.c-drawer.f-responsive.f-show>button:hover,.c-drawer.f-responsive.f-show>header .f-toggle:hover,.c-drawer.f-responsive.f-show>header>button:hover{background:transparent}}.c-drawer>div[id]{position:relative}.c-explicit{font-size:11px;line-height:1;margin:0 5px;padding:0 3px;border:1px solid #000}.c-feature{position:relative;height:300px}.c-feature:after,.c-feature:before{content:" ";display:table}.c-feature:after{clear:both}.c-feature picture{height:300px;width:50%;display:block;position:relative;overflow:hidden}.c-feature picture img{position:absolute;right:0;top:0;top:50%;right:50%;-ms-transform:translate(50%,-50%);-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.c-feature .c-video{height:300px;width:50%;max-width:50%;overflow:hidden;left:0}.c-feature .c-video>h1{display:none}.c-feature .c-video video{min-width:100%;min-height:100%;height:100%;width:100%}.c-feature.f-align-left>div{left:0;padding:24px}.c-feature.f-align-left .c-video,.c-feature.f-align-left picture{float:right}.c-feature.f-align-right>div{left:50%;padding:24px}.c-feature.f-align-right .c-video,.c-feature.f-align-right picture{float:left;left:0}.c-feature.f-align-left>div,.c-feature.f-align-right>div{position:absolute;top:0;top:50%;-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%);transform:translateY(-50%);width:50%}.c-feature.f-align-left .c-video,.c-feature.f-align-right .c-video{position:relative}.c-feature>div{padding:0 24px 24px}.c-feature>div .c-heading{font-size:24px;line-height:28px;padding:36px 0 4px;font-weight:200;max-height:84px}.c-feature>div .c-heading,.c-feature>div .c-paragraph{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box}.c-feature>div .c-paragraph{font-size:15px;line-height:20px;font-weight:400;max-height:60px;padding:0}.c-feature>div .c-call-to-action{color:#0078d7;border-width:2px;padding:10px 44px 7px 24px;margin-left:-24px;margin-right:-24px;margin-top:10px}.c-feature>div .c-call-to-action,.c-feature>div .c-call-to-action:focus,.c-feature>div .c-call-to-action:hover{background:transparent;border-color:transparent}.c-feature>div .c-call-to-action:active{background:transparent;text-decoration:none}.c-feature>div .c-call-to-action span:hover{text-decoration:underline}.theme-dark .theme-light .c-feature>div .c-call-to-action,.theme-light .c-feature>div .c-call-to-action{color:#000;background:transparent;border-color:transparent}.theme-dark .theme-light .c-feature>div .c-call-to-action:active,.theme-light .c-feature>div .c-call-to-action:active{color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-feature>div .c-call-to-action:focus,.theme-light .c-feature>div .c-call-to-action:focus{outline-color:#000}.theme-dark .c-feature>div .c-call-to-action,.theme-light .theme-dark .c-feature>div .c-call-to-action{color:#fff;background:transparent;border-color:transparent}.theme-dark .c-feature>div .c-call-to-action:active,.theme-light .theme-dark .c-feature>div .c-call-to-action:active{color:hsla(0,0%,100%,.6)}.theme-dark .c-feature>div .c-call-to-action:focus,.theme-light .theme-dark .c-feature>div .c-call-to-action:focus{outline-color:#fff}.c-feature>div .c-group{display:block;overflow:visible;margin-top:10px}.c-feature>div .c-group .c-call-to-action{margin-top:0;margin-right:4px}.c-feature>div .c-badge{margin-top:12px}.c-feature>div .c-badge+.c-heading{padding-top:8px}.c-feature.f-align-center{height:auto}.c-feature.f-align-center>div{width:auto;padding:0 24px;max-width:848px;margin-left:auto;margin-right:auto;text-align:center}.c-feature.f-align-center>div .c-heading{font-size:34px;line-height:40px;padding:38px 0 2px;font-weight:100;max-height:120px}.c-feature.f-align-center>div .c-paragraph{max-height:80px}.c-feature.f-align-center>div .c-group{display:block}.c-feature.f-align-center>div .c-group .c-call-to-action{margin:0 2px}.c-feature.f-align-center>div .c-badge{margin-top:12px}.c-feature.f-align-center>div .c-badge+.c-heading{padding-top:8px}.c-feature.f-align-center .c-video,.c-feature.f-align-center picture{width:100%}@media only screen and (max-width:539px){.c-feature{height:auto}.c-feature.f-align-left>div,.c-feature.f-align-right>div{width:auto;position:relative;top:auto;left:auto;right:auto;-ms-transform:none;-webkit-transform:none;transform:none;padding:0 24px}.c-feature.f-align-left>div .c-badge,.c-feature.f-align-right>div .c-badge{margin-top:12px}.c-feature.f-align-left>div .c-badge+.c-heading,.c-feature.f-align-right>div .c-badge+.c-heading{padding-top:8px}.c-feature.f-align-left picture,.c-feature.f-align-right picture{float:none;width:auto}.c-feature.f-align-left .c-video,.c-feature.f-align-right .c-video{float:none;max-width:100%}.c-feature.f-align-left .c-paragraph,.c-feature.f-align-right .c-paragraph{padding:0}.c-feature>div .c-heading{font-size:20px;line-height:24px;padding:35px 0 5px;font-weight:200;max-height:48px}.c-feature.c-feature.f-align-left>div,.c-feature.c-feature.f-align-right>div{text-align:left}.c-feature .c-video,.c-feature picture{height:200px}}@media only screen and (max-width:767px){.c-feature{height:auto}.c-feature.f-align-left>div,.c-feature.f-align-right>div{max-width:490px;margin:0 auto;position:relative;width:auto;top:auto;left:auto;right:auto;-ms-transform:none;-webkit-transform:none;transform:none;padding:0 24px;text-align:center;float:none}.c-feature.f-align-left .c-badge,.c-feature.f-align-right .c-badge{margin-top:12px}.c-feature.f-align-left .c-badge+.c-heading,.c-feature.f-align-right .c-badge+.c-heading{padding-top:8px}.c-feature.f-align-left picture,.c-feature.f-align-right picture{float:none;width:auto}.c-feature.f-align-left .c-video,.c-feature.f-align-right .c-video{float:none;max-width:100%}.c-feature>div .c-heading{font-size:20px;line-height:24px;padding:35px 0 5px;font-weight:200;max-height:48px}}@media only screen and (min-width:1084px){.c-feature{height:400px}.c-feature>div{max-width:654px}.c-feature .c-video,.c-feature picture{height:400px}.c-feature.f-align-left>div,.c-feature.f-align-right>div{padding:48px}.c-feature>div .c-heading{font-size:34px;line-height:40px;padding:38px 0 2px;font-weight:100;max-height:120px}.c-feature>div .c-paragraph{font-size:15px;line-height:20px;padding:24px 0 0;font-weight:400;max-height:80px}.c-feature.f-align-center>div{padding:0 48px;max-width:894px}}.c-file{display:-ms-flexbox;display:flex}.c-file .c-button{margin-top:20px}.c-file input[type=file]{float:left;visibility:hidden;width:0}.c-file input.c-text-field[type=text]{margin-right:8px}.c-file input.c-text-field[type=text]::-ms-clear{display:none}.c-file input.c-text-field[type=text][readonly]{background:#fff}.c-file input.c-text-field[type=text][readonly]:hover{border-color:rgba(0,0,0,.8)}.c-file input.c-text-field[type=text][readonly]:active,.c-file input.c-text-field[type=text][readonly]:focus{border-color:#0078d7}.c-flipper{display:inline-block;width:24px;height:48px;border:0;padding:0;background:rgba(0,0,0,.1);color:rgba(0,0,0,.6);font-family:MWF-MDL2}.c-flipper:before{position:relative;left:0;top:0}.c-flipper.f-left:before,.c-flipper.f-previous:before{content:""}.c-flipper.f-next:before,.c-flipper.f-right:before{content:""}.c-flipper:focus{outline:1px dashed #000;background:rgba(0,0,0,.15)}.c-flipper:hover{background:rgba(0,0,0,.15);color:rgba(0,0,0,.8)}.c-flipper:active{background:rgba(0,0,0,.2);color:#000}.theme-dark .theme-light .c-flipper,.theme-light .c-flipper{background:hsla(0,0%,100%,.5);color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-flipper:focus,.theme-light .c-flipper:focus{background:hsla(0,0%,100%,.8);outline-color:#000}.theme-dark .theme-light .c-flipper:hover,.theme-light .c-flipper:hover{background:hsla(0,0%,100%,.4);color:rgba(0,0,0,.8)}.theme-dark .theme-light .c-flipper:active,.theme-light .c-flipper:active{background:hsla(0,0%,100%,.2);color:#000}.theme-dark .c-flipper,.theme-light .theme-dark .c-flipper{background:rgba(0,0,0,.5);color:hsla(0,0%,100%,.6)}.theme-dark .c-flipper:focus,.theme-light .theme-dark .c-flipper:focus{background:rgba(0,0,0,.8);outline-color:#fff}.theme-dark .c-flipper:hover,.theme-light .theme-dark .c-flipper:hover{background:rgba(0,0,0,.4);color:hsla(0,0%,100%,.8)}.theme-dark .c-flipper:active,.theme-light .theme-dark .c-flipper:active{background:rgba(0,0,0,.2);color:#fff}.c-flyout{font-size:15px;position:absolute;background:#fff;border:1px solid rgba(0,0,0,.2);min-width:128px;max-width:296px;padding:12px;z-index:700}.c-flyout[aria-hidden=true]{display:none}.c-flyout[aria-hidden=false]{display:block}.c-flyout p{padding:0}.c-flyout button{float:right}.c-flyout:focus{outline:none}.c-universal-footer nav:after,.c-universal-footer nav:before{content:" ";display:table}.c-universal-footer nav:after{clear:both}.c-universal-footer nav div>div{-webkit-box-sizing:border-box;box-sizing:border-box;float:left;min-height:1px;padding:0 12px;width:16.6666666667%;zoom:1}.c-universal-footer nav div>div:after,.c-universal-footer nav div>div:before{content:" ";display:table}.c-universal-footer nav div>div:after{clear:both}.c-universal-footer nav div>div .c-heading-4,.c-universal-footer nav div>div a.c-hyperlink{color:rgba(0,0,0,.6)}.c-universal-footer nav div>div ul.c-list{font-size:11px;line-height:16px}.c-universal-footer>section>a.c-hyperlink,.c-universal-footer>section>a.c-hyperlink.c-glyph{font-size:11px;line-height:16px;display:inline-block;margin-top:30px;color:rgba(0,0,0,.6);float:left}.c-universal-footer>section>a.c-hyperlink.c-glyph:before{font-size:20px;line-height:24px;margin-right:10px;color:rgba(0,0,0,.6);vertical-align:middle}.c-universal-footer>section>a.c-hyperlink.c-glyph.glyph-world:before{content:""}.c-universal-footer>section ul.c-list{font-size:11px;line-height:16px;margin-left:-20px;float:right;margin-top:25px}.c-universal-footer>section ul.c-list li{color:rgba(0,0,0,.6);display:inline-block;padding:8px 20px}.c-universal-footer>section ul.c-list li a.c-hyperlink{color:rgba(0,0,0,.6)}@media only screen and (max-width:767px){.c-universal-footer nav div:after,.c-universal-footer nav div:before{content:" ";display:table}.c-universal-footer nav div:after{clear:both}.c-universal-footer nav div>div{width:33.33333%}.c-universal-footer>section ul.c-list li{padding-left:0;padding-right:16px}}@media only screen and (max-width:539px){.c-universal-footer nav div>div{width:100%;float:none}.c-universal-footer>section ul.c-list{float:left}}.btn-group,.c-group,.checkbox-inline,.radio-inline{display:-ms-flexbox;display:flex;position:relative;-ms-flex-wrap:nowrap;flex-wrap:nowrap;overflow:hidden;padding:1px}.btn-group.f-wrap-items,.c-group.f-wrap-items,.checkbox-inline.f-wrap-items,.radio-inline.f-wrap-items{-ms-flex-wrap:wrap;flex-wrap:wrap}@media only screen and (max-width:539px){.btn-group.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium,.btn-group.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium,.c-group.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium,.c-group.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium,.checkbox-inline.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium,.checkbox-inline.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium,.radio-inline.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium,.radio-inline.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium{width:calc(50% - 24px)}.btn-group.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium picture img,.btn-group.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium picture img,.c-group.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium picture img,.c-group.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium picture img,.checkbox-inline.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium picture img,.checkbox-inline.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium picture img,.radio-inline.f-wrap-items .c-product-placement.f-orientation-vertical.f-size-medium picture img,.radio-inline.f-wrap-items .m-product-placement-item.f-orientation-vertical.f-size-medium picture img{width:100%}}.btn-group .c-call-to-action,.c-group .c-call-to-action,.checkbox-inline .c-call-to-action,.radio-inline .c-call-to-action{margin-right:4px}.btn-group .c-action-trigger,.c-group .c-action-trigger,.checkbox-inline .c-action-trigger,.radio-inline .c-action-trigger{padding-right:24px}.btn-group .c-action-trigger:last-child,.c-group .c-action-trigger:last-child,.checkbox-inline .c-action-trigger:last-child,.radio-inline .c-action-trigger:last-child{padding-right:0}.btn-group .c-select-button,.c-group .c-select-button,.checkbox-inline .c-select-button,.radio-inline .c-select-button{margin-top:8px}@media only screen and (min-width:320px){.btn-group .btn,.btn-group a.c-button[role=button],.btn-group button.c-button,.c-group .btn,.c-group a.c-button[role=button],.c-group button.c-button,.checkbox-inline .btn,.checkbox-inline a.c-button[role=button],.checkbox-inline button.c-button,.radio-inline .btn,.radio-inline a.c-button[role=button],.radio-inline button.c-button{margin-right:4px}}@media only screen and (min-width:540px){.btn-group .btn,.btn-group a.c-button[role=button],.btn-group button.c-button,.c-group .btn,.c-group a.c-button[role=button],.c-group button.c-button,.checkbox-inline .btn,.checkbox-inline a.c-button[role=button],.checkbox-inline button.c-button,.radio-inline .btn,.radio-inline a.c-button[role=button],.radio-inline button.c-button{margin-right:8px}}[class^=c-heading-]:after,[class^=c-heading-]:before{content:" ";display:table}[class^=c-heading-]:after{clear:both}[class^=c-heading-] a.c-hyperlink{font-size:15px;line-height:20px;float:right;margin-left:12px;font-weight:400}.c-heading-1 a.c-hyperlink{margin-top:45px}.c-heading-2 a.c-hyperlink{margin-top:31px}.c-heading-3 a.c-hyperlink{margin-top:18px}.c-heading-4 a.c-hyperlink{margin-top:8px}.c-heading-5 a.c-hyperlink{margin-top:4px}.c-heading-6 a.c-hyperlink{margin-top:3px}@media (max-width:767px){.c-heading-1 a.c-hyperlink{margin-top:31px}.c-heading-2 a.c-hyperlink{margin-top:18px}.c-heading-3 a.c-hyperlink{margin-top:10px}.c-heading-4 a.c-hyperlink{margin-top:4px}.c-heading-5 a.c-hyperlink{margin-top:3px}.c-heading-6 a.c-hyperlink{margin-top:0}}.c-histogram:after,.c-histogram:before,.histogram:after,.histogram:before{content:" ";display:table}.c-histogram:after,.histogram:after{clear:both}.c-histogram>div:first-child,.histogram>div:first-child{float:left}.c-histogram>div:first-child>div>span,.histogram>div:first-child>div>span{margin-left:4px}.c-histogram>div:first-child>span,.histogram>div:first-child>span{font-size:135px;line-height:1;letter-spacing:-5px;font-weight:100;padding:0}.c-histogram .rating-star-bars,.c-histogram>ul,.histogram .rating-star-bars,.histogram>ul{overflow:hidden;padding-left:28px;margin-top:26px}.c-histogram .rating-star-bars li,.c-histogram>ul li,.histogram .rating-star-bars li,.histogram>ul li{margin-bottom:14px}.c-histogram .rating-star-bars a,.c-histogram>ul a,.histogram .rating-star-bars a,.histogram>ul a{font-size:13px;display:block;line-height:1}.c-histogram .rating-star-bars a>div,.c-histogram>ul a>div,.histogram .rating-star-bars a>div,.histogram>ul a>div{display:inline-block;margin-left:6px;width:calc(100% - 85px)}.c-histogram .rating-star-bars a>div>div,.c-histogram>ul a>div>div,.histogram .rating-star-bars a>div>div,.histogram>ul a>div>div{height:12px;position:relative;background-color:#0078d7;-ms-high-contrast-adjust:none}.c-histogram .rating-star-bars a>div>div span,.c-histogram>ul a>div>div span,.histogram .rating-star-bars a>div>div span,.histogram>ul a>div>div span{position:absolute;right:0;-ms-transform:translateX(100%);-webkit-transform:translateX(100%);transform:translateX(100%);padding-left:4px}.c-histogram .rating-star-bars .c-glyph,.c-histogram .rating-star-bars .glyph,.c-histogram>ul .c-glyph,.c-histogram>ul .glyph,.histogram .rating-star-bars .c-glyph,.histogram .rating-star-bars .glyph,.histogram>ul .c-glyph,.histogram>ul .glyph{margin-left:1px}.c-histogram .rating-star-bars .c-glyph:after,.c-histogram .rating-star-bars .glyph:after,.c-histogram>ul .c-glyph:after,.c-histogram>ul .glyph:after,.histogram .rating-star-bars .c-glyph:after,.histogram .rating-star-bars .glyph:after,.histogram>ul .c-glyph:after,.histogram>ul .glyph:after{-ms-transform:translateY(1px);-webkit-transform:translateY(1px);transform:translateY(1px);content:""}@media only screen and (max-width:539px){.c-histogram>div:first-child,.histogram>div:first-child{float:none}.c-histogram .rating-star-bars,.c-histogram>ul,.histogram .rating-star-bars,.histogram>ul{padding-left:0}}a.c-hyperlink{text-decoration:none;color:#0078d7}a.c-hyperlink:hover,a.c-hyperlink:visited{color:#0078d7;text-decoration:underline}a.c-hyperlink:focus{outline:1px dashed #000}a.c-hyperlink:focus:active{outline-style:none}a.c-hyperlink:active{color:#0078d7;text-decoration:none}.theme-dark .theme-light a.c-hyperlink,.theme-light a.c-hyperlink{text-decoration:underline;color:#000}.theme-dark .theme-light a.c-hyperlink:focus,.theme-light a.c-hyperlink:focus{text-decoration:none;color:#000}.theme-dark .theme-light a.c-hyperlink:visited,.theme-light a.c-hyperlink:visited{color:rgba(0,0,0,.4)}.theme-dark .theme-light a.c-hyperlink:hover,.theme-light a.c-hyperlink:hover{color:rgba(0,0,0,.8)}.theme-dark .theme-light a.c-hyperlink:active,.theme-light a.c-hyperlink:active{color:rgba(0,0,0,.6)}.theme-dark a.c-hyperlink,.theme-light .theme-dark a.c-hyperlink{text-decoration:underline;color:#fff}.theme-dark a.c-hyperlink:focus,.theme-light .theme-dark a.c-hyperlink:focus{text-decoration:none;outline-color:#fff}.theme-dark a.c-hyperlink:visited,.theme-light .theme-dark a.c-hyperlink:visited{color:hsla(0,0%,100%,.4)}.theme-dark a.c-hyperlink:hover,.theme-light .theme-dark a.c-hyperlink:hover{color:hsla(0,0%,100%,.8)}.theme-dark a.c-hyperlink:active,.theme-light .theme-dark a.c-hyperlink:active{color:hsla(0,0%,100%,.6)}.c-glyph:after,.c-glyph:before,.glyph:after,.glyph:before{font-family:MWF-MDL2;display:inline-block;text-decoration:underline}.c-glyph:after,.c-glyph:before,.c-glyph:hover:after,.c-glyph:hover:before,.glyph:after,.glyph:before,.glyph:hover:after,.glyph:hover:before{text-decoration:none}.img-responsive,img.c-image,picture.c-image img{display:block;margin:0;max-width:100%;height:auto}.img-responsive.f-round,img.c-image.f-round{border-radius:50%}nav.c-in-page-navigation{border-bottom:1px solid rgba(0,0,0,.2);display:-ms-flexbox;display:flex}nav.c-in-page-navigation h4{padding:38px 0 12px;margin:0 24px}nav.c-in-page-navigation.f-vertical{border-bottom:0}nav.c-in-page-navigation.f-vertical>ul{white-space:normal}nav.c-in-page-navigation.f-vertical>ul li{display:block}nav.c-in-page-navigation.f-sticky{position:fixed;top:0;left:0;width:100%;background:#fff;z-index:300}nav.c-in-page-navigation.f-sticky.f-vertical{width:auto}nav.c-in-page-navigation.f-sticky.f-vertical.f-dropdown{width:100%;border-bottom:1px solid rgba(0,0,0,.2)}nav.c-in-page-navigation.f-hide{height:0;visibility:hidden}nav.c-in-page-navigation a.f-active,nav.c-in-page-navigation a:active,nav.c-in-page-navigation a:focus,nav.c-in-page-navigation a:hover{color:#000}nav.c-in-page-navigation a:focus{outline:1px dashed #000}nav.c-in-page-navigation .c-select-menu{padding:2px 0;margin:0 24px}nav.c-in-page-navigation .c-select-menu>a{color:#000}nav.c-in-page-navigation>ul{white-space:nowrap}nav.c-in-page-navigation>ul li{display:inline-block}nav.c-in-page-navigation>ul li>a{font-size:15px;color:rgba(0,0,0,.6);padding:12px 0;margin:0 24px;display:inline-block}nav.c-in-page-navigation>ul li>a:hover{color:rgba(0,0,0,.8)}nav.c-in-page-navigation>ul li>a:focus{color:rgba(0,0,0,.8);outline:1px dashed rgba(0,0,0,.8)}nav.c-in-page-navigation>ul li>a:active{color:#000}nav.c-in-page-navigation>ul li>a.f-active{color:rgba(0,0,0,.8)}nav.c-in-page-navigation.f-dropdown{padding-left:20px}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu{position:relative;width:100%}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu.f-border [aria-expanded]{margin-left:8px;-webkit-box-sizing:border-box;box-sizing:border-box;height:100%;border:1px solid rgba(0,0,0,.6)}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu.f-border [aria-expanded]:hover{border-color:rgba(0,0,0,.8)}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu.f-border [aria-expanded]:active,nav.c-in-page-navigation.f-dropdown .f-dropdown-menu.f-border [aria-expanded]:focus{border-color:#0078d7}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu .c-menu{position:absolute;top:100%}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu [aria-expanded=false]+.c-menu[aria-hidden=true],nav.c-in-page-navigation.f-dropdown .f-dropdown-menu [aria-expanded=false]+.dropdown-menu{display:none}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu>a{display:inline-block;color:rgba(0,0,0,.6);-ms-transform:translateX(-8px);-webkit-transform:translateX(-8px);transform:translateX(-8px);padding:12px 24px 12px 0;margin:0 24px}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu>a:after{font-family:MWF-MDL2;content:"";position:absolute;font-size:9px;color:#000;font-weight:700;right:8px;padding-top:7px}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu>a:focus{outline:1px dashed #000}nav.c-in-page-navigation.f-dropdown .f-dropdown-menu>a:focus:hover{outline:none}.js nav.c-in-page-navigation.f-dropdown .f-dropdown-menu>[aria-expanded=true]+.c-menu[aria-hidden=false],.js nav.c-in-page-navigation.f-dropdown .f-dropdown-menu>[aria-expanded=true]+.dropdown-menu,.js nav.c-in-page-navigation.f-dropdown .f-dropdown-menu>span[aria-expanded=true]+.c-menu[aria-hidden=false],.no-js nav.c-in-page-navigation.f-dropdown .f-dropdown-menu:hover .c-menu,.no-js nav.c-in-page-navigation.f-dropdown .f-dropdown-menu:hover .dropdown-menu{display:block}.c-label,label{font-size:13px;display:block;margin-top:21px;padding-bottom:7px;line-height:20px}.c-label+input.c-password[type=password],.c-label+input.c-text-field[type=text],.c-label+input.form-control,label+input.c-password[type=password],label+input.c-text-field[type=text],label+input.form-control{margin:0}.link-navigation,nav.c-link-navigation{margin-top:48px;text-align:center}.link-navigation .c-heading,.link-navigation .text-title,nav.c-link-navigation .c-heading,nav.c-link-navigation .text-title{font-size:20px;line-height:24px;font-weight:200;padding:8px 0 24px}.link-navigation a,.link-navigation a.c-hyperlink,nav.c-link-navigation a,nav.c-link-navigation a.c-hyperlink{display:block}.link-navigation a.c-hyperlink:after,.link-navigation a.c-hyperlink:before,.link-navigation a:after,.link-navigation a:before,nav.c-link-navigation a.c-hyperlink:after,nav.c-link-navigation a.c-hyperlink:before,nav.c-link-navigation a:after,nav.c-link-navigation a:before{content:" ";display:table}.link-navigation a.c-hyperlink:after,.link-navigation a:after,nav.c-link-navigation a.c-hyperlink:after,nav.c-link-navigation a:after{clear:both}.link-navigation p,nav.c-link-navigation p{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:60px;word-wrap:break-word;-o-text-overflow:clip;text-overflow:clip}.link-navigation li,nav.c-link-navigation li{display:inline-block}.link-navigation li a,.link-navigation li a.c-hyperlink,nav.c-link-navigation li a,nav.c-link-navigation li a.c-hyperlink{margin:0 18px;vertical-align:top}.link-navigation li a.c-hyperlink picture,.link-navigation li a picture,nav.c-link-navigation li a.c-hyperlink picture,nav.c-link-navigation li a picture{display:block;margin:0 auto;max-width:400px;max-height:120px}@media only screen and (min-width:768px){.link-navigation li a.c-hyperlink picture,.link-navigation li a picture,nav.c-link-navigation li a.c-hyperlink picture,nav.c-link-navigation li a picture{margin-bottom:12px}}.link-navigation li a.c-hyperlink p,.link-navigation li a p,nav.c-link-navigation li a.c-hyperlink p,nav.c-link-navigation li a p{padding:0 10px;max-width:200px;text-align:center;margin:0 auto}.link-navigation li a.c-hyperlink.f-image,.link-navigation li a.f-image,nav.c-link-navigation li a.c-hyperlink.f-image,nav.c-link-navigation li a.f-image{display:inline-block;margin:0 22px}@media only screen and (max-width:767px){.link-navigation li,nav.c-link-navigation li{clear:both;display:block;height:72px}.link-navigation li a,.link-navigation li a.c-hyperlink,nav.c-link-navigation li a,nav.c-link-navigation li a.c-hyperlink{width:100%;height:100%;padding:12px 0;overflow:hidden;margin:0}.link-navigation li a.c-hyperlink picture,.link-navigation li a picture,nav.c-link-navigation li a.c-hyperlink picture,nav.c-link-navigation li a picture{display:inline-block;max-width:none;max-height:none}.link-navigation li a.c-hyperlink picture img,.link-navigation li a picture img,nav.c-link-navigation li a.c-hyperlink picture img,nav.c-link-navigation li a picture img{width:64px;height:64px;margin:4px}.link-navigation li a.c-hyperlink p,.link-navigation li a p,nav.c-link-navigation li a.c-hyperlink p,nav.c-link-navigation li a p{padding:0 12px 0 8px;text-align:left;max-width:none;display:inline}.link-navigation li a.c-hyperlink.f-image,.link-navigation li a.f-image,nav.c-link-navigation li a.c-hyperlink.f-image,nav.c-link-navigation li a.f-image{text-align:left;padding:0;margin:0}}ol.c-list,ol.list-styled,ul.c-list,ul.list-styled{font-size:15px;line-height:20px;padding-left:19px;padding-right:0;margin:8px 0;list-style-position:outside}ol.c-list li,ol.list-styled li,ul.c-list li,ul.list-styled li{padding:8px 0}ol.c-list.f-lean li,ol.list-styled.f-lean li,ul.c-list.f-lean li,ul.list-styled.f-lean li{padding:0}ol.c-list.f-bare,ol.list-styled.f-bare,ul.c-list.f-bare,ul.list-styled.f-bare,ul.list-unstyled{padding-left:0;list-style-type:none}ul.c-list,ul.list-styled{list-style-type:disc}ol.c-list,ol.list-styled{list-style-type:decimal}.c-logo img+span{position:absolute!important;overflow:hidden!important;clip:rect(1px,1px,1px,1px)!important;width:1px!important;height:1px!important;border:none!important;padding:0!important;margin:0!important}.c-meta-text{color:rgba(0,0,0,.6)}.c-menu-item a,.c-menu-item button,.c-menu-item span,.dropdown-menu>li a,.dropdown-menu>li button,.dropdown-menu>li span{display:block;background:rgba(0,0,0,.05);padding:11px 12px 13px;outline:0;cursor:pointer;white-space:normal}.c-menu-item a:focus,.c-menu-item a:hover,.c-menu-item button:focus,.c-menu-item button:hover,.c-menu-item span:focus,.c-menu-item span:hover,.dropdown-menu>li a:focus,.dropdown-menu>li a:hover,.dropdown-menu>li button:focus,.dropdown-menu>li button:hover,.dropdown-menu>li span:focus,.dropdown-menu>li span:hover{background:rgba(0,0,0,.1)}.c-menu-item a:focus,.c-menu-item button:focus,.c-menu-item span:focus,.dropdown-menu>li a:focus,.dropdown-menu>li button:focus,.dropdown-menu>li span:focus{outline:1px dashed #000}.c-menu-item a:active,.c-menu-item button:active,.c-menu-item span:active,.dropdown-menu>li a:active,.dropdown-menu>li button:active,.dropdown-menu>li span:active{background:rgba(0,0,0,.3)}.c-menu-item a[role=menuitemradio][aria-checked=true],.c-menu-item button[role=menuitemradio][aria-checked=true],.c-menu-item span[role=menuitemradio][aria-checked=true],.dropdown-menu>li a[role=menuitemradio][aria-checked=true],.dropdown-menu>li button[role=menuitemradio][aria-checked=true],.dropdown-menu>li span[role=menuitemradio][aria-checked=true]{background:#0078d7;color:#fff}.c-menu-item.f-sub-menu>a,.c-menu-item.f-sub-menu>button,.dropdown-menu>li.f-sub-menu>a,.dropdown-menu>li.f-sub-menu>button{position:relative}.c-menu-item.f-sub-menu>a:after,.c-menu-item.f-sub-menu>button:after,.dropdown-menu>li.f-sub-menu>a:after,.dropdown-menu>li.f-sub-menu>button:after{font-family:MWF-MDL2;content:"";position:absolute;font-size:6px;right:12px;top:19px}.c-menu-item.f-sub-menu>a+.c-menu,.c-menu-item.f-sub-menu>button+.c-menu,.dropdown-menu>li.f-sub-menu>a+.c-menu,.dropdown-menu>li.f-sub-menu>button+.c-menu{display:none;position:absolute;left:100%;top:0}.c-menu-item.f-sub-menu>a+.c-menu.f-flip,.c-menu-item.f-sub-menu>button+.c-menu.f-flip,.dropdown-menu>li.f-sub-menu>a+.c-menu.f-flip,.dropdown-menu>li.f-sub-menu>button+.c-menu.f-flip{left:-100%}.js .c-menu-item.f-sub-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false],.js .c-menu-item.f-sub-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false],.js .dropdown-menu>li.f-sub-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false],.js .dropdown-menu>li.f-sub-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false],.no-js .c-menu-item.f-sub-menu>a:focus+.c-menu,.no-js .c-menu-item.f-sub-menu>a:hover+.c-menu,.no-js .c-menu-item.f-sub-menu>button:focus+.c-menu,.no-js .c-menu-item.f-sub-menu>button:hover+.c-menu,.no-js .dropdown-menu>li.f-sub-menu>a:focus+.c-menu,.no-js .dropdown-menu>li.f-sub-menu>a:hover+.c-menu,.no-js .dropdown-menu>li.f-sub-menu>button:focus+.c-menu,.no-js .dropdown-menu>li.f-sub-menu>button:hover+.c-menu{display:block;-webkit-animation:fadeIn .3s cubic-bezier(.68,-.55,.265,1.55);animation:fadeIn .3s cubic-bezier(.68,-.55,.265,1.55)}.c-menu,.dropdown-menu{position:relative;z-index:500;width:296px;min-width:64px;max-width:368px;padding:0;margin:0;background:#fff;border:1px solid rgba(0,0,0,.1);border-top:0;background-clip:padding-box}.c-menu .c-menu-item [aria-checked=true],.dropdown-menu .c-menu-item [aria-checked=true]{background:#0078d7;color:#fff}.theme-dark .c-menu,.theme-dark .dropdown-menu,.theme-dark .theme-light .c-menu,.theme-dark .theme-light .dropdown-menu,.theme-light .c-menu,.theme-light .dropdown-menu,.theme-light .theme-dark .c-menu,.theme-light .theme-dark .dropdown-menu{color:#000}.c-mosaic{max-width:2048px;margin:0 auto}.c-mosaic [data-f-mosaic]>picture{z-index:0;position:relative;display:block;overflow:hidden;width:100%;height:100%}.c-mosaic [data-f-mosaic]>picture img{position:absolute;left:50%;top:50%;-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.c-mosaic:after,.c-mosaic:before,.c-mosaic [data-f-mosaic*=f-vp]:after,.c-mosaic [data-f-mosaic*=f-vp]:before{content:" ";display:table}.c-mosaic:after,.c-mosaic [data-f-mosaic*=f-vp]:after{clear:both}.c-mosaic [data-f-mosaic*=f-vp]{float:left}.c-mosaic [data-f-mosaic~=f-vp1-whole]{width:100%}.c-mosaic [data-f-mosaic~=f-vp1-half]{width:50%}.c-mosaic [data-f-mosaic~=f-height-small]{height:150px}.c-mosaic [data-f-mosaic~=f-height-large],.c-mosaic [data-f-mosaic~=f-height-medium]{height:300px}@media only screen and (min-width:540px){.c-mosaic [data-f-mosaic~=f-vp2-whole]{width:100%}.c-mosaic [data-f-mosaic~=f-vp2-half]{width:50%}}@media only screen and (min-width:768px){.c-mosaic [data-f-mosaic~=f-vp3-whole]{width:100%}.c-mosaic [data-f-mosaic~=f-vp3-half]{width:50%}.c-mosaic [data-f-mosaic~=f-height-small]{height:200px}.c-mosaic [data-f-mosaic~=f-height-large],.c-mosaic [data-f-mosaic~=f-height-medium]{height:400px}}@media only screen and (min-width:1084px){.c-mosaic [data-f-mosaic~=f-vp4-whole]{width:100%}.c-mosaic [data-f-mosaic~=f-vp4-half]{width:50%}.c-mosaic [data-f-mosaic~=f-height-large]{height:800px}}.c-pagination,.pagination{display:-ms-flexbox;display:flex;-ms-flex:0 0 auto;flex:0 0 auto;padding:0;margin-top:24px;-ms-flex-direction:row;flex-direction:row}.c-pagination li,.pagination li{display:inline-block;margin-right:12px}.c-pagination li>a,.c-pagination li>span,.pagination li>a,.pagination li>span{display:inline-block;padding:5px 11px;outline:1px solid transparent;white-space:nowrap}.c-pagination li>a:focus,.c-pagination li>span:focus,.pagination li>a:focus,.pagination li>span:focus{background-color:rgba(0,0,0,.1);outline:1px dashed #000}.c-pagination li>a:hover,.pagination li>a:hover{background-color:rgba(0,0,0,.1);outline-color:rgba(0,0,0,.1)}.c-pagination li>a:active,.pagination li>a:active{background-color:rgba(0,0,0,.3);outline:1px solid rgba(0,0,0,.3)}.c-pagination li.active>a,.c-pagination li.active>span,.c-pagination li.f-active>a,.c-pagination li.f-active>span,.pagination li.active>a,.pagination li.active>span,.pagination li.f-active>a,.pagination li.f-active>span{outline-color:#0078d7}.c-pagination li.f-hide,.pagination li.f-hide{display:none}.c-pagination li:first-child .c-glyph:before,.pagination li:first-child .c-glyph:before{content:"";vertical-align:-2px;margin-right:8px}.c-pagination li:last-child .c-glyph:after,.pagination li:last-child .c-glyph:after{content:"";vertical-align:-2px;margin-left:8px}@media only screen and (max-width:539px){.c-pagination li:first-child a,.c-pagination li:last-child a,.pagination li:first-child a,.pagination li:last-child a{position:relative;text-indent:-9999px}.c-pagination li:first-child .c-glyph:after,.c-pagination li:first-child .c-glyph:before,.c-pagination li:last-child .c-glyph:after,.c-pagination li:last-child .c-glyph:before,.pagination li:first-child .c-glyph:after,.pagination li:first-child .c-glyph:before,.pagination li:last-child .c-glyph:after,.pagination li:last-child .c-glyph:before{position:absolute;top:8px;left:9999px}}[class*=c-paragraph].f-lean{padding:0}input.c-password[type=password],input.form-control{display:block;width:276px;height:36px;margin-top:20px;padding:7px 10px;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid rgba(0,0,0,.6);outline:0;background-color:#fff}input.c-password[type=password].f-small,input.form-control.f-small{width:88px}input.c-password[type=password].f-flex,input.form-control.f-flex{width:100%;min-width:88px;max-width:400px}input.c-password[type=password]:hover,input.form-control:hover{border-color:rgba(0,0,0,.8)}input.c-password[type=password]:active,input.c-password[type=password]:focus,input.form-control:active,input.form-control:focus{border-color:#0078d7}input.c-password[type=password][disabled],input.form-control[disabled]{cursor:not-allowed;color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}input.c-password[type=password][readonly],input.form-control[readonly]{border:1px solid rgba(0,0,0,.6);background-color:#e6e6e6}.c-pivot>header{display:-ms-flexbox;display:flex}.c-pivot>header>a{font-size:20px;display:inline-block;-ms-flex-negative:0;flex-shrink:0;font-weight:200;white-space:nowrap;padding:5px 12px 1px;color:rgba(0,0,0,.6)}.c-pivot>header>a:first-child{padding-left:0}.c-pivot>header>a.f-active{color:#000}.c-pivot>header>a:hover{color:rgba(0,0,0,.8)}.c-pivot>header>a:focus{outline:1px dashed}.c-pivot>section[aria-hidden=true]{display:none;overflow:hidden}.c-pivot>section[aria-hidden=false]{display:block}.c-pivot.f-disabled>header>a{color:rgba(0,0,0,.2);cursor:not-allowed}.c-mosaic-placement{position:relative;display:block;overflow:hidden;padding-bottom:19px;width:100%;height:100%}.c-mosaic-placement.f-background-neutral-00{background:#fff}.c-mosaic-placement.f-background-neutral-10{background:#e3e3e3}.c-mosaic-placement.f-background-neutral-20{background:#c8c8c8}.c-mosaic-placement.f-background-neutral-30{background:#acacac}.c-mosaic-placement.f-background-neutral-45{background:#919191}.c-mosaic-placement.f-background-neutral-55{background:#767676}.c-mosaic-placement.f-background-neutral-65{background:#5e5e5e}.c-mosaic-placement.f-background-neutral-75{background:#464646}.c-mosaic-placement.f-background-neutral-80{background:#2f2f2f}.c-mosaic-placement.f-background-neutral-90{background:#171717}.c-mosaic-placement.f-background-neutral-100{background:#000}.c-mosaic-placement.f-background-accent{background:#0078d7}.c-mosaic-placement[class*=f-mask]>picture:before{position:absolute;top:0;left:0;right:0;bottom:0;content:"";z-index:1}.theme-dark .theme-light .c-mosaic-placement.f-mask-10>picture:before,.theme-light .c-mosaic-placement.f-mask-10>picture:before{background:hsla(0,0%,100%,.1)}.theme-dark .theme-light .c-mosaic-placement.f-mask-20>picture:before,.theme-light .c-mosaic-placement.f-mask-20>picture:before{background:hsla(0,0%,100%,.2)}.theme-dark .theme-light .c-mosaic-placement.f-mask-40>picture:before,.theme-light .c-mosaic-placement.f-mask-40>picture:before{background:hsla(0,0%,100%,.4)}.theme-dark .theme-light .c-mosaic-placement.f-mask-60>picture:before,.theme-light .c-mosaic-placement.f-mask-60>picture:before{background:hsla(0,0%,100%,.6)}.theme-dark .theme-light .c-mosaic-placement.f-mask-80>picture:before,.theme-light .c-mosaic-placement.f-mask-80>picture:before{background:hsla(0,0%,100%,.8)}.theme-dark .theme-light .c-mosaic-placement.f-mask-100>picture:before,.theme-light .c-mosaic-placement.f-mask-100>picture:before{background:#fff}.theme-dark .c-mosaic-placement.f-mask-10>picture:before,.theme-light .theme-dark .c-mosaic-placement.f-mask-10>picture:before{background:rgba(0,0,0,.1)}.theme-dark .c-mosaic-placement.f-mask-20>picture:before,.theme-light .theme-dark .c-mosaic-placement.f-mask-20>picture:before{background:rgba(0,0,0,.2)}.theme-dark .c-mosaic-placement.f-mask-40>picture:before,.theme-light .theme-dark .c-mosaic-placement.f-mask-40>picture:before{background:rgba(0,0,0,.4)}.theme-dark .c-mosaic-placement.f-mask-60>picture:before,.theme-light .theme-dark .c-mosaic-placement.f-mask-60>picture:before{background:rgba(0,0,0,.6)}.theme-dark .c-mosaic-placement.f-mask-80>picture:before,.theme-light .theme-dark .c-mosaic-placement.f-mask-80>picture:before{background:rgba(0,0,0,.8)}.theme-dark .c-mosaic-placement.f-mask-100>picture:before,.theme-light .theme-dark .c-mosaic-placement.f-mask-100>picture:before{background:#000}.c-mosaic-placement .c-video{height:400px;width:100%;max-width:100%;overflow:hidden;left:0;top:0;position:absolute}.c-mosaic-placement .c-video>h1{display:none}.c-mosaic-placement .c-video video{min-width:100%;min-height:100%;height:auto;width:auto;z-index:-2;background-size:cover;overflow:hidden;position:absolute;left:0;top:0}.c-mosaic-placement .c-heading{font-weight:200;max-height:48px;padding:35px 0 1.636px;font-weight:700}.c-mosaic-placement .c-heading,.c-mosaic-placement .c-subheading{font-size:20px;line-height:24px;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box}.c-mosaic-placement .c-subheading{max-height:72px;padding-bottom:1.636px;font-weight:200;padding-top:0}.c-mosaic-placement a.c-call-to-action{color:#0078d7;border-width:2px;padding:10px 44px 7px 24px;margin-left:-24px;margin-right:-24px}.c-mosaic-placement a.c-call-to-action,.c-mosaic-placement a.c-call-to-action:focus,.c-mosaic-placement a.c-call-to-action:hover{background:transparent;border-color:transparent}.c-mosaic-placement a.c-call-to-action:active{background:transparent;text-decoration:none}.c-mosaic-placement a.c-call-to-action span:hover{text-decoration:underline}.theme-dark .theme-light .c-mosaic-placement a.c-call-to-action,.theme-light .c-mosaic-placement a.c-call-to-action{color:#000;background:transparent;border-color:transparent}.theme-dark .theme-light .c-mosaic-placement a.c-call-to-action:active,.theme-light .c-mosaic-placement a.c-call-to-action:active{color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-mosaic-placement a.c-call-to-action:focus,.theme-light .c-mosaic-placement a.c-call-to-action:focus{outline-color:#000}.theme-dark .c-mosaic-placement a.c-call-to-action,.theme-light .theme-dark .c-mosaic-placement a.c-call-to-action{color:#fff;background:transparent;border-color:transparent}.theme-dark .c-mosaic-placement a.c-call-to-action:active,.theme-light .theme-dark .c-mosaic-placement a.c-call-to-action:active{color:hsla(0,0%,100%,.6)}.theme-dark .c-mosaic-placement a.c-call-to-action:focus,.theme-light .theme-dark .c-mosaic-placement a.c-call-to-action:focus{outline-color:#fff}.c-mosaic-placement .c-group,.c-mosaic-placement picture,.c-mosaic-placement picture:after{position:absolute;left:0;right:0;bottom:0;top:0}.c-mosaic-placement picture:after{content:"";display:block}.c-mosaic-placement .c-group{display:block;top:auto;text-align:center;height:42px}.c-mosaic-placement picture{z-index:0;overflow:hidden}.c-mosaic-placement picture img{position:absolute;left:50%;top:50%;-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.c-mosaic-placement picture:after{z-index:1}.theme-dark .theme-light .c-mosaic-placement picture:after,.theme-light .c-mosaic-placement picture:after{background-color:hsla(0,0%,100%,.2)}.theme-dark .c-mosaic-placement picture:after,.theme-light .theme-dark .c-mosaic-placement picture:after{background-color:rgba(0,0,0,.2)}.c-mosaic-placement>div{position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:100;text-align:center}.c-mosaic-placement>div>div{display:block;position:absolute;left:0;right:0;bottom:0;top:auto;text-align:center;height:42px}.c-mosaic-placement.f-height-large.f-width-small{padding:0 12.5% 19px}.c-mosaic-placement.f-height-large.f-width-large{padding:0 25% 19px}.c-mosaic-placement.f-height-medium .c-heading,.c-mosaic-placement.f-height-medium .c-subheading{display:none}.c-mosaic-placement.f-height-medium.f-width-large{padding:0 12.5% 19px}.c-mosaic-placement.f-height-medium .c-video{height:200px}.c-price:after,.c-price:before{content:" ";display:table}.c-price:after{clear:both}.c-price .c-label{font-size:15px;padding:0 4px;display:inline;margin:0;float:left}.c-price meta+span,.c-price s,.c-price span{float:left}progress.c-progress[value]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;min-width:296px;height:4px}progress.c-progress::-webkit-progress-bar{background:rgba(0,0,0,.2)}progress.c-progress::-webkit-progress-value{background:#0078d7}progress.c-progress::-moz-progress-bar{background:#0078d7}progress.c-progress>[role=progressbar]{display:block;position:relative;background:rgba(0,0,0,.2);min-width:296px;width:100%;height:4px}progress.c-progress>[role=progressbar]>span{display:block;position:relative;height:100%;background:#0078d7;color:#0078d7}.c-progress{display:block;margin-top:12px}.c-progress.f-indeterminate-regional{position:relative;min-width:296px;width:100%}.c-progress.f-indeterminate-regional span{position:absolute;display:inline-block;opacity:0;-webkit-animation:dots 4s infinite;animation:dots 4s infinite}.c-progress.f-indeterminate-regional span:after{content:"";position:absolute;display:inline-block;background:#0078d7;width:5px;height:5px;border-radius:50%}.c-progress.f-indeterminate-regional span:first-child{-webkit-animation-delay:.05s;animation-delay:.05s}.c-progress.f-indeterminate-regional span:first-child:after{left:-10px}.c-progress.f-indeterminate-regional span:nth-child(2){-webkit-animation-delay:.1s;animation-delay:.1s}.c-progress.f-indeterminate-regional span:nth-child(2):after{left:-20px}.c-progress.f-indeterminate-regional span:nth-child(3){-webkit-animation-delay:.15s;animation-delay:.15s}.c-progress.f-indeterminate-regional span:nth-child(3):after{left:-30px}.c-progress.f-indeterminate-regional span:nth-child(4){-webkit-animation-delay:.2s;animation-delay:.2s}.c-progress.f-indeterminate-regional span:nth-child(4):after{left:-40px}.c-progress.f-indeterminate-regional span:nth-child(5){-webkit-animation-delay:.25s;animation-delay:.25s}.c-progress.f-indeterminate-regional span:nth-child(5):after{left:-50px}@-webkit-keyframes dots{0%,20%{left:0;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out;opacity:0}25%{opacity:1}35%{left:45%;-webkit-animation-timing-function:linear;animation-timing-function:linear}65%{left:55%;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}75%{opacity:1}80%,to{left:100%;opacity:0}}@keyframes dots{0%,20%{left:0;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out;opacity:0}25%{opacity:1}35%{left:45%;-webkit-animation-timing-function:linear;animation-timing-function:linear}65%{left:55%;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}75%{opacity:1}80%,to{left:100%;opacity:0}}.c-progress.f-indeterminate-local{position:relative}.c-progress.f-indeterminate-local span{position:absolute;-ms-transform:rotate(225deg);-webkit-transform:rotate(225deg);transform:rotate(225deg);-webkit-animation:orbit 5.5s infinite;animation:orbit 5.5s infinite}.c-progress.f-indeterminate-local span:after{content:"";position:absolute;border-radius:100%;background:#0078d7}.c-progress.f-indeterminate-local span:nth-child(2){-webkit-animation-delay:.24s;animation-delay:.24s}.c-progress.f-indeterminate-local span:nth-child(3){-webkit-animation-delay:.48s;animation-delay:.48s}.c-progress.f-indeterminate-local span:nth-child(4){-webkit-animation-delay:.72s;animation-delay:.72s}.c-progress.f-indeterminate-local span:nth-child(5){-webkit-animation-delay:.96s;animation-delay:.96s}.c-progress.f-indeterminate-local.f-progress-large,.c-progress.f-indeterminate-local.f-progress-large span{width:60px;height:60px}.c-progress.f-indeterminate-local.f-progress-large span:after{width:6px;height:6px}.c-progress.f-indeterminate-local.f-progress-small{width:20px;height:20px}.c-progress.f-indeterminate-local.f-progress-small span{width:25px;height:25px}.c-progress.f-indeterminate-local.f-progress-small span:after{width:3px;height:3px}@-webkit-keyframes orbit{0%{-webkit-transform:rotate(225deg);transform:rotate(225deg);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}7%{-webkit-transform:rotate(345deg);transform:rotate(345deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}30%{-webkit-transform:rotate(455deg);transform:rotate(455deg);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}39%{-webkit-transform:rotate(690deg);transform:rotate(690deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}70%{-webkit-transform:rotate(815deg);transform:rotate(815deg);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}75%{-webkit-transform:rotate(945deg);transform:rotate(945deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}76%{-webkit-transform:rotate(945deg);transform:rotate(945deg);opacity:0}to{-webkit-transform:rotate(945deg);transform:rotate(945deg);opacity:0}}@keyframes orbit{0%{-webkit-transform:rotate(225deg);transform:rotate(225deg);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}7%{-webkit-transform:rotate(345deg);transform:rotate(345deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}30%{-webkit-transform:rotate(455deg);transform:rotate(455deg);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}39%{-webkit-transform:rotate(690deg);transform:rotate(690deg);-webkit-animation-timing-function:linear;animation-timing-function:linear}70%{-webkit-transform:rotate(815deg);transform:rotate(815deg);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}75%{-webkit-transform:rotate(945deg);transform:rotate(945deg);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}76%{-webkit-transform:rotate(945deg);transform:rotate(945deg);opacity:0}to{-webkit-transform:rotate(945deg);transform:rotate(945deg);opacity:0}}.c-rating span.c-glyph{width:16px;height:16px;line-height:1}.c-rating span.c-glyph:after,.c-rating span.c-glyph:before{font-size:12px}.c-rating button.c-glyph{width:44px;height:44px;border:0;background:transparent}.c-rating button.c-glyph:after,.c-rating button.c-glyph:before{font-size:24px}.c-rating button.c-glyph:focus{outline:none}.c-rating button.c-glyph:focus:before{outline:1px dashed #000}.c-rating.f-individual{-ms-transform:translateX(-4px);-webkit-transform:translateX(-4px);transform:translateX(-4px)}.c-rating.f-individual span.c-glyph{width:30px;height:30px}.c-rating.f-individual span.c-glyph:after,.c-rating.f-individual span.c-glyph:before{font-size:18px}.c-rating .c-glyph{position:relative;float:left}.c-rating .c-glyph:after,.c-rating .c-glyph:before{position:absolute;top:50%;left:50%;-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.c-rating .c-glyph:before{font-family:MWF-MDL2;content:"";color:rgba(0,0,0,.3)}.c-rating .c-glyph:after{color:#000}.c-rating div,.c-rating form{display:inline-block}.c-rating div:after,.c-rating div:before,.c-rating form:after,.c-rating form:before{content:" ";display:table}.c-rating div:after,.c-rating form:after{clear:both}.c-rating div{-ms-transform:translateX(-2px);-webkit-transform:translateX(-2px);transform:translateX(-2px)}.c-rating form{-ms-transform:translateX(-7px);-webkit-transform:translateX(-7px);transform:translateX(-7px)}.c-rating form:hover button.c-glyph:before{font-family:MWF-MDL2;content:"";color:#000}.c-rating form:hover button.c-glyph:after{display:none}.c-rating form:hover button.c-glyph:hover~button.c-glyph:before{color:rgba(0,0,0,.3)}.c-rating form[disabled] button.c-glyph:hover{cursor:not-allowed}.c-rating form[disabled] button.c-glyph:hover~button.c-glyph:before{color:rgba(0,0,0,.2)}.c-rating form[disabled] button.c-glyph:after{display:none}.c-rating form[disabled] button.c-glyph:before{font-family:MWF-MDL2;content:"";color:rgba(0,0,0,.2)}.c-rating.f-community-rated .c-glyph:before,.c-rating.f-community-rated .f-full:after{font-family:MWF-MDL2;content:""}.c-rating.f-community-rated .f-half:after{font-family:MWF-MDL2;content:""}.c-rating.f-community-rated.f-user-rated .f-full:after,.c-rating.f-community-rated.f-user-rated .f-half:after{color:#0078d7}.theme-dark .theme-light .c-rating .c-glyph:before,.theme-light .c-rating .c-glyph:before{color:rgba(0,0,0,.3)}.theme-dark .theme-light .c-rating .c-glyph:after,.theme-light .c-rating .c-glyph:after{color:#000}.theme-dark .theme-light .c-rating form button.c-glyph:focus:before,.theme-light .c-rating form button.c-glyph:focus:before{outline-color:#000}.theme-dark .theme-light .c-rating form button.c-glyph:before,.theme-light .c-rating form button.c-glyph:before{color:rgba(0,0,0,.3)}.theme-dark .theme-light .c-rating form button.c-glyph:after,.theme-light .c-rating form button.c-glyph:after{color:#000}.theme-dark .theme-light .c-rating form:hover button.c-glyph:before,.theme-light .c-rating form:hover button.c-glyph:before{color:rgba(0,0,0,.8)}.theme-dark .theme-light .c-rating form:hover button.c-glyph:hover~button.c-glyph:before,.theme-light .c-rating form:hover button.c-glyph:hover~button.c-glyph:before{color:rgba(0,0,0,.3)}.theme-dark .theme-light .c-rating form[disabled] button.c-glyph:before,.theme-dark .theme-light .c-rating form[disabled] button.c-glyph:hover~button.c-glyph:before,.theme-light .c-rating form[disabled] button.c-glyph:before,.theme-light .c-rating form[disabled] button.c-glyph:hover~button.c-glyph:before{color:rgba(0,0,0,.2)}.theme-dark .theme-light .c-rating.f-community-rated.f-user-rated .f-full:after,.theme-dark .theme-light .c-rating.f-community-rated.f-user-rated .f-half:after,.theme-light .c-rating.f-community-rated.f-user-rated .f-full:after,.theme-light .c-rating.f-community-rated.f-user-rated .f-half:after{color:#000}.theme-dark .c-rating .c-glyph:before,.theme-light .theme-dark .c-rating .c-glyph:before{color:hsla(0,0%,100%,.3)}.theme-dark .c-rating .c-glyph:after,.theme-light .theme-dark .c-rating .c-glyph:after{color:#fff}.theme-dark .c-rating form button.c-glyph:focus:before,.theme-light .theme-dark .c-rating form button.c-glyph:focus:before{outline-color:#fff}.theme-dark .c-rating form button.c-glyph:before,.theme-light .theme-dark .c-rating form button.c-glyph:before{color:hsla(0,0%,100%,.3)}.theme-dark .c-rating form button.c-glyph:after,.theme-light .theme-dark .c-rating form button.c-glyph:after{color:#fff}.theme-dark .c-rating form:hover button.c-glyph:before,.theme-light .theme-dark .c-rating form:hover button.c-glyph:before{color:hsla(0,0%,100%,.8)}.theme-dark .c-rating form:hover button.c-glyph:hover~button.c-glyph:before,.theme-light .theme-dark .c-rating form:hover button.c-glyph:hover~button.c-glyph:before{color:hsla(0,0%,100%,.3)}.theme-dark .c-rating form[disabled] button.c-glyph:before,.theme-dark .c-rating form[disabled] button.c-glyph:hover~button.c-glyph:before,.theme-light .theme-dark .c-rating form[disabled] button.c-glyph:before,.theme-light .theme-dark .c-rating form[disabled] button.c-glyph:hover~button.c-glyph:before{color:hsla(0,0%,100%,.2)}.theme-dark .c-rating.f-community-rated.f-user-rated .f-full:after,.theme-dark .c-rating.f-community-rated.f-user-rated .f-half:after,.theme-light .theme-dark .c-rating.f-community-rated.f-user-rated .f-full:after,.theme-light .theme-dark .c-rating.f-community-rated.f-user-rated .f-half:after{color:#fff}@media screen and (-ms-high-contrast:active){.c-rating.f-community-rated .c-glyph:before,.c-rating form:hover button.c-glyph:hover~button.c-glyph:before{font-family:MWF-MDL2;content:""}}.c-radio .c-label,.radio .c-label{font-size:15px;line-height:20px;margin-right:24px;padding-bottom:0;position:relative}.c-radio input[type=radio],.radio input[type=radio]{float:left;opacity:0}.c-radio input[type=radio]+span,.radio input[type=radio]+span{cursor:pointer;display:inline-block;margin-left:28px}.c-radio input[type=radio]+span:before,.radio input[type=radio]+span:before{border:1px solid #000;border-radius:50%;height:20px;width:20px;content:"";left:0;position:absolute;top:0}.c-radio input[type=radio]:hover:not(:disabled)+span:before,.radio input[type=radio]:hover:not(:disabled)+span:before{border-color:rgba(0,0,0,.8)}.c-radio input[type=radio]:focus+span:before,.radio input[type=radio]:focus+span:before{outline:1px dashed rgba(0,0,0,.8)}.c-radio input[type=radio]:checked+span:after,.radio input[type=radio]:checked+span:after{background:currentColor;border-radius:50%;height:10px;width:10px;content:"";left:5px;position:absolute;top:5px}@media screen and (-ms-high-contrast:active){.c-radio input[type=radio]:checked+span:after,.radio input[type=radio]:checked+span:after{border:5px solid}}.c-radio input[type=radio]:checked:not(:disabled)+span,.radio input[type=radio]:checked:not(:disabled)+span{color:#000}.c-radio input[type=radio]:checked:not(:disabled)+span:before,.radio input[type=radio]:checked:not(:disabled)+span:before{border-color:#0078d7}.c-radio input[type=radio]:checked:not(:disabled):hover+span:after,.radio input[type=radio]:checked:not(:disabled):hover+span:after{background:rgba(0,0,0,.6)}.c-radio input[type=radio]:disabled+span,.radio input[type=radio]:disabled+span{color:rgba(0,0,0,.2);cursor:not-allowed}.c-radio input[type=radio]:disabled+span:before,.radio input[type=radio]:disabled+span:before{border-color:rgba(0,0,0,.2)}a.c-refine-item,button.c-refine-item{position:relative;display:block;padding:12px;border:0;width:100%;background:transparent;color:rgba(0,0,0,.6)}a.c-refine-item span,button.c-refine-item span{text-align:left;display:block;overflow:hidden;white-space:nowrap}a.c-refine-item:after,button.c-refine-item:after{font-family:MWF-MDL2;content:"";position:absolute;right:0;top:16px;display:none;width:44px;font-size:13px;text-align:center}a.c-refine-item:focus,button.c-refine-item:focus{outline:1px dashed #000}a.c-refine-item:hover,button.c-refine-item:hover{background:rgba(0,0,0,.1)}a.c-refine-item:active,button.c-refine-item:active{background:rgba(0,0,0,.3)}a[aria-checked=true].c-refine-item,a[aria-selected=true].c-refine-item,button[aria-checked=true].c-refine-item,button[aria-selected=true].c-refine-item{padding-right:44px;background:rgba(0,0,0,.1);font-weight:600;color:#000}a[aria-checked=true].c-refine-item:hover,a[aria-selected=true].c-refine-item:hover,button[aria-checked=true].c-refine-item:hover,button[aria-selected=true].c-refine-item:hover{background:rgba(0,0,0,.2)}a[aria-checked=true].c-refine-item:active,a[aria-selected=true].c-refine-item:active,button[aria-checked=true].c-refine-item:active,button[aria-selected=true].c-refine-item:active{background:rgba(0,0,0,.3)}a[aria-checked=true].c-refine-item:after,a[aria-selected=true].c-refine-item:after,button[aria-checked=true].c-refine-item:after,button[aria-selected=true].c-refine-item:after{display:inline-block}.c-refine-menu>button{display:none}.c-refine-menu>div>div{position:relative}.c-refine-menu>div>div .c-heading{font-size:24px;line-height:28px;padding:36px 0 4px;font-weight:200;display:inline-block;overflow:hidden;margin-left:12px}.c-refine-menu>div>div .c-heading+a.c-action-trigger.c-glyph,.c-refine-menu>div>div .c-heading+button.c-action-trigger.c-glyph{display:none;position:absolute;top:26px;right:0;width:44px;height:44px;margin:0 -12px 0 0;padding:9px 0 10px;color:rgba(0,0,0,.6)}.c-refine-menu .c-divider{margin:12px 0}.c-refine-menu .c-drawer{margin:0}@media only screen and (max-width:767px){.c-refine-menu>div>div .c-heading{padding-right:44px}.c-refine-menu>div>div .c-heading+button.c-action-trigger.c-glyph{display:block}}.c-search{position:relative;min-width:92px;max-width:296px;height:38px;margin-top:20px}.c-search button,.c-search input[type=search]{float:left;height:100%;outline:0;background-color:#fff}.c-search input[type=search]{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;padding:7px 38px 7px 10px;border:1px solid rgba(0,0,0,.6)}.c-search input[type=search]:hover{border-color:rgba(0,0,0,.8)}.c-search input[type=search]:active,.c-search input[type=search]:focus{border-color:#0078d7}.c-search input[type=search]::-ms-clear{display:none}.c-search button{position:absolute;top:0;right:0;width:34px;height:34px;margin:2px 1px 1px;padding:9px;-webkit-transition:color .1s,background-color .1s;-o-transition:color .1s,background-color .1s;transition:color .1s,background-color .1s;border:0}.c-search button:hover{color:#0078d7}.c-search button:active,.c-search button:focus{color:#fff;background:#0078d7}.c-search button:before{content:"";text-indent:0;font-size:16px}.btn,button.c-select-button{font-size:15px;margin-top:36px;margin-right:12px;background:#fff;border:1px solid rgba(0,0,0,.4);color:#000;padding:6px 10px;overflow:hidden;text-align:center;white-space:nowrap}.btn[aria-pressed=true],button.c-select-button[aria-pressed=true]{border-width:2px;border-color:#000;padding:5px 9px}.btn:focus,button.c-select-button:focus{outline:1px dashed #000}.btn:hover,button.c-select-button:hover{outline:1px dashed #000;border-color:#000}.btn:hover[aria-pressed=true],button.c-select-button:hover[aria-pressed=true]{border-color:#004881}.btn:active,button.c-select-button:active{outline:none;border-color:#004881}.btn[disabled],button.c-select-button[disabled]{border-color:rgba(0,0,0,.2);color:rgba(0,0,0,.2);outline:0;cursor:not-allowed}.btn[data-select-button-swatch],button.c-select-button[data-select-button-swatch]{width:36px;height:36px}.btn[data-select-button-swatch]:focus,.btn[data-select-button-swatch]:hover,button.c-select-button[data-select-button-swatch]:focus,button.c-select-button[data-select-button-swatch]:hover{border-color:#000;-webkit-box-shadow:inset 0 0 0 1px #fff;box-shadow:inset 0 0 0 1px #fff}.btn[data-select-button-swatch]:active,button.c-select-button[data-select-button-swatch]:active{border-color:#999;-webkit-box-shadow:inset 0 0 0 1px #fff;box-shadow:inset 0 0 0 1px #fff}.btn[data-select-button-swatch][aria-pressed=true],button.c-select-button[data-select-button-swatch][aria-pressed=true]{-webkit-box-shadow:inset 0 0 0 1px #fff;box-shadow:inset 0 0 0 1px #fff}.btn[data-select-button-swatch][aria-pressed=true]:focus,.btn[data-select-button-swatch][aria-pressed=true]:hover,button.c-select-button[data-select-button-swatch][aria-pressed=true]:focus,button.c-select-button[data-select-button-swatch][aria-pressed=true]:hover{border-color:#999;outline:1px dashed #000;-webkit-box-shadow:inset 0 0 0 1px #fff;box-shadow:inset 0 0 0 1px #fff}.btn.f-swatch-disabled,button.c-select-button.f-swatch-disabled{position:relative}.btn.f-swatch-disabled:focus,.btn.f-swatch-disabled:hover,button.c-select-button.f-swatch-disabled:focus,button.c-select-button.f-swatch-disabled:hover{outline:0;-webkit-box-shadow:none;box-shadow:none;border:1px solid rgba(0,0,0,.2)}.btn.f-swatch-disabled:before,button.c-select-button.f-swatch-disabled:before{position:absolute;content:"";left:-25%;top:50%;right:-25%;border-top:1px solid;border-color:inherit;-ms-transform:rotate(-45deg);-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.btn.f-swatch-disabled-dark,button.c-select-button.f-swatch-disabled-dark{border-color:hsla(0,0%,100%,.2)}.btn.f-swatch-disabled-dark:focus,.btn.f-swatch-disabled-dark:hover,button.c-select-button.f-swatch-disabled-dark:focus,button.c-select-button.f-swatch-disabled-dark:hover{outline:0;-webkit-box-shadow:none;box-shadow:none;border:1px solid hsla(0,0%,100%,.2)}.theme-dark .theme-light .btn,.theme-dark .theme-light button.c-select-button,.theme-light .btn,.theme-light button.c-select-button{background:hsla(0,0%,100%,0);border-color:rgba(0,0,0,.4);color:#000}.theme-dark .theme-light .btn[aria-pressed=true],.theme-dark .theme-light button.c-select-button[aria-pressed=true],.theme-light .btn[aria-pressed=true],.theme-light button.c-select-button[aria-pressed=true]{border-color:#000}.theme-dark .theme-light .btn:focus,.theme-dark .theme-light button.c-select-button:focus,.theme-light .btn:focus,.theme-light button.c-select-button:focus{outline-color:#000}.theme-dark .theme-light .btn:hover,.theme-dark .theme-light button.c-select-button:hover,.theme-light .btn:hover,.theme-light button.c-select-button:hover{border-color:#000}.theme-dark .theme-light .btn:active,.theme-dark .theme-light button.c-select-button:active,.theme-light .btn:active,.theme-light button.c-select-button:active{background:rgba(0,0,0,.4);outline:none}.theme-dark .theme-light .btn[disabled],.theme-dark .theme-light button.c-select-button[disabled],.theme-light .btn[disabled],.theme-light button.c-select-button[disabled]{border-color:rgba(0,0,0,.2);color:rgba(0,0,0,.2)}.theme-dark .btn,.theme-dark button.c-select-button,.theme-light .theme-dark .btn,.theme-light .theme-dark button.c-select-button{background:hsla(0,0%,100%,0);border-color:hsla(0,0%,100%,.4);color:#fff}.theme-dark .btn[aria-pressed=true],.theme-dark button.c-select-button[aria-pressed=true],.theme-light .theme-dark .btn[aria-pressed=true],.theme-light .theme-dark button.c-select-button[aria-pressed=true]{border-color:#fff}.theme-dark .btn:focus,.theme-dark .btn:hover,.theme-dark button.c-select-button:focus,.theme-dark button.c-select-button:hover,.theme-light .theme-dark .btn:focus,.theme-light .theme-dark .btn:hover,.theme-light .theme-dark button.c-select-button:focus,.theme-light .theme-dark button.c-select-button:hover{outline-color:#fff;border-color:hsla(0,0%,100%,.4)}.theme-dark .btn:active,.theme-dark button.c-select-button:active,.theme-light .theme-dark .btn:active,.theme-light .theme-dark button.c-select-button:active{background:hsla(0,0%,100%,.4);outline:none}.theme-dark .btn[disabled],.theme-dark button.c-select-button[disabled],.theme-light .theme-dark .btn[disabled],.theme-light .theme-dark button.c-select-button[disabled]{border-color:hsla(0,0%,100%,.2);color:hsla(0,0%,100%,.2)}.c-select-menu,.dropdown{position:relative;display:inline-block}.c-select-menu.f-border [aria-expanded],.dropdown.f-border [aria-expanded]{margin-left:8px;-webkit-box-sizing:border-box;box-sizing:border-box;height:100%;border:1px solid rgba(0,0,0,.6)}.c-select-menu.f-border [aria-expanded]:hover,.dropdown.f-border [aria-expanded]:hover{border-color:rgba(0,0,0,.8)}.c-select-menu.f-border [aria-expanded]:active,.c-select-menu.f-border [aria-expanded]:focus,.dropdown.f-border [aria-expanded]:active,.dropdown.f-border [aria-expanded]:focus{border-color:#0078d7}.c-select-menu .c-menu,.dropdown .c-menu{position:absolute;top:100%}.c-select-menu [aria-expanded=false]+.c-menu[aria-hidden=true],.c-select-menu [aria-expanded=false]+.dropdown-menu,.dropdown [aria-expanded=false]+.c-menu[aria-hidden=true],.dropdown [aria-expanded=false]+.dropdown-menu{display:none}.c-select-menu>button,.dropdown>button{border:0;background:transparent}.c-select-menu>a,.c-select-menu>button,.dropdown>a,.dropdown>button{display:inline-block;color:rgba(0,0,0,.6);padding:8px 24px 8px 8px;-ms-transform:translateX(-8px);-webkit-transform:translateX(-8px);transform:translateX(-8px)}.c-select-menu>a:after,.c-select-menu>button:after,.dropdown>a:after,.dropdown>button:after{font-family:MWF-MDL2;content:"";position:absolute;font-size:9px;color:#000;font-weight:700;right:8px;padding-top:7px}.c-select-menu>a:hover,.c-select-menu>button:hover,.dropdown>a:hover,.dropdown>button:hover{color:rgba(0,0,0,.8)}.c-select-menu>a:focus,.c-select-menu>button:focus,.dropdown>a:focus,.dropdown>button:focus{border-color:#0078d7;outline:1px dashed #000}.c-select-menu>a:focus:hover,.c-select-menu>button:focus:hover,.dropdown>a:focus:hover,.dropdown>button:focus:hover{outline:none}.js .c-select-menu>[aria-expanded=true]+.c-menu[aria-hidden=false],.js .c-select-menu>[aria-expanded=true]+.dropdown-menu,.js .c-select-menu>span[aria-expanded=true]+.c-menu[aria-hidden=false],.js .dropdown>[aria-expanded=true]+.c-menu[aria-hidden=false],.js .dropdown>[aria-expanded=true]+.dropdown-menu,.js .dropdown>span[aria-expanded=true]+.c-menu[aria-hidden=false],.no-js .c-select-menu:hover .c-menu,.no-js .c-select-menu:hover .dropdown-menu,.no-js .dropdown:hover .c-menu,.no-js .dropdown:hover .dropdown-menu{display:block;-webkit-animation:fadeIn .3s cubic-bezier(.68,-.55,.265,1.55);animation:fadeIn .3s cubic-bezier(.68,-.55,.265,1.55)}.theme-dark .c-select-menu>a,.theme-dark .c-select-menu>button,.theme-dark .dropdown>a,.theme-dark .dropdown>button,.theme-light .theme-dark .c-select-menu>a,.theme-light .theme-dark .c-select-menu>button,.theme-light .theme-dark .dropdown>a,.theme-light .theme-dark .dropdown>button{color:hsla(0,0%,100%,.6)}.theme-dark .c-select-menu>a:hover,.theme-dark .c-select-menu>button:hover,.theme-dark .dropdown>a:hover,.theme-dark .dropdown>button:hover,.theme-light .theme-dark .c-select-menu>a:hover,.theme-light .theme-dark .c-select-menu>button:hover,.theme-light .theme-dark .dropdown>a:hover,.theme-light .theme-dark .dropdown>button:hover{color:hsla(0,0%,100%,.8)}.theme-dark .c-select-menu>a:after,.theme-dark .c-select-menu>button:after,.theme-dark .dropdown>a:after,.theme-dark .dropdown>button:after,.theme-light .theme-dark .c-select-menu>a:after,.theme-light .theme-dark .c-select-menu>button:after,.theme-light .theme-dark .dropdown>a:after,.theme-light .theme-dark .dropdown>button:after{color:#fff}.theme-dark .c-select-menu>a:focus,.theme-dark .c-select-menu>button:focus,.theme-dark .dropdown>a:focus,.theme-dark .dropdown>button:focus,.theme-light .theme-dark .c-select-menu>a:focus,.theme-light .theme-dark .c-select-menu>button:focus,.theme-light .theme-dark .dropdown>a:focus,.theme-light .theme-dark .dropdown>button:focus{outline-color:#fff}.theme-dark .c-select-menu.f-border>a,.theme-dark .c-select-menu.f-border>button,.theme-dark .dropdown.f-border>a,.theme-dark .dropdown.f-border>button,.theme-light .theme-dark .c-select-menu.f-border>a,.theme-light .theme-dark .c-select-menu.f-border>button,.theme-light .theme-dark .dropdown.f-border>a,.theme-light .theme-dark .dropdown.f-border>button{color:rgba(0,0,0,.6);background:hsla(0,0%,100%,.6);border-color:#fff}.theme-dark .c-select-menu.f-border>a:after,.theme-dark .c-select-menu.f-border>button:after,.theme-dark .dropdown.f-border>a:after,.theme-dark .dropdown.f-border>button:after,.theme-light .theme-dark .c-select-menu.f-border>a:after,.theme-light .theme-dark .c-select-menu.f-border>button:after,.theme-light .theme-dark .dropdown.f-border>a:after,.theme-light .theme-dark .dropdown.f-border>button:after{color:#000}.theme-dark .c-select-menu.f-border>a:hover,.theme-dark .c-select-menu.f-border>button:hover,.theme-dark .dropdown.f-border>a:hover,.theme-dark .dropdown.f-border>button:hover,.theme-light .theme-dark .c-select-menu.f-border>a:hover,.theme-light .theme-dark .c-select-menu.f-border>button:hover,.theme-light .theme-dark .dropdown.f-border>a:hover,.theme-light .theme-dark .dropdown.f-border>button:hover{color:rgba(0,0,0,.8);border-color:#fff}.theme-dark .c-select-menu.f-border>a:focus,.theme-dark .c-select-menu.f-border>button:focus,.theme-dark .dropdown.f-border>a:focus,.theme-dark .dropdown.f-border>button:focus,.theme-light .theme-dark .c-select-menu.f-border>a:focus,.theme-light .theme-dark .c-select-menu.f-border>button:focus,.theme-light .theme-dark .dropdown.f-border>a:focus,.theme-light .theme-dark .dropdown.f-border>button:focus{border-color:#fff}.c-select,.combobox{position:relative;margin-top:20px;min-width:88px;max-width:296px;background-color:#fff;cursor:pointer;height:36px}.c-select:after,.combobox:after{font-family:MWF-MDL2;content:"";position:absolute;right:4px;top:1px;height:34px;width:31px;background:#fff;padding-top:10px;text-align:center}.c-select:after:hover,.combobox:after:hover{z-index:1}.c-select select,.combobox select{position:relative;width:100%;padding:7px 34px 7px 5px;background:#fff;-webkit-appearance:none;-moz-appearance:none;appearance:none;height:100%;outline:0;border:1px solid rgba(0,0,0,.6);cursor:pointer}.c-select select:active,.c-select select:focus,.combobox select:active,.combobox select:focus{background:#fff}.c-select select:hover,.combobox select:hover{z-index:100;background:transparent;border-color:rgba(0,0,0,.8)}.c-select select:active,.c-select select:focus,.combobox select:active,.combobox select:focus{border-color:#0078d7}.c-select select[disabled],.combobox select[disabled]{cursor:not-allowed;color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2);background:#fff;z-index:100;padding-right:0}.c-select select option,.combobox select option{background:#fff;color:#000}.c-select select:-moz-focusring,.combobox select:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.c-select select::-ms-expand,.combobox select::-ms-expand{display:none}.c-select select:focus::-ms-value,.combobox select:focus::-ms-value{background:transparent;color:#000}.c-sequence-indicator{font-size:0}.c-sequence-indicator button{display:inline-block;border:0;padding:2px 3px;width:12px;height:10px;background:transparent}.c-sequence-indicator button:before{content:"";display:block;width:100%;height:100%;border-radius:50%;border:1px solid rgba(0,0,0,.8)}.c-sequence-indicator button:focus{outline:1px dashed #000}.c-sequence-indicator button:hover:before{background:rgba(0,0,0,.4)}.c-sequence-indicator button[aria-checked=true]:before{background:#000}.theme-dark .theme-light .c-sequence-indicator button:before,.theme-light .c-sequence-indicator button:before{border-color:rgba(0,0,0,.8)}.theme-dark .theme-light .c-sequence-indicator button:focus,.theme-light .c-sequence-indicator button:focus{outline-color:#000}.theme-dark .theme-light .c-sequence-indicator button:hover:before,.theme-light .c-sequence-indicator button:hover:before{background:rgba(0,0,0,.4)}.theme-dark .theme-light .c-sequence-indicator button[aria-checked=true]:before,.theme-light .c-sequence-indicator button[aria-checked=true]:before{background:#000}.theme-dark .c-sequence-indicator button:before,.theme-light .theme-dark .c-sequence-indicator button:before{border-color:hsla(0,0%,100%,.8)}.theme-dark .c-sequence-indicator button:focus,.theme-light .theme-dark .c-sequence-indicator button:focus{outline-color:#fff}.theme-dark .c-sequence-indicator button:hover:before,.theme-light .theme-dark .c-sequence-indicator button:hover:before{background:hsla(0,0%,100%,.4)}.theme-dark .c-sequence-indicator button[aria-checked=true]:before,.theme-light .theme-dark .c-sequence-indicator button[aria-checked=true]:before{background:#fff}.c-slider{width:296px}.c-slider input[type=range]{-webkit-appearance:slider-horizontal;-moz-appearance:slider-horizontal;appearance:slider-horizontal}.no-js .c-slider input[type=range]{display:block}.js .c-slider input[type=range]{display:none}.c-slider div{position:relative;height:4px;background:rgba(0,0,0,.4);margin-top:12px}.c-slider div button{height:24px;width:8px;background:#0078d7;border:0;padding:0;border-radius:4px;position:absolute;top:-10px;outline:none}.c-slider div button:focus{outline:1px dashed #000}.c-slider div button:hover{background:#000}.c-slider div button:active{background:#004881}.c-slider div button:active span{display:block}.c-slider div button span{display:none;position:absolute;min-width:36px;height:36px;text-align:center;top:-40px;left:4px;padding:8px 8px 10px;background:#e6e6e6;border:1px solid rgba(0,0,0,.3);-ms-transform:translateX(-50%);-webkit-transform:translateX(-50%);transform:translateX(-50%)}.c-slider div>span{display:block;position:absolute;top:0;bottom:0;background:#0078d7}.c-slider.f-disabled label.c-label{color:rgba(0,0,0,.2)}.c-slider.f-disabled input[type=range][disabled]+div,.c-slider.f-disabled input[type=range][disabled]+div button{background:#ccc}.c-slider.f-disabled input[type=range][disabled]+div span{display:none}.c-structured-list{margin:24px 0}.c-structured-list .f-column{padding-left:10px}.c-structured-list .f-column:first-child{padding-right:10px;padding-left:0}@media only screen and (max-width:1399px){.c-structured-list .f-column:first-child .f-row:first-child{border-top:1px solid #e3e3e3}}@media only screen and (max-width:1399px){.c-structured-list .f-column{padding-right:10px;padding-left:0;max-width:768px}}.c-structured-list .f-column .f-row{border-bottom:1px solid #e3e3e3;float:left}.c-structured-list .f-column .f-row:after,.c-structured-list .f-column .f-row:before{content:" ";display:table}.c-structured-list .f-column .f-row:after{clear:both}.c-structured-list .f-column .f-row:first-child{border-top:1px solid #e3e3e3}@media only screen and (max-width:1399px){.c-structured-list .f-column .f-row:first-child{border-top:0}}.c-structured-list .f-column .f-row [class^=c-paragraph]{padding:0}.c-structured-list .f-column .f-row [data-grid="col-2 stack-2"]{padding:8px 0 8px 24px}.c-structured-list .f-column .f-row [data-grid=col-10]{padding:8px 12px 8px 24px}.c-supplemental-nav{margin-top:32px}.c-supplemental-nav a,.c-supplemental-nav span{display:block;margin-bottom:30px;color:rgba(0,0,0,.6)}.c-supplemental-nav a:hover,.c-supplemental-nav span:hover{cursor:pointer}.c-supplemental-nav a.active{color:#000}.c-supplemental-nav a:hover,.c-supplemental-nav a focus{color:rgba(0,0,0,.8)}.c-supplemental-nav a:focus{outline:1px dashed}.c-supplemental-nav a.f-active{color:#000}.c-supplemental-nav a.f-disabled{color:rgba(0,0,0,.2);cursor:not-allowed}.c-supplemental-nav>nav>a+nav{height:0;overflow:hidden}.c-supplemental-nav>nav>a:first-child,.c-supplemental-nav>nav>span:first-child{margin-left:0;margin-bottom:16px}.c-supplemental-nav>nav a{margin-left:20px;margin-bottom:16px}.c-table,.table-responsive{overflow:visible;margin-top:8px}.c-table.f-divided tbody tr,.table-responsive.f-divided tbody tr{border-bottom:1px solid rgba(0,0,0,.1)}.c-table td.f-image,.table-responsive td.f-image{padding:8px;vertical-align:middle}.c-table table,.table-responsive table{width:100%}.c-table thead,.table-responsive thead{border-bottom:1px solid rgba(0,0,0,.2)}.c-table thead th,.table-responsive thead th{font-size:11px;line-height:16px;vertical-align:bottom;font-weight:400;color:rgba(0,0,0,.6)}.c-table thead th button,.table-responsive thead th button{font-size:11px;line-height:16px;font-weight:400;color:rgba(0,0,0,.6);background:transparent;border:0;padding-left:0}.c-table thead th button:hover,.table-responsive thead th button:hover{color:rgba(0,0,0,.8)}.c-table thead th button:focus,.table-responsive thead th button:focus{outline:1px dashed rgba(0,0,0,.6)}.c-table thead th button:active,.table-responsive thead th button:active{color:#000;outline:1px solid transparent}.c-table thead th button.c-glyph:after,.table-responsive thead th button.c-glyph:after{display:inline-block;margin-left:8px;vertical-align:top}.c-table thead th button.f-ascending,.table-responsive thead th button.f-ascending{color:#000}.c-table thead th button.f-ascending:after,.table-responsive thead th button.f-ascending:after{content:""}.c-table thead th button.f-descending,.table-responsive thead th button.f-descending{color:#000}.c-table thead th button.f-descending:after,.table-responsive thead th button.f-descending:after{content:""}.c-table thead th[colspan]:not([colspan="1"]),.c-table thead tr+tr th,.c-table thead tr+tr th:last-child,.table-responsive thead th[colspan]:not([colspan="1"]),.table-responsive thead tr+tr th,.table-responsive thead tr+tr th:last-child{text-align:center}.c-table tr:before,.table-responsive tr:before{content:"";display:block;width:7px}.c-table td,.c-table th,.table-responsive td,.table-responsive th{padding:10px 12px;text-align:left}.c-table td.f-sub-categorical,.c-table th.f-sub-categorical,.table-responsive td.f-sub-categorical,.table-responsive th.f-sub-categorical{text-align:center}.c-table td.f-numerical,.c-table th.f-numerical,.table-responsive td.f-numerical,.table-responsive th.f-numerical{text-align:right}.c-table td.f-numerical .c-price,.c-table th.f-numerical .c-price,.table-responsive td.f-numerical .c-price,.table-responsive th.f-numerical .c-price{float:right}.c-table[data-table=structured],.table-responsive[data-table=structured]{margin-top:20px}.c-table[data-table=structured] table,.table-responsive[data-table=structured] table{table-layout:fixed}.c-table[data-table=structured] table td,.table-responsive[data-table=structured] table td{width:50%}.c-table ul.c-list,.table-responsive ul.c-list{margin:0;padding:0;list-style-type:none}.c-table ul.c-list li,.table-responsive ul.c-list li{padding:0 0 8px;list-style:none}.c-table .c-paragraph,.table-responsive .c-paragraph{padding:0}.c-table .c-call-to-action,.table-responsive .c-call-to-action{background:transparent;color:#0078d7;border-color:transparent;border-width:2px;padding:10px 44px 7px 24px;margin-left:-24px;margin-right:-24px;margin-top:10px}.c-table .c-call-to-action:focus,.c-table .c-call-to-action:hover,.table-responsive .c-call-to-action:focus,.table-responsive .c-call-to-action:hover{background:transparent;border-color:transparent}.c-table .c-call-to-action:active,.table-responsive .c-call-to-action:active{background:transparent;text-decoration:none}.c-table .c-call-to-action span:hover,.table-responsive .c-call-to-action span:hover{text-decoration:underline}.theme-dark .theme-light .c-table .c-call-to-action,.theme-dark .theme-light .table-responsive .c-call-to-action,.theme-light .c-table .c-call-to-action,.theme-light .table-responsive .c-call-to-action{color:#000;background:transparent;border-color:transparent}.theme-dark .theme-light .c-table .c-call-to-action:active,.theme-dark .theme-light .table-responsive .c-call-to-action:active,.theme-light .c-table .c-call-to-action:active,.theme-light .table-responsive .c-call-to-action:active{color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-table .c-call-to-action:focus,.theme-dark .theme-light .table-responsive .c-call-to-action:focus,.theme-light .c-table .c-call-to-action:focus,.theme-light .table-responsive .c-call-to-action:focus{outline-color:#000}.theme-dark .c-table .c-call-to-action,.theme-dark .table-responsive .c-call-to-action,.theme-light .theme-dark .c-table .c-call-to-action,.theme-light .theme-dark .table-responsive .c-call-to-action{color:#fff;background:transparent;border-color:transparent}.theme-dark .c-table .c-call-to-action:active,.theme-dark .table-responsive .c-call-to-action:active,.theme-light .theme-dark .c-table .c-call-to-action:active,.theme-light .theme-dark .table-responsive .c-call-to-action:active{color:hsla(0,0%,100%,.6)}.theme-dark .c-table .c-call-to-action:focus,.theme-dark .table-responsive .c-call-to-action:focus,.theme-light .theme-dark .c-table .c-call-to-action:focus,.theme-light .theme-dark .table-responsive .c-call-to-action:focus{outline-color:#fff}.c-table .c-call-to-action:hover,.table-responsive .c-call-to-action:hover{border-color:transparent}.c-textarea label.c-label{margin-top:16px;padding-bottom:6px}.c-textarea textarea{font-size:15px;line-height:20px;min-width:276px;min-height:36px;background:#fff;border:1px solid rgba(0,0,0,.6);outline:0;padding:7px 12px;color:#000}.c-textarea textarea:active,.c-textarea textarea:focus{border-color:#0078d7}.c-textarea textarea[disabled]{cursor:not-allowed;color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}.c-textarea textarea[readonly]{border:1px solid rgba(0,0,0,.6);background-color:#e6e6e6}.c-textarea textarea.f-resize{resize:both}.c-textarea textarea.f-no-resize{resize:none}.c-textarea textarea.f-scroll{overflow-y:scroll}.theme-dark .theme-light .c-textarea textarea,.theme-light .c-textarea textarea{background:hsla(0,0%,100%,.6);border:1px solid #000;color:#000}.theme-dark .c-textarea textarea,.theme-light .theme-dark .c-textarea textarea{background:hsla(0,0%,100%,.6);border-color:#fff;color:#000}input.c-text-field[type=text],input.form-control{display:block;width:276px;height:36px;margin-top:20px;padding:7px 10px;border:1px solid rgba(0,0,0,.6);outline:0;background:#fff}input.c-text-field[type=text].f-small,input.form-control.f-small{width:88px}input.c-text-field[type=text].f-flex,input.form-control.f-flex{width:100%;min-width:88px;max-width:400px}input.c-text-field[type=text]:hover,input.form-control:hover{border-color:rgba(0,0,0,.8)}input.c-text-field[type=text]:active,input.c-text-field[type=text]:focus,input.form-control:active,input.form-control:focus{border-color:#0078d7}input.c-text-field[type=text][disabled],input.form-control[disabled]{cursor:not-allowed;color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}input.c-text-field[type=text][readonly],input.form-control[readonly]{border:1px solid rgba(0,0,0,.6);background:#e6e6e6}div.c-toggle button{display:inline-block;position:relative;width:44px;height:20px;background:transparent;border:1px solid #000;border-radius:20px;margin-top:42px}div.c-toggle button:after{position:absolute;left:4px;top:4px;-webkit-transition:all .1s ease;-o-transition:all .1s ease;transition:all .1s ease;background:#000;content:"";border-radius:10px;width:10px;height:10px}div.c-toggle button:focus{outline:1px dashed #000}div.c-toggle button[aria-checked=true]{background:#0078d7;border-color:#0078d7}div.c-toggle button[aria-checked=true]:hover{background:rgba(0,120,215,.8);border-color:rgba(0,120,215,.8)}div.c-toggle button[aria-checked=true]:after{left:28px;background:#fff}div.c-toggle button[aria-checked=true]:disabled{background:rgba(0,0,0,.2);border-color:transparent}div.c-toggle button[aria-checked=true]:disabled:after{background:rgba(0,0,0,.2)}div.c-toggle button[aria-checked=false]{background:transparent;border-color:#000}div.c-toggle button:disabled{background:transparent;border-color:rgba(0,0,0,.2)}div.c-toggle button:disabled:after{background:rgba(0,0,0,.2)}div.c-toggle label{margin-top:32px}div.c-toggle label+button{margin-top:0}div.c-toggle span{font-size:13px;display:inline-block;margin-top:0;padding-left:12px;padding-bottom:0;cursor:pointer;line-height:19px}div.c-toggle.f-disabled{color:rgba(0,0,0,.2)}span.c-tooltip{font-size:13px;position:fixed;background:#fff;border:1px solid rgba(0,0,0,.3);min-width:104px;max-width:340px;margin-top:20px;padding:12px 8px;line-height:16px;z-index:700}span.c-tooltip[aria-hidden=true]{display:none}span.c-tooltip[aria-hidden=false]{display:block}.c-track-list-placement{margin-right:24px;margin-top:12px}.c-track-list-placement>a{display:block;width:100%;height:100%}.c-track-list-placement>a:after,.c-track-list-placement>a:before{content:" ";display:table}.c-track-list-placement>a:after{clear:both}.c-track-list-placement>a:focus{outline:1px dashed rgba(0,0,0,.6)}.c-track-list-placement>a:hover .c-heading,.c-track-list-placement>a:hover .c-subheading{text-decoration:underline}.c-track-list-placement>a:focus>picture img,.c-track-list-placement>a:hover>picture img{outline:1px solid rgba(0,0,0,.6)}.c-track-list-placement picture,.c-track-list-placement picture img{display:block}.c-track-list-placement .c-badge{margin-top:12px;margin-bottom:4px}.c-track-list-placement .c-badge+.c-heading{padding-top:0}.c-track-list-placement .c-price{padding:5px 0 0 5px;line-height:20px;float:right}.c-track-list-placement .c-heading{font-size:15px;line-height:20px;white-space:nowrap;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:20px;width:200px;float:left;padding:8px 0 0;font-weight:400;-o-text-overflow:ellipsis;text-overflow:ellipsis}.c-track-list-placement .c-explicit{vertical-align:text-bottom}.c-track-list-placement .f-information{font-size:15px;line-height:20px;font-weight:400;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:60px;width:200px;color:rgba(0,0,0,.6);float:left;padding:8px 0 0;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.c-track-list-placement.f-size-small{width:358px}.c-track-list-placement.f-size-small .c-badge{display:none}.c-track-list-placement.f-size-small picture{float:left;margin-right:12px}.c-universal-header .c-select-menu>a,.c-universal-header .c-select-menu>button{-ms-transform:none;-webkit-transform:none;transform:none;margin-top:1px;padding:14px 27px 10px 24px}.c-universal-header .c-select-menu>a[aria-haspopup=true],.c-universal-header .c-select-menu>button[aria-haspopup=true]{padding-right:45px}.c-universal-header .c-select-menu>a[aria-haspopup=true]:after,.c-universal-header .c-select-menu>button[aria-haspopup=true]:after{right:27px}.c-universal-header .c-select-menu .c-menu-item a,.c-universal-header .c-select-menu .c-menu-item button{background:transparent}.c-universal-header .c-select-menu .c-menu-item a:hover{text-decoration:underline}.c-universal-header .c-menu{border:0}.c-universal-header .c-menu-item>a,.c-universal-header .c-menu-item>button{padding-left:24px;padding-top:18px;padding-bottom:18px}.c-universal-header .c-menu-item.f-sub-menu>a:after,.c-universal-header .c-menu-item.f-sub-menu>button:after{top:26px}.c-universal-header .c-menu-item.f-sub-menu button{border:0;display:block;width:100%;text-align:left;padding-right:12px}.c-universal-header>div>div{max-width:1600px;height:100%;margin:0 5%}.c-universal-header>div>div:after,.c-universal-header>div>div:before{content:" ";display:table}.c-universal-header>div>div:after{clear:both}.c-universal-header>div:first-child{height:48px;background-color:#fff}.c-universal-header>div:first-child>div>div{float:right}.c-universal-header>div:first-child>div>div>.c-me{height:50px;line-height:50px;float:left}.c-universal-header>div:first-child>div>div>.c-me>.c-hyperlink{margin-top:1px;padding-top:0;padding-bottom:0;color:#000;line-height:50px;height:46px;float:left;text-decoration:none}.c-universal-header>div:first-child>div>div>.c-me>.c-image{float:left;margin-top:8px;margin-left:12px}.c-universal-header>div:first-child .c-action-trigger{margin-top:0;width:50px;height:50px;color:#000;float:left}.c-universal-header>div:first-child .c-action-trigger:before{vertical-align:baseline;margin:0}.c-universal-header>div:first-child .c-action-trigger.glyph-global-nav-button{font-size:20px;display:none;margin-left:-14px}.c-universal-header>div:first-child .c-action-trigger.glyph-global-nav-button:before{width:20px;height:20px;margin-top:7px}.c-universal-header>div:first-child .c-action-trigger.glyph-shopping-cart{margin-right:5px;margin-left:5px;padding-top:0;line-height:50px;height:46px;margin-top:1px}.c-universal-header>div:first-child .c-search{margin-top:6px;float:left}.c-universal-header>div:first-child .c-search input[type=search]{background:transparent;border-color:#000;max-width:100%;width:276px}.c-universal-header>div:first-child .c-search button{background-color:transparent;color:#000;margin-right:2px}.c-universal-header>div:first-child .c-search button:focus{outline:1px dashed #000}@media only screen and (max-width:1083px){.c-universal-header>div:first-child .c-search{min-width:34px}.c-universal-header>div:first-child .c-search input[type=search]{border:0;padding:0;width:0;opacity:0}}.c-universal-header>div:first-child .c-logo{width:132px;height:96%;margin-top:1px;padding:13px 12px 14px;margin-left:-12px;float:left}.c-universal-header>div:first-child .c-logo:focus{outline:1px dashed #000}.c-universal-header>div:first-child nav{height:50px;float:left}.c-universal-header>div:first-child nav:after,.c-universal-header>div:first-child nav:before{content:" ";display:table}.c-universal-header>div:first-child nav:after{clear:both}.c-universal-header>div:first-child nav>ul>li{float:left}.c-universal-header>div:first-child nav>ul>li .c-hyperlink{color:#000;text-decoration:none;display:inline-block;-ms-transform:none;-webkit-transform:none;transform:none;margin-top:1px;padding:14px 27px 10px 24px}.c-universal-header>div:first-child nav>ul>li .c-hyperlink:focus,.c-universal-header>div:first-child nav>ul>li .c-hyperlink:hover{background:#fff;text-decoration:underline}.c-universal-header>div:first-child nav>ul>li .c-hyperlink[aria-expanded=true]{background:#fff;text-decoration:none}.c-universal-header>div:first-child nav>ul>li .c-hyperlink[aria-expanded=true]:hover{text-decoration:none}.c-universal-header>div:first-child .c-select-menu{float:left}.c-universal-header>div:first-child .c-select-menu a,.c-universal-header>div:first-child .c-select-menu button{color:#000}.c-universal-header>div:first-child .c-select-menu>a:after,.c-universal-header>div:first-child .c-select-menu>button:after{right:12px}.c-universal-header>div:first-child .c-select-menu>a:focus,.c-universal-header>div:first-child .c-select-menu>a:hover,.c-universal-header>div:first-child .c-select-menu>button:focus,.c-universal-header>div:first-child .c-select-menu>button:hover{background:#fff;text-decoration:underline}.c-universal-header>div:first-child .c-select-menu>a[aria-expanded=true],.c-universal-header>div:first-child .c-select-menu>button[aria-expanded=true]{background:#fff;text-decoration:none}.c-universal-header>div:first-child .c-select-menu>a[aria-expanded=true]:hover,.c-universal-header>div:first-child .c-select-menu>button[aria-expanded=true]:hover{text-decoration:none}.c-universal-header>div:first-child .c-select-menu>.c-menu{background:#fff;border-bottom:2px solid #000}.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>button:hover,.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#f2f2f2}.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu{background:#f2f2f2;border-bottom:2px solid #000}.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu a:focus,.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu a:hover,.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu button:focus,.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu button:hover{background:#e6e6e6}.c-universal-header>div:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu>button:hover{text-decoration:none}@media only screen and (max-width:767px){.c-universal-header>div:first-child{height:48px}.c-universal-header>div:first-child .c-action-trigger{width:48px;height:48px}.c-universal-header>div:first-child .c-action-trigger.glyph-global-nav-button{display:block}.c-universal-header>div:first-child .c-action-trigger.glyph-shopping-cart{margin-right:-12px}}.c-universal-header>div+div{background:#fff;position:relative;height:70px}.c-universal-header>div+div .c-hyperlink{color:#000}.c-universal-header>div+div .c-hyperlink:focus,.c-universal-header>div+div .c-hyperlink:hover{color:#000;background-color:#fff;text-decoration:underline}.c-universal-header>div+div .c-hyperlink:active,.c-universal-header>div+div .c-hyperlink:visited{color:#000;background-color:#fff}.c-universal-header>div+div .c-logo{color:#000}.c-universal-header>div+div .c-logo:focus,.c-universal-header>div+div .c-logo:hover{background:#fff;text-decoration:underline}.c-universal-header>div+div .c-action-trigger[aria-label]{color:#000}.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-left{border-right:1px solid rgba(0,0,0,.1);opacity:.7}.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-left:hover{opacity:1}.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-right{border-left:1px solid rgba(0,0,0,.1);opacity:.7}.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-right:hover{opacity:1}.c-universal-header>div+div .c-select-menu a,.c-universal-header>div+div .c-select-menu a:after,.c-universal-header>div+div .c-select-menu button,.c-universal-header>div+div .c-select-menu button:after{color:#000}.c-universal-header>div+div .c-select-menu>a:focus,.c-universal-header>div+div .c-select-menu>a:hover,.c-universal-header>div+div .c-select-menu>button:focus,.c-universal-header>div+div .c-select-menu>button:hover{background:#fff;text-decoration:underline}.c-universal-header>div+div .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div .c-select-menu>button[aria-expanded=true]{background:#fff;text-decoration:none}.c-universal-header>div+div .c-select-menu>.c-menu{background:#fff;border-bottom:2px solid #000}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>button:hover{background:#f2f2f2}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#f2f2f2;text-decoration:none}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu{background:#f2f2f2;border-bottom:2px solid #000}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{background:#e6e6e6}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#f2f2f2}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column{border-bottom:2px solid #000}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a:hover,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button:hover{background:#e6e6e6}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a[aria-expanded=true],.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button[aria-expanded=true]{background:#f2f2f2}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>button:hover{text-decoration:none}.c-universal-header>div+div.brand-blue{background:#0078d7}.c-universal-header>div+div.brand-blue .c-hyperlink{color:#fff}.c-universal-header>div+div.brand-blue .c-hyperlink:focus,.c-universal-header>div+div.brand-blue .c-hyperlink:hover{color:#fff;background-color:#006cc2;text-decoration:underline}.c-universal-header>div+div.brand-blue .c-hyperlink:active,.c-universal-header>div+div.brand-blue .c-hyperlink:visited{color:#fff;background-color:#0060ac}.c-universal-header>div+div.brand-blue .c-logo{color:#fff}.c-universal-header>div+div.brand-blue .c-logo:focus,.c-universal-header>div+div.brand-blue .c-logo:hover{background:#006cc2;text-decoration:underline}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label]{color:#fff}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-left{border-right:1px solid hsla(0,0%,100%,.1);opacity:.7}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-left:hover{opacity:1}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-right{border-left:1px solid hsla(0,0%,100%,.1);opacity:.7}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-right:hover{opacity:1}.c-universal-header>div+div.brand-blue .c-select-menu a,.c-universal-header>div+div.brand-blue .c-select-menu a:after,.c-universal-header>div+div.brand-blue .c-select-menu button,.c-universal-header>div+div.brand-blue .c-select-menu button:after{color:#fff}.c-universal-header>div+div.brand-blue .c-select-menu>a:focus,.c-universal-header>div+div.brand-blue .c-select-menu>a:hover,.c-universal-header>div+div.brand-blue .c-select-menu>button:focus,.c-universal-header>div+div.brand-blue .c-select-menu>button:hover{background:#006cc2}.c-universal-header>div+div.brand-blue .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div.brand-blue .c-select-menu>button[aria-expanded=true]{background:#0060ac;text-decoration:none}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu{background:#0060ac;border-bottom:2px solid #fff}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>button:hover{background:#005497}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#004881;text-decoration:none}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu{background:#004881;border-bottom:2px solid #fff}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{background:#003c6c}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#004881}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column{border-bottom:2px solid #fff}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a:hover,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button:hover{background:#003c6c}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a[aria-expanded=true],.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button[aria-expanded=true]{background:#004881}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>button:hover{text-decoration:none}.c-universal-header>div+div.brand-green{background:#107c10}.c-universal-header>div+div.brand-green .c-hyperlink{color:#fff}.c-universal-header>div+div.brand-green .c-hyperlink:focus,.c-universal-header>div+div.brand-green .c-hyperlink:hover{color:#fff;background-color:#0e700e;text-decoration:underline}.c-universal-header>div+div.brand-green .c-hyperlink:active,.c-universal-header>div+div.brand-green .c-hyperlink:visited{color:#fff;background-color:#0d630d}.c-universal-header>div+div.brand-green .c-logo{color:#fff}.c-universal-header>div+div.brand-green .c-logo:focus,.c-universal-header>div+div.brand-green .c-logo:hover{background:#0e700e;text-decoration:underline}.c-universal-header>div+div.brand-green .c-action-trigger[aria-label]{color:#fff}.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-left{border-right:1px solid hsla(0,0%,100%,.1);opacity:.7}.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-left:hover{opacity:1}.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-right{border-left:1px solid hsla(0,0%,100%,.1);opacity:.7}.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-right:hover{opacity:1}.c-universal-header>div+div.brand-green .c-select-menu a,.c-universal-header>div+div.brand-green .c-select-menu a:after,.c-universal-header>div+div.brand-green .c-select-menu button,.c-universal-header>div+div.brand-green .c-select-menu button:after{color:#fff}.c-universal-header>div+div.brand-green .c-select-menu>a:focus,.c-universal-header>div+div.brand-green .c-select-menu>a:hover,.c-universal-header>div+div.brand-green .c-select-menu>button:focus,.c-universal-header>div+div.brand-green .c-select-menu>button:hover{background:#0e700e}.c-universal-header>div+div.brand-green .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div.brand-green .c-select-menu>button[aria-expanded=true]{background:#0d630d;text-decoration:none}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu{background:#0d630d;border-bottom:2px solid #fff}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>button:hover{background:#0b570b}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#0a4a0a;text-decoration:none}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu{background:#0a4a0a;border-bottom:2px solid #fff}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{background:#083e08}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#0a4a0a}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column{border-bottom:2px solid #fff}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a:hover,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button:hover{background:#083e08}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a[aria-expanded=true],.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button[aria-expanded=true]{background:#0a4a0a}.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>button:hover{text-decoration:none}.c-universal-header>div+div.brand-neutral{background:#2f2f2f}.c-universal-header>div+div.brand-neutral .c-hyperlink{color:#fff}.c-universal-header>div+div.brand-neutral .c-hyperlink:focus,.c-universal-header>div+div.brand-neutral .c-hyperlink:hover{color:#fff;background-color:#464646;text-decoration:underline}.c-universal-header>div+div.brand-neutral .c-hyperlink:active,.c-universal-header>div+div.brand-neutral .c-hyperlink:visited{color:#fff;background-color:#525252}.c-universal-header>div+div.brand-neutral .c-logo{color:#fff}.c-universal-header>div+div.brand-neutral .c-logo:focus,.c-universal-header>div+div.brand-neutral .c-logo:hover{background:#464646;text-decoration:underline}.c-universal-header>div+div.brand-neutral .c-action-trigger[aria-label]{color:#fff}.c-universal-header>div+div.brand-neutral .c-action-trigger[aria-label].glyph-chevron-left{border-right:1px solid hsla(0,0%,100%,.1);opacity:.7}.c-universal-header>div+div.brand-neutral .c-action-trigger[aria-label].glyph-chevron-left:hover{opacity:1}.c-universal-header>div+div.brand-neutral .c-action-trigger[aria-label].glyph-chevron-right{border-left:1px solid hsla(0,0%,100%,.1);opacity:.7}.c-universal-header>div+div.brand-neutral .c-action-trigger[aria-label].glyph-chevron-right:hover{opacity:1}.c-universal-header>div+div.brand-neutral .c-select-menu a,.c-universal-header>div+div.brand-neutral .c-select-menu a:after,.c-universal-header>div+div.brand-neutral .c-select-menu button,.c-universal-header>div+div.brand-neutral .c-select-menu button:after{color:#fff}.c-universal-header>div+div.brand-neutral .c-select-menu>a:focus,.c-universal-header>div+div.brand-neutral .c-select-menu>a:hover,.c-universal-header>div+div.brand-neutral .c-select-menu>button:focus,.c-universal-header>div+div.brand-neutral .c-select-menu>button:hover{background:#464646}.c-universal-header>div+div.brand-neutral .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div.brand-neutral .c-select-menu>button[aria-expanded=true]{background:#525252;text-decoration:none}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu{background:#525252;border-bottom:2px solid #fff}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>button:hover{background:#5e5e5e}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#767676;text-decoration:none}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu{background:#767676;border-bottom:2px solid #fff}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#767676}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column{border-bottom:2px solid #fff}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a[aria-expanded=true],.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button[aria-expanded=true]{background:#767676}.c-universal-header>div+div.brand-neutral .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>button:hover{text-decoration:none}.c-universal-header>div+div.f-transparent{background:hsla(0,0%,100%,0)}.c-universal-header>div+div.f-transparent .c-hyperlink{color:#000}.c-universal-header>div+div.f-transparent .c-hyperlink:focus,.c-universal-header>div+div.f-transparent .c-hyperlink:hover{color:#000;background-color:hsla(0,0%,100%,0);text-decoration:underline}.c-universal-header>div+div.f-transparent .c-hyperlink:active,.c-universal-header>div+div.f-transparent .c-hyperlink:visited{color:#000;background-color:#fff}.c-universal-header>div+div.f-transparent .c-logo{color:#000}.c-universal-header>div+div.f-transparent .c-logo:focus,.c-universal-header>div+div.f-transparent .c-logo:hover{background:hsla(0,0%,100%,0);text-decoration:underline}.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label]{color:#000}.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-left{border-right:1px solid rgba(0,0,0,.1);opacity:.7}.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-left:hover{opacity:1}.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-right{border-left:1px solid rgba(0,0,0,.1);opacity:.7}.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-right:hover{opacity:1}.c-universal-header>div+div.f-transparent .c-select-menu a,.c-universal-header>div+div.f-transparent .c-select-menu a:after,.c-universal-header>div+div.f-transparent .c-select-menu button,.c-universal-header>div+div.f-transparent .c-select-menu button:after{color:#000}.c-universal-header>div+div.f-transparent .c-select-menu>a:focus,.c-universal-header>div+div.f-transparent .c-select-menu>a:hover,.c-universal-header>div+div.f-transparent .c-select-menu>button:focus,.c-universal-header>div+div.f-transparent .c-select-menu>button:hover{background:hsla(0,0%,100%,0);text-decoration:underline}.c-universal-header>div+div.f-transparent .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div.f-transparent .c-select-menu>button[aria-expanded=true]{background:#fff;text-decoration:none}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu{background:#fff}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>button:hover{background:#e6e6e6}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#e6e6e6;text-decoration:none}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu{background:#e6e6e6;border-bottom:2px solid #000}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#e6e6e6}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu>.c-menu-item>button:hover{text-decoration:none}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column{border-bottom:2px solid #000}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column a[aria-expanded=true],.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column button[aria-expanded=true]{background:#e6e6e6}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>button:hover{text-decoration:none}.c-universal-header>div+div>div{overflow:hidden;width:calc(90% + 18px);margin:0 5% 0 calc(5% - 18px)}.c-universal-header>div+div>div>.c-call-to-action,.c-universal-header>div+div>div>.c-hyperlink{float:right}.c-universal-header>div+div>div>.c-call-to-action{margin-top:16px}.c-universal-header>div+div .c-logo{height:100%;padding:18px;float:left;outline:none}.c-universal-header>div+div .c-logo img{max-height:100%}.c-universal-header>div+div .c-logo span{font-size:20px;line-height:24px;margin-top:4px;display:block;font-weight:200}.c-universal-header>div+div .c-action-trigger[aria-label]{margin:1px 0 0;padding:0;height:66px}.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-left{float:left;top:48px}.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-right{float:right;top:48px}.c-universal-header>div+div .c-action-trigger[aria-label]:disabled{display:none}.c-universal-header>div+div nav{overflow:hidden;height:100%;white-space:nowrap}.c-universal-header>div+div nav>.c-hyperlink{vertical-align:top}.c-universal-header>div+div nav a.f-hidden,.c-universal-header>div+div nav button.f-hidden{opacity:.6}.c-universal-header>div+div .c-hyperlink{display:inline-block;padding:25px 24px;text-decoration:none;outline:none}.c-universal-header>div+div .c-select-menu{position:static;display:inline-block}.c-universal-header>div+div .c-select-menu>a,.c-universal-header>div+div .c-select-menu>button{position:relative;padding-top:26px;padding-bottom:24px;margin-top:0}.c-universal-header>div+div .c-select-menu a,.c-universal-header>div+div .c-select-menu button{outline:none}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>a,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>button{background:transparent}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column{white-space:nowrap;max-width:none;width:auto}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li{float:left}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li:after,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li:before{content:" ";display:table}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li:after{clear:both}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li>.c-menu-item{display:inline-block;vertical-align:top;float:left}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li>.c-menu-item>a,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li>.c-menu-item>button{font-weight:700}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li>.c-menu-item>a:after,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li>.c-menu-item>button:after{content:none}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li .c-menu{position:relative;left:auto;right:auto;background:transparent}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li a,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li button{background:transparent}.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li a:hover,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li button:hover{text-decoration:underline}@media only screen and (max-width:767px){.c-universal-header>div+div{height:48px}.c-universal-header>div+div>div{overflow:visible}.c-universal-header>div+div .c-action-trigger,.c-universal-header>div+div .c-call-to-action,.c-universal-header>div+div .c-hyperlink,.c-universal-header>div+div nav{display:none}.c-universal-header>div+div .c-logo{padding:10px;margin-left:-10px;outline:none}.c-universal-header>div+div .c-logo span{font-size:15px;line-height:20px;margin-top:5px;font-weight:400}}.c-universal-header.f-transparent{position:absolute;top:0;width:100%;z-index:500}.c-universal-header.f-transparent .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header.f-transparent .c-action-trigger[aria-label].glyph-chevron-right{top:0}.c-universal-header.f-transparent .f-transparent{position:absolute;width:100%}.c-universal-header.f-transparent .c-select-menu>.c-menu{top:100%}.c-universal-header.f-transparent>div+div{top:48px}@media only screen and (min-width:768px){.c-universal-header.f-transparent>div+div{top:50px}}@media only screen and (min-width:768px){.c-universal-header>div.f-transparent:first-child{background-color:hsla(0,0%,100%,0)}}.c-universal-header>div.f-transparent:first-child .c-action-trigger{color:#000}.c-universal-header>div.f-transparent:first-child .c-logo:focus{outline:1px dashed #000}.c-universal-header>div.f-transparent:first-child .c-search button,.c-universal-header>div.f-transparent:first-child .c-search input[type=search]{background:transparent!important;color:#000}.c-universal-header>div.f-transparent:first-child nav>ul>li .c-hyperlink{background-color:hsla(0,0%,100%,0)}.c-universal-header>div.f-transparent:first-child nav>ul>li .c-hyperlink:focus,.c-universal-header>div.f-transparent:first-child nav>ul>li .c-hyperlink:hover{background-color:hsla(0,0%,100%,0);text-decoration:underline}.c-universal-header>div.f-transparent:first-child nav>ul>li .c-hyperlink[aria-expanded=true]{background-color:hsla(0,0%,100%,0);text-decoration:none}.c-universal-header>div.f-transparent:first-child nav>ul>li .c-hyperlink[aria-expanded=true]:hover{text-decoration:none}.c-universal-header>div.f-transparent:first-child .c-select-menu a,.c-universal-header>div.f-transparent:first-child .c-select-menu button{color:#000}.c-universal-header>div.f-transparent:first-child .c-select-menu>a:focus,.c-universal-header>div.f-transparent:first-child .c-select-menu>button:focus{background:transparent;text-decoration:underline}.c-universal-header>div.f-transparent:first-child .c-select-menu>a[aria-expanded=true],.c-universal-header>div.f-transparent:first-child .c-select-menu>button[aria-expanded=true]{background:#fff}.c-universal-header>div.f-transparent:first-child .c-select-menu>a[aria-expanded=true]:hover,.c-universal-header>div.f-transparent:first-child .c-select-menu>button[aria-expanded=true]:hover{text-decoration:none}.c-universal-header>div.f-transparent:first-child .c-select-menu>a:hover,.c-universal-header>div.f-transparent:first-child .c-select-menu>button:hover{background:transparent;text-decoration:underline}.c-universal-header>div.f-transparent:first-child .c-select-menu>a:hover[aria-expanded=true],.c-universal-header>div.f-transparent:first-child .c-select-menu>button:hover[aria-expanded=true]{background:#fff}.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu{background:#fff;border-bottom:2px solid #000}.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>button:hover,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#f2f2f2}.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu a:focus,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu a:hover,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu button:focus,.c-universal-header>div.f-transparent:first-child .c-select-menu>.c-menu>.c-menu-item>.c-menu button:hover{background:#e6e6e6}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu{border-bottom:2px solid #000}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>a:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>a:hover,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>a[aria-expanded=true],.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>button:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>button:hover,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>button[aria-expanded=true]{background:#f2f2f2}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu a:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu a:hover,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu button:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu button:hover{background:#e6e6e6}.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu.f-multi-column>li>.c-menu-item>button:hover{text-decoration:none}.c-universal-header .f-transparent>div+div .c-logo span,.c-universal-header .f-transparent>div+div>div .c-action-trigger[aria-label],.c-universal-header .f-transparent a:link,.c-universal-header .f-transparent button:link{color:#000}.c-universal-header .f-transparent>div+div>div .c-action-trigger[aria-label].glyph-chevron-left{border-right:1px solid #000}.c-universal-header .f-transparent .c-select-menu .c-menu-item a[aria-expanded=true],.c-universal-header .f-transparent .c-select-menu .c-menu-item button[aria-expanded=true]{background:#f2f2f2}@media only screen and (max-width:767px){.c-universal-header .c-select-menu>a,.c-universal-header .c-select-menu>button{margin-top:0}.c-universal-header>div:first-child>div{margin:0 2%}.c-universal-header>div:first-child .c-action-trigger.glyph-shopping-cart,.c-universal-header>div:first-child .c-search{display:none}.c-universal-header>div:first-child nav{position:fixed;display:none;top:96px;width:100%;height:calc(100vh - 48px);margin-left:-2%;overflow:auto;background:#fff}.c-universal-header>div:first-child nav .c-menu-item.f-sub-menu>a+.c-menu,.c-universal-header>div:first-child nav .c-menu-item.f-sub-menu>button+.c-menu{left:0}.c-universal-header>div:first-child nav>ul>li{display:block;text-align:left;height:48px;float:none;border-top:1px solid hsla(0,0%,100%,0);border-bottom:1px solid rgba(0,0,0,.1)}.c-universal-header>div:first-child nav>ul>li>.c-hyperlink{float:none;display:block;width:100%;padding:15px;margin:0}.c-universal-header>div:first-child nav>ul>li>.c-hyperlink:hover{background:hsla(0,0%,100%,0);font-weight:700;text-decoration:none}.c-universal-header>div:first-child nav>ul>li>.c-select-menu{float:none;display:block}.c-universal-header>div:first-child nav>ul>li>.c-select-menu a,.c-universal-header>div:first-child nav>ul>li>.c-select-menu button{display:block;width:100%}.c-universal-header>div:first-child nav>ul>li>.c-select-menu a:hover,.c-universal-header>div:first-child nav>ul>li>.c-select-menu button:hover{background:hsla(0,0%,100%,0);font-weight:700}.c-universal-header>div:first-child nav>ul>li>.c-select-menu a[aria-haspopup=true]:after,.c-universal-header>div:first-child nav>ul>li>.c-select-menu button[aria-haspopup=true]:after{content:""}.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false]{position:fixed;display:block;top:96px;width:100%;max-width:none;height:calc(100vh - 48px);padding-left:-2%;overflow:auto;background:#f2f2f2}.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item{height:48px}.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>a,.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>button{padding:15px;height:48px}.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>a:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>a:hover,.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>button:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>button:hover{background:hsla(0,0%,100%,0)}.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>a:after,.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>button:after{top:20px;font-size:9px}.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>a[aria-expanded=true],.c-universal-header>div:first-child nav>ul>li>.c-select-menu .c-menu[aria-hidden=false] .c-menu-item>button[aria-expanded=true]{background:hsla(0,0%,100%,0)}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button{width:100%;text-align:left}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button{display:block;color:#000;padding:15px;height:48px}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a:after,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button:after{color:#000;content:""}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a:hover,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button:hover{background:hsla(0,0%,100%,0);font-weight:700;text-decoration:none!important}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true],.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]{background:hsla(0,0%,100%,0)}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false],.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false]{position:fixed;display:block;top:96px;width:100%;max-width:none;height:calc(100vh - 48px);padding-left:-2%;overflow:auto;background:#f2f2f2}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item{height:48px}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button{padding:15px;height:48px}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a:hover,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button:hover,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a:hover,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button:focus,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button:hover{background:hsla(0,0%,100%,0)}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a:after,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button:after,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a:after,.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button:after{top:20px;font-size:9px}.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a[aria-expanded=true],.c-universal-header>div:first-child nav>ul>li>.c-select-menu>a[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button[aria-expanded=true],.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>a[aria-expanded=true],.c-universal-header>div:first-child nav>ul>li>.c-select-menu>button[aria-expanded=true]+.c-menu[aria-hidden=false] .c-menu-item>button[aria-expanded=true]{background:hsla(0,0%,100%,0)}.c-universal-header>div:first-child .c-logo{float:none;display:block;position:absolute;left:calc(50% - 60px);height:auto}.c-universal-header>div+div,.c-universal-header>div+div.brand-blue,.c-universal-header>div+div.brand-green,.c-universal-header>div+div.f-transparent{background:#fff;color:#000;height:48px}.c-universal-header>div+div.brand-blue .c-logo,.c-universal-header>div+div.brand-green .c-logo,.c-universal-header>div+div .c-logo,.c-universal-header>div+div.f-transparent .c-logo{margin:0;padding:10px 48px;display:block;border-top:1px solid rgba(0,0,0,.1);border-bottom:1px solid rgba(0,0,0,.1);color:#000;float:none;text-align:center}.c-universal-header>div+div.brand-blue .c-logo:focus,.c-universal-header>div+div.brand-blue .c-logo:hover,.c-universal-header>div+div.brand-green .c-logo:focus,.c-universal-header>div+div.brand-green .c-logo:hover,.c-universal-header>div+div .c-logo:focus,.c-universal-header>div+div .c-logo:hover,.c-universal-header>div+div.f-transparent .c-logo:focus,.c-universal-header>div+div.f-transparent .c-logo:hover{background:hsla(0,0%,100%,0);cursor:default}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label],.c-universal-header>div+div.brand-green .c-action-trigger[aria-label],.c-universal-header>div+div .c-action-trigger[aria-label],.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label]{height:48px;margin-top:0}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-right,.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-right,.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-right,.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-right{display:block;color:#000;position:absolute;top:0}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-left,.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-left{border-right:none;left:0}.c-universal-header>div+div.brand-blue .c-action-trigger[aria-label].glyph-chevron-right,.c-universal-header>div+div.brand-green .c-action-trigger[aria-label].glyph-chevron-right,.c-universal-header>div+div .c-action-trigger[aria-label].glyph-chevron-right,.c-universal-header>div+div.f-transparent .c-action-trigger[aria-label].glyph-chevron-right{border-left:none;right:0}.c-universal-header>div+div.brand-blue .c-select-menu>button,.c-universal-header>div+div.brand-green .c-select-menu>button,.c-universal-header>div+div .c-select-menu>button,.c-universal-header>div+div.f-transparent .c-select-menu>button{width:100%;text-align:left}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false],.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false],.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false],.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]{position:fixed;display:block;top:96px;width:100%!important;height:calc(100vh - 48px);left:0;overflow:auto;background:#f2f2f2}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] button[aria-expanded=true],.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] button[aria-expanded=true],.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] button[aria-expanded=true],.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false] button[aria-expanded=true]{background:hsla(0,0%,100%,0)}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li{float:none}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu-item.f-sub-menu,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu-item.f-sub-menu,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu-item.f-sub-menu,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu-item.f-sub-menu{display:block;float:none;height:inherit}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item .c-menu.f-multi-column[aria-hidden=false]>li .c-menu{height:inherit;top:0}.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:hover,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:focus,.c-universal-header>div+div.brand-blue .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:hover,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:hover,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:focus,.c-universal-header>div+div.brand-green .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:hover,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:hover,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:focus,.c-universal-header>div+div .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:hover,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>a:hover,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:focus,.c-universal-header>div+div.f-transparent .c-select-menu>.c-menu>.c-menu-item>.c-menu .c-menu-item>button:hover{background:hsla(0,0%,100%,0)}.c-universal-header>div+div.brand-blue .c-menu-item.f-sub-menu>a+.c-menu,.c-universal-header>div+div.brand-blue .c-menu-item.f-sub-menu>button+.c-menu,.c-universal-header>div+div.brand-green .c-menu-item.f-sub-menu>a+.c-menu,.c-universal-header>div+div.brand-green .c-menu-item.f-sub-menu>button+.c-menu,.c-universal-header>div+div .c-menu-item.f-sub-menu>a+.c-menu,.c-universal-header>div+div .c-menu-item.f-sub-menu>button+.c-menu,.c-universal-header>div+div.f-transparent .c-menu-item.f-sub-menu>a+.c-menu,.c-universal-header>div+div.f-transparent .c-menu-item.f-sub-menu>button+.c-menu{left:0}.c-universal-header>div+div.brand-blue .c-menu-item.f-sub-menu>a[aria-expaneded=true],.c-universal-header>div+div.brand-blue .c-menu-item.f-sub-menu>button[aria-expaneded=true],.c-universal-header>div+div.brand-green .c-menu-item.f-sub-menu>a[aria-expaneded=true],.c-universal-header>div+div.brand-green .c-menu-item.f-sub-menu>button[aria-expaneded=true],.c-universal-header>div+div .c-menu-item.f-sub-menu>a[aria-expaneded=true],.c-universal-header>div+div .c-menu-item.f-sub-menu>button[aria-expaneded=true],.c-universal-header>div+div.f-transparent .c-menu-item.f-sub-menu>a[aria-expaneded=true],.c-universal-header>div+div.f-transparent .c-menu-item.f-sub-menu>button[aria-expaneded=true]{background:hsla(0,0%,100%,0)}.c-universal-header>div+div.brand-blue>div,.c-universal-header>div+div.brand-green>div,.c-universal-header>div+div.f-transparent>div,.c-universal-header>div+div>div{margin:0 auto;padding:0;width:100%}.c-universal-header>div+div.brand-blue>div nav,.c-universal-header>div+div.brand-green>div nav,.c-universal-header>div+div.f-transparent>div nav,.c-universal-header>div+div>div nav{position:fixed;display:none;top:96px;width:100%;height:calc(100vh - 48px);overflow:auto;background:#f2f2f2}.c-universal-header>div+div.brand-blue>div nav .c-select-menu,.c-universal-header>div+div.brand-green>div nav .c-select-menu,.c-universal-header>div+div.f-transparent>div nav .c-select-menu,.c-universal-header>div+div>div nav .c-select-menu{display:block;text-align:left;height:48px}.c-universal-header>div+div.brand-blue>div nav .c-select-menu>a,.c-universal-header>div+div.brand-blue>div nav .c-select-menu>button,.c-universal-header>div+div.brand-green>div nav .c-select-menu>a,.c-universal-header>div+div.brand-green>div nav .c-select-menu>button,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>a,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>button,.c-universal-header>div+div>div nav .c-select-menu>a,.c-universal-header>div+div>div nav .c-select-menu>button{display:block;color:#000;padding:15px;height:48px}.c-universal-header>div+div.brand-blue>div nav .c-select-menu>a:after,.c-universal-header>div+div.brand-blue>div nav .c-select-menu>button:after,.c-universal-header>div+div.brand-green>div nav .c-select-menu>a:after,.c-universal-header>div+div.brand-green>div nav .c-select-menu>button:after,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>a:after,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>button:after,.c-universal-header>div+div>div nav .c-select-menu>a:after,.c-universal-header>div+div>div nav .c-select-menu>button:after{color:#000;content:"";right:12px}.c-universal-header>div+div.brand-blue>div nav .c-select-menu>a:hover,.c-universal-header>div+div.brand-blue>div nav .c-select-menu>button:hover,.c-universal-header>div+div.brand-green>div nav .c-select-menu>a:hover,.c-universal-header>div+div.brand-green>div nav .c-select-menu>button:hover,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>a:hover,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>button:hover,.c-universal-header>div+div>div nav .c-select-menu>a:hover,.c-universal-header>div+div>div nav .c-select-menu>button:hover{background:hsla(0,0%,100%,0);font-weight:700;text-decoration:none!important}.c-universal-header>div+div.brand-blue>div nav .c-select-menu>a:focus,.c-universal-header>div+div.brand-blue>div nav .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div.brand-blue>div nav .c-select-menu>button:focus,.c-universal-header>div+div.brand-blue>div nav .c-select-menu>button[aria-expanded=true],.c-universal-header>div+div.brand-green>div nav .c-select-menu>a:focus,.c-universal-header>div+div.brand-green>div nav .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div.brand-green>div nav .c-select-menu>button:focus,.c-universal-header>div+div.brand-green>div nav .c-select-menu>button[aria-expanded=true],.c-universal-header>div+div.f-transparent>div nav .c-select-menu>a:focus,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div.f-transparent>div nav .c-select-menu>button:focus,.c-universal-header>div+div.f-transparent>div nav .c-select-menu>button[aria-expanded=true],.c-universal-header>div+div>div nav .c-select-menu>a:focus,.c-universal-header>div+div>div nav .c-select-menu>a[aria-expanded=true],.c-universal-header>div+div>div nav .c-select-menu>button:focus,.c-universal-header>div+div>div nav .c-select-menu>button[aria-expanded=true]{background:hsla(0,0%,100%,0)}.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false],.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false],.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false],.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false]{position:fixed;display:block;top:96px;width:100%;max-width:none;height:calc(100vh - 48px);overflow:auto;background:#f2f2f2;border-bottom:0;color:#000}.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] a,.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] button,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] a,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] button,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] a,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] button,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] a,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] button{display:block;color:#000;padding:15px;height:48px}.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] a:focus,.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] a:hover,.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] button:focus,.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] button:hover,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] a:focus,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] a:hover,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] button:focus,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] button:hover,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] a:focus,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] a:hover,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] button:focus,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] button:hover,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] a:focus,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] a:hover,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] button:focus,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] button:hover{background:hsla(0,0%,100%,0);font-weight:700;text-decoration:none!important}.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] button[aria-expanded=true],.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] button[aria-expanded=true],.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] button[aria-expanded=true],.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] a[aria-expanded=true],.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] button[aria-expanded=true]{background:hsla(0,0%,100%,0)}.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] a:after,.c-universal-header>div+div.brand-blue>div nav .c-select-menu .c-menu[aria-hidden=false] button:after,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] a:after,.c-universal-header>div+div.brand-green>div nav .c-select-menu .c-menu[aria-hidden=false] button:after,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] a:after,.c-universal-header>div+div.f-transparent>div nav .c-select-menu .c-menu[aria-hidden=false] button:after,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] a:after,.c-universal-header>div+div>div nav .c-select-menu .c-menu[aria-hidden=false] button:after{color:#000;top:20px;font-size:9px}}.c-video{display:inline-block;margin:0;width:100%;min-width:320px;direction:ltr;position:relative;overflow:hidden}.c-video>[aria-hidden=true]{display:none}.c-video video{display:block;min-width:100%;width:100%;max-height:100%;height:auto;background:#000}.c-video .f-progress{direction:ltr;width:100%;width:calc(100% - 288px);display:inline-block;margin-bottom:4px}.c-video .f-progress div{background:hsla(0,0%,100%,.4)}.c-video .f-progress div button:active,.c-video .f-progress div button:hover{background:#fff}.c-video .f-progress div button:active span,.c-video .f-progress div button:hover span{display:block}.c-video .f-progress div button span{font-size:13px;width:auto;top:-50px;background:#000;color:#fff}@media (max-width:767px){.c-video .f-progress div button span{font-size:12px}}.c-video button{color:#fff;background:transparent;border:0}.c-video .f-video-controls{font-size:24px;width:100%;max-width:1779px;height:44px;background:#000;position:absolute;bottom:0;display:inline-block}@media (max-width:767px){.c-video .f-video-controls{font-size:20px}}.c-video .f-video-controls button.c-glyph{width:44px;height:44px;padding-top:4px;vertical-align:middle}.c-video .f-video-controls button.c-glyph.glyph-mute,.c-video .f-video-controls button.c-glyph.glyph-volume{padding-top:12px}.c-video .f-video-controls button.c-glyph:focus,.c-video .f-video-controls button.c-glyph:hover{color:hsla(0,0%,100%,.6)}.c-video .f-video-controls button.c-glyph:focus{outline:1px dashed #fff}.c-video .f-video-controls button.c-glyph:active{color:hsla(0,0%,100%,.4)}.c-video .f-video-controls .f-timecode{font-size:13px;color:#fff;padding-right:12px;position:relative;top:-2px}@media (max-width:767px){.c-video .f-video-controls .f-timecode{font-size:12px}}.c-video .f-video-controls .f-timecode span{color:hsla(0,0%,100%,.6)}.c-video .f-play-pause{margin-left:1px;margin-top:1px}.c-video .f-play-pause span{font-size:13px;color:#fff;position:absolute;height:36px;min-width:44px;bottom:46px;left:0;background:#000;padding:8px}@media (max-width:767px){.c-video .f-play-pause span{font-size:12px}}.c-video .f-play-pause span[aria-hidden=true]{display:none}.c-video .f-play-pause span[aria-hidden=false]{display:block}.c-video .f-full-screen{display:inline-block;position:absolute;top:1px;right:1px}.c-video .f-full-screen span{font-size:13px;color:#fff;position:absolute;height:36px;min-width:44px;text-align:right;bottom:47px;right:0;background:#000;padding:8px}@media (max-width:767px){.c-video .f-full-screen span{font-size:12px}}.c-video .f-full-screen span[aria-hidden=true]{display:none}.c-video .f-full-screen span[aria-hidden=false]{display:block}.c-video .f-volume-button{display:inline-block;position:absolute;top:-4px;right:45px}.c-video .f-volume-slider{position:absolute;width:44px;min-height:148px;bottom:46px;right:46px;background:#000;border:1px solid hsla(0,0%,100%,.6)}.c-video .f-volume-slider[aria-hidden=true]{visibility:hidden}.c-video .f-volume-slider[aria-hidden=false]{visibility:visible}.c-video .f-volume-slider .c-slider{direction:ltr;-ms-transform:rotate(-90deg);-webkit-transform:rotate(-90deg);transform:rotate(-90deg);width:120px;padding-bottom:40px;margin-top:52px;margin-left:-18px}.c-video .f-volume-slider .c-slider div{background:hsla(0,0%,100%,.4)}.c-video .f-volume-slider .c-slider div button:active,.c-video .f-volume-slider .c-slider div button:hover{background:#fff}.c-video .f-volume-slider .c-slider div>span{min-height:0;height:4px;width:100%;top:0;left:0;background:#0078d7}.c-video .f-volume-slider .c-slider div button{z-index:1}.c-video .f-volume-slider .c-slider div button span{font-size:13px;width:auto;-ms-transform:rotate(90deg);-webkit-transform:rotate(90deg);transform:rotate(90deg);min-width:40px;min-height:32px;top:38px;left:-16px;background:#000;color:#fff;border:1px solid hsla(0,0%,100%,.6)}@media (max-width:767px){.c-video .f-volume-slider .c-slider div button span{font-size:12px}}.c-video .f-options{display:inline-block;position:absolute;top:1px;right:90px;margin-left:12px}.c-video .f-options-dialog{position:absolute;bottom:46px;right:90px;width:160px;background:#000;border:1px solid hsla(0,0%,100%,.6);overflow:hidden}.c-video .f-options-dialog .c-list{margin:0;position:absolute;left:0;top:0;width:160px}.c-video .f-options-dialog .c-list li{height:40px;padding:0;border-top:1px solid hsla(0,0%,100%,.6)}.c-video .f-options-dialog .c-list li:first-child{border-top:0}.c-video .f-options-dialog .c-list li ul{display:none;left:160px}.c-video .f-options-dialog .c-list li ul li{position:relative}.c-video .f-options-dialog .c-list li a{font-size:13px;color:#fff;display:block;height:100%;width:100%;padding:8px 12px}@media (max-width:767px){.c-video .f-options-dialog .c-list li a{font-size:12px}}.c-video .f-options-dialog .c-list li a .c-image{padding-right:12px;display:inline-block}.c-video .f-options-dialog .c-list li a.c-action-trigger{margin-top:0}.c-video .f-options-dialog .c-list li a.c-action-trigger:before{margin-left:1px;margin-bottom:5px}.c-video .f-options-dialog .c-list li a.c-glyph[data-video-selectable]{color:hsla(0,0%,100%,.8)}.c-video .f-options-dialog .c-list li a.glyph-check-mark[data-video-selectable]{color:#fff}.c-video .f-options-dialog .c-list li a.glyph-check-mark[data-video-selectable]:before{float:right;margin-right:0}.c-video .f-options-dialog .c-list li a:hover{text-decoration:none;background:hsla(0,0%,100%,.1)}.c-video .f-options-dialog .c-list li a:focus{border:1px dashed #fff}.c-video .f-options-dialog .c-list li a:active{text-decoration:none;background:hsla(0,0%,100%,.2);border:0}.c-video .f-options-dialog[aria-hidden=true]{visibility:hidden}.c-video .f-options-dialog[aria-hidden=false]{visibility:visible}.c-video .glyph-play:before{font-family:MWF-MDL2;content:""}.c-video .glyph-pause:before{font-family:MWF-MDL2;content:""}.c-video .glyph-full-screen:before{font-family:MWF-MDL2;content:""}.c-video .glyph-mute:before{font-family:MWF-MDL2;content:""}.c-video .glyph-volume:before{font-family:MWF-MDL2;content:""}.c-video .glyph-more:before{font-family:MWF-MDL2;content:""}.c-video .glyph-copy:before{font-family:MWF-MDL2;content:""}.c-video .glyph-mail:before{font-family:MWF-MDL2;content:""}.c-video .glyph-check-mark:before{font-family:MWF-MDL2;content:""}@-webkit-keyframes slidein{0%{bottom:-44px}to{bottom:0}}@keyframes slidein{0%{bottom:-44px}to{bottom:0}}@-webkit-keyframes slideout{0%{bottom:0}to{bottom:-44px}}@keyframes slideout{0%{bottom:0}to{bottom:-44px}}.c-video .f-slidein{-webkit-animation-name:slidein;animation-name:slidein;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.c-video .f-slidein,.c-video .f-slideout{-webkit-animation-duration:.5s;animation-duration:.5s}.c-video .f-slideout{-webkit-animation-name:slideout;animation-name:slideout;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.c-product-placement,.m-product-placement-item{padding-left:0;padding-right:0;padding-top:0;margin-right:24px;margin-top:12px}.c-product-placement>a,.m-product-placement-item>a{display:block;width:100%;height:100%}.c-product-placement>a:after,.c-product-placement>a:before,.m-product-placement-item>a:after,.m-product-placement-item>a:before{content:" ";display:table}.c-product-placement>a:after,.m-product-placement-item>a:after{clear:both}.c-product-placement>a .c-image,.c-product-placement>a>picture img,.m-product-placement-item>a .c-image,.m-product-placement-item>a>picture img{outline:1px solid rgba(0,0,0,.1)}.c-product-placement>a:focus,.m-product-placement-item>a:focus{outline:1px dashed rgba(0,0,0,.6)}.c-product-placement>a:hover .c-heading,.c-product-placement>a:hover .c-subheading,.m-product-placement-item>a:hover .c-heading,.m-product-placement-item>a:hover .c-subheading{text-decoration:underline}.c-product-placement>a:focus .c-image,.c-product-placement>a:focus>picture img,.c-product-placement>a:hover .c-image,.c-product-placement>a:hover>picture img,.m-product-placement-item>a:focus .c-image,.m-product-placement-item>a:focus>picture img,.m-product-placement-item>a:hover .c-image,.m-product-placement-item>a:hover>picture img{outline:1px solid rgba(0,0,0,.6)}.c-product-placement picture,.c-product-placement picture .c-image,.c-product-placement picture img,.m-product-placement-item picture,.m-product-placement-item picture .c-image,.m-product-placement-item picture img{display:inline-block}.c-product-placement .c-badge,.m-product-placement-item .c-badge{margin-top:12px;margin-bottom:4px}.c-product-placement .c-badge+.c-heading,.m-product-placement-item .c-badge+.c-heading{padding-top:0}.c-product-placement .c-heading,.m-product-placement-item .c-heading{font-size:15px;line-height:20px;white-space:nowrap;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:20px;padding-top:8px;font-weight:400}.c-product-placement .c-paragraph,.m-product-placement-item .c-paragraph{font-size:15px;line-height:20px;padding:24px 0 0;font-weight:400;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:60px;color:rgba(0,0,0,.6)}.c-product-placement.context-accessory .c-image,.c-product-placement.context-accessory .f-default-image,.c-product-placement.context-accessory picture img,.c-product-placement.context-artist .c-image,.c-product-placement.context-artist .f-default-image,.c-product-placement.context-artist picture img,.c-product-placement.context-device .c-image,.c-product-placement.context-device .f-default-image,.c-product-placement.context-device picture img,.m-product-placement-item.context-accessory .c-image,.m-product-placement-item.context-accessory .f-default-image,.m-product-placement-item.context-accessory picture img,.m-product-placement-item.context-artist .c-image,.m-product-placement-item.context-artist .f-default-image,.m-product-placement-item.context-artist picture img,.m-product-placement-item.context-device .c-image,.m-product-placement-item.context-device .f-default-image,.m-product-placement-item.context-device picture img{outline:none}.c-product-placement.context-artist .c-image,.c-product-placement.context-artist .f-default-image,.c-product-placement.context-artist picture img,.m-product-placement-item.context-artist .c-image,.m-product-placement-item.context-artist .f-default-image,.m-product-placement-item.context-artist picture img{border-radius:50%}.c-product-placement.context-artist .f-default-image .c-image,.c-product-placement.context-artist .f-default-image picture img,.m-product-placement-item.context-artist .f-default-image .c-image,.m-product-placement-item.context-artist .f-default-image picture img{border-radius:0}.c-product-placement.context-artist.f-size-medium>a>div,.m-product-placement-item.context-artist.f-size-medium>a>div{text-align:center;padding:0 12px}.c-product-placement.context-tvshow .f-default-image+div,.c-product-placement.context-tvshow picture+div,.m-product-placement-item.context-tvshow .f-default-image+div,.m-product-placement-item.context-tvshow picture+div{padding:5px;height:62px;width:100%}.c-product-placement .f-default-image,.m-product-placement-item .f-default-image{background-color:rgba(0,0,0,.2);outline:1px solid rgba(0,0,0,.1)}.c-product-placement .f-default-image:focus,.m-product-placement-item .f-default-image:focus{outline:1px dashed rgba(0,0,0,.6)}.c-product-placement .f-default-image:focus,.c-product-placement .f-default-image:hover,.m-product-placement-item .f-default-image:focus,.m-product-placement-item .f-default-image:hover{outline:1px solid rgba(0,0,0,.6)}.c-product-placement .f-default-image picture,.m-product-placement-item .f-default-image picture{position:relative;width:100%;height:100%}.c-product-placement .f-default-image picture .c-image,.m-product-placement-item .f-default-image picture .c-image{outline:0;position:absolute;top:50%;left:50%;-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.c-product-placement .f-default-image picture:focus,.m-product-placement-item .f-default-image picture:focus{outline:none}.c-product-placement.f-size-small,.m-product-placement-item.f-size-small{width:358px}.c-product-placement.f-size-small .c-badge,.m-product-placement-item.f-size-small .c-badge{display:none}.c-product-placement.f-size-small picture,.m-product-placement-item.f-size-small picture{float:left;margin-right:12px}.c-product-placement.f-size-small .f-default-image,.m-product-placement-item.f-size-small .f-default-image{width:72px;height:72px;float:left;margin-right:12px}.c-product-placement.f-size-small.context-movie .f-default-image,.m-product-placement-item.f-size-small.context-movie .f-default-image{width:72px;height:103px}.c-product-placement.f-size-medium,.m-product-placement-item.f-size-medium{width:167px}.c-product-placement.f-size-medium>a>div,.m-product-placement-item.f-size-medium>a>div{padding-right:24px}.c-product-placement.f-size-medium .f-default-image,.m-product-placement-item.f-size-medium .f-default-image{width:167px;height:167px;padding-right:0}.c-product-placement.f-size-medium .f-default-image+div,.m-product-placement-item.f-size-medium .f-default-image+div{padding-right:24px}.c-product-placement.f-size-medium.context-movie .f-default-image,.m-product-placement-item.f-size-medium.context-movie .f-default-image{width:167px;height:229px}.c-product-placement.f-size-large,.m-product-placement-item.f-size-large{width:358px}.c-product-placement.f-size-large>a>div,.m-product-placement-item.f-size-large>a>div{padding-right:24px}.c-product-placement.f-size-large .f-default-image,.m-product-placement-item.f-size-large .f-default-image{width:358px;height:300px;padding-right:0}.c-product-placement.f-size-large .f-default-image+div,.m-product-placement-item.f-size-large .f-default-image+div{padding-right:24px}.c-product-placement.f-size-extra-large,.m-product-placement-item.f-size-extra-large{width:740px}.c-product-placement.f-size-extra-large>a>div,.m-product-placement-item.f-size-extra-large>a>div{padding-right:48px}.c-product-placement.f-size-extra-large .f-default-image,.m-product-placement-item.f-size-extra-large .f-default-image{width:740px;height:416px;padding-right:0}.c-product-placement.f-size-extra-large .f-default-image+div,.m-product-placement-item.f-size-extra-large .f-default-image+div{padding-right:48px}.c-product-placement.f-size-extra-large .c-heading,.c-product-placement.f-size-large .c-heading,.m-product-placement-item.f-size-extra-large .c-heading,.m-product-placement-item.f-size-large .c-heading{font-size:20px;line-height:24px;max-height:48px;font-weight:200}@media only screen and (max-width:539px){.c-product-placement.f-size-large,.m-product-placement-item.f-size-large{width:272px}.c-product-placement.f-size-large .f-default-image,.m-product-placement-item.f-size-large .f-default-image{width:272px;height:272px}}.c-hero,.m-hero-item{position:relative;overflow:hidden;padding:0 5%;height:600px}.c-hero picture,.m-hero-item picture{display:block}.c-hero>picture,.m-hero-item>picture{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0;overflow:hidden}.c-hero>picture img,.m-hero-item>picture img{position:absolute}.c-hero>picture:after,.m-hero-item>picture:after{content:"";display:block;position:relative;z-index:1;width:100%;height:100%}.c-hero>div,.m-hero-item>div{width:100%;height:100%;max-width:1600px;position:relative;z-index:1;margin:0 auto}.c-hero>div>div,.m-hero-item>div>div{position:absolute;z-index:1;width:520px}.c-hero>div>div>div,.m-hero-item>div>div>div{margin-top:24px}.c-hero .c-heading,.m-hero-item .c-heading{font-size:34px;line-height:40px;padding:38px 0 2px;font-weight:100;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:80px}.c-hero .c-subheading,.m-hero-item .c-subheading{font-size:20px;line-height:24px;padding:8px 0 4px;font-weight:200;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:48px}.c-hero .c-paragraph,.m-hero-item .c-paragraph{font-size:15px;line-height:20px;padding:24px 0 0;font-weight:400;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:80px}.c-hero .c-product-subtitle,.c-hero .c-product-title,.m-hero-item .c-product-subtitle,.m-hero-item .c-product-title{font-size:24px;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:56px;line-height:32px;max-height:64px;padding:0}.c-hero .c-product-title,.m-hero-item .c-product-title{font-weight:700}.c-hero .c-product-subtitle,.m-hero-item .c-product-subtitle{font-weight:100}.c-hero .c-price,.m-hero-item .c-price{font-size:20px;line-height:24px;display:inline-block}.c-hero .c-rating,.m-hero-item .c-rating{margin-top:12px}.c-hero .c-group,.m-hero-item .c-group{display:block;overflow:visible}.c-hero .c-group>.c-call-to-action,.m-hero-item .c-group>.c-call-to-action{margin-right:24px}.c-hero .c-group>.c-call-to-action+.c-call-to-action,.m-hero-item .c-group>.c-call-to-action+.c-call-to-action{background:transparent;color:#0078d7;border-color:transparent;border-width:2px;margin-left:-24px;margin-right:-24px;padding:10px 43px 7px 25px}.c-hero .c-group>.c-call-to-action+.c-call-to-action:focus,.c-hero .c-group>.c-call-to-action+.c-call-to-action:hover,.m-hero-item .c-group>.c-call-to-action+.c-call-to-action:focus,.m-hero-item .c-group>.c-call-to-action+.c-call-to-action:hover{background:transparent;border-color:transparent}.c-hero .c-group>.c-call-to-action+.c-call-to-action:active,.m-hero-item .c-group>.c-call-to-action+.c-call-to-action:active{background:transparent;text-decoration:none}.c-hero .c-group>.c-call-to-action+.c-call-to-action span:hover,.m-hero-item .c-group>.c-call-to-action+.c-call-to-action span:hover{text-decoration:underline}.theme-dark .theme-light .c-hero .c-group>.c-call-to-action+.c-call-to-action,.theme-dark .theme-light .m-hero-item .c-group>.c-call-to-action+.c-call-to-action,.theme-light .c-hero .c-group>.c-call-to-action+.c-call-to-action,.theme-light .m-hero-item .c-group>.c-call-to-action+.c-call-to-action{color:#000;background:transparent;border-color:transparent}.theme-dark .theme-light .c-hero .c-group>.c-call-to-action+.c-call-to-action:active,.theme-dark .theme-light .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:active,.theme-light .c-hero .c-group>.c-call-to-action+.c-call-to-action:active,.theme-light .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:active{color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-hero .c-group>.c-call-to-action+.c-call-to-action:focus,.theme-dark .theme-light .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:focus,.theme-light .c-hero .c-group>.c-call-to-action+.c-call-to-action:focus,.theme-light .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:focus{outline-color:#000}.theme-dark .c-hero .c-group>.c-call-to-action+.c-call-to-action,.theme-dark .m-hero-item .c-group>.c-call-to-action+.c-call-to-action,.theme-light .theme-dark .c-hero .c-group>.c-call-to-action+.c-call-to-action,.theme-light .theme-dark .m-hero-item .c-group>.c-call-to-action+.c-call-to-action{color:#fff;background:transparent;border-color:transparent}.theme-dark .c-hero .c-group>.c-call-to-action+.c-call-to-action:active,.theme-dark .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:active,.theme-light .theme-dark .c-hero .c-group>.c-call-to-action+.c-call-to-action:active,.theme-light .theme-dark .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:active{color:hsla(0,0%,100%,.6)}.theme-dark .c-hero .c-group>.c-call-to-action+.c-call-to-action:focus,.theme-dark .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:focus,.theme-light .theme-dark .c-hero .c-group>.c-call-to-action+.c-call-to-action:focus,.theme-light .theme-dark .m-hero-item .c-group>.c-call-to-action+.c-call-to-action:focus{outline-color:#fff}.c-hero.theme-dark .c-group>.c-call-to-action+.c-call-to-action,.m-hero-item.theme-dark .c-group>.c-call-to-action+.c-call-to-action{color:#fff}.c-hero.theme-light .c-group>.c-call-to-action+.c-call-to-action,.m-hero-item.theme-light .c-group>.c-call-to-action+.c-call-to-action{color:#000}.c-hero.theme-dark .c-group.f-accent>.c-call-to-action,.c-hero.theme-light .c-group.f-accent>.c-call-to-action,.m-hero-item.theme-dark .c-group.f-accent>.c-call-to-action,.m-hero-item.theme-light .c-group.f-accent>.c-call-to-action{margin-right:24px}.c-hero.theme-dark .c-group.f-accent>.c-call-to-action+.c-call-to-action,.c-hero.theme-light .c-group.f-accent>.c-call-to-action+.c-call-to-action,.m-hero-item.theme-dark .c-group.f-accent>.c-call-to-action+.c-call-to-action,.m-hero-item.theme-light .c-group.f-accent>.c-call-to-action+.c-call-to-action{color:#0078d7}.c-hero .c-logo,.m-hero-item .c-logo{margin-top:12px}.c-hero.context-app .c-heading,.m-hero-item.context-app .c-heading{font-size:24px;line-height:28px;padding:36px 0 4px;font-weight:200;white-space:nowrap;max-height:28px}.c-hero.context-app .c-subheading,.m-hero-item.context-app .c-subheading{font-size:18px;line-height:24px;padding:9px 0 3px;font-weight:200;max-height:48px}.c-hero.context-article .c-heading,.m-hero-item.context-article .c-heading{font-size:24px;line-height:28px;padding:36px 0 4px;font-weight:200;max-height:56px}.c-hero.context-game .c-rating,.m-hero-item.context-game .c-rating{margin-top:60px}.c-hero.context-accessory>div>div>div,.c-hero.context-article>div>div>div,.c-hero.context-device>div>div>div,.c-hero.context-game>div>div>div,.c-hero.context-music-album .c-product-title,.m-hero-item.context-accessory>div>div>div,.m-hero-item.context-article>div>div>div,.m-hero-item.context-device>div>div>div,.m-hero-item.context-game>div>div>div,.m-hero-item.context-music-album .c-product-title{margin-top:12px}.c-hero.f-x-left>div>div,.m-hero-item.f-x-left>div>div{left:0}.c-hero.f-x-left>picture img,.m-hero-item.f-x-left>picture img{right:0}.c-hero.f-x-center,.m-hero-item.f-x-center{text-align:center}.c-hero.f-x-center .c-group,.m-hero-item.f-x-center .c-group{-ms-flex-pack:center;justify-content:center}.c-hero.f-x-center>div>div,.m-hero-item.f-x-center>div>div{left:30%;left:50%;-ms-transform:translateX(-50%);-webkit-transform:translateX(-50%);transform:translateX(-50%)}.c-hero.f-x-center>div>div .c-image,.m-hero-item.f-x-center>div>div .c-image{margin:0 auto}.c-hero.f-x-center>picture img,.m-hero-item.f-x-center>picture img{left:50%;-ms-transform:translateX(-50%);-webkit-transform:translateX(-50%);transform:translateX(-50%)}.c-hero.f-x-right>div>div,.m-hero-item.f-x-right>div>div{right:0}.c-hero.f-x-right>picture img,.m-hero-item.f-x-right>picture img{left:0}.c-hero.f-y-top>div>div,.m-hero-item.f-y-top>div>div{top:60px}.c-hero.f-y-top>picture img,.m-hero-item.f-y-top>picture img{top:0}.c-hero.f-y-center .c-heading:first-child,.m-hero-item.f-y-center .c-heading:first-child{padding-top:0}.c-hero.f-y-center>div>div,.m-hero-item.f-y-center>div>div{top:120px;top:50%;-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%);transform:translateY(-50%)}.c-hero.f-y-center>picture img,.m-hero-item.f-y-center>picture img{top:50%;-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%);transform:translateY(-50%)}.c-hero.f-y-center.f-x-center>div>div,.c-hero.f-y-center.f-x-center>picture img,.m-hero-item.f-y-center.f-x-center>div>div,.m-hero-item.f-y-center.f-x-center>picture img{-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.c-hero.f-y-center.f-x-center>picture img,.m-hero-item.f-y-center.f-x-center>picture img{top:50%;left:50%}.c-hero.f-y-bottom>div>div,.m-hero-item.f-y-bottom>div>div{bottom:60px}.c-hero.f-y-bottom>picture img,.m-hero-item.f-y-bottom>picture img{bottom:0}.c-hero[class*=f-mask].theme-light>picture:after,.m-hero-item[class*=f-mask].theme-light>picture:after{background:#fff}.c-hero[class*=f-mask].theme-light.f-x-left.f-y-top>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-left.f-y-top>picture:after{background:-webkit-radial-gradient(top left,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(top left,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at top left,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-left.f-y-center>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-left.f-y-center>picture:after{background:-webkit-radial-gradient(center left,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(center left,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at center left,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-left.f-y-bottom>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-left.f-y-bottom>picture:after{background:-webkit-radial-gradient(bottom left,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(bottom left,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at bottom left,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-center.f-y-top>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-center.f-y-top>picture:after{background:-webkit-radial-gradient(top center,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(top center,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at top center,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-center.f-y-center>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-center.f-y-center>picture:after{background:-webkit-radial-gradient(center center,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(center center,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at center center,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-center.f-y-bottom>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-center.f-y-bottom>picture:after{background:-webkit-radial-gradient(bottom center,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(bottom center,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at bottom center,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-right.f-y-top>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-right.f-y-top>picture:after{background:-webkit-radial-gradient(top right,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(top right,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at top right,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-right.f-y-center>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-right.f-y-center>picture:after{background:-webkit-radial-gradient(center right,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(center right,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at center right,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-light.f-x-right.f-y-bottom>picture:after,.m-hero-item[class*=f-mask].theme-light.f-x-right.f-y-bottom>picture:after{background:-webkit-radial-gradient(bottom right,circle,#fff,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(bottom right,circle,#fff,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at bottom right,#fff,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark>picture:after,.m-hero-item[class*=f-mask].theme-dark>picture:after{background:#000}.c-hero[class*=f-mask].theme-dark.f-x-left.f-y-top>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-left.f-y-top>picture:after{background:-webkit-radial-gradient(top left,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(top left,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at top left,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-left.f-y-center>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-left.f-y-center>picture:after{background:-webkit-radial-gradient(center left,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(center left,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at center left,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-left.f-y-bottom>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-left.f-y-bottom>picture:after{background:-webkit-radial-gradient(bottom left,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(bottom left,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at bottom left,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-center.f-y-top>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-center.f-y-top>picture:after{background:-webkit-radial-gradient(top center,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(top center,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at top center,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-center.f-y-center>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-center.f-y-center>picture:after{background:-webkit-radial-gradient(center center,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(center center,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at center center,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-center.f-y-bottom>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-center.f-y-bottom>picture:after{background:-webkit-radial-gradient(bottom center,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(bottom center,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at bottom center,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-right.f-y-top>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-right.f-y-top>picture:after{background:-webkit-radial-gradient(top right,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(top right,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at top right,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-right.f-y-center>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-right.f-y-center>picture:after{background:-webkit-radial-gradient(center right,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(center right,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at center right,#000,hsla(0,0%,100%,0) 80%)}.c-hero[class*=f-mask].theme-dark.f-x-right.f-y-bottom>picture:after,.m-hero-item[class*=f-mask].theme-dark.f-x-right.f-y-bottom>picture:after{background:-webkit-radial-gradient(bottom right,circle,#000,hsla(0,0%,100%,0) 80%);background:-o-radial-gradient(bottom right,circle,#000,hsla(0,0%,100%,0) 80%);background:radial-gradient(circle at bottom right,#000,hsla(0,0%,100%,0) 80%)}.c-hero.f-mask-20>picture:after,.m-hero-item.f-mask-20>picture:after{opacity:.2}.c-hero.f-mask-40>picture:after,.m-hero-item.f-mask-40>picture:after{opacity:.4}.c-hero.f-mask-60>picture:after,.m-hero-item.f-mask-60>picture:after{opacity:.6}.c-hero.f-mask-80>picture:after,.m-hero-item.f-mask-80>picture:after{opacity:.8}.c-hero.f-mask-100>picture:after,.m-hero-item.f-mask-100>picture:after{opacity:1}.c-hero .c-video,.m-hero-item .c-video{position:absolute;height:100%;width:100%;max-width:100%;overflow:hidden;left:0}.c-hero .c-video>h1,.m-hero-item .c-video>h1{display:none}.c-hero .c-video video,.m-hero-item .c-video video{min-width:100%;min-height:100%;height:auto;width:auto;z-index:-2;background-size:cover;overflow:hidden;position:absolute;left:0;top:0}@media only screen and (max-width:1083px){.c-hero,.m-hero-item{height:500px}.c-hero>div>div,.m-hero-item>div>div{width:440px}.c-hero .c-heading,.m-hero-item .c-heading{font-size:24px;line-height:28px;font-weight:200;max-height:56px;padding:0 0 4px}.c-hero .c-subheading,.m-hero-item .c-subheading{font-size:18px;line-height:24px;padding:9px 0 3px;font-weight:200;max-height:72px}}@media only screen and (max-width:767px){.c-hero,.m-hero-item{height:auto;padding:0;text-align:center}.c-hero[class*=f-x][class*=f-y]>picture img,.m-hero-item[class*=f-x][class*=f-y]>picture img{top:0;left:0;left:50%;-ms-transform:translateX(-50%);-webkit-transform:translateX(-50%);transform:translateX(-50%)}.c-hero[class*=f-x][class*=f-y]>picture:after,.m-hero-item[class*=f-x][class*=f-y]>picture:after{display:none}.c-hero[class*=f-x][class*=f-y]>div>div,.m-hero-item[class*=f-x][class*=f-y]>div>div{position:relative;width:auto;left:0;top:0;top:50%;-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%);transform:translateY(-50%)}.c-hero>picture,.m-hero-item>picture{position:relative;height:400px}.c-hero>div,.m-hero-item>div{padding:12px;height:280px}.c-hero>div picture,.m-hero-item>div picture{display:none}.c-hero .c-paragraph,.m-hero-item .c-paragraph{max-height:40px}.c-hero .c-heading,.c-hero.context-article .c-heading,.m-hero-item .c-heading,.m-hero-item.context-article .c-heading{font-size:20px;line-height:24px;padding:35px 0 5px;font-weight:200;max-height:120px}.c-hero .c-heading,.c-hero.context-app .c-heading,.c-hero.context-article .c-heading,.m-hero-item .c-heading,.m-hero-item.context-app .c-heading,.m-hero-item.context-article .c-heading{padding-top:0}.c-hero>div>div>div,.m-hero-item>div>div>div{-ms-flex-pack:center;justify-content:center}.c-hero .c-group>.c-call-to-action,.c-hero .c-group>.c-call-to-action+.c-call-to-action,.c-hero.theme-dark .c-group.f-accent>.c-call-to-action,.c-hero.theme-dark .c-group.f-accent>.c-call-to-action+.c-call-to-action,.c-hero.theme-light .c-group.f-accent>.c-call-to-action,.c-hero.theme-light .c-group.f-accent>.c-call-to-action+.c-call-to-action,.m-hero-item .c-group>.c-call-to-action,.m-hero-item .c-group>.c-call-to-action+.c-call-to-action,.m-hero-item.theme-dark .c-group.f-accent>.c-call-to-action,.m-hero-item.theme-dark .c-group.f-accent>.c-call-to-action+.c-call-to-action,.m-hero-item.theme-light .c-group.f-accent>.c-call-to-action,.m-hero-item.theme-light .c-group.f-accent>.c-call-to-action+.c-call-to-action{margin:0}.c-hero .c-subheading,.m-hero-item .c-subheading{display:none}.c-hero.context-game .c-rating,.m-hero-item.context-game .c-rating{margin-top:12px}.c-hero.context-music-album .c-product-title,.m-hero-item.context-music-album .c-product-title{margin-top:0}}@media only screen and (max-width:539px){.c-hero>picture,.m-hero-item>picture{height:300px}.c-hero .c-paragraph,.c-hero .c-price,.c-hero .c-rating,.m-hero-item .c-paragraph,.m-hero-item .c-price,.m-hero-item .c-rating{display:none}}.m-additional-information .c-heading-4+div{margin-top:24px}.m-additional-information [data-grid=col-6]>[data-grid=col-6]{margin-bottom:24px;padding-right:12px}.m-additional-information .c-list.f-bare.f-lean{margin-bottom:24px}.m-additional-information .c-list.f-bare.f-lean:first-child{margin-top:0}.c-alert[role=alert],.m-alert[role=alert]{padding-top:0;margin-top:24px;position:relative}.c-alert[role=alert].f-fixed,.m-alert[role=alert].f-fixed{position:fixed;left:0;right:0;bottom:0;z-index:700}.c-alert[role=alert].f-information,.m-alert[role=alert].f-information{background:#f2f2f2;color:#231f20}.c-alert[role=alert].f-warning,.m-alert[role=alert].f-warning{background:#d02e00;color:#fff}.c-alert[role=alert].f-warning .c-action-trigger,.m-alert[role=alert].f-warning .c-action-trigger{color:#fff;text-decoration:underline}.c-alert[role=alert].f-error,.m-alert[role=alert].f-error{background:#fff999;color:#231f20}.c-alert[role=alert] .c-glyph,.m-alert[role=alert] .c-glyph{float:left;top:0;left:0;margin-left:-8px;margin-right:12px}.c-alert[role=alert] .c-glyph:before,.m-alert[role=alert] .c-glyph:before{font-size:24px;margin:0}.c-alert[role=alert] .c-glyph~p.c-paragraph,.m-alert[role=alert] .c-glyph~p.c-paragraph{margin-left:28px}.c-alert[role=alert] .c-glyph.glyph-warning:before,.m-alert[role=alert] .c-glyph.glyph-warning:before{content:""}.c-alert[role=alert] .c-glyph.glyph-info:before,.m-alert[role=alert] .c-glyph.glyph-info:before{content:""}.c-alert[role=alert] .c-glyph.glyph-incident-triangle:before,.m-alert[role=alert] .c-glyph.glyph-incident-triangle:before{content:""}.c-alert[role=alert]>.c-glyph.c-action-trigger.glyph-cancel,.m-alert[role=alert]>.c-glyph.c-action-trigger.glyph-cancel{height:48px;width:48px;position:absolute;right:1px;left:auto;top:1px;margin:0 10px 0 0;padding:14px 6px;z-index:1;float:right;color:currentColor}.c-alert[role=alert]>.c-glyph.c-action-trigger.glyph-cancel:before,.m-alert[role=alert]>.c-glyph.c-action-trigger.glyph-cancel:before{font-size:15px;content:""}.c-alert[role=alert]>div,.m-alert[role=alert]>div{max-width:1600px;margin:0 auto;padding:16px 48px 16px 20px;float:inherit}.c-alert[role=alert]>div>.c-heading,.m-alert[role=alert]>div>.c-heading{font-size:18px;line-height:24px;font-weight:200;padding:2px 0 8px}.c-alert[role=alert]>div>.c-paragraph,.m-alert[role=alert]>div>.c-paragraph{font-size:13px;padding-top:0;margin-right:15px}@media (max-width:767px){.c-alert[role=alert]>div>.c-paragraph,.m-alert[role=alert]>div>.c-paragraph{font-size:12px}}.c-alert[role=alert]>div>.c-paragraph .c-group,.m-alert[role=alert]>div>.c-paragraph .c-group{overflow:visible;display:block}.c-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger,.m-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger{font-size:13px;line-height:16px;padding-left:10px;padding-right:10px}@media (max-width:767px){.c-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger,.m-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger{font-size:12px;line-height:16px}}@media only screen and (max-width:767px){.c-alert[role=alert]>div>.c-paragraph .c-group,.m-alert[role=alert]>div>.c-paragraph .c-group{display:-ms-flexbox;display:flex;margin-left:-12px;margin-right:-12px}.c-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger,.m-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger{margin-top:0;vertical-align:baseline}}@media only screen and (min-width:768px){.c-alert[role=alert]>div>.c-paragraph .c-group,.m-alert[role=alert]>div>.c-paragraph .c-group{display:inline;padding-left:15px;float:right}.c-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger,.m-alert[role=alert]>div>.c-paragraph .c-group .c-action-trigger{margin:-7px 0 0}}a.c-back-to-top,a.m-back-to-top{visibility:hidden}@media only screen and (min-width:768px){a.c-back-to-top,a.m-back-to-top{position:fixed;bottom:24px;right:24px;width:48px;height:48px;background:rgba(0,0,0,.1);cursor:pointer;visibility:visible;float:right;padding:12px;z-index:500;opacity:1;-webkit-transition:opacity .6s cubic-bezier(.19,1,.22,1);-o-transition:opacity .6s cubic-bezier(.19,1,.22,1);transition:opacity .6s cubic-bezier(.19,1,.22,1)}a.c-back-to-top:focus,a.c-back-to-top:hover,a.m-back-to-top:focus,a.m-back-to-top:hover{background:rgba(0,0,0,.2)}a.c-back-to-top:focus,a.m-back-to-top:focus{outline:1px dashed #000}a.c-back-to-top:active,a.m-back-to-top:active{background:rgba(0,0,0,.3)}a.c-back-to-top .c-glyph.glyph-up,a.m-back-to-top .c-glyph.glyph-up{font-size:24px}a.c-back-to-top .c-glyph.glyph-up:before,a.m-back-to-top .c-glyph.glyph-up:before{width:24px;height:24px;content:""}a.c-back-to-top[aria-disabled=true],a.m-back-to-top[aria-disabled=true]{visibility:hidden;opacity:0;-webkit-transition:visibility 601ms cubic-bezier(.19,1,.22,1),opacity .6s cubic-bezier(.19,1,.22,1);-o-transition:visibility 601ms cubic-bezier(.19,1,.22,1),opacity .6s cubic-bezier(.19,1,.22,1);transition:visibility 601ms cubic-bezier(.19,1,.22,1),opacity .6s cubic-bezier(.19,1,.22,1)}}.m-banner{text-align:center}.m-banner .c-heading-3{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:80px;padding-bottom:3.1812px}.m-banner .c-caption-1{font-size:18px;padding-top:20px;color:rgba(0,0,0,.6)}.m-banner .c-image{margin:0 auto;width:auto;max-height:70px}.m-banner .c-image+.c-heading-3{padding-top:10px}.m-banner a.c-call-to-action{color:#0078d7;border-width:2px;padding:10px 44px 7px 24px;margin-left:-24px;margin-right:-24px}.m-banner a.c-call-to-action,.m-banner a.c-call-to-action:focus,.m-banner a.c-call-to-action:hover{background:transparent;border-color:transparent}.m-banner a.c-call-to-action:active{background:transparent;text-decoration:none}.m-banner a.c-call-to-action span:hover{text-decoration:underline}.theme-dark .theme-light .m-banner a.c-call-to-action,.theme-light .m-banner a.c-call-to-action{color:#000;background:transparent;border-color:transparent}.theme-dark .theme-light .m-banner a.c-call-to-action:active,.theme-light .m-banner a.c-call-to-action:active{color:rgba(0,0,0,.6)}.theme-dark .theme-light .m-banner a.c-call-to-action:focus,.theme-light .m-banner a.c-call-to-action:focus{outline-color:#000}.theme-dark .m-banner a.c-call-to-action,.theme-light .theme-dark .m-banner a.c-call-to-action{color:#fff;background:transparent;border-color:transparent}.theme-dark .m-banner a.c-call-to-action:active,.theme-light .theme-dark .m-banner a.c-call-to-action:active{color:hsla(0,0%,100%,.6)}.theme-dark .m-banner a.c-call-to-action:focus,.theme-light .theme-dark .m-banner a.c-call-to-action:focus{outline-color:#fff}.c-compare-chart .c-product-placement img,.c-compare-chart .m-product-placement-item img,.m-compare-chart .c-product-placement img,.m-compare-chart .m-product-placement-item img{margin:0}.c-compare-chart .c-product-placement [aria-hidden=true],.c-compare-chart .m-product-placement-item [aria-hidden=true],.m-compare-chart .c-product-placement [aria-hidden=true],.m-compare-chart .m-product-placement-item [aria-hidden=true]{visibility:visible}.c-compare-chart .c-product-placement .c-heading-4,.c-compare-chart .m-product-placement-item .c-heading-4,.m-compare-chart .c-product-placement .c-heading-4,.m-compare-chart .m-product-placement-item .c-heading-4{padding:4px 0 8px}.c-compare-chart section .f-row,.m-compare-chart section .f-row{display:inline-block;padding-right:24px;margin:10px 0 0}.c-compare-chart section .f-icons,.m-compare-chart section .f-icons{margin-bottom:24px}.c-compare-chart section img,.m-compare-chart section img{margin:5px;display:initial}.c-compare-chart section button,.m-compare-chart section button{color:#fff;background-color:#0078d7;margin-bottom:24px}.c-compare-chart section button:focus,.c-compare-chart section button:hover,.m-compare-chart section button:focus,.m-compare-chart section button:hover{background-color:#006cc2;border-color:rgba(0,0,0,.4)}.c-compare-chart section button:active,.m-compare-chart section button:active{background-color:#005497;border-color:transparent}.c-compare-chart section button[disabled],.m-compare-chart section button[disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,120,215,.2);border-color:transparent}.theme-dark .theme-light .c-compare-chart section button,.theme-dark .theme-light .m-compare-chart section button,.theme-light .c-compare-chart section button,.theme-light .m-compare-chart section button{color:#fff;background-color:#000;border-color:transparent}.theme-dark .theme-light .c-compare-chart section button:focus,.theme-dark .theme-light .m-compare-chart section button:focus,.theme-light .c-compare-chart section button:focus,.theme-light .m-compare-chart section button:focus{outline-color:#000;background-color:rgba(0,0,0,.8)}.theme-dark .theme-light .c-compare-chart section button:hover,.theme-dark .theme-light .m-compare-chart section button:hover,.theme-light .c-compare-chart section button:hover,.theme-light .m-compare-chart section button:hover{background-color:rgba(0,0,0,.8)}.theme-dark .theme-light .c-compare-chart section button:active,.theme-dark .theme-light .m-compare-chart section button:active,.theme-light .c-compare-chart section button:active,.theme-light .m-compare-chart section button:active{background-color:rgba(0,0,0,.6)}.theme-dark .theme-light .c-compare-chart section button[disabled],.theme-dark .theme-light .m-compare-chart section button[disabled],.theme-light .c-compare-chart section button[disabled],.theme-light .m-compare-chart section button[disabled]{background-color:rgba(0,0,0,.2);color:rgba(0,0,0,.2)}.theme-dark .c-compare-chart section button,.theme-dark .m-compare-chart section button,.theme-light .theme-dark .c-compare-chart section button,.theme-light .theme-dark .m-compare-chart section button{color:#000;background-color:#fff;border-color:transparent}.theme-dark .c-compare-chart section button:focus,.theme-dark .m-compare-chart section button:focus,.theme-light .theme-dark .c-compare-chart section button:focus,.theme-light .theme-dark .m-compare-chart section button:focus{outline-color:#fff;background-color:hsla(0,0%,100%,.8)}.theme-dark .c-compare-chart section button:hover,.theme-dark .m-compare-chart section button:hover,.theme-light .theme-dark .c-compare-chart section button:hover,.theme-light .theme-dark .m-compare-chart section button:hover{background-color:hsla(0,0%,100%,.8)}.theme-dark .c-compare-chart section button:active,.theme-dark .m-compare-chart section button:active,.theme-light .theme-dark .c-compare-chart section button:active,.theme-light .theme-dark .m-compare-chart section button:active{background-color:hsla(0,0%,100%,.6)}.theme-dark .c-compare-chart section button[disabled],.theme-dark .m-compare-chart section button[disabled],.theme-light .theme-dark .c-compare-chart section button[disabled],.theme-light .theme-dark .m-compare-chart section button[disabled]{background-color:hsla(0,0%,100%,.2);color:hsla(0,0%,100%,.2)}.c-compare-chart section ul,.m-compare-chart section ul{margin-bottom:24px}.c-compare-chart section .c-call-to-action,.m-compare-chart section .c-call-to-action{margin-top:15px}.c-compare-chart section .c-divider,.m-compare-chart section .c-divider{-webkit-box-sizing:border-box;box-sizing:border-box}.c-compare-chart section p,.m-compare-chart section p{margin-bottom:24px;padding:0;display:block}.c-compare-chart section [aria-hidden=true],.m-compare-chart section [aria-hidden=true]{visibility:hidden}@media only screen and (max-width:539px){.c-compare-chart,.m-compare-chart{padding:0 24px}.c-compare-chart section .f-column .f-row img,.m-compare-chart section .f-column .f-row img{max-height:112px;max-width:100%;text-align:center}.c-compare-chart h3[aria-hidden=true],.m-compare-chart h3[aria-hidden=true]{visibility:visible}}.m-content-placement{padding-left:0;padding-right:0;padding-top:0}@media only screen and (min-width:540px){.m-content-placement{padding-left:12px;padding-right:12px}}@media only screen and (min-width:768px){.m-content-placement{padding-left:24px;padding-right:24px;padding-top:48px}.m-content-placement .c-content-placement{margin-top:0}}@media only screen and (min-width:1400px){.m-content-placement{padding-left:36px;padding-right:36px}}.m-feature{padding-top:48px}@media only screen and (min-width:1083px){.m-feature .c-feature.f-align-left>div{padding-left:0}.m-feature .c-feature.f-align-right>div{left:50%;padding-right:0}}.m-feature+.m-feature{padding-top:0}.m-feature[data-grid~=container]{padding-left:12px;padding-right:12px;max-width:100%;clear:both}@media only screen and (min-width:540px){.m-feature[data-grid~=container]{padding-left:24px;padding-right:24px}}@media only screen and (min-width:768px){.m-feature[data-grid~=container]{padding-left:36px;padding-right:36px}}@media only screen and (min-width:1400px){.m-feature[data-grid~=container]{padding-left:48px;padding-right:48px}}.m-feature-channel{display:block;position:relative;height:240px;overflow:hidden;padding-top:0;margin-top:48px}.m-feature-channel>.c-image img{left:0;max-width:inherit;position:absolute}.m-feature-channel>section{position:relative;z-index:1}.m-feature-channel>section>.c-group li{display:none}.m-feature-channel>section .c-call-to-action{margin-top:16px}.m-feature-channel>div{height:100%;position:absolute;right:0;top:0;z-index:0}@media only screen and (max-width:767px){.m-feature-channel>section{text-align:center}.m-feature-channel>div{background-image:none!important;left:0}.m-feature-channel.theme-dark>div{background:rgba(0,0,0,.4)}.m-feature-channel.theme-light>div{background:hsla(0,0%,100%,.4)}}@media only screen and (min-width:540px){.m-feature-channel{height:260px}}@media only screen and (max-width:1083px){.m-feature-channel>section{top:calc(50% - 48px)}.m-feature-channel>section>.c-heading-4{padding-top:0}.m-feature-channel>section>.c-heading-4 .c-hyperlink{display:none}}@media only screen and (min-width:768px){.m-feature-channel{height:280px}.m-feature-channel>div{left:calc(50% - 150px);right:0}.m-feature-channel.theme-dark>div{background:-webkit-linear-gradient(left,hsla(0,0%,100%,0),#333 150px);background:-o-linear-gradient(left,hsla(0,0%,100%,0) 0,#333 150px);background:linear-gradient(90deg,hsla(0,0%,100%,0) 0,#333 150px)}.m-feature-channel.theme-light>div{background:-webkit-linear-gradient(left,hsla(0,0%,100%,0),#e6e6e6 150px);background:-o-linear-gradient(left,hsla(0,0%,100%,0) 0,#e6e6e6 150px);background:linear-gradient(90deg,hsla(0,0%,100%,0) 0,#e6e6e6 150px)}.m-feature-channel>section{padding:0 48px;position:absolute;right:0}.m-feature-channel>section>.c-group{margin-right:-24px}}@media only screen and (min-width:768px) and (max-width:1083px){.m-feature-channel>section{width:50%}}@media only screen and (min-width:1084px){.m-feature-channel{height:370px}.m-feature-channel>section .c-call-to-action{display:none}.m-feature-channel>section .c-group li:nth-child(-n+3){display:inherit}.m-feature-channel>div{left:auto;width:749px}}@media only screen and (min-width:1400px){.m-feature-channel>section .c-group li:nth-child(-n+4){display:inherit}.m-feature-channel>div{width:960px}}@media only screen and (min-width:1779px){.m-feature-channel>section .c-group li:nth-child(-n+5){display:inherit}.m-feature-channel>div{width:1131px}}.m-group-call-to-action{padding-top:34px}.m-group-call-to-action strong{font-size:18px;line-height:24px;padding-bottom:10px}@media (max-width:767px){.m-group-call-to-action strong{font-size:16px;line-height:20px}}.m-group-call-to-action .c-group{height:auto;position:relative}.m-group-call-to-action .c-group .c-call-to-action{font-size:18px;line-height:24px;border:0;font-weight:200}@media (max-width:767px){.m-group-call-to-action .c-group .c-call-to-action{font-size:16px;line-height:20px}}.m-group-call-to-action .c-group .c-call-to-action:after{content:""}@media only screen and (max-width:767px){.m-group-call-to-action{padding-top:24px}.m-group-call-to-action strong{padding-bottom:6px}.m-group-call-to-action .c-call-to-action{padding:6px 0}}.m-hero{padding-left:0;padding-right:0;padding-top:0}@media only screen and (max-width:1083px){.m-hero .c-hero,.m-hero .m-hero-item{padding-left:36px;padding-right:36px}}@media only screen and (max-width:767px){.m-hero .c-hero,.m-hero .m-hero-item{padding-left:0;padding-right:0}}.m-in-page-navigation,.m-link-navigation,.m-media{padding-top:0}.m-media{padding-bottom:4px}.m-media:after,.m-media:before{content:" ";display:table}.m-media:after{clear:both}.m-media .c-image{float:left;margin-right:12px}.m-media [class*=c-heading],.m-media [class*=c-paragraph],.m-media [class*=c-subheading]{float:left;width:calc(100% - 60px);padding:0 24px 0 0}@media only screen and (min-width:539px){.m-media [class*=c-heading]{float:none;display:inline-block}}.m-hyperlink-group{padding-left:0;padding-right:0}.m-hyperlink-group>div{text-align:center;padding:0 12.5% 19px}.m-hyperlink-group>div .c-heading{font-size:20px;line-height:24px;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:48px;padding:35px 0 1.636px;font-weight:700}.m-hyperlink-group>div ul{margin:0;padding:0}.m-hyperlink-group>div ul li{padding:0}.m-hyperlink-group>div ul li .c-hyperlink{font-size:18px;line-height:24px;white-space:nowrap;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:24px;padding:10px 0;display:block;text-decoration:none;font-weight:200}@media (max-width:767px){.m-hyperlink-group>div ul li .c-hyperlink{font-size:16px;line-height:20px}}.m-hyperlink-group>div.f-background-accent{background:#0078d7}.m-hyperlink-group>div.f-background-neutral-00{background:#fff}.m-hyperlink-group>div.f-background-neutral-10{background:#e3e3e3}.m-hyperlink-group>div.f-background-neutral-20{background:#c8c8c8}.m-hyperlink-group>div.f-background-neutral-30{background:#acacac}.m-hyperlink-group>div.f-background-neutral-45{background:#919191}.m-hyperlink-group>div.f-background-neutral-55{background:#767676}.m-hyperlink-group>div.f-background-neutral-65{background:#5e5e5e}.m-hyperlink-group>div.f-background-neutral-75{background:#464646}.m-hyperlink-group>div.f-background-neutral-80{background:#2f2f2f}.m-hyperlink-group>div.f-background-neutral-90{background:#171717}.m-hyperlink-group>div.f-background-neutral-100,.m-hyperlink-group>div.f-brand-neutral-100{background:#000}.theme-dark .theme-light .m-hyperlink-group>div,.theme-light .m-hyperlink-group>div{color:#000}.theme-dark .m-hyperlink-group>div,.theme-light .theme-dark .m-hyperlink-group>div{color:#f2f2f2}@media only screen and (max-width:767px){.m-hyperlink-group>div .c-heading{padding-top:24px;padding-bottom:6px}.m-hyperlink-group>div ul{margin:0;padding:0}.m-hyperlink-group>div ul li{padding:0}.m-hyperlink-group>div ul li .c-hyperlink{padding:6px 0}}.c-mosaic-placement .m-hyperlink-group>div{padding:0;height:100%}.m-hyperlink-group-content-placement{padding-left:0;padding-right:0}@media only screen and (min-width:768px){.m-hyperlink-group-content-placement,.m-hyperlink-group-content-placement [data-grid*=col-]{display:-ms-flexbox;display:flex}}.m-hyperlink-group-content-placement [class^=m-]{padding-top:0}.m-hyperlink-group-content-placement .c-content-placement{margin-top:0}.m-hyperlink-group-content-placement .m-hyperlink-group{display:block}.m-hyperlink-group-content-placement .f-background-accent{height:100%}.m-mosaic{padding-left:0;padding-right:0}.m-multi-column{padding-top:0}.m-multi-column>div,.m-multi-column>ul{-webkit-column-gap:48px;-moz-column-gap:48px;column-gap:48px}.m-multi-column>div>li,.m-multi-column>ul>li{padding:0}.m-multi-column>div>li a.c-hyperlink,.m-multi-column>ul>li a.c-hyperlink{padding:8px 0;display:inline-block}.m-multi-column.f-columns-1>div,.m-multi-column.f-columns-1>ul{-webkit-columns:1;-moz-columns:1;column-count:1}.m-multi-column.f-columns-2>div,.m-multi-column.f-columns-2>ul{-webkit-columns:2;-moz-columns:2;column-count:2}.m-multi-column.f-columns-3>div,.m-multi-column.f-columns-3>ul{-webkit-columns:3;-moz-columns:3;column-count:3}.m-multi-column.f-columns-4>div,.m-multi-column.f-columns-4>ul{-webkit-columns:4;-moz-columns:4;column-count:4}@media only screen and (max-width:2048px){.m-multi-column.f-columns-5>div,.m-multi-column.f-columns-5>ul{-webkit-columns:5;-moz-columns:5;column-count:5}}@media only screen and (max-width:1778px){.m-multi-column.f-columns-4>div,.m-multi-column.f-columns-4>ul,.m-multi-column.f-columns-5>div,.m-multi-column.f-columns-5>ul{-webkit-columns:4;-moz-columns:4;column-count:4}}@media only screen and (max-width:1399px){.m-multi-column.f-columns-4>div,.m-multi-column.f-columns-4>ul,.m-multi-column.f-columns-5>div,.m-multi-column.f-columns-5>ul{-webkit-columns:3;-moz-columns:3;column-count:3}}@media only screen and (max-width:1083px){.m-multi-column.f-columns-4>div,.m-multi-column.f-columns-4>ul,.m-multi-column.f-columns-5>div,.m-multi-column.f-columns-5>ul{-webkit-columns:3;-moz-columns:3;column-count:3}}@media only screen and (max-width:767px){.m-multi-column.f-columns-3>div,.m-multi-column.f-columns-3>ul,.m-multi-column.f-columns-4>div,.m-multi-column.f-columns-4>ul,.m-multi-column.f-columns-5>div,.m-multi-column.f-columns-5>ul{-webkit-columns:2;-moz-columns:2;column-count:2}}@media only screen and (max-width:539px){.m-multi-column.f-columns-2>div,.m-multi-column.f-columns-2>ul,.m-multi-column.f-columns-3>div,.m-multi-column.f-columns-3>ul,.m-multi-column.f-columns-4>div,.m-multi-column.f-columns-4>ul,.m-multi-column.f-columns-5>div,.m-multi-column.f-columns-5>ul{-webkit-columns:1;-moz-columns:1;column-count:1}}.m-page-bar{position:relative;min-width:inherit;padding-top:0;background:#fff;border-bottom:1px solid #e3e3e3}.m-page-bar.f-hidden{display:none}.m-page-bar.f-sticky{z-index:500;visibility:hidden;position:fixed;top:-60px;-webkit-transition:all .4s cubic-bezier(.19,1,.22,1);-o-transition:all .4s cubic-bezier(.19,1,.22,1);transition:all .4s cubic-bezier(.19,1,.22,1)}.m-page-bar.f-sticky.f-show{visibility:visible;top:0}.m-page-bar>div{height:60px;width:30%;float:right}.m-page-bar>div:before{content:" ";display:inline-block;vertical-align:middle;height:100%}.m-page-bar>div:first-child{width:70%;float:left}.m-page-bar>div [class^=c-heading-]{white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;padding-top:0;margin-right:24px}.m-page-bar>div [class^=c-heading-] .c-hyperlink{float:none}.m-page-bar>div .context-menu [class^=c-heading-]{float:left;padding-top:5px}.m-page-bar>div .context-menu [class^=c-heading-]+.c-list li:first-child{margin-left:24px}.m-page-bar>div .context-menu .c-list{margin:0;white-space:nowrap}.m-page-bar>div .context-menu .c-list li{display:inline-block;margin:0 24px}.m-page-bar>div .context-menu .c-list li.f-active .c-hyperlink{color:#000}.m-page-bar>div .context-menu .c-list li .c-hyperlink{color:#5e5e5e}.m-page-bar>div .context-menu .c-list li .c-hyperlink:hover{text-decoration:none}.m-page-bar>div>div{width:95%;float:none;display:inline-block;vertical-align:middle}.m-page-bar>div>div>div{float:left;width:inherit}.m-page-bar>div>div>div+div{display:block;width:100%}.m-page-bar>div>div>div>.c-hyperlink{display:block;margin:0;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.m-page-bar>div>.c-price{width:auto;float:right;padding:20px 0;margin:0 12px}.m-page-bar>div>.c-call-to-action{float:right;margin:10px 0 10px 12px;max-width:90%}@media only screen and (max-width:1083px){.m-page-bar>div{width:40%}.m-page-bar>div:first-child{width:60%}}@media only screen and (max-width:767px){.m-page-bar{width:100%}.m-page-bar>div .context-menu [class^=c-heading-]{padding-top:8px}}@media only screen and (max-width:539px){.m-page-bar>div,.m-page-bar>div:first-child{width:50%}.m-page-bar>div>.c-price{display:none}}.m-ratings-and-reviews .context-filter,.m-ratings-and-reviews .context-sort{padding-right:24px}.m-ratings-and-reviews .context-response{padding-top:24px}.m-ratings-and-reviews .context-response>div{position:relative;padding-left:24px}.m-ratings-and-reviews .context-response>div:before{font-family:MWF-MDL2;content:"";position:absolute;left:0;top:0}.m-ratings-and-reviews .context-response>div .c-content-toggle p{padding-top:10px}.m-ratings-and-reviews .context-helpful-select{padding-top:24px}.m-ratings-and-reviews .context-helpful-select .c-meta-text{padding-right:13px}.m-ratings-and-reviews .context-helpful-select .c-group{display:inline-block;vertical-align:bottom}.m-ratings-and-reviews .context-helpful-select .c-group button{display:inline-block;color:#0078d7;border:0;background:transparent;padding:0;min-width:inherit;margin:0 13px;vertical-align:inherit}.m-ratings-and-reviews .context-helpful-select .c-group button:hover{text-decoration:underline}.m-ratings-and-reviews .context-helpful-select .c-group button:active{text-decoration:none;color:#006cc2}.m-ratings-and-reviews .context-helpful-select .c-group button:focus{outline:1px dashed #000}.m-ratings-and-reviews .c-histogram{padding-top:22px}.m-ratings-and-reviews .c-divider{margin-top:48px}.m-ratings-and-reviews .c-divider+span{padding:8px 0 8px 8px;float:right}.m-ratings-and-reviews .c-heading-4{padding-top:48px}.m-ratings-and-reviews [data-grid=col-3] .c-rating{padding-top:18px}.m-ratings-and-reviews [data-grid=col-3] .c-paragraph-3{padding:0}.m-ratings-and-reviews [data-grid=col-3] .c-paragraph-3+.c-paragraph-3{padding:8px 0 0}.m-ratings-and-reviews [data-grid=col-3] .c-meta-text{padding-top:8px}.m-ratings-and-reviews [data-grid=col-9] .c-heading-6{font-weight:400;padding:22px 0 5px}.m-ratings-and-reviews [data-grid=col-9] .c-heading-6+.c-content-toggle p{padding-top:0}@media only screen and (max-width:539px){.m-ratings-and-reviews .c-histogram{padding-top:8px}.m-ratings-and-reviews button+[data-grid=col-12] .c-heading-4{padding-top:48px}.m-ratings-and-reviews .c-heading-4{padding-top:28px}.m-ratings-and-reviews .c-select-menu,.m-ratings-and-reviews .context-filter{display:block}.m-ratings-and-reviews .context-sort+.c-select-menu{display:inline-block}.m-ratings-and-reviews .c-divider{margin-top:28px}.m-ratings-and-reviews .c-divider+span{float:none;display:block;padding:8px 8px 8px 0}.m-ratings-and-reviews .context-filter{padding:12px 0 8px}.m-ratings-and-reviews .context-helpful-select .c-meta-text{display:block}.m-ratings-and-reviews .context-helpful-select .c-group button:first-child{margin-left:0}.m-ratings-and-reviews [data-grid=col-9] .c-heading-6{padding:14px 0 4px}.m-ratings-and-reviews [data-grid=col-9] .c-content-toggle p{padding:0}.m-ratings-and-reviews [data-grid=col-9] .c-meta-text{padding:20px 0 24px}.m-ratings-and-reviews [data-grid=col-9] .context-helpful-select .c-meta-text{padding:20px 0 14px}.m-ratings-and-reviews [data-grid=col-9] .context-response{padding-top:24px}.m-ratings-and-reviews [data-grid=col-9] .context-response>div{position:relative;padding-left:24px}.m-ratings-and-reviews [data-grid=col-9] .context-response>div span{display:block}.m-ratings-and-reviews [data-grid=col-9] .context-response>div .c-content-toggle p{padding-top:12px}.m-ratings-and-reviews [data-grid=col-9] .context-response>div:before{font-family:MWF-MDL2;content:"";position:absolute;left:0;top:0}}.m-refinements>div[data-grid=col-3]{margin-top:35px}.m-refinements>div+div{margin-top:36px;padding-left:75px}.m-refinements>div+div>h1{padding-top:12px;padding-bottom:8px}.m-refinements>div+div section{display:inline-block}.m-rich-heading{display:block;height:200px;position:relative;padding-top:0}.m-rich-heading.f-image{width:100%;height:200px;background:#000;color:#fff}.m-rich-heading>div{position:relative;width:50%;float:left}.m-rich-heading>picture.c-image img{height:200px;width:400px;position:absolute;right:0}.m-rich-heading>picture.c-image:after{content:"";position:absolute;z-index:0;top:0;right:285px;width:115px;height:200px;background:-webkit-gradient(linear,right top,left top,color-stop(0,hsla(0,0%,100%,0)),to(#000));background:-webkit-linear-gradient(right,hsla(0,0%,100%,0),#000);background:-o-linear-gradient(right,hsla(0,0%,100%,0) 0,#000 100%);background:linear-gradient(270deg,hsla(0,0%,100%,0) 0,#000)}.m-rich-heading .c-paragraph-3{max-height:40px}.m-rich-heading .c-heading,.m-rich-heading .c-paragraph-3{overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box}.m-rich-heading .c-heading{max-height:80px}.m-rich-heading.theme-light.f-brand-neutral-10{background:#e3e3e3}.m-rich-heading.theme-light.f-brand-neutral-20{background:#c8c8c8}.m-rich-heading.theme-light.f-brand-neutral-30{background:#acacac}.m-rich-heading.theme-dark.f-accent{background:#0078d7}.m-rich-heading.theme-dark.f-brand-neutral-45{background:#919191}.m-rich-heading.theme-dark.f-brand-neutral-55{background:#767676}.m-rich-heading.theme-dark.f-brand-neutral-65{background:#5e5e5e}.m-rich-heading.theme-dark.f-brand-neutral-75{background:#464646}.m-rich-heading.theme-dark.f-brand-neutral-80{background:#2f2f2f}.m-rich-heading.theme-dark.f-brand-neutral-90{background:#171717}.m-rich-heading.theme-dark.f-brand-neutral-100{background:#000}.m-rich-heading .c-logo{position:absolute;right:48px;width:200px;height:130px;margin-top:32px;margin-bottom:32px}.m-rich-heading .c-logo>.c-image{width:100%;max-width:200px;max-height:130px}@media only screen and (max-width:1083px){.m-rich-heading .c-heading{font-size:24px;line-height:28px;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:56px}.m-rich-heading .c-logo{right:36px}}@media only screen and (max-width:767px){.m-rich-heading>div{width:100%;float:none}.m-rich-heading .c-logo,.m-rich-heading .c-paragraph-3{display:none}.m-rich-heading .c-heading{padding:8px}.m-rich-heading.theme-dark,.m-rich-heading.theme-light{height:auto}.m-rich-heading>picture.c-image{z-index:-1}.m-rich-heading>picture.c-image+div{height:200px}.m-rich-heading>picture.c-image+div .c-heading{position:absolute;bottom:40px;z-index:1}.m-rich-heading>picture.c-image:before{content:"";position:absolute;z-index:1;top:0;right:0;left:0;bottom:0;background:rgba(0,0,0,.4)}}@media only screen and (max-width:539px){.m-rich-heading>picture.c-image:after{right:0;left:0;width:100%;background:-webkit-gradient(linear,right top,left top,color-stop(0,hsla(0,0%,100%,0)),color-stop(80%,#000));background:-webkit-linear-gradient(right,hsla(0,0%,100%,0),#000 80%);background:-o-linear-gradient(right,hsla(0,0%,100%,0) 0,#000 80%);background:linear-gradient(270deg,hsla(0,0%,100%,0) 0,#000 80%)}.m-rich-heading>picture.c-image:before{background:hsla(0,0%,100%,0)}}.m-product-detail-hero,.m-product-detail-hero>div[data-grid=col-6]:first-child{padding-top:0}.m-product-detail-hero>div[data-grid=col-6]:first-child>div[data-grid=col-12]{padding-top:36px}.m-product-detail-hero>div[data-grid=col-6]:first-child>div[data-grid=col-12] .c-image{float:left;padding-right:20px}.m-product-detail-hero>div[data-grid=col-6]:first-child>div[data-grid=col-12]>div[data-grid=col-6] h2{padding-top:0}.m-product-detail-hero>div[data-grid=col-6]:first-child>div[data-grid=col-12]>div[data-grid=col-6] h2+p{padding-bottom:4px}.m-product-detail-hero .context-image-cover{height:0;padding-top:25%;position:absolute;top:0;right:0;bottom:0;left:0;z-index:0;background-size:cover;background-position:50%}.m-product-detail-hero .context-image-cover[data-treatment=blur]{overflow:hidden;-webkit-filter:blur(15px);filter:blur(15px)}.m-product-detail-hero .context-image-cover:before{position:absolute;top:0;right:0;bottom:0;left:0;overflow:hidden;z-index:1;content:"";background:-webkit-gradient(linear,left top,left bottom,from(hsla(0,0%,100%,.4)),color-stop(50%,hsla(0,0%,100%,.4)),color-stop(95%,#fff));background:-webkit-linear-gradient(top,hsla(0,0%,100%,.4),hsla(0,0%,100%,.4) 50%,#fff 95%);background:-o-linear-gradient(top,hsla(0,0%,100%,.4) 0,hsla(0,0%,100%,.4) 50%,#fff 95%);background:linear-gradient(180deg,hsla(0,0%,100%,.4) 0,hsla(0,0%,100%,.4) 50%,#fff 95%)}@media only screen and (max-width:768px){.m-product-detail-hero .context-image-cover{padding-top:50%}}.m-product-detail-hero .m-product-detail-hero-product-placement{padding-left:76px;padding-top:36px}.m-product-detail-hero .m-product-detail-hero-product-placement picture{padding-top:40px;padding-right:16px;padding-bottom:16px;float:left}.m-product-detail-hero .m-product-detail-hero-product-placement picture img{max-width:179px}.m-product-detail-hero .m-product-detail-hero-product-placement .context-product-placement-data{float:left}.m-product-detail-hero .m-product-detail-hero-product-placement .c-heading-1{padding-top:24px;padding-bottom:8px}.m-product-detail-hero .m-product-detail-hero-product-placement .c-heading-1+div[data-grid=col-12]{display:none}.m-product-detail-hero .m-product-detail-hero-product-placement .c-badge+.c-heading-1{padding-top:0}.m-product-detail-hero .m-product-detail-hero-product-placement .c-label,.m-product-detail-hero .m-product-detail-hero-product-placement .c-label+.c-group{margin-top:0}.m-product-detail-hero .m-product-detail-hero-product-placement .c-rating{display:inline-block}.m-product-detail-hero .m-product-detail-hero-product-placement .c-meta-text{color:#000;position:relative;top:-2px}.m-product-detail-hero .m-product-detail-hero-product-placement .c-price{font-size:24px;padding-top:24px;font-weight:200}.m-product-detail-hero .m-product-detail-hero-product-placement .c-price .c-label{font-size:24px;line-height:inherit}.m-product-detail-hero .m-product-detail-hero-product-placement .c-price .context-sale-data{font-size:24px;padding-left:8px;font-weight:200}.m-product-detail-hero .m-product-detail-hero-product-placement .c-price .context-sale-data .c-badge{position:relative;bottom:2px;float:none}.m-product-detail-hero .m-product-detail-hero-product-placement .c-combo{margin:0}.m-product-detail-hero .m-product-detail-hero-product-placement .context-configuration-buttons>.c-group .c-select-button{font-size:13px;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:32px;width:250px;white-space:normal}.m-product-detail-hero .m-product-detail-hero-product-placement button[type=submit]{margin-top:24px}.m-product-detail-hero .m-product-detail-hero-product-placement button[type=submit]+.c-caption-2{padding-top:8px}.m-product-detail-hero .m-product-detail-hero-product-placement div[data-grid=col-12]{display:none}.m-product-detail-hero .m-product-detail-hero-social{padding-top:76px}.m-product-detail-hero .m-product-detail-hero-social .c-social,.m-product-detail-hero .m-product-detail-hero-social .m-social{margin-top:12px}.m-product-detail-hero .m-product-detail-hero-social .c-social>.c-hyperlink,.m-product-detail-hero .m-product-detail-hero-social .m-social>.c-hyperlink{width:60px;height:60px;margin-right:8px}.m-product-detail-hero .m-product-detail-hero-social .c-social>.c-hyperlink:before,.m-product-detail-hero .m-product-detail-hero-social .m-social>.c-hyperlink:before{border-radius:50%}.m-product-detail-hero .m-product-detail-hero-social .c-social .c-social,.m-product-detail-hero .m-product-detail-hero-social .c-social .m-social,.m-product-detail-hero .m-product-detail-hero-social .m-social .c-social,.m-product-detail-hero .m-product-detail-hero-social .m-social .m-social{width:60px;height:60px}.m-product-detail-hero .m-product-detail-hero-age-rating{padding-top:20px}.m-product-detail-hero .theme-light{background:none}@media only screen and (min-width:768px){.m-product-detail-hero .m-product-detail-hero-social .c-social .c-image,.m-product-detail-hero .m-product-detail-hero-social .c-social>.c-hyperlink,.m-product-detail-hero .m-product-detail-hero-social .m-social .c-image,.m-product-detail-hero .m-product-detail-hero-social .m-social>.c-hyperlink{width:52px;height:52px}}@media only screen and (max-width:768px){.m-product-detail-hero .m-product-detail-hero-age-rating,.m-product-detail-hero .m-product-detail-hero-social{padding-left:76px}}@media only screen and (max-width:767px){.m-product-detail-hero>div[data-grid=col-6]:first-child{display:none}.m-product-detail-hero>div+div{padding-left:0}.m-product-detail-hero>div+div>h1+div[data-grid=col-12]{display:block}.m-product-detail-hero>div+div>h1+div[data-grid=col-12]+.c-rating,.m-product-detail-hero>div+div>h1+div[data-grid=col-12]+.c-rating+.c-meta-text{display:none}}@media only screen and (max-width:539px){.m-product-detail-hero>div+div .context-configuration-buttons>.c-group .c-select-button{width:100%;margin-right:0}.m-product-detail-hero .m-product-detail-hero-product-placement{padding-top:12px;padding-left:24px}.m-product-detail-hero .m-product-detail-hero-age-rating,.m-product-detail-hero .m-product-detail-hero-social{padding-left:24px}}.m-product-detail-hero.m-digital-good-hero{min-height:400px;position:relative}.m-product-detail-hero.m-digital-good-hero .m-product-detail-hero-product-placement{padding-top:24px}.m-product-detail-hero.m-digital-good-hero>[data-grid*=col-]{position:relative}.m-product-detail-hero.m-digital-good-hero .c-rating{padding-top:12px}.m-product-detail-hero.m-digital-good-hero .c-price{padding-top:40px}.m-product-detail-hero.m-digital-good-hero .c-caption-2{padding-top:8px;display:inline-block}.m-product-detail-hero.m-digital-good-hero>div[data-grid=col-4]{min-height:200px;position:relative}.m-live-gold-badge{margin-top:40px;margin-right:40px;display:inline-block;position:relative;float:right}.m-live-gold-badge>div{width:100%;padding-top:50px;position:absolute;top:0;color:#fff;text-align:center}.m-live-gold-badge>div *{padding:0}@media only screen and (max-width:768px){.m-live-gold-badge{margin-right:0;margin-left:75px;float:none}}@media only screen and (max-width:539px){.m-live-gold-badge{margin-left:25px}}.m-product-placement{padding-top:12px}.m-product-placement .c-hyperlink[aria-hidden=true]{visibility:hidden}.m-product-placement.f-artist a>div{height:inherit}.m-product-placement .c-carousel .c-flipper.f-left,.m-product-placement .c-carousel .c-flipper.f-previous{left:-24px}.m-product-placement .c-carousel .c-flipper.f-next,.m-product-placement .c-carousel .c-flipper.f-right{right:-24px}@media only screen and (max-width:767px){.m-product-placement .c-carousel .c-flipper.f-left,.m-product-placement .c-carousel .c-flipper.f-next,.m-product-placement .c-carousel .c-flipper.f-previous,.m-product-placement .c-carousel .c-flipper.f-right{background-color:transparent}}.m-search-help .c-heading-5{padding:12px 0 24px}.m-search-help span,.m-search-help ul li{padding:2px 0}.m-search-help .f-column{padding-right:24px}.m-search-help .c-search{max-width:none;margin:46px 0 84px}@media only screen and (max-width:539px){.m-search-help .c-heading-5{padding:12px 0 8px}}.m-search-results>div:last-child{padding:24px 0}.m-search-results .c-hyperlink{display:block}.m-search-results .f-result-item,.m-search-results .f-result-item-details{padding-top:24px}.m-search-results .f-result-item-details{padding-left:24px}.m-search-results .f-hyperlink{font-weight:400;line-height:20px}.m-search-results h3.f-hyperlink{font-size:20px;line-height:24px;padding-top:0;font-weight:200}@media (max-width:767px){.m-search-results h3.f-hyperlink{font-size:18px;line-height:24px}}.m-search-results span.f-hyperlink .c-hyperlink{white-space:nowrap;overflow:hidden;-webkit-box-sizing:content-box;box-sizing:content-box;max-height:24px;padding-bottom:1.636px;color:#107c10}.m-search-results p{color:rgba(0,0,0,.6);padding-top:0}@media only screen and (max-width:539px){.m-search-results .f-result-item-details{padding:0}}.m-social{padding-left:0;padding-right:0}.c-social,.m-social{display:block;margin-top:48px}.c-social.f-facebook>div,.c-social.f-pinterest>div,.c-social.f-twitter>div,.m-social.f-facebook>div,.m-social.f-pinterest>div,.m-social.f-twitter>div{display:inline-block;margin-right:24px}.c-social>span,.m-social>span{font-size:11px;line-height:16px;color:rgba(0,0,0,.6)}.c-social>a,.m-social>a{position:relative;width:32px;height:32px}.c-social>a:hover:before,.m-social>a:hover:before{background:rgba(0,0,0,.1)}.c-social>a:focus,.m-social>a:focus{outline:1px dashed #000}.c-social>a:before,.m-social>a:before{background:none;content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0}.c-social>a>img,.m-social>a>img{width:32px;height:32px}.c-social.f-follow>a:hover:before,.c-social.f-share>a:hover:before,.m-social.f-follow>a:hover:before,.m-social.f-share>a:hover:before{background:hsla(0,0%,100%,0)}.c-social.f-follow>a:active,.c-social.f-share>a:active,.m-social.f-follow>a:active,.m-social.f-share>a:active{outline:none}.c-social.f-follow>a>img,.c-social.f-share>a>img,.m-social.f-follow>a>img,.m-social.f-share>a>img{opacity:.6}.c-social.f-follow>a>img:focus,.c-social.f-follow>a>img:hover,.c-social.f-share>a>img:focus,.c-social.f-share>a>img:hover,.m-social.f-follow>a>img:focus,.m-social.f-follow>a>img:hover,.m-social.f-share>a>img:focus,.m-social.f-share>a>img:hover{opacity:.8}.c-social.f-follow>a>img:active,.c-social.f-share>a>img:active,.m-social.f-follow>a>img:active,.m-social.f-share>a>img:active{opacity:1}.c-social button,.m-social button{width:32px;height:32px;border:0;background-color:transparent;padding:0;color:rgba(0,0,0,.6);vertical-align:middle}.c-social button[aria-hidden=true],.m-social button[aria-hidden=true]{display:none}.c-social button:focus,.m-social button:focus{outline:1px dashed #000}.c-social .f-hide,.m-social .f-hide{display:none!important}.c-social.f-horizontal>a,.m-social.f-horizontal>a{display:inline-block;margin-right:12px}.c-social.f-horizontal button[aria-hidden=false],.m-social.f-horizontal button[aria-hidden=false]{display:inline-block}.c-social.f-horizontal button.c-glyph[aria-expanded=false]:after,.m-social.f-horizontal button.c-glyph[aria-expanded=false]:after{content:""}.c-social.f-horizontal button.c-glyph[aria-expanded=true]:after,.m-social.f-horizontal button.c-glyph[aria-expanded=true]:after{content:""}.c-social.f-vertical>a,.m-social.f-vertical>a{display:block;margin-bottom:12px;margin-right:0}.c-social.f-vertical button[aria-hidden=false],.m-social.f-vertical button[aria-hidden=false]{display:block}.c-social.f-vertical button.c-glyph[aria-expanded=false]:after,.m-social.f-vertical button.c-glyph[aria-expanded=false]:after{font-family:MWF-MDL2;content:""}.c-social.f-vertical button.c-glyph[aria-expanded=true]:after,.m-social.f-vertical button.c-glyph[aria-expanded=true]:after{font-family:MWF-MDL2;content:""}@media only screen and (max-width:767px){.c-social,.m-social{margin-top:36px}}.m-supplemental-nav{padding-top:0}.m-system-requirements .c-table tr:before{width:0}.m-system-requirements .c-table td{min-width:120px;padding-left:0;vertical-align:text-top}.m-system-requirements .c-table td:first-child{font-weight:700}',""]),t.locals={"c-heading-1":"c-heading-1",cHeading1:"c-heading-1",h1:"h1","type-h1":"type-h1",typeH1:"type-h1","c-heading-2":"c-heading-2",cHeading2:"c-heading-2",h2:"h2","type-h2":"type-h2",typeH2:"type-h2","c-heading-3":"c-heading-3",cHeading3:"c-heading-3","c-subheading-1":"c-subheading-1",cSubheading1:"c-subheading-1",h3:"h3","type-h3":"type-h3",typeH3:"type-h3","type-sh1":"type-sh1",typeSh1:"type-sh1","c-heading-4":"c-heading-4",cHeading4:"c-heading-4","c-subheading-2":"c-subheading-2",cSubheading2:"c-subheading-2",h4:"h4","type-h4":"type-h4",typeH4:"type-h4","type-sh2":"type-sh2",typeSh2:"type-sh2","c-heading-5":"c-heading-5",cHeading5:"c-heading-5","c-paragraph-1":"c-paragraph-1",cParagraph1:"c-paragraph-1","c-subheading-3":"c-subheading-3",cSubheading3:"c-subheading-3",h5:"h5","type-h5":"type-h5",typeH5:"type-h5","type-p1":"type-p1",typeP1:"type-p1","type-sh3":"type-sh3",typeSh3:"type-sh3","c-heading-6":"c-heading-6",cHeading6:"c-heading-6","c-paragraph-2":"c-paragraph-2",cParagraph2:"c-paragraph-2","c-subheading-4":"c-subheading-4",cSubheading4:"c-subheading-4",h6:"h6","type-h6":"type-h6",typeH6:"type-h6","type-p2":"type-p2",typeP2:"type-p2","type-sh4":"type-sh4",typeSh4:"type-sh4","c-paragraph-3":"c-paragraph-3",cParagraph3:"c-paragraph-3","c-paragraph-4":"c-paragraph-4",cParagraph4:"c-paragraph-4","c-subheading-5":"c-subheading-5",cSubheading5:"c-subheading-5","c-subheading-6":"c-subheading-6",cSubheading6:"c-subheading-6","type-p3":"type-p3",typeP3:"type-p3","type-p4":"type-p4",typeP4:"type-p4","type-sh5":"type-sh5",typeSh5:"type-sh5","type-sh6":"type-sh6",typeSh6:"type-sh6","c-caption-1":"c-caption-1",cCaption1:"c-caption-1","type-c1":"type-c1",typeC1:"type-c1","c-caption-2":"c-caption-2",cCaption2:"c-caption-2","type-c2":"type-c2",typeC2:"type-c2","theme-light":"theme-light",themeLight:"theme-light","theme-dark":"theme-dark",themeDark:"theme-dark","x-clearfix":"x-clearfix",xClearfix:"x-clearfix","x-float-left":"x-float-left",xFloatLeft:"x-float-left","x-float-right":"x-float-right",xFloatRight:"x-float-right","x-visible-print-block":"x-visible-print-block",xVisiblePrintBlock:"x-visible-print-block","x-visible-print-inline":"x-visible-print-inline",xVisiblePrintInline:"x-visible-print-inline","x-visible-print-inline-block":"x-visible-print-inline-block",xVisiblePrintInlineBlock:"x-visible-print-inline-block","x-hidden-print":"x-hidden-print",xHiddenPrint:"x-hidden-print","x-visible-vp1-block":"x-visible-vp1-block",xVisibleVp1Block:"x-visible-vp1-block","x-visible-vp1-inline":"x-visible-vp1-inline",xVisibleVp1Inline:"x-visible-vp1-inline","x-visible-vp1-inline-block":"x-visible-vp1-inline-block",xVisibleVp1InlineBlock:"x-visible-vp1-inline-block","x-hidden-vp1":"x-hidden-vp1",xHiddenVp1:"x-hidden-vp1","x-visible-vp2-block":"x-visible-vp2-block",xVisibleVp2Block:"x-visible-vp2-block","x-visible-vp2-inline":"x-visible-vp2-inline",xVisibleVp2Inline:"x-visible-vp2-inline","x-visible-vp2-inline-block":"x-visible-vp2-inline-block",xVisibleVp2InlineBlock:"x-visible-vp2-inline-block","x-hidden-vp2":"x-hidden-vp2",xHiddenVp2:"x-hidden-vp2","x-visible-vp3-block":"x-visible-vp3-block",xVisibleVp3Block:"x-visible-vp3-block","x-visible-vp3-inline":"x-visible-vp3-inline",xVisibleVp3Inline:"x-visible-vp3-inline","x-visible-vp3-inline-block":"x-visible-vp3-inline-block",xVisibleVp3InlineBlock:"x-visible-vp3-inline-block","x-hidden-vp3":"x-hidden-vp3",xHiddenVp3:"x-hidden-vp3","x-visible-vp4-block":"x-visible-vp4-block",xVisibleVp4Block:"x-visible-vp4-block","x-visible-vp4-inline":"x-visible-vp4-inline",xVisibleVp4Inline:"x-visible-vp4-inline","x-visible-vp4-inline-block":"x-visible-vp4-inline-block",xVisibleVp4InlineBlock:"x-visible-vp4-inline-block","x-hidden-vp4":"x-hidden-vp4",xHiddenVp4:"x-hidden-vp4","x-visible-vp5-block":"x-visible-vp5-block",xVisibleVp5Block:"x-visible-vp5-block","x-visible-vp5-inline":"x-visible-vp5-inline",xVisibleVp5Inline:"x-visible-vp5-inline","x-visible-vp5-inline-block":"x-visible-vp5-inline-block",xVisibleVp5InlineBlock:"x-visible-vp5-inline-block","x-hidden-vp5":"x-hidden-vp5",xHiddenVp5:"x-hidden-vp5","sr-only":"sr-only",srOnly:"sr-only","x-screen-reader":"x-screen-reader",xScreenReader:"x-screen-reader","x-type-center":"x-type-center",xTypeCenter:"x-type-center","x-type-right":"x-type-right",xTypeRight:"x-type-right","x-type-left":"x-type-left",xTypeLeft:"x-type-left","c-action-trigger":"c-action-trigger",cActionTrigger:"c-action-trigger","c-glyph":"c-glyph",cGlyph:"c-glyph","glyph-edit":"glyph-edit",glyphEdit:"glyph-edit","glyph-cancel":"glyph-cancel",glyphCancel:"glyph-cancel","glyph-global-nav-button":"glyph-global-nav-button",glyphGlobalNavButton:"glyph-global-nav-button","glyph-shopping-cart":"glyph-shopping-cart",glyphShoppingCart:"glyph-shopping-cart","glyph-chevron-left":"glyph-chevron-left",glyphChevronLeft:"glyph-chevron-left","glyph-chevron-right":"glyph-chevron-right",glyphChevronRight:"glyph-chevron-right","glyph-arrow-htmllegacy-mirrored":"glyph-arrow-htmllegacy-mirrored",glyphArrowHtmllegacyMirrored:"glyph-arrow-htmllegacy-mirrored","glyph-arrow-htmllegacy":"glyph-arrow-htmllegacy",glyphArrowHtmllegacy:"glyph-arrow-htmllegacy","glyph-play":"glyph-play",glyphPlay:"glyph-play","glyph-info":"glyph-info",glyphInfo:"glyph-info","c-age-rating":"c-age-rating",cAgeRating:"c-age-rating","c-image":"c-image",cImage:"c-image","c-label":"c-label",cLabel:"c-label","c-paragraph":"c-paragraph",cParagraph:"c-paragraph","c-content-toggle":"c-content-toggle",cContentToggle:"c-content-toggle","c-auto-suggest":"c-auto-suggest",cAutoSuggest:"c-auto-suggest","c-menu":"c-menu",cMenu:"c-menu","c-menu-item":"c-menu-item",cMenuItem:"c-menu-item","f-auto-suggest-no-results":"f-auto-suggest-no-results",fAutoSuggestNoResults:"f-auto-suggest-no-results","f-auto-suggest-scroll":"f-auto-suggest-scroll",fAutoSuggestScroll:"f-auto-suggest-scroll","c-search":"c-search",cSearch:"c-search","c-badge":"c-badge",cBadge:"c-badge","f-highlight":"f-highlight",fHighlight:"f-highlight","f-lowlight":"f-lowlight",fLowlight:"f-lowlight","f-small":"f-small",fSmall:"f-small","f-large":"f-large",fLarge:"f-large","c-breadcrumb":"c-breadcrumb",cBreadcrumb:"c-breadcrumb",btn:"btn","c-button":"c-button",cButton:"c-button","btn-primary":"btn-primary",btnPrimary:"btn-primary","c-call-to-action":"c-call-to-action",cCallToAction:"c-call-to-action","f-secondary":"f-secondary",fSecondary:"f-secondary","c-carousel":"c-carousel",cCarousel:"c-carousel","c-flipper":"c-flipper",cFlipper:"c-flipper","f-left":"f-left",fLeft:"f-left","f-previous":"f-previous",fPrevious:"f-previous","f-next":"f-next",fNext:"f-next","f-right":"f-right",fRight:"f-right","f-scrollable-next":"f-scrollable-next",fScrollableNext:"f-scrollable-next","f-scrollable-previous":"f-scrollable-previous",fScrollablePrevious:"f-scrollable-previous","c-sequence-indicator":"c-sequence-indicator",cSequenceIndicator:"c-sequence-indicator","f-multi-slide":"f-multi-slide",fMultiSlide:"f-multi-slide",hero:"hero","f-active":"f-active",fActive:"f-active","f-single-slide":"f-single-slide",fSingleSlide:"f-single-slide","f-gallery":"f-gallery",fGallery:"f-gallery","c-hero":"c-hero",cHero:"c-hero","m-hero-item":"m-hero-item",mHeroItem:"m-hero-item","f-x-left":"f-x-left",fXLeft:"f-x-left","f-x-right":"f-x-right",fXRight:"f-x-right","f-animate-next":"f-animate-next",fAnimateNext:"f-animate-next","hero-background-next":"hero-background-next",heroBackgroundNext:"hero-background-next","f-x-center":"f-x-center",fXCenter:"f-x-center","hero-background-next-x-center":"hero-background-next-x-center",heroBackgroundNextXCenter:"hero-background-next-x-center","f-y-center":"f-y-center",fYCenter:"f-y-center","hero-background-next-y-center":"hero-background-next-y-center",heroBackgroundNextYCenter:"hero-background-next-y-center","hero-background-next-x-center-y-center":"hero-background-next-x-center-y-center",heroBackgroundNextXCenterYCenter:"hero-background-next-x-center-y-center","hero-content-next":"hero-content-next",heroContentNext:"hero-content-next","f-animate-previous":"f-animate-previous",fAnimatePrevious:"f-animate-previous","hero-background-previous":"hero-background-previous",heroBackgroundPrevious:"hero-background-previous","hero-background-previous-x-center":"hero-background-previous-x-center",heroBackgroundPreviousXCenter:"hero-background-previous-x-center","hero-background-previous-y-center":"hero-background-previous-y-center",heroBackgroundPreviousYCenter:"hero-background-previous-y-center","hero-background-previous-x-center-y-center":"hero-background-previous-x-center-y-center",heroBackgroundPreviousXCenterYCenter:"hero-background-previous-x-center-y-center","hero-content-previous":"hero-content-previous",heroContentPrevious:"hero-content-previous","c-checkbox":"c-checkbox",cCheckbox:"c-checkbox",checkbox:"checkbox","c-choice-summary":"c-choice-summary",cChoiceSummary:"c-choice-summary","c-combo":"c-combo",cCombo:"c-combo",active:"active","c-content-placement":"c-content-placement",cContentPlacement:"c-content-placement","c-heading":"c-heading",cHeading:"c-heading","c-video":"c-video",cVideo:"c-video","c-group":"c-group",cGroup:"c-group","c-date-time-picker":"c-date-time-picker",cDateTimePicker:"c-date-time-picker","f-js-pm":"f-js-pm",fJsPm:"f-js-pm","f-js-last":"f-js-last",fJsLast:"f-js-last","glyph-accept":"glyph-accept",glyphAccept:"glyph-accept","c-dialog":"c-dialog",cDialog:"c-dialog","f-flow":"f-flow",fFlow:"f-flow","f-lightbox":"f-lightbox",fLightbox:"f-lightbox","c-divider":"c-divider",cDivider:"c-divider","c-drawer":"c-drawer",cDrawer:"c-drawer","f-toggle":"f-toggle",fToggle:"f-toggle","c-link-navigation":"c-link-navigation",cLinkNavigation:"c-link-navigation","c-hyperlink":"c-hyperlink",cHyperlink:"c-hyperlink","f-responsive":"f-responsive",fResponsive:"f-responsive","f-show":"f-show",fShow:"f-show","c-explicit":"c-explicit",cExplicit:"c-explicit","c-feature":"c-feature",cFeature:"c-feature","f-align-left":"f-align-left",fAlignLeft:"f-align-left","f-align-right":"f-align-right",fAlignRight:"f-align-right","f-align-center":"f-align-center",fAlignCenter:"f-align-center","c-file":"c-file",cFile:"c-file","c-text-field":"c-text-field",cTextField:"c-text-field","c-flyout":"c-flyout",cFlyout:"c-flyout","c-universal-footer":"c-universal-footer",cUniversalFooter:"c-universal-footer","c-list":"c-list",cList:"c-list","glyph-world":"glyph-world",glyphWorld:"glyph-world","btn-group":"btn-group",btnGroup:"btn-group","checkbox-inline":"checkbox-inline",checkboxInline:"checkbox-inline","radio-inline":"radio-inline",radioInline:"radio-inline","f-wrap-items":"f-wrap-items",fWrapItems:"f-wrap-items","c-product-placement":"c-product-placement",cProductPlacement:"c-product-placement","f-orientation-vertical":"f-orientation-vertical",fOrientationVertical:"f-orientation-vertical","f-size-medium":"f-size-medium",fSizeMedium:"f-size-medium","m-product-placement-item":"m-product-placement-item",mProductPlacementItem:"m-product-placement-item","c-select-button":"c-select-button",cSelectButton:"c-select-button","c-histogram":"c-histogram",cHistogram:"c-histogram",histogram:"histogram","rating-star-bars":"rating-star-bars",ratingStarBars:"rating-star-bars",glyph:"glyph","img-responsive":"img-responsive",imgResponsive:"img-responsive","f-round":"f-round",fRound:"f-round","c-in-page-navigation":"c-in-page-navigation",cInPageNavigation:"c-in-page-navigation","f-vertical":"f-vertical",fVertical:"f-vertical","f-sticky":"f-sticky",fSticky:"f-sticky","f-dropdown":"f-dropdown",fDropdown:"f-dropdown","f-hide":"f-hide",fHide:"f-hide","c-select-menu":"c-select-menu",cSelectMenu:"c-select-menu","f-dropdown-menu":"f-dropdown-menu",fDropdownMenu:"f-dropdown-menu","f-border":"f-border",fBorder:"f-border","dropdown-menu":"dropdown-menu",dropdownMenu:"dropdown-menu",js:"js","no-js":"no-js",noJs:"no-js","c-password":"c-password",cPassword:"c-password","form-control":"form-control",formControl:"form-control","link-navigation":"link-navigation",linkNavigation:"link-navigation","text-title":"text-title",textTitle:"text-title","f-image":"f-image",fImage:"f-image","list-styled":"list-styled",listStyled:"list-styled","f-lean":"f-lean",fLean:"f-lean","f-bare":"f-bare",fBare:"f-bare","list-unstyled":"list-unstyled",listUnstyled:"list-unstyled","c-logo":"c-logo",cLogo:"c-logo","c-meta-text":"c-meta-text",cMetaText:"c-meta-text","f-sub-menu":"f-sub-menu",fSubMenu:"f-sub-menu","f-flip":"f-flip",fFlip:"f-flip",fadeIn:"fadeIn","c-mosaic":"c-mosaic",cMosaic:"c-mosaic","c-pagination":"c-pagination",cPagination:"c-pagination",pagination:"pagination","f-flex":"f-flex",fFlex:"f-flex","c-pivot":"c-pivot",cPivot:"c-pivot","f-disabled":"f-disabled",fDisabled:"f-disabled","c-mosaic-placement":"c-mosaic-placement",cMosaicPlacement:"c-mosaic-placement","f-background-neutral-00":"f-background-neutral-00",fBackgroundNeutral00:"f-background-neutral-00","f-background-neutral-10":"f-background-neutral-10",fBackgroundNeutral10:"f-background-neutral-10","f-background-neutral-20":"f-background-neutral-20",fBackgroundNeutral20:"f-background-neutral-20","f-background-neutral-30":"f-background-neutral-30",fBackgroundNeutral30:"f-background-neutral-30","f-background-neutral-45":"f-background-neutral-45",fBackgroundNeutral45:"f-background-neutral-45","f-background-neutral-55":"f-background-neutral-55",fBackgroundNeutral55:"f-background-neutral-55","f-background-neutral-65":"f-background-neutral-65",fBackgroundNeutral65:"f-background-neutral-65","f-background-neutral-75":"f-background-neutral-75",fBackgroundNeutral75:"f-background-neutral-75","f-background-neutral-80":"f-background-neutral-80",fBackgroundNeutral80:"f-background-neutral-80","f-background-neutral-90":"f-background-neutral-90",fBackgroundNeutral90:"f-background-neutral-90","f-background-neutral-100":"f-background-neutral-100",fBackgroundNeutral100:"f-background-neutral-100","f-background-accent":"f-background-accent",fBackgroundAccent:"f-background-accent","f-mask-10":"f-mask-10",fMask10:"f-mask-10","f-mask-20":"f-mask-20",fMask20:"f-mask-20","f-mask-40":"f-mask-40",fMask40:"f-mask-40","f-mask-60":"f-mask-60",fMask60:"f-mask-60","f-mask-80":"f-mask-80",fMask80:"f-mask-80","f-mask-100":"f-mask-100",fMask100:"f-mask-100","c-subheading":"c-subheading",cSubheading:"c-subheading","f-height-large":"f-height-large",fHeightLarge:"f-height-large","f-width-small":"f-width-small",fWidthSmall:"f-width-small","f-width-large":"f-width-large",fWidthLarge:"f-width-large","f-height-medium":"f-height-medium",fHeightMedium:"f-height-medium","c-price":"c-price",cPrice:"c-price","c-progress":"c-progress",cProgress:"c-progress","f-indeterminate-regional":"f-indeterminate-regional",fIndeterminateRegional:"f-indeterminate-regional",dots:"dots","f-indeterminate-local":"f-indeterminate-local",fIndeterminateLocal:"f-indeterminate-local",orbit:"orbit","f-progress-large":"f-progress-large",fProgressLarge:"f-progress-large","f-progress-small":"f-progress-small",fProgressSmall:"f-progress-small","c-rating":"c-rating",cRating:"c-rating","f-individual":"f-individual",fIndividual:"f-individual","f-community-rated":"f-community-rated",fCommunityRated:"f-community-rated","f-full":"f-full",fFull:"f-full","f-half":"f-half",fHalf:"f-half","f-user-rated":"f-user-rated",fUserRated:"f-user-rated","c-radio":"c-radio",cRadio:"c-radio",radio:"radio","c-refine-item":"c-refine-item",cRefineItem:"c-refine-item","c-refine-menu":"c-refine-menu",cRefineMenu:"c-refine-menu","f-swatch-disabled":"f-swatch-disabled",fSwatchDisabled:"f-swatch-disabled","f-swatch-disabled-dark":"f-swatch-disabled-dark",fSwatchDisabledDark:"f-swatch-disabled-dark",dropdown:"dropdown","c-select":"c-select",cSelect:"c-select",combobox:"combobox","c-slider":"c-slider",cSlider:"c-slider","c-structured-list":"c-structured-list",cStructuredList:"c-structured-list","f-column":"f-column",fColumn:"f-column","f-row":"f-row",fRow:"f-row","c-supplemental-nav":"c-supplemental-nav",cSupplementalNav:"c-supplemental-nav","c-table":"c-table",cTable:"c-table","table-responsive":"table-responsive",tableResponsive:"table-responsive","f-divided":"f-divided",fDivided:"f-divided","f-ascending":"f-ascending",fAscending:"f-ascending","f-descending":"f-descending",fDescending:"f-descending","f-sub-categorical":"f-sub-categorical",fSubCategorical:"f-sub-categorical","f-numerical":"f-numerical",fNumerical:"f-numerical","c-textarea":"c-textarea",cTextarea:"c-textarea","f-resize":"f-resize",fResize:"f-resize","f-no-resize":"f-no-resize",fNoResize:"f-no-resize","f-scroll":"f-scroll",fScroll:"f-scroll","c-toggle":"c-toggle",cToggle:"c-toggle","c-tooltip":"c-tooltip",cTooltip:"c-tooltip","c-track-list-placement":"c-track-list-placement",cTrackListPlacement:"c-track-list-placement","f-information":"f-information",fInformation:"f-information","f-size-small":"f-size-small",fSizeSmall:"f-size-small","c-universal-header":"c-universal-header",cUniversalHeader:"c-universal-header","c-me":"c-me",cMe:"c-me","f-multi-column":"f-multi-column",fMultiColumn:"f-multi-column","brand-blue":"brand-blue",brandBlue:"brand-blue","brand-green":"brand-green",brandGreen:"brand-green","brand-neutral":"brand-neutral",brandNeutral:"brand-neutral","f-transparent":"f-transparent",fTransparent:"f-transparent","f-hidden":"f-hidden",fHidden:"f-hidden","f-progress":"f-progress",fProgress:"f-progress","f-video-controls":"f-video-controls",fVideoControls:"f-video-controls","glyph-mute":"glyph-mute",glyphMute:"glyph-mute","glyph-volume":"glyph-volume",glyphVolume:"glyph-volume","f-timecode":"f-timecode",fTimecode:"f-timecode","f-play-pause":"f-play-pause",fPlayPause:"f-play-pause","f-full-screen":"f-full-screen",fFullScreen:"f-full-screen","f-volume-button":"f-volume-button",fVolumeButton:"f-volume-button","f-volume-slider":"f-volume-slider",fVolumeSlider:"f-volume-slider","f-options":"f-options",fOptions:"f-options","f-options-dialog":"f-options-dialog",fOptionsDialog:"f-options-dialog","glyph-check-mark":"glyph-check-mark",glyphCheckMark:"glyph-check-mark","glyph-pause":"glyph-pause",glyphPause:"glyph-pause","glyph-full-screen":"glyph-full-screen",glyphFullScreen:"glyph-full-screen","glyph-more":"glyph-more",glyphMore:"glyph-more","glyph-copy":"glyph-copy",glyphCopy:"glyph-copy","glyph-mail":"glyph-mail",glyphMail:"glyph-mail","f-slidein":"f-slidein",fSlidein:"f-slidein",slidein:"slidein","f-slideout":"f-slideout",fSlideout:"f-slideout",slideout:"slideout","context-accessory":"context-accessory",contextAccessory:"context-accessory","f-default-image":"f-default-image",fDefaultImage:"f-default-image","context-artist":"context-artist",contextArtist:"context-artist","context-device":"context-device",contextDevice:"context-device","context-tvshow":"context-tvshow",contextTvshow:"context-tvshow","context-movie":"context-movie",contextMovie:"context-movie","f-size-large":"f-size-large",fSizeLarge:"f-size-large","f-size-extra-large":"f-size-extra-large",fSizeExtraLarge:"f-size-extra-large","c-product-subtitle":"c-product-subtitle",cProductSubtitle:"c-product-subtitle","c-product-title":"c-product-title",cProductTitle:"c-product-title","f-accent":"f-accent",fAccent:"f-accent","context-app":"context-app",contextApp:"context-app","context-article":"context-article",contextArticle:"context-article","context-game":"context-game",contextGame:"context-game","context-music-album":"context-music-album",contextMusicAlbum:"context-music-album","f-y-top":"f-y-top",fYTop:"f-y-top","f-y-bottom":"f-y-bottom",fYBottom:"f-y-bottom","m-additional-information":"m-additional-information",mAdditionalInformation:"m-additional-information","c-alert":"c-alert",cAlert:"c-alert","m-alert":"m-alert",mAlert:"m-alert","f-fixed":"f-fixed",fFixed:"f-fixed","f-warning":"f-warning",fWarning:"f-warning","f-error":"f-error",fError:"f-error","glyph-warning":"glyph-warning",glyphWarning:"glyph-warning","glyph-incident-triangle":"glyph-incident-triangle",glyphIncidentTriangle:"glyph-incident-triangle","c-back-to-top":"c-back-to-top",cBackToTop:"c-back-to-top","m-back-to-top":"m-back-to-top",mBackToTop:"m-back-to-top","glyph-up":"glyph-up",glyphUp:"glyph-up","m-banner":"m-banner",mBanner:"m-banner","c-compare-chart":"c-compare-chart",cCompareChart:"c-compare-chart","m-compare-chart":"m-compare-chart",mCompareChart:"m-compare-chart","f-icons":"f-icons",fIcons:"f-icons","m-content-placement":"m-content-placement",mContentPlacement:"m-content-placement","m-feature":"m-feature",mFeature:"m-feature","m-feature-channel":"m-feature-channel",mFeatureChannel:"m-feature-channel","m-group-call-to-action":"m-group-call-to-action",mGroupCallToAction:"m-group-call-to-action","m-hero":"m-hero",mHero:"m-hero","m-in-page-navigation":"m-in-page-navigation",mInPageNavigation:"m-in-page-navigation","m-link-navigation":"m-link-navigation",mLinkNavigation:"m-link-navigation","m-media":"m-media",mMedia:"m-media","m-hyperlink-group":"m-hyperlink-group",mHyperlinkGroup:"m-hyperlink-group","f-brand-neutral-100":"f-brand-neutral-100",fBrandNeutral100:"f-brand-neutral-100","m-hyperlink-group-content-placement":"m-hyperlink-group-content-placement",mHyperlinkGroupContentPlacement:"m-hyperlink-group-content-placement","m-mosaic":"m-mosaic",mMosaic:"m-mosaic","m-multi-column":"m-multi-column",mMultiColumn:"m-multi-column","f-columns-1":"f-columns-1",fColumns1:"f-columns-1","f-columns-2":"f-columns-2",fColumns2:"f-columns-2","f-columns-3":"f-columns-3",fColumns3:"f-columns-3","f-columns-4":"f-columns-4",fColumns4:"f-columns-4","f-columns-5":"f-columns-5",fColumns5:"f-columns-5","m-page-bar":"m-page-bar",mPageBar:"m-page-bar","context-menu":"context-menu",contextMenu:"context-menu","m-ratings-and-reviews":"m-ratings-and-reviews",mRatingsAndReviews:"m-ratings-and-reviews","context-filter":"context-filter",contextFilter:"context-filter","context-sort":"context-sort",contextSort:"context-sort","context-response":"context-response",contextResponse:"context-response","context-helpful-select":"context-helpful-select",contextHelpfulSelect:"context-helpful-select","m-refinements":"m-refinements",mRefinements:"m-refinements","m-rich-heading":"m-rich-heading",mRichHeading:"m-rich-heading","f-brand-neutral-10":"f-brand-neutral-10",fBrandNeutral10:"f-brand-neutral-10","f-brand-neutral-20":"f-brand-neutral-20",fBrandNeutral20:"f-brand-neutral-20","f-brand-neutral-30":"f-brand-neutral-30",fBrandNeutral30:"f-brand-neutral-30","f-brand-neutral-45":"f-brand-neutral-45",fBrandNeutral45:"f-brand-neutral-45","f-brand-neutral-55":"f-brand-neutral-55",fBrandNeutral55:"f-brand-neutral-55","f-brand-neutral-65":"f-brand-neutral-65",fBrandNeutral65:"f-brand-neutral-65","f-brand-neutral-75":"f-brand-neutral-75",fBrandNeutral75:"f-brand-neutral-75","f-brand-neutral-80":"f-brand-neutral-80",fBrandNeutral80:"f-brand-neutral-80","f-brand-neutral-90":"f-brand-neutral-90",fBrandNeutral90:"f-brand-neutral-90","m-product-detail-hero":"m-product-detail-hero",mProductDetailHero:"m-product-detail-hero","context-image-cover":"context-image-cover",contextImageCover:"context-image-cover","m-product-detail-hero-product-placement":"m-product-detail-hero-product-placement",mProductDetailHeroProductPlacement:"m-product-detail-hero-product-placement","context-product-placement-data":"context-product-placement-data",contextProductPlacementData:"context-product-placement-data","context-sale-data":"context-sale-data",contextSaleData:"context-sale-data","context-configuration-buttons":"context-configuration-buttons",contextConfigurationButtons:"context-configuration-buttons","m-product-detail-hero-social":"m-product-detail-hero-social",mProductDetailHeroSocial:"m-product-detail-hero-social","c-social":"c-social",cSocial:"c-social","m-social":"m-social",mSocial:"m-social","m-product-detail-hero-age-rating":"m-product-detail-hero-age-rating",mProductDetailHeroAgeRating:"m-product-detail-hero-age-rating","m-digital-good-hero":"m-digital-good-hero",mDigitalGoodHero:"m-digital-good-hero","m-live-gold-badge":"m-live-gold-badge",mLiveGoldBadge:"m-live-gold-badge","m-product-placement":"m-product-placement",mProductPlacement:"m-product-placement","f-artist":"f-artist",fArtist:"f-artist","m-search-help":"m-search-help",mSearchHelp:"m-search-help","m-search-results":"m-search-results",mSearchResults:"m-search-results","f-result-item":"f-result-item",fResultItem:"f-result-item","f-result-item-details":"f-result-item-details",fResultItemDetails:"f-result-item-details","f-hyperlink":"f-hyperlink",fHyperlink:"f-hyperlink","f-facebook":"f-facebook",fFacebook:"f-facebook","f-pinterest":"f-pinterest",fPinterest:"f-pinterest","f-twitter":"f-twitter",fTwitter:"f-twitter","f-follow":"f-follow",fFollow:"f-follow","f-share":"f-share",fShare:"f-share","f-horizontal":"f-horizontal",fHorizontal:"f-horizontal","m-supplemental-nav":"m-supplemental-nav",mSupplementalNav:"m-supplemental-nav","m-system-requirements":"m-system-requirements",mSystemRequirements:"m-system-requirements"}},33283:function(e,t,i){e.exports=i.p+"static/media/MWFMDL2.deb7f918.woff"},33284:function(e,t,i){e.exports=i.p+"static/media/MWFMDL2.544a7ef2.ttf"},33285:function(e,t,i){e.exports=i.p+"static/media/MWFMDL2.deda6db1.svg"},33286:function(e,t,i){var r=i(33287);"string"==typeof r&&(r=[[e.i,r,""]]);var n={hmr:!1,transform:void 0,insertInto:void 0};i(14234)(r,n);r.locals&&(e.exports=r.locals)},33287:function(e,t,i){(t=e.exports=i(14233)(!1)).push([e.i,'.c-select:after{pointer-events:none}.c-select:after,.combobox:after{background:transparent}.c-table tr:before,.table-responsive tr:before{content:none}.c-carousel button.c-flipper{font-family:MWF-MDL2}.ms-Tooltip-subtext{font-size:12px;line-height:normal;letter-spacing:normal;padding:initial}.fl-WidgetInlineConsent-CheckBox .ms-Checkbox label{margin-top:0;padding-bottom:0;line-height:normal}.msla-diet-view label{margin:inherit;padding:inherit}.fl-LabeledText h1,.fl-LabeledText p{line-height:normal;letter-spacing:normal;padding:initial}.fl-DetailsList-empty p{padding:0}.approvalActivity p{font-size:14px;padding:0;margin:0;overflow:auto}.ba-Panel-header h1{padding:0;letter-spacing:0;line-height:normal}.ba-EmptyState p{padding:0;font-weight:auto}.ba-DetailsList-empty a,.ba-DetailsList-error a,.fl-Create-CDS-Panel a{color:#06f;text-decoration:underline}.ba-CardSubTitle{line-height:normal}.fl-CreateModalHeader-headerTitle{line-height:normal;margin:initial;letter-spacing:normal;padding:0}.fl-CreateModalImageSection ul{padding:0 0 0 20px;margin:0;list-style-type:disc}.fl-CreateModalImageSection p{font-size:14px;margin:initial;padding-top:0;font-weight:400;line-height:normal}.fl-DialogWithIconHeader-header h2{font-size:28px;padding:0}.fl-DialogWithIconHeader p{font-size:13px;padding:0}.fl-PermissionSurface-scope h4{font-size:13px;font-weight:400;height:18px;padding:0}.fl-PermissionSurface-scope li{list-style:disc;margin-left:40px}.fl-ApprovalViewInfo a,.fl-Designer-TokenCallout a{color:#06f}.fl-DetailsCard-Section-Body a:hover{color:#00388c}.fl-Attachment-fileTypeIcon img{vertical-align:unset}#react-office-header button{line-height:normal}.no-mwf h1,.no-mwf h2,.no-mwf h3,.no-mwf p{line-height:auto;margin:initial;padding:initial;line-height:normal;letter-spacing:normal;font-weight:400;font-size:medium}.no-mwf a{letter-spacing:normal;text-decoration:initial}a:link[class^="ms-Link fl-Link fl-TemplateCard"]{text-decoration:none!important}#flow-commenting-pane .ms-Icon{-webkit-box-sizing:content-box;box-sizing:content-box}#flow-commenting-pane p{line-height:unset;letter-spacing:unset;font-weight:unset;font-size:unset}.msla-run-after-action-menu-list label{display:inline}',""]),t.locals={"c-select":"c-select",cSelect:"c-select",combobox:"combobox","c-table":"c-table",cTable:"c-table","table-responsive":"table-responsive",tableResponsive:"table-responsive","c-carousel":"c-carousel",cCarousel:"c-carousel","c-flipper":"c-flipper",cFlipper:"c-flipper","ms-Tooltip-subtext":"ms-Tooltip-subtext",msTooltipSubtext:"ms-Tooltip-subtext","fl-WidgetInlineConsent-CheckBox":"fl-WidgetInlineConsent-CheckBox",flWidgetInlineConsentCheckBox:"fl-WidgetInlineConsent-CheckBox","ms-Checkbox":"ms-Checkbox",msCheckbox:"ms-Checkbox","msla-diet-view":"msla-diet-view",mslaDietView:"msla-diet-view","fl-LabeledText":"fl-LabeledText",flLabeledText:"fl-LabeledText","fl-DetailsList-empty":"fl-DetailsList-empty",flDetailsListEmpty:"fl-DetailsList-empty",approvalActivity:"approvalActivity","ba-Panel-header":"ba-Panel-header",baPanelHeader:"ba-Panel-header","ba-EmptyState":"ba-EmptyState",baEmptyState:"ba-EmptyState","ba-DetailsList-empty":"ba-DetailsList-empty",baDetailsListEmpty:"ba-DetailsList-empty","ba-DetailsList-error":"ba-DetailsList-error",baDetailsListError:"ba-DetailsList-error","fl-Create-CDS-Panel":"fl-Create-CDS-Panel",flCreateCdsPanel:"fl-Create-CDS-Panel","ba-CardSubTitle":"ba-CardSubTitle",baCardSubTitle:"ba-CardSubTitle","fl-CreateModalHeader-headerTitle":"fl-CreateModalHeader-headerTitle",flCreateModalHeaderHeaderTitle:"fl-CreateModalHeader-headerTitle","fl-CreateModalImageSection":"fl-CreateModalImageSection",flCreateModalImageSection:"fl-CreateModalImageSection","fl-DialogWithIconHeader-header":"fl-DialogWithIconHeader-header",flDialogWithIconHeaderHeader:"fl-DialogWithIconHeader-header","fl-DialogWithIconHeader":"fl-DialogWithIconHeader",flDialogWithIconHeader:"fl-DialogWithIconHeader","fl-PermissionSurface-scope":"fl-PermissionSurface-scope",flPermissionSurfaceScope:"fl-PermissionSurface-scope","fl-ApprovalViewInfo":"fl-ApprovalViewInfo",flApprovalViewInfo:"fl-ApprovalViewInfo","fl-Designer-TokenCallout":"fl-Designer-TokenCallout",flDesignerTokenCallout:"fl-Designer-TokenCallout","fl-DetailsCard-Section-Body":"fl-DetailsCard-Section-Body",flDetailsCardSectionBody:"fl-DetailsCard-Section-Body","fl-Attachment-fileTypeIcon":"fl-Attachment-fileTypeIcon",flAttachmentFileTypeIcon:"fl-Attachment-fileTypeIcon","react-office-header":"react-office-header",reactOfficeHeader:"react-office-header","no-mwf":"no-mwf",noMwf:"no-mwf","flow-commenting-pane":"flow-commenting-pane",flowCommentingPane:"flow-commenting-pane","ms-Icon":"ms-Icon",msIcon:"ms-Icon","msla-run-after-action-menu-list":"msla-run-after-action-menu-list",mslaRunAfterActionMenuList:"msla-run-after-action-menu-list"}},33288:function(e,t,i){var r=i(33289);"string"==typeof r&&(r=[[e.i,r,""]]);var n={hmr:!1,transform:void 0,insertInto:void 0};i(14234)(r,n);r.locals&&(e.exports=r.locals)},33289:function(e,t,i){(t=e.exports=i(14233)(!1)).push([e.i,'.hide,.hide-for-small-only,.hide-for-small-up,.show-for-large-only,.show-for-large-up,.show-for-medium-only,.show-for-medium-up{display:none!important}.hide-for-large-only,.hide-for-large-up,.hide-for-medium-only,.hide-for-medium-up,.show-for-small-only,.show-for-small-up{display:block!important}@media only screen and (min-width:480px){.hide-for-medium-only,.hide-for-medium-up,.show-for-small-only{display:none!important}.hide-for-small-only,.show-for-medium-only,.show-for-medium-up{display:block!important}}@media only screen and (min-width:960px){.hide-for-large-only,.hide-for-large-up,.hide-for-medium-only,.show-for-medium-only{display:none!important}.hide-for-medium-only,.show-for-large-only,.show-for-large-up{display:block!important}}.container,.section{width:100%}.section{padding:50px 0}.row{margin:0 auto;max-width:1200px;padding-left:2%;padding-right:2%;width:96%}.row:after{clear:both;content:"";display:table}.row+.row{margin-top:6%}.row+.row-divided{border-top:1px solid #dedede;padding-top:6%}.column{margin:0 2.08333333%;width:95.83333333%;display:inline;float:left}.column+.column{margin-top:6%}.column>:last-child{margin-bottom:0}.column>:first-child{margin-top:0}.column .row{margin-left:-4.16666667%;margin-right:-4.16666667%;width:104.16666667%}@media only screen and (min-width:320px){.column[class*=small-]+.column[class*=small-]{margin-top:0}.row+.row{margin-top:50px}.row+.row-none{margin-top:0}.row+.row-tiny{margin-top:10px}.row+.row-little{margin-top:15px}.row+.row-small{margin-top:30px}.row+.row-normal{margin-top:50px}.row+.row-large{margin-top:100px}.small-12{width:95.83333333%}.small-11,.small-12{margin:0 2.08333333%}.small-11{width:87.5%}.small-10{width:79.16666667%}.small-9,.small-10{margin:0 2.08333333%}.small-9{width:70.83333333%}.small-8{width:62.5%}.small-7,.small-8{margin:0 2.08333333%}.small-7{width:54.16666667%}.small-6{width:45.83333333%}.small-5,.small-6{margin:0 2.08333333%}.small-5{width:37.5%}.small-4{width:29.16666667%}.small-3,.small-4{margin:0 2.08333333%}.small-3{width:20.83333333%}.small-2{width:12.5%}.small-1,.small-2{margin:0 2.08333333%}.small-1{width:4.16666667%}.small-offset-12{margin:0 0 0 102.08333333%}.small-offset-11{margin:0 0 0 93.75%}.small-offset-10{margin:0 0 0 85.41666667%}.small-offset-9{margin:0 0 0 77.08333333%}.small-offset-8{margin:0 0 0 68.75%}.small-offset-7{margin:0 0 0 60.41666667%}.small-offset-6{margin:0 0 0 52.08333333%}.small-offset-5{margin:0 0 0 43.75%}.small-offset-4{margin:0 0 0 35.41666667%}.small-offset-3{margin:0 0 0 27.08333333%}.small-offset-2{margin:0 0 0 18.75%}.small-offset-1{margin:0 0 0 10.41666667%}.small-offset-0{margin:0 0 0 2.08333333%}.small-centered{display:block;float:none;margin-left:auto;margin-right:auto}}@media only screen and (min-width:480px){.column[class*=medium-]+.column[class*=medium-],.column[class*=small-]+.column[class*=medium-]{margin-top:0}.medium-12{margin:0 2.08333333%;width:95.83333333%}.medium-11{margin:0 2.08333333%;width:87.5%}.medium-10{margin:0 2.08333333%;width:79.16666667%}.medium-9{width:70.83333333%}.medium-8,.medium-9{margin:0 2.08333333%}.medium-8{width:62.5%}.medium-7{width:54.16666667%}.medium-6,.medium-7{margin:0 2.08333333%}.medium-6{width:45.83333333%}.medium-5{width:37.5%}.medium-4,.medium-5{margin:0 2.08333333%}.medium-4{width:29.16666667%}.medium-3{width:20.83333333%}.medium-2,.medium-3{margin:0 2.08333333%}.medium-2{width:12.5%}.medium-1{margin:0 2.08333333%;width:4.16666667%}.medium-offset-12{margin:0 0 0 102.08333333%}.medium-offset-11{margin:0 0 0 93.75%}.medium-offset-10{margin:0 0 0 85.41666667%}.medium-offset-9{margin:0 0 0 77.08333333%}.medium-offset-8{margin:0 0 0 68.75%}.medium-offset-7{margin:0 0 0 60.41666667%}.medium-offset-6{margin:0 0 0 52.08333333%}.medium-offset-5{margin:0 0 0 43.75%}.medium-offset-4{margin:0 0 0 35.41666667%}.medium-offset-3{margin:0 0 0 27.08333333%}.medium-offset-2{margin:0 0 0 18.75%}.medium-offset-1{margin:0 0 0 10.41666667%}.medium-offset-0{margin:0 0 0 2.08333333%}.medium-centered{display:block;float:none;margin-left:auto;margin-right:auto}}@media only screen and (min-width:960px){.column+.column{margin-top:0}.row+.row-divided{margin-top:25px;padding-top:25px}.row.row-middled{left:50%;position:absolute;top:50%;-ms-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.column{margin:0 1.04166667%;width:97.91666667%}.column .row{margin-left:-3.125%;margin-right:-3.125%;width:102.08333333%}.small-12{width:97.91666667%}.small-11,.small-12{margin:0 1.04166667%}.small-11{width:89.58333333%}.small-10{width:81.25%}.small-9,.small-10{margin:0 1.04166667%}.small-9{width:72.91666667%}.small-8{width:64.58333333%}.small-7,.small-8{margin:0 1.04166667%}.small-7{width:56.25%}.small-6{width:47.91666667%}.small-5,.small-6{margin:0 1.04166667%}.small-5{width:39.58333333%}.small-4{width:31.25%}.small-3,.small-4{margin:0 1.04166667%}.small-3{width:22.91666667%}.small-2{width:14.58333333%}.small-1,.small-2{margin:0 1.04166667%}.small-1{width:6.25%}.medium-12{margin:0 1.04166667%;width:97.91666667%}.medium-11{margin:0 1.04166667%;width:89.58333333%}.medium-10{margin:0 1.04166667%;width:81.25%}.medium-9{width:72.91666667%}.medium-8,.medium-9{margin:0 1.04166667%}.medium-8{width:64.58333333%}.medium-7{width:56.25%}.medium-6,.medium-7{margin:0 1.04166667%}.medium-6{width:47.91666667%}.medium-5{width:39.58333333%}.medium-4,.medium-5{margin:0 1.04166667%}.medium-4{width:31.25%}.medium-3{width:22.91666667%}.medium-2,.medium-3{margin:0 1.04166667%}.medium-2{width:14.58333333%}.medium-1{width:6.25%}.large-12,.medium-1{margin:0 1.04166667%}.large-12{width:97.91666667%}.large-11{width:89.58333333%}.large-10,.large-11{margin:0 1.04166667%}.large-10{width:81.25%}.large-9{width:72.91666667%}.large-8,.large-9{margin:0 1.04166667%}.large-8{width:64.58333333%}.large-7{width:56.25%}.large-6,.large-7{margin:0 1.04166667%}.large-6{width:47.91666667%}.large-5{width:39.58333333%}.large-4,.large-5{margin:0 1.04166667%}.large-4{width:31.25%}.large-3{width:22.91666667%}.large-2,.large-3{margin:0 1.04166667%}.large-2{width:14.58333333%}.large-1{margin:0 1.04166667%;width:6.25%}.small-offset-12{margin:0 0 0 101.04166667%}.small-offset-11{margin:0 0 0 92.70833333%}.small-offset-10{margin:0 0 0 84.375%}.small-offset-9{margin:0 0 0 76.04166667%}.small-offset-8{margin:0 0 0 67.70833333%}.small-offset-7{margin:0 0 0 59.375%}.small-offset-6{margin:0 0 0 51.04166667%}.small-offset-5{margin:0 0 0 42.70833333%}.small-offset-4{margin:0 0 0 34.375%}.small-offset-3{margin:0 0 0 26.04166667%}.small-offset-2{margin:0 0 0 17.70833333%}.small-offset-1{margin:0 0 0 9.375%}.small-offset-0{margin:0 0 0 1.04166667%}.medium-offset-12{margin:0 0 0 101.04166667%}.medium-offset-11{margin:0 0 0 92.70833333%}.medium-offset-10{margin:0 0 0 84.375%}.medium-offset-9{margin:0 0 0 76.04166667%}.medium-offset-8{margin:0 0 0 67.70833333%}.medium-offset-7{margin:0 0 0 59.375%}.medium-offset-6{margin:0 0 0 51.04166667%}.medium-offset-5{margin:0 0 0 42.70833333%}.medium-offset-4{margin:0 0 0 34.375%}.medium-offset-3{margin:0 0 0 26.04166667%}.medium-offset-2{margin:0 0 0 17.70833333%}.medium-offset-1{margin:0 0 0 9.375%}.medium-offset-0{margin:0 0 0 1.04166667%}.large-offset-12{margin:0 0 0 101.04166667%}.large-offset-11{margin:0 0 0 92.70833333%}.large-offset-10{margin:0 0 0 84.375%}.large-offset-9{margin:0 0 0 76.04166667%}.large-offset-8{margin:0 0 0 67.70833333%}.large-offset-7{margin:0 0 0 59.375%}.large-offset-6{margin:0 0 0 51.04166667%}.large-offset-5{margin:0 0 0 42.70833333%}.large-offset-4{margin:0 0 0 34.375%}.large-offset-3{margin:0 0 0 26.04166667%}.large-offset-2{margin:0 0 0 17.70833333%}.large-offset-1{margin:0 0 0 9.375%}.large-offset-0{margin:0 0 0 1.04166667%}.large-centered,.medium-centered,.small-centered{display:block;float:none;margin-left:auto;margin-right:auto}}.toggled{display:none}.open .toggled{display:block}.subsection-manage .heading{width:100%;background-color:#e3e3e3;margin-bottom:32px}.subsection-manage .heading h1{white-space:nowrap;padding:49px 0}.subsection-manage .heading-buttons{padding:62px 0 0;float:right}.subsection-manage .heading-buttons a,.subsection-manage .heading-buttons button{padding:13px}.subsection-manage .heading-buttons a,.subsection-manage .heading-buttons button,.subsection-manage .heading-buttons input,.subsection-manage .heading-buttons select{min-width:150px;height:40px;margin:0 10px 0 0;font-size:14px;display:inline-block;background-color:#fff;color:#333;text-align:center;border:1px solid rgba(0,0,0,.2);outline:initial}.subsection-manage .heading-buttons a:hover,.subsection-manage .heading-buttons button:hover,.subsection-manage .heading-buttons input:hover,.subsection-manage .heading-buttons select:hover{cursor:pointer;outline:0;border:1px solid #4d4d4d}.subsection-manage .heading-buttons .btn[disabled],.subsection-manage .heading-buttons button.c-button[disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,0,0,.2);cursor:not-allowed}.subsection-manage .heading-buttons a:focus,.subsection-manage .heading-buttons button:focus,.subsection-manage .heading-buttons input:focus,.subsection-manage .heading-buttons select:focus{outline:0;border:1px solid #4d4d4d}@media only screen and (max-width:540px){.subsection-manage .heading-buttons{padding-top:0;padding-bottom:20px}}.context-activity-feed .activityfeed-timeheading{margin-top:4px;background-color:#f2f2f2;text-align:left;font-size:12px;color:rgba(0,0,0,.6);height:32px;padding:8px 12px}.context-activity-feed tr{height:104px}.context-activity-feed tr td:nth-child(2){padding-left:0}.context-activity-feed table tr:last-of-type{border-bottom:none}.context-activity-feed .activityfeed-item-imageholder{margin:16px 16px 0 0;height:72px;width:72px;float:left}.context-activity-feed .activityfeed-item-description{margin:18px 0 0 12px}.context-activity-feed .activityfeed-item-description p:first-child{padding:0;color:#333;line-height:20px;min-height:20px;max-height:40px;overflow:hidden}.context-activity-feed .activityfeed-item-description p:nth-child(2){padding:2px 0 0;color:#5e5e5e}.context-activity-feed .activityfeed-item-timesince{margin-top:34px;white-space:nowrap;color:#5e5e5e;text-align:right}.context-activity-feed .activityfeed-item-timesince span{text-align:right}.context-activity-feed .activityfeed-showmore{height:72px;text-align:center}.context-activity-feed .activityfeed-showmore a,.context-activity-feed .activityfeed-showmore spinner{display:block;margin-top:36px}.subsection-manage.context-manage-activityfeed .activityfeed-search form{height:40px;width:100%;max-width:100%;float:right;margin:0}.subsection-manage.context-manage-activityfeed .activityfeed-search form input,.subsection-manage.context-manage-activityfeed .activityfeed-search form input:active{border:1px solid rgba(0,0,0,.2)}.subsection-manage.context-manage-activityfeed .activityfeed-search form input[type=search] -moz-placeholder,.subsection-manage.context-manage-activityfeed .activityfeed-search form input[type=search]::-webkit-input-placeholder{color:#000;text-overflow:ellipsis!important}.subsection-manage.context-manage-activityfeed .activityfeed-search form input[type=search]:-ms-input-placeholder{color:#000;text-overflow:ellipsis!important}.subsection-manage.context-manage-activityfeed .heading{padding:40px}.subsection-manage.context-manage-activityfeed h1{padding:0;font-size:32px;line-height:100%}.context-zero-custom-apis .custom-api-text-inline p{display:inline;padding:0}.context-zero-custom-apis .zero-custom-api-image{height:150px}.section-manage-apis{height:100%;width:100%}.section-manage-apis .custom-apis-body{height:calc(100% - 60px);width:100%;overflow:auto}.section-manage-apis .content-header{display:none}@media (max-width:500px){.heading-container h1{display:none}.section-manage-apis .content-header{display:block}}.api-list-tbody td{height:72px}.api-list-tbody td.text-ellipse{width:70%}.api-list-tbody td .command-button{margin-top:6px;cursor:auto}.api-list-tbody .c-glyph i{font-size:x-large}.api-list-tbody .dropdown-content{right:-20px}.api-list-tbody .context-glyph-tile{display:-ms-flexbox;display:flex}.api-list-tbody .context-glyph-tile .ms-TooltipHost{display:inline-block}.api-list-tbody .context-glyph-tile button:disabled{color:grey;opacity:.5;background:transparent}.api-list-tbody .context-glyph-tile button{width:60px;height:60px;color:#000}.api-list-tbody .command-item{display:inline-block;margin-top:6px}.api-list-tbody .dropdown-content{min-width:192px}@media only screen and (max-width:960px){.api-list-tbody .context-glyph-tile button{width:30px;height:30px}}.disable-card-overlay{position:absolute;width:264px;height:264px;background-color:hsla(0,0%,100%,.75);z-index:1}.disable-card-overlay.selected{background-color:transparent}.approval-card{position:relative;background:#fff;width:264px;height:264px;border:2px solid transparent;-webkit-box-shadow:0 0 3px #000;box-shadow:0 0 3px #000;padding:10px 16px}.approval-card .card-selected,.approval-card:focus,.approval-card:hover{outline:0;-webkit-box-shadow:0 0 10px rgba(0,0,0,.2);box-shadow:0 0 10px rgba(0,0,0,.2);border-color:#06f}.approval-card p{padding:0}.approval-card .c-glyph:before{font-weight:700;color:#06f}.approval-card .avatar{width:34px;height:34px}.approval-card .avatars-list-item{display:inline-block;vertical-align:middle}.approval-card .avatars-list-item avatar{margin-right:6px}.approval-card .grey-circle-count{color:#000;background-color:#e3e3e3;border-radius:50%;width:34px;height:34px;text-align:center;vertical-align:middle;padding:6px 0}.approval-card .title{display:block;display:-webkit-box;-webkit-line-clamp:3;max-height:60px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal;height:60px;margin-top:4px;position:relative;font-weight:600;font-size:15px}.approval-card .due-date{display:inline-block;color:#767676}.approval-card .due-date .c-paragraph-3{padding-top:0;font-size:12px}.approval-card .due-date img{width:12px;height:12px}.approval-card .thumbnail-photos{margin-top:14px;vertical-align:middle}.approval-card .approver-names{font-size:12px;color:#767676;margin-top:2px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.approval-card .actions{position:absolute;bottom:12px;display:-ms-flexbox;display:flex;-ms-flex-align:baseline;align-items:baseline;font-weight:600;font-size:13px}.approval-card .actions .c-glyph:before{bottom:4px}.approval-card .actions .status-text{padding:2px 6px}.approval-card .actions .respond-icon{margin-right:10px;color:#06f;font-weight:600}.approval-card .action-button{max-width:100px;display:block;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.approval-card list-commands{display:inline-block}.approval-card list-commands .dropdown-block{top:3px}.approval-card list-commands .dropdown-block button:focus:after{outline:none!important}.approval-card list-commands button:active,.approval-card list-commands button:focus{outline:1px dashed #000}.approval-card list-commands .dropdown-content{right:unset;border:1px transparent;-webkit-box-shadow:0 0 3px #000;box-shadow:0 0 3px #000;white-space:nowrap}.approval-card list-commands .dropdown-item.c-glyph{font-size:13px;display:block}.approval-card list-commands .c-glyph:before{color:#000;vertical-align:middle}.approval-card .blue-circle{position:relative;width:20px;height:20px;padding:3px;border-radius:50%;background-color:#06f;top:4px}.approval-card button.c-action-trigger.c-glyph:before{margin-left:0;margin-right:4px}.approval-card button.c-action-trigger.c-glyph{min-width:0;margin:0;line-height:1}.approval-card .c-glyph[disabled]:before{color:rgba(0,0,0,.2)}.approval-card .c-action-trigger{color:#303030;font-size:13px;padding:0}.approval-center{background-color:#eaeaea;height:100%}.approval-center-content{height:calc(100% - 60px);overflow:auto}.first-day-approvals{background-color:#fff;padding:0;position:relative}.first-day-approvals .first-day-approvals-content{background-color:#eaeaea;padding-bottom:10px}.first-day-approvals .first-day-approvals-content .column{margin:0}.first-day-approvals .first-day-approvals-content .c-content{margin:30px 0}.first-day-approvals .first-day-approvals-content .c-heading-6{line-height:normal;font-size:24px;padding:0;text-align:left;font-weight:600}.first-day-approvals .first-day-approvals-content .c-paragraph-1{padding:8px 0}.first-day-approvals .first-day-approvals-content .img-column{display:none}@media only screen and (min-width:960px){.first-day-approvals .first-day-approvals-content .img-column{float:right;display:block}}.first-day-approvals .first-day-approvals-content a.f-video-button{background-color:#fff;color:#06f;border:1px solid #06f;-webkit-transition:background-color .2s ease-in-out,color .2s ease-in-out;-o-transition:background-color .2s ease-in-out,color .2s ease-in-out;transition:background-color .2s ease-in-out,color .2s ease-in-out;line-height:15px;display:inline-block;height:40px}.first-day-approvals .first-day-approvals-content a.f-video-button:hover{background-color:#06f;color:#fff;border-color:#06f}.first-day-approvals .first-day-approvals-content a.f-video-button:before{margin-right:8px}.first-day-approvals .first-day-approvals-content .create-approval-button{display:inline-block;height:40px;margin-right:10px}.list-section .card-list-item{display:inline-block;margin:10px}.list-section .list-container{padding-top:36px;position:relative}.list-section .list-container:focus{outline:none}.list-section .row{padding:0;max-width:284px}@media only screen and (min-width:480px){.list-section .row{max-width:568px}}@media only screen and (min-width:960px){.list-section .row{max-width:852px}}@media only screen and (min-width:1400px){.list-section .row{max-width:1136px}}.list-section .info-pane{width:650px}.list-section .info-pane.slide-in-pane{right:-650px}.list-section .info-pane.slide-in-pane.expanded{-webkit-transform:translateX(-650px);-ms-transform:translateX(-650px);transform:translateX(-650px)}.list-section .info-pane .pane-content{padding:0 40px 60px}.list-section .card-selected{outline:0;-webkit-box-shadow:0 0 10px rgba(0,0,0,.2);box-shadow:0 0 10px rgba(0,0,0,.2);border-color:#06f}.list-section .card-disabled{background-color:hsla(0,0%,100%,.75)}.list-section .black-circle{width:28px;height:28px;padding:6px;border-radius:50%;background-color:#303030}.list-section .confirmationIcon{font-size:21px;font-weight:700;position:relative;padding:.5em;margin:8px;border:2px solid;border-radius:50%}.list-section .response-message{margin:20px;text-align:center;vertical-align:middle}.list-section .response-message .message{font-size:15px;line-height:1.35em}.list-section .approval-content .approval-container{padding:16px 0}.list-section .approval-content .approval-container.details ul{list-style-type:disc;margin-left:25px}.list-section .approval-content .approval-container.details ol{list-style-type:decimal;margin-left:25px}.list-section .approval-content .approval-container.details p{padding:0;white-space:pre-wrap}.list-section .approval-content .approval-container.details table{width:100%}.list-section .approval-content .details{overflow:hidden}.list-section .approval-content .markdown-body h1,.list-section .approval-content .markdown-body h2,.list-section .approval-content .markdown-body h3,.list-section .approval-content .markdown-body h4,.list-section .approval-content .markdown-body h5,.list-section .approval-content .markdown-body h6,.list-section .approval-content .markdown-body p{padding:0;display:block;font-weight:700;line-height:normal}.list-section .approval-content .markdown-body h1{font-size:32px;margin:21.44px 0}.list-section .approval-content .markdown-body h2{font-size:24px;margin:19.92px 0}.list-section .approval-content .markdown-body h3{font-size:18.72px;margin:18.72px 0}.list-section .approval-content .markdown-body h4{font-size:16px;margin:21.28px 0}.list-section .approval-content .markdown-body h5{font-size:13.28px;margin:22.18px 0}.list-section .approval-content .markdown-body h6{font-size:10.72px;margin:24.98px 0}.list-section .approval-content .markdown-body p{font-size:14px;font-weight:400;margin:0}.list-section .approval-content .markdown-body table td{font-size:14px;line-height:normal;height:unset}.list-section .approval-content .markdown-body table tbody tr{height:unset}.list-section .approval-content .markdown-body th{text-align:unset}.list-section .approval-content .link{padding-right:20px;font-size:15px;font-weight:400;display:block;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.list-section .approval-content .advanced-options .advanced-options-toggle{display:inline-block;font-size:17px;font-weight:300;margin-bottom:12px}.list-section .approval-content .approveOrReject{padding-bottom:16px}.list-section .approval-content .customOptions{display:-ms-flexbox;display:flex}.list-section .approval-content .customOptions .fl-DefaultButton{margin:5px;min-width:100px;max-width:120px}.list-section .approval-content .confirmSection{margin-bottom:36px}.list-section .approval-content .avatars-list-item{margin-bottom:12px}.list-section .approval-content .grey-circle-count{color:#000;background-color:#e3e3e3;border-radius:50%;width:48px;height:48px;text-align:center;vertical-align:middle;padding:12px 0;font-size:17px;font-weight:300}.list-section .approval-content .c-glyph:before{font-size:18px;padding-right:8px}.list-section .approval-content textarea{min-width:100%;max-width:100%;height:90px}.list-section .approval-content textarea:focus{border-color:#06f}.list-section .approval-content .status{display:inline-block}.list-section .approval-content .status p{float:left}.list-section .approval-content .status list-commands{position:relative;float:right;bottom:12px}.list-section .approval-content .status list-commands .dropbtn:focus{outline:1px dashed #000}.list-section .approval-content .status .bold-label{font-weight:700}.list-section .approval-content .optional-label{color:#919191}.list-section .approval-content .c-label{margin-top:0}.list-section .approval-content .c-paragraph-1,.list-section .approval-content .c-paragraph-2,.list-section .approval-content .c-paragraph-3{padding:0}.list-section .confirmation-content{position:absolute;top:50%;left:50%;-webkit-transform:translateY(-50%) translateX(-50%);-ms-transform:translateY(-50%) translateX(-50%);transform:translateY(-50%) translateX(-50%)}.alert-container{max-width:1200px;min-height:72px;background-color:#eee;margin:auto;z-index:100}.alert-container .alert{display:block}.alert-container .c-glyph:before{position:relative;bottom:4px;font-size:20px}.alert-container .alert-content-container{position:relative;width:100%;display:inline-block;margin-left:auto}.alert-container .alert-content{vertical-align:middle;width:95%;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center}.alert-container .alert-image-container{display:inline;position:absolute;margin-left:20px;padding-right:12px;height:18px}.alert-container .c-progress{margin-top:0}.alert-container .c-progress.f-indeterminate-local.f-progress-small,.alert-container .c-progress.f-indeterminate-local.f-progress-small span{width:15px;height:15px}.alert-container .image-container-alert-has-title{margin-top:3px}.alert-container .alert-title{font-size:16px;font-weight:600;display:block;margin-left:50px}.alert-container .alert-message{font-size:13px;margin-left:50px;word-break:break-all}.alert-container .alert-close-button{float:right;margin-top:0;color:#0078d6}.alert-container .alert-close-container{float:right;margin-left:auto;padding:18px 0}@media only screen and (max-width:960px){.alert-container .alert .alert-image-container{margin-left:3px}.alert-container .alert .alert-message,.alert-container .alert .alert-title{margin-left:33px}.alert-container .alert .c-action-trigger.c-glyph{min-width:0;width:36px;float:right;overflow:hidden;display:block;margin:0 auto}}@media only screen and (min-width:480px){.sticky-error .alert-container{background-color:#fff}.alert-container .alert-content-container:before{content:" ";display:inline-block;height:72px;width:0;vertical-align:middle}.alert-container .alert-title{-ms-text-overflow:ellipsis;white-space:nowrap}.alert-container .alert-message,.alert-container .alert-title{overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.alert-container .alert-message{line-height:1.3em;display:block;display:-webkit-box;-webkit-line-clamp:2;max-height:2.6em;white-space:normal}.alert-container .small-screen-close-button-container{padding:24px 0}}@media only screen and (max-width:480px){.sticky-error .alert-container{padding-bottom:0}.alert-container{padding:10px 0;min-height:36px}.alert-container .alert{padding:0}.alert-container .alert .alert-image-container{margin-left:8px}.alert-container .alert .alert-message,.alert-container .alert .alert-title{margin-left:38px;line-height:1.3em;display:block;display:-webkit-box;-webkit-line-clamp:6;max-height:7.8em;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal}.alert-container .alert .alert-content-container{white-space:normal}.alert-container .alert .alert-close-container{padding:0}}img.avatar{width:100%;height:100%}img.avatar.img-circle{border-radius:50%}.back-button-container{cursor:pointer;float:left;padding:10px}.back-button-container button{background-color:transparent;background-repeat:no-repeat;border:none;outline:none}.back-button-container label{margin:0 0 0 4px;padding:0;display:inline-block;font-size:13px;font-weight:600}.back-button-container .c-glyph:before{position:relative;font-size:24px;color:#06f}.back-button-container button:focus{outline:1px dashed #000}.confirm-dialog-component .ng-modal-dialog-header-content .c-heading-3{padding:0}.confirm-dialog-component .ng-modal-dialog-body-content .c-paragraph-3{padding:6px 0}.confirm-dialog-component button.c-button[type=submit]{color:#fff;background-color:#06f}.confirm-dialog-component button.c-button[type=submit]:focus,.confirm-dialog-component button.c-button[type=submit]:hover{background-color:#005ce6;border-color:#000}.confirm-dialog-component button.c-button[type=submit]:active{background-color:#005ce6;border-color:transparent}.confirm-dialog-component button.c-button[type=submit][disabled]{color:#a6a6a6;background-color:#f4f4f4;border-color:transparent}.dialog-buttons{text-align:center}.dialog-buttons .button-container{float:right}.dialog-buttons .dialog-button{margin:0 0 0 15px;height:32px;font-size:14px;font-weight:400;font-weight:600;border:1px solid transparent;background-color:#f4f4f4}@media only screen and (max-width:480px){.dialog-buttons .dialog-button{max-width:100%}}.dialog-buttons .dialog-button:active,.dialog-buttons .dialog-button:focus{background-color:#f4f4f4}@media screen and (-ms-high-contrast:active){.dialog-buttons .dialog-button:active,.dialog-buttons .dialog-button:focus{border:2px solid windowText}}.dialog-buttons .dialog-button:hover{background-color:#eaeaea}.dialog-buttons .dialog-button[disabled]{background-color:#f4f4f4}.dialog-buttons .dialog-button[type=submit],.dialog-buttons .dialog-button[type=submit]:active,.dialog-buttons .dialog-button[type=submit]:focus{background-color:#06f}@media screen and (-ms-high-contrast:active){.dialog-buttons .dialog-button[type=submit]:active,.dialog-buttons .dialog-button[type=submit]:focus{border:2px solid windowText}}.dialog-buttons .dialog-button[type=submit]:hover{background-color:#0047b3}.dialog-buttons .dialog-button[type=submit][disabled]{background-color:#cce0ff}.dialog-buttons spinner{display:block;float:left;margin:5px auto;width:25px;height:25px}.dialog-buttons spinner .spinner-content{margin-top:0}@media only screen and (max-width:960px){.dialog-buttons .button-container,.dialog-buttons spinner{float:none}.dialog-buttons button{margin:auto 8px}}.dialog-buttons:after,.dialog-buttons:before{content:" ";display:table}.dialog-buttons:after{clear:both}.widget .dialog-buttons spinner{float:left}flow-permissions-list{display:block;position:relative}flow-permissions-list .permission-entry{margin-bottom:12px}flow-permissions-list .permission-entry .permission-photo{border-radius:50%;display:inline-block;position:relative;overflow:hidden;vertical-align:middle;width:40px;height:40px}flow-permissions-list .permission-entry .permission-photo img{height:40px;width:40px}flow-permissions-list .permission-entry .permission-photo .flow-icon{position:absolute;top:50%;left:50%;-webkit-transform:translateY(-50%) translateX(-50%);-ms-transform:translateY(-50%) translateX(-50%);transform:translateY(-50%) translateX(-50%);font-size:20px;color:#fff}flow-permissions-list .permission-entry .permission-info{display:inline-block;vertical-align:middle;padding-left:8px;width:calc(100% - 48px)}flow-permissions-list .permission-entry .permission-info .permission-primary-text{font-size:14px;color:#000;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}flow-permissions-list .permission-entry .permission-info .permission-primary-text .tenant-help{margin-left:5px;display:inline-block}flow-permissions-list .permission-entry .permission-info .permission-primary-text .tenant-help .flow-icon.help{font-size:8px;padding:2px}flow-permissions-list .permission-entry .permission-info .permission-secondary-text{font-size:12px;color:#595a5a;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}flow-permissions-list .more-link{display:inline-block;font-size:20px}flow-permissions-list .more-link a,flow-permissions-list .more-link a:active,flow-permissions-list .more-link a:hover{cursor:pointer;color:#000;font-size:12px}flow-permissions-list .circle{border-radius:50%}flow-permissions-list .absolute-center{position:absolute;top:50%;left:50%;-webkit-transform:translateY(-50%) translateX(-50%);-ms-transform:translateY(-50%) translateX(-50%);transform:translateY(-50%) translateX(-50%)}.full-page-error{background-color:#fff}.full-page-error .full-page-error-image-container{background:-webkit-gradient(linear,left top,left bottom,color-stop(93.2%,#e3e3e3),color-stop(6.8%,#fff));background:-webkit-linear-gradient(top,#e3e3e3 93.2%,#fff 0);background:-o-linear-gradient(top,#e3e3e3 93.2%,#fff 6.8%);background:linear-gradient(180deg,#e3e3e3 93.2%,#fff 0);text-align:center}.full-page-error .full-page-error-image-container img{max-height:420px}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.full-page-error .full-page-error-image-container img{height:100%}}.full-page-error .image-container-404{background:-webkit-gradient(linear,left top,left bottom,color-stop(84.2%,#e3e3e3),color-stop(15.8%,#fff));background:-webkit-linear-gradient(top,#e3e3e3 84.2%,#fff 0);background:-o-linear-gradient(top,#e3e3e3 84.2%,#fff 15.8%);background:linear-gradient(180deg,#e3e3e3 84.2%,#fff 0)}.full-page-error .image-container-404 img{max-height:none;width:100%}.full-page-error h2,.full-page-error p{text-align:center}.full-page-error .full-page-error-title-container{text-align:center;background-color:#e3e3e3}.full-page-error .full-page-error-title-container .full-page-error-title{padding:20px;display:inline-block}.full-page-error .full-page-error-title-container .full-page-error-widget-close-button{position:absolute;top:0;left:0;margin:15px 0}.full-page-error .full-page-error-message{text-align:center}.full-page-error .full-page-error-message a{display:inline-block;margin:0 10px}.full-page-error .full-page-error-details{margin-top:30px;padding-bottom:24px;background-color:#e3e3e3;width:100%;max-width:100%;position:relative;word-break:break-all;word-break:break-word;word-wrap:break-word}.full-page-error .full-page-error-details p{font-weight:400;margin:20px;padding-top:48px}.full-page-error .full-page-error-details .c-action-trigger.c-glyph{min-width:0}.full-page-error .full-page-error-details .error-info-container{text-align:center}.full-page-error .full-page-error-details .error-info-container .error-info{display:block}.full-page-error .full-page-error-details .error-detail-close-button{position:absolute;right:20px;top:0}@media only screen and (max-width:540px){.full-page-error .full-page-error-details .error-detail-close-button{right:0;padding-right:0}}.full-page-error .full-page-error-button-container{width:100%;padding:40px 0;text-align:center}.full-page-error .full-page-error-button-container a.c-button[role=button]{background-color:#06f;color:#fff;margin:auto;min-width:175px;text-align:center;outline:none;cursor:pointer}.full-page-error .full-page-error-button-container a.c-button[role=button]:before{font-size:24px}.full-page-error .full-page-error-button-container a.c-button[role=button]:hover{color:#fff}.full-page-error .full-page-error-button-container a.c-button[role=button]+a.c-button[role=button]{margin-left:30px}@media only screen and (max-width:540px){.full-page-error .full-page-error-button-container a.c-button[role=button]+a.c-button[role=button]{display:block;text-align:center;margin:10px auto}}.heading-container{width:100%;height:60px;border-bottom:1px solid #c8c8c8;font-size:15px;font-weight:400;position:absolute;z-index:101;background-color:#f4f4f4}.heading-container .heading-content{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:100%}.heading-container .heading-content-left{-ms-flex-positive:1;flex-grow:1;overflow:hidden}.heading-container .heading-content-right{-ms-flex-negative:0;flex-shrink:0}.heading-container .back-button-container{padding:0}.heading-container .back-button-container button{padding:17px 10px 15px;margin-top:4px;margin-right:10px;margin-left:-10px}.heading-container .back-button-container button:before{font-size:15px}.heading-container .back-button-container img{width:16px;height:17px}.heading-container h1{font-size:inherit;font-weight:inherit;padding:20px 0;line-height:normal;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.heading-container .header-divider{border-right:1px solid #c8c8c8;height:40px;display:inline-block;vertical-align:middle;margin:0 10px}@media only screen and (max-width:480px){.heading-container .header-divider{display:none}}.heading-container .command-item{display:inline-block;vertical-align:middle}.heading-container .command-item .dropdown-block{margin-top:0}.heading-container .command-item .dropdown-block:hover,.heading-container .command-item .dropdown-item:hover{color:#06f}.heading-container .command-item .dropbtn{font-size:14px;padding:10px 6px 10px 8px}.heading-container .command-item .dropbtn:active,.heading-container .command-item .dropbtn:focus,.heading-container .command-item .dropbtn:hover{background-color:#f2f2f2;color:#06f}@media only screen and (max-width:480px){.heading-container .command-item .dropbtn{padding-left:4px;padding-right:4px}}.heading-container .command-item .dropbtn span{vertical-align:middle;display:inline-block}.heading-container .command-item .dropbtn .c-glyph:before{height:18px;overflow:hidden;padding-top:3px}@media only screen and (max-width:768px){.heading-container .command-item span.toggle-button-text{display:none}}.heading-container .command-item .dropdown-content{padding:10px}.heading-container .command-item .dropdown-content li{font-size:14px}.heading-container .heading-contextual-menu .fl-DefaultButton{background-color:transparent;height:20px;padding:10px 5px;border:none}.heading-container .heading-contextual-menu .ms-Button-label{font-weight:400}.heading-container .heading-button{font-size:inherit;font-weight:inherit;background-color:transparent;padding:10px 5px;border:0;min-width:10px;margin-right:0;cursor:pointer;display:inline-block;vertical-align:middle}@media only screen and (min-width:960px){.heading-container .heading-button{padding:10px 6px 10px 8px;margin-right:9px}}.heading-container .heading-button:hover{border:0;color:#06f}.heading-container .heading-button:active{background-color:transparent}.heading-container .heading-button:last-child{margin-right:0}.heading-container .heading-button .c-glyph{color:#06f;display:inline-block;font-size:15px}@media only screen and (min-width:768px){.heading-container .heading-button .c-glyph{padding-right:5px}}.heading-container .heading-button .c-glyph img{width:18px;height:18px}.heading-container .heading-button .heading-button-label,.heading-container .heading-button .heading-link-label{display:none;vertical-align:top}@media only screen and (min-width:960px){.heading-container .heading-button .heading-button-label,.heading-container .heading-button .heading-link-label{display:inline-block}}.heading-container select{min-width:0;width:20px;height:30px;margin:5px 0;border:1px solid #c8c8c8}@media only screen and (min-width:768px){.heading-container select{min-width:150px;width:150px}}.heading-container .column-right{position:absolute;right:0}.heading-container .heading-right{font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}.heading-container .heading-tabs a{margin:0 10px;display:inline-block;padding:20px 0;font-weight:600}@media only screen and (min-width:768px){.heading-container .heading-tabs a{margin:0 20px}}.heading-container .heading-tabs a.tab-active{color:#06f;padding-bottom:17px;border-bottom:3px solid #06f}.heading-container .heading-tabs a.tab-active:focus{outline:none}.heading-container spinner{display:inline-block;vertical-align:middle}.heading-container react-toggle{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.heading-spacer{height:60px}.infoPane-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.7);z-index:996}.info-pane{position:fixed;background-color:#fff;top:48px;width:500px;padding-top:20px;max-width:100%;right:0;-webkit-transition:-webkit-transform .25s;transition:-webkit-transform .25s;-o-transition:transform .25s;transition:transform .25s;transition:transform .25s,-webkit-transform .25s;z-index:997}.info-pane.expanded{-webkit-box-shadow:-3px 0 3px 0 rgba(0,0,0,.2);box-shadow:-3px 0 3px 0 rgba(0,0,0,.2)}.info-pane.slide-in-pane{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);right:-500px}.info-pane.slide-in-pane.expanded{-webkit-transform:translateX(-500px);-ms-transform:translateX(-500px);transform:translateX(-500px)}.info-pane.static-pane{display:none;top:108px}.info-pane.static-pane.expanded{display:block}.widget .info-pane{top:0}.info-pane header{height:60px;position:relative;max-width:100%;*zoom:1}.info-pane header:after,.info-pane header:before{display:table;content:"";line-height:0}.info-pane header:after{clear:both}.info-pane header button.c-action-trigger.c-glyph{min-width:0;color:#000;margin-top:0;padding:0}.info-pane header button.glyph-arrowback{float:left}.info-pane header button.glyph-close{float:right}.info-pane header h1{color:#000;margin:0;font-size:20px;padding:0 0 0 20px;line-height:26px;display:-webkit-box;-webkit-line-clamp:2;max-height:52px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal;display:block}.info-pane header p{color:#666;font-size:17px;margin:0;padding:0 0 0 20px;display:block}.info-pane header .svg-container{width:20px}.info-pane .pane-content{padding:10px 20px;height:calc(100vh - 108px);max-width:100%;overflow-y:auto}.info-pane .pane-content a{color:#06f}.widget .info-pane .pane-content{height:calc(100vh - 60px)}.info-pane .pane-section{margin-bottom:40px}.info-pane .pane-heading{font-size:13px;font-weight:600;margin:0 0 5px;padding:0;line-height:normal;letter-spacing:normal}.info-pane .pane-subheading{font-size:13px;padding:0;color:#5e5e5e}.info-pane .pane-alert{color:#ea433b;padding:0;font-weight:500;font-size:13px}.info-pane .info-pane-content{display:none}.info-pane.expanded .info-pane-content{display:block}.info-pane .info-pane-transclude-content{margin-bottom:16px}@media only screen and (min-device-width:320px) and (max-device-height:480px) and (-webkit-device-pixel-ratio:1){.info-pane .info-pane-transclude-content{margin-bottom:32px}}@media only screen and (min-device-width:320px) and (max-device-height:480px) and (-webkit-device-pixel-ratio:2){.info-pane .info-pane-transclude-content{margin-bottom:32px}}@media only screen and (min-device-width:320px) and (max-device-height:568px) and (-webkit-device-pixel-ratio:2){.info-pane .info-pane-transclude-content{margin-bottom:32px}}@media only screen and (min-device-width:375px) and (max-device-height:667px) and (-webkit-device-pixel-ratio:2){.info-pane .info-pane-transclude-content{margin-bottom:32px}}@media only screen and (min-device-width:414px) and (max-device-height:736px) and (-webkit-device-pixel-ratio:3){.info-pane .info-pane-transclude-content{margin-bottom:32px}}@media only screen and (min-device-width:414px) and (max-device-height:896px) and (-webkit-device-pixel-ratio:2){.info-pane .info-pane-transclude-content{margin-bottom:64px}}@media only screen and (min-device-width:375px) and (max-device-height:812px) and (-webkit-device-pixel-ratio:3){.info-pane .info-pane-transclude-content{margin-bottom:64px}}@media only screen and (min-device-width:414px) and (max-device-height:896px) and (-webkit-device-pixel-ratio:3){.info-pane .info-pane-transclude-content{margin-bottom:64px}}.learn-more-component{display:inline-block}.learn-more-component a{color:#005be5}.learn-more-component a:focus-visible,.learn-more-component a:hover{outline:none;text-decoration:underline;color:#00388c!important}.ng-modal{z-index:999;position:fixed;top:0;left:0;width:100%;height:100%}.ng-modal .ng-modal-overlay{width:100%;height:100%;background-color:rgba(0,0,0,.7)}.ng-modal .ng-modal-dialog{z-index:1000;position:absolute;max-width:700px;min-width:320px;width:50%;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background-color:#fff;border:1px solid #06f;word-wrap:break-word}.ng-modal .ng-modal-dialog .ng-modal-dialog-content{font-size:13px;text-align:left}.ng-modal .ng-modal-dialog .ng-modal-dialog-content .ng-modal-dialog-header-content{padding:20px 20px 0;font-size:21px}.ng-modal .ng-modal-dialog .ng-modal-dialog-content .ng-modal-dialog-body-content{max-height:60vh;overflow:auto;padding:0 20px;margin:12px 0}.ng-modal .ng-modal-dialog .ng-modal-dialog-content .ng-modal-dialog-footer-content{padding:0 20px 20px}.context-option-items div:first-child button{border-right:0 solid rgba(0,0,0,.2)}.context-option-items div:first-child button:hover{border-right:1px solid #4d4d4d}.context-option-items div:last-child button{border-left:0 solid rgba(0,0,0,.2)}.context-option-items div:last-child button:hover{border-left:1px solid #4d4d4d}.context-option-items .option-item button{float:left;-o-text-overflow:ellipsis;text-overflow:ellipsis;padding:6px 10px;height:40px;margin:0;font-size:14px;display:inline-block;background-color:#fff;color:#333;text-align:center;border:1px solid rgba(0,0,0,.2);outline:initial}@media only screen and (max-width:480px){.context-option-items .option-item button{width:100%!important}}.context-option-items .option-item button:hover{cursor:pointer;outline:0;border:1px solid #4d4d4d}.context-option-items .option-item button:focus{outline:1px solid #4d4d4d}.context-option-items .option-item button[aria-pressed=true]{background-color:#4d4d4d;color:#fff;-webkit-box-shadow:none;box-shadow:none;border:3px solid #fff}.spinner-global{left:0;top:0;position:absolute;height:100%;width:100%;background-color:#fff;z-index:999}.spinner-global .spinner-content,.spinner .spinner-content{position:absolute;top:50%;left:50%;-webkit-transform:translateY(-50%) translateX(-50%);-ms-transform:translateY(-50%) translateX(-50%);transform:translateY(-50%) translateX(-50%)}.spinner-local-horizontal .spinner-content{position:relative;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%)}.dropbtn{font-size:16px;border:none;cursor:auto;background-color:transparent}.dropbtn button{color:#000}.dropbtn button:active,.dropbtn button:focus{outline:1px solid grey;outline-offset:-2px;color:#000!important}.dropbtn-text{font-size:16px;border:none;cursor:pointer;background-color:transparent;height:84px;vertical-align:middle}.dropbtn-text.disabled{color:grey;cursor:auto}.dropbtn-text:hover:enabled{background-color:#d3d3d3}.dropdown-block{position:relative}.dropdown-block .toggle-button-text{margin-left:5px;margin-right:5px;display:inline-block}@media only screen and (max-width:480px){.dropdown-block .toggle-button-text{display:none}}.dropdown-block-wide{position:relative}.dropdown-block-wide .c-glyph{font-size:small}.dropdown-content{display:block;position:absolute;background-color:#fff;min-width:130px;border:1px solid grey;z-index:2;right:0;text-align:left}.dropdown-content li{overflow:visible}.dropdown-content li.large-command-panel{padding:8px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;position:relative;min-height:80px}.dropdown-content li span.large-command-panel{font-size:small;display:block;display:-webkit-box;-webkit-line-clamp:6;max-height:186px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal}.dropdown-content .child-dropdown-toggle{padding-right:20px}.dropdown-content .child-dropdown-toggle:after{font-family:MWF-MDL2;font-size:12px;content:"\\E70D";color:#000;position:absolute;right:5px;top:50%;-webkit-transition:-webkit-transform .3s;transition:-webkit-transform .3s;-o-transition:transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s;-webkit-transform:translateY(-50%) rotate(-90deg);-ms-transform:translateY(-50%) rotate(-90deg);transform:translateY(-50%) rotate(-90deg)}@media only screen and (max-width:480px){.dropdown-content .child-dropdown-toggle.toggled:after{-webkit-transform:translateY(-50%) rotate(0);-ms-transform:translateY(-50%) rotate(0);transform:translateY(-50%) rotate(0)}}.dropdown-content .dropdown-content{position:absolute;display:block;top:15px;right:80%}@media only screen and (max-width:480px){.dropdown-content .dropdown-content{position:static;border:none}}.dropdown-content .command-text{padding-left:10px;-ms-flex-positive:1;flex-grow:1}.dropdown-content .command-container{position:relative}.dropdown-content .command-container[disabled]:focus{outline:none}@media only screen and (max-width:480px){.dropdown-content .hover-menu{display:none}}@media only screen and (min-width:480px){.dropdown-content .click-menu{display:none}}.dropdown-content .dropdown-item{color:#000;padding:8px;text-decoration:none;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:44px;white-space:nowrap;position:relative}.dropdown-content .dropdown-item:hover{background-color:#f1f1f1;cursor:pointer}.dropdown-content .dropdown-item:focus{outline:1px dashed #000}.dropdown-content .dropdown-item.img-button{width:inherit;height:inherit;margin-top:0}.dropdown-content .dropdown-item.img-button .x-screen-reader{display:block}.dropdown-content .dropdown-item.c-glyph{font-size:medium;padding:8px}.dropdown-content .dropdown-item.c-glyph img{height:1em;width:1em}.dropdown-content .dropdown-item[disabled]{background-color:transparent;color:grey;outline:none}.dropdown-content .dropdown-item[disabled]:hover{color:grey;cursor:default}.dropdown-content.wide{min-width:200px}.c-carousel.f-single-slide .dropdown-content{display:block}.flow-runs .c-glyph{font-size:x-large;float:right;padding-right:20px}.flow-runs .status-image{margin-left:5px;margin-right:5px;vertical-align:middle}.flow-runs table.tile-row .c-glyph{font-size:x-small}.flow-runs table.tile-row tr{height:36px;border:none}.flow-runs table.tile-row td{height:36px;font-size:13px}.flow-runs table.tile-row .img-button{width:16px;height:16px;margin-top:0}.flow-runs .zero-run-text{padding:10px 0 10px 8px}.flow-runs .learn-more-button{border:none;cursor:pointer;float:none;color:#06f}.flow-runs .info-pane header{background-color:#fff}\n/*!\n * Copyright (C) Microsoft Corporation. All rights reserved.\n */\n/*!\n * Copyright (C) Microsoft Corporation. All rights reserved.\n */.flow-creation-widget,.invoke-flow-widget-v2{position:absolute;width:100%;height:100%}.property-tile{display:block;background-color:#fff;min-height:120px;margin:24px 0 0;padding:18px 24px;overflow:hidden;border:1px solid transparent}.property-tile-reset{padding:0;margin:0;overflow:initial;border:0;min-height:0}.property-tile .tile-title{font-weight:600;text-transform:uppercase;font-size:12px;white-space:nowrap;display:inline-block;margin:0;padding:0 0 10px;line-height:normal}.property-tile .tile-see-all{float:right;background-color:transparent;border:none;font-size:12px;padding-right:0}.property-tile .tile-see-all .c-glyph{vertical-align:middle;padding-left:5px}.property-tile .info-card-item{margin:10px 0}.property-tile .info-card-item .info-card-icon{margin:0;padding:0}.property-tile .info-card-item .info-card-icon img{background-color:grey;width:50px;height:50px}.property-tile .info-card-item .info-card-icon img.img-circle{border-radius:50%}.property-tile .info-card-item .info-card-text-section{margin:0;padding:5px 10px}.property-tile .add-owner-title{font-weight:100;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;display:inline-block;padding:10px 0}.property-tile .add-owner-title:hover{cursor:pointer;color:#06f}.property-tile .add-owner-icon svg{height:50px;width:50px}.property-tile .add-owner-icon svg:hover{cursor:pointer}.property-tile .add-owner-icon svg:hover .a{fill:#c8c8c8}.section-flow-submit-template .alert-content{width:70%}.section-flow-submit-template a.c-action-trigger.alert-close-button{min-width:0}.section-flow-submit-template .c-text-field[type=text]{width:100%}.section-flow-submit-template .c-input{padding:7px 10px;width:100%}.section-flow-submit-template .c-textarea textarea{height:76px}.section-flow-submit-template input[type=text]::-webkit-input-placeholder,.section-flow-submit-template textarea::-webkit-input-placeholder{color:#a6a6a6}.section-flow-submit-template input[type=text]::-moz-placeholder,.section-flow-submit-template textarea::-moz-placeholder{color:#a6a6a6}.section-flow-submit-template input[type=text]::-ms-input-placeholder,.section-flow-submit-template textarea::-ms-input-placeholder{color:#a6a6a6}.section-flow-submit-template input[type=text]::placeholder,.section-flow-submit-template textarea::placeholder{color:#a6a6a6}.section-flow-submit-template .publish-validation{height:0}.section-flow-submit-template p.publish-error{color:#ef3a24;font-size:13px;text-align:left;padding-top:0;padding-bottom:10px}.section-flow-submit-template .submit-template-categories{float:left;width:48%;margin:0 1%}.section-flow-submit-template .submit-template-disclaimer{font-size:11px}.section-flow-submit-template .submit-template-actions{border-top:1px solid #c8c8c8;display:inline-block;margin-top:30px;padding:10px 0;text-align:right;width:100%}.section-flow-submit-template .submit-template-actions button{margin:14px 0 14px 14px}.section-flow-submit-template .property-tile{border:1px solid #d3d3d3}.section-flow-submit-template .success-response{margin:20px;text-align:center;vertical-align:middle}.section-flow-submit-template .green-circle-border{font-size:45px;font-weight:700}.section-flow-submit-template .green-circle-border.c-glyph:before{position:relative;padding:.5em;margin:8px;color:#3bb44a;border:2px solid;border-radius:50%}.section-flow-submit-template .yellow-warning{font-size:45px;font-weight:700}.section-flow-submit-template .yellow-warning.c-glyph:before{color:#efa607}.section-flow-submit-template .template-submission-required:after{content:"*";color:red;padding-left:2px}.section-flow-submit-template .template-categories-container:after,.section-flow-submit-template .template-categories-container:before{content:" ";display:table}.section-flow-submit-template .template-categories-container:after{clear:both}.context-manage-zeroactivities img{padding-top:50px;text-align:center;width:100%}.context-manage-zeroactivities h2,.context-manage-zeroactivities p{text-align:center}.context-manage-zeroactivities h2{padding:0}.context-manage-zeroactivities button{width:100%}.context-manage-zeroflowruns img{padding-top:50px;width:100%}.context-manage-zeroflowruns h2,.context-manage-zeroflowruns p{text-align:center}.zero-flow-runs-pane-content .title{color:#000;font-weight:500;text-transform:uppercase}.zero-flow-runs-pane-content .trigger-label{font-weight:400;font-size:15px;color:#919191;padding-top:20px;padding-bottom:4px}.zero-flow-runs-pane-content .trigger-details-label{text-transform:uppercase}.zero-flow-runs-pane-content .trigger-description{font-weight:400;color:#000;padding-top:0}.zero-flow-runs-pane-content .info-card-item{vertical-align:middle}.zero-flow-runs-pane-content .info-card-item .info-card-icon{margin:0;padding:10px 10px 10px 0}.zero-flow-runs-pane-content .info-card-item .info-card-text-section{margin:0;padding-left:4px;overflow:visible}.zero-flow-runs-pane-content .info-card-item .info-card-text-section .info-card-title{font-weight:400;text-transform:capitalize}.zero-flow-runs-pane-content .info-card-item .info-card-text-section .info-card-subtitle{font-weight:400;overflow:visible;-o-text-overflow:ellipsis;text-overflow:ellipsis}.codeSwaggerEditorTab .title{font-size:21px;font-weight:400;margin-bottom:12px}.codeSwaggerEditorTab .codeSwaggerEditorTab-section{margin:32px 0 0}.codeSwaggerEditorTab .codeSwaggerEditorTab-scrollbox{overflow-y:auto;height:100%;position:relative;visibility:hidden}.codeSwaggerEditorTab .codeSwaggerEditorTab-scrollbox-content{visibility:visible;margin-top:32px}.codeSwaggerEditorTab .codeSwaggerEditorTab-description{padding:0}.codeSwaggerEditorTab react-toggle{padding-top:5px}.codeSwaggerEditorTab .icon-upload-label{outline:transparent;position:relative;font-family:Segoe UI,"Segoe UI Web (West European)",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid #06f;display:inline-block;text-decoration:none;text-align:center;cursor:pointer;padding:10px 16px;border-radius:2px;min-width:80px;background-color:#06f;color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-top:10px;margin-bottom:10px}.codeSwaggerEditorTab .icon-upload-label:focus:after{content:"";position:absolute;inset:2px;border:1px solid transparent;outline:1px solid #605e5c;z-index:1}.customApiAction fieldset{border:0;padding:0}.customApiAction fieldset .c-label{font-size:12px;position:relative;float:left}.customApiAction hr{margin:20px 0 8px}.customApiAction .customApiAction-section{margin:0}.customApiAction .customApiAction-section .import-heading{padding-right:24px;float:right}.customApiAction .customApiAction-section .minimal-content{height:20px}.customApiAction .customApiAction-section .c-glyph:before{position:relative;font-size:12px;margin-right:3px}.customApiAction .customApiAction-section .pane-buttons{padding-top:16px}.customApiAction .customApiAction-section .response-item{margin-top:12px}.customApiAction .customApiAction-section .response-item img{float:right}.customApiAction .customApiAction-section .response-item:hover{border:1px solid;padding:15px 23px 23px}.customApiAction .customApiAction-section .status-code{background-color:#666;border-radius:12px;color:#fff;display:inline-block;font-size:16px;margin-right:8px;max-width:72px;overflow:hidden;padding:2px 8px 4px;text-align:center;-o-text-overflow:ellipsis;text-overflow:ellipsis;vertical-align:middle}.customApiAction .customApiAction-pane{margin-top:12px}.customApiAction .customApiAction-section-buttons{margin-top:8px}.customApiAction .customApiAction-pane-field-value{font-weight:600;display:inline-block;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.custom-api-definition .reference-link,.customApiResponse .reference-link{cursor:pointer}.customApiTabNavigation{margin-top:12px;margin-bottom:12px;pointer-events:all}.customApiTabNavigation .customApiTabNavigation-navigationButton--previous{float:left}.customApiTabNavigation .customApiTabNavigation-navigationButton--next{float:right}.customApiTrigger fieldset{border:0;padding:0}.customApiTrigger hr{margin:20px 0 8px}.customApiTrigger .customApiTrigger-section{margin:0}.customApiTrigger .customApiTrigger-section .response-item{margin-top:12px}.customApiTrigger .customApiTrigger-section .response-item img{float:right}.customApiTrigger .customApiTrigger-section .response-item:hover{border:1px solid;padding:15px 23px 23px}.customApiTrigger .customApiTrigger-section .status-code{background-color:grey;border-radius:12px;color:#fff;display:inline-block;font-size:16px;margin-right:8px;max-width:72px;overflow:hidden;padding:2px 8px 4px;text-align:center;-o-text-overflow:ellipsis;text-overflow:ellipsis;vertical-align:middle}.customApiTrigger .customApiTrigger-pane{margin-top:12px}.customApiTrigger .customApiTrigger-section-buttons{margin-top:8px}.customApiTrigger .customApiTrigger-pane-field-value{font-weight:600;display:inline-block;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.customConnectorDialog .customConnectorDialog-messageBarWrapper{margin-top:8px}.customConnectorDialog .pane-content{padding:4px 0 0}.customConnectorDialog .pane-content input{margin:1px}.customConnectorDialog .header-icon-container{display:inline}.customConnectorDialog .header-icon{float:right;width:57px;height:57px}.customConnectorDialog .header-container{display:grid}.customConnectorDialog .header-text{padding:0;font-size:13px}.customConnectorDialog .header-github-link{color:#00f;text-decoration:underline}.customConnectorDialog div.ng-modal-dialog{width:40%}.customConnectorDialog .customConnectorDialog-container{margin-top:0;max-width:100%}.customConnectorDialog .customConnectorDialog-dropDown{margin:1px;max-width:100%}.customConnectorDialog select:disabled{background-color:rgba(0,0,0,.05)}.customConnectorDialog div label.ms-Label{font-size:14px;font-weight:600}.customConnectorDialog h1.title{padding:0;font-size:21px;font-weight:400;line-height:20px}.customConnectorDialog select option{font-size:15px}.customApiDefinitionTab{height:100%}.customApiDefinitionTab .customApiDefinitionTab-scrollbox{overflow-y:auto;visibility:hidden;height:100%;position:relative}.customApiDefinitionTab .customApiDefinitionTab-scrollbox:hover{visibility:visible}.customApiDefinitionTab .customApiDefinitionTab-scrollbox-content{visibility:visible;margin-top:32px}.customApiDefinitionTab .customApiDefinitionTab-scrollbox-content--preRendered{min-height:10000px}.customApiDefinitionTab .customApiDefinitionTab-scrollbox-content--rendered{min-height:auto}.customApiDefinitionTab .customApiDefinitionTab-content-divider{margin-top:20px;margin-bottom:20px}.section-custom-api-details-tab{padding-top:32px}.section-custom-api-details-tab h2{padding:0;font-size:20px;line-height:1;font-weight:500;margin-bottom:8px}.section-custom-api-details-tab .row.top-align{padding-left:0;margin-left:0}.section-custom-api-details-tab .form-row{padding:16px}.section-custom-api-details-tab .form-row--first{padding-top:0}.section-custom-api-details-tab .details-description{word-wrap:break-word}.context-folding-list div.title{margin-bottom:12px}.context-folding-list div.title span{display:inline-block;vertical-align:middle}.context-folding-list div.title .folding-list-collapse{position:relative;top:4px;font-size:12px;font-weight:700;margin-right:4px}.context-folding-list div.title .title{font-size:21px;font-weight:400}.context-folding-list .description{padding-left:20px}.context-folding-list a.c-hyperlink{margin-bottom:12px}.context-folding-list .c-hyperlink{padding-left:20px}.context-folding-list .list-item{color:#06f;font-size:15px;margin:8px 0;cursor:pointer;padding-left:20px}.context-folding-list .list-item a{cursor:pointer}.context-folding-list .list-item a.selected{font-weight:700}.context-folding-list .list-item a.selected .item-text{color:#005be5}.context-folding-list .list-item a.selected .index{color:#fff;background:#06f;border-color:#06f}.context-folding-list .list-item .index{display:inline-block;text-align:center;vertical-align:middle;padding:2px 8px 4px;border-radius:50%;border:1px solid grey;margin-right:4px;font-size:13px;color:#fff;background:#666}.context-folding-list .list-item .index.add-new{background:none;color:#06f;border-color:#06f;padding:4px 12px 2px 6px;margin-left:32px}.context-folding-list .list-item .index.add-new:before{width:7px}.context-folding-list .list-item .add-new-text{color:#000;font-weight:700}.context-folding-list .list-item .add-new-text,.context-folding-list .list-item .item-text{display:inline-block;vertical-align:middle;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;width:calc(100% - 84px)}.context-folding-list .list-item .item-text{white-space:nowrap;color:#666}.context-folding-list .list-item .item-text.commands{width:calc(100% - 106px)}.context-folding-list .list-item .item-status{display:inline-block;height:24px;width:24px;margin:auto 4px auto auto}.context-folding-list .list-item .dropdown-block{display:inline-block}.context-folding-list .list-item img[ng-src=""]{opacity:0}.context-folding-list .list-item .command-item{float:right;padding-right:4px}.generalSwaggerEditorTab{padding-top:32px}.generalSwaggerEditorTab fieldset{border:0;padding:0 0 4px}.generalSwaggerEditorTab fieldset .c-label{font-size:12px;position:relative;float:left;margin-top:4px}.generalSwaggerEditorTab .title{font-size:21px;font-weight:400;margin-bottom:12px}.generalSwaggerEditorTab .generalSwaggerEditorTab-section--bottom{margin-bottom:0}.generalSwaggerEditorTab .generalSwaggerEditorTab-input--resizable{resize:vertical}.generalSwaggerEditorTab .generalSwaggerEditorTab-section-divider{margin-top:32px;margin-bottom:32px}.icon-section{margin-bottom:24px}.icon-section .icon-holder{display:inline-block}.icon-section .icon-holder .icon-holder-button{display:block;min-width:0;border:0;padding:0;margin:0}.icon-section .icon-holder .icon-holder-image{background-color:rgba(0,0,0,.2);background-size:100% 100%;background-repeat:no-repeat;margin:auto;height:100px;min-width:100px;padding:0}.icon-section .icon-holder .icon-holder-label{margin:0;border:0;text-align:center;font-size:14px;padding:2px 4px}.icon-section .icon-description{padding-left:20px;display:inline-block}.icon-section .icon-description a{cursor:pointer}.icon-section .icon-description label{margin:0;padding:0}.copilotSwaggerEditorTab{padding-top:32px}.copilotSwaggerEditorTab fieldset{border:0;padding:0 0 4px}.copilotSwaggerEditorTab fieldset .c-label{font-size:12px;position:relative;float:left;margin-top:4px}.copilotSwaggerEditorTab .title{font-size:21px;font-weight:400;margin-bottom:12px}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-section--bottom{margin-bottom:0}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-input--resizable{resize:vertical}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-section-divider{margin-top:32px;margin-bottom:32px}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-scrollbox{overflow-y:auto;visibility:hidden;height:100%;position:relative}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-scrollbox:hover{visibility:visible}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-scrollbox-content{visibility:visible;margin-top:32px}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-scrollbox-content--preRendered{min-height:10000px}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-scrollbox-content--rendered{min-height:auto}.copilotSwaggerEditorTab .copilotSwaggerEditorTab-content-divider{margin-top:20px;margin-bottom:20px}.importFromSamplePanel .importFromSamplePanel-textArea--multiline textarea{font-family:Consolas,monaco,monospace;font-size:13px}.importFromSamplePanel .importFromSamplePanelCtrl-buttons{margin-top:24px;padding-bottom:24px}.importFromSamplePanel .importFromSamplePanelCtrl-button{margin-right:8px}.section-custom-api-import .importSection-choiceGroup .ms-ChoiceField{display:inline-block;padding-right:16px}.section-custom-api-import fieldset{border:0;width:100%;padding:0 0 4px}.section-custom-api-import fieldset .c-label{font-size:12px;position:relative;float:left}.section-custom-api-import .title{font-size:21px;font-weight:400;margin-bottom:12px}.section-custom-api-import .c-select-wsdl{width:100%;max-width:100%;margin-top:0;margin-bottom:4px}.parameter-dropdown-editor-container{margin:0;padding:0}.parameter-dropdown-editor-container .input-with-image-container{position:relative;padding:0;margin:0}.parameter-dropdown-editor-container .input-with-image-container input{margin:0;padding-right:34px}.parameter-dropdown-editor-container .input-with-image-container span{position:absolute;bottom:10px;right:11px;width:16px;height:16px;vertical-align:middle;cursor:pointer}.customApiPropertiesPane{background-color:#e3e3e3;padding-top:0;overflow-y:auto;height:calc(100vh - 48px)}.customApiPropertiesPane .customApiPropertiesPane-header{width:100%;background-color:#fff}.customApiPropertiesPane .customApiPropertiesPane-topHeader{width:100%;border-bottom:1px solid #eaeaea;border-top:1px solid #eaeaea;padding-top:4px}@media only screen and (max-width:480px){.customApiPropertiesPane .customApiPropertiesPane-topHeader{position:static}}@media (min-width:768px){.customApiPropertiesPane .customApiPropertiesPane-topHeader{height:44px}}.customApiPropertiesPane .customApiPropertiesPane-topHeader-input.c-text-field[type=text]{width:100%;max-width:300px;display:inline-block;border:none;height:32px;font-size:15px}.customApiPropertiesPane .customApiPropertiesPane-topHeader-input.c-text-field[type=text][read-only]{border:none}.customApiPropertiesPane .customApiPropertiesPane-topHeader-input.c-text-field[type=text]:focus{border-bottom:1px solid #06f}.customApiPropertiesPane .customApiPropertiesPane-topHeader-button{padding-right:24px}.customApiPropertiesPane .customApiPropertiesPane-topHeader-button .fl-NgReactIconButton{height:34px;padding:0;width:16px;display:inline}.customApiPropertiesPane .customApiPropertiesPane-topHeader-ApiNameLabel{color:#767676;font-size:15px;position:relative;display:inline-block;margin:0;padding:0 16px 0 0}@media only screen and (max-width:960px){.customApiPropertiesPane .customApiPropertiesPane-topHeader-ApiNameLabel{display:none}}.customApiPropertiesPane .customApiPropertiesPane-bottomHeader{height:44px;width:100%;z-index:101;margin:auto}@media only screen and (max-width:480px){.customApiPropertiesPane .customApiPropertiesPane-bottomHeader{position:static}}.customApiPropertiesPane .customApiPropertiesPane-bottomHeader-actions{float:right;padding-top:2px}@media only screen and (max-width:960px){.customApiPropertiesPane .customApiPropertiesPane-bottomHeader-action .ms-Button-textContainer{display:none}}.customApiPropertiesPane .customApiPropertiesPane-tab{font-weight:400;font-size:15px;height:44px;padding-top:11px;margin:0 16px;display:inline-block;cursor:pointer}.customApiPropertiesPane .customApiPropertiesPane-tab--active{color:#06f;font-weight:600;border-bottom:3px solid #06f}.customApiPropertiesPane .customApiPropertiesPane-tab--first{margin-left:0}.customApiPropertiesPane .fl-alert{background-color:#fff}.customApiPropertiesPane .customApiPropertiesPane-bodyContainer{height:calc(100% - 88px);overflow:auto}.customApiPropertiesPane .customApiPropertiesPane-bodyContainer-shifted{height:calc(100% - 160px)}.customApiPropertiesPane .alert-container{background:none}.schema-property fieldset{border:none;padding:0}.schema-property fieldset .c-label{font-size:12px;position:relative;float:left}.securitySwaggerEditorTab{height:100%}.securitySwaggerEditorTab .title{font-size:21px;font-weight:400;margin-bottom:12px}.securitySwaggerEditorTab .context-required-text{color:red}.securitySwaggerEditorTab input.c-text-field[type=password],.securitySwaggerEditorTab input.c-text-field[type=text]{width:100%;max-width:100%}.securitySwaggerEditorTab input.c-text-field[type=password]{display:block;height:36px;padding:7px 10px;border:1px solid rgba(0,0,0,.6);outline:0;background:#fff}.securitySwaggerEditorTab input.c-text-field[type=password]:focus{border:1px solid #0078d7}.securitySwaggerEditorTab input.c-text-field[type=password]:disabled{cursor:not-allowed;color:rgba(0,0,0,.2);border:1px solid rgba(0,0,0,.2)}.securitySwaggerEditorTab .locked-security{position:fixed;width:100%;top:40%;left:0}.securitySwaggerEditorTab .locked-security span{font-size:21px;font-weight:700}.securitySwaggerEditorTab .securitySwaggerEditorTab-section{margin:32px 0 0}.securitySwaggerEditorTab .securitySwaggerEditorTab-scrollbox{overflow-y:auto;height:100%;position:relative;visibility:hidden}.securitySwaggerEditorTab .securitySwaggerEditorTab-scrollbox:hover{visibility:visible}.securitySwaggerEditorTab .securitySwaggerEditorTab-scrollbox-content{visibility:visible;margin-top:32px}.securitySwaggerEditorTab .securitySwaggerEditorTab-pane-field--hasButton{margin-bottom:0!important}.securitySwaggerEditorTab .securitySwaggerEditorTab-pane-content--hasButton{padding-bottom:0!important}.securitySwaggerEditorTab .securitySwaggerEditorTab-description{padding:0}.securitySwaggerEditorTab .securitySwaggerEditorTab-checkbox{display:-ms-flexbox;display:flex}.securitySwaggerEditorTab .securitySwaggerEditorTab-checkbox .learn-more{margin-top:21px;padding-left:2px}.section-share{padding:32px 0}.section-share .ps-list-item{border:1px solid #cac8c7;background:#fff;margin:10px 0}.section-share .minimal-content{height:20px}.section-share .autocomplete-container{margin-bottom:30px}.section-share hr{margin:30px 0}.section-share .tenant-share{background-color:#fff;height:72px;margin-bottom:30px;position:relative}.section-share .tenant-share img{width:48px;height:48px;position:absolute;margin-left:12px;margin-top:12px}.section-share .tenant-share span{padding-left:84px;position:absolute;vertical-align:middle;line-height:72px}.section-share .tenant-share a{position:absolute;vertical-align:middle;right:50px;line-height:72px;color:#06f;cursor:pointer}.section-share h2{padding:37px 0 3px;font-weight:200;font-size:18px;line-height:24px}.share-list-tbody td{height:72px}.share-list-tbody td.text-ellipse{width:70%}.action-buttons{float:left}.action-buttons .action-button{padding-right:8px}.option-block{margin:16px;text-align:center;font-size:x-large;vertical-align:middle;cursor:pointer}.option-block.c-glyph:hover{color:#06f}.option-block.c-glyph[disabled],.option-block[disabled]{color:rgba(0,0,0,.2);cursor:default}select{height:32px;width:150px}div.debug-pane pre:first-child{float:left;width:50%}div.debug-pane pre:last-child{width:50%}.widget .swaggerEditor{height:100vh}.swaggerEditor{background-color:#eaeaea;overflow-y:auto;height:calc(100vh - 48px)}.swaggerEditor react-button-with-custom-menu{padding-top:5px}.swaggerEditor .visible-380px,.swaggerEditor .visible-480px{display:none}.swaggerEditor .swaggerEditor-header{background-color:#fff;width:100%}.swaggerEditor .swaggerEditor-header .copilotTabHeaderMessage .ms-MessageBar,.swaggerEditor .swaggerEditor-header .copilotTabHeaderMessage .ms-MessageBar-content{background-color:#e6f0ff}.swaggerEditor .swaggerEditor-messageHeader{-ms-flex-pack:center;justify-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap}.swaggerEditor .swaggerEditor-messageHeader,.swaggerEditor .swaggerEditor-messageHeader .swaggerEditor-copyClipBoard{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.swaggerEditor .swaggerEditor-topHeader{border-bottom:1px solid #eaeaea;border-top:1px solid #eaeaea;padding-top:4px}@media only screen and (max-width:480px){.swaggerEditor .swaggerEditor-topHeader{position:static}}.swaggerEditor .swaggerEditor-topHeader-input.c-text-field[type=text]{width:100%;max-width:300px;display:inline-block;border:none;height:32px;font-size:15px}.swaggerEditor .swaggerEditor-topHeader-input.c-text-field[type=text][read-only]{border:none}.swaggerEditor .swaggerEditor-topHeader-input.c-text-field[type=text]:focus{border-bottom:1px solid #06f}.swaggerEditor .swaggerEditor-topHeader-button{padding-right:24px}.swaggerEditor .swaggerEditor-topHeader-button .fl-NgReactIconButton{height:34px;padding:0;width:16px;display:inline}.swaggerEditor .swaggerEditor-topHeader-ApiNameLabel{color:#767676;font-size:15px;position:relative;display:inline-block;margin:0;padding:0 16px 0 0}.swaggerEditor .swaggerEditor-bottomHeader{width:100%;background:#fff;z-index:101;top:92px;margin:auto}@media only screen and (max-width:480px){.swaggerEditor .swaggerEditor-bottomHeader{position:static}}.swaggerEditor .swaggerEditor-bottomHeader .swaggerEditor-bottomHeader-tabs{float:left}.swaggerEditor .swaggerEditor-bottomHeader .swaggerEditor-bottomHeader-actions{float:right;padding-top:2px;width:500px;height:44px}.swaggerEditor .swaggerEditor-bottomHeader .swaggerEditor-bottomHeader-actions .ms-Toggle{float:left;padding:10px}@media only screen and (max-width:960px){.swaggerEditor .swaggerEditor-bottomHeader .swaggerEditor-bottomHeader-actions{width:300px}}.swaggerEditor .swaggerEditor-tabSeperator{font-size:12px}.swaggerEditor .swaggerEditor-tab{font-weight:400;font-size:15px;height:44px;padding-top:11px;margin:0 16px;display:inline-block}.swaggerEditor .swaggerEditor-tab--active{color:#06f;font-weight:600;border-bottom:3px solid #06f}.swaggerEditor .swaggerEditor-tab--first{margin-left:0}.swaggerEditor .swaggerEditor-errorAlert{z-index:102;top:48px;width:80%;height:72px;background-color:#fff;float:left}.swaggerEditor .swaggerEditor-errorAlert .alert-container .alert-message{overflow-y:auto;overflow-x:hidden;word-break:break-word}.swaggerEditor .swaggerEditor-copyClipBoard{position:relative;width:20%;height:72px;background-color:#fff;font-size:15px}.swaggerEditor .swagger-editor-container{overflow:auto;height:calc(100% - 88px)}.swaggerEditor .swagger-editor-container .row,.swaggerEditor .swagger-editor-content,.swaggerEditor .swagger-editor-content-tab{height:100%}.swaggerEditor .swagger-editor-container-shifted{height:calc(100% - 160px)}.swaggerEditor .c-action-trigger{color:#333;font-size:15px;margin-top:0}.swaggerEditor .alert-container{background:none}@media only screen and (max-width:480px){.swaggerEditor .swaggerEditor-tab-name{display:none}}@media only screen and (max-width:960px){.swaggerEditor .swaggerEditor-bottomHeader-action .ms-Button-textContainer,.swaggerEditor .swaggerEditor-topHeader-ApiNameLabel{display:none}}@media only screen and (max-width:480px){.swaggerEditor .swaggerEditor-errorAlert{position:static}}.swaggerEditor .swaggerEditorTabsDropdown{display:none}.swaggerEditor .pane-field-multiselect{display:-ms-flexbox;display:flex}.swaggerEditor .pane-field-multiselect .select-option-container{display:inline-block;width:50%}.swaggerEditor .pane-field-multiselect .select-option-container .select-option{width:100%}.swaggerEditor .pane-field-multiselect .select-option-container:first-child{padding-right:20px}.swaggerEditor .pane-field-multiselect .select-option-container select:disabled{background-color:rgba(0,0,0,.2)}@media (max-width:480px){.swaggerEditor .swaggerEditor-bottomHeader .swaggerEditor-bottomHeader-actions{width:180px}.swaggerEditor .visible-480px{display:block;float:left}.swaggerEditor .not-visible-480px{display:none}.swaggerEditor .swaggerEditor-topHeader-input.c-text-field[type=text]{max-width:300px}.swaggerEditor .swaggerEditor-topHeader-row{display:-ms-inline-flexbox;display:inline-flex}.swaggerEditor .swagger-editor-container-shifted{height:calc(100% - 232px)}}@media (max-width:380px){.swaggerEditor .swaggerEditor-bottomHeader .swaggerEditor-bottomHeader-actions{width:80px}.swaggerEditor .visible-380px{display:block;float:left}.swaggerEditor .not-visible-380px{display:none}.swaggerEditor .swaggerEditor-topHeader-input.c-text-field[type=text]{max-width:200px}.swaggerEditor .swaggerEditor-messageHeader .swaggerEditor-copyClipBoard{-ms-flex-preferred-size:100%;flex-basis:100%}}@media (max-width:1360px){.swaggerEditor .swaggerEditor-bottomHeader-tabs{display:none}.swaggerEditor .swaggerEditorTabsDropdown{display:block;float:left;padding-top:7px}}#swagger-editor-iframe{height:100%;width:100%;display:block}.customApiTestTab{padding-top:32px}.customApiTestTab .validation-errors img{display:inline}.customApiTestTab .validation-errors label{display:inline;color:#000}.customApiTestTab .left-pane .column-title{font-size:21px;font-weight:400;margin-bottom:12px}.customApiTestTab .left-pane .left-pane-button{margin-left:48px}.customApiTestTab .c-select:disabled{background-color:#e6e6e6}.customApiTestTab .pane-field spinner{display:inline-block;margin-left:12px;padding-bottom:8px}.customApiTestTab .right-pane section hr{margin:12px 0}.customApiTestTab .right-pane section .pane-title a{margin-right:24px}.customApiTestTab .right-pane section .pane-tabs{padding:0}.customApiTestTab .right-pane section .pane-field{margin-bottom:8px}.customApiTestTab .right-pane section .pane-field input.c-text-field{height:30px;padding-top:0;padding-bottom:0}.customApiTestTab .right-pane section .pane-field textarea{resize:vertical;border:1px solid rgba(0,0,0,.6);height:20em}.customApiTestTab .right-pane section .pane-field textarea.raw-output{resize:none}.customApiTestTab .right-pane section .pane-field textarea.small{height:8em}.customApiTestTab .right-pane section .pane-field .error-message{color:red}.customApiTestTab .right-pane section a{cursor:pointer}.customApiTestTab .right-pane section a.disabled{cursor:not-allowed;color:grey}.customApiTestTab .right-pane section .c-glyph:before{font-size:12px;margin-right:4px}.customApiTestTab .right-pane section .raw-output{font:14px Segoe UI,Segoe WP,Tahoma,Arial,sans-serif;overflow-y:auto;white-space:pre;width:100%}.customApiTestTab .right-pane section.margin-bottom{margin-bottom:20px}.customApiTestTab .margin-top{margin-top:40px}.customApiTestTab #results-section-pivot label{font-weight:700}.customApiTestTab .right{float:right}.customApiTestTab .c-pivot .pane-header{color:#000;cursor:pointer;font-weight:500;padding:8px 12px 4px}.customApiTestTab .c-pivot .pane-header.f-active{color:#06f;border-bottom:4px solid #06f}.customApiTestTab .pane-header{font-size:14px}.customApiTestTab div.c-toggle button[disabled=disabled]:hover{background:rgba(0,0,0,.2);border-color:transparent;cursor:not-allowed}.customApiTestTab div.c-toggle label{margin-top:0}.customApiTestTab .customApiTestTab-sectionDivider{margin-top:32px;margin-bottom:32px}.validatedInput{position:relative;padding:0;margin:0}.validatedInput .validatedInput-label{margin-top:0;font-size:12px;padding:0 0 4px}.validatedInput .validatedInput-description{margin-top:0;margin-bottom:8px;font-size:12px;padding:0 0 4px}.validatedInput .validatedInput-input{margin:0}.validatedInput .validatedInput-input--toolTipLeft{padding-left:40px!important}.validatedInput .validatedInput-input--toolTipRight{padding-right:40px!important}.validatedInput .c-select .validatedInput-input--toolTipRight{padding-right:64px!important}.validatedInput input.validatedInput-input--toolTipRight[type=number]{padding-right:10px!important}.validatedInput .validatedInput-validationResultTooltip{position:absolute;bottom:10px;width:16px;height:16px;vertical-align:middle}.validatedInput .validatedInput-validationResultTooltip--left{left:12px}.validatedInput .validatedInput-validationResultTooltip--right{right:12px}.validatedInput .c-select+.validatedInput-validationResultTooltip--right,.validatedInput input[type=number]+.validatedInput-validationResultTooltip--right{right:36px}.validation-results-container{margin:0}.validation-results-container .validation-pane{margin-top:12px}.validation-results-container .validation-pane .validation-icon{margin-right:24px}.validation-results-container .validation-pane .pane-content .pane-field{margin-bottom:0}.validation-results-container .validation-pane div.entity-result{margin-bottom:8px}.validation-results-container .validation-pane .result-messages img,.validation-results-container .validation-pane .result-messages label{display:inline}.validation-results-container .indent{margin-left:16px}.validationResultTooltip{padding:0;margin:0}.validationResultTooltip .validationResultTooltip-icon{display:block}.validationResultTooltip .validationResultTooltip-result{margin:8px}.validationResultTooltip .validationResultTooltip-result-icon{margin-top:3px;margin-right:4px;vertical-align:top;display:inline-block}.validationResultTooltip .validationResultTooltip-result-message{margin-left:4px;display:inline-block;width:85%}.validationResultTooltip .validationResultTooltip-result-divider{margin:4px 0;border-color:#eaeaea}.validationResultTooltip .validationResultTooltip-tooltip{width:300px;background-color:#fff;color:#333;-webkit-box-shadow:0 0 4px 0 #a6a6a6;box-shadow:0 0 4px 0 #a6a6a6;border:1px solid #eaeaea;text-align:left;padding:4px;border-radius:4px;visibility:hidden;position:absolute;z-index:1}.validationResultTooltip .validationResultTooltip-tooltip--topLeft{bottom:28px;right:0}.validationResultTooltip .validationResultTooltip-tooltip--topRight{bottom:28px;left:0}.validationResultTooltip .validationResultTooltip-tooltip--bottomLeft{top:28px;right:0}.validationResultTooltip .validationResultTooltip-tooltip--bottomRight{top:28px;left:0}.validationResultTooltip:focus .validationResultTooltip-tooltip,.validationResultTooltip:hover .validationResultTooltip-tooltip{visibility:visible}@media (max-width:480px){.validationResultTooltip .validationResultTooltip-tooltip{width:auto}}.left-pane{margin:0}.left-pane h1{padding:0;font-size:20px;line-height:1;font-weight:500;margin-bottom:8px}.left-pane p{padding:0;font-size:15px}.pane-title{font-size:14px;font-weight:600;padding:8px 8px 8px 24px;line-height:normal}.pane-title .pane-title-button{height:35px}.pane-title .pane-title-text--hasIconOrButton{font-size:14px;font-weight:600;padding:8px 8px 8px 24px;line-height:normal;display:inline-block}.pane-title--hasIconOrButton{padding:0;-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.pane-content{padding:16px 24px 24px;background-color:#fff}.pane-content .c-action-trigger .c-glyph{padding:0;border:0;clear:both}.pane-content input[type=file]{height:.1px;width:.1px;opacity:0;z-index:-1;position:absolute;overflow:hidden;display:initial}.pane-content div.pane-field:last-child{margin-bottom:0}.pane-content .pane-table-header{font-size:12px}.pane-content .pane-table-header label{padding-left:0;padding-bottom:12px}.pane-content .pane-table-body{margin-top:4px;margin-bottom:4px}.pane-content .pane-table-body .c-label{height:36px;margin:8px 0}.pane-content .pane-row-label{font-size:13px;font-weight:500}.pane-content .pane-row-input{font-size:15px}.pane-content .pane-field{margin-bottom:24px}.pane-content .pane-field:after,.pane-content .pane-field:before{content:" ";display:table}.pane-content .pane-field:after{clear:both}.pane-content .pane-field textarea{min-width:0}.pane-content .pane-field .subtitle{margin-bottom:8px;color:#767676}.pane-content .pane-field .pane-field-label,.pane-content .pane-field .subtitle{margin-top:0;font-size:12px;padding:0 0 4px}.pane-content .pane-field .c-select{width:100%;max-width:100%;margin-top:0}.pane-content .pane-field input[type=number],.pane-content .pane-field input[type=password],.pane-content .pane-field input[type=text]{width:100%;outline:0;margin:0}.pane-content .pane-field textarea{width:100%;height:72px;display:block}.pane-content .pane-field .fl-ChoiceGroup .ms-Label{font-size:12px;font-weight:400}.pane-elements{margin-top:12px}td.table-cell-image img{height:48px;width:48px;background-color:#fff}td.text-ellipse{white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}td .connection-name-text{max-width:600px}table{border-collapse:separate;border-spacing:0}table thead th,table thead tr{border-bottom:1px solid rgba(0,0,0,.2);border-collapse:separate}table tbody td:hover,table tbody tr:hover{background-color:#e3e3e3;cursor:pointer}table .img-button{background-color:transparent;background-repeat:no-repeat;border:none;cursor:pointer;overflow:hidden;width:60px;height:60px}table .img-button.c-glyph:hover{color:#06f}.c-table .load-more{text-align:center;height:20px;padding-top:20px}.c-table tr:before{width:0}.c-table td{vertical-align:middle;padding:0 12px}@media only screen and (max-width:960px){table .img-button{width:30px;height:30px}}.c-glyph.glyph-close:before{content:"\\E711"}.c-glyph.glyph-search:before{content:"\\E721"}.c-glyph.glyph-search-reverse:before{content:"\\E71E"}.c-glyph.glyph-create:before{content:"\\E710"}.c-glyph.glyph-delete:before{content:"\\E74D"}.c-glyph.glyph-edit:before{content:"\\E70F"}.c-glyph.glyph-play:before{content:"\\E768"}.c-glyph.glyph-pause:before{content:"\\E769"}.c-glyph.glyph-arrow-after:after,.c-glyph.glyph-arrow:before{content:"\\E76C"}.c-glyph.glyph-arrowback:before{content:"\\E72B"}.c-glyph.glyph-checkmark:before{content:"\\E73E"}.c-glyph.glyph-inprogress:before{content:"\\E895"}.c-glyph.glyph-download:before{content:"\\E896"}.c-glyph.glyph-upload:before{content:"\\E896";-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.c-glyph.glyph-stop:before{content:"\\E73C"}.c-glyph.glyph-resubmit:before{content:"\\E7AD"}.c-glyph.glyph-ellipsis:before{content:"\\E712"}.c-glyph.glyph-mail:before{content:"\\E715"}.c-glyph.glyph-owners:before{content:"\\E716"}.c-glyph.glyph-arrowdown:before{content:"\\E70D"}.c-glyph.glyph-arrowup:before{content:"\\E70E"}.c-glyph.glyph-leavepage:before{content:"\\E8AD"}.c-glyph.glyph-saveas:before{content:"\\E8C8"}.c-glyph.glyph-minus:before{content:"\\E738"}.c-glyph.glyph-share:before{content:"\\E72D"}.c-glyph.glyph-person:before{content:"\\E77B"}.c-glyph.glyph-calendar:before{content:"\\ED28"}.c-glyph.glyph-export:before{content:"\\E896";display:inline-block;-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.c-glyph.glyph-info:before{content:"\\E946"}.c-glyph.glyph-warning:before{content:"\\E7BA"}.c-glyph.glyph-refresh:before{content:"\\E72C"}.c-glyph.glyph-error:before{content:"\\E8C9"}.c-glyph.glyph-test:before{content:"\\E8B1"}.c-glyph.glyph-onOffToggle:before{content:"\\E890"}.c-glyph.glyph-copy:before{content:"\\E8C8"}.theme-blue input.c-text-field[type=text]{border-color:#fff;color:#000}.theme-blue input.c-text-field[type=text]:hover{border-color:#005fcb}.theme-blue input.c-text-field[type=text]:active,.theme-blue input.c-text-field[type=text]:focus{border-color:#000}.theme-white input.c-text-field[type=text]{border-color:#000;color:#000}.theme-white input.c-text-field[type=text]:hover{border-color:#005fcb}.theme-white input.c-text-field[type=text]:active,.theme-white input.c-text-field[type=text]:focus{border-color:#06f}.c-input-select-field{width:276px;height:36px;padding:7px 10px;border:1px solid rgba(0,0,0,.6);outline:0;background:#fff}.c-input-select-field:active{border-color:#0078d7}.c-button-text-field{position:relative;min-width:92px;max-width:296px;height:38px;margin-top:20px}.c-button-text-field button,.c-button-text-field input[type=text]{float:left;height:100%;outline:0;background-color:#fff}.c-button-text-field input[type=text]{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;margin-top:0;padding:7px 38px 7px 10px;border:1px solid #000;border:1px solid rgba(0,0,0,.6)}.c-button-text-field input[type=text]:hover{border-color:rgba(0,0,0,.8)}.c-button-text-field input[type=text]:active,.c-button-text-field input[type=text]:focus{border-color:#06f}.c-button-text-field input[type=text]::-ms-clear{display:none}.c-button-text-field button{position:absolute;top:0;right:0;width:38px;height:38px;margin:0;padding:9px;line-height:normal;-webkit-transition:color .1s,background-color .1s;-o-transition:color .1s,background-color .1s;transition:color .1s,background-color .1s;border:0;background-color:#06f;color:#fff}.c-button-text-field button:active,.c-button-text-field button:focus,.c-button-text-field button:hover{background-color:#005fcb}.c-button-text-field button:before{text-indent:0;font-size:16px}.c-button-text-field button.glyph-forward-arrow:before{content:"\\e72a";color:#fff}.section-manage-flow-analytics{min-height:calc(100vh - 48px);background-color:#eaeaea}.section-manage-flow-analytics .section-flow-analytics .autocomplete-container{max-width:100%}.section-manage-flow-analytics .section-flow-analytics .analytics-info-pane{display:none;padding:10px;background:#eee;margin-left:5%;margin-right:5%}.section-manage-flow-analytics .section-flow-analytics.row{max-width:1200px}.section-manage-flow-analytics .section-flow-analytics .analytics-report{width:100%;padding-left:0;padding-right:0;height:645px;overflow:hidden;border-style:none;margin-top:0}.section-manage-flow-analytics .section-flow-analytics .analytics-report iframe{border:none}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon{height:90px}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .dashboard-tabs{margin-left:-12px;padding:25px 0;display:inline-block}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .dashboard-tabs a{margin:0 10px;padding:12px 0;font-weight:600;cursor:pointer}@media only screen and (min-width:768px){.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .dashboard-tabs a{margin:0 12px}}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .dashboard-tabs a.tab-active{color:#06f;padding-bottom:9px;border-bottom:3px solid #06f}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .dashboard-tabs a.tab-active:focus{outline:none}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .duration-control{width:160px;margin-top:22px;float:right}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .duration-control select{padding-left:15px}.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .label-filter{float:right;padding:28px 10px;font-weight:600}@media only screen and (max-width:960px){.section-manage-flow-analytics .section-flow-analytics .detail-ribbon .label-filter{display:none}}.heading-template{padding:10px 5px;float:left}.heading-template span{font-size:14px}@media only screen and (max-width:960px){.heading-template span{display:none}}.heading-template .analytics-refreshdate-text{margin-right:0}.heading-template .analytics-dashboard{float:right}.heading-template a{font-size:14px;padding:7px 15px;border:1px solid #666;margin-right:0;vertical-align:middle;float:right}.heading-template a.dashboard-active{background-color:#666;color:#fff}@media only screen and (min-width:320px) and (max-width:960px){.section-manage-flow-analytics .section-flow-analytics .analytics-info-pane{display:block}}.user-autocomplete .autocomplete-error p{color:#ef3a24;font-weight:700;padding:0 6px}.autocomplete-container{width:100%;position:relative}.autocomplete-hint{border:1px solid #000;border-top:none}.autocomplete-hint p{padding:0 6px;font-size:12px}.autocomplete-input.c-text-field[type=text]{width:100%}input.autocomplete-input[disabled]{background-color:#c8c8c8;cursor:not-allowed}.autocomplete-list-wrapper{width:100%;z-index:997;position:absolute;background:#fff}ul.autocomplete-list{width:100%;max-height:250px;overflow-y:auto;overflow-x:hidden;border:1px solid #5e5e5e;background:#fff}li.autocomplete-list-item{cursor:pointer;padding:5px;word-wrap:break-word}li.autocomplete-selected-row{background-color:#e3e3e3}.ps-list-item{border:1px solid #cac8c7;background:#fff;margin:10px 0}.info-card-item{vertical-align:middle}.info-card-item .info-card-icon{float:left;margin:8px;padding:10px}.info-card-item .info-card-icon img{vertical-align:middle;width:48px;height:48px}.info-card-item .info-card-text-section{float:left;margin:8px;padding:10px}.info-card-item .info-card-text-section .info-card-title{font-weight:500;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.info-card-item .info-card-text-section .info-card-subtitle{font-weight:200;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;color:#5e5e5e;font-size:13px;font-weight:400;white-space:normal}.info-card-item .info-card-text-section .info-card-list-option{font-weight:400;padding-top:4px}.info-card-item .info-card-text-section .info-card-list-option li{font-weight:300}.info-card-item .info-card-options{float:right}.info-card-item .info-card-options select{font-size:13px;margin-top:12px;width:100%}.info-card-item .card-option{display:inline-block;padding:10px}.info-card-item .dropdown-card-option{float:left}.section-manage-flow-owners .section-flow-owners .ps-list-item{margin:10px 0}.section-manage-flow-owners .section-flow-owners.row{max-width:1200px}.section-manage-flow-owners .owner-tabs a{font-size:15px;margin:0 8px 10px 0;display:inline-block;color:#333;cursor:pointer}.section-manage-flow-owners .owner-tabs a.tab-active{font-size:15px;color:#06f;padding-bottom:5px;font-weight:600;border-bottom:3px solid #06f}.section-manage-flow-owners .owner-tabs a.tab-active:focus{outline:none}.section-manage-flow-owners .flow-owners-flow-name{max-width:100%;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-header-content h6{padding:0}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-header-content .ng-modal-close{position:absolute;top:15px;right:12px;padding:5px;cursor:pointer;font-size:70%;display:inline-block}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-header-content .ng-modal-close:hover{color:#06f}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-body-content .connections-info-cards{padding-top:10px}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-body-content .info-card-item{margin:0;padding:0}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-body-content .info-card-item:after,.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-body-content .info-card-item:before{content:" ";display:table}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-body-content .info-card-item:after{clear:both}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-body-content .info-card-item .info-card-icon{margin:0;padding:10px 0 0}.section-manage-flow-owners .ng-modal-dialog .ng-modal-dialog-body-content .learn-more-link{color:#06f}.section-manage-flow-owners .option-block{margin:16px;text-align:center;font-size:x-large;vertical-align:middle;cursor:pointer}.section-manage-flow-owners .option-block.c-glyph:hover{color:#06f}.section-manage-flow-owners .option-block.c-glyph[disabled]{color:rgba(0,0,0,.2);cursor:not-allowed}.section-manage-flow-owners .option-block[disabled]{color:rgba(0,0,0,.2);cursor:default}.section-manage-flow-owners .flow-owners-alert{margin:10px}.section-manage-flow-owners .section-flow-owners-connections{margin-top:40px}.section-manage-flow-owners .section-flow-owners-connections.row{max-width:1200px}.section-manage-flow-owners .section-flow-owners-connections .ps-list-item{margin:10px 0}.section-manage-flow-owners .section-flow-owners-connections .other-connections-title{margin-top:20px}.section-manage-flow-owners .section-flow-owners{margin-bottom:24px}.section-manage-flow-owners .owners-sharepoint-container{margin-bottom:20px}.section-manage-flow-owners .owners-sharepoint-container select{margin-top:5px;width:100%}.section-manage-flow-owners .owners-sharepoint-container .dropdown-label{margin-top:12px;padding-bottom:0}.section-manage-flow-owners .ng-modal .info-card-item.row{display:-ms-flexbox;display:flex}.section-manage-flow-owners .ng-modal .info-card-item .info-card-text-section{-ms-flex-positive:1;flex-grow:1;margin:8px}.section-manage-flow-owners .flow-owners-title{font-size:21px;font-weight:600}.section-manage-flow-owners .flow-owners-subtitle{font-size:15px;font-weight:400}.section-manage-flow-owners .flowOwners-header{padding:0}.section-manage-flow-owners .flowOwners-warningDialog-header{font-weight:600;font-size:20px;line-height:28px;padding:0;margin-left:5px;display:inline-block}.section-manage-flow-owners .flowOwners-description{padding:0}.section-manage-flow-owners .c-hyperlink{text-decoration:underline}@media only screen and (min-width:320px) and (max-width:480px){.section-manage-flow-owners .section-flow-owners .autocomplete-container{max-width:100%}.section-manage-flow-owners .section-flow-owners-connections.row,.section-manage-flow-owners .section-flow-owners.row{max-width:100%;padding-left:10px;padding-right:10px;width:100%}}@media only screen and (max-width:900px){.section-manage-flow-owners .medium-6{width:30%}}.sticky-save{z-index:101}.sticky-error,.sticky-save{background-color:#fff;width:100%;position:fixed;top:48px}.sticky-error{z-index:100;height:72px}.sticky-save.testing,.sticky-save.testing input[type=text]{background-color:#e3e3e3}.sticky-container{position:relative;max-width:1200px;margin:auto}.sticky-save-shifted{top:120px}@media only screen and (max-width:480px){.sticky-error,.sticky-save{position:static}.sticky-error{margin-bottom:20px}}.widget .manage-flow-section{height:100vh}.manage-flow-section{height:calc(100vh - 48px);display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.manage-flow-section .manage-flow-details{overflow:auto;display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;background:#eaeaea;position:relative}.manage-flow-section .manage-flow-details .draft-overlay{height:100%;width:100%;text-transform:uppercase;position:absolute;background:transparent;pointer-events:none;top:0;z-index:1}.manage-flow-section .manage-flow-details .draft-overlay .draft-marker{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;position:absolute;-webkit-transform:rotate(335deg);-ms-transform:rotate(335deg);transform:rotate(335deg);top:44px;left:44px;height:44px;padding:0 12px;border:2px solid #e81123;color:#e81123;font-size:18px;font-weight:600}.manage-flow-section .flow-designer-container{-ms-flex:1 1;flex:1 1;overflow:auto}.manage-flow-section .flow-designer-container .msla-container{padding:16px}.manage-flow-section .flow-designer-container .msla-transform-buttons{display:none}.manage-flow-section .ms-Button.fl-CommandBar-FlowChecker--hasErrors,.manage-flow-section .ms-Button.fl-CommandBar-FlowChecker--hasWarnings{position:relative}.manage-flow-section .ms-Button.fl-CommandBar-FlowChecker--hasErrors .ms-Button-flexContainer,.manage-flow-section .ms-Button.fl-CommandBar-FlowChecker--hasWarnings .ms-Button-flexContainer{position:static}.manage-flow-section .ms-Button.fl-CommandBar-FlowChecker--hasErrors .ms-Button-icon:after,.manage-flow-section .ms-Button.fl-CommandBar-FlowChecker--hasWarnings .ms-Button-icon:after{content:"\\1F7E0";position:absolute;top:1px;left:17px;font-size:10px}.manage-flow-section .ms-Button[aria-label="Flow Checker"].fl-CommandBar-FlowChecker--hasWarnings .ms-Button-icon:after{background:#767676}#flow-commenting-pane>div{height:100%}#flow-commenting-pane.opened{-ms-flex-positive:1;flex-grow:1;min-width:293px}@media only screen and (min-width:768px){#flow-commenting-pane.opened{-ms-flex-positive:0;flex-grow:0}}#flow-commenting-pane #ppux-shared-comments-pane h2{line-height:100%;padding:0}#flow-commenting-pane .ms-Icon{-webkit-box-sizing:content-box;box-sizing:content-box}#flow-commenting-pane p{line-height:unset;letter-spacing:unset;font-weight:unset;font-size:unset}.msla-host-flow-template,.msla-host-processsimple{background:transparent}.msla-host-flow-template *,.msla-host-flow-template :after,.msla-host-flow-template :before,.msla-host-flow-template input[type=search],.msla-host-processsimple *,.msla-host-processsimple :after,.msla-host-processsimple :before,.msla-host-processsimple input[type=search]{-webkit-box-sizing:border-box;box-sizing:border-box}.msla-host-flow-template,.msla-host-processsimple{padding-bottom:10px}.msla-host-flow-template input[type=text],.msla-host-processsimple input[type=text]{height:44px}.msla-host-flow-template input[type=text].ms-TextField-field,.msla-host-processsimple input[type=text].ms-TextField-field{height:100%}.msla-host-flow-template .msla-copy-input-control input[type=text],.msla-host-processsimple .msla-copy-input-control input[type=text]{height:32px}.msla-host-flow-template input[type=checkbox],.msla-host-processsimple input[type=checkbox]{-webkit-appearance:checkbox;margin:3px 3px 3px 4px}.msla-host-flow-template label,.msla-host-processsimple label{margin:inherit;padding:inherit}.msla-host-flow-template table td,.msla-host-processsimple table td{height:inherit}.msla-host-flow-template table td:hover,.msla-host-processsimple table td:hover{background-color:inherit;cursor:inherit}.msla-host-flow-template table tbody tr,.msla-host-processsimple table tbody tr{height:inherit;border-bottom:inherit}.msla-host-flow-template .msla-card-button-primary,.msla-host-processsimple .msla-card-button-primary{background-color:#06f}.msla-host-flow-template .msla-card-button-primary:hover,.msla-host-processsimple .msla-card-button-primary:hover{background-color:#005fcb;border-color:rgba(0,0,0,.4)}.msla-host-flow-template .msla-card-button-primary:disabled,.msla-host-processsimple .msla-card-button-primary:disabled{color:rgba(0,0,0,.2);background-color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}.msla-host-flow-template .msla-card-description-icon-button,.msla-host-processsimple .msla-card-description-icon-button{height:90%;width:44px;vertical-align:top;padding:5px 0;display:inline-block}.msla-host-flow-template .msla-card-children,.msla-host-processsimple .msla-card-children{width:100%}.msla-host-flow-template .msla-card-selected,.msla-host-processsimple .msla-card-selected{-webkit-box-shadow:0 0 10px #acacac;box-shadow:0 0 10px #acacac}.msla-host-flow-template .msla-actionpalette-menu-triangle,.msla-host-processsimple .msla-actionpalette-menu-triangle{border-bottom:7px solid #06f;margin-right:calc(50% + 60px)}.msla-host-flow-template .msla-actionpalette-menu,.msla-host-processsimple .msla-actionpalette-menu{background-color:#06f;-webkit-box-shadow:0 3px 3px #c8c8c8;box-shadow:0 3px 3px #c8c8c8;border-radius:0}.msla-host-flow-template .msla-actionpalette-menu .msla-action-button img,.msla-host-processsimple .msla-actionpalette-menu .msla-action-button img{margin:5px 0 0}.msla-host-flow-template .msla-actionpalette-menu .msla-actionpalette-expanded-menu,.msla-host-processsimple .msla-actionpalette-menu .msla-actionpalette-expanded-menu{width:215px;right:-135px}.msla-host-flow-template .msla-action-palette-list .msla-actionpalette-expanded-menu,.msla-host-processsimple .msla-action-palette-list .msla-actionpalette-expanded-menu{width:205px;right:-66px}.msla-host-flow-template .msla-action-palette-list .msla-action-button,.msla-host-processsimple .msla-action-palette-list .msla-action-button{padding:10px 0}.msla-host-flow-template .msla-condition-branch-header .msla-condition-branch-add,.msla-host-processsimple .msla-condition-branch-header .msla-condition-branch-add{color:#06f}.msla-host-flow-template .msla-action-button-text,.msla-host-processsimple .msla-action-button-text{padding-top:0}.msla-host-flow-template .msla-actionpalette,.msla-host-processsimple .msla-actionpalette{margin:0}.msla-host-flow-template .msla-actionpalette .buttons-row .msla-action-buttons,.msla-host-processsimple .msla-actionpalette .buttons-row .msla-action-buttons{color:#333}.msla-host-flow-template .msla-actionpalette .msla-action-button .msla-actionmenu-toggle,.msla-host-processsimple .msla-actionpalette .msla-action-button .msla-actionmenu-toggle{padding:0}.msla-host-flow-template .msla-connection-link .msla-selector div.msla-selector-list-item .msla-selector-icon,.msla-host-processsimple .msla-connection-link .msla-selector div.msla-selector-list-item .msla-selector-icon{margin:0 7px}.msla-host-flow-template .msla-connection-container,.msla-host-processsimple .msla-connection-container{-webkit-box-sizing:content-box;box-sizing:content-box}.msla-host-flow-template .msla-connection-selector-options .msla-connection-create-button,.msla-host-processsimple .msla-connection-selector-options .msla-connection-create-button{background-color:#06f;border-color:#06f}.msla-host-flow-template .msla-connection-selector-options .msla-connection-switch-link,.msla-host-processsimple .msla-connection-selector-options .msla-connection-switch-link{color:#06f;border-color:#06f}.msla-host-flow-template .msla-connection-selector-options .msla-selector,.msla-host-processsimple .msla-connection-selector-options .msla-selector{margin:0 0 0 5px}.msla-host-flow-template .msla-connection-selector .msla-connection-switch-link:focus,.msla-host-processsimple .msla-connection-selector .msla-connection-switch-link:focus{outline:5px auto #06f}.msla-host-flow-template .msla-connection-view-permissions-link,.msla-host-processsimple .msla-connection-view-permissions-link{color:#06f;border-color:#06f}.msla-host-flow-template .msla-connection-container-footer .msla-button,.msla-host-processsimple .msla-connection-container-footer .msla-button{background-color:#06f;border-color:#06f}.msla-host-flow-template .msla-connection-container-footer button[disabled],.msla-host-processsimple .msla-connection-container-footer button[disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}.msla-host-flow-template .msla-card-config-button-container button,.msla-host-processsimple .msla-card-config-button-container button{background-color:#06f;border-color:#06f;color:#fff}.msla-host-flow-template .msla-card-config-button-container button:focus,.msla-host-processsimple .msla-card-config-button-container button:focus{border:1px dashed #fff}.msla-host-flow-template .msla-card-config-button-container button[disabled],.msla-host-processsimple .msla-card-config-button-container button[disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}.msla-host-flow-template .msla-card-config-item,.msla-host-processsimple .msla-card-config-item{margin:10px 8px}.msla-host-flow-template .msla-card-config-item>div,.msla-host-processsimple .msla-card-config-item>div{min-width:0}.msla-host-flow-template .msla-card-config-item .msla-label,.msla-host-processsimple .msla-card-config-item .msla-label{padding:0}.msla-host-flow-template .msla-card-config-item label,.msla-host-processsimple .msla-card-config-item label{margin:2px;width:100%}.msla-host-flow-template .msla-card-config-item .msla-checkbox-label,.msla-host-processsimple .msla-card-config-item .msla-checkbox-label{min-height:18px}.msla-host-flow-template .msla-card-config-item .msla-checkbox-description-icon-button,.msla-host-flow-template .msla-card-config-item .msla-checkbox-label label,.msla-host-processsimple .msla-card-config-item .msla-checkbox-description-icon-button,.msla-host-processsimple .msla-card-config-item .msla-checkbox-label label{vertical-align:middle}@media only screen and (max-width:1161px){.msla-host-flow-template .msla-card-config-item,.msla-host-processsimple .msla-card-config-item{display:block}.msla-host-flow-template .msla-card-config-item label,.msla-host-processsimple .msla-card-config-item label{width:auto}}.msla-host-flow-template .msla-input-parameter-label,.msla-host-processsimple .msla-input-parameter-label{text-transform:none}.msla-host-flow-template .msla-input-parameter-label .msla-label,.msla-host-processsimple .msla-input-parameter-label .msla-label{padding:0}.msla-host-flow-template .msla-input-parameter-label.msla-label-with-tooltip,.msla-host-processsimple .msla-input-parameter-label.msla-label-with-tooltip{display:-ms-flexbox;display:flex}.msla-host-flow-template .msla-input-parameter-label.msla-label-with-tooltip .msla-label-tooltip,.msla-host-processsimple .msla-input-parameter-label.msla-label-with-tooltip .msla-label-tooltip{margin-left:5px;cursor:default}.msla-host-flow-template .public-DraftEditorPlaceholder-root,.msla-host-processsimple .public-DraftEditorPlaceholder-root{padding-left:0}.msla-host-flow-template .msla-picker-header .msla-picker-title .msla-title-segment .msla-segment .msla-text-navigation,.msla-host-processsimple .msla-picker-header .msla-picker-title .msla-title-segment .msla-segment .msla-text-navigation{color:#06f}.msla-host-flow-template .msla-parameter-picker-button,.msla-host-processsimple .msla-parameter-picker-button{width:43px;height:39px}.msla-host-flow-template .msla-picker-items .msla-item-selected,.msla-host-processsimple .msla-picker-items .msla-item-selected{background-color:#06f}.msla-host-flow-template .msla-picker-items .msla-folder:hover,.msla-host-processsimple .msla-picker-items .msla-folder:hover{background-color:transparent}.msla-host-flow-template .msla-picker-items .msla-file:hover,.msla-host-flow-template .msla-picker-items .msla-folder .msla-navigate-button:hover,.msla-host-flow-template .msla-picker-items .msla-folder .msla-selection-section:hover,.msla-host-processsimple .msla-picker-items .msla-file:hover,.msla-host-processsimple .msla-picker-items .msla-folder .msla-navigate-button:hover,.msla-host-processsimple .msla-picker-items .msla-folder .msla-selection-section:hover{background-color:rgba(0,119,255,.1)}.msla-host-flow-template .msla-picker-command-bar .msla-confirm,.msla-host-processsimple .msla-picker-command-bar .msla-confirm{background-color:#06f}.msla-host-flow-template .msla-parameter-picker-input-box,.msla-host-processsimple .msla-parameter-picker-input-box{vertical-align:middle}.msla-host-flow-template .msla-condition-branches .msla-parameter-picker-input-box,.msla-host-processsimple .msla-condition-branches .msla-parameter-picker-input-box{width:calc(100% - 75px)}.msla-host-flow-template .msla-condition-branches .msla-picker-items .msla-folder .msla-selection-section,.msla-host-processsimple .msla-condition-branches .msla-picker-items .msla-folder .msla-selection-section{width:calc(100% - 62px)}.msla-host-flow-template .msla-condition-branches .msla-picker-command-bar .msla-cancel,.msla-host-flow-template .msla-condition-branches .msla-picker-command-bar .msla-confirm,.msla-host-processsimple .msla-condition-branches .msla-picker-command-bar .msla-cancel,.msla-host-processsimple .msla-condition-branches .msla-picker-command-bar .msla-confirm{padding:0}.msla-host-flow-template .msla-change-profile-link-text,.msla-host-flow-template .msla-edit-parameters-values-text,.msla-host-processsimple .msla-change-profile-link-text,.msla-host-processsimple .msla-edit-parameters-values-text{color:#06f}.msla-host-flow-template .msla-checkbox-label,.msla-host-processsimple .msla-checkbox-label{margin:0}.msla-host-flow-template .msla-if .msla-condition-expanded>div>div>.msla-card.msla-card-selected .msla-card-condition-parameters,.msla-host-processsimple .msla-if .msla-condition-expanded>div>div>.msla-card.msla-card-selected .msla-card-condition-parameters{border:none}.msla-host-flow-template .msla-if>div>div>div>.msla-card>.msla-card-body>.msla-card-condition-body>.msla-card-condition-branches,.msla-host-processsimple .msla-if>div>div>div>.msla-card>.msla-card-body>.msla-card-condition-body>.msla-card-condition-branches{background:none}.msla-host-flow-template .msla-recommendation-dropdown,.msla-host-processsimple .msla-recommendation-dropdown{border:1px solid #cac8c7}.msla-host-flow-template .msla-recommendation-footer,.msla-host-processsimple .msla-recommendation-footer{color:#000;border:1px solid #cac8c7;border-top:none}.msla-host-flow-template .msla-card-condition-branch .msla-card-condition-parameters-body,.msla-host-processsimple .msla-card-condition-branch .msla-card-condition-parameters-body{-webkit-box-shadow:0 0 10px #acacac;box-shadow:0 0 10px #acacac}.msla-host-flow-template .msla-card-condition-branch .msla-card-header,.msla-host-flow-template .msla-card-condition-branch .msla-if>div>div>div>.msla-card.msla-card-selected>.msla-card-header,.msla-host-processsimple .msla-card-condition-branch .msla-card-header,.msla-host-processsimple .msla-card-condition-branch .msla-if>div>div>div>.msla-card.msla-card-selected>.msla-card-header{-webkit-box-shadow:none;box-shadow:none;border:none}.msla-host-flow-template .msla-comment-box,.msla-host-processsimple .msla-comment-box{border-top:1px solid #d2d2d2}.msla-host-flow-template .msla-comment-box .msla-comment-icon img,.msla-host-processsimple .msla-comment-box .msla-comment-icon img{width:22px;height:22px}.msla-host-flow-template .msla-information-box-container,.msla-host-processsimple .msla-information-box-container{font-size:14px;font-family:Segoe WP,Segoe UI,sans-serif}.msla-host-flow-template .msla-html-editor .rdw-link-modal,.msla-host-processsimple .msla-html-editor .rdw-link-modal{z-index:1000}.msla-host-flow-template .msla-html-editor .rdw-link-modal label,.msla-host-processsimple .msla-html-editor .rdw-link-modal label{margin:0;padding:0}.msla-host-flow-template .msla-card-config-item .ms-Stack,.msla-host-flow-template .msla-card-config-item .msla-checkbox,.msla-host-flow-template .msla-card-config-item .msla-combobox-container,.msla-host-flow-template .msla-card-config-item .msla-dropdown-container,.msla-host-flow-template .msla-card-config-item .msla-textbox,.msla-host-processsimple .msla-card-config-item .ms-Stack,.msla-host-processsimple .msla-card-config-item .msla-checkbox,.msla-host-processsimple .msla-card-config-item .msla-combobox-container,.msla-host-processsimple .msla-card-config-item .msla-dropdown-container,.msla-host-processsimple .msla-card-config-item .msla-textbox{width:100%}.msla-host-flow-template .msla-recurrence-parameters-container .msla-input-parameters-list,.msla-host-processsimple .msla-recurrence-parameters-container .msla-input-parameters-list{display:block}.msla-host-flow-template .msla-recurrence-parameters-container .msla-input-parameters-list .msla-input-parameter-inline-item,.msla-host-processsimple .msla-recurrence-parameters-container .msla-input-parameters-list .msla-input-parameter-inline-item{display:-ms-inline-flexbox;display:inline-flex}.msla-host-flow-template .msla-dynamic-added-param-inputs-container,.msla-host-processsimple .msla-dynamic-added-param-inputs-container{min-width:0}.msla-host-flow-template .msla-dynamic-added-param-inputs-container .msla-editor-input-control,.msla-host-flow-template .msla-dynamic-added-param-inputs-container .msla-input-control,.msla-host-processsimple .msla-dynamic-added-param-inputs-container .msla-editor-input-control,.msla-host-processsimple .msla-dynamic-added-param-inputs-container .msla-input-control{width:100%}.msla-host-flow-template .msla-input-parameters-body .msla-token-recommendation-v2,.msla-host-processsimple .msla-input-parameters-body .msla-token-recommendation-v2{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}.msla-host-flow-template .msla-html-codeview-editor .msla-input-parameter-error,.msla-host-processsimple .msla-html-codeview-editor .msla-input-parameter-error{margin-bottom:-16px}.msla-host-flow-template .msla-html-codeview-editor .msla-token-recommendation-v2,.msla-host-processsimple .msla-html-codeview-editor .msla-token-recommendation-v2{margin-bottom:-20px}.msla-host-flow-template .msla-card-expression-builder .msla-input-parameter,.msla-host-processsimple .msla-card-expression-builder .msla-input-parameter{max-width:690px}.msla-host-flow-template .msla-card-expression-builder .msla-input-parameter-label,.msla-host-processsimple .msla-card-expression-builder .msla-input-parameter-label{font-size:14px;font-weight:700;margin-bottom:2px}.msla-host-flow-template .msla-card-expression-builder .msla-input-parameter-content-wrapper,.msla-host-processsimple .msla-card-expression-builder .msla-input-parameter-content-wrapper{-ms-flex-preferred-size:100%;flex-basis:100%}.widget .msla-host-flow-template .msla-connection-container-body,.widget .msla-host-processsimple .msla-connection-container-body{max-height:none}.ms-Callout-container .msla-card-menu-item-button-title[data-disabled=true]{color:#767676}.ms-Callout-container .msla-dropdown-option{overflow:hidden}.ms-Callout-container .msla-dropdown-option>span{overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.ms-ContextualMenu>.ms-ContextualMenu-list{line-height:normal}.flow-run-only-tile .row+.row{margin-top:0}.flow-run-only-tile .info-pane .pane-section .run-tile-sharepoint-section{margin-bottom:30px}.flow-run-only-tile .run-tile-sharepoint-section .info-card-text-section{width:calc(100% - 100px);max-width:none}.flow-run-only-tile .pane-content .run-only-tabs a{font-size:15px;margin:0 8px 10px 0;display:inline-block;color:#333;cursor:pointer}.flow-run-only-tile .pane-content .run-only-tabs a.tab-active{font-size:15px;color:#06f;padding-bottom:5px;font-weight:600;border-bottom:3px solid #06f}.flow-run-only-tile .pane-content .run-only-tabs a.tab-active:focus{outline:none}.flow-run-only-tile .run-tile-graph-container{margin-bottom:20px}.flow-run-only-tile .run-tile-graph-container .pane-alert{padding:5px}.flow-run-only-tile .run-tile-sharepoint-container{margin-bottom:20px}.flow-run-only-tile .run-tile-sharepoint-container select{margin-top:5px;width:100%}.flow-run-only-tile .run-tile-sharepoint-container .dropdown-label{margin-top:5px}.flow-run-only-tile .run-tile-sharepoint-container .pane-alert{padding:5px}.flow-run-only-tile .pane-actions{border-top:1px solid grey;width:100%}.flow-run-only-tile .pane-actions button{margin:20px 10px 0 0}.flow-run-only-tile .option-block{margin:0;padding:0;border:0;background-color:transparent}.flow-run-only-tile .info-card-container{position:relative}.flow-run-only-tile .info-card-container.disabled:after{background-color:#fff;content:"";height:100%;position:absolute;width:90%;top:0;opacity:.7;margin-left:-4%}.flow-run-only-tile .connection-card-container .info-card-text-section{width:calc(100% - 50px);max-width:none}.flow-run-only-tile .connection-card-container .info-card-text-section .info-card-subtitle{color:#5e5e5e;font-size:13px;font-weight:400;white-space:normal}.flow-run-only-tile .connection-card-container .info-card-options{float:none}.flow-run-only-tile .connection-card-container .info-card-options .card-option{padding:0 10px 0 0;width:100%}.flow-run-only-tile .connection-card-container .info-card-options select{font-size:13px;margin-top:12px;width:100%}.flow-run-only-tile .connection-card-container img{margin-top:8px}.flow-run-only-tile .connection-warning-message{background-color:#fed9cc;margin-left:0;margin-top:8px;width:100%}.flow-run-only-tile .connection-warning-message .c-glyph{margin-top:4px}.flow-run-only-tile .connection-warning-message .icon-column{margin-left:0;width:16px}.flow-run-only-tile .connection-warning-message p{padding-top:2px;font-size:13px}.flow-run-only-tile .flow-runonly-section-react-text-message-bar{padding-bottom:20px;margin-top:-10px}.flow-run-only-tile .ng-modal .ng-modal-dialog .ng-modal-dialog-footer-content{padding-top:20px}.section-flow-save-as-dialog .flow-save-as-dialog-content{min-height:210px;padding:20px}.section-flow-save-as-dialog .flow-save-as-dialog-content .msla-connectionwizard-canvas{min-height:200px}.section-flow-save-as-dialog .create-connection-description,.section-flow-save-as-dialog .flow-save-as-description{font-weight:lighter;font-size:16px;position:relative;padding-top:0;padding-bottom:0;min-height:16px;margin-top:15px;margin-bottom:15px}.section-flow-save-as-dialog .create-connection-description{margin-top:0}.section-flow-save-as-dialog .alert-container{margin-bottom:20px}.section-flow-save-as-dialog input[type=text]{width:100%;border:1px solid grey;font-size:16px;-o-text-overflow:ellipsis;text-overflow:ellipsis;margin:0 0 15px}.section-flow-save-as-dialog input[type=text]:focus:not(:-moz-read-only){border:1px solid #005fcb}.section-flow-save-as-dialog input[type=text]:focus:not(:read-only){border:1px solid #005fcb}.section-flow-save-as-dialog input[type=text]:-moz-read-only{background-color:#fff}.section-flow-save-as-dialog input[type=text]:read-only{background-color:#fff}.section-flow-save-as-dialog .ng-modal-dialog{padding-left:3px;padding-right:3px}.section-flow-save-as-dialog .ng-modal-close{position:absolute;top:3px;right:5px;padding:5px;cursor:pointer;font-size:120%;display:inline-block}.section-flow-save-as-dialog .ng-modal-close:hover{color:#06f}.connection-disambiguation{margin-top:24px}.connection-disambiguation .msla-selector.msla-selector-shadow{max-height:15vh;overflow-y:auto}.connection-disambiguation .header-message{margin-bottom:10px}.connection-disambiguation .header-message .header-message-run-only-title{font-weight:600}.connection-disambiguation .full-designer-mode.hide-continue-button{padding-bottom:0}.connection-disambiguation .full-designer-mode.hide-continue-button .msla-connection-container-footer .msla-connection-continue-button{display:none}.connection-disambiguation .diet-designer-mode,.connection-disambiguation .diet-designer-mode .msla-container{padding:0}.connection-disambiguation .diet-designer-mode .msla-connection-container{max-width:100%}.connection-disambiguation .diet-designer-mode .msla-connectionwizard-canvas{min-height:0;max-width:100%}.connection-disambiguation .diet-designer-mode .msla-card-caption{padding:0}.connection-disambiguation .diet-designer-mode .msla-connection-container-footer .msla-connection-continue-button{height:32px;line-height:100%;font-size:14px;font-weight:400;font-weight:600}.connection-disambiguation .diet-designer-mode .msla-connection-selector{padding:0}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-icon{padding:8px}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-icon img{width:48px;height:48px}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-options{width:100%;padding:4px}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-options .msla-connection-create-button{width:100%}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-connection{padding:4px;width:calc(100% - 72px)}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-connection .msla-connection-display-name{font-size:12px;font-weight:400;color:#666}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-connection .msla-connection-selector-options{padding:0}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-connection .msla-connection-selector-options .msla-connection-switch-link,.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-connection .msla-connection-selector-options .msla-connection-view-permissions-link{font-size:12px;font-weight:400}.connection-disambiguation .diet-designer-mode .msla-connection-selector .msla-connection-selector-connector-name{height:auto;font-size:14px;font-weight:400}.connection-disambiguation .diet-designer-mode.hide-connection-options .msla-connection-container-body .msla-connection-selector-options,.connection-disambiguation .diet-designer-mode.hide-continue-button .msla-connection-container-footer .msla-connection-continue-button,.connection-disambiguation .diet-designer-mode.hide-view-permissions-link .msla-connection-selector-options .msla-connection-view-permissions-link{display:none}.connection-disambiguation .diet-designer-mode .msla-drop-zone{height:0}.connection-wizard .connection-wizard-container{max-width:600px;margin:auto}.load-current-env-error-section{max-width:600px;margin:auto}.ai-builder-trial-message-bar,.load-current-env-error-section{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center}.ai-builder-trial-message-bar{padding-bottom:20px;margin:-10px auto auto}.ai-builder-trial-message-bar react-text-message-bar,.ai-builder-trial-message-bar react-text-message-bar-with-link{min-width:700px}.ai-builder-trial-message-bar .ms-Link{margin-left:-6px}.cds-provisioning-section{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center}.cds-provisioning-section react-text-message-bar{padding-bottom:20px}.cds-provisioning-section react-button-group{padding-top:20px}.templateManager{text-align:center}.context-template-detail{position:relative;padding-bottom:60px;text-align:center;background-color:#e3e3e3;margin-bottom:36px}.context-template-detail>.row>.column>.c-heading-3,.context-template-detail>.row>.column>.c-paragraph-2{max-width:320px;margin:0 auto}.context-template-detail>.row>.column>.c-paragraph-2{text-align:left}.context-template-detail>.row:last-child a.c-button[role=button]{display:block;margin-left:auto;margin-right:auto;max-width:320px;font-size:18px;font-weight:200;line-height:23px;color:#fff;background-color:#06f}.context-template-detail>.row:last-child a.c-button[role=button]:focus,.context-template-detail>.row:last-child a.c-button[role=button]:hover{background-color:#005fcb;border-color:rgba(0,0,0,.4)}.context-template-detail>.row:last-child a.c-button[role=button]:active{background-color:#005fcb;border-color:transparent}.context-template-detail>.row:last-child a.c-button[role=button][disabled]{color:rgba(0,0,0,.2);background-color:rgba(0,120,215,.2);border-color:transparent}.context-template-detail>.row>.column>h1,.context-template-detail>.row>.column>p{max-width:320px;margin:0 auto}@media only screen and (min-width:768px){.context-template-detail>.row>.column>.c-heading-3{max-width:792px}.context-template-detail>.row>.column>.c-paragraph-2{max-width:550px}.context-template-detail>.row:last-child{max-width:none}.context-template-detail>.row:last-child a.c-button[role=button]{font-size:20px}}.context-template-detail a.template-use-flow-button[role=button]{outline:0}.context-template-detail a.template-use-flow-button[role=button]:focus{outline:1px dashed #000}.extend-trial-dialog .btn-primary,.trial-expired .btn-primary,.trial-extended-dialog .btn-primary{background-color:#06f;color:#fff}.extend-trial-dialog .c-button,.trial-expired .c-button,.trial-extended-dialog .c-button{min-width:150px}.extend-trial-dialog [role=dialog],.trial-expired [role=dialog],.trial-extended-dialog [role=dialog]{width:80%;max-height:100vh}.extend-trial-dialog [role=presentation],.trial-extended-dialog [role=presentation]{background-color:rgba(0,0,0,.6)}.trial-expired{text-align:center}.trial-expired .heading{padding:20px}.trial-expired .heading a{color:#06f}.trial-expired .heading a:hover{text-decoration:underline}.trial-expired .heading h1{margin:20px 0 5px;padding:0}.trial-expired .heading p{margin:0 0 20px;padding:0}.trial-expired .empty-space{height:40vh;background-size:cover}.trial-expired .empty-space img{height:40vh;width:100%;-o-object-fit:cover;object-fit:cover}.trial-expired .option h1{padding:0;margin-bottom:20px}.trial-expired .option .error{padding:0 0 10px;color:#ef3a24}@media only screen and (min-width:480px){.trial-expired .options{padding:30px}.trial-expired .options .option{padding:90px 0}}@media only screen and (min-width:480px){.trial-expired .medium-6:first-child{border-right:1px solid #000}}.extend-trial-dialog [role=dialog]{padding:35px;max-width:700px}.extend-trial-dialog h1{padding:0}.extend-trial-dialog label{padding:0;margin:20px 0 10px;font-weight:400}.extend-trial-dialog input,.extend-trial-dialog select,.extend-trial-dialog textarea{width:100%;border:1px solid #c8c8c8;padding:5px 10px}.extend-trial-dialog textarea{display:block;height:150px;resize:none;margin-bottom:30px}.extend-trial-dialog .buttons{text-align:right}.extend-trial-dialog .c-select{max-width:none}.extend-trial-dialog .heading{margin-bottom:36px}.trial-extended-dialog [role=dialog]{border:none;padding:0;width:80%;max-width:800px}.trial-extended-dialog [role=dialog] p{padding:0}.trial-extended-dialog svg{width:30px;margin-right:20px;vertical-align:middle}.trial-extended-dialog p{display:inline-block;vertical-align:middle}.trial-extended-dialog button{margin-top:5px;float:right}.trial-extended-dialog .content{padding:20px 50px}.trial-extended-dialog .content:after,.trial-extended-dialog .content:before{content:" ";display:table}.trial-extended-dialog .content:after{clear:both}.trial-extended-dialog .empty-space{height:200px;background-size:cover}.trial-extended-dialog .empty-space img{height:200px;width:100%;-o-object-fit:cover;object-fit:cover}.trial-dialog a{color:#06f}.trial-dialog [role=dialog]{width:90%;padding:0;max-height:500px;z-index:1000;border:none}.trial-dialog [role=presentation]{z-index:1000;background-color:rgba(0,0,0,.7)}.trial-dialog .trial-dialog-header{background-color:#fff}.trial-dialog .trial-dialog-header h3{padding:12px;text-align:center;font-size:24px;font-weight:600}.trial-dialog .trial-dialog-header .trial-dialog-header-image{padding-top:48px}.trial-dialog .trial-dialog-header .trial-dialog-header-image img{height:40px}.trial-dialog .trial-dialog-header .trial-dialog-header-image i{color:#06f;font-size:48px}.trial-dialog .trial-dialog-content{text-align:center;padding:0 74px;font-size:14px}@media only screen and (max-width:480px){.trial-dialog .trial-dialog-content{padding:0 30px}}.trial-dialog .trial-dialog-action{padding:20px}.trial-dialog .trial-dialog-action .trial-dialog-action-button-group{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-direction:row;flex-direction:row;font-size:14px;font-weight:600}.trial-dialog .trial-dialog-action button:first-of-type{margin-right:10px;margin-top:12px;background-color:#06f;color:#fff}.trial-dialog .trial-dialog-action button:not(first-of-type){margin-right:0;background-color:#fff;border:1px solid #666;color:#333}@media only screen and (max-width:480px){.trial-dialog .trial-dialog-action{padding:20px 0}}.trial-dialog .trial-dialog-action [role=button]{width:196px;margin:0}.trial-dialog .trial-dialog-action .trial-dialog-action-footer{padding-bottom:20px;font-size:12px}.context-manage-create-connection .c-select{width:276px}.debug-summary-pane .icon-column{width:20px}.debug-summary-pane .ps-list-item{border:0;padding-top:40px}.debug-summary-pane .ps-list-item:first-child{padding-top:0}.debug-summary-pane svg{width:20px;height:20px}.debug-summary-pane .support-title{padding:0;color:#333;font-size:14px;font-weight:500}.debug-summary-pane .support-message{margin-top:0}.debug-summary-pane .support-message p{color:#767676;font-size:14px;padding-top:8px;padding-bottom:20px}.debug-summary-pane .support-message a{color:#06f}.debug-summary-pane--new .info-pane.static-pane{top:48px}react-remediation-pane>.ms-Fabric{height:100%}.invoke-flow-page .row{max-width:768px}@media only screen and (min-width:480px){.full-page-single-action{padding-top:200px}}.full-page-single-action img.flow-logo-image{margin-top:24px;height:56px;width:72px}.full-page-single-action .full-page-single-action-header{font-family:Segoe UI Light,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif;color:#333;padding:24px 0 0}.full-page-single-action button.full-page-single-action-button{margin-top:40px;padding:12px;width:188px;font-family:Segoe UI,Segoe WP,Tahoma,Arial,sans-serif;font-size:14px}.invoke-flow-form{padding:16px}.invoke-flow-form .flow-header{padding:0 0 24px}.invoke-flow-form .flow-details-spinner-container{height:175px}.invoke-flow-form .invoke-flow-form-body{margin-top:12px}.invoke-flow-form .invoke-flow-form-body .additional-inputs-info{overflow-x:hidden;overflow-y:auto;padding-right:5px;max-height:600px}.invoke-flow-form .invoke-flow-form-body .no-additional-input-text{font-size:14px;font-weight:400}.invoke-flow-form .dialog-buttons{padding-top:20px}.invoke-flow-form .alert-container{margin-bottom:16px}.invoke-flow-form .flow-run-request-completion-content{text-align:center}.invoke-flow-form .flow-run-request-completion-content .ms-Icon{font-size:60px;margin-top:40px;margin-bottom:25px}.invoke-flow-form .flow-run-request-completion-content .mobile-icon{padding:30px}.invoke-flow-form .flow-run-request-completion-content p{padding-top:10px}.invoke-flow-form .flow-run-request-completion-content .flow-run-activity{color:#06f}.invoke-flow-form .flow-run-request-completion-content .dialog-buttons{padding-top:20px}.invoke-flow-form .flow-run-request-completion-content .dialog-buttons button{float:none;display:block;margin:0 auto}.invoke-flow-form .edit-button{border:none;background:none;vertical-align:center;font-size:12px;font-weight:400}.invoke-flow-form .edit-button:focus,.invoke-flow-form .edit-button:hover{color:#06f;outline:none}.invoke-flow-form .c-glyph:before{color:#06f;margin-right:6px}.invoke-flow-form .full-width-button{width:100%}.invoke-flow-form .full-width-button button{width:100%;margin-top:24px}.invoke-flow-form .designerload-spinner-container,.invoke-flow-form .inputParameterForm,.invoke-flow-form .no-additional-input-text-wrapper{margin-top:12px}.ng-modal .modal-spinner-container{min-height:300px}.ng-modal .invoke-flow-form .additional-inputs-info{max-height:300px}@media only screen and (max-width:480px){.widget .invoke-flow-form{padding-bottom:0}}.widget .invoke-flow-form .see-details-divider{margin:16px 0;height:1px;background-color:#eaeaea;border:0}.widget .invoke-flow-form .scroll-content{max-height:calc(100vh - 350px);min-height:70px;overflow-y:auto}.widget .invoke-flow-form .invoke-flow-form-body{max-height:unset}@media only screen and (max-width:480px){.widget .invoke-flow-form .invoke-flow-form-body{margin-top:0}}.widget .invoke-flow-form .invoke-flow-form-body .dialog-buttons button{float:left;margin:0}@media only screen and (max-width:480px){.widget .invoke-flow-form .invoke-flow-form-body .dialog-buttons button{min-width:calc(50% - 6px)}}.widget .invoke-flow-form .invoke-flow-form-body .dialog-buttons .dialog-button:not(:last-child){margin-right:12px}.widget .invoke-flow-form .flow-run-data table th{padding:30px 0 10px}.widget .invoke-flow-form .flow-run-data table tbody tr,.widget .invoke-flow-form .flow-run-data table td{height:35px}.widget .invoke-flow-form .widget-footer{padding-top:24px;position:relative}.widget .invoke-flow-form .widget-footer .widget-consent{margin:16px 16px 16px 0;display:block}.widget .invoke-flow-form .widget-footer .edit-button{font-size:12px}.widget .invoke-flow-form .widget-footer .para-microsoft-flow{font-size:12px;color:#767676;padding:0 0 16px}.widget .invoke-flow-form .widget-footer .para-microsoft-flow a{color:#06f}.horizontalContactCard{display:inline-block;width:100%;-ms-flex-align:center;align-items:center;background-color:#fff;-webkit-box-shadow:0 0 4px 0 rgba(0,0,0,.1);box-shadow:0 0 4px 0 rgba(0,0,0,.1);border:1px solid #eaeaea;*zoom:1}.horizontalContactCard .horizontalContactCard-iconContainer{float:left}.horizontalContactCard .horizontalContactCard-iconContainer .context-icon-template{height:74px;width:74px}@media only screen and (max-width:480px){.horizontalContactCard .horizontalContactCard-iconContainer .context-icon-template{height:90px;width:90px}}.horizontalContactCard .horizontalContactCard-textContainer{height:74px;position:relative}@media only screen and (max-width:480px){.horizontalContactCard .horizontalContactCard-textContainer{height:90px}}.horizontalContactCard .horizontalContactCard-primaryText{display:block;display:-webkit-box;-webkit-line-clamp:2;max-height:38.66666667px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal;font-size:14px;line-height:19.33333333px;padding:0;word-break:break-all;word-break:break-word;word-wrap:break-word}@media only screen and (max-width:480px){.horizontalContactCard .horizontalContactCard-primaryText{display:block;display:-webkit-box;-webkit-line-clamp:2;max-height:37px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal;line-height:18.5px}}.horizontalContactCard .horizontalContactCard-secondaryText{display:block;display:-webkit-box;-webkit-line-clamp:1;max-height:19.33333333px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal;font-size:12px;padding:0;line-height:19.33333333px;color:#767676;word-break:break-all;word-break:break-word;word-wrap:break-word}@media only screen and (max-width:480px){.horizontalContactCard .horizontalContactCard-secondaryText{display:block;display:-webkit-box;-webkit-line-clamp:2;max-height:37px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:normal;line-height:18.5px}}.horizontalContactCard .horizontalContactCard-innerTextContainer{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);padding:8px 16px;min-width:0;overflow:hidden;left:74px}@media only screen and (max-width:480px){.horizontalContactCard .horizontalContactCard-innerTextContainer{padding:8px 16px;left:90px}}.horizontalContactCard:after,.horizontalContactCard:before{display:table;content:"";line-height:0}.horizontalContactCard:after{clear:both}.flowDetails .flowDetails-title{cursor:pointer;margin-top:12px}.flowDetails .flowDetails-title-text{font-size:14px;color:#333}.flowDetails .flowDetails-title-icon{padding-right:6px;float:right;color:#767676}.flowDetails .flowDetails-content{margin:12px 0;background-color:transparent;font-size:14px;color:#333;text-align:left}.flowDetails .flowDetails-description{font-size:14px;padding:0 0 24px;word-break:break-all;word-break:break-word;word-wrap:break-word;color:#767676}.flowDetails .flowDetails-infoCard{padding:4px;display:inline-block}.flowDetails .flowDetails-infoCard-iconContainer{padding:0;margin:0 10px 0 0;float:left}.flowDetails .flowDetails-infoCard-icon{height:50px;width:50px}.flowDetails .flowDetails-permissionsSection{padding-bottom:24px}.flowDetails .flowDetails-permissionTitle{font-size:14px;word-break:break-all;word-break:break-word;word-wrap:break-word;color:#333}.flowDetails .flowDetails-permissions{list-style-type:circle;padding-left:28px}.flowDetails .flowDetails-permission{display:list-item;color:#767676;word-break:break-all;word-break:break-word;word-wrap:break-word}.flowDetails .flowDetails-permission--bold{font-weight:600}.flowDetails .flowDetails-permissionSubtext{font-size:14px;padding:8px 0 0;word-break:break-all;word-break:break-word;word-wrap:break-word;color:#333}.flowDetails .flowDetails-infoCard-textContainer{margin:0;padding:0;width:calc(100% - 60px);float:left}.flowDetails .flowDetails-infoCard-description{color:#767676;word-break:break-all;word-break:break-word;word-wrap:break-word}.flowDetails .flowDetails-infoCard-description--bold{font-weight:600}.flowDetails .flowDetails-infoCard-label{color:#333}.inputParameterForm .inputParameterForm-inputParameter{padding-top:12px}.inputParameterForm .inputParameterForm-inputParameter--first{padding-top:0}.inputParameterForm .inputParameterForm-enumContainer{margin-top:0;max-width:100%}.inputParameterForm .inputParameterForm-enum{border:1px solid;height:32px;padding:0 12px}.inputParameterForm input.c-text-field[type=text]{border:1px solid;margin-top:0;width:100%;height:32px;padding:0 12px}.inputParameterForm .inputParameterForm-autoCompleteContainer input{height:32px;margin-top:0;border:1px solid}.email-display-component{margin-top:8px}.email-display-component .email-block{font-size:13px;display:-ms-inline-flexbox;display:inline-flex;background:#f4f4f4;color:#333;border-radius:15px;cursor:default;margin:4px;max-width:300px;padding:4px}.email-display-component .email-block:hover{background:#eaeaea}.email-display-component .email-text{border:0;display:block;padding:0 8px;text-align:left;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap;float:left;overflow:hidden;max-width:180px}.email-display-component .email-delete{background-color:transparent;border:1px solid transparent;-webkit-border-image:initial;-o-border-image:initial;border-image:initial;border-radius:50%;cursor:pointer;font-size:11px;padding:2px 3px 0}.email-display-component .c-glyph:before{background:transparent;color:#333;margin-right:0}.email-display-component .email-delete:hover{background:#c8c8c8;color:#212121}.filePicker .filePicker-selectedFileContainer{width:calc(100% - 36px);float:left}.filePicker .filePicker-selectedFileInput{height:.1px;width:.1px;opacity:0;z-index:-1;position:absolute;overflow:hidden;display:initial;border:1px solid}.filePicker input.c-text-field[type=text][readonly]{background:#fff;margin:0;height:32px;width:100%;padding:0 12px;border:1px solid}.filePicker .filePicker-fileInputIconContainer{width:32px;height:32px;float:left}.filePicker .filePicker-fileInputIconLabel{margin:0;padding:0;width:100%;height:100%;cursor:pointer}.filePicker .filePicker-fileInputIcon{margin:8px;height:16px;width:16px}.filePicker:after,.filePicker:before{content:" ";display:table}.filePicker:after{clear:both}.widget-consent .email-consent-input,.widget-consent .email-consent-not-required-text,.widget-consent .terms-and-conditions{margin-bottom:10px;padding:0}.widget-consent .email-consent-input{font-size:12px}.widget-consent .fine-print{font-size:12px;color:#767676}.widget-consent .fine-print.privacy-link,.widget-consent .fine-print a{color:#06f}.widget-consent .msla-connectionwizard-canvas{min-height:0}',""]),t.locals={hide:"hide","hide-for-small-only":"hide-for-small-only",hideForSmallOnly:"hide-for-small-only","hide-for-small-up":"hide-for-small-up",hideForSmallUp:"hide-for-small-up","show-for-large-only":"show-for-large-only",showForLargeOnly:"show-for-large-only","show-for-large-up":"show-for-large-up",showForLargeUp:"show-for-large-up","show-for-medium-only":"show-for-medium-only",showForMediumOnly:"show-for-medium-only","show-for-medium-up":"show-for-medium-up",showForMediumUp:"show-for-medium-up","hide-for-large-only":"hide-for-large-only",hideForLargeOnly:"hide-for-large-only","hide-for-large-up":"hide-for-large-up",hideForLargeUp:"hide-for-large-up","hide-for-medium-only":"hide-for-medium-only",hideForMediumOnly:"hide-for-medium-only","hide-for-medium-up":"hide-for-medium-up",hideForMediumUp:"hide-for-medium-up","show-for-small-only":"show-for-small-only",showForSmallOnly:"show-for-small-only","show-for-small-up":"show-for-small-up",showForSmallUp:"show-for-small-up",container:"container",section:"section",row:"row","row-divided":"row-divided",rowDivided:"row-divided",column:"column","row-none":"row-none",rowNone:"row-none","row-tiny":"row-tiny",rowTiny:"row-tiny","row-little":"row-little",rowLittle:"row-little","row-small":"row-small",rowSmall:"row-small","row-normal":"row-normal",rowNormal:"row-normal","row-large":"row-large",rowLarge:"row-large","small-12":"small-12",small12:"small-12","small-11":"small-11",small11:"small-11","small-10":"small-10",small10:"small-10","small-9":"small-9",small9:"small-9","small-8":"small-8",small8:"small-8","small-7":"small-7",small7:"small-7","small-6":"small-6",small6:"small-6","small-5":"small-5",small5:"small-5","small-4":"small-4",small4:"small-4","small-3":"small-3",small3:"small-3","small-2":"small-2",small2:"small-2","small-1":"small-1",small1:"small-1","small-offset-12":"small-offset-12",smallOffset12:"small-offset-12","small-offset-11":"small-offset-11",smallOffset11:"small-offset-11","small-offset-10":"small-offset-10",smallOffset10:"small-offset-10","small-offset-9":"small-offset-9",smallOffset9:"small-offset-9","small-offset-8":"small-offset-8",smallOffset8:"small-offset-8","small-offset-7":"small-offset-7",smallOffset7:"small-offset-7","small-offset-6":"small-offset-6",smallOffset6:"small-offset-6","small-offset-5":"small-offset-5",smallOffset5:"small-offset-5","small-offset-4":"small-offset-4",smallOffset4:"small-offset-4","small-offset-3":"small-offset-3",smallOffset3:"small-offset-3","small-offset-2":"small-offset-2",smallOffset2:"small-offset-2","small-offset-1":"small-offset-1",smallOffset1:"small-offset-1","small-offset-0":"small-offset-0",smallOffset0:"small-offset-0","small-centered":"small-centered",smallCentered:"small-centered","medium-12":"medium-12",medium12:"medium-12","medium-11":"medium-11",medium11:"medium-11","medium-10":"medium-10",medium10:"medium-10","medium-9":"medium-9",medium9:"medium-9","medium-8":"medium-8",medium8:"medium-8","medium-7":"medium-7",medium7:"medium-7","medium-6":"medium-6",medium6:"medium-6","medium-5":"medium-5",medium5:"medium-5","medium-4":"medium-4",medium4:"medium-4","medium-3":"medium-3",medium3:"medium-3","medium-2":"medium-2",medium2:"medium-2","medium-1":"medium-1",medium1:"medium-1","medium-offset-12":"medium-offset-12",mediumOffset12:"medium-offset-12","medium-offset-11":"medium-offset-11",mediumOffset11:"medium-offset-11","medium-offset-10":"medium-offset-10",mediumOffset10:"medium-offset-10","medium-offset-9":"medium-offset-9",mediumOffset9:"medium-offset-9","medium-offset-8":"medium-offset-8",mediumOffset8:"medium-offset-8","medium-offset-7":"medium-offset-7",mediumOffset7:"medium-offset-7","medium-offset-6":"medium-offset-6",mediumOffset6:"medium-offset-6","medium-offset-5":"medium-offset-5",mediumOffset5:"medium-offset-5","medium-offset-4":"medium-offset-4",mediumOffset4:"medium-offset-4","medium-offset-3":"medium-offset-3",mediumOffset3:"medium-offset-3","medium-offset-2":"medium-offset-2",mediumOffset2:"medium-offset-2","medium-offset-1":"medium-offset-1",mediumOffset1:"medium-offset-1","medium-offset-0":"medium-offset-0",mediumOffset0:"medium-offset-0","medium-centered":"medium-centered",mediumCentered:"medium-centered","row-middled":"row-middled",rowMiddled:"row-middled","large-12":"large-12",large12:"large-12","large-11":"large-11",large11:"large-11","large-10":"large-10",large10:"large-10","large-9":"large-9",large9:"large-9","large-8":"large-8",large8:"large-8","large-7":"large-7",large7:"large-7","large-6":"large-6",large6:"large-6","large-5":"large-5",large5:"large-5","large-4":"large-4",large4:"large-4","large-3":"large-3",large3:"large-3","large-2":"large-2",large2:"large-2","large-1":"large-1",large1:"large-1","large-offset-12":"large-offset-12",largeOffset12:"large-offset-12","large-offset-11":"large-offset-11",largeOffset11:"large-offset-11","large-offset-10":"large-offset-10",largeOffset10:"large-offset-10","large-offset-9":"large-offset-9",largeOffset9:"large-offset-9","large-offset-8":"large-offset-8",largeOffset8:"large-offset-8","large-offset-7":"large-offset-7",largeOffset7:"large-offset-7","large-offset-6":"large-offset-6",largeOffset6:"large-offset-6","large-offset-5":"large-offset-5",largeOffset5:"large-offset-5","large-offset-4":"large-offset-4",largeOffset4:"large-offset-4","large-offset-3":"large-offset-3",largeOffset3:"large-offset-3","large-offset-2":"large-offset-2",largeOffset2:"large-offset-2","large-offset-1":"large-offset-1",largeOffset1:"large-offset-1","large-offset-0":"large-offset-0",largeOffset0:"large-offset-0","large-centered":"large-centered",largeCentered:"large-centered",toggled:"toggled",open:"open","subsection-manage":"subsection-manage",subsectionManage:"subsection-manage",heading:"heading","heading-buttons":"heading-buttons",headingButtons:"heading-buttons",btn:"btn","c-button":"c-button",cButton:"c-button","context-activity-feed":"context-activity-feed",contextActivityFeed:"context-activity-feed","activityfeed-timeheading":"activityfeed-timeheading",activityfeedTimeheading:"activityfeed-timeheading","activityfeed-item-imageholder":"activityfeed-item-imageholder",activityfeedItemImageholder:"activityfeed-item-imageholder","activityfeed-item-description":"activityfeed-item-description",activityfeedItemDescription:"activityfeed-item-description","activityfeed-item-timesince":"activityfeed-item-timesince",activityfeedItemTimesince:"activityfeed-item-timesince","activityfeed-showmore":"activityfeed-showmore",activityfeedShowmore:"activityfeed-showmore","context-manage-activityfeed":"context-manage-activityfeed",contextManageActivityfeed:"context-manage-activityfeed","activityfeed-search":"activityfeed-search",activityfeedSearch:"activityfeed-search","context-zero-custom-apis":"context-zero-custom-apis",contextZeroCustomApis:"context-zero-custom-apis","custom-api-text-inline":"custom-api-text-inline",customApiTextInline:"custom-api-text-inline","zero-custom-api-image":"zero-custom-api-image",zeroCustomApiImage:"zero-custom-api-image","section-manage-apis":"section-manage-apis",sectionManageApis:"section-manage-apis","custom-apis-body":"custom-apis-body",customApisBody:"custom-apis-body","content-header":"content-header",contentHeader:"content-header","heading-container":"heading-container",headingContainer:"heading-container","api-list-tbody":"api-list-tbody",apiListTbody:"api-list-tbody","text-ellipse":"text-ellipse",textEllipse:"text-ellipse","command-button":"command-button",commandButton:"command-button","c-glyph":"c-glyph",cGlyph:"c-glyph","dropdown-content":"dropdown-content",dropdownContent:"dropdown-content","context-glyph-tile":"context-glyph-tile",contextGlyphTile:"context-glyph-tile","ms-TooltipHost":"ms-TooltipHost",msTooltipHost:"ms-TooltipHost","command-item":"command-item",commandItem:"command-item","disable-card-overlay":"disable-card-overlay",disableCardOverlay:"disable-card-overlay",selected:"selected","approval-card":"approval-card",approvalCard:"approval-card","card-selected":"card-selected",cardSelected:"card-selected",avatar:"avatar","avatars-list-item":"avatars-list-item",avatarsListItem:"avatars-list-item","grey-circle-count":"grey-circle-count",greyCircleCount:"grey-circle-count",title:"title","due-date":"due-date",dueDate:"due-date","c-paragraph-3":"c-paragraph-3",cParagraph3:"c-paragraph-3","thumbnail-photos":"thumbnail-photos",thumbnailPhotos:"thumbnail-photos","approver-names":"approver-names",approverNames:"approver-names",actions:"actions","status-text":"status-text",statusText:"status-text","respond-icon":"respond-icon",respondIcon:"respond-icon","action-button":"action-button",actionButton:"action-button","dropdown-block":"dropdown-block",dropdownBlock:"dropdown-block","dropdown-item":"dropdown-item",dropdownItem:"dropdown-item","blue-circle":"blue-circle",blueCircle:"blue-circle","c-action-trigger":"c-action-trigger",cActionTrigger:"c-action-trigger","approval-center":"approval-center",approvalCenter:"approval-center","approval-center-content":"approval-center-content",approvalCenterContent:"approval-center-content","first-day-approvals":"first-day-approvals",firstDayApprovals:"first-day-approvals","first-day-approvals-content":"first-day-approvals-content",firstDayApprovalsContent:"first-day-approvals-content","c-content":"c-content",cContent:"c-content","c-heading-6":"c-heading-6",cHeading6:"c-heading-6","c-paragraph-1":"c-paragraph-1",cParagraph1:"c-paragraph-1","img-column":"img-column",imgColumn:"img-column","f-video-button":"f-video-button",fVideoButton:"f-video-button","create-approval-button":"create-approval-button",createApprovalButton:"create-approval-button","list-section":"list-section",listSection:"list-section","card-list-item":"card-list-item",cardListItem:"card-list-item","list-container":"list-container",listContainer:"list-container","info-pane":"info-pane",infoPane:"info-pane","slide-in-pane":"slide-in-pane",slideInPane:"slide-in-pane",expanded:"expanded","pane-content":"pane-content",paneContent:"pane-content","card-disabled":"card-disabled",cardDisabled:"card-disabled","black-circle":"black-circle",blackCircle:"black-circle",confirmationIcon:"confirmationIcon","response-message":"response-message",responseMessage:"response-message",message:"message","approval-content":"approval-content",approvalContent:"approval-content","approval-container":"approval-container",approvalContainer:"approval-container",details:"details","markdown-body":"markdown-body",markdownBody:"markdown-body",link:"link","advanced-options":"advanced-options",advancedOptions:"advanced-options","advanced-options-toggle":"advanced-options-toggle",advancedOptionsToggle:"advanced-options-toggle",approveOrReject:"approveOrReject",customOptions:"customOptions","fl-DefaultButton":"fl-DefaultButton",flDefaultButton:"fl-DefaultButton",confirmSection:"confirmSection",status:"status",dropbtn:"dropbtn","bold-label":"bold-label",boldLabel:"bold-label","optional-label":"optional-label",optionalLabel:"optional-label","c-label":"c-label",cLabel:"c-label","c-paragraph-2":"c-paragraph-2",cParagraph2:"c-paragraph-2","confirmation-content":"confirmation-content",confirmationContent:"confirmation-content","alert-container":"alert-container",alertContainer:"alert-container",alert:"alert","alert-content-container":"alert-content-container",alertContentContainer:"alert-content-container","alert-content":"alert-content",alertContent:"alert-content","alert-image-container":"alert-image-container",alertImageContainer:"alert-image-container","c-progress":"c-progress",cProgress:"c-progress","f-indeterminate-local":"f-indeterminate-local",fIndeterminateLocal:"f-indeterminate-local","f-progress-small":"f-progress-small",fProgressSmall:"f-progress-small","image-container-alert-has-title":"image-container-alert-has-title",imageContainerAlertHasTitle:"image-container-alert-has-title","alert-title":"alert-title",alertTitle:"alert-title","alert-message":"alert-message",alertMessage:"alert-message","alert-close-button":"alert-close-button",alertCloseButton:"alert-close-button","alert-close-container":"alert-close-container",alertCloseContainer:"alert-close-container","sticky-error":"sticky-error",stickyError:"sticky-error","small-screen-close-button-container":"small-screen-close-button-container",smallScreenCloseButtonContainer:"small-screen-close-button-container","img-circle":"img-circle",imgCircle:"img-circle","back-button-container":"back-button-container",backButtonContainer:"back-button-container","confirm-dialog-component":"confirm-dialog-component",confirmDialogComponent:"confirm-dialog-component","ng-modal-dialog-header-content":"ng-modal-dialog-header-content",ngModalDialogHeaderContent:"ng-modal-dialog-header-content","c-heading-3":"c-heading-3",cHeading3:"c-heading-3","ng-modal-dialog-body-content":"ng-modal-dialog-body-content",ngModalDialogBodyContent:"ng-modal-dialog-body-content","dialog-buttons":"dialog-buttons",dialogButtons:"dialog-buttons","button-container":"button-container",buttonContainer:"button-container","dialog-button":"dialog-button",dialogButton:"dialog-button","spinner-content":"spinner-content",spinnerContent:"spinner-content",widget:"widget","permission-entry":"permission-entry",permissionEntry:"permission-entry","permission-photo":"permission-photo",permissionPhoto:"permission-photo","flow-icon":"flow-icon",flowIcon:"flow-icon","permission-info":"permission-info",permissionInfo:"permission-info","permission-primary-text":"permission-primary-text",permissionPrimaryText:"permission-primary-text","tenant-help":"tenant-help",tenantHelp:"tenant-help",help:"help","permission-secondary-text":"permission-secondary-text",permissionSecondaryText:"permission-secondary-text","more-link":"more-link",moreLink:"more-link",circle:"circle","absolute-center":"absolute-center",absoluteCenter:"absolute-center","full-page-error":"full-page-error",fullPageError:"full-page-error","full-page-error-image-container":"full-page-error-image-container",fullPageErrorImageContainer:"full-page-error-image-container","image-container-404":"image-container-404",imageContainer404:"image-container-404","full-page-error-title-container":"full-page-error-title-container",fullPageErrorTitleContainer:"full-page-error-title-container","full-page-error-title":"full-page-error-title",fullPageErrorTitle:"full-page-error-title","full-page-error-widget-close-button":"full-page-error-widget-close-button",fullPageErrorWidgetCloseButton:"full-page-error-widget-close-button","full-page-error-message":"full-page-error-message",fullPageErrorMessage:"full-page-error-message","full-page-error-details":"full-page-error-details",fullPageErrorDetails:"full-page-error-details","error-info-container":"error-info-container",errorInfoContainer:"error-info-container","error-info":"error-info",errorInfo:"error-info","error-detail-close-button":"error-detail-close-button",errorDetailCloseButton:"error-detail-close-button","full-page-error-button-container":"full-page-error-button-container",fullPageErrorButtonContainer:"full-page-error-button-container","heading-content":"heading-content",headingContent:"heading-content","heading-content-left":"heading-content-left",headingContentLeft:"heading-content-left","heading-content-right":"heading-content-right",headingContentRight:"heading-content-right","header-divider":"header-divider",headerDivider:"header-divider","toggle-button-text":"toggle-button-text",toggleButtonText:"toggle-button-text","heading-contextual-menu":"heading-contextual-menu",headingContextualMenu:"heading-contextual-menu","ms-Button-label":"ms-Button-label",msButtonLabel:"ms-Button-label","heading-button":"heading-button",headingButton:"heading-button","heading-button-label":"heading-button-label",headingButtonLabel:"heading-button-label","heading-link-label":"heading-link-label",headingLinkLabel:"heading-link-label","column-right":"column-right",columnRight:"column-right","heading-right":"heading-right",headingRight:"heading-right","heading-tabs":"heading-tabs",headingTabs:"heading-tabs","tab-active":"tab-active",tabActive:"tab-active","heading-spacer":"heading-spacer",headingSpacer:"heading-spacer","infoPane-overlay":"infoPane-overlay",infoPaneOverlay:"infoPane-overlay","static-pane":"static-pane",staticPane:"static-pane","glyph-arrowback":"glyph-arrowback",glyphArrowback:"glyph-arrowback","glyph-close":"glyph-close",glyphClose:"glyph-close","svg-container":"svg-container",svgContainer:"svg-container","pane-section":"pane-section",paneSection:"pane-section","pane-heading":"pane-heading",paneHeading:"pane-heading","pane-subheading":"pane-subheading",paneSubheading:"pane-subheading","pane-alert":"pane-alert",paneAlert:"pane-alert","info-pane-content":"info-pane-content",infoPaneContent:"info-pane-content","info-pane-transclude-content":"info-pane-transclude-content",infoPaneTranscludeContent:"info-pane-transclude-content","learn-more-component":"learn-more-component",learnMoreComponent:"learn-more-component","ng-modal":"ng-modal",ngModal:"ng-modal","ng-modal-overlay":"ng-modal-overlay",ngModalOverlay:"ng-modal-overlay","ng-modal-dialog":"ng-modal-dialog",ngModalDialog:"ng-modal-dialog","ng-modal-dialog-content":"ng-modal-dialog-content",ngModalDialogContent:"ng-modal-dialog-content","ng-modal-dialog-footer-content":"ng-modal-dialog-footer-content",ngModalDialogFooterContent:"ng-modal-dialog-footer-content","context-option-items":"context-option-items",contextOptionItems:"context-option-items","option-item":"option-item",optionItem:"option-item","spinner-global":"spinner-global",spinnerGlobal:"spinner-global",spinner:"spinner","spinner-local-horizontal":"spinner-local-horizontal",spinnerLocalHorizontal:"spinner-local-horizontal","dropbtn-text":"dropbtn-text",dropbtnText:"dropbtn-text",disabled:"disabled","dropdown-block-wide":"dropdown-block-wide",dropdownBlockWide:"dropdown-block-wide","large-command-panel":"large-command-panel",largeCommandPanel:"large-command-panel","child-dropdown-toggle":"child-dropdown-toggle",childDropdownToggle:"child-dropdown-toggle","command-text":"command-text",commandText:"command-text","command-container":"command-container",commandContainer:"command-container","hover-menu":"hover-menu",hoverMenu:"hover-menu","click-menu":"click-menu",clickMenu:"click-menu","img-button":"img-button",imgButton:"img-button","x-screen-reader":"x-screen-reader",xScreenReader:"x-screen-reader",wide:"wide","c-carousel":"c-carousel",cCarousel:"c-carousel","f-single-slide":"f-single-slide",fSingleSlide:"f-single-slide","flow-runs":"flow-runs",flowRuns:"flow-runs","status-image":"status-image",statusImage:"status-image","tile-row":"tile-row",tileRow:"tile-row","zero-run-text":"zero-run-text",zeroRunText:"zero-run-text","learn-more-button":"learn-more-button",learnMoreButton:"learn-more-button","flow-creation-widget":"flow-creation-widget",flowCreationWidget:"flow-creation-widget","invoke-flow-widget-v2":"invoke-flow-widget-v2",invokeFlowWidgetV2:"invoke-flow-widget-v2","property-tile":"property-tile",propertyTile:"property-tile","property-tile-reset":"property-tile-reset",propertyTileReset:"property-tile-reset","tile-title":"tile-title",tileTitle:"tile-title","tile-see-all":"tile-see-all",tileSeeAll:"tile-see-all","info-card-item":"info-card-item",infoCardItem:"info-card-item","info-card-icon":"info-card-icon",infoCardIcon:"info-card-icon","info-card-text-section":"info-card-text-section",infoCardTextSection:"info-card-text-section","add-owner-title":"add-owner-title",addOwnerTitle:"add-owner-title","add-owner-icon":"add-owner-icon",addOwnerIcon:"add-owner-icon",a:"a","section-flow-submit-template":"section-flow-submit-template",sectionFlowSubmitTemplate:"section-flow-submit-template","c-text-field":"c-text-field",cTextField:"c-text-field","c-input":"c-input",cInput:"c-input","c-textarea":"c-textarea",cTextarea:"c-textarea","publish-validation":"publish-validation",publishValidation:"publish-validation","publish-error":"publish-error",publishError:"publish-error","submit-template-categories":"submit-template-categories",submitTemplateCategories:"submit-template-categories","submit-template-disclaimer":"submit-template-disclaimer",submitTemplateDisclaimer:"submit-template-disclaimer","submit-template-actions":"submit-template-actions",submitTemplateActions:"submit-template-actions","success-response":"success-response",successResponse:"success-response","green-circle-border":"green-circle-border",greenCircleBorder:"green-circle-border","yellow-warning":"yellow-warning",yellowWarning:"yellow-warning","template-submission-required":"template-submission-required",templateSubmissionRequired:"template-submission-required","template-categories-container":"template-categories-container",templateCategoriesContainer:"template-categories-container","context-manage-zeroactivities":"context-manage-zeroactivities",contextManageZeroactivities:"context-manage-zeroactivities","context-manage-zeroflowruns":"context-manage-zeroflowruns",contextManageZeroflowruns:"context-manage-zeroflowruns","zero-flow-runs-pane-content":"zero-flow-runs-pane-content",zeroFlowRunsPaneContent:"zero-flow-runs-pane-content","trigger-label":"trigger-label",triggerLabel:"trigger-label","trigger-details-label":"trigger-details-label",triggerDetailsLabel:"trigger-details-label","trigger-description":"trigger-description",triggerDescription:"trigger-description","info-card-title":"info-card-title",infoCardTitle:"info-card-title","info-card-subtitle":"info-card-subtitle",infoCardSubtitle:"info-card-subtitle",codeSwaggerEditorTab:"codeSwaggerEditorTab","codeSwaggerEditorTab-section":"codeSwaggerEditorTab-section",codeSwaggerEditorTabSection:"codeSwaggerEditorTab-section","codeSwaggerEditorTab-scrollbox":"codeSwaggerEditorTab-scrollbox",codeSwaggerEditorTabScrollbox:"codeSwaggerEditorTab-scrollbox","codeSwaggerEditorTab-scrollbox-content":"codeSwaggerEditorTab-scrollbox-content",codeSwaggerEditorTabScrollboxContent:"codeSwaggerEditorTab-scrollbox-content","codeSwaggerEditorTab-description":"codeSwaggerEditorTab-description",codeSwaggerEditorTabDescription:"codeSwaggerEditorTab-description","icon-upload-label":"icon-upload-label",iconUploadLabel:"icon-upload-label",customApiAction:"customApiAction","customApiAction-section":"customApiAction-section",customApiActionSection:"customApiAction-section","import-heading":"import-heading",importHeading:"import-heading","minimal-content":"minimal-content",minimalContent:"minimal-content","pane-buttons":"pane-buttons",paneButtons:"pane-buttons","response-item":"response-item",responseItem:"response-item","status-code":"status-code",statusCode:"status-code","customApiAction-pane":"customApiAction-pane",customApiActionPane:"customApiAction-pane","customApiAction-section-buttons":"customApiAction-section-buttons",customApiActionSectionButtons:"customApiAction-section-buttons","customApiAction-pane-field-value":"customApiAction-pane-field-value",customApiActionPaneFieldValue:"customApiAction-pane-field-value","custom-api-definition":"custom-api-definition",customApiDefinition:"custom-api-definition","reference-link":"reference-link",referenceLink:"reference-link",customApiResponse:"customApiResponse",customApiTabNavigation:"customApiTabNavigation","customApiTabNavigation-navigationButton--previous":"customApiTabNavigation-navigationButton--previous",customApiTabNavigationNavigationButtonPrevious:"customApiTabNavigation-navigationButton--previous","customApiTabNavigation-navigationButton--next":"customApiTabNavigation-navigationButton--next",customApiTabNavigationNavigationButtonNext:"customApiTabNavigation-navigationButton--next",customApiTrigger:"customApiTrigger","customApiTrigger-section":"customApiTrigger-section",customApiTriggerSection:"customApiTrigger-section","customApiTrigger-pane":"customApiTrigger-pane",customApiTriggerPane:"customApiTrigger-pane","customApiTrigger-section-buttons":"customApiTrigger-section-buttons",customApiTriggerSectionButtons:"customApiTrigger-section-buttons","customApiTrigger-pane-field-value":"customApiTrigger-pane-field-value",customApiTriggerPaneFieldValue:"customApiTrigger-pane-field-value",customConnectorDialog:"customConnectorDialog","customConnectorDialog-messageBarWrapper":"customConnectorDialog-messageBarWrapper",customConnectorDialogMessageBarWrapper:"customConnectorDialog-messageBarWrapper","header-icon-container":"header-icon-container",headerIconContainer:"header-icon-container","header-icon":"header-icon",headerIcon:"header-icon","header-container":"header-container",headerContainer:"header-container","header-text":"header-text",headerText:"header-text","header-github-link":"header-github-link",headerGithubLink:"header-github-link","customConnectorDialog-container":"customConnectorDialog-container",customConnectorDialogContainer:"customConnectorDialog-container","customConnectorDialog-dropDown":"customConnectorDialog-dropDown",customConnectorDialogDropDown:"customConnectorDialog-dropDown","ms-Label":"ms-Label",msLabel:"ms-Label",customApiDefinitionTab:"customApiDefinitionTab","customApiDefinitionTab-scrollbox":"customApiDefinitionTab-scrollbox",customApiDefinitionTabScrollbox:"customApiDefinitionTab-scrollbox","customApiDefinitionTab-scrollbox-content":"customApiDefinitionTab-scrollbox-content",customApiDefinitionTabScrollboxContent:"customApiDefinitionTab-scrollbox-content","customApiDefinitionTab-scrollbox-content--preRendered":"customApiDefinitionTab-scrollbox-content--preRendered",customApiDefinitionTabScrollboxContentPreRendered:"customApiDefinitionTab-scrollbox-content--preRendered","customApiDefinitionTab-scrollbox-content--rendered":"customApiDefinitionTab-scrollbox-content--rendered",customApiDefinitionTabScrollboxContentRendered:"customApiDefinitionTab-scrollbox-content--rendered","customApiDefinitionTab-content-divider":"customApiDefinitionTab-content-divider",customApiDefinitionTabContentDivider:"customApiDefinitionTab-content-divider","section-custom-api-details-tab":"section-custom-api-details-tab",sectionCustomApiDetailsTab:"section-custom-api-details-tab","top-align":"top-align",topAlign:"top-align","form-row":"form-row",formRow:"form-row","form-row--first":"form-row--first",formRowFirst:"form-row--first","details-description":"details-description",detailsDescription:"details-description","context-folding-list":"context-folding-list",contextFoldingList:"context-folding-list","folding-list-collapse":"folding-list-collapse",foldingListCollapse:"folding-list-collapse",description:"description","c-hyperlink":"c-hyperlink",cHyperlink:"c-hyperlink","list-item":"list-item",listItem:"list-item","item-text":"item-text",itemText:"item-text",index:"index","add-new":"add-new",addNew:"add-new","add-new-text":"add-new-text",addNewText:"add-new-text",commands:"commands","item-status":"item-status",itemStatus:"item-status",generalSwaggerEditorTab:"generalSwaggerEditorTab","generalSwaggerEditorTab-section--bottom":"generalSwaggerEditorTab-section--bottom",generalSwaggerEditorTabSectionBottom:"generalSwaggerEditorTab-section--bottom","generalSwaggerEditorTab-input--resizable":"generalSwaggerEditorTab-input--resizable",generalSwaggerEditorTabInputResizable:"generalSwaggerEditorTab-input--resizable","generalSwaggerEditorTab-section-divider":"generalSwaggerEditorTab-section-divider",generalSwaggerEditorTabSectionDivider:"generalSwaggerEditorTab-section-divider","icon-section":"icon-section",iconSection:"icon-section","icon-holder":"icon-holder",iconHolder:"icon-holder","icon-holder-button":"icon-holder-button",iconHolderButton:"icon-holder-button","icon-holder-image":"icon-holder-image",iconHolderImage:"icon-holder-image","icon-holder-label":"icon-holder-label",iconHolderLabel:"icon-holder-label","icon-description":"icon-description",iconDescription:"icon-description",copilotSwaggerEditorTab:"copilotSwaggerEditorTab","copilotSwaggerEditorTab-section--bottom":"copilotSwaggerEditorTab-section--bottom",copilotSwaggerEditorTabSectionBottom:"copilotSwaggerEditorTab-section--bottom","copilotSwaggerEditorTab-input--resizable":"copilotSwaggerEditorTab-input--resizable",copilotSwaggerEditorTabInputResizable:"copilotSwaggerEditorTab-input--resizable","copilotSwaggerEditorTab-section-divider":"copilotSwaggerEditorTab-section-divider",copilotSwaggerEditorTabSectionDivider:"copilotSwaggerEditorTab-section-divider","copilotSwaggerEditorTab-scrollbox":"copilotSwaggerEditorTab-scrollbox",copilotSwaggerEditorTabScrollbox:"copilotSwaggerEditorTab-scrollbox","copilotSwaggerEditorTab-scrollbox-content":"copilotSwaggerEditorTab-scrollbox-content",copilotSwaggerEditorTabScrollboxContent:"copilotSwaggerEditorTab-scrollbox-content","copilotSwaggerEditorTab-scrollbox-content--preRendered":"copilotSwaggerEditorTab-scrollbox-content--preRendered",copilotSwaggerEditorTabScrollboxContentPreRendered:"copilotSwaggerEditorTab-scrollbox-content--preRendered","copilotSwaggerEditorTab-scrollbox-content--rendered":"copilotSwaggerEditorTab-scrollbox-content--rendered",copilotSwaggerEditorTabScrollboxContentRendered:"copilotSwaggerEditorTab-scrollbox-content--rendered","copilotSwaggerEditorTab-content-divider":"copilotSwaggerEditorTab-content-divider",copilotSwaggerEditorTabContentDivider:"copilotSwaggerEditorTab-content-divider",importFromSamplePanel:"importFromSamplePanel","importFromSamplePanel-textArea--multiline":"importFromSamplePanel-textArea--multiline",importFromSamplePanelTextAreaMultiline:"importFromSamplePanel-textArea--multiline","importFromSamplePanelCtrl-buttons":"importFromSamplePanelCtrl-buttons",importFromSamplePanelCtrlButtons:"importFromSamplePanelCtrl-buttons","importFromSamplePanelCtrl-button":"importFromSamplePanelCtrl-button",importFromSamplePanelCtrlButton:"importFromSamplePanelCtrl-button","section-custom-api-import":"section-custom-api-import",sectionCustomApiImport:"section-custom-api-import","importSection-choiceGroup":"importSection-choiceGroup",importSectionChoiceGroup:"importSection-choiceGroup","ms-ChoiceField":"ms-ChoiceField",msChoiceField:"ms-ChoiceField","c-select-wsdl":"c-select-wsdl",cSelectWsdl:"c-select-wsdl","parameter-dropdown-editor-container":"parameter-dropdown-editor-container",parameterDropdownEditorContainer:"parameter-dropdown-editor-container","input-with-image-container":"input-with-image-container",inputWithImageContainer:"input-with-image-container",customApiPropertiesPane:"customApiPropertiesPane","customApiPropertiesPane-header":"customApiPropertiesPane-header",customApiPropertiesPaneHeader:"customApiPropertiesPane-header","customApiPropertiesPane-topHeader":"customApiPropertiesPane-topHeader",customApiPropertiesPaneTopHeader:"customApiPropertiesPane-topHeader","customApiPropertiesPane-topHeader-input":"customApiPropertiesPane-topHeader-input",customApiPropertiesPaneTopHeaderInput:"customApiPropertiesPane-topHeader-input","customApiPropertiesPane-topHeader-button":"customApiPropertiesPane-topHeader-button",customApiPropertiesPaneTopHeaderButton:"customApiPropertiesPane-topHeader-button","fl-NgReactIconButton":"fl-NgReactIconButton",flNgReactIconButton:"fl-NgReactIconButton","customApiPropertiesPane-topHeader-ApiNameLabel":"customApiPropertiesPane-topHeader-ApiNameLabel",customApiPropertiesPaneTopHeaderApiNameLabel:"customApiPropertiesPane-topHeader-ApiNameLabel","customApiPropertiesPane-bottomHeader":"customApiPropertiesPane-bottomHeader",customApiPropertiesPaneBottomHeader:"customApiPropertiesPane-bottomHeader","customApiPropertiesPane-bottomHeader-actions":"customApiPropertiesPane-bottomHeader-actions",customApiPropertiesPaneBottomHeaderActions:"customApiPropertiesPane-bottomHeader-actions","customApiPropertiesPane-bottomHeader-action":"customApiPropertiesPane-bottomHeader-action",customApiPropertiesPaneBottomHeaderAction:"customApiPropertiesPane-bottomHeader-action","ms-Button-textContainer":"ms-Button-textContainer",msButtonTextContainer:"ms-Button-textContainer","customApiPropertiesPane-tab":"customApiPropertiesPane-tab",customApiPropertiesPaneTab:"customApiPropertiesPane-tab","customApiPropertiesPane-tab--active":"customApiPropertiesPane-tab--active",customApiPropertiesPaneTabActive:"customApiPropertiesPane-tab--active","customApiPropertiesPane-tab--first":"customApiPropertiesPane-tab--first",customApiPropertiesPaneTabFirst:"customApiPropertiesPane-tab--first","fl-alert":"fl-alert",flAlert:"fl-alert","customApiPropertiesPane-bodyContainer":"customApiPropertiesPane-bodyContainer",customApiPropertiesPaneBodyContainer:"customApiPropertiesPane-bodyContainer","customApiPropertiesPane-bodyContainer-shifted":"customApiPropertiesPane-bodyContainer-shifted",customApiPropertiesPaneBodyContainerShifted:"customApiPropertiesPane-bodyContainer-shifted","schema-property":"schema-property",schemaProperty:"schema-property",securitySwaggerEditorTab:"securitySwaggerEditorTab","context-required-text":"context-required-text",contextRequiredText:"context-required-text","locked-security":"locked-security",lockedSecurity:"locked-security","securitySwaggerEditorTab-section":"securitySwaggerEditorTab-section",securitySwaggerEditorTabSection:"securitySwaggerEditorTab-section","securitySwaggerEditorTab-scrollbox":"securitySwaggerEditorTab-scrollbox",securitySwaggerEditorTabScrollbox:"securitySwaggerEditorTab-scrollbox","securitySwaggerEditorTab-scrollbox-content":"securitySwaggerEditorTab-scrollbox-content",securitySwaggerEditorTabScrollboxContent:"securitySwaggerEditorTab-scrollbox-content","securitySwaggerEditorTab-pane-field--hasButton":"securitySwaggerEditorTab-pane-field--hasButton",securitySwaggerEditorTabPaneFieldHasButton:"securitySwaggerEditorTab-pane-field--hasButton","securitySwaggerEditorTab-pane-content--hasButton":"securitySwaggerEditorTab-pane-content--hasButton",securitySwaggerEditorTabPaneContentHasButton:"securitySwaggerEditorTab-pane-content--hasButton","securitySwaggerEditorTab-description":"securitySwaggerEditorTab-description",securitySwaggerEditorTabDescription:"securitySwaggerEditorTab-description","securitySwaggerEditorTab-checkbox":"securitySwaggerEditorTab-checkbox",securitySwaggerEditorTabCheckbox:"securitySwaggerEditorTab-checkbox","learn-more":"learn-more",learnMore:"learn-more","section-share":"section-share",sectionShare:"section-share","ps-list-item":"ps-list-item",psListItem:"ps-list-item","autocomplete-container":"autocomplete-container",autocompleteContainer:"autocomplete-container","tenant-share":"tenant-share",tenantShare:"tenant-share","share-list-tbody":"share-list-tbody",shareListTbody:"share-list-tbody","action-buttons":"action-buttons",actionButtons:"action-buttons","option-block":"option-block",optionBlock:"option-block","debug-pane":"debug-pane",debugPane:"debug-pane",swaggerEditor:"swaggerEditor","visible-380px":"visible-380px",visible380Px:"visible-380px","visible-480px":"visible-480px",visible480Px:"visible-480px","swaggerEditor-header":"swaggerEditor-header",swaggerEditorHeader:"swaggerEditor-header",copilotTabHeaderMessage:"copilotTabHeaderMessage","ms-MessageBar":"ms-MessageBar",msMessageBar:"ms-MessageBar","ms-MessageBar-content":"ms-MessageBar-content",msMessageBarContent:"ms-MessageBar-content","swaggerEditor-messageHeader":"swaggerEditor-messageHeader",swaggerEditorMessageHeader:"swaggerEditor-messageHeader","swaggerEditor-copyClipBoard":"swaggerEditor-copyClipBoard",swaggerEditorCopyClipBoard:"swaggerEditor-copyClipBoard","swaggerEditor-topHeader":"swaggerEditor-topHeader",swaggerEditorTopHeader:"swaggerEditor-topHeader","swaggerEditor-topHeader-input":"swaggerEditor-topHeader-input",swaggerEditorTopHeaderInput:"swaggerEditor-topHeader-input","swaggerEditor-topHeader-button":"swaggerEditor-topHeader-button",swaggerEditorTopHeaderButton:"swaggerEditor-topHeader-button","swaggerEditor-topHeader-ApiNameLabel":"swaggerEditor-topHeader-ApiNameLabel",swaggerEditorTopHeaderApiNameLabel:"swaggerEditor-topHeader-ApiNameLabel","swaggerEditor-bottomHeader":"swaggerEditor-bottomHeader",swaggerEditorBottomHeader:"swaggerEditor-bottomHeader","swaggerEditor-bottomHeader-tabs":"swaggerEditor-bottomHeader-tabs",swaggerEditorBottomHeaderTabs:"swaggerEditor-bottomHeader-tabs","swaggerEditor-bottomHeader-actions":"swaggerEditor-bottomHeader-actions",swaggerEditorBottomHeaderActions:"swaggerEditor-bottomHeader-actions","ms-Toggle":"ms-Toggle",msToggle:"ms-Toggle","swaggerEditor-tabSeperator":"swaggerEditor-tabSeperator",swaggerEditorTabSeperator:"swaggerEditor-tabSeperator","swaggerEditor-tab":"swaggerEditor-tab",swaggerEditorTab:"swaggerEditor-tab","swaggerEditor-tab--active":"swaggerEditor-tab--active",swaggerEditorTabActive:"swaggerEditor-tab--active","swaggerEditor-tab--first":"swaggerEditor-tab--first",swaggerEditorTabFirst:"swaggerEditor-tab--first","swaggerEditor-errorAlert":"swaggerEditor-errorAlert",swaggerEditorErrorAlert:"swaggerEditor-errorAlert","swagger-editor-container":"swagger-editor-container",swaggerEditorContainer:"swagger-editor-container","swagger-editor-content":"swagger-editor-content",swaggerEditorContent:"swagger-editor-content","swagger-editor-content-tab":"swagger-editor-content-tab",swaggerEditorContentTab:"swagger-editor-content-tab","swagger-editor-container-shifted":"swagger-editor-container-shifted",swaggerEditorContainerShifted:"swagger-editor-container-shifted","swaggerEditor-tab-name":"swaggerEditor-tab-name",swaggerEditorTabName:"swaggerEditor-tab-name","swaggerEditor-bottomHeader-action":"swaggerEditor-bottomHeader-action",swaggerEditorBottomHeaderAction:"swaggerEditor-bottomHeader-action",swaggerEditorTabsDropdown:"swaggerEditorTabsDropdown","pane-field-multiselect":"pane-field-multiselect",paneFieldMultiselect:"pane-field-multiselect","select-option-container":"select-option-container",selectOptionContainer:"select-option-container","select-option":"select-option",selectOption:"select-option","not-visible-480px":"not-visible-480px",notVisible480Px:"not-visible-480px","swaggerEditor-topHeader-row":"swaggerEditor-topHeader-row",swaggerEditorTopHeaderRow:"swaggerEditor-topHeader-row","not-visible-380px":"not-visible-380px",notVisible380Px:"not-visible-380px","swagger-editor-iframe":"swagger-editor-iframe",swaggerEditorIframe:"swagger-editor-iframe",customApiTestTab:"customApiTestTab","validation-errors":"validation-errors",validationErrors:"validation-errors","left-pane":"left-pane",leftPane:"left-pane","column-title":"column-title",columnTitle:"column-title","left-pane-button":"left-pane-button",leftPaneButton:"left-pane-button","c-select":"c-select",cSelect:"c-select","pane-field":"pane-field",paneField:"pane-field","right-pane":"right-pane",rightPane:"right-pane","pane-title":"pane-title",paneTitle:"pane-title","pane-tabs":"pane-tabs",paneTabs:"pane-tabs","raw-output":"raw-output",rawOutput:"raw-output",small:"small","error-message":"error-message",errorMessage:"error-message","margin-bottom":"margin-bottom",marginBottom:"margin-bottom","margin-top":"margin-top",marginTop:"margin-top","results-section-pivot":"results-section-pivot",resultsSectionPivot:"results-section-pivot",right:"right","c-pivot":"c-pivot",cPivot:"c-pivot","pane-header":"pane-header",paneHeader:"pane-header","f-active":"f-active",fActive:"f-active","c-toggle":"c-toggle",cToggle:"c-toggle","customApiTestTab-sectionDivider":"customApiTestTab-sectionDivider",customApiTestTabSectionDivider:"customApiTestTab-sectionDivider",validatedInput:"validatedInput","validatedInput-label":"validatedInput-label",validatedInputLabel:"validatedInput-label","validatedInput-description":"validatedInput-description",validatedInputDescription:"validatedInput-description","validatedInput-input":"validatedInput-input",validatedInputInput:"validatedInput-input","validatedInput-input--toolTipLeft":"validatedInput-input--toolTipLeft",validatedInputInputToolTipLeft:"validatedInput-input--toolTipLeft","validatedInput-input--toolTipRight":"validatedInput-input--toolTipRight",validatedInputInputToolTipRight:"validatedInput-input--toolTipRight","validatedInput-validationResultTooltip":"validatedInput-validationResultTooltip",validatedInputValidationResultTooltip:"validatedInput-validationResultTooltip","validatedInput-validationResultTooltip--left":"validatedInput-validationResultTooltip--left",validatedInputValidationResultTooltipLeft:"validatedInput-validationResultTooltip--left","validatedInput-validationResultTooltip--right":"validatedInput-validationResultTooltip--right",validatedInputValidationResultTooltipRight:"validatedInput-validationResultTooltip--right","validation-results-container":"validation-results-container",validationResultsContainer:"validation-results-container","validation-pane":"validation-pane",validationPane:"validation-pane","validation-icon":"validation-icon",validationIcon:"validation-icon","entity-result":"entity-result",entityResult:"entity-result","result-messages":"result-messages",resultMessages:"result-messages",indent:"indent",validationResultTooltip:"validationResultTooltip","validationResultTooltip-icon":"validationResultTooltip-icon",validationResultTooltipIcon:"validationResultTooltip-icon","validationResultTooltip-result":"validationResultTooltip-result",validationResultTooltipResult:"validationResultTooltip-result","validationResultTooltip-result-icon":"validationResultTooltip-result-icon",validationResultTooltipResultIcon:"validationResultTooltip-result-icon","validationResultTooltip-result-message":"validationResultTooltip-result-message",validationResultTooltipResultMessage:"validationResultTooltip-result-message","validationResultTooltip-result-divider":"validationResultTooltip-result-divider",validationResultTooltipResultDivider:"validationResultTooltip-result-divider","validationResultTooltip-tooltip":"validationResultTooltip-tooltip",validationResultTooltipTooltip:"validationResultTooltip-tooltip","validationResultTooltip-tooltip--topLeft":"validationResultTooltip-tooltip--topLeft",validationResultTooltipTooltipTopLeft:"validationResultTooltip-tooltip--topLeft","validationResultTooltip-tooltip--topRight":"validationResultTooltip-tooltip--topRight",validationResultTooltipTooltipTopRight:"validationResultTooltip-tooltip--topRight","validationResultTooltip-tooltip--bottomLeft":"validationResultTooltip-tooltip--bottomLeft",validationResultTooltipTooltipBottomLeft:"validationResultTooltip-tooltip--bottomLeft","validationResultTooltip-tooltip--bottomRight":"validationResultTooltip-tooltip--bottomRight",validationResultTooltipTooltipBottomRight:"validationResultTooltip-tooltip--bottomRight","pane-title-button":"pane-title-button",paneTitleButton:"pane-title-button","pane-title-text--hasIconOrButton":"pane-title-text--hasIconOrButton",paneTitleTextHasIconOrButton:"pane-title-text--hasIconOrButton","pane-title--hasIconOrButton":"pane-title--hasIconOrButton",paneTitleHasIconOrButton:"pane-title--hasIconOrButton","pane-table-header":"pane-table-header",paneTableHeader:"pane-table-header","pane-table-body":"pane-table-body",paneTableBody:"pane-table-body","pane-row-label":"pane-row-label",paneRowLabel:"pane-row-label","pane-row-input":"pane-row-input",paneRowInput:"pane-row-input",subtitle:"subtitle","pane-field-label":"pane-field-label",paneFieldLabel:"pane-field-label","fl-ChoiceGroup":"fl-ChoiceGroup",flChoiceGroup:"fl-ChoiceGroup","pane-elements":"pane-elements",paneElements:"pane-elements","table-cell-image":"table-cell-image",tableCellImage:"table-cell-image","connection-name-text":"connection-name-text",connectionNameText:"connection-name-text","c-table":"c-table",cTable:"c-table","load-more":"load-more",loadMore:"load-more","glyph-search":"glyph-search",glyphSearch:"glyph-search","glyph-search-reverse":"glyph-search-reverse",glyphSearchReverse:"glyph-search-reverse","glyph-create":"glyph-create",glyphCreate:"glyph-create","glyph-delete":"glyph-delete",glyphDelete:"glyph-delete","glyph-edit":"glyph-edit",glyphEdit:"glyph-edit","glyph-play":"glyph-play",glyphPlay:"glyph-play","glyph-pause":"glyph-pause",glyphPause:"glyph-pause","glyph-arrow-after":"glyph-arrow-after",glyphArrowAfter:"glyph-arrow-after","glyph-arrow":"glyph-arrow",glyphArrow:"glyph-arrow","glyph-checkmark":"glyph-checkmark",glyphCheckmark:"glyph-checkmark","glyph-inprogress":"glyph-inprogress",glyphInprogress:"glyph-inprogress","glyph-download":"glyph-download",glyphDownload:"glyph-download","glyph-upload":"glyph-upload",glyphUpload:"glyph-upload","glyph-stop":"glyph-stop",glyphStop:"glyph-stop","glyph-resubmit":"glyph-resubmit",glyphResubmit:"glyph-resubmit","glyph-ellipsis":"glyph-ellipsis",glyphEllipsis:"glyph-ellipsis","glyph-mail":"glyph-mail",glyphMail:"glyph-mail","glyph-owners":"glyph-owners",glyphOwners:"glyph-owners","glyph-arrowdown":"glyph-arrowdown",glyphArrowdown:"glyph-arrowdown","glyph-arrowup":"glyph-arrowup",glyphArrowup:"glyph-arrowup","glyph-leavepage":"glyph-leavepage",glyphLeavepage:"glyph-leavepage","glyph-saveas":"glyph-saveas",glyphSaveas:"glyph-saveas","glyph-minus":"glyph-minus",glyphMinus:"glyph-minus","glyph-share":"glyph-share",glyphShare:"glyph-share","glyph-person":"glyph-person",glyphPerson:"glyph-person","glyph-calendar":"glyph-calendar",glyphCalendar:"glyph-calendar","glyph-export":"glyph-export",glyphExport:"glyph-export","glyph-info":"glyph-info",glyphInfo:"glyph-info","glyph-warning":"glyph-warning",glyphWarning:"glyph-warning","glyph-refresh":"glyph-refresh",glyphRefresh:"glyph-refresh","glyph-error":"glyph-error",glyphError:"glyph-error","glyph-test":"glyph-test",glyphTest:"glyph-test","glyph-onOffToggle":"glyph-onOffToggle",glyphOnOffToggle:"glyph-onOffToggle","glyph-copy":"glyph-copy",glyphCopy:"glyph-copy","theme-blue":"theme-blue",themeBlue:"theme-blue","theme-white":"theme-white",themeWhite:"theme-white","c-input-select-field":"c-input-select-field",cInputSelectField:"c-input-select-field","c-button-text-field":"c-button-text-field",cButtonTextField:"c-button-text-field","glyph-forward-arrow":"glyph-forward-arrow",glyphForwardArrow:"glyph-forward-arrow","section-manage-flow-analytics":"section-manage-flow-analytics",sectionManageFlowAnalytics:"section-manage-flow-analytics","section-flow-analytics":"section-flow-analytics",sectionFlowAnalytics:"section-flow-analytics","analytics-info-pane":"analytics-info-pane",analyticsInfoPane:"analytics-info-pane","analytics-report":"analytics-report",analyticsReport:"analytics-report","detail-ribbon":"detail-ribbon",detailRibbon:"detail-ribbon","dashboard-tabs":"dashboard-tabs",dashboardTabs:"dashboard-tabs","duration-control":"duration-control",durationControl:"duration-control","label-filter":"label-filter",labelFilter:"label-filter","heading-template":"heading-template",headingTemplate:"heading-template","analytics-refreshdate-text":"analytics-refreshdate-text",analyticsRefreshdateText:"analytics-refreshdate-text","analytics-dashboard":"analytics-dashboard",analyticsDashboard:"analytics-dashboard","dashboard-active":"dashboard-active",dashboardActive:"dashboard-active","user-autocomplete":"user-autocomplete",userAutocomplete:"user-autocomplete","autocomplete-error":"autocomplete-error",autocompleteError:"autocomplete-error","autocomplete-hint":"autocomplete-hint",autocompleteHint:"autocomplete-hint","autocomplete-input":"autocomplete-input",autocompleteInput:"autocomplete-input","autocomplete-list-wrapper":"autocomplete-list-wrapper",autocompleteListWrapper:"autocomplete-list-wrapper","autocomplete-list":"autocomplete-list",autocompleteList:"autocomplete-list","autocomplete-list-item":"autocomplete-list-item",autocompleteListItem:"autocomplete-list-item","autocomplete-selected-row":"autocomplete-selected-row",autocompleteSelectedRow:"autocomplete-selected-row","info-card-list-option":"info-card-list-option",infoCardListOption:"info-card-list-option","info-card-options":"info-card-options",infoCardOptions:"info-card-options","card-option":"card-option",cardOption:"card-option","dropdown-card-option":"dropdown-card-option",dropdownCardOption:"dropdown-card-option","section-manage-flow-owners":"section-manage-flow-owners",sectionManageFlowOwners:"section-manage-flow-owners","section-flow-owners":"section-flow-owners",sectionFlowOwners:"section-flow-owners","owner-tabs":"owner-tabs",ownerTabs:"owner-tabs","flow-owners-flow-name":"flow-owners-flow-name",flowOwnersFlowName:"flow-owners-flow-name","ng-modal-close":"ng-modal-close",ngModalClose:"ng-modal-close","connections-info-cards":"connections-info-cards",connectionsInfoCards:"connections-info-cards","learn-more-link":"learn-more-link",learnMoreLink:"learn-more-link","flow-owners-alert":"flow-owners-alert",flowOwnersAlert:"flow-owners-alert","section-flow-owners-connections":"section-flow-owners-connections",sectionFlowOwnersConnections:"section-flow-owners-connections","other-connections-title":"other-connections-title",otherConnectionsTitle:"other-connections-title","owners-sharepoint-container":"owners-sharepoint-container",ownersSharepointContainer:"owners-sharepoint-container","dropdown-label":"dropdown-label",dropdownLabel:"dropdown-label","flow-owners-title":"flow-owners-title",flowOwnersTitle:"flow-owners-title","flow-owners-subtitle":"flow-owners-subtitle",flowOwnersSubtitle:"flow-owners-subtitle","flowOwners-header":"flowOwners-header",flowOwnersHeader:"flowOwners-header","flowOwners-warningDialog-header":"flowOwners-warningDialog-header",flowOwnersWarningDialogHeader:"flowOwners-warningDialog-header","flowOwners-description":"flowOwners-description",flowOwnersDescription:"flowOwners-description","sticky-save":"sticky-save",stickySave:"sticky-save",testing:"testing","sticky-container":"sticky-container",stickyContainer:"sticky-container","sticky-save-shifted":"sticky-save-shifted",stickySaveShifted:"sticky-save-shifted","manage-flow-section":"manage-flow-section",manageFlowSection:"manage-flow-section","manage-flow-details":"manage-flow-details",manageFlowDetails:"manage-flow-details","draft-overlay":"draft-overlay",draftOverlay:"draft-overlay","draft-marker":"draft-marker",draftMarker:"draft-marker","flow-designer-container":"flow-designer-container",flowDesignerContainer:"flow-designer-container","msla-container":"msla-container",mslaContainer:"msla-container","msla-transform-buttons":"msla-transform-buttons",mslaTransformButtons:"msla-transform-buttons","ms-Button":"ms-Button",msButton:"ms-Button","fl-CommandBar-FlowChecker--hasErrors":"fl-CommandBar-FlowChecker--hasErrors",flCommandBarFlowCheckerHasErrors:"fl-CommandBar-FlowChecker--hasErrors","fl-CommandBar-FlowChecker--hasWarnings":"fl-CommandBar-FlowChecker--hasWarnings",flCommandBarFlowCheckerHasWarnings:"fl-CommandBar-FlowChecker--hasWarnings","ms-Button-flexContainer":"ms-Button-flexContainer",msButtonFlexContainer:"ms-Button-flexContainer","ms-Button-icon":"ms-Button-icon",msButtonIcon:"ms-Button-icon","flow-commenting-pane":"flow-commenting-pane",flowCommentingPane:"flow-commenting-pane",opened:"opened","ppux-shared-comments-pane":"ppux-shared-comments-pane",ppuxSharedCommentsPane:"ppux-shared-comments-pane","ms-Icon":"ms-Icon",msIcon:"ms-Icon","msla-host-flow-template":"msla-host-flow-template",mslaHostFlowTemplate:"msla-host-flow-template","msla-host-processsimple":"msla-host-processsimple",mslaHostProcesssimple:"msla-host-processsimple","ms-TextField-field":"ms-TextField-field",msTextFieldField:"ms-TextField-field","msla-copy-input-control":"msla-copy-input-control",mslaCopyInputControl:"msla-copy-input-control","msla-card-button-primary":"msla-card-button-primary",mslaCardButtonPrimary:"msla-card-button-primary","msla-card-description-icon-button":"msla-card-description-icon-button",mslaCardDescriptionIconButton:"msla-card-description-icon-button","msla-card-children":"msla-card-children",mslaCardChildren:"msla-card-children","msla-card-selected":"msla-card-selected",mslaCardSelected:"msla-card-selected","msla-actionpalette-menu-triangle":"msla-actionpalette-menu-triangle",mslaActionpaletteMenuTriangle:"msla-actionpalette-menu-triangle","msla-actionpalette-menu":"msla-actionpalette-menu",mslaActionpaletteMenu:"msla-actionpalette-menu","msla-action-button":"msla-action-button",mslaActionButton:"msla-action-button","msla-actionpalette-expanded-menu":"msla-actionpalette-expanded-menu",mslaActionpaletteExpandedMenu:"msla-actionpalette-expanded-menu","msla-action-palette-list":"msla-action-palette-list",mslaActionPaletteList:"msla-action-palette-list","msla-condition-branch-header":"msla-condition-branch-header",mslaConditionBranchHeader:"msla-condition-branch-header","msla-condition-branch-add":"msla-condition-branch-add",mslaConditionBranchAdd:"msla-condition-branch-add","msla-action-button-text":"msla-action-button-text",mslaActionButtonText:"msla-action-button-text","msla-actionpalette":"msla-actionpalette",mslaActionpalette:"msla-actionpalette","buttons-row":"buttons-row",buttonsRow:"buttons-row","msla-action-buttons":"msla-action-buttons",mslaActionButtons:"msla-action-buttons","msla-actionmenu-toggle":"msla-actionmenu-toggle",mslaActionmenuToggle:"msla-actionmenu-toggle","msla-connection-link":"msla-connection-link",mslaConnectionLink:"msla-connection-link","msla-selector":"msla-selector",mslaSelector:"msla-selector","msla-selector-list-item":"msla-selector-list-item",mslaSelectorListItem:"msla-selector-list-item","msla-selector-icon":"msla-selector-icon",mslaSelectorIcon:"msla-selector-icon","msla-connection-container":"msla-connection-container",mslaConnectionContainer:"msla-connection-container","msla-connection-selector-options":"msla-connection-selector-options",mslaConnectionSelectorOptions:"msla-connection-selector-options","msla-connection-create-button":"msla-connection-create-button",mslaConnectionCreateButton:"msla-connection-create-button","msla-connection-switch-link":"msla-connection-switch-link",mslaConnectionSwitchLink:"msla-connection-switch-link","msla-connection-selector":"msla-connection-selector",mslaConnectionSelector:"msla-connection-selector","msla-connection-view-permissions-link":"msla-connection-view-permissions-link",mslaConnectionViewPermissionsLink:"msla-connection-view-permissions-link","msla-connection-container-footer":"msla-connection-container-footer",mslaConnectionContainerFooter:"msla-connection-container-footer","msla-button":"msla-button",mslaButton:"msla-button","msla-card-config-button-container":"msla-card-config-button-container",mslaCardConfigButtonContainer:"msla-card-config-button-container","msla-card-config-item":"msla-card-config-item",mslaCardConfigItem:"msla-card-config-item","msla-label":"msla-label",mslaLabel:"msla-label","msla-checkbox-label":"msla-checkbox-label",mslaCheckboxLabel:"msla-checkbox-label","msla-checkbox-description-icon-button":"msla-checkbox-description-icon-button",mslaCheckboxDescriptionIconButton:"msla-checkbox-description-icon-button","msla-input-parameter-label":"msla-input-parameter-label",mslaInputParameterLabel:"msla-input-parameter-label","msla-label-with-tooltip":"msla-label-with-tooltip",mslaLabelWithTooltip:"msla-label-with-tooltip","msla-label-tooltip":"msla-label-tooltip",mslaLabelTooltip:"msla-label-tooltip","public-DraftEditorPlaceholder-root":"public-DraftEditorPlaceholder-root",publicDraftEditorPlaceholderRoot:"public-DraftEditorPlaceholder-root","msla-picker-header":"msla-picker-header",mslaPickerHeader:"msla-picker-header","msla-picker-title":"msla-picker-title",mslaPickerTitle:"msla-picker-title","msla-title-segment":"msla-title-segment",mslaTitleSegment:"msla-title-segment","msla-segment":"msla-segment",mslaSegment:"msla-segment","msla-text-navigation":"msla-text-navigation",mslaTextNavigation:"msla-text-navigation","msla-parameter-picker-button":"msla-parameter-picker-button",mslaParameterPickerButton:"msla-parameter-picker-button","msla-picker-items":"msla-picker-items",mslaPickerItems:"msla-picker-items","msla-item-selected":"msla-item-selected",mslaItemSelected:"msla-item-selected","msla-folder":"msla-folder",mslaFolder:"msla-folder","msla-file":"msla-file",mslaFile:"msla-file","msla-navigate-button":"msla-navigate-button",mslaNavigateButton:"msla-navigate-button","msla-selection-section":"msla-selection-section",mslaSelectionSection:"msla-selection-section","msla-picker-command-bar":"msla-picker-command-bar",mslaPickerCommandBar:"msla-picker-command-bar","msla-confirm":"msla-confirm",mslaConfirm:"msla-confirm","msla-parameter-picker-input-box":"msla-parameter-picker-input-box",mslaParameterPickerInputBox:"msla-parameter-picker-input-box","msla-condition-branches":"msla-condition-branches",mslaConditionBranches:"msla-condition-branches","msla-cancel":"msla-cancel",mslaCancel:"msla-cancel","msla-change-profile-link-text":"msla-change-profile-link-text",mslaChangeProfileLinkText:"msla-change-profile-link-text","msla-edit-parameters-values-text":"msla-edit-parameters-values-text",mslaEditParametersValuesText:"msla-edit-parameters-values-text","msla-if":"msla-if",mslaIf:"msla-if","msla-condition-expanded":"msla-condition-expanded",mslaConditionExpanded:"msla-condition-expanded","msla-card":"msla-card",mslaCard:"msla-card","msla-card-condition-parameters":"msla-card-condition-parameters",mslaCardConditionParameters:"msla-card-condition-parameters","msla-card-body":"msla-card-body",mslaCardBody:"msla-card-body","msla-card-condition-body":"msla-card-condition-body",mslaCardConditionBody:"msla-card-condition-body","msla-card-condition-branches":"msla-card-condition-branches",mslaCardConditionBranches:"msla-card-condition-branches","msla-recommendation-dropdown":"msla-recommendation-dropdown",mslaRecommendationDropdown:"msla-recommendation-dropdown","msla-recommendation-footer":"msla-recommendation-footer",mslaRecommendationFooter:"msla-recommendation-footer","msla-card-condition-branch":"msla-card-condition-branch",mslaCardConditionBranch:"msla-card-condition-branch","msla-card-condition-parameters-body":"msla-card-condition-parameters-body",mslaCardConditionParametersBody:"msla-card-condition-parameters-body","msla-card-header":"msla-card-header",mslaCardHeader:"msla-card-header","msla-comment-box":"msla-comment-box",mslaCommentBox:"msla-comment-box","msla-comment-icon":"msla-comment-icon",mslaCommentIcon:"msla-comment-icon","msla-information-box-container":"msla-information-box-container",mslaInformationBoxContainer:"msla-information-box-container","msla-html-editor":"msla-html-editor",mslaHtmlEditor:"msla-html-editor","rdw-link-modal":"rdw-link-modal",rdwLinkModal:"rdw-link-modal","ms-Stack":"ms-Stack",msStack:"ms-Stack","msla-checkbox":"msla-checkbox",mslaCheckbox:"msla-checkbox","msla-combobox-container":"msla-combobox-container",mslaComboboxContainer:"msla-combobox-container","msla-dropdown-container":"msla-dropdown-container",mslaDropdownContainer:"msla-dropdown-container","msla-textbox":"msla-textbox",mslaTextbox:"msla-textbox","msla-recurrence-parameters-container":"msla-recurrence-parameters-container",mslaRecurrenceParametersContainer:"msla-recurrence-parameters-container","msla-input-parameters-list":"msla-input-parameters-list",mslaInputParametersList:"msla-input-parameters-list","msla-input-parameter-inline-item":"msla-input-parameter-inline-item",mslaInputParameterInlineItem:"msla-input-parameter-inline-item","msla-dynamic-added-param-inputs-container":"msla-dynamic-added-param-inputs-container",mslaDynamicAddedParamInputsContainer:"msla-dynamic-added-param-inputs-container","msla-editor-input-control":"msla-editor-input-control",mslaEditorInputControl:"msla-editor-input-control","msla-input-control":"msla-input-control",mslaInputControl:"msla-input-control","msla-input-parameters-body":"msla-input-parameters-body",mslaInputParametersBody:"msla-input-parameters-body","msla-token-recommendation-v2":"msla-token-recommendation-v2",mslaTokenRecommendationV2:"msla-token-recommendation-v2","msla-html-codeview-editor":"msla-html-codeview-editor",mslaHtmlCodeviewEditor:"msla-html-codeview-editor","msla-input-parameter-error":"msla-input-parameter-error",mslaInputParameterError:"msla-input-parameter-error","msla-card-expression-builder":"msla-card-expression-builder",mslaCardExpressionBuilder:"msla-card-expression-builder","msla-input-parameter":"msla-input-parameter",mslaInputParameter:"msla-input-parameter","msla-input-parameter-content-wrapper":"msla-input-parameter-content-wrapper",mslaInputParameterContentWrapper:"msla-input-parameter-content-wrapper","msla-connection-container-body":"msla-connection-container-body",mslaConnectionContainerBody:"msla-connection-container-body","ms-Callout-container":"ms-Callout-container",msCalloutContainer:"ms-Callout-container","msla-card-menu-item-button-title":"msla-card-menu-item-button-title",mslaCardMenuItemButtonTitle:"msla-card-menu-item-button-title","msla-dropdown-option":"msla-dropdown-option",mslaDropdownOption:"msla-dropdown-option","ms-ContextualMenu":"ms-ContextualMenu",msContextualMenu:"ms-ContextualMenu","ms-ContextualMenu-list":"ms-ContextualMenu-list",msContextualMenuList:"ms-ContextualMenu-list","flow-run-only-tile":"flow-run-only-tile",flowRunOnlyTile:"flow-run-only-tile","run-tile-sharepoint-section":"run-tile-sharepoint-section",runTileSharepointSection:"run-tile-sharepoint-section","run-only-tabs":"run-only-tabs",runOnlyTabs:"run-only-tabs","run-tile-graph-container":"run-tile-graph-container",runTileGraphContainer:"run-tile-graph-container","run-tile-sharepoint-container":"run-tile-sharepoint-container",runTileSharepointContainer:"run-tile-sharepoint-container","pane-actions":"pane-actions",paneActions:"pane-actions","info-card-container":"info-card-container",infoCardContainer:"info-card-container","connection-card-container":"connection-card-container",connectionCardContainer:"connection-card-container","connection-warning-message":"connection-warning-message",connectionWarningMessage:"connection-warning-message","icon-column":"icon-column",iconColumn:"icon-column","flow-runonly-section-react-text-message-bar":"flow-runonly-section-react-text-message-bar",flowRunonlySectionReactTextMessageBar:"flow-runonly-section-react-text-message-bar","section-flow-save-as-dialog":"section-flow-save-as-dialog",sectionFlowSaveAsDialog:"section-flow-save-as-dialog","flow-save-as-dialog-content":"flow-save-as-dialog-content",flowSaveAsDialogContent:"flow-save-as-dialog-content","msla-connectionwizard-canvas":"msla-connectionwizard-canvas",mslaConnectionwizardCanvas:"msla-connectionwizard-canvas","create-connection-description":"create-connection-description",createConnectionDescription:"create-connection-description","flow-save-as-description":"flow-save-as-description",flowSaveAsDescription:"flow-save-as-description","connection-disambiguation":"connection-disambiguation",connectionDisambiguation:"connection-disambiguation","msla-selector-shadow":"msla-selector-shadow",mslaSelectorShadow:"msla-selector-shadow","header-message":"header-message",headerMessage:"header-message","header-message-run-only-title":"header-message-run-only-title",headerMessageRunOnlyTitle:"header-message-run-only-title","full-designer-mode":"full-designer-mode",fullDesignerMode:"full-designer-mode","hide-continue-button":"hide-continue-button",hideContinueButton:"hide-continue-button","msla-connection-continue-button":"msla-connection-continue-button",mslaConnectionContinueButton:"msla-connection-continue-button","diet-designer-mode":"diet-designer-mode",dietDesignerMode:"diet-designer-mode","msla-card-caption":"msla-card-caption",mslaCardCaption:"msla-card-caption","msla-connection-selector-icon":"msla-connection-selector-icon",mslaConnectionSelectorIcon:"msla-connection-selector-icon","msla-connection-selector-connection":"msla-connection-selector-connection",mslaConnectionSelectorConnection:"msla-connection-selector-connection","msla-connection-display-name":"msla-connection-display-name",mslaConnectionDisplayName:"msla-connection-display-name","msla-connection-selector-connector-name":"msla-connection-selector-connector-name",mslaConnectionSelectorConnectorName:"msla-connection-selector-connector-name","hide-connection-options":"hide-connection-options",hideConnectionOptions:"hide-connection-options","hide-view-permissions-link":"hide-view-permissions-link",hideViewPermissionsLink:"hide-view-permissions-link","msla-drop-zone":"msla-drop-zone",mslaDropZone:"msla-drop-zone","connection-wizard":"connection-wizard",connectionWizard:"connection-wizard","connection-wizard-container":"connection-wizard-container",connectionWizardContainer:"connection-wizard-container","load-current-env-error-section":"load-current-env-error-section",loadCurrentEnvErrorSection:"load-current-env-error-section","ai-builder-trial-message-bar":"ai-builder-trial-message-bar",aiBuilderTrialMessageBar:"ai-builder-trial-message-bar","ms-Link":"ms-Link",msLink:"ms-Link","cds-provisioning-section":"cds-provisioning-section",cdsProvisioningSection:"cds-provisioning-section",templateManager:"templateManager","context-template-detail":"context-template-detail",contextTemplateDetail:"context-template-detail","template-use-flow-button":"template-use-flow-button",templateUseFlowButton:"template-use-flow-button","extend-trial-dialog":"extend-trial-dialog",extendTrialDialog:"extend-trial-dialog","btn-primary":"btn-primary",btnPrimary:"btn-primary","trial-expired":"trial-expired",trialExpired:"trial-expired","trial-extended-dialog":"trial-extended-dialog",trialExtendedDialog:"trial-extended-dialog","empty-space":"empty-space",emptySpace:"empty-space",option:"option",error:"error",options:"options",buttons:"buttons",content:"content","trial-dialog":"trial-dialog",trialDialog:"trial-dialog","trial-dialog-header":"trial-dialog-header",trialDialogHeader:"trial-dialog-header","trial-dialog-header-image":"trial-dialog-header-image",trialDialogHeaderImage:"trial-dialog-header-image","trial-dialog-content":"trial-dialog-content",trialDialogContent:"trial-dialog-content","trial-dialog-action":"trial-dialog-action",trialDialogAction:"trial-dialog-action","trial-dialog-action-button-group":"trial-dialog-action-button-group",trialDialogActionButtonGroup:"trial-dialog-action-button-group","trial-dialog-action-footer":"trial-dialog-action-footer",trialDialogActionFooter:"trial-dialog-action-footer","context-manage-create-connection":"context-manage-create-connection",contextManageCreateConnection:"context-manage-create-connection","debug-summary-pane":"debug-summary-pane",debugSummaryPane:"debug-summary-pane","support-title":"support-title",supportTitle:"support-title","support-message":"support-message",supportMessage:"support-message","debug-summary-pane--new":"debug-summary-pane--new",debugSummaryPaneNew:"debug-summary-pane--new","ms-Fabric":"ms-Fabric",msFabric:"ms-Fabric","invoke-flow-page":"invoke-flow-page",invokeFlowPage:"invoke-flow-page","full-page-single-action":"full-page-single-action",fullPageSingleAction:"full-page-single-action","flow-logo-image":"flow-logo-image",flowLogoImage:"flow-logo-image","full-page-single-action-header":"full-page-single-action-header",fullPageSingleActionHeader:"full-page-single-action-header","full-page-single-action-button":"full-page-single-action-button",fullPageSingleActionButton:"full-page-single-action-button","invoke-flow-form":"invoke-flow-form",invokeFlowForm:"invoke-flow-form","flow-header":"flow-header",flowHeader:"flow-header","flow-details-spinner-container":"flow-details-spinner-container",flowDetailsSpinnerContainer:"flow-details-spinner-container","invoke-flow-form-body":"invoke-flow-form-body",invokeFlowFormBody:"invoke-flow-form-body","additional-inputs-info":"additional-inputs-info",additionalInputsInfo:"additional-inputs-info","no-additional-input-text":"no-additional-input-text",noAdditionalInputText:"no-additional-input-text","flow-run-request-completion-content":"flow-run-request-completion-content",flowRunRequestCompletionContent:"flow-run-request-completion-content","mobile-icon":"mobile-icon",mobileIcon:"mobile-icon","flow-run-activity":"flow-run-activity",flowRunActivity:"flow-run-activity","edit-button":"edit-button",editButton:"edit-button","full-width-button":"full-width-button",fullWidthButton:"full-width-button","designerload-spinner-container":"designerload-spinner-container",designerloadSpinnerContainer:"designerload-spinner-container",inputParameterForm:"inputParameterForm","no-additional-input-text-wrapper":"no-additional-input-text-wrapper",noAdditionalInputTextWrapper:"no-additional-input-text-wrapper","modal-spinner-container":"modal-spinner-container",modalSpinnerContainer:"modal-spinner-container","see-details-divider":"see-details-divider",seeDetailsDivider:"see-details-divider","scroll-content":"scroll-content",scrollContent:"scroll-content","flow-run-data":"flow-run-data",flowRunData:"flow-run-data","widget-footer":"widget-footer",widgetFooter:"widget-footer","widget-consent":"widget-consent",widgetConsent:"widget-consent","para-microsoft-flow":"para-microsoft-flow",paraMicrosoftFlow:"para-microsoft-flow",horizontalContactCard:"horizontalContactCard","horizontalContactCard-iconContainer":"horizontalContactCard-iconContainer",horizontalContactCardIconContainer:"horizontalContactCard-iconContainer","context-icon-template":"context-icon-template",contextIconTemplate:"context-icon-template","horizontalContactCard-textContainer":"horizontalContactCard-textContainer",horizontalContactCardTextContainer:"horizontalContactCard-textContainer","horizontalContactCard-primaryText":"horizontalContactCard-primaryText",horizontalContactCardPrimaryText:"horizontalContactCard-primaryText","horizontalContactCard-secondaryText":"horizontalContactCard-secondaryText",horizontalContactCardSecondaryText:"horizontalContactCard-secondaryText","horizontalContactCard-innerTextContainer":"horizontalContactCard-innerTextContainer",horizontalContactCardInnerTextContainer:"horizontalContactCard-innerTextContainer",flowDetails:"flowDetails","flowDetails-title":"flowDetails-title",flowDetailsTitle:"flowDetails-title","flowDetails-title-text":"flowDetails-title-text",flowDetailsTitleText:"flowDetails-title-text","flowDetails-title-icon":"flowDetails-title-icon",flowDetailsTitleIcon:"flowDetails-title-icon","flowDetails-content":"flowDetails-content",flowDetailsContent:"flowDetails-content","flowDetails-description":"flowDetails-description",flowDetailsDescription:"flowDetails-description","flowDetails-infoCard":"flowDetails-infoCard",flowDetailsInfoCard:"flowDetails-infoCard","flowDetails-infoCard-iconContainer":"flowDetails-infoCard-iconContainer",flowDetailsInfoCardIconContainer:"flowDetails-infoCard-iconContainer","flowDetails-infoCard-icon":"flowDetails-infoCard-icon",flowDetailsInfoCardIcon:"flowDetails-infoCard-icon","flowDetails-permissionsSection":"flowDetails-permissionsSection",flowDetailsPermissionsSection:"flowDetails-permissionsSection","flowDetails-permissionTitle":"flowDetails-permissionTitle",flowDetailsPermissionTitle:"flowDetails-permissionTitle","flowDetails-permissions":"flowDetails-permissions",flowDetailsPermissions:"flowDetails-permissions","flowDetails-permission":"flowDetails-permission",flowDetailsPermission:"flowDetails-permission","flowDetails-permission--bold":"flowDetails-permission--bold",flowDetailsPermissionBold:"flowDetails-permission--bold","flowDetails-permissionSubtext":"flowDetails-permissionSubtext",flowDetailsPermissionSubtext:"flowDetails-permissionSubtext","flowDetails-infoCard-textContainer":"flowDetails-infoCard-textContainer",flowDetailsInfoCardTextContainer:"flowDetails-infoCard-textContainer","flowDetails-infoCard-description":"flowDetails-infoCard-description",flowDetailsInfoCardDescription:"flowDetails-infoCard-description","flowDetails-infoCard-description--bold":"flowDetails-infoCard-description--bold",flowDetailsInfoCardDescriptionBold:"flowDetails-infoCard-description--bold","flowDetails-infoCard-label":"flowDetails-infoCard-label",flowDetailsInfoCardLabel:"flowDetails-infoCard-label","inputParameterForm-inputParameter":"inputParameterForm-inputParameter",inputParameterFormInputParameter:"inputParameterForm-inputParameter","inputParameterForm-inputParameter--first":"inputParameterForm-inputParameter--first",inputParameterFormInputParameterFirst:"inputParameterForm-inputParameter--first","inputParameterForm-enumContainer":"inputParameterForm-enumContainer",inputParameterFormEnumContainer:"inputParameterForm-enumContainer","inputParameterForm-enum":"inputParameterForm-enum",inputParameterFormEnum:"inputParameterForm-enum","inputParameterForm-autoCompleteContainer":"inputParameterForm-autoCompleteContainer",inputParameterFormAutoCompleteContainer:"inputParameterForm-autoCompleteContainer","email-display-component":"email-display-component",emailDisplayComponent:"email-display-component","email-block":"email-block",emailBlock:"email-block","email-text":"email-text",emailText:"email-text","email-delete":"email-delete",emailDelete:"email-delete",filePicker:"filePicker","filePicker-selectedFileContainer":"filePicker-selectedFileContainer",filePickerSelectedFileContainer:"filePicker-selectedFileContainer","filePicker-selectedFileInput":"filePicker-selectedFileInput",filePickerSelectedFileInput:"filePicker-selectedFileInput","filePicker-fileInputIconContainer":"filePicker-fileInputIconContainer",filePickerFileInputIconContainer:"filePicker-fileInputIconContainer","filePicker-fileInputIconLabel":"filePicker-fileInputIconLabel",filePickerFileInputIconLabel:"filePicker-fileInputIconLabel","filePicker-fileInputIcon":"filePicker-fileInputIcon",filePickerFileInputIcon:"filePicker-fileInputIcon","email-consent-input":"email-consent-input",emailConsentInput:"email-consent-input","email-consent-not-required-text":"email-consent-not-required-text",emailConsentNotRequiredText:"email-consent-not-required-text","terms-and-conditions":"terms-and-conditions",termsAndConditions:"terms-and-conditions","fine-print":"fine-print",finePrint:"fine-print","privacy-link":"privacy-link",privacyLink:"privacy-link"}},33290:function(e,t,i){"use strict";var r=i(33291);i(33295),i(33324),r.a},33291:function(e,t,i){"use strict";var r=i(33279),n=(i(33292),i(33293),r.module("powerux",["ngAria","react"]));t.a=n},33295:function(e,t,i){"use strict";i(33296)},33296:function(e,t,i){"use strict";i(33297),i(33298),i(33312),i(33313),i(33314),i(33315),i(33316),i(33317),i(33318),i(33319),i(33320),i(33321),i(33322),i(33323)},33297:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33279),n=i(33291);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s={Never:31536e6},l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._$interval=void 0,this._options=void 0,this._getPollInterval=void 0,this._isPolling=void 0,this._intervalPromise=void 0,this._pollRefCount=0,this._isDestroyed=void 0,this._$interval=t,this._options=i,this._getPollInterval=()=>{var e=this._options.interval;return r.isFunction(e)?e():e}}var t,i,n;return t=e,(i=[{key:"destroy",value:function(){this._pollRefCount=0,this._clearScheduledPoll(),this._isPolling=!1,this._isDestroyed=!0}},{key:"start",value:function(e){this._isDestroyed||(this._pollRefCount++,e.$on("$destroy",()=>{this._pollRefCount--,this._pollRefCount<=0&&(this._pollRefCount=0,this._clearScheduledPoll(),this._isPolling=!1)}),this._isPolling||(this._schedulePoll(),this._isPolling=!0))}},{key:"reset",value:function(){this._isPolling&&(this._clearScheduledPoll(),this._schedulePoll())}},{key:"_schedulePoll",value:function(){this._intervalPromise=this._$interval(()=>{this._options.poll(),this._schedulePoll()},this._getPollInterval(),1)}},{key:"_clearScheduledPoll",value:function(){this._intervalPromise&&(this._$interval.cancel(this._intervalPromise),this._intervalPromise=null)}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();n.a.factory("poll",["$interval",e=>t=>new l(e,t)])},33298:function(e,t,i){"use strict";var r=i(33279),n=i(33299),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,r,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.refCountCacheFactory=t,this.resourceIdentifierFactory=i,this.resourceArrayFactory=r,this.config=o,this.resourceFunctions=a,this.refCountCache=void 0,this.resourceIdentifier=void 0,this.refCountCache=t(Object(n.e)(),{evictionDelay:this.config.options&&this.config.options.evictionDelay}),this.resourceIdentifier=i(o)}var t,i,o;return t=e,(i=[{key:"getOrCreate",value:function(e,t){return this.refCountCache.getOrPut(e,()=>{var i=this.resourceArrayFactory(this.config,e,this.resourceFunctions);return r.isFunction(t)&&t(i),i})}},{key:"release",value:function(e){return this.refCountCache.release(e,e=>{e&&e.$destroy()})}},{key:"peek",value:function(e){return this.refCountCache.peek(e)}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory("resourceArrayCacheFactory",["refCountCacheFactory","resourceIdentifierFactory","resourceArrayFactory",(e,t,i)=>(r,n)=>new l(e,t,i,r,n)])},33299:function(e,t,i){"use strict";var r=i(33300);i.d(t,"a",(function(){return r}));var n=i(33302);i.d(t,"b",(function(){return n}));var o=i(33306);i.d(t,"c",(function(){return o}));var a=i(33308);i.d(t,"d",(function(){return a}));var s=i(33311);i.d(t,"e",(function(){return s.a}))},33300:function(e,t,i){"use strict";i.r(t);var r=i(33301);i.d(t,"stableStringify",(function(){return r.a}))},33301:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(33302);function n(e,t){if(Object(r.isObject)(e)){"function"==typeof e.toJSON&&(e=e.toJSON());var i=[];for(var o in e)e.hasOwnProperty(o)&&(!t||t&&void 0!==e[o])&&i.push({key:o,value:e[o]});return i.sort((e,t)=>e.key<t.key?-1:1),"{"+i.map(e=>'"'.concat(e.key,'":')+n(e.value,t)).join(",")+"}"}return Array.isArray(e)?("function"==typeof e.toJSON&&(e=e.toJSON()),"["+e.map(e=>n(e,t)).join(",")+"]"):JSON.stringify(e)}},33302:function(e,t,i){"use strict";i.r(t);var r=i(33303);i.d(t,"forEach",(function(){return r.a}));var n=i(33304);i.d(t,"isObject",(function(){return n.a}));var o=i(33305);i.d(t,"map",(function(){return o.a}))},33303:function(e,t,i){"use strict";function r(e,t,i){for(var r in e)e.hasOwnProperty(r)&&t.call(i,{key:r,value:e[r]})}i.d(t,"a",(function(){return r}))},33304:function(e,t,i){"use strict";function r(e){return!(!e||"object"!=typeof e||e instanceof Date||e instanceof RegExp||Array.isArray(e))}i.d(t,"a",(function(){return r}))},33305:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(33303);function n(e,t,i){var n=[];return Object(r.a)(e,e=>{var r=t.call(i,e);null!=r&&n.push(r)}),n}},33306:function(e,t,i){"use strict";i.r(t);var r=i(33307);i.d(t,"equalsIgnoreCase",(function(){return r.a}))},33307:function(e,t,i){"use strict";function r(e,t){return(e=(""+e).toUpperCase())===(t=(""+t).toUpperCase())}i.d(t,"a",(function(){return r}))},33308:function(e,t,i){"use strict";i.r(t);var r=i(33309);i.d(t,"formatDottedUrl",(function(){return r.a}));var n=i(33310);i.d(t,"validateUrl",(function(){return n.a}))},33309:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33279),n=i(33302);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t,i,r){return new l(e,t).format(i,r)}var l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dottedUrlTemplate=void 0,this._dottedUrlBase=void 0,this._dottedUrlTemplate=i,this._dottedUrlBase=t}var t,i,a;return t=e,(i=[{key:"format",value:function(e,t){e=e||{},t=t||{};var i={},o=this._dottedUrlTemplate.replace(/:(\w+?)(\W|$)/g,(n,o,a)=>{if(!e[o])return""+a;var s=e[o];return"string"==typeof s&&"@"===s[0]&&(s=this._lookupDottedPath(t||{},s)),r.isFunction(s)&&(s=s()),i[o]=s,s+a}),a={};Object(n.forEach)(e,e=>{i[e.key]||(a[e.key]=r.isFunction(e.value)?e.value():e.value)}),o=(o=[this._dottedUrlBase,o].join("/")).split("://").map(e=>e.replace(/[\/]{2,}/g,"/")).join("://"),o=(o=this._encodeUri(o)).replace(/#/g,"%23");var s=this._getQueryString(a);return s&&(o=o+(/\?/.test(o)?"&":"?")+s),o}},{key:"_lookupDottedPath",value:function(e,t){try{return""+(t||"").split(".").reduce((e,t)=>e[t],e)}catch(i){return""}}},{key:"_getQueryString",value:function(e){return Object(n.map)(e,e=>{var t=this._camelCaseToHypens(e.key);return this._encodeQueryStringComponent(t)+"="+this._encodeQueryStringComponent(e.value)}).join("&")}},{key:"_camelCaseToHypens",value:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{key:"_encodeUri",value:function(e){return encodeURI(e).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+").replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}},{key:"_encodeQueryStringComponent",value:function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}}])&&o(t.prototype,i),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33310:function(e,t,i){"use strict";function r(e){return/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}i.d(t,"a",(function(){return r}))},33311:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));for(var r=[],n=0;n<256;n++)r[n]=(n<16?"0":"")+n.toString(16);function o(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,o=r[255&e]+r[e>>8&255]+r[e>>16&255]+r[e>>24&255],a=r[255&t]+r[t>>8&255]+"-"+r[t>>16&15|64]+r[t>>24&255],s=r[63&i|128]+r[i>>8&255]+"-"+r[i>>16&255]+r[i>>24&255],l=r[255&n]+r[n>>8&255]+r[n>>16&255]+r[n>>24&255];return"".concat(o,"-").concat(a,"-").concat(s,"-").concat(l)}},33312:function(e,t,i){"use strict";var r=i(33279),n=i(33302),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,n,o,a,s,l,c,u){var d;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$params=void 0,this.$promise=void 0,this.$resolved=!1,this.$lastModified=new Date,this.$nextLink=void 0,this._scope=void 0,this._config=void 0,this._resourceFunctions=void 0,this._resourceHttpClient=void 0,this._resourceIdentifier=void 0,this._poll=void 0,this._watcher=void 0,this._deferred=void 0,this._isApplying=!1,this._resourceArray=void 0,this._resourceWatches={},this._scope=t.$new(!0),this._deferred=i.defer(),this.$promise=this._deferred.promise,this.$params=c,this._config=l;var p=null===(d=this._config.options)||void 0===d?void 0:d.queryPollInterval;this._poll=n({poll:()=>this._refresh(!0),interval:r.isFunction(p)?()=>p(this.resourceArray):p}),this._watcher=o(()=>this.$lastModified.getTime(),[this]),this._resourceFunctions=u,this._resourceHttpClient=a(this._config),this._resourceIdentifier=s(this._config),this._resourceArray=[];["$params","$resolved","$promise","$lastModified","$nextLink","$destroy","$refresh","$remove","$hasNextPage","$getNextPage","$watch","$apply","$startPolling"].forEach(e=>{Object.defineProperty(this._resourceArray,e,{get:()=>{var t=this[e];if(r.isFunction(t)){var i=this;return function(){return t.apply(i,arguments)}}return t},set:t=>{this[e]=t},enumerable:!0})}),this._resourceArray.toJSON=()=>[].concat(this._resourceArray.map(e=>r.isFunction(e.toJSON)?e.toJSON():e))}var t,i,o;return t=e,(i=[{key:"resourceArray",get:function(){return this._resourceArray}},{key:"$destroy",value:function(){this._poll.destroy(),this._scope.$destroy(),this.$apply([])}},{key:"$startPolling",value:function(e){this.$promise.then(()=>{this._poll.start(e)})}},{key:"$refresh",value:function(){return this._refresh()}},{key:"$remove",value:function(e){return!!this._removeResource(e)&&(this.$apply(),!0)}},{key:"$hasNextPage",value:function(){return null!==this.$nextLink&&void 0!==this.$nextLink}},{key:"$getNextPage",value:function(){var e=r.extend({},this.$params,{url:this.$nextLink});return this._resourceHttpClient.query(null,e).then(e=>{if(e.modified||!this.$resolved)return this.$apply(e.data,!0),e.data}).catch(e=>{this._deferred.reject(e)})}},{key:"$watch",value:function(e,t,i){r.isArray(t)||(i=t,t=[]);var n=!0;return this._watcher.watch(e,t,()=>{var e;null===(e=i)||void 0===e||e(n),n=!1})}},{key:"$apply",value:function(e,t){this._isApplying||(this._isApplying=!0,e?this._isDataChanged(e)&&(this._merge(e,t),this.$nextLink=e.nextLink,this.$resolved=!0,this.$lastModified=new Date,this._deferred.resolve(e)):this.$lastModified=new Date,this._isApplying=!1)}},{key:"$query",value:function(e){var t=this.$params;return e&&(t=r.extend({},this.$params,{_poll:!0})),this._resourceHttpClient.query(null,t)}},{key:"_refresh",value:function(e){var t=this.$query(e);return t.then(e=>{!e.modified&&this.$resolved||this.$apply(e.data)}).catch(e=>{e.status>=400&&e.status<=499&&this._poll.destroy(),this._deferred.reject(e)}),e||this._poll.reset(),t}},{key:"_isDataChanged",value:function(e){var t;return!this.$resolved||null===(t=this._config.options)||void 0===t||!t.isResourceArrayChanged||this._config.options.isResourceArrayChanged(this.resourceArray.toJSON(),e)}},{key:"_merge",value:function(e,t){var i={},r={};if(e.forEach((e,t)=>{var n=this._resourceIdentifier.resourceToId(e);i[n]=e,r[n]=t}),!t){var o=[];this.resourceArray.forEach(e=>{var t=this._resourceIdentifier.resourceToId(e),r=i[t];r?(e.$apply(r),delete i[t]):o.push(e)}),o.forEach(e=>{this._removeResource(e)})}Object(n.forEach)(i,e=>{this._insertResource(r[e.key],e.value)})}},{key:"_getResource",value:function(e){return this.resourceArray.filter(t=>this._resourceIdentifier.doesResourceMatchParams(t,e))[0]}},{key:"_insertResource",value:function(e,t){var i=this._resourceIdentifier.resourceToParams(t);if(this._getResource(i))return!1;var r=this._resourceFunctions.create(i),n=this._resourceIdentifier.paramsToId(i);return r.$apply(t),this._resourceWatches[n]=r.$watch(this._scope,e=>{e||(this.$lastModified=r.$lastModified)}),e>=0?this._resourceArray.splice(e,0,r):this._resourceArray.push(r),!0}},{key:"_removeResource",value:function(e){for(var t=-1,i=0;i<this._resourceArray.length;i++)if(this._resourceArray[i]===e){t=i;break}if(t>=0){var r=this._resourceArray.splice(t,1)[0],n=this._resourceIdentifier.resourceToParams(r),o=this._resourceIdentifier.paramsToId(n);return this._resourceWatches[o]&&this._resourceWatches[o](),this._resourceFunctions.remove(n),!0}return!1}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory("resourceArrayFactory",["$rootScope","$q","poll","watcherFactory","resourceHttpClientFactory","resourceIdentifierFactory",(e,t,i,r,n,o)=>(a,s,c)=>new l(e,t,i,r,n,o,a,s,c).resourceArray])},33313:function(e,t,i){"use strict";var r=i(33279),n=i(33299),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.refCountCacheFactory=t,this.resourceFactory=i,this.config=r,this.refCountCache=void 0,this.refCountCache=t(Object(n.e)(),{evictionDelay:this.config.options&&this.config.options.evictionDelay})}var t,i,o;return t=e,(i=[{key:"getOrCreate",value:function(e,t){return this.refCountCache.getOrPut(e,()=>{var i=this.resourceFactory(this.config,e);return r.isFunction(t)&&t(i),i})}},{key:"release",value:function(e){return this.refCountCache.release(e,e=>{e&&e.$destroy()})}},{key:"peek",value:function(e){return this.refCountCache.peek(e)}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory("resourceCacheFactory",["refCountCacheFactory","resourceFactory",(e,t)=>i=>new l(e,t,i)])},33314:function(e,t,i){"use strict";var r=i(33279),n=i(33291);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resourceFactory=t,this.resourceCacheFactory=i,this.resourceArrayCacheFactory=r,this.resourceIdentifierFactory=n,this.resourceCachesByResourceType={}}var t,i,n;return t=e,(i=[{key:"getCaches",value:function(e){var t,i,n=e.options||{},o=n.atomize,a=n.atomizeGloballyByResourceType,s=e.resourceType;return a&&s?(this.resourceCachesByResourceType[s]||(this.resourceCachesByResourceType[s]=this.resourceCacheFactory(e)),t=this.resourceCachesByResourceType[s]):t=this.resourceCacheFactory(e),i=o?this.resourceArrayCacheFactory(e,{create:e=>t.getOrCreate(e),remove:e=>t.release(e)}):this.resourceArrayCacheFactory(e,{create:t=>this.resourceFactory(e,t),remove:e=>r.noop}),[t,i]}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.$inject=["resourceFactory","resourceCacheFactory","resourceArrayCacheFactory","resourceIdentifierFactory"],n.a.service("resourceCacheManager",s)},33315:function(e,t,i){"use strict";var r=i(33291);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resourceCacheManager=t,this.config=i,this.resourceCache=void 0,this.resourceArrayCache=void 0,[this.resourceCache,this.resourceArrayCache]=t.getCaches(i)}var t,i,r;return t=e,(i=[{key:"getOrCreateResource",value:function(e,t,i){var r=this.resourceCache.getOrCreate(t,i);return e.$on("$destroy",()=>{this.resourceCache.release(t)}),r}},{key:"getOrCreateResourceArray",value:function(e,t,i){var r=this.resourceArrayCache.getOrCreate(t,i);return e.$on("$destroy",()=>{this.resourceArrayCache.release(t)}),r}},{key:"peekAtResource",value:function(e){return this.resourceCache.peek(e)}},{key:"peekAtResourceArray",value:function(e){return this.resourceArrayCache.peek(e)}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.factory("resourceDataSetFactory",["resourceCacheManager",e=>t=>new a(e,t)])},33316:function(e,t,i){"use strict";var r=i(33279),n=i(33302),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,n,o,a,s,l){var c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$params=void 0,this.$promise=void 0,this.$resolved=!1,this.$lastModified=new Date,this._config=void 0,this._resourceHttpClient=void 0,this._poll=void 0,this._watcher=void 0,this._deferred=void 0,this._isApplying=!1,this._deferred=i.defer(),this.$promise=this._deferred.promise,this.$params=l,this._config=s;var u=null===(c=this._config.options)||void 0===c?void 0:c.getPollInterval;this._poll=n({poll:()=>this._refresh(!0),interval:r.isFunction(u)?()=>u(this):u}),this._watcher=o(()=>this.$lastModified.getTime(),[this]),this._resourceHttpClient=a(this._config),Object.keys(this._config.actions||{}).forEach(e=>{this["$"+e]=t=>this._resourceHttpClient.action(e,null,this.$params,t)})}var t,i,o;return t=e,(i=[{key:"$destroy",value:function(){this._poll.destroy()}},{key:"$startPolling",value:function(e){this.$promise.then(()=>{this._poll.start(e)})}},{key:"$refresh",value:function(){return this._refresh()}},{key:"$watch",value:function(e,t,i){r.isArray(t)||(i=t,t=[]);var n=!0;return this._watcher.watch(e,t,()=>{var e;null===(e=i)||void 0===e||e(n),n=!1})}},{key:"$apply",value:function(e){this._isApplying||(this._isApplying=!0,e?this._isDataChanged(e)&&(this._merge(e),this.$resolved=!0,this.$lastModified=new Date,this._deferred.resolve(e)):this.$lastModified=new Date,this._isApplying=!1)}},{key:"$get",value:function(e){var t=this.$params;return e&&(t=r.extend({},this.$params,{_poll:!0})),this._resourceHttpClient.get(null,t)}},{key:"$put",value:function(){var e=this._resourceHttpClient.put(null,this.$params,this);return e.then(()=>this.$apply()),e}},{key:"$post",value:function(){var e=this._resourceHttpClient.post(null,this.$params,this);return e.then(()=>this.$apply()),e}},{key:"$patch",value:function(e){var t=this._resourceHttpClient.patch(null,this.$params,e);return t.then(()=>this.$apply(e)),t}},{key:"$delete",value:function(){return this._resourceHttpClient.delete(null,this.$params)}},{key:"toJSON",value:function(){var e={};return Object(n.forEach)(this,t=>{this._isReservedProperty(this,t.key)||(e[t.key]=t.value)}),e}},{key:"_refresh",value:function(e){var t=this.$get(e);return t.then(e=>{!e.modified&&this.$resolved||this.$apply(e.data)}).catch(e=>{e.status>=400&&e.status<=499&&this._poll.destroy(),this._deferred.reject(e)}),e||this._poll.reset(),t}},{key:"_isDataChanged",value:function(e){var t;return!this.$resolved||null===(t=this._config.options)||void 0===t||!t.isResourceChanged||this._config.options.isResourceChanged(this.toJSON(),e)}},{key:"_merge",value:function(e){this._mergeObjects(this,e)}},{key:"_mergeObjects",value:function(e,t){Object(n.forEach)(t,t=>{this._isReservedProperty(e,t.key)||void 0===typeof t.value||(Object(n.isObject)(e[t.key])&&Object(n.isObject)(t.value)?this._mergeObjects(e[t.key],t.value):e[t.key]=t.value)}),Object.keys(e).forEach(i=>{this._isReservedProperty(e,i)||t.hasOwnProperty(i)||delete e[i]})}},{key:"_isReservedProperty",value:function(e,t){return e===this&&(0===t.indexOf("_")||0===t.indexOf("$")||r.isFunction(e[t]))}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory("resourceFactory",["$rootScope","$q","poll","watcherFactory","resourceHttpClientFactory",(e,t,i,r,n)=>(o,a)=>new l(e,t,i,r,n,o,a)])},33317:function(e,t,i){"use strict";var r=i(33279),n=i(33299),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._$q=void 0,this._$http=void 0,this._rest=void 0,this._actions=void 0,this._config=void 0,this._$q=t,this._$http=i,this._config=o;var a={query:{method:"GET",urlPath:this._urlPathToArrayPath(o.urlPath)},get:{method:"GET",urlPath:o.urlPath},put:{method:"PUT",urlPath:o.urlPath},post:{method:"POST",urlPath:o.urlPath},patch:{method:"PATCH",urlPath:o.urlPath},delete:{method:"DELETE",urlPath:o.urlPath}};this._rest=a,n.b.forEach(o.rest||{},e=>{var t,i;this._rest[e.key]=r.extend({},a[e.key]||{},e.value),this._rest[e.key].headers=r.extend({},o.headers||{},(null===(t=e.value)||void 0===t?void 0:t.headers)||{}),this._rest[e.key].params=r.extend({},o.params||{},(null===(i=e.value)||void 0===i?void 0:i.params)||{})}),this._actions={},n.b.forEach(o.actions||{},e=>{this._actions[e.key]=r.extend({},e.value),this._actions[e.key].headers=r.extend({},o.headers||{},e.value.headers),this._actions[e.key].params=r.extend({},o.params||{},e.value.params)})}var t,i,o;return t=e,(i=[{key:"query",value:function(e,t){return this._request(this._rest.query,e,t)}},{key:"get",value:function(e,t){return this._request(this._rest.get,e,t)}},{key:"put",value:function(e,t,i){return this._request(this._rest.put,e,t,i)}},{key:"post",value:function(e,t,i){return this._request(this._rest.post,e,t,i)}},{key:"patch",value:function(e,t,i){return this._request(this._rest.patch,e,t,i)}},{key:"delete",value:function(e,t){return this._request(this._rest.delete,e,t)}},{key:"action",value:function(e,t,i,r){var n=this._actions[e];if(!n)throw new Error("resourceHttpClient: action ".concat(e," not defined"));return this._request(n,t,i,r)}},{key:"_request",value:function(t,i,o,a){i=r.extend({},t.headers||{},this._config.headers||{},i||{}),o=r.extend({},t.params||{},this._config.params||{},o||{}),a=r.extend({},this._toJSON(t.data)||{},this._toJSON(a)||{});var s=r.extend({},t);delete s.params,delete s.data,o.url?s.url=o.url:s.url=n.d.formatDottedUrl(this._config.urlBase,t.urlPath||"",o,a),s.headers=i,s.data=/^(POST|PUT|PATCH)$/i.test(s.method)?a:void 0,t.requestInterceptor&&t.requestInterceptor&&(s=t.requestInterceptor(s));var l=!0;n.c.equalsIgnoreCase(s.method,"GET")&&this._prependResponseTransformer(s,t=>{if("string"==typeof t){var i=(s.url||"").replace(/[?|&]_.+?=.+?(?=(&|$))/gi,"").toLowerCase();t===e.responseBodyCache[i]&&(l=!1),e.responseBodyCache[i]=t}return t});var c=this._$http(s);return t.isODataArray&&(c=c.then(e=>this._processODataArrayResponse(e,t.lazyPaging||!1))),c=c.then(e=>(e.modified=l,e)),t.responseInterceptor&&(c=c.then(e=>{var i,n=null===(i=t.responseInterceptor)||void 0===i?void 0:i.call(t,e);return r.isFunction(n.then)?n.then(t=>(e.data=t,e)):(e.data=n,e)})),c}},{key:"_urlPathToArrayPath",value:function(e){var t,i=e.split("/");return i.length&&0===(null===(t=i.pop())||void 0===t?void 0:t.indexOf(":"))&&(e=i.join("/")),e}},{key:"_processODataArrayResponse",value:function(e,t){if(Array.isArray(e.data))return e.data;var i=this._$q.defer(),n=[],o=a=>{var s=Array.isArray(a.data)?a.data:a.data.value||[];if(n.push.apply(n,s),a.data&&a.data.nextLink)if(t)n.nextLink=a.data.nextLink,e.data=n,i.resolve(e);else{var l=r.extend({},e.config);l.url=a.data.nextLink,this._$http(l).then(o)}else e.data=n,i.resolve(e)};return o(e),i.promise}},{key:"_prependResponseTransformer",value:function(e,t){var i=e.transformResponse||this._$http.defaults.transformResponse,n=r.isArray(i)?i:[i];(n=n.slice()).unshift(t),e.transformResponse=n}},{key:"_toJSON",value:function(e){return e&&r.isFunction(e.toJSON)?e.toJSON():e}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.responseBodyCache={},o.a.factory("resourceHttpClientFactory",["$q","$http",(e,t)=>i=>new l(e,t,i)])},33318:function(e,t,i){"use strict";var r=i(33279),n=i(33299),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=void 0,this._config=t}var t,i,o;return t=e,(i=[{key:"resourceToParams",value:function(e){return this._config.resourceToParams(e)}},{key:"paramsToId",value:function(e){return e=e||{},r.isFunction(e.toJSON)&&(e=e.toJSON()),n.b.isObject(e)&&(e=r.extend({},e||{})),n.b.isObject(e)&&(e=r.extend({},e),Object.keys(e).forEach(t=>{r.isFunction(e[t])&&(e[t]=e[t]())})),n.a.stableStringify(e)}},{key:"resourceToId",value:function(e){return this.paramsToId(this.resourceToParams(e))}},{key:"doesResourceMatchParams",value:function(e,t){var i=this.paramsToId(t),r=this.resourceToId(e);return n.c.equalsIgnoreCase(i,r)}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory("resourceIdentifierFactory",()=>e=>new l(e))},33319:function(e,t,i){"use strict";var r=i(33291);function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n(this,e),this.watchExpression=t,this.defaultDependencies=i}var t,i,r;return t=e,(i=[{key:"watch",value:function(e,t,i){return t=[].concat(this.defaultDependencies,t),e.$watchGroup([this.watchExpression,()=>t.every(e=>e.$resolved)],(e,t)=>{var[r,n]=e,[o]=t;n&&i(r,o)})}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.factory("watcherFactory",()=>(e,t)=>new s(e,t))},33320:function(e,t,i){"use strict";var r=i(33279),n=i(33302);i(33291).a.factory("azureResourceClientFactory",["resourceClientFactory","AppSettings",e=>t=>{var i={apiVersion:t.apiVersion||"2016-01-01-alpha"},o={urlBase:t.urlBase||"https://management.azure.com",urlPath:t.urlPath||"",resourceType:t.resourceType,resourceToParams:t.resourceToParams||(e=>({id:e.id})),headers:t.headers,params:r.extend({},i,t.params||{}),options:t.options},a={query:{isODataArray:!0},get:{urlPath:":id",params:{id:"@id"}},put:{urlPath:":id",params:{id:"@id"}},post:{urlPath:":id",params:{id:"@id"}},patch:{urlPath:":id",params:{id:"@id"}},delete:{urlPath:":id",params:{id:"@id"}}};return o.rest=a,t.rest&&Object(n.forEach)(t.rest,e=>{a[e.key]=r.extend(a[e.key]||{},e.value)}),o.actions={},t.actions&&t.actions.forEach(e=>{var t="string"==typeof e?{name:e}:e,i={urlPath:":id/"+t.name,method:"POST",params:{id:"@id"}};o.actions&&(o.actions[t.name]=r.extend({},i,t))}),e(o)}])},33321:function(e,t,i){"use strict";var r=i(33279),n=i(33291);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=void 0,this._$interval=void 0,this._cache=void 0,this._references={},this._$interval=t,this.options=r.extend({},{evictionDelay:0},o||{}),this._cache=i(n,this.options)}var t,i,n;return t=e,(i=[{key:"info",value:function(){return this._cache.info()}},{key:"put",value:function(e,t){this._cache.hasKey(e)||void 0===t||this._incrementReferences(e),this._cache.put(e,t)}},{key:"get",value:function(e){return this._cache.hasKey(e)&&this._incrementReferences(e),this._cache.get(e)}},{key:"getOrPut",value:function(e,t){if(this._cache.hasKey(e))return this.get(e);var i=r.isFunction(t)?t():t;return this.put(e,i),i}},{key:"peek",value:function(e){return this._cache.get(e)}},{key:"release",value:function(e,t){this._decrementReferences(e)<=0&&this.remove(e,t)}},{key:"remove",value:function(e,t){this._scheduleEviction(this._cache.serializeKey(e),t)}},{key:"removeAll",value:function(e){Object.keys(this._references).forEach(t=>{this._scheduleEviction(t,e)})}},{key:"hasKey",value:function(e){return this._cache.hasKey(e)}},{key:"serializeKey",value:function(e){return this._cache.serializeKey(e)}},{key:"destroy",value:function(e){this.options.evictionDelay=0,this.removeAll(e),this._references={},this._cache.destroy()}},{key:"_scheduleEviction",value:function(e,t){delete this._references[e];var i=()=>{if(!(this._references[e]>0)){var i=this._cache.raw().get(e);this._cache.raw().remove(e),t&&t(i)}};this.options.evictionDelay&&this.options.evictionDelay>0?this._$interval(i,this.options.evictionDelay,1):i()}},{key:"_incrementReferences",value:function(e){var t=this._cache.serializeKey(e);return this._references[t]?this._references[t]++:this._references[t]=1,this._references[t]}},{key:"_decrementReferences",value:function(e){var t=this._cache.serializeKey(e);return!this._references[t]||this._references[t]<0?delete this._references[t]:this._references[t]--,this._references[t]||0}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();n.a.factory("refCountCacheFactory",["$interval","typedCacheFactory",(e,t)=>(i,r)=>{if(r&&r.capacity)throw new Error("refCountCacheFactory: ref-counted caches cannot have a capacity");return new s(e,t,i,r)}])},33322:function(e,t,i){"use strict";var r=i(33279),n=i(33297),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l={atomize:!0,atomizeGloballyByResourceType:!0,getPollInterval:n.a.Never,queryPollInterval:n.a.Never,evictionDelay:0},c=function(){function e(t,i,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.resourceHttpClient=void 0,this.resourceDataSet=void 0,this.$q=t,o.options=r.extend({},l,o.options||{}),this.resourceHttpClient=i(o),this.resourceDataSet=n(o),Object.keys(o.actions||{}).forEach(e=>{this[e]=(t,i)=>this.resourceHttpClient.action(e,null,t,i)})}var t,i,n;return t=e,(i=[{key:"query",value:function(e,t){var i=this.resourceDataSet.getOrCreateResourceArray(e,t,e=>{e.$refresh()});return i.$startPolling(e),i}},{key:"get",value:function(e,t){var i=this.resourceDataSet.getOrCreateResource(e,t,e=>{e.$refresh()});return i.$startPolling(e),i}},{key:"put",value:function(e,t){return this.resourceHttpClient.put(null,e,t)}},{key:"post",value:function(e,t){return this.resourceHttpClient.post(null,e,t)}},{key:"patch",value:function(e,t){return this.resourceHttpClient.patch(null,e,t)}},{key:"delete",value:function(e){return this.resourceHttpClient.delete(null,e)}},{key:"refreshQuery",value:function(e){var t=this.$q.defer(),i=this.resourceDataSet.peekAtResourceArray(e);return i?i.$refresh().then(()=>t.resolve(),e=>t.reject(e)):t.resolve(),t.promise}},{key:"refresh",value:function(e){var t=this.$q.defer(),i=this.resourceDataSet.peekAtResource(e);return i?i.$refresh().then(()=>t.resolve(),e=>t.reject(e)):t.resolve(),t.promise}},{key:"updateQueryCache",value:function(){var e,t,i;arguments.length<=2?(e=arguments[0],t=void 0,i=arguments[1]):(e=arguments[0],t=arguments[1],i=arguments[2]);var r=this.resourceDataSet.getOrCreateResourceArray(e,t);r.$apply(i)}},{key:"updateCache",value:function(e,t,i){this.resourceDataSet.getOrCreateResource(e,t).$apply(i)}}])&&a(t.prototype,i),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory("resourceClientFactory",["$q","resourceHttpClientFactory","resourceDataSetFactory",(e,t,i)=>r=>new c(e,t,i,r)])},33323:function(e,t,i){"use strict";var r=i(33279),n=i(33300),o=i(33291);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=void 0,this._cache=void 0,this.options=r.extend({},{serializeKey:n.stableStringify},o||{}),this._cache=t(i,this.options)}var t,i,o;return t=e,(i=[{key:"info",value:function(){return this._cache.info()}},{key:"put",value:function(e,t){this._cache.put(this.serializeKey(e),t)}},{key:"get",value:function(e){return this._cache.get(this.serializeKey(e))}},{key:"remove",value:function(e){this._cache.remove(this.serializeKey(e))}},{key:"removeAll",value:function(){this._cache.removeAll()}},{key:"hasKey",value:function(e){return void 0!==this.get(e)}},{key:"serializeKey",value:function(e){var t,i;return(null===(t=(i=this.options).serializeKey)||void 0===t?void 0:t.call(i,e))||""}},{key:"destroy",value:function(){this._cache.destroy()}},{key:"raw",value:function(){return this._cache}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory("typedCacheFactory",["$cacheFactory",e=>(t,i)=>new l(e,t,i)])},33324:function(e,t,i){"use strict";var r=i(33279);i(33291).a.directive("svgSrc",["$http",e=>({restrict:"A",template:'<span class="svg-container"></span>',replace:!0,priority:99,link:(t,i,n)=>{n.$observe("svgSrc",t=>{var n;t&&(n=t,e({method:"GET",url:n,headers:{"Content-Type":"application/xml"},cache:!0})).then(e=>{if(200===e.status){var t=e.data,n=r.element(t);i.empty().append(n)}})})}})])},33325:function(e,t,i){"use strict";i(33326),i(33342),i(33516),i(33517),i(33536),i(33559),i(33768),i(33791),i(33980),i(34182),i(34189),i(34196),i(31434),i(34213),i(34216),i(34218),i(34222),i(34224)},33326:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(33279),n=i(33327),o=i(33328),a=i(33331),s=i(33334),l=i(33335),c=i(33338),u=i(33339),d=(i(33292),r.module(n.a.modules.processSimple,[i(33340),n.a.modules.react,o.a.name,s.a.name,l.a.name,c.a.name,u.a.name,a.a.name]))},33327:function(e,t,i){"use strict";t.a={modules:{ngResource:"ngResource",ngRoute:"ngRoute",ngAria:"ngAria",ngSanitize:"ngSanitize",processSimple:"processSimple",processSimpleComponents:"processSimple.components",processSimpleData:"processSimple.data",processSimpleDirectives:"processSimple.directives",processSimpleInterceptors:"processSimple.interceptors",processSimpleResources:"processSimple.resources",processSimpleServices:"processSimple.services",powerUx:"powerux",react:"react",reactDirective:"reactDirective"},providers:{$compileProvider:"$compileProvider",$httpProvider:"$httpProvider",$locationProvider:"$locationProvider",authenticationProvider:"authenticationProvider",route:"route",routeProvider:"routeProvider"},components:{widgetConsent:"widgetConsent",inputParameterForm:"inputParameterForm",filePicker:"filePicker",emailDisplay:"emailDisplay",flowDetails:"flowDetails",flowContactCard:"flowContactCard",horizontalContactCard:"horizontalContactCard",fullPageSingleAction:"fullPageSingleAction",flowSendACopyPanel:"flowSendACopyPanel",autocomplete:"autocomplete",alert:"alert",apis:"apis",approvalCenter:"approvalCenter",approvals:{approvalCard:"approvalCard",emptyApprovals:"emptyApprovals",firstDayApprovals:"firstDayApprovals",receivedTab:"receivedTab",sentTab:"sentTab"},avatar:"avatar",backbutton:"backbutton",confirmDialog:"confirmDialog",connectionWizard:"connectionWizard",connectionDisambiguation:"connectionDisambiguation",createConnection:"createConnection",customConnectorDialog:"customConnectorDialog",customApi:{codeTab:"customApiCodeTab",customApiAction:"customApiAction",customApiDefinition:"customApiDefinition",customApiParameter:"customApiParameter",customApiPolicy:"customApiPolicy",customApiResponse:"customApiResponse",customApiTabNavigation:"customApiTabNavigation",customApiTestTab:"customApiTestTab",customApiTrigger:"customApiTrigger",definitionTab:"customApiDefinitionTab",detailsTab:"customApiDetailsTab",importSection:"customApiImportSection",generalTab:"customApiGeneralTab",propertiesPane:"propertiesPane",securityTab:"customApiSecurityTab",shareTab:"customApiShareTab",swaggerEditorTab:"customApiSwaggerEditorTab",copilotTab:"customApiCopilotTab",customApiCopilotAction:"customApiCopilotAction",customApiCopilotParameter:"customApiCopilotParameter",reactCustomApiSecurityTabWrapper:"reactCustomApiSecurityTabWrapper"},dialogButtons:"dialogButtons",flowAnalytics:"flowAnalytics",flowCreationWidget:"flowCreationWidget",flowOwners:"flowOwners",flowSaveAsDialog:"flowSaveAsDialog",flowPermissionsList:"flowPermissionsList",flowTiles:{flowRunOnlyTile:"flowRunOnlyTile"},foldingList:"foldingList",fullPageError:"fullPageError",graphAutocomplete:"graphAutocomplete",heading:"heading",importFromSamplePanel:"importFromSamplePanel",infoCard:"infoCard",infoCardList:"infoCardList",infoPane:"infoPane",invokeFlow:{invokeFlowPage:"invokeFlowPage",invokeFlowForm:"invokeFlowForm",invokeFlowWidgetV2:"invokeFlowWidgetV2"},learnMore:"learnMore",messageBar:"messageBar",modalDialog:"modalDialog",parameterDropdownEditor:"parameterDropdownEditor",psList:"psList",react:{reactPeoplePicker:"reactPeoplePicker",reactDatePicker:"reactDatePicker",reactCheckbox:"reactCheckbox",reactSendACopyPanel:"reactSendACopyPanel",reactFlowCreatorCdsProvisioning:"reactFlowCreatorCdsProvisioning",reactBackButton:"reactBackButton",reactButtonGroup:"reactButtonGroup",reactRecommendationPanel:"reactRecommendationPanel",reactContextualHelpPanel:"reactContextualHelpPanel",reactFlowCheckerPanel:"reactFlowCheckerPanel",reactTestFlowPanel:"reactTestFlowPanel",reactIconSet:"reactIconSet",reactActionButton:"reactActionButton",reactButtonWithCustomMenu:"reactButtonWithCustomMenu",reactCoachmarkWithTeachingBubble:"reactCoachmarkWithTeachingBubble",reactChoiceGroup:"reactChoiceGroup",reactChoiceGroupWithLink:"reactChoiceGroupWithLink",reactCopyableTextField:"reactCopyableTextField",reactContactCards:"reactContactCards",reactDropdown:"reactDropdown",reactDropdownSwaggerStyle:"reactDropdownSwaggerStyle",reactFileImport:"reactFileImport",reactDefaultButton:"reactDefaultButton",reactDialog:"reactDialog",reactDivider:"reactDivider",reactIconButton:"reactIconButton",reactLabel:"reactLabel",reactMonacoEditor:"reactMonacoEditor",reactPersona:"reactPersona",reactSpinner:"reactSpinner",reactTextField:"reactTextField",reactTextFieldWithInlineButton:"reactTextFieldWithInlineButton",reactTextMessageBar:"reactTextMessageBar",reactTextMessageBarWithLink:"reactTextMessageBarWithLink",reactToggle:"reactToggle",reactRunsPage:"reactRunsPage",reactTokenBlock:"reactTokenBlock",reactActionHeading:"reactActionHeading",reactRemediationPane:"reactRemediationPane",reactEasyAutomationPanel:"reactEasyAutomationPanel",reactWidgetFooter:"reactWidgetFooter",reactDefaultNpsDialog:"reactDefaultNpsDialog",reactCustomConnectorSecurityTab:"reactCustomConnectorSecurityTab"},ngReactBridge:{ngFlowSendACopyUI:"ngFlowSendACopyUi",ngFlowSaveAsUI:"ngFlowSaveAsUi",ngFlowRunOnlyUsersUI:"ngFlowRunOnlyUsersUi"},schemaProperty:"schemaProperty",spinner:"spinner",swaggerEditor:"swaggerEditor",templateManager:"templateManager",trialExpired:"trialExpired",userAutocomplete:"userAutocomplete",xrmSystemUserAutocomplete:"xrmSystemUserAutocomplete",zeroCustomApis:"zeroCustomApis",zeroFlowRuns:"zeroFlowRuns",zeroFlowRunsSlideInPane:"zeroFlowRunsSlideInPane",flowRuns:"flowRuns",validatedInput:"validatedInput",validationResults:"validationResults",validationResultTooltip:"validationResultTooltip",submitTemplate:"submitTemplate",propertyTile:"propertyTile",ngCommands:"ngCommands",zeroActivities:"zeroActivities",activityFeed:"activityFeed",templateDetails:"templateDetails",options:"options",viewPermissionsDialog:"viewPermissionsDialog",flow:"flow",ngInvokeFlowPanelWrapper:"ngInvokeFlowPanelWrapper",trialDialog:"trialDialog",flowRemediationPane:"flowRemediationPane"},directives:{connectionForm:"connectionForm",actvityFeedList:"activityFeedList",apiList:"apiList",listCommands:"listCommands",flowRunList:"flowRunList",cdnSrc:"cdnSrc",flowDesigner:"flowDesigner",flowMonitor:"flowMonitor",imgOnErrorSrc:"imgOnErrorSrc",ngBindHtmlCompile:"ngBindHtmlCompile",onInputFileChange:"onInputFileChange",validateMultipleEmails:"validateMultipleEmails"},services:{userConsent:"userConsent",installFlowService:"installFlowService",geocode:"geocode",gatewaysClient:"gatewaysClient",userDetailsStore:"userDetailsStore",$document:"$document",$element:"$element",$http:"$http",$interval:"$interval",$location:"$location",$q:"$q",$provide:"$provide",$route:"$route",$routeParams:"$routeParams",$rootElement:"$rootElement",$rootScope:"$rootScope",$sce:"$sce",$scope:"$scope",$timeout:"$timeout",$window:"$window",$compile:"$compile",approvalsClient:"approvalsClient",approvalRequestsClient:"approvalRequestsClient",approvalViewsClient:"approvalViewsClient",assetService:"assetService",authentication:"authentication",businessAppPlatformService:"businessAppPlatformService",designerRenderService:"designerRenderService",domHelper:"domHelper",environment:"environment",environmentService:"environmentService",feedEventDefinitionsClient:"feedEventDefinitionsClient",fileReaderHelperService:"fileReaderHelperService",hostCommunicationService:"hostCommunication",logging:"logging",markdownService:"markdownService",navigation:"navigation",reactNavigation:"reactNavigation",policy:"policyService",promiseHelperService:"promiseHelperService",routeCrafter:"routeCrafter",session:"session",telemetry:"telemetry",token:"token",widgetUtilService:"widgetUtilService",cdnService:"cdnService",flowsClient:"flowsClient",flowRunsClient:"flowRunsClient",flowRunsHistoryCsvDownloadService:"flowRunsHistoryCsvDownloadService",backend:"backend",dateTime:"dateTime",flowTriggerHistoriesClient:"flowTriggerHistoriesClient",flowRun:"flowRun",flowConnectionsClient:"flowConnectionsClient",poll:"poll",runInstanceService:"runInstanceService",flowTriggersClient:"flowTriggersClient",templatesClient:"templatesClient",templateCreationHelper:"templateCreationHelper",templatePublish:"templatePublish",url:"url",ngCommandService:"ngCommandService",permissionsClient:"permissionsClient",flowRoleService:"flowRoleService",flowRoleStore:"flowRoleStore",flowStore:"flowStore",graph:"graph",flowRunHistoryService:"flowRunHistoryService",flowRunsTriggerOutputsStore:"flowRunsTriggerOutputsStore",appSettings:"AppSettings",clientResources:"clientResources",apisClient:"apisClient",multiAuthServiceSelector:"multiAuthServiceSelector",xrmPermissionsService:"xrmPermissionsService",apisClientLA:"apisClientLA",azureBlobUploaderService:"azureBlobUploaderService",connectionForm:"connectionForm",connectionHelper:"connectionHelper",connectionsClient:"connectionsClient",codeEditorData:"codeEditorData",customApiHelper:"customApiHelper",customConnectorUrlService:"customConnectorUrlService",policyConfigurationService:"policyConfigurationService",policyConversionService:"policyConversionService",policyDataService:"policyDataService",policyTemplatesClient:"policyTemplatesClient",swaggerEditorData:"swaggerEditorData",securityDetailsValidationService:"securityDetailsValidationService",swaggerValidationService:"swaggerValidationService",copilotPluginValidationService:"copilotPluginValidationService",apisClientARM:"apisClientARM",apisClientGithub:"apisClientGithub",azureResourceClientFactory:"azureResourceClientFactory",universalSearchService:"universalSearchService",connectorHideKey:"connectorHideKey",powerAppsUserSettingsClient:"powerAppsUserSettingsClient",storage:"storage",designerConfig:"designerConfig",designerDocumentationLinkService:"designerDocumentationLinkService",designerOperationResultSchemaService:"designerOperationResultSchemaService",designerValidationService:"designerValidationService",xrmChildFlowsClient:"xrmChildFlowsClient",analytics:"analytics",gateway:"gateway",xrmMachineManagement:"xrmMachineManagement",rpaLocal:"rpaLocal",doNotShowAgain:"doNotShowAgain",flow:"flow",graphService:"graphService",codeSnippet:"codeSnippet",connection:"connection",environmentCapability:"environmentCapability",flowRunInputsOutputs:"flowRunInputsOutputs",rpaSeleniumRecording:"rpaSeleniumRecording",uiFlow:"uiFlow",designerCreateContext:"designerCreateContext",flowRolesClient:"flowRolesClient",designerCoreLoader:"designerCoreLoader",apiOperation:"apiOperation",designerOperations:"designerOperations",designerUserPreference:"designerUserPreference",trialDialog:"trialDialog",entitlements:"entitlements",entitlementsClient:"entitlementsClient",policies:"policies",plansClientCreateAndRenew:"plansClientCreateAndRenew",powerbiClientService:"powerbiClientService",flowAnalyticsService:"flowAnalyticsService",xrmService:"xrmService",parameterValidationServices:{sharepointDatasetParameterValidationService:"sharepointDatasetParameterValidationService"},ngReactBridge:{ngFlowRunOnlyUsersUI:"ngFlowRunOnlyUsersUI",ngFlowService:"ngFlowService"},ngUrl:"ngUrl",sharePointPermissionService:"sharePointPermissionService",xrmSystemUsersClient:"xrmSystemUsersClient",xrmRolesClient:"xrmRolesClient",flowPermissions:"flowPermissions",flowrunsService:"flowrunsService",xrmEntityClient:"xrmEntityClient",triggerService:"triggerService",xrmWorkflowClient:"xrmWorkflowClient",flowDraftClient:"flowDraftClient",presenceService:"presenceService",presenceStore:"presenceStore",flowUndoService:"flowUndoService",xrmUserService:"xrmUserService",xrmConnectionReferenceService:"xrmConnectionReferenceService",xrmConnectionReferenceStore:"xrmConnectionReferenceStore",designerConnectionStore:"designerConnectionStore",uiFlowRunService:"uiFlowRunService",uiFlowRunStore:"uiFlowRunStore",desktopFlowAIHttpClient:"desktopFlowAIHttpClient",desktopFlowRuntimeHttpClient:"desktopFlowRuntimeHttpClient",flowHttpClient:"flowHttpClient",flowRpHttpClient:"flowRpHttpClient",gptService:"gptService",xrmRecommendation:"xrmRecommendation",flowCheckerService:"flowCheckerService",flowTriggerCallbackUrlClient:"flowTriggerCallbackUrlClient",modernFlowClient:"modernFlowClient",environmentsClient:"environmentsClient",algorithms:"algorithms",storageCacheFactory:"storageCacheFactory",alertService:"alertService",licenseManagement:"licenseManagement",consentService:"consentService",plan:"plan",planService:"planService",planStore:"planStore",oAuthService:"oAuthService",aiHostedModelsService:"aiHostedModelsService",solutionService:"solutionService",winAutomationService:"winAutomationService",neptuneService:"neptuneService",neptuneHttpClient:"neptuneHttpClient",azureResourceGraphHttpClient:"azureResourceGraphHttpClient",desktopFlowStore:"desktopFlowStore",ppapiService:"ppapiService",flowSupportChecker:"flowSupportChecker",teamsDeepLinkService:"teamsDeepLinkService"},interceptors:{convertPARPtoPPAPIInterceptor:"convertPARPtoPPAPIInterceptor",localeInterceptor:"localeInterceptor",loggingInterceptor:"loggingInterceptor",removeHeadersInterceptor:"removeHeadersInterceptor"}}},33328:function(e,t,i){"use strict";var r=i(33327),n=i(33279);i(33329);t.a=n.module(r.a.modules.processSimpleData,[r.a.modules.ngResource,r.a.modules.powerUx])},33331:function(e,t,i){"use strict";var r=i(33327),n=i(33279),o=i(31433),a=(i(33332),n.module(r.a.modules.processSimpleServices,[r.a.modules.ngRoute]));a.constant(r.a.services.appSettings,Object(o.a)()),t.a=a},33334:function(e,t,i){"use strict";var r=i(33327),n=i(33279);i(33293);t.a=n.module(r.a.modules.processSimpleDirectives,[r.a.modules.ngAria])},33335:function(e,t,i){"use strict";var r=i(33327),n=i(33279),o=(i(33293),i(33336),n.module(r.a.modules.processSimpleComponents,[r.a.modules.ngAria,r.a.modules.ngSanitize]));o.config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|ms-visio|javascript):/)}]),t.a=o},33338:function(e,t,i){"use strict";var r=i(33327),n=i(33279);t.a=n.module(r.a.modules.processSimpleInterceptors,[r.a.modules.processSimpleServices])},33339:function(e,t,i){"use strict";var r=i(33327),n=i(33279);t.a=n.module(r.a.modules.processSimpleResources,[])},33342:function(e,t,i){"use strict";var r=i(33326),n=i(33343),o=i(33327),a=i(13144),s=i(14697);r.a.config([o.a.providers.authenticationProvider,o.a.providers.$httpProvider,o.a.providers.$locationProvider,o.a.providers.routeProvider,o.a.services.appSettings,o.a.services.ppapiService,(e,t,i,r,l,c)=>{r.eagerInstantiationEnabled(!1),i.hashPrefix(""),i.html5Mode({enabled:!0,requireBase:l.featureFlags.useHtmlBaseTag,rewriteLinks:!1}),Object(n.a)(r);var u={[l.processSimpleManagementUri]:l.flowAudience,[Object(a.f)(l)]:l.flowAudience,[Object(a.e)(l)]:l.flowAudience,[l.azureResourceManagementUri]:l.armAudience,[l.powerAppsResourceProviderEndpoint]:l.flowAudience,[Object(a.c)(l).powerAppsRP]:l.flowAudience,[l.microsoftGraphResource]:l.microsoftGraphResource};Object(s.a)()&&(c.getEnvironmentEndpoint()&&(u[c.getEnvironmentEndpoint()]=c.getTokenAudience()),c.getTenantEndpoint()&&(u[c.getTenantEndpoint()]=c.getTokenAudience()));var d={[l.xrmInstanceApiUriSuffix]:l.xrmInstanceApiUriSuffix};t&&t.useApplyAsync(!0),t&&t.interceptors&&(Object(s.a)()&&t.interceptors.push(o.a.interceptors.convertPARPtoPPAPIInterceptor),t.interceptors.push(o.a.interceptors.localeInterceptor),t.interceptors.push(o.a.interceptors.loggingInterceptor),t.interceptors.push(o.a.interceptors.removeHeadersInterceptor)),e.init({anonymousEndpoints:[],endpoints:u,endpointPatterns:d},t)}])},33343:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var r=i(33344),n=i(17806),o=i(33379),a=i(33388),s=i(33401),l=i(33406),c=i(33412),u=i(33424),d=i(33428),p=i(33434),h=i(33450),m=i(16811),g=i(33491),f=i(33496),v=i(33501),b=i(33507),y=i(33512),w=i(31433);function S(e){e.when(m.H,new o.a).when(n.p,new r.a).when(n.q,new r.a).when(n.h,new r.a).when(n.i,new r.a).when(n.v,new l.a).when(n.m,new p.a).when(m.hb,new y.a).when(m.Nb,new y.a).when(m.jb,new y.a).when(Object(m.Eb)(m.hb),new y.a).when(Object(m.Eb)(m.Nb),new y.a).when(Object(m.Eb)(m.jb),new y.a).when(n.n,new a.a).when(n.t,new p.a).when(n.u,new a.a).when(m.Zb,new f.a).when(m.ac,new f.a).when(n.a,new c.a).when(n.b,new d.a).when(m.Qb,new d.a).when(m.dc,new b.a).when(m.ub,new v.a).when(Object(m.Eb)(n.r),new h.a).when(m.Mb,{}).when(n.s,new h.a).when(Object(m.Eb)(n.j),new h.a).when(m.N,new h.a({isSharedFlow:!1})).when(n.k,new h.a({isSharedFlow:!0})).when(n.x,new h.a).when(m.mc,new h.a).when(n.y,new h.a({isSharedFlow:!0})).when(n.w,new h.a).when(n.z,new h.a),Object(w.a)().featureFlags.useHtmlBaseTag?e.when(n.r,new h.a).when(n.d,new s.a).when(n.f,new s.a).when(n.o,new u.a).when(Object(m.Eb)(n.d),new s.a).when(Object(m.Eb)(n.f),new s.a).when(Object(m.Eb)(n.o),new u.a).when(n.j,new h.a).when(n.l,new g.a).when(Object(m.Eb)(n.l),new g.a).when(m.O,new o.a).when(m.Q,new r.a):e.when(":widgetPath*".concat(n.s),new h.a).when(":widgetPath*".concat(n.r),new h.a).when(":widgetPath*".concat(n.d),new s.a).when(":widgetPath*".concat(n.f),new s.a).when(":widgetPath*".concat(n.o),new u.a).when(":widgetPath*".concat(Object(m.Eb)(n.d)),new s.a).when(":widgetPath*".concat(Object(m.Eb)(n.f)),new s.a).when(":widgetPath*".concat(Object(m.Eb)(n.o)),new u.a).when(":widgetPath*".concat(n.j),new h.a).when(":widgetPath*".concat(n.l),new g.a).when(":widgetPath*".concat(Object(m.Eb)(n.l)),new g.a).when(":widgetPath*".concat(m.O),new o.a).when(":widgetPath*".concat(m.Q),new r.a).when(":widgetPath*".concat(m.H),new o.a).when(":widgetPath*".concat(n.q),new r.a).when(":widgetPath*".concat(n.i),new r.a).when(":widgetPath*".concat(n.v),new l.a).when(":widgetPath*".concat(n.m),new p.a).when(":widgetPath*".concat(m.ac),new f.a).when(":widgetPath*".concat(n.n),new a.a).when(":widgetPath*".concat(n.x),new h.a).when(":widgetPath*".concat(m.mc),new h.a).when(":widgetPath*".concat(n.y),new h.a({isSharedFlow:!0})).when(":widgetPath*".concat(n.k),new h.a({isSharedFlow:!0})).when(":widgetPath*".concat(n.u),new a.a)}},33344:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33345),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33377);var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33378),this.controllerAs="swaggerEditorCtrl",this.resolve={setPageTitle:[n.a.services.$document,n.a.services.appSettings,n.a.services.clientResources,function(e,t,i){e[0].title=Object(a.a)(i.PageTitle.CustomApis,t.brandName)}]}}));r.a.component(n.a.components.swaggerEditor,new u)},33345:function(e,t,i){"use strict";i.d(t,"a",(function(){return H}));var r=i(33279),n=i(14751),o=i.n(n),a=i(13083),s=i(13223),l=i(33346),c=i(33352),u=i(33353),d=i(33354),p=i(33327),h=i(33356),m=i(33357),g=i(12862),f=i(13272),v=i(33373),b=i(33347),y=i(33358),w=i(12381),S=i(17914),C=i(13009),k=i(14898),P=i(12330),x=i(12324),A=i(13031),T=i(14868),R=i(19940),O=i(33364),D=i(33374),E=i(33360),F=i(33375),I=i(20936),j=i(14901),N=i(12344),M=i(33376),L=i(14346),U=i(15991);function B(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function $(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?B(Object(i),!0).forEach((function(t){q(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):B(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function q(e,t,i){return(t=z(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function W(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z(r.key),r)}}function z(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var H=function(){function e(t,i,r,n,o,a,l,c,d,p,h,m,v,y,w,C,x,A,T,R,O,D,E,F,j,B,$,q,W){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$locationService=t,this.$q=i,this.$route=r,this.$routeParams=n,this.$scope=o,this.$timeout=a,this.apisClient=l,this.apisClientLA=c,this.appSettings=d,this.assetService=p,this.clientResources=h,this.customApiHelperService=m,this.customConnectorUrlService=v,this.environmentService=y,this.fileReader=w,this.loggingService=C,this.navigationService=x,this.policiesService=A,this.policyDataService=T,this.promiseHelperService=R,this.securityDetailsValidationService=O,this.copilotPluginValidationService=D,this.sessionService=E,this.codeEditorDataService=F,this.swaggerEditorDataService=j,this.swaggerValidationService=B,this.trialDialog=$,this.widgetUtilService=q,this.routeCrafter=W,this.alertType=u.a,this.iconName=f.a,this.apiNameInputId="apiNameInput",this.saveCustomApiButtonId="swaggerEditor-saveCustomApi-button",this.selectedTab=void 0,this.selectedTabText=void 0,this.swaggerEditorData=void 0,this.editorDropdownIconName="More",this.debug=void 0,this.isSwaggerDataReady=!1,this.isOperationInProgress=void 0,this.apiCreatedNavigation=void 0,this.saveCustomApiText="",this.closeCustomApiText="",this.copyClipBoardText="",this.solutionId=void 0,this.tab=void 0,this.props=void 0,this.isCopilotMessageBarOpen=void 0,this.permissionExpandString=void 0,this.tabs=void 0,this.editorDropdownItemsToggleOnly=[],this.editorDropdownItems=[],this.tabsDropdown=void 0,this.deployedConnectionParameterSets=void 0,this.getIsInlineSwaggerEditor=()=>this.swaggerEditorData.isInlineSwaggerEditor,this.onCreateApiClicked=()=>{this.$timeout(()=>{this.swaggerEditorData.isInlineSwaggerEditor&&this.swaggerEditorDataService.updateUISwaggerFromInlineSwagger(),this.widgetUtilService.isLogicApps()?this.onCreateApiClickedForLogicApps():this.onCreateApiClickedForFlow()},1e3)},this.onChangeSwaggerEditorType=()=>{this.swaggerEditorData.isInlineSwaggerEditor=!this.swaggerEditorData.isInlineSwaggerEditor,this.swaggerEditorData.isInlineSwaggerEditor?this.swaggerEditorDataService.updateInlineSwaggerFromUISwagger():this.swaggerEditorDataService.updateUISwaggerFromInlineSwagger(),this.loggingService.logInfo("swaggerEditorCtrl.onChangeSwaggerEditorType","Toggling ".concat(this.swaggerEditorData.isInlineSwaggerEditor?"on":"off"," inline swagger editor"),{isInlineSwaggerEditor:this.swaggerEditorData.isInlineSwaggerEditor})},this.onCancelClicked=()=>{this.swaggerEditorDataService.clear(),this.codeEditorDataService.clear(),this.navigationService.navigate(this.customConnectorUrlService.getCustomApisListUrl())},this.navigateToCustomConnectorsList=()=>{this.codeEditorDataService.clear(),this.swaggerEditorDataService.clear(),this.apiCreatedNavigation=!0,this.navigationService.navigate(this.customConnectorUrlService.getCustomApisListUrl())},this.onClipBoardClicked=()=>{Object(I.a)(this.swaggerEditorData.statusAlert.message,this.loggingService)},this.onMessageBarDismiss=()=>{this.isCopilotMessageBarOpen=!1},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"SwaggerEditorCtrl"}),this.tabs=[{tabHeader:this.clientResources.Manage.CustomApi.Tabs.general,tabName:S.c.general},{tabHeader:this.clientResources.Manage.CustomApi.Tabs.security,tabName:S.c.security},{tabHeader:this.clientResources.Manage.CustomApi.Tabs.definition,tabName:S.c.definition}],this.isCopilotMessageBarOpen=!0,this.permissionExpandString=Object(b.o)(this.sessionService.getUserInfo()),this.props={links:[{text:this.clientResources.Manage.CustomApi.CopilotTab.TabHeaderMessageBar.LeanHowariaLabel,href:U.a.CopilotPluginTab.pluginActionsInCopilotStudio,ariaLabel:this.clientResources.Manage.CustomApi.CopilotTab.TabHeaderMessageBar.LeanHowariaLabel,target:L.b.blank},{text:this.clientResources.Manage.CustomApi.CopilotTab.TabHeaderMessageBar.LeanMoreariaLabel,href:U.a.CopilotPluginTab.connectorPluginCertification,ariaLabel:this.clientResources.Manage.CustomApi.CopilotTab.TabHeaderMessageBar.LeanMoreariaLabel,target:L.b.blank}],interpolatedString:this.clientResources.Manage.CustomApi.CopilotTab.TabHeaderMessageBar.title},this.trialDialog.tryBlockMSA(),this.solutionId=this.$routeParams[S.h.solutionId],this.swaggerEditorData=this.swaggerEditorDataService.SwaggerEditorData,this.swaggerEditorData.apiName=this.$routeParams.apiName,this.swaggerEditorData.editMode=!!this.widgetUtilService.isLogicApps()||!!this.swaggerEditorData.apiName,this.selectedTab=this.$routeParams.tab,this.debug=d.featureFlags.enableDebug,this.isOperationInProgress=!1,this.apiCreatedNavigation=!1,this.swaggerEditorData.isInlineSwaggerEditor=!1,this.saveCustomApiText=this.swaggerEditorData.editMode?h.Manage.CustomApi.updateApi:h.Manage.CustomApi.createApi,this.closeCustomApiText=this.swaggerEditorData.editMode?h.Manage.CustomApi.UpdateApi.Close:h.Manage.CustomApi.CreateApi.cancel,this.copyClipBoardText=h.Common.ClickToCopy,!this.widgetUtilService.isLogicApps()&&Object(M.a)()&&this.tabs.push({tabHeader:this.clientResources.Manage.CustomApi.Tabs.copilot,tabName:S.c.copilot}),this.widgetUtilService.isLogicApps()||Object(N.c)(this.appSettings.featureFlags)||this.tabs.push({tabHeader:this.clientResources.Manage.CustomApi.Tabs.code,tabName:S.c.code}),this.widgetUtilService.isLogicApps()||this.tabs.push({tabHeader:this.clientResources.Manage.CustomApi.Tabs.test,tabName:S.c.test}),this.tabsDropdown={items:this.tabs.map((e,t)=>({key:e.tabName,text:"".concat(t+1,". ").concat(e.tabHeader),href:v.getCustomApiTabUrl(e.tabName)}))};var z=this.tabs.findIndex(e=>e.tabName===this.selectedTab);if(z>=0){var H=this.tabs[z].tabHeader;this.selectedTabText="".concat(z+1,". ").concat(H)}this.swaggerEditorData.editMode||(null!==this.swaggerEditorData.displayName&&""!==this.swaggerEditorData.displayName||"true"!==this.$routeParams.randomApiName||(this.swaggerEditorData.displayName=Object(s.a)().replace(/-/g,"").slice(0,30)),this.$scope.$watch(()=>this.swaggerEditorData.displayName,()=>this.swaggerEditorData.swaggerFileName="".concat(Object(k.a)(this.swaggerEditorData.displayName),".swagger.json"))),this.$scope.$watch(()=>this.swaggerEditorData.validationError,()=>{var e=this.swaggerEditorData.validationError;Object(P.a)(e)&&this.swaggerEditorData.statusAlert.type!==u.a.Error||(e?this.swaggerEditorData.statusAlert.options.show(u.a.Error,e.message):this.swaggerEditorData.statusAlert.options.hide())}),this.$scope.$watch(()=>this.codeEditorDataService.CodeEditorData.validationError,()=>{var e=this.codeEditorDataService.CodeEditorData.validationError;Object(P.a)(e)&&this.codeEditorDataService.CodeEditorData.statusAlert.type!==u.a.Error||(e?this.codeEditorDataService.CodeEditorData.statusAlert.options.show(u.a.Error,e.message):this.codeEditorDataService.CodeEditorData.statusAlert.options.hide())}),this.$scope.$watch(()=>(this.tab=document.getElementById("heading-tabs-"+String(this.$scope.$id)),!!this.tab&&this.tab.getElementsByClassName("swaggerEditor-tab--active")[0]),()=>{if(this.tab){var e=this.tab.getElementsByClassName("swaggerEditor-tab--active")[0];e&&e.focus()}}),this.$scope.$watch(()=>this.codeEditorDataService.CodeEditorData.operationSelectedKeys,()=>{Object(P.a)(this.codeEditorDataService.CodeEditorData.operationSelectedKeys)||(this.codeEditorDataService.CodeEditorData.operationSelectedKeys=void 0)}),this.policyDataService.isCustomApiPolicyFeatureEnabled()&&this.$scope.$watch(()=>this.swaggerEditorData.swagger,(e,t)=>{e!==t&&this.policyDataService.updateOperations()}),this.swaggerEditorData.editMode?this.initializeForEditMode():this.initializeForCreateMode(),this.swaggerEditorData.editMode||this.$timeout(()=>{this.$timeout(()=>{var e=document.getElementById(this.apiNameInputId);e&&!e.getAttribute("readonly")&&e.focus()})});var V={key:"swaggerEditor",customType:"toggle",onText:h.Manage.CustomApi.inlineSwaggerEditor,offText:h.Manage.CustomApi.inlineSwaggerEditor,onChange:this.onChangeSwaggerEditorType,getChecked:this.getIsInlineSwaggerEditor};this.editorDropdownItems.push(V),this.editorDropdownItemsToggleOnly.push(V),this.editorDropdownItems.push({key:"divider_1",itemType:g.a.Divider},{key:"create",text:this.saveCustomApiText,iconProps:{iconName:this.iconName.Accept},onClick:this.onCreateApiClicked},{key:"cancel",text:this.closeCustomApiText,iconProps:{iconName:this.iconName.Cancel},onClick:this.onCancelClicked})}var t,i,n;return t=e,(i=[{key:"setOperationInProgress",value:function(e){this.isOperationInProgress=e,this.editorDropdownItems.forEach(t=>{t.disabled=e}),this.editorDropdownItemsToggleOnly.forEach(t=>{t.disabled=e})}},{key:"backButtonUrl",get:function(){return this.customConnectorUrlService.getCustomApisListUrl()}},{key:"useInlineSwaggerOnSave",get:function(){return!0}},{key:"isGeneralTab",get:function(){return this.selectedTab===S.c.general}},{key:"isSecurityTab",get:function(){return this.selectedTab===S.c.security}},{key:"isDefinitionTab",get:function(){return this.selectedTab===S.c.definition}},{key:"isCodeTab",get:function(){return this.selectedTab===S.c.code}},{key:"isTestTab",get:function(){return this.selectedTab===S.c.test}},{key:"isCopilotTab",get:function(){return this.selectedTab===S.c.copilot}},{key:"getSwagger",value:function(){return this.swaggerEditorData.swagger?JSON.parse(Object(v.a)(this.swaggerEditorData.swagger)):void 0}},{key:"getConnectionParameters",value:function(e){if(this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled&&this.swaggerEditorData.securityTabDetails.selectedAuthenticationTypes&&this.swaggerEditorData.securityTabDetails.selectedAuthenticationTypes.length>1)return{};var t=this.swaggerEditorDataService.constructConnectionParameters(e);return this.swaggerEditorDataService.securityTabDetails.isLocked&&(t=this.swaggerEditorDataService.connectionParametersAreImported?this.swaggerEditorDataService.securityTabDetails.connectionParameters:void 0),t}},{key:"getConnectionParameterSets",value:function(e){return this.swaggerEditorDataService.securityTabDetails.isLocked?this.swaggerEditorDataService.connectionParametersAreImported?this.swaggerEditorDataService.securityTabDetails.connectionParameterSets:void 0:this.swaggerEditorDataService.constructConnectionParameterSets(e)}},{key:"initializeForEditMode",value:function(){this.registerConfirmNavigateAway(),this.isNewOrDefaultSwagger(this.swaggerEditorData.swagger)||this.swaggerEditorDataService.swaggerEditorUIData.swaggerUpdatedFromList||!this.swaggerEditorDataService.isDeployedApiSameAsLocalApi?(this.swaggerEditorDataService.securityTabDetails.isLocked=!0,this.widgetUtilService.isLogicApps()?this.initializeParametersAndGetApiAndParseSwaggerForLogicApps():this.getApiAndPopulatePage(!this.swaggerEditorDataService.swaggerEditorUIData.swaggerUpdatedFromList)):this.isSwaggerDataReady=!0}},{key:"initializeParametersAndGetApiAndParseSwaggerForLogicApps",value:function(){var e=this.widgetUtilService.isWidgetPage()?this.widgetUtilService.widgetInfo.logicAppsSettings:void 0;this.getApiAndParseSwaggerForLogicApps(e)}},{key:"isNewOrDefaultSwagger",value:function(e){return Object(x.isEmpty)(e)||r.equals(e,m.b)&&!r.equals(e,this.swaggerEditorData.deployedSwagger)}},{key:"initializeForCreateMode",value:function(){this.isSwaggerDataReady=!0;var e=this.policiesService.checkShouldShowFreePlanDialog().then(e=>e?this.apisClient.query(this.$scope).$promise:this.$q.resolve([])).then(e=>{(Array.isArray(e)?e.filter(e=>Object(b.v)(e)):[]).length>1?this.trialDialog.showStartFreeTrialDialog(e=>{e||this.navigationService.navigate(Object(j.m)(this.routeCrafter))}):this.registerConfirmNavigateAway()}),t=this.policyDataService.fetchPolicyTypes(this.$scope);this.$q.all([e,t]).catch(e=>{this.loggingService.logError("swaggerEditorCtrl.initializeForCreateMode",e)})}},{key:"validateSwagger",value:function(){return this.swaggerValidationService.validate(this.swaggerEditorDataService.swagger,this.policyDataService.operationPolicyInfo),this.swaggerValidationService.resultCollection.errorCount}},{key:"getSecurityDetailsErrorCount",value:function(){return this.securityDetailsValidationService.validate(this.swaggerEditorDataService.securityTabDetails,this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled),this.securityDetailsValidationService.resultCollection.errorCount}},{key:"getCoPilotTabErrorCount",value:function(){return this.copilotPluginValidationService.validate(this.swaggerEditorDataService.swagger),this.copilotPluginValidationService.resultCollection.errorCount}},{key:"isInValidSoapToRestRequest",value:function(){return this.swaggerEditorData.apiLogicApps.properties.apiType===c.a.Soap&&this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod===c.b.SoapToRest&&!this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.service}},{key:"createOrUpdateApiForLogicApps",value:function(e,t){this.swaggerEditorData.statusAlert.options.show(u.a.Progress,this.clientResources.Manage.CustomApi.SavingCustomAPI);var i=this.getApiPutObjectForLogicApps(e);return this.apisClientLA.put(t,i)}},{key:"getApiPutObjectForLogicApps",value:function(e){var t={location:this.swaggerEditorData.apiLogicApps.location,properties:{displayName:this.swaggerEditorData.displayName,description:this.swaggerEditorData.swagger.info?this.swaggerEditorData.swagger.info.description:"",iconUri:this.swaggerEditorData.swaggerIconFileContentUrl,swagger:JSON.parse(Object(v.a)(this.swaggerEditorData.swagger)),backendService:{serviceUrl:this.getServiceUrl()},brandColor:this.swaggerEditorData.swaggerIconBrandColor,connectionParameters:e,apiType:Object(R.b)(c.a,this.swaggerEditorData.apiLogicApps.properties.apiType)}},i=this.swaggerEditorData.isOnPremiseDataGateway?{capabilities:[T.c.gateway]}:{capabilities:[]};return t.properties=$($({},t.properties),i),this.swaggerEditorData.apiLogicApps.properties.apiType===c.a.Soap&&(t.properties.wsdlDefinition={url:this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url,content:this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.content,service:this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.service,importMethod:Object(R.b)(c.b,this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod)}),this.swaggerEditorData.apiLogicApps.properties.integrationServiceEnvironment&&this.swaggerEditorData.apiLogicApps.properties.integrationServiceEnvironment.id&&(t.properties.integrationServiceEnvironment={id:this.swaggerEditorData.apiLogicApps.properties.integrationServiceEnvironment.id}),t}},{key:"onCreateApiClickedForLogicApps",value:function(){var e=this.loggingService.profileStart(d.a.LogicAppsCustomApiSaveEditStart,this.swaggerEditorDataService.loggableSwaggerEditorData),t=d.a.LogicAppsCustomApiSaveEditEnd,i=this.swaggerEditorDataService.SwaggerEditorData;if(this.isInValidSoapToRestRequest())i.validationError=new O.a(C.c.customApiValidationError,this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.Input.Missing);else{var r=this.validateSwagger();if(r>0)return i.validationError=new O.a(C.c.customApiValidationError,Object(A.a)(this.clientResources.Manage.CustomApi.SwaggerValidationFailed,r)),void this.loggingService.profileEnd(e,t,C.e.ValidationError,i.validationError,this.swaggerEditorDataService.loggableSwaggerEditorData);var n=this.getSecurityDetailsErrorCount();if(n>0)return this.swaggerEditorDataService.SwaggerEditorData.validationError=new O.a(C.c.customApiValidationError,Object(A.a)(this.clientResources.Manage.CustomApi.SecurityValidationFailed,n)),void this.loggingService.profileEnd(e,t,C.e.ValidationError,this.swaggerEditorDataService.SwaggerEditorData.validationError,this.swaggerEditorDataService.loggableSwaggerEditorData);var o=this.getCoPilotTabErrorCount();if(o>0)return this.swaggerEditorDataService.SwaggerEditorData.validationError=new O.a(C.c.customApiValidationError,Object(A.a)(this.clientResources.Manage.CustomApi.CoPilotTabValidationFailed,o)),void this.loggingService.profileEnd(e,t,C.e.ValidationError,this.swaggerEditorDataService.SwaggerEditorData.validationError,this.swaggerEditorDataService.loggableSwaggerEditorData);this.swaggerEditorData.spinner.show=!0,this.setOperationInProgress(!0);var a=this.widgetUtilService.isWidgetPage()?this.widgetUtilService.widgetInfo.logicAppsSettings:void 0;this.swaggerEditorDataService.validateFormDetailsLogicApps(this.$scope).then(()=>this.promiseHelperService.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource))).then(e=>{var t=this.swaggerEditorDataService.securityTabDetails.isLocked?void 0:this.swaggerEditorDataService.constructConnectionParameters();return this.createOrUpdateApiForLogicApps(t,a)}).then(()=>{var e=this.clientResources.Manage.CustomApi.Updated.Alert,t={type:u.a.Success,message:e};this.reloadPageAndClearSwaggerAndCodeEditorData(!1),i.statusAlert.options.show(t.type,t.message)}).catch(r=>{Object(C.cb)(r);var n=$($({},this.swaggerEditorDataService.loggableSwaggerEditorData),{},{fullNonLocalizedError:Object(C.fb)(r)});this.loggingService.profileEnd(e,t,Object(C.y)(r),r,n),i.statusAlert.options.show(u.a.Error,Object(C.db)(r))}).finally(()=>{this.swaggerEditorData.spinner.show=!1,this.setOperationInProgress(!1)})}}},{key:"getApiAndParseSwaggerForLogicApps",value:function(e){var t=this.swaggerEditorDataService.SwaggerEditorData;this.swaggerEditorData.spinner.show=!0,this.setOperationInProgress(!0);var i=this.loggingService.profileStart(d.a.LogicAppsCustomApiLoadStart);this.apisClientLA.get(e).then(e=>(this.getAndAssignSwaggerIconForLogicApps(e),this.parseSwaggerDataForLogicApps(e))).then(()=>{this.loggingService.profileEndWithSuccess(i,d.a.LogicAppsCustomApiLoadEnd)}).catch(e=>{this.loggingService.profileEnd(i,d.a.LogicAppsCustomApiLoadEnd,Object(C.y)(e),e),this.displayGetApiAndParseSwaggerErrorAlert(e)}).finally(()=>{this.isSwaggerDataReady=!0,this.validateSwagger(),this.swaggerEditorDataService.setIconDisplay(),t.spinner.show=!1,this.setOperationInProgress(!1)})}},{key:"parseSwaggerDataForLogicApps",value:function(e){var t=this.swaggerEditorDataService.SwaggerEditorData;return t.apiLogicApps=e,t.apiLogicApps.properties.apiType=c.a[t.apiLogicApps.properties.apiType.toString()],t.apiLogicApps.properties.apiType===c.a.Soap&&t.apiLogicApps.properties.wsdlDefinition&&(t.apiLogicApps.properties.wsdlDefinition.importMethod=c.b[t.apiLogicApps.properties.wsdlDefinition.importMethod.toString()]),this.genericParseSwaggerData(e,!0)}},{key:"getAndAssignSwaggerIconForLogicApps",value:function(e){this.swaggerEditorDataService.SwaggerEditorData.swaggerIconFileContentUrl=Object(b.k)(e,this.assetService)}},{key:"onCreateApiClickedForFlow",value:function(){var e,t,i,r=this,n=this.getAlmMode(this.swaggerEditorData.editMode),o=$($({},this.swaggerEditorDataService.loggableSwaggerEditorData),{},{almMode:n}),a=this.swaggerEditorData.editMode?this.loggingService.profileStart(d.a.myCustomApiSaveEditStart,o):this.loggingService.profileStart(d.a.myCustomApiCreateStart,o),s=this.swaggerEditorData.editMode?d.a.myCustomApiSaveEditEnd:d.a.myCustomApiCreateEnd,l=0;if((l=this.validateSwagger()+this.policyDataService.operationValidationErrorCount)>0?e=Object(A.a)(this.clientResources.Manage.CustomApi.SwaggerValidationFailed,l):(l=this.policyDataService.validationErrorCount)>0?e=Object(A.a)(this.clientResources.Manage.CustomApi.PolicyValidationFailed,l):(l=this.getSecurityDetailsErrorCount())>0?e=Object(A.a)(this.clientResources.Manage.CustomApi.SecurityValidationFailed,l):(l=this.getCoPilotTabErrorCount())>0&&(e=Object(A.a)(this.clientResources.Manage.CustomApi.CoPilotTabValidationFailed,l)),l>0)return this.swaggerEditorDataService.SwaggerEditorData.validationError=new O.a(C.c.customApiValidationError,e),void this.loggingService.profileEnd(a,s,C.e.ValidationError,this.swaggerEditorDataService.SwaggerEditorData.validationError,$($({},this.swaggerEditorDataService.loggableSwaggerEditorData),{},{useInlineSwaggerOnSave:this.useInlineSwaggerOnSave,almMode:n}));this.swaggerEditorData.spinner.show=!0;var c=this.sessionService.getUserInfo();this.setOperationInProgress(!0),this.swaggerEditorDataService.validateFormDetails(this.$scope).then(()=>{var e=!1;if(e=!this.swaggerEditorData||!this.swaggerEditorData.securityTabDetails||!this.swaggerEditorData.securityTabDetails.redirectMode&&!this.swaggerEditorData.securityTabDetails.redirectUrl||this.swaggerEditorData.securityTabDetails.redirectMode&&"global"===this.swaggerEditorData.securityTabDetails.redirectMode.toLowerCase(),e=this.appSettings.featureFlags.useGlobalRedirectModeForConnections&&e,t=this.getConnectionParameters(e),i=this.getConnectionParameterSets(e),this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled&&this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationTypes.length>1){var n;this.swaggerEditorDataService.swagger.security||(this.swaggerEditorDataService.swagger.security=[]);var o=Object.keys(this.swaggerEditorDataService.swagger.securityDefinitions),a=function(e){var t=r.swaggerEditorDataService.swagger.security.find(t=>t[e]);t||(t={[e]:[]},r.swaggerEditorDataService.swagger.security.push(t))};for(var s of o)a(s);(null===(n=i)||void 0===n?void 0:n.values.length)>=1&&0===Object.keys(t||{}).length&&(t=i.values[0].parameters)}else this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled&&1===this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationTypes.length&&this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationTypes[0]!==T.b.Oauth2&&(this.swaggerEditorDataService.swagger.security=[]);return this.customApiHelperService.validateSwaggerAgainstSchemaOnSave(c.uniqueId,JSON.parse(Object(v.a)(this.swaggerEditorData.swagger)))}).then(()=>this.uploadFilesToStorage(c.uniqueId)).then(e=>this.createOrUpdateApi(e,t,i)).then(e=>{var t,i;return this.swaggerEditorData.apiName=this.swaggerEditorData.editMode?this.swaggerEditorData.apiName:e.data.name,this.swaggerEditorData.apiId=null!==(t=e.data.id)&&void 0!==t?t:null===(i=this.swaggerEditorData.api)||void 0===i?void 0:i.id,this.refreshApis()}).then(()=>{var e,i,r;if(this.loggingService.profileEndWithSuccess(a,s,$($({},this.swaggerEditorDataService.loggableSwaggerEditorData),{},{redirectMode:null!==(e=null===(i=this.swaggerEditorDataService.loggableSwaggerEditorData)||void 0===i?void 0:i.redirectMode)&&void 0!==e?e:null===(r=t)||void 0===r||null===(r=r.token)||void 0===r||null===(r=r.oAuthSettings)||void 0===r?void 0:r.redirectMode,useInlineSwaggerOnSave:this.useInlineSwaggerOnSave,almMode:n,codeEnabled:this.codeEditorDataService.CodeEditorData.codeEnabled})),!this.widgetUtilService.isWidgetPage())return this.$q.resolve();try{var o=JSON.parse(Object(v.a)(this.swaggerEditorData.swagger));return this.customApiHelperService.validateWadl(c.uniqueId,o)}catch(l){return this.loggingService.logError("SwaggerEditorCtrl.OnCreateApiClicked.ParseJsonForWadl",l),this.$q.resolve()}}).then(e=>{var t;if(e){var i=this.swaggerEditorData.editMode?this.clientResources.Manage.CustomApi.Updated.WadlAlert:this.clientResources.Manage.CustomApi.Created.WadlAlert;i=Object(A.a)(i,Object(C.db)(e)),t={type:u.a.Warning,message:i}}else if(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType===T.b.Oauth2&&this.swaggerEditorData.securityTabDetails.uniqueRedirectUrlChecked){var r=this.clientResources.Manage.CustomApi.Updated.UniqueRedirectUrlAlert;t={type:u.a.UniqueRedirectUrlSuccess,message:r}}else{var n=this.swaggerEditorData.editMode?this.clientResources.Manage.CustomApi.Updated.Alert:this.clientResources.Manage.CustomApi.Created.Alert;t={type:u.a.Success,message:n}}this.swaggerEditorData.editMode?this.reloadPageAndClearSwaggerAndCodeEditorData(!0):this.navigateToEditApi(this.swaggerEditorData.apiName),this.swaggerEditorData.statusAlert.options.show(t.type,t.message)}).catch(e=>{var t=Object(C.cb)(e),i=$($({},this.swaggerEditorDataService.loggableSwaggerEditorData),{},{fullNonLocalizedError:Object(C.fb)(e),useInlineSwaggerOnSave:this.useInlineSwaggerOnSave,almMode:n});this.loggingService.profileEnd(a,s,Object(C.y)(e),e,i),t===C.c.customApiRefreshApisClient?(this.swaggerEditorData.statusAlert.options.hide(),this.navigateToCustomConnectorsList()):this.swaggerEditorData.statusAlert.options.show(u.a.Error,Object(C.db)(e))}).finally(()=>{this.swaggerEditorData.spinner.show=!1,this.setOperationInProgress(!1)})}},{key:"getApiAndPopulatePage",value:function(e){this.codeEditorDataService.CodeEditorData.codeEnabled&&this.codeEditorDataService.clear(),this.swaggerEditorDataService.swaggerEditorUIData.swaggerUpdatedFromList=!1,this.swaggerEditorData.spinner.show=!0,this.setOperationInProgress(!0),this.swaggerEditorData.apiId=Object(b.e)(this.swaggerEditorData.apiName);var t={id:this.swaggerEditorData.apiId,$expand:this.permissionExpandString},i=this.loggingService.profileStart(d.a.myCustomApiLoadStart,t),r=this.apisClient.get(this.$scope,t);this.$q.all([r.$promise,this.policyDataService.fetchPolicyTypes(this.$scope)]).then(()=>this.$q.all([this.parseSwaggerData(r,e),this.getAndAssignSwaggerIcon(r),r.properties.scriptDefinitionUrl&&this.getCodeData(r)])).then(()=>{this.isSwaggerDataReady=!0,this.loggingService.profileEndWithSuccess(i,d.a.myCustomApiLoadEnd,t),this.swaggerEditorDataService.setIconDisplay()}).catch(e=>{var r=Object(C.cb)(e),n=r===C.c.ApiResourceNotFound||r===C.c.ApiAuthorizationFailed?C.e.ValidationError:Object(C.y)(e);this.loggingService.profileEnd(i,d.a.myCustomApiLoadEnd,n,e,t),this.displayGetApiAndParseSwaggerErrorAlert(e)}).finally(()=>{this.swaggerValidationService.validate(this.swaggerEditorData.swagger,this.policyDataService.operationPolicyInfo),this.deployedConnectionParameterSets=r.properties.connectionParameterSets,this.swaggerEditorData.spinner.show=!1,this.setOperationInProgress(!1)})}},{key:"getCodeData",value:function(e){return this.parseCodeData(e)}},{key:"parseCodeData",value:function(e){var t=this.loggingService.profileStart(d.a.myCustomApiGetCodeFromUrlStart);return this.getCodeFromUrl(e).then(e=>this.promiseHelperService.toAngularPromise(this.fileReader(e).asText())).then(i=>{this.loggingService.profileEndWithSuccess(t,d.a.myCustomApiGetCodeFromUrlEnd),this.codeEditorDataService.CodeEditorData.sourceCode=i,this.codeEditorDataService.CodeEditorData.deployedSourceCode=o()(i),this.codeEditorDataService.CodeEditorData.codeEnabled=!0,this.codeEditorDataService.CodeEditorData.scriptOperations=Object(b.r)(e)||[],this.codeEditorDataService.CodeEditorData.operationSelectedKeys=o()(this.codeEditorDataService.CodeEditorData.scriptOperations),this.codeEditorDataService.CodeEditorData.deployedScriptOperations=o()(this.codeEditorDataService.CodeEditorData.scriptOperations)}).catch(e=>{this.loggingService.profileEnd(t,d.a.myCustomApiGetCodeFromUrlEnd,Object(C.y)(e),e)})}},{key:"parseSwaggerData",value:function(e,t){return this.swaggerEditorData.api=e,this.genericParseSwaggerData(e,t)}},{key:"genericParseSwaggerData",value:function(e,t){var i=Object(b.h)(e);this.swaggerEditorData.swaggerFileName="".concat(Object(k.a)(i),".swagger.json"),this.swaggerEditorData.isOnPremiseDataGateway=e.properties.capabilities.indexOf(T.c.gateway)>-1&&e.properties.capabilities.indexOf("cloud")<0,this.swaggerEditorData.displayName=i;var r=Object(b.j)(e);r&&(this.swaggerEditorData.swaggerIconBrandColor=r),this.swaggerEditorDataService.securityTabDetails.connectionParameters=e.properties.connectionParameters;var n,a=Object(b.l)(e.properties.connectionParameters);this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled&&(this.swaggerEditorDataService.securityTabDetails.connectionParameterSets=e.properties.connectionParameterSets,a=Object(b.l)(e.properties.connectionParameters),e.properties.connectionParameterSets&&(a=Object(b.m)(e.properties.connectionParameterSets)||a)),a&&(this.swaggerEditorDataService.securityTabDetails.redirectUrl=a.redirectUrl,this.swaggerEditorDataService.securityTabDetails.redirectMode=a.redirectMode,this.swaggerEditorDataService.securityTabDetails.federatedIdentityCredentials=null===(n=a.properties)||void 0===n?void 0:n.federatedIdentityCredentials);var s=this.loggingService.profileStart(d.a.myCustomApiGetSwaggerFromUrlStart);return this.getSwaggerFromUrl(e).then(e=>{this.loggingService.profileEndWithSuccess(s,d.a.myCustomApiGetSwaggerFromUrlEnd);var i=Object(y.a)(e);t&&(this.swaggerEditorDataService.swagger=i),this.swaggerEditorData.deployedSwagger=o()(i),this.swaggerEditorData.inlineEditorSwagger=e,!this.swaggerEditorDataService.swagger||this.swaggerEditorData.importFormat!==h.a.postman&&this.swaggerEditorData.importFormat!==h.a.wsdlFile&&this.swaggerEditorData.importFormat!==h.a.wsdlUrl||(this.swaggerEditorDataService.swagger.securityDefinitions=this.swaggerEditorData.deployedSwagger.securityDefinitions),this.swaggerEditorDataService.hasSecurityDefinitionBeenModified&&(this.swaggerEditorData.securityTabDetails.isLocked=!1)}).then(()=>{this.policyDataService.isCustomApiPolicyFeatureEnabled()&&(this.policyDataService.policyTemplateInstances=e.properties.policyTemplateInstances)}).catch(e=>{this.loggingService.profileEnd(s,d.a.myCustomApiGetSwaggerFromUrlEnd,Object(C.y)(e),e)})}},{key:"getAndAssignSwaggerIcon",value:function(e){return this.acquireIconBlobWithRetry(e,1).then(e=>this.convertIconBlobToFile(e)).then(e=>(this.swaggerEditorData.swaggerIconFile=e,this.promiseHelperService.toAngularPromise(this.fileReader(e).asDataURL()))).then(e=>{this.swaggerEditorData.swaggerIconFileContentUrl=e}).catch(e=>{this.displayGetApiAndParseSwaggerErrorAlert(e),this.loggingService.logError("CustomApi.GetAndAssignSwaggerIcon",e)})}},{key:"acquireIconBlobWithRetry",value:function(e,t){return this.customApiHelperService.getSwaggerIconData(e.properties.iconUri).catch(i=>{var r=i.data&&i.data.responseStatusCode?i.data.responseStatusCode:-1;return t<5&&(-1===r||400<=r&&r<500)?(this.swaggerEditorDataService.setIconDisplayNotFound(),this.$timeout(()=>this.refreshApi(e),1e3).then(e=>e).then(e=>this.acquireIconBlobWithRetry(e,t+1))):this.$q.reject(i)})}},{key:"convertIconBlobToFile",value:function(e){var t=new File([e],"customconnectoricon");return t?this.$q.resolve(t):this.$q.reject(new C.a(C.c.customApiOriginalDataError,this.clientResources.Manage.CustomApi.OriginalIcon.DownloadError))}},{key:"displayGetApiAndParseSwaggerErrorAlert",value:function(e){var t;switch(Object(C.cb)(e)){case C.c.customApiOriginalDataError:t=Object(C.db)(e);break;case C.c.customApiGetSwaggerIcon:t=this.clientResources.Manage.CustomApi.OriginalIcon.DownloadError;break;case C.c.ApiResourceNotFound:t=this.clientResources.Manage.CustomApi.ApiDoesNotExist.Error;break;case C.c.ApiAuthorizationFailed:t=this.clientResources.Manage.CustomApi.NoWritePermissionsToApi.Error;break;default:t=this.clientResources.Manage.CustomApi.OriginalSwagger.DownloadError}this.swaggerEditorData.statusAlert.options.show(u.a.Error,t)}},{key:"uploadFilesToStorage",value:function(e){this.swaggerEditorData.statusAlert.options.show(u.a.Progress,this.clientResources.Manage.CustomApi.UploadingSwagger);var t={},i=this.swaggerEditorData.swaggerIconFile&&this.swaggerEditorData.userUploadedIcon,r=!this.useInlineSwaggerOnSave,n=this.codeEditorDataService.CodeEditorData.codeEnabled&&!this.codeEditorDataService.isSourceCodeEmptyString();return r||i||n?this.customApiHelperService.generateResourceStorage(e,this.environmentService.getCurrentEnvironmentName()).then(e=>{var o=e.data.sharedAccessSignature;r&&(t.swagger={file:new File([new Blob([Object(v.a)(this.swaggerEditorData.swagger)])],this.swaggerEditorData.swaggerFileName),sasUri:Object(D.a)(o,Object(E.j)(this.swaggerEditorData.swaggerFileName))}),i&&(t.icon={file:this.swaggerEditorData.swaggerIconFile,sasUri:Object(D.a)(o,"customconnectoricon.".concat(this.swaggerEditorData.swaggerIconFile.name.split(".").pop()))}),n&&(t.script={file:new File([new Blob([this.codeEditorDataService.CodeEditorData.sourceCode])],"script.csx"),sasUri:Object(D.a)(o,"script.csx")})}).then(()=>this.customApiHelperService.uploadFilesToStorage(this.$scope,t)):this.customApiHelperService.uploadFilesToStorage(this.$scope,t)}},{key:"createOrUpdateApi",value:function(e,t,i){this.swaggerEditorData.statusAlert.options.show(u.a.Progress,this.clientResources.Manage.CustomApi.SavingCustomAPI);var r=Object(F.a)({properties:this.swaggerEditorData.editMode?this.getApiPatchObject(e,t,i):this.getApiPostObject(e,t,i)},!0,this.environmentService.getCurrentEnvironmentName()),n={};if(n=this.swaggerEditorData.isOnPremiseDataGateway?{capabilities:[T.c.gateway]}:{capabilities:[]},r.properties=$($({},r.properties),n),this.swaggerEditorData.editMode){var o={id:"".concat(l.a.urlPath,"/").concat(this.swaggerEditorData.apiName),$expand:this.permissionExpandString};return this.apisClient.patch(o,r)}if(this.solutionId){var a=this.customConnectorUrlService.getSolutionQueryString(),s={id:"".concat(l.a.urlPath,"?").concat(a),$expand:this.permissionExpandString};return this.apisClient.post(s,r)}var c={id:l.a.urlPath,$expand:this.permissionExpandString};return this.apisClient.post(c,r)}},{key:"getApiPostObject",value:function(e,t,i){return $($({},this.getApiPatchObject(e,t,i)),{},{displayName:this.swaggerEditorData.displayName})}},{key:"getApiPatchObject",value:function(e,t,i){var r,n,o={iconBrandColor:Object(a.a)(this.swaggerEditorData.swaggerIconBrandColor)?void 0:this.swaggerEditorData.swaggerIconBrandColor,description:this.swaggerEditorData.swagger.info?this.swaggerEditorData.swagger.info.description:"",backendService:{serviceUrl:this.getServiceUrl()}};e.icon&&(o.iconUri=e.icon.sasUri),Object(P.a)(t)||(o.connectionParameters=t),this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled?this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationTypes.length>1?Object(P.a)(i)||(o.connectionParameterSets=i):((null===(r=this.deployedConnectionParameterSets)||void 0===r||null===(r=r.values)||void 0===r?void 0:r.length)>0&&null==i&&(i={values:[]}),o.connectionParameterSets=i):((null===(n=this.deployedConnectionParameterSets)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)>0&&null==i&&(i={values:[]}),o.connectionParameterSets=i),this.useInlineSwaggerOnSave?o.openApiDefinition=JSON.parse(Object(v.a)(this.swaggerEditorData.swagger)):o.apiDefinitionUrl=e.swagger.sasUri;var s=!this.codeEditorDataService.CodeEditorData.codeEnabled&&!Object(P.a)(Object(b.q)(this.swaggerEditorData.api))||this.codeEditorDataService.isSourceCodeEmptyString();if(this.codeEditorDataService.CodeEditorData.codeEnabled&&!this.codeEditorDataService.isSourceCodeEmptyString()){this.swaggerEditorData.statusAlert.options.show(u.a.Progress,this.clientResources.Manage.CustomApi.EnablingCustomCode);var l,{actions:c,triggers:d}=this.swaggerEditorData.swagger;l=void 0===c?d.map(e=>e.operation.operationId):void 0===d?c.map(e=>e.operation.operationId):c.concat(d).map(e=>e.operation.operationId),o.scriptDefinitionUrl=e.script.sasUri,o.scriptOperations=this.codeEditorDataService.CodeEditorData.scriptOperations.filter(e=>l.includes(e))}else s&&(this.swaggerEditorData.statusAlert.options.show(u.a.Progress,this.clientResources.Manage.CustomApi.DisablingCustomCode),o.scriptDefinitionUrl="",o.scriptOperations=[]);return this.policyDataService.isCustomApiPolicyFeatureEnabled()&&(o.policyTemplateInstances=this.policyDataService.policyTemplateInstances),o}},{key:"refreshApis",value:function(){var e,t,i,r;if(this.swaggerEditorData.editMode){var n={id:this.swaggerEditorData.apiId,$expand:this.permissionExpandString};e=this.apisClient.refresh(n),t=n,i=d.a.myCustomApiRefreshApiStart,r=d.a.myCustomApiRefreshApiEnd}else e=this.apisClient.refreshQuery(),i=d.a.myCustomApiRefreshApisStart,r=d.a.myCustomApiRefreshApisEnd;var o=this.loggingService.profilePageStart(i,t);return e.then(()=>(this.loggingService.profileEndWithSuccess(o,r,t),this.$q.resolve())).catch(e=>(this.loggingService.profileEnd(o,r,Object(C.y)(e),e,t),this.$q.reject(new C.a(C.c.customApiRefreshApisClient,Object(C.db)(e),e))))}},{key:"refreshApi",value:function(e){var t={id:e.id,$expand:this.permissionExpandString};return this.apisClient.refresh(t).then(()=>this.apisClient.get(this.$scope,t))}},{key:"getSwaggerFromUrl",value:function(e){var t=Object(b.n)(e);return t?this.customApiHelperService.getSwaggerFromUrl(t):this.$q.reject(new C.b(C.c.customApiOriginalDataError,this.clientResources.Manage.CustomApi.OriginalSwagger.NotFound))}},{key:"getCodeFromUrl",value:function(e){var t=Object(b.q)(e);return t?this.customApiHelperService.getBlobFromUrl(t):this.$q.reject(new C.b(C.c.customApiOriginalCustomCodeError,this.clientResources.Manage.CustomApi.Code.NotFound))}},{key:"registerConfirmNavigateAway",value:function(){this.navigationService.confirmNavigateAway(this.$scope,{getMessage:()=>this.clientResources.Flow.Discard.Changes.Message,confirmation:this.clientResources.Flow.Discard.Changes.Confirmation,condition:()=>-1===this.$locationService.url().indexOf("/connections/available/custom/")&&!this.apiCreatedNavigation&&(this.swaggerEditorDataService.hasSwaggerBeenModified||this.codeEditorDataService.hasScriptOperationsBeenModified()||this.codeEditorDataService.hasSourceCodeBeenModified()&&!this.codeEditorDataService.hasDefaultCode()),onConfirmResult:e=>{e&&(this.codeEditorDataService.clear(),this.swaggerEditorDataService.clear())}})}},{key:"reloadPageAndClearSwaggerAndCodeEditorData",value:function(e){e&&this.codeEditorDataService.clear(),this.swaggerEditorDataService.clear(),this.$route.reload()}},{key:"navigateToEditApi",value:function(e){this.codeEditorDataService.clear(),this.swaggerEditorDataService.clear(),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiTabUrlFromCaller(e,!0,this.selectedTab))}},{key:"getServiceUrl",value:function(){var e="",t="https",i=this.swaggerEditorData.swagger;return i.schemes&&i.schemes.some(e=>"http"===e)&&!i.schemes.some(e=>"https"===e)&&(t="http"),e=t+"://",i.basePath?e+=Object(w.a)(i.host,i.basePath):e+=i.host,e}},{key:"getAlmMode",value:function(e){if(e){var t=this.swaggerEditorData.api;return t&&t.properties&&t.properties.almMode?t.properties.almMode:T.a.NotSpecified}return this.solutionId?T.a.Solution:T.a.Environment}},{key:"isMultiAuth",get:function(){return this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled}}])&&W(t.prototype,i),n&&W(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();H.$inject=[p.a.services.$location,p.a.services.$q,p.a.services.$route,p.a.services.$routeParams,p.a.services.$scope,p.a.services.$timeout,p.a.services.apisClient,p.a.services.apisClientLA,p.a.services.appSettings,p.a.services.assetService,p.a.services.clientResources,p.a.services.customApiHelper,p.a.services.customConnectorUrlService,p.a.services.environment,p.a.services.fileReaderHelperService,p.a.services.logging,p.a.services.navigation,p.a.services.policies,p.a.services.policyDataService,p.a.services.promiseHelperService,p.a.services.securityDetailsValidationService,p.a.services.copilotPluginValidationService,p.a.services.session,p.a.services.codeEditorData,p.a.services.swaggerEditorData,p.a.services.swaggerValidationService,p.a.services.trialDialog,p.a.services.widgetUtilService,p.a.services.routeCrafter]},33346:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(33328),o=i(33347),a=i(12366),s=i(13144),l=i(33350),c={evictionDelay:3e5},u={urlPath:a.K,resourceType:a.K};n.a.factory(r.a.services.apisClient,[r.a.services.appSettings,r.a.services.azureResourceClientFactory,r.a.services.environment,(e,t,i)=>{var r=Object(l.a)(e=>(e.url=Object(o.s)(e.url,i.getCurrentEnvironmentName()),e)),n=Object(l.a)();return t({urlBase:Object(s.c)(e).powerAppsRP,urlPath:u.urlPath,apiVersion:e.powerAppsResourceProviderApiVersionWithEnvironments,resourceType:u.resourceType,rest:{get:{params:{id:"@id",$expand:"swagger"},requestInterceptor:r},post:{params:{id:"@id"},requestInterceptor:r},put:{params:{},requestInterceptor:r},patch:{params:{id:"@id"},requestInterceptor:r},delete:{params:{id:"@id"},requestInterceptor:r},query:{responseInterceptor:e=>e.data&&e.data.filter(e=>!Object(o.t)(e)),requestInterceptor:r}},actions:[{name:"validateApiSwaggerToWadl",urlPath:"/providers/Microsoft.PowerApps/objectIds/:objectId/validateApiSwaggerToWadl",method:"POST",requestInterceptor:n},{name:"validateApiSwagger",urlPath:"/providers/Microsoft.PowerApps/objectIds/:objectId/validateApiSwagger",method:"POST",params:{enableopenapivalidation:"@enableopenapivalidation"},requestInterceptor:n},{name:"downgradeOpenApiContract",urlPath:"/providers/Microsoft.PowerApps/downgradeOpenApiContract",method:"PUT",params:{},requestInterceptor:n},{name:"generateResourceStorage",urlPath:"/providers/Microsoft.PowerApps/objectIds/:objectId/generateResourceStorage",method:"POST",params:{},requestInterceptor:n}],options:{atomize:!1,evictionDelay:c.evictionDelay}})}])},33347:function(e,t,i){"use strict";i.d(t,"o",(function(){return d})),i.d(t,"h",(function(){return p})),i.d(t,"k",(function(){return h})),i.d(t,"p",(function(){return m})),i.d(t,"g",(function(){return g})),i.d(t,"f",(function(){return f})),i.d(t,"d",(function(){return v})),i.d(t,"c",(function(){return b})),i.d(t,"u",(function(){return y})),i.d(t,"x",(function(){return w})),i.d(t,"y",(function(){return S})),i.d(t,"l",(function(){return C})),i.d(t,"m",(function(){return k})),i.d(t,"t",(function(){return P})),i.d(t,"a",(function(){return x})),i.d(t,"b",(function(){return A})),i.d(t,"n",(function(){return R})),i.d(t,"w",(function(){return O})),i.d(t,"z",(function(){return D})),i.d(t,"i",(function(){return F})),i.d(t,"s",(function(){return I})),i.d(t,"q",(function(){return j})),i.d(t,"r",(function(){return N})),i.d(t,"j",(function(){return M})),i.d(t,"e",(function(){return L}));var r=i(14868),n=i(33348),o=i(33307),a=i(33346),s=i(33349),l=i(12324),c=i.n(l),u=i(14892);function d(e){return"permissions($filter=maxAssignedTo('".concat(e.uniqueId,"'))")}function p(e){return e.properties.displayName||e.name}function h(e,t){return e.properties.iconUri||t.defaultConnection}function m(e,t){var i,r;return null!==(i=null===(r=e.properties)||void 0===r||null===(r=r.createdBy)||void 0===r?void 0:r.displayName)&&void 0!==i?i:t.Manage.Connections.Publisher.Microsoft}function g(e){return e.properties.connectionParameters||{}}function f(e){return e.properties.connectionParameterSets}function v(e,t){return c.a.find(e,{uiDefinition:{displayName:t}})}function b(e){return c.a.map(e,e=>e.uiDefinition.displayName)}function y(e){return(!S(e)||w(e))&&!P(e)&&(Object.keys(e.properties.connectionParameters||{}).length>0||Object.keys(e.properties.connectionParameterSets||{}).length>0)}function w(e){var t;return(null===(t=e.properties.connectionParameterSets)||void 0===t?void 0:t.values.length)>0}function S(e){return!!C(e.properties.connectionParameters)}function C(e){var t=Object.keys(e||{}).find(t=>Object(o.a)(e[t].type,"oauthSetting"));return t&&e[t].oAuthSettings}function k(e){for(var t of null==e?void 0:e.values){var i=C(t.parameters);if(i)return i}return null}function P(e){return!!e.properties.capabilities&&e.properties.capabilities.indexOf("composite")>-1}function x(e,t){return T(e,[n.b.CanEdit,n.b.Owner],t)}function A(e,t){return T(e,[n.b.CanEdit,n.b.CanViewWithShare,n.b.Owner],t)}function T(e,t,i){var r;return function(e,t){if(!e||!e.properties)return;return e.properties&&t.some(t=>Object(o.a)(e.properties.roleName,t))}(Object(s.a)(null==e||null===(r=e.properties)||void 0===r?void 0:r.permissions,i),t)}function R(e){var t,i;return null!==(t=null==e||null===(i=e.properties)||void 0===i||null===(i=i.apiDefinitions)||void 0===i?void 0:i.originalSwaggerUrl)&&void 0!==t?t:""}function O(e){return E(e,r.c.gateway)}function D(e){return O(e)&&!E(e,r.c.cloud)}function E(e,t){var i,r;return null!==(i=null==e||null===(r=e.properties)||void 0===r||null===(r=r.capabilities)||void 0===r?void 0:r.some(e=>Object(o.a)(e,t)))&&void 0!==i&&i}function F(e){if(e&&e.properties&&e.properties.connectionParameters)for(var t=Object.keys(e.properties.connectionParameters),i=0;i<t.length;i++){var r=t[i],n=e.properties.connectionParameters[r].type;if(n&&Object(o.a)(n,"gatewaySetting"))return r}return null}function I(e,t){if(-1===e.indexOf("environment eq")){var i="environment eq '".concat(t,"'");if(-1===e.indexOf("$filter=")){var r="&";-1===e.indexOf("?")&&(r="?"),e+="".concat(r).concat("$filter=").concat(i)}else e=e.replace("$filter=","".concat("$filter=").concat(i," and "))}return e}function j(e){return e&&e.properties&&e.properties.scriptDefinitionUrl}function N(e){return e&&e.properties&&e.properties.scriptOperations}function M(e){return e.properties.iconBrandColor||e.properties.brandColor}function L(e){return"".concat(a.a.urlPath,"/").concat(e)}i.d(t,"v",(function(){return u.e}))},33348:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var r=function(e){return e.CanView="CanView",e.CanViewWithShare="CanViewWithShare",e.CanEdit="CanEdit",e.Owner="Owner",e}({}),n={User:"User",Group:"Group",Tenant:"Tenant",NotSpecified:"NotSpecified"}},33349:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var r=i(33348);function n(e,t){return e&&e.length?e.reduce((e,i)=>{var r;return(e&&e.properties?null===(r=o(e.properties.roleName,t))||void 0===r?void 0:r.priority:Number.NEGATIVE_INFINITY)>=(i&&i.properties?o(i.properties.roleName,t).priority:Number.NEGATIVE_INFINITY)?e:i}):null}function o(e,t){switch(e){case r.b.CanView:return{name:r.b.CanView,displayName:t.Manage.CustomApi.Share.RoleView,priority:1};case r.b.CanViewWithShare:return{name:r.b.CanViewWithShare,displayName:t.Manage.CustomApi.Share.RoleViewWithShare,priority:2};case r.b.CanEdit:return{name:r.b.CanEdit,displayName:t.Manage.CustomApi.Share.RoleEdit,priority:3};case r.b.Owner:return{name:r.b.Owner,displayName:t.Manage.CustomApi.Share.RoleOwner,priority:4};default:return null}}},33350:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33338),o=i(14697),a=i(33351),s=i(11891);function l(e){return Object(o.a)()?t=>(e&&e(t),t.headers||(t.headers={}),t.headers.convertPARPtoPPAPI="convertPARPtoPPAPI",t):e}n.a.factory(r.a.interceptors.convertPARPtoPPAPIInterceptor,[r.a.services.ppapiService,e=>function(e){return{request:t=>{var i;if(!(null==t||null===(i=t.headers)||void 0===i?void 0:i.convertPARPtoPPAPI)||null==t||!t.url||!Object(a.a)(t.url))return t;delete t.headers.convertPARPtoPPAPI;var r=e.tryConvertPARPRequestUrl(t.url);if(!r.converted)return t;var n=new URL(r.path,r.endpoint);return Object.keys(r.queryParams).forEach(e=>{n.searchParams.set(e,r.queryParams[e])}),s.a(r.path,"/connectivity/downgradeOpenConnectorContract")&&(t.method="POST"),t.url=n.toString(),t}}}(e)])},33351:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(11890);function n(e){return Object(r.a)(e,"http://")||Object(r.a)(e,"https://")||Object(r.a)(e,"ws://")||Object(r.a)(e,"wss://")}},33352:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));var r=function(e){return e[e.Rest=0]="Rest",e[e.Soap=1]="Soap",e}({}),n=function(e){return e[e.NotSpecified=0]="NotSpecified",e[e.SoapToRest=1]="SoapToRest",e[e.SoapPassThrough=2]="SoapPassThrough",e}({})},33353:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){return e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Progress=4]="Progress",e[e.Success=5]="Success",e[e.UniqueRedirectUrlSuccess=6]="UniqueRedirectUrlSuccess",e}({})},33354:function(e,t,i){"use strict";var r=i(33355);i.d(t,"a",(function(){return r.a}))},33355:function(e,t,i){"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",(function(){return a}));var a=n(n({},i(13085).a),{},{asyncPollStart:"AsyncPollStart",asyncPollEnd:"AsyncPollEnd",zeroFlowRunsInfoPaneGetStart:"NoRunsInfoPaneStart",zeroFlowRunsInfoPaneGetEnd:"NoRunsInfoPaneEnd",remediationPaneLoadStart:"RemediationPaneLoadStart",remediationPaneLoadEnd:"RemediationPaneLoadEnd",remediationPanelApiCallStart:"remediationPanelApiCallStart",remediationPanelApiCallEnd:"remediationPanelApiCallEnd",remediationPaneUniversalSearchStart:"remediationPaneUniversalSearchStart",remediationPaneUniversalSearchEnd:"remediationPaneUniversalSearchEnd",remediationApiCallStart:"remediationApiCallStart",remediationApiCallEnd:"remediationApiCallEnd",activityFeedLoadStart:"ActivityFeedLoadStart",activityFeedLoadEnd:"ActivityFeedLoadEnd",activityFeedLoadMoreStart:"ActivityFeedLoadMoreStart",activityFeedLoadMoreEnd:"ActivityFeedLoadMoreEnd",flowAIBuilderModulePageLoadStart:"flowAIBuilderModulePageLoadStart",flowAIBuilderModulePageLoadEnd:"flowAIBuilderModulePageLoadEnd",autoCreateFlowFailed:"AutoCreateFlowFailed",environmentsStorageInvalid:"EnvironmentStorageInvalid",environmentsFetchFailed:"EnvironmentsFetchFailed",flowAnalyticsGetDashboardsStart:"FlowAnalyticsGetDashboardsStart",flowAnalyticsGetDashboardsEnd:"FlowAnalyticsGetDashboardsEnd",flowAnalyticsGetDashboardsV2Start:"FlowAnalyticsGetDashboardsV2Start",flowAnalyticsGetDashboardsV2End:"FlowAnalyticsGetDashboardsV2End",flowAnalyticsGetEmbeddedReportLinkStart:"FlowAnalyticsGetEmbeddedReportLinkStart",flowAnalyticsGetEmbeddedReportLinkEnd:"FlowAnalyticsGetEmbeddedReportLinkEnd",flowAnalyticsGetEmbeddedReportLinkV2Start:"FlowAnalyticsGetEmbeddedReportLinkV2Start",flowAnalyticsGetEmbeddedReportLinkV2End:"FlowAnalyticsGetEmbeddedReportLinkV2End",flowCheckerGetErrorsStart:"flowCheckerGetErrorsStart",flowCheckerGetWarningsStart:"flowCheckerGetWarningsStart",flowCheckerGetErrorsEnd:"flowCheckerGetErrorsEnd",flowCheckerGetWarningsEnd:"flowCheckerGetWarningsEnd",geocodeGetStart:"GeocodeGetStart",geocodeGetEnd:"GeocodeGetEnd",getGraphDetailsStart:"getGraphDetailsStart",getGraphDetailsEnd:"getGraphDetailsEnd",graphServiceQuerySharepointSiteStart:"GraphServiceQuerySharepointSiteStart",graphServiceQuerySharepointSiteEnd:"GraphServiceQuerySharepointSiteEnd",graphServiceQuerySharepointListStart:"GraphServiceQuerySharepointListStart",graphServiceQuerySharepointListEnd:"GraphServiceQuerySharepointListEnd",graphServiceGetThumbnailStart:"GraphServiceGetThumbnailStart",graphServiceGetThumbnailEnd:"GraphServiceGetThumbnailEnd",installFlowStart:"installFlowStart",installFlowEnd:"installFlowEnd",createTrialStart:"CreateTrialStart",createTrialEnd:"CreateTrialEnd",widgetGetUserSessionStart:"WidgetGetUserSessionStart",widgetGetUserSessionEnd:"WidgetGetUserSessionEnd",populateSessionInfoUsingAccessTokenStart:"PopulateSessionInfoUsingAccessTokenStart",populateSessionInfoUsingAccessTokenEnd:"PopulateSessionInfoUsingAccessTokenEnd",autoCreateFlowStart:"AutoCreateFlowStart",autoCreateFlowEnd:"AutoCreateFlowEnd",createFlowWithConnectionReferencesStart:"createFlowWithConnectionReferencesStart",createFlowWithConnectionReferencesEnd:"createFlowWithConnectionReferencesEnd",createFlowWithTemplateDefinitionStart:"createFlowFromTemplateDefinitionStart",createFlowWithTemplateDefinitionEnd:"createFlowFromTemplateDefinitionEnd",createFlowFromTemplateRouteStart:"createFlowFromTemplateStart",createFlowFromTemplateRouteEnd:"createFlowFromTemplateEnd",clarityScriptStart:"ClarityScriptStart",clarityScriptEnd:"ClarityScriptEnd",widgetGetUserConsentedStatusStart:"WidgetGetUserConsentedStatusStart",widgetGetUserConsentedStatusEnd:"WidgetGetUserConsentedStatusEnd",widgetGetUserDisallowedStatusStart:"WidgetGetUserDisallowedStatusStart",widgetGetUserDisallowedStatusEnd:"WidgetGetUserDisallowedStatusEnd",widgetGetIsGuestUserStart:"WidgetGetIsGuestUserStart",widgetGetIsGuestUserEnd:"WidgetGetIsGuestUserEnd",widgetGetFilteredAndSelectedPlanStart:"WidgetGetFilteredAndSelectedPlanStart",widgetGetFilteredAndSelectedPlanEnd:"WidgetGetFilteredAndSelectedPlanEnd",widgetGetEntitlementsStart:"WidgetGetEntitlementsStart",widgetGetEntitlementsEnd:"WidgetGetEntitlementsEnd",widgetGetEnvironmentStart:"WidgetGetEnvironmentStart",widgetGetEnvironmentEnd:"WidgetGetEnvironmentEnd",widgetSaveAndApplyFlowInDesignerStart:"WidgetSaveAndApplyFlowInDesignerStart",widgetSaveAndApplyFlowInDesignerEnd:"WidgetSaveAndApplyFlowInDesignerEnd",flowConnectionsPageLoadStart:"FlowConnectionsPageLoadStart",flowConnectionsPageLoadEnd:"FlowConnectionsPageLoadEnd",wigetGetUserNameStart:"WigetGetUserNameStart",wigetGetUserNameEnd:"WigetGetUserNameEnd",deleteConnectionStart:"DeleteConnectionStart",deleteConnectionEnd:"DeleteConnectionEnd",loadConnectionDisambiguationStart:"loadConnectionDisambiguationStart",loadConnectionDisambiguationEnd:"loadConnectionDisambiguationEnd",renderConnectionWizardStart:"renderConnectionWizardStart",renderConnectionWizardEnd:"renderConnectionWizardEnd",expandConnectionWizardStart:"ExpandConnectionWizardStart",expandConnectionWizardEnd:"ExpandConnectionWizardEnd",saveFlowStart:"SaveFlowStart",saveFlowEnd:"SaveFlowEnd",entitlementsRetrievalFailed:"EntitlementsRetrievalFailed",xrmSaveDraftFlowStart:"XRMSaveDraftFlowStart",xrmSaveDraftFlowEnd:"XRMSaveDraftFlowEnd",xrmPublishFlowStart:"XRMPublishFlowStart",xrmPublishFlowEnd:"XRMPublishFlowEnd",embedDefaultEnvironmentRetrievalFailed:"EmbedDefaultEnvironmentRetrievalFailed",flowCreationWidgetLoadStart:"flowCreationWidgetLoadStart",flowCreationWidgetPrefetchConnectionsStart:"flowCreationWidgetPrefetchConnectionsStart",flowCreationWidgetPrefetchConnectionsEnd:"flowCreationWidgetPrefetchConnectionsEnd",flowCreationWidgetPrefetchDesignerStart:"flowCreationWidgetPrefetchDesignerStart",flowCreationWidgetPrefetchDesignerEnd:"flowCreationWidgetPrefetchDesignerEnd",flowCreationWidgetLoadEnd:"flowCreationWidgetLoadEnd",flowRuntimeConnectionManagementStart:"FlowRuntimeConnectionManagementStart",flowRuntimeConnectionManagementEnd:"FlowRuntimeConnectionManagementEnd",sendAFlowCopyStart:"sendAFlowCopyStart",sendAFlowCopyEnd:"sendAFlowCopyEnd",sendAFlowCopyPageOpenStart:"sendAFlowCopyPageOpenStart",sendAFlowCopyPageOpenEnd:"sendAFlowCopyPageOpenEnd",sendAFlowCopyRefreshFlowRunsStart:"sendAFlowCopyRefreshFlowRunsStart",sendAFlowCopyRefreshFlowRunsEnd:"sendAFlowCopyRefreshFlowRunsEnd",sendAFlowCopyGetFlowDefinitionStart:"sendAFlowCopyGetFlowDefinitionStart",sendAFlowCopyGetFlowDefinitionEnd:"sendAFlowCopyGetFlowDefinitionEnd",saveAsFlowEnsureApiStart:"saveAsFlowEnsureApiStart",saveAsFlowEnsureApiEnd:"saveAsFlowEnsureApiEnd",saveAsFlowStart:"SaveAsFlowStart",saveAsFlowEnd:"SaveAsFlowEnd",solutionFlowSaveAsFlowStart:"SolutionFlowSaveAsFlowStart",solutionFlowSaveAsFlowEnd:"SolutionFlowSaveAsFlowEnd",invokeFlowFormLoadedWithNonConsentedUser:"invokeFlowFormLoadedWithNonConsentedUser",invokeFlowFormLoadedWithConsentedUser:"invokeFlowFormLoadedWithConsentedUser",invokeFlowFormConsentUserStart:"invokeFlowFormConsentUserStart",invokeFlowFormConsentUserEnd:"invokeFlowFormConsentUserEnd",invokeFlowInputContentLoadStart:"InvokeFlowInputContentLoadStart",invokeFlowInputContentLoadEnd:"InvokeFlowInputContentLoadEnd",invokeFlowPageLoadStart:"InvokeFlowPageLoadStart",invokeFlowPageLoadEnd:"InvokeFlowPageLoadEnd",requestRunOnlyAccessStart:"requestRunOnlyAccessStart",requestRunOnlyAccessEnd:"requestRunOnlyAccessEnd",invokeFlowWidgetLoadStart:"InvokeFlowWidgetLoadStart",invokeFlowWidgetLoadEnd:"InvokeFlowWidgetLoadEnd",invokeFlowWidgetTriggerFlowStart:"InvokeFlowWidgetTriggerFlowStart",invokeFlowWidgetTriggerFlowError:"InvokeFlowWidgetTriggerFlowError",invokeFlowWidgetGetTriggerSchemaStart:"InvokeFlowWidgetGetTriggerSchemaStart",invokeFlowWidgetGetTriggerSchemaError:"InvokeFlowWidgetGetTriggerSchemaError",invokeFlowWidgetGetTriggerSchemaEnd:"InvokeFlowWidgetGetTriggerSchemaEnd",invokeFlowWidgetDoneButtonClicked:"InvokeFlowWidgetDoneButtonClicked",invokeFlowWidgetCreateFlowDoneButtonClicked:"invokeFlowWidgetCreateFlowDoneButtonClicked",invokeFlowWidgetTriggerFlowRendered:"InvokeFlowWidgetTriggerFlowRendered",invokeFlowWidgetTriggerFlowEnd:"InvokeFlowWidgetTriggerFlowEnd",v1DesignerLoadStart:"V1DesignerLoadStart",v1DesignerLoadEnd:"V1DesignerLoadEnd",flowLoadEnd:"FlowLoadEnd",flowLoadStart:"FlowLoadStart",flowRunLoadStart:"FlowRunLoadStart",flowRunLoadEnd:"FlowRunLoadEnd",flowNewWidgetGetWidgetOptionsStart:"flowNewWidgetGetWidgetOptionsStart",flowNewWidgetGetWidgetOptionsEnd:"flowNewWidgetGetWidgetOptionsEnd",powerAutomateProxyOperationStart:"powerAutomateProxyOperationStart",powerAutomateProxyOperationEnd:"powerAutomateProxyOperationEnd",testFlowPreviousRunsLoadStart:"TestFlowPreviousRunsLoadStart",testFlowPreviousRunsLoadEnd:"TestFlowPreviousRunsLoadEnd",undoStateUpdateOnFlowSaveStart:"undoStateUpdateOnFlowSaveStart",undoStateUpdateOnFlowSaveEnd:"undoStateUpdateOnFlowSaveEnd",undoInitializeStart:"undoInitializeStart",undoInitializeEnd:"undoInitializeEnd",saveFlowDraftStart:"SaveFlowStart",saveFlowDraftEnd:"SaveFlowDraftEnd",RecommendationLoadConnectorsStart:"RecommendationLoadConnectorsStart",RecommendationLoadConnectorsEnd:"RecommendationLoadConnectorsEnd",RecommendationLoadRecommendationsStart:"RecommendationLoadRecommendationsStart",RecommendationLoadRecommendationsEnd:"RecommendationLoadRecommendationsEnd",RecommendationPanelLoadContentStart:"RecommendationPanelLoadContentStart",RecommendationPanelLoadContentEnd:"RecommendationPanelLoadContentEnd",FlowCheckerPanelLoadContentStart:"FlowCheckerPanelLoadContentStart",flowCheckerClientValidationStart:"flowCheckerClientValidationStart",flowCheckerClientValidationEnd:"flowCheckerClientValidationEnd",FlowCheckerPanelLoadContentEnd:"FlowCheckerPanelLoadContentEnd",TestFlowInvokeFlowStart:"TestFlowInvokeFlowStart",TestFlowInvokeFlowEnd:"TestFlowInvokeFlowEnd",TestFlowResubmitRunStart:"TestFlowResubmitRunStart",TestFlowResubmitRunEnd:"TestFlowResubmitRunEnd",testFlowInvokeSimulateStart:"TestFlowInvokeSimulateStart",testFlowInvokeSimulateEnd:"TestFlowInvokeSimulateEnd",getLastTriggerAndMonitorStart:"GetLastTriggerAndMonitorStart",getLastTriggerAndMonitorEnd:"GetLastTriggerAndMonitorEnd",commentsInitializeStart:"commentsInitializeStart",commentsInitializeEnd:"commentsInitializeEnd",pollForNewTestRunStart:"PollForNewTestRunStart",pollForNewTestRunEnd:"PollForNewTestRunEnd",flowAnalyticsPageLoadStart:"FlowAnalyticsPageLoadStart",flowAnalyticsPageLoadEnd:"FlowAnalyticsPageLoadEnd",flowAnalyticsReportLoadStart:"FlowAnalyticsReportLoadStart",flowAnalyticsReportLoadEnd:"FlowAnalyticsReportLoadEnd",flowAnalyticsLoadReportStart:"flowAnalyticsLoadReportStart",flowAnalyticsLoadReportEnd:"flowAnalyticsLoadReportEnd",flowAnalyticsGetFlowDetailsStart:"flowAnalyticsGetFlowDetailsStart",flowAnalyticsGetFlowDetailsEnd:"flowAnalyticsGetFlowDetailsEnd",flowAnalyticsGetFlowThrottlingMessageStart:"flowAnalyticsGetFlowThrottlingMessageStart",flowAnalyticsGetFlowThrottlingMessageEnd:"flowAnalyticsGetFlowThrottlingMessageEnd",flowAnalyticsChangeReportDurationStart:"flowAnalyticsChangeReportDurationStart",flowAnalyticsChangeReportDurationEnd:"flowAnalyticsChangeReportDurationEnd",flowOwnersPageLoadStart:"flowOwnersPageLoadStart",flowOwnersPageLoadEnd:"flowOwnersPageLoadEnd",fetchFlowAndCoauthoringDataStart:"fetchFlowAndCoauthoringDataStart",fetchFlowAndCoauthoringDataEnd:"fetchFlowAndCoauthoringDataEnd",ownersPageDeleteConnectionStart:"deleteOwnersPageConnectionStart",ownersPageDeleteConnectionEnd:"deleteOwnersPageConnectionEnd",flowOwnersLoadStart:"FlowOwnersLoadStart",flowOwnersLoadEnd:"FlowOwnersLoadEnd",addFlowOwnerStart:"AddFlowOwnerStart",addFlowOwnerEnd:"AddFlowOwnerEnd",flowRunOnlySaveStart:"FlowRunOnlySaveStart",flowRunOnlySaveEnd:"FlowRunOnlySaveEnd",deleteFlowOwnerStart:"DeleteFlowOwnerStart",deleteFlowOwnerEnd:"DeleteFlowOwnerEnd",getGraphSharepointDetailsStart:"getGraphSharepointDetailsStart",getGraphSharepointDetailsEnd:"getGraphSharepointDetailsEnd",getOperationManifestStart:"getOperationManifestStart",getOperationManifestEnd:"getOperationManifestEnd",addSharePointFlowOwnerStart:"addSharePointFlowOwnerStart",addSharePointFlowOwnerEnd:"addSharePointFlowOwnerEnd",publishTemplateStart:"PublishTemplateStart",publishTemplateEnd:"PublishTemplateEnd",parameterValidationServiceValidateParameterStart:"parameterValidationServiceValidateParameterStart",parameterValidationServiceValidateParameterEnd:"parameterValidationServiceValidateParameterEnd",userPlansRetrievalFailed:"UserPlansRetrievalFailed",flowProcessInsightsPageLoadStart:"flowProcessInsightsPageLoadStart",flowProcessInsightsPageLoadEnd:"flowProcessInsightsPageLoadEnd",userSettingsSaveStart:"UserSettingsSaveStart",userSettingsSaveEnd:"UserSettingsSaveEnd",userPreferencesUpdateFailed:"UserPreferencesUpdateFailed",switchCaseUnhandled:"switchCaseUnhandled",myCustomApiInlineImportSwaggerUrlStart:"myCustomApiInlineImportSwaggerUrlStart",myCustomApiInlineImportSwaggerUrlEnd:"myCustomApiInlineImportSwaggerUrlEnd",myCustomApiInlineImportPostmanStart:"myCustomApiInlineImportPostmanStart",myCustomApiInlineImportPostmanEnd:"myCustomApiInlineImportPostmanEnd",myCustomApiInlineImportSwaggerFileStart:"myCustomApiInlineImportSwaggerFileStart",myCustomApiInlineImportSwaggerFileEnd:"myCustomApiInlineImportSwaggerFileEnd",WsdlServicesLoadStart:"WsdlServicesLoadStart",WsdlServicesLoadEnd:"WsdlServicesLoadEnd",ExtractSwaggerFromWsdlStart:"ExtractSwaggerFromWsdlStart",ExtractSwaggerFromWsdlEnd:"ExtractSwaggerFromWsdlEnd",myCustomApiPropertiesGetPermissionsStart:"myCustomApiPropertiesGetPermissionsStart",myCustomApiPropertiesGetPermissionsEnd:"myCustomApiPropertiesGetPermissionsEnd",myCustomApiPropertiesLoadStart:"MyCustomApiPropertiesLoadStart",myCustomApiPropertiesLoadEnd:"myCustomApiPropertiesLoadEnd",myCustomApiGetCurrentUserPermissionStart:"MyCustomApiGetCurrentUserPermissionStart",myCustomApiGetCurrentUserPermissionEnd:"MyCustomApiGetCurrentUserPermissionEnd",myCustomApiPropertiesRefreshPermissionsStart:"myCustomApiPropertiesRefreshPermissionsStart",myCustomApiPropertiesRefreshPermissionsEnd:"myCustomApiPropertiesUpdatePermissionsEnd",myCustomApiGetTenantDetailsStart:"MyCustomApiGetTenantDetailsStart",myCustomApiGetTenantDetailsEnd:"MyCustomApiGetTenantDetailsEnd",myCustomApiModifyPermissionsStart:"MyCustomApiModifyPermissionsStart",myCustomApiModifyPermissionsEnd:"MyCustomApiModifyPermissionsEnd",getCustomCodeLogBlobSasUriStart:"getCustomCodeLogBlobSasUriStart",getCustomCodeLogBlobSasUriEnd:"getCustomCodeLogBlobSasUriEnd",myCustomApiTestOperationStartNoSLA:"myCustomApiTestOperationStartNoSLA",myCustomApiTestOperationEndNoSLA:"myCustomApiTestOperationEndNoSLA",myCustomApiTestCreateConnectionStartNoSLA:"myCustomApiTestCreateConnectionStartNoSLA",myCustomApiTestCreateConnectionEndNoSLA:"myCustomApiTestCreateConnectionEndNoSLA",swaggerValidationException:"SwaggerValidationException",recommendedTemplatesRenderingOnHomePageStart:"RecommendedTemplatesRenderingOnHomePageStart",recommendedTemplatesRenderingOnHomePageEnd:"RecommendedTemplatesRenderingOnHomePageEnd",templateManagerDeleteTemplateStart:"templateManagerDeleteTemplateStart",templateManagerDeleteTemplateEnd:"templateManagerDeleteTemplateEnd",templatesLoadStart:"TemplatesLoadStart",templatesLoadEnd:"TemplatesLoadEnd",templateSearchStart:"TemplateSearchStart",templateSearchEnd:"TemplateSearchEnd",templateSearchLoadMoreStart:"TemplateSearchLoadMoreStart",templateSearchLoadMoreEnd:"TemplateSearchLoadMoreEnd",extendTrialStart:"ExtendTrialStart",extendTrialEnd:"ExtendTrialEnd",userConsentFailed:"userConsentFailed",userConsentDetailsRetrievalFailed:"UserConsentDetailsRetrievalFailed",pollForNewRunStart:"pollForNewRunStart",pollForNewRunEnd:"pollForNewRunEnd",flowRunOnlyLoadStart:"flowRunOnlyLoadStart",flowRunOnlyLoadEnd:"flowRunOnlyLoadEnd",flowPropertiesRunOnlyPanelLoadStart:"FlowPropertiesRunOnlyPanelLoadStart",flowPropertiesRunOnlyPanelLoadEnd:"FlowPropertiesRunOnlyPanelLoadEnd",flowPropertiesRunOnlyPanelAddSharepointForSolutionFlowStart:"flowPropertiesRunOnlyPanelAddSharepointForSolutionFlowStart",flowPropertiesRunOnlyPanelAddSharepointForSolutionFlowEnd:"flowPropertiesRunOnlyPanelAddSharepointForSolutionFlowEnd",flowEasyAutoPromptWorkflowStart:"flowEasyAutoPromptWorkflowStart",flowEasyAutoPromptWorkflowEnd:"flowEasyAutoPromptWorkflowEnd",EasyAutomationFlowDefinitionSaved:"EasyAutomationFlowDefinitionSaved"})},33356:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return o}));var r=function(e){return e.OpenApiFile="OpenApiFile",e.PostmanFile="PostmanFile",e.OpenApiUrl="OpenApiUrl",e}({}),n=function(e){return e.WsdlFile="WsdlFile",e.WsdlUrl="WsdlUrl",e}({}),o=function(e){return e.none="none",e.postman="postman",e.postmanV2="postmanV2",e.swaggerFile="swaggerFile",e.swaggerUrl="swaggerUrl",e.wsdlFile="wsdlFile",e.wsdlUrl="wsdlUrl",e.github="github",e.azureApim="azureApim",e.azureFunctions="azureFunctions",e.azureLogicApps="azureLogicApps",e}({})},33357:function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return h})),i.d(t,"K",(function(){return m})),i.d(t,"u",(function(){return g})),i.d(t,"t",(function(){return f})),i.d(t,"L",(function(){return v})),i.d(t,"l",(function(){return b})),i.d(t,"G",(function(){return y})),i.d(t,"s",(function(){return w})),i.d(t,"v",(function(){return S})),i.d(t,"w",(function(){return C})),i.d(t,"A",(function(){return k})),i.d(t,"z",(function(){return P})),i.d(t,"J",(function(){return x})),i.d(t,"H",(function(){return A})),i.d(t,"E",(function(){return T})),i.d(t,"C",(function(){return R})),i.d(t,"D",(function(){return O})),i.d(t,"F",(function(){return D})),i.d(t,"m",(function(){return F})),i.d(t,"p",(function(){return I})),i.d(t,"o",(function(){return j})),i.d(t,"n",(function(){return N})),i.d(t,"r",(function(){return M})),i.d(t,"I",(function(){return L})),i.d(t,"g",(function(){return U})),i.d(t,"e",(function(){return B})),i.d(t,"h",(function(){return $})),i.d(t,"f",(function(){return q})),i.d(t,"d",(function(){return W})),i.d(t,"i",(function(){return z})),i.d(t,"y",(function(){return H})),i.d(t,"j",(function(){return V})),i.d(t,"k",(function(){return _})),i.d(t,"B",(function(){return G})),i.d(t,"x",(function(){return K})),i.d(t,"q",(function(){return J})),i.d(t,"c",(function(){return Y}));var r=i(20342),n=i(11891),o=i(33358),a=i(12330),s=i(33359),l=i(33360),c=i(33361),u=i(33363),d=i(33372),p={swagger:"2.0",info:{title:"Default title",description:"",version:"1.0"},host:"",basePath:"/",schemes:["https"],consumes:[],produces:[],paths:{},definitions:{},parameters:{},responses:{},securityDefinitions:{},security:[],tags:[]},h=Object(o.a)(p),m="parameter";function g(e,t){return Array.isArray(e)?e.map(e=>v(e,t)):[]}function f(e,t){var i=g(e,t);return i.forEach(e=>{e.schema&&(e.schema=Object(u.g)(t,e.schema).schema)}),i}function v(e,t){if(y(e)){var i=b(t,e.$ref);return i?i.item:null}return e}function b(e,t){if(Object(a.a)(t))return null;var i=e,r=t.split("/");return!r||r.length<=1||"#"!==r[0]?null:(r.slice(1).forEach(e=>{i=Array.isArray(i)?i.filter(t=>t.name===e)[0]:i[e]}),i||null)}function y(e){return e&&!Object(a.a)(e.$ref)}function w(e,t,i){return g(t,i).map(e=>e.name+e.in).indexOf(e.name+e.in)}function S(e,t,i){var r=e.swagger.parameters.map(e=>e.item).indexOf(i);return A(t.source,r,e)?r:-1}function C(e,t,i){var r=e.swagger.responses.map(e=>e.name).indexOf(i.name);return A(t.source,r,e)?r:-1}function k(e,t){return E(t)&&!Object(a.a)(e)&&e>=0&&e<t.swagger.actions.length}function P(e,t){var i;return E(t)&&!Object(a.a)(e)&&e>=0&&e<t.swagger.actions.length&&(null===(i=t.swagger.actions[e].operation["x-ms-openai-data"])||void 0===i||null===(i=i.operations)||void 0===i?void 0:i.length)>0&&!Object(a.a)(t.swagger.actions[e].operation["x-ms-openai-data"].operations[0].operationId)}function x(e,t){return function(e){return e&&e.swagger&&e.swagger.triggers&&e.swagger.triggers.length>0}(t)&&!Object(a.a)(e)&&e>=0&&e<t.swagger.triggers.length}function A(e,t,i){return i&&i.swagger&&i.swagger[e]&&i.swagger[e].length>0&&t>=0&&t<i.swagger[e].length}function T(e,t){return t&&t.operation&&t.operation.parameters&&t.operation.parameters.length>0&&e>=0&&e<t.operation.parameters.length}function R(e,t){var i;if((null==t||null===(i=t.operation)||void 0===i||null===(i=i["x-ms-openai-data"])||void 0===i||null===(i=i.operations)||void 0===i||null===(i=i[0])||void 0===i||null===(i=i.parameters)||void 0===i?void 0:i.length)>0){var n=t.operation.parameters[e],o=t.operation["x-ms-openai-data"].operations[0].parameters.findIndex(e=>e.name===n.name&&e.type===r.b.upsert);if(-1===o)return!1;if(t.operation["x-ms-openai-data"].operations[0].parameters&&t.operation["x-ms-openai-data"].operations[0].parameters[o]&&t.operation["x-ms-openai-data"].operations[0].parameters[o].properties)return!0}return!1}function O(e,t,i){var n;if(i.parameters&&i.parameters[e]&&t&&(null==t||null===(n=t.operation)||void 0===n||null===(n=n["x-ms-openai-data"])||void 0===n||null===(n=n.operations)||void 0===n||null===(n=n[0])||void 0===n||null===(n=n.parameters)||void 0===n?void 0:n.length)>0){var o=i.parameters[e].item,a=t.operation["x-ms-openai-data"].operations[0].parameters.findIndex(e=>e.name===o.name&&e.type===r.b.upsert);if(-1===a)return!1;if(t.operation["x-ms-openai-data"].operations[0].parameters&&t.operation["x-ms-openai-data"].operations[0].parameters[a]&&t.operation["x-ms-openai-data"].operations[0].parameters[a].properties)return!0}return!1}function D(e,t){return t&&t.operation&&t.operation.responses&&t.operation.responses.length>0&&e>=0&&e<t.operation.responses.length}function E(e){return e&&e.swagger&&e.swagger.actions&&e.swagger.actions.length>0}function F(){return{method:"get",operation:{responses:[{name:s.c,item:{description:s.c,schema:{}}}]},path:""}}function I(){return{method:"get",operation:{responses:[]},path:""}}function j(e,t){var i,n=function(e,t){var i,n,o,a;return{operationId:null!==(i=e.swagger.actions[t].operation.operationId)&&void 0!==i?i:"","x-ms-require-user-confirmation":(null===(n=e.swagger.actions[t])||void 0===n?void 0:n.method)!==r.c.get&&(null===(o=e.swagger.actions[t])||void 0===o?void 0:o.method)!==r.c.head&&(null===(a=e.swagger.actions[t])||void 0===a?void 0:a.method)!==r.c.options}}(e,t);return{"openai-enabled":!0===(null===(i=e.swagger)||void 0===i||null===(i=i.actions[t])||void 0===i||null===(i=i.operation)||void 0===i||null===(i=i["x-ms-openai-data"])||void 0===i?void 0:i["openai-enabled"]),operations:[n]}}function N(e,t,i,r){return{name:(e?t.swagger.parameters[r].item:t.swagger.actions[i].operation.parameters[r]).name,type:"upsert",properties:[]}}function M(e,t){return e.actions.concat(e.triggers).filter(e=>!!Array.isArray(e.operation.parameters)&&e.operation.parameters.some(e=>e.$ref==="#/parameters/".concat(t)))}function L(e){var t=(null==e?void 0:e.openapi)||(null==e?void 0:e.swagger)||"2";return parseFloat(t)<3}function U(e,t){var i,r=B(e,t);return null==e||null===(i=e.securityDefinitions)||void 0===i?void 0:i[r]}function B(e,t){var i;return Object.keys(null!==(i=null==e?void 0:e.securityDefinitions)&&void 0!==i?i:{}).find(i=>Object(n.a)(e.securityDefinitions[i].type,t))}function $(e,t){var i;return null!==(i=U(e,t))&&void 0!==i?i:function(e){var t;return null==e||null===(t=e.securityDefinitions)||void 0===t?void 0:t[Object.keys((null==e?void 0:e.securityDefinitions)||{})[0]]}(e)}function q(e,t){var i;return null!==(i=B(e,t))&&void 0!==i?i:Object.keys((null==e?void 0:e.securityDefinitions)||{})[0]}function W(e,t){var i,r=Object.keys(null!==(i=null==e?void 0:e.securityDefinitions)&&void 0!==i?i:{}).filter(i=>Object(n.a)(e.securityDefinitions[i].type,t)),o={};for(var a of r)o[a]=e.securityDefinitions[a];return o}function z(e){if(null!=e&&e.securityDefinitions)for(var t in e.securityDefinitions)if(e.securityDefinitions.hasOwnProperty(t)&&e.securityDefinitions[t].type)return e.securityDefinitions[t].type;return"none"}function H(e){return Object.keys(null==e?void 0:e.securityDefinitions).length>1}function V(e){var t=[];if(null!=e&&e.securityDefinitions)for(var i in e.securityDefinitions)e.securityDefinitions.hasOwnProperty(i)&&e.securityDefinitions[i].type&&t.push(e.securityDefinitions[i].type);return t}function _(e,t){var i=e.schemes&&e.schemes[0]?e.schemes[0].trim():"",r=e.host?e.host.trim():"",n=i?"".concat(i,"://").concat(r):r,o=e.basePath?e.basePath.trim():"";o&&o.endsWith("/")&&(o=o.substring(0,o.length-1));var a=t.path?t.path.trim():"";return"".concat(n).concat(o).concat(a)}function G(e){return!Object(n.a)(e,r.c.get)&&!Object(n.a)(e,r.c.head)&&!Object(n.a)(e,r.c.options)}function K(e,t){for(var i=Q(e,t),r=[],n=function(){var t={referencingItems:[],definitionNames:[]};i.definitionNames.forEach(i=>{t=X(t,Q(e,i)),r.push(i)}),i=X(i,t),r.forEach(e=>{var t=i.definitionNames.indexOf(e);t>=0&&i.definitionNames.splice(t,1)})};i.definitionNames.length>0;)n();return i.referencingItems}function X(e,t){var i=e.referencingItems.concat(t.referencingItems),r=e.definitionNames.concat(t.definitionNames),n={};return i.forEach(e=>{var t="".concat(e.operationItem.method).concat(e.operationItem.path);n[t]||(n[t]=e)}),{referencingItems:Object.keys(n).map(e=>n[e]),definitionNames:Object(l.f)(r)}}function Q(e,t){var i={referencingItems:[],definitionNames:[]},r="#/definitions/".concat(t);return e.actions.concat(e.triggers).forEach(e=>{if(Array.isArray(e.operation.parameters)&&e.operation.parameters.some(e=>Object.keys(Object(c.a)(e)).indexOf(r)>=0))return void i.referencingItems.push({operationItem:e,referenceType:m});if(Array.isArray(e.operation.responses)&&e.operation.responses.some(e=>Object.keys(Object(c.a)(e.item)).indexOf(r)>=0))return void i.referencingItems.push({operationItem:e,referenceType:"response"})}),Array.isArray(e.definitions)&&(i.definitionNames=e.definitions.filter(e=>Object.keys(Object(c.a)(e)).indexOf(r)>=0).map(e=>e.name)),i}function J(e,t){var i=null;return e&&e.paths&&Object.keys(e.paths).forEach(r=>{var o=e.paths[r];Object.keys(o||{}).forEach(e=>{var r=o[e];r&&Object(n.a)(r.operationId,t)&&(i=r)})}),i}function Y(e){if(Object(a.a)(e)||Object(l.m)(e,"$ref"))return[];var t=new d.BodyParameterProcessor(e,{excludeAdvanced:!1,excludeInternal:!1}).getParameters(),i=t.filter(e=>e.type===r.f.array);return i.length>0&&(i.forEach(e=>{var i=function(e){if(Object(a.a)(e)||e.type!==r.f.array)return[];var t={in:r.e.body,schema:e.itemSchema},i=new d.BodyParameterProcessor(t,{excludeAdvanced:!1,excludeInternal:!1}).getParameters().map(e=>e);return i.forEach(t=>{t.isInsideArray=!0,t.parentArray=e.key}),i}(e);t=t.concat(i)}),t=t.filter(e=>e.type!==r.f.array)),t}},33358:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(14751),n=i.n(r),o=i(20342),a=i(33359),s=i(14876),l=i(12330);function c(e){if(e){var t,i,r,c,u=e=n()(e);return e.definitions&&(u.definitions=Object.keys(e.definitions).map(t=>({name:t,item:e.definitions[t]}))),e.parameters&&(u.parameters=Object.keys(e.parameters).map(t=>({name:t,item:e.parameters[t]}))),e.responses&&(u.responses=Object.keys(e.responses).map(t=>({name:t,item:e.responses[t]}))),u.actions=[],u.triggers=[],u.host&&(u.host=decodeURI(u.host)),u.basePath&&(u.basePath=decodeURI(u.basePath)),Object(s.a)(u.paths)?u:(t=u.paths,i=u.triggers,r=u.actions,c=[],Object.keys(t).forEach(e=>{var n=t[e];n&&Object.keys(o.c).map(e=>o.c[e]).forEach(o=>{var u=n[o];if(Object(s.a)(u)||(Object(l.a)(u.operationId)||(u.operationId=function(e,t){var i=e.replace(/\//g,"_");return t.some(e=>e===i)?"".concat(i).concat(t.length):i}(u.operationId,c),c.push(u.operationId)),u.responses&&(u.responses=Object.keys(u.responses).map(e=>({name:e,item:u.responses[e]})))),!Object(s.a)(u))if(u.hasOwnProperty(a.i.Trigger)){var d={path:e,method:o,operation:u};n[a.i.NotificationContent]&&(d[a.i.NotificationContent]=n[a.i.NotificationContent]),i.push(d)}else r.push({path:e,method:o,operation:n[o]});delete t[e][o]})}),u)}}},33359:function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"i",(function(){return n})),i.d(t,"f",(function(){return o})),i.d(t,"e",(function(){return a})),i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return l})),i.d(t,"k",(function(){return c})),i.d(t,"j",(function(){return u})),i.d(t,"l",(function(){return d})),i.d(t,"d",(function(){return p})),i.d(t,"g",(function(){return h})),i.d(t,"h",(function(){return m})),i.d(t,"m",(function(){return g}));var r="default",n={DynamicSchema:"x-ms-dynamic-schema",DynamicValues:"x-ms-dynamic-values",NotificationContent:"x-ms-notification-content",NotificationUrl:"x-ms-notification-url",Permission:"x-ms-permission",Summary:"x-ms-summary",TestValue:"x-ms-test-value",Trigger:"x-ms-trigger",TriggerHint:"x-ms-trigger-hint",TriggerMetadata:"x-ms-trigger-metadata",TriggerValue:"x-ms-trigger-value",Visibility:"x-ms-visibility",NoGenericTest:"x-ms-no-generic-test"},o={readOnly:"read-only"},a={Trace:"ocp-apim-trace",TraceLocation:"ocp-apim-trace-location",SubscriptionKey:"apihub-subscription-key"},s="x-ms-log-blob-sas-uri",l="x-ms-log-to-response",c={ValueCollection:"value-collection",ValuePath:"value-path"},u={Single:"single",Batch:"batch"},d=function(e){return e.none="none",e.advanced="advanced",e.internal="internal",e.important="important",e}({}),p={valueCollection:"value-collection",valuePath:"value-path",valueTitle:"value-title"},h=function(e){return e.definitions="definitions",e.parameters="parameters",e.responses="responses",e}({}),m=[h.definitions,h.parameters,h.responses];function g(e,t){return e&&e.length>0?e.map(e=>({name:e.name,source:t})):[]}},33360:function(e,t,i){"use strict";i.d(t,"l",(function(){return h})),i.d(t,"k",(function(){return m})),i.d(t,"j",(function(){return g})),i.d(t,"i",(function(){return f})),i.d(t,"f",(function(){return v})),i.d(t,"m",(function(){return b}));var r=i(14876);i.d(t,"n",(function(){return r.a}));var n=i(19940);i.d(t,"h",(function(){return n.b}));var o=i(16927);i.d(t,"g",(function(){return o.a}));var a=i(17450);i.d(t,"a",(function(){return a.a}));var s=i(13031);i.d(t,"d",(function(){return s.a}));i(12327);var l=i(13083);i.d(t,"p",(function(){return l.a}));var c=i(14883);i.d(t,"b",(function(){return c.d})),i.d(t,"c",(function(){return c.e}));var u=i(14898),d=i(15523);i.d(t,"e",(function(){return d.a}));var p=i(12330);function h(e){return Object(p.a)(e)||Object(r.a)(e.trim())?"":-1===e.indexOf(" ")?e[0].toUpperCase()+e.substring(1):e.trim().split(" ").map(e=>e&&e[0].toUpperCase()+e.substring(1).toLowerCase()).join("")}function m(e){return e.size/1024/1024}function g(e){return Object(p.a)(e)?"":"".concat(Object(u.a)(function(e){return Object(p.a)(e)?"":e.replace(/\.[^/.]+$/,"")}(e)),".").concat(f(e))}function f(e){return Object(p.a)(e)?"":e.substr(e.lastIndexOf(".")+1)}function v(e){var t=[],i={};return e.forEach(e=>{i[e]||(i[e]=!0,t.push(e))}),t}function b(e,t){if(Object(p.a)(e)||Object(r.a)(t)||"object"!=typeof e)return!1;if(e.hasOwnProperty(t))return!0;for(var i in e)if(b(e[i],t))return!0;return!1}i.d(t,"o",(function(){return p.a}))},33361:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return l}));var r=i(14876),n=i(33279),o=i(33362),a=i.n(o);function s(e,t,i){return function(e,t,i){if(Object(r.a)(e)||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(e=>s(e,t,i));return Object.keys(e).forEach(r=>e[r]=s(e[r],t,i)),a()(e,(e,r)=>r.replace(t,i))}(Object(n.copy)(e),t,i)}function l(e){return function e(t,i,n){var o={};if(Object(r.a)(t)||"object"!=typeof t||i.some(e=>e===t))return{};i.push(t),t.$ref&&(o[t.$ref]=[n]);Array.isArray(t)?t.forEach((t,r)=>{var a=e(t,i,"".concat(n,"[").concat(r,"]"));o=c(o,a)}):Object.keys(t).map(r=>e(t[r],i,"".concat(n,".").concat(r.split(".").join("~1")))).forEach(e=>{o=c(o,e)});return o}(e,[],"")}function c(e,t){var i=Object(n.copy)(e);return Object.keys(t).forEach(e=>{i[e]?i[e]=i[e].concat(t[e]):i[e]=t[e]}),i}},33363:function(e,t,i){"use strict";i.d(t,"b",(function(){return C})),i.d(t,"e",(function(){return T})),i.d(t,"a",(function(){return D})),i.d(t,"d",(function(){return F})),i.d(t,"f",(function(){return I})),i.d(t,"i",(function(){return j})),i.d(t,"g",(function(){return N})),i.d(t,"h",(function(){return U})),i.d(t,"c",(function(){return B}));var r=i(14751),n=i.n(r),o=i(20342),a=i(33359),s=i(33361),l=i(14754),c=i.n(l),u=i(12066),d=i.n(u),p=i(12067),h=i.n(p),m=i(12330),g=i(14876),f=i(13083),v=i(33364),b=i(13143),y=i(13009),w=i(11891),S=i(33365);function C(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};if(Object(m.a)(e))return i.allowNullType?{type:o.f.null}:r;var n=typeof e;switch(n){case o.f.number:return e.toString().indexOf(".")>-1?{type:o.f.number,format:"float"}:{type:o.f.integer,format:"int32"};case o.f.boolean:return{type:o.f.boolean};case o.f.string:return k(e,i,t);case o.f.object:return x(e,i,t);default:return r}}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r={type:o.f.string};try{var n=JSON.parse(e);return typeof n===o.f.object?x(n,t,i):r}catch(a){if(Object(y.y)(a)===y.e.ValidationError)throw a;return t.returnUndefinedOnError?void 0:r}}function P(e){var t=typeof e;return t===o.f.number&&-1===e.toString().indexOf(".")?t=o.f.integer:e instanceof Array&&(t=o.f.array),t}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if(e instanceof Array){var r,n={type:o.f.array};return e.forEach(e=>{if(void 0!==r){var t=P(e),n=P(r);if(n===o.f.integer&&t===o.f.number||n===o.f.number&&t===o.f.integer)r=1.5;else{if(n!==t)throw new v.a(b.b.schemaGenerationError,i.SchemaUtil.Error.DifferentTypesInArray);n===o.f.object&&t===o.f.object&&(r=d()(r,e))}}else r=e}),n.items=C(r,i,t),n}return A(e,t,i)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r={type:o.f.string},n={type:o.f.object,properties:{}};return Object(m.a)(e)?r:(0!==Object.keys(e).length&&Object.keys(e).forEach(t=>{var r={type:o.f.string};null!==e[t]&&(r=C(e[t],i)),r.description=t,n.properties[t]=r}),t.assignDefaultValue&&(n.default=e),t.assignTestValue&&(n[a.i.TestValue]=e),n)}function T(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Object(m.a)(e)?[]:Object(m.a)(t)?[{propertyPresent:!1,propertyName:i}]:t.type===o.f.null||e.type===o.f.number&&t.type===o.f.integer||e.type===o.f.string&&(t.type===o.f.object||t.type===o.f.array)?[]:e.type!==t.type?[{propertyPresent:!0,propertyName:i,expectedType:e.type.toString(),actualType:t.type.toString()}]:e.format!==t.format?[{propertyPresent:!0,propertyName:i,expectedType:"".concat(e.type," ").concat(e.format),actualType:"".concat(t.type," ").concat(t.format)}]:e.type===o.f.array?R(e,t,i):e.type===o.f.object?O(e,t,i):[]}function R(e,t,i){return Object(m.a)(e.items)||Object(m.a)(t.items)?[]:T(e.items,t.items,Object(g.a)(i)?"Item":"".concat(i,".Item"))}function O(e,t,i){var r=[];return Object(m.a)(e.properties)||Object.keys(e.properties).forEach(n=>{var o=t.properties?t.properties[n]:null;if(Object(m.a)(o)){if(!Object(m.a)(e.required)&&e.required.indexOf(n)>-1){var a={propertyPresent:!1,propertyName:n};r.push(a)}}else r=r.concat(T(e.properties[n],o,"".concat(i,".").concat(n)))}),r}function D(e){var t={};return e.forEach(e=>{var i=function(e){if(null!==e.default&&Object(f.a)(e.default))return;if(t=e.type,t===o.f.integer||t===o.f.number)return+e.default;var t;if(i=e,i&&Object(w.a)(i.type,"boolean"))return"true"===e.default||!0===e.default;var i;return e.default}(e);if(void 0!==i){var r=E(e.key),n="body.$"===r&&e.type!==o.f.object;if("body.$"===e.parentArray)t=Object(g.a)(t)?[{}]:t,n?t=[i]:h()(t[0],r,i);else if(e.parentArray){var a=E(e.parentArray);a=F(a);var s=c()(t,a);n?s=[i]:(s=Object(m.a)(s)?[{}]:s,h()(s[0],r,i)),h()(t,a,s)}else n?t=i:h()(t,r,i)}}),Array.isArray(t)||"object"!=typeof t||(t=Object(s.b)(t,"~1",".")),t}function E(e){return"."===(e="$"===e[0]?e.substr(1):e)[0]?e.substr(1):e}function F(e){return Object(f.a)(e)||"."!==e[0]?e:e.substr(1)}function I(e){return!Object(m.a)(e)&&!!e[a.i.DynamicSchema]}function j(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(m.a)(e))return[];if(Object(m.a)(t))return e;var r=t;return Array.isArray(r)||"object"!=typeof r||(r=Object(s.b)(t,".","~1")),e.forEach(e=>{var t,n=E(e.key),a="body.$"===n&&e.type!==o.f.object;if("body.$"===e.parentArray)t=a?r[0]:c()(r[0],n);else if(e.parentArray){var s=E(e.parentArray),l=c()(r,s);if(Object(m.a)(l)||Object(m.a)(l[0]))return;t=a?l[0]:c()(l[0],n)}else t=a?r:c()(r,n);e.default=i||Object(m.a)(e.default)?t:e.default}),e}function N(e,t){var i=n()(e),r=n()(t),o={};i.definitions&&Array.isArray(i.definitions)&&i.definitions.forEach(e=>{o["#/definitions/".concat(e.name)]=e.item});var a={};return{schema:M(i,n()(r),o,a),referencesUsed:Object.keys(a).filter(e=>!!a[e]).filter((e,t,i)=>i.indexOf(e)===t).map(e=>e.split("/")[2])}}function M(e,t,i,r){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(Object(m.a)(t))return null;if(null===n&&(n={}),!Object(m.a)(t.$ref)){var s=i[t.$ref];return n[t.$ref]?t:(n[t.$ref]=!0,r[t.$ref]=!0,M(e,s,i,r,n))}return t.type===o.f.object?(Object(m.a)(t.properties)||(t.properties=L(e,t.properties,i,r,n)),Object(m.a)(t.additionalProperties)||"boolean"==typeof t.additionalProperties||(t.additionalProperties=M(e,t.additionalProperties,i,r,n))):t.type===o.f.array?Object(m.a)(t.items)||(t.items=M(e,t.items,i,r,n)):t.type===o.f.any&&(t.type=null),""===t[a.i.Visibility]&&(t[a.i.Visibility]=null),t}function L(e,t,i,r,o){var a={};return Object.keys(t).forEach(s=>{var l=t[s],c=M(e,l,i,r,n()(o));a[s]=c}),a}function U(e,t,i){var r={},n={};return i&&Array.isArray(i.definitions)&&i.definitions.forEach(e=>{n["#/definitions/".concat(e.name)]=e.item}),e.forEach(e=>{var i=e.key.replace(/^(\$)/g,"").split(".").filter(e=>!Object(f.a)(e)).map(e=>e.replace("~1",".")),a=t,s="",l="";i.forEach(e=>{if(a.$ref&&(s=a.$ref,l="",a=n[a.$ref]),"array"===a.type)a=a.items,l="".concat(""===l?"":"".concat(l,"."),"items");else if("object"===a.type){var t=Object.keys(a.properties).filter(t=>t===e.replace("~1","."))[0];if(!t)throw new Error("Schema not found");a=a.properties[t],l="".concat(""===l?"":"".concat(l,"."),"properties.").concat(t.replace(".","~1"))}}),e.type===o.f.any&&(e.type=null),""===e.visibility&&(e.visibility=null),r[e.key]={path:l,reference:s.split("/")[2]}}),r}function B(e){var t=new S.SchemaProcessor({excludeInternal:!1,excludeAdvanced:!1,required:!0}).getSchemaProperties(e).filter(e=>-1===["object","array"].indexOf(e.type)),i=U(t,e,null),r=Object(s.b)(e,".","~1");return t.forEach(t=>{var n=c()(r,i[t.key].path)||e;t.leafTitle=n&&(n.title||n["x-ms-summary"])||""}),t.sort((e,t)=>e.key<t.key?-1:1)}},33364:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(16808),n=i(16809);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=u(e);if(t){var n=u(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return c(this,i)}}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(c,e);var t,i,r,a=l(c);function c(e,t,i,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a.call(this,n.a.ValidationError,t,e,r,i)}return t=c,i&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(r.a)},33373:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(14751),n=i.n(r),o=i(33359);function a(e){var t=e=n()(e);if(e.definitions&&Array.isArray(e.definitions)){var i={};e.definitions.forEach(e=>{i[e.name]=e.item}),t.definitions=i}if(e.parameters&&Array.isArray(e.parameters)){var r={};e.parameters.forEach(e=>{r[e.name]=e.item}),t.parameters=r}if(e.responses&&Array.isArray(e.responses)){var a={};e.responses.forEach(e=>{a[e.name]=e.item}),t.responses=a}t.paths||(t.paths={});var s=[];return Array.isArray(t.actions)&&(s=s.concat(t.actions)),Array.isArray(t.triggers)&&(s=s.concat(t.triggers)),s.forEach(e=>{var i={};e.operation.responses&&Array.isArray(e.operation.responses)&&e.operation.responses.forEach(e=>{i[e.name]=e.item}),e.operation.responses=i,t.paths[e.path]||(t.paths[e.path]={}),e[o.i.NotificationContent]&&(t.paths[e.path][o.i.NotificationContent]=e[o.i.NotificationContent]),t.paths[e.path][e.method]=e.operation}),delete t.actions,delete t.triggers,t.host&&(t.host=decodeURI(t.host)),t.basePath&&(t.basePath=decodeURI(t.basePath)),JSON.stringify(t)}},33374:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"e",(function(){return l})),i.d(t,"d",(function(){return c})),i.d(t,"f",(function(){return u}));var r=i(13003),n=i(12381),o=i(11806),a=i(14690);function s(e,t){var i=Object(r.a)(e),a="".concat(i.protocol,"://").concat(i.host).concat(i.path),s=Object(n.a)(a,t),l=Object(o.b)(i.parameters);return l&&(s="".concat(s,"?").concat(l)),s}function l(e){return Object(r.a)(Object(a.a)(e))}function c(e){var t=Object(r.a)(e),i=decodeURI(t.path),n=e.indexOf("?"),o=-1===n?e:e.substring(0,n);return i.indexOf(o)>0&&(i=o),t.path=0===i.indexOf("/")?i:"/".concat(i),t}function u(e,t,i){var n=Object(r.a)(e),a=n.parameters;return a[t]=i,Object(o.b)(a)?"".concat(n.protocol,"://").concat(n.host).concat(n.path,"?").concat(Object(o.b)(a)):"".concat(n.protocol,"://").concat(n.host).concat(n.path)}i.d(t,"c",(function(){return r.a})),i.d(t,"b",(function(){return o.c}))},33375:function(e,t,i){"use strict";function r(e,t,i){return t&&((e=e||{properties:{}}).properties=e.properties||{},e.properties.environment={name:i}),e}function n(e,t,i){return t&&((e=e||{properties:{}}).properties=e.properties||{},e.properties.environment={id:"/providers/Microsoft.PowerApps/environments/".concat(i),name:i}),e}i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}))},33376:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(11808),n=()=>!!Object(r.a)().customConnectorCopilotTab.getConfig().isCustomConnectorCopilotTabEnabled},33377:function(e,t,i){e.exports=i.p+"static/media/swaggerEditor.6520a462.less"},33378:function(e,t){e.exports='<trial-dialog></trial-dialog>\n<div class="swaggerEditor" role="contentinfo">\n    \x3c!-- TODO(nidurak): move the headers plus alert to a component and merge with the custom api properties page --\x3e\n    <div class="swaggerEditor-header">\n        <div class="copilotTabHeaderMessage" ng-if="swaggerEditorCtrl.isCopilotTab && swaggerEditorCtrl.isCopilotMessageBarOpen">\n            <react-text-message-bar\n                ng-if="swaggerEditorCtrl.isCopilotTab"\n                type="swaggerEditorCtrl.messageBarType.info"\n                message="::swaggerEditorCtrl.clientResources.Manage.CustomApi.CopilotTab.TabHeaderMessageBar.title"\n                links-with-interpolation-props="swaggerEditorCtrl.props"\n                onDismiss="swaggerEditorCtrl.onMessageBarDismiss">\n            </react-text-message-bar>\n        </div>\n        <div class="row swaggerEditor-messageHeader">\n                <alert\n                    class="swaggerEditor-errorAlert"\n                    model="swaggerEditorCtrl.swaggerEditorData.statusAlert"\n                    ng-if="swaggerEditorCtrl.swaggerEditorData.statusAlert.type !== swaggerEditorCtrl.alertType.None"\n                    dismiss-focus-element="::swaggerEditorCtrl.saveCustomApiButtonId"\n                    focus-on-action="true"></alert>\n                <alert\n                    class="swaggerEditor-errorAlert"\n                    model="swaggerEditorCtrl.codeEditorDataService.CodeEditorData.statusAlert"\n                    ng-if="swaggerEditorCtrl.codeEditorDataService.CodeEditorData.statusAlert.type !== swaggerEditorCtrl.alertType.None"\n                    dismiss-focus-element="::swaggerEditorCtrl.saveCustomApiButtonId"\n                    focus-on-action="true"></alert>\n                <react-action-button\n                    ng-if="swaggerEditorCtrl.swaggerEditorData.statusAlert.type !== swaggerEditorCtrl.alertType.None"\n                    class="swaggerEditor-copyClipBoard"\n                    on-click="swaggerEditorCtrl.onClipBoardClicked"\n                    text="swaggerEditorCtrl.copyClipBoardText"\n                    title="swaggerEditorCtrl.copyClipBoardText"\n                    icon-name="swaggerEditorCtrl.iconName.Copy">\n                </react-action-button>\n                <react-action-button\n                    ng-if="swaggerEditorCtrl.codeEditorDataService.CodeEditorData.statusAlert.type !== swaggerEditorCtrl.alertType.None"\n                    class="swaggerEditor-copyClipBoard"\n                    on-click="swaggerEditorCtrl.onClipBoardClicked"\n                    text="swaggerEditorCtrl.copyClipBoardText"\n                    title="swaggerEditorCtrl.copyClipBoardText"\n                    icon-name="swaggerEditorCtrl.iconName.Copy">\n                </react-action-button>\n        </div>\n        <div class="swaggerEditor-topHeader" ng-class="{\'swaggerEditor-topHeader--shifted\': swaggerEditorCtrl.swaggerEditorData.statusAlert.type}">\n            <div class="row swaggerEditor-topHeader-row">\n                <react-back-button\n                    ng-if="!swaggerEditorCtrl.widgetUtilService.isLogicApps()"\n                    class="swaggerEditor-topHeader-button"\n                    back-url="swaggerEditorCtrl.backButtonUrl"\n                    is-disabled="swaggerEditorCtrl.isOperationInProgress"\n                    client-resources="::swaggerEditorCtrl.clientResources">\n                </react-back-button>\n                <label for="{{::swaggerEditorCtrl.apiNameInputId}}" class="swaggerEditor-topHeader-ApiNameLabel">{{swaggerEditorCtrl.clientResources.Manage.CustomApi.apiName}}</label>\n                <input type="text"\n                    class="c-text-field swaggerEditor-topHeader-input"\n                    ng-model="swaggerEditorCtrl.swaggerEditorData.displayName"\n                    ng-readonly="swaggerEditorCtrl.isOperationInProgress || swaggerEditorCtrl.swaggerEditorData.editMode"\n                    id="{{::swaggerEditorCtrl.apiNameInputId}}"\n                    placeholder="{{::swaggerEditorCtrl.clientResources.Common.Untitled}}"\n                 >\n            </div>\n        </div>\n        <div id="heading-tabs-{{::swaggerEditorCtrl.$scope.$id}}" class="swaggerEditor-bottomHeader" ng-class="{\'swaggerEditor-bottomHeader--shifted\': swaggerEditorCtrl.swaggerEditorData.statusAlert.type}">\n            <div class="row">\n                <div role="tablist" class="swaggerEditor-bottomHeader-tabs">\n                    <span ng-repeat="tab in swaggerEditorCtrl.tabs">\n                        <a href="{{swaggerEditorCtrl.customConnectorUrlService.getCustomApiTabUrl(tab.tabName)}}"\n                           class="swaggerEditor-tab"\n                           role="tab"\n                           title="{{tab.tabHeader}}"\n                           ng-class="{\'swaggerEditor-tab--active\': swaggerEditorCtrl.selectedTab === tab.tabName, \'swaggerEditor-tab--first\': $first }"\n                           aria-label="{{tab.tabHeader}}"\n                           aria-selected="{{swaggerEditorCtrl.selectedTab === tab.tabName}}">\n                            <span class="swaggerEditor-tab-number">{{$index + 1}}. </span>\n                            <span class="swaggerEditor-tab-name">{{tab.tabHeader}}</span>\n                        </a>\n                        <span class="swaggerEditor-tabSeperator ms-Icon ms-Icon--ChevronRight x-hidden-focus" ng-if="!$last"></span>\n                    </span>\n                </div>\n                <react-default-button\n                    class="swaggerEditorTabsDropdown heading-button heading-contextual-menu"\n                    menu-props="swaggerEditorCtrl.tabsDropdown"\n                    text="swaggerEditorCtrl.selectedTabText">\n                </react-default-button>\n                <div class="swaggerEditor-bottomHeader-actions">\n                    <react-button-with-custom-menu class="visible-380px" items="swaggerEditorCtrl.editorDropdownItems" icon-name="swaggerEditorCtrl.editorDropdownIconName" >\n                    </react-button-with-custom-menu>\n                    <react-button-with-custom-menu\n                                           class="visible-480px not-visible-380px"\n                                           items="swaggerEditorCtrl.editorDropdownItemsToggleOnly"\n                                           icon-name="swaggerEditorCtrl.editorDropdownIconName">\n                    </react-button-with-custom-menu>\n                    <react-toggle\n                                  class="swaggerEditor-bottomHeader-action not-visible-480px"\n                                  on-change="swaggerEditorCtrl.onChangeSwaggerEditorType"\n                                  disabled="swaggerEditorCtrl.isOperationInProgress"\n                                  checked="swaggerEditorCtrl.swaggerEditorData.isInlineSwaggerEditor"\n                                  on-text="::swaggerEditorCtrl.clientResources.Manage.CustomApi.inlineSwaggerEditor"\n                                  off-text="::swaggerEditorCtrl.clientResources.Manage.CustomApi.inlineSwaggerEditor">\n                    </react-toggle>\n                    <react-action-button id="{{::swaggerEditorCtrl.saveCustomApiButtonId}}"\n                                         class="swaggerEditor-bottomHeader-action not-visible-380px"\n                                         on-click="swaggerEditorCtrl.onCreateApiClicked"\n                                         disabled="swaggerEditorCtrl.isOperationInProgress"\n                                         text="swaggerEditorCtrl.saveCustomApiText"\n                                         title="swaggerEditorCtrl.saveCustomApiText"\n                                         icon-name="swaggerEditorCtrl.iconName.Accept">\n                    </react-action-button>\n                    <react-action-button ng-if="!swaggerEditorCtrl.widgetUtilService.isLogicApps()"\n                                         class="swaggerEditor-bottomHeader-action not-visible-380px"\n                                         on-click="swaggerEditorCtrl.onCancelClicked"\n                                         disabled="swaggerEditorCtrl.isOperationInProgress"\n                                         text="swaggerEditorCtrl.closeCustomApiText"\n                                         title="swaggerEditorCtrl.closeCustomApiText"\n                                         icon-name="swaggerEditorCtrl.iconName.Cancel">\n                    </react-action-button>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="swagger-editor-container"\n            ng-class="{\'swagger-editor-container-shifted\': swaggerEditorCtrl.swaggerEditorData.statusAlert.type, \'code-editor-container-shifted\': swaggerEditorCtrl.codeEditorDataService.CodeEditorData.statusAlert.type}">\n        <div class="swagger-editor-content" ng-hide="swaggerEditorCtrl.swaggerEditorData.spinner.show" ng-if="swaggerEditorCtrl.isSwaggerDataReady"\n            ng-class="swaggerEditorCtrl.swaggerEditorData.isInlineSwaggerEditor ? \'\' : \'row\'">\n            <div ng-if="!swaggerEditorCtrl.swaggerEditorData.isInlineSwaggerEditor">\n                <div class="swagger-editor-content-tab" ng-if="swaggerEditorCtrl.isGeneralTab">\n                    <custom-api-general-tab></custom-api-general-tab>\n                </div>\n                <div class="swagger-editor-content-tab" ng-if="swaggerEditorCtrl.isSecurityTab">\n                    <react-custom-api-security-tab-wrapper ng-if="swaggerEditorCtrl.isMultiAuth"></react-custom-api-security-tab-wrapper>\n                    <custom-api-security-tab ng-if="!swaggerEditorCtrl.isMultiAuth"></custom-api-security-tab>\n                </div>\n                <div class="swagger-editor-content-tab" ng-if="swaggerEditorCtrl.isDefinitionTab">\n                    <custom-api-definition-tab></custom-api-definition-tab>\n                </div>\n                <div class="swagger-editor-content-tab" ng-if="swaggerEditorCtrl.isCodeTab">\n                    <custom-api-code-tab></custom-api-code-tab>\n                </div>\n                <div class="swagger-editor-content-tab" ng-if="swaggerEditorCtrl.isTestTab">\n                    <custom-api-test-tab></custom-api-test-tab>\n                </div>\n                <div class="swagger-editor-content-tab" ng-if="swaggerEditorCtrl.isCopilotTab">\n                    <custom-api-copilot-tab></custom-api-copilot-tab>\n                </div>\n            </div>\n            <div class="swagger-editor-content-tab" ng-if="swaggerEditorCtrl.swaggerEditorData.isInlineSwaggerEditor">\n                <custom-api-swagger-editor-tab></custom-api-swagger-editor-tab>\n            </div>\n        </div>\n    </div>\n    <div class="row debug-pane" ng-if="swaggerEditorCtrl.debug">\n        <pre>{{swaggerEditorCtrl.swaggerEditorData | json}}</pre>\n        <pre>{{swaggerEditorCtrl.getSwagger() | json}}</pre>\n    </div>\n    <spinner model="swaggerEditorCtrl.swaggerEditorData.spinner"></spinner>\n</div>'},33379:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33380),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33387),this.controllerAs="customApisCtrl",this.resolve={setPageTitle:[n.a.services.$document,n.a.services.clientResources,n.a.services.appSettings,function(e,t,i){e[0].title=Object(a.a)(t.PageTitle.CustomApis,i.brandName)}]}}));r.a.component(n.a.components.apis,new u)},33380:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var r=i(33327),n=i(13085),o=i(33381),a=i(33382),s=i(33383),l=i(33347),c=i(13009),u=i(33353),d=i(13272),p=i(15523),h=i(33384),m=i(11891),g=i(33385),f=i(33386),v=i(15991),b=i(33376);function y(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var S=function(){function e(t,i,r,m,y,w,S,C,k,P,x,A,T,R){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.apisClient=i,this.appSettings=r,this.assetService=m,this.clientResources=y,this.customConnectorUrlService=w,this.hostCommunicationService=S,this.loggingService=C,this.navigationService=k,this.policiesService=P,this.policyConfigurationService=x,this.sessionService=A,this.trialDialog=T,this.widgetUtilService=R,this.headerButtonId="customApis-headerButton-".concat(Object(p.a)()),this.apisResult=void 0,this.spinner=void 0,this.contextualMenu=void 0,this.coachmark=void 0,this.customApiList=void 0,this.customConnectorDialogModel={},this.statusAlert={type:u.a.None,message:"",options:{}},this.shouldShowFreePlanDialogPromise=void 0,this.showHeaderSpinner=!1,this.fullPageErrorModel=void 0,this.onClickUpdate=(e,t)=>{this.customConnectorDialogModel={api:t,dialogMode:e,show:!0}},this.fullPageErrorModel={image:this.assetService.fullPageErrorGeneric,isPageErrored:!1,pageTitle:null},this.trialDialog.tryBlockMSA(),this.customApiList={id:"customApis",apis:[],apiType:a.a.Custom,markedForDeletion:[],onLoading:!1,loaded:!1,hideCommandsInDropDown:!1,statusAlert:this.statusAlert};var O=[{key:"createFromBlank",text:this.clientResources.Manage.CustomApi.Create.FromBlank.MenuLabel,onClick:()=>{this.$scope.$applyAsync(()=>{this.customConnectorDialogModel={dialogMode:o.a.Blank,show:!0}})}},{key:"createFromAzureService",text:this.clientResources.Manage.CustomApi.Create.FromAzureService.MenuLabel,onClick:()=>{this.$scope.$applyAsync(()=>{this.customConnectorDialogModel={dialogMode:o.a.AzureService,show:!0}})}},{key:"importFile",text:this.clientResources.Manage.CustomApi.Create.FromOpenAPIFile.MenuLabel,onClick:()=>{this.$scope.$applyAsync(()=>{this.customConnectorDialogModel={dialogMode:o.a.OpenApiFile,show:!0}})}},{key:"importUrl",text:this.clientResources.Manage.CustomApi.Create.FromOpenAPIUrl.MenuLabel,onClick:()=>{this.$scope.$applyAsync(()=>{this.customConnectorDialogModel={dialogMode:o.a.OpenApiUrl,show:!0}})}},{key:"postman",text:this.clientResources.Manage.CustomApi.Create.FromPostman.MenuLabel,onClick:()=>{this.$scope.$applyAsync(()=>{this.customConnectorDialogModel={dialogMode:o.a.Postman,show:!0}})}},{key:"github",text:this.clientResources.Manage.CustomApi.Create.FromGithub.MenuLabel,onClick:()=>{this.$scope.$applyAsync(()=>{this.customConnectorDialogModel={dialogMode:o.a.Github,show:!0}})}}];if(Object(f.a)()){var D={key:"importOpenAIUrl",text:this.clientResources.Manage.CustomApi.Create.FromOpenAIUrl.MenuLabel,onClick:()=>{this.$scope.$applyAsync(()=>{this.customConnectorDialogModel={dialogMode:o.a.OpenAIUrl,show:!0}})}};O.splice(2,0,D)}this.contextualMenu={buttonId:this.headerButtonId,iconName:d.a.Add,menuProps:{items:O,shouldFocusOnMount:!0,isBeakVisible:!1},text:this.clientResources.Manage.CustomConnection.Create.Api.button},this.coachmark={show:!1,headline:this.clientResources.Manage.CustomApi.CopilotTab.Coachmark.openAIPlugin.headline,bodyContent:this.clientResources.Manage.CustomApi.CopilotTab.Coachmark.openAIPlugin.bodyContent,hyperLink:v.a.CopilotPluginTab.connectorPluginCertification,primaryButtonProps:{text:this.clientResources.Manage.CustomApi.CopilotTab.Coachmark.openAIPlugin.primaryButtonText,onClick:()=>{Object(g.a)("copilotPluginCoachMark"),this.coachmark.show=!1}},onDismiss:()=>{Object(g.a)("copilotPluginCoachMark"),this.coachmark.show=!1}},this.spinner={size:s.c.Large,show:!0,local:s.a.Local};var E=this.loggingService.profilePageStart(n.a.myCustomApisLoadStart),F=this.sessionService.getUserInfo();this.shouldShowFreePlanDialogPromise=this.policiesService.checkShouldShowFreePlanDialog(),this.policiesService.shouldShowUpgradeToProDialog()?this.loggingService.logInfo("CustomApisCtrl.getCustomApisForUser","Not fetching custom apis since this is not a pro user"):(this.apisResult=this.apisClient.query(this.$scope,{$expand:Object(l.o)(F),$filter:"IsCustomApi eq 'True'"}),this.policyConfigurationService.updateHideKeys(),this.apisResult.$promise.then(()=>{this.customApiList.loaded=!0,this.spinner.show=!1,Object(b.a)()&&(this.coachmark.show=Object(g.b)("copilotPluginCoachMark")),this.customApiList.apis=this.getCustomApisNotMarkedForDeletion(this.apisResult);var e=(this.customApiList.apis||[]).map(e=>e.id),t=(this.customApiList.apis||[]).map(e=>{var t;return null===(t=e.properties)||void 0===t||null===(t=t.connectionParameters)||void 0===t||null===(t=t.token)||void 0===t||null===(t=t.oAuthSettings)||void 0===t?void 0:t.identityProvider}),i=(this.customApiList.apis||[]).map(e=>{var t;return null===(t=e.properties)||void 0===t||null===(t=t.connectionParameters)||void 0===t||null===(t=t.token)||void 0===t||null===(t=t.oAuthSettings)||void 0===t?void 0:t.redirectMode});this.loggingService.profilePageEnd(E,n.a.myCustomApisLoadEnd,{status:c.e.Success,customApiIds:e,identityProviders:t,customApiRedirectModes:i})}).catch(e=>{this.loggingService.profilePageEnd(E,n.a.myCustomApisLoadEnd,{status:Object(c.y)(e),error:Object(c.db)(e)}),this.spinner.show=!1,Object(h.b)(this.fullPageErrorModel,e),this.loggingService.logError("CustomApisCtrl.getCustomApisForUser",e)}),this.apisResult.$watch(this.$scope,e=>{this.customApiList.apis=this.getCustomApisNotMarkedForDeletion(this.apisResult)}),this.widgetUtilService.isWidgetPage()&&this.hostCommunicationService.onCustomApiRefreshApis(()=>{var e=this.loggingService.profileStart(n.a.myCustomApiRefreshApisTriggeredByHostStart);this.spinner.show=!0,this.apisResult.$refresh().then(()=>{this.spinner.show=!1,this.loggingService.profileEndWithSuccess(e,n.a.myCustomApiRefreshApisTriggeredByHostEnd)}).catch(t=>{this.loggingService.profileEnd(e,n.a.myCustomApiRefreshApisTriggeredByHostEnd,Object(c.y)(t),t)})}))}var t,i,r;return t=e,(i=[{key:"onAddConnection",value:function(){this.spinner.show=this.customApiList.onLoading}},{key:"onCreateOrUpdateCustomApi",value:function(e){if(e)this.navigationService.navigate(this.customConnectorUrlService.getDefaultEditCustomApisUrl(e.name));else{var t=document.referrer||"/";this.policiesService.shouldShowUpgradeToProDialog()?this.trialDialog.showUpgradeToProRequiredDialog(()=>{window.location.assign(t)}):(this.showHeaderSpinner=!0,this.userHasCreatedMoreThanOneCustomApi()?this.shouldShowFreePlanDialogPromise.then(e=>{this.showHeaderSpinner=!1,e?this.trialDialog.showStartFreeTrialDialog(e=>{e&&this.navigationService.navigate(this.customConnectorUrlService.getCustomApiNewDefaultUrl())}):this.navigationService.navigate(this.customConnectorUrlService.getCustomApiNewDefaultUrl())}):(this.showHeaderSpinner=!1,this.navigationService.navigate(this.customConnectorUrlService.getCustomApiNewDefaultUrl())))}}},{key:"userHasCreatedMoreThanOneCustomApi",value:function(){var e=this.sessionService.getUserInfo();return this.customApiList.apis.filter(t=>t.properties&&t.properties.createdBy&&Object(m.a)(t.properties.createdBy.id,e.uniqueId)&&!this.isMarkedForDeletion(t)).length>0}},{key:"getCustomApisNotMarkedForDeletion",value:function(e){return e.filter(e=>Object(l.v)(e)&&!this.isMarkedForDeletion(e)).sort((e,t)=>e.properties.displayName>t.properties.displayName?1:-1)}},{key:"isMarkedForDeletion",value:function(e){return this.customApiList.markedForDeletion.filter(t=>t.id===e.id).length>0}}])&&y(t.prototype,i),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();S.$inject=[r.a.services.$scope,r.a.services.apisClient,r.a.services.appSettings,r.a.services.assetService,r.a.services.clientResources,r.a.services.customConnectorUrlService,r.a.services.hostCommunicationService,r.a.services.logging,r.a.services.navigation,r.a.services.policies,r.a.services.policyConfigurationService,r.a.services.session,r.a.services.trialDialog,r.a.services.widgetUtilService]},33381:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){return e[e.Blank=0]="Blank",e[e.OpenApiFile=1]="OpenApiFile",e[e.OpenApiUrl=2]="OpenApiUrl",e[e.Postman=3]="Postman",e[e.AzureService=4]="AzureService",e[e.Github=5]="Github",e[e.OpenAIUrl=6]="OpenAIUrl",e}({})},33382:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){return e[e.Default=0]="Default",e[e.Custom=1]="Custom",e}({})},33383:function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var r=function(e){return e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large",e}({}),n=function(e){return e[e.NotSpecified=0]="NotSpecified",e[e.Global=1]="Global",e[e.Local=2]="Local",e[e.LocalHorizontal=3]="LocalHorizontal",e[e.LocalStatic=4]="LocalStatic",e}({}),o={global:"spinner-global",local:"spinner",localHorizontal:"spinner-local-horizontal",localStatic:""}},33384:function(e,t,i){"use strict";function r(e,t,i,r){e.error=t,e.time=new Date,e.isPageErrored=!0,i&&(e.friendlyErrorText=i),r&&(e.friendlyErrorSubtext=r)}function n(e){if(null===e||-1===e.indexOf('"accessToken":'))return e;var t=e.indexOf('"accessToken":')+'"accessToken":'.length,i=t+(-1===e.substring(t).indexOf(",")?e.substring(t).length-1:-1!==e.substring(t).indexOf("}")&&e.substring(t).indexOf(",")>e.substring(t).indexOf("}")?e.substring(t).indexOf("}"):e.substring(t).indexOf(",")),r=e.substring(t,i);return e.replace(r,'""')}i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}))},33385:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return o}));var r=i(12345);function n(e){var t,i=r.a.currentEnvironmentName+"-"+e;if((t=localStorage.hasOwnProperty(i)?JSON.parse(localStorage.getItem(i)):{name:i,visitedCount:0,lastVisited:new Date}).visitedCount>3)return!1;var n=new Date,o=new Date(t.lastVisited);return!(t.visitedCount>0&&n.getTime()-o.getTime()<3e5)&&(localStorage.setItem(i,JSON.stringify(t)),!0)}function o(e){var t=r.a.currentEnvironmentName+"-"+e,i=JSON.parse(localStorage.getItem(t));i.visitedCount+=1,i.lastVisited=new Date,localStorage.setItem(t,JSON.stringify(i))}},33386:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(11808),n=()=>!!Object(r.a)().openAIPluginTemplate.getConfig().enableOpenAIPlugin},33387:function(e,t){e.exports='<trial-dialog></trial-dialog>\n<div class="subsection-manage section-manage-apis" ng-if="!customApisCtrl.fullPageErrorModel.isPageErrored">\n    <heading\n        label="customApisCtrl.clientResources.Manage.CustomConnections.title"\n        contextual-menu="customApisCtrl.contextualMenu"\n        show-spinner="customApisCtrl.showHeaderSpinner"\n        coachmark="customApisCtrl.coachmark"></heading>\n    <h6 class="row top-align content-header">{{customApisCtrl.contentHeader}}</h6>\n    <div class="custom-apis-body" role="main">\n        <alert model="customApisCtrl.statusAlert"></alert>\n        <div class="row top-align" ng-show="customApisCtrl.customApiList.loaded && !customApisCtrl.spinner.show">\n            <div class="column">\n                <api-list model="customApisCtrl.customApiList" on-add-connection="customApisCtrl.onAddConnection()" on-click-update="customApisCtrl.onClickUpdate(dialogMode, api)"></api-list>\n            </div>\n        </div>\n        <custom-connector-dialog model="customApisCtrl.customConnectorDialogModel" on-continue="customApisCtrl.onCreateOrUpdateCustomApi(api)" on-cancel="customApisCtrl.onCancelDialog()"></custom-connector-dialog>\n        <spinner model="customApisCtrl.spinner"></spinner>\n    </div>\n</div>\n<full-page-error model="customApisCtrl.fullPageErrorModel" ng-if="customApisCtrl.fullPageErrorModel.isPageErrored"></full-page-error>\n'},33388:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(33335),n=i(33327),o=i(33389),a=i(33390),s=i(13031);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function c(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=c((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.controllerAs="flowRunsCtrl",this.template=i(33400),this.resolve={setPageTitle:[n.a.services.$document,n.a.services.appSettings,n.a.services.clientResources,function(e,t,i){e[0].title=Object(s.a)(i.PageTitle.Flows,t.brandName)}]},t=t||{},this.resolve[a.m]=[()=>!(!t||!t.isSharedFlow)]}));r.a.component(n.a.components.flowRuns,new d)},33389:function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var r=i(33327),n=i(33390),o=i(33391),a=i(33396),s=i(33383),l=i(33360),c=i(33394),u=i(33392),d=i(11891),p=i(33355),h=i(13016),m=i(14900),g=i(17190),f=i(17210),v=i(33398),b=i(14877),y=i(28985),w=i(22770),S=i(14835),C=i(33399),k=i(13e3);function P(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function x(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?P(Object(i),!0).forEach((function(t){A(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):P(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function A(e,t,i){return(t=R(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function T(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R(r.key),r)}}function R(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var O=function(){function e(t,i,r,o,g,f,S,k,P,A,T,R,O,D,E,F,I,j,N,M,L,U){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.appSettings=r,this.clientResources=o,this.dateTimeService=g,this.environmentService=f,this.flowTriggerHistoriesClient=S,this.flowRunService=k,this.flowRunsClient=P,this.flowRunsHistoryCsvDownloadService=A,this.flowsClient=T,this.loggingService=R,this.navigationService=O,this.telemetry=D,this.routeCrafter=E,this.widgetUtilService=F,this.universalSearchService=I,this.assetService=j,this.cdnService=N,this.isSharedFlow=M,this.flowRunHistoryService=L,this.flowService=U,this.flowRunList=void 0,this.hasMoreRuns=void 0,this.title=void 0,this.fullPageErrorModel=void 0,this.allowableFilters=void 0,this.availableFilters=void 0,this.selectedFilter=void 0,this.filterModel=void 0,this.flowName=void 0,this.solutionId=void 0,this.flow=void 0,this.backUrl=void 0,this.detailsPageUrl=void 0,this.isLoading=void 0,this.runsPageUrl=void 0,this.messageBarProps=void 0,this.throttlingMessage=void 0,this.flowRunsHistoryCsvDownloadLinkAsyncPollState=void 0,this.downloadButton=void 0,this.remediationUIState=void 0,this.isFilterSelectedFromFiltersMenu=void 0,this.shownColumns=void 0,this.triggerOutputs=void 0,this.allColumnViewPreferences=void 0,this.isLoadingTriggerOutputs=void 0,this.friendlyMappingForButtonTriggerParameters=void 0,this.remediationPaneCorrelationId=void 0,this.onSelectFilter=(t,i)=>{i.key.includes(n.a.invalid)||(this.$scope.$on("$destroy",()=>{e._isFilterSelectedFromFiltersMenu=!0}),this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.ListFlowRunsFilterSelected,null,{flowName:this.flowName,filter:i}),this.selectedFilter=i,this.flowRunList.filter=i.key,this.navigationService.navigate(Object(m.p)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:this.isSharedFlow,isUIFlow:!1,filter:i.key}))}))},this.onEdit=()=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.EditFlowClicked,null,{flowName:this.flowName});var e=Object(m.d)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:this.isSharedFlow});this.navigationService.navigate(e,{backUrl:this.backUrl})})},this.onResubmit=(e,t)=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.ResubmitFlowRunClicked);var e=t.data;if(confirm(Object(l.d)(this.clientResources.Dialogs.ConfirmFlowRunResubmitMessage,e.length))){this.telemetry.tagEvent(v.a.ConfirmResubmitRunYesClicked),this.loggingService.logInfo("FlowRunsCtrl.onResubmit",Object(l.d)("Flow name {0} resubmit batch size {1}",this.flowName,e.length));var i=e.length>1?p.a.flowRunsHistoryPageBulkResubmitStart:p.a.flowRunsHistoryPageSingleResubmitStart,r=e.length>1?p.a.flowRunsHistoryPageBulkResubmitEnd:p.a.flowRunsHistoryPageSingleResubmitEnd,n=this.loggingService.profileStart(i);this.isLoading=!0,e.forEach((t,i)=>{setTimeout(()=>{var r=this.loggingService.profileStart(p.a.flowRunsHistoryPageResubmitStart);this.flowRunService.resubmitFlowRun(this.$scope,this.flowName,t.properties.trigger.name,t.name,this.backUrl).then(()=>{if(this.loggingService.profileEnd(r,p.a.flowRunsHistoryPageResubmitEnd,u.a.Success),this.appSettings.featureFlags.enableFlowRunBulkOperations){var e=this.getFilterString();this.flowRunsClient.refreshQuery(null===e?{flowName:this.flowName}:{flowName:this.flowName,$filter:e})}}).then(()=>{i===e.length-1&&(this.isLoading=!1)}).catch(e=>{this.loggingService.profileEnd(r,p.a.flowRunsHistoryPageResubmitEnd,Object(u.b)(e),Object(u.e)(e)),this.loggingService.logError("FlowRunsCtrl.onResubmit",e),this.onPageError(e),this.isLoading=!1})},1e3*i)}),this.loggingService.profileEnd(n,r,u.a.Success)}else this.telemetry.tagEvent(v.a.ConfirmResubmitRunNoClicked)})},this.onCancel=(e,t)=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.CancelFlowRunClicked);var e=t.data;if(confirm(Object(l.d)(this.clientResources.Dialogs.ConfirmFlowRunCancelMessage,e.length))){this.telemetry.tagEvent(v.a.ConfirmCancelRunYesClicked),this.loggingService.logInfo("FlowRunsCtrl.onCancel",Object(l.d)("Flow name {0} cancel batch size {1}",this.flowName,e.length));var i=e.length>1?p.a.flowRunsHistoryPageBulkCancelStart:p.a.flowRunsHistoryPageSingleCancelStart,r=e.length>1?p.a.flowRunsHistoryPageBulkCancelEnd:p.a.flowRunsHistoryPageSingleCancelEnd,n=this.loggingService.profileStart(i);this.isLoading=!0,e.forEach((t,i)=>{setTimeout(()=>{var r=this.loggingService.profileStart(p.a.flowRunsHistoryPageCancelStart);this.flowRunService.cancelFlowRun(this.flowName,t.name).then(()=>{var t=this.getFilterString();this.flowRunsClient.refreshQuery(null===t?{flowName:this.flowName}:{flowName:this.flowName,$filter:t}).then(()=>{this.loggingService.profileEnd(r,p.a.flowRunsHistoryPageCancelEnd,u.a.Success),i===e.length-1&&(this.isLoading=!1)}).catch(e=>{this.loggingService.profileEnd(r,p.a.flowRunsHistoryPageCancelEnd,Object(u.b)(e),"An error occurred while refreshing the runs: "+Object(u.e)(e))})}).catch(e=>{Object(u.d)(e)===c.c.AzureResourceManagerRequestFailed&&Object(u.e)(e).includes(c.c.WorkflowRunCanNotBeCancelled)?this.loggingService.logInfo("FlowRunsCtrl.onCancel",e):(this.loggingService.profileEnd(r,p.a.flowRunsHistoryPageCancelEnd,Object(u.b)(e),Object(u.e)(e)),this.loggingService.logError("FlowRunsCtrl.onCancel",e),this.onPageError(e))})},500*i)}),this.loggingService.profileEnd(n,r,u.a.Success)}else this.telemetry.tagEvent(v.a.ConfirmCancelRunNoClicked)})},this.onDismissMessageBar=()=>{this.$scope.$applyAsync(()=>{this.messageBarProps=null})},this.onPageError=e=>{Object(u.d)(e)===c.c.InsufficientCdsPermissions?this.messageBarProps={ariaLabel:this.clientResources.Common.Warning,type:h.c.warning,onRenderBody:()=>this.clientResources.XrmFlow.NoAccessWarning,onDismiss:()=>this.onDismissMessageBar}:Object(u.d)(e)===c.c.InsufficientFlowPermissions?this.messageBarProps={ariaLabel:this.clientResources.Common.Warning,type:h.c.warning,onRenderBody:()=>this.clientResources.Flow.LimitedAccessWarning,onDismiss:()=>this.onDismissMessageBar}:this.messageBarProps={ariaLabel:this.clientResources.Common.Error,type:h.c.error,onRenderBody:()=>Object(u.e)(e),onDismiss:this.onDismissMessageBar}},this.onFlowNameClick=(e,t)=>{e.preventDefault(),this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.FlowDetailsBreadcrumbClicked,null,{flowName:this.flowName});var e=Object(m.m)(this.routeCrafter,{flowName:this.flowName,isLegacyShared:this.isSharedFlow,solutionId:this.solutionId});this.navigationService.navigate(e,{backUrl:Object(m.p)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:!1,isUIFlow:!1})})})},this.getRunLink=e=>e?Object(b.j)(e)?Object(m.l)(this.routeCrafter,{solutionId:this.solutionId,flowName:this.flowName,triggerHistoryName:e.name},{environmentName:this.environmentService.getCurrentEnvironmentName()}):Object(m.n)(this.routeCrafter,{solutionId:this.solutionId,flowName:this.flowName,runName:e.name,isLegacyShared:this.isSharedFlow,isUIFlow:!1,isMigrationSource:e.isMigrationSource},{environmentName:this.environmentService.getCurrentEnvironmentName()}):"",this.getRemediation=(e,t)=>{this.remediationPaneCorrelationId=this.loggingService.profilePageStart(p.a.remediationPaneLoadStart);var i=this.loggingService.profilePageStart(p.a.remediationPanelApiCallStart);return this.flowRunService.getRemediationAndDebugFlowData(this.$scope,this.flowName,e,null,t).then(t=>(this.loggingService.profileEndWithSuccess(i,p.a.remediationPanelApiCallEnd,{flowName:this.flowName,flowRunName:e,remediationType:t&&t.remediationData&&t.remediationData.remediationType}),this.remediationUIState=t,t)).catch(t=>(this.loggingService.profileEnd(i,p.a.remediationPanelApiCallEnd,Object(u.b)(t),t,{flowName:this.flowName,flowRunName:e}),this.loggingService.profileEnd(this.remediationPaneCorrelationId,p.a.remediationPaneLoadEnd,Object(u.b)(t),t,{flowName:this.flowName,flowRunName:e}),this.onPageError(t),t))},this.getSupportDocuments=(e,t)=>{var i=this.loggingService.profileStart(p.a.remediationPaneUniversalSearchStart);return this.getUniversalSearchResults(this.getSearchText(t)).then(t=>(this.updateRemediationUIState(t),this.loggingService.profileEndWithSuccess(i,p.a.remediationPaneUniversalSearchEnd,{flowName:this.flowName,flowRunName:e,universalSearchResults:t}),this.loggingService.profileEndWithSuccess(this.remediationPaneCorrelationId,p.a.remediationPaneLoadEnd,{flowName:this.flowName,flowRunName:e,remediationType:this.remediationUIState&&this.remediationUIState.remediationData&&this.remediationUIState.remediationData.remediationType,universalSearchResults:t}),this.remediationUIState)).catch(t=>(this.loggingService.profileEnd(i,p.a.remediationPaneUniversalSearchEnd,Object(u.b)(t),t,{flowName:this.flowName,flowRunName:e}),this.loggingService.profileEnd(this.remediationPaneCorrelationId,p.a.remediationPaneLoadEnd,Object(u.b)(t),t,{flowName:this.flowName,flowRunName:e}),this.onPageError(t),t))},this.setShownColumnsDefault=()=>{this.shownColumns=[w.b.duration]},this.getSavedColumnHeadersAndInitializeTriggerOutputs=()=>{this.$scope.$applyAsync(()=>{if(this.allColumnViewPreferences=this.flowRunHistoryService.getAllColumnViewPreferences(),this.allColumnViewPreferences){var e=this.allColumnViewPreferences[this.flowName];e?this.shownColumns=e:this.setShownColumnsDefault()}else this.setShownColumnsDefault();this.initializeTriggerOutputs()})},this._batchFetchAndLoadTriggerOutputs=()=>{var e,t=this.flowRunList.flowRuns;if(t&&t.length>0&&(null===(e=this.shownColumns)||void 0===e?void 0:e.length)>0&&!this.isOnlyDurationColumnShown()){var i=t.filter(e=>{var t=e.name;return!this.triggerOutputs||!this.triggerOutputs[t]});i.length>0&&(this.isLoadingTriggerOutputs=!0,this.flowRunService.getBatchTriggerOutputs(i).then(e=>{this.triggerOutputs=e,this.isLoadingTriggerOutputs=!1}))}},this.onSaveColumnHeaders=e=>{var t=this.flowRunHistoryService.updateSavedColumnHeaders(this.flowName,e,this.allColumnViewPreferences),i=!1,r=this.shownColumns.includes(w.b.duration);return this.$scope.$applyAsync(()=>{t&&(i=this.wereColumnsChanged(t,this.shownColumns.slice()),r=t.includes(w.b.duration),this.shownColumns=t,this._batchFetchAndLoadTriggerOutputs())}),this.telemetry.tagEvent(v.a.FlowRunHistoryEditColumnsSaved,x(x({},this.getTelemetryDataForRunIdentifier()),{},{dynamicColumnCount:"".concat(e.length),wasListUpdated:"".concat(i),isDurationColumnShown:"".concat(r)})),Promise.resolve(t)},this.onRunClick=()=>{this.telemetry.tagEvent(v.a.FlowRunHistoryRunClicked,this.getTelemetryDataForRunIdentifier())},this.onAddColumnClick=()=>{this.telemetry.tagEvent(v.a.FlowRunHistoryEditColumnsClicked,this.getTelemetryDataForRunIdentifier())},this.getTelemetryDataForRunIdentifier=()=>{var e=this.appSettings.featureFlags.enableFlowRunIdentifier?{dynamicColumnCount:"".concat(this.shownColumns.length),isDurationColumnShown:"".concat(this.shownColumns.includes(w.b.duration))}:null;return x({flowName:this.flowName,solutionId:this.solutionId,isUIFlow:"false",isRunsPage:"true"},e)},this.isOnlyDurationColumnShown=()=>{var e;return 1===(null===(e=this.shownColumns)||void 0===e?void 0:e.length)&&this.shownColumns.includes(w.b.duration)};var B=this.loggingService.profilePageStart(p.a.flowRunsHistoryPageLoadStart);this.isFilterSelectedFromFiltersMenu=!1,this.flowName=this.$routeParams.flowName||null,this.solutionId=this.$routeParams.solutionId;var $=new URLSearchParams(t);this.backUrl=Object(y.b)($)||null,this.detailsPageUrl=Object(m.m)(this.routeCrafter,{flowName:this.flowName,isLegacyShared:this.isSharedFlow}),this.runsPageUrl=Object(m.p)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:!1,isUIFlow:!1}),this.allowableFilters=[n.a.successfulRuns,n.a.runningRuns,n.a.failedRuns,n.a.skippedRuns,n.a.faultedRuns,n.a.ignoredRuns,n.a.pausedRuns,n.a.cancelledRuns,n.a.bulkCancelledRuns,n.a.abortedRuns,n.a.failedTriggers,n.a.allRuns],this.availableFilters=[{key:n.a.allRuns,name:o.FlowRuns.RunsFilter.AllRuns},{key:"".concat(n.a.invalid,"-0"),name:""},{key:n.a.successfulRuns,name:o.FlowRuns.RunsFilter.SuccessfulFlows},{key:n.a.failedRuns,name:o.FlowRuns.RunsFilter.FailedFlows},{key:n.a.runningRuns,name:o.FlowRuns.RunsFilter.RunningFlows},{key:n.a.cancelledRuns,name:o.FlowRuns.RunsFilter.CancelledFlows},{key:"".concat(n.a.invalid,"-1"),name:""},{key:n.a.skippedRuns,name:o.FlowRuns.RunsFilter.SkippedTriggers},{key:n.a.failedTriggers,name:o.FlowRuns.RunsFilter.FailedTriggers}],Object(C.a)()&&this.availableFilters.splice(6,0,{key:n.a.bulkCancelledRuns,name:o.FlowRuns.RunsFilter.BulkCancelledFlows});var q=this.$routeParams.filter;this.selectedFilter=q&&this.allowableFilters.includes(q)?this.availableFilters.find(e=>e.key===q):this.availableFilters[0],this.filterModel={selected:this.selectedFilter,available:this.availableFilters,onSelect:this.onSelectFilter},e._isFilterSelectedFromFiltersMenu&&(this.isFilterSelectedFromFiltersMenu=!0,e._isFilterSelectedFromFiltersMenu=!1),this.flowRunList={id:"flowRuns",filter:this.selectedFilter.key,flowName:this.flowName,flowTriggerHistoriesWithRun:void 0,flowRuns:void 0,flowTriggerHistoryFilter:e=>this.filterFlowTriggerHistoryWithRun(e),flowRunFilter:e=>this.filterFlowRun(e),latestRunTriggerOutputKeys:void 0,spinner:{size:s.c.Large,show:!0,local:s.a.Local},loadingMoreSpinner:{size:s.c.Small,local:s.a.LocalHorizontal},hasMore:()=>this.flowRunList.flowTriggerHistoriesWithRun&&this.flowRunList.flowTriggerHistoriesWithRun.$hasNextPage()||this.flowRunList.flowRuns&&this.flowRunList.flowRuns.$hasNextPage(),isLoadingMore:!1,loadNextPage:()=>{this.flowRunList.flowTriggerHistoriesWithRun&&this.flowRunList.flowTriggerHistoriesWithRun.$hasNextPage()?(this.flowRunList.isLoadingMore=!0,this.flowRunList.loadingMoreSpinner.show=!0,this.flowRunList.flowTriggerHistoriesWithRun.$getNextPage().finally(()=>{this.flowRunList.isLoadingMore=!1,this.flowRunList.loadingMoreSpinner.show=!1,this.flowRunList.flowTriggerHistoriesWithRun.sort((e,t)=>this.dateTimeService.compareDates(t.properties.startTime,e.properties.startTime)),this.hasMoreRuns=this.flowRunList.hasMore()})):this.flowRunList.flowRuns&&this.flowRunList.flowRuns.$hasNextPage()&&(this.flowRunList.isLoadingMore=!0,this.flowRunList.loadingMoreSpinner.show=!0,this.flowRunList.flowRuns.$getNextPage().finally(()=>{this.flowRunList.isLoadingMore=!1,this.flowRunList.loadingMoreSpinner.show=!1,this.flowRunList.flowRuns.sort((e,t)=>this.dateTimeService.compareDates(t.properties.startTime,e.properties.startTime)),this.hasMoreRuns=this.flowRunList.hasMore(),this.appSettings.featureFlags.enableFlowRunIdentifier&&this._batchFetchAndLoadTriggerOutputs()}))}},this.fullPageErrorModel={isPageErrored:!1,pageTitle:this.clientResources.FlowRuns.GenericTitle};var W=Object(a.b)(this.flowName,this.environmentService);this.flow=this.flowsClient.get(this.$scope,{id:W}),this.getFlowThrottlingMessage(this.flow),this.flow.$promise.then(()=>{if(Object(d.a)(this.selectedFilter.key,n.a.skippedRuns)||Object(d.a)(this.selectedFilter.key,n.a.failedTriggers)){if(this.flow&&this.flow.properties&&this.flow.properties.definition&&this.flow.properties.definition.triggers){var e=Object.keys(this.flow.properties.definition.triggers||{})[0],t=this.getFilterString();if(e)return this.flowRunList.flowTriggerHistoriesWithRun=this.flowTriggerHistoriesClient.query(this.$scope,null===t?{flowName:this.flowName,flowTriggerName:e}:{flowName:this.flowName,flowTriggerName:e,$filter:t}),this.flowRunList.flowTriggerHistoriesWithRun.$promise}}else if(this.flowName){var i=this.getFilterString();return this.flowRunList.flowRuns=this.flowRunsClient.query(this.$scope,null===i?{flowName:this.flowName}:{flowName:this.flowName,$filter:i}),this.flowRunList.flowRuns.$promise}throw new c.a(c.c.invalidFlowDefinition,this.clientResources.FlowRuns.Errors.InvalidFlowDefinition,null)}).then(()=>{this.refreshFlowRuns()}).then(()=>{this.hasMoreRuns=this.flowRunList.hasMore(),this.loggingService.profilePageEnd(B,p.a.flowRunsHistoryPageLoadEnd,{status:u.a.Success})}).then(()=>{this.appSettings.featureFlags.enableFlowRunIdentifier&&this.getSavedColumnHeadersAndInitializeTriggerOutputs()}).catch(e=>{this.loggingService.profilePageEnd(B,p.a.flowRunsHistoryPageLoadEnd,{status:Object(u.b)(e),error:Object(u.e)(e)}),this.loggingService.logError("FlowRunsCtrl.Constructor",e),this.onPageError(e)}).finally(()=>{this.flowRunList.spinner.show=!1,this.setupDownloadFlowRunsHistoryCsvLink()}),this.flow.$watch(this.$scope,()=>{this.title=Object(l.d)(this.clientResources.FlowRuns.Title,this.flow&&this.flow.properties&&this.flow.properties.displayName||"")}),i.$watch(()=>{var e;return null===(e=this.flowRunList.flowRuns)||void 0===e?void 0:e.length},(e,t)=>{Object(C.a)()&&this.flowRunList.flowRuns.filter(e=>!this.flowRunList.flowRunFilter(e)).forEach(e=>this.flowRunList.flowRuns.$remove(e))})}var t,i,r;return t=e,(i=[{key:"refreshFlowRuns",value:function(){Object(d.a)(this.selectedFilter.key,n.a.skippedRuns)||Object(d.a)(this.selectedFilter.key,n.a.failedTriggers)?this.flowRunList&&this.flowRunList.flowTriggerHistoriesWithRun&&this.flowRunList.flowTriggerHistoriesWithRun.$refresh():this.flowRunList&&this.flowRunList.flowRuns&&this.flowRunList.flowRuns.$refresh()}},{key:"initializeTriggerOutputs",value:function(){var e=this.flowRunList.flowRuns,t=null==e?void 0:e[0];if(t){var i,r=null===(i=t.properties.trigger)||void 0===i||null===(i=i.outputsLink)||void 0===i?void 0:i.uri;r&&this.flowRunService.getTriggerOutputs(r).then(e=>{var t;if(null!=e&&null!==(t=e.data)&&void 0!==t&&t.body){var i=Object.keys(e.data.body);if(Object(S.f)(this.flow)){var r=[S.b,S.a];this.flowRunList.latestRunTriggerOutputKeys=[...i,...r]}else this.flowRunList.latestRunTriggerOutputKeys=i;Object(S.D)(this.flow)&&(this.friendlyMappingForButtonTriggerParameters=this.flowRunService.getAndLoadButtonOutputsFriendlyNames(this.flow,this.clientResources.FlowRuns.DynamicColumns.UserName,this.clientResources.FlowRuns.DynamicColumns.UserEmail))}})}this._batchFetchAndLoadTriggerOutputs()}},{key:"sessionStore",get:function(){return k.a}},{key:"getUniversalSearchResults",value:function(e){return this.universalSearchService.searchSupport(e,void 0)}},{key:"getSearchText",value:function(e){return e&&e.remediationData&&e.remediationData.searchText?e.remediationData.searchText:""}},{key:"updateRemediationUIState",value:function(e){var t=this.remediationUIState,i=e&&e.value,r=t&&t.remediationData&&t.remediationData.documentationLink;i&&r&&(i[g.a.article]||(i[g.a.article]=[]),i[g.a.article].push(r)),t&&t.remediationData&&(t.remediationData.universalSearchResults=i),this.remediationUIState=t}},{key:"getFilterString",value:function(){if(this.selectedFilter){if(Object(d.a)(this.selectedFilter.key,n.a.allRuns))return null;if(Object(d.a)(this.selectedFilter.key,n.a.failedTriggers))return"Status eq 'failed'";var e=this.selectedFilter.key;if(this.allowableFilters&&this.allowableFilters.indexOf(e)>-1)return"Status eq '".concat(e,"'")}return null}},{key:"filterFlowRun",value:function(e){var t=e&&e.properties&&e.properties.status;return this.filterByStatus(t)}},{key:"filterFlowTriggerHistoryWithRun",value:function(e){var t=e&&e.properties&&e.properties.status,i=e&&e.properties&&e.properties.run&&e.properties.run.properties&&e.properties.run.properties.status;return this.filterByStatus(i||t)}},{key:"filterByStatus",value:function(e){switch(this.selectedFilter.key){case n.a.failedRuns:return Object(d.a)(e,n.j.failed);case n.a.successfulRuns:return Object(d.a)(e,n.j.succeeded);case n.a.runningRuns:return Object(d.a)(e,n.j.running);default:return!0}}},{key:"setupDownloadFlowRunsHistoryCsvLink",value:function(){this.flowRunsHistoryCsvDownloadLinkAsyncPollState=this.getDownloadLinkAsyncPollState(!1),this.initializeDownloadButton()}},{key:"initializeDownloadButton",value:function(){this.downloadButton={status:this.flowRunsHistoryCsvDownloadLinkAsyncPollState.status,text:this.clientResources.FlowRuns.GenerateCsv.Text,disabled:!this.canDownloadCsv(),href:"",onClick:()=>this.handleDownloadFlowRunsHistoryCsv()}}},{key:"getDownloadLinkAsyncPollState",value:function(e){return this.flowRunsHistoryCsvDownloadService.getDownloadLinkAsyncPollState({flowName:this.flowName,filter:this.selectedFilter&&this.selectedFilter.key,reset:e})}},{key:"canDownloadCsv",value:function(){if(!this.hasRuns())return!1;switch(this.selectedFilter.key){case n.a.successfulRuns:case n.a.failedRuns:case n.a.runningRuns:case n.a.cancelledRuns:case n.a.allRuns:return!0;default:return!1}}},{key:"handleDownloadFlowRunsHistoryCsv",value:function(){this.canDownloadCsv()&&this.flowRunsHistoryCsvDownloadLinkAsyncPollState.status!==o.a.Running&&(this.downloadButton.disabled=!0,this.downloadButton.status=o.a.Running,this.messageBarProps={ariaLabel:this.clientResources.FlowRuns.DownloadCsv.Text,type:h.c.progress,onRenderBody:()=>this.clientResources.FlowRuns.GeneratingCsv.Text},this.flowRunsHistoryCsvDownloadLinkAsyncPollState.wait().then(()=>{this.flowRunsHistoryCsvDownloadLinkAsyncPollState.status===o.a.RanToCompletion&&(this.messageBarProps=null,this.downloadButton.href=this.flowRunsHistoryCsvDownloadLinkAsyncPollState.result.downloadLink||this.flowRunsHistoryCsvDownloadLinkAsyncPollState.result.DownloadLink)}).catch(e=>{this.loggingService.logError("FlowRunsCtrl.handleDownloadFlowRunsHistoryCsv",e,{flowName:this.flowName,filter:this.selectedFilter.key}),this.onPageError(e),this.initializeDownloadButton(),this.flowRunsHistoryCsvDownloadLinkAsyncPollState=this.getDownloadLinkAsyncPollState(!0)}))}},{key:"hasRuns",value:function(){return this.flowRunList&&(this.flowRunList.flowRuns&&this.flowRunList.flowRuns.length>0||this.flowRunList.flowTriggerHistoriesWithRun&&this.flowRunList.flowTriggerHistoriesWithRun.length>0)}},{key:"getFlowThrottlingMessage",value:function(e){var t=x(x({},this.clientResources.Manage.Flow),{},{SlowPerformance:this.clientResources.SlowPerformance,HighUsage:this.clientResources.HighUsage}),i=Object(f.c)(e,t,this.clientResources.DateTime);i&&(this.throttlingMessage=i)}},{key:"wereColumnsChanged",value:function(e,t){return e.length!==t.length||e.filter(e=>-1===t.indexOf(e)).length>0}}])&&T(t.prototype,i),r&&T(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();O._isFilterSelectedFromFiltersMenu=void 0,O.$inject=[r.a.services.$routeParams,r.a.services.$scope,r.a.services.appSettings,r.a.services.clientResources,r.a.services.dateTime,r.a.services.environment,r.a.services.flowTriggerHistoriesClient,r.a.services.flowRun,r.a.services.flowRunsClient,r.a.services.flowRunsHistoryCsvDownloadService,r.a.services.flowsClient,r.a.services.logging,r.a.services.navigation,r.a.services.telemetry,r.a.services.routeCrafter,r.a.services.widgetUtilService,r.a.services.universalSearchService,r.a.services.assetService,r.a.services.cdnService,n.m,r.a.services.flowRunHistoryService,r.a.services.flow]},33390:function(e,t,i){"use strict";var r=i(13154);i.d(t,"a",(function(){return r.c})),i.d(t,"b",(function(){return r.i})),i.d(t,"c",(function(){return r.j})),i.d(t,"d",(function(){return r.k})),i.d(t,"e",(function(){return r.m})),i.d(t,"f",(function(){return r.n})),i.d(t,"g",(function(){return r.o})),i.d(t,"h",(function(){return r.p})),i.d(t,"i",(function(){return r.s})),i.d(t,"j",(function(){return r.u})),i.d(t,"k",(function(){return r.v})),i.d(t,"l",(function(){return r.w})),i.d(t,"m",(function(){return r.x})),i.d(t,"n",(function(){return r.y}))},33391:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(33331),n=i(33327),o=i(33355),a=i(11891),s=i(33301),l=i(33392);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d="location",p="retry-after",h=202,m=200,g=204,f=function(e){return e[e.CompleteSuccess=0]="CompleteSuccess",e[e.CompleteFailure=1]="CompleteFailure",e[e.NotComplete=2]="NotComplete",e}({}),v=function(e){return e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.RanToCompletion=2]="RanToCompletion",e[e.Cancelled=3]="Cancelled",e[e.Faulted=4]="Faulted",e}({}),b=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.$timeout=r,this.loggingService=n,this.cachedAsyncPollers={}}var t,i,r;return t=e,(i=[{key:"getOrCreateCachedAsyncPoller",value:function(e){var t=Object(s.a)(e.cacheParams),i=new Date,r=this.cachedAsyncPollers[t];if(r&&r.expiration<i.getTime()&&(delete this.cachedAsyncPollers[t],r=null),!r){var n,a,c=v.NotStarted,u=null;this.cachedAsyncPollers[t]=r={expiration:i.getTime()+e.evictionDelay,data:{get status(){return c},get result(){if(c===v.RanToCompletion)return a;throw new Error("Async poll did not complete successfully")},get error(){return c===v.Faulted?u:null},wait:()=>{if(!n){var t=this.loggingService.profilePageStart(o.a.asyncPollStart);n=this.waitOnPolling(e.action()).then(e=>e.status===f.CompleteSuccess?e.response:e.status===f.CompleteFailure?this.$q.reject(e.response):this.$q.reject("Polling failed. Invalid state")).then(i=>(c=v.RanToCompletion,a=i.data,this.loggingService.profileEndWithSuccess(t,o.a.asyncPollEnd,{data:e.eventData}),a)).catch(i=>{throw c=v.Faulted,u=i,this.loggingService.profileEnd(t,o.a.asyncPollEnd,Object(l.b)(u),u,{data:e.eventData}),i}),c=v.Running}return n}}}}return r.data}},{key:"waitOnPolling",value:function(e,t){var i=this.$q.defer();return e.then(e=>{var r=e&&e.headers&&e.headers();if(r&&r[d]){var n=e.headers()[p]?e.headers()[p]:"5";return this.backendPollingTracker(e.headers()[d],n,t).then(e=>{i.resolve(e)}).catch(e=>{i.reject(e)})}return i.resolve(e)}).catch(e=>i.reject(e)),i.promise}},{key:"backendPollingTracker",value:function(e,t,i){var r=e,n=(t&&parseInt(t,10))>=0?1e3*parseInt(t,10):5e3;return this.setPolling(()=>this.backendPoller(r,i),e=>e.HttpStatusCode===m||e.HttpStatusCode===g?Object(a.a)(this.extractStatus(e),"Failed")?{status:f.CompleteFailure,response:e.Response}:{status:f.CompleteSuccess,response:e.Response}:(r=e.Location,{status:f.NotComplete,response:e.Response}),n)}},{key:"extractStatus",value:function(e){if(e.Response&&e.Response.data){var{data:t}=e.Response;return t.properties?t.properties.status:t.status}return""}},{key:"setPolling",value:function(e,t,i){var r=this.$q.defer(),n=()=>{e().then(e=>{var o=t(e);o.status===f.CompleteSuccess&&r.resolve(o),o.status===f.CompleteFailure?r.reject(o):o.status===f.NotComplete&&this.$timeout(n,i)}).catch(e=>{r.reject(e)})};return this.$timeout(n,i),r.promise}},{key:"backendPoller",value:function(e,t){var i={method:"GET",url:e};return this.getRequest(i)}},{key:"getRequest",value:function(e){return this.$http(e).then(e=>e.status===h?{HttpStatusCode:e.status,Location:e.headers()[d],RetryAfter:e.headers()[p],Response:e,StatusText:e.statusText}:{HttpStatusCode:e.status,Location:"",RetryAfter:"",Response:e,StatusText:e.statusText})}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();b.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.$timeout,n.a.services.logging],r.a.service(n.a.services.backend,b)},33392:function(e,t,i){"use strict";var r=i(33393);i.d(t,"a",(function(){return r.a})),i.d(t,"d",(function(){return r.j})),i.d(t,"b",(function(){return r.b})),i.d(t,"f",(function(){return r.l}));var n=i(13015);i.d(t,"e",(function(){return n.o})),i.d(t,"c",(function(){return n.n}))},33393:function(e,t,i){"use strict";i.d(t,"f",(function(){return s}));var r=i(33394),n=i(13009);i.d(t,"a",(function(){return n.e})),i.d(t,"b",(function(){return n.y})),i.d(t,"c",(function(){return n.B})),i.d(t,"d",(function(){return n.K})),i.d(t,"e",(function(){return n.U})),i.d(t,"h",(function(){return n.Z})),i.d(t,"j",(function(){return n.cb})),i.d(t,"l",(function(){return n.gb})),i.d(t,"i",(function(){return n.ab}));i(15424),i(15423);var o=i(15422);i.d(t,"g",(function(){return o.p}));i(20431);var a=i(19855);function s(e){return Object(n.g)(e,r.c.RemediationNotFound)}i.d(t,"k",(function(){return a.b}))},33394:function(e,t,i){"use strict";i.d(t,"c",(function(){return n}));var r=i(13009);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b}));var n=i(33395).a},33395:function(e,t,i){"use strict";t.a={AuthenticationError:"AuthenticationError",ClientErrorAborted:"ClientErrorAborted",ajaxRequestFailed:"ajaxRequestFailed",apiOperationNotFound:"apiOperationNotFound",AuthenticationFailed:"AuthenticationFailed",base64ToBinaryBlobInvalidError:"Base64ToBinaryBlobInvalidError",blobUploadCancelled:"blobUploadCancelled",blobUploadExceededMaximumRetry:"blobUploadExceededMaximumRetry",blobUploadFailure:"blobUploadFailure",cds2InstanceNotProvisioned:"cds2InstanceNotProvisioned",cdsBusinessUnitDisabled:"0x8004032c",cdsOrgIsDisabled:"0x8004a104",cdsUserIsDisabled:"0x80040225",userNotMemberOfCdsSecurityGroup:"UserNotMemberOfCdsSecurityGroup",cdsUserIsNotAssignedAnyRoles:"0x80042f09",cdsUserIsNotLicensed:"0x8004d24b",cdsUserIsNotMember:"0x80072560",cdsOperationTimeOutError:"0x80048543",connectionAuthenticationFailed:"connectionAuthenticationFailed",connectionAuthenticationPopupBlocked:"connectionAuthenticationPopupBlocked",connectionAuthenticationPopupClosed:"connectionAuthenticationPopupClosed",connectionAuthenticationPopupTimeout:"connectionAuthenticationPopupTimeout",createAuthenticationFormError:"createAuthenticationFormError",customApiAttemptingToSaveInvalidSwagger:"customApiAttemptingToSaveInvalidSwagger",customApiError:"customApiError",customApiExist:"customApiExist",customApiGetSwaggerFromUrl:"customApiGetSwaggerFromUrl",customApiGetSwaggerIcon:"customApiGetSwaggerIcon",customApiGetWsdlFromUrl:"customApiGetWsdlFromUrl",customApiImportFromSampleError:"customApiImportFromSampleError",customApiInvalidBasePath:"customApiInvalidBasePath",customApiInvalidHost:"customApiInvalidHost",customApiInvalidIconBrandColor:"customApiInvalidIconBrandColor",customApiNameError:"customApiNameError",customApiNoMatchingIdentityProvider:"customApiNoMatchingIdentityProvider",customApiOpenApiImportFromPayloadMissingParameter:"customApiOpenApiImportFromPayloadMissingParameter",customApiOpenApiImportFromPayloadInvalidResponse:"customApiOpenApiImportFromPayloadInvalidResponse",customApiOpenApiImportFromPayloadServerError:"customApiOpenApiImportFromPayloadServerError",customApiOriginalDataError:"customApiOriginalDataError",customApiOriginalCustomCodeError:"customApiCustomCodeError",customApiPolicyError:"customApiPolicyError",customApiRefreshApisClient:"customApiRefreshApisClient",customApiValidationError:"customApiValidationError",failureParsingImplicitData:"failureParsingImplicitData",failureRetrievingRuntimeToken:"failureRetrievingRuntimeToken",flowCreationNoFlowName:"flowCreationNoFlowName",flowDebugViewTimeoutWaitingForRun:"flowDebugViewTimeoutWaitingForRun",flowDraftNotFound:"flowDraftNotFound",flowProxyGetFailed:"flowProxyGetFailed",flowNotFound:"flowNotFound",flowNotRunnable:"flowNotRunnable",flowOwnerPermissionRequired:"flowOwnerPermissionRequired",flowPollingTimeoutWaitingForRun:"flowPollingTimeoutWaitingForRun",flowRunNotFound:"flowRunNotFound",flowRunRequestFailed:"flowRunRequestFailed",flowSaveAsFailed:"flowSaveAsFailed",flowsDesignerGetDefinitionError:"flowsDesignerGetDefinitionError",flowsDesignerLoadDefinitionError:"flowsDesignerLoadDefinitionError",flowsDesignerScriptLoadError:"flowsDesignerScriptLoadError",flowsDesignerOpenConnectorRecommendationError:"flowsDesignerOpenConnectorRecommendationError",flowStopped:"flowStopped",flowSuspended:"flowSuspended",flowTriggerUriMissing:"flowTriggerUriMissing",getApiOperationsError:"getApiOperationsError",getTemplateError:"getTemplateError",invalidFlowDefinition:"invalidFlowDefinition",invalidNumberInput:"invalidNumberInput",invalidParameterValue:"invalidParameterValue",markdownServiceLoadFailed:"markdownServiceLoadFailed",mfaTestConnectionError:"mfaTestConnectionError",miniWidgetNotReady:"miniWidgetNotReady",missingPrvReadCdsWorkflow:"0x80040220",oAuthPopupError:"oAuthPopupError",oneClickFlowCreationNoFlowName:"oneClickFlowCreationNoFlowName",peoplePickerItemMissingEmail:"peoplePickerItemMissingEmail",resubmitRunAsTestFailed:"resubmitRunAsTestFailed",schemaGenerationError:"schemaGenerationError",sessionInfoNotAvailable:"sessionInfoNotAvailable",storageCreationFailure:"storageCreationFailure",swaggerToWadlError:"swaggerToWadlError",swaggerUploadFailure:"swaggerUploadFailure",templateNotFoundError:"templateNotFoundError",testConnectionError:"testConnectionError",uiFlowNotStarted:"uiFlowNotStarted",uiFlowRunning:"uiFlowRunning",uiFlowDeprecated:"uiFlowDeprecated",unsupportedCds1:"unsupportedCds1",widgetFeatureNotImplemented:"widgetFeatureNotImplemented",widgetOAuthLoginPromiseFetchedBeforeUrlSet:"widgetOAuthLoginPromiseFetchedBeforeUrlSet",widgetOAuthPopupClosureByScriptUnsupported:"widgetOAuthPopupClosureByScriptUnsupported",widgetReceivedNullToken:"widgetReceivedNullToken",widgetUnableToGetEnvironment:"widgetUnableToGetEnvironment",xrmInstanceApiUrlMissing:"xrmInstanceApiUrlMissing",xrmRequestBadResponse:"xrmRequestBadResponse",xrmApiRequestFailed:"XrmApiRequestFailed",rpaXrmOutdated:"RpaXrmOutdated",MissingRPALicense:"ConsumptionViolation",nullResponse:"nullResponse",operationCanceled:"operationCanceled",invalidOperation:"invalidOperation",networkError:"networkError",clientRequestAborted:"clientRequestAborted",failedToFetch:"failedToFetch",runInstanceServiceInvalidId:"runInstanceServiceInvalidId",runInstanceServiceInvalidStatusCode:"runInstanceServiceInvalidStatusCode",runInstanceServiceInvalidTriggerHistoryResponse:"runInstanceServiceInvalidTriggerHistoryResponse",runInstanceServiceRunNotFound:"runInstanceServiceRunNotFound",graphServiceInvalidMemberId:"graphServiceInvalidMemberId",graphServiceInvalidTenantId:"graphServiceInvalidTenantId",graphServiceQueryBadResponse:"graphServiceQueryBadResponse",graphServiceUnauthenticatedRequest:"graphServiceUnauthenticatedRequest",InvokeFlowServiceEntityDataWrongFormat:"InvokeFlowServiceEntityDataWrongFormat",invokeFlowUserNotConsented:"invokeFlowUserNotConsented",flowCreatorMissingTemplateDefinition:"flowCreatorMissingTemplateDefinition",flowCreatorMissingTemplateName:"flowCreatorMissingTemplateName",flowCreatorUserNotConsented:"flowCreatorUserNotConsented",runFlowWidgetNeverLoadedWithEnvironment:"runFlowWidgetNeverLoadedWithEnvironment",runFlowWidgetNullOrEmptyActionName:"runFlowWidgetNullOrEmptyActionName",runFlowWidgetFailedToLoad:"runFlowWidgetFailedToLoad",runFlowWidgetFlowNotFound:"runFlowWidgetFlowNotFound",runFlowWidgetError:"runFlowWidgetError",runFlowWidgetCancelled:"runFlowWidgetCancelled",runFlowWidgetInvalidTriggerFlowParams:"runFlowWidgetInvalidTriggerFlowParams",runFlowWidgetInvalidImplicitDataType:"runFlowWidgetInvalidImplicitDataType",runFlowWidgetInvalidTriggerSchemaParams:"runFlowWidgetInvalidTriggerSchemaParams",runFlowWidgetInvalidTriggerSchema:"runFlowWidgetInvalidTriggerSchema",runFlowWidgetNotReady:"runFlowWidgetNotReady",runFlowWidgetTemplateDefinitionEmpty:"runFlowWidgetTemplateDefinitionEmpty",runFlowWidgetTemplateNotFound:"runFlowWidgetTemplateNotFound",flowWidgetClosed:"flowWidgetClosed",widgetUsageBlocked:"widgetUsageBlocked",hostCommunicationServiceUnregisteredActionName:"hostCommunicationServiceUnregisteredActionName",hostCommunicationServiceEmptyActionName:"hostCommunicationServiceEmptyActionName",geocodeServiceGeolocationUnsupported:"geocodeServiceGeolocationUnsupported",geocodeServiceGeolocationDisabled:"geocodeServiceGeolocationDisabled",geocodeServiceInvalidResult:"geocodeServiceInvalidResult",installFlowFailed:"installFlowFailed",createFlowFromTemplateRouteFailed:"createFlowFromTemplateRouteFailed",flowAnalyticsGetDashboardsBadResponse:"flowAnalyticsGetDashboardsBadResponse",flowAnalyticsGetEmbeddedReportLinkBadResponse:"flowAnalyticsGetEmbeddedReportLinkBadResponse",flowCreationWidgetInvalidCreateFromTemplateArgs:"flowCreationWidgetInvalidCreateFromTemplateArgs",flowCreationWidgetInvalidCreateFromTemplateDefinitionArgs:"flowCreationWidgetInvalidCreateFromTemplateDefinitionArgs",flowCreationWidgetNotReadyError:"flowCreationWidgetNotReadyError",templateWidgetLoadTemplateError:"templateWidgetLoadTemplateError",templateWidgetFlowCreationError:"templateWidgetFlowCreationError",winAutomationServiceLaunchAppError:"winAutomationServiceLaunchAppError",uiFlowServiceNotRunning:"uiFlowServiceNotRunning",ApprovalRequestReassignmentAccessDenied:"ApprovalRequestReassignmentAccessDenied",ApprovalRequestReassignmentDisallowed:"ApprovalRequestReassignmentDisallowed",ApprovalRequestReassignmentOwnerDisallowed:"ApprovalRequestReassignmentOwnerDisallowed",ApprovalRequestReassignmentUserCurrentlyAssigned:"ApprovalRequestReassignmentUserCurrentlyAssigned",ApprovalRequestReassignmentTargetUserNotFound:"ApprovalRequestReassignmentTargetUserNotFound",ApprovalRequestReassignmentUserAlreadyResponded:"ApprovalRequestReassignmentUserAlreadyResponded",ApprovalResponseNotAllowed:"ApprovalResponseNotAllowed",ApprovalResponseNotAllowedApprovalCompletedByUserAndOthers:"ApprovalResponseNotAllowedApprovalCompletedByUserAndOthers",ApprovalResponseNotAllowedApprovalCompletedByUser:"ApprovalResponseNotAllowedApprovalCompletedByUser",ApprovalResponseNotAllowedApprovalCanceled:"ApprovalResponseNotAllowedApprovalCanceled",ApprovalResponseNotAllowedApprovalCompletedByOthers:"ApprovalResponseNotAllowedApprovalCompletedByOthers",ApprovalResponseNotAllowedUserAlreadyResponded:"ApprovalResponseNotAllowedUserAlreadyResponded",ApprovalResponseNotAllowedNoRequestsForUser:"ApprovalResponseNotAllowedNoRequestsForUser",ApprovalResponseNotAllowedOthersAlreadyResponded:"ApprovalResponseNotAllowedOthersAlreadyResponded",ApprovalResponseNotAllowedRequestReassigned:"ApprovalResponseNotAllowedRequestReassigned",ApprovalCancelAccessDenied:"ApprovalCancelAccessDenied",ApprovalCancelAlreadyCanceled:"ApprovalCancelAlreadyCanceled",ApprovalCancelAlreadyComplete:"ApprovalCancelAlreadyComplete",ApprovalCommonDataServiceMigrationOngoing:"ApprovalCommonDataServiceMigrationOngoing",ApiAuthorizationFailed:"ApiAuthorizationFailed",ApiPolicyApiGroupCode:"ApiPolicyApiGroupViolation",ApiPolicyDataFlowCode:"ApiPolicyDataFlowViolation",ApiPolicyEndpointFilteringCode:"ApiPolicyEndpointViolation",ApiPolicyActionControlCode:"ApiPolicyConnectorActionViolation",ApiResourceNotFound:"ApiResourceNotFound",ApplicationDisabledInTenant:"ApplicationDisabledInTenant",AzureResourceManagerRequestFailed:"AzureResourceManagerRequestFailed",ConnectionAuthorizationFailed:"ConnectionAuthorizationFailed",CustomApiQuotaReached:"CustomApiQuotaReached",EnvironmentAccessDenied:"EnvironmentAccessDenied",FlowSoftDeleted:"FlowSoftDeleted",FullNonLocalizedError:"FullNonLocalizedError",GoogleDlpViolationCode:"GoogleDlpViolation",InvalidPowerFlowDisplayName:"InvalidPowerFlowDisplayName",InvalidPowerFlowName:"InvalidPowerFlowName",InvalidFlow:"InvalidFlow",InvalidSourceTemplateName:"InvalidSourceTemplateName",InvalidSwagger:"InvalidSwagger",MultipleErrorsCode:"MultipleErrorsOccurred",MissingAdequateQuotaPolicy:"MissingAdequateQuotaPolicy",NotFound:"NotFound",FlowNotFound:"FlowNotFound",OutOfBoxTemplateInstanceNotUniqueCode:"OutOfBoxTemplateInstanceNotUnique",PermissionDowngradeNotAllowed:"PermissionDowngradeNotAllowed",RemediationNotFound:"RemediationNotFound",ServicePrincipalNotProvisionedInTenant:"ServicePrincipalNotProvisionedInTenant",SwaggerParsingError:"SwaggerParsingError",TemplateNotFound:"TemplateNotFound",TemplateValidationError:"TemplateValidationError",InvalidSwaggerBasedOnExtendedValidation:"InvalidSwaggerBasedOnExtendedValidation",UserFlowLimitReached:"UserFlowLimitReached",UserExceededFlowRunAllotment:"UserExceededFlowRunAllotment",RecurrenceFrequencyLimitExceeded:"RecurrenceFrequencyLimitExceeded",BackendFlowHasChangedError:"BackendFlowHasChangedError",MsFlowSdk:"MsFlowSdk",UnlistenedEventCalled:"UnlistenedEventCalled",apiOperationInvalidStatusCode:"apiOperationInvalidStatusCode",mashupEditorOnReadyError:"mashupEditorOnReadyError",unknownAsyncCachedPollStatus:"unknownAsyncCachedPollStatus",announcementStorageReadError:"announcementStorageReadError",scriptDownloadError:"scriptDownloadError",failedToGetTokenMultifactorAuthentication:"FailedToGetTokenMultifactorAuthentication",failedToGetTokenBundleDueToConditionalAccess:"FailedToGetTokenBundleDueToConditionalAccess",missingAuthorizationHeaderAndClientCertificate:"MissingAuthorizationHeaderAndClientCertificate",intlPolyfillError:"intlPolyfillError",bingMapsSdkDownloadError:"bingMapsSdkDownloadError",bingMapsSdkModuleLoadError:"bingMapsSdkModuleLoadError",localeNotRecognized:"localeNotRecognized",UnexpectedUnauthenticatedConsent:"unexpectedUnauthenticatedConsent",MissingUserDetails:"MissingUserDetails",asyncGetStorageError:"asyncGetStorageError",asyncSetStorageError:"asyncSetStorageError",asyncRemoveStorageError:"asyncRemoveStorageError",DesignerInvalidParameters:"InvalidParameters",DesignerDefinitionInvalidForSKU:"DefinitionInvalidForSKU",DesignerUnsupportedValueSegmentType:"UnsupportedValueSegmentType",SplitOnOutputsRequestedBeforeOperationManifest:"SplitOnOutputsRequestedBeforeOperationManifest",InvalidSplitOn:"InvalidSplitOn",NotManifestBasedOperation:"NotManifestBasedOperation",sendACopyFailedToGetFlowDefinition:"sendACopyFailedToGetFlowDefinition",sendACopyFailedToGetFlowRuns:"sendACopyFailedToGetFlowRuns",FlowCheckerError:"FlowCheckerError",findFlowCheckerErrorsErrorResponse:"findFlowCheckerErrorsErrorResponse",findFlowCheckerWarningsErrorResponse:"findFlowCheckerWarningsErrorResponse",graph:{Request_UnsupportedQuery:"Request_UnsupportedQuery"},pasteTriggerNotSupported:"pasteTriggerNotSupported",snippetsUnknownMessageType:"snippetsUnknownMessageType",CannotUpdateNonCustomizableFlowProcess:"CannotUpdateNonCustomizableFlowProcess",DeleteManagedSolutionFlowXrmError:"0x8004023b",DeleteSolutionFlowDoesNotExistError:"0x80040217",DeleteFlowWithDeclaredDependenciesXrmError:"0x8004f01f",InsufficientPrivelegesXrmError:"0x80048306",FlowMissingConnections:"FlowMissingConnection",InsufficientCdsPermissions:"InsufficientCdsPermissions",ConnectionReferenceEntityNotFound:"ConnectionReferenceEntityNotFound",InvalidQuerySyntax:"0x8006088a",PrivilegeAssignedNoRoles:"0x80042f09",PrivilegeFailedForPrvReadEntity:"0x80040220",UnmanagedIdsAccessDenied:"0x80048306",CannotSaveManagedSolutionError:"0x8004f024",NoPrivilegeAccess:"0x8004a113",NoAccessToCdsOrg:"NoAccessToCdsOrg",MissingAccessRight:"0x80048306",SDKMessageNotPermitted:"0x80061113",DoesNotExist:"0x80040217",ObjectAssociatedWithAnotherObject:"0x80040227",GenericSQLError:"0x80044150",ConcurrentDeleteRequestDetected:"0x80048105",ADAuthenticationException:"ADAuthenticationException",InsufficientFlowPermissions:"InsufficientFlowPermissions",OfficeHeaderInitializeO365Header:"OfficeHeaderInitializeO365Header",ConnectionWizardFirstPartyConnectionFailure:"ConnectionWizardFirstPartyConnectionFailure",DesignerConnectionWizardRegression:"DesignerConnectionWizardRegression",DietDesignerRegression:"DietDesignerRegression",WorkflowRunCanNotBeCancelled:"WorkflowRunCanNotBeCancelled",InvalidTemplate:"InvalidTemplate",InvalidWorkflowTriggerRecurrence:"InvalidWorkflowTriggerRecurrence",InvalidVariableOperation:"InvalidVariableOperation",InvalidVariableInitialization:"InvalidVariableInitialization",InvalidWorkflowTriggerName:"InvalidWorkflowTriggerName",InvalidWorkflowRunActionName:"InvalidWorkflowRunActionName",WorkflowRunActionInputsInvalidProperty:"WorkflowRunActionInputsInvalidProperty",InvalidWorkflowRunAction:"InvalidWorkflowRunAction",InvalidPaginationPolicy:"InvalidPaginationPolicy",WorkflowUnsupportedSplitOnTriggerForResponseAction:"WorkflowUnsupportedSplitOnTriggerForResponseAction",WorkflowRunActionTimeoutLimitInvalid:"WorkflowRunActionTimeoutLimitInvalid",CannotDisableTriggerConcurrency:"CannotDisableTriggerConcurrency",InvalidRetryPolicy:"InvalidRetryPolicy",WorkflowUnsupportedRecurrenceTriggerForResponseAction:"WorkflowUnsupportedRecurrenceTriggerForResponseAction",OpenApiOperationParameterValidationFailed:"OpenApiOperationParameterValidationFailed",WorkflowOperationParametersExtraParameter:"WorkflowOperationParametersExtraParameter",DynamicOperationRequestClientFailure:"DynamicOperationRequestClientFailure",DynamicParameterInputInvalid:"DynamicParameterInputInvalid",InvalidOpenApiFlow:"InvalidOpenApiFlow",MicrosoftDataverseNotFound:"MicrosoftDataverseNotFound",RpaXrmOutdated:"RpaXrmOutdated",rpaFlowFetchingError:"rpaFlowFetchingError",rpaFlowRunEntityMissing:"rpaFlowRunEntityMissing",rpaFlowSaveFailed:"rpaFlowSaveFailed",rpaDuplicateScreenshotId:"rpaDuplicateScreenshotId",rpaUnknownScreenshotId:"rpaUnknownScreenshotId",rpaScreenshotValueMissing:"rpaScreenshotValueMissing",rpaScreenshotUploadError:"rpaScreenshotUploadError",rpaScreenshotFetchingError:"rpaScreenshotFetchingError",rpaLocalServiceMessagingError:"rpaLocalServiceMessagingError",rpaScriptRunFailedWithNoActionName:"rpaScriptRunFailedWithNoActionName",rpaScriptRunNotFound:"rpaScriptRunNotFound",RpaScriptRunUnknownStatus:"RpaScriptRunUnknownStatus",RpaScriptRunTestFailed:"RpaScriptRunTestFailed",rpaScriptNotFoundError:"0x80040217",RpaFlowTypeUnknown:"RpaFlowTypeUnknown",rpaAgentBusyError:"AgentBusy",rpaRecorderBusyError:"RecorderBusy",rpaRecordingFailed:"rpaRecordingFailed",rpaFlowDesignerLoadError:"rpaFlowDesignerLoadError",rpaFlowDesignerParallelBranchesValidationError:"rpaFlowDesignerParallelBranchesValidationError",rpaFlowDesignerAppIDsValidationWarning:"rpaFlowDesignerAppIDsValidationWarning",rpaFlowDesignerGetRecordingError:"rpaFlowDesignerGetRecordingError",rpaSeleniumExtensionErrorOnGetStatus:"rpaSeleniumExtensionErrorOnGetStatus",rpaSeleniumRecording:"rpaSeleniumRecording",rpaSeleniumRecordingValidationError:"rpaSeleniumRecordingValidationError",rpaSeleniumUnexpectedRequestReceivedByBrowserExtension:"UnexpectedRequestReceivedByBrowserExtension",rpaUnexpectedBrowserExtensionError:"rpaUnexpectedBrowserExtensionError",rpaSeleniumRecordingSessionLostErrorFromExtension:"RecordingSessionLost",rpaSeleniumRecordingSessionLost:"rpaSeleniumRecordingSessionLost",rpaCreationModalUnexpectedPage:"rpaCreationModalUnexpectedPage",rpaMigrationModalUnexpectedPage:"rpaMigrationModalUnexpectedPage",rpaEditModalUnexpectedPage:"rpaEditModalUnexpectedPage",rpaSaveSolutionFlow:"rpaSaveSolutionFlow",hostServiceRetryScriptLoadFailed:"hostServiceRetryScriptLoadFailed",hostServiceCannotGenerateConnectionDisplayName:"hostServiceCannotGenerateConnectionDisplayName",retrieveUIFlowIdFromInputsFailed:"retrieveUIFlowIdFromInputsFailed",retrieveUIFlowRunIdFromOutputsFailed:"retrieveUIFlowRunIdFromOutputsFailed",botActivityTemplateRendererError:"botActivityTemplateRendererError",importTemplateLoadError:"importTemplateLoadError",connectionParameterEditorServiceUnexpectedRenderCall:"connectionParameterEditorServiceUnexpectedRenderCall",commentsEmitterUndefined:"commentsEmitterUndefined",undoSnapshotNullOrUndefined:"undoSnapshotNullOrUndefined",overCapacityStorageDriven:"OverCapacity_StorageDriven",IsvAborted:"0x80040265",AttributeMaxLengthExceeded:"0x80044331",MissingAADTenantPreferredLanguage:"MissingAADTenantPreferredLanguage",DisallowedPreviewProvision:"DisallowedPreviewProvision",OperationNotStartable:"OperationNotStartable",loadUserEntitlementsMissingObjectId:"loadUserEntitlementsMissingObjectId",ViralServicePlanRequired:"ViralServicePlanRequired",UnknownAngularClientResponseError:"UnknownAngularClientResponseError"}},33396:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"f",(function(){return h})),i.d(t,"e",(function(){return g})),i.d(t,"d",(function(){return f})),i.d(t,"b",(function(){return v})),i.d(t,"g",(function(){return b})),i.d(t,"c",(function(){return y}));var r=i(33328),n=i(33327),o=i(31433),a=i(33397),s=i(13144),l=i(18956),c=i(17220),u={urlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/flows"),resourceType:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/flows")};function d(e){return[...null!=e&&e.excludeSwagger?[]:["swagger"],"properties.connectionreferences.apidefinition","properties.definitionsummary.operations.apioperation","operationDefinition","plan","properties.throttleData","properties.estimatedsuspensiondata"].join(",")}var p={listFlows:42e4,getFlow:48e4,evictionDelay:3e5};function h(e){return"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(e.getCurrentEnvironmentName(),"/flows")}function m(e){return"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(e.getCurrentEnvironmentName(),"/solutions")}function g(){var e=location.pathname.split("/"),t=e.indexOf("solutions");return t>=0?e[t+1]:Object(l.a)()}function f(e){return"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(e.getCurrentEnvironmentName(),"/flows")}function v(e,t){return"".concat(h(t),"/").concat(e)}function b(e){return!!(e&&201===e.status&&e.data&&e.data.name)}function y(e){var t=[];return e.encodedFlowsFilter&&t.push("".concat(atob(e.encodedFlowsFilter))),e.isPersonal&&!Object(a.a)(t)&&t.push("search('personal')"),e.isShared&&!Object(a.a)(t)&&t.push("search('team')"),{$filter:t.join(" and "),$top:"50"}}r.a.factory(n.a.services.flowsClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment,(e,t,i)=>{var r=t=>{var r=e.processSimpleResourceProviderApiVersionWithEnvironments,n=h(i);return t.url=t.url.replace(/api-version=[^&]*/gi,"api-version="+r),t.url=t.url.replace(new RegExp(u.urlPath,"i"),n),t},n=i.getCurrentEnvironmentName()?h(i):u.urlPath,o={urlPath:"".concat(m(i),"/:solutionId/flows"),name:"createSolutionFlow",method:"POST",params:{solutionId:"@solutionId"}},a={urlPath:":id",name:"patchSolutionFlow",method:"PATCH",params:{id:"@id",$expand:d({excludeSwagger:Object(c.a)()})}},l={headers:{"x-ms-flow-comment-setup":"true"},method:"PATCH",name:"patchCommentingSetup",params:{id:"@id",$expand:d({excludeSwagger:Object(c.a)()})},urlPath:":id"};return t({urlBase:Object(s.c)(e).flowRP,urlPath:n,apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:u.resourceType,rest:{query:{requestInterceptor:r,lazyPaging:!0},get:{requestInterceptor:r,params:{id:"@id",$expand:d({excludeSwagger:Object(c.a)()})}},post:{requestInterceptor:r,params:{id:"@id"}},patch:{requestInterceptor:r,params:{id:"@id",$expand:d({excludeSwagger:Object(c.a)()})}},delete:{requestInterceptor:r,params:{id:"@id",$expand:d({excludeSwagger:Object(c.a)()})}}},actions:["start","stop","exportToARMTemplate",o,l,a],options:{atomize:!1,evictionDelay:p.evictionDelay}})}])},33397:function(e,t,i){"use strict";function r(e){return Array.isArray(e)?e.some(e=>r(e)):function(e){return-1!==e.toLowerCase().indexOf("operations/any")}(e)||function(e){return new RegExp("search\\('[^\\)]+'\\)").test(e.toLowerCase())}(e)||function(e){return-1!==e.toLowerCase().indexOf("properties/userType")}(e)||function(e){return-1!==e.toLowerCase().indexOf("properties/owners/any")}(e)||function(e){return-1!==e.toLowerCase().indexOf("properties/users/any")}(e)}i.d(t,"a",(function(){return r}))},33398:function(e,t,i){"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",(function(){return a}));var a=n(n({},i(13240).c),{},{CancelFlowRunClicked:"CancelFlowRunClicked",ConfirmCancelRunYesClicked:"ConfirmCancelRunYesClicked",ConfirmCancelRunNoClicked:"ConfirmCancelRunNoClicked",ConfirmResubmitRunYesClicked:"ConfirmResubmitRunYesClicked",ConfirmResubmitRunNoClicked:"ConfirmResubmitRunNoClicked",ListFlowRunsFilterSelected:"ListFlowRunsFilterSelected",ResubmitFlowRunClicked:"ResubmitFlowRunClicked",DebugViewSummaryPaneClientSupportLinkClicked:"DebugViewSummaryPaneClientSupportLinkClicked",DebugViewSummaryPaneCommunityLinkClicked:"DebugViewSummaryPaneCommunityLinkClicked",DebugViewSummaryPaneServerSupportLinkClicked:"DebugViewSummaryPaneServerSupportLinkClicked",FlowDetailsBreadcrumbClicked:"FlowDetailsBreadcrumbClicked",TemplateTileInitFailed:"TemplateTileInitFailed",TemplateTileTemplateShown:"TemplateTileTemplateShown",TemplateTileAddButtonClicked:"TemplateTileAddButtonClicked",TemplateTileSimulateButtonClicked:"TemplateTileSimulateButtonClicked",PowerAppsWidgetCommunicationTimedOut:"PowerAppsWidgetCommunicationTimedOut",CtrlAltAPressed:"CtrlAltAPressed",FlowCheckerOnDesignerChangeSkipped:"FlowCheckerOnDesignerChangeSkipped",FlowCheckerOnDesignerChangeProceed:"FlowCheckerOnDesignerChangeProceed",FlowCheckerOnDesignerChangeReset:"FlowCheckerOnDesignerChangeReset",PageLoad:"PageLoad",DeleteConnectionFromDetails:"DeleteConnectionFromDetails",AddConnectionButtonClicked:"AddConnectionButtonClicked",CreateConfigurableConnection:"CreateConfigurableConnection",ShowConnectionInfo:"ShowConnectionInfo",UpdateConnectionPasswordClicked:"UpdateConnectionPasswordClicked",CreateFlowCompleted:"CreateFlowCompleted",UserFeedbackReceived:"UserFeedbackReceived",FeedbackFormClosed:"FeedbackFormClosed",RunOnlyTileSeeAllClicked:"RunOnlyTileSeeAllClicked",RunOnlyTileAddPersonClicked:"RunOnlyTileAddPersonClicked",RunOnlyPaneSaveClicked:"RunOnlyPaneSaveClicked",RunOnlyPaneCancelClicked:"RunOnlyPaneCancelClicked",RunOnlyPaneCloseClicked:"RunOnlyPaneCloseClicked",RunOnlyPaneDeleteAddedUserClicked:"RunOnlyPaneDeleteAddedUserClicked",RunOnlyPaneAddAddedUserClicked:"RunOnlyPaneAddAddedUserClicked",RunOnlyPaneDeletePendingToAddUserClicked:"RunOnlyPaneDeletePendingToAddUserClicked",RunOnlyPaneSharepointSiteSelected:"RunOnlyPaneSharepointSiteSelected",RunOnlyPaneSharepointListSelected:"RunOnlyPaneSharepointListSelected",RunOnlyPaneAddSharepointPermissionClicked:"RunOnlyPaneAddSharepointPermissionClicked",RunOnlyPaneDeleteAddedSharepointPermissionClicked:"RunOnlyPaneDeleteAddedSharepointPermissionClicked",RunOnlyPaneAddAddedSharepointPermissionClicked:"RunOnlyPaneAddAddedSharepointPermissionClicked",RunOnlyPaneDeletePendingToAddSharepointPermissionClicked:"RunOnlyPaneDeletePendingToAddSharepointPermissionClicked",RunOnlyPaneDefaultToEmbeddedConnectionsToggleClicked:"RunOnlyPaneDefaultToEmbeddedConnectionsToggleClicked",RunOnlyPaneModifyConnectionSelectClicked:"RunOnlyPaneModifyConnectionSelectClicked",RunOnlyPaneModifyConnectionModalCancelClicked:"RunOnlyPaneModifyConnectionModalCancelClicked",FlowSendACopyPanelDismissed:"FlowSendACopyPanelDismissed",FlowSaveAsDialogCancelButtonClicked:"FlowSaveAsDialogCancelButtonClicked",FlowSaveAsDialogSaveButtonClicked:"FlowSaveAsDialogSaveButtonClicked",InvokeFlowFormConsentClicked:"InvokeFlowFormConsentClicked",InvokeFlowFormRunFlowButtonClicked:"InvokeFlowFormRunFlowButtonClicked",InvokeFlowFormCancelButtonClicked:"InvokeFlowFormCancelButtonClicked",InvokeFlowFormDoneButtonClicked:"InvokeFlowFormDoneButtonClicked",PublishFlowStarted:"PublishFlowStarted",CreateFlowStarted:"CreateFlowStarted",BrowseTemplatesClicked:"BrowseTemplatesClicked",DesignerLoad:"DesignerLoad",FlowCheckerPanelCellClicked:"FlowCheckerPanelCellClicked",ActionHeadingBackButtonNavigate:"ActionHeadingBackButtonNavigate",UpdateFlowCompleted:"UpdateFlowCompleted",FlowCheckerPanelOpenedOnSave:"FlowCheckerPanelOpenedOnSave",ActionHeadingMessageBarDismissed:"ActionHeadingMessageBarDismissed",SaveFlowClicked:"SaveFlowClicked",SaveFlowDraftClicked:"SaveFlowDraftClicked",SavePremiumFlowClickedByUnlicensedMaker:"SavePremiumFlowClickedByUnlicensedMaker",CreateFlowDraftCompleted:"CreateFlowDraftCompleted",UndoOrRedoClicked:"UndoOrRedoClicked",XRMSaveDraftFlowClicked:"XRMSaveDraftFlowClicked",XRMPublishFlowClicked:"XRMPublishFlowClicked",XRMRestorePublishedClicked:"XRMRestorePublishedClicked",TestFlowPanelOpened:"TestFlowPanelOpened",FlowCheckerPanelOpenedOnTest:"FlowCheckerPanelOpenedOnTest",FlowCheckerPanelOpenedOnClick:"FlowCheckerPanelOpenedOnClick",DeleteFlowDraftClicked:"DeleteFlowDraftClicked",RecommendationPanelOnDismiss:"RecommendationPanelOnDismiss",RecommendationPanelOnOpen:"RecommendationPanelOnOpen",RecommendationPanelOnDisplayConnector:"RecommendationPanelOnDisplayConnector",RecommendationOnFlowSave:"RecommendationOnFlowSave",FlowCheckerPanelClosed:"FlowCheckerPanelClosed",RecommendationPanelOnClose:"RecommendationPanelOnClose",TestFlowPanelClosed:"TestFlowPanelClosed",TestFlowPanelChoiceClicked:"TestFlowPanelChoiceClicked",TestFlowPanelAutomaticallySubChoiceClicked:"TestFlowPanelAutomaticallySubChoiceClicked",TestFlowPanelRunChoiceClicked:"TestFlowPanelRunChoiceClicked",TestFlowPanelInvokedFlow:"TestFlowPanelInvokedFlow",TestFlowPanelInvokedRun:"TestFlowPanelInvokedRun",TestFlowPanelInvokedSimulate:"TestFlowPanelInvokedSimulate",FlowDesignerCloseClicked:"FlowDesignerCloseClicked",FlowDesignerSaveAndApplyClicked:"FlowDesignerSaveAndApplyClicked",FlowDesignerSaveDraftAndApplyClicked:"FlowDesignerSaveDraftAndApplyClicked",ContextualHelpPaneOpened:"ContextualHelpPaneOpened",TestFlowWaitForRun:"TestFlowWaitForRun",UpdateFlowStarted:"UpdateFlowStarted",OwnersSharepointSiteSelected:"OwnersSharepointSiteSelected",OwnersSharepointListSelected:"OwnersSharepointListSelected",OwnersAddSharepointPermissionClicked:"OwnersAddSharepointPermissionClicked",PublishFlowCompleted:"PublishFlowCompleted",BillingDialogLearnMoreClicked:"BillingDialogLearnMoreClicked",StartFreeTrialDialogCancelClicked:"StartFreeTrialDialogCancelClicked",StartFreeTrialDialogStartTrialClicked:"StartFreeTrialDialogStartTrialClicked",BillingDialogTermAndConditionsClicked:"BillingDialogTermAndConditionsClicked",AiBuilderStartTrialDialogLearnMoreClicked:"AiBuilderStartTrialDialogLearnMoreClicked",AiBuilderStartTrialDialogDocumentationClicked:"AiBuilderStartTrialDialogDocumentationClicked",AiBuilderStartTrialDialogCancelClicked:"AiBuilderStartTrialDialogCancelClicked",AiBuilderStartTrialDialogStartTrialClicked:"AiBuilderStartTrialDialogStartTrialClicked",AiBuilderExtendTrialDialogLearnMoreClicked:"AiBuilderExtendTrialDialogLearnMoreClicked",AiBuilderExtendTrialDialogDocumentationClicked:"AiBuilderExtendTrialDialogDocumentationClicked",AiBuilderExtendTrialDialogCancelClicked:"AiBuilderExtendTrialDialogCancelClicked",AiBuilderExtendTrialDialogStartTrialClicked:"AiBuilderExtendTrialDialogStartTrialClicked",AiBuilderTrialCapacityLimitDialogLearnMoreClicked:"AiBuilderTrialCapacityLimitDialogLearnMoreClicked",AiBuilderTrialCapacityLimitDialogDocumentationClicked:"AiBuilderTrialCapacityLimitDialogDocumentationClicked",AiBuilderTrialCapacityLimitDialogCancelClicked:"AiBuilderTrialCapacityLimitDialogCancelClicked",AiBuilderTrialCountLimitDialogLearnMoreClicked:"AiBuilderTrialCountLimitDialogLearnMoreClicked",AiBuilderTrialCountLimitDialogDocumentationClicked:"AiBuilderTrialCountLimitDialogDocumentationClicked",AiBuilderTrialCountLimitDialogCancelClicked:"AiBuilderTrialCountLimitDialogCancelClicked",AiBuilderNotAllowedToStartTrialDialogLearnMoreClicked:"AiBuilderNotAllowedToStartTrialDialogLearnMoreClicked",AiBuilderNotAllowedToStartTrialDialogDocumentationClicked:"AiBuilderNotAllowedToStartTrialDialogDocumentationClicked",AiBuilderNotAllowedToStartTrialDialogCancelClicked:"AiBuilderNotAllowedToStartTrialDialogCancelClicked",BillingDialogRedirectToSignupClicked:"BillingDialogRedirectToSignupClicked",BillingDialogSignInWithOrgClicked:"BillingDialogSignInWithOrgClicked",PremiumRequiredDialogOkClicked:"PremiumRequiredDialogOkClicked",BillingAdminDialogJustMeClicked:"BillingAdminDialogJustMeClicked",BillingAdminDialogForMyTeamClicked:"BillingAdminDialogForMyTeamClicked",IndividualPurchaseNotSupportedStartTrialClicked:"IndividualPurchaseNotSupportedStartTrialClicked",FeatureBlockedOnDeveloperEnvironmentOKClicked:"FeatureBlockedOnDeveloperEnvironmentOKClicked",TrialDialogOfficePortalSignupDismissed:"TrialDialogOfficePortalSignupDismissed",TrialDialogOfficePortalSignupClicked:"TrialDialogOfficePortalSignupClicked",SettingsPaneUpdateSettingsClicked:"SettingsPaneUpdateSettingsClicked",SignUpClicked:"SignUpClicked",SupportSearchSubmitted:"SupportSearchSubmitted",CustomApiCodeUploaded:"CustomApiCodeUploaded",CustomApiActionVisited:"CustomApiActionVisited",CustomApiEditParameterClicked:"CustomApiEditParameterClicked",CustomApiDeleteParameterClicked:"CustomApiDeleteParameterClicked",CustomApiDefinitionBackButtonClicked:"CustomApiDefinitionBackButtonClicked",CustomApiDefinitionVisited:"CustomApiDefinitionVisited",CustomApiParameterVisited:"CustomApiParameterVisited",CustomApiPolicyVisited:"CustomApiPolicyVisited",CustomApiResponseBackButtonClicked:"CustomApiResponseBackButtonClicked",CustomApiResponseVisited:"CustomApiResponseVisited",CustomApiTriggerBackButtonClicked:"CustomApiTriggerBackButtonClicked",CustomApiTriggerVisited:"CustomApiTriggerVisited",CustomApiActionDeleted:"CustomApiActionDeleted",CustomApiTriggerDeleted:"CustomApiTriggerDeleted",CustomApiDetailsTabVisited:"CustomApiDetailsTabVisited",CustomApiImportFromSampleRequestClicked:"CustomApiImportFromSampleRequestClicked",CustomApiImportFromSampleResponseClicked:"CustomApiImportFromSampleResponseClicked",CustomApiImportFromSampleWebhookResponseClicked:"CustomApiImportFromSampleWebhookResponseClicked",CustomApiUpdateOperationRequest:"CustomApiUpdateOperationRequest",CustomApiUpdateOperationResponse:"CustomApiUpdateOperationResponse",CustomApiUpdateResponse:"CustomApiUpdateResponse",CustomApiUpdateWebhookResponse:"CustomApiUpdateWebhookResponse",WsdlUrlUploaded:"WsdlUrlUploaded",CustomApiCopilotParameterVisited:"CustomApiCopilotParameterVisited",PostmanCollectionUploaded:"PostmanCollectionUploaded",SwaggerFileUploaded:"SwaggerFileUploaded",WsdlFileUploaded:"WsdlFileUploaded",CustomApiParameterDropdownTypeInitialized:"CustomApiParameterDropdownTypeInitialized",CustomApiParameterDropdownTypeChanged:"CustomApiParameterDropdownTypeChanged",CustomApiPropertiesCloseButtonClicked:"CustomApiPropertiesCloseButtonClicked",CustomApiPropertiesEditButtonClicked:"CustomApiPropertiesEditButtonClicked",CustomApiPropertiesBackButtonClicked:"CustomApiPropertiesBackButtonClicked",CustomApiPropertiesTabClicked:"CustomApiPropertiesTabClicked",CustomApiShareTabVisited:"CustomApiShareTabVisited",CustomApiShareTabSaveChangesClicked:"CustomApiShareTabSaveChangesClicked",CustomApiShareTabDiscardChangesClicked:"CustomApiShareTabDiscardChangesClicked",TestTabVisited:"TestTabVisited",ToggleRawBodyClicked:"ToggleRawBodyClicked",TestCurrentOperationClicked:"TestCurrentOperationClicked",TestingOperationUsingRawBody:"TestingOperationUsingRawBody",TestingOperationUsingParsedBody:"TestingOperationUsingParsedBody",CreateConnectionFromTestPage:"CreateConnectionFromTestPage",TemplateManagerConfirmTemplateDeleteButtonClicked:"TemplateManagerConfirmTemplateDeleteButtonClicked",TemplateManagerCancelTemplateDeleteButtonClicked:"TemplateManagerCancelTemplateDeleteButtonClicked",TemplateManagerTemplateDeleteButtonClicked:"TemplateManagerTemplateDeleteButtonClicked",TemplateManagerContinueToFlowCreationButtonClicked:"TemplateManagerContinueToFlowCreationButtonClicked",SearchEvent:"SearchEvent",TemplateLandingLiteCreateButtonClicked:"TemplateLandingLiteCreateButtonClicked",PremiumTemplateCreateFlowClicked:"PremiumTemplateCreateFlowClicked",TrialExpiredPageShown:"TrialExpiredPageShown",TrialExpiredExtendSubmitted:"TrialExpiredExtendSubmitted",TrialExtendedAutoClaimed:"TrialExtendedAutoClaimed",TrialExtendedAutoClaimFailed:"TrialExtendedAutoClaimFailed",TrialExtendedAutoClaimError:"TrialExtendedAutoClaimError",FilterQuerySetOnSave:"FilterQuerySetOnSave",TextMessageBarDismissed:"TextMessageBarDismissed",AutoClaimNotificationBannerShowed:"AutoClaimNotificationBannerShowed"})},33399:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(12999),n=i(11808),o=()=>Object(r.a)().enableCancelAllRuns&&!!Object(n.a)().CancelAllRuns.getConfig().isCancelAllRunsEnabled},33400:function(e,t){e.exports='<react-runs-page\n    download-button="flowRunsCtrl.downloadButton"\n    filters="flowRunsCtrl.filterModel"\n    flow="flowRunsCtrl.flow"\n    flow-details-url="::flowRunsCtrl.detailsPageUrl"\n    is-filter-selected-from-filters-menu="flowRunsCtrl.isFilterSelectedFromFiltersMenu"\n    is-loading="flowRunsCtrl.flowRunList.spinner.show || flowRunsCtrl.isLoading"\n    is-loading-more="flowRunsCtrl.flowRunList.isLoadingMore"\n    is-loading-trigger-outputs="flowRunsCtrl.isLoadingTriggerOutputs"\n    has-more="flowRunsCtrl.hasMoreRuns"\n    message-bar-props="flowRunsCtrl.messageBarProps"\n    runs="flowRunsCtrl.flowRunList.flowTriggerHistoriesWithRun || flowRunsCtrl.flowRunList.flowRuns"\n    runs-page-url="::flowRunsCtrl.runsPageUrl"\n    get-run-link="::flowRunsCtrl.getRunLink"\n    get-remediation="::flowRunsCtrl.getRemediation"\n    get-support-documents="::flowRunsCtrl.getSupportDocuments"\n    on-cancel="::flowRunsCtrl.onCancel"\n    on-edit="::flowRunsCtrl.onEdit"\n    on-flow-name-click="::flowRunsCtrl.onFlowNameClick"\n    on-resubmit="::flowRunsCtrl.onResubmit"\n    on-load-more="flowRunsCtrl.flowRunList.loadNextPage"\n    throttling-message="flowRunsCtrl.throttlingMessage"\n    latest-column-header-list="flowRunsCtrl.flowRunList.latestRunTriggerOutputKeys"\n    saved-column-headers="flowRunsCtrl.shownColumns"\n    trigger-outputs="flowRunsCtrl.triggerOutputs"\n    friendly-mapping-for-button-trigger-parameters="flowRunsCtrl.friendlyMappingForButtonTriggerParameters"\n    on-save-column-headers="flowRunsCtrl.onSaveColumnHeaders"\n    on-run-click="flowRunsCtrl.onRunClick"\n    on-add-column-click="flowRunsCtrl.onAddColumnClick"\n    clientResources="flowRunsCtrl.clientResources"\n    appSettings="flowRunsCtrl.appSettings"\n    assetService="flowRunsCtrl.assetService"\n    cdnService="flowRunsCtrl.cdnService"\n    telemetryService="flowRunsCtrl.telemetry"\n    loggingService="flowRunsCtrl.loggingService"\n    flowService="flowRunsCtrl.flowService"\n    sessionStore="flowRunsCtrl.sessionStore">\n</react-runs-page>\n'},33401:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33327),n=i(33335),o=i(33402);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33404);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33405),this.controller=o.a,this.controllerAs="approvalCenterCtrl"}));n.a.component(r.a.components.approvalCenter,new c)},33402:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(33327),n=i(33403),o=i(33355),a=i(12366),s=i(11891),l=i(13031),c=i(13009),u=i(33384),d=i(17807),p=i(17806);function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function m(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=m((function e(t,i,r,h,m,g,f,v,b,y,w,S,C,k){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$window=i,this.$locationService=r,this.appSettings=h,this.approvalViewsClient=m,this.assetService=g,this.clientResources=f,this.hostCommunicationService=v,this.loggingService=b,this.policiesService=y,this.promiseHelperService=w,this.routeCrafter=S,this.sessionService=C,this.widgetUtilService=k,this.TabNames={received:"received",sent:"sent",history:"history"},this.loaded=void 0,this.isHistoryLoading=!0,this.fullPageErrorModel=void 0,this.selectedTab=void 0,this.tabs=void 0,this.headingLinks=void 0,this.approvalViews=[],this.selectedApproval=void 0,this.listApprovals=(e,t)=>{var i=this.loggingService.profileStart(o.a.approvalsListApprovalsStart),r=this.approvalViewsClient.query(this.$scope,{$filter:Object(n.a)(e,t)});r.$promise.then(()=>{this.loggingService.profileEndWithSuccess(i,o.a.approvalsListApprovalsEnd),this.approvalViews=r.toJSON(),this.isHistoryLoading=!1}).catch(e=>{this.loggingService.profileEnd(i,o.a.approvalsListApprovalsEnd,Object(c.y)(e),e),Object(u.b)(this.fullPageErrorModel,e)})},this.getApproval=e=>{var t=this.loggingService.profileStart(o.a.approvalsGetApprovalStart),i=this.approvalViewsClient.get(this.$scope,{id:e.name});i.$promise.then(()=>{this.loggingService.profileEndWithSuccess(t,o.a.approvalsGetApprovalEnd,{approvalName:e.name}),this.selectedApproval=i}).catch(i=>{this.loggingService.profileEnd(t,o.a.approvalsGetApprovalEnd,Object(c.y)(i),i,{approvalName:e.name}),Object(u.b)(this.fullPageErrorModel,i)})},this.handleApprovalPanelDismissed=()=>{this.selectedApproval=void 0},this.getSelectedTab=()=>{var e=this.$locationService.path().split("/");return e[e.length-1]},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ApprovalCenterCtrl"}),this.loaded=!1,this.selectedTab=this.getSelectedTab(),this.fullPageErrorModel={image:this.assetService.fullPageErrorGeneric,isPageErrored:!1,pageTitle:null},this.promiseHelperService.toAngularPromise(Promise.all([this.sessionService.getUserSessionAsync(),this.policiesService.shouldBlockWidgetUsage()])).then(e=>{var[t,i]=e;if(i){this.fullPageErrorModel.customButtons=[{buttonText:Object(l.a)(this.clientResources.Common.VisitFlowPortal,this.appSettings.brandName),url:this.appSettings.portalUrl}];var r=this.sessionService.isGuestUser()?Object(l.a)(this.clientResources.FullPageError.FriendlyError.Subtext.GuestUserNoPlans,this.appSettings.brandName):Object(l.a)(this.clientResources.FullPageError.FriendlyError.Subtext.RedirectToMSA,this.appSettings.brandName);throw Object(u.b)(this.fullPageErrorModel,null,this.clientResources.FullPageError.FriendlyError.Text.ThatDidntWork,r),new Error(r)}this.tabs={tabSelected:this.selectedTab,tabsInfo:[{tabHeader:this.clientResources.Approvals.Received,tabName:this.TabNames.received,href:Object(p.e)(this.routeCrafter),eventName:"ApprovalsReceivedTabClicked"},{tabHeader:this.clientResources.Approvals.Sent,tabName:this.TabNames.sent,href:Object(p.g)(this.routeCrafter),eventName:"ApprovalsSentTabClicked"}]},this.widgetUtilService.isWidgetPage()&&!this.widgetUtilService.widgetInfo.approvalCenterSettings.showApprovalHistory||this.tabs.tabsInfo.push({tabHeader:this.clientResources.Approvals.History,tabName:this.TabNames.history,href:Object(p.c)(this.routeCrafter),eventName:"ApprovalsHistoryTabClicked"}),this.widgetUtilService.isWidgetPage()&&(this.widgetUtilService.widgetInfo.pathAlias=Object(s.a)(this.selectedTab,this.TabNames.received)?a.w.receivedApprovals:Object(s.a)(this.selectedTab,this.TabNames.sent)?a.w.sentApprovals:a.w.historyApprovals),this.headingLinks=[],(!this.widgetUtilService.isWidgetPage()||this.widgetUtilService.isWidgetPage()&&!this.widgetUtilService.widgetInfo.hideFlowCreation)&&(this.headingLinks=[{label:this.clientResources.Approvals.CreateApprovalFlow,action:()=>{this.$window.open(Object(d.g)(this.routeCrafter))},image:this.assetService.templateNew,name:"approval-createapprovalflow-link"}]),this.loaded=!0}).catch(e=>{Object(u.b)(this.fullPageErrorModel,e),this.loggingService.logError("ApprovalCenterCtrl.constructor",e)})}));f.$inject=[r.a.services.$scope,r.a.services.$window,r.a.services.$location,r.a.services.appSettings,r.a.services.approvalViewsClient,r.a.services.assetService,r.a.services.clientResources,r.a.services.hostCommunicationService,r.a.services.logging,r.a.services.policies,r.a.services.promiseHelperService,r.a.services.routeCrafter,r.a.services.session,r.a.services.widgetUtilService]},33403:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33328),n=i(33327),o=i(31433),a=i(13144),s={query:42e4,get:48e4,evictionDelay:3e5};function l(e,t){return"properties/isActive eq '".concat(e,"' and properties/userRole eq '").concat(t,"'")}r.a.factory(n.a.services.approvalViewsClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment,(e,t,i)=>{var r=e=>(e.url=e.url.replace(new RegExp("environments/(.*?)/?approvalViews"),"environments/".concat(i.getCurrentEnvironmentName(),"/approvalViews")),e),n={urlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/approvalViews"),getUrlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/approvalViews/:id"),resourceType:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/approvals/approvalView")};return t({urlBase:Object(a.c)(e).flowRP,urlPath:n.urlPath,apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:n.resourceType,rest:{query:{requestInterceptor:r,params:{$filter:"@filter"}},get:{requestInterceptor:r,urlPath:n.getUrlPath,params:{id:"@id"}}},options:{atomize:!1,evictionDelay:s.evictionDelay}})}])},33404:function(e,t,i){e.exports=i.p+"static/media/approvalCenter.e4594f4a.less"},33405:function(e,t){e.exports='<div\n    class="approval-center"\n    ng-if="approvalCenterCtrl.loaded && !approvalCenterCtrl.fullPageErrorModel.isPageErrored">\n    <heading tabs="approvalCenterCtrl.tabs" links="approvalCenterCtrl.headingLinks"></heading>\n    <section class="approval-center-content" ng-switch="approvalCenterCtrl.selectedTab">\n            <received-tab ng-switch-when="received"></received-tab>\n            <sent-tab ng-switch-when="sent"></sent-tab>\n            <history-tab ng-switch-when="history"\n                approvals="approvalCenterCtrl.approvalViews"\n                selected-approval="approvalCenterCtrl.selectedApproval"\n                is-list-loading="approvalCenterCtrl.isHistoryLoading"\n                list-approvals="approvalCenterCtrl.listApprovals"\n                on-approval-selected="approvalCenterCtrl.getApproval"\n                on-approval-panel-dismissed="approvalCenterCtrl.handleApprovalPanelDismissed">\n            </history-tab>\n    </section>\n    <div class="consent-widget" ng-if="approvalCenterCtrl.userConsentService.shouldShowIntegratedConsent()">\n        <user-consent></user-consent>\n    </div>\n</div>\n<full-page-error model="approvalCenterCtrl.fullPageErrorModel" ng-if="approvalCenterCtrl.fullPageErrorModel.isPageErrored"></full-page-error>'},33406:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33407),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33410);var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33411),this.controllerAs="customApiPropertiesPaneCtrl",this.resolve={setPageTitle:[n.a.services.$document,n.a.services.appSettings,n.a.services.clientResources,function(e,t,i){e[0].title=Object(a.a)(i.PageTitle.CustomApis,t.brandName)}]}}));r.a.component(n.a.components.customApi.propertiesPane,new u)},33407:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(33394),n=i(33353),o=i(33383),a=i(33392),s=i(33327),l=i(13272),c=i(13009),u=i(33398),d=i(33347),p=i(33355),h=i(17914),m=i(33408),g=i(33306);function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(){function e(t,i,r,a,s,c,d,p,m,g,f,v,b){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$locationService=t,this.$q=i,this.$routeParams=r,this.$scope=a,this.apisClient=s,this.clientResources=c,this.customConnectorUrlService=d,this.environmentService=p,this.navigationService=m,this.loggingService=g,this.permissionsClient=f,this.sessionService=v,this.telemetryService=b,this.alertType=n.a,this.iconName=l.a,this.TabNames=h.b,this.customApiProperties=void 0,this.selectedTab=void 0,this.tabs=void 0,this.spinner={size:o.c.Large,local:o.a.Local},this.statusAlert={message:"",type:n.a.None,options:{title:null,show:(e,t)=>{this.statusAlert.type=e,this.statusAlert.message=t},hide:()=>this.statusAlert.options.show(n.a.None,"")}},this.canUserEdit=!1,this.backUrl=void 0,this.onCloseButtonClicked=()=>{this.navigationService.navigate(this.customConnectorUrlService.getCustomApisListUrl()),this.telemetryService.tagEvent(u.a.CustomApiPropertiesCloseButtonClicked,{closeUrl:this.customConnectorUrlService.getCustomApisListUrl()})},this.onEditButtonClicked=()=>{this.navigationService.navigate(this.customConnectorUrlService.getDefaultEditCustomApisUrl(this.customApiProperties.apiName)),this.telemetryService.tagEvent(u.a.CustomApiPropertiesEditButtonClicked,{editApiUrl:"/connections/available/custom/:apiName/edit"})},this.onBackButtonClicked=()=>{this.telemetryService.tagEvent(u.a.CustomApiPropertiesBackButtonClicked,{backUrl:this.backUrl})},this.onTabKeydown=(e,t)=>{switch(e.code){case"Enter":case"Space":this.navigateToTab(t)}},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"CustomApiPropertiesPaneCtrl"}),this.customApiProperties={permissions:{},api:{},apiName:this.$routeParams.apiName,apiDisplayName:"",spinner:this.spinner,statusAlert:this.statusAlert},this.tabs=[{tabHeader:this.clientResources.Manage.CustomApi.Tabs.details,tabName:this.TabNames.details},{tabHeader:this.clientResources.Manage.CustomApi.Tabs.share,tabName:this.TabNames.share}],this.selectedTab=this.$routeParams.tab,this.getApiAndPermissions(this.customApiProperties.apiName),this.backUrl=this.customConnectorUrlService.getCustomApisListUrl()}var t,i,s;return t=e,(i=[{key:"navigateToTab",value:function(e){this.telemetryService.tagEvent(u.a.CustomApiPropertiesTabClicked,{apiName:this.customApiProperties.apiName,section:e}),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDetailsTab(this.customApiProperties.apiName,e))}},{key:"getApiAndPermissions",value:function(e){var t=Object(d.e)(e);this.spinner.show=!0;var i={id:t,$expand:Object(d.o)(this.sessionService.getUserInfo())},o=this.loggingService.profileStart(p.a.myCustomApiPropertiesLoadStart,i),s=this.apisClient.get(this.$scope,i);s.$promise.then(()=>{this.loggingService.profileEndWithSuccess(o,p.a.myCustomApiPropertiesLoadEnd,i),this.customApiProperties.api=s,this.canUserEdit=Object(d.a)(s,this.clientResources),this.customApiProperties.apiDisplayName=Object(d.h)(s);var e=Object(d.l)(s.properties.connectionParameters);if(this.customApiProperties.redirectUrl=e&&e.redirectUrl,!Object(g.equalsIgnoreCase)(this.customApiProperties.api.properties.almMode,"solution")){var t=Object(m.a)({apiName:this.$routeParams.apiName},!0,this.environmentService.getCurrentEnvironmentName()),n=this.loggingService.profileStart(p.a.myCustomApiPropertiesGetPermissionsStart,{filter:null==t?void 0:t.$filter});this.customApiProperties.permissions=this.permissionsClient.query(this.$scope,t),this.customApiProperties.permissions.$promise.then(()=>{this.loggingService.profileEndWithSuccess(n,p.a.myCustomApiPropertiesGetPermissionsEnd,{filter:null==t?void 0:t.$filter})}).catch(e=>{var i=Object(c.fb)(e),o=Object(a.d)(i)===r.c.NotFound?a.a.ValidationError:Object(a.b)(e);this.loggingService.profileEnd(n,p.a.myCustomApiPropertiesGetPermissionsEnd,o,e,{filter:null==t?void 0:t.$filter,fullNonLocalizedError:i})})}}).catch(e=>{var t=Object(a.d)(e),s=(Object(a.b)(e),this.clientResources.Manage.CustomApi.GetApi.Error);t===r.c.ApiResourceNotFound?(a.a.ValidationError,s=this.clientResources.Manage.CustomApi.ApiDoesNotExist.Error):t===r.c.ApiAuthorizationFailed&&(a.a.ValidationError,s=this.clientResources.Manage.CustomApi.NoReadPermissionsToApi.Error),this.loggingService.profileEnd(o,p.a.myCustomApiPropertiesLoadEnd,Object(a.b)(e),e,i),this.statusAlert.options.show(n.a.Error,s)}).finally(()=>{this.spinner.show=!1})}}])&&f(t.prototype,i),s&&f(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();b.$inject=[s.a.services.$location,s.a.services.$q,s.a.services.$routeParams,s.a.services.$scope,s.a.services.apisClient,s.a.services.clientResources,s.a.services.customConnectorUrlService,s.a.services.environment,s.a.services.navigation,s.a.services.logging,s.a.services.permissionsClient,s.a.services.session,s.a.services.telemetry]},33408:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33331),n=i(33327),o=i(33409);function a(e,t,i){return t&&(e.$filter?e.$filter="environment eq '".concat(i,"' and ").concat(e.$filter):e.$filter="environment eq '".concat(i,"'")),e}r.a.service(n.a.services.environment,o.a)},33409:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(12345),n=i(12366);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,a;return t=e,(i=[{key:"getCurrentEnvironment",value:function(){return r.a.environmentClaim}},{key:"getCurrentEnvironmentName",value:function(){return r.a.currentEnvironmentName}},{key:"getEnvironmentSku",value:function(){var e=this.getCurrentEnvironment();return e&&e.sku?e.sku:n.k.NotSpecified}},{key:"isDevEnvironment",value:function(){return this.getEnvironmentSku()===n.k.Developer}},{key:"getSponsoredConnectorNames",value:function(){var e,t=[];return null===(e=this.getCurrentEnvironment())||void 0===e||null===(e=e.sponsoredConnectors)||void 0===e||e.forEach(e=>{e&&e.requiredApis&&t.push(...e.requiredApis.map(e=>null==e?void 0:e.name))}),t}},{key:"isPayGoEnabled",get:function(){var e;return(null===(e=this.getCurrentEnvironment())||void 0===e?void 0:e.isPayAsYouGoEnabled)||!1}}])&&o(t.prototype,i),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33410:function(e,t,i){e.exports=i.p+"static/media/customApiPropertiesPane.3aeeaf49.less"},33411:function(e,t){e.exports='<div class="subsection-manage customApiPropertiesPane">\n    <div class="customApiPropertiesPane-header">\n    \x3c!-- TODO(nidurak): move the headers plus alert to a component and merge with the swagger editor page --\x3e\n        <alert class="customApiPropertiesPane-errorAlert" model="customApiPropertiesPaneCtrl.statusAlert" ng-if="customApiPropertiesPaneCtrl.statusAlert.type !== customApiPropertiesPaneCtrl.alertType.None"></alert>\n        <div class="customApiPropertiesPane-topHeader">\n            <div class="row">\n                <react-back-button\n                    class="customApiPropertiesPane-topHeader-button"\n                    back-url="customApiPropertiesPaneCtrl.backUrl"\n                    is-disabled="customApiPropertiesPaneCtrl.spinner.show"\n                    on-before-navigate="customApiPropertiesPaneCtrl.onBackButtonClicked"\n                    client-resources="::customApiPropertiesPaneCtrl.clientResources">\n                </react-back-button>\n                <label for="apiNameInput" class="customApiPropertiesPane-topHeader-ApiNameLabel">{{customApiPropertiesPaneCtrl.clientResources.Manage.CustomApi.apiName}}</label>\n                <input type="text"\n                    class="c-text-field customApiPropertiesPane-topHeader-input"\n                    ng-model="customApiPropertiesPaneCtrl.customApiProperties.apiDisplayName"\n                    readonly="true"\n                    id="apiNameInput"\n                    placeholder="{{::customApiPropertiesPaneCtrl.clientResources.Common.Untitled}}"\n                >\n            </div>\n        </div>\n        <div id="heading-tabs-{{::customApiPropertiesPaneCtrl.$scope.$id}}" class="customApiPropertiesPane-bottomHeader">\n            <div class="row" role="tablist">\n                <span ng-repeat="tab in customApiPropertiesPaneCtrl.tabs">\n                    <a role="tab"\n                        tabindex="0"\n                        class="customApiPropertiesPane-tab"\n                        ng-class="{\'customApiPropertiesPane-tab--active\': customApiPropertiesPaneCtrl.selectedTab === tab.tabName, \'customApiPropertiesPane-tab--first\': $first }"\n                        ng-click="customApiPropertiesPaneCtrl.navigateToTab(tab.tabName)"\n                        aria-label="{{tab.tabHeader}}"\n                        ng-keydown="customApiPropertiesPaneCtrl.onTabKeydown($event, tab.tabName)"\n                        aria-selected="{{customApiPropertiesPaneCtrl.selectedTab === tab.tabName}}"\n                        ng-bind="tab.tabHeader">\n                    </a>\n                </span>\n                <div class="customApiPropertiesPane-bottomHeader-actions">\n                    <react-action-button\n                        class="customApiPropertiesPane-bottomHeader-action"\n                        disabled="!customApiPropertiesPaneCtrl.canUserEdit || customApiPropertiesPaneCtrl.spinner.show"\n                        text="::customApiPropertiesPaneCtrl.clientResources.Common.Edit"\n                        icon-name="::customApiPropertiesPaneCtrl.iconName.Edit"\n                        on-click="customApiPropertiesPaneCtrl.onEditButtonClicked">\n                    </react-action-button>\n                    <react-action-button\n                        class="customApiPropertiesPane-bottomHeader-action"\n                        disabled="customApiPropertiesPaneCtrl.spinner.show"\n                        text="::customApiPropertiesPaneCtrl.clientResources.Common.Close"\n                        icon-name="::customApiPropertiesPaneCtrl.iconName.Cancel"\n                        on-click="customApiPropertiesPaneCtrl.onCloseButtonClicked">\n                    </react-action-button>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="customApiPropertiesPane-bodyContainer" ng-class="{\'customApiPropertiesPane-bodyContainer-shifted\': customApiPropertiesPaneCtrl.statusAlert.type}" >\n        <div class="row" ng-hide="customApiPropertiesPaneCtrl.spinner.show">\n            <div ng-if="customApiPropertiesPaneCtrl.selectedTab === customApiPropertiesPaneCtrl.TabNames.details">\n                <custom-api-details-tab model="customApiPropertiesPaneCtrl.customApiProperties"></custom-api-details-tab>\n            </div>\n            <div ng-if="customApiPropertiesPaneCtrl.selectedTab === customApiPropertiesPaneCtrl.TabNames.share">\n                <custom-api-share-tab model="customApiPropertiesPaneCtrl.customApiProperties"></custom-api-share-tab>\n            </div>\n        </div>\n    </div>\n    <spinner model="customApiPropertiesPaneCtrl.spinner"></spinner>\n</div>'},33412:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33413),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33422);var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33423),this.controllerAs="activityFeedCtrl",this.resolve={setPageTitle:[n.a.services.$document,n.a.services.clientResources,n.a.services.appSettings,function(e,t,i){e[0].title=Object(a.a)(t.PageTitle.Activity,i.brandName)}]}}));r.a.component(n.a.components.activityFeed,new u)},33413:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(33327),n=i(33414),o=i(33417),a=i(33383),s=i(33418),l=i(33354),c=i(33392),u=i(33384);function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=function(){function e(t,i,r,n,o,d,p,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$scope=i,this.$window=r,this.clientResources=n,this.dateTimeService=o,this.feedEventDefinitionsClient=d,this.flowsClient=p,this.loggingService=h,this.activityFeed=void 0,this.DefaultOptions=[{displayName:this.clientResources.Manage.ActivityFilter.AllActivity,name:""},{displayName:this.clientResources.Manage.ActivityFilter.Notifications,name:s.a.PushNotification},{displayName:this.clientResources.Manage.ActivityFilter.Failures,name:s.a.AggregatedFail}],this.spinner={size:a.c.Large,show:!0,local:a.a.Local},this.options={options:this.DefaultOptions,selectedOption:this.DefaultOptions[0]},this.fullPageErrorModel=void 0;var m=this.loggingService.profilePageStart(l.a.activityFeedLoadStart);this.activityFeed=this.getActivityFeed(new Date),this.fullPageErrorModel={isPageErrored:!1,pageTitle:this.clientResources.Manage.Activity.CloudFlowActivity},this.$q.all(this.activityFeed.eventCollections.map(e=>e.events.$promise)).then(()=>this.loggingService.profilePageEnd(m,l.a.activityFeedLoadEnd,{status:c.a.Success})).catch(e=>{throw this.loggingService.profilePageEnd(m,l.a.activityFeedLoadEnd,{status:Object(c.b)(e),error:Object(c.e)(e)}),this.loggingService.logError("ActivityFeedCtrl.ActivityFeedLoad",e),Object(u.b)(this.fullPageErrorModel,e),e}).finally(()=>{this.spinner.show=!1,this.activityFeed.pagesLoaded=1})}var t,i,r;return t=e,(i=[{key:"getActivityFeed",value:function(e){return{id:"feedEvents",date:e,pagesLoaded:0,eventCollections:this.getEventCollections(e),loadingMore:!1,loadMore:()=>{var t=this.loggingService.profileStart(l.a.activityFeedLoadMoreStart);this.activityFeed.loadingMore=!0,this.activityFeed.loadingMoreSpinner.show=!0;var i=o.c.PagingIntervals[this.activityFeed.pagesLoaded],r=o.c.PagingIntervals[this.activityFeed.pagesLoaded+1];switch(this.activityFeed.pagesLoaded){case o.c.MaximumPagesToLoad:this.activityFeed.loadingMore=!1,this.activityFeed.loadingMoreSpinner.show=!1;break;default:var a=this.feedEventDefinitionsClient.query(this.$scope,{$filter:Object(n.a)(e,r,i)});a.$promise.then(()=>this.loggingService.profileEndWithSuccess(t,l.a.activityFeedLoadMoreEnd)).catch(e=>{this.loggingService.profileEnd(t,l.a.activityFeedLoadMoreEnd,Object(c.b)(e),e),this.$q.reject(e)}).finally(()=>{this.activityFeed.eventCollections[o.b.Older].events.$apply(a),this.activityFeed.pagesLoaded++,this.activityFeed.loadingMore=!1,this.activityFeed.loadingMoreSpinner.show=!1})}},hasMore:()=>this.activityFeed.pagesLoaded!==o.c.MaximumPagesToLoad,spinner:this.spinner,loadingMoreSpinner:{size:a.c.Small,show:!1,local:a.a.LocalHorizontal},options:this.options,tables:[]}}},{key:"getEventCollections",value:function(e){return[{events:this.feedEventDefinitionsClient.query(this.$scope,{$filter:Object(n.a)(e,o.c.TodayStartInterval)}),heading:this.clientResources.Manage.Activity.Today},{events:this.feedEventDefinitionsClient.query(this.$scope,{$filter:Object(n.a)(e,o.c.YesterdayStartInterval,o.c.YesterdayEndInterval)}),heading:this.clientResources.Manage.Activity.Yesterday},{events:this.feedEventDefinitionsClient.query(this.$scope,{$filter:Object(n.a)(e,o.c.PagingIntervals[1],o.c.PagingIntervals[0])}),heading:this.clientResources.Manage.Activity.Older,shouldMerge:!0,expandDateTime:!0}]}}])&&d(t.prototype,i),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();h.$inject=[r.a.services.$q,r.a.services.$scope,r.a.services.$window,r.a.services.clientResources,r.a.services.dateTime,r.a.services.feedEventDefinitionsClient,r.a.services.flowsClient,r.a.services.logging]},33414:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33328),n=i(33327),o=i(33415),a=i(12330),s=i(33416),l=i(13144);function c(e,t,i){var r=o.g(e,t),n=Object(a.a)(i)?e:o.g(e,i);return"Timestamp ge ".concat(Object(s.a)(r)," ").concat(Object(a.a)(i)?"":"and Timestamp lt ".concat(Object(s.a)(n)))}var u={listFeedEventDefinitions:12e4,evictionDelay:3e5};r.a.factory(n.a.services.feedEventDefinitionsClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,n.a.services.environment,n.a.services.session,(e,t,i,r)=>{var n="".concat(t.processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/events");return e({urlBase:Object(l.c)(t).flowRP,urlPath:n,apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,rest:{query:{params:{$aggregate:"Fail,Success",$expand:"Runs"}}},options:{atomize:!1,evictionDelay:u.evictionDelay}})}])},33415:function(e,t,i){"use strict";var r=i(14918);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.i})),i.d(t,"c",(function(){return r.l})),i.d(t,"d",(function(){return r.r})),i.d(t,"e",(function(){return r.s})),i.d(t,"f",(function(){return r.B})),i.d(t,"g",(function(){return r.D})),i.d(t,"h",(function(){return r.K})),i.d(t,"i",(function(){return r.P}))},33416:function(e,t,i){"use strict";function r(e){var t="";if(e.hasOwnProperty("toISOString"))t=e.toISOString();else{var i=e.getUTCFullYear(),r=n(e.getUTCMonth()+1,2),o=n(e.getUTCDate(),2),a=n(e.getUTCHours(),2),s=n(e.getUTCMinutes(),2),l=n(e.getUTCSeconds(),2),c=n(e.getUTCMilliseconds(),3);t="".concat(i,"-").concat(r,"-").concat(o,"T").concat(a,":").concat(s,":").concat(l,".").concat(c,"Z")}return t}function n(e,t){for(var i="".concat(e),r=i.length;r<t;r++)i="0".concat(i);return i}i.d(t,"a",(function(){return r}))},33417:function(e,t,i){"use strict";i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return m})),i.d(t,"a",(function(){return g}));var r=i(33327),n=i(11891),o=i(33418),a=i(33383),s=i(33419),l=i(33420),c=i(33396),u=i(33421);function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=function(e){return e[e.Today=0]="Today",e[e.Yesterday=1]="Yesterday",e[e.Older=2]="Older",e}({}),m={TodayStartInterval:0,YesterdayEndInterval:0,YesterdayStartInterval:-1,PagingIntervals:[-1,-8,-15,-22,-29],MaximumPagesToLoad:4},g=function(){function e(t,i,r,o,s,l,c,u,d,p,h,m,g){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$sce=t,this.$scope=i,this.$q=r,this.clientResources=o,this.feedEventDefinitionsClient=s,this.flowsClient=l,this.dateTimeService=c,this.navigationService=u,this.environmentService=d,this.assetService=p,this.routeCrafter=h,this.cdnService=m,this.loggingService=g,this.modalDialog=void 0,this.spinner={size:a.c.Large,local:a.a.Local},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ActivityFeedListDirectiveCtrl"}),this.modalDialog={show:!1,title:this.clientResources.Flow.Error.RunOnlyFlowNoPermission,buttons:[{label:this.clientResources.Common.Ok,action:()=>{this.modalDialog.show=!1}}]},this.$q.all(this.$scope.model.eventCollections.map(e=>e.events.$promise)).finally(()=>{this.$scope.model.spinner.show=!1}),this.$scope.model.eventCollections.forEach((t,i)=>{t.events.$watch(this.$scope,()=>{var r=t.events.filter(t=>e.SupportedFeedEventTypes.some(e=>n.a(e,t.properties.type))).map(e=>this.convertFeedEventDefinitionToRow(e,t.expandDateTime));this.$scope.model.tables[i]={rows:t.shouldMerge&&this.$scope.model.tables[i]&&this.$scope.model.tables[i].rows?this.$scope.model.tables[i].rows.concat(r):r,heading:t.heading}})})}var t,i,r;return t=e,(i=[{key:"convertFeedEventDefinitionToRow",value:function(e,t){var i=new Date(e.properties.timestamp);return{flowName:e.properties.actorId,type:e.properties.type,title:Object(o.c)(e,this.clientResources.Manage.Activity.Flow.Failed),description:Object(o.b)(e,this.clientResources),timeSince:t?this.dateTimeService.getTimeAtDateTimeString(i):this.dateTimeService.getFriendlyTimeSinceString(l.a,i),allIcons:Object(s.a)(e,this.assetService,this.clientResources),isFeedEventFailed:Object(o.d)(e),navigationInfo:Object(u.a)(e,this.routeCrafter)}}},{key:"activityFeedPresent",value:function(){return this.$scope.model.tables.some(e=>0!==e.rows.length)&&!this.$scope.model.spinner.show}},{key:"rowDefaultAction",value:function(e){var t=Object(c.b)(e.flowName,this.environmentService),i=this.flowsClient.get(this.$scope,{id:t});i.$promise.then(()=>{i&&!i.properties.definition&&n.a(i.properties.userType,"user")?this.modalDialog.show=!0:this.navigationService.navigate(e.navigationInfo)})}}])&&d(t.prototype,i),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.$inject=[r.a.services.$sce,r.a.services.$scope,r.a.services.$q,r.a.services.clientResources,r.a.services.feedEventDefinitionsClient,r.a.services.flowsClient,r.a.services.dateTime,r.a.services.navigation,r.a.services.environment,r.a.services.assetService,r.a.services.routeCrafter,r.a.services.cdnService,r.a.services.logging],g.SupportedFeedEventTypes=[o.a.AggregatedFail,o.a.AggregatedSuccess,o.a.PushNotification,o.a.FlowSuspended,o.a.BrokenConnection]},33418:function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return a}));var r=i(14923);function n(e){return e&&e.properties&&(e.properties.type===r.a.AggregatedFail||e.properties.type===r.a.BrokenConnection)}function o(e,t){switch(e&&e.properties&&e.properties.type){case r.a.AggregatedFail:return t;case r.a.BrokenConnection:case r.a.PushNotification:case r.a.AggregatedSuccess:case r.a.FlowSuspended:return e.properties.title;default:return""}}function a(e,t){switch(e&&e.properties&&e.properties.type){case r.a.AggregatedFail:case r.a.AggregatedSuccess:case r.a.PushNotification:case r.a.FlowSuspended:return"*sanitized*"===e.properties.object.displayName?t.Manage.Activity.FlowId+": "+e.properties.actorId:e.properties.object.displayName;case r.a.BrokenConnection:return e.properties.object.description;default:return""}}i.d(t,"a",(function(){return r.a}))},33419:function(e,t,i){"use strict";var r=i(14922);i.d(t,"a",(function(){return r.c})),i.d(t,"b",(function(){return r.d})),i.d(t,"c",(function(){return r.f}))},33420:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33331),n=i(33327),o=i(33360),a=i(33415),s=i(12375);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u={UseShortFormat:!1,UseShortUnit:!1},d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t}var t,i,r;return t=e,(i=[{key:"getFriendlyTimeSinceString",value:function(e,t,i){return Object(a.f)(this.clientResources.DateTime,e,t,i)}},{key:"getSimpleDateTimeString",value:function(e){return Object(o.d)("{0} {1}",e.toLocaleDateString(),e.toLocaleTimeString())}},{key:"getTimeAtDateTimeString",value:function(e){return Object(a.h)(this.clientResources.DateTime,e,Object(s.a)())}},{key:"compareDates",value:function(e,t){var i=Object(o.g)(e),r=Object(o.g)(t);return i&&r?i.getTime()-r.getTime():i?i.getTime():r?-1*r.getTime():0}},{key:"getIntervalDate",value:function(e,t){return Object(a.g)(e,t)}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[n.a.services.clientResources],r.a.service(n.a.services.dateTime,d)},33421:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(14900),n=i(14901),o=i(18959),a=i(33418);function s(e,t){switch(e&&e.properties&&e.properties.type){case a.a.AggregatedFail:case a.a.AggregatedSuccess:return e.properties.object.isFlowDeleted?"#":Object(r.n)(t,{flowName:e.properties.actorId,runName:e.properties.object.runs[0].flowRunSequenceId,isLegacyShared:!1,isUIFlow:!1,solutionId:void 0});case a.a.PushNotification:return e.properties.object.isFlowDeleted?"#":Object(r.n)(t,{flowName:e.properties.actorId,runName:e.properties.object.flowRunSequenceId,isLegacyShared:!1,isUIFlow:!1,solutionId:void 0});case a.a.BrokenConnection:var i=Object(o.c)(e.properties.object.connectionId);return Object(n.c)({crafter:t,apiName:i,connectionName:e.properties.actorId});case a.a.FlowSuspended:return e.properties.object.isFlowDeleted?"#":Object(r.e)(t,{flowName:e.properties.actorId});default:return"#"}}},33422:function(e,t,i){e.exports=i.p+"static/media/activityFeed.c52c9465.less"},33423:function(e,t){e.exports='<div>\n    <div class="subsection-manage context-manage-activityfeed" ng-if="!activityFeedCtrl.fullPageErrorModel.isPageErrored">\n        <div class="heading">\n            <div class="row">\n                <div class="column large-4">\n                    <h1>{{activityFeedCtrl.clientResources.Manage.Activity.CloudFlowActivity}}</h1>\n                </div>\n                <div class="column large-4">\n                    <div class="activityfeed-search">\n                        <form class="c-search flow-f-search-alt">\n                            <input type="search"\n                                    aria-label="{{activityFeedCtrl.clientResources.Manage.Activity.SearchRecentActivity}}"\n                                    placeholder="{{activityFeedCtrl.clientResources.Manage.Activity.SearchRecentActivity}}"\n                                    ng-model="activityFeedCtrl.activityFeed.searchFilter"\n                                    autocomplete="off"\n                                    spellcheck="false"\n                                    title="{{activityFeedCtrl.clientResources.Manage.Activity.SearchRecentActivity}}" />\n                            <button type="submit" disabled="true" class="c-glyph">\n                                <span class="x-screen-reader">{{activityFeedCtrl.clientResources.Manage.Activity.Search}}</span>\n                            </button>\n                        </form>\n                    </div>\n                </div>\n                <div class="column large-4">\n                    <div class="activityfeed-options">\n                        <options model="activityFeedCtrl.options"></options>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="row">\n            <div class="column">\n                <spinner model="activityFeedCtrl.spinner"></spinner>\n                <activity-feed-list model="activityFeedCtrl.activityFeed"></activity-feed-list>\n            </div>\n        </div>\n    </div>\n    <full-page-error model="activityFeedCtrl.fullPageErrorModel" ng-if="activityFeedCtrl.fullPageErrorModel.isPageErrored"></full-page-error>\n</div>\n'},33424:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33335),n=i(33327),o=i(33425);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33426);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33427),this.controller=o.a,this.controllerAs="invokeFlowWidgetV2Ctrl"}));r.a.component(n.a.components.invokeFlow.invokeFlowWidgetV2,new c)},33425:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var r=i(13009),n=i(33394),o=i(33364),a=i(33354),s=i(33392),l=i(33384),c=i(33327),u=i(33360),d=i(11804),p=i(33396),h=i(16926),m=i(21028),g=i(18933),f=i(17214),v=i(13202),b=i(17258),y=i(19726),w=i(14900),S=i(21057),C=i(22888),k=i(20381);function P(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function x(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){P(o,r,n,a,s,"next",e)}function s(e){P(o,r,n,a,s,"throw",e)}a(void 0)}))}}function A(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function T(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var R=function(){function e(t,i,o,l,c,m,b,S,P,x,A,T,R,O,D,E){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$timeout=i,this.appSettings=o,this.assetService=l,this.clientResources=c,this.designerCoreLoaderService=m,this.environmentService=b,this.flowService=S,this.flowRunsService=P,this.hostCommunicationService=x,this.loggingService=A,this.policiesService=T,this.routeCrafter=R,this.sessionService=O,this.widgetUtilService=D,this.designerCoreLoader=E,this.invokeFlowResolve=void 0,this.invokeFlowReject=void 0,this.invokeFlowByTemplateResolve=void 0,this.invokeFlowByTemplateReject=void 0,this.getTriggerSchemaReject=void 0,this.implicitData=void 0,this.flowName=void 0,this.fullPageErrorModel=void 0,this.triggerFlowEventCorrelationId=void 0,this.invokeFlowSurfaceKey=void 0,this.flowCreatorSurfaceKey=void 0,this.shouldBlockWidgetUsage=void 0,this.licenseHeader=void 0,this.onClose=()=>{var e="The widget was closed";this.invokeFlowReject&&this.invokeFlowReject({code:n.c.flowWidgetClosed,message:e}),this.invokeFlowByTemplateReject&&this.invokeFlowByTemplateReject({code:n.c.flowWidgetClosed,message:e}),this.getTriggerSchemaReject&&this.getTriggerSchemaReject({code:n.c.flowWidgetClosed,message:e}),this.hostCommunicationService.triggerHostEvent(d.e.WIDGET_CLOSE)},this.showFlowCreatorSurface=e=>{var t=this.designerCoreLoader.loadDesignerScripts.bind(this.designerCoreLoader),i={autoConsentUser:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.allowBackgroundConsent(),allowCustomFlowDisplayName:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.allowCustomFlowName(),flowCreationMode:k.a.fromTemplateName,installFlowAfterCreation:!0,designTimeParameters:e.designTimeParameters,loadDesignerScripts:t,onCancel:this.handleCancel,onCreateFlowCompletion:this.handleCreateFlowCompletion,onCreateFlowError:this.handleCreateFlowError,onContentFirstRendered:this.handleRendered,onLoadTemplateError:this.handleLoadTemplateError,onDone:this.handleCreateFlowDoneClicked,templateName:e.templateId,dismiss:this.onClose,surfaceType:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.getFullPageSurfaceType(),hasCloseButton:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.hasCloseButtonOnFullPageSurface()};this.dismissSurfaces(),this.flowCreatorSurfaceKey=Object(C.a)({surfaceStore:v.a,flowCreatorProps:i}).key},this.dismissSurfaces=()=>{this.dismissInvokeFlowSurface(),this.dismissFlowCreatorSurface()},this.dismissInvokeFlowSurface=()=>{this.invokeFlowSurfaceKey&&v.a.dismissSurface(this.invokeFlowSurfaceKey)},this.dismissFlowCreatorSurface=()=>{this.flowCreatorSurfaceKey&&v.a.dismissSurface(this.flowCreatorSurfaceKey)},this.environmentSafeHostCommunicationServiceCallback=e=>{if(this.isEnvironmentNameAvailable)return e;var t=new r.b(n.c.runFlowWidgetNotReady,"Widget not ready. Wait for WIDGET_READY event");return this.loggingService.logError("InvokeFlowWidgetV2Ctrl.environmentSafeHostCommunicationServiceCallback",t),Promise.reject(t)},this.handleCancel=()=>{this.hostCommunicationService.triggerHostEvent(d.e.RUN_FLOW_CANCEL_BUTTON_CLICKED),this.hostCommunicationService.triggerHostEvent(d.e.WIDGET_CLOSE),this.invokeFlowReject&&this.invokeFlowReject({code:n.c.runFlowWidgetCancelled,message:"Invoking the flow run was cancelled"}),this.invokeFlowByTemplateReject&&this.invokeFlowByTemplateReject({code:n.c.runFlowWidgetCancelled,message:"Creating the flow was cancelled"})},this.handleRunFlowDoneClicked=()=>{this.loggingService.logInfo(a.a.invokeFlowWidgetDoneButtonClicked,"InvokeFlow Done button clicked"),this.hostCommunicationService.triggerHostEvent(d.e.RUN_FLOW_DONE_BUTTON_CLICKED)},this.handleCreateFlowDoneClicked=e=>{this.loggingService.logInfo(a.a.invokeFlowWidgetCreateFlowDoneButtonClicked,"FlowCreation Done button clicked"),this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.fireFlowCreationDoneClicked(e.name)},this.handleRendered=()=>{this.triggerFlowEventCorrelationId&&(this.loggingService.profileEndWithSuccess(this.triggerFlowEventCorrelationId,a.a.invokeFlowWidgetTriggerFlowRendered),this.triggerFlowEventCorrelationId=void 0),this.hostCommunicationService.triggerHostEvent(d.e.WIDGET_RENDERED)},this.handleFlowRunRequestCompletion=(e,t)=>{var i=this.environmentService.getCurrentEnvironmentName();this.loggingService.logInfo(a.a.invokeFlowWidgetTriggerFlowEnd,"TriggerFlow completed"),this.invokeFlowResolve&&this.invokeFlowResolve({data:"TriggerFlowCompleted"}),this.invokeFlowByTemplateResolve&&this.invokeFlowByTemplateResolve({data:"TriggerFlowCompleted"});var r=Object(h.c)(e),n={flowName:r,flowRunUrl:Object(w.p)(this.routeCrafter,{flowName:r,isLegacyShared:!1,solutionId:void 0,isUIFlow:!1,filter:"succeeded"}),flowRunId:t};this.hostCommunicationService.triggerHostEvent(d.e.RUN_FLOW_COMPLETED,n),this.flowService.eventEmitter.emit(f.b.refreshFlowRuns,{flowName:r}),this.flowRunsService.getFlowRuns({environmentName:i,flowName:r,status:g.a.all,forceRefresh:!0})},this.handleFlowRunRequestStart=()=>{this.hostCommunicationService.triggerHostEvent(d.e.RUN_FLOW_STARTED)},this.handleFlowRunRequestError=e=>{this.loggingService.logError(a.a.invokeFlowWidgetTriggerFlowError,e),this.showFullPageError({error:e,friendlyErrorText:this.clientResources.Common.SomethingWentWrong}),this.invokeFlowReject({code:n.c.runFlowWidgetError,message:Object(s.e)(e,this.clientResources.Common.SomethingWentWrong)})},this.handleCreateFlowCompletion=e=>{if(this.hostCommunicationService.triggerHostEvent(d.e.FLOW_CREATION_SUCCEEDED,{flowUrl:Object(p.b)(e,this.environmentService),flowId:e,flowName:e}),this.widgetUtilService.isWidgetPage()&&!this.widgetUtilService.widgetCloseOnFlowSaveEnabled()&&!this.widgetUtilService.shouldWaitAfterSavingFlow()){this.flowName=e;var t=this.widgetUtilService.getLicenseContext();this.showInvokeFlowSurface(this.implicitData,t)}},this.handleCreateFlowError=e=>{this.hostCommunicationService.triggerHostEvent(d.e.FLOW_CREATION_FAILED,{error:e}),this.invokeFlowByTemplateReject&&this.invokeFlowByTemplateReject(e)},this.handleLoadTemplateError=e=>{this.hostCommunicationService.triggerHostEvent(d.e.TEMPLATE_LOAD_FAILED,{error:e}),this.invokeFlowByTemplateReject&&this.invokeFlowByTemplateReject(e)},this.fullPageErrorModel={image:this.assetService.fullPageErrorGeneric,isPageErrored:!1,pageTitle:this.appSettings.brandName,customButtons:[]};var F=this.loggingService.profilePageStart(a.a.invokeFlowWidgetLoadStart,{isMini:this.isMiniWidget});Promise.all([this.sessionService.getUserSessionAsync(),this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetOptionsAvailabilityPromise,this.policiesService.shouldBlockWidgetUsage()]).then(e=>{var[t,i,r]=e;if(this.shouldBlockWidgetUsage=r,r){this.fullPageErrorModel.customButtons=[{buttonText:Object(u.d)(this.clientResources.Common.VisitFlowPortal,this.appSettings.brandName),url:Object(y.a)()}];var n=this.sessionService.isGuestUser()?Object(u.d)(this.clientResources.FullPageError.FriendlyError.Subtext.GuestUserNoPlans,this.appSettings.brandName):Object(u.d)(this.clientResources.FullPageError.FriendlyError.Subtext.RedirectToMSA,this.appSettings.brandName);this.showFullPageError({friendlyErrorText:this.clientResources.FullPageError.FriendlyError.Text.ThatDidntWork,friendlyErrorSubtext:n}),this.handleRendered()}this.loggingService.profilePageEnd(F,a.a.invokeFlowWidgetLoadEnd,{status:s.a.Success,isMini:this.isMiniWidget})}).catch(e=>{F?this.loggingService.profilePageEnd(F,a.a.invokeFlowWidgetLoadEnd,{status:Object(s.b)(e),error:Object(s.e)(e),isMini:this.isMiniWidget}):this.loggingService.logError(n.c.runFlowWidgetFailedToLoad,e),this.showFullPageError({error:e,friendlyErrorText:this.clientResources.Common.SomethingWentWrong})}),this.hostCommunicationService.onTriggerFlow(e=>this.environmentSafeHostCommunicationServiceCallback(this.handleTriggerFlow(e))),this.hostCommunicationService.onTriggerFlowByTemplate(e=>this.environmentSafeHostCommunicationServiceCallback(this.handleTriggerFlowByTemplate(e))),this.hostCommunicationService.onGetTriggerSchema(e=>this.environmentSafeHostCommunicationServiceCallback(this.handleGetTriggerSchema(e))),this.hostCommunicationService.onCloseWidget(()=>{this.onClose()})}var t,i,c,P;return t=e,(i=[{key:"isEnvironmentNameAvailable",get:function(){return!Object(u.p)(this.environmentService.getCurrentEnvironmentName())}},{key:"isMiniWidget",get:function(){return this.widgetUtilService.isMiniWidget()}},{key:"showInvokeFlowSurface",value:function(e,t){if(!this.shouldBlockWidgetUsage){this.fullPageErrorModel.isPageErrored=!1;var i={autoConsentUser:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.allowBackgroundConsent(),isTestRun:!1,entityData:e,flowName:this.flowName,surfaceType:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.getFullPageSurfaceType(),onCancel:this.handleCancel,onContentFirstRendered:this.handleRendered,onFlowRunRequestComplete:this.handleFlowRunRequestCompletion,onFlowRunRequestError:this.handleFlowRunRequestError,onFlowRunRequestStart:this.handleFlowRunRequestStart,dismiss:this.onClose,onDone:this.handleRunFlowDoneClicked,hasCloseButton:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.hasCloseButtonOnFullPageSurface(),licenseContext:t};this.dismissSurfaces(),this.invokeFlowSurfaceKey=Object(m.a)(v.a,i).key}}},{key:"showTemplateWidgetAndHideError",value:function(e){this.shouldBlockWidgetUsage||(this.fullPageErrorModel.isPageErrored=!1,this.dismissSurfaces(),this.showFlowCreatorSurface(e))}},{key:"showFullPageError",value:function(e){var{error:t,friendlyErrorText:i,friendlyErrorSubtext:r}=e;this.dismissSurfaces(),this.$timeout(()=>{Object(l.b)(this.fullPageErrorModel,t,i,r)})}},{key:"handleError",value:function(e){var{profileEventCorrelationId:t,eventName:i,error:r}=e;this.showFullPageError({error:r,friendlyErrorText:this.clientResources.Common.SomethingWentWrong}),this.loggingService.profileEnd(t,i,Object(s.b)(r),r)}},{key:"handleTriggerFlow",value:(P=x((function*(e){var t=this;return new Promise(function(){var i=x((function*(i,r){t.invokeFlowResolve=i,t.invokeFlowReject=r,t.triggerFlowEventCorrelationId=t.loggingService.profileStart(a.a.invokeFlowWidgetTriggerFlowStart),t.flowName=e&&e.flowName;var s=t.widgetUtilService.isWidgetPage()&&t.widgetUtilService.getFlowNameFromWidgetOptions();if(s&&(t.flowName=s),!t.flowName){var l=new o.a(n.c.runFlowWidgetInvalidTriggerFlowParams,Object(u.d)(t.clientResources.Widget.Common.Error.RequiredParameterMissing,"flowName"));return t.handleError({profileEventCorrelationId:t.triggerFlowEventCorrelationId,eventName:a.a.invokeFlowWidgetTriggerFlowError,error:l}),void t.invokeFlowReject(l)}var c=e&&e.implicitData;if(!c){var d=t.widgetUtilService.isWidgetPage()&&t.widgetUtilService.getImplicitDataFromWidgetOptions();if(d)try{c=JSON.parse(d)}catch(l){t.loggingService.logError(n.c.failureParsingImplicitData,l)}}if(c&&!Array.isArray(c)){var p=new o.a(n.c.runFlowWidgetInvalidImplicitDataType,t.clientResources.Widget.RuntimeFlow.Error.ImplicitDataShouldBeArray);return t.handleError({profileEventCorrelationId:t.triggerFlowEventCorrelationId,eventName:a.a.invokeFlowWidgetTriggerFlowError,error:p}),void t.invokeFlowReject(p)}var h=Object(S.a)()&&t.widgetUtilService.isWidgetPage()?t.widgetUtilService.getLicenseContext():void 0;t.showInvokeFlowSurface(c,h)}));return function(e,t){return i.apply(this,arguments)}}())})),function(e){return P.apply(this,arguments)})},{key:"handleTriggerFlowByTemplate",value:function(e){return new Promise((t,i)=>{if(this.invokeFlowByTemplateResolve=t,this.invokeFlowByTemplateReject=i,this.triggerFlowEventCorrelationId=this.loggingService.profileStart(a.a.invokeFlowWidgetTriggerFlowStart),!e||!e.templateId){var r=new o.a(n.c.runFlowWidgetInvalidTriggerFlowParams,Object(u.d)(this.clientResources.Widget.Common.Error.RequiredParameterMissing,"templateId"));return this.handleError({profileEventCorrelationId:this.triggerFlowEventCorrelationId,eventName:a.a.invokeFlowWidgetTriggerFlowError,error:r}),void this.invokeFlowByTemplateReject(r)}if(this.implicitData=e&&e.implicitData,this.implicitData&&!Array.isArray(this.implicitData)){var s=new o.a(n.c.runFlowWidgetInvalidImplicitDataType,this.clientResources.Widget.RuntimeFlow.Error.ImplicitDataShouldBeArray);return this.handleError({profileEventCorrelationId:this.triggerFlowEventCorrelationId,eventName:a.a.invokeFlowWidgetTriggerFlowError,error:s}),void this.invokeFlowByTemplateReject(s)}this.showTemplateWidgetAndHideError(e)})}},{key:"handleGetTriggerSchema",value:function(e){return new Promise((t,i)=>{this.getTriggerSchemaReject=i;var l=this.loggingService.profileStart(a.a.invokeFlowWidgetGetTriggerSchemaStart);if(!e||!e.flowName){var c=new o.a(n.c.runFlowWidgetInvalidTriggerSchemaParams,Object(u.d)(this.clientResources.Widget.Common.Error.RequiredParameterMissing,"flowName"));return this.handleError({profileEventCorrelationId:l,eventName:a.a.invokeFlowWidgetGetTriggerSchemaError,error:c}),void this.getTriggerSchemaReject(c)}this.flowService.loadFlow(e.flowName,!0).then(()=>{var i=b.a.flows.getEntity(e.flowName).entitySchema;if(i)return this.loggingService.profileEndWithSuccess(l,a.a.invokeFlowWidgetGetTriggerSchemaEnd),t({data:i}),Promise.resolve();var o=new r.a(n.c.runFlowWidgetInvalidTriggerSchema,this.clientResources.Widget.RuntimeFlow.Error.TriggerSchemaCannotBeParsed);return this.handleError({profileEventCorrelationId:l,eventName:a.a.invokeFlowWidgetGetTriggerSchemaError,error:o}),Promise.reject(o)}).catch(e=>{var t=new r.a(n.c.runFlowWidgetFlowNotFound,Object(s.e)(e,this.clientResources.Common.SomethingWentWrong),e);this.handleError({profileEventCorrelationId:l,eventName:a.a.invokeFlowWidgetGetTriggerSchemaError,error:t}),this.getTriggerSchemaReject(t)})})}}])&&A(t.prototype,i),c&&A(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}();R.$inject=[c.a.services.$routeParams,c.a.services.$timeout,c.a.services.appSettings,c.a.services.assetService,c.a.services.clientResources,c.a.services.designerCoreLoader,c.a.services.environment,c.a.services.flow,c.a.services.flowrunsService,c.a.services.hostCommunicationService,c.a.services.logging,c.a.services.policies,c.a.services.routeCrafter,c.a.services.session,c.a.services.widgetUtilService,c.a.services.designerCoreLoader,c.a.services.licenseManagement]},33426:function(e,t,i){e.exports=i.p+"static/media/invokeFlowWidgetV2.e3fee6d7.less"},33427:function(e,t){e.exports='<div class="invoke-flow-widget-v2">\n    <full-page-error model="invokeFlowWidgetV2Ctrl.fullPageErrorModel" ng-if="invokeFlowWidgetV2Ctrl.fullPageErrorModel.isPageErrored"></full-page-error>\n</div>'},33428:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33429),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33432);var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33433),this.controllerAs="flowAnalytics",this.resolve={setPageTitle:[n.a.services.$document,n.a.services.appSettings,n.a.services.clientResources,function(e,t,i){e[0].title=Object(a.a)(i.PageTitle.FlowAnalytics,t.brandName)}]}}));r.a.component(n.a.components.flowAnalytics,new u)},33429:function(e,t,i){"use strict";i.d(t,"a",(function(){return A}));var r=i(33327),n=i(33360),o=i(33354),a=i(33396),s=i(33383),l=i(33353),c=i(33392),u=i(33430),d=i(28985),p=i(16927),h=i(13016),m=i(33420),g=i(14900),f=i(33384),v=i(17210),b=i(14839),y=i(14918),w=i(33306),S=i(33431);function C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function k(e,t,i){return(t=x(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function P(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var A=function(){function e(t,i,r,o,u,p,m,f,v,b,y,w,S,C){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$routeParams=i,this.$scope=r,this.appSettings=o,this.clientResources=u,this.environmentService=p,this.flowAnalyticsService=m,this.flowsClient=f,this.loggingService=v,this.navigationService=b,this.powerbiClientService=y,this.datetimeService=w,this.routeCrafter=S,this.xrmService=C,this.messageBarType=h.c,this.flowName=void 0,this.solutionId=void 0,this.flowId=void 0,this.activeDashboard=void 0,this.analyticsSpinner={size:s.c.Large,local:s.a.Local},this.headingSpinner={size:s.c.Small,local:s.a.LocalHorizontal},this.errorAlert={type:l.a.None,message:"",options:{}},this.warningMessage=void 0,this.learnMoreLink=void 0,this.dataDurationText=void 0,this.dialogMessage=void 0,this.allowShowSharedFlows=void 0,this.flowDisplayName=void 0,this.flowDisplayTitle=void 0,this.flow=void 0,this.creatorId=void 0,this.backButton=void 0,this.backUrl=void 0,this.headingAnalytics=void 0,this.spinner=void 0,this.showIframe=!1,this.aggregationValue=30,this.aggregationType="Daily",this.embedUrl=void 0,this.accessToken=void 0,this.reportName=void 0,this.dateRange=void 0,this.refreshDate=void 0,this.flowAnalyticsPageCorrelationId=void 0,this.powerbi=void 0,this.powerbiReport=void 0,this.currentReport=void 0,this.filterOptions=void 0,this.selectedFilterOption=void 0,this.listDays=void 0,this.reports=void 0,this.setupFilterListMenu=()=>{this.filterOptions=[],this.listDays=[30,14,7],this.listDays.forEach(e=>{this.filterOptions.push({text:Object(n.d)(this.clientResources.Manage.Flow.Analytics.Heading.Filter.Text,e),value:e})}),this.selectedFilterOption=this.filterOptions[0]},this.flowName=i.flowName||null,this.flowName||this.navigationService.navigate("/"),this.flowId=Object(a.b)(this.flowName,this.environmentService),this.getFlowDetails();var k=new URLSearchParams(i),P=Object(d.b)(k)||Object(g.m)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:!1});if(this.backButton={url:P},this.solutionId=i.solutionId||null,this.environmentService.getCurrentEnvironment().hasXrmInstance){var x="workflows?$filter=workflowid+eq+'".concat(this.flowName,"'&$select=resourceid");this.xrmService.makeXrmCall(0,x).then(e=>{var t;this.flowName=(null==e||null===(t=e.data)||void 0===t||null===(t=t.value[0])||void 0===t?void 0:t.resourceid)||this.flowName,this.onInit()}).catch(e=>{var t=Object(c.e)(e,this.clientResources.Common.SomethingWentWrong);this.errorAlert.message=t,this.loggingService.logError("FlowAnalyticsCtrl.solutionFlow",e),this.onInit()})}else this.onInit()}var t,i,r;return t=e,(i=[{key:"onInit",value:function(){this.flowAnalyticsPageCorrelationId=this.loggingService.profilePageStart(o.a.flowAnalyticsPageLoadStart,{flowName:this.flowName}),this.setupFilterListMenu(),this.loadPage(()=>this.loggingService.profileEndWithSuccess(this.flowAnalyticsPageCorrelationId,o.a.flowAnalyticsPageLoadEnd),e=>{this.loggingService.profileEnd(this.flowAnalyticsPageCorrelationId,o.a.flowAnalyticsPageLoadEnd,Object(c.b)(e),e)})}},{key:"loadPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{};this.analyticsSpinner.show=!0,this.headingSpinner.show=!0;var i=this.$q.defer();this.powerbiClientService.getPowerbiClient().then(e=>{this.powerbi=new e.service.Service(e.factories.hpmFactory,e.factories.wpmpFactory,e.factories.routerFactory),this.powerbiReport=e.Report}).catch(e=>{this.errorAlert.type=l.a.Error,this.errorAlert.message=Object(c.e)(e)}).then(e=>Object(S.a)()?this.flowAnalyticsService.getDashboardsV2(this.environmentService.getCurrentEnvironment().location):this.flowAnalyticsService.getDashboards()).then(t=>{var r,o;this.headingSpinner.show=!1,t.length>0&&(this.reports=this.appSettings.featureFlags.enableFlowActionsAnalytics?t:t.filter(e=>!Object(w.equalsIgnoreCase)(e.name,"actions")),this.activeDashboard=null!==(r=null===(o=this.currentReport)||void 0===o?void 0:o.name)&&void 0!==r?r:this.reports[0].name,this.changeSelectedReportTo(this.reports.find(e=>e.name===this.activeDashboard),i),this.headingAnalytics={durationText:Object(n.d)(this.clientResources.Manage.Flow.Analytics.Heading.Duration.Text,this.aggregationValue),reports:this.reports,changeSelectedReport:e=>{var t=this.$q.defer();this.changeSelectedReportTo(e,t)}}),e()}).catch(e=>{i.reject(e),this.headingSpinner.show=!1,this.analyticsSpinner.show=!1,this.errorAlert.type=l.a.Error;var r=Object(c.e)(e);this.errorAlert.message=r,t(e)})}},{key:"changeSelectedReportTo",value:function(e,t){var i,r={flow:this.flowName,reportName:e.name},n=this.loggingService.profileStart(o.a.flowAnalyticsReportLoadStart);if(this.activeDashboard=e.name,this.currentReport=e,this.analyticsSpinner.show=!0,this.aggregationValue=this.selectedFilterOption.value,Object(S.a)()){var a=this.environmentService.getCurrentEnvironment();i=this.flowAnalyticsService.getEmbeddedReportLinkV2(this.flowName,e.name,this.aggregationValue,a.name,a.location)}else i=this.flowAnalyticsService.getEmbeddedReportLink(this.flowName,e.name,this.aggregationValue,this.aggregationType);i.then(e=>{this.embedUrl=e.embedUrl,this.accessToken=e.accessToken,this.loadReport(t),this.analyticsSpinner.show=!1,this.loggingService.profileEndWithSuccess(n,o.a.flowAnalyticsReportLoadEnd,r)}).catch(e=>{t.reject(e),this.analyticsSpinner.show=!1,this.errorAlert.type=l.a.Error;var i=Object(c.e)(e);this.errorAlert.message=i;var n=Object(c.d)(e),a=Object(f.a)(i),s=new Error("errorMessage: '".concat(a,"', errorCode: '").concat(n,"'."));this.loggingService.profileEnd(this.flowAnalyticsPageCorrelationId,o.a.flowAnalyticsReportLoadEnd,Object(c.b)(e),s,r)})}},{key:"loadReport",value:function(e){var t={type:"report",tokenType:u.TokenType.Embed,accessToken:this.accessToken,embedUrl:this.embedUrl,id:"",settings:{filterPaneEnabled:!1,navContentPaneEnabled:!1}},i={flow:this.flowName,report:this.currentReport.name},r=this.loggingService.profileStart(o.a.flowAnalyticsLoadReportStart),n=document.querySelector(".section-flow-analytics .row .column .analytics-report");this.powerbiReport=0===n.childElementCount?this.powerbi.embed(n,t):this.powerbi.embedNew(n,t),this.powerbiReport.on("loaded",e=>{this.loggingService.profileEndWithSuccess(r,o.a.flowAnalyticsLoadReportEnd,i)}),this.powerbiReport.on("error",e=>{this.errorAlert.message=e.detail,this.loggingService.logError(o.a.flowAnalyticsLoadReportEnd,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?C(Object(i),!0).forEach((function(t){k(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({powerBiError:e.detail},i)),this.loggingService.profileEnd(r,o.a.flowAnalyticsLoadReportEnd,Object(c.b)(e),e,i)}),e.resolve()}},{key:"getFlowDetails",value:function(){var e={flow:this.flowId},t=this.loggingService.profileStart(o.a.flowAnalyticsGetFlowDetailsStart),i=this.flowsClient.get(this.$scope,{id:this.flowId});i.$promise.then(()=>{this.flowDisplayName=i&&i.properties&&i.properties.displayName||"",this.flowDisplayTitle=Object(n.d)(this.clientResources.Analytics.Header.Title,this.flowDisplayName),this.getFlowThrottlingMessage(i),this.loggingService.profileEndWithSuccess(t,o.a.flowAnalyticsGetFlowDetailsEnd,e)}).catch(i=>{var r=Object(c.e)(i,this.clientResources.Common.SomethingWentWrong);this.errorAlert.message=r,this.loggingService.logError("FlowAnalyticsCtrl.getFlowDetails",i),this.loggingService.profileEnd(t,o.a.flowAnalyticsGetFlowDetailsEnd,Object(c.b)(i),i,e)})}},{key:"getFlowThrottlingMessage",value:function(e){var t={flow:e.name},i=this.loggingService.profileStart(o.a.flowAnalyticsGetFlowThrottlingMessageStart),r=Object(v.f)(e),a=Object(v.g)(e),s=Object(v.b)(e),l=Object(v.a)(e),c=Object(b.d)(e)&&Object(b.o)(e),u=Object(b.d)(e)&&Object(b.p)(e);if(c){var d=Object(p.a)(e.properties.flowSuspensionTime);this.warningMessage=Object(n.d)(this.clientResources.Manage.Flow.Analytics.SlowPerformanceSuspension.Message,this.datetimeService.getSimpleDateTimeString(d),this.datetimeService.getFriendlyTimeSinceString(m.a,d)),this.learnMoreLink={href:this.clientResources.FlowsRuns.PowerAutomateRateLimits.Link,ariaLabel:this.clientResources.Common.LearnMore}}else if(u){var h=Object(p.a)(e.properties.flowSuspensionTime);this.warningMessage=Object(n.d)(this.clientResources.Manage.Flow.Analytics.SlowPerformanceSuspension.ConsumedContent.Message,this.datetimeService.getSimpleDateTimeString(h),this.datetimeService.getFriendlyTimeSinceString(m.a,h)),this.learnMoreLink={href:this.clientResources.FlowsRuns.PowerAutomateRateLimits.Link,ariaLabel:this.clientResources.Common.LearnMore}}else if(r){var g=e.properties.throttlingData.apiCalls&&e.properties.throttlingData.apiCalls.throttleStartTime&&Object(p.a)(e.properties.throttlingData.apiCalls.throttleStartTime);this.warningMessage=g?Object(n.d)(this.clientResources.Manage.Flow.Analytics.SlowPerformance.Message,Object(y.I)(g),this.datetimeService.getFriendlyTimeSinceString(m.a,g)):this.clientResources.Manage.Flow.Analytics.SlowPerformance.Fallback,this.learnMoreLink={href:this.clientResources.FlowsRuns.PowerAutomateRateLimits.Link,ariaLabel:this.clientResources.Common.LearnMore}}else if(a){var f=e.properties.throttlingData&&e.properties.throttlingData.completedContent&&e.properties.throttlingData.completedContent.throttleStartTime&&Object(p.a)(e.properties.throttlingData.completedContent.throttleStartTime);this.warningMessage=f?Object(n.d)(this.clientResources.Manage.Flow.Analytics.SlowPerformance.CompletedContent.Message,this.datetimeService.getSimpleDateTimeString(f),this.datetimeService.getFriendlyTimeSinceString(m.a,f)):this.clientResources.Manage.Flow.Analytics.SlowPerformance.Fallback,this.learnMoreLink={href:this.clientResources.FlowsRuns.PowerAutomateRateLimits.Link,ariaLabel:this.clientResources.Common.LearnMore}}else if(s){var w=e.properties.throttlingData&&e.properties.throttlingData.completedContent&&e.properties.throttlingData.completedContent.throttleStartTime&&Object(p.a)(e.properties.throttlingData.completedContent.throttleStartTime),S=e.properties.throttlingData&&e.properties.throttlingData.completedContent&&e.properties.throttlingData.completedContent.lastThrottleTime&&Object(p.a)(e.properties.throttlingData.completedContent.lastThrottleTime);this.warningMessage=w&&S?Object(n.d)(this.clientResources.SlowPerformance.Ended.WarningMessage,this.datetimeService.getSimpleDateTimeString(w),this.datetimeService.getSimpleDateTimeString(S)):this.clientResources.Manage.Flow.Analytics.SlowPerformance.Fallback,this.learnMoreLink={href:this.clientResources.FlowsRuns.PowerAutomateRateLimits.Link,ariaLabel:this.clientResources.Common.LearnMore}}else if(l){var C=e.properties.throttlingData.apiCalls&&e.properties.throttlingData.apiCalls.throttleStartTime&&Object(p.a)(e.properties.throttlingData.apiCalls.throttleStartTime),k=e.properties.throttlingData.apiCalls&&e.properties.throttlingData.apiCalls.lastThrottleTime&&Object(p.a)(e.properties.throttlingData.apiCalls.lastThrottleTime);this.warningMessage=C&&k?Object(n.d)(this.clientResources.SlowPerformance.Ended.WarningMessage,this.datetimeService.getSimpleDateTimeString(C),this.datetimeService.getSimpleDateTimeString(k)):this.clientResources.Manage.Flow.Analytics.SlowPerformance.Fallback,this.learnMoreLink={href:this.clientResources.FlowsRuns.PowerAutomateRateLimits.Link,ariaLabel:this.clientResources.Common.LearnMore}}this.loggingService.profileEndWithSuccess(i,o.a.flowAnalyticsGetFlowThrottlingMessageEnd,t)}},{key:"changeReportDuration",value:function(e){var t={flow:this.flowId},i=this.loggingService.profileStart(o.a.flowAnalyticsChangeReportDurationStart);this.aggregationValue=e,this.loadPage(()=>this.loggingService.profileEndWithSuccess(i,o.a.flowAnalyticsChangeReportDurationEnd,t),e=>{this.errorAlert.type=l.a.Error,this.errorAlert.message=Object(c.e)(e),this.loggingService.profileEnd(i,o.a.flowAnalyticsChangeReportDurationEnd,Object(c.b)(e),e,t)})}}])&&P(t.prototype,i),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();A.$inject=[r.a.services.$q,r.a.services.$routeParams,r.a.services.$scope,r.a.services.appSettings,r.a.services.clientResources,r.a.services.environment,r.a.services.flowAnalyticsService,r.a.services.flowsClient,r.a.services.logging,r.a.services.navigation,r.a.services.powerbiClientService,r.a.services.dateTime,r.a.services.routeCrafter,r.a.services.xrmService]},33431:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.PowerAutomateClientTeam,owners:["flowmoney"],description:"Whether or not to use the new Admin Analytics endpoint",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1271936",createdOn:"06/11/2024",fallback:{enableAdminAnalyticsEndpoint:!1}}),{getFeatureValue:a}=Object(n.b)(o,"enableAdminAnalyticsEndpoint")},33432:function(e,t,i){e.exports=i.p+"static/media/flowAnalytics.9d951042.less"},33433:function(e,t){e.exports='<section class="subsection-manage section-manage-flow-analytics">\n    <heading\n        label="flowAnalytics.flowDisplayTitle"\n        back="flowAnalytics.backButton">\n        <heading-template>\n            <spinner model="flowAnalytics.headingSpinner" ng-if="flowAnalytics.headingSpinner.show"></spinner>\n        </heading-template>\n    </heading>\n    <div class="section-flow-analytics">\n        <div class="flowAnalytics-messageBarWrapper" ng-if="flowAnalytics.warningMessage">\n                <react-text-message-bar-with-link\n                    type="flowAnalytics.messageBarType.warning"\n                    message="flowAnalytics.warningMessage"\n                    labelLink="flowAnalytics.learnMoreLink">\n                </react-text-message-bar-with-link>\n            </div>\n        <div class="row detail-ribbon">\n            <div class="column medium-6 small-8">\n                <div class="dashboard-tabs">\n                    <a ng-repeat="report in flowAnalytics.headingAnalytics.reports"\n                        role="tab"\n                        href\n                        aria-selected="{{flowAnalytics.activeDashboard.toUpperCase() === report.name.toUpperCase()}}"\n                        aria-label="{{report.name}}"\n                        tabindex="0"\n                        ng-class="{\'tab-active\': flowAnalytics.activeDashboard.toUpperCase() === report.name.toUpperCase()}"\n                        ng-onload="flowAnalytics.loadReport()"\n                        ng-click="flowAnalytics.headingAnalytics.changeSelectedReport(report)"> {{report.name[0].toLocaleUpperCase(flowAnalytics.appSettings.locale) + report.name.toLocaleLowerCase(flowAnalytics.appSettings.locale).slice(1)}} </a>\n                </div>\n            </div>\n            <div class="column medium-6 small-4" ng-if="flowAnalytics.headingAnalytics">\n                <div class="c-select duration-control">\n                    <select aria-label="{{::flowAnalytics.clientResources.Manage.Flow.Analytics.Filter.Label}}"\n                            ng-model="flowAnalytics.selectedFilterOption"\n                            ng-change="flowAnalytics.changeReportDuration(flowAnalytics.selectedFilterOption.value)"\n                            ng-options="item.text for item in flowAnalytics.filterOptions">\n                    </select>\n                </div>\n                <span class="label-filter">{{::flowAnalytics.clientResources.Manage.Flow.Analytics.Heading.Duration.Text}}</span>\n            </div>\n        </div>\n        <div class="analytics-info-pane">\n            <span>{{flowAnalytics.headingAnalytics.refreshText}}</span>\n        </div>\n        <div class="row">\n            <div class="column">\n                <div class="analytics-report"\n                     ng-show="!!flowAnalytics.embedUrl">\n                </div>\n            </div>\n            <spinner model="flowAnalytics.analyticsSpinner" ng-if="flowAnalytics.analyticsSpinner.show"></spinner>\n        </div>\n        <alert model="flowAnalytics.errorAlert"></alert>\n    </div>\n</section>'},33434:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33435),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33448);var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33449),this.controllerAs="flowOwners",this.resolve={setPageTitle:[n.a.services.$document,n.a.services.appSettings,n.a.services.clientResources,function(e,t,i){e[0].title=Object(a.a)(i.PageTitle.FlowOwners,t.brandName)}]}}));r.a.component(n.a.components.flowOwners,new u)},33435:function(e,t,i){"use strict";i.d(t,"c",(function(){return I})),i.d(t,"b",(function(){return j})),i.d(t,"a",(function(){return N}));var r=i(14751),n=i.n(r),o=i(33353),a=i(33436),s=i(33383),l=i(33354),c=i(33437),u=i(33392),d=i(33438),p=i(33327),h=i(33396),m=i(33439),g=i(18959),f=i(33360),v=i(12367),b=i(33394),y=i(17451),w=i(17282),S=i(16926),C=i(14867),k=i(33440),P=i(14900),x=i(14901),A=i(13016),T=i(17237),R=i(17239);function O(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,D(r.key),r)}}function D(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var E=function(e){return e[e.Sharepoint=0]="Sharepoint",e[e.Users=1]="Users",e}(E||{}),F=function(e){return e[e.loading=0]="loading",e[e.enabled=1]="enabled",e[e.disabled=2]="disabled",e[e.failed=3]="failed",e}(F||{});function I(e,t){return e.map(e=>{var i={id:e.id,alternativeId:e.alternativeId,iconUrl:e.iconUri||"",click:()=>{e.isNonRemovableOwner||t(i)},title:e.displayName,subTitle:e.email,disabled:e.isNonRemovableOwner,loading:!1,userPermission:null,type:Object(a.b)(e.type)};return i})}function j(e,t,i){return{id:w.a.getRoleKeyWithFlow(null!=e?e:"",t.id),name:Object(m.e)(t.type)?void 0:t.id,properties:{principal:{displayName:t.displayName,id:Object(m.e)(t.type)?t.id:void 0,xrmUniqueId:Object(m.e)(t.type)?t.id:void 0,aadObjectId:Object(m.e)(t.type)?void 0:t.id,type:Object(m.g)(t.type)?"user":"group",email:t.email,isDisabled:!1},permissionType:y.c.Principal},type:i}}var N=function(){function e(t,i,r,a,p,m,g,b,w,C,A,T,R,O,D,N,M,L,U,B,$,q,W,z,H,V,_,G,K){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$location=i,this.$routeParams=r,this.$scope=a,this.appSettings=p,this.assetService=m,this.clientResources=g,this.environmentService=b,this.flowsConnectionsClient=w,this.apisClient=C,this.flowPermissionsService=A,this.flowsClient=T,this.graphService=R,this.loggingService=O,this.navigationService=D,this.policiesService=N,this.promiseHelperService=M,this.routeCrafter=L,this.sessionService=U,this.sharePointPermissionService=B,this.telemetryService=$,this.trialDialog=q,this.widgetUtilService=W,this.modernFlowClient=z,this.flowRoleService=H,this.flowService=V,this.xrmEntityHttpClient=_,this.xrmRolesClient=G,this.environmentCapabilityService=K,this.FlowOwnersTileTab=E,this.connectionsRoute=void 0,this.flowName=void 0,this.flowId=void 0,this.contributors=[],this.connectionsInfoCards=[],this.usingConnectionsInfoCards=[],this.sharedConnections=[],this.isEntityFlow=void 0,this.connectionSpinner={size:s.c.Small,local:s.a.LocalHorizontal},this.coauthorSpinner={size:s.c.Small,local:s.a.LocalHorizontal},this.errorAlert={type:o.a.None,message:"",options:{}},this.sharepointCoauthors=void 0,this.deleteAction=void 0,this.deleteDialogShow=!1,this.deleteDialogPrimaryButton=void 0,this.deleteDialogSecondaryButton=void 0,this.dialogTitle=void 0,this.dialogMessage=void 0,this.coauthorToAdd=void 0,this.coauthWarningDialog=void 0,this.deletingContributor=void 0,this.allowShowSharedFlows=void 0,this.flowDisplayName="",this.flow=void 0,this.solutionId=void 0,this.backButton=void 0,this.headingLinks=void 0,this.backUrl=void 0,this.xrmConnectionReferenceModeStatus=F.loading,this.xrmConnectionReferences=void 0,this.connectionTitle=void 0,this.connectionDescription=void 0,this.ownerConnectionsTitle=void 0,this.ownerConnectionsSubtitle=void 0,this.ownerConnectionsManageConnectionText=void 0,this.otherConnectionsTitle=void 0,this.otherConnectionsSubtitle=void 0,this.currentTab=E.Users,this.selectedSharepointListIdentifier=void 0,this.enableAddSharepointListButton=!1,this.textMessageBarMessage=void 0,this.textMessageBarLink=void 0,this.linksWithInterpolationProps=void 0,this.showErrorMessageBar=void 0,this.showTabs=!1,this.fetchAndWatchFlowConnections=()=>{this.connectionSpinner.show=!0;var e=this.loggingService.profileStart(l.a.flowConnectionsLoadStart,{flowName:this.flowName}),t=this.flowsConnectionsClient.query(this.$scope,{flowName:this.flowName}),i=this.apisClient.query(this.$scope);return this.$q.all([t.$promise,i.$promise,this.getXRMConnectionReferences()]).then(()=>{this.loggingService.profileEndWithSuccess(e,l.a.flowConnectionsLoadEnd,{flowName:this.flowName});var r=this.flow?n()(this.flow.properties.connectionReferences):{};t.forEach(e=>{var t=Object.keys(r||{}).findIndex(t=>r[t].connectionName===e.name);if(t>-1){var n=Object.keys(r)[t],o=r[n],a=this.xrmConnectionReferences&&this.xrmConnectionReferences.find(e=>e.connectionreferencelogicalname===o.connectionReferenceLogicalName);this.usingConnectionsInfoCards.push(this.toUsingConnectionInfoCard(e,o,a))}else{var s=this.xrmConnectionReferences&&this.xrmConnectionReferences.find(t=>t.connectionid===e.name);this.connectionsInfoCards.push(this.toConnectionInfoCard(e,i.find(t=>t.id===e.properties.apiId),s))}})}).catch(t=>{this.errorAlert.type=o.a.Error,this.errorAlert.message=Object(u.e)(t,this.clientResources.Common.SomethingWentWrong),this.loggingService.profileEnd(e,l.a.flowConnectionsLoadEnd,Object(u.b)(t),t,{flowName:this.flowName})}).finally(()=>this.connectionSpinner.show=!1)},this.deleteConnection=(e,t,i)=>{var r=e.id;this.deleteDialogShow=!0,this.deletingContributor=e,this.dialogTitle=Object(f.d)(this.clientResources.Dialogs.ConfirmDelete.DeleteOwnerTitle,t.properties.displayName),this.dialogMessage=i?this.clientResources.Dialogs.ConfirmDelete.DeleteUsingConnectionMessage:this.clientResources.Dialogs.ConfirmDelete.DeleteConnectionMessage,this.deleteDialogPrimaryButton.disabled=!1,this.deleteDialogSecondaryButton.disabled=!1,this.deleteAction=()=>{this.deleteDialogPrimaryButton.disabled=!0,this.deleteDialogSecondaryButton.disabled=!0;var e=t.properties.apiId.split("/"),i=e.length>0?e[e.length-1]:"",n={id:Object(d.a)(this.flowName,i,t.name,this.environmentService)},o=this.loggingService.profileStart(l.a.ownersPageDeleteConnectionStart,n);this.flowsConnectionsClient.delete(n).then(()=>{this.loggingService.profileEndWithSuccess(o,l.a.ownersPageDeleteConnectionEnd,n),this.usingConnectionsInfoCards=this.usingConnectionsInfoCards.filter(e=>e.id!==r),this.connectionsInfoCards=this.connectionsInfoCards.filter(e=>e.id!==r),this.flowsConnectionsClient.refreshQuery()}).catch(e=>{this.loggingService.profileEnd(o,l.a.ownersPageDeleteConnectionEnd,Object(u.b)(e),e,n)}).finally(()=>this.deleteDialogShow=!1)}},this.onUserAutocompleteSelect=(e,t)=>{t.stopPropagation(),this.loggingService.logInfo("flowOwnersCtrl.onUserAutocompleteSelect","user selected an author",{usingConnectionsInfoCards:this.usingConnectionsInfoCards.length,coAuthorId:e&&e.id}),this.usingConnectionsInfoCards.length>0?(this.coauthorToAdd=e,this.coauthWarningDialog.show=!0):this.addCoauthor(e)},this.onDeleteCoauthor=e=>{var t=Object(k.b)(e),i=t.id;this.deleteDialogShow=!0,this.deletingContributor=e,this.dialogTitle=Object(f.d)(this.clientResources.Dialogs.ConfirmDelete.DeleteOwnerTitle,this.deletingContributor.title),this.dialogMessage=this.clientResources.Dialogs.ConfirmDelete.DeleteOwnerMessage,this.deleteDialogPrimaryButton.disabled=!1,this.deleteDialogSecondaryButton.disabled=!1;var r=this.graphService.getCachedThumbnailPhotos([i]);r.hasOwnProperty(i)?this.deletingContributor.iconUrl=r[i]:this.graphService.getThumbnailPhotos([i]).then(e=>{this.deletingContributor.iconUrl=e.hasOwnProperty(i)?e[i]:this.assetService.userPlaceholder}).catch(e=>{this.loggingService.logError("FlowOwnersCtrl.getThumbnailPhotos",e)}),this.deleteAction=()=>{var e;this.deleteDialogPrimaryButton.disabled=!0,this.deleteDialogSecondaryButton.disabled=!0,this.appSettings.featureFlags.enableShareSolutionFlowWithAADUsers&&this.flowRoleService.dvInstanceSupportsAutoJIT()&&Object(S.y)(this.flow)&&t.type!==y.b.SharepointList?(this.xrmRolesClient.clearFlowAccessCache(this.flow.properties.workflowEntityId),e=this.promiseHelperService.toAngularPromise(this.flowRoleService.syncFlowAccess(this.flow.properties.workflowEntityId,[j(this.flow.properties.workflowEntityId,t)]))):e=this.flowPermissionsService.removeFlowOwner(this.flow,t),e.then(()=>{if(this.flowService.onFlowOwnersUpdated({flowName:this.flow.name}),this.flowRoleService.loadFlowRoles({flowName:this.flow.name,flowRole:v.g.owners,forceRefresh:!0}),this.contributors=this.contributors.filter(e=>e.id!==i),this.sharePointPermissionService.filterOutPermission(i),this.getSharepointCoauthors(),i===this.sessionService.getUserInfo().uniqueId){var e,t=this.widgetUtilService.isWidgetPage()&&(null===(e=this.widgetUtilService.widgetInfo.flowsSettings)||void 0===e?void 0:e.encodedFlowsFilter)||void 0;this.flowsClient.refreshQuery(Object(h.c)({isPersonal:!1,isShared:!0,encodedFlowsFilter:t})),this.navigationService.navigate(Object(P.t)(this.routeCrafter))}}).catch(e=>{this.errorAlert.type=o.a.Error,this.errorAlert.message=Object(u.e)(e)}).finally(()=>this.deleteDialogShow=!1)}},this.onEditFlowClick=()=>{this.telemetryService.tagEvent(c.a.UpdateFlowStarted,{flowId:this.flow.id}),this.solutionId?this.navigationService.navigate(Object(P.g)(this.routeCrafter,{flowName:this.flow.name,solutionId:this.solutionId})):Object(S.s)(this.flow)||this.contributors.length>=2?this.navigationService.navigate(Object(P.f)(this.routeCrafter,{flowName:this.flow.name})):this.navigationService.navigate(Object(P.e)(this.routeCrafter,{flowName:this.flow.name}))},this.onDismissDialog=()=>{this.$scope.$applyAsync(()=>{this.deleteDialogShow=!1})},this.fetchAllCoauthors=()=>(this.coauthorSpinner.show=!0,this.$q.all([this.flowPermissionsService.getFlowOwners(this.flow,this.$scope),this.prepareSharepoint()]).then(e=>{var t,i=e[0];e[1]?(this.loggingService.logInfo("FlowOwnersCtrl.fetchAllCoauthors","Solution delegated auth enabled detected, attempting to filter out sharepoint teams",{workflowId:null==this||null===(t=this.flow)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.workflowEntityId}),this.contributors=I(i.owners.filter(e=>!Object(y.f)(e)),this.onDeleteCoauthor)):this.contributors=I(i.owners,this.onDeleteCoauthor);this.getSharepointCoauthors()}).then(()=>this.appSettings.featureFlags.enableShareSolutionFlowWithAADUsers&&Object(S.y)(this.flow)?this.promiseHelperService.toAngularPromise(this.flowRoleService.loadFlowRoles({flowName:this.flow.name,flowRole:v.g.owners})):this.$q.resolve()).catch(e=>{this.populateErrorAlertAndLog(e)}).finally(()=>{this.coauthorSpinner.show=!1})),this.populateErrorAlertAndLog=e=>{this.loggingService.logError("FlowOwners",e);var t=Object(u.e)(e);this.errorAlert.type=o.a.Error,this.errorAlert.message=t},this.onSelectSharepointSite=()=>{this.telemetryService.tagEvent(c.a.OwnersSharepointSiteSelected),this.sharePointPermissionService.updateSharepointListOptions(this.selectedSharepointListIdentifier.site)},this.onSelectSharepointList=()=>{this.telemetryService.tagEvent(c.a.OwnersSharepointListSelected),this.enableAddSharepointListButton=!!this.selectedSharepointListIdentifier.list},this.onAddSharepointPermission=()=>{this.telemetryService.tagEvent(c.a.OwnersAddSharepointPermissionClicked),this.prepareSharepoint().then(e=>{var t,i,r;e?(this.loggingService.logInfo("FlowOwnersCtrl.onAddSharepointPermission","Delegated auth enabled detected, attempting to add sharepoint permission",{workflowId:null==this||null===(t=this.flow)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.workflowEntityId,sharepointSite:null==this||null===(i=this.selectedSharepointListIdentifier)||void 0===i?void 0:i.site,sharepointList:null==this||null===(r=this.selectedSharepointListIdentifier)||void 0===r?void 0:r.list}),this.sharePointPermissionService.addPermission(this.flowName,this.selectedSharepointListIdentifier,this.onDeleteCoauthor,this.flow.properties.workflowEntityId).then(()=>{this.getSharepointCoauthors()}).catch(e=>{this.populateErrorAlertAndLog(e)})):this.sharePointPermissionService.addPermission(this.flowName,this.selectedSharepointListIdentifier,this.onDeleteCoauthor).then(()=>{this.getSharepointCoauthors()}).catch(e=>{this.populateErrorAlertAndLog(e)})})},this.onMessageBarDismiss=()=>{this.$scope.$applyAsync(()=>{this.telemetryService.tagEvent(c.a.TextMessageBarDismissed),this.linksWithInterpolationProps=null,this.textMessageBarLink=null,this.textMessageBarMessage=null,this.showErrorMessageBar=!1})},this.deleteDialogPrimaryButton={text:this.clientResources.Dialogs.ConfirmDelete.Button.DeleteOwner,disabled:!1,onClick:()=>{this.$scope.$applyAsync(()=>{this.deleteAction()})}},this.deleteDialogSecondaryButton={text:this.clientResources.Dialogs.ConfirmDelete.Button.Cancel,disabled:!1,onClick:()=>this.onDismissDialog()},this.coauthWarningDialog={show:!1,buttons:[{label:this.clientResources.Common.Ok,action:()=>{this.loggingService.logInfo("flowOwnersCtrl.coauthWarningDialog.ok","Add coauthor",{coAuthorId:this.coauthorToAdd&&this.coauthorToAdd.id}),this.addCoauthor(this.coauthorToAdd)},primary:!0},{label:this.clientResources.Common.Cancel,action:()=>{this.onDismissAddCoauthor()}}]},this.connectionsRoute=Object(x.d)(this.routeCrafter);var X=this.loggingService.profilePageStart(l.a.flowOwnersPageLoadStart);this.flowName=this.$routeParams.flowName||null,this.solutionId=this.$routeParams.solutionId||void 0,this.flowName||this.navigationService.navigate("/"),this.flowId=Object(h.b)(this.flowName,this.environmentService),this.coauthorSpinner.show=!0,this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()),this.fetchFlowAndCoauthoringData().then(()=>{this.prepareSharepoint()}).then(()=>this.promiseHelperService.toAngularPromise(this.policiesService.checkCanUserShareFlow(this.flow))).then(e=>(e||(this.environmentService.isDevEnvironment()?this.widgetUtilService.isWidgetPage()?this.navigateBackToFlowDetails():this.trialDialog.showFeatureBlockedOnDeveloperEnvironment(e=>{this.navigateBackToFlowDetails()}):this.trialDialog.showBlockedFeatureStartTrialDialog(e=>{this.allowShowSharedFlows=e,e?this.fetchFlowAndCoauthoringData().then(()=>{this.prepareSharepoint()}):this.navigateBackToFlowDetails()})),t.resolve())).finally(()=>{this.loggingService.profilePageEnd(X,l.a.flowOwnersPageLoadEnd)}),this.headingLinks=[{label:this.clientResources.Flow.Commands.Edit,action:()=>this.onEditFlowClick(),disabled:()=>""===this.flowDisplayName,svgId:"glyph-edit"}];var Q=this.$location.search();Q.backUrl&&(this.backUrl=decodeURIComponent(Q.backUrl)),this.linksWithInterpolationProps=null,this.textMessageBarLink=null}var t,i,r;return t=e,(i=[{key:"getConnectionsOrConnectionReferencesText",value:function(){return this.isXrmConnectionReferenceModeEnabled?this.clientResources.FlowOwners.ConnectionReferences.Text:this.clientResources.FlowOwners.Connections.Text}},{key:"getConnectionsOrConnectionReferencesTitleText",value:function(){return this.isXrmConnectionReferenceModeEnabled?this.clientResources.FlowOwners.ConnectionReferences.UpperCaseText:this.clientResources.FlowOwners.Connections.UpperCaseText}},{key:"updateConnectionSectionStrings",value:function(){var e=this.getConnectionsOrConnectionReferencesText(),t=this.getConnectionsOrConnectionReferencesTitleText();this.connectionTitle=Object(f.d)(this.clientResources.FlowOwners.Connections.GenericTitle,e),this.connectionDescription=Object(f.d)(this.clientResources.FlowOwners.Connections.GenericDescription,e),this.ownerConnectionsTitle=Object(f.d)(this.clientResources.FlowOwners.OwnerConnections.GenericTitle,t),this.ownerConnectionsSubtitle=Object(f.d)(this.clientResources.FlowOwners.OwnerConnections.GenericSubtitle,t),this.ownerConnectionsManageConnectionText=Object(f.d)(this.clientResources.FlowOwners.OwnerConnections.ManageConnectionsLink.GenericText,e),this.otherConnectionsTitle=Object(f.d)(this.clientResources.FlowOwners.OwnerConnections.OtherConnections.GenericTitle,e),this.otherConnectionsSubtitle=Object(f.d)(this.clientResources.FlowOwners.OwnerConnections.OtherConnections.GenericSubtitle,t,e)}},{key:"fetchFlowAndCoauthoringData",value:function(){var e={id:this.flowId},t=this.loggingService.profileStart(l.a.fetchFlowAndCoauthoringDataStart,e),i=this.flowsClient.get(this.$scope,e);return i.$promise.then(()=>{this.flow=i,this.isEntityFlow=!!this.flow.properties.workflowEntityId,this.flowDisplayName=this.flow&&this.flow.properties&&this.flow.properties.displayName||"";var e=Object(P.m)(this.routeCrafter,{flowName:this.flow.name,isLegacyShared:Object(S.s)(i),solutionId:this.solutionId});this.backButton={url:this.backUrl?this.backUrl:e}}).then(()=>{this.checkIsXrmConnectionReferenceMode(this.isEntityFlow).then(()=>{this.isManagedFlow(this.isEntityFlow)})}).then(()=>this.$q.all([this.fetchAllCoauthors(),this.fetchAndWatchFlowConnections()])).then(()=>{this.loggingService.profileEndWithSuccess(t,l.a.fetchFlowAndCoauthoringDataEnd,e)}).catch(i=>{this.loggingService.profileEnd(t,l.a.fetchFlowAndCoauthoringDataEnd,Object(u.b)(i),i,e),this.coauthorSpinner.show=!1})}},{key:"prepareSharepoint",value:function(){return this.promiseHelperService.toAngularPromise(Object(T.c)(this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,this.loggingService)).then(e=>(this.showTabs=this.sharePointPermissionService.shouldShowSharepointTabs(this.flow,e),this.$q.resolve(),this.promiseHelperService.toAngularPromise(Promise.resolve(e))))}},{key:"toUsingConnectionInfoCard",value:function(e,t,i){var r=t.apiDefinition&&t.apiDefinition.properties&&t.apiDefinition.properties.scopes&&t.apiDefinition.properties.scopes.will||[],n=e.properties.authenticatedUser&&e.properties.authenticatedUser.name||e.properties.displayName||e.properties.createdBy&&e.properties.createdBy.email||"",o=i&&i.connectionreferencedisplayname||t.displayName||e.properties.displayName,s={id:e.name,iconUrl:e.properties.iconUri,click:()=>{this.deleteConnection(s,e,!0)},title:n,subTitle:o,statusIcon:Object(g.g)(e)?this.assetService.statusSuccess:this.assetService.statusError,userPermission:null,ariaLabel:this.clientResources.FlowOwners.DeleteConnection.Delete,scopes:r,type:a.a.Connection};return s}},{key:"toConnectionInfoCard",value:function(e,t,i){var r=e.properties.createdBy&&e.properties.createdBy.email||"",n=i&&i.connectionreferencedisplayname||t&&t.properties&&t.properties.displayName||e.properties.displayName,o={id:e.name,iconUrl:e.properties.iconUri,click:()=>{this.deleteConnection(o,e,!1)},title:r,subTitle:n,userPermission:null,ariaLabel:this.clientResources.FlowOwners.DeleteConnection.Delete};return o}},{key:"addCoauthor",value:function(e){if(this.coauthWarningDialog.show=!1,this.coauthorToAdd=null,!(this.contributors.filter(t=>t.id===e.id).length>0)){var t,i,r,n,s={id:e.id,iconUrl:"",click:()=>this.onDeleteCoauthor(s),title:e.displayName,subTitle:e.mail,loading:!0,userPermission:null,type:Object(a.b)(e.type)};this.contributors.push(s),this.coauthorSpinner.show=!0,this.appSettings.featureFlags.enableShareSolutionFlowWithAADUsers&&this.flowRoleService.dvInstanceSupportsAutoJIT()&&Object(S.y)(this.flow)?(this.xrmRolesClient.clearFlowAccessCache(this.flow.properties.workflowEntityId),t=this.promiseHelperService.toAngularPromise(this.flowRoleService.syncFlowAccess(this.flow.properties.workflowEntityId,[(i=this.flow.properties.workflowEntityId,r=e,n=v.g.owners,{id:w.a.getRoleKeyWithFlow(null!=i?i:"",r.id),name:Object(m.e)(r.type)?void 0:r.id,properties:{principal:{displayName:r.displayName,id:Object(m.e)(r.type)?r.id:void 0,xrmUniqueId:Object(m.e)(r.type)?r.id:void 0,aadObjectId:Object(m.e)(r.type)?void 0:r.id,type:Object(m.g)(r.type)?"user":"group",email:r.mail,isDisabled:!1},permissionType:y.c.Principal},type:n})]))):t=this.flowPermissionsService.addFlowOwner(this.flow,function(e){return{id:e.id,displayName:e.displayName,isNonRemovableOwner:!1,email:e.mail,iconUri:"",accessLevel:m.a.NoAccess,type:e.type}}(e)),t.then(()=>{if(this.flowService.onFlowOwnersUpdated({flowName:this.flow.name}),this.flowRoleService.loadFlowRoles({flowName:this.flow.name,flowRole:v.g.owners,forceRefresh:!0}),this.contributors.forEach(t=>{t.id===e.id&&(t.loading=!1)}),2===this.contributors.length){var t,i=this.widgetUtilService.isWidgetPage()&&(null===(t=this.widgetUtilService.widgetInfo.flowsSettings)||void 0===t?void 0:t.encodedFlowsFilter)||void 0;this.flowsClient.refreshQuery(Object(h.c)({isPersonal:!1,isShared:!0,encodedFlowsFilter:i})),this.flowsClient.refreshQuery(Object(h.c)({isPersonal:!0,isShared:!1,encodedFlowsFilter:i})),Object(S.y)(this.flow)||(this.backButton.url=-1===this.backButton.url.indexOf("shared")?this.backButton.url.replace("/flows","/flows/shared"):this.backButton.url)}}).catch(t=>{if(this.contributors=this.contributors.filter(t=>t.id!==e.id),this.errorAlert.type=o.a.Error,this.errorAlert.message=Object(u.e)(t),this.appSettings.featureFlags.enableConnectionSharingDLPErrorParsing&&Object(S.y)(this.flow)){var i=Object(u.c)(this.errorAlert.message,this.clientResources);null!=i&&i.message&&(this.setMainMessageBar(i),this.errorAlert.message=null,this.errorAlert.type=o.a.None)}}).finally(()=>{this.coauthorSpinner.show=!1})}}},{key:"onDismissAddCoauthor",value:function(){this.coauthWarningDialog.show=!1,this.coauthorToAdd=null}},{key:"connectionsSectionHidden",get:function(){return this.usingConnectionsInfoCardsHidden&&this.connectionsInfoCardsHidden&&this.isXrmConnectionReferenceStateComputed}},{key:"usingConnectionsInfoCardsHidden",get:function(){return 0===this.usingConnectionsInfoCards.length}},{key:"connectionsInfoCardsHidden",get:function(){return 0===this.connectionsInfoCards.length}},{key:"navigateBackToFlowDetails",value:function(){var e=this.flowsClient.get(this.$scope,{id:this.flowId});e.$promise.then(()=>{this.navigationService.navigate(Object(P.m)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:Object(S.s)(e)}))}).catch(e=>{this.loggingService.logError("flowOwnersCtrl.navigateBackToFlowDetails: Failed to get flow",e),this.navigationService.navigate(Object(P.t)(this.routeCrafter))})}},{key:"getXRMConnectionReferences",value:function(){return this.isXrmConnectionReferenceModeEnabled?this.promiseHelperService.toAngularPromise(this.xrmEntityHttpClient.retrieveMultiple("connectionreferences").then(e=>{this.xrmConnectionReferences=e.data.value}).catch(e=>{this.loggingService.logWarning("FlowOwnersCtrl.getXrmConnectionReferences","Failed to load xrm connection references.")})):this.$q.resolve()}},{key:"checkIsXrmConnectionReferenceMode",value:function(e){this.setXrmConnectionReferenceModeState(F.loading);var{enableHostConnectionService:t,enableUIChangesForXRMConnectionReferences:i}=this.appSettings.featureFlags;if(!(t&&i||this.widgetUtilService.isTeamsSolutionExplorerContext()))return this.setXrmConnectionReferenceModeState(F.disabled),this.$q.resolve();var r=Object(C.k)(this.flow);return Object(C.g)(r)?(this.loggingService.logInfo("flowOwnersCtrl.checkIsXrmConnectionReferenceMode.Disable","Flow has existing standalone connections."),this.setXrmConnectionReferenceModeState(F.disabled),this.$q.resolve()):e?this.promiseHelperService.toAngularPromise(this.xrmEntityHttpClient.entityDefinition("connectionreference").then(e=>{this.loggingService.logInfo("flowOwnersCtrl.checkIsXrmConnectionReferenceMode.Enable","Connection reference entity exists and the Flow has no existing standalone connections."),this.setXrmConnectionReferenceModeState(F.enabled)}).catch(e=>{if(Object(C.a)(r))throw this.loggingService.logInfo("flowOwnersCtrl.checkIsXrmConnectionReferenceMode.Error","Flow uses connection references, but the connection reference entity check call failed."),this.setXrmConnectionReferenceModeState(F.failed),new b.a(b.c.ConnectionReferenceEntityNotFound,this.clientResources.XRMConnectionReference.EntityNotFound,null);this.loggingService.logInfo("flowOwnersCtrl.checkIsXrmConnectionReferenceMode.Disable","New Flow, but the connection reference entity check failed."),this.setXrmConnectionReferenceModeState(F.disabled)})):this.$q.resolve()}},{key:"isManagedFlow",value:function(e){e&&this.promiseHelperService.toAngularPromise(Object(R.c)(this.loggingService,this.environmentCapabilityService,this.environmentService.getCurrentEnvironmentName(),this.environmentService.getCurrentEnvironment().hasXrmInstance,this.environmentService.getCurrentEnvironment().protectionStatus.keyManagedBy)).then(e=>{this.modernFlowClient.checkIfModernFlowIsManagedFlow(this.flow,this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,this.loggingService,e).then(e=>{var t=Object(C.k)(this.flow);e&&Object(C.f)(t)&&this.setXrmConnectionReferenceModeState(F.disabled)})})}},{key:"setXrmConnectionReferenceModeState",value:function(e){this.xrmConnectionReferenceModeStatus=e,this.isXrmConnectionReferenceStateComputed&&this.updateConnectionSectionStrings()}},{key:"isXrmConnectionReferenceModeEnabled",get:function(){return this.xrmConnectionReferenceModeStatus===F.enabled}},{key:"isXrmConnectionReferenceStateComputed",get:function(){return!(this.xrmConnectionReferenceModeStatus===F.loading)}},{key:"addOwnerTitle",get:function(){return Object(S.y)(this.flow)?this.clientResources.FlowOwners.AddOwner.EntityFlow.TeamTitle:this.clientResources.FlowOwners.AddOwner.NormalFlow.Title}},{key:"getSharepointCoauthors",value:function(){this.sharepointCoauthors=this.sharePointPermissionService.delegatedSharePointCoauthors.map(e=>{var t={id:e.id,title:e.title,subTitle:e.subTitle,iconUrl:e.iconUrl,sharepointPermission:e.sharepointPermission,click:()=>this.onDeleteCoauthor(t),type:e.type};return t})}},{key:"setMainMessageBar",value:function(e){this.linksWithInterpolationProps=e.linksWithInterpolationProps,this.textMessageBarLink=e.link,this.textMessageBarMessage=e.message,this.showErrorMessageBar=!0}},{key:"getMessageBarTypeForError",get:function(){return A.c.error}}])&&O(t.prototype,i),r&&O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();N.$inject=[p.a.services.$q,p.a.services.$location,p.a.services.$routeParams,p.a.services.$scope,p.a.services.appSettings,p.a.services.assetService,p.a.services.clientResources,p.a.services.environment,p.a.services.flowConnectionsClient,p.a.services.apisClient,p.a.services.flowPermissions,p.a.services.flowsClient,p.a.services.graph,p.a.services.logging,p.a.services.navigation,p.a.services.policy,p.a.services.promiseHelperService,p.a.services.routeCrafter,p.a.services.session,p.a.services.sharePointPermissionService,p.a.services.telemetry,p.a.services.trialDialog,p.a.services.widgetUtilService,p.a.services.modernFlowClient,p.a.services.flowRoleService,p.a.services.flow,p.a.services.xrmEntityClient,p.a.services.xrmRolesClient,p.a.services.environmentCapability]},33436:function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return a}));var r=i(17451);function n(e){if(e===a.NotSpecified)return r.b.NotSpecified;if(e===a.User)return r.b.User;if(e===a.Group)return r.b.Group;if(e===a.SharepointList)return r.b.SharepointList;if(e===a.SystemUser)return r.b.SystemUser;if(e===a.Team)return r.b.Team;throw new Error("Cannot convert info card type '".concat(e,"' to flow sharing principal type."))}function o(e){if(e===r.b.NotSpecified)return a.NotSpecified;if(e===r.b.User)return a.User;if(e===r.b.Group)return a.Group;if(e===r.b.SharepointList)return a.SharepointList;if(e===r.b.SystemUser)return a.SystemUser;if(e===r.b.Team)return a.Team;throw new Error("Cannot convert sharing principal type '".concat(e,"' to info card type."))}var a=function(e){return e[e.NotSpecified=0]="NotSpecified",e[e.User=1]="User",e[e.Group=2]="Group",e[e.SystemUser=3]="SystemUser",e[e.Team=4]="Team",e[e.SharepointList=5]="SharepointList",e[e.Connection=6]="Connection",e}({})},33437:function(e,t,i){"use strict";var r=i(33398);i.d(t,"a",(function(){return r.a}))},33438:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33328),n=i(33327),o=i(13144),a="/providers/Microsoft.PowerApps/apis/connections";function s(e,t,i,r){return"providers/Microsoft.ProcessSimple/environments/".concat(r.getCurrentEnvironmentName(),"/flows/").concat(e,"/apis/").concat(t,"/connections/").concat(i)}r.a.factory(n.a.services.flowConnectionsClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment,(e,t,i)=>{var r="".concat(e.processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/flows/:flowName/connections");return t({urlBase:Object(o.c)(e).flowRP,urlPath:r,resourceType:a,apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,rest:{query:{requestInterceptor:e=>(e.url=e.url.replace(new RegExp("environments/(.*?)/?flows"),"environments/".concat(i.getCurrentEnvironmentName(),"/flows")),e),responseInterceptor:e=>e}}})}])},33439:function(e,t,i){"use strict";var r=i(17451);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b})),i.d(t,"c",(function(){return r.c})),i.d(t,"d",(function(){return r.d})),i.d(t,"e",(function(){return r.e})),i.d(t,"f",(function(){return r.f})),i.d(t,"g",(function(){return r.g}))},33440:function(e,t,i){"use strict";i.d(t,"b",(function(){return K})),i.d(t,"a",(function(){return X}));var r=i(33353),n=i(33441),o=i(33436),a=i(33383),s=i(33354),l=i(33437),c=i(33392),u=i(33442),d=i(33327),p=i(33360),h=i(33443),m=i(33396),g=i(33439),f=i(33444),v=i(33435),b=i(14751),y=i.n(b),w=i(33390),S=i(16926),C=i(33445),k=i(14900),P=i(33446),x=i(14867),A=i(14835),T=i(15420),R=i(33447),O=i(11806),D=i(12344),E=i(13016),F=i(17237),I=i(12345),j=i(17239),N=i(19853),M=i(14871),L=i(14873),U=i(17252),B=i(14852);function $(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?$(Object(i),!0).forEach((function(t){W(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function W(e,t,i){return(t=_(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function H(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){z(o,r,n,a,s,"next",e)}function s(e){z(o,r,n,a,s,"throw",e)}a(void 0)}))}}function V(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_(r.key),r)}}function _(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var G=function(e){return e[e.Sharepoint=0]="Sharepoint",e[e.Users=1]="Users",e}({});function K(e){return{id:e.id,displayName:e.title,email:e.subTitle,isNonRemovableOwner:void 0,iconUri:e.iconUrl,accessLevel:g.a.NotSpecified,type:Object(o.c)(e.type)}}var X=function(){function e(t,i,d,f,b,T,R,E,F,U,B,$,W,z,V,_,K,X,Q,J,Y,Z,ee,te,ie,re,ne,oe,ae,se,le){var ce=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$window=i,this.$scope=d,this.$timeout=f,this.appSettings=b,this.clientResources=T,this.connectionsClient=R,this.environmentService=E,this.flowConnectionsClient=F,this.flowPermissionsService=U,this.flowRolesClient=B,this.xrmRolesClient=$,this.flowsClient=W,this.graphService=z,this.loggingService=V,this.navigationService=_,this.ngFlowService=K,this.policiesService=X,this.promiseHelperService=Q,this.sessionService=J,this.sharePointPermissionService=Y,this.telemetryService=Z,this.trialDialog=ee,this.assetService=te,this.routeCrafter=ie,this.flowRoleService=re,this.flowRoleStore=ne,this.paCoreGraphService=oe,this.xrmEntityHttpClient=ae,this.environmentCapabilityService=se,this.xrmWorkflowHttpClient=le,this.flowRunOnlyTileTabs=G,this.toggleButtonEvent=void 0,this.flow=void 0,this.isEntityFlow=void 0,this.flowName=void 0,this.flowId=void 0,this.creatorId=void 0,this.flowRunOnlyTile=void 0,this.addedUsers=[],this.pendingUsersToAdd=[],this.pendingUsersToDelete=[],this.showTile=void 0,this.allSharepointSites={},this.allSharepointLists={},this.sharepointSiteUrls=[],this.sharepointListOptions=[],this.selectedSharepointListIdentifier=void 0,this.addedSharepointPermissions=[],this.pendingSharepointPermissionsToAdd=[],this.pendingSharepointPermissionsToDelete=[],this.errorAlert=void 0,this.populateRunOnlyUser=void 0,this.runOnlySpinner={size:a.c.Small,local:a.a.LocalHorizontal,message:this.clientResources.ModalDialog.RunOnly.Loading},this.infoPaneSpinner={size:a.c.Small,local:a.a.LocalHorizontal},this.addUserImage=this.assetService.addPerson,this.context=void 0,this.providedByRunOnlyUserId="",this.providedByTriggeringUserId=w.b.providedByTriggeringUserId,this.defaultToEmbeddedConnections=!1,this.runtimeConnectionCards=[],this.isRuntimeConnectionConfigurationUpdated=!1,this.isDefaultToEmbeddedConnectionsUpdated=!1,this.showConnectionWarningMessage=!1,this.showDraftFlowWarningMessage=!1,this.runtimeConnectionSpinner={size:a.c.Small,local:a.a.LocalHorizontal},this.modalDialogCancelButton={label:this.clientResources.ModalDialog.RunOnly.Cancel,action:e=>{e.stopPropagation(),this.useEmbeddedConnectionDialog.show=!1}},this.useEmbeddedConnectionDialog={show:!1,buttons:[{label:this.clientResources.ModalDialog.RunOnly.OK,action:e=>{e.stopPropagation(),this.useEmbeddedConnectionDialog.show=!1},primary:!0},this.modalDialogCancelButton]},this.infoPane=!1,this.showConnectionManagementSection=!1,this.showNewConnectionsManagementSection=!1,this.showTabs=!1,this.currentTab=G.Users,this.enablePaneSaveButton=!1,this.enablePaneCancelButton=!0,this.enableAddSharepointListButton=!1,this.userAddedErrorMessage=null,this.sharepointListAddedErrorMessage=null,this.pageEventLoadCorrelationId=void 0,this.linksWithInterpolationProps=void 0,this.textMessageBarMessage=void 0,this.textMessageBarLink=void 0,this.showErrorMessageBar=void 0,this.$onInit=()=>{this.flowId=Object(m.b)(this.flowName,this.environmentService),this.flowRunOnlyTile={title:this.clientResources.FlowPropertyTile.RunOnly.Title,showAll:!0,showAllAction:this.seeAllClick,searchParameters:{backUrl:Object(k.m)(this.routeCrafter,{flowName:this.flowName,solutionId:void 0,isLegacyShared:!1})}};var e=this.$q.defer();this.context.fetchAllRunOnlyUsers=e.promise,this.$scope.$watch(()=>this.flow,()=>{this.flow&&(this.isEntityFlow=!!this.flow.properties.workflowEntityId,this.creatorId=this.flow&&this.flow.properties&&this.flow.properties.creator&&this.flow.properties.creator.objectId||"",this.fetchAllRunOnlyUsers().then(()=>{this.prepareSharepoint()}).then(()=>{e.resolve()}).catch(t=>{e.reject(t)}))}),this.$scope.$watch(()=>this.infoPane,()=>{this.infoPane&&this.openInfoPane()}),this.linksWithInterpolationProps=null,this.textMessageBarLink=null,this.loggingService.profilePageEnd(this.pageEventLoadCorrelationId,s.a.flowPropertiesRunOnlyPanelLoadEnd)},this.fetchAllRunOnlyUsers=()=>(this.runOnlySpinner.show=!0,this.flowPermissionsService.getFlowUsers(this.flow,this.$scope).then(e=>{var{users:t,sharepointListInfo:i}=e;return this.populateAddedUsers(t).then(()=>{this.populateSharepointFields(i.sharepointPermissions,i.sharepointSites,i.sharepointLists)})}).then(()=>{if(this.populateRunOnlyUser){this.infoPane=!0;var e={properties:{principal:{id:Object(O.c)(this.$window.location.search).oid||""},permissionType:g.c.Principal}};return this.graphService.getUsersGraphDetails([e]).then(e=>{this.prepopulatePendingUsersToAdd(e.graphObjects,e.thumbnailPhotos)})}return this.$q.resolve()}).catch(e=>{this.populateErrorAlert(e)}).catch(e=>{}).finally(()=>{this.runOnlySpinner.show=!1,this.context.onInit()})),this.populateAddedUsers=e=>this.prepareSharepoint().then(t=>{t&&(e=e.filter(e=>!Object(g.f)(e))),this.addedUsers=Object(v.c)(e),this.$q.resolve()}),this.prepopulatePendingUsersToAdd=(e,t)=>{e.map(e=>{this.userNotAlreadyAdded(e.id)?(this.pendingUsersToAdd.push(Object(P.b)(e,t)),this.enablePaneSaveButton=!0,this.userAddedErrorMessage=null):this.userAddedErrorMessage=Object(p.d)(this.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Invite.UserAlreadyAdded,e.displayName)})},this.populateSharepointFields=(e,t,i)=>{this.addedSharepointPermissions=[],this.allSharepointSites={},this.allSharepointLists={},this.sharePointPermissionService.getFlowReferencedSharepointLists(this.flow).concat(e.map(e=>e.listIdentifier)).forEach(e=>{this.allSharepointSites[e.site]=t[e.site]||{webUrl:e.site},this.allSharepointLists[e.site]=this.allSharepointLists[e.site]||{},i[e.site]&&i[e.site][e.list]?this.allSharepointLists[e.site][e.list]=i[e.site][e.list]:this.allSharepointLists[e.site][e.list]={id:e.list}}),e.forEach(e=>{this.addedSharepointPermissions.push(this.prepareSharepointListCard(e))}),this.sharepointSiteUrls=Object.keys(this.allSharepointSites)},this.populateErrorAlert=e=>{this.loggingService.logError("FlowRunOnlyTileCtrl.getUserObjects",e);var t=Object(c.e)(e);this.errorAlert&&(this.errorAlert.type=r.a.Error,this.errorAlert.message=t)},this.userNotAlreadyAdded=e=>{var t=this.addedUsers.filter(t=>t.id===e||t.alternativeId===e),i=this.pendingUsersToAdd.filter(t=>t.id===e||t.alternativeId===e);return 0===t.length&&0===i.length},this.sharepointListNotAlreadyAdded=e=>{var t=this.addedSharepointPermissions.filter(t=>t.sharepointPermission.listIdentifier.site===e.site&&t.sharepointPermission.listIdentifier.list===e.list),i=this.pendingSharepointPermissionsToAdd.filter(t=>t.sharepointPermission.listIdentifier.site===e.site&&t.sharepointPermission.listIdentifier.list===e.list);return 0===t.length&&0===i.length},this.onUserAutocompleteSelect=(e,t)=>{t.stopPropagation();var i=e.id,n={id:i,title:e.displayName,subTitle:e.mail,type:Object(o.b)(e.type)};this.flowPermissionsService.checkCanAddUserAsRunOnlyUser(this.flow,i).then(t=>{var{canAddUser:r,error:o}=t;r?this.userNotAlreadyAdded(i)?(this.pendingUsersToAdd.push(n),this.enablePaneSaveButton=!0,this.userAddedErrorMessage=null):this.userAddedErrorMessage=Object(p.d)(this.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Invite.UserAlreadyAdded,e.displayName):this.userAddedErrorMessage=o}).catch(e=>{this.errorAlert.type=r.a.Error,this.errorAlert.message=Object(c.e)(e)})},this.seeAllClick=e=>{this.toggleButtonEvent=e,this.infoPane?this.onClose():(this.telemetryService.tagEvent(l.a.RunOnlyTileSeeAllClicked),this.tryToOpenInfoPane())},this.addPersonClick=e=>{this.toggleButtonEvent=e,this.infoPane?this.onClose():(this.telemetryService.tagEvent(l.a.RunOnlyTileAddPersonClicked),this.tryToOpenInfoPane())},this.tryToOpenInfoPane=()=>{this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>this.policiesService.checkUserCanShareFlow(this.flow)).then(e=>{e?this.openInfoPane():this.environmentService.isDevEnvironment()?this.trialDialog.showFeatureBlockedOnDeveloperEnvironment():this.trialDialog.showBlockedFeatureStartTrialDialog(e=>{e&&this.openInfoPane()})})},this.openInfoPane=()=>{var e;this.resetPaneData(),this.infoPane=!0,this.showConnectionManagementSection=!0,this.showNewConnectionsManagementSection=Object(A.k)(this.flow)&&Object(M.a)(),this.defaultToEmbeddedConnections=Object(L.g)(null===(e=this.flow.properties)||void 0===e?void 0:e.definition),this.fetchRuntimeConnectionConfiguration()},this.onSave=H((function*(){ce.telemetryService.tagEvent(l.a.RunOnlyPaneSaveClicked);try{ce.infoPaneSpinner.show=!0,ce.enablePaneSaveButton=!1,ce.enablePaneCancelButton=!1;var e=ce.isRuntimeConnectionConfigurationUpdated?ce.getUpdatedFlowDefinition(yield ce.getXRMConnectionReferencesForSolutionFlow()):ce.flow;if(ce.isDefaultToEmbeddedConnectionsUpdated&&Object(L.i)(e.properties.definition,ce.defaultToEmbeddedConnections),ce.isRuntimeConnectionConfigurationUpdated||ce.isDefaultToEmbeddedConnectionsUpdated){var t,i,n=Object(x.q)(e);if((yield Object(j.c)(ce.loggingService,ce.environmentCapabilityService,I.a.currentEnvironmentName,!(null===(t=I.a.environmentClaim)||void 0===t||!t.hasXrmInstance),null===(i=I.a.environmentClaim)||void 0===i||null===(i=i.protectionStatus)||void 0===i?void 0:i.keyManagedBy))&&Object(N.a)()&&Object(S.y)(ce.flow)&&Object(S.o)(ce.flow)){var o=yield ce.shouldCreateAsMcsFlow();yield ce.xrmWorkflowHttpClient.patchWorkflow(ce.flow.properties.workflowEntityId,n.properties,{isDraft:!0,createAsMcsFlow:o})}else yield ce.ngFlowService.patch({id:ce.flowId},n)}var a=ce.getModifyFlowUsersRequest();if(ce.prepareSharepoint().then(e=>{if(Object(S.y)(ce.flow)&&e){ce.loggingService.logInfo("FlowRunOnlyTileCtrl.onSave.delegatedAuthEnabled","Saving run only SP list users using SP delegated auth for solution flows.");var t=ce.loggingService.profileStart(s.a.flowPropertiesRunOnlyPanelAddSharepointForSolutionFlowStart);ce.pendingSharepointPermissionsToAdd.forEach(e=>{ce.promiseHelperService.toAngularPromise(ce.xrmRolesClient.addSharepointListAccessToFlow(ce.flow.properties.workflowEntityId,e.sharepointPermission.listIdentifier.site,e.sharepointPermission.listIdentifier.list,g.a.User)).then(()=>{ce.loggingService.profileEndWithSuccess(t,s.a.flowPropertiesRunOnlyPanelAddSharepointForSolutionFlowEnd,{flowName:ce.flowName})}).catch(e=>{ce.errorAlert.type=r.a.Error,ce.errorAlert.message=Object(c.e)(e,ce.clientResources.Common.SomethingWentWrong),ce.loggingService.profileEnd(t,s.a.flowPropertiesRunOnlyPanelAddSharepointForSolutionFlowEnd,c.a.Failure,e,{flowName:ce.flowName})})}),ce.pendingSharepointPermissionsToDelete.forEach(e=>{var t,i,n={id:(i=e).id,displayName:i.id,email:"",isNonRemovableOwner:void 0,iconUri:void 0,accessLevel:g.a.NotSpecified,type:g.b.NotSpecified};ce.promiseHelperService.toAngularPromise(ce.xrmRolesClient.removeFlowUser(null===(t=ce.flow)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.workflowEntityId,n)).catch(e=>{ce.errorAlert.type=r.a.Error,ce.errorAlert.message=Object(c.e)(e,ce.clientResources.Common.SomethingWentWrong),ce.loggingService.logError("FlowRunOnlyTileCtrl.onSave.removeFlowUser",e)})})}}),ce.appSettings.featureFlags.enableShareSolutionFlowWithAADUsers&&ce.flowRoleService.dvInstanceSupportsAutoJIT()&&Object(S.y)(ce.flow)){var u=a.add.users.map(e=>Object(v.b)(ce.flow.properties.workflowEntityId,e,C.c.users)),d=a.remove.users.map(e=>Object(v.b)(ce.flow.properties.workflowEntityId,e));yield ce.flowRoleService.syncFlowAccess(ce.flow.properties.workflowEntityId,[...u,...d])}else yield ce.flowPermissionsService.modifyFlowRunOnlyUsers(ce.flow,a);ce.pendingUsersToDelete.forEach(e=>{ce.addedUsers=ce.addedUsers.filter(t=>t.id!==e.id)}),ce.addedUsers=ce.addedUsers.concat(ce.pendingUsersToAdd);var p=ce.flowRolesClient.refreshQuery({flowName:ce.flowName,roleName:h.a.users}),m=ce.flowConnectionsClient.refreshQuery({flowName:ce.flowName});yield Promise.all([p,m]),ce.flow=e,ce.pendingSharepointPermissionsToDelete.forEach(e=>{ce.addedSharepointPermissions=ce.addedSharepointPermissions.filter(t=>t.sharepointPermission.listIdentifier.site!==e.listIdentifier.site||t.sharepointPermission.listIdentifier.list!==e.listIdentifier.list)}),ce.addedSharepointPermissions=ce.addedSharepointPermissions.concat(ce.pendingSharepointPermissionsToAdd),ce.resetPaneData(),ce.flowRoleService.loadFlowRoles({flowName:ce.flowName,flowRole:C.c.users,forceRefresh:!0}).then(()=>{ce.flowRoleStore.getRolePrincipalObjectIds(ce.flowName,C.c.users).forEach(e=>{ce.paCoreGraphService.getObjectsByObjectIds([e]),ce.paCoreGraphService.getThumbnailPhoto(e)})})}catch(b){if(ce.errorAlert&&(ce.errorAlert.type=r.a.Error,ce.errorAlert.message=Object(c.e)(b),ce.appSettings.featureFlags.enableConnectionSharingDLPErrorParsing&&Object(S.y)(ce.flow))){var f=Object(c.c)(ce.errorAlert.message,ce.clientResources);null!=f&&f.message&&(ce.setMainMessageBar(f),ce.errorAlert.message=null,ce.errorAlert.type=r.a.None)}}finally{ce.$scope.$applyAsync(()=>{var e,t;ce.infoPaneSpinner.show=!1,ce.enablePaneCancelButton=!0,ce.infoPane=(null===(e=ce.errorAlert)||void 0===e?void 0:e.type)===r.a.Error&&(null===(t=ce.errorAlert)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.length)>0||ce.showErrorMessageBar})}})),this.resetPaneData=()=>{this.pendingUsersToAdd=[],this.pendingUsersToDelete=[],this.pendingSharepointPermissionsToAdd=[],this.pendingSharepointPermissionsToDelete=[],this.addedUsers.forEach(e=>{e.disabled=!1}),this.addedSharepointPermissions.forEach(e=>{e.disabled=!1}),this.selectedSharepointListIdentifier=null,this.userAddedErrorMessage=null,this.sharepointListAddedErrorMessage=null,this.enablePaneSaveButton=!1,this.errorAlert.message=null,this.errorAlert.type=r.a.None},this.onCancel=()=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneCancelClicked),this.infoPane=!1,this.errorAlert={type:r.a.None,message:""},this.showErrorMessageBar=!1,this.linksWithInterpolationProps=null,this.textMessageBarLink=null,this.textMessageBarMessage=null},this.onClose=()=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneCloseClicked),this.infoPane=!1,this.errorAlert={type:r.a.None,message:""},this.showErrorMessageBar=!1,this.linksWithInterpolationProps=null,this.textMessageBarLink=null,this.textMessageBarMessage=null},this.onDeleteAddedUser=e=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneDeleteAddedUserClicked),this.pendingUsersToDelete.push(e),this.addedUsers[this.addedUsers.indexOf(e)].disabled=!0,this.enablePaneSaveButton=this.determineSaveButtonDisplay()},this.onAddAddedUser=e=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneAddAddedUserClicked),this.pendingUsersToDelete=this.pendingUsersToDelete.filter(t=>t.id!==e.id),this.addedUsers[this.addedUsers.indexOf(e)].disabled=!1,this.enablePaneSaveButton=this.determineSaveButtonDisplay()},this.onDeletePendingToAddUser=(e,t)=>{e.stopPropagation(),this.telemetryService.tagEvent(l.a.RunOnlyPaneDeletePendingToAddUserClicked),this.pendingUsersToAdd=this.pendingUsersToAdd.filter(e=>e.id!==t.id),this.enablePaneSaveButton=this.determineSaveButtonDisplay()},this.onSelectSharepointSite=()=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneSharepointSiteSelected),this.updateSharepointListOptions(),this.enablePaneSaveButton=!1},this.onSelectSharepointList=()=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneSharepointListSelected),this.enableAddSharepointListButton=!!this.selectedSharepointListIdentifier.list},this.onAddPendingSharepointPermission=()=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneAddSharepointPermissionClicked),this.prepareSharepoint().then(e=>{if(Object(S.y)(this.flow)&&e&&this.sharepointListNotAlreadyAdded(this.selectedSharepointListIdentifier))this.xrmRolesClient.getTeamIdForSharepointListSite(this.selectedSharepointListIdentifier.site,this.selectedSharepointListIdentifier.list).then(e=>{var t={id:e,listIdentifier:q({},this.selectedSharepointListIdentifier),accessDefinition:n.c};this.pendingSharepointPermissionsToAdd.push(this.prepareSharepointListCard(t)),this.enablePaneSaveButton=!0,this.sharepointListAddedErrorMessage=null,this.$q.resolve(),this.$scope.$apply()}).catch(e=>{this.errorAlert.type=r.a.Error,this.errorAlert.message=Object(c.e)(e,this.clientResources.Common.SomethingWentWrong),this.loggingService.logError("FlowRunOnlyTileCtrl.onAddPendingSharepointPermission",e)});else if(this.sharepointListNotAlreadyAdded(this.selectedSharepointListIdentifier)){var t={id:"DELEGATED-"+Object(p.e)(),listIdentifier:q({},this.selectedSharepointListIdentifier),accessDefinition:n.c};this.pendingSharepointPermissionsToAdd.push(this.prepareSharepointListCard(t)),this.enablePaneSaveButton=!0,this.sharepointListAddedErrorMessage=null}else this.sharepointListAddedErrorMessage=this.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Invite.ListAlreadyAdded,this.enablePaneSaveButton=this.determineSaveButtonDisplay()})},this.onDeleteAddedSharepointPermission=e=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneDeleteAddedSharepointPermissionClicked),this.pendingSharepointPermissionsToDelete.push(e.sharepointPermission),this.addedSharepointPermissions[this.addedSharepointPermissions.indexOf(e)].disabled=!0,this.enablePaneSaveButton=this.determineSaveButtonDisplay()},this.onAddAddedSharepointPermission=e=>{this.telemetryService.tagEvent(l.a.RunOnlyPaneAddAddedSharepointPermissionClicked),this.pendingSharepointPermissionsToDelete=this.pendingSharepointPermissionsToDelete.filter(t=>t.listIdentifier.site!==e.sharepointPermission.listIdentifier.site&&t.listIdentifier.list!==e.sharepointPermission.listIdentifier.list),this.addedSharepointPermissions[this.addedSharepointPermissions.indexOf(e)].disabled=!1,this.enablePaneSaveButton=this.determineSaveButtonDisplay()},this.onDeletePendingToAddSharepointPermission=(e,t)=>{e.stopPropagation(),this.telemetryService.tagEvent(l.a.RunOnlyPaneDeletePendingToAddSharepointPermissionClicked),this.pendingSharepointPermissionsToAdd=this.pendingSharepointPermissionsToAdd.filter(e=>e.id!==t.id),this.enablePaneSaveButton=this.determineSaveButtonDisplay()},this.determineSaveButtonDisplay=()=>this.pendingUsersToDelete.length>0||this.pendingUsersToAdd.length>0||this.isRuntimeConnectionConfigurationUpdated||this.isDefaultToEmbeddedConnectionsUpdated||this.pendingSharepointPermissionsToDelete.length>0||this.pendingSharepointPermissionsToAdd.length>0,this.getAvailableConnectionOptions=e=>Object(D.b)(this.appSettings.featureFlags)&&Object(x.u)(e)?[{value:this.providedByTriggeringUserId,displayName:this.clientResources.FlowInfoPane.RunOnly.Connections.ProvidedByTriggeringUser}]:Object(A.i)(this.flow)?[]:[{value:this.providedByRunOnlyUserId,displayName:this.clientResources.FlowInfoPane.RunOnly.Connections.ProvidedByRunOnlyUser}],this.fetchRuntimeConnectionConfiguration=()=>{this.showConnectionWarningMessage=!1,this.showDraftFlowWarningMessage=!1,this.runtimeConnectionSpinner.show=!0;var e=this.loggingService.profileStart(s.a.flowRuntimeConnectionManagementStart,{flowName:this.flowName}),t=this.flowConnectionsClient.query(this.$scope,{flowName:this.flowName}),i=this.connectionsClient.query(this.$scope);this.$q.all([t.$promise,i.$promise]).then(()=>{var r=this.flow?y()(this.flow.properties.connectionReferences):{},n=t,o={},a=i.concat(n).filter(e=>!o[e.name]&&e.properties.statuses.filter(e=>"Connected"===e.status).length>0&&(o[e.name]=!0,!0));0===Object.keys(r).length?this.showConnectionManagementSection=!1:(this.runtimeConnectionCards=[],Object.keys(r).forEach(e=>{var t=r[e],i={id:e,title:t.displayName,subTitle:"",iconUrl:t.iconUri,selectedConnection:"",availableConnectionOptions:this.getAvailableConnectionOptions(t),originalConfigurationModified:!1};t.source===u.a.Invoker?(i.subTitle=this.clientResources.FlowInfoPane.RunOnly.Connections.ProvideOwnConnection,i.selectedConnection=""):Object(D.b)(this.appSettings.featureFlags)&&Object(x.t)(t)?(i.subTitle=this.clientResources.FlowInfoPane.RunOnly.Connections.ProvidedByTriggeringUserDescription,i.selectedConnection=this.providedByTriggeringUserId):t.source===u.a.Embedded&&(i.subTitle=this.clientResources.FlowInfoPane.RunOnly.Connections.EmbeddedConnection,i.selectedConnection=t.connectionName),a.forEach(e=>{e.properties.apiId===t.id&&(Object(D.b)(this.appSettings.featureFlags)&&Object(x.u)(t)&&Object(S.y)(this.flow)&&t.connectionName!==e.name||i.availableConnectionOptions.push({value:e.name,displayName:Object(p.d)(this.clientResources.FlowInfoPane.RunOnly.Connections.UseThisConnection,e.properties.displayName)}))}),this.runtimeConnectionCards.push(i)})),this.loggingService.profileEndWithSuccess(e,s.a.flowRuntimeConnectionManagementEnd,{flowName:this.flowName})}).catch(t=>{this.errorAlert.type=r.a.Error,this.errorAlert.message=Object(c.e)(t,this.clientResources.Common.SomethingWentWrong),this.loggingService.profileEnd(e,s.a.flowRuntimeConnectionManagementEnd,c.a.Failure,t,{flowName:this.flowName})}).finally(()=>this.runtimeConnectionSpinner.show=!1)},this.pageEventLoadCorrelationId=this.loggingService.profilePageStart(s.a.flowPropertiesRunOnlyPanelLoadStart)}var t,i,d,b;return t=e,(i=[{key:"prepareSharepoint",value:function(){return this.promiseHelperService.toAngularPromise(Object(F.c)(this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,this.loggingService)).then(e=>(this.showTabs=this.sharePointPermissionService.shouldShowSharepointTabs(this.flow,e),this.$q.resolve(),this.promiseHelperService.toAngularPromise(Promise.resolve(e))))}},{key:"prepareSharepointListCard",value:function(e){var t=this.allSharepointSites[e.listIdentifier.site],i=this.allSharepointLists[e.listIdentifier.site][e.listIdentifier.list];return{id:e.id,title:t.displayName||Object(p.d)(this.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.SiteUrl,t.webUrl.toLowerCase()),subTitle:i.displayName||Object(p.d)(this.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.ListId,i.id.toLowerCase()),iconUrl:this.assetService.sharepointOnline,sharepointPermission:e,type:o.a.SharepointList}}},{key:"updateSharepointListOptions",value:function(){this.selectedSharepointListIdentifier.site?this.sharepointListOptions=Object.keys(this.allSharepointLists[this.selectedSharepointListIdentifier.site]).map(e=>this.allSharepointLists[this.selectedSharepointListIdentifier.site][e]):this.sharepointListOptions=[]}},{key:"shouldCreateAsMcsFlow",value:(b=H((function*(){if(Object(U.b)(this.flow.properties.templateName))try{var e;return yield Object(T.e)(B.a.modernFlowTypeMinimumVersion,!(null===(e=I.a.environmentClaim)||void 0===e||!e.hasXrmInstance),this.xrmEntityHttpClient)}catch(t){return this.loggingService.logError("FlowCtrl.xrmSaveDraftFlow getting org info",t),!1}return!1})),function(){return b.apply(this,arguments)})},{key:"isCurrentTab",value:function(e){return e===this.currentTab}},{key:"onDefaultToEmbeddedConnectionsChange",value:function(){this.telemetryService.tagEvent(l.a.RunOnlyPaneDefaultToEmbeddedConnectionsToggleClicked),this.updateStatesPerUserSelection()}},{key:"onRuntimeConnectionSelectionChange",value:function(e){this.telemetryService.tagEvent(l.a.RunOnlyPaneModifyConnectionSelectClicked);var t=this.flow.properties.connectionReferences[e],i=t.source===u.a.Invoker,r=this.runtimeConnectionCards.filter(t=>t.id===e)[0];r.selectedConnection!==this.providedByRunOnlyUserId&&(this.modalDialogCancelButton.action=t=>{t.stopPropagation(),this.telemetryService.tagEvent(l.a.RunOnlyPaneModifyConnectionModalCancelClicked),this.revertUseEmbeddedConnectionSelection(e),this.updateStatesPerUserSelection()},this.useEmbeddedConnectionDialog.show=!0),r.originalConfigurationModified=i&&r.selectedConnection!==this.providedByRunOnlyUserId||!i&&r.selectedConnection!==t.connectionName||!!Object(D.b)(this.appSettings.featureFlags)&&Object(x.t)(t)&&r.selectedConnection!==this.providedByTriggeringUserId,this.updateStatesPerUserSelection()}},{key:"revertUseEmbeddedConnectionSelection",value:function(e){var t=this.runtimeConnectionCards.filter(t=>t.id===e)[0];t.selectedConnection=this.flow.properties.connectionReferences[e].source===u.a.Invoker?this.providedByRunOnlyUserId:this.flow.properties.connectionReferences[e].connectionName,Object(D.b)(this.appSettings.featureFlags)&&Object(x.t)(this.flow.properties.connectionReferences[e])&&(t.selectedConnection=this.providedByTriggeringUserId),t.originalConfigurationModified=!1,this.useEmbeddedConnectionDialog.show=!1}},{key:"getXRMConnectionReferencesForSolutionFlow",value:function(){return Object(S.y)(this.flow)?this.promiseHelperService&&this.xrmEntityHttpClient?this.promiseHelperService.toAngularPromise(this.xrmEntityHttpClient.retrieveMultiple("connectionreferences").then(e=>e.data.value).catch(e=>(this.loggingService.logWarning("FlowRunOnlyTileCtrl.getXrmConnectionReferences","Failed to load xrm connection references."),[]))):(this.loggingService.logWarning("FlowRunOnlyTileCtrl.getXrmConnectionReferences","Failed to load xrm connection references without valid client."),this.$q.resolve([])):(this.loggingService.logInfo("FlowRunOnlyTileCtrl.getXrmConnectionReferences","Did not need to load xrm connection references since non-solution flow."),this.$q.resolve([]))}},{key:"getUpdatedFlowDefinition",value:function(e){var t=y()(this.flow);return this.runtimeConnectionCards.forEach(i=>{var r=i.id;if(i.originalConfigurationModified)if(i.selectedConnection===this.providedByRunOnlyUserId&&i.originalConfigurationModified)t.properties.connectionReferences[r].source=u.a.Invoker;else{t.properties.connectionReferences[r].source=u.a.Embedded,Object(D.b)(this.appSettings.featureFlags)&&Object(x.u)(t.properties.connectionReferences[r])&&(t.properties.connectionReferences[r].impersonation||(t.properties.connectionReferences[r].impersonation={}),t.properties.connectionReferences[r].impersonation.source=i.selectedConnection===this.providedByTriggeringUserId?f.b.Invoker:void 0),i.selectedConnection!==this.providedByTriggeringUserId&&(t.properties.connectionReferences[r].connectionName=i.selectedConnection);var n,o=t.properties.connectionReferences[r].connectionName,a=t.properties.connectionReferences[r].connectionReferenceLogicalName;if(Object(D.b)(this.appSettings.featureFlags)&&Object(x.u)(t.properties.connectionReferences[r])&&a&&o&&e)if((null===(n=e.find(e=>e.connectionreferencelogicalname===a))||void 0===n?void 0:n.connectionid)===o)t.properties.connectionReferences[r].connectionName=void 0;else{var s,l=null===(s=e.find(e=>e.connectionid===o))||void 0===s?void 0:s.connectionreferencelogicalname;l&&(this.loggingService.logInfo("FlowRunOnlyTileCtrl.getUpdatedFlowDefinition","Updating connection reference logical name in flow",{originalConnectionReferenceLogicalName:a,updatedConnectionReferenceLogicalName:l}),t.properties.connectionReferences[r].connectionReferenceLogicalName=l,t.properties.connectionReferences[r].connectionName=void 0)}}}),t}},{key:"updateStatesPerUserSelection",value:function(){var e;this.isRuntimeConnectionConfigurationUpdated=!1,this.runtimeConnectionCards.forEach(e=>{e.originalConfigurationModified&&(this.isRuntimeConnectionConfigurationUpdated=!0)}),this.showConnectionWarningMessage=this.isRuntimeConnectionConfigurationUpdated&&(this.addedUsers.length>0||this.pendingUsersToAdd.length>0),this.showDraftFlowWarningMessage=Object(S.o)(this.flow)&&this.isRuntimeConnectionConfigurationUpdated&&Object(N.a)(),this.isDefaultToEmbeddedConnectionsUpdated=this.defaultToEmbeddedConnections!==Object(L.g)(null===(e=this.flow.properties)||void 0===e?void 0:e.definition),this.enablePaneSaveButton=this.determineSaveButtonDisplay()}},{key:"getAddUsersTitle",value:function(){return Object(S.y)(this.flow)?this.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Invite.EntityFlow.TeamTitle:this.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Invite.Title}},{key:"getAriaLabelForConnectionSelectElement",value:function(e){return Object(p.d)(this.clientResources.FlowInfoPane.RunOnly.Connections.Select.AriaLabel,e.title)}},{key:"getModifyFlowUsersRequest",value:function(){return{add:{users:this.pendingUsersToAdd.map(e=>K(e)),sharepointLists:Object(R.a)(this.pendingSharepointPermissionsToAdd.map(e=>e.sharepointPermission))},remove:{users:this.pendingUsersToDelete.map(e=>K(e)),sharepointLists:Object(R.a)(this.pendingSharepointPermissionsToDelete)}}}},{key:"setMainMessageBar",value:function(e){this.linksWithInterpolationProps=e.linksWithInterpolationProps,this.textMessageBarMessage=e.message,this.textMessageBarLink=e.link,this.showErrorMessageBar=!0}},{key:"getMessageBarTypeForError",get:function(){return E.c.error}}])&&V(t.prototype,i),d&&V(t,d),Object.defineProperty(t,"prototype",{writable:!1}),e}();X.$inject=[d.a.services.$q,d.a.services.$window,d.a.services.$scope,d.a.services.$timeout,d.a.services.appSettings,d.a.services.clientResources,d.a.services.connectionsClient,d.a.services.environment,d.a.services.flowConnectionsClient,d.a.services.flowPermissions,d.a.services.flowRolesClient,d.a.services.xrmRolesClient,d.a.services.flowsClient,d.a.services.graph,d.a.services.logging,d.a.services.navigation,d.a.services.ngReactBridge.ngFlowService,d.a.services.policies,d.a.services.promiseHelperService,d.a.services.session,d.a.services.sharePointPermissionService,d.a.services.telemetry,d.a.services.trialDialog,d.a.services.assetService,d.a.services.routeCrafter,d.a.services.flowRoleService,d.a.services.flowRoleStore,d.a.services.graphService,d.a.services.xrmEntityClient,d.a.services.environmentCapability,d.a.services.xrmWorkflowClient]},33441:function(e,t,i){"use strict";var r=i(21041);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b})),i.d(t,"c",(function(){return r.c}))},33442:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r={Embedded:"Embedded",Invoker:"Invoker"}},33443:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return d}));var r=i(33328),n=i(33327),o=i(31433),a=i(13144);function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){c(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function c(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u={owners:"owners",users:"users"};function d(e,t,i,r){return"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(r,"/flows/").concat(e,"/").concat(t,"/").concat(i)}r.a.factory(n.a.services.flowRolesClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,n.a.services.environment,(e,t,i)=>{var r,n=e=>(e.url=e.url.replace(new RegExp("environments/(.*?)/?flows"),"environments/".concat(i.getCurrentEnvironmentName(),"/flows")),e),s=(r=i.getCurrentEnvironmentName(),{urlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(r,"/flows/:flowName/:roleName/:id"),listUrlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(r,"/flows/:flowName/:roleName"),modifyUrlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(r,"/flows/:flowName/modify:roleName"),requestAccessUrlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(r,"/flows/:flowName/requestUserAccess"),resourceType:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/flows/:roleName")}),c={requestInterceptor:n,urlPath:s.modifyUrlPath,name:"modify",method:"POST",params:l({flowName:"@flowName",roleName:"@roleName"},{cascadeoperation:"true"})},u={requestInterceptor:n,urlPath:s.requestAccessUrlPath,name:"requestAccess",method:"POST",params:{flowName:"@flowName"}};return e({apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,urlBase:Object(a.c)(t).flowRP,urlPath:s.urlPath,resourceType:s.resourceType,rest:{delete:{requestInterceptor:n,params:{id:"@id"}},query:{requestInterceptor:n,urlPath:s.listUrlPath,params:{flowName:"@flowName",roleName:"@roleName"}}},actions:[c,u]})}])},33444:function(e,t,i){"use strict";var r=i(14869);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b}))},33445:function(e,t,i){"use strict";var r=i(12367);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.f})),i.d(t,"c",(function(){return r.g}))},33446:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c})),i.d(t,"d",(function(){return u}));var r=i(11891),n=(i(14827),i(33439)),o=i(33436),a=i(17452),s=i(15520);function l(e){return e&&e.some(e=>!e.roleDisabled&&(Object(r.a)(e.roleTemplateId,a.a.companyAdminRoleObjectId)||Object(r.a)(e.roleTemplateId,a.a.companyBillingAdministrator)))}function c(e,t){var i=e.id;return{id:i,title:e.displayName,subTitle:e.mail,iconUrl:t.hasOwnProperty(i)?t[i]:"",type:Object(o.b)(Object(n.d)(e.objectType))}}function u(e){var t,i;return null!==(t=e["@odata.type"])&&void 0!==t&&t.toLowerCase().includes("user")?"user":null!==(i=e["@odata.type"])&&void 0!==i&&i.toLowerCase().includes("group")?"group":""}i.d(t,"c",(function(){return s.a})),i.d(t,"e",(function(){return s.b}))},33447:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(21041),n=i(17451);function o(e){return e.map(e=>function(e){return{name:e.id,properties:{permissionType:n.c.AuthorizationDelegate,authorizationDelegate:{delegationSource:{delegationService:r.a.sharepoint},delegatedAuthResource:{resourceCollection:e.listIdentifier.site,resourceId:e.listIdentifier.list},accessDefinition:e.accessDefinition}}}}(e))}},33448:function(e,t,i){e.exports=i.p+"static/media/flowOwners.2b91db83.less"},33449:function(e,t){e.exports='<trial-dialog></trial-dialog>\n<div class="subsection-manage section-manage-flow-owners" ng-show="flowOwners.flow">\n    <heading label="flowOwners.flowDisplayName" back="flowOwners.backButton" links="flowOwners.headingLinks"></heading>\n    <react-text-message-bar\n         ng-if="flowOwners.showErrorMessageBar"\n         type="flowOwners.getMessageBarTypeForError"\n         link="flowOwners.textMessageBarLink"\n         links-with-interpolation-props="flowOwners.linksWithInterpolationProps"\n         message="flowOwners.textMessageBarMessage"\n         onDismiss="flowOwners.onMessageBarDismiss">\n    </react-text-message-bar>\n    <alert class="flow-owners-alert" model="flowOwners.errorAlert"></alert>\n    <section class="row section-flow-owners">\n        <div class="column medium-3 left-pane">\n            <h1>{{::flowOwners.clientResources.FlowOwners.Owners.Title}}</h1>\n            <p>{{::flowOwners.clientResources.FlowOwners.Owners.Description}}</p>\n            <a class="c-hyperlink" target="_blank" href="https://go.microsoft.com/fwlink/?linkid=839912" data-event-name="FlowCoauthorsLearnMoreClicked" aria-label="{{::flowOwners.clientResources.FlowOwners.Owners.LearnMore.AriaLabel}}">{{::flowOwners.clientResources.Common.LearnMore}}</a>\n        </div>\n        <div class="column medium-8 medium-offset-1 right-pane">\n            <div class="owner-tabs" role="tablist" ng-if="flowOwners.showTabs">\n                <a\n                    class="owner-tab"\n                    role="tab"\n                    href\n                    tabindex="0"\n                    aria-selected="{{flowOwners.currentTab === flowOwners.FlowOwnersTileTab.Users}}"\n                    aria-label="{{::flowOwners.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Title}}"\n                    ng-class="{\'tab-active\': flowOwners.currentTab === flowOwners.FlowOwnersTileTab.Users}"\n                    ng-click="flowOwners.currentTab = flowOwners.FlowOwnersTileTab.Users">\n                    {{::flowOwners.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Title}}\n                </a>\n                <a\n                    class="owner-tab"\n                    role="tab"\n                    href\n                    tabindex="0"\n                    aria-selected="{{flowOwners.currentTab === flowOwners.FlowOwnersTileTab.Sharepoint}}"\n                    aria-label="{{::flowOwners.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Title}}"\n                    ng-class="{\'tab-active\': flowOwners.currentTab === flowOwners.FlowOwnersTileTab.Sharepoint}"\n                    ng-click="flowOwners.currentTab = flowOwners.FlowOwnersTileTab.Sharepoint">\n                    {{::flowOwners.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Title}}\n                </a>\n            </div>\n            <div ng-show="flowOwners.currentTab === flowOwners.FlowOwnersTileTab.Users">\n                <h6 class="flowOwners-header">{{flowOwners.addOwnerTitle}}</h6>\n                <div ng-if="!flowOwners.coauthorSpinner.show">\n                    <graph-autocomplete\n                        ng-if="!flowOwners.isEntityFlow"\n                        on-select="flowOwners.onUserAutocompleteSelect"></graph-autocomplete>\n                    <xrm-system-user-autocomplete\n                        ng-if="flowOwners.isEntityFlow"\n                        on-select="flowOwners.onUserAutocompleteSelect"></xrm-system-user-autocomplete>\n                </div>\n                <spinner model="flowOwners.coauthorSpinner"></spinner>\n                <ps-list items="flowOwners.contributors">\n                    <ps-list-item-template>\n                        <info-card model="$parent.item">\n                            <info-card-icon-template>\n                                <avatar mail="$parent.model.subTitle" display-name="$parent.model.title" image-src="$parent.model.iconUrl" object-id="$parent.model.id"></avatar>\n                            </info-card-icon-template>\n                            <info-card-picker-template></info-card-picker-template>\n                            <info-card-option-template>\n                                <div ng-click="$parent.model.click()" ng-disabled="$parent.model.disabled" aria-label="{{::flowOwners.clientResources.FlowOwners.DeleteUser.Delete}}">\n                                    <p ng-show="$parent.model.loading">{{::flowOwners.clientResources.FlowOwners.Owner.Adding}}</p>\n                                    <div class="option-block c-glyph glyph-delete" role="presentation" ng-disabled="$parent.model.disabled" ng-show="!$parent.model.loading"></div>\n                                </div>\n                            </info-card-option-template>\n                        </info-card>\n                    </ps-list-item-template>\n                </ps-list>\n            </div>\n            <div ng-show="flowOwners.currentTab === flowOwners.FlowOwnersTileTab.Sharepoint">\n                <h6 class="flowOwners-header">{{::flowOwners.clientResources.FlowOwners.AddSharePointOwner.Title}}</h6>\n                <div class="owners-sharepoint-container">\n                    <label class="dropdown-label" for="sharepoint-site-selection">{{::flowOwners.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Site}}</label>\n                    <select\n                        name="sharepoint-site-selection"\n                        id="sharepoint-site-selection"\n                        ng-options="sharepointSiteUrl as flowOwners.sharePointPermissionService.allSharepointSites[sharepointSiteUrl].displayName || sharepointSiteUrl for sharepointSiteUrl in flowOwners.sharePointPermissionService.sharepointSiteUrls"\n                        ng-model="flowOwners.selectedSharepointListIdentifier.site"\n                        ng-change="flowOwners.onSelectSharepointSite()"\n                    ></select>\n                    <label class="dropdown-label" for="sharepoint-list-selection">{{::flowOwners.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.ListLibrary}}</label>\n                    <select\n                        name="sharepoint-list-selection"\n                        id="sharepoint-list-selection"\n                        ng-options="sharepointListOption.id as sharepointListOption.displayName || sharepointListOption.id for sharepointListOption in flowOwners.sharePointPermissionService.sharepointListOptions | orderBy:\'displayName\'"\n                        ng-model="flowOwners.selectedSharepointListIdentifier.list"\n                        ng-change="flowOwners.onSelectSharepointList()"\n                        ng-disabled="!flowOwners.sharePointPermissionService.sharepointListOptions || flowOwners.sharePointPermissionService.sharepointListOptions.length < 1"\n                    ></select>\n                    <button class="c-button" type="submit" ng-click="flowOwners.onAddSharepointPermission()" ng-disabled="!flowOwners.enableAddSharepointListButton">\n                        {{::flowOwners.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Invite.AddList}}\n                    </button>\n                </div>\n                <spinner model="flowOwners.coauthorSpinner"></spinner>\n                <ps-list items="flowOwners.sharepointCoauthors">\n                    <ps-list-item-template>\n                        <info-card model="$parent.item">\n                            <info-card-icon-template>\n                                <img ng-src="{{$parent.model.iconUrl}}" />\n                            </info-card-icon-template>\n                            <info-card-picker-template></info-card-picker-template>\n                            <info-card-option-template>\n                                <div ng-click="$parent.model.click()" ng-disabled="$parent.model.disabled" aria-label="{{::flowOwners.clientResources.FlowOwners.DeleteUser.Delete}}">\n                                    <p ng-show="$parent.model.loading">{{::flowOwners.clientResources.FlowOwners.Owner.Adding}}</p>\n                                    <div class="option-block c-glyph glyph-delete" role="presentation" ng-disabled="$parent.model.disabled" ng-show="!$parent.model.loading"></div>\n                                </div>\n                            </info-card-option-template>\n                        </info-card>\n                    </ps-list-item-template>\n                </ps-list>\n            </div>\n        </div>\n    </section>\n\n    <react-dialog\n        hidden="!flowOwners.deleteDialogShow"\n        title="flowOwners.dialogTitle"\n        sub-text="flowOwners.dialogMessage"\n        primary-button-props="flowOwners.deleteDialogPrimaryButton"\n        secondary-button-props="flowOwners.deleteDialogSecondaryButton"\n        on-dismiss="flowOwners.onDismissDialog"\n    ></react-dialog>\n\n    <hr ng-hide="flowOwners.connectionsSectionHidden" />\n    <section class="row section-flow-owners-connections" ng-hide="flowOwners.connectionsSectionHidden">\n        <div class="column medium-3 left-pane">\n            <h1>{{::flowOwners.connectionTitle}}</h1>\n            <p>{{::flowOwners.connectionDescription}}</p>\n            <a ng-if="!flowOwners.isXrmConnectionReferenceModeEnabled" class="c-hyperlink" target="_blank" href="https://go.microsoft.com/fwlink/?linkid=839913" data-event-name="FlowConnectionsLearnMoreClicked" aria-label="{{::flowOwners.clientResources.FlowOwners.Connections.LearnMore.AriaLabel}}">{{::flowOwners.clientResources.Common.LearnMore}}</a>\n        </div>\n        <div class="column medium-8 medium-offset-1 right-pane">\n            <spinner model="flowOwners.connectionSpinner"></spinner>\n            <div class="flow-owners-title" ng-hide="flowOwners.usingConnectionsInfoCardsHidden">{{::flowOwners.ownerConnectionsTitle}}</div>\n            <div class="flow-owners-subtitle" ng-hide="flowOwners.usingConnectionsInfoCardsHidden">\n                {{::flowOwners.ownerConnectionsSubtitle}}\n                <a ng-if="!flowOwners.isXrmConnectionReferenceModeEnabled" class="c-hyperlink" href="{{::flowOwners.connectionsRoute}}" aria-label="{{::flowOwners.clientResources.FlowOwners.OwnerConnections.ManageConnectionsLink.AriaLabel}}">{{::flowOwners.ownerConnectionsManageConnectionText}}</a>\n            </div>\n\n            <info-card-list model="flowOwners.usingConnectionsInfoCards"></info-card-list>\n\n            <div class="flow-owners-title" ng-hide="flowOwners.connectionsInfoCardsHidden">{{::flowOwners.otherConnectionsTitle}}</div>\n            <div class="flow-owners-subtitle" ng-hide="flowOwners.connectionsInfoCardsHidden">{{::flowOwners.otherConnectionsSubtitle}}</div>\n\n            <info-card-list model="flowOwners.connectionsInfoCards"></info-card-list>\n        </div>\n    </section>\n\n    <modal-dialog model="flowOwners.coauthWarningDialog">\n        <dialog-header-content-template>\n            <div>\n                <img ng-attr-src="{{::flowOwners.assetService.flowSharingAlertIcon}}"/>\n                <h6 class="flowOwners-warningDialog-header">{{::flowOwners.clientResources.FlowOwners.CoauthWarningDialog.Header}}</h6>\n                <a role="button" aria-label="{{::flowOwners.clientResources.FlowOwners.CoauthWarningDialog.CloseButtonAriaLabel}}" ng-click="flowOwners.onDismissAddCoauthor()" href="" class="c-glyph glyph-close ng-modal-close"></a>\n            </div>\n        </dialog-header-content-template>\n        <dialog-body-content-template>\n            <p class="flowOwners-description">\n                {{::flowOwners.clientResources.FlowOwners.CoauthWarningDialog.Description}}\n            </p>\n            <a class="c-hyperlink" target="_blank" href="https://go.microsoft.com/fwlink/?linkid=839912" data-event-name="FlowCoauthorsLearnMoreClicked" aria-label="{{::flowOwners.clientResources.FlowOwners.Owners.LearnMore.AriaLabel}}">{{::flowOwners.clientResources.Common.LearnMore}}</a>\n            <spinner model="flowOwners.connectionSpinner"></spinner>\n            <div class="connections-info-cards">\n                <info-card ng-repeat="infoCard in flowOwners.usingConnectionsInfoCards" model="infoCard">\n                    <info-card-icon-template>\n                        <img ng-attr-src="{{::$parent.model.iconUrl}}" img-on-error-src="{{::flowOwners.assetService.connection}}" alt="{{::$parent.model.title}}" />\n                    </info-card-icon-template>\n                    <info-card-list-template ng-if="$parent.model.scopes && $parent.model.scopes.length">\n                        {{::flowOwners.clientResources.FlowOwners.CoauthWarningDialog.OwnerAccessSubheader}}\n                        <ul>\n                            <li ng-repeat="permission in $parent.$parent.model.scopes">{{::permission}}</li>\n                        </ul>\n                    </info-card-list-template>\n                </info-card>\n            </div>\n        </dialog-body-content-template>\n    </modal-dialog>\n</div>\n'},33450:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33451),a=i(33390);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33489);var u=l((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33490),this.controllerAs="flowCtrl",this.resolve=void 0,t=t||{},this.resolve={[a.m]:[()=>!(!t||!t.isSharedFlow)]}}));r.a.component(n.a.components.flow,new u)},33451:function(e,t,i){"use strict";i.d(t,"a",(function(){return di}));var r=i(33279),n=i(14751),o=i.n(n),a=i(11795),s=i(33327),l=i(33396),c=i(33452),u=i(33453),d=i(13274),p=i(33360),h=i(33374),m=i(28985),g=i(20807),f=i(33454),v=i(33437),b=i(33354),y=i(11891),w=i(15478),S=i.n(w),C=i(33383),k=i(33353),P=i(33455),x=i(33390),A=i(33456),T=i(33357),R=i(16926),O=i(17208),D=i(13272),E=i(17214),F=i(19719),I=i(33394),j=i(33463),N=i(33465),M=i(33466),L=i(33467),U=i(33468),B=i(13016),q=i(33469),W=i(20354),z=i(14754),H=i.n(z),V=i(33393),_=i(19865),G=i(14875),K=i(19891),X=i(20897),Q=i(19906),J=i(16806),Y=i(18960),Z=i(17280),ee=i(12364),te=i(15402),ie=i(33470),re=i(15430),ne=i(13121),oe=i(20735),ae=i(28034),se=i(27977),le=i(33471),ce=i(27983),ue=i(17451),de=i(12366),pe=i(12367),he=i(15459),me=i(21013),ge=i(13240),fe=i(20789),ve=i(28996),be=i(15427),ye=i(20892),we=i(17228),Se=i(14867),Ce=i(13009),ke=i(33384),Pe=i(14895),xe=i(20915),Ae=i(12345),Te=i(15420),Re=i(20908),Oe=i(19863),De=i(14877),Ee=i(14835),Fe=i(14900),Ie=i(12339),je=i(17258),Ne=i(14839),Me=i(16811),Le=i(15509),Ue=i(15339),Be=i(13e3),$e=i(13202),qe=i(20913),We=i(11804),ze=i(17211),He=i(22337),Ve=i(20020),_e=i(14873),Ge=i(28980),Ke=i(33375),Xe=i(33472),Qe=i(14894),Je=i(15330),Ye=i(33473),Ze=i(28983),et=i(33475),tt=i(17210),it=i(20920),rt=(i(20098),i(20096),i(20100),i(33478)),nt=i(30966),ot=i(13144),at=i(12754),st=i(33481),lt=i(14901),ct=i(19924),ut=i(20378),dt=i(33482),pt=i(19997),ht=i(17367),mt=i(20887),gt=i(20767),ft=i(17914),vt=i(19907),bt=i(16749),yt=i(33483),wt=i(17212),St=i(14917),Ct=i(22968),kt=i(14916),Pt=i(28029),xt=i(29022),At=i(28998),Tt=i(27976),Rt=i(14905),Ot=i(20008),Dt=i(14947),Et=i(12375),Ft=i(23043),It=i(14682),jt=i(33415),Nt=i(18956),Mt=i(17775),Lt=i(33484),Ut=i(20006),Bt=i(22960),$t=i(22966),qt=i(17776),Wt=i(17961),zt=i(33485),Ht=i(17226),Vt=i(17242),_t=i(33486),Gt=i(11773),Kt=i(13119),Xt=i(17762),Qt=i(22396),Jt=i(13049),Yt=i(33487),Zt=i(17252),ei=i(14852),ti=i(33488);function ii(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function ri(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ii(Object(i),!0).forEach((function(t){ni(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ii(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ni(e,t,i){return(t=li(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function oi(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function ai(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){oi(o,r,n,a,s,"next",e)}function s(e){oi(o,r,n,a,s,"throw",e)}a(void 0)}))}}function si(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,li(r.key),r)}}function li(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var ci=function(e){return e[e.editingFlow=0]="editingFlow",e[e.savingFlow=1]="savingFlow",e[e.savingFlowSucceeded=2]="savingFlowSucceeded",e[e.renderingTestRun=3]="renderingTestRun",e[e.runComplete=4]="runComplete",e[e.savingOrRenderingUndoSnapshot=5]="savingOrRenderingUndoSnapshot",e[e.savingDraftFlow=6]="savingDraftFlow",e}(ci||{}),ui=function(e){return e.saveFlow="saveFlow",e.checkFlow="checkFlow",e.testFlow="testFlow",e.resubmitFlowRun="resubmitFlowRun",e.cancelFlowRun="cancelFlowRun",e.close="close",e.editFlow="editFlow",e.help="help",e.saveFlowDraft="saveFlowDraft",e.discardFlowDraft="discardFlowDraft",e.saveAndApply="saveAndApply",e.openAutomationPanel="openAutomationPanel",e.openCommentingPane="openCommentingPane",e.undo="undo",e.redo="redo",e.saveDraft="saveDraft",e.publish="publish",e.restorePublished="restorePublished",e.switchDesigner="switchDesigner",e.switchDesignerFlowRunDetails="switchDesignerFlowRunDetails",e}(ui||{}),di=function(){function e(t,i,n,o,a,s,u,g,f,w,S,P,O,D,F,j,N,$,W,z,H,X,Y,Z,ee,ie,pe,me,ge,be,we,Se,ke,Pe,xe,Te,Oe,De,Ie,je,Ne,Le,ze,_e,Ke,Xe,Qe,tt,at,st,lt,ct,ut,dt,pt,ht,gt,ft,vt,bt,yt,wt,St,kt,xt,Rt,Ot,Dt,Et,Ft){var It,jt,Nt=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=t,this.$interval=i,this.$q=n,this.$routeParams=o,this.$scope=a,this.$timeout=s,this.$window=u,this.alertService=g,this.algorithms=f,this.apisClient=w,this.appSettings=S,this.clientResources=P,this.connectionsClient=O,this.dateTime=D,this.environmentService=F,this.environmentsClient=j,this.flowCheckerService=N,this.flowConnectionsClient=$,this.flowPermissionsService=W,this.flowRolesClient=z,this.flowRunService=H,this.flowRunsClient=X,this.flowsClient=Y,this.flowTriggerCallbackUrlClient=Z,this.flowTriggerHistoriesClient=ee,this.flowTriggersClient=ie,this.loggingService=pe,this.ngFlowService=me,this.navigationService=ge,this.poll=be,this.promiseHelperService=we,this.sessionService=Se,this.storageCacheFactory=ke,this.telemetry=Pe,this.templatesClient=xe,this.ngUrlService=Te,this.widgetUtilService=Oe,this.isSharedFlow=De,this.modernFlowClient=Ie,this.routeCrafter=je,this.hostCommunicationService=Ne,this.flowService=Le,this.environmentCapabilityService=ze,this.widgetService=_e,this.designerOperationsService=Ke,this.apiOperationService=Xe,this.xrmEntityHttpClient=Qe,this.universalSearchService=tt,this.triggerService=at,this.xrmWorkflowHttpClient=st,this.flowDraftClient=lt,this.assetService=ct,this.presenceService=ut,this.presenceStore=dt,this.flowUndoService=pt,this.planService=ht,this.xrmUserService=gt,this.tokenService=ft,this.graphService=vt,this.xrmRecommendationService=bt,this.cdnService=yt,this.licenseManagementService=wt,this.consentService=St,this.doNotShowAgainService=kt,this.trialDialogService=xt,this.aiHostedModelsService=Rt,this.solutionService=Ot,this.flowSupportCheckerService=Dt,this.neptuneService=Et,this.teamsDeepLinkService=Ft,this.spinner={size:C.c.Large,local:C.a.Local},this.flowDisplayName="",this.originalConnectionReferences=void 0,this.flowPlanError="InvalidPlanForRecurrence",this.servicePrincipalNotProvisionedError="ServicePrincipalNotProvisionedInTenant",this.flowCheckerError="FlowCheckerError",this.invalidOpenApiFlow="InvalidOpenApiFlow",this.backUrl=void 0,this.autoSimulate=void 0,this.hasDefinitionLoaded=!1,this.designerRenderingComplete=!1,this.designerContext={},this.monitorModel=void 0,this.monitorContext=void 0,this.statusAlert={type:k.a.None,message:"",options:{}},this.fullPageErrorModel=void 0,this.isFlowRunnable=!1,this.isFlowRunCompleted=!1,this.isFlowRunPage=void 0,this.isFlowCheckPage=void 0,this.invokeFlowPanelAngularWrapperBindings={flowName:void 0,isOpen:!1,isTestRun:!1,onDone:()=>this.getLastTriggerAndMonitor()},this.flowId=void 0,this.testPanel=void 0,this.flowCheckerPanel=void 0,this.recommendationPanel=void 0,this.contextualHelpPanel={flowName:null,isOpen:!1,searchText:null,title:null,description:null,apiBrandColor:null,apiIconUri:null,documentUrl:null,connectorDisplayName:null,connectorId:null,actionFriendlyName:null,isRecommendation:!1,recommendationContext:null,widgetUtilService:null,cdnService:null,doNotShowAgainService:null,flowClientResources:null,loggingService:null,telemetryService:null,tokenService:null},this.actionHeadingAriaRole="heading",this.actionBackButton=void 0,this.actionHeadingMenu=void 0,this.actionHeadingMessageBar=void 0,this.actionHeadingAdditionalMessageBar=[],this.actionHeadingMessageBarButton=void 0,this.actionHeadingStatusText=void 0,this.actionHeadingTitleText=this.flowDisplayName,this.actionHeadingTitleAriaLabel=void 0,this.actionHeadingTitlePlaceholder=void 0,this.actionHeadingTitleReadonly=!1,this.actionHeadingOnTitleChange=e=>{if(e.target){var t=e.target.value;t.length<de.n&&this.updateFlowDisplayName(t)}},this.actionHeadingRenderRightContent=()=>this.appSettings.featureFlags.enableFlowPresence&&this.hasDefinitionLoaded&&!this.isMonitorEnabled()&&this.flowName&&(this.isSharedFlow||this.isSolutionFlow)?Object(Ye.a)(this.flowName,this.clientResources,this.presenceService,this.presenceStore):null,this.flowDrafts=void 0,this.linkedDraftFlowName=void 0,this.currentFlowDraft=void 0,this.flowName=void 0,this.flowRunName=void 0,this.isMigrationSourceFlowRun=!1,this.flowDefinitionTriggerName=void 0,this.initRemediationPane=!1,this.showRemediationPane=!1,this.unregisterNavigateAway=r.noop,this.flowNeedsSaveBeforeInitComments=!1,this.defaultNpsDialog=void 0,this.shouldShowNpsDialog=!1,this.isFromCreateWizard=void 0,this.flowV3SupportState=void 0,this.actionButton=void 0,this.isXRMConnectionReferenceMode=void 0,this.willClearConnectionNamesFromFlowDefinition=void 0,this.didClearConnectionNamesFromFlowDefinition=!1,this.pageEventCorrelationId=void 0,this.monitorReadyDeferred=void 0,this.designerReadyDeferred=void 0,this.galleryName=void 0,this.templateName=void 0,this.solutionId=void 0,this.flowInterfaceState=ci.editingFlow,this.cachedConnections=void 0,this.pageLoadStart=void 0,this.saveTimeoutPromise=void 0,this.flowRunInitPromise=void 0,this.waitForRunPromise=void 0,this.pageEventData=void 0,this.flowData=void 0,this.lastSavedFlow=void 0,this.backendRPFlowDefinition=void 0,this.currentFlowFromDesigner=void 0,this.isDestroying=!1,this.environmentAccessDeniedDisableSave=!1,this.flow=void 0,this.actionBackButtonDisabled=!1,this.savedProcessId=void 0,this.recommendationModel=void 0,this.countByRecommendedConnector=void 0,this.useCDSDirectCommunication=!1,this.checkCdsDirectCommunicationSupportedCapabilityPromise=void 0,this.nodeIdToOperationIdMapping={},this.isNextSelectActionTriggeredByCommentPane=!1,this.previousFlowStateForUndo=null,this.previousSelectedActionOrTriggerForUndo=null,this.isUndoButtonDisabled=!0,this.isRedoButtonDisabled=!0,this.isPerformingUndoOrRedo=!1,this.isManagedSolutionFlowResolvedValue=void 0,this.isCustomizableSolutionFlowResolvedValue=void 0,this.easyAutomationPromptEventCorrelationId=void 0,this.activeLayerExists=!1,this.layerRouteSolutionId=void 0,this.thisFlowCannotBeEditedWarningActive=!1,this.userCanAccessSolution=!1,this.currentXrmUserId=null,this.easyAutomationPanelStore=void 0,this.createFromNaturalLanguage=void 0,this.isNL2FlowSaveTemplateIdError=!1,this.defaultedToSolution=!1,this.environmentSponsoredConnectorNames=[],this.userDetailsStoreInstance=void 0,this.connectionIdToXRMLogicalNameMapping={},this.getFlowExpandParams=Object(l.a)(),this.isNL2FlowWidgetInTeams=()=>this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.isNL2FlowWidget()&&this.widgetUtilService.isTeamsContext(),this.shouldShowNL2FlowFooter=()=>this.isNL2FlowWidgetInTeams()&&Object(Ut.a)()&&this.hasDefinitionLoaded,this.getNL2FlowWidgetFooterButtonProps=()=>[{text:this.clientResources.Common.Back,onClick:()=>{var e,t=null!==(e=this.backUrl)&&void 0!==e?e:Me.x;this.unregisterNavigateAway(),this.navigationService.navigate(t)}},{primary:!0,disabled:this.shouldDisableSaveFlowButton(),text:this.clientResources.Create.NL2FlowWizard.FinalizeFlowStep.CreateFlowButtonText,onClick:()=>{this.onSave()}}],this.onClickEditInWorkflowsApp=()=>{var e,t;this.widgetUtilService.isTeamsContext()&&this.widgetUtilService.isWidgetPage()||this.loggingService.logWarning("flowCtrl.onClickEditInWorkflowsApp","Edit in Workflows App only available in Teams context with widgets");var i=new URL(window.location.href);i.searchParams.set("loadNL2FlowStoreFromStorage","true"),Ve.a.userFinalizedFlowToLoad=Object(Gt.toJS)(this.currentFlowFromDesigner),null===(e=Wt.a.get())||void 0===e||e.setNL2FlowStore(Ve.a),null===(t=Wt.a.get())||void 0===t||t.setNL2FlowCreateUrl(i.toString()),this.teamsDeepLinkService.goToCreateTabNL2FlowFullDesigner()},this.removeDraftButtonAction=ai((function*(){var e=Nt.flow;if(e&&e.properties&&e.properties.workflowEntityId){var t=Nt.loggingService.profileStart(b.a.removeDraftCommandStart);try{yield Nt.flowService.restoreLastPublishedSolutionFlow(e.name),Nt.loggingService.profileEndWithSuccess(t,b.a.removeDraftCommandStart,{flowName:e.name,workflowId:e.properties.workflowEntityId}),Nt.showRemoveDraftSuccessMessageBar()}catch(o){var i=Object(V.k)(o,Nt.loggingService),r=Object(Ce.y)(i),n=Object(Ce.db)(o,Nt.clientResources.Common.SomethingWentWrong);Nt.showAlert(B.c.error,n),Nt.loggingService.profileEnd(t,b.a.removeDraftCommandEnd,r,{flowName:e.name,workflowId:e.properties.workflowEntityId})}}})),this.forwardToSolutionComponentLayerPageFunction=()=>{var e;this.forwardToSolutionComponentLayerPage(null===(e=this.flow)||void 0===e?void 0:e.properties.workflowEntityId)},this.onSetRecommendationContext=e=>{this.contextualHelpPanel.recommendationContext=e},this.onInvokeSearch=e=>this.universalSearchService.searchSupport(e,void 0),this.openUnsupportedV3FlowModal=()=>this.updateFlowIsUnsupportedInV3Reasons().then(()=>{this.flowV3SupportState.wasRedirectedFromV3&&(this.flowV3SupportState.currentlyLoadedFlowIsSupported?this.$scope.$applyAsync(()=>{this.showOrHideUnsupportedFlowBannerIfNeeded(),this.updateActionHeading()}):Object(Pt.a)($e.a,{telemetryService:this.telemetry,clientResources:this.clientResources,unsupportedResults:this.flowV3SupportState.cachedUnsupportedReasons,flowName:this.flowName,shouldNavigateOnClose:!1}))}),this.onOperationItemClicked=(e,t,i)=>{this.telemetry.tagEvent(v.a.FlowCheckerPanelCellClicked,null,{flowName:this.flowName,operationClicked:{groupId:t,parameterId:i}}),this.designerContext.navigateTo(e,t,i),this.flowCheckerPanel.isOpen=!1},this.setCallback=(e,t)=>{var i=t||x.g.manual;return e?this.flowTriggerCallbackUrlClient.post({id:Object(U.a)(e,i,this.environmentService)},{}).then(e=>{var t=e.data.response,r=t&&t.value||"",n=t&&t.method||"",o=t.relativePath;if(o){r=t.basePath,"/"===o.charAt(0)?r+=o:r+="/"+o;var a=t.queries,s="?";Object.keys(a).forEach(e=>{var t="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a[e]),"&");s+=t}),r+=s=s.slice(0,-1)}this.setUpdateCallbacks({[i]:{urlTemplate:r,method:n}})}).catch(e=>409===e.status&&e.data&&e.data.error&&e.data.error.code===U.b?this.$q.resolve():this.$q.reject(e)):this.$q.resolve()},this.hasHttpRequestTrigger=e=>{if(!e||!e.triggers)return!1;var t=e.triggers,i=[];return Object.keys(t).forEach(e=>{var r=t[e];(y.a(r.kind,x.f.HTTP)||y.a(r.kind,x.f.TEAMSWEBHOOK))&&y.a(r.type,x.g.httpRequestTrigger)&&i.push(r)}),i.length>0},this.processOnCloudFlowSaveChangeDetection=function(){var e=ai((function*(e){return Nt.promiseHelperService.toAngularPromise(Object(te.b)({loggingService:Nt.loggingService,promise:Nt.flowService.processOnCloudFlowSaveChangeDetection({originalFlow:e.originalFlow,isSharedFlow:e.isSharedFlow,workflowEntityId:Object(R.g)(Nt.flow),props:e.props}).then(t=>{if(t)throw Object(rt.a)($e.a,e.props),new Ce.b(I.c.BackendFlowHasChangedError,"Flow has changed after the last retrieval.")}),eventStartName:"FlowCtrl.processOnCloudFlowSaveChangeDetection.Start",eventEndName:"FlowCtrl.processOnCloudFlowSaveChangeDetection.End",eventData:Nt.getDefaultFlowEventData()}))}));return function(t){return e.apply(this,arguments)}}(),this.onMessageBarDismiss=()=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.ActionHeadingMessageBarDismissed),this.actionHeadingMessageBar=null})},this.onInadequateQuotaLinkClick=()=>{this.$scope.$applyAsync(()=>{var e;e=this.sessionService.isConsumerDomain?J.b.blockedFeatureUpgradeToPro:J.b.blockedFeatureStartTrial,Object(J.e)({dialogType:e,appSettings:this.appSettings,clientResources:this.clientResources,planService:this.planService,planStore:Ue.a,sessionStore:Be.a,surfaceStore:$e.a,telemetryService:this.telemetry,graphService:this.graphService,assetService:this.assetService,licenseManagementService:this.licenseManagementService,licenseManagementStore:it.a,neptuneService:this.neptuneService,consentService:this.consentService,cdnService:this.cdnService,loggingService:this.loggingService,userDetailsStore:this.userDetailsStoreInstance,featureFlags:this.appSettings.featureFlags})})},this.onSave=()=>{this.dismissAllPanels(),this.trySaveFlow()},this.trySaveFlow=ai((function*(){return Nt.telemetry.tagEvent(v.a.SaveFlowClicked),Nt.save().catch(e=>{var t=Object(Ce.L)(e);if(!t.isExcluded)throw e;if(t.logMessage){var i=Object(_t.a)(e);Nt.loggingService.logWarning("trySaveFlow",i)}})})),this.initializeUndo=()=>{He.a.resetState()},this.triggerSaveSnapshotCheckForUndo=e=>!this.appSettings.featureFlags.enableUndoForDesigner||this.isPerformingUndoOrRedo?this.$q.resolve():this.getFlowFromDesigner(!0).then(t=>{if(t)if(Object(p.o)(this.previousFlowStateForUndo)||Object(M.b)(this.previousFlowStateForUndo,t.properties)||Object(M.a)(this.previousFlowStateForUndo,t.properties)){if(this.isPerformingUndoOrRedo)return this.$q.resolve();this.previousFlowStateForUndo=t.properties,this.promiseHelperService.toAngularPromise(this.saveSnapshotForUndo(t)).then(()=>{var t;null!=e&&(this.previousSelectedActionOrTriggerForUndo=null==e||null===(t=e.action)||void 0===t?void 0:t.name)})}else{var i;if(null!=e)this.previousSelectedActionOrTriggerForUndo=null==e||null===(i=e.action)||void 0===i?void 0:i.name}else this.loggingService.logWarning("FlowCtrl.onSelectedActionOrTriggerChanged.getFlowFromDesignerForUndo","Failed to get flow from designer. Flow is undefined.");return this.$q.resolve()}).catch(e=>{var t=Object(_t.a)(e);this.loggingService.logWarning("FlowCtrl.onSelectedActionOrTriggerChanged.getFlowFromDesignerForUndo",Object(Ce.db)(t),{flowName:this.flowName,sanitizedError:t})}),this.saveSnapshotForUndo=e=>this.flowUndoService.saveSnapshot(e,this.previousSelectedActionOrTriggerForUndo).then(()=>this.updateUndoRedoButtonEnablity()).catch(e=>{var t=Object(_t.a)(e);this.loggingService.logError("FlowCtrl.saveSnapshotForUndo",t,{flowName:this.flowName})}),this.onXRMSaveDraft=()=>(this.telemetry.tagEvent(v.a.XRMSaveDraftFlowClicked),this.dismissAllPanels(),this.xrmSaveDraft().catch(e=>{var t=Object(Ce.L)(e);if(!t.isExcluded)throw e;t.logMessage&&this.loggingService.logWarning("tryXRMSaveDraftFlow",t.logMessage)})),this.onXRMPublish=()=>(this.telemetry.tagEvent(v.a.XRMPublishFlowClicked),this.dismissAllPanels(),this.xrmSaveDraft(!1,!0).catch(e=>{var t=Object(Ce.L)(e);if(!t.isExcluded)throw e;t.logMessage&&this.loggingService.logWarning("tryXRMSaveDraftFlow",t.logMessage)})),this.onXRMRestorePublished=()=>(this.telemetry.tagEvent(v.a.XRMRestorePublishedClicked),this.dismissAllPanels(),this.xrmRestoreLastPublished()),this.onTest=()=>{this.telemetry.tagEvent(v.a.TestFlowPanelOpened),this.testPanel.isOpen=!0,this.dismissAllPanels(),this.getFlowFromDesigner().then(e=>{this.testPanel.flowIsDirty=Object(M.c)(this.lastSavedFlow.properties,e.properties);var t=this.getDesignerTriggerFromFlow(e),i=this.getApiSwaggerForDesignerOperation(e,t),r=T.q(i,this.getDesignerTriggerOperationId(t));this.testPanel.flowIsSimulateTriggerSupported=!!r&&this.isSimulateTriggerSupported(r),this.testPanel.flowIsTriggerConcurrencyEnabled=this.isTriggerConcurrencyEnabled(t),this.testPanel.triggerConnectorDisplayName=i?this.getConnectorNameForDesignerTrigger(i):null,this.updateTriggerHintForTestPane()}).catch(e=>{this.closeTestPanel(),Object(Ce.G)(e)?(this.telemetry.tagEvent(v.a.FlowCheckerPanelOpenedOnTest),this.openFlowCheckerPanel()):this.showAlert(B.c.error,Object(Ce.db)(e))}),this.getPreviousRuns()},this.onFlowCheckerButtonClicked=()=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.FlowCheckerPanelOpenedOnClick),this.openFlowCheckerPanel(),this.flowCheckerPanel.isOpen=!this.flowCheckerPanel.isOpen,this.dismissAllPanels()})},this.onDiscardDraft=()=>{this.telemetry.tagEvent(v.a.DeleteFlowDraftClicked),this.flowDraftClient.deleteFlowDraft(this.linkedDraftFlowName),this.currentFlowDraft.linkedApiFlowName?this.navigateToFlow(this.currentFlowDraft.linkedApiFlowName):this.navigateToFlowDraftsListPage()},this.areProcessAdvisorRecommendationsEnabled=()=>this.appSettings.featureFlags.enableProcessAdvisorRecommendations&&this.processId,this.dismissAllPanels=()=>{this.dismissContextualHelpPanel(),this.dismissRecommendationPanel()},this.dismissRecommendationPanel=()=>{this.recommendationPanel.isOpen&&(this.telemetry.tagEvent(v.a.RecommendationPanelOnDismiss,this.createRecommendationTelemetryData()),this.setRecommendationPanelVisibility(!1))},this.openRecommendationPanel=()=>{if(this.countByRecommendedConnector){var e=Object.keys(this.countByRecommendedConnector),t=e.length>30,i=e.slice(0,30),r={};for(var n of i)r[n]=this.countByRecommendedConnector[n];this.telemetry.tagEvent(v.a.RecommendationPanelOnOpen,this.createRecommendationTelemetryData({recommendedConnectors:r,isPartial:t})),this.setRecommendationPanelVisibility(!0)}},this.toggleRecommendationPanel=()=>{this.setRecommendationPanelVisibility(!this.recommendationPanel.isOpen)},this.setRecommendationPanelVisibility=e=>{e&&this.dismissContextualHelpPanel(),this.$scope.$applyAsync(()=>{this.recommendationPanel.isOpen=e})},this.loadConnectors=()=>{var e=this.loggingService.profileStart(b.a.RecommendationLoadConnectorsStart);return this.designerOperationsService.getOperationGroups().then(t=>(this.loggingService.profileEndWithSuccess(e,b.a.RecommendationLoadConnectorsEnd),t.data.value)).catch(t=>{throw this.loggingService.profileEnd(e,b.a.RecommendationLoadConnectorsEnd,Object(V.j)(t),t),t})},this.createRecommendationTelemetryData=e=>{var t,i={flowName:null===(t=this.flow)||void 0===t?void 0:t.name,processId:this.processId};return e&&(i=ri(ri({},i),e)),i},this.toRecommendation=(e,t,i)=>({connectorFriendlyName:e.properties.displayName,apiBrandColor:e.properties.brandColor,apiIconUri:e.properties.iconUri,openConnectorRecommendation:()=>{this.telemetry.tagEvent(v.a.RecommendationPanelOnDisplayConnector,this.createRecommendationTelemetryData({connectorIndex:i,connectorId:this.getConnectorShortName(t)})),this.designerContext.openConnectorRecommendation(t)}}),this.loadRecommendationInfo=()=>{var e=this.loggingService.profileStart(b.a.RecommendationLoadRecommendationsStart);return this.xrmRecommendationService.retrieveProcessRecommendations(this.processId).then(t=>(this.loggingService.profileEndWithSuccess(e,b.a.RecommendationLoadRecommendationsEnd),t)).catch(t=>{this.loggingService.profileEnd(e,b.a.RecommendationLoadRecommendationsEnd,Object(V.j)(t),t)})},this.initializeRecommendationPanel=(e,t)=>{var i=e.reduce((e,t)=>ri(ri({},e),{},{[t.id]:t}),{}),r="",n=[];if(this.countByRecommendedConnector={},t&&(r=t.processName,""===this.flowDisplayName&&this.updateFlowDisplayName(r),t.recommendationModel)){this.recommendationModel=t.recommendationModel;var o=0;this.recommendationModel.RecommendedConnectors.forEach(e=>{var t=e.ConnectorsUniqueNames.map(e=>{var t,r=i[e];if(void 0!==r){var n=this.getConnectorShortName(e);return this.countByRecommendedConnector[n]=(null!==(t=this.countByRecommendedConnector[n])&&void 0!==t?t:0)+1,this.toRecommendation(r,e,o++)}}).filter(e=>void 0!==e);t.length>0&&n.push({activityName:e.ActivityName,connectorRecommendations:t})})}var a=c.d.connectorId,s=i[a],l=this.toRecommendation(s,a,-1);this.$scope.$applyAsync(()=>{this.recommendationPanel.processName=r,this.recommendationPanel.activityRecommendations=n,this.recommendationPanel.defaultConnectorRecommendation=l})},this.loadRecommendations=()=>{if(this.areProcessAdvisorRecommendationsEnabled()){var e=this.loggingService.profileStart(b.a.RecommendationPanelLoadContentStart);return Promise.all([this.loadConnectors(),this.loadRecommendationInfo()]).then(t=>{var[i,r]=t;this.initializeRecommendationPanel(i,r),this.loggingService.profileEndWithSuccess(e,b.a.RecommendationPanelLoadContentEnd),this.openRecommendationPanel()}).catch(t=>{throw this.loggingService.profileEnd(e,b.a.RecommendationPanelLoadContentEnd,Object(V.j)(t),t),t})}return Promise.resolve()},this.getConnectorShortName=e=>e.split("/").pop(),this.logRecommendationTelemetryOnSave=e=>{if(this.recommendationModel&&this.countByRecommendedConnector){var t=Object.keys(this.countByRecommendedConnector),i=[],r=[];e.properties.definitionSummary.actions.filter(e=>e.api).forEach(e=>{var n=this.getConnectorShortName(e.api.id);t.includes(n)?i.push(n):r.push(n)});var n=t.filter(e=>!i.includes(e)),o=r.length>30;r=r.slice(0,30),this.telemetry.tagEvent(v.a.RecommendationOnFlowSave,this.createRecommendationTelemetryData({recommendedUsedConnectors:i,recommendedUnusedConnectors:n,notRecommendedUsedConnectors:r,isPartial:o}))}},this.openFlowCheckerPanel=(e,t,i)=>{var r=this.loggingService.profileStart(b.a.FlowCheckerPanelLoadContentStart,{hideIfEmpty:e,forceOverride:t,isOnDesignerFlowChanged:i}),n=this.loggingService.profileStart(b.a.flowCheckerClientValidationStart);this.$q.all([this.designerContext.getParameters(),this.designerContext.getActions(),this.designerContext.getTriggers()]).then(i=>{var[r,o,a]=i,s=Object(L.a)(r);return this.$scope.$applyAsync(()=>{var i=t&&!this.flowCheckerPanel.isOpen;this.flowCheckerPanel.actions=o,this.flowCheckerPanel.parametersErrors=s,this.flowCheckerPanel.triggers=a,this.flowCheckerPanel.isSolutionFlow=this.isSolutionFlow,this.flowCheckerPanel.isCurrentUserFlowOwner=Object(et.f)(this.isNewFlow,Be.a,this.flowData,this.isSolutionFlow),this.flowCheckerPanel.isOpen=!(e&&0===this.flowCheckerPanel.parametersErrors.length||i),this.updateActionHeading()}),this.loggingService.logWarning(b.a.flowCheckerClientValidationEnd,"flowCtrl.openFlowCheckerPanel.flowCheckerClientValidationEnd",{flowName:this.flowName,flowRunName:this.flowRunName,parametersErrors:s},n),this.getFlowFromDesigner(!0)}).then(e=>{var t,r;return null!=e&&null!==(t=e.properties)&&void 0!==t&&t.connectionReferences&&this.transformConnectionReferences(e.properties.connectionReferences),null!=e&&e.properties&&(e.properties.solutionId=this.solutionId),null!=e&&e.properties&&null!==(r=this.flowData)&&void 0!==r&&r.properties&&(e.properties.plan=this.flowData.properties.plan,e.properties.workflowEntityId=this.flowData.properties.workflowEntityId,e.properties.creator=this.flowData.properties.creator),e?this.$q.all([this.flowCheckerService.findFlowCheckerResult(q.a.error,e,this.flowName,i),this.flowCheckerService.findFlowCheckerResult(q.a.warning,e,this.flowName,i)]):null}).then(i=>{var[n,o]=i;if(this.flowData&&(o=[...o,...this.getFlowCheckersWarningsForPowerAppsTriggeredFlows(this.currentFlowFromDesigner.properties)]),Object(At.b)()?o=[...o,...Object(ve.b)(this.currentFlowFromDesigner.properties,this.clientResources)]:n.some(e=>e.ruleId===_.b.FlowAiBuilderGptHITLChecker)||(n=[...n,...Object(ve.b)(this.currentFlowFromDesigner.properties,this.clientResources)]),Object(At.a)()?o=[...o,...Object(ve.a)(this.currentFlowFromDesigner.properties,this.clientResources)]:n.some(e=>e.ruleId===_.b.FlowAiBuilderCustomPromptHITLChecker)||(n=[...n,...Object(ve.a)(this.currentFlowFromDesigner.properties,this.clientResources)]),n||o){Object(le.b)(this.clientResources,n),Object(le.a)(this.clientResources,o,this.solutionId,this.flowName,this.routeCrafter),o&&(o=Object(ce.b)(this.clientResources,this.appSettings.featureFlags,o));var a=0===this.flowCheckerPanel.parametersErrors.length&&0===n.length&&0===o.length;this.$scope.$applyAsync(()=>{var i=t&&!this.flowCheckerPanel.isOpen;this.flowCheckerPanel.flowCheckerErrors=n,this.flowCheckerPanel.flowCheckerWarnings=o,this.flowCheckerPanel.isOpen=!(e&&a||i),this.updateActionHeading()})}function s(e){var t=[];return Object.keys(e).forEach(i=>{var r,n=e[i];n={fixInstructions:{messageId:null===(r=n.fixInstructions)||void 0===r?void 0:r.messageId},ruleId:n.ruleId},t.push(n)}),t}var l={connectionErrors:this.flowCheckerPanel.connectionErrors,connectionWarnings:this.flowCheckerPanel.connectionWarnings,flowCheckerErrors:s(n),flowCheckerWarnings:s(o),isCurrentUserFlowOwner:this.flowCheckerPanel.isCurrentUserFlowOwner,isSolutionFlow:this.flowCheckerPanel.isSolutionFlow,parametersErrors:this.flowCheckerPanel.parametersErrors};this.loggingService.profileEndWithSuccess(r,b.a.FlowCheckerPanelLoadContentEnd,l)}).catch(e=>{!t&&this.showAlert(B.c.error,Object(Ce.db)(e));var i=Object(_t.a)(e);this.loggingService.profileEnd(r,b.a.FlowCheckerPanelLoadContentEnd,Object(Ce.y)(e),i),this.loggingService.logError("flowCtrl.openFlowCheckerPanel",i,{flowName:this.flowName})})},this.onFlowCheckerPanelDismissed=()=>{this.flowCheckerPanel.isOpen=!1,this.telemetry.tagEvent(v.a.FlowCheckerPanelClosed)},this.onRecommendationPanelDismiss=()=>{this.recommendationPanel.isOpen=!1,this.telemetry.tagEvent(v.a.RecommendationPanelOnClose,this.createRecommendationTelemetryData())},this.closeTestPanel=()=>{this.testPanel.isOpen=!1},this.onTestPanelIsDismissed=()=>{this.testPanel.isOpen=!1,this.testPanel.selectedChoice=null,this.testPanel.selectedSubChoice=null,this.testPanel.selectedRun=null,this.telemetry.tagEvent(v.a.TestFlowPanelClosed)},this.onContextualHelpPanelIsDismissed=()=>{this.contextualHelpPanel.isOpen=!1,this.contextualHelpPanel.searchText=null,this.contextualHelpPanel.title=null},this.onTestPanelChoiceChange=(e,t)=>{this.testPanel.selectedChoice=t.key,this.telemetry.tagEvent(v.a.TestFlowPanelChoiceClicked,{option:t.key})},this.onTestPanelAutomaticallySubChoiceChange=(e,t)=>{this.testPanel.selectedSubChoice=t.key,this.telemetry.tagEvent(v.a.TestFlowPanelAutomaticallySubChoiceClicked,{option:t.key})},this.onTestPanelRunChoiceChange=(e,t)=>{this.testPanel.selectedRun=t.key,this.telemetry.tagEvent(v.a.TestFlowPanelRunChoiceClicked,{option:t.key})},this.onInvokeFlowAsTest=()=>{this.telemetry.tagEvent(v.a.TestFlowPanelInvokedFlow,{runnable:this.isFlowRunnable});var e=this.loggingService.profileStart(b.a.TestFlowInvokeFlowStart,{runnable:this.isFlowRunnable});this.getFlowFromDesigner().then(e=>this.saveIfDirty(e)).then(()=>{this.isFlowRunnable?this.onRunNow():(this.setInterfaceState(ci.savingFlowSucceeded),this.pollForNewRun(!1,null,!0))}).then(()=>{this.loggingService.profileEndWithSuccess(e,b.a.TestFlowInvokeFlowEnd,{runnable:this.isFlowRunnable})}).catch(t=>{this.showAlert(B.c.error,Object(Ce.db)(t)),this.loggingService.profileEnd(e,b.a.TestFlowInvokeFlowEnd,Object(Ce.y)(t),t,{runnable:this.isFlowRunnable})}).finally(()=>{this.updateActionHeading(),this.closeTestPanel()})},this.onInvokeRunAsTest=()=>{var e=this.loggingService.profileStart(b.a.TestFlowResubmitRunStart),t=this.testPanel.previousRuns.find(e=>e.name===this.testPanel.selectedRun);this.telemetry.tagEvent(v.a.TestFlowPanelInvokedRun,{runName:t.name});var i=t.properties.trigger.name;this.getFlowFromDesigner().then(e=>this.saveIfDirty(e)).then(()=>this.flowTriggerHistoriesClient.resubmitAsTest({flowName:this.flowName,flowTriggerName:i,flowTriggerHistoryId:t.name})).then(()=>{this.loggingService.profileEndWithSuccess(e,b.a.TestFlowResubmitRunEnd,{resubmittedRun:void 0}),this.getLastTriggerAndMonitor()}).catch(t=>{var r=i!==Object(Ee.y)(this.flowData);this.loggingService.profileEnd(e,b.a.TestFlowResubmitRunEnd,r?Ce.e.Warning:Object(Ce.y)(t),t,{resubmittedRun:void 0}),this.showAlert(B.c.error,Object(Ce.db)(t))}).finally(()=>{this.updateActionHeading(),this.closeTestPanel()})},this.onInvokeSimulate=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Nt.loggingService.profileStart(b.a.testFlowInvokeSimulateStart),i=Object(Ee.y)(Nt.flowData),r=Object(Ee.z)(Nt.flowData);Nt.telemetry.tagEvent(v.a.TestFlowPanelInvokedSimulate,{triggerName:i,autoSimulate:e}),Nt.getFlowFromDesigner().then(e=>Nt.saveIfDirty(e)).then(()=>Nt.flowTriggersClient.simulate({flowName:Nt.flowName,triggerName:i})).then(n=>{var o=n&&n.headers&&n.headers();Nt.loggingService.profileEndWithSuccess(t,b.a.testFlowInvokeSimulateEnd,{triggerName:i,operationId:r,autoSimulate:e}),Nt.setInterfaceState(ci.savingFlowSucceeded),Nt.pollForNewRun(!1,Nt.flowData,!1,!0,o[x.n.clientTrackingId])}).catch(n=>{Nt.showAlert(B.c.error,Object(Ce.db)(n)),Nt.loggingService.profileEnd(t,b.a.testFlowInvokeSimulateEnd,Object(Ce.y)(n),n,{flowName:Nt.flowName,triggerName:i,operation:r,autoSimulate:e})}).finally(()=>{Nt.updateActionHeading(),Nt.closeTestPanel()})},this.getLastTriggerAndMonitor=()=>{var e,t,i=this.loggingService.profileStart(b.a.getLastTriggerAndMonitorStart),r=Object(Ee.y)(this.flowData),n={flowName:this.flowName,flowTriggerName:r};(t=this.flowTriggerHistoriesClient.query(this.$scope,n)).$promise.then(()=>this.flowTriggerHistoriesClient.refreshQuery(n)).then(()=>(e=t[0].properties.run,this.renderTestRunState(e),this.monitorReadyDeferred.promise)).then(()=>this.flowRunService.waitForFlowRunToComplete(this.$scope,e,this.monitorContext,this.flowRunCompleted)).then(t=>{this.showRunStatus(t),this.loggingService.profileEndWithSuccess(i,b.a.getLastTriggerAndMonitorEnd,{flowName:this.flowName,lastRun:e})}).catch(t=>{this.loggingService.profileEnd(i,b.a.getLastTriggerAndMonitorEnd,Object(Ce.y)(t),t,{flowName:this.flowName,lastRun:e}),this.loggingService.logError("FlowCtrl.getLastTriggerAndMonitor",t),this.showErrorMessageInAlert(t)})},this.onFlowDesignerClose=()=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.FlowDesignerCloseClicked),this.miniWidgetGoBack()})},this.onFlowDesignerSaveAndApply=()=>{this.$scope.$applyAsync(ai((function*(){var e=Nt.loggingService.profileStart(b.a.widgetSaveAndApplyFlowInDesignerStart);try{yield Nt.trySaveFlow(),Nt.hostCommunicationService.triggerHostEvent(We.e.FLOW_APPLY,{flowName:Nt.flowName,flowId:Nt.flow.id,managementUri:Object(ot.f)(Nt.appSettings)}),Nt.actionHeadingMessageBar={type:B.c.success,message:Object(p.d)(Nt.clientResources.Flow.Commands.ApplyFlow,Nt.flowDisplayName),onDismiss:Nt.onMessageBarDismiss},Nt.loggingService.profileEndWithSuccess(e,b.a.widgetSaveAndApplyFlowInDesignerEnd)}catch(i){var t=Object(Ce.db)(i);Nt.actionHeadingMessageBar={type:B.c.error,message:t,onDismiss:Nt.onMessageBarDismiss},Nt.loggingService.profileEnd(e,b.a.widgetSaveAndApplyFlowInDesignerEnd,Object(Ce.y)(i),i)}})))},this.onActionHeadingBackClick=()=>{this.isFromCreateWizard||this.isFlowRunPage?window.history.back():(this.widgetUtilService.fireDesignerBackButtonClicked(),this.widgetUtilService.isTeamsSolutionExplorerContext()?this.widgetUtilService.fireWidgetCloseEvent():this.widgetService.widgetCloseOnFlowSaveEnabled()&&this.widgetService.fireWidgetCloseOnFlowSave())},this.initializeCommenting=()=>{this.flowNeedsSaveBeforeInitComments=!1;var e=Object(R.c)(this.flow),t=Object(R.g)(this.flow);Re.a.resetPaneStore();var i=Ae.a.currentEnvironment.hasXrmInstance,r=!this.isManagedSolutionFlowResolvedValue,n=!!e,o=this.flowInterfaceState===ci.editingFlow||this.flowInterfaceState===ci.savingFlow||this.flowInterfaceState===ci.savingFlowSucceeded;if(i&&r&&n&&o){var a=this.loggingService.profileStart(b.a.commentsInitializeStart);return this.fetchCommentingContextMap().then(()=>{var i;Object(ae.c)({commentingPaneStore:Re.a,flowDisplayName:this.flow.properties.displayName,flowName:this.flow.name,getUrlForComment:e=>Object(Tt.b)(e,this.flow,{environmentName:this.environmentService.getCurrentEnvironmentName(),portalUrl:this.appSettings.portalUrl,solutionId:this.solutionId}),getUsersAbleToComment:(i=ai((function*(){return(yield Nt.flowPermissionsService.getFlowOwners(Nt.flow,Nt.$scope)).owners.map(e=>({userPrincipalName:e.email}))})),function(){return i.apply(this,arguments)}),initiallyHighlightedComment:(()=>{if(this.appSettings.featureFlags.enableCommentingMentions){var e=Object(h.b)(this.$window.location.search),t=e[se.a],i=e[se.b];if(t&&i)return{anchorId:t,commentId:i}}})(),loggingService:this.loggingService,onError:this.showCommentingError,onReady:this.onCommentingPaneReady,onRequestShareWithUsers:e=>this.onRequestShareComment(e.map(e=>e.userPrincipalName)),onThreadSelected:this.onSelectCommentThread,telemetryService:this.telemetry,workflowEntityId:t}),this.loggingService.profileEndWithSuccess(a,b.a.commentsInitializeEnd,{flowName:e,workflowEntityId:t,isShared:x.m})}).catch(i=>{var r=new URLSearchParams(this.$window.location.search).get(Fe.y),n=Object(Mt.a)({isRunPage:!1,isWidgetPage:this.widgetUtilService.isWidgetPage(),v3UrlParameter:r});this.loggingService.profileEnd(a,b.a.commentsInitializeEnd,n?Ce.e.Warning:Object(Ce.y)(i),i,{flowName:e,workflowEntityId:t,isShared:x.m,isV3:n})})}return Promise.resolve()},this.toggleCommentingPane=()=>{var e=this;e.$scope.$applyAsync(()=>{var t=Object(R.c)(e.flow),i=Object(R.g)(e.flow),r=Re.a.isPaneOpen;r?Re.a.setIsPaneOpen(!1):Re.a.setIsPaneOpen(!0),this.telemetry.tagEvent(v.a.CommentingPaneToggled,{paneOpened:r,context:"button",flowName:t,workflowEntityId:i,shared:e.isSharedFlow})})},this.onSelectCommentThread=e=>{e&&Promise.all([this.designerContext.getTriggers(),this.designerContext.getActions()]).then(t=>{var[i,r]=t,n=i.concat(r),o=n.findIndex(t=>this.getOperationMetadataId(t)===e),a=o>=0&&n[o].nodeId||"";a&&(this.isNextSelectActionTriggeredByCommentPane=!0,this.designerContext.navigateTo(a,null,null))})},this.showCommentingError=e=>{this.loggingService.logError("FlowCtrl.showCommentingError",e);var t=this;t.$scope.$applyAsync(()=>{t.showErrorMessageInAlert(e)})},this.onCommentingPaneReady=e=>{Re.a.setHasCommentingPaneRendered(!0),this.updateActionHeading(),e&&this.toggleCommentingPane()},this.onRequestShareComment=function(){var e=ai((function*(e){var t,i=Array(e.length);try{var r=e.map(e=>Nt.getFlowSharingPrincipal(e));t=yield Promise.all(r)}catch(n){return Nt.loggingService.logError("FlowCtrl.onRequestShare",Object(Ce.hb)(n),{isLegacy:!1}),i.fill(!1)}return new Promise((e,r)=>{var n;Object(Ze.a)($e.a,{onConfirm:(n=ai((function*(){var n=t.map(e=>Nt.flowPermissionsService.addFlowOwner(Nt.flow,e));return Promise.all(n).then(()=>e(i.fill(!0)),e=>r(e)).catch(r)})),function(){return n.apply(this,arguments)}),onDismiss:()=>(e(i.fill(!1)),Promise.resolve()),users:t,clientResources:Nt.clientResources})})}));return function(t){return e.apply(this,arguments)}}(),this.onSaveWithCommenting=()=>{var e=Promise.resolve();Re.a.hasCommentingPaneRendered&&!this.flowNeedsSaveBeforeInitComments||(e=this.initializeCommenting()),e.then(()=>this.fetchCommentingContextMap()).then(()=>this.runOrphanedCommentDeletionInBackground()).catch(e=>{throw this.loggingService.logError("FlowCtrl.onSaveWithCommenting",e,{flowName:Object(R.c)(this.flow),shared:this.isSharedFlow,workflowEntityId:Object(R.g)(this.flow)}),e})},this.fetchCommentingContextMap=()=>Promise.all([this.designerContext.getActions(),this.designerContext.getTriggers()]).then(e=>{var[t,i]=e,r=i.length>0&&this.getOperationMetadataId(i[0]),n=[...r?[r]:[],...t.map(e=>this.getOperationMetadataId(e)).filter(e=>!!e)];Re.a.setActiveContextId(this.flowName),Re.a.setContextWidgetAnchorMap(this.flowName,n),Re.a.setTriggerAnchorId(r)}).catch(e=>{throw this.loggingService.logError("FlowCtrl.fetchCommentingContextMap",e,{flowName:Object(R.c)(this.flow),workflowEntityId:Object(R.g)(this.flow),shared:this.isSharedFlow}),e}),this.getOperationMetadataId=e=>{var t;if(e)return(null===(t=e.metadata)||void 0===t?void 0:t.operationMetadataId)||this.nodeIdToOperationIdMapping[e.nodeId]},this.runOrphanedCommentDeletionInBackground=()=>{Re.a.eventDispatcher(oe.d.DeleteOrphanedComments)},this.transformFlowForCommenting=(e,t,i)=>{var r=ri({},e);return this.updateNodeIdToOperationIdMapping(t,i),Object(Ge.a)(r,i,t,this.nodeIdToOperationIdMapping),r},this.updateNodeIdToOperationIdMapping=(e,t)=>{[...t,...e].forEach(e=>{var t;e.nodeId in this.nodeIdToOperationIdMapping||(this.nodeIdToOperationIdMapping[e.nodeId]=null!==(t=e.metadata)&&void 0!==t&&t.operationMetadataId?e.metadata.operationMetadataId:Object(Ge.b)())})},this.updateTriggerHintForTestPane=()=>{this.getTriggerHint().then(e=>{this.testPanel.triggerHint=e}).catch(e=>{this.loggingService.logError("FlowCtrl.updateTriggerHintForTestPane",e,{displayName:this.testPanel.triggerConnectorDisplayName})})},this.toggleFlowCheckerPane=()=>{this.$scope.$applyAsync(()=>{this.flowCheckerPanel.isOpen=!this.flowCheckerPanel.isOpen})},this.loadTriggerAndAction=(e,t)=>{var i,r;if(e.operationId&&Object(G.i)(this.appSettings,e.operationId)){var n={operationGroupName:e.apiName,operationName:e.operationName};i=this.promiseHelperService.toAngularPromise(this.designerOperationsService.loadOperation(n).then(()=>ye.a.designerOperations.getEntity(K.a.getOperationKey(e.apiName,e.operationName))))}else i=e.operationId&&!Q.a.requiresDefinition(e.operationId)?this.promiseHelperService.toAngularPromise(this.apiOperationService.getApiOperation(Object(nt.a)(e.apiId),e.operationName)):this.$q.resolve(void 0);return null!=t&&t.operationId&&(r=this.promiseHelperService.toAngularPromise(this.designerOperationsService.loadOperation({operationGroupName:t.apiName,operationName:t.operationName}).then(()=>ye.a.designerOperations.getEntity(K.a.getOperationKey(t.apiName,t.operationName))))),r||(r=this.$q.resolve(void 0)),Promise.all([i,r])},this.onEditFlowClicked=()=>{this.$scope.$applyAsync(()=>{if(this.flowRunService.stopFlowRunPolling(),this.$interval.cancel(this.waitForRunPromise),this.onMessageBarDismiss(),this.telemetry.tagEvent(v.a.EditFlowClicked),this.isFlowRunPage){var e=Object(Fe.d)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:this.isSharedFlow});this.navigationService.navigate(e,{backUrl:Object(Fe.m)(this.routeCrafter,{flowName:this.flowName,isLegacyShared:this.isSharedFlow,solutionId:this.solutionId})})}else this.setInterfaceState(ci.editingFlow)})},this.onResubmitFlowRunClicked=()=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.ResubmitFlowRunClicked),confirm(Object(p.d)(this.clientResources.Dialogs.ConfirmFlowRunResubmitMessage,"").replace(/\s+/g," "))?(this.telemetry.tagEvent(v.a.ConfirmResubmitRunYesClicked),this.fetchDefinition().then(()=>this.flowRunService.resubmitFlowRun(this.$scope,this.flowName,this.flowDefinitionTriggerName,this.flowRunName,this.backUrl)).then(e=>this.flowTriggerHistoriesClient.query(this.$scope,{flowName:this.flowName,flowTriggerName:this.flowDefinitionTriggerName})).then(e=>{e.$refresh().then(()=>{var t=e[0].properties.run;this.navigationService.navigate(Object(Fe.n)(this.routeCrafter,{flowName:this.flowName,runName:t.name,isLegacyShared:!1,isUIFlow:!1,solutionId:void 0}),this.backUrl?{backUrl:this.backUrl}:{})})}).catch(e=>{this.loggingService.logError("FlowCtrl.FlowTriggerHistoryResubmit",e),this.showAlert(B.c.error,Object(Ce.db)(e,this.clientResources.Common.SomethingWentWrong))})):this.telemetry.tagEvent(v.a.ConfirmResubmitRunNoClicked)})},this.onCancelFlowRunClicked=()=>{this.$scope.$applyAsync(()=>{this.telemetry.tagEvent(v.a.CancelFlowRunClicked),confirm(Object(p.d)(this.clientResources.Dialogs.ConfirmFlowRunCancelMessage,"").replace(/\s+/g," "))?(this.telemetry.tagEvent(v.a.ConfirmCancelRunYesClicked),this.flowRunService.cancelFlowRun(this.flowName,this.flowRunName,!0===this.isMigrationSourceFlowRun).then(()=>{this.showAlert(B.c.error,this.clientResources.FlowRun.CancelText),this.flowRunCompleted()}).catch(e=>{this.loggingService.logError("FlowCtrl.FlowRunCancel",e),this.showErrorMessageInAlert(e)}).finally(this.updateActionHeading)):this.telemetry.tagEvent(v.a.ConfirmCancelRunNoClicked)})},this.getSaveButtonDisplayText=()=>this.scenario===fe.a.editFlowDraft&&this.appSettings.featureFlags.enableDraftFlows?this.clientResources.Common.Publish:this.clientResources.Common.Save,this.getSaveDraftButtonDisplay=()=>this.clientResources.Common.SaveDraft,this.getPublishButtonDisplay=()=>this.clientResources.Common.Publish,this.shouldDisableSaveFlowButton=()=>this.thisFlowCannotBeEditedWarningActive||this.isTesting()||this.isSaving()||this.environmentAccessDeniedDisableSave,this.shouldDisableSaveDraftFlowButton=()=>this.isXRMConnectionReferenceMode&&this.shouldDisableSaveFlowButton(),this.shouldDisableXRMPublishFlowButton=()=>this.isXRMConnectionReferenceMode&&this.shouldDisableSaveFlowButton(),this.flowRunCompleted=e=>{this.flowInterfaceState!==ci.editingFlow&&(e&&this.showRunStatus(e),this.setInterfaceState(ci.runComplete))},this.toggleRemediationPane=()=>{this.$scope.$applyAsync(()=>{this.showRemediationPane=!this.showRemediationPane})},this.onDismissRemediationPane=()=>{this.$scope.$applyAsync(()=>{this.showRemediationPane=!1})},this.getFlowSharingPrincipal=function(){var e=ai((function*(e){var t;yield Nt.graphService.getUserByMail(e,Nt.appSettings.featureFlags.disableGuestUserSharing);var i=Je.a.users.getEntity(e),r=i.tenantId||(null===(t=Be.a.user)||void 0===t?void 0:t.tenantId),n=Je.a.thumbnailPhotos.getEntity("".concat(r,"/").concat(i.id));return{accessLevel:ue.a.Owner,displayName:i.displayName,email:e,iconUri:n.thumbnailPhoto,id:i.id||i.id,isNonRemovableOwner:!1,type:ue.b.User}}));return function(t){return e.apply(this,arguments)}}(),Object(Ut.a)()&&this.widgetService.isWidgetPage()&&this.widgetService.isTeamsContext()){var Lt,Bt,$t,qt=null===(Lt=Wt.a.get())||void 0===Lt?void 0:Lt.getNL2FlowCreateUrl();if(qt)new URLSearchParams(qt.split("?")[1]).forEach((e,t)=>{o[t]=e}),pe.logInfo("flowCtrl.constructor.updateLocationWithCreateUrlFromStorage","Merging query parameters from deep link.",{createUrl:qt},null!==(Bt=Ve.a.createWizardCorrelationId)&&void 0!==Bt?Bt:null===($t=Oe.widgetInfo)||void 0===$t?void 0:$t.sessionId)}null!==(It=document.querySelector('div[class^="mainContainerStyle"]'))&&void 0!==It&&null!==(It=It.attributes)&&void 0!==It&&It.getNamedItem("tabIndex")&&(null===(jt=document.querySelector('div[class^="mainContainerStyle"]'))||void 0===jt||null===(jt=jt.attributes)||void 0===jt||jt.removeNamedItem("tabIndex"));this.designerReadyDeferred=n.defer(),this.fullPageErrorModel={image:this.assetService.fullPageErrorCreateEditFlow,isPageErrored:!1,pageTitle:this.clientResources.Flow.Editor.PageTitle,time:new Date},this.flowName=o.flowName||null,this.flowRunName=o.flowRunName||null;var zt=Object(h.b)(this.$window.location.search);this.isMigrationSourceFlowRun="true"===zt.isMigrationSource,this.isFlowRunPage=!!this.flowRunName,this.isFlowCheckPage=Object(A.a)(),this.galleryName=o.gallery||null,this.templateName=o.template||null,this.solutionId=o.projectId||o.solutionId||null,this.autoSimulate=o.autoSimulate||!1,this.easyAutomationPanelStore=Object(qe.a)(this.loggingService,this.telemetry),this.defaultNpsDialog={widgetUtilService:this.widgetUtilService,sessionStore:Be.a,environmentStore:Ae.a};var Ht,Vt,Kt=new URLSearchParams(o);(this.backUrl=Object(m.b)(Kt)||null,o[Fe.x.key]===Fe.x.values.fromV3?(this.flowV3SupportState={cachedUnsupportedReasons:void 0,currentlyLoadedFlowIsSupported:!1,wasRedirectedFromV3:!0},this.loggingService.logInfo("FlowCtrl.flowUnsupportedInV3","User landed in v1 designer due to flow not being supported in v3 designer.",this.getDefaultFlowEventData())):this.flowV3SupportState={wasRedirectedFromV3:!1},Object(p.o)(Kt.get("createFromNaturalLanguage"))||(this.createFromNaturalLanguage="true"===Kt.get("createFromNaturalLanguage"),this.loggingService.logInfo(v.a.NL2FlowDesignerOpened,"",this.getDefaultFlowEventData(),Ve.a.createWizardCorrelationId)),Object(Ut.a)()&&"true"===o.createFromNaturalLanguage&&"true"===o.loadNL2FlowStoreFromStorage)&&(Kt.delete("loadNL2FlowStoreFromStorage"),Ve.a.loadStateFromStorage(),this.loggingService.logInfo("FlowCtrl.constructor.loadStateFromStorage","Load NL2Flow Store From Storage",this.getDefaultFlowEventData(),null!==(Ht=Ve.a.createWizardCorrelationId)&&void 0!==Ht?Ht:null===(Vt=Oe.widgetInfo)||void 0===Vt?void 0:Vt.sessionId));if(this.flowService.eventEmitter.on(E.b.showMessage,(e,t)=>this.showAlert(e,t)),this.flowService.eventEmitter.on(E.b.showContextualHelpPanel,()=>this.showContextualHelpPanel()),this.recommendationPanel={isOpen:!1,processName:null,activityRecommendations:[],defaultConnectorRecommendation:null,clientResources:this.clientResources,cdnService:this.cdnService},this.testPanel={flowIsDirty:!1,triggerNewTestRunAllowed:!1,flowIsSimulateTriggerSupported:!1,flowIsTriggerConcurrencyEnabled:!1,isOpen:!1,isDisabled:!1,previousRuns:null,selectedChoice:null,selectedSubChoice:null,selectedRun:null,triggerConnectorDisplayName:null,triggerHint:null,clientResources:this.clientResources,loggingService:this.loggingService},this.flowCheckerPanel={actions:[],connectionErrors:[],connectionWarnings:[],flowCheckerErrors:[],flowCheckerWarnings:[],isOpen:!1,isSolutionFlow:!1,isCurrentUserFlowOwner:!1,featureFlags:this.appSettings.featureFlags,loggingService:this.loggingService,parametersErrors:[],triggers:[],clientResources:this.clientResources,appSettings:this.appSettings,assetService:this.assetService,telemetryService:this.telemetry,planService:this.planService,graphService:this.graphService,licenseManagementService:this.licenseManagementService,neptuneService:this.neptuneService,consentService:this.consentService,cdnService:this.cdnService,userDetailsStore:this.userDetailsStoreInstance,widgetUtilService:this.widgetUtilService,planStore:Ue.a,sessionStore:Be.a,surfaceStore:$e.a,licenseManagementStore:it.a},this.actionHeadingTitleAriaLabel=Object(p.d)(this.clientResources.FlowProperties.ActionHeading.Title.AriaLabel,this.flowDisplayName),this.actionHeadingTitlePlaceholder="",this.isFromCreateWizard=mt.a.isWizardFlowCompleted&&window.history.length>1,mt.a.resetState(),this.$scope.$on("$destroy",()=>{this.isDestroying=!0,this.$timeout.cancel(this.saveTimeoutPromise),this.$interval.cancel(this.waitForRunPromise),this.flowRunService.stopFlowRunPolling(),Object(ae.d)(),this.$document.unbind("keydown",this.onKeyDown)}),this.$document.bind("keydown",this.onKeyDown),this.$timeout(()=>{if(this.widgetUtilService.isWidgetPage()&&Object(d.b)()&&document.getElementsByTagName){var e=document.getElementsByTagName("button");e&&e[0]&&e[0].focus()}}),this.environmentSponsoredConnectorNames=this.environmentService.getSponsoredConnectorNames(),this.pageLoadStart=this.loggingService.performanceNow(),this.pageEventData={galleryName:this.galleryName,flowName:this.flowName,templateName:this.templateName,isSharedFlow:this.isSharedFlow,isSolutionFlow:this.isSolutionFlow},this.useCDSDirectCommunication=!1,this.checkCdsDirectCommunicationSupportedCapabilityPromise=this.solutionId?this.promiseHelperService.toAngularPromise(this.environmentCapabilityService.getIsCdsDirectCommunicationSupportedCapability().then(()=>{var e,t,i=this.environmentService.getCurrentEnvironmentName(),r=re.a.getEnvironmentCapabilityKey({environmentName:i,capabilityName:ne.a.isCdsDirectCommunicationSupported});return this.useCDSDirectCommunication=null!==(e=null===(t=he.a.environmentCapabilities.getEntity(r))||void 0===t?void 0:t.isEnabled)&&void 0!==e&&e,this.useCDSDirectCommunication})):this.$q.resolve(!1),this.flowName){var Xt=Object(l.a)({excludeSwagger:!0});Xt&&(this.getFlowExpandParams=Xt)}this.spinner.show=!0,this.isFlowCheckPage?this.initializeFlowCheckPage():this.isFlowRunPage?this.initializeFlowRunPage():(this.initializeFlowEditPage(),this.updateFlowDisplayName(this.createFromBlankFlowName||""),"true"===Kt.get(Ct.a)&&this.openV3DesignerSurveyPanel(),"true"===Kt.get(Fe.a)&&this.showAlert(B.c.success,this.clientResources.ConvertedConnectionsToConnectionReferencesMessage)),this.getFlowAndSetIsFlowRunnable(this.flowName),this.isFlowDraftEditMode()&&(this.linkedDraftFlowName=this.flowName),Oe.fireWidgetRendered(),this.widgetUtilService.isWidgetPage()&&this.widgetService.widgetInfo.widgetType===c.e.flowNew&&this.initializeBackButtonUsingWidgetOptions(),this.isTesting=this.isTesting.bind(this)}var t,i,n,s,w,z;return t=e,(i=[{key:"updatePageTitle",value:function(){this.isDestroying||(this.isMonitorEnabled()?this.$window.document.title=Object(p.d)(this.clientResources.PageTitle.RunHistory,this.appSettings.brandName):this.$window.document.title=this.isNewFlow?Object(p.d)(this.clientResources.PageTitle.CreateFlow,this.appSettings.brandName):Object(p.d)(this.clientResources.PageTitle.EditFlow,this.appSettings.brandName))}},{key:"registerConfirmNavigateAway",value:function(){this.unregisterNavigateAway=this.navigationService.confirmNavigateAway(this.$scope,{getMessage:()=>{try{this.getFlowFromDesignerSync(!0)}catch(e){return this.clientResources.Flow.Discard.Errors.Message}return this.clientResources.Flow.Discard.Changes.Message},confirmation:this.clientResources.Flow.Discard.Changes.Confirmation,condition:()=>{if(this.isMonitorEnabled())return!1;if(me.a.hasRegisteredTokensToSkipConfirm())return!1;try{var e=this.getFlowFromDesignerSync(!0);return e.properties&&!this.isFlowNotConstructed()&&(this.flowInterfaceState===ci.savingFlow||this.isFlowNotSavedPreviously()||Object(M.c)(this.lastSavedFlow.properties,e.properties))}catch(t){return!0}}})}},{key:"isFlowNotConstructed",value:function(){return this.isFlowNotSavedPreviously()&&Object(G.a)(this.currentFlowFromDesigner)}},{key:"isFlowNotSavedPreviously",value:function(){return!this.lastSavedFlow}},{key:"onInitDesigner",value:function(){return this.defaultToSolutionIfEnabled().then(()=>this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync().then(()=>{this.appSettings.featureFlags.enableSolutionFlowsCDSDirectCommunication&&this.solutionId&&this.environmentCapabilityService.getIsCdsDirectCommunicationSupportedCapability()})).then(()=>this.onInitDesignerInternal()))}},{key:"onInitDesignerInternal",value:function(){if(this.telemetry.tagEvent(v.a.DesignerLoad,{fromTemplate:this.templateName||ge.b.CreateNew,vNextCreateEnabled:Object(ht.a)()}),this.ngUrlService.cameFromTemplateDetailsPage&&this.scenario===fe.a.newFlowFromTemplate){var t=this.storageCacheFactory.Create(u.a.storageCacheId);this.cachedConnections=t.get(u.a.urlPath),this.cachedConnections&&t.remove(u.a.urlPath)}this.pageEventData=ri(ri({},this.pageEventData),{usingCachedConnections:!!this.cachedConnections});var i=this.fetchDefinition();i.then(e=>{try{!Object(bt.a)()&&!this.appSettings.featureFlags.enableDesktopFlowConnectivityVNext&&e&&e.connectionReferences&&Object.keys(e.connectionReferences).forEach(t=>{var i,r;null!==(i=e.connectionReferences[t])&&void 0!==i&&null!==(i=i.apiDefinition)&&void 0!==i&&i.id&&Object(p.c)(e.connectionReferences[t].apiDefinition.id,c.d.connectorId)&&null!==(r=e.connectionReferences[t].apiDefinition.properties)&&void 0!==r&&r.connectionParameterSets&&delete e.connectionReferences[t].apiDefinition.properties.connectionParameterSets})}catch(t){this.loggingService.logError("FlowCtrl.hideDesktopFlowMultiAuthConnector",t)}}).then(()=>this.promiseHelperService.toAngularPromise(this.loadRecommendations())).then(()=>this.handleRedirectForCoauthoredFlows());var r,n,o,a,s,l=this.isNewFlow&&this.createFromTriggerTriggerId&&Object(G.l)(this.appSettings,this.createFromTriggerTriggerId),d=this.getApis(l,ct.c.TRIGGER,i),h=Object(ht.a)()&&this.isNewFlow&&this.createFromTriggerAndActionOperationId&&Object(G.l)(this.appSettings,this.createFromTriggerAndActionOperationId)||null,m=h?this.getApis(h,ct.c.ACTION,i):Promise.resolve([]),g=l?this.loadTriggerAndAction(l,h):Promise.resolve([]),f=Object(Yt.a)()?this.isManagedSolutionFlowAndIsCustomizableSolutionFlow(i):this.isManagedSolutionFlow(i),w=this.$q.all([i,f]).then(e=>{var[t]=e,i=t.connectionReferences;return Object(Yt.b)()?this.getDesignerConnectionsV2(i,this.isManagedSolutionFlowResolvedValue):this.getDesignerConnections(i,this.isManagedSolutionFlowResolvedValue)}).catch(e=>(this.loggingService.logWarning("FlowCtrl.onInitDesignerInternal","Failed to load flow definition. Flow may be partially loaded."),[])),S=this.getXrmEnvironmentVariables(),C=this.$q.all([i,d,m,w,S,g,f]).then(e=>{var[t,i,l,c,u,d]=e,p=d&&d[0],h=d&&d[1];if(Object(X.b)(p)?n=p:r=p,o=h,this.designerReadyDeferred.resolve(),s=t,this.isXrmEnvironmentVariablesEnabled())try{this.loggingService.logInfo("FlowCtrl.onInitDesignerInternal","Adding environment variables to flow definition"),s.definition=Object(we.b)(s.definition,u,this.loggingService),this.appSettings.featureFlags.enableMergeXRMEnvironmentVariables&&(s.definition=Object(we.g)(s.definition,u,this.loggingService))}catch(g){this.loggingService.logError("FlowCtrl.onInitDesignerInternal",g)}var m=i||l?(i||[]).concat(l||[]).filter(e=>!!e):void 0;return this.pageEventData=ri(ri({},this.pageEventData),{connectionPending:!c}),a={prefetchedData:{connections:c,apis:m,connectionReferences:this.getDesignerConnectionReferences(s.connectionReferences),plan:s.plan},allowCoauthoring:!this.isNewFlow&&this.shouldExpandSharedConnections,showCalloutHints:this.isNewFlow,flowName:this.flowName,loadScenario:this.scenario,onSaveFlow:()=>{this.$scope.$applyAsync(()=>{this.appSettings.featureFlags.enableXRMPublishFlowsV1?this.xrmSaveDraft(!1,!1):this.trySaveFlow()})},apiOperationAuthoringBehavior:Object(G.f)(t.definitionSummary,this.isSolutionFlow),templateName:this.templateName,isSolutionFlow:this.isSolutionFlow,isXrmConnectionReferenceMode:this.isXRMConnectionReferenceMode,solutionId:this.solutionId,containsNativeCDSOperation:Object(Se.e)(s.connectionReferences),setRecommendationContext:e=>{this.onSetRecommendationContext(e)}}});return C.then(()=>{var e=this.getDesignerConnectionReferences(s.connectionReferences),t=o?Object(G.n)(o.toJS()):void 0;if(null!=t&&t.id&&t.id in vt.a&&!Object(y.a)(vt.a[t.id],t.id)){var i=Object(ft.i)(h.apiName);i in gt.b&&(i=gt.b[i]),t.name=vt.a[t.id],t.properties.api.id="connectionProviders/".concat(i)}if(this.isSolutionFlow&&Object(Jt.l)()&&!Be.a.isDataverseCachePrimed&&(this.flowService.primeCache(this.flowName),Be.a.setDataverseCachePrimed(!0),this.loggingService.logInfo(v.a.PrimeCacheOnExistingFlowLoad,"Prime cache on existing flow load with V1",{workflowEntityId:this.flowName})),Q.a.requiresDefinition(this.createFromTriggerTriggerId))return this.designerContext.loadDefinition(s.definition,e,this.scenario,t);if(this.createFromTriggerTriggerId&&Object(G.i)(this.appSettings,this.createFromTriggerTriggerId)){var c=Object(G.m)(this.appSettings,n);return t?this.designerContext.loadTriggerAndAction(c,t):this.designerContext.loadTrigger(c)}if(r){var u=r;return t?this.designerContext.loadTriggerAndAction(u,t):this.designerContext.loadTrigger(u)}if(this.createFromTriggerTriggerId&&a&&a.prefetchedData&&a.prefetchedData.apis){var d=a.prefetchedData.apis.filter(e=>y.a(e.id,l.apiId))[0],m=this.getOperationFromApi(d,l.operationName);if(m){var g={id:"".concat(d.id,"/").concat(m.operationId),name:m.operationId,type:"".concat(de.P,"/apis/apiOperations"),properties:{summary:m.summary,api:{id:d.id,displayName:d.properties.displayName},isNotification:!Object(p.o)(m["x-ms-notification"])}};return t?this.designerContext.loadTriggerAndAction(g,t):this.designerContext.loadTrigger(g)}throw new I.a(I.c.apiOperationNotFound,this.clientResources.Flow.Error.ApiOperationNotFound,null,{trigger:this.createFromTriggerTriggerId})}return this.designerContext.loadDefinition(s.definition,e,this.scenario)}).then(()=>{if(this.widgetUtilService.fireFullDesignerRendered(),this.designerRenderingComplete=!0,this.hasHttpRequestTrigger(s.definition)){var e,t=(null===(e=s.definition)||void 0===e?void 0:e.triggers)&&Object.keys(s.definition.triggers)[0]||null;this.setCallback(this.flowName,t)}this.isSolutionFlow||this.environmentsClient.checkEnvironmentAccess({environmentName:this.environmentService.getCurrentEnvironmentName()}).catch(e=>{this.isNewFlow&&(Object(V.d)(e)||Object(V.i)(e))?(this.showAlert(B.c.error,Object(Ce.db)(e)),this.loggingService.logWarning("FlowCtrl.checkEnvironmentAccess",Object(_t.b)(Object(Ce.db)(e),this.clientResources)),this.setDesignerReadOnlyState(!0),this.environmentAccessDeniedDisableSave=!0):this.loggingService.logError("FlowCtrl.checkEnvironmentAccess",Object(_t.b)(e,this.clientResources))})}).then(()=>{this.showCallbackUrlDeprecationMessageBarIfNeeded()}).then(()=>{var e=Object(Yt.a)();return!this.appSettings.featureFlags.enableEditManagedSolutionFlowWarnings||!this.isSolutionFlow||e&&void 0!==this.isCustomizableSolutionFlowResolvedValue?this.$q.resolve(null):this.isCustomizableSolutionFlow(i)}).then(()=>this.appSettings.featureFlags.enableEditManagedSolutionFlowWarnings&&this.isManagedSolutionFlowResolvedValue?this.checkIfActiveLayerExistsForFlow(this.flow.properties.workflowEntityId):this.$q.resolve(null)).then(()=>this.activeLayerExists?this.getSolutionIdForFlowWithActiveLayerFunction(this.flow.properties.workflowEntityId):this.$q.resolve(null)).then(()=>this.appSettings.featureFlags.enableEditManagedSolutionFlowWarnings&&!this.sessionService.isConsumerDomain&&this.environmentService.getCurrentEnvironment().hasXrmInstance?this.getXrmUserId():this.$q.resolve(null)).then(()=>this.appSettings.featureFlags.enableEditManagedSolutionFlowWarnings&&this.activeLayerExists&&!this.sessionService.isConsumerDomain?this.checkIfUserCanAccessSolution(this.currentXrmUserId):this.$q.resolve(null)).then(()=>{this.appSettings.featureFlags.enableEditManagedSolutionFlowWarnings&&this.activeLayerExists?(this.loggingService.logInfo("FlowCtrl.onInitDesignerInternal","Editing flow with active layer detected. Showing warning on designer.",{flowName:this.flowName}),this.showAlert(B.c.warning,this.clientResources.EditManagedSolutionFlowWarning.ActiveLayerExistsWarning,Object(Ce.t)(this.clientResources),null,null,null,this.userCanAccessSolution?this.clientResources.EditManagedSolutionFlowWarning.RemoveLayer:null,this.userCanAccessSolution?this.forwardToSolutionComponentLayerPageFunction:null,!1)):this.appSettings.featureFlags.enableEditManagedSolutionFlowWarnings&&this.isManagedSolutionFlowResolvedValue&&this.isCustomizableSolutionFlowResolvedValue?(this.loggingService.logInfo("FlowCtrl.onInitDesignerInternal","Editing managed solution flow detected. Showing warning on designer.",{flowName:this.flowName}),this.showAlert(B.c.warning,this.clientResources.EditManagedSolutionFlowWarning.WillCreateAnActiveLayerWarning,Object(Ce.u)(this.clientResources))):this.appSettings.featureFlags.enableEditManagedSolutionFlowWarnings&&this.isManagedSolutionFlowResolvedValue&&!this.isCustomizableSolutionFlowResolvedValue&&(this.loggingService.logInfo("FlowCtrl.onInitDesignerInternal","Editing noncustomizable managed solution flow detected. Showing warning on designer.",{flowName:this.flowName}),this.setDesignerReadOnlyState(!0),this.thisFlowCannotBeEditedWarningActive=!0,this.showAlert(B.c.warning,this.clientResources.EditManagedSolutionFlowWarning.ThisFlowCannotBeEditedWarning))}).then(()=>{var e,t;return this.promiseHelperService.toAngularPromise(Object(ti.a)({loggingService:this.loggingService,environmentName:this.environmentService.getCurrentEnvironmentName(),flowIdentifier:null!==(e=Object(R.g)(this.flow))&&void 0!==e?e:this.flowName,backendFlowLastModifiedTime:null===(t=this.flow)||void 0===t?void 0:t.properties.lastModifiedTime}))}).then(e=>{var t,i;e?(this.loggingService.logInfo("flowCtrl.checkForLocalAutoSave","Local auto save data found. Prompting user to load.",{environmentId:this.environmentService.getCurrentEnvironmentName(),flowIdentifier:null!==(t=Object(R.g)(this.flow))&&void 0!==t?t:this.flowName}),this.showAlert(B.c.info,this.clientResources.LocalAutoSave.SaveDetectedMessage,Object(Ce.q)(this.clientResources),void 0,void 0,"localAutoSaveAlertId",this.clientResources.LocalAutoSave.RecoverFlowButtonText,()=>{var t;this.loggingService.logInfo("flowCtrl.checkForLocalAutoSave.onClick","User clicked button to load local auto save data.",{environmentId:this.environmentService.getCurrentEnvironmentName(),flowIdentifier:null!==(t=Object(R.g)(this.flow))&&void 0!==t?t:this.flowName});var i=this.getDesignerConnectionReferences(s.connectionReferences);this.designerContext.loadDefinition(e.properties.definition,i,fe.a.localAutoSave,void 0,!0);var r=this.actionHeadingAdditionalMessageBar.findIndex(e=>"localAutoSaveAlertId"===e.dataAutomationId);this.actionHeadingAdditionalMessageBar.splice(r,1)},!1,!0)):Object(ti.c)({loggingService:this.loggingService,environmentName:this.environmentService.getCurrentEnvironmentName(),flowIdentifier:null!==(i=Object(R.g)(this.flow))&&void 0!==i?i:this.flowName})}).then(()=>this.initializeUndo()).then(()=>(this.initializeDesignerCallbacks(),this.hasDefinitionLoaded=!0,this.actionHeadingTitlePlaceholder=this.clientResources.Common.Untitled,this.flowNeedsSaveBeforeInitComments&&!1===this.isManagedSolutionFlowResolvedValue?this.save({isCommentingInitialization:!0}).then(()=>(this.loggingService.logInfo("FlowCtrl.SaveBeforeInitializingComments","Added metadata and save successful, will initialize comments"),this.promiseHelperService.toAngularPromise(this.initializeCommenting()))).catch(e=>{var t=Object(_t.a)(e);this.loggingService.logError("FlowCtrl.save:SaveBeforeInitComments",t)}):this.promiseHelperService.toAngularPromise(this.initializeCommenting()))).then(()=>{this.pageEventData=ri(ri({},this.pageEventData),{status:Ce.e.Success}),this.loggingService.profilePageEnd(this.pageEventCorrelationId,b.a.flowLoadEnd,ri(ri({},this.pageEventData),this.getDefaultFlowEventData(!1))),this.showOrHideUnsupportedFlowBannerIfNeeded(),this.autoSimulate&&(this.spinner.show=!0,this.onInvokeSimulate(!0)),this.scenario===fe.a.naturalLanguageToFlow?(this.loggingService.logInfo(v.a.NL2FlowFlowInDesignerLoaded,"",this.getDefaultFlowEventData(),Ve.a.createWizardCorrelationId),this.showNL2FlowSuccessMessageBar()):e.isReloadingFlowAfterFirstSave&&(e.isReloadingFlowAfterFirstSave=!1,this.showSaveSuccessMessageBar()),this.appSettings.featureFlags.enableTestExpressions&&this.getLastRun()}).catch(e=>{var t=Object(V.j)(e),i=t===I.c.FlowSoftDeleted,r=Ce.e.Abort,n=Object(_t.a)(e);if(i||(r=Object(Ce.y)(e),this.loggingService.logError("FlowCtrl.LoadDefinition",n)),this.pageEventData=ri(ri({},this.pageEventData),{status:r,error:Object(Ce.db)(e),errorCode:t}),this.loggingService.profilePageEnd(this.pageEventCorrelationId,b.a.flowLoadEnd,ri(ri({},this.pageEventData),this.getDefaultFlowEventData(!1))),this.designerRenderingComplete)this.scenario===fe.a.naturalLanguageToFlow&&t===I.c.DesignerInvalidParameters?this.showNL2FlowSuccessMessageBar():this.showErrorMessageInAlert(e);else if(i)this.alertService.enqueueAlert({message:Object(Ce.db)(e)}),this.navigationService.navigate("/flows");else{if(this.scenario===fe.a.naturalLanguageToFlow){var{createWizardCorrelationId:o}=Ve.a;this.loggingService.logError(v.a.NL2FlowFlowInDesignerLoadError,e,this.getDefaultFlowEventData(),o)}Object(ke.b)(this.fullPageErrorModel,e)}throw e}).finally(()=>{this.flowRunInitPromise?this.flowRunInitPromise.finally(()=>{this.spinner.show=!1}):this.spinner.show=!1,this.updateDraftFlow(),this.isXrmEnvironmentVariablesEnabled()&&(s.definition=Object(we.e)(s.definition)),e.isReloadingFlowAfterFirstSave=!1}),C}},{key:"getApis",value:function(e,t,i){return t===ct.c.TRIGGER&&this.createFromTriggerTriggerId&&(Q.a.requiresDefinition(this.createFromTriggerTriggerId)||Object(G.i)(this.appSettings,this.createFromTriggerTriggerId))||t===ct.c.ACTION&&Object(G.i)(this.appSettings,null==e?void 0:e.operationId)?this.$q.resolve([]):e?this.apisClient.get(this.$scope,{id:e.apiId}).$promise.then(e=>(this.pageEventData=ri(ri({},this.pageEventData),{apisFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart}),[e])):i.then(e=>{var{connectionReferences:t}=e;this.pageEventData=ri(ri({},this.pageEventData),{definitionFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart});var i=Object.keys(t||{}).map(e=>{var i=t[e];if(!i)return this.$q.resolve(null);var r=o()(i.apiDefinition||i.api);if(r&&r.properties&&(r.properties.swagger||(r.properties.swagger=i.swagger),r.properties.swagger))return this.$q.resolve(r);var n=i.id||i.api.id;return this.apisClient.get(this.$scope,{id:n}).$promise.catch(e=>{this.loggingService.logError("FlowCtrl.onInitDesigner",e,{apiId:n}),this.$q.resolve(r)})});return this.$q.all(i).then(e=>(this.pageEventData=ri(ri({},this.pageEventData),{apisFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart}),e))})}},{key:"checkIfActiveLayerExistsForFlow",value:function(e){return this.solutionService.checkIfActiveLayerExistsForFlow({workflowId:e}).then(e=>(this.activeLayerExists=e,e)).catch(e=>(this.loggingService.logWarning("FlowCtrl.checkIfActiveLayerExistsForFlow","Failed to check if active layer exists. Assuming false.",{flowName:this.flowName,error:e}),!1))}},{key:"getSolutionIdForFlowWithActiveLayerFunction",value:function(e){return this.solutionService.getSolutionIdForFlowWithActiveLayer({workflowId:e}).then(e=>(this.layerRouteSolutionId=e,e)).catch(e=>{this.loggingService.logWarning("FlowCtrl.getSolutionIdForFlowWithActiveLayerFunction","Failed to check get base layer for flow with active layer. Assuming false.",{flowName:this.flowName,error:e})})}},{key:"checkIfUserCanAccessSolution",value:function(e){return this.xrmEntityHttpClient.retrieveUserPrivilegesByName(e,be.m.Solution.ReadPrivilege).then(e=>{var t=e.data;if(t&&t.RolePrivileges&&t.RolePrivileges.length>0){var i=t.RolePrivileges[0]&&"Global"===t.RolePrivileges[0].Depth;return this.userCanAccessSolution=i,i}return this.userCanAccessSolution=!1,!1}).catch(e=>(this.loggingService.logWarning("FlowCtrl.checkIfUserCanAccessSolution","Failed to check if user can access solution for remove layer button. Assuming false.",{flowName:this.flowName,error:e}),!1))}},{key:"getXrmUserId",value:function(){return this.xrmWorkflowHttpClient.getWhoAmI().then(e=>(this.currentXrmUserId=e.UserId,e.UserId)).catch(e=>(this.loggingService.logWarning("FlowCtrl.getXrmUserId","Failed to retrieve xrmuserid. Assuming null.",{flowName:this.flowName,error:e}),null))}},{key:"forwardToSolutionComponentLayerPage",value:function(e){this.loggingService.logInfo("FlowCtrl.forwardToSolutionComponentLayerPage","User clicked button to remove layer. Forwarding to solution component page.",{flowName:this.flowName}),this.unregisterNavigateAway(),window.open(this.getSolutionComponentLayerPageRoute(e,this.layerRouteSolutionId),"_blank")}},{key:"getSolutionComponentLayerPageRoute",value:function(e,t){var i,r=null!==(i=null!=t?t:this.solutionId)&&void 0!==i?i:Object(Nt.a)();return Object(lt.q)(this.routeCrafter,"solutions/".concat(r,"/objects/workflow/").concat(e,"/layers"))}},{key:"isManagedSolutionFlow",value:function(e){return e.then(()=>Object(R.y)(this.flow)?this.modernFlowClient.checkIfModernFlowIsManagedFlow(this.flow):this.$q.resolve(!1)).then(e=>(this.isManagedSolutionFlowResolvedValue=e,e))}},{key:"isCustomizableSolutionFlow",value:function(e){return e.then(()=>Object(R.y)(this.flow)?this.modernFlowClient.checkIfFlowIsCustomizable(this.flow,this.loggingService,this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService):this.$q.resolve(!1)).then(e=>(this.isCustomizableSolutionFlowResolvedValue=e,e))}},{key:"isManagedSolutionFlowAndIsCustomizableSolutionFlow",value:function(e){return e.then(()=>Object(R.y)(this.flow)?void 0!==this.isManagedSolutionFlowResolvedValue&&void 0!==this.isCustomizableSolutionFlowResolvedValue?this.$q.resolve([this.isManagedSolutionFlowResolvedValue,this.isCustomizableSolutionFlowResolvedValue]):this.modernFlowClient.checkIfModernFlowIsManagedFlowAndIfFlowIsCustomizable(this.flow,this.loggingService,this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService):this.$q.resolve([!1,!1])).then(e=>(this.isManagedSolutionFlowResolvedValue=e[0],this.isCustomizableSolutionFlowResolvedValue=e[1],e))}},{key:"getDesignerConnectionsV2",value:function(e,t){var i,r=this.getConnections();if(this.isSolutionFlow){Object(Ut.a)()&&this.createFromNaturalLanguage&&Object(Se.w)(e);var n=this.checkIsXrmConnectionReferenceMode(e),o=this.getXrmConnectionReferenceDesignerConnections(r,e);n.then(i=>(this.flow&&(this.willClearConnectionNamesFromFlowDefinition=Object(et.i)(this.appSettings,t,Object(R.y)(this.flow),this.$routeParams,Object(Se.g)(this.flow.properties.connectionReferences),this.flow)),this.isXRMConnectionReferenceMode=!!this.willClearConnectionNamesFromFlowDefinition||i,t&&Object(Se.f)(e)&&(this.isXRMConnectionReferenceMode=!1),this.isXRMConnectionReferenceMode?o:r))}else this.isXRMConnectionReferenceMode=!1,i=r;return i.then(e=>(this.pageEventData=ri(ri({},this.pageEventData),{designerConnectionsFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart,isSolutionFlow:this.isSolutionFlow}),e)),i}},{key:"getDesignerConnections",value:function(e,t){var i,r=this.getConnections();return this.isSolutionFlow?(Object(Ut.a)()&&this.createFromNaturalLanguage&&Object(Se.w)(e),i=this.checkIsXrmConnectionReferenceMode(e).then(i=>(this.flow&&(this.willClearConnectionNamesFromFlowDefinition=Object(et.i)(this.appSettings,t,Object(R.y)(this.flow),this.$routeParams,Object(Se.g)(this.flow.properties.connectionReferences),this.flow)),this.isXRMConnectionReferenceMode=!!this.willClearConnectionNamesFromFlowDefinition||i,t&&Object(Se.f)(e)&&(this.isXRMConnectionReferenceMode=!1),this.isXRMConnectionReferenceMode?this.getXrmConnectionReferenceDesignerConnections(r,e):r))):(this.isXRMConnectionReferenceMode=!1,i=r),i.then(e=>(this.pageEventData=ri(ri({},this.pageEventData),{designerConnectionsFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart,isSolutionFlow:this.isSolutionFlow}),e)),i}},{key:"getConnections",value:function(){var e,t=this.connectionsClient.query(this.$scope).$promise.then(e=>(this.loggingService.logInfo("FlowCtrl.onInitDesignerInternal.myConnections","Load all user connections",this.getDefaultFlowEventData()),this.pageEventData=ri(ri({},this.pageEventData),{myConnectionsFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart}),e)).catch(e=>(this.loggingService.logWarning("FlowCtrl.onInitDesignerInternal","Failed to load my connections. Flow may be partially loaded."),[]));if(this.shouldExpandSharedConnections&&this.flowName){var i=this.flowConnectionsClient.query(this.$scope,{flowName:this.flowName}).$promise.then(e=>(this.loggingService.logInfo("FlowCtrl.onInitDesignerInternal.flowConnections","Load flow connections",this.getDefaultFlowEventData()),this.pageEventData=ri(ri({},this.pageEventData),{flowConnectionsFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart}),e)).catch(e=>(this.loggingService.logWarning("FlowCtrl.onInitDesignerInternal","Failed to load flow connections. Flow may be partially loaded."),[]));e=this.$q.all([t,i]).then(e=>{var[t,i]=e;return this.shouldExpandSharedConnections&&i&&i.length>0?t?S()([...t,...i],e=>e.id):i:t})}else e=t,this.cachedConnections||(this.cachedConnections=this.getCachedArrayFromClient(this.connectionsClient)),this.cachedConnections&&(e=this.$q.resolve(this.cachedConnections));return e.then(e=>(this.pageEventData=ri(ri({},this.pageEventData),{connectionsFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart}),e)),e}},{key:"getXrmConnectionReferenceDesignerConnections",value:function(e,t){return this.$q.all([e,this.getXRMConnectionReferences()]).then(e=>{var[i,r]=e;if(!Object(F.a)(r)&&Object(p.o)(t))return[];if(this.appSettings.featureFlags.enableXRMConnectionReferenceSaveValidation)try{for(var n of(this.connectionIdToXRMLogicalNameMapping={},r))n.connectionid&&(this.connectionIdToXRMLogicalNameMapping[n.connectionid]=n.connectionreferencelogicalname,this.loggingService.logInfo("flowCtrl.getXrmConnectionReferenceDesignerConnections","Mapping connection id ".concat(n.connectionid," to XRM logical name\n                      ").concat(n.connectionreferencelogicalname)))}catch(s){this.loggingService.logWarning("flowCtrl.getXrmConnectionReferenceDesignerConnections","Error while mapping connection id to XRM logical name: ".concat(s))}var o=i?new Map(i.map(e=>[e.name,e])):new Map,a=Object(Se.r)(t,this.willClearConnectionNamesFromFlowDefinition);return(Object(F.a)(a)?Object(F.a)(r)?S()([...r,...a],e=>e.connectionreferencelogicalname):a:Object(p.o)(r)?[]:r).filter(e=>e.connectionid&&o.has(e.connectionid)).map(e=>{var t=o.get(e.connectionid);return t.properties&&t.properties.statuses&&t.properties.statuses[0]&&t.properties.statuses[0].status===Pe.c.connected?this.generateDesignerConnectionForValidConnectionReference(o.get(e.connectionid),e):this.generateDesignerConnectionForInvalidConnectionReference(o.get(e.connectionid),e,this.clientResources.XRMConnectionReference.InvalidConnection)})})}},{key:"generateDesignerConnectionForValidConnectionReference",value:function(e,t){xe.a.addDesignerConnectionIdMapEntry(t.connectionreferencelogicalname,e.id);var i=o()(e);return i.id=i.name=t.connectionreferencelogicalname,i.properties.displayName=t.connectionreferencedisplayname,i}},{key:"generateDesignerConnectionForInvalidConnectionReference",value:function(e,t,i){return xe.a.addDesignerConnectionIdMapEntry(t.connectionreferencelogicalname,e.id),{id:t.connectionreferencelogicalname,name:t.connectionreferencelogicalname,properties:{apiId:t.connectorid,displayName:t.connectionreferencedisplayname,statuses:[{status:Pe.c.error,error:{code:Pe.b.configurationNeeded,message:i}}],createdTime:t.createdon,lastModifiedTime:t.overwritetime}}}},{key:"getXRMConnectionReferences",value:function(){return Ae.a.currentEnvironment.xrmInstanceApiUrl?this.promiseHelperService.toAngularPromise(this.xrmEntityHttpClient.retrieveMultiple("connectionreferences").then(e=>(this.pageEventData=ri(ri({},this.pageEventData),{xrmConnectionReferenceFetchDuration:this.loggingService.performanceNow()-this.pageLoadStart}),e.data.value)).catch(e=>(this.loggingService.logWarning("FlowCtrl.getXrmConnectionReferences","Failed to load xrm connection references. Flow may be partially loaded."),[]))):(this.loggingService.logWarning("FlowCtrl.getXRMConnectionReferences","XRM instance API URL not found",{flowName:this.flowName}),this.$q.resolve([]))}},{key:"getXrmEnvironmentVariables",value:function(){return this.isXrmEnvironmentVariablesEnabled()?Ae.a.currentEnvironment.xrmInstanceApiUrl?this.promiseHelperService.toAngularPromise(this.xrmEntityHttpClient.retrieveEnvironmentVariables().then(e=>e&&e.data&&e.data.value?e.data.value:(this.loggingService.logWarning("FlowCtrl.getXrmEnvironmentVariables","Failed to load XRM environment variables."),[])).catch(e=>(this.loggingService.logWarning("FlowCtrl.getXrmEnvironmentVariables","Failed to load XRM environment variables."),[]))):(this.loggingService.logWarning("FlowCtrl.getXrmEnvironmentVariables","XRM instance API URL not found",{flowName:this.flowName}),this.$q.resolve([])):this.$q.resolve([])}},{key:"initializeDesignerCallbacks",value:function(){this.designerContext.onParameterChanged(()=>{this.designerContext.getParameters().then(e=>this.onParameterChanged(e))}),this.designerContext.onCardChanged(()=>{Promise.all([this.designerContext.getTriggers(),this.designerContext.getActions(),this.designerContext.getConnections()]).then(e=>{var[t,i,r]=e;return this.onCardChanged(t,i,r)})}),this.designerContext.onDesignerFlowChanged(()=>{this.onDesignerFlowChanged()}),this.designerContext.onSelectedActionOrTriggerChanged(()=>{this.designerContext.getSelectedActionOrTrigger().then(e=>this.onSelectedActionOrTriggerChanged(e)).catch(e=>{this.loggingService.logError("FlowCtrl.getSelectedActionOrTrigger",e)})}),this.designerContext.onSelectedRecommendationOperationChanged(()=>{this.contextualHelpPanel.recommendationContext=null,this.designerContext.getSelectedRecommendationOperation().then(e=>this.onSelectedActionOrTriggerChanged(e)).catch(e=>{this.loggingService.logError("FlowCtrl.getSelectedRecommendationOperation",e)})})}},{key:"onSelectedActionOrTriggerChanged",value:function(e){if(!this.appSettings.featureFlags.enableConnectorAndActionHelp||this.widgetUtilService.isWidgetPage())this.contextualHelpPanel.isOpen=!1;else{var t=this.contextualHelpPanel.recommendationContext,i=t&&t.userSelections;if(this.contextualHelpPanel.isOpen&&e){var r=e.action&&(e.summary||e.action.friendlyName);this.contextualHelpPanel.title=r,this.contextualHelpPanel.searchText="".concat(e.connectorDisplayName," ").concat(r),this.contextualHelpPanel.apiBrandColor=e.brandColor,this.contextualHelpPanel.apiIconUri=e.connectorUri,this.contextualHelpPanel.documentUrl=e.documentationUrl,this.contextualHelpPanel.description=e.description,this.contextualHelpPanel.connectorDisplayName=e.connectorDisplayName,this.contextualHelpPanel.connectorId=e.connectorId,this.contextualHelpPanel.actionFriendlyName=r,this.contextualHelpPanel.isRecommendation=!1}else this.contextualHelpPanel.isOpen&&i&&i.connector&&i.connector.label&&(this.contextualHelpPanel.title=i.connector.label,this.contextualHelpPanel.searchText=i.connector.label,this.contextualHelpPanel.apiBrandColor=i.connector.connectorIconBrandColor,this.contextualHelpPanel.apiIconUri=i.connector.connectorIconuri,this.contextualHelpPanel.documentUrl=i.connector.documentUrl,this.contextualHelpPanel.description=i.connector.description,this.contextualHelpPanel.connectorDisplayName=i.connector.label,this.contextualHelpPanel.connectorId=t.connectorId,this.contextualHelpPanel.isRecommendation=!0)}this.updateCommentingSelectedOperationId(e),this.triggerSaveSnapshotCheckForUndo(e)}},{key:"updateCommentingSelectedOperationId",value:function(e){var t;if(null!=e&&e.action){var i=null===(t=e.action.metadata)||void 0===t?void 0:t.operationMetadataId;!i&&e.action.nodeId&&(i=e.action.nodeId in this.nodeIdToOperationIdMapping?this.nodeIdToOperationIdMapping[e.action.nodeId]:ae.b,e.action.metadata=ri(ri({},e.action.metadata),{},{operationMetadataId:i}),Object(Tt.a)(Re.a,this.flowName,i)),Re.a.setSelectedOperationId(i)}}},{key:"dismissContextualHelpPanel",value:function(){this.appSettings.featureFlags.enableConnectorAndActionHelp&&this.contextualHelpPanel.isOpen&&(this.contextualHelpPanel.isOpen=!1,this.contextualHelpPanel.searchText=null,this.contextualHelpPanel.title=null,this.contextualHelpPanel.isRecommendation=!1)}},{key:"onParameterChanged",value:function(e){this.$scope.$applyAsync(()=>{this.flowCheckerPanel.parametersErrors=Object(L.a)(e),this.updateActionHeading(),this.updateDraftFlow(),this.triggerSaveSnapshotCheckForUndo()})}},{key:"onCardChanged",value:function(e,t,i){this.$scope.$applyAsync(()=>{this.flowCheckerPanel.connectionErrors=Object(Oe.c)(e,t,i,this.clientResources),this.updateActionHeading(),this.updateDraftFlow(),this.checkIfContainsSponsoredOperation(e,t)})}},{key:"checkIfContainsSponsoredOperation",value:function(e,t){if(this.appSettings.featureFlags.enableSponsoredConnectorExperience&&!this.environmentService.isPayGoEnabled){var i=[].concat(e,t).filter(e=>{var t=e.connectionId?Object(Qe.h)(e.connectionId):void 0;return!!t&&this.environmentSponsoredConnectorNames.includes(t.apiName)}),r=-1;this.actionHeadingAdditionalMessageBar.length>0&&(r=this.actionHeadingAdditionalMessageBar.findIndex(e=>"sponsoredConnectorBanner"===(null==e?void 0:e.dataAutomationId))),0===i.length&&r>-1?delete this.actionHeadingAdditionalMessageBar[r]:i.length>0&&r<0&&this.showAlert(B.c.info,this.clientResources.SponsoredConnector.BannerMessage,{target:P.a.blank,url:"https://aka.ms/PAEmbedLimits",ariaLabel:this.clientResources.SponsoredConnector.LearnMoreLinkMessage,text:this.clientResources.SponsoredConnector.LearnMoreLinkMessage},null,this.clientResources.Common.Dismiss,"sponsoredConnectorBanner",null,null,!0,!0,{root:{"&.ms-MessageBar":{backgroundColor:Object(at.Y)().palette.themeLight,padding:"0px"}}},{iconName:D.a.Diamond})}}},{key:"showOrHideUnsupportedFlowBannerIfNeeded",value:function(){var e=this.actionHeadingAdditionalMessageBar.findIndex(e=>"unsupportedFlowBanner"===e.dataAutomationId);this.flowV3SupportState.wasRedirectedFromV3&&!this.flowV3SupportState.currentlyLoadedFlowIsSupported?e>=0||this.addAdditionalMessageBar({actions:Object(st.a)(this.clientResources.LoadUnsupportedFlowReasonsButton,this.openUnsupportedV3FlowModal),dataAutomationId:"unsupportedFlowBanner",message:this.clientResources.LoadUnsupportedFlowMessage,isMultiline:!1,type:B.c.warning}):e>-1&&this.actionHeadingAdditionalMessageBar.splice(e,1)}},{key:"onDesignerFlowChanged",value:function(){this.getFlowFromDesigner(!0).then(e=>{var t,i;!Object(p.o)(null===(t=this.lastSavedFlow)||void 0===t?void 0:t.properties)&&Object(M.c)(null===(i=this.lastSavedFlow)||void 0===i?void 0:i.properties,null==e?void 0:e.properties)&&(this.loggingService.logInfo("FlowCtrl.onDesignerFlowChanged","Flow is dirty and flow checker is invoked",this.getDefaultFlowEventData()),this.openFlowCheckerPanelAsync())})}},{key:"openFlowCheckerPanelAsync",value:function(){this.$scope.$applyAsync(()=>{this.openFlowCheckerPanel(!0,!0,!0),this.updateActionHeading(),this.updateDraftFlow()})}},{key:"openV3DesignerSurveyPanel",value:(z=ai((function*(){var e,t;if(Object(St.b)()&&!Object(Kt.c)()){var i=Object(St.a)(),r=yield null===(e=kt.a.get())||void 0===e?void 0:e.getSurveyPanelLastShownDate(),n=r?Object(jt.b)(r,i):new Date(null),o=new Date;n.getTime()>o.getTime()?this.loggingService.logInfo("FlowCtrl.openV3DesignerSurveyPanel","V3->V1 survey modal will not be shown to user.",ri(ri({},this.getDefaultFlowEventData()),{},{currentDate:o,doNotShowSurveyUntilDate:n,settingCacheDays:i})):(this.loggingService.logInfo("FlowCtrl.openV3DesignerSurveyPanel","V3->V1 survey modal being shown to user.",ri(ri({},this.getDefaultFlowEventData()),{},{currentDate:o,doNotShowSurveyUntilDate:n,settingCacheDays:i})),Object(Ot.b)($e.a,{closeButtonAriaLabel:this.clientResources.Common.Close,getUserContext:()=>{var e,t,i,r;return{UserId:null!==(e=null===(t=Be.a.minimalUserInfo)||void 0===t?void 0:t.uniqueId)&&void 0!==e?e:"",TenantId:null!==(i=null===(r=Be.a.minimalUserInfo)||void 0===r?void 0:r.tenantId)&&void 0!==i?i:"",SessionId:Be.a.sessionId,Location:Object(a.h)().location,Region:Object(a.h)().region,EnvironmentId:Ae.a.currentEnvironmentName,locale:Object(Et.a)()}},isOpen:!0,size:Dt.b.small,surveyId:Ft.b,title:this.clientResources.Designer.FeedbackPanel.FeedbackPanelTitle}),yield null===(t=kt.a.get())||void 0===t?void 0:t.setSurveyPanelLastShownDate(o))}})),function(){return z.apply(this,arguments)})},{key:"updateFlowIsUnsupportedInV3Reasons",value:(w=ai((function*(e){var t,i;if(this.flowV3SupportState.wasRedirectedFromV3&&this.hasDefinitionLoaded){if(null!==(t=null==e?void 0:e.forceRefresh)&&void 0!==t&&t)this.flowV3SupportState.cachedUnsupportedReasons=void 0;else if(this.flowV3SupportState.cachedUnsupportedReasons)return;var r=null!==(i=this.flow)&&void 0!==i?i:yield this.getFlowFromDesigner(!0),n=Object(xt.a)(r),o=yield this.flowSupportCheckerService.checkFlowSupport(n);if(!0===o.isV3DesignerSupported)return this.flowV3SupportState.cachedUnsupportedReasons=void 0,void(this.flowV3SupportState.currentlyLoadedFlowIsSupported=!0);this.flowV3SupportState.cachedUnsupportedReasons=o.unsupported,this.flowV3SupportState.currentlyLoadedFlowIsSupported=!1}})),function(e){return w.apply(this,arguments)})},{key:"updateDraftFlow",value:function(){this.scenario===fe.a.editFlowDraft&&this.appSettings.featureFlags.enableDraftFlows&&this.updateDesignerActionButton(this.clientResources.Common.Publish),this.isSolutionFlow&&this.appSettings.featureFlags.enableXRMPublishFlowsV1&&this.updateDesignerActionButton(this.clientResources.Common.SaveDraft)}},{key:"updateDesignerActionButton",value:function(e){var t=document.querySelectorAll(".msla-actionpalette .msla-button");this.$scope.$applyAsync(()=>{t&&t.length>1&&(t[1].textContent=e)})}},{key:"shouldExpandSharedConnections",get:function(){return this.isSharedFlow||this.isSolutionFlow}},{key:"initializeFlowEditPage",value:function(){this.registerConfirmNavigateAway(),this.setInterfaceState(ci.editingFlow),this.pageEventCorrelationId=this.loggingService.profilePageStart(b.a.flowLoadStart,this.pageEventData,void 0,this.pageLoadStart)}},{key:"initializeFlowRunPage",value:function(){this.pageEventCorrelationId=this.loggingService.profilePageStart(b.a.flowRunLoadStart),this.flowRunService.getFlowRun(this.$scope,this.flowName,this.flowRunName,this.isMigrationSourceFlowRun).then(e=>{if(!e)throw new I.a(I.c.flowRunNotFound,this.clientResources.FlowRun.ExpectingArrayReceivedNull,null);var t=this.dateTime.getSimpleDateTimeString(Object(p.g)(e.properties.startTime));return this.actionHeadingStatusText=Object(p.d)(this.clientResources.FlowRun.TimeTitle,t),this.renderTestRunState(e),Object(Xt.a)()&&!Object(Qt.a)()&&(this.shouldShowNpsDialog=!0),e}).catch(e=>{var t=Object(V.j)(e)===I.c.FlowSoftDeleted;e&&404===e.status&&!t?(this.showAlert(B.c.error,this.clientResources.Flow.Status.RunFailed,null,null,ie.a.flow_run_fail_message),this.initializeMonitor(),this.setInterfaceState(ci.runComplete),this.showRemediationPaneForFailedRun()):(this.loggingService.profilePageEnd(this.pageEventCorrelationId,b.a.flowRunLoadEnd,{status:Object(Ce.y)(e),flowName:this.flowName,flowRunName:this.flowRunName,error:Object(Ce.db)(e)}),t?(this.alertService.enqueueAlert({message:Object(Ce.db)(e)}),this.navigationService.navigate("/flows")):(this.loggingService.logError("FlowCtrl.Constructor",e),this.showErrorMessageInAlert(e)))}).finally(()=>{this.spinner.show=!1})}},{key:"initializeFlowCheckPage",value:function(){this.pageEventCorrelationId=this.loggingService.profilePageStart(b.a.flowRunLoadStart),this.fetchDefinition().then(()=>this.flowRunService.getTriggerCheck(this.$scope,this.flowName,this.flowDefinitionTriggerName,this.flowRunName)).then(e=>{this.initializeMonitor(),this.setInterfaceState(ci.runComplete),Object(De.e)(e)&&this.showRemediationPaneForFailedRun()}).finally(()=>this.spinner.show=!1)}},{key:"getFlowAndSetIsFlowRunnable",value:function(e){this.flowName&&!this.isFlowDraftEditMode()&&this.checkCdsDirectCommunicationSupportedCapabilityPromise.then(e=>{if(e)return this.getFlow().then(()=>this.flow=this.flowData);var t=Object(l.b)(this.flowName,this.environmentService),i=this.flowsClient.get(this.$scope,{id:t,$expand:this.getFlowExpandParams});return this.flow=i,i.$promise}).then(()=>{var e=new O.a(this.flow);je.a.flows.addEntity(e,(e,t)=>!0),je.a.flows.entities.setEntitySuccess(e.name),this.isFlowRunPage&&this.updateFlowDisplayName(this.flow.properties&&this.flow.properties.displayName||""),this.setIsFlowIsRunnable(this.flow)})}},{key:"setIsFlowIsRunnable",value:function(e){this.isFlowRunnable=Object(Ee.W)(e)&&!N.d(e.properties.definitionSummary.triggers[0])}},{key:"getOperationFromApi",value:function(e,t){return e&&e.properties&&e.properties.swagger?T.q(e.properties.swagger,t):null}},{key:"getCachedArrayFromClient",value:function(e,t){var i=e.resourceDataSet;return i&&i.peekAtResourceArray&&i.peekAtResourceArray(t)&&i.peekAtResourceArray(t).length&&i.peekAtResourceArray(t).length>=1?(this.loggingService.logInfo("FlowCtrl.getCachedArrayFromClient","connections are cached",ri(ri({},this.getDefaultFlowEventData()),{},{connectionsCached:!0})),i.peekAtResourceArray(t)):void this.loggingService.logInfo("FlowCtrl.getCachedArrayFromClient","connections are not cached",ri(ri({},this.getDefaultFlowEventData()),{},{connectionsCached:!1}))}},{key:"handleRedirectForCoauthoredFlows",value:function(){this.isNewFlow||this.isSharedFlow||this.templateName||this.galleryName||this.checkCdsDirectCommunicationSupportedCapabilityPromise.then(e=>{if(e)return this.getFlow().then(()=>this.flowData);var t=Object(l.b)(this.flowName,this.environmentService);return this.flowsClient.get(this.$scope,{id:t,$expand:this.getFlowExpandParams})}).then(e=>{if(Object(R.s)(e)){this.loggingService.logInfo("FlowCtrl.onInitDesigner","navigating to editing coauthored flow url",{flowName:this.flowName}),this.unregisterNavigateAway();var t=Object(Fe.f)(this.routeCrafter,{flowName:e.name}),i=this.$window.location.search;i&&(t="".concat(t).concat(i)),this.navigationService.navigate(t)}})}},{key:"fetchDefinition",value:function(){var e=this.scenario;return this.linkedDraftFlowName?this.getFlowDraft():e===fe.a.editExistingFlow?this.getFlow(!0):e===fe.a.newFlowFromTemplate?this.getTemplate():e===fe.a.naturalLanguageToFlow?this.getFlowFromNaturalLanguage():Q.a.requiresDefinition(this.createFromTriggerTriggerId)?this.$q.resolve(this.triggerService.getDefinitionForTrigger(this.createFromTriggerTriggerId)):(this.widgetUtilService.fireCreateFromBlankLoadedEvent(),this.$q.resolve({definition:{$schema:Object(Ie.l)(this.appSettings).definitionSchemaUri,contentversion:"1.0.0.0",actions:{},triggers:{},parameters:{},outputs:{}},connectionReferences:{},definitionSummary:{actions:null,triggers:null}}))}},{key:"scenario",get:function(){return this.createFromNaturalLanguage&&Ve.a.hasFlowDefinitionToLoad?fe.a.naturalLanguageToFlow:this.isFlowDraftEditMode()?fe.a.editFlowDraft:this.flowName?fe.a.editExistingFlow:this.templateName&&this.galleryName?fe.a.newFlowFromTemplate:fe.a.newFlowFromBlank}},{key:"isNewFlow",get:function(){return this.scenario!==fe.a.editExistingFlow}},{key:"isFlowFromNaturalLanguage",get:function(){var e;return this.scenario===fe.a.naturalLanguageToFlow||!(null===(e=this.flow)||void 0===e||null===(e=e.properties)||void 0===e||!e.templateName||!this.appSettings.naturalLanguageToFlowTemplateId||this.flow.properties.templateName!==this.appSettings.naturalLanguageToFlowTemplateId)}},{key:"isNewFlowFromNaturalLanguage",get:function(){return this.scenario===fe.a.naturalLanguageToFlow||Ve.a.isNewFlowFromNaturalLanguage(this.flowName)}},{key:"reloadOnNewFlowFromNaturalLanguageSaved",value:function(){Ve.a.resetStore(),Ve.a.onNewFlowFromNaturalLanguageSaved(this.flowName),e.isReloadingFlowAfterFirstSave=!0,this.unregisterNavigateAway();var t=Object(Fe.d)(this.routeCrafter,{flowName:this.flowName,solutionId:this.solutionId,isLegacyShared:this.isSharedFlow});if(this.widgetUtilService.isWidgetPage())return this.navigationService.navigate(t);window.history.replaceState({},"",t)}},{key:"createFromTriggerTriggerId",get:function(){var e=vt.b.triggerIds.flowButton,t=this.$routeParams.processId?e:null;return this.$routeParams.trigger||t}},{key:"createFromTriggerAndActionOperationId",get:function(){return this.$routeParams.action||null}},{key:"processId",get:function(){return this.savedProcessId||this.$routeParams.processId||null}},{key:"createFromBlankFlowName",get:function(){return this.$routeParams.newFlowName}},{key:"getDefaultFlowEventData",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={flowName:this.flowName,isManagedSolutionFlow:this.isManagedSolutionFlowResolvedValue,isSolutionFlow:this.isSolutionFlow,xrmWorkflowId:Object(R.g)(this.flow),solutionId:this.solutionId,defaultedToSolution:this.defaultedToSolution,vNextCreateEnabled:Object(ht.a)()};return e&&this.designerRenderingComplete&&(t.containsEnvironmentVariables=this.containsEnvironmentVariables(),t.isOpenApiFlow=this.isOpenApi,t.containsDataverseConnector=this.containsDataverseConnector(),t.containsFlowConnectionReferences=this.containsFlowConnectionReferences(),t.isXRMConnectionReferenceMode=this.isXRMConnectionReferenceMode),this.scenario===fe.a.naturalLanguageToFlow&&(t.nl2FlowWizardCorrelationId=Ve.a.createWizardCorrelationId,t.nl2FlowServiceCorrelationId=Ve.a.nl2flowServiceCorrelationId,t.copilotSource=Ve.a.copilotSource),t.isNewFlowFromNaturalLanguage=this.isNewFlowFromNaturalLanguage,t.isFlowFromNaturalLanguage=this.isFlowFromNaturalLanguage,t}},{key:"updateActionHeading",value:function(){this.actionHeadingTitleReadonly=this.isTesting()||this.isSaving();var e=Object(Rt.f)(this.widgetUtilService.isWidgetPage()),t=!1;if(this.isNL2FlowWidgetInTeams())this.actionHeadingMenu={items:[{key:ui.checkFlow,text:this.clientResources.FlowChecker.Title,onClick:this.onFlowCheckerButtonClicked,disabled:this.shouldDisableFlowCheckerButton(),icon:D.a.FlowChecker,className:Object(Oe.b)(this.flowCheckerPanel)}],clientResources:this.clientResources};else{var i={key:ui.editFlow,text:this.clientResources.Common.Edit,onClick:this.onEditFlowClicked,icon:D.a.Edit},r=[];if(this.isFlowRunPage&&!this.isFlowCheckPage)r.push({key:ui.resubmitFlowRun,text:this.clientResources.FlowRun.Resubmit,disabled:this.flowInterfaceState!==ci.runComplete||!0===this.isMigrationSourceFlowRun,onClick:this.onResubmitFlowRunClicked,icon:D.a.Refresh},{key:ui.cancelFlowRun,text:this.clientResources.FlowRun.Cancel,disabled:this.flowInterfaceState!==ci.renderingTestRun,onClick:this.onCancelFlowRunClicked,icon:D.a.Cancel},i),e&&(e=Object(qt.b)()),t=e;else if(this.isFlowCheckPage||this.flowInterfaceState===ci.runComplete||this.flowInterfaceState===ci.renderingTestRun)r.push(i),e=!1;else{if(this.appSettings.featureFlags.enableUndoForDesigner&&(r.push({key:ui.undo,text:this.clientResources.UndoButton.Title,onClick:()=>this.onUndoOrRedo(!0),disabled:this.isUndoButtonDisabled,icon:D.a.Undo}),r.push({key:ui.redo,text:this.clientResources.RedoButton.Title,onClick:()=>this.onUndoOrRedo(!1),disabled:this.isRedoButtonDisabled,icon:D.a.Redo})),this.areProcessAdvisorRecommendationsEnabled()&&r.push({key:ui.openAutomationPanel,text:this.clientResources.AutomationPanel.Title,onClick:this.toggleRecommendationPanel,disabled:!1,imgSrc:this.assetService.automateFlowIcon}),Ae.a.currentEnvironment.hasXrmInstance){var n=this.clientResources.Commenting.Title,o=!1;!this.flowName||this.flowNeedsSaveBeforeInitComments?(n=this.clientResources.Comments.MenuItem.SaveFlow,o=!0):this.isManagedSolutionFlowResolvedValue?(n=this.clientResources.Comments.MenuItem.ManagedSolution,o=!0):Re.a.hasCommentingPaneRendered||(n=this.clientResources.Common.Loading,o=!0),r.push({key:ui.openCommentingPane,text:this.clientResources.Commenting.Title,toolTipText:n,onClick:this.toggleCommentingPane,disabled:o,icon:D.a.Chat})}if(this.appSettings.featureFlags.enableXRMPublishFlowsV1||r.push({key:ui.saveFlow,text:this.getSaveButtonDisplayText(),onClick:this.onSave,disabled:this.shouldDisableSaveFlowButton(),icon:D.a.Save}),this.appSettings.featureFlags.enableDraftFlows&&!this.widgetUtilService.shouldHideTabs()&&(this.isFlowDraftEditMode()||!this.isFlowDraftEditMode()&&this.flowDrafts&&this.flowDrafts.length<5)&&(this.linkedDraftFlowName&&r.unshift({key:ui.discardFlowDraft,text:this.clientResources.DraftFlows.DiscardCommand.Text,onClick:this.onDiscardDraft,disabled:this.shouldDisableSaveFlowButton(),icon:D.a.Delete}),r.unshift({key:ui.saveFlowDraft,text:this.clientResources.DraftFlows.SaveCommand.Text,onClick:()=>this.onSaveDraft(),disabled:this.shouldDisableSaveFlowButton(),icon:D.a.Save})),this.widgetUtilService.isMiniWidget()){var a,s=null===(a=this.widgetService.widgetInfo)||void 0===a||null===(a=a.flowsSettings)||void 0===a?void 0:a.widgetFlowListDisplaySettings;s&&s.applyActionDisplay?this.flow&&this.flow.id&&r.push({key:ui.saveAndApply,text:this.clientResources.Flow.Commands.SaveAndApply,onClick:this.onFlowDesignerSaveAndApply,disabled:!1,icon:D.a.Accept}):r.push({key:ui.close,text:this.clientResources.Common.Close,onClick:this.onFlowDesignerClose,disabled:!1,icon:D.a.Cancel}),e=!1}else r.push({key:ui.checkFlow,text:this.clientResources.FlowChecker.Title,onClick:this.onFlowCheckerButtonClicked,disabled:this.shouldDisableFlowCheckerButton(),icon:D.a.FlowChecker,className:Object(Oe.b)(this.flowCheckerPanel)}),this.widgetUtilService.shouldHideDesignerTestButton()||r.push({key:ui.testFlow,text:this.clientResources.Common.Test,onClick:this.onTest,disabled:this.shouldDisableTestFlowButton(),icon:D.a.Test}),this.appSettings.featureFlags.enableXRMPublishFlowsV1&&(this.isSolutionFlow?(r.push({key:ui.saveFlowDraft,text:this.getSaveDraftButtonDisplay(),onClick:this.onXRMSaveDraft,disabled:this.shouldDisableSaveDraftFlowButton(),icon:D.a.Save,isSplitButton:!0,menuProps:{items:[{key:ui.restorePublished,text:this.clientResources.Common.RestorePublished,toolTipText:this.clientResources.Common.RestorePublished,onClick:()=>{this.onXRMRestorePublished()}}]}}),r.push({key:ui.publish,text:this.getPublishButtonDisplay(),onClick:this.onXRMPublish,disabled:this.shouldDisableXRMPublishFlowButton(),icon:D.a.Publish})):r.push({key:ui.saveFlow,text:this.getSaveButtonDisplayText(),onClick:this.onSave,disabled:this.shouldDisableSaveFlowButton(),icon:D.a.Save}))}e&&r.push(this.getSwitchDesignerMenuItem(t)),this.actionHeadingMenu={items:r,clientResources:this.clientResources},this.updateActionBackButton()}}},{key:"getSwitchDesignerMenuItem",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=t?ui.switchDesignerFlowRunDetails:ui.switchDesigner;return{[It.a]:"action-heading-item-".concat(i),checked:!1,disabled:this.flowV3SupportState.wasRedirectedFromV3&&!this.flowV3SupportState.currentlyLoadedFlowIsSupported,key:i,onChange:this.isFlowRunPage&&!this.isFlowCheckPage?()=>{Object($t.a)({cloudFlowPage:Bt.a.flowRunDetailsPage,flowName:this.flowName||"",isFlowLegacyShared:this.isSharedFlow,solutionId:this.solutionId,target:"v3",reason:"modalNoSaveNeededBeforeSwitch",flowRunName:this.flowRunName,loggingService:this.loggingService,navigationService:this.navigationService,routeCrafter:this.routeCrafter})}:ai((function*(){var t,i,r=!0;if(e.hasDefinitionLoaded&&null!==(t=e.lastSavedFlow)&&void 0!==t&&t.properties){var n=yield e.getFlowFromDesigner(!0);Object(M.c)(e.lastSavedFlow.properties,n.properties)||(r=!1)}else e.isFlowNotConstructed()&&(r=!1);Object(Ct.b)($e.a,{cloudFlowPage:Bt.a.flowEditPage,clientResources:e.clientResources,flowName:e.flowName,isFlowDirty:r,isFlowLegacyShared:e.isSharedFlow,isDraftScenario:!1,saveFlow:(i=ai((function*(){try{return yield e.save(),{savedFlowName:e.flowName,success:!0}}catch(t){return e.loggingService.logWarning("FlowCtrl.getSwitchDesignerMenuItem.saveFlow","Error while saving: ".concat(Object(Ce.hb)(t).message),{error:t,flowName:e.flowName}),{savedFlowName:e.flowName,success:!1}}})),function(){return i.apply(this,arguments)}),removeDraft:null,loggingService:e.loggingService,navigationService:e.navigationService,routeCrafter:e.routeCrafter,solutionId:e.solutionId,target:"v3"})})),text:t?this.clientResources.Flow.Commands.SwitchDesigner.NewView:this.clientResources.Flow.Commands.SwitchDesigner.NewDesigner,type:"toggle"}}},{key:"initializeBackButtonUsingWidgetOptions",value:function(){this.actionBackButtonDisabled=!0,this.updateActionBackButton();var e=this.loggingService.profileStart(b.a.flowNewWidgetGetWidgetOptionsStart);this.widgetUtilService.widgetOptionsAvailabilityPromise.then(()=>{this.$scope.$applyAsync(()=>{this.actionBackButtonDisabled=!1,this.updateActionBackButton()}),this.loggingService.profileEndWithSuccess(e,b.a.flowNewWidgetGetWidgetOptionsEnd)}).catch(t=>{this.loggingService.profileEnd(e,b.a.flowNewWidgetGetWidgetOptionsEnd,Object(Ce.y)(t),t)})}},{key:"updateActionBackButton",value:function(){this.actionBackButton={disabled:!!this.widgetUtilService.shouldHideDesignerBackButton()||this.actionBackButtonDisabled,backUrl:this.isFlowRunPage?"":this.getActionHeadingBackUrl(),onClick:this.onActionHeadingBackClick,telemetryData:{name:v.a.ActionHeadingBackButtonNavigate},clientResources:this.clientResources}}},{key:"onInitMonitor",value:function(){this.monitorReadyDeferred.resolve()}},{key:"onMonitorLoadComplete",value:function(){(this.isFlowRunPage||this.isFlowCheckPage)&&this.loggingService.profilePageEnd(this.pageEventCorrelationId,b.a.flowRunLoadEnd,{status:Ce.e.Success,flowName:this.flowName,flowRunName:this.flowRunName})}},{key:"onMonitorLoadError",value:function(){this.showErrorMessageInAlert(this.monitorModel.monitorLoadError)}},{key:"updateFlowDisplayName",value:function(e){this.flowDisplayName=e,this.actionHeadingTitleText=e,this.actionHeadingTitleAriaLabel=Object(p.d)(this.clientResources.FlowProperties.ActionHeading.Title.AriaLabel,this.flowDisplayName)}},{key:"getFlowFromNaturalLanguage",value:function(){return this.$q.resolve(Ve.a.flowToLoad)}},{key:"getFlow",value:function(e){var t,i=this.loggingService.performanceNow(),r=Object(l.b)(this.flowName,this.environmentService);return this.checkCdsDirectCommunicationSupportedCapabilityPromise.then(e=>e?this.$q.resolve():this.flowsClient.refresh({id:r})).then(()=>{this.pageEventData=ri(ri({},this.pageEventData),{flowRefreshingDurationForEdit:this.loggingService.performanceNow()-i}),i=this.loggingService.performanceNow()}).then(()=>{if(this.useCDSDirectCommunication){var i=this.environmentService.getCurrentEnvironmentName();return this.promiseHelperService.toAngularPromise(Object(te.b)({loggingService:this.loggingService,promise:this.xrmWorkflowHttpClient.getSolutionFlow(this.flowName,i).then(e=>{t=e.data}).catch(e=>{throw je.a.flows.entities.setEntityError(this.flowName,e),new I.a(I.c.flowProxyGetFailed,Object(p.d)(this.clientResources.Flow.Error.GetFlowDetails,e,{flowName:this.flowName}))}),eventStartName:b.a.powerAutomateProxyOperationStart,eventEndName:b.a.powerAutomateProxyOperationEnd,eventData:{caller:"FlowCtrl.getFlow",flowName:this.flowName,environmentName:i},eventCorrelationId:this.pageEventCorrelationId}))}var n=e?this.getFlowExpandParams:void 0;return(t=this.flowsClient.get(this.$scope,{id:r,$expand:n})).$promise}).then(()=>{if(this.pageEventData=ri(ri({},this.pageEventData),{flowGettingDurationForEdit:this.loggingService.performanceNow()-i}),i=this.loggingService.performanceNow(),t)return this.promiseHelperService.toAngularPromise(this.updateFlowPropertiesWithOwnerIfNecessary(t)).then(()=>{var e;if(this.flowData=t,this.lastSavedFlow=t,this.backendRPFlowDefinition=null===(e=t.properties)||void 0===e?void 0:e.definition,!Object(R.t)(t))throw new Ce.b(I.c.flowOwnerPermissionRequired,this.clientResources.Flow.Error.FlowDesignerOwnerPermissionRequired);(Object(Ne.d)(t)||Object(Ne.c)(t))&&(this.testPanel.isDisabled=!0,this.testPanel.messageBarProps={ariaLabel:this.clientResources.TestFlow.DisabledMessage,type:B.c.warning,onRenderBody:()=>this.clientResources.TestFlow.DisabledMessage}),this.updateFlowDisplayName(t.properties&&t.properties.displayName||"");var{processAdvisorMetadata:r}=t.properties;return null!=r&&r.processId&&(this.savedProcessId=r.processId),this.updateActionHeading(),this.flowDefinitionTriggerName=Object(Ee.y)(t),this.templateName=t.properties&&t.properties.templateName||"",this.originalConnectionReferences=t.properties&&t.properties.connectionReferences,this.testPanel.triggerNewTestRunAllowed=Object(Ee.ab)(t),this.flowNeedsSaveBeforeInitComments=Object(Ge.e)(t),this.pageEventData=ri(ri({},this.pageEventData),{flowRenderingDurationForEdit:this.loggingService.performanceNow()-i}),{definition:Object(g.a)(t.properties.definition),connectionReferences:t.properties.connectionReferences,definitionSummary:t.properties.definitionSummary,plan:t.properties.plan}});throw new I.a(I.c.flowNotFound,Object(p.d)(this.clientResources.Flow.Error.FlowNotFound,this.flowName),null,{flowName:this.flowName})})}},{key:"getFlowDraft",value:function(){return this.promiseHelperService.toAngularPromise(this.flowDraftClient.getFlowDraft(this.linkedDraftFlowName)).then(e=>{if(e){this.flowData=e.flow,this.currentFlowDraft=e,this.flowName=this.linkedDraftFlowName;var t=e.flow;return this.updateFlowDisplayName(t.properties&&t.properties.displayName||""),this.updateActionHeading(),this.flowDefinitionTriggerName=Object(Ee.y)(t),this.templateName=t.properties&&t.properties.templateName||"",this.originalConnectionReferences=t.properties&&t.properties.connectionReferences,{definition:Object(g.a)(t.properties.definition),connectionReferences:t.properties.connectionReferences,definitionSummary:t.properties.definitionSummary,plan:t.properties.plan}}throw new I.a(I.c.flowDraftNotFound,Object(p.d)(this.clientResources.Flow.Error.FlowNotFound,this.linkedDraftFlowName),null,{flowName:this.linkedDraftFlowName})})}},{key:"getTemplate",value:function(){var e=Object(j.c)(this.galleryName,this.templateName,this.environmentService),t=this.templatesClient.get(this.$scope,{id:e});return t.$promise.then(()=>{if(t){this.actionHeadingTitleText=this.$routeParams.newFlowName||t.properties&&t.properties.displayName||"",this.actionHeadingTitleAriaLabel=Object(p.d)(this.clientResources.FlowProperties.ActionHeading.Title.AriaLabel,this.actionHeadingTitleText);var e=t.properties.definition;e.description=t.properties.description;try{var i=mt.a.flowToLoad;return i||{definition:Object(we.f)(e,this.$routeParams),connectionReferences:Object(Se.m)(t.properties.connectionReferences,this.$routeParams,!!this.solutionId),definitionSummary:t.properties.definitionSummary}}catch(r){this.loggingService.logError("FlowCtrl.GetTemplate",r)}return{definition:e,connectionReferences:t.properties.connectionReferences,definitionSummary:t.properties.definitionSummary}}throw new I.a(I.c.templateNotFoundError,Object(p.d)(this.clientResources.Manage.Flows.Template.NotFound,this.templateName,this.galleryName),null,{galleryName:this.galleryName,templateName:this.templateName})})}},{key:"updateFlowPropertiesWithOwnerIfNecessary",value:function(e){var t=Object(R.g)(e);return!e.properties.owner&&Object(R.y)(e)&&t?this.xrmWorkflowHttpClient.getWorkflow(t,{$select:be.r.selectParams,$expand:be.r.expandParams}).then(t=>{var i,r,n,o,a,s,l={fullName:null===(i=t.data)||void 0===i||null===(i=i.owninguser)||void 0===i?void 0:i.fullname,xrmSystemUserId:null===(r=t.data)||void 0===r||null===(r=r.owninguser)||void 0===r?void 0:r.systemuserid,internalEmailAddress:null===(n=t.data)||void 0===n||null===(n=n.owninguser)||void 0===n?void 0:n.internalemailaddress,objectId:null===(o=t.data)||void 0===o||null===(o=o.owninguser)||void 0===o?void 0:o.azureactivedirectoryobjectid,isDisabled:null===(a=t.data)||void 0===a||null===(a=a.owninguser)||void 0===a?void 0:a.isdisabled,isLicensed:null===(s=t.data)||void 0===s||null===(s=s.owninguser)||void 0===s?void 0:s.islicensed};e.properties.owner=l,Object(Yt.a)()&&([this.isManagedSolutionFlowResolvedValue,this.isCustomizableSolutionFlowResolvedValue]=Object(Ht.d)(t.data))}).catch(e=>{this.loggingService.logError("FlowCtrl.GetOwnerForSolutionFlow",e)}):Promise.resolve()}},{key:"getPreviousRuns",value:function(){var e,t=this.loggingService.profileStart(b.a.testFlowPreviousRunsLoadStart);this.flowRunsClient.refreshQuery({flowName:this.flowName}).then(()=>(e=this.flowRunsClient.query(this.$scope,{flowName:this.flowName})).$promise).then(()=>{this.loggingService.profileEndWithSuccess(t,b.a.testFlowPreviousRunsLoadEnd,{flowName:this.flowName}),this.testPanel.previousRuns=(e||[]).slice(0,5)}).catch(e=>{this.loggingService.profileEnd(t,b.a.testFlowPreviousRunsLoadEnd,Object(Ce.y)(e),e,{flowName:this.flowName})})}},{key:"validateFlowHasNoErrors",value:function(e){return this.isFlowCheckerErrorPresent()?this.$q.reject({code:this.flowCheckerError}):this.$q.resolve(e)}},{key:"appendOriginalFlow",value:function(e,t){return e.then(e=>({result:e,originalFlow:t}))}},{key:"addProcessId",value:function(e){if(this.areProcessAdvisorRecommendationsEnabled()){var t={processId:this.processId};e.properties.processAdvisorMetadata=t}return this.$q.resolve(e)}},{key:"sanitizeFlowConnectionReferences",value:function(e){var t=this.loggingService.profileStart("FlowCtrl.sanitizeFlowConnectionReferences.Start",this.getDefaultFlowEventData());if(this.isXRMConnectionReferenceMode&&(Object.keys(e.properties.connectionReferences).forEach(t=>{var i=e.properties.connectionReferences[t].connectionName;delete e.properties.connectionReferences[t].connectionName,e.properties.connectionReferences[t].connectionReferenceLogicalName=i,this.loggingService.logInfo("FlowCtrl.sanitizeFlowConnectionReferences","Set connectionreference logical name",{connectionReferenceLogicalName:i})}),this.appSettings.featureFlags.enableXRMConnectionReferenceSaveValidation))try{Object.keys(e.properties.connectionReferences).forEach(t=>{var i=e.properties.connectionReferences[t].connectionReferenceLogicalName;this.loggingService.logInfo("FlowCtrl.sanitizeFlowConnectionReferences","Checking ".concat(i," with connection name\n                ").concat(e.properties.connectionReferences[t].connectionName," and connection id\n                ").concat(e.properties.connectionReferences[t].connectionId)),i in this.connectionIdToXRMLogicalNameMapping?(this.loggingService.logInfo("FlowCtrl.sanitizeFlowConnectionReferences","Connection id ".concat(i," incorrectly placed logical name")),this.loggingService.logInfo("FlowCtrl.sanitizeFlowConnectionReferences","Replace ".concat(i," with\n                  ").concat(this.connectionIdToXRMLogicalNameMapping[i])),e.properties.connectionReferences[t].connectionReferenceLogicalName=this.connectionIdToXRMLogicalNameMapping[i]):i&&i.includes("-")&&this.loggingService.logInfo("FlowCtrl.sanitizeFlowConnectionReferences","Connection id ".concat(i," incorrectly placed logical name but mapping was not\n                  found between connection id and connection reference logical name"))})}catch(i){this.loggingService.logWarning("FlowCtrl.sanitizeFlowConnectionReferences","Error on validating connection references: ".concat(i))}return this.loggingService.profileEndWithSuccess(t,"FlowCtrl.sanitizeFlowConnectionReferences.End",this.getDefaultFlowEventData()),this.$q.resolve(e)}},{key:"getDesignerConnectionReferences",value:function(e){if(e=this.removeSwaggerAndApiDefinition(e),this.willClearConnectionNamesFromFlowDefinition)try{Object(_e.a)(e),this.didClearConnectionNamesFromFlowDefinition=!0,this.loggingService.logInfo("FlowCtrl.getDesignerConnectionReferences.connectionModeDiagnosticClearConnectionNamesFromFlowDefinition","Deleted connectionNames for "+this.flowName)}catch(t){this.loggingService.logError("FlowCtrl.getDesignerConnectionReferences.connectionModeDiagnosticClearConnectionNamesFromFlowDefinition",t,{flowName:this.flowName}),this.showAlert(B.c.error,Object(Ce.db)(t))}return this.isXRMConnectionReferenceMode&&Object.keys(e||{}).forEach(t=>{var i=e[t].connectionReferenceLogicalName;i&&(delete e[t].connectionName,e[t].connectionId=i)}),e}},{key:"removeSwaggerAndApiDefinition",value:function(e){var t=Object(Y.a)(e);return Object.keys(e||{}).forEach(e=>{t[e].swagger=void 0,t[e].api=void 0,t[e].apiDefinition=void 0}),t}},{key:"save",value:function(e){var{forceSave:t,isCommentingInitialization:i}=null!=e?e:{};if(this.scenario===fe.a.editFlowDraft){if(this.currentFlowDraft.linkedApiFlowName&&!confirm(this.clientResources.DraftFlows.PublishWarning))return this.$q.resolve();this.flowDisplayName===Object(Z.b)(this.clientResources)&&(this.flowDisplayName="")}var n=this.loggingService.profileStart(b.a.saveFlowStart,this.getDefaultFlowEventData());this.setInterfaceState(ci.savingFlow),this.actionHeadingMessageBar=null;var o=this.isNewFlow;this.testPanel.isDisabled=!0;var a=!!this.testPanel.isOpen,s=Object(yt.a)();return this.designerReadyDeferred.promise.then(()=>Object(R.E)(this.flowDisplayName,this.clientResources,o)).then(()=>this.getFlowFromDesigner()).then(e=>{if(Object(zt.a)()){var t=Object(Ht.f)(this.lastSavedFlow,e);return this.validateFlowHasNoErrors(t)}return this.validateFlowHasNoErrors(e)}).then(e=>this.addProcessId(e)).then(e=>this.appendOriginalFlow(this.sanitizeFlowConnectionReferences(ri({},e)),e)).then(e=>{var i,r,o;return this.promiseHelperService.toAngularPromise(this.scenario!==fe.a.editExistingFlow||t||s?Promise.resolve(e).then(e=>{var t,i;return s?this.loggingService.logInfo("FlowCtrl.OnCloudFlowSaveChangeDetection.NotCheckingBackendFlow","Change detection passed in header to server. Not running change detection logic.",{flowName:this.flowName,workflowId:null==e||null===(t=e.result)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.workflowEntityId,solutionId:this.solutionId}):this.loggingService.logInfo("FlowCtrl.OnCloudFlowSaveChangeDetection.NotCheckingBackendFlow",this.scenario!==fe.a.editExistingFlow?"Current scenario is not editExistingFlow":"The save is forced (overwriting the backend).",{flowName:this.flowName,workflowId:null==e||null===(i=e.result)||void 0===i||null===(i=i.properties)||void 0===i?void 0:i.workflowEntityId,solutionId:this.solutionId}),e}):this.processOnCloudFlowSaveChangeDetection({originalFlow:ri(ri({},this.lastSavedFlow),{},{properties:ri(ri({},null===(i=this.lastSavedFlow)||void 0===i?void 0:i.properties),{},{definition:null!==(r=this.backendRPFlowDefinition)&&void 0!==r?r:null===(o=this.lastSavedFlow)||void 0===o||null===(o=o.properties)||void 0===o?void 0:o.definition})}),isSharedFlow:this.isSharedFlow,isSolutionFlow:this.isSolutionFlow,props:{flowName:this.flowName,reload:()=>this.onInitDesigner(),navigateToFlow:e=>this.navigateToFlow(e),overrideSave:()=>{this.testPanel.isOpen=a,this.save({forceSave:!0})},eventCorrelationId:n,updatedFlow:e.result,setMessageBarProps:e=>{var t;this.showAlert(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:B.c.error,null==e?void 0:e.message)},appSettings:this.appSettings,clientResources:this.clientResources,loggingService:this.loggingService,telemetryService:this.telemetry}}).then(()=>e))}).then(e=>(this.scenario!==fe.a.editFlowDraft||this.currentFlowDraft||(e.result.properties.displayName=null),this.appendOriginalFlow(this.saveOrUpdateFlow(e.result,s),e.originalFlow))).then(e=>(this.currentFlowDraft&&(this.flowDraftClient.deleteFlowDraft(this.linkedDraftFlowName),this.currentFlowDraft.linkedApiFlowName=e.result.data.name),e.result.data&&e.result.data.name&&e.result.data.properties&&e.result.data.properties.definition&&this.hasHttpRequestTrigger(e.result.data.properties.definition)?this.setCallback(e.result.data.name,Object(Ee.y)(e.result.data)).then(()=>this.$q.resolve(e)):this.$q.resolve(e))).then(e=>(this.flowName=e.result.data.name,this.updateFlowDisplayName(e.result.data.properties&&e.result.data.properties.displayName||""),this.widgetUtilService.isWidgetPage()||this.flowNeedsSaveBeforeInitComments||this.showAutoClaimSuccessMessageBarIfNecessary(e.result),o?this.telemetry.tagEvent(v.a.CreateFlowCompleted,{status:ge.d.succeeded,fromTemplate:this.templateName||ge.b.CreateNew},{flowName:this.flowName,solutionId:this.solutionId}):this.telemetry.tagEvent(v.a.UpdateFlowCompleted,{status:ge.d.succeeded},{flowName:this.flowName}),{result:e.result.data,originalFlow:e.originalFlow})).then(e=>{var t,r,n,o,a;this.refreshFlowsClient(),this.shouldExpandSharedConnections&&this.flowConnectionsClient.refreshQuery(),this.flowData=e.result,this.lastSavedFlow=e.originalFlow,this.backendRPFlowDefinition=null===(t=e.result)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.definition,Object(p.o)(null===(r=this.lastSavedFlow)||void 0===r?void 0:r.properties)||(!Object(p.p)(null===(n=this.lastSavedFlow)||void 0===n||null===(n=n.properties)||void 0===n?void 0:n.displayName)&&!Object(p.o)(null===(o=this.lastSavedFlow)||void 0===o||null===(o=o.properties)||void 0===o?void 0:o.displayName)||Object(p.p)(this.flowDisplayName)||(this.lastSavedFlow.properties.displayName=this.flowDisplayName),this.lastSavedFlow.properties.lastModifiedTime=null===(a=e.result)||void 0===a||null===(a=a.properties)||void 0===a?void 0:a.lastModifiedTime),this.widgetUtilService.isWidgetPage()||i||this.showSaveSuccessMessageBar(),this.flow=e.result,this.updateFlowPropertiesWithOwnerIfNecessary(this.flowData)}).then(()=>{var e;this.loggingService.profileEndWithSuccess(n,b.a.saveFlowEnd,ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),Object(ti.c)({loggingService:this.loggingService,environmentName:this.environmentService.getCurrentEnvironmentName(),flowIdentifier:null!==(e=Object(R.g)(this.flow))&&void 0!==e?e:this.flowName}),this.logRecommendationTelemetryOnSave(this.flow),this.logEditorsTelemetryOnSave(this.flow),this.setIsFlowIsRunnable(this.flow),this.saveFlowSucceededState(this.flow,o),this.testPanel.triggerNewTestRunAllowed=Object(Ee.ab)(this.flow),this.didClearConnectionNamesFromFlowDefinition=!1,Object(Xt.a)()&&(this.shouldShowNpsDialog=!0)}).then(()=>{this.onSaveWithCommenting(),this.updateFlowIsUnsupportedInV3Reasons({forceRefresh:!0}).then(()=>{this.$scope.$applyAsync(()=>{this.showOrHideUnsupportedFlowBannerIfNeeded(),this.updateActionHeading()})})}).then(()=>this.designerContext.getTriggers()).then(e=>{if(!this.flow||Object(Ne.d)(this.flow)||Object(Ne.c)(this.flow)||this.forcePollingTrigger(e),this.widgetUtilService.isNL2FlowWidget()&&this.scenario===fe.a.naturalLanguageToFlow){Ve.a.designerCreatedFlow=this.flow,this.widgetUtilService.fireUpdateContainerDimensions(We.g.TeamsDefaultModal),this.unregisterNavigateAway();var t=Object(lt.e)(this.routeCrafter,{solutionId:this.solutionId,naturalLanguageWizardStep:"3"});return this.navigationService.navigate(t)}if(this.scenario===fe.a.naturalLanguageToFlow)return this.reloadOnNewFlowFromNaturalLanguageSaved();this.isFlowDraftEditMode()&&this.navigateToFlow(this.flowName)}).catch(e=>this.getFlowFromDesigner(!0).then(e=>{var t;e.name=this.flowName,e.properties.workflowEntityId=Object(R.g)(this.flow);var i=null!==(t=e.properties.workflowEntityId)&&void 0!==t?t:e.name;return i?(this.transformConnectionReferences(e.properties.connectionReferences),this.promiseHelperService.toAngularPromise(Object(ti.b)({loggingService:this.loggingService,environmentName:this.environmentService.getCurrentEnvironmentName(),flowIdentifier:i,flow:e}))):this.$q.resolve(!1)}).then(e=>{var t;e&&(this.showAlert(B.c.info,this.clientResources.LocalAutoSave.SuccessfullyCachedMessage,Object(Ce.q)(this.clientResources),void 0,void 0,void 0,void 0,void 0,void 0,!0),this.loggingService.logInfo("FlowCtrl.save.handleLocalAutoSave","Displayed local auto save success banner",{environmentName:this.environmentService.getCurrentEnvironmentName(),flowIdentifier:null!==(t=Object(R.g)(this.flow))&&void 0!==t?t:this.flowName}))}).catch(e=>{}).finally(()=>{var t=Object(Ce.z)(e),o=t?Object(Ce.eb)(t):void 0;return this.setInterfaceState(ci.editingFlow),this.widgetUtilService.widgetCloseOnFlowSaveEnabled()&&this.widgetUtilService.setPostFlowSaveSucceeded(!1),Object(Ce.H)(e)?(this.loggingService.profileEnd(n,b.a.saveFlowEnd,Ce.e.Warning,Object(_t.b)(e,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),this.showAlert(B.c.error,Object(p.d)(this.clientResources.Plans.InvalidRecurrenceErrorFormatting,Object(Le.a)(Ue.a.activeUserPlans)),{url:Object(Me.Ib)(),text:this.clientResources.Common.LearnMore}),this.$q.reject(e)):y.a(e.code,this.flowPlanError)?(this.loggingService.profileEnd(n,b.a.saveFlowEnd,Ce.e.Warning,Object(_t.b)(e,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),this.sessionService.isConsumerDomain?this.trialDialogService.showRecurrenceUpgradeToProRequiredDialog():this.trialDialogService.showRecurrenceStartTrialDialog(e=>e?this.save():r.noop),this.$q.reject(e)):Object(Ce.T)(e)||Object(Ce.V)(e)||o?(this.loggingService.profileEnd(n,b.a.saveFlowEnd,Ce.e.Warning,Object(_t.b)(e,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),this.showAlert(B.c.error,null!=o?o:Object(Ce.db)(e),Object(Ce.V)(e)?void 0:{url:"#",text:"Upgrade",onClick:this.onInadequateQuotaLinkClick}),this.$q.reject(e)):Object(V.c)(e)?(this.loggingService.logInfo("FlowCtrl.isBackendFlowHasChangedError","A change was detected in the backend... aborting the save. The user can choose what to do next in the dialog.",{flowName:this.flowName},n),this.actionHeadingMessageBar=null,this.loggingService.profileEnd(n,b.a.saveFlowEnd,Ce.e.Warning,Object(_t.b)(e,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{lastModifiedTime:Object(R.D)(this.flowData)})),this.$q.reject(e)):Object(V.g)(e)||Object(V.e)(e)?(this.loggingService.profileEnd(n,b.a.saveFlowEnd,Ce.e.Warning,Object(_t.b)(e,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition,thrownDuringCommentInit:!!i})),i||this.showErrorMessageInAlert(e),this.$q.reject(e)):Object(Ce.G)(e)||e.code===this.flowCheckerError?(this.loggingService.profileEnd(n,b.a.saveFlowEnd,Ce.e.Warning,Object(_t.b)(e,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition,isFlowChecker:!0})),this.telemetry.tagEvent(v.a.FlowCheckerPanelOpenedOnSave),this.$q.reject(e)):Object(Ce.Y)(e)?(this.showAlert(B.c.error,this.clientResources.Designer.SaveDraftInOldDesignerErrorMessage,null,null,null,null,this.clientResources.Designer.RemoveDraftChangeMessage,this.removeDraftButtonAction,!1),this.$q.reject(e)):(this.loggingService.profileEnd(n,b.a.saveFlowEnd,Object(Ce.y)(e),Object(_t.b)(e,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition,thrownDuringCommentInit:!!i})),this.isNewFlow?this.telemetry.tagEvent(v.a.CreateFlowCompleted,{status:ge.d.failed,fromTemplate:this.templateName||ge.b.CreateNew}):this.telemetry.tagEvent(v.a.UpdateFlowCompleted,{status:ge.d.failed},{flowName:this.flowName}),e&&e.data&&e.data.error&&y.a(e.data.error.code,this.servicePrincipalNotProvisionedError)?(this.sessionService.isConsumerDomain?this.trialDialogService.showUpgradeToProRequiredDialog():this.trialDialogService.showOfficePortalSignupDialog(e=>{e&&this.onOfficePortalSignupClicked()}),this.$q.reject(e)):this.scenario===fe.a.naturalLanguageToFlow&&Object(Ce.R)(e)?(this.showAlert(B.c.error,this.clientResources.NaturalLanguageToFlow.InvalidTemplateError),this.isNL2FlowSaveTemplateIdError=!0,this.$q.reject(e)):(i||this.showErrorMessageInAlert(e),this.$q.reject(e)))})).finally(()=>{this.flow&&(Object(Ne.d)(this.flow)||Object(Ne.c)(this.flow))||(this.testPanel.isDisabled=!1),this.openFlowCheckerPanel(!0)})}},{key:"saveIfDirty",value:function(e){return Object(M.c)(this.lastSavedFlow.properties,e.properties)?this.save():null}},{key:"onUndoOrRedo",value:function(e){this.telemetry.tagEvent(v.a.UndoOrRedoClicked,{flowName:this.flowName,isUndo:e}),this.isPerformingUndoOrRedo=!0,this.actionHeadingMessageBar=null,this.setInterfaceState(ci.savingOrRenderingUndoSnapshot);var t=null;this.flowUndoService.getSnapshotOnUndoOrRedo(e).then(e=>Object(p.o)(e)?Promise.reject(new I.a(I.c.undoSnapshotNullOrUndefined,"Snapshot is null or undefined.")):Promise.resolve(e)).then(e=>{this.previousFlowStateForUndo=e.properties;var t=e.properties.connectionReferences;return this.isSolutionFlow&&(Object(pt.f)(t),t=this.getDesignerConnectionReferences(e.properties.connectionReferences)),this.designerContext.loadDefinition(e.properties.definition,t,this.scenario,void 0,!0)}).then(()=>this.flowUndoService.getPreviousSelectedCardOnUndoOrRedo(e)).then(e=>(t=e,Object(p.o)(t)?Promise.resolve(null):this.designerContext.getActions())).then(e=>{if(!Object(p.o)(e)){var i,r=null===(i=e.find(e=>Object(p.c)(e.name,t)))||void 0===i?void 0:i.nodeId;if(!Object(p.o)(r))return this.designerContext.navigateTo(r,null,null)}return Promise.resolve()}).then(()=>this.updateUndoRedoButtonEnablity()).catch(t=>{this.loggingService.logError("FlowCtrl.onUndoOrRedo",t,{flowName:this.flowName,isUndo:e});var i="Unable to ".concat(e?"undo":"redo");Object(p.o)(t)||Object(V.j)(t)===I.c.undoSnapshotNullOrUndefined||(i+=": ".concat(t)),this.showAlert(B.c.error,i)}).finally(()=>{this.setInterfaceState(ci.editingFlow),this.isPerformingUndoOrRedo=!1})}},{key:"updateUndoRedoButtonEnablity",value:function(){this.isUndoButtonDisabled=!He.a.isUndoPossible,this.isRedoButtonDisabled=!He.a.isRedoPossible}},{key:"onSaveDraft",value:function(){this.telemetry.tagEvent(v.a.SaveFlowDraftClicked);var e=this.loggingService.profileStart(b.a.saveFlowDraftStart,this.getDefaultFlowEventData());return this.setInterfaceState(ci.savingFlow),this.actionHeadingMessageBar=null,this.testPanel.isDisabled=!0,this.designerReadyDeferred.promise.then(()=>Object(R.E)(this.flowDisplayName,this.clientResources,!0)).then(()=>this.getFlowFromDesigner(!0)).then(e=>{var t=this.currentFlowDraft?{flow:e,linkedApiFlowName:this.currentFlowDraft.linkedApiFlowName,linkedApiFlowEnvironmentName:this.currentFlowDraft.linkedApiFlowEnvironmentName,linkedApiFlowSolutionId:this.currentFlowDraft.linkedApiFlowSolutionId,isLinkedApiFlowShared:this.currentFlowDraft.isLinkedApiFlowShared}:{flow:e,linkedApiFlowName:this.flowName,linkedApiFlowEnvironmentName:this.flowName?this.environmentService.getCurrentEnvironmentName():null,linkedApiFlowSolutionId:this.flowName?this.solutionId:null,isLinkedApiFlowShared:this.flowName?this.isSharedFlow:null};return this.promiseHelperService.toAngularPromise(this.flowDraftClient.saveFlowDraft(this.linkedDraftFlowName,t,this.clientResources))}).then(t=>(t&&(this.linkedDraftFlowName=t.flow.name,this.flowName=this.linkedDraftFlowName,this.loggingService.profileEndWithSuccess(e,b.a.saveFlowDraftEnd,this.getDefaultFlowEventData()),this.$scope.$applyAsync(()=>{var e=new O.a(t.flow);je.a.flows.addEntity(e,ee.a)}),this.saveFlowSucceededState(t,!0),this.actionBackButton.backUrl=this.getActionHeadingBackUrl(),this.$routeParams.flowName!==this.flowName&&this.navigateToFlow(this.flowName)),t)).catch(t=>(this.actionHeadingStatusText="",this.setInterfaceState(ci.editingFlow),this.loggingService.profileEnd(e,b.a.saveFlowEnd,Object(Ce.y)(t),Object(_t.b)(t,this.clientResources),ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),Object(Ce.db)(t,this.clientResources.Common.SomethingWentWrong),this.telemetry.tagEvent(v.a.CreateFlowDraftCompleted,{status:ge.d.failed,fromTemplate:this.templateName||ge.b.CreateNew}),this.showErrorMessageInAlert(t),this.$q.reject(t)))}},{key:"xrmSaveDraft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.loggingService.profileStart(b.a.xrmSaveDraftFlowStart,this.getDefaultFlowEventData());this.setInterfaceState(ci.savingDraftFlow),this.actionHeadingMessageBar=null,this.testPanel.isDisabled=!0;var n=!!this.testPanel.isOpen;return this.designerReadyDeferred.promise.then(()=>Object(R.E)(this.flowDisplayName,this.clientResources,this.isNewFlow)).then(()=>this.getFlowFromDesigner()).then(e=>this.validateFlowHasNoErrors(e)).then(e=>this.addProcessId(e)).then(e=>this.appendOriginalFlow(this.sanitizeFlowConnectionReferences(ri({},e)),e)).then(r=>{var o,a,s;return this.promiseHelperService.toAngularPromise(this.scenario!==fe.a.editExistingFlow||e?Promise.resolve(r).then(e=>{var t;return this.loggingService.logInfo("FlowCtrl.OnCloudFlowSaveChangeDetection.NotCheckingBackendFlow",this.scenario!==fe.a.editExistingFlow?"Current scenario is not editExistingFlow":"The save is forced (overwriting the backend).",{flowName:this.flowName,workflowId:null==e||null===(t=e.result)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.workflowEntityId,solutionId:this.solutionId}),e}):this.processOnCloudFlowSaveChangeDetection({originalFlow:ri(ri({},this.lastSavedFlow),{},{properties:ri(ri({},null===(o=this.lastSavedFlow)||void 0===o?void 0:o.properties),{},{definition:null!==(a=this.backendRPFlowDefinition)&&void 0!==a?a:null===(s=this.lastSavedFlow)||void 0===s||null===(s=s.properties)||void 0===s?void 0:s.definition})}),isSharedFlow:this.isSharedFlow,isSolutionFlow:this.isSolutionFlow,props:{flowName:this.flowName,reload:()=>this.onInitDesigner(),navigateToFlow:e=>this.navigateToFlow(e),overrideSave:()=>{this.testPanel.isOpen=n,this.xrmSaveDraft(!0,t)},eventCorrelationId:i,updatedFlow:r.result,setMessageBarProps:e=>{var t;this.showAlert(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:B.c.error,null==e?void 0:e.message)},appSettings:this.appSettings,clientResources:this.clientResources,loggingService:this.loggingService,telemetryService:this.telemetry}}).then(()=>r))}).then(e=>(this.scenario!==fe.a.editFlowDraft||this.currentFlowDraft||(e.result.properties.displayName=null),this.appendOriginalFlow(this.xrmSaveDraftFlow(e.result,t),e.originalFlow))).then(e=>(this.currentFlowDraft&&(this.flowDraftClient.deleteFlowDraft(this.linkedDraftFlowName),this.currentFlowDraft.linkedApiFlowName=e.result.data.name),e.result.data&&e.result.data.name&&e.result.data.properties&&e.result.data.properties.definition&&this.hasHttpRequestTrigger(e.result.data.properties.definition)?this.setCallback(e.result.data.name,Object(Ee.y)(e.result.data)).then(()=>this.$q.resolve(e)):this.$q.resolve(e))).then(e=>(this.flowName=e.result.data.name,this.updateFlowDisplayName(e.result.data.properties&&e.result.data.properties.displayName||""),this.widgetUtilService.isWidgetPage()||this.flowNeedsSaveBeforeInitComments||this.showAutoClaimSuccessMessageBarIfNecessary(e.result),this.isNewFlow?this.telemetry.tagEvent(v.a.CreateFlowCompleted,{status:ge.d.succeeded,fromTemplate:this.templateName||ge.b.CreateNew},{flowName:this.flowName,solutionId:this.solutionId}):this.telemetry.tagEvent(v.a.UpdateFlowCompleted,{status:ge.d.succeeded},{flowName:this.flowName}),{result:e.result.data,originalFlow:e.originalFlow})).then(e=>{var t,i,r,n,o;this.refreshFlowsClient(),this.shouldExpandSharedConnections&&this.flowConnectionsClient.refreshQuery(),this.flowData=e.result,this.lastSavedFlow=e.originalFlow,this.backendRPFlowDefinition=null===(t=e.result)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.definition,Object(p.o)(null===(i=this.lastSavedFlow)||void 0===i?void 0:i.properties)||(!Object(p.p)(null===(r=this.lastSavedFlow)||void 0===r||null===(r=r.properties)||void 0===r?void 0:r.displayName)&&!Object(p.o)(null===(n=this.lastSavedFlow)||void 0===n||null===(n=n.properties)||void 0===n?void 0:n.displayName)||Object(p.p)(this.flowDisplayName)||(this.lastSavedFlow.properties.displayName=this.flowDisplayName),this.lastSavedFlow.properties.lastModifiedTime=null===(o=e.result)||void 0===o||null===(o=o.properties)||void 0===o?void 0:o.lastModifiedTime),this.widgetUtilService.isWidgetPage()||this.flowNeedsSaveBeforeInitComments||this.showSaveSuccessMessageBar(),this.flow=e.result}).then(()=>{this.loggingService.profileEndWithSuccess(i,b.a.xrmSaveDraftFlowEnd,ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),this.logRecommendationTelemetryOnSave(this.flow),this.logEditorsTelemetryOnSave(this.flow),this.setIsFlowIsRunnable(this.flow),this.saveFlowSucceededState(this.flow,this.isNewFlow),this.testPanel.triggerNewTestRunAllowed=Object(Ee.ab)(this.flow),this.didClearConnectionNamesFromFlowDefinition=!1}).then(()=>{this.onSaveWithCommenting()}).then(()=>this.designerContext.getTriggers()).then(e=>{if(!this.flow||Object(Ne.d)(this.flow)||Object(Ne.c)(this.flow)||this.forcePollingTrigger(e),this.scenario===fe.a.naturalLanguageToFlow)return this.reloadOnNewFlowFromNaturalLanguageSaved();this.isFlowDraftEditMode()&&this.navigateToFlow(this.flowName)}).catch(e=>(this.actionHeadingStatusText="",this.setInterfaceState(ci.editingFlow),this.widgetUtilService.widgetCloseOnFlowSaveEnabled()&&this.widgetUtilService.setPostFlowSaveSucceeded(!1),Object(Ce.H)(e)?(this.showAlert(B.c.error,Object(p.d)(this.clientResources.Plans.InvalidRecurrenceErrorFormatting,Object(Le.a)(Ue.a.activeUserPlans)),{url:Object(Me.Ib)(),text:this.clientResources.Common.LearnMore}),this.$q.reject(e)):y.a(e.code,this.flowPlanError)?(this.sessionService.isConsumerDomain?this.trialDialogService.showRecurrenceUpgradeToProRequiredDialog():this.trialDialogService.showRecurrenceStartTrialDialog(e=>e?this.save():r.noop),this.$q.reject(e)):Object(Ce.T)(e)||Object(Ce.V)(e)?(this.loggingService.profileEnd(i,b.a.xrmSaveDraftFlowEnd,Object(Ce.y)(e),e,ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),this.showAlert(B.c.error,Object(Ce.db)(e),Object(Ce.V)(e)?void 0:{url:"#",text:"Upgrade",onClick:this.onInadequateQuotaLinkClick}),this.$q.reject(e)):Object(V.c)(e)?(this.loggingService.logInfo("FlowCtrl.isBackendFlowHasChangedError","A change was detected in the backend... aborting the save. The user can choose what to do next in the dialog.",{flowName:this.flowName},i),this.actionHeadingMessageBar=null,this.loggingService.profileEnd(i,b.a.xrmSaveDraftFlowEnd,Ce.e.Warning,e,ri(ri({},this.getDefaultFlowEventData()),{},{lastModifiedTime:Object(R.D)(this.flowData)})),this.$q.reject(e)):Object(V.g)(e)||Object(V.e)(e)?(this.loggingService.profileEnd(i,b.a.xrmSaveDraftFlowEnd,Ce.e.Warning,e,ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),this.showErrorMessageInAlert(e),this.$q.reject(e)):Object(Ce.G)(e)||e.code===this.flowCheckerError?(this.telemetry.tagEvent(v.a.FlowCheckerPanelOpenedOnSave),this.$q.reject(e)):(this.loggingService.profileEnd(i,b.a.xrmSaveDraftFlowEnd,Object(Ce.y)(e),e,ri(ri({},this.getDefaultFlowEventData()),{},{didClearConnectionNamesFromFlowDefinition:this.didClearConnectionNamesFromFlowDefinition})),Object(Ce.db)(e,this.clientResources.Common.SomethingWentWrong),this.isNewFlow?this.telemetry.tagEvent(v.a.CreateFlowCompleted,{status:ge.d.failed,fromTemplate:this.templateName||ge.b.CreateNew}):this.telemetry.tagEvent(v.a.UpdateFlowCompleted,{status:ge.d.failed},{flowName:this.flowName}),e&&e.data&&e.data.error&&y.a(e.data.error.code,this.servicePrincipalNotProvisionedError)?(this.sessionService.isConsumerDomain?this.trialDialogService.showUpgradeToProRequiredDialog():this.trialDialogService.showOfficePortalSignupDialog(e=>{e&&this.onOfficePortalSignupClicked()}),this.$q.reject(e)):this.scenario===fe.a.naturalLanguageToFlow&&Object(Ce.R)(e)?(this.showAlert(B.c.error,this.clientResources.NaturalLanguageToFlow.InvalidTemplateError),this.isNL2FlowSaveTemplateIdError=!0,this.$q.reject(e)):(this.showErrorMessageInAlert(e),this.$q.reject(e))))).finally(()=>{this.flow&&(Object(Ne.d)(this.flow)||Object(Ne.c)(this.flow))||(this.testPanel.isDisabled=!1),this.openFlowCheckerPanel(!0)})}},{key:"xrmRestoreLastPublished",value:function(){var e;this.promiseHelperService.toAngularPromise(this.xrmWorkflowHttpClient.restoreLastPublished(this.flowData.properties.workflowEntityId).then(t=>(e=t.data,this.flowName=e.workflowid,Object(Xe.a)(this.getFlow()))).then(t=>(this.flow=this.flowData,Object(et.h)(e,this.solutionId,je.a),{data:this.flow})))}},{key:"navigateToFlow",value:function(e){this.unregisterNavigateAway(),this.navigationService.navigate(Object(Fe.d)(this.routeCrafter,{flowName:e,solutionId:this.solutionId,isLegacyShared:this.isSharedFlow}))}},{key:"navigateToFlowDraftsListPage",value:function(){this.navigationService.navigate("".concat(Object(Fe.c)(this.routeCrafter)))}},{key:"logEditorsTelemetryOnSave",value:function(e){var t,i=null===(t=e.properties.definition)||void 0===t?void 0:t.actions;if(i)for(var r of Object.keys(i)){var n,o,a=null===(n=i[r].inputs)||void 0===n||null===(n=n.host)||void 0===n?void 0:n.connectionName,s=null===(o=i[r].inputs)||void 0===o||null===(o=o.host)||void 0===o?void 0:o.operationId;if("shared_sharepointonline"===a&&("GetItems"===s||"GetFileItems"===s)){var l,c=!1,u=null===(l=i[r].inputs)||void 0===l?void 0:l.parameters;u&&"$filter"in u&&(c=!0),this.loggingService.logInfo(v.a.FilterQuerySetOnSave,"Has the user entered data in the Filter Query field in the specified action?",{operationId:s,filterQueryUsed:c})}}}},{key:"onRunNow",value:function(){this.invokeFlowPanelAngularWrapperBindings.flowName=this.flowName,this.invokeFlowPanelAngularWrapperBindings.isTestRun=!0,this.invokeFlowPanelAngularWrapperBindings.isOpen=!0}},{key:"miniWidgetGoBack",value:function(){this.navigationService.navigate(this.getWidgetBackUrl())}},{key:"getWidgetBackUrl",value:function(){var e=this.widgetUtilService.getPathAliasOverrides().designerBackButton?this.widgetUtilService.getPathAliasOverrides().designerBackButton:this.ngUrlService.defaultPathAlias();return this.ngUrlService.routeWithPathAlias(e)}},{key:"getActionHeadingBackUrl",value:function(){if(this.isFromCreateWizard)return"";if(this.widgetUtilService.isWidgetPage()){var e;if(this.widgetUtilService.widgetCloseOnFlowSaveEnabled()||this.widgetUtilService.isTeamsSolutionExplorerContext())return"";if(null===(e=this.widgetService.widgetInfo)||void 0===e||null===(e=e.flowsSettings)||void 0===e||!e.isMini)return this.getWidgetBackUrl()}return this.backUrl?this.backUrl:this.flowName&&!this.isFlowDraftEditMode()?Object(Fe.m)(this.routeCrafter,{flowName:this.flowName,isLegacyShared:this.isSharedFlow,solutionId:this.solutionId}):Object(Fe.t)(this.routeCrafter)}},{key:"isSaving",value:function(){return this.flowInterfaceState===ci.savingFlow}},{key:"isTesting",value:function(){return this.flowInterfaceState!==ci.editingFlow&&this.flowInterfaceState!==ci.savingFlow}},{key:"isFlowDraftEditMode",value:function(){return Object(ze.a)(this.flowName)}},{key:"shouldDisplayDraftOverlay",value:function(){return this.isFlowDraftEditMode()&&this.appSettings.featureFlags.enableDraftFlows}},{key:"isMonitorEnabled",value:function(){return this.flowInterfaceState===ci.renderingTestRun||this.flowInterfaceState===ci.runComplete}},{key:"isSimulateTriggerSupported",value:function(e){return e&&e.hasOwnProperty(x.d.OperationContext)&&void 0!==e[x.d.OperationContext][x.d.Simulate]}},{key:"isFlowCheckerErrorPresent",value:function(){return this.appSettings.flowCheckerDebounceRate>250&&this.flowCheckerPanel.flowCheckerErrors.length+this.flowCheckerPanel.parametersErrors.length+this.flowCheckerPanel.connectionErrors.length>0}},{key:"transformDesignerWorkflow",value:function(e){var t=this.transformDesignerWorkflowProperties(e);return Promise.all([this.designerContext.getActions(),this.designerContext.getTriggers()]).then(e=>{var[i,r]=e;return this.transformFlowForCommenting(t,i,r)})}},{key:"transformDesignerWorkflowSync",value:function(e){return this.transformFlowForCommenting(this.transformDesignerWorkflowProperties(e),this.designerContext.getActionsSync(),this.designerContext.getTriggersSync())}},{key:"transformDesignerWorkflowProperties",value:function(e){var t={};return e&&(t.properties=ri(ri({},e),{},{displayName:this.flowDisplayName,connectionReferences:this.getConnectionReferences(e.connectionReferences),definition:Object(g.b)(e.definition),templateName:this.templateName}),this.isXrmEnvironmentVariablesEnabled()&&(t.properties.definition=Object(we.e)(t.properties.definition))),t}},{key:"getFlowFromDesignerSync",value:function(e){var t=this.transformDesignerWorkflowSync(this.designerContext.getDefinitionSync(e));return this.currentFlowFromDesigner=t,t}},{key:"updateFlowCheckerErrors",value:function(){Object(At.a)()||this.flowCheckerPanel.flowCheckerErrors.some(e=>e.ruleId===_.b.FlowAiBuilderCustomPromptHITLChecker)||(this.flowCheckerPanel.flowCheckerErrors=this.flowCheckerPanel.flowCheckerErrors.concat(Object(ve.a)(this.currentFlowFromDesigner.properties,this.clientResources))),Object(At.b)()||this.flowCheckerPanel.flowCheckerErrors.some(e=>e.ruleId===_.b.FlowAiBuilderGptHITLChecker)||(this.flowCheckerPanel.flowCheckerErrors=this.flowCheckerPanel.flowCheckerErrors.concat(Object(ve.b)(this.currentFlowFromDesigner.properties,this.clientResources)))}},{key:"getFlowFromDesigner",value:function(e){var t=this.$q.defer(),i={skipValidation:null!==e&&e,ignoreNonCriticalErrors:!0};return this.designerContext.getDefinition(i).then(e=>this.promiseHelperService.toAngularPromise(this.transformDesignerWorkflow(e))).then(e=>(this.currentFlowFromDesigner=e,this.updateFlowCheckerErrors(),t.resolve(e),t.promise)).catch(e=>(t.reject(e),t.promise))}},{key:"getDesignerTriggerFromFlow",value:function(e){return e.properties.definition.triggers&&Object.values(e.properties.definition.triggers)[0]}},{key:"getApiSwaggerForDesignerOperation",value:function(e,t){return this.designerContext.getSwaggerSync(this.getDesignerTriggerApiId(e,t))}},{key:"getDesignerTriggerApiId",value:function(e,t){if(N.b(t))return t.inputs&&t.inputs.host&&t.inputs.host.apiId;if(N.a(t)){var i=t.inputs&&t.inputs.host&&t.inputs.host.connection&&t.inputs.host.connection.name,r=Object(Se.i)(i),n=Object(Se.k)(e);return n[r]&&n[r].id}}},{key:"getDesignerTriggerOperationId",value:function(e){return N.b(e)?e.inputs&&e.inputs.host&&e.inputs.host.operationId:e.metadata&&e.metadata.flowSystemMetadata&&e.metadata.flowSystemMetadata.swaggerOperationId}},{key:"isTriggerConcurrencyEnabled",value:function(e){return!!(e&&e.runtimeConfiguration&&e.runtimeConfiguration.concurrency)}},{key:"getTriggerHint",value:function(){return this.designerContext.getTriggers().then(e=>{var t=e&&e[0];if(!N.c(t))return t&&t.hint?t.hint:this.clientResources.Flow.DefaultTriggerHint})}},{key:"getConnectorNameForDesignerTrigger",value:function(e){return e.info&&e.info.title}},{key:"saveOrUpdateFlow",value:function(e,t){var i,r,n,o=this,a=this.scenario;return Object(Ke.a)(e,!0,this.environmentService.getCurrentEnvironmentName()),this.isNewFlow&&this.widgetUtilService.isWidgetPage()&&null!==(i=this.widgetService.widgetInfo)&&void 0!==i&&i.groupId&&this.extendPropsWithOwner(e,this.widgetService.widgetInfo.groupId),this.widgetUtilService.isWidgetPage()&&Object(Vt.a)()&&this.extendBodyWithWidgetHostId(e,null===(n=this.widgetService.widgetInfo)||void 0===n?void 0:n.hostId),a===fe.a.editFlowDraft?r=this.currentFlowDraft&&this.currentFlowDraft.linkedApiFlowName?this.ngFlowService.patch({id:Object(l.b)(this.currentFlowDraft.linkedApiFlowName,this.environmentService)},Object(Se.q)(e)):this.ngFlowService.post({id:Object(l.d)(this.environmentService)},e):a!==fe.a.editExistingFlow?(a===fe.a.newFlowFromTemplate?e.properties.templateName=this.templateName:this.appSettings.featureFlags.enableNL2FlowTemplateId&&a===fe.a.naturalLanguageToFlow&&this.appSettings.naturalLanguageToFlowTemplateId&&!this.isNL2FlowSaveTemplateIdError&&(e.properties.templateName=this.appSettings.naturalLanguageToFlowTemplateId),r=this.solutionId?this.checkCdsDirectCommunicationSupportedCapabilityPromise.then(t=>{if(t){var i=null;return this.promiseHelperService.toAngularPromise(this.xrmWorkflowHttpClient.getSolution(this.solutionId).then(function(){var t=ai((function*(t){return o.xrmWorkflowHttpClient.createWorkflow(Object(et.d)(e),t.data,{createAsMcsFlow:yield o.shouldCreateAsMcsFlow()})}));return function(e){return t.apply(this,arguments)}}()).then(e=>this.xrmWorkflowHttpClient.activateWorkflow(e.workflowid)).then(e=>(i=e.data,this.flowName=i.workflowid,Object(Xe.a)(this.getFlow()))).then(e=>(this.flow=this.flowData,Object(et.h)(i,this.solutionId,je.a),{data:this.flow}))).catch(e=>{throw e})}return this.promiseHelperService.toAngularPromise(this.shouldCreateAsMcsFlow().then(t=>(t&&(e.properties.powerFlowType=pe.o.CopilotStudioFlow),this.flowsClient.createSolutionFlow({solutionId:this.solutionId},e).then(e=>{if(Object(l.g)(e)){var t=new O.a(e.data);this.flowService.addFlowToSpecifiedCollections(t,[wt.a.personal,wt.a.allOwnedFlows]),je.a.flows.entities.setEntitySuccess(t.name),je.a.setFlowMetadata(t.name,{propertiesPageCount:0,savedRecently:!0,isNewFlow:!0})}return e}).catch(e=>{var t,i,{code:r,message:n}=null!==(t=null==e||null===(i=e.data)||void 0===i?void 0:i.error)&&void 0!==t?t:{};if(r&&n)throw e.data.error;throw e}))))}):this.ngFlowService.post({id:Object(l.d)(this.environmentService)},e)):r=Object(R.y)(this.flow)&&!Object(R.B)(this.flow)&&this.appSettings.featureFlags.enableSolutionFlowsCDSDirectCommunication?this.promiseHelperService.toAngularPromise(this.xrmWorkflowHttpClient.patchWorkflow(this.flowData.properties.workflowEntityId,Object(et.e)(e.properties)).then(e=>({data:Object(et.h)(e.data,this.solutionId,je.a)})).catch(e=>{throw je.a.flows.entities.setEntityError(this.flowData.properties.workflowEntityId,e),e})):this.ngFlowService.patch({id:Object(l.b)(this.flowName,this.environmentService)},Object(Se.q)(e),this.flowNeedsSaveBeforeInitComments,t?Object(R.D)(this.flowData):void 0),this.promiseHelperService.toAngularPromise(Object(te.b)({loggingService:this.loggingService,promise:Object(f.a)(r),eventStartName:"FlowCtrl.saveOrUpdateFlow.Start",eventEndName:"FlowCtrl.saveOrUpdateFlow.End",eventData:this.getDefaultFlowEventData()}))}},{key:"xrmSaveDraftFlow",value:function(e){var t,i,r=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.scenario;Object(Ke.a)(e,!0,this.environmentService.getCurrentEnvironmentName()),this.isNewFlow&&this.widgetUtilService.isWidgetPage()&&null!==(t=this.widgetService.widgetInfo)&&void 0!==t&&t.groupId&&this.extendPropsWithOwner(e,this.widgetService.widgetInfo.groupId);var a=null;if(o!==fe.a.editExistingFlow){o===fe.a.newFlowFromTemplate?e.properties.templateName=this.templateName:this.appSettings.featureFlags.enableNL2FlowTemplateId&&o===fe.a.naturalLanguageToFlow&&this.appSettings.naturalLanguageToFlowTemplateId&&!this.isNL2FlowSaveTemplateIdError&&(e.properties.templateName=this.appSettings.naturalLanguageToFlowTemplateId);var s=!1;i=this.checkCdsDirectCommunicationSupportedCapabilityPromise.then(()=>this.promiseHelperService.toAngularPromise(this.xrmWorkflowHttpClient.getSolution(this.solutionId).then(function(){var t=ai((function*(t){return s=yield r.shouldCreateAsMcsFlow(),r.xrmWorkflowHttpClient.createWorkflow(Object(et.d)(e),t.data,{isDraft:!0,createAsMcsFlow:s})}));return function(e){return t.apply(this,arguments)}}()).then(e=>(this.flowName=a.workflowid,n&&(this.loggingService.profileStart(b.a.xrmPublishFlowStart,this.getDefaultFlowEventData()),this.xrmWorkflowHttpClient.publishWorkflow(e.workflowid,!0,e,!0)),Object(Xe.a)(this.getFlow()))).then(e=>(this.flow=this.flowData,Object(et.h)(a,this.solutionId,je.a),{data:this.flow}))).catch(e=>{throw e}))}else i=this.promiseHelperService.toAngularPromise(this.xrmWorkflowHttpClient.patchWorkflow(this.flowData.properties.workflowEntityId,Object(et.e)(e.properties)).then(e=>(a=e.data,n&&this.xrmWorkflowHttpClient.publishWorkflow(a.workflowid,!1,a,!0),{data:Object(et.h)(e.data,this.solutionId,je.a)})).catch(e=>{throw je.a.flows.entities.setEntityError(this.flowData.properties.workflowEntityId,e),e}));return i}},{key:"shouldCreateAsMcsFlow",value:(s=ai((function*(){if(Object(Zt.b)(this.templateName))try{var e;return yield Object(Te.e)(ei.a.modernFlowTypeMinimumVersion,!(null===(e=Ae.a.environmentClaim)||void 0===e||!e.hasXrmInstance),this.xrmEntityHttpClient)}catch(t){return this.loggingService.logError("FlowCtrl.shouldCreateAsMcsFlow getting org info",t),!1}return!1})),function(){return s.apply(this,arguments)})},{key:"extendPropsWithOwner",value:function(e,t){(e=e||{properties:{}}).properties=e.properties||{};var i={owners:[{properties:{principal:{id:t}}}]};return e.properties=$.extend(e.properties,i),e}},{key:"extendBodyWithWidgetHostId",value:function(e,t){return(e=e||{telemetryMetadata:{}}).telemetryMetadata=ri(ri({},e.telemetryMetadata),{},{modifiedSources:t}),this.isNewFlow&&(e.telemetryMetadata=ri(ri({},e.telemetryMetadata),{},{creationSource:t})),e}},{key:"refreshFlowsClient",value:function(){var e,t=[];return t.push(this.flowsClient.refresh({id:Object(l.b)(this.flowName,this.environmentService)})),t.push(this.flowsClient.refreshQuery(Object(l.c)({isPersonal:!0,encodedFlowsFilter:null===(e=this.widgetService.widgetInfo)||void 0===e||null===(e=e.flowsSettings)||void 0===e?void 0:e.encodedFlowsFilter}))),this.$q.all(t).catch(e=>this.loggingService.logError("FlowCtrl.RefreshFlowsClient",e))}},{key:"getConnectionReferences",value:function(e){return Object.keys(e).forEach(t=>{delete e[t].connectionId,this.originalConnectionReferences&&this.originalConnectionReferences[t]&&(e[t].source=this.originalConnectionReferences[t].source)}),e}},{key:"transformConnectionReferences",value:function(e){return Object.keys(e).forEach(t=>{this.isXRMConnectionReferenceMode&&(e[t].connectionReferenceLogicalName=e[t].connectionName,e[t].connectionName=Object(Qe.a)(xe.a.getConnectionIdFromDesignerConnectionId(e[t].connectionName)))}),e}},{key:"getFlowCheckersWarningsForPowerAppsTriggeredFlows",value:function(e){var t=[];if(this.flowCheckerPanel.triggers.some(e=>Object(y.a)(e.kind,x.f.POWERAPPV2)||Object(y.a)(e.kind,x.f.POWERAPP)))try{if(Object(M.d)(this.lastSavedFlow.properties,e)){var i={errorDescription:this.clientResources.FlowChecker.PowerAppsTrigger.TriggerWarnings,operationName:x.g.manual};t.push(i),this.loggingService.logWarning("FlowCtrl.CheckPowerAppFlow","The triggers are dirty")}Object(M.a)(this.lastSavedFlow.properties,e)&&(this.$scope.$applyAsync(()=>{this.flowCheckerPanel.connectionWarnings=Object(Oe.d)(this.flowCheckerPanel.triggers,this.flowCheckerPanel.actions,this.originalConnectionReferences,this.clientResources),this.updateActionHeading()}),this.loggingService.logWarning("FlowCtrl.CheckPowerAppFlow","The Connection References are dirty"))}catch(r){return this.loggingService.logError("FlowCtrl.CheckPowerAppFlow",r),t}return t}},{key:"showAlert",value:function(e,t,i,r,n,o,a,s,l,c,u,d){var p={type:e,message:t,link:i,linksWithInterpolationProps:r,dismissButtonAriaLabel:n,dataAutomationId:o,actions:a?Object(st.a)(a,s):null,isMultiline:l,styles:u,messageBarIconProps:d};c?this.addAdditionalMessageBar(p):this.setMainMessageBar(p)}},{key:"setMainMessageBar",value:function(e){this.actionHeadingMessageBar=ri({onDismiss:this.onMessageBarDismiss},e)}},{key:"addAdditionalMessageBar",value:function(e){this.actionHeadingAdditionalMessageBar.push(e)}},{key:"showCallbackUrlDeprecationMessageBarIfNeeded",value:function(){Object(R.n)(this.flow)&&this.flowTriggerCallbackUrlClient.post({id:Object(U.a)(this.flow.name,Object(Ee.y)(this.flow),this.environmentService),showdeprecatedcallbackurl:"true"},{}).then(e=>{var t=e.data.response,i=t&&t.value;i&&Object(R.k)(i)&&this.setMainMessageBar({type:B.c.warning,message:Object(p.d)(this.clientResources.FlowPropertiesPage.RequestTriggerMigrationMessageBar.Details.TextWithLink,i),isMultiline:!0,dataAutomationId:ie.a.deprecated_request_trigger_url,link:{target:P.a.blank,url:this.clientResources.FlowPropertiesPage.RequestTriggerMigrationMessageBar.Details.Link,text:this.clientResources.FlowPropertiesPage.RequestTriggerMigrationMessageBar.Details.LinkText}})}).catch(e=>{this.loggingService.logError("FlowCtrl.showCallbackUrlDeprecationMessageBarIfNeeded",e)})}},{key:"showSaveSuccessMessageBar",value:function(){this.setMainMessageBar({type:B.c.success,message:this.clientResources.Designer.SaveSuccessMessage,actions:this.isNewFlowFromNaturalLanguage?Object(st.a)(this.clientResources.NaturalLanguageToFlow.SendFeedbackButtonText,this.easyAutomationPanelStore.openFeedbackPanel):void 0,isMultiline:!1,dataAutomationId:ie.a.flow_save_success_message})}},{key:"showRemoveDraftSuccessMessageBar",value:function(){this.$scope.$applyAsync(()=>{this.setMainMessageBar({type:B.c.success,message:this.clientResources.Designer.DraftChangesWereRemovedMessage})})}},{key:"showAutoClaimSuccessMessageBarIfNecessary",value:function(e){Object(Lt.a)(e)&&(this.telemetry.tagEvent(v.a.AutoClaimNotificationBannerShowed,{status:ge.d.succeeded},{flowName:this.flowName}),this.showAlert(B.c.info,this.clientResources.SuccessfulRequestAutoClaim.Text,{target:P.a.blank,url:this.clientResources.SuccessfulRequestAutoClaim.Link,text:this.clientResources.SuccessfulRequestAutoClaim.LinkText},null,this.clientResources.Common.Dismiss,"autoclaimnotification",null,null,!0,!0))}},{key:"showNL2FlowSuccessMessageBar",value:function(){this.setMainMessageBar({type:B.c.success,message:Object(dt.a)(this.clientResources.NaturalLanguageToFlow.FlowGeneratedMessageBarPublicPreviewTitle,this.clientResources.NaturalLanguageToFlow.FlowGeneratedMessageBarPublicPreviewText),isMultiline:!1})}},{key:"showContextualHelpPanel",value:function(){this.contextualHelpPanel.widgetUtilService=this.widgetUtilService,this.contextualHelpPanel.flowName=this.flowName,this.contextualHelpPanel.isOpen=!0,this.designerContext&&this.designerContext.getSelectedActionOrTrigger&&this.designerContext.getSelectedActionOrTrigger().then(e=>{this.telemetry.tagEvent(v.a.ContextualHelpPaneOpened,{title:e&&e.action&&(e.summary||e.action.friendlyName),connectorDisplayName:e&&e.connectorDisplayName}),this.onSelectedActionOrTriggerChanged(e)}).catch(e=>{this.loggingService.logError("FlowCtrl.showContextualHelpPanel",e)})}},{key:"setDesignerReadOnlyState",value:function(e){this.designerContext&&this.designerContext.setReadOnly&&this.designerContext.setReadOnly(e)}},{key:"setUpdateCallbacks",value:function(e){this.designerContext&&this.designerContext.updateCallbacksOnSave&&this.designerContext.updateCallbacksOnSave(e)}},{key:"showErrorMessageInAlert",value:function(e){this.showAlert(B.c.error,Object(Ce.db)(e,this.clientResources.Common.SomethingWentWrong),null,null,null,ie.a.message_bar_message_generic)}},{key:"showRunStatus",value:function(e){if(Object(De.m)(e)&&Object(et.g)(e))this.setMainMessageBar({type:B.c.success,message:this.clientResources.Flow.Status.RunSuccessful,actions:this.isNewFlowFromNaturalLanguage?Object(st.a)(this.clientResources.NaturalLanguageToFlow.SendFeedbackButtonText,this.easyAutomationPanelStore.openFeedbackPanel):void 0,isMultiline:!1,dismissButtonAriaLabel:this.clientResources.Flow.Status.CloseButtonAriaLabel.RunSuccessful,dataAutomationId:ie.a.flow_run_success_message}),this.setInterfaceState(ci.runComplete);else if(Object(De.f)(e))this.showAlert(B.c.info,this.clientResources.Flow.Status.Canceling),this.setInterfaceState(ci.runComplete);else if(Object(De.k)(e)){var t=ri(ri({},this.clientResources.Manage.Flow),{},{SlowPerformance:this.clientResources.SlowPerformance,HighUsage:this.clientResources.HighUsage}),i=Object(tt.c)(this.flow,t,this.clientResources.DateTime);i?this.showAlert(B.c.warning,i,Object(Ce.s)(this.clientResources)):this.showAlert(B.c.progress,this.clientResources.Flow.Status.Running),this.monitorReadyDeferred.promise.then(()=>{this.flowRunService.waitForFlowRunToComplete(this.$scope,e,this.monitorContext,this.flowRunCompleted)}),this.setInterfaceState(ci.renderingTestRun)}else Object(De.e)(e)?(this.setMainMessageBar({type:B.c.error,message:this.clientResources.Flow.Status.RunFailed,actions:this.isNewFlowFromNaturalLanguage?Object(st.a)(this.clientResources.NaturalLanguageToFlow.SendFeedbackButtonText,this.easyAutomationPanelStore.openFeedbackPanel):void 0,isMultiline:!1,dataAutomationId:ie.a.flow_run_fail_message}),this.setInterfaceState(ci.runComplete),e.name&&(this.flowRunName=e.name,this.showRemediationPaneForFailedRun())):this.setInterfaceState(ci.runComplete)}},{key:"setInterfaceState",value:function(e){switch(this.flowInterfaceState=e,this.isFlowRunCompleted=!1,this.hostCommunicationService.triggerHostEvent(We.e.GET_FULL_DESIGNER_STATE,{state:e}),e){default:case ci.editingFlow:this.setDesignerReadOnlyState(!1),this.hideAndResetRemediationPane(),this.updateUndoRedoButtonEnablity();break;case ci.savingFlow:this.widgetUtilService.isMiniWidget()&&this.showAlert(B.c.progress,this.clientResources.Flow.Status.Saving),this.setDesignerReadOnlyState(!0),this.actionHeadingStatusText=this.clientResources.Flow.Status.Saving,this.isUndoButtonDisabled=!0,this.isRedoButtonDisabled=!0;break;case ci.savingFlowSucceeded:case ci.renderingTestRun:this.setDesignerReadOnlyState(!0);break;case ci.runComplete:this.isFlowRunCompleted=!0,this.setDesignerReadOnlyState(!0);break;case ci.savingOrRenderingUndoSnapshot:this.setDesignerReadOnlyState(!0)}this.updatePageTitle(),this.updateActionHeading()}},{key:"showFlowTriggerPrompt",value:function(){return this.getTriggerHint().then(e=>{this.showAlert(B.c.info,e)})}},{key:"saveFlowSucceededState",value:function(e,t){this.$timeout.cancel(this.saveTimeoutPromise),this.actionHeadingStatusText=this.clientResources.Flow.Status.Saved,this.saveTimeoutPromise=this.$timeout(()=>{this.actionHeadingStatusText=""},3e3),this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.fireFlowCreationSucceeded(e.name),this.updateActionHeading(),this.widgetUtilService.widgetCloseOnFlowSaveEnabled()&&this.widgetUtilService.setPostFlowSaveSucceeded(!0),this.setInterfaceState(ci.editingFlow),Object(Ne.d)(e)&&this.handleFlowSuspensionOnSave(e,t)}},{key:"handleFlowSuspensionOnSave",value:function(e,t){if(this.appSettings.featureFlags.enableUpsellingPremiumLicensesExperience&&this.appSettings.featureFlags.enableFlowLicensingChecker&&Object(Ne.r)(e)&&this.telemetry.tagEvent(v.a.SavePremiumFlowClickedByUnlicensedMaker),Object(Ne.v)(e))this.showAlert(B.c.warning,this.clientResources.Flow.Warning.Saved.ViolatesGooglePolicy,Object(Ce.p)(this.clientResources));else if(Object(Ne.m)(e))this.showAlert(B.c.warning,this.clientResources.Flow.Warning.Saved.ViolatesCompanyDlpPolicy,Object(Ce.n)(this.clientResources));else if(Object(Ne.n)(e))if(this.appSettings.featureFlags.enableFlowLicensingChecker){var i=Object(Ce.x)(this.clientResources,this.toggleFlowCheckerPane);this.showAlert(B.c.blocked,"violates billing reasons warning",void 0,i)}else this.surfaceWarningForBillingConsumptionSuspensionReasons(e);else this.showAlert(B.c.warning,t?this.clientResources.Flow.Status.Created.ViolatesPolicy:this.clientResources.Flow.Status.Updated.ViolatesPolicy,Object(Ce.n)(this.clientResources))}},{key:"surfaceWarningForBillingConsumptionSuspensionReasons",value:function(e){Object(Ne.g)(e)||Object(Ne.h)(e)?this.showAlert(B.c.warning,this.clientResources.Flow.Warning.Saved.ViolatesBillingRestrictions,Object(Ce.m)(this.clientResources)):Object(Ne.i)(e)?this.showAlert(B.c.warning,this.clientResources.Flow.Warning.Saved.ViolatesBillingRestrictionsPowerAutomateProcess,Object(Ce.k)(this.clientResources)):Object(Ne.j)(e)&&this.showAlert(B.c.warning,this.clientResources.Flow.Warning.Saved.ViolatesBillingRestrictionsRPAUnattendedLicenses,Object(Ce.l)(this.clientResources))}},{key:"pollForNewRun",value:function(e,t,i,r,n){var o=this.loggingService.profileStart(i?b.a.pollForNewTestRunStart:b.a.pollForNewRunStart);this.showFlowTriggerPrompt().then(()=>this.waitForNewFlowRun(t,r,n,i)).then(e=>(this.spinner.show=!1,this.renderTestRunState(e),this.monitorReadyDeferred.promise.then(()=>this.flowRunService.waitForFlowRunToComplete(this.$scope,e,this.monitorContext,this.flowRunCompleted)))).then(a=>{this.showRunStatus(a),this.loggingService.profileEndWithSuccess(o,i?b.a.pollForNewTestRunEnd:b.a.pollForNewRunEnd,{isNewFlow:e,isTestRun:i,isSimulateTrigger:r,clientTrackingId:n,flowName:null==t?void 0:t.name,flowRunName:null==a?void 0:a.name})}).catch(a=>{this.loggingService.logError("FlowCtrl.pollForNewRun",a),a.code&&y.a(a.code,I.c.operationCanceled)||this.showErrorMessageInAlert(a),this.loggingService.profileEnd(o,i?b.a.pollForNewTestRunEnd:b.a.pollForNewRunEnd,Object(Ce.y)(a),a,{isNewFlow:e,isTestRun:i,isSimulateTrigger:r,clientTrackingId:n,flowName:null==t?void 0:t.name})})}},{key:"isOpenApi",get:function(){return this.currentFlowFromDesigner||(this.currentFlowFromDesigner=this.getFlowFromDesignerSync()),Object(Ee.g)(this.currentFlowFromDesigner)}},{key:"isSolutionFlow",get:function(){var e=!this.isNewFlow&&Object(R.y)(this.flowData),t=!!this.solutionId;return e||t}},{key:"containsEnvironmentVariables",value:function(){return!!this.isSolutionFlow&&(this.currentFlowFromDesigner||(this.currentFlowFromDesigner=this.getFlowFromDesignerSync()),Object(we.d)(this.currentFlowFromDesigner.properties.definition))}},{key:"containsDataverseConnector",value:function(){return this.currentFlowFromDesigner||(this.currentFlowFromDesigner=this.getFlowFromDesignerSync()),Object(Se.e)(this.currentFlowFromDesigner.properties.connectionReferences)}},{key:"containsFlowConnectionReferences",value:function(){return this.currentFlowFromDesigner||(this.currentFlowFromDesigner=this.getFlowFromDesignerSync()),Object(Se.b)(this.currentFlowFromDesigner)}},{key:"isXrmEnvironmentVariablesEnabled",value:function(){return this.isSolutionFlow}},{key:"checkIsXrmConnectionReferenceMode",value:function(e){return Object(Se.g)(e)?(this.loggingService.logInfo("FlowCtrl.checkIsXrmConnectionReferenceMode.Disable","Flow has existing standalone connections."),this.$q.resolve(!1)):Ae.a.currentEnvironment.xrmInstanceApiUrl?this.promiseHelperService.toAngularPromise(this.xrmEntityHttpClient.entityDefinition("connectionreference").then(e=>(this.loggingService.logInfo("FlowCtrl.checkIsXrmConnectionReferenceMode.Enable","Connection reference entity exists and the Flow has no existing standalone connections."),!0)).catch(t=>{if(Object(Se.a)(e))throw this.loggingService.logInfo("FlowCtrl.checkIsXrmConnectionReferenceMode.Error","Flow uses connection references, but the connection reference entity check call failed."),new I.a(I.c.ConnectionReferenceEntityNotFound,this.clientResources.XRMConnectionReference.EntityNotFound,null);return this.loggingService.logInfo("FlowCtrl.checkIsXrmConnectionReferenceMode.Disable","New Flow, but the connection reference entity check failed."),!1})):(this.loggingService.logWarning("FlowCtrl.checkIsXrmConnectionReferenceMode","XRM instance API URL not found",{flowName:this.flowName}),this.$q.resolve(!1))}},{key:"initializeMonitor",value:function(e){var t=e?e.name:this.flowRunName;this.monitorContext={},this.monitorReadyDeferred=this.$q.defer(),this.monitorModel={isFlowCheck:this.isFlowCheckPage,flowRunId:"".concat(this.flowName,"/runs/").concat(t),monitorLoadError:"",isShared:this.isSharedFlow,solutionId:this.solutionId}}},{key:"renderTestRunState",value:function(e){this.initializeMonitor(e),this.showRunStatus(e)}},{key:"shouldDisableTestFlowButton",value:function(){return!this.flowName||this.isSaving()||this.isTesting()||this.scenario===fe.a.editFlowDraft}},{key:"shouldDisableFlowCheckerButton",value:function(){return!this.hasDefinitionLoaded||this.isTesting()||this.isSaving()}},{key:"onOfficePortalSignupClicked",value:function(){r.element(document.querySelector("#officePortalSignup")).submit()}},{key:"officePortalSignupAction",get:function(){return""}},{key:"isApiConnectionTrigger",value:function(e){return e&&e[0]&&e[0].type&&y.a(e[0].type,x.h.apiconnection)}},{key:"isOpenApiConnectionTrigger",value:function(e){return e&&e[0]&&e[0].type&&y.a(e[0].type,x.h.openapiconnection)}},{key:"isPollingTrigger",value:function(e){return this.isApiConnectionTrigger(e)||this.isOpenApiConnectionTrigger(e)}},{key:"forcePollingTrigger",value:function(e,t){if(this.isPollingTrigger(e)){var i={flowName:this.flowName,triggerName:e[0].name};return t?this.flowTriggersClient.runAsTest(i):this.flowTriggersClient.run(i)}return this.$q.resolve()}},{key:"waitForNewFlowRun",value:function(e,t,i,r){var n=this.$q.defer(),o=e&&e.properties&&e.properties.lastModifiedTime?new Date(e.properties.lastModifiedTime).getTime():Date.now();function a(e){return new Date(e.properties.startTime).getTime()>o&&(!t||t&&H()(e,"properties.correlation.clientTrackingId")===i)}var s=this.poll({poll:()=>this.algorithms.asyncRetry(this.appSettings.flowTestingPollRetryCount,this.appSettings.flowTestingPollRetryDelay,()=>this.designerContext.getTriggers().then(e=>{var i=this.isPollingTrigger(e),o=this.$q.defer();t?o.resolve():this.forcePollingTrigger(e,r).then(()=>{o.resolve()}).catch(e=>{o.reject(e)}),o.promise.then(()=>{this.flowDefinitionTriggerName=e[0].name;var o=this.flowTriggerHistoriesClient.query(this.$scope,{flowName:this.flowName,flowTriggerName:this.flowDefinitionTriggerName});o.$refresh().then(()=>{if(this.isTesting()){this.spinner.show=!0;var e=o.filter(e=>Object(De.e)(e)&&a(e));if(e.length>0)this.telemetry.tagEvent(v.a.TestFlowWaitForRun,{status:ge.d.succeeded},{flowName:this.flowName,isApiConnectionTrigger:i,isTestRun:r,isSimulateTrigger:t}),n.resolve(e[0]);else{var s=o.filter(e=>Object(De.m)(e)&&a(e)&&void 0!==e.properties.run);if(s.length>0){var l=s[0].properties.run;this.flowRunName=l.name,this.telemetry.tagEvent(v.a.TestFlowWaitForRun,{status:ge.d.succeeded},{flowName:this.flowName,isApiConnectionTrigger:i,isTestRun:r,isSimulateTrigger:t}),n.resolve(l)}else if(t){var c=o.filter(e=>(Object(De.l)(e)||Object(De.m)(e)&&!1===e.properties.fired)&&a(e));c.length>0&&(this.telemetry.tagEvent(v.a.TestFlowWaitForRun,{status:ge.d.skipped},{flowName:this.flowName,isApiConnectionTrigger:i,isTestRun:r,isSimulateTrigger:t}),n.resolve(c[0]))}}}else this.telemetry.tagEvent(v.a.TestFlowWaitForRun,{status:ge.d.canceled},{flowName:this.flowName,isApiConnectionTrigger:i,isTestRun:r,isSimulateTrigger:t}),n.reject(new I.a(I.c.operationCanceled,"the user exited test mode",null))})})})).catch(e=>{this.telemetry.tagEvent(v.a.TestFlowWaitForRun,{status:ge.d.failed},{flowName:this.flowName,error:e,isTestRun:r}),this.loggingService.logError("FlowCtrl.waitForNewFlowRun",e),n.reject(e)}),interval:this.appSettings.flowTestingPollInterval});return this.waitForRunPromise=this.$interval(()=>{this.telemetry.tagEvent(v.a.TestFlowWaitForRun,{status:ge.d.timedout},{flowName:this.flowName}),n.reject(new Ce.b(I.c.flowDebugViewTimeoutWaitingForRun,this.clientResources.Flow.Error.TimeoutWaitingForRun))},this.appSettings.flowTestingPollTimeout,1),n.promise.finally(()=>{this.$interval.cancel(this.waitForRunPromise),s.destroy()}),s.start(this.$scope),n.promise}},{key:"showRemediationPaneForFailedRun",value:function(){var e,t,i={key:ui.help,text:this.clientResources.FlowRun.Help,onClick:this.toggleRemediationPane,icon:D.a.Help};this.showRemediationPane=!0;var r=null!==(e=null===(t=this.actionHeadingMenu.items)||void 0===t?void 0:t.slice())&&void 0!==e?e:[],n=r.pop();r=(null==n?void 0:n.key)===ui.switchDesigner?[...r,i,n]:[...r,n,i],this.actionHeadingMenu={items:r,clientResources:this.clientResources},this.initRemediationPane=!0}},{key:"hideAndResetRemediationPane",value:function(){this.showRemediationPane=!1,this.initRemediationPane=!1}},{key:"onKeyDown",value:function(e){var t=e.srcElement||e.target,i=new RegExp(t.tagName.toUpperCase());Object(W.a)(e)&&"true"!==t.contentEditable&&i.test("HTML, BODY, DIV")&&e.preventDefault()}},{key:"isCommentingPaneOpen",get:function(){return Re.a.isPaneOpen}},{key:"getLastRun",value:function(){var e,t,i,r=this.loggingService.performanceNow();this.flowRunsClient.refreshQuery({flowName:this.flowName}).then(()=>(e=this.flowRunsClient.query(this.$scope,{flowName:this.flowName})).$promise).then(()=>{var n={flowName:this.flowName,arePreviousRunsAvailable:!Object(p.o)(e)&&e.length>0,isLastRunAvailable:!Object(p.o)(t),runsAPIFetchDuration:this.loggingService.performanceNow()-r};if(e&&e.length>0){var o=e.sort((e,t)=>e.properties.startTime<t.properties.startTime?1:-1);(t=o[0])?(ut.a.setLastRun(t),i=t.properties.trigger.outputsLink.uri,ut.a.setTriggerOutputsURI(i),this.loggingService.logInfo("FlowCtrl.getLastRun.TestExpressionsFeature","Successful call to Runs API: previous runs available, last run available",ri(ri({},n),{lastRunName:t.name,lastRunStatus:t.properties.status,hasTriggerOuputs:!!t.properties.trigger.outputsLink,isLastRunAvailable:!Object(p.o)(t)}))):this.loggingService.logInfo("FlowCtrl.getLastRun.TestExpressionsFeature","Successful call to Runs API: previous runs available, last run NOT available",ri({},n))}else this.loggingService.logInfo("FlowCtrl.getLastRun.TestExpressionsFeature","Successful call to Runs API: previous runs NOT available, last run NOT available",ri({},n))}).catch(e=>{this.loggingService.logError("FlowCtrl.getLastRun.TestExpressionsFeature",e,{flowName:this.flowName})})}},{key:"defaultToSolutionIfEnabled",value:function(){var e,t,i,r;return this.isNewFlow?this.promiseHelperService.toAngularPromise(Object(pt.d)(this.loggingService,null===(e=this.environmentService.getCurrentEnvironment())||void 0===e?void 0:e.hasXrmInstance,this.widgetUtilService,this.sessionService.isConsumerDomain,this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,null!==(t=null===(i=this.sessionService.getUserInfo())||void 0===i?void 0:i.tenantId)&&void 0!==t?t:"",null===(r=this.environmentService.getCurrentEnvironment())||void 0===r?void 0:r.xrmInstanceVersion)).then(e=>{if(this.solutionId||e!==pt.a.ShouldDefault){if(!this.solutionId&&e===pt.a.BlockFlowSave)throw this.showAlert(B.c.error,this.clientResources.DefaultToSolution.FlowSaveBlocked),new I.a(pt.b,this.clientResources.DefaultToSolution.FlowSaveBlocked)}else this.solutionId=Object(Nt.a)(),this.defaultedToSolution=!0}):this.$q.resolve()}}])&&si(t.prototype,i),n&&si(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();di.$inject=[s.a.services.$document,s.a.services.$interval,s.a.services.$q,s.a.services.$routeParams,s.a.services.$scope,s.a.services.$timeout,s.a.services.$window,s.a.services.alertService,s.a.services.algorithms,s.a.services.apisClient,s.a.services.appSettings,s.a.services.clientResources,s.a.services.connectionsClient,s.a.services.dateTime,s.a.services.environment,s.a.services.environmentsClient,s.a.services.flowCheckerService,s.a.services.flowConnectionsClient,s.a.services.flowPermissions,s.a.services.flowRolesClient,s.a.services.flowRun,s.a.services.flowRunsClient,s.a.services.flowsClient,s.a.services.flowTriggerCallbackUrlClient,s.a.services.flowTriggerHistoriesClient,s.a.services.flowTriggersClient,s.a.services.logging,s.a.services.ngReactBridge.ngFlowService,s.a.services.navigation,s.a.services.poll,s.a.services.promiseHelperService,s.a.services.session,s.a.services.storageCacheFactory,s.a.services.telemetry,s.a.services.templatesClient,s.a.services.ngUrl,s.a.services.widgetUtilService,x.m,s.a.services.modernFlowClient,s.a.services.routeCrafter,s.a.services.hostCommunicationService,s.a.services.flow,s.a.services.environmentCapability,s.a.services.widgetUtilService,s.a.services.designerOperations,s.a.services.apiOperation,s.a.services.xrmEntityClient,s.a.services.universalSearchService,s.a.services.triggerService,s.a.services.xrmWorkflowClient,s.a.services.flowDraftClient,s.a.services.assetService,s.a.services.presenceService,s.a.services.presenceStore,s.a.services.flowUndoService,s.a.services.planService,s.a.services.xrmUserService,s.a.services.token,s.a.services.graphService,s.a.services.xrmRecommendation,s.a.services.cdnService,s.a.services.licenseManagement,s.a.services.consentService,s.a.services.doNotShowAgain,s.a.services.trialDialog,s.a.services.aiHostedModelsService,s.a.services.solutionService,s.a.services.flowSupportChecker,s.a.services.neptuneService,s.a.services.teamsDeepLinkService],di.isReloadingFlowAfterFirstSave=!1},33452:function(e,t,i){"use strict";i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a})),i.d(t,"f",(function(){return s}));var r=i(11804);i.d(t,"e",(function(){return r.k}));var n=i(12366);i.d(t,"b",(function(){return n.q})),i.d(t,"d",(function(){return n.B}));i(21949);var o={applicationJson:"application/json"},a={contentType:"Content-Type"},s="4a95641b-e27c-ab69-a7d8-fb936c50e4ec"},33453:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33328),n=i(33327),o=i(12366),a=i(18959),s=i(13144),l=i(33350),c={storageCacheId:"connections",urlPath:o.L,resourceType:o.L,maxPageSize:1e3},u={evictionDelay:3e5};r.a.factory(n.a.services.connectionsClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment,(e,t,i)=>{var r=Object(l.a)(t=>(-1===t.url.indexOf("environment eq")&&(t.url+="&$filter=environment eq '".concat(i.getCurrentEnvironmentName(),"'")),t.url=t.url.replace(/api-version=[^&]*/gi,"api-version=".concat(e.processSimpleResourceProviderApiVersionWithEnvironments)),t)),n={name:"usages",method:"GET",isODataArray:!0,params:{$expand:"Resource"},requestInterceptor:Object(l.a)()},d={name:"getConsentLink",method:"POST",params:{id:"@id"},requestInterceptor:r},p={name:"confirmConsentCode",method:"POST",params:{id:"@id"},requestInterceptor:r};return t({urlBase:Object(s.c)(e).powerAppsRP,urlPath:c.urlPath,resourceType:c.resourceType,apiVersion:e.powerAppsResourceProviderApiVersionWithEnvironments,rest:{query:{responseInterceptor:e=>e.data&&e.data.filter(e=>Object(a.l)(e,o.H)),requestInterceptor:r},get:{params:{id:"@id"},requestInterceptor:r},put:{params:{id:"@id"},requestInterceptor:r},delete:{params:{id:"@id"},requestInterceptor:r}},actions:[d,n,p],options:{evictionDelay:u.evictionDelay}})}])},33454:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33331),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e){return new Promise((t,i)=>{e.then(e=>t(e)).catch(e=>i(e))})}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t}var t,i,r;return t=e,(i=[{key:"toAngularPromise",value:function(e){return this.$q((t,i)=>{e.then(e=>t(e)).catch(e=>i(e))})}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[n.a.services.$q],r.a.service(n.a.services.promiseHelperService,l)},33455:function(e,t,i){"use strict";var r=i(13029);i.d(t,"a",(function(){return r.a}))},33456:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var r=i(33331),n=i(33390),o=i(33327),a=i(33360),s=i(33457),l=i(33458),c=i(33462),u=i(33392),d=i(33394),p=i(33355),h=i(33393),m=i(14900),g=i(14901),f=i(14877),v=i(13143),b=i(13142),y=i(11891),w=i(14835);function S(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function C(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var k=function(){function e(t,i,r,n,o,a,s,l,c,u,d,p,h,m,g,f,v){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$interval=i,this.clientResources=r,this.connectionsClient=n,this.environmentService=o,this.flowRunsClient=a,this.flowTriggerHistoriesClient=s,this.navigation=l,this.runInstanceService=c,this.routeCrafter=u,this.loggingService=d,this.algorithms=p,this.poll=h,this.appSettings=m,this.flowRunsService=g,this.promiseHelperService=f,this.flowRunsTriggerOutputsStore=v,this.timeoutPromise=void 0,this.flowRunCompleted=void 0,this.pollFlowRunStatus=void 0,this.cache=new Map}var t,i,r;return t=e,(i=[{key:"waitForFlowRunToComplete",value:function(e,t,i,r){var n=this.$q.defer(),{flowTestingPollInterval:o,flowTestingPollTimeout:a,flowTestingPollRetryCount:s,flowTestingPollRetryDelay:l}=this.appSettings;this.flowRunCompleted=r;var c=null==t?void 0:t.id;this.cache.has(e)||this.cache.set(e,new Map);var u,d=this.cache.get(e);return d.has(c)?d.get(c):(Object(f.k)(t)?(this.pollFlowRunStatus=this.poll({poll:()=>this.algorithms.asyncRetry(s,l,()=>this.flowRunsClient.get(e,{id:c}).$refresh().then(e=>{var t=e.data;i.refreshRun(),Object(f.k)(t)||(u=t,n.resolve(t))}).catch(e=>{this.loggingService.logError("FlowCtrl.WaitForFlowRunToComplete",e),n.reject(e)})),interval:o}),this.timeoutPromise=this.$interval(()=>{n.reject(new b.a(v.b.flowPollingTimeoutWaitingForRun,this.clientResources.Flow.Error.TimeoutWaitingForRunComplete))},a,1),n.promise.finally(()=>{r&&r(u),this.$interval.cancel(this.timeoutPromise),this.pollFlowRunStatus.destroy(),d.delete(c),0===d.size&&this.cache.delete(e)}),this.pollFlowRunStatus.start(e)):(u=t,r&&r(u),n.resolve(u)),d.set(c,n.promise),n.promise)}},{key:"stopFlowRunPolling",value:function(){this.flowRunCompleted&&this.flowRunCompleted(),this.timeoutPromise&&this.$interval.cancel(this.timeoutPromise),this.pollFlowRunStatus&&this.pollFlowRunStatus.destroy()}},{key:"cancelFlowRun",value:function(e,t,i){return this.flowRunsClient.cancel({flowName:e,flowRunName:t,isMigrationSource:i}).then(e=>this.stopFlowRunPolling())}},{key:"resubmitFlowRun",value:function(e,t,i,r,n){return this.appSettings.featureFlags.enableFlowRunBulkOperations?this.flowTriggerHistoriesClient.resubmit({flowName:t,flowTriggerName:i,flowTriggerHistoryId:r}):this.flowTriggerHistoriesClient.resubmit({flowName:t,flowTriggerName:i,flowTriggerHistoryId:r}).then(r=>this.flowTriggerHistoriesClient.query(e,{flowName:t,flowTriggerName:i})).then(e=>{e.$refresh().then(()=>{var i=e[0].properties.run;this.navigation.navigate(Object(m.n)(this.routeCrafter,{flowName:t,runName:i.name,isLegacyShared:!1,isUIFlow:!1,solutionId:void 0}),n?{backUrl:n}:{})})})}},{key:"getFlowRun",value:function(e,t,i,r){var n=this.flowRunsClient.get(e,{id:Object(s.a)(t,i,this.environmentService,r)});return n.$promise.then(()=>n)}},{key:"getTriggerCheck",value:function(e,t,i,r){var n=this.flowTriggerHistoriesClient.get(e,{id:Object(c.a)(t,i,r,this.environmentService)});return n.$promise.then(()=>n)}},{key:"getRunInstance",value:function(e,t){return this.runInstanceService.createDesignerRunInstanceService(P()).getRunInstance(e,!0,!0===t)}},{key:"getRemediationData",value:function(e,t,i){var r=this.loggingService.profilePageStart(p.a.remediationApiCallStart);return(i?this.flowTriggerHistoriesClient.remediate({flowName:e,flowTriggerName:i,flowTriggerHistoryId:t}):this.flowRunsClient.remediate({flowName:e,flowRunName:t})).then(e=>(this.loggingService.profileEndWithSuccess(r,p.a.remediationApiCallEnd),e)).catch(i=>{if(this.loggingService.profileEnd(r,p.a.remediationApiCallEnd,Object(u.b)(i),i,{flowName:e,flowRunName:t}),Object(h.f)(i)||Object(h.h)(i))return null;throw new d.a(Object(u.d)(i),Object(u.e)(i),i)})}},{key:"getFirstFailedOperationSummary",value:function(e,t,i){var r=t&&t.run&&t.run.properties&&t.run.properties.trigger;if(r&&r.status===n.j.failed)return this.toFlowOperationSummaryPromise(e,r,r.name,!0,t.workflowVersion,i);var o=t.runActions&&t.runActions.find(e=>e.properties&&e.properties.status===n.j.failed&&"ActionFailed"!==e.properties.code);return o?this.toFlowOperationSummaryPromise(e,o.properties,o.name,!1,t.workflowVersion,i):null}},{key:"toFlowOperationSummaryPromise",value:function(e,t,i,r,o,s){return this.runInstanceService.getOperationOutput(s,t).then(e=>e.length>1?e.filter(e=>e.status===n.j.failed):e).then(t=>t.map(t=>{var n=t.outputs||t,c=Object(l.e)(n),u=Object(l.a)(i,o),d="",p="",h=this.connectionsClient.query(e),m={},g=r?this.clientResources.FlowRun.Operation.Type.Trigger:this.clientResources.FlowRun.Operation.Type.Action;return u&&(u.apiDefinition&&(d=u.apiDefinition.properties.displayName),p=u.connectionName),m.title=Object(a.d)(this.clientResources.FlowRun.Operation.Failed.Title,g,i.replace(/_/g," ")),m.fixDescription=Object(l.f)(this.clientResources,c,d),m.errorDetails=Object(l.c)(n),m.errorDescription=Object(l.b)(this.clientResources,c,p,h),m.errorType=c,m.hasFriendlyErrorMessage=Object(l.g)(n),this.loggingService.logInfo("FlowRemediationPaneCtrl.toFlowOperationSummaries","Computed error and fix descriptions for operation",{flowName:s,flowRunName:o&&o.run&&o.run.name,statusCode:n.statusCode,errorType:c,errorDescription:m.errorDescription,fixDescription:m.fixDescription,additionalInfo:Object(l.d)(n)}),m}))}},{key:"getRemediationAndDebugFlowData",value:function(e,t,i,r,n){var o="".concat(t,"/runs/").concat(i),a=this.getRunInstance(o,n),s=this.getRemediationData(t,i,r),l=a.then(i=>this.getFirstFailedOperationSummary(e,i,t));return Promise.all([a,s,l]).then(e=>{var[t,i,r]=e;return{run:t.run,remediationData:i&&i.data,failedOperation:r&&r[0],brokenConnectionsUrl:"".concat(Object(g.d)(this.routeCrafter,{filterBrokenConnections:!0}))}}).catch(e=>{throw new d.a(Object(u.d)(e),Object(u.e)(e),e)})}},{key:"getTriggerOutputs",value:function(e){return this.promiseHelperService.toAngularPromise(this.flowRunsService.getTriggerOutputs({uri:e}))}},{key:"getBatchTriggerOutputs",value:function(e){var t=this.flowRunsTriggerOutputsStore.getOutputUrisForRunsMissingData(e).map(e=>this.getTriggerOutputs(e));return this.promiseHelperService.toAngularPromise(Promise.all(t).then(e=>this.flowRunsTriggerOutputsStore.setRunTriggerOutputsFromBatchResponse(e)))}},{key:"getAndLoadButtonOutputsFriendlyNames",value:function(e,t,i){var r;return e&&(r=Object(w.t)(e,t,i))&&this.flowRunsTriggerOutputsStore.updateButtonInputsFriendlyNameMapping(e.name,r),r}}])&&S(t.prototype,i),r&&S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=e.split("/"),i=t.indexOf("environments");return i>0&&t.length>i+4&&Object(y.a)(t[i+2],"flows")&&Object(y.a)(t[i+4],"checks")}k.$inject=[o.a.services.$q,o.a.services.$interval,o.a.services.clientResources,o.a.services.connectionsClient,o.a.services.environment,o.a.services.flowRunsClient,o.a.services.flowTriggerHistoriesClient,o.a.services.navigation,o.a.services.runInstanceService,o.a.services.routeCrafter,o.a.services.logging,o.a.services.algorithms,o.a.services.poll,o.a.services.appSettings,o.a.services.flowrunsService,o.a.services.promiseHelperService,o.a.services.flowRunsTriggerOutputsStore],r.a.service(o.a.services.flowRun,k)},33457:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33328),n=i(33327),o=i(31433),a=i(13144),s={urlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/flows/:flowName/runs"),resourceType:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/flows/runs")},l={listFlowRuns:6e4,getFlowRuns:45e3,evictionDelay:3e5};function c(e,t,i,r){return"/providers/Microsoft.ProcessSimple/environments/".concat(i.getCurrentEnvironmentName(),"/flows/").concat(e,"/runs/").concat(t).concat(!0===r?"?isMigrationSource=true":"")}r.a.factory(n.a.services.flowRunsClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,n.a.services.environment,(e,t,i)=>{var r=e=>!e&&i.getCurrentEnvironmentName()?"".concat(t.processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/flows/:flowName/runs"):s.urlPath,n=e=>!e&&i.getCurrentEnvironmentName()?t.processSimpleResourceProviderApiVersionWithEnvironments:t.processSimpleResourceProviderApiVersion,o=(e,t)=>e.replace(":flowName",t),c=e=>{var t,i=(t=e.url).substring(t.indexOf("flows/")+"flows/".length,t.indexOf("/runs")),a=o(r(!0),i),s=o(r(!1),i),l=n(!0),c=n(!1);return e.url=e.url.replace(l,c),e.url=e.url.replace(a,s),e},u=r(!0),d={requestInterceptor:c,urlPath:"".concat(u,"/:flowRunName/cancel"),name:"cancel",method:"POST",params:{flowName:"@flowName",flowRunName:"@flowRunName",isMigrationSource:"@isMigrationSource"}},p={requestInterceptor:c,urlPath:"".concat(u,"/:flowRunName/remediation"),name:"remediate",method:"GET",params:{flowName:"@flowName",flowRunName:"@flowRunName"}};return e({apiVersion:n(!1),urlBase:Object(a.c)(t).flowRP,urlPath:u,resourceType:s.resourceType,rest:{get:{requestInterceptor:c,params:{id:"@id"}},query:{requestInterceptor:c,lazyPaging:!0,params:{flowName:"@flowName"}}},actions:[d,p],options:{atomize:!1,evictionDelay:l.evictionDelay}})}])},33458:function(e,t,i){"use strict";i.d(t,"e",(function(){return l})),i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"f",(function(){return d})),i.d(t,"c",(function(){return p})),i.d(t,"d",(function(){return h})),i.d(t,"g",(function(){return m}));var r=i(33360),n=i(33459),o=i(33461),a=(i(33398),i(12327)),s=/connection .* not found/i;function l(e){var t=o.a.Default,i=p(e);switch(e.statusCode){case 400:t=o.a.InvalidInput;break;case 401:t=o.a.NotAuthorized;break;case 404:t=o.a.ObjectNotFound,i&&Object(a.k)(i)&&i.match(s)&&(t=o.a.ConnectionNotFound);break;case 409:t=o.a.Conflict;break;case 500:case 502:case 503:case 504:t=o.a.InternalServerError;break;default:t=o.a.Default}return t}function c(e,t){var i,r=t.properties.definition.triggers[e]||function e(t,i){var r;i&&Object.keys(i).forEach(n=>{r||"runAfter"===n||(n===t?r=i[n]:"object"==typeof i[n]&&(r=e(t,i[n])))});return r}(e,t.properties.definition.actions),o=!Object(n.a)(r)&&r&&r.inputs&&r.inputs.host&&r.inputs.host.api&&r.inputs.host.api.runtimeUrl||null;return o&&Object.keys(t.properties.connectionReferences).length>0?Object.keys(t.properties.connectionReferences).forEach(e=>{var r=t.properties.connectionReferences[e];r&&r.apiDefinition&&r.apiDefinition.properties&&r.apiDefinition.properties.primaryRuntimeUrl&&r.apiDefinition.properties.primaryRuntimeUrl===o&&(i=r)}):i=r,i}function u(e,t,i,n){var a,s=!0;switch(t){case o.a.Conflict:a=e.FlowRun.Operation.ErrorType.Conflict;break;case o.a.ConnectionNotFound:a=e.FlowRun.Operation.ErrorType.ConnectionNotFound;break;case o.a.InvalidInput:a=e.FlowRun.Operation.ErrorType.InputsInvalid;break;case o.a.InternalServerError:a=e.FlowRun.Operation.ErrorType.InternalServerError;break;case o.a.InvalidTemplate:s=!0,a=e.FlowRun.Operation.ErrorType.InvalidTemplate;break;case o.a.NotAuthorized:s=!0,a=e.FlowRun.Operation.ErrorType.NotAuthorized;break;case o.a.ObjectNotFound:a=e.FlowRun.Operation.ErrorType.ObjectNotFound;break;case o.a.RequestEntityTooLarge:a=e.FlowRun.Operation.ErrorType.RequestEntityTooLarge;break;default:a=e.FlowRun.Operation.ErrorType.Default}return s&&n.forEach(e=>{e.name===i&&(a=Object(r.d)(a,e.properties.displayName))}),a}function d(e,t,i){switch(t){case o.a.Conflict:return e.FlowRun.Operation.FixIt.Conflict;case o.a.ConnectionNotFound:return Object(r.d)(e.FlowRun.Operation.FixIt.ConnectionNotFound,i);case o.a.InternalServerError:return e.FlowRun.Operation.FixIt.InternalServerError;case o.a.InvalidInput:return e.FlowRun.Operation.FixIt.InputsInvalid;case o.a.InvalidTemplate:return e.FlowRun.Operation.FixIt.InvalidTemplate;case o.a.NotAuthorized:return Object(r.d)(e.FlowRun.Operation.FixIt.NotAuthorized,i);case o.a.ObjectNotFound:return e.FlowRun.Operation.FixIt.ObjectNotFound;case o.a.RequestEntityTooLarge:return e.FlowRun.Operation.FixIt.RequestEntityTooLarge;default:return e.FlowRun.Operation.FixIt.Default}}function p(e){var t;if(e.body){if(e.body.$content)return"application/octet-stream"===e.body["$content-type"]?atob(e.body.$content):e.body.$content;if(e.body.message)return e.body.message;if(e.body.error&&e.body.error.message)return e.body.error.message}else{var i;if(null!=e&&null!==(t=e.error)&&void 0!==t&&t.additionalInfo)return null===(i=e.error.additionalInfo[0])||void 0===i||null===(i=i.info)||void 0===i?void 0:i.userFriendlyErrorMessage;if(e.error&&e.error.message)return e.error.message}return e.body}function h(e){var t,i,r;if(null!=e&&null!==(t=e.error)&&void 0!==t&&t.additionalInfo){var n=e.error.additionalInfo[0];return{isFriendlyErrorMessageExist:m(e),errorCode:null==e||null===(i=e.error)||void 0===i?void 0:i.code,errorType:"".concat(null==n||null===(r=n.info)||void 0===r?void 0:r.errorType," - ").concat(null==n?void 0:n.type)}}}function m(e){return!!(e&&e.error&&e.error.additionalInfo&&e.error.additionalInfo[0]&&e.error.additionalInfo[0].info&&e.error.additionalInfo[0].info.userFriendlyErrorMessage)}},33459:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(33460);function n(e){switch(e.type){case r.a.Compose:case r.a.DecrementVariable:case r.a.Foreach:case r.a.Function:case r.a.Http:case r.a.HttpWebhook:case r.a.If:case r.a.IncrementVariable:case r.a.InitializeVariable:case r.a.Join:case r.a.Manual:case r.a.ParseJson:case r.a.Query:case r.a.Recurrence:case r.a.Request:case r.a.Response:case r.a.Scope:case r.a.Select:case r.a.SetVariable:case r.a.Switch:case r.a.Table:case r.a.Terminate:case r.a.Until:case r.a.Wait:return!0;case r.a.NotSpecified:default:return!1}}},33460:function(e,t,i){"use strict";var r=i(14837);i.d(t,"a",(function(){return r.a}))},33461:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r={Conflict:"Conflict",ConnectionNotFound:"ConnectionNotFound",Default:"Default",InternalServerError:"InternalServerError",InvalidInput:"InvalidInput",InvalidTemplate:"InvalidTemplate",NoAccess:"NoAccess",NotAuthorized:"NotAuthorized",ObjectNotFound:"ObjectNotFound",RequestEntityTooLarge:"RequestEntityTooLarge"}},33462:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33328),n=i(33327),o=i(33390),a=i(13144),s=e=>"/providers/Microsoft.ProcessSimple/environments/".concat(e.getCurrentEnvironmentName(),"/flows/:flowName/triggers/:flowTriggerName/histories"),l="/providers/Microsoft.ProcessSimple/flows/triggers/histories",c={listFlowTriggerHistories:6e4,getFlowTriggerHistory:45e3,evictionDelay:3e5};function u(e,t,i,r){return"/providers/Microsoft.ProcessSimple/environments/".concat(r.getCurrentEnvironmentName(),"/flows/").concat(e,"/triggers/").concat(t,"/histories/").concat(i)}r.a.factory(n.a.services.flowTriggerHistoriesClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,n.a.services.environment,(e,t,i)=>{var r=s(i),n={urlBase:Object(a.c)(t).flowRP,urlPath:"".concat(s(i),"/:flowTriggerHistoryId/resubmit"),name:"resubmit",method:"POST",params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",flowTriggerHistoryId:"@flowTriggerHistoryId"}},u={urlBase:Object(a.c)(t).flowRP,urlPath:"".concat(s(i),"/:flowTriggerHistoryId/resubmit"),name:"resubmitAsTest",method:"POST",params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",flowTriggerHistoryId:"@flowTriggerHistoryId"},headers:{[o.n.clientKeywords]:o.l.testFlow}},d={requestInterceptor:e=>e,urlPath:"".concat(r,"/:flowTriggerHistoryId/remediation"),name:"remediate",method:"GET",params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",flowTriggerHistoryId:"@flowTriggerHistoryId"}};return e({apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,urlBase:Object(a.c)(t).flowRP,urlPath:r,resourceType:l,rest:{get:{params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",id:"@id",$expand:"properties/run/properties"}},query:{lazyPaging:!0,params:{flowName:"@flowName",flowTriggerName:"@flowTriggerName",id:"@id",$expand:"properties/run/properties",$top:40}}},actions:[n,u,d],options:{atomize:!1,evictionDelay:c.evictionDelay}})}])},33463:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return d}));var r=i(33328),n=i(33327),o=i(33464),a=i(31433),s=i(13144),l={urlPath:"".concat(Object(a.a)().processSimpleResourceProviderPath,"/environments/:environmentName/galleries/:galleryName/templates"),resourceType:"".concat(Object(a.a)().processSimpleResourceProviderPath,"/galleries/templates")};function c(e){return"".concat(Object(a.a)().processSimpleResourceProviderPath,"/galleries/").concat(e,"/templates")}function u(e,t){return"".concat(Object(a.a)().processSimpleResourceProviderPath,"/environments/").concat(t.getCurrentEnvironmentName(),"/galleries/").concat(e,"/templates")}function d(e,t,i){return Object(a.a)().featureFlags.enablePendingTemplatesGallery&&(e=o.b.pending),"".concat(Object(a.a)().processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/galleries/").concat(e,"/templates/").concat(t)}var p=e=>(e.url=e.url.replace("/environments/galleries","/galleries"),e);r.a.factory(n.a.services.templatesClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,(e,t)=>e({resourceType:l.resourceType,urlBase:Object(s.c)(t).flowRP,urlPath:l.urlPath,apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,rest:{delete:{params:{id:"@id"},requestInterceptor:p},get:{params:{id:"@id",$expand:"definition,connectionReferences.api.properties,connectionReferences.api.properties.swagger"},requestInterceptor:p},post:{params:{id:"@id"},requestInterceptor:p},query:{lazyPaging:!0,params:{$expand:"definition,connectionReferences.api.properties"},requestInterceptor:p}},options:{atomize:!1}})])},33464:function(e,t,i){"use strict";var r=i(14825);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b}))},33465:function(e,t,i){"use strict";var r=i(14835);i.d(t,"d",(function(){return r.S})),i.d(t,"a",(function(){return r.C})),i.d(t,"b",(function(){return r.L})),i.d(t,"c",(function(){return r.R}))},33466:function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return o})),i.d(t,"d",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i(33301);function n(e,t){return function(e,t){var i=e.displayName,r=t.displayName;return c(i,r)}(e,t)||s(e,t)||o(e,t)}function o(e,t){return c(l(e),l(t))}function a(e,t){return c(e.definition.triggers,t.definition.triggers)}function s(e,t){return c(e.definition,t.definition)}function l(e){var t=e.connectionReferences;if(t){var i={};return Object.entries(t).map(e=>{var[t,r]=e;i[t]={connectionName:r&&(r.connectionReferenceLogicalName||r.connectionName),id:r&&r.id}}),i}return t}function c(e,t){return Object(r.a)(e,!0)!==Object(r.a)(t,!0)}},33467:function(e,t,i){"use strict";function r(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];r&&r.errorMessages.length>0&&t.push(r)}return t}i.d(t,"a",(function(){return r}))},33468:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s}));var r=i(33328),n=i(33327),o=i(13144),a="CannotListCallbackUrlForUnpublishedSolutionFlow";function s(e,t,i){return"/providers/Microsoft.ProcessSimple/environments/".concat(i.getCurrentEnvironmentName(),"/flows/").concat(e,"/triggers/").concat(t,"/listCallbackUrl")}r.a.factory(n.a.services.flowTriggerCallbackUrlClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,n.a.services.environment,(e,t,i)=>{var r=(e=>({urlPath:"/providers/Microsoft.ProcessSimple/flows/:flowName/triggers/:flowTriggerName/listCallbackUrl",urlPathWithEnvironments:"/providers/Microsoft.ProcessSimple/environments/".concat(e.getCurrentEnvironmentName(),"/flows/:flowName/triggers/:flowTriggerName/listCallbackUrl"),resourceType:"/providers/Microsoft.ProcessSimple/flows/triggers"}))(i),n=r.urlPathWithEnvironments;return e({apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,urlBase:Object(o.c)(t).flowRP,urlPath:n,resourceType:r.resourceType,resourceToParams:e=>{var t={id:e.id,showdeprecatedcallbackurl:!1};return null!=e.showdeprecatedcallbackurl&&(t.showdeprecatedcallbackurl=e.showdeprecatedcallbackurl),t},rest:{post:{params:{id:"@id"}}},options:{atomize:!1}})}])},33469:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(33331),n=i(33394),o=i(33354),a=i(33437),s=i(33327),l=i(33360),c=i(33393),u=i(13083),d=i(12381),p=i(13142),h=i(13144);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=function(e){return e.error="Error",e.warning="Warning",e}({}),v=function(){function e(t,i,r,n,o,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.appSettings=i,this.environmentService=r,this.loggingService=n,this.telemetryService=o,this.promiseHelperService=a,this.sessionService=s,this.$q=l,this.checkFlowErrorsInProgress=!1,this.checkFlowWarningsInProgress=!1}var t,i,r;return t=e,(i=[{key:"findFlowCheckerResult",value:function(e,t,i,r){var s;if(r){if(e===f.error?this.checkFlowErrorsInProgress:this.checkFlowWarningsInProgress)return this.telemetryService.tagEvent(a.a.FlowCheckerOnDesignerChangeSkipped,{flow:i,checkType:e,isOnDesignerFlowChanged:r}),this.$q.resolve([]);this.telemetryService.tagEvent(a.a.FlowCheckerOnDesignerChangeProceed,{flow:i,checkType:e,isOnDesignerFlowChanged:r}),this.setFlowCheckInProgress(e,!0),s=setTimeout(()=>{this.setFlowCheckInProgress(e,!1),this.telemetryService.tagEvent(a.a.FlowCheckerOnDesignerChangeReset,{flow:i,checkType:e,isOnDesignerFlowChanged:r})},3e4)}var m=Object(u.a)(i)?"new":i,g=Object(l.d)(Object(d.a)("{0}/environments/{1}/flows/{2}/",e===f.error?"checkFlowErrors":"checkFlowWarnings"),Object(d.a)(Object(h.c)(this.appSettings).flowRP,this.appSettings.processSimpleResourceProviderPath),this.environmentService.getCurrentEnvironmentName(),m),v=this.loggingService.profileStart(e===f.error?o.a.flowCheckerGetErrorsStart:o.a.flowCheckerGetWarningsStart),b=e===f.error?o.a.flowCheckerGetErrorsEnd:o.a.flowCheckerGetWarningsEnd;return this.promiseHelperService.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource)).then(e=>this.$http({method:"POST",url:g,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},data:t,params:{"api-version":this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments}})).then(t=>(r&&(this.setFlowCheckInProgress(e,!1),clearTimeout(s)),200===t.status?(this.loggingService.profileEndWithSuccess(v,b),t.data):(this.loggingService.profileEnd(v,b,c.a.Failure,{name:e===f.error?n.c.findFlowCheckerErrorsErrorResponse:n.c.findFlowCheckerWarningsErrorResponse,message:Object(l.d)("Request to get flow checker errors failed with status code {0}",t.status)},{flow:i}),[]))).catch(t=>{var o;r&&(this.setFlowCheckInProgress(e,!1),clearTimeout(s));var a=null==t||null===(o=t.data)||void 0===o||null===(o=o.error)||void 0===o||null===(o=o.message)||void 0===o?void 0:o.includes("Required property 'case' expects a value but got null.");return this.loggingService.profileEnd(v,b,a?c.a.Warning:c.a.Failure,a?new p.a(e===f.error?n.c.findFlowCheckerErrorsErrorResponse:n.c.findFlowCheckerWarningsErrorResponse,Object(l.d)("Request to get flow checker errors failed with status code {0}",t.status),Object(c.l)(t)):new n.a(e===f.error?n.c.findFlowCheckerErrorsErrorResponse:n.c.findFlowCheckerWarningsErrorResponse,Object(l.d)("Request to get flow checker errors failed with status code {0}",t.status),Object(c.l)(t)),{flow:i}),[]})}},{key:"setFlowCheckInProgress",value:function(e,t){e===f.error?this.checkFlowErrorsInProgress=t:this.checkFlowWarningsInProgress=t}}])&&m(t.prototype,i),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[s.a.services.$http,s.a.services.appSettings,s.a.services.environment,s.a.services.logging,s.a.services.telemetry,s.a.services.promiseHelperService,s.a.services.session,s.a.services.$q],r.a.service(s.a.services.flowCheckerService,v)},33470:function(e,t,i){"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",(function(){return o}));var o=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({flow_run_success_message:"flow_run_success_message",flow_run_fail_message:"flow_run_fail_message",flow_checker_panel:"flow_checker_panel",action_completed:"action_completed",flow_presence_container:"flow_presence_container",save_flow_option_discard:"save_flow_option_discard",save_flow_option_save_as:"save_flow_option_save_as",save_flow_option_override:"save_flow_option_override",easy_automation_panel:"easy_automation_panel",rpa_createModal_launch:"rpa_createModal_launch",onboarding_wizard_next_button:"onboarding_wizard_next_button",onboarding_wizard_v1:"onboarding_wizard_v1",message_bar_message_generic:"message_bar_message_generic"},i(21035).a)},33471:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return l}));var r=i(33360),n=i(33390),o=i(14900),a=i(13015);function s(e,t){null==t||t.forEach(t=>{if(function(e){if(e&&e.fixInstructions&&e.fixInstructions.messageId){var t=e.fixInstructions.messageId;return t===a.b.BlockedConnector||t===a.b.BusinessAndNonBusinessConnector||t===a.b.BlockedAction||t===a.b.BlockedEndpoint}return!1}(t)&&t.extendedData&&t.fixInstructions){var i,n,o=null===(i=t.extendedData.additionalInfo)||void 0===i?void 0:i.policyWikiUrl,s=null===(n=t.extendedData.additionalInfo)||void 0===n?void 0:n.adminContactEmailAddress,l=null,c=null,u=null;if(o&&(c=function(e,t){var i=e.Flow.Error.Click.PlaceHolder,r=e.Flow.Error.HereLinkText,n=e.Flow.Checker.DLP.Violation.PolicyWikiUrlFixInstruction;return"".concat(i," <a href=").concat(t,">").concat(r,"</a> ").concat(n)}(e,o)),s&&(u=Object(r.d)(e.Flow.Error.DLPViolation.PolicyAdminContactFixInstruction,s)),c&&u){var d=e.Flow.Error.Or.PlaceHolder;l="<p>".concat(c," ").concat(d," ").concat(u,"</p>")}else c?l="<p>".concat(c,"<p>"):u&&(l="<p>".concat(u,"</p>"));l&&(t.fixInstructions.htmlText=t.fixInstructions.htmlText.concat(l))}})}function l(e,t,i,r,s){null==t||t.forEach(t=>{(function(e){if(e&&e.fixInstructions&&e.fixInstructions.messageId)return e.fixInstructions.messageId===a.a.ConnectionToConnectionReference;return!1})(t)&&(t.fixInstructions.htmlText=function(e,t,i,r){var a=e.Diagnostic.PaneFixHeader,s=e.Diagnostic.ConnectionMode.SwitchMode,l=e.Diagnostic.ConnectionMode.InConnectionMode.Title,c=e.Diagnostic.ConnectionMode.InConnectionMode.Detail,u={};u[n.a.connectionMode]=n.a.connectionMode;var d=Object(o.g)(r,{solutionId:t,flowName:i,queryParams:u});return"<b>".concat(l,"</b> <p>").concat(c,"</p> <b>").concat(a,"</b> <p><a href=").concat(d,' target="').concat("_self",'">').concat(s,"</a</p>")}(e,i,r,s))})}},33472:function(e,t,i){"use strict";function r(e){return window.Promise?new Promise((t,i)=>{e.then(e=>t(e)).catch(e=>i(e))}):e}i.d(t,"a",(function(){return r}))},33473:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var r,n,o,a=i(11766),s=i(18792),l=i(15552),c=i(14965),u=i(13275),d=i(11773),p=i(14337),h=i(33474),m=i(21035),g=i(22146);function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=C(e);if(t){var n=C(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return w(this,i)}}function w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t,i,r,n){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var P=Object(p.c)((n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(d,e);var t,i,r,n=y(d);function d(e){var t,i,r,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),t=n.call(this,e),i=t,r="isLoading",a=o,s=S(t),a&&Object.defineProperty(i,r,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(s):void 0}),t.setIsLoading(!0),t}return t=d,(i=[{key:"setIsLoading",value:function(e){this.isLoading=e}},{key:"componentDidMount",value:function(){this.props.presenceService.becomePresent(this.props.flowName).then(()=>{this.setIsLoading(!1)})}},{key:"componentWillUnmount",value:function(){this.props.presenceService.becomeAbsent(this.props.flowName)}},{key:"render",value:function(){return this.isLoading||0===this.props.presenceStore.personas.length?null:a.createElement(u.a,{horizontal:!0,verticalFill:!0,verticalAlign:"center",tokens:{childrenGap:8},"data-automation-id":m.a.flow_presence_container},a.createElement(g.a,{personas:this.props.presenceStore.personas,personaSize:l.c.size24,maxDisplayablePersonas:5,hideSingleUserName:!0,overflowButtonType:s.a.descriptive,overflowButtonProps:{ariaLabel:this.props.clientResources.FlowProperties.SharedCard.OverflowButtonAriaLabel,styles:h.a}}),a.createElement(c.a,{vertical:!0,styles:h.b}))}}])&&f(t.prototype,i),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(a.Component),o=k(n.prototype,"isLoading",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k(n.prototype,"setIsLoading",[d.action],Object.getOwnPropertyDescriptor(n.prototype,"setIsLoading"),n.prototype),r=n))||r,x=(e,t,i,r)=>a.createElement(P,{flowName:e,clientResources:t,presenceService:i,presenceStore:r})},33474:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return a}));var r=i(12754),n=Object(r.Y)().palette,o={root:{backgroundColor:n.neutralTertiaryAlt}},a={root:{"&::after":{backgroundColor:n.neutralTertiaryAlt,margin:"8px 0"}},content:{}}},33475:function(e,t,i){"use strict";i.d(t,"a",(function(){return v})),i.d(t,"b",(function(){return b})),i.d(t,"e",(function(){return y})),i.d(t,"d",(function(){return w})),i.d(t,"h",(function(){return S})),i.d(t,"g",(function(){return C})),i.d(t,"i",(function(){return k})),i.d(t,"c",(function(){return P})),i.d(t,"f",(function(){return x}));var r=i(14835),n=i(14751),o=i.n(n),a=i(33441),s=i(33445),l=i(33439),c=i(17208),u=i(11955),d=i.n(u),p=i(11891),h=i(13154);i(33460),i(33476),i(33477);function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function g(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){f(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e){var t,i,r;return{id:e.name,listIdentifier:{site:null==e||null===(t=e.properties)||void 0===t||null===(t=t.authorizationDelegate)||void 0===t||null===(t=t.delegatedAuthResource)||void 0===t||null===(t=t.resourceCollection)||void 0===t?void 0:t.toLowerCase(),list:null==e||null===(i=e.properties)||void 0===i||null===(i=i.authorizationDelegate)||void 0===i||null===(i=i.delegatedAuthResource)||void 0===i||null===(i=i.resourceId)||void 0===i?void 0:i.toLowerCase()},accessDefinition:null==e||null===(r=e.properties)||void 0===r||null===(r=r.authorizationDelegate)||void 0===r?void 0:r.accessDefinition}}function b(e){var t,i;return{id:e.id,listIdentifier:{site:null===(t=e.listIdentifier)||void 0===t||null===(t=t.site)||void 0===t?void 0:t.toLowerCase(),list:null===(i=e.listIdentifier)||void 0===i||null===(i=i.list)||void 0===i?void 0:i.toLowerCase()},accessDefinition:void 0}}function y(e){var t=o()(e);return Object.entries(t.connectionReferences||{}).map(e=>{var t,i,r;null===(t=e[1])||void 0===t||!t.connectionReferenceLogicalName||null!==(i=e[1])&&void 0!==i&&null!==(i=i.connection)&&void 0!==i&&i.connectionReferenceLogicalName||(e[1].connection=g(g({},(null===(r=e[1])||void 0===r?void 0:r.connection)||{}),{},{connectionReferenceLogicalName:e[1].connectionReferenceLogicalName}))}),t}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{category:s.a.Modern,type:1,primaryentity:"none"},{category:i,type:n,primaryentity:o}=t,a=y(e.properties);return{category:i,clientdata:JSON.stringify({properties:a,schemaVersion:"1.0.0.0"}),name:(null==a?void 0:a.displayName)||Object(r.p)(null==a?void 0:a.definition),primaryentity:o,type:n}}function S(e,t,i){var r=function(e,t){var i=JSON.parse(e.clientdata);return{name:e.workflowidunique,id:"/providers/Microsoft.ProcessSimple/environments/".concat(t,"/flows/").concat(e.workflowid),properties:g(g({},i.properties),{},{displayName:e.name,workflowEntityId:e.workflowid}),type:"Microsoft.ProcessSimple/environments/flows"}}(e,t),n=new c.a(r);return i.flows.addEntity(n,(e,t)=>!0),i.flows.entities.setEntitySuccess(n.name),i.setFlowMetadata(n.name,{propertiesPageCount:0,savedRecently:!0,isNewFlow:!1}),r}function C(e){return d()(e)&&e.hasOwnProperty("type")&&(Object(p.a)(e.type,"Microsoft.ProcessSimple/flows/runs")||Object(p.a)(e.type,"Microsoft.ProcessSimple/environments/flows/runs"))}function k(e,t,i,r,n,o){return e.featureFlags.enableConnectionModeDiagnostic&&!!r[h.c.connectionMode]&&!!o&&!!o.properties&&i&&!t&&n}function P(e){return{name:e.id,properties:{permissionType:l.c.AuthorizationDelegate,authorizationDelegate:{delegationSource:{delegationService:a.a.sharepoint},delegatedAuthResource:{resourceCollection:e.listIdentifier.site,resourceId:e.listIdentifier.list},accessDefinition:e.accessDefinition}}}}function x(e,t,i,r){var n,o,a,s;if(e)return!0;r?o=null==i||null===(a=i.properties)||void 0===a||null===(a=a.owner)||void 0===a?void 0:a.objectId:o=null==i||null===(s=i.properties)||void 0===s||null===(s=s.creator)||void 0===s?void 0:s.objectId;return!(null===(n=t.user)||void 0===n||!n.uniqueId)&&o===t.user.uniqueId}},33476:function(e,t,i){"use strict";var r=i(14924);i.d(t,"a",(function(){return r.a}))},33477:function(e,t,i){"use strict";var r=i(14868);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b})),i.d(t,"c",(function(){return r.d}))},33478:function(e,t,i){"use strict";i.d(t,"a",(function(){return N}));var r,n,o=i(11766),a=i(14337),s=i(11773),l=i(12706),c=i(12728),u=i(33479),d=i(33480),p=i(15907),h=i(15995),m=i(21035),g=i(13240),f=i(17226),v=i(13016),b=i(12366),y=i(19862),w=i(12719),S=i(12850),C=i(12960),k=i(12961);function P(){return(P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function x(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function A(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){x(o,r,n,a,s,"next",e)}function s(e){x(o,r,n,a,s,"throw",e)}a(void 0)}))}}function T(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R(r.key),r)}}function R(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=F(e);if(t){var n=F(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return E(this,i)}}function E(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t,i,r,n){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var j=Object(a.c)((I((n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(a,e);var t,i,r,n=D(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.call(this,e)).onSaveFlowChangeDetectionSurfaceStore=void 0,t.getClassNames=Object(l.a)(),t.classNames=t.getClassNames(u.a),t.onChoiceChange=(e,i)=>{switch(i.key){case d.a.SAVE_AS_COPY:case d.a.OVERWRITE:case d.a.DISCARD:t.onSaveFlowChangeDetectionSurfaceStore.setSelectedToggleOption(i.key);break;default:t.onSaveFlowChangeDetectionSurfaceStore.setSelectedToggleOption(d.a.DISCARD)}},t.dismiss=()=>{var{flowName:e,dismiss:i,loggingService:r,eventCorrelationId:n}=t.props;r.logInfo("OnSaveFlowChangeDetection.Dismissed.OnBehalfOfUser","The dialog has been dismissed on behalf of the user.",{flowName:e,flowData:t.loggableFlowData},n),t.setState({isReloading:!1}),i()},t.onDismiss=()=>{var{flowName:e,dismiss:i,clientResources:r,telemetryService:n,eventCorrelationId:o}=t.props;n.tagEvent(g.c.FlowOnSaveConflictsDetectionDialogCloseButtonClicked,null,{flowName:e,flowData:t.loggableFlowData,eventCorrelationId:o}),i(),t.showInfoMessage(r.Dialogs.FlowSaveConflicts.Messages.Dismiss)},t.onConfirm=()=>{if(!t.state.isReloading)switch(t.onSaveFlowChangeDetectionSurfaceStore.selectedToggleOption){case d.a.SAVE_AS_COPY:t.onSaveCopy();break;case d.a.OVERWRITE:t.onOverrideSave();break;case d.a.DISCARD:default:t.onDiscard()}},t.onDiscard=()=>{var{flowName:e,reload:i,clientResources:r,telemetryService:n,eventCorrelationId:o}=t.props;return n.tagEvent(g.c.FlowOnSaveConflictsDetectionDialogDiscardButtonClicked,null,{flowName:e,flowData:t.loggableFlowData,eventCorrelationId:o}),t.setState({isReloading:!0}),i().then(()=>t.showInfoMessage(r.Dialogs.FlowSaveConflicts.Messages.Discard)).finally(()=>t.dismiss())},t.onSaveCopy=A((function*(){var{navigateToFlow:e,flowName:i,updatedFlow:r,clientResources:n,telemetryService:o,loggingService:a,eventCorrelationId:s}=t.props;o.tagEvent(g.c.FlowOnSaveConflictsDetectionDialogSaveAsCopyButtonClicked,null,{flowName:i,flowData:t.loggableFlowData,eventCorrelationId:s}),t.onSaveFlowChangeDetectionSurfaceStore.setHidden(!0);var l=i;yield new Promise((e,t)=>y.a.invokeAngularCommand({id:"showSaveAsDialog",options:{show:!0,flowName:i,flowData:r,resolve:e,reject:t}})).then(i=>{var r=i.cancelledByUser,o=i.flowName;r?(t.onSaveFlowChangeDetectionSurfaceStore.setHidden(!1),a.logInfo("OnSaveFlowChangeDetection.OnSaveCopy.CancelledByUser","Flow copy cancelled.",{newFlowName:o,oldFlowName:l,flowData:t.loggableFlowData},s)):o?(t.dismiss(),e(o),t.showSuccessMessage(n.Dialogs.FlowSaveConflicts.Messages.SaveCopy.Success),a.logInfo("OnSaveFlowChangeDetection.OnSaveCopy.Success","Copy created correctly.",{newFlowName:o,oldFlowName:l,flowData:t.loggableFlowData},s)):(t.dismiss(),t.showInfoMessage(n.Dialogs.FlowSaveConflicts.Messages.SaveCopy.NoFlowName),a.logWarning("OnSaveFlowChangeDetection.OnSaveCopy.EmptyFlowName","Copy created but flowName is empty",{newFlowName:o,oldFlowName:l,flowData:t.loggableFlowData},s))}).catch(e=>{t.showErrorMessage(n.Dialogs.FlowSaveConflicts.Messages.SaveCopy.NotCopied),t.onSaveFlowChangeDetectionSurfaceStore.setHidden(!1),a.logWarning("OnSaveFlowChangeDetection.OnSaveCopy.FailedToSaveCopy","Unable to save as copy.",{flowName:i,error:e,flowData:t.loggableFlowData},s)})})),t.onOverrideSave=()=>{var{flowName:e,overrideSave:i,telemetryService:r,eventCorrelationId:n}=t.props;r.tagEvent(g.c.FlowOnSaveConflictsDetectionDialogOverrideSaveButtonClicked,null,{flowName:e,flowData:t.loggableFlowData,eventCorrelationId:n}),t.dismiss(),i()},t.onSaveFlowChangeDetectionSurfaceStore=new d.b,t.state={isReloading:!1},t}return t=a,(i=[{key:"render",value:function(){var{clientResources:e}=this.props;return o.createElement(w.a,{hidden:this.onSaveFlowChangeDetectionSurfaceStore.hidden,maxWidth:b.G,title:e.Dialogs.FlowSaveConflicts.Header,onDismiss:this.onDismiss,containerClassName:"onSaveFlowChangeDetectionDialog"},o.createElement("p",{className:this.classNames.mainDescription},e.Dialogs.FlowSaveConflicts.Details.Main),o.createElement(p.a,{className:this.classNames.optionListDescription,selectedKey:this.onSaveFlowChangeDetectionSurfaceStore.selectedToggleOption,onChange:this.onChoiceChange,options:this.options,required:!1}),o.createElement(S.a,null,o.createElement(C.a,P({},this.okButtonProps,{disabled:this.state.isReloading})),o.createElement(k.a,P({},this.cancelButtonProps,{disabled:this.state.isReloading}))))}},{key:"okButtonProps",get:function(){return{text:this.props.clientResources.Common.Apply,onClick:this.onConfirm}}},{key:"cancelButtonProps",get:function(){return{text:this.props.clientResources.Common.Cancel,onClick:this.onDismiss}}},{key:"options",get:function(){var{clientResources:e}=this.props;return[{key:d.a.DISCARD,text:e.Dialogs.FlowSaveConflicts.Details.Discard,onRenderLabel:()=>o.createElement(h.a,{formatText:e.Dialogs.FlowSaveConflicts.Details.Discard}),onRenderField:(e,t)=>o.createElement(p.b,{props:e,onRenderOption:t,dataAutomationId:m.a.save_flow_option_discard})},{key:d.a.SAVE_AS_COPY,text:e.Dialogs.FlowSaveConflicts.Details.SaveCopy,onRenderLabel:()=>o.createElement(h.a,{formatText:e.Dialogs.FlowSaveConflicts.Details.SaveCopy}),onRenderField:(e,t)=>o.createElement(p.b,{props:e,onRenderOption:t,dataAutomationId:m.a.save_flow_option_save_as})},{key:d.a.OVERWRITE,text:e.Dialogs.FlowSaveConflicts.Details.OverrideSave,onRenderLabel:()=>o.createElement(h.a,{formatText:e.Dialogs.FlowSaveConflicts.Details.OverrideSave}),onRenderField:(e,t)=>o.createElement(p.b,{props:e,onRenderOption:t,dataAutomationId:m.a.save_flow_option_override})}]}},{key:"loggableFlowData",get:function(){var e,t,{updatedFlow:i}=this.props;return{workflowId:null==i||null===(e=i.properties)||void 0===e?void 0:e.workflowEntityId,connections:Object(f.b)(null==i||null===(t=i.properties)||void 0===t?void 0:t.connectionReferences)}}},{key:"showErrorMessage",value:function(e){var t;null===(t=this.props)||void 0===t||t.setMessageBarProps({type:v.c.error,message:e})}},{key:"showInfoMessage",value:function(e){var t;null===(t=this.props)||void 0===t||t.setMessageBarProps({type:v.c.info,message:e})}},{key:"showSuccessMessage",value:function(e){var t;null===(t=this.props)||void 0===t||t.setMessageBarProps({type:v.c.success,message:e})}}])&&T(t.prototype,i),r&&T(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.Component)).prototype,"okButtonProps",[s.computed],Object.getOwnPropertyDescriptor(n.prototype,"okButtonProps"),n.prototype),I(n.prototype,"cancelButtonProps",[s.computed],Object.getOwnPropertyDescriptor(n.prototype,"cancelButtonProps"),n.prototype),I(n.prototype,"options",[s.computed],Object.getOwnPropertyDescriptor(n.prototype,"options"),n.prototype),I(n.prototype,"loggableFlowData",[s.computed],Object.getOwnPropertyDescriptor(n.prototype,"loggableFlowData"),n.prototype),r=n))||r;function N(e,t){e.spawn({key:Object(c.a)("on-save-flow-change-detection-surface"),render:e=>o.createElement(j,P({},t,e,{dismiss:e.dismiss}))})}},33479:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(12754),n=e=>({optionListDescription:["fl-onsave-flow-conflict-options-description",{padding:0,paddingBottom:"9px",fontSize:r.k.medium,listStyle:"disc",paddingInlineStart:"revert",selectors:{".ms-ChoiceField-field":{paddingLeft:"28px",selectors:{b:{fontWeight:r.l.semibold}}}}}],mainDescription:["fl-onsave-flow-conflict-main-description",{padding:0,paddingBottom:"16px",fontSize:r.k.medium}]})},33480:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return p}));var r,n,o,a=i(11773);function s(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t,i,r,n){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var d=function(e){return e.DISCARD="DISCARD",e.OVERWRITE="OVERWRITE",e.SAVE_AS_COPY="SAVE_AS_COPY",e}({}),p=(n=u((r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"hidden",n,this),s(this,"selectedToggleOption",o,this),this.setHidden(!1),this.setSelectedToggleOption(d.DISCARD)}var t,i,r;return t=e,(i=[{key:"setHidden",value:function(e){this.hidden=e}},{key:"setSelectedToggleOption",value:function(e){this.selectedToggleOption=e}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"hidden",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(r.prototype,"selectedToggleOption",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(r.prototype,"setHidden",[a.action],Object.getOwnPropertyDescriptor(r.prototype,"setHidden"),r.prototype),u(r.prototype,"setSelectedToggleOption",[a.action],Object.getOwnPropertyDescriptor(r.prototype,"setSelectedToggleOption"),r.prototype),r)},33481:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(13022),n=i(11766),o=i.n(n);function a(e,t){return o.a.createElement(r.a,{onClick:t},e)}},33482:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(11766),n=i.n(r);function o(e,t){return n.a.createElement("span",null,n.a.createElement("b",null,e)," ",t)}},33483:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.PowerAutomateClientTeam,owners:["bjustice"],description:"Enables passing in last modified time on patch",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1535675",createdOn:"01/08/2024",fallback:{passChangeDetectionThroughHeader:!1}}),{getFeatureValue:a}=Object(n.b)(o,"passChangeDetectionThroughHeader")},33484:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(33390);function n(e){if(e.config&&e.config.headers&&e.config.headers[r.n.autoClaim]){var t=e.config.headers[r.n.autoClaim];return"string"==typeof t?"true"===t.toLowerCase():!!t}return!1}},33485:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.PowerAutomateClientTeam,owners:["pdaniels"],description:"Enables output parameter description feature for Skills Response operation",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1280493",createdOn:"06/26/2024",fallback:{outputParameterDescriptionsEnabledInSkillsActions:!1}}),{getFeatureValue:a}=Object(n.b)(o,"outputParameterDescriptionsEnabledInSkillsActions")},33486:function(e,t,i){"use strict";i.d(t,"a",(function(){return A})),i.d(t,"b",(function(){return T}));var r=i(12327),n=i(12324),o=/(Failed to find environment variables with schema name\(s\) ')[^']*('\. Create environment variables with those names or use different environment variables\.)/gi,a=/(Failed to find connection references with logical name\(s\) ')[^']*('\. Create connection references with those names or use different connection references\.)/gi,s=/(Table ')[^']*(' cannot be found)/gi,l="--scrubPII--",c=/("emailMessage\/Subject":\s*")[^"]*(")/g,u=/("emailMessage\/Body":\s*")[^"]*(")/g,d=/("emailMessage\/Sensitivity":\s*")[^"]*(")/g,p=/("body":\s*")[^"]*(")/g,h=/(The inputs of workflow run action ')[^']*(')/gi,m=/(The inputs of template action ')[^']*(' at)/gi,g=/(cannot reference action ')[^']*('. Action ')[^']*(' must either)/gi,f=/(updating the value of variable ')[^']*(')/gi,v=/(The variable ')[^']*(' must be initialized before it can be used inside action ')[^']*(')/gi,b=/(The input parameter\(s\) of operation ')[^']*(' contains invalid expression\(s\)\. Fix invalid expression\(s\) for the input parameter\(s\) of operation ')[^']*('\.)/gi,y=/(The input parameter\(s\) of action ')[^']*(' contain an invalid reference to ')[^']*('\. Correct to include a valid reference to ')[^']*(' for the input parameter\(s\) of action ')[^']*('\.)/gi,w=/(The provided workflow run action name ')[^']*(' has)/gi,S=/(Invalid parameter for ')[^']*('\. Error: ')[^']*(')/gi,C=/(The template validation failed: ')[^']*(' referenced by 'inputs' in action ')[^']*(' are not defined in the template\.)/gi,k=/(The variable action ')[^']*(' of type 'InitializeVariable' cannot be nested in an action of type ')[^']*(')/gi,P=/(This operation violates admin data policy ')[^']*(', which restricts the use of connector)/gi,x=["Should at least contain one trigger and one action","Request failed with status code 400","Request failed with status code 403","Request failed with status code 404","Definition contains invalid parameters.","powerAutomateClientRequestAborted","Some of the connections are not authorized yet.","https://make.powerapps.com/aibuilder/build","https://aka.ms/powerAutomateClientRequestAborted","Flow has changed after the last retrieval.","https://learn.microsoft.com/power-automate/desktop-flows/desktop-flow-connections#limitations","The 'type' property of template trigger 'manual' at line","a maximum of '600' flows allowed per user. You could delete flows that you are not using, or create more flows in a solution.","UserFlowLimitReached"],A=e=>{var t=E(Object(n.cloneDeep)(e));if(!t||!Object(r.h)(t,{error:Object(r.j)(r.k,r.m)}))return e;var i=t.error;return function(e){Object(r.j)(r.k,r.m)(e.error)&&Object(r.j)(r.k,r.m)(e.error.data)&&Object(r.j)(r.k,r.m)(e.error.data.error)&&Object(r.k)(e.error.data.error.message)&&(e.error.data.error.message=D(o,e.error.data.error.message),Object(r.j)(r.k,r.m)(e.error.data.error.extendedData)&&Object(r.k)(e.error.data.error.extendedData.message)&&(e.error.data.error.extendedData.message=D(o,e.error.data.error.extendedData.message)))}(i),function(e){Object(r.j)(r.k,r.m)(e.error)&&Object(r.j)(r.k,r.m)(e.error.data)&&Object(r.j)(r.k,r.m)(e.error.data.error)&&Object(r.k)(e.error.data.error.message)&&(e.error.data.error.message=D(a,e.error.data.error.message),Object(r.j)(r.k,r.m)(e.error.data.error.extendedData)&&Object(r.k)(e.error.data.error.extendedData.message)&&(e.error.data.error.extendedData.message=D(a,e.error.data.error.extendedData.message)))}(i),function(e){if(Object(r.k)(e.message)&&e.message.match(s)){e.message=D(s,e.message);var t=e.message;if(Object(r.k)(t)){var i=t.split("["),n=i[1].split("]")[1];t=i[0]+'[\\"'.concat(l,'\\"]')+n}e.message=t}Object(r.j)(r.k,r.m)(e.error)&&Object(r.j)(r.k,r.m)(e.error.innerException)&&Object(r.k)(e.error.innerException.code)&&"UnrecognizedExpression"===e.error.innerException.code&&Object(r.k)(e.error.message)&&(e.error.message=e.error.message.replace(c,"$1".concat(l,"$2")),Object(r.k)(e.error.message)&&(e.error.message=e.error.message.replace(u,"$1".concat(l,"$2"))),Object(r.k)(e.error.message)&&(e.error.message=e.error.message.replace(d,"$1".concat(l,"$2"))),Object(r.k)(e.error.message)&&(e.error.message=e.error.message.replace(p,"$1".concat(l,"$2"))),Object(r.k)(e.error.innerException.message)&&(e.error.innerException.message=e.error.message));Object(r.k)(e.message)&&(e.message=O(e.message))}(i),function(e){Object(r.j)(r.k,r.m)(e.error)&&Object(r.k)(e.error.code)&&"xrmInstanceApiUrlMissing"===e.error.code&&Object(r.k)(e.error.message)&&"xrm instance API not defined"===e.error.message&&Object(r.j)(r.k,r.m)(e.error.data)&&Object(r.j)(r.k,r.m)(e.error.data.environmentEntity)&&Object(r.j)(r.k,r.m)(e.error.data.environmentEntity.properties)&&(Object(r.k)(e.error.data.environmentEntity.properties.displayName)&&(e.error.data.environmentEntity.properties.displayName=l),Object(r.k)(e.error.data.environmentEntity.properties.description)&&(e.error.data.environmentEntity.properties.description=l),Object(r.j)(r.k,r.m)(e.error.data.environmentEntity.properties.createdBy)&&Object(r.k)(e.error.data.environmentEntity.properties.createdBy.displayName)&&(e.error.data.environmentEntity.properties.createdBy.displayName=l))}(i),function(e){if(Object(r.j)(r.k,r.m)(e.error)&&Object(r.k)(e.error.code)&&e.error.code.includes("DynamicParameterNotFound")&&Object(r.j)(r.k,r.m)(e.error.data)&&Object(r.k)(e.error.data.alias)){var t=e.error.data.alias;e.error.data.alias=l,Object(r.k)(e.message)&&e.message.match(t)&&(e.message=e.message.replace(t,l))}}(i),R(i),F(i)};var T=(e,t)=>{var i=E(Object(n.cloneDeep)(e));if(!Object(r.h)(i,{error:Object(r.j)(r.k,r.m)}))return e;var o=i.error;return function(e,t){!Object(r.k)(e.message)||function(e,t){if(e.includes(t.FlowChecker.FlowDefinition.MissingTriggerOrAction.split(".")[0]))return!0;if(e.includes(t.FlowChecker.ErrorDuringValidation.split(".")[0]))return!0;return x.some(t=>e.includes(t))}(e.message,t)||e.message.includes("InternalServerError")&&e.message.includes("CannotSaveFlow")||(e.message=O(e.message),Object(r.k)(e.message)&&!e.message.includes(l)&&(e.message=l));Object(r.k)(e.error)&&(e.error=O(e.error),Object(r.k)(e.error)&&!e.error.includes(l)&&(e.error=l))}(o,t),R(o),F(o)};function R(e){if(Object(r.j)(r.k,r.m)(e.error)&&Object(r.k)(e.error.code)&&"flowsDesignerGetDefinitionError"===e.error.code&&Object(r.j)(r.k,r.m)(e.error.innerException)&&Object(r.j)(r.k,r.m)(e.error.innerException.data)&&Object(r.k)(e.error.innerException.data.tokenExpression)&&(e.error.innerException.data.tokenExpression=l,Object(r.j)(r.k,r.m)(e.error.innerException.data.segment))){var t=e.error.innerException.data.segment;Object(r.j)(r.k,r.m)(t.token)&&Object(r.k)(t.token.value)&&(t.token.value=l),Object(r.j)(r.k,r.m)(t.token)&&Object(r.k)(t.token.title)&&(t.token.title=l),Object(r.k)(t.tokenExpression)&&(t.tokenExpression=l)}}function O(e){var t=e||"";if(t.includes("0x80060467")&&(t=D(h,t),t=D(m,t),t=D(g,t),t=D(f,t),t=D(v,t)),t=D(b,t),t=D(y,t),t=D(w,t),t=D(S,t),t=D(C,t),t=D(k,t),(t=D(P,t)).match(P)&&(t.includes(" to ")||t.includes(" with "))){t=t.replace(/'([^']*)'\./g,"'".concat(l,"'."))}return e=t}function D(e,t){var i,r=t;e.lastIndex=0;do{(i=e.exec(r))&&(r="".concat(r.substring(0,i.index)).concat(i.slice(1).join("--scrubPII--")).concat(r.substring(i.index+i[0].length)),e.lastIndex=i.index+i.slice(1).join("--scrubPII--").length)}while(null!==i);return r}function E(e){try{return{error:"string"==typeof e?JSON.parse(e):e}}catch(t){return!1}}function F(e){try{return JSON.stringify(e)}catch(t){return e}}},33487:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.PowerAutomateClientTeam,owners:["paadminandlifecycle"],description:"Enables performance updates related to solution flows by default load",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1534655",createdOn:"1/6/2025",fallback:{enableCondenseXrmWorkflowCalls:!1,enableParallelizeGetConnectionReferenceCalls:!1}}),{getFeatureValue:a}=Object(n.b)(o,"enableCondenseXrmWorkflowCalls"),{getFeatureValue:s}=Object(n.b)(o,"enableParallelizeGetConnectionReferenceCalls")},33488:function(e,t,i){"use strict";var r=i(29014);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b})),i.d(t,"c",(function(){return r.c}))},33489:function(e,t,i){e.exports=i.p+"static/media/flow.88e67090.less"},33490:function(e,t){e.exports='<trial-dialog></trial-dialog>\n\n<react-default-nps-dialog\n    widget-util-service="flowCtrl.defaultNpsDialog.widgetUtilService"\n    session-store="flowCtrl.defaultNpsDialog.sessionStore"\n    environment-store="flowCtrl.defaultNpsDialog.environmentStore"\n    ng-if="flowCtrl.shouldShowNpsDialog">\n</react-default-nps-dialog>\n\n<div\n    class="manage-flow-section"\n    ng-if="!flowCtrl.fullPageErrorModel.isPageErrored"\n    role="main">\n    <react-action-heading\n        data-automation-id="action_heading"\n        class="react-action-heading"\n        ng-class="{\'is-widget\': flowCtrl.widgetUtilService.isWidgetPage()}"\n        ng-if="flowCtrl.isFlowLoaded || this.actionHeadingMessageBar !== null"\n        back-button-props="flowCtrl.actionBackButton"\n        menu-bar-props="flowCtrl.actionHeadingMenu"\n        title-aria-label="flowCtrl.actionHeadingTitleAriaLabel"\n        title-text="flowCtrl.actionHeadingTitleText"\n        title-placeholder="flowCtrl.actionHeadingTitlePlaceholder"\n        title-readonly="flowCtrl.actionHeadingTitleReadonly"\n        status-text="flowCtrl.actionHeadingStatusText"\n        message-bar-props="flowCtrl.actionHeadingMessageBar"\n        additional-message-bar-props="flowCtrl.actionHeadingAdditionalMessageBar"\n        on-title-change="flowCtrl.actionHeadingOnTitleChange"\n        render-right-content="flowCtrl.actionHeadingRenderRightContent"\n        role="flowCtrl.actionHeadingAriaRole"\n        aria-level="{{1}}"\n        client-resources="flowCtrl.clientResources"></react-action-heading>\n    <spinner model="flowCtrl.spinner"></spinner>\n    <div class="manage-flow-details" ng-show="!flowCtrl.spinner.show">\n        <div class="draft-overlay" ng-if="::flowCtrl.shouldDisplayDraftOverlay()">\n            <span class="draft-marker">{{::flowCtrl.clientResources.Common.Draft}}</span>\n        </div>\n        <div\n            class="flow-designer-container"\n            ng-class="{\'message-bar-spacer\': flowCtrl.actionHeadingMessageBar && flowCtrl.actionHeadingMessageBar.message}">\n            <flow-designer\n                ng-if="!flowCtrl.isFlowRunPage"\n                ng-show="!flowCtrl.isMonitorEnabled()"\n                context="flowCtrl.designerContext"\n                on-init="flowCtrl.onInitDesigner()">\n            </flow-designer>\n            <flow-monitor\n                ng-if="flowCtrl.isMonitorEnabled()"\n                model="flowCtrl.monitorModel"\n                context="flowCtrl.monitorContext"\n                on-init="flowCtrl.onInitMonitor()"\n                on-load-complete="flowCtrl.onMonitorLoadComplete()"\n                on-load-error="flowCtrl.onMonitorLoadError()">\n            </flow-monitor>\n        </div>\n        <div id="flow-commenting-pane"\n            ng-class="{\'opened\': flowCtrl.isCommentingPaneOpen}">\n        </div>\n        <flow-remediation-pane\n            ng-if="flowCtrl.initRemediationPane"\n            flow-name="flowCtrl.flowName"\n            flow-run-name="flowCtrl.flowRunName"\n            is-migration-source="flowCtrl.isMigrationSourceFlowRun"\n            is-flow-check-page="flowCtrl.isFlowCheckPage"\n            flow-trigger-name="flowCtrl.flowDefinitionTriggerName"\n            on-error="flowCtrl.showErrorMessageInAlert(error)"\n            on-dismiss="flowCtrl.onDismissRemediationPane()"\n            show-pane="flowCtrl.showRemediationPane">\n        </flow-remediation-pane>\n        <react-contextual-help-panel\n            flow-name="flowCtrl.contextualHelpPanel.flowName"\n            is-open="flowCtrl.contextualHelpPanel.isOpen"\n            search-text="flowCtrl.contextualHelpPanel.searchText"\n            title="flowCtrl.contextualHelpPanel.title"\n            description="flowCtrl.contextualHelpPanel.description"\n            api-BrandColor="flowCtrl.contextualHelpPanel.apiBrandColor"\n            api-IconUri="flowCtrl.contextualHelpPanel.apiIconUri"\n            document-Url="flowCtrl.contextualHelpPanel.documentUrl"\n            connector-Display-Name="flowCtrl.contextualHelpPanel.connectorDisplayName"\n            is-recommendation="flowCtrl.contextualHelpPanel.isRecommendation"\n            connector-Id="flowCtrl.contextualHelpPanel.connectorId"\n            action-Friendly-Name="flowCtrl.contextualHelpPanel.actionFriendlyName"\n            on-invoke-search="flowCtrl.onInvokeSearch"\n            on-dismissed="flowCtrl.onContextualHelpPanelIsDismissed"\n            flow-client-resources="flowCtrl.clientResources"\n            telemetry-service="flowCtrl.telemetry"\n            cdn-service="flowCtrl.cdnService"\n            logging-service="flowCtrl.loggingService"\n            do-not-show-again-service="flowCtrl.doNotShowAgainService"\n            token-service="flowCtrl.tokenService"\n            widget-util-service="flowCtrl.widgetUtilService"\n            >\n        </react-contextual-help-panel>\n        <react-recommendation-panel\n            is-open="flowCtrl.recommendationPanel.isOpen"\n            processName="flowCtrl.recommendationPanel.processName"\n            activityRecommendations="flowCtrl.recommendationPanel.activityRecommendations"\n            defaultConnectorRecommendation="flowCtrl.recommendationPanel.defaultConnectorRecommendation"\n            on-dismiss="flowCtrl.onRecommendationPanelDismiss"\n            client-resources="flowCtrl.clientResources"\n            cdn-service="flowCtrl.cdnService">\n        </react-recommendation-panel>\n    </div>\n    <react-widget-footer\n        data-automation-id="react-widget-footer"\n        class="react-widget-footer"\n        ng-class="{\'is-widget\': flowCtrl.widgetUtilService.isWidgetPage()}"\n        ng-if="flowCtrl.shouldShowNL2FlowFooter()"\n        aria-role="flowCtrl.actionHeadingAriaRole"\n        aria-level="{{1}}"\n        client-resources="flowCtrl.clientResources"\n        footer-button-props="flowCtrl.getNL2FlowWidgetFooterButtonProps()"\n        on-click-edit-in-workflows-app="flowCtrl.onClickEditInWorkflowsApp">\n    </react-widget-footer>\n</div>\n\n<react-test-flow-panel\n    is-open="flowCtrl.testPanel.isOpen"\n    is-disabled="flowCtrl.testPanel.isDisabled"\n    flow-is-dirty="flowCtrl.testPanel.flowIsDirty"\n    trigger-new-test-run-allowed="flowCtrl.testPanel.triggerNewTestRunAllowed"\n    flow-is-simulate-trigger-supported="flowCtrl.testPanel.flowIsSimulateTriggerSupported"\n    flow-is-trigger-concurrency-enabled="flowCtrl.testPanel.flowIsTriggerConcurrencyEnabled"\n    message-bar-props="flowCtrl.testPanel.messageBarProps"\n    previous-runs="flowCtrl.testPanel.previousRuns"\n    selected-choice="flowCtrl.testPanel.selectedChoice"\n    selected-sub-choice="flowCtrl.testPanel.selectedSubChoice"\n    selected-run="flowCtrl.testPanel.selectedRun"\n    trigger-connector-display-name="flowCtrl.testPanel.triggerConnectorDisplayName"\n    trigger-hint="flowCtrl.testPanel.triggerHint"\n    on-choice-selection-change="flowCtrl.onTestPanelChoiceChange"\n    on-choice-automatically-sub-selection-change="flowCtrl.onTestPanelAutomaticallySubChoiceChange"\n    on-run-selection-change="flowCtrl.onTestPanelRunChoiceChange"\n    on-close="flowCtrl.closeTestPanel"\n    on-dismissed="flowCtrl.onTestPanelIsDismissed"\n    on-invoke-flow-as-test="flowCtrl.onInvokeFlowAsTest"\n    on-invoke-run-as-test="flowCtrl.onInvokeRunAsTest"\n    on-invoke-simulate="flowCtrl.onInvokeSimulate",\n    client-resources="flowCtrl.clientResources"\n    logging-service="flowCtrl.loggingService">\n</react-test-flow-panel>\n<react-flow-checker-panel\n    actions="flowCtrl.flowCheckerPanel.actions"\n    connection-errors="flowCtrl.flowCheckerPanel.connectionErrors"\n    connection-warnings="flowCtrl.flowCheckerPanel.connectionWarnings"\n    flow-checker-errors="flowCtrl.flowCheckerPanel.flowCheckerErrors"\n    flow-checker-warnings="flowCtrl.flowCheckerPanel.flowCheckerWarnings"\n    is-open="flowCtrl.flowCheckerPanel.isOpen"\n    is-solution-flow="flowCtrl.flowCheckerPanel.isSolutionFlow"\n    is-current-user-flow-owner="flowCtrl.flowCheckerPanel.isCurrentUserFlowOwner"\n    parameters-errors="flowCtrl.flowCheckerPanel.parametersErrors"\n    triggers="flowCtrl.flowCheckerPanel.triggers"\n    on-dismissed="flowCtrl.onFlowCheckerPanelDismissed"\n    on-operation-item-clicked="flowCtrl.onOperationItemClicked"\n    client-resources="flowCtrl.clientResources"\n    app-settings="flowCtrl.appSettings"\n    asset-service="flowCtrl.assetService"\n    telemetry-service="flowCtrl.telemetry"\n    plan-service="flowCtrl.planService"\n    graph-service="flowCtrl.graphService"\n    license-management-service="flowCtrl.licenseManagementService"\n    neptune-service="flowCtrl.neptuneService"\n    widget-util-service="flowCtrl.widgetUtilService"\n    plan-store="flowCtrl.flowCheckerPanel.planStore"\n    session-store="flowCtrl.flowCheckerPanel.sessionStore"\n    surface-store="flowCtrl.flowCheckerPanel.surfaceStore"\n    license-management-store="flowCtrl.flowCheckerPanel.licenseManagementStore"\n    logging-service="flowCtrl.flowCheckerPanel.loggingService"\n    feature-flags="flowCtrl.flowCheckerPanel.featureFlags"\n    cdn-service="flowCtrl.flowCheckerPanel.cdnService"\n    consent-service="flowCtrl.flowCheckerPanel.consentService"\n    user-details-store="flowCtrl.flowCheckerPanel.userDetailsStore">\n</react-flow-checker-panel>\n<react-easy-automation-panel\n    resources="flowCtrl.clientResources"\n    store="flowCtrl.easyAutomationPanelStore">\n</react-easy-automation-panel>\n<ng-invoke-flow-panel-wrapper\n    flow-name="flowCtrl.invokeFlowPanelAngularWrapperBindings.flowName"\n    is-open="flowCtrl.invokeFlowPanelAngularWrapperBindings.isOpen"\n    is-test-run="flowCtrl.invokeFlowPanelAngularWrapperBindings.isTestRun"\n    on-done="flowCtrl.invokeFlowPanelAngularWrapperBindings.onDone">\n</ng-invoke-flow-panel-wrapper>\n\n<full-page-error model="flowCtrl.fullPageErrorModel" ng-if="flowCtrl.fullPageErrorModel.isPageErrored"></full-page-error>\n<div>\n    <form id="officePortalSignup" method="post" action="{{flowCtrl.officePortalSignupAction}}" target="_blank">\n        <input type="hidden" name="StepsData.Email" value="{{flowCtrl.sessionService.getUserSession().userInfo.displayName}}" />\n    </form>\n</div>\n<div class="consent-widget" ng-if="flowCtrl.isSessionInfoPopulated && flowCtrl.userConsentService.shouldShowIntegratedConsent()">\n    <user-consent></user-consent>\n</div>\n\n<ng-flow-save-as-ui />'},33491:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33335),n=i(33327),o=i(33492);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33494);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33495),this.controller=o.a,this.controllerAs="flowCreationWidgetCtrl"}));r.a.component(n.a.components.flowCreationWidget,new c)},33492:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(13009),n=i(19793),o=i(20381),a=i(13202),s=i(15402),l=i(19726),c=i(22602),u=i(33355),d=i(33327),p=i(33360),h=i(33384),m=i(33493),g=i(33396),f=i(22888);function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y=function(){function e(t,i,n,d,h,v,b,y,w,S,C,k,P,x,A){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$scope=i,this.appSettings=n,this.assetService=d,this.clientResources=h,this.connectionService=v,this.designerCoreLoaderService=b,this.environmentService=y,this.hostCommunicationService=w,this.loggingService=S,this.policiesService=C,this.sessionService=k,this.widgetUtilService=P,this.designerCoreLoader=x,this.designerContextService=A,this.createFromTemplateDeferredPromise=void 0,this.createFromTemplateDefinitionDeferredPromise=void 0,this.fullPageErrorModel=void 0,this.safeSessionStorage=void 0,this.isReady=!1,this.isCreatedFromTemplateDefinition=!1,this.flowCreatorSurfaceKey=void 0,this.showFlowCreatorSurface=e=>{var t=this.designerCoreLoader.loadDesignerScripts.bind(this.designerCoreLoader);this.safeSessionStorage.setItem("flowCreationWidgetTemplateArgs",JSON.stringify(e));var i={autoConsentUser:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.allowBackgroundConsent(),allowCustomFlowDisplayName:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.allowCustomFlowName(),flowCreationMode:o.a.fromTemplateName,installFlowAfterCreation:!1,designTimeParameters:e.designTimeParameters,loadDesignerScripts:t,onCreateFlowCompletion:this.onCreateFlowCompletion,onCreateFlowError:this.onCreateFlowError,onContentFirstRendered:this.onRender,onLoadTemplateError:this.onLoadTemplateError,templateName:e.templateName,solutionId:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.getSolutionId(),onDone:this.onDoneClickedAfterCreatingFlow,onCancel:this.onClose,onClose:this.onClose,dismiss:this.dismiss,surfaceType:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.getFullPageSurfaceType(),hasCloseButton:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.hasCloseButtonOnFullPageSurface(),skipClosingSurfaceOnDoneClicked:this.widgetUtilService.widgetOptions.preventCloseOnFlowCreationDoneClicked,skipForceRefreshOfConnections:!0,hideCancelButton:this.shouldHideCancelButton()};this.dismissSurfaces(),this.flowCreatorSurfaceKey=Object(f.a)({surfaceStore:a.a,flowCreatorProps:i}).key},this.shouldHideCancelButton=()=>this.widgetUtilService.isTeamsContext(),this.dismissSurfaces=()=>{this.flowCreatorSurfaceKey&&a.a.dismissSurface(this.flowCreatorSurfaceKey)},this.onDoneClickedAfterCreatingFlow=(e,t)=>{t===m.c.ForASelectedMessage||t===m.c.ForASelectedMessageV2||t===m.c.ComposeAMessage||t===m.c.ComposeAMessageV2?this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.fireFlowCreationRunClickedAndUpdateTeamsCache(e,t):this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.fireFlowCreationDoneClicked(e.name)},this.showFlowCreatorSurfaceForInlineTemplate=e=>{var t=this.designerCoreLoader.loadDesignerScripts.bind(this.designerCoreLoader),i={autoConsentUser:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.allowBackgroundConsent(),allowCustomFlowDisplayName:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.allowCustomFlowName(),flowCreationMode:o.a.fromTemplateDefinition,installFlowAfterCreation:!1,designTimeParameters:e.designTimeParameters,loadDesignerScripts:t,onCreateFlowCompletion:this.onCreateFlowCompletion,onCreateFlowError:this.onCreateFlowError,onContentFirstRendered:this.onRender,onLoadTemplateError:this.onLoadTemplateError,templateDefinition:JSON.parse(e.templateDefinition),onCancel:this.onClose,onClose:this.onClose,onDone:this.onDoneClickedAfterCreatingFlow,dismiss:this.dismiss,surfaceType:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.getFullPageSurfaceType(),solutionId:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.getSolutionId(),hasCloseButton:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.hasCloseButtonOnFullPageSurface(),skipClosingSurfaceOnDoneClicked:this.widgetUtilService.widgetOptions.preventCloseOnFlowCreationDoneClicked,hideCancelButton:this.shouldHideCancelButton()};this.dismissSurfaces(),this.flowCreatorSurfaceKey=Object(f.a)({surfaceStore:a.a,flowCreatorProps:i}).key},this.dismiss=()=>{this.completePendingPromises(),this.flowCreatorSurfaceKey&&a.a.dismissSurface(this.flowCreatorSurfaceKey)},this.onClose=()=>{this.completePendingPromises(),this.hostCommunicationService.triggerHostEvent(m.d.WIDGET_CLOSE)},this.onCreateFlowCompletion=e=>{var t=Object(g.b)(e,this.environmentService);this.hostCommunicationService.triggerHostEvent(m.d.FLOW_CREATION_SUCCEEDED,{flowId:e,flowName:e,flowUrl:t}),this.isCreatedFromTemplateDefinition?this.createFromTemplateDefinitionDeferredPromise.resolve(e):this.createFromTemplateDeferredPromise.resolve(e)},this.onCreateFlowError=e=>{this.hostCommunicationService.triggerHostEvent(m.d.FLOW_CREATION_FAILED,{error:e}),this.isCreatedFromTemplateDefinition?this.createFromTemplateDefinitionDeferredPromise.reject(e):this.createFromTemplateDeferredPromise.reject(e)},this.onLoadTemplateError=e=>{this.hostCommunicationService.triggerHostEvent(m.d.TEMPLATE_LOAD_FAILED,{error:e}),this.isCreatedFromTemplateDefinition?this.createFromTemplateDefinitionDeferredPromise.reject(e):this.createFromTemplateDeferredPromise.reject(e)},this.onRender=()=>{this.hostCommunicationService.triggerHostEvent(m.d.WIDGET_RENDERED)},i.$on("$destroy",()=>{this.hostCommunicationService.onCreateFlowFromTemplate(()=>{}),this.hostCommunicationService.onCreateFlowFromTemplateDefinition(()=>{}),this.hostCommunicationService.onCloseWidget(()=>{})}),this.safeSessionStorage=new c.a("flowCreationWidgetTemplateArgs",S),this.fullPageErrorModel={image:this.assetService.fullPageErrorGeneric,isPageErrored:!1,pageTitle:this.appSettings.brandName,customButtons:[]};var T=this.loggingService.profilePageStart(u.a.flowCreationWidgetLoadStart);Promise.all([this.sessionService.getUserSessionAsync(),this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetOptionsAvailabilityPromise,this.policiesService.shouldBlockWidgetUsage()]).then(e=>{var[t,i,r]=e;if(r){this.fullPageErrorModel.customButtons=[{buttonText:Object(p.d)(this.clientResources.Common.VisitFlowPortal,this.appSettings.brandName),url:Object(l.a)()}];var n=this.sessionService.isGuestUser()?Object(p.d)(this.clientResources.FullPageError.FriendlyError.Subtext.GuestUserNoPlans,this.appSettings.brandName):Object(p.d)(this.clientResources.FullPageError.FriendlyError.Subtext.RedirectToMSA,this.appSettings.brandName),o=new Error(n);throw this.showFullPageError(o),o}Object(s.c)({loggingService:this.loggingService,promise:this.connectionService.getConnections({forceRefresh:!0}),eventStartName:u.a.flowCreationWidgetPrefetchConnectionsStart,eventEndName:u.a.flowCreationWidgetPrefetchConnectionsEnd}),Object(s.c)({loggingService:this.loggingService,promise:this.designerCoreLoaderService.loadDesignerScripts(),eventStartName:u.a.flowCreationWidgetPrefetchDesignerStart,eventEndName:u.a.flowCreationWidgetPrefetchDesignerEnd}),this.loggingService.profilePageEnd(T,u.a.flowCreationWidgetLoadEnd),this.isReady=!0;var a=this.safeSessionStorage.getItem("flowCreationWidgetTemplateArgs");a&&this.handleLoadTemplate(JSON.parse(a))}).catch(e=>{this.loggingService.profilePageEnd(T,u.a.flowCreationWidgetLoadEnd,{status:Object(r.y)(e),error:Object(r.db)(e)})}),this.hostCommunicationService.onCreateFlowFromTemplate(e=>this.handleLoadTemplate(e)),this.hostCommunicationService.onCreateFlowFromTemplateDefinition(e=>this.handleLoadTemplateDefinition(e)),this.hostCommunicationService.onCloseWidget(()=>{this.onClose()})}var t,i,d;return t=e,(i=[{key:"handleLoadTemplate",value:function(e){var t;return this.createFromTemplateDeferredPromise=this.$q.defer(),this.isReady?e?e.templateName||(t=new n.a(r.c.flowCreationWidgetInvalidCreateFromTemplateArgs,"invalid createFromTemplateArgs. Missing templateName")):t=new n.a(r.c.flowCreationWidgetInvalidCreateFromTemplateArgs,"createFromTemplateArgs is undefined"):t=new n.a(r.c.flowCreationWidgetNotReadyError,"Wait for WIDGET_READY before notifying widget to 'createFlowFromTemplate'"),Object(p.o)(t)?(this.showFlowCreatorSurface(e),this.createFromTemplateDeferredPromise.promise):(this.showFullPageError(t),this.loggingService.logError(t.code,t),this.createFromTemplateDeferredPromise.reject(t),this.createFromTemplateDeferredPromise.promise)}},{key:"showFullPageError",value:function(e){this.dismissSurfaces();var t=Object(r.db)(e);Object(h.b)(this.fullPageErrorModel,null,this.clientResources.FullPageError.FriendlyError.Text.ThatDidntWork,t),this.hostCommunicationService.triggerHostEvent(m.d.WIDGET_RENDERED),this.$scope.$applyAsync(()=>{})}},{key:"handleLoadTemplateDefinition",value:function(e){var t;this.createFromTemplateDefinitionDeferredPromise=this.$q.defer(),this.isCreatedFromTemplateDefinition=!0,this.isReady?e?e.templateDefinition||(t=new n.a(r.c.flowCreationWidgetInvalidCreateFromTemplateDefinitionArgs,"invalid createFromTemplateDefinitionArgs. Missing templateDefinition")):t=new n.a(r.c.flowCreationWidgetInvalidCreateFromTemplateDefinitionArgs,"createFromTemplateDefinitionArgs is missing"):t=new n.a(r.c.flowCreationWidgetNotReadyError,"Wait for WIDGET_READY before notifying widget to 'createFlowFromTemplateDefinition'");try{JSON.parse(e.templateDefinition)}catch(i){t=new n.a(r.c.flowCreationWidgetInvalidCreateFromTemplateDefinitionArgs,this.clientResources.Widget.FlowCreation.TemplateDefinition.InvalidTemplateDefinition,i)}return Object(p.o)(t)?(this.showFlowCreatorSurfaceForInlineTemplate(e),this.createFromTemplateDefinitionDeferredPromise.promise):(this.showFullPageError(t),this.loggingService.logError(t.code,t),this.createFromTemplateDefinitionDeferredPromise.reject(t),this.createFromTemplateDefinitionDeferredPromise.promise)}},{key:"completePendingPromises",value:function(){this.createFromTemplateDeferredPromise&&this.createFromTemplateDeferredPromise.reject({code:r.c.flowWidgetClosed,message:"The widget was closed"}),this.createFromTemplateDefinitionDeferredPromise&&this.createFromTemplateDefinitionDeferredPromise.reject({code:r.c.flowWidgetClosed,message:"The widget was closed"})}}])&&v(t.prototype,i),d&&v(t,d),Object.defineProperty(t,"prototype",{writable:!1}),e}();y.$inject=[d.a.services.$q,d.a.services.$scope,d.a.services.appSettings,d.a.services.assetService,d.a.services.clientResources,d.a.services.connection,d.a.services.designerCoreLoader,d.a.services.environment,d.a.services.hostCommunicationService,d.a.services.logging,d.a.services.policies,d.a.services.session,d.a.services.widgetUtilService,d.a.services.designerCoreLoader,d.a.services.designerCreateContext]},33493:function(e,t,i){"use strict";var r=i(11804);i.d(t,"a",(function(){return r.b})),i.d(t,"b",(function(){return r.c})),i.d(t,"c",(function(){return r.d})),i.d(t,"d",(function(){return r.e}))},33494:function(e,t,i){e.exports=i.p+"static/media/flowCreationWidget.89aafbdf.less"},33495:function(e,t){e.exports='<div class="flow-creation-widget">\n    <full-page-error model="flowCreationWidgetCtrl.fullPageErrorModel" ng-if="flowCreationWidgetCtrl.fullPageErrorModel.isPageErrored"></full-page-error>\n</div>'},33496:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33335),n=i(33327),o=i(33497);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33499);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33500),this.controllerAs="templateDetails"}));r.a.component(n.a.components.templateDetails,new c)},33497:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var r=i(33394),n=i(33383),o=i(33355),a=i(33392),s=i(33327),l=i(33463),c=i(15433),u=i.n(c),d=i(33498),p=i(14900),h=i(33360),m=i(33374),g=i(17166),f=i.n(g),v=i(13016),b=i(13272),y=i(12754),w=i(14892);function S(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function C(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var k=function(){function e(t,i,s,c,m,g,f,w,S,C,k,P){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$window=s,this.appSettings=c,this.assetService=m,this.cdnService=g,this.clientResources=f,this.environmentService=w,this.routeCrafter=S,this.templatesClient=C,this.loggingService=k,this.userDetailsStore=P,this.template=void 0,this.triggers=[],this.actions=[],this.submitterUserId="",this.redirectUrl=void 0,this.galleryName=void 0,this.templateName=void 0,this.messageBarType=v.c,this.messageBarStyles=void 0,this.messageBarIconProps=void 0,this.messageBarText=void 0,this.sponsoredConnectorsLearnMoreLink=void 0,this.displayForSponsoredConnectors=void 0,this.spinner={size:n.c.Large,local:n.a.Local,show:!0},this.fullPageErrorModel={isPageErrored:!1,pageTitle:null},this.userDetailsStore.isConsented){var x=this.loggingService.profilePageStart(o.a.templateDetailsPageLoadStart);this.galleryName=this.$routeParams.galleryName,this.templateName=this.$routeParams.templateName,this.redirectUrl=Object(p.q)(this.routeCrafter,{createFromTemplateInfo:{templateName:this.templateName,gallery:this.galleryName},additionalQueryParams:this.getFilteredQueryString()});var A=Object(l.c)(this.galleryName,this.templateName,this.environmentService);this.template=this.templatesClient.get(this.$scope,{id:A}),this.template.$promise.then(()=>{var e,t,i,n;if(null===(e=this.template)||void 0===e||!e.properties)throw new r.a(r.c.getTemplateError,"Error loading templateId: ".concat(A));this.loggingService.profileEndWithSuccess(x,o.a.templateDetailsPageLoadEnd),this.$window.document.title=Object(h.d)(f.TemplateDetails.PageTitle,this.template.properties.displayName,this.appSettings.brandName),this.triggers=Object(d.a)((null===(t=this.template.properties.definitionSummary)||void 0===t?void 0:t.triggers)||[],this.template.properties.connectionReferences,this.assetService.trigger,!0,this.assetService,this.clientResources);var a=Object(d.a)((null===(i=this.template.properties.definitionSummary)||void 0===i?void 0:i.actions)||[],this.template.properties.connectionReferences,this.assetService.action,!1,this.assetService,this.clientResources);this.actions=Object.values(u()(a,e=>e.displayName)).map(e=>e[0]),this.submitterUserId=(null===(n=this.template.properties.metadata)||void 0===n||null===(n=n.sharing)||void 0===n?void 0:n.submitterUserId)||"",this.showBannerIfTemplateContainsSponsoredConnectors(),this.displayForSponsoredConnectors&&(this.sponsoredConnectorsLearnMoreLink={href:"https://aka.ms/PAEmbedLimits",ariaLabel:this.clientResources.SponsoredConnector.LearnMoreLinkMessage},this.messageBarText=this.clientResources.SponsoredConnector.BannerMessage,this.messageBarIconProps={iconName:b.a.Diamond},this.messageBarStyles={root:{"&.ms-MessageBar":{backgroundColor:Object(y.Y)().palette.themeLight,padding:"0px"}}})}).catch(e=>{this.loggingService.profilePageEnd(x,o.a.templateDetailsPageLoadEnd,{status:Object(a.b)(e),error:Object(a.e)(e)}),this.fullPageErrorModel={isPageErrored:!0,pageTitle:null,friendlyErrorText:this.clientResources.TemplateDetails.FailedToLoadTemplate,error:e}}).finally(()=>{this.spinner.show=!1})}}var t,i,s;return t=e,(i=[{key:"showBannerIfTemplateContainsSponsoredConnectors",value:function(){if(this.appSettings.featureFlags.enableSponsoredConnectorExperience&&!this.environmentService.isPayGoEnabled){var e=this.environmentService.getSponsoredConnectorNames(),t=Object.values(this.template.properties.connectionReferences).filter(t=>e.includes(Object(w.m)(t.api)));this.displayForSponsoredConnectors=t.length>0}}},{key:"getFilteredQueryString",value:function(){var e=Object(m.b)(this.$window.location.search),t=["themename","enableonbehalfoftokens","oauthhandler","environment","pathalias","showapprovalhistory","historydisabled","expandconnectionwizard"];return f()(e,(e,i)=>{var r=i.toLowerCase();return t.includes(r)||r.startsWith("parameters.")||r.startsWith("utm_")})}}])&&S(t.prototype,i),s&&S(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();k.$inject=[s.a.services.$routeParams,s.a.services.$scope,s.a.services.$window,s.a.services.appSettings,s.a.services.assetService,s.a.services.cdnService,s.a.services.clientResources,s.a.services.environment,s.a.services.routeCrafter,s.a.services.templatesClient,s.a.services.logging,s.a.services.userDetailsStore]},33498:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(14868),n=i(14922),o=i(14926),a=i(14924),s=i(14837),l=i(11891);function c(e,t,i,c,p,h){return 0!==e.length||c?e.filter(e=>Object(l.a)(e.type,s.a.ApiApp)||Object(l.a)(e.type,s.a.ApiConnection)||Object(l.a)(e.type,s.a.ApiConnectionWebhook)||Object(l.a)(e.type,s.a.ApiConnectionNotification)||Object(l.a)(e.type,s.a.OpenApiConnection)||Object(l.a)(e.type,s.a.OpenApiConnectionWebhook)||Object(l.a)(e.type,s.a.OpenApiConnectionNotification)||Object(l.a)(e.type,s.a.Http)||Object(l.a)(e.type,s.a.HttpWebhook)||Object(l.a)(e.type,s.a.Manual)||Object(l.a)(e.type,s.a.Recurrence)||Object(l.a)(e.type,s.a.Request)||Object(l.a)(e.type,s.a.Response)||Object(l.a)(e.type,s.a.Wait)).map(e=>{var c,m,g,f,v,b,y,w=Object(o.a)(e,t);return null!=w&&null!==(c=w.api)&&void 0!==c&&c.properties&&!Object(l.a)(e.type,s.a.Response)?null!==(m=e.metadata)&&void 0!==m&&null!==(m=m.flowSystemMetadata)&&void 0!==m&&m.portalOperationIconOverride&&null!==(g=e.metadata)&&void 0!==g&&null!==(g=g.flowSystemMetadata)&&void 0!==g&&g.portalOperationBrandColorOverride&&null!==(f=e.metadata)&&void 0!==f&&null!==(f=f.flowSystemMetadata)&&void 0!==f&&f.portalOperationApiDisplayNameOverride?{displayName:e.metadata.flowSystemMetadata.portalOperationApiDisplayNameOverride,brandColor:e.metadata.flowSystemMetadata.portalOperationBrandColorOverride,iconUri:e.metadata.flowSystemMetadata.portalOperationIconOverride,onErrorImageSrc:i,tier:u(e.metadata.flowSystemMetadata.portalOperationApiTierOverride)||w.api.properties.tier,isSponsored:null===(y=e.api)||void 0===y||null===(y=y.properties.metadata)||void 0===y?void 0:y.isSponsoredConnector}:{displayName:w.api.properties.displayName||h.TemplateDetails.OperationDisplayNames.NotSpecified,brandColor:(null===(v=w.api.properties.metadata)||void 0===v?void 0:v.brandColor)||"#FFFFFF",iconUri:w.api.properties.iconUri||i,onErrorImageSrc:i,tier:w.api.properties.tier,isSponsored:null===(b=e.api)||void 0===b||null===(b=b.properties.metadata)||void 0===b?void 0:b.isSponsoredConnector}:function(e,t,i,o,l){var c=Object(n.g)(e,t,o,l),u={brandColor:c.brandColor,displayName:c.displayName||d(e,t,l),iconUri:c.iconUri||i,onErrorImageSrc:i};e===s.a.Request&&t===a.a.Http&&(u.tier=r.d.premium);e===s.a.Response&&t!==a.a.VirtualAgent&&t!==a.a.Teams&&(u.tier=r.d.premium);return u}(e.type,e.kind,i,p,h)}):[{displayName:"Custom action",brandColor:"#333333",iconUri:p.customActionPlaceholder,onErrorImageSrc:i,tier:r.d.standard}]}function u(e){return Object(l.a)(e,r.d.standard)?r.d.standard:Object(l.a)(e,r.d.premium)?r.d.premium:void 0}function d(e,t,i){switch(e){case s.a.ApiApp:return i.TemplateDetails.OperationDisplayNames.ApiApp;case s.a.Http:return i.TemplateDetails.OperationDisplayNames.Http;case s.a.HttpWebhook:return i.TemplateDetails.OperationDisplayNames.HttpWebhook;case s.a.Manual:return i.TemplateDetails.OperationDisplayNames.Manual;case s.a.Recurrence:return i.TemplateDetails.OperationDisplayNames.Recurrence;case s.a.Request:switch(t){case a.a.VirtualAgent:return i.TemplateDetails.OperationDisplayNames.PowerVirtualAgents;case a.a.PowerApp:case a.a.PowerAppV2:return i.TemplateDetails.OperationDisplayNames.Manual;case a.a.Teams:return i.TemplateDetails.OperationDisplayNames.Teams;case a.a.Http:return i.TemplateDetails.OperationDisplayNames.Request;case a.a.Button:return i.TemplateDetails.OperationDisplayNames.MobileButton;case a.a.Geofence:return i.TemplateDetails.OperationDisplayNames.Geofence}break;case s.a.Response:switch(t){case a.a.VirtualAgent:return i.TemplateDetails.OperationDisplayNames.PowerVirtualAgents;case a.a.Teams:return i.TemplateDetails.OperationDisplayNames.Teams;default:return i.TemplateDetails.OperationDisplayNames.Response}case s.a.Wait:return i.TemplateDetails.OperationDisplayNames.Wait}return i.TemplateDetails.OperationDisplayNames.NotSpecified}},33499:function(e,t,i){e.exports=i.p+"static/media/templateDetails.7b8deb24.less"},33500:function(e,t){e.exports='<div class="sponsoredConnector-message-bar" ng-if="templateDetails.displayForSponsoredConnectors">\n    <react-text-message-bar-with-link\n        type="templateDetails.messageBarType.info"\n        message="templateDetails.messageBarText"\n        message-bar-icon-props="templateDetails.messageBarIconProps"\n        styles="templateDetails.messageBarStyles"\n        labelLink="templateDetails.sponsoredConnectorsLearnMoreLink">\n    </react-text-message-bar-with-link>\n</div>\n<div ng-if="!templateDetails.spinner.show && !templateDetails.fullPageErrorModel.isPageErrored">\n    <section class="context-template-detail">\n        <div class="row">\n            <div class="column">\n                <h1 class="c-heading-3">{{templateDetails.template.properties.displayName}}</h1>\n            </div>\n        </div>\n        <react-contact-cards\n            triggers="templateDetails.triggers"\n            actions="templateDetails.actions"\n            cdn-service="templateDetails.cdnService"\n            client-resources="templateDetails.clientResources"\n        ></react-contact-cards>\n        <div class="row">\n            <div class="column">\n                <p class="c-paragraph-2">{{templateDetails.template.properties.description}}</p>\n            </div>\n        </div>\n    </section>\n\n    <template-manager\n        gallery-name="{{::templateDetails.galleryName}}"\n        template-display-name="{{templateDetails.template.properties.displayName}}"\n        template-name="{{::templateDetails.templateName}}"\n        submitter-user-id="{{templateDetails.submitterUserId}}"\n        template="templateDetails.template"\n        redirect-url="{{::templateDetails.redirectUrl}}"\n    >\n    </template-manager>\n</div>\n<spinner model="templateDetails.spinner"></spinner>\n<full-page-error model="templateDetails.fullPageErrorModel"></full-page-error>\n'},33501:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33335),n=i(33327),o=i(33502),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33505);var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33506),this.controllerAs="controller",this.resolve={setPageTitle:[n.a.services.$document,n.a.services.appSettings,n.a.services.clientResources,function(e,t,i){e[0].title=Object(a.a)(i.PageTitle.Connections,t.brandName)}]}}));r.a.component(n.a.components.createConnection,new u)},33502:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(33327),n=i(18959),o=i(33503),a=i(33408),s=i(33383),l=i(33353),c=i(33392),u=i(33437),d=i(13223),p=i(33360),h=i(33504),m=i(33347),g=i(14901),f=i(14895);function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y=function(){function e(t,i,r,n,a,u,d,h,f,v,b,y,w,S,C){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$location=t,this.$routeParams=i,this.$scope=r,this.$window=n,this.apisClient=a,this.appSettings=u,this.clientResources=d,this.connectionFormService=h,this.connectionHelperService=f,this.environmentService=v,this.gatewaysClient=b,this.loggingService=y,this.navigationService=w,this.routeCrafter=S,this.telemetryService=C,this.apiName=void 0,this.api=void 0,this.connectionForm=void 0,this.automaticallyCloseTabOnCreate=void 0,this.statusAlert={type:l.a.None,message:"",options:{}},this.spinner={size:s.c.Large,local:s.a.Local},this.formScope=void 0,this.title=void 0,this.isSaving=!1,this.backButton=void 0,this.selectedGateway=void 0,this.availableGateways=void 0,this.hasGatewaySupport=void 0,this.enableGatewayByDefault=void 0,this.isUseGateway=void 0,this.gatewayRefreshShouldSpin=void 0,this.gatewayPickerMessage=void 0,this.isMultiAuth=void 0,this.selectedParam=void 0,this.authTypes=void 0,this.connectionParameterSets=void 0,this.isApiConfigurable=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"CreateConnectionCtrl"}),this.backButton={url:Object(g.m)(this.routeCrafter)},this.automaticallyCloseTabOnCreate=this.$location.search().closeOnCreate,this.apiName=this.$routeParams.apiName,this.spinner.show=!0;var k=this.apisClient.get(this.$scope,{id:m.e(this.apiName)});k.$promise.then(()=>{var e;(this.api=k,this.hasGatewaySupport=m.w(k),this.enableGatewayByDefault=m.z(k),this.isUseGateway=this.hasGatewaySupport&&this.enableGatewayByDefault,this.isApiConfigurable=m.u(k),this.isMultiAuth=m.x(k),this.isApiConfigurable||this.hasGatewaySupport)?(this.hasGatewaySupport&&this.populateGatewaySection(),this.title=Object(p.d)(d.Manage.Connection.Create.Title,m.h(k)),this.isMultiAuth?(this.connectionParameterSets=m.f(k),this.authTypes=m.c(this.connectionParameterSets.values)):(e=this.connectionFormService.createFormItemsFromConnectionParameters(o.a.Create,m.g(k)),this.formScope={formItems:e})):this.navigationService.navigate(Object(g.m)(this.routeCrafter))}).catch(e=>{this.loggingService.logError("CreateConnectionCtrl.Constructor.GetApi",e),this.statusAlert.type=l.a.Error,this.statusAlert.message=Object(c.e)(e,this.clientResources.Common.SomethingWentWrong)}).finally(()=>{this.spinner.show=!1})}var t,i,r;return t=e,(i=[{key:"showApiConfigurationForm",value:function(){return this.isApiConfigurable||this.isUseGateway}},{key:"updateSelectedAuthType",value:function(){var e=m.f(this.api),t=m.d(e.values,this.selectedParam),i=this.connectionFormService.createFormItemsFromConnectionParameterSets(o.a.Create,t);this.formScope={formItems:i}}},{key:"populateGatewaySection",value:function(){this.gatewayPickerMessage=this.clientResources.Manage.Connection.Create.GatewayPicker.LoadingMessage,this.availableGateways=this.gatewaysClient.query(this.$scope,Object(a.a)({$filter:Object(p.d)(h.a,this.api.name)},!0,this.environmentService.getCurrentEnvironmentName())),this.availableGateways.$promise.finally(()=>{this.updateGatewayPickerText()})}},{key:"updateGatewayPickerText",value:function(){0===this.availableGateways.length?this.gatewayPickerMessage=this.clientResources.Manage.Connection.Create.GatewayPicker.NoGatewayMessage:(this.selectedGateway||(this.selectedGateway=this.availableGateways[0]),this.gatewayPickerMessage="")}},{key:"getGatewayOptionName",value:function(e){return e.properties.displayName}},{key:"submitButtonText",get:function(){return this.isSaving?this.clientResources.Manage.Connection.Create.Creating:this.clientResources.Manage.Connection.Create.Create}},{key:"isDisabled",get:function(){var e=this.showApiConfigurationForm()&&this.connectionForm.$invalid;return this.isUseGateway&&!this.selectedGateway&&(e=!0),this.isSaving||e}},{key:"submit",value:function(){this.telemetryService.tagEvent(u.a.CreateConfigurableConnection);var e,t=this.connectionFormService.convertFormItemsToParameterValues(this.formScope.formItems);e=this.isMultiAuth&&this.selectedParam===f.d.ServicePrincipalConnection?Object(n.b)(t):Object(n.a)(t);var i=Object(d.a)().replace(/-/g,""),r=Object(n.e)(this.api.name,i);this.isUseGateway&&(t=this.connectionFormService.addGatewayToParameterValues(t,this.selectedGateway,this.api)),this.isSaving=!0,this.statusAlert.type=l.a.None,this.statusAlert.message="",this.connectionHelperService.addConnection(this.api,r,e).then(e=>this.connectionHelperService.testConnection(e)).then(()=>{this.navigationService.navigate(Object(g.d)(this.routeCrafter)),this.automaticallyCloseTabOnCreate&&this.$window.close()}).catch(e=>{this.loggingService.logError("CreateConnectionCtrl.Submit",e),this.statusAlert.type=l.a.Error,this.statusAlert.message=Object(c.e)(e,this.clientResources.Common.SomethingWentWrong)}).finally(()=>{this.isSaving=!1})}},{key:"cancel",value:function(){this.navigationService.navigate(this.backButton.url)}}])&&v(t.prototype,i),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();y.$inject=[r.a.services.$location,r.a.services.$routeParams,r.a.services.$scope,r.a.services.$window,r.a.services.apisClient,r.a.services.appSettings,r.a.services.clientResources,r.a.services.connectionForm,r.a.services.connectionHelper,r.a.services.environment,r.a.services.gatewaysClient,r.a.services.logging,r.a.services.navigation,r.a.services.routeCrafter,r.a.services.telemetry]},33503:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33331),n=i(33327),o=i(11891),a=i(33347);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(e){return e[e.Create=0]="Create",e[e.Edit=1]="Edit",e}({}),u="bool",d="options",p="int",h="number",m=["securestring","string",h,p,u,d],g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t}var t,i,r;return t=e,(i=[{key:"createFormItemsFromConnectionParameters",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={},n=[],a={};return Object.keys(i).map(e=>{a[e.toLowerCase()]=i[e]}),Object.keys(t||{}).forEach(s=>{var l=t[s];if((l.allowedValues||l.uiDefinition.constraints.allowedValues)&&(l.type=d),this.isSupportedType(l.type)){var u,p=l.uiDefinition&&l.uiDefinition.displayName||s,h=l.type,m=s.toLowerCase(),g=a[m];u=!(Object(o.a)(l.type,"bool")||e!==c.Create&&Object(o.a)(l.type,"securestring"))&&l.uiDefinition&&l.uiDefinition.constraints&&l.uiDefinition.constraints.required===(!0).toString(),!Object(o.a)(l.type,"bool")||null!==i[s]&&void 0!==i[s]||(g=!1),void 0===g&&void 0!==l.uiDefinition.constraints.allowedValues&&l.uiDefinition.constraints.allowedValues.length>0&&(g=l.uiDefinition.constraints.allowedValues[0]),r[s]={type:h,displayName:p,value:g,options:l.uiDefinition.constraints.allowedValues,required:u,isCreateFormItem:e===c.Create}}else n.push(l.type)}),n.length>0&&this.loggingService.logInfo("ConnectionUnsupportedTypes","Connection unsupported types detected.",{unsupportedConnectionTypes:n}),r}},{key:"createFormItemsFromConnectionParameterSets",value:function(e,t){return this.createFormItemsFromConnectionParameters(c.Create,t.parameters)}},{key:"createFormItemsFromProviderParameters",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return(t||[]).forEach(e=>{var t={type:e.Type,metadata:e.Metadata,uiDefinition:{displayName:e.DisplayName,description:e.Description,constraints:{required:(!e.Default).toString(),allowedValues:e.AllowedValues}}};r[e.Name]=t,!i[e.Name]&&e.Default&&(i[e.Name]=e.Default)}),this.createFormItemsFromConnectionParameters(e,r,i)}},{key:"convertFormItemsToParameterValues",value:function(e){var t={};return Object.keys(e).forEach(i=>{var r,n=e[i];switch(n.type.toLowerCase()){case u:r=Object(o.a)(n.value,"true");break;case p:case h:try{r=JSON.parse(n.value)}catch(s){this.loggingService.logError("ConnectionFormService.ConvertFormItemsToParameterValues",s)}break;case d:var a=n.value;a&&a.value&&(r=a.value);break;default:r=n.value}t[i]=r}),t}},{key:"addGatewayToParameterValues",value:function(e,t,i){return t&&(e[Object(a.i)(i)]={gatewayObjectId:t.name}),e}},{key:"isSupportedType",value:function(e){return m.some(t=>Object(o.a)(t,e))}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.$inject=[n.a.services.logging],r.a.service(n.a.services.connectionForm,g)},33504:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33328),n=i(33327),o=i(31433),a=i(33408),s=i(13144),l=i(33350),c={urlPath:"".concat(Object(o.a)().powerAppsResourceProviderPath,"/gatewayClusters"),resourceType:"".concat(Object(o.a)().powerAppsResourceProviderPath,"/gatewayClusters")},u="apiName eq '{0}'",d={listGateways:6e4,getGateway:45e3,evictionDelay:3e5};r.a.factory(n.a.services.gatewaysClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment,(e,t,i)=>{var r=Object(l.a)();return t({urlBase:Object(s.c)(e).powerAppsRP,urlPath:c.urlPath,resourceType:c.resourceType,apiVersion:e.powerAppsResourceProviderApiVersionWithEnvironments,rest:{query:{params:Object(a.a)({},!0,i.getCurrentEnvironmentName()),requestInterceptor:r},get:{params:Object(a.a)({id:"@id"},!0,i.getCurrentEnvironmentName()),requestInterceptor:r}},actions:[],options:{evictionDelay:d.evictionDelay}})}])},33505:function(e,t,i){e.exports=i.p+"static/media/createConnection.ea1ad8c0.less"},33506:function(e,t){e.exports='<div class="subsection-manage context-manage-create-connection">\n    <heading label="controller.title" back="controller.backButton" ng-hide="controller.spinner.show"></heading>\n    <alert model="controller.statusAlert"></alert>\n    <div class="row top-align">\n        <div class="column" ng-hide="controller.spinner.show">\n            <form name="controller.connectionForm" novalidate>\n                <div ng-show="controller.hasGatewaySupport && !controller.enableGatewayByDefault">\n                    <div class="c-checkbox">\n                        <label class="c-label">\n                            <input type="checkbox" ng-model="controller.isUseGateway" checked/> <span>{{controller.clientResources.Manage.Connection.Create.UseGatewayCheckboxLabel}}</span>\n                        </label>\n                    </div>\n                </div>\n\n                <div class="title label-required" id="multiauth-picker-label" ng-if="controller.isMultiAuth ">\n                    {{controller.clientResources.Manage.Connection.Create.AuthenticationType}}\n                </div>\n\n                <div class="input">\n                    <select\n                        aria-labelledby="multiauth-picker-label"\n                        class="form-control gateway-picker-container description-row"\n                        ng-model="controller.selectedParam" ng-if="controller.isMultiAuth"\n                        ng-change="controller.updateSelectedAuthType()"\n                        ng-options="auth for auth in controller.authTypes">\n                    </select>\n                </div>\n\n                <connection-form model="controller.formScope" ng-show="controller.showApiConfigurationForm()"></connection-form>\n\n                <div ng-show="controller.isUseGateway">\n                    <label class="c-label" for="ddlGatewayPicker">{{controller.clientResources.Manage.Connection.Create.SelectGatewayLabel}} <span class="context-required-text">*</span></label>\n                    <div class="c-select">\n                        <select class="form-control" ng-required ng-model="controller.selectedGateway" ng-disabled="controller.availableGateways.length == 0" ng-options="controller.getGatewayOptionName(gateway) for gateway in controller.availableGateways">\n                                    <option value="" ng-show="controller.gatewayPickerMessage !== \'\'">{{controller.gatewayPickerMessage}}</option>\n                            </select>\n                    </div>\n                    <label class="c-label">\n                            {{controller.clientResources.Manage.Connection.Create.GatewayInstallerInfo}}\n                            <a ng-href="{{controller.appSettings.gatewayInstallerUrl}}" class="c-hyperlink" data-event-name="IntallGatewayFromCreateConnectionClicked">\n                                {{controller.clientResources.Manage.Connection.Create.GatewayInstallerLinkInfo}}\n                            </a>\n                        </label>\n                    </label>\n                </div>\n\n                <button class="c-button" ng-click="controller.cancel()" ng-disabled="controller.isSaving">{{controller.clientResources.Manage.Connection.Create.Cancel}}</button>\n                <button type="submit" class="c-button" ng-click="controller.submit()" ng-disabled="controller.isDisabled">{{controller.submitButtonText}}</button>\n            </form>\n        </div>\n    </div>\n    <spinner model="controller.spinner"></spinner>\n</div>'},33507:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33335),n=i(33327),o=i(33508);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33510);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33511),this.controllerAs="trialExpiredCtrl"}));r.a.component(n.a.components.trialExpired,new c)},33508:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(33327),n=i(33437),o=i(33509),a=i(33354),s=i(33446),l=i(33360),c=i(33392),u=i(16811),d=i(16918);function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var m=function(){function e(t,i,r,a,s,c,u,d,p,h,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$window=t,this.appSettings=i,this.clientResources=r,this.graphService=a,this.loggingService=s,this.planService=c,this.plansClientCreateAndRenew=u,this.assetService=d,this.sessionService=p,this.telemetryService=h,this.neptuneService=m,this.heading=void 0,this.headingBottom=void 0,this.shouldShowExtendTrialDialog=!1,this.shouldShowTrialExtendedDialog=!1,this.extendingTrial=!1,this.isUserTypeDetermined=!1,this.isPageErrored=!1,this.confirmationCheckIcon=void 0,this.extendError=void 0,this.isAdmin=!1,this.extensionFormData={reasonForExtending:"",phoneNumber:"",additionalComments:""},this.telemetryService.tagEvent(n.a.TrialExpiredPageShown,{planSku:this.planService.getPlanLicenseSku()});var g=this.planService.getPlanLicenseSku()===o.a.p2?Object(l.d)(this.clientResources.Common.FlowPlan.P2,this.appSettings.brandName):Object(l.d)(this.clientResources.Common.FlowPlan.P1,this.appSettings.brandName);this.heading=Object(l.d)(r.TrialExpired.Heading.Top,g),this.confirmationCheckIcon=this.assetService.confirmationCheck,this.headingBottom=Object(l.d)(this.clientResources.TrialExpired.Heading.Bottom,this.appSettings.brandName),this.determineUserType()}var t,i,r;return t=e,(i=[{key:"goToPricingPage",value:function(){this.$window.location.href=Object(u.Ib)()}},{key:"showExtendTrialDialog",value:function(){this.shouldShowExtendTrialDialog=!0}},{key:"hideExtendTrialDialog",value:function(){this.shouldShowExtendTrialDialog=!1}},{key:"extendTrial",value:function(){this.telemetryService.tagEvent(n.a.TrialExpiredExtendSubmitted,{isAdmin:this.isAdmin},{reasonForExtending:this.extensionFormData.reasonForExtending}),this.extendingTrial=!0;var e=this.loggingService.profileStart(a.a.extendTrialStart);this.plansClientCreateAndRenew.renewPlan({licenseId:this.planService.getPlanName()}).then(()=>{this.extendingTrial=!1,this.loggingService.profileEndWithSuccess(e,a.a.extendTrialEnd),this.shouldShowExtendTrialDialog=!1,this.shouldShowTrialExtendedDialog=!0}).then(()=>{this.shouldAutoClaimLicense&&this.neptuneService.checkAppAccessV2(d.b.DesktopFlowAttended,d.c.Save,d.a.Premium,[d.d.AutoClaim]).then(e=>{var t;null!=e&&e.hasAccess&&(null==e||null===(t=e.perAppUsageTypeResults)||void 0===t?void 0:t.length)>0&&null!=e&&e.perAppUsageTypeResults.find(e=>e.type===d.f.AutoClaim&&e.status===d.e.Assigned)?this.telemetryService.tagEvent(n.a.TrialExtendedAutoClaimed):this.telemetryService.tagEvent(n.a.TrialExtendedAutoClaimFailed)}).catch(e=>{this.loggingService.logError(n.a.TrialExtendedAutoClaimError,e)})}).catch(t=>{this.extendingTrial=!1,this.extendError=Object(c.e)(t),this.isPageErrored=!0,this.loggingService.profileEnd(e,a.a.extendTrialEnd,c.a.Failure,t)})}},{key:"shouldShowPurchaseOption",get:function(){return this.isAdmin}},{key:"shouldAutoClaimLicense",get:function(){return this.appSettings.featureFlags.enableAutoClaimFromTrialExtendPage}},{key:"redirectBack",value:function(){this.$window.location.reload()}},{key:"determineUserType",value:function(){this.sessionService.isOrgId?this.graphService.getUserRoles().then(e=>{this.isAdmin=Object(s.a)(e),this.isUserTypeDetermined=!0}).catch(e=>{this.isUserTypeDetermined=!0,this.loggingService.logError("trialExpiredCtrl.determineUserType",e)}):this.isUserTypeDetermined=!0}}])&&p(t.prototype,i),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();m.$inject=[r.a.services.$window,r.a.services.appSettings,r.a.services.clientResources,r.a.services.graph,r.a.services.logging,r.a.services.plan,r.a.services.plansClientCreateAndRenew,r.a.services.assetService,r.a.services.session,r.a.services.telemetry,r.a.services.neptuneService]},33509:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33328),n=i(31433),o=i(33327),a=i(13144),s={urlPath:"".concat(Object(n.a)().processSimpleResourceProviderPath,"/servicePlans"),resourceType:"Microsoft.BusinessAppPlatform/servicePlans"},l={p1:"P1",p2:"P2"};r.a.factory(o.a.services.plansClientCreateAndRenew,[o.a.services.appSettings,o.a.services.azureResourceClientFactory,(e,t)=>t({urlBase:Object(a.c)(e).flowRP,urlPath:s.urlPath,actions:[{name:"createPlan",method:"POST",params:{},urlPath:"/providers/Microsoft.ProcessSimple/servicePlans"},{name:"renewPlan",method:"POST",urlPath:"/providers/Microsoft.ProcessSimple/servicePlans/:licenseId/renew/",params:{licenseId:"@licenseId"}}],resourceType:s.resourceType})])},33510:function(e,t,i){e.exports=i.p+"static/media/trialExpired.9d7a1c05.less"},33511:function(e,t){e.exports='<main class="trial-expired" ng-if="trialExpiredCtrl.isUserTypeDetermined">\n  <div class="empty-space">\n    <img ng-src="{{::trialExpiredCtrl.assetService.banners.bigHeroMin}}" alt="" />\n  </div>\n  <div ng-if="trialExpiredCtrl.shouldShowPurchaseOption">\n      <section class="heading">\n          <h1 class="c-heading-3">{{trialExpiredCtrl.heading}}</h1>\n          <p class="c-heading-3">{{::trialExpiredCtrl.headingBottom}}\n              <a ng-href="{{pricingRoute()}}" target="_blank" data-event-name="TrialExpiredLearnMoreClicked">{{::trialExpiredCtrl.clientResources.Common.LearnMore}}</a>\n          </p>\n      </section>\n      <section class="options">\n          <div class="row">\n              <div class="column medium-6">\n                  <section class="option">\n                      <h1 class="c-heading-5">{{::trialExpiredCtrl.clientResources.TrialExpired.Options.Buy}}</h1>\n                      <button data-event-name="TrialExpiredBuyButtonClicked" class="c-button btn-primary" ng-click="trialExpiredCtrl.goToPricingPage()">{{::trialExpiredCtrl.clientResources.TrialExpired.Buttons.Buy}}</button>\n                  </section>\n              </div>\n              <div class="column medium-6">\n                  <section class="option">\n                      <h1 class="c-heading-5">{{::trialExpiredCtrl.clientResources.TrialExpired.Options.Extend}}</h1>\n                      <button data-event-name="TrialExpiredExtendClicked" ng-click="trialExpiredCtrl.showExtendTrialDialog()" class="c-button btn-primary">{{::trialExpiredCtrl.clientResources.TrialExpired.Buttons.Extend}}</button>\n                  </section>\n              </div>\n          </div>\n      </section>\n  </div>\n  <div ng-if="!trialExpiredCtrl.shouldShowPurchaseOption && !trialExpiredCtrl.shouldAutoClaimLicense">\n      <section class="heading">\n          <h1 class="c-heading-3">{{trialExpiredCtrl.heading}}</h1>\n          <p class="c-heading-3">{{::trialExpiredCtrl.clientResources.TrialExpired.Heading.BottomIndividualPurchaseNotSupported}}</p>\n      </section>\n      <section class="option">\n          <h1 class="c-heading-5">{{::trialExpiredCtrl.clientResources.TrialExpired.Options.Extend}}</h1>\n          <p class="c-paragraph-2 error" ng-show="this.trialExpiredCtrl.isPageErrored">{{trialExpiredCtrl.extendError}}</p>\n          <button data-event-name="TrialExpiredExtendClicked" ng-click="trialExpiredCtrl.extendTrial()" ng-disabled="this.trialExpiredCtrl.extendingTrial" class="c-button btn-primary">{{::trialExpiredCtrl.clientResources.TrialExpired.Buttons.Extend}}</button>\n      </section>\n  </div>\n  <div ng-if="!trialExpiredCtrl.shouldShowPurchaseOption && trialExpiredCtrl.shouldAutoClaimLicense">\n      <section class="heading">\n          <h1 class="c-heading-3">{{trialExpiredCtrl.heading}}</h1>\n          <p class="c-heading-3">{{::trialExpiredCtrl.clientResources.TrialExpired.Heading.BottomRequestAndExtendLicense}}</p>\n      </section>\n      <section class="option">\n          <h1 class="c-heading-5">{{::trialExpiredCtrl.clientResources.TrialExpired.Options.RequestExtend}}</h1>\n          <p class="c-paragraph-2 error" ng-show="this.trialExpiredCtrl.isPageErrored">{{trialExpiredCtrl.extendError}}</p>\n          <button data-event-name="TrialExpiredExtendClicked" ng-click="trialExpiredCtrl.extendTrial()" ng-disabled="this.trialExpiredCtrl.extendingTrial" class="c-button btn-primary">{{::trialExpiredCtrl.clientResources.TrialExpired.Buttons.RequestLicense}}</button>\n      </section>\n  </div>\n</main>\n<section class="c-dialog extend-trial-dialog" ng-show="trialExpiredCtrl.shouldShowExtendTrialDialog">\n  <div role="presentation" tabindex="-1" data-js-dialog-hide></div>\n  <div role="dialog" tabindex="-1" class="">\n      <div class="heading">\n          <h1 class="c-heading-3">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Heading.Top}}</h1>\n          <p class="c-paragraph-2">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Heading.Bottom}}</p>\n      </div>\n      <form ng-submit="trialExpiredCtrl.extendTrial()">\n          <label for="reason" class="c-paragraph-2">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.Heading}}</label>\n          <div class="c-select">\n              <select name="reason" id="reason" ng-model="trialExpiredCtrl.extensionFormData.reasonForExtending" required>\n                  <option disabled selected hidden value="">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.Placeholder}}</option>\n                  <option value="Still Evaluating">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.StillEvaluating}}</option>\n                  <option value="Problems Purchasing">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.ProblemsPurchasing}}</option>\n                  <option value="Someone else is buying">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.SomeoneElse}}</option>\n                  <option value="Other">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Reason.Other}}</option>\n              </select>\n          </div>\n          <label for="phone-number" class="c-paragraph-2">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.PhoneNumber.Heading}}</label>\n          <input type="text" placeholder="{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.PhoneNumber.Placeholder}}" id="phone-number" name="phone-number" ng-model="trialExpiredCtrl.extensionFormData.phoneNumber">\n          <label for="anything-else" class="c-paragraph-2">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.AnythingElse.Heading}}</label>\n          <textarea name="anything-else" id="anything-else" ng-model="trialExpiredCtrl.extensionFormData.additionalComments"></textarea>\n          <div class="buttons">\n              <button type="button" class="c-button" ng-click="trialExpiredCtrl.hideExtendTrialDialog()">{{::trialExpiredCtrl.clientResources.Common.Cancel}}</button>\n              <button class="c-button btn-primary" type="submit" ng-disabled="this.trialExpiredCtrl.extendingTrial">{{::trialExpiredCtrl.clientResources.TrialExpired.ExtendTrial.Buttons.Extend}}</button>\n          </div>\n      </form>\n  </div>\n</section>\n<section class="c-dialog trial-extended-dialog" ng-show="this.trialExpiredCtrl.shouldShowTrialExtendedDialog">\n  <div role="presentation" tabindex="-1" data-js-dialog-hide></div>\n  <div role="dialog" tabindex="-1" class="">\n      <div class="empty-space">\n        <img ng-src="{{::trialExpiredCtrl.assetService.banners.signIn}}" alt="" />\n      </div>\n      <div class="content">\n          <img svg-src="{{::trialExpiredCtrl.confirmationCheckIcon}}" alt="">\n          <p class="c-heading-3">{{::trialExpiredCtrl.clientResources.TrialExpired.TrialExtended.Message}}</p>\n          <button class="c-button btn-primary" ng-disabled="this.trialExpiredCtrl.extendingTrial" ng-click="this.trialExpiredCtrl.redirectBack()">{{::trialExpiredCtrl.clientResources.Common.Next}}</button>\n      </div>\n  </div>\n</section>'},33512:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33335),n=i(33327),o=i(33513);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33514);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33515),this.controller=o.a,this.controllerAs="invokeFlowPageCtrl"}));r.a.component(n.a.components.invokeFlow.invokeFlowPage,new c)},33513:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(33327),n=i(33394),o=i(33392),a=i(33360),s=i(33396),l=i(33383),c=i(33354),u=i(14900),d=i(14835),p=i(33384),h=i(16926);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=function(){function e(t,i,r,n,o,a,c,u,d,p,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$routeParams=i,this.appSettings=r,this.clientResources=n,this.flowRolesClient=o,this.flowsClient=a,this.loggingService=c,this.navigationService=u,this.routeCrafter=d,this.environmentService=p,this.assetService=m,this.inputData=void 0,this.flowName=void 0,this.flowId=void 0,this.spinner=void 0,this.fullPageErrorModel=void 0,this.getFlowErrorCode=void 0,this.requestRunOnlyAccessHeader=void 0,this.requestRunOnlyAccessSubHeader=void 0,this.requestRunOnlyAccessShowButton=void 0,this.handleCancel=e=>{Object(h.s)(e)?this.navigateToTeamFlowsPage():this.navigateToMyFlowsPage()},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"InvokeFlowPageCtrl"}),this.flowName=i.flowName||null,this.flowId=Object(s.b)(this.flowName,this.environmentService),this.inputData={flowId:this.flowId},this.fullPageErrorModel={image:this.assetService.fullPageErrorDebugFlow,isPageErrored:!1,pageTitle:this.clientResources.ErrorPageTitle.RunFlow},this.spinner={size:l.c.Large,show:!0,local:l.a.Local},this.requestRunOnlyAccessHeader=this.clientResources.RequestFlowAccess.RunPermissionMessage,this.requestRunOnlyAccessShowButton=!0,this.loadPage()}var t,i,r;return t=e,(i=[{key:"loadPage",value:function(){var e=this.loggingService.profilePageStart(c.a.invokeFlowPageLoadStart,{flowName:this.flowName});this.spinner.show=!0;var t=this.flowsClient.get(this.$scope,{id:this.inputData.flowId});return t.$promise.then(()=>{if(!Object(d.W)(t))throw new n.b(n.c.flowNotRunnable,Object(a.d)(this.clientResources.RunFlow.FlowNotRunnable,t.properties.displayName),null,{flowName:t.name});this.loggingService.profileEndWithSuccess(e,c.a.invokeFlowPageLoadEnd,{flowName:t.name})}).catch(t=>{var i=t&&403===t.status?o.a.Warning:Object(o.b)(t);this.loggingService.profileEnd(e,c.a.invokeFlowPageLoadEnd,i,t,{flowName:this.flowName}),Object(p.b)(this.fullPageErrorModel,t),this.getFlowErrorCode=t.status}).finally(()=>{this.spinner.show=!1})}},{key:"navigateToMyFlowsPage",value:function(){this.navigationService.navigate(Object(u.t)(this.routeCrafter))}},{key:"navigateToTeamFlowsPage",value:function(){this.navigationService.navigate(Object(u.v)(this.routeCrafter))}},{key:"showRequestAccessPage",value:function(){return this.fullPageErrorModel.isPageErrored&&403===this.getFlowErrorCode&&this.fullPageErrorModel.error&&(Object(o.d)(this.fullPageErrorModel.error)===n.c.ConnectionAuthorizationFailed||Object(o.d)(this.fullPageErrorModel.error)===n.c.InsufficientCdsPermissions)}},{key:"showErrorPage",value:function(){return!this.showRequestAccessPage()}},{key:"requestRunOnlyAccess",value:function(){var e=this.loggingService.profileStart(c.a.requestRunOnlyAccessStart,{flowName:this.flowName});return this.flowRolesClient.requestAccess({flowName:this.flowName}).then(()=>{this.loggingService.profileEndWithSuccess(e,c.a.requestRunOnlyAccessEnd,{flowName:this.flowName}),this.requestRunOnlyAccessShowButton=!1,this.requestRunOnlyAccessHeader=this.clientResources.RequestFlowAccess.ConfirmationMessage}).catch(t=>{this.loggingService.profileEnd(e,c.a.requestRunOnlyAccessEnd,o.a.Failure,t,{flowName:this.flowName}),this.requestRunOnlyAccessShowButton=!1,this.requestRunOnlyAccessHeader=this.clientResources.RequestFlowAccess.ErrorMessage,this.requestRunOnlyAccessSubHeader=Object(o.e)(t)})}}])&&m(t.prototype,i),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();f.$inject=[r.a.services.$scope,r.a.services.$routeParams,r.a.services.appSettings,r.a.services.clientResources,r.a.services.flowRolesClient,r.a.services.flowsClient,r.a.services.logging,r.a.services.navigation,r.a.services.routeCrafter,r.a.services.environment,r.a.services.assetService]},33514:function(e,t,i){e.exports=i.p+"static/media/invokeFlowPage.f3f6c338.less"},33515:function(e,t){e.exports='<div class="invoke-flow-page">\n    <div class="modal-spinner-container" ng-if="invokeFlowPageCtrl.spinner.show">\n        <spinner model="invokeFlowPageCtrl.spinner"></spinner>\n    </div>\n    <div class="row">\n        <invoke-flow-form\n            ng-if="!invokeFlowPageCtrl.fullPageErrorModel.isPageErrored && !invokeFlowPageCtrl.spinner.show"\n            input-data="invokeFlowPageCtrl.inputData"\n            on-cancel="invokeFlowPageCtrl.handleCancel"\n            on-done="invokeFlowPageCtrl.handleCancel">\n        </invoke-flow-form>\n    </div>\n    <full-page-single-action\n        ng-if="invokeFlowPageCtrl.showRequestAccessPage()"\n        header="invokeFlowPageCtrl.requestRunOnlyAccessHeader"\n        sub-header="invokeFlowPageCtrl.requestRunOnlyAccessSubHeader"\n        button-text="invokeFlowPageCtrl.clientResources.RequestFlowAccess.Button.Text"\n        render-button="invokeFlowPageCtrl.requestRunOnlyAccessShowButton"\n        on-click="invokeFlowPageCtrl.requestRunOnlyAccess()">\n    </full-page-single-action>\n</div>\n<full-page-error model="invokeFlowPageCtrl.fullPageErrorModel" ng-if="invokeFlowPageCtrl.showErrorPage()"></full-page-error>'},33516:function(e,t,i){"use strict";var r=i(33326),n=i(22327),o=i(33327);r.a.run([o.a.services.authentication,e=>{Object(n.a)()}])},33517:function(e,t,i){"use strict";i(33518),i(33522),i(33529),i(33535)},33518:function(e,t,i){"use strict";i(33519)},33519:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33520);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33521),this.controller=o.a,this.controllerAs="zeroCustomApisCtrl"}));n.a.component(r.a.components.zeroCustomApis,new c)},33520:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function o(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=o((function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.assetService=i,this.loggingService=r,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ZeroCustomApisCtrl"})}));s.$inject=[r.a.services.clientResources,r.a.services.assetService,r.a.services.logging]},33521:function(e,t){e.exports='<div class="context-zero-custom-apis">\n    <div class="row top-align">\n        <div class="x-type-center">\n            <img class="zero-custom-api-image" src="{{zeroCustomApisCtrl.assetService.apisCustomApi}}" alt="{{::zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.Image.Alt}}" />\n        </div>\n    </div>\n    <div class="row">\n        <div class="column x-type-center">\n            <h4>{{::zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.header}}</h4>\n            <div class="column medium-8 medium-offset-2 custom-api-text-inline">\n                <p>\n                    {{::zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.text}}\n                    <learn-more\n                        resource="\'Manage.CustomConnections.ZeroCustomApis.hyperlink\'"\n                        text="::zeroCustomApisCtrl.clientResources.Manage.CustomConnections.ZeroCustomApis.learnMore"\n                    ></learn-more>\n                </p>\n            </div>\n        </div>\n    </div>\n</div>'},33522:function(e,t,i){"use strict";i(33346),i(33523),i(33524),i(33526),i(33527)},33523:function(e,t,i){"use strict";var r=i(33328),n=i(33327),o=i(13031);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.appSettings=r}var t,i,r;return t=e,(i=[{key:"listSubscriptions",value:function(){var e=Object(o.a)("{0}/subscriptions?api-version={1}",this.appSettings.azureResourceManagementUri,"2018-11-01");return this.$http.get(e).then(e=>e.data)}},{key:"listSubscriptionResources",value:function(e){var t=Object(o.a)("{0}/{1}/resources?$filter=resourceType eq '{2}'&api-version={3}",this.appSettings.azureResourceManagementUri,e.subscriptionId,e.resourceType,"2018-11-01");return this.$http.get(t).then(e=>e.data)}},{key:"listApiManagementApis",value:function(e){var t=Object(o.a)("{0}{1}/apis?api-version={2}",this.appSettings.azureResourceManagementUri,e,"2018-01-01");return this.$http.get(t).then(e=>e.data)}},{key:"getResourceSiteConfig",value:function(e){var t=Object(o.a)("{0}/{1}/config?api-version={2}",this.appSettings.azureResourceManagementUri,e.resourceId,"2018-11-01");return this.$http.get(t).then(e=>e.data)}},{key:"getLogicAppsSwagger",value:function(e){var t=Object(o.a)("{0}{1}/listSwagger?api-version={2}",this.appSettings.azureResourceManagementUri,e,"2018-07-01-preview");return this.$http.post(t,null).then(e=>e.data)}},{key:"getApiManagementApiSwagger",value:function(e){var t=Object(o.a)("{0}{1}?format=swagger&export=true&api-version={2}",this.appSettings.azureResourceManagementUri,e,"2018-01-01");return this.$http.get(t,null).then(e=>e.data)}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.appSettings],r.a.factory(n.a.services.apisClientARM,[n.a.services.$http,n.a.services.$q,n.a.services.appSettings,(e,t,i)=>new l(e,t,i)])},33524:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33328),n=i(33327),o=i(33525),a=i(13031);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c="https://raw.githubusercontent.com/microsoft/PowerPlatformConnectors/{0}/{1}/{2}",u="script.csx",d=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.appSettings=r}var t,i,r;return t=e,(i=[{key:"listDirectoryContents",value:function(e,t){var i={headers:{},params:{}};i.headers[o.a]=o.a,i.params.ref=t;var r=Object(a.a)("https://api.github.com/repos/microsoft/PowerPlatformConnectors/contents/{0}",e);return this.$http.get(r,i).then(e=>e.data)}},{key:"getSwaggerFile",value:function(e,t){var i={headers:{}};i.headers[o.a]=o.a;var r=Object(a.a)(c,e,t,"apiDefinition.swagger.json");return this.$http.get(r,i).then(e=>e.data)}},{key:"getApiProperties",value:function(e,t){var i={headers:{}};i.headers[o.a]=o.a;var r=Object(a.a)(c,e,t,"apiProperties.json");return this.$http.get(r,i).then(e=>e.data)}},{key:"getCodeFile",value:function(e,t){var i={headers:{},responseType:"blob"};i.headers[o.a]=o.a;var r=Object(a.a)(c,e,t,u);return this.$http.get(r,i).then(e=>e.data)}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.appSettings],r.a.factory(n.a.services.apisClientGithub,[n.a.services.$http,n.a.services.$q,n.a.services.appSettings,(e,t,i)=>new d(e,t,i)])},33525:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(33327),n=i(33338),o="CustomApiSwaggerUrlRequest";n.a.factory(r.a.interceptors.removeHeadersInterceptor,[()=>({request:e=>(e&&e.headers&&e.headers[o]&&(e.headers={}),e)})])},33526:function(e,t,i){"use strict";var r=i(33328),n=i(33327),o=i(13031);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l="{0}/subscriptions/{1}/resourceGroups/{2}/providers/Microsoft.Web/customApis/{3}?api-version={4}",c=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.appSettings=r}var t,i,r;return t=e,(i=[{key:"get",value:function(e){var t=Object(o.a)(l,this.appSettings.azureResourceManagementUri,e.subscriptionId,e.resourceGroupName,e.customApiName,e.apiVersion);return this.$http.get(t).then(e=>e.data).catch(e=>this.$q.reject(e))}},{key:"put",value:function(e,t){var i=Object(o.a)(l,this.appSettings.azureResourceManagementUri,e.subscriptionId,e.resourceGroupName,e.customApiName,e.apiVersion);return this.$http.put(i,t).then(e=>e.data).catch(e=>this.$q.reject(e))}},{key:"listWsdlServices",value:function(e,t,i){var r=Object(o.a)("{0}/subscriptions/{1}/providers/Microsoft.Web/locations/{2}/listWsdlInterfaces?api-version={3}",this.appSettings.azureResourceManagementUri,e.subscriptionId,t,e.apiVersion);return this.$http.post(r,i).then(e=>e.data)}},{key:"extractSwaggerFromWsdl",value:function(e,t,i){var r=Object(o.a)("{0}/subscriptions/{1}/providers/Microsoft.Web/locations/{2}/extractApiDefinitionFromWsdl?api-version={3}",this.appSettings.azureResourceManagementUri,e.subscriptionId,t,e.apiVersion);return this.$http.post(r,i).then(e=>e.data)}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.appSettings],r.a.factory(n.a.services.apisClientLA,[n.a.services.$http,n.a.services.$q,n.a.services.appSettings,(e,t,i)=>new c(e,t,i)])},33527:function(e,t,i){"use strict";i.d(t,"d",(function(){return g})),i.d(t,"f",(function(){return f})),i.d(t,"i",(function(){return v})),i.d(t,"j",(function(){return b})),i.d(t,"k",(function(){return y})),i.d(t,"a",(function(){return w})),i.d(t,"g",(function(){return S})),i.d(t,"h",(function(){return C})),i.d(t,"c",(function(){return k})),i.d(t,"b",(function(){return P})),i.d(t,"e",(function(){return x}));var r=i(11891),n=i(33328),o=i(31433),a=i(33408),s=i(33327),l=i(33528),c=i(33349),u=i(13144),d=i(33360),p=i(33350),h={urlPath:"".concat(Object(o.a)().powerAppsResourceProviderPath,"/permissions"),resourceType:"".concat(Object(o.a)().powerAppsResourceProviderPath,"/permissions")},m={evictionDelay:3e5};function g(e,t){var i=e.filter(e=>r.a(e.properties.principal.id,t));return Object(d.n)(i)?null:i[0]}function f(e){return!(!e||!e.length)&&e.some(e=>r.a(e.properties.principal.type,l.a.Group))}function v(e){return!(!e||!e.properties)&&r.a(e.properties.roleName,l.b.Owner)}function b(e){return!(!e||!e.properties)&&(r.a(e.properties.roleName,l.b.CanView)||r.a(e.properties.roleName,l.b.CanViewWithShare))}function y(e){return!(!e||!e.properties)&&r.a(e.properties.roleName,l.b.CanViewWithShare)}function w(e){return!(!e||!e.properties)&&!r.a(e.properties.roleName,l.b.CanView)}function S(e){return!(!e||!e.properties)&&C(e.properties.principal.type)}function C(e){return r.a(e,l.a.Tenant)}function k(e){return e.filter(e=>!!e.properties.principal.id&&!S(e)).map(e=>e.properties.principal.id)}function P(e){return function(e){if(e&&e.length>0){var t=e[0];return e.forEach(e=>{e.priority<t.priority&&(t=e)}),t}return null}(x(e))}function x(e){return[l.b.CanView,l.b.CanViewWithShare,l.b.CanEdit,l.b.Owner].map(t=>Object(c.b)(t,e))}n.a.factory(s.a.services.permissionsClient,[s.a.services.appSettings,s.a.services.azureResourceClientFactory,s.a.services.environment,(e,t,i)=>{var r="".concat(e.powerAppsResourceProviderPath,"/apis/:apiName/permissions"),n="".concat(e.powerAppsResourceProviderPath,"/apis/:apiName/modifyPermissions"),o=Object(p.a)();return t({urlBase:Object(u.c)(e).powerAppsRP,urlPath:r,apiVersion:e.powerAppsResourceProviderApiVersionWithEnvironments,resourceType:h.resourceType,rest:{post:{params:Object(a.a)({},!0,i.getCurrentEnvironmentName()),requestInterceptor:o},query:{responseInterceptor:e=>e.data,params:Object(a.a)({},!0,i.getCurrentEnvironmentName()),requestInterceptor:o}},actions:[{name:"modify",urlPath:n,method:"POST",requestInterceptor:o}],options:{atomize:!1,evictionDelay:m.evictionDelay}})}])},33528:function(e,t,i){"use strict";var r=i(33348);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b}))},33529:function(e,t,i){"use strict";i(33530)},33530:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33531);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.restrict="E",this.template=i(33534),this.scope={model:"=",onAddConnection:"&",onClickUpdate:"&"},this.controller=o.a,this.controllerAs="controller"}));r.a.directive(n.a.directives.apiList,[()=>new c])},33531:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var r=i(33279),n=i(33299),o=i(33347),a=i(33353),s=i(13085),l=i(13240),c=i(13009),u=i(13015),d=i(11804),p=i(33327),h=i(33381),m=i(13031),g=i(14898),f=i(13272),v=i(33382),b=i(18959),y=i(17914),w=i(14901),S=i(13016),C=i(20342),k=i(33532),P=i(33533);function x(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,A(r.key),r)}}function A(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var T=function(){function e(t,i,r,n,o,a,s,c,u,d,p,h,m,g){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.assetService=i,this.clientResources=r,this.connectionHelper=n,this.customApiHelperService=o,this.customConnectorUrlService=a,this.$document=s,this.hostCommunicationService=c,this.loggingService=u,this.navigationService=d,this.routeCrafter=p,this.telemetryService=h,this.widgetUtilService=m,this.appSettings=g,this.hideCommandsInDropDown=!1,this.showConfirmDelete=!1,this.commandsButtonId="api-list-commands-button-id",this.connectionUrl="/Content/Images/Common/connection.svg",this.isPerfImprovementEnabled=!1,this.showMoreActionsMenuIndex=void 0,this.commandsInDropDown=void 0,this.moreActionMenuButtonClicked=!1,this.selectedRow=void 0,this.AddIcon=void 0,this.DeleteIcon=void 0,this.DownloadIcon=void 0,this.EditIcon=void 0,this.InfoIcon=void 0,this.MoreIcon=void 0,this.PeopleRepeatIcon=void 0,this.UploadIcon=void 0,this.apiToDelete=void 0,this.messageBarType=S.c,this.bannerText=void 0,this.connectorsUsingSharedRedirectUrl=void 0,this.bannerLearnMoreLink=void 0,this.$onInit=()=>{Object(P.a)()&&this.registerCloseOnClickOutsidePane()},this.onConfirmDelete=()=>{var e=this.apiToDelete;this.apiToDelete=void 0,this.$scope.model.markedForDeletion.push(e),this.telemetryService.tagEvent(l.c.DeleteCustomApi,{type:"CustomApi"},{}),this.customApiHelperService.deleteApi(e).then(()=>{this.removeFromMarkedForDeletion(e)}).catch(()=>{this.removeFromMarkedForDeletion(e),this.$scope.model.rows=this.$scope.model.apis.filter(e=>!this.$scope.model.markedForDeletion.some(t=>t.id===e.id)).map(e=>this.convertApiToRow(e))}),this.$scope.model.rows=this.$scope.model.rows.filter(t=>t.id!==e.id)},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ApiListDirectiveCtrl"}),this.$scope.$watch("model.apis",e=>{this.$scope.model.rows=e.map(e=>this.convertApiToRow(e))}),this.$scope.$watch("model.rows",e=>{this.getConnectorsUsingSharedRedirectUrl()}),Object(k.a)()&&this.$scope.$watch(()=>document.getElementById(this.commandsButtonId),(e,t)=>{null!==t&&null!==e&&this.loggingService.logInfo("ApiListDirectiveCtrl loaded","Commands button component rendered.",{component:"ApiListDirectiveCtrl"})}),this.hideCommandsInDropDown=this.$scope.model.hideCommandsInDropDown,this.bannerLearnMoreLink={href:this.clientResources.Manage.Connection.UniqueRedirectUrlBanner.LearnMore.Hyperlink,ariaLabel:this.clientResources.Manage.Connection.UniqueRedirectUrlBanner.LearnMore.AriaLabel},this.AddIcon=this.assetService.add,this.DeleteIcon=this.assetService.deleteIcon,this.DownloadIcon=this.assetService.download,this.EditIcon=this.assetService.editPencil,this.InfoIcon=this.assetService.info,this.MoreIcon=this.assetService.more,this.PeopleRepeatIcon=this.assetService.peopleRepeat,this.UploadIcon=this.assetService.upload,this.isPerfImprovementEnabled=Object(P.a)()}var t,i,p;return t=e,(i=[{key:"registerCloseOnClickOutsidePane",value:function(){var e=e=>{this.moreActionMenuButtonClicked||(this.showMoreActionsMenuIndex=-1),this.moreActionMenuButtonClicked=!1};this.$document.on("click",e),this.$scope.$on("$destroy",()=>{this.$document.off("click",e)})}},{key:"showErrorAlert",value:function(e){this.$scope.model.statusAlert.type=a.a.Error,this.$scope.model.statusAlert.message=e}},{key:"hideErrorAlert",value:function(){this.$scope.model.statusAlert.type=a.a.None,this.$scope.model.statusAlert.message=""}},{key:"getConnectorsUsingSharedRedirectUrl",value:function(){this.connectorsUsingSharedRedirectUrl=this.$scope.model.rows.filter(e=>(null==e?void 0:e.api)&&o.y(e.api)&&e.redirectMode!==C.g.GlobalPerConnector),this.connectorsUsingSharedRedirectUrl.length>10?this.bannerText=Object(m.a)(this.clientResources.Manage.Connection.UniqueRedirectUrlBanner.ConnecterNumberBannerText,this.connectorsUsingSharedRedirectUrl.length):this.bannerText=Object(m.a)(this.clientResources.Manage.Connection.UniqueRedirectUrlBanner.ConnecterNameBannerText,this.connectorsUsingSharedRedirectUrl.map(e=>" "+e.name).toString())}},{key:"convertApiToRow",value:function(e){var t,i,r=this.$scope.model.apiType===v.a.Default?this.defaultCommands(e):this.customCommands(e),n=this.customCommandsInDropdown(e);return{name:o.h(e),id:e.id,imageUrl:o.k(e,this.assetService),publisher:o.p(e,this.clientResources),api:e,commands:r,commandsInDropDown:n,allCommands:r.concat(n),redirectMode:null===(t=e.properties)||void 0===t||null===(t=t.connectionParameters)||void 0===t||null===(t=t.token)||void 0===t||null===(t=t.oAuthSettings)||void 0===t?void 0:t.redirectMode,imageBgColor:null===(i=e.properties)||void 0===i?void 0:i.iconBrandColor}}},{key:"defaultCommands",value:function(e){return[{text:this.clientResources.Manage.Connections.CreateToolTip,iconName:this.isPerfImprovementEnabled?this.AddIcon:f.a.Add,click:()=>this.openAddConnection(e,Object(w.d)(this.routeCrafter))}]}},{key:"customCommandsInDropdown",value:function(e){var t=o.a(e,this.clientResources),i=o.b(e,this.clientResources);return[{text:this.clientResources.Manage.Apis.PropertiesConnectionToolTip,iconName:this.isPerfImprovementEnabled?this.InfoIcon:f.a.Info,click:()=>this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDetailsTab(e.name,y.b.details)),name:"custom-dropdown-info"},{text:this.clientResources.Manage.Apis.ShareConnectionToolTip,iconName:this.isPerfImprovementEnabled?this.PeopleRepeatIcon:f.a.PeopleRepeat,click:()=>this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDetailsTab(e.name,y.b.share)),name:"custom-dropdown-owners",disabled:!1===i},{text:this.clientResources.Manage.Apis.Update.OpenApiFile,iconName:this.isPerfImprovementEnabled?this.UploadIcon:f.a.Upload,click:()=>this.$scope.onClickUpdate({dialogMode:h.a.OpenApiFile,api:e}),name:"custom-dropdown-uploadfromopenapifile",disabled:!1===t},{text:this.clientResources.Manage.Apis.Update.OpenApiUrl,iconName:this.isPerfImprovementEnabled?this.UploadIcon:f.a.Upload,click:()=>this.$scope.onClickUpdate({dialogMode:h.a.OpenApiUrl,api:e}),name:"custom-dropdown-uploadfromopenapiurl",disabled:!1===t},{text:this.clientResources.Manage.Apis.Update.Postman,iconName:this.isPerfImprovementEnabled?this.UploadIcon:f.a.Upload,click:()=>this.$scope.onClickUpdate({dialogMode:h.a.Postman,api:e}),name:"custom-dropdown-uploadfrompostman",disabled:!1===t},{text:this.clientResources.Manage.Apis.Update.Github,iconName:this.isPerfImprovementEnabled?this.UploadIcon:f.a.Upload,click:()=>this.$scope.onClickUpdate({dialogMode:h.a.Github,api:e}),name:"custom-dropdown-uploadfromgithub",disabled:!1===t},{text:this.clientResources.Manage.Apis.DeleteToolTip,iconName:this.isPerfImprovementEnabled?this.DeleteIcon:f.a.Delete,click:()=>this.deleteApi(e),name:"custom-dropdown-delete",disabled:!1===t}]}},{key:"customCommands",value:function(e){var t=[];if(t.push({text:this.clientResources.Manage.Apis.CreateConnectionToolTip,iconName:this.isPerfImprovementEnabled?this.AddIcon:f.a.Add,click:()=>this.openAddConnection(e,Object(w.d)(this.routeCrafter)),name:"custom-create"}),this.$scope.model.apiType===v.a.Custom){var i=o.n(e);t.push({text:this.clientResources.Manage.Apis.DownloadToolTip,iconName:this.isPerfImprovementEnabled?this.DownloadIcon:f.a.Download,disabled:!i,click:()=>this.downloadCustomApi(e,i),name:"custom-download"})}return t.push({text:this.clientResources.Manage.Apis.EditToolTip,iconName:this.isPerfImprovementEnabled?this.EditIcon:f.a.Edit,click:()=>{this.telemetryService.tagEvent(l.c.EditCustomApi,{type:"CustomApi"},{}),this.navigationService.navigate(this.customConnectorUrlService.getDefaultEditCustomApisUrl(e.name))},name:"custom-edit",disabled:!1===o.a(e,this.clientResources)}),t}},{key:"onMoreCommandsButtonClicked",value:function(e,t,i){var r,n,o=document.getElementById("MoreActionsMenuId");if(o){var a=o.getBoundingClientRect(),s=Math.min(e.pageX,window.innerWidth-(a.width>0?a.width:243)),l=Math.min(e.pageY,window.innerHeight-(a.height>0?a.height:252));o.style.left="".concat(s,"px"),o.style.top="".concat(l,"px")}this.showMoreActionsMenuIndex=t,this.selectedRow=t>=0?this.$scope.model.rows[t]:null,this.commandsInDropDown=i?null===(r=this.selectedRow)||void 0===r?void 0:r.allCommands:null===(n=this.selectedRow)||void 0===n?void 0:n.commandsInDropDown,this.moreActionMenuButtonClicked=!0}},{key:"onClickRow",value:function(e){this.$scope.model.apiType===v.a.Default?this.openAddConnection(e.api,Object(w.d)(this.routeCrafter)):this.$scope.model.apiType===v.a.Custom&&this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDetailsTab(e.api.name,y.b.details))}},{key:"deleteApi",value:function(e){this.widgetUtilService.isWidgetPage()?(this.telemetryService.tagEvent(l.c.DeleteCustomApiDeferredToHost,{type:"CustomApi"},{}),this.hostCommunicationService.triggerHostEvent(d.e.ON_DELETE_CUSTOMAPI_CLICKED,{apiName:e.name})):(this.apiToDelete=e,this.showConfirmDelete=!0)}},{key:"downloadCustomApi",value:function(e,t){var i=window.document.createElement("a");this.telemetryService.tagEvent(l.c.DownloadCustomApi,{type:"CustomApi"},{});var n=this.loggingService.profileStart(s.a.myCustomApiDownloadStart);this.customApiHelperService.getSwaggerFromUrl(t).then(t=>{var o=new Blob([r.toJson(t,!0)],{type:"application/json"}),a="".concat(Object(g.a)(e.properties.displayName,!0),".swagger.json");navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(o,a):(i.download=a,i.href=window.URL.createObjectURL(o),document.body.appendChild(i),i.click()),this.loggingService.profileEndWithSuccess(n,s.a.myCustomApiDownloadEnd)}).catch(e=>{alert(this.clientResources.Manage.CustomApi.OriginalSwagger.DownloadError),this.loggingService.profileEnd(n,s.a.myCustomApiDownloadEnd,Object(c.y)(e),e)}).finally(()=>{document.body.removeChild(i)})}},{key:"removeFromMarkedForDeletion",value:function(e){this.$scope.model.markedForDeletion=this.$scope.model.markedForDeletion.filter(t=>t.id!==e.id)}},{key:"openAddConnection",value:function(e,t){if(this.hideErrorAlert(),this.widgetUtilService.isWidgetPage())this.hostCommunicationService.triggerHostEvent(d.e.ON_ADD_CONNECTION_CLICKED,{apiName:e.name});else{o.y(e)&&!o.x(e)||(this.$scope.model.onLoading=!0,this.$scope.onAddConnection()),this.telemetryService.tagEvent(l.c.CreateConnectionStarted,{type:this.$scope.model.apiType===v.a.Default?"DefaultApi":"CustomApi"},{});var i=o.w(e);if(o.u(e)||i)this.navigationService.navigate(Object(w.A)(this.routeCrafter,e.name));else{var r=Object(n.e)(),a=Object(b.e)(e.name,r);this.connectionHelper.addConnection(e,a).then(e=>this.connectionHelper.testConnection(e)).then(()=>this.navigationService.navigate(t)).catch(e=>{this.loggingService.logError("ApiListDirectiveCtrl.OpenAddConnection",e);var t=Object(u.o)(e,this.clientResources.Common.SomethingWentWrong);this.showErrorAlert(t)}).finally(()=>{this.$scope.model.onLoading=!1,this.$scope.onAddConnection()})}}}},{key:"getIconAriaLabel",value:function(e){return Object(m.a)(this.clientResources.Manage.CustomConnector.Icon.AriaLabel,e)}},{key:"getImageSrc",value:function(e,t){var i=document.getElementById("img-".concat(t));if(i){var r=t=>{i.removeEventListener("error",r),i.onerror=null,e=this.connectionUrl,t.stopImmediatePropagation()};i.addEventListener("error",r)}return e||this.connectionUrl}},{key:"getPublishedByAriaLabel",value:function(e){return Object(m.a)(this.clientResources.Manage.CustomConnector.Publisher.AriaLabel,e)}},{key:"asMenuProps",value:function(e){return{items:e.map(e=>({onClick:()=>e.click(),key:e.name,iconProps:{iconName:e.iconName},text:e.text,disabled:e.disabled}))}}},{key:"menuIconProps",get:function(){return{iconName:f.a.More}}},{key:"moreText",get:function(){return this.clientResources.ListCommands.More}}])&&x(t.prototype,i),p&&x(t,p),Object.defineProperty(t,"prototype",{writable:!1}),e}();T.$inject=[p.a.services.$scope,p.a.services.assetService,p.a.services.clientResources,p.a.services.connectionHelper,p.a.services.customApiHelper,p.a.services.customConnectorUrlService,p.a.services.$document,p.a.services.hostCommunicationService,p.a.services.logging,p.a.services.navigation,p.a.services.routeCrafter,p.a.services.telemetry,p.a.services.widgetUtilService,p.a.services.appSettings]},33532:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.EcosystemsAndExperience,owners:["jianblu"],description:"ECS feature to enable logging for Custom Connectors list rendered.",ecsURL:"https://ecs.skype.com/PowerAutomate/EcosystemsAndExperience/configurations/1174403",createdOn:"12/13/2023",fallback:{enableCustomConnectorsLoggingForListRendered:!1}}),{getFeatureValue:a}=Object(n.b)(o,e=>!!e.enableCustomConnectorsLoggingForListRendered)},33533:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.EcosystemsAndExperience,owners:["jianblu"],description:"ECS feature to enable the performance improvement for Custom Connectors list.",ecsURL:"https://ecs.skype.com/PowerAutomate/EcosystemsAndExperience/configurations/1176368",createdOn:"12/21/2023",fallback:{enablePerfImprovementForCustomConnectorsList:!1}}),{getFeatureValue:a}=Object(n.b)(o,e=>!!e.enablePerfImprovementForCustomConnectorsList)},33534:function(e,t){e.exports='<div class="c-table">\n    <table role="table" ng-show="model.rows.length > 0">\n        <thead role="rowgroup">\n            <tr role="row">\n                <th role="columnheader">{{controller.clientResources.ListHeader.Icon}}</th>\n                <th role="columnheader">{{controller.clientResources.Manage.Connection.Header.Name}}</th>\n                <th role="columnheader">{{controller.clientResources.ListHeader.Actions}}</th>\n            </tr>\n        </thead>\n        <div ng-if="controller.connectorsUsingSharedRedirectUrl.length">\n            <react-text-message-bar-with-link\n                type="controller.messageBarType.warning"\n                message="controller.bannerText"\n                labelLink="controller.bannerLearnMoreLink">\n            </react-text-message-bar-with-link>\n        </div>\n        <div id="MoreActionsMenuId" ng-if="controller.isPerfImprovementEnabled" ng-show="controller.showMoreActionsMenuIndex >= 0" ng-style="{ \'position\': \'fixed\', \'border\': \'2px\', \'z-index\': \'2147483647\', \'box-shadow\': \'rgba(0, 0, 0, 0.133) 0px 3.2px 7.2px 0px, rgba(0, 0, 0, 0.11) 0px 0.6px 1.8px 0px\' }">\n            <ul>\n                <li ng-repeat="command in controller.commandsInDropDown" ng-click="command.disabled || command.click()" ng-style="{ \'background\': (isHover && !command.disabled ? \'#F4F4F4\' : \'white\'), \'padding\': \'4px\', \'height\': \'36px\' }" ng-mouseenter="isHover = true;" ng-mouseleave="isHover = false;">\n                    <div data-test="{{command.name}}"\n                        ng-disabled="{{command.disabled}}"\n                        title="{{command.text}}">\n                        <img ng-if="command.iconName" svg-src="{{command.iconName}}" alt="{{command.name}}" role="presentation" ng-style="{ \'filter\': (command.disabled ? \'saturate(0%) invert(90%)\' : initial), \'max-width\': \'16px\', \'max-height\': \'16px\', \'margin\': \'4px\', \'display\': \'inline-block\'}"/>\n                        <span class="command-text" ng-class="{\'large-command-panel\': isLargeCommandPanel}" ng-style="{ \'color\': (command.disabled ? \'#A6A6A6\' : \'black\'), \'line-height\': \'normal\', \'vertical-align\': \'middle\', \'padding-right\': \'8px\'}">{{command.text}}</span>\n                    </div>\n                </li>\n            </ul>\n        </div>\n        <tbody class="api-list-tbody">\n            <tr ng-repeat="row in model.rows">\n                <td class="table-cell-image" ng-click="controller.onClickRow(row)" aria-hidden="true" tabindex="-1" role="presentation" aria-label="{{controller.getIconAriaLabel(row.name)}}">\n                    <img id="{{\'img-\'+ $index}}" ng-style="{\'background-color\': row.imageBgColor}" ng-attr-src="{{controller.getImageSrc(row.imageUrl, $index)}}" alt="{{controller.getIconAriaLabel(row.name)}}"/>\n                </td>\n                <td class="text-ellipse" ng-click="controller.onClickRow(row)" role="navigation" aria-labelledby="{{\'customConnectorRow-apiName\' + $index}}">\n                    <div class="table-cell-name-multiline" ng-attr-id="{{\'customConnectorRow-apiName\' + $index}}">\n                        <div class="apiName" aria-label="{{::row.name}}">{{::row.name}}</div>\n                        <div class="name connection-name-text" aria-label="{{controller.getPublishedByAriaLabel(row.publisher)}}">{{::row.publisher}}</div>\n                    </div>\n                </td>\n                <td class="hide-for-small-only pull-right">\n                    <div ng-if="controller.isPerfImprovementEnabled" class="context-glyph-tile" ng-style="{\'padding-top\': \'6px\'}">\n                        <button\n                            ng-repeat="command in row.commands"\n                            ng-disabled="command.disabled"\n                            ng-style="{\'background\': (isHover && !command.disabled ? \'#F4F4F4\' : \'transparent\'), border: \'none\'}"\n                            ng-click="command.click()"\n                            ng-mouseenter="isHover = true;"\n                            ng-mouseleave="isHover = false;"\n                            title="{{::command.text}}"\n                            alt="{{::command.text}}"\n                            aria-label="{{::command.text}}"\n                            data-test="{{::command.name}}">\n                            <img svg-src="{{command.iconName}}" alt="{{command.text}}" ng-style="{ \'filter\': \'brightness(0%)\', \'max-width\': \'24px\', \'max-height\': \'24px\', \'display\': \'inline-block\'}"/>\n                        </button>\n                        <button\n                            ng-style="{\'background\': (isHover ? \'#F4F4F4\' : \'transparent\'), border: \'none\' }"\n                            ng-if="!controller.hideCommandsInDropDown"\n                            ng-click="controller.onMoreCommandsButtonClicked($event, $index, false)"\n                            ng-mouseenter="isHover = true;"\n                            ng-mouseleave="isHover = false;"\n                            id="{{::controller.commandsButtonId}}"\n                            title="{{::controller.moreText}}">\n                            <img svg-src="{{controller.MoreIcon}}" alt="controller.moreText" />\n                        </button>\n                    </div>\n                    <div ng-if="!controller.isPerfImprovementEnabled" class="context-glyph-tile">\n                        <react-icon-button\n                            ng-repeat="command in row.commands"\n                            is-disabled="command.disabled"\n                            icon-name="command.iconName"\n                            class="command.iconUrl c-glyph command-button"\n                            react-title="::command.text"\n                            on-click="command.click"\n                            data-test="{{command.name}}">\n                        </react-icon-button>\n                        <react-icon-button\n                            class="command-item"\n                            id="{{::controller.commandsButtonId  + $index}}"\n                            ng-if="!controller.hideCommandsInDropDown"\n                            menu-props="controller.asMenuProps(row.commandsInDropDown)"\n                            menu-icon-props="controller.menuIconProps"\n                            react-title="controller.moreText">\n                        </react-icon-button>\n                    </div>\n                </td>\n                <td ng-if="controller.isPerfImprovementEnabled" class="column small-1 show-for-small-only">\n                    <button\n                        ng-style="{ background: \'transparent\', border: \'none\', \'height\': \'32px\' }"\n                        ng-if="!controller.hideCommandsInDropDown"\n                        ng-click="controller.onMoreCommandsButtonClicked($event, $index, true)"\n                        title="{{::controller.moreText}}">\n                        <img svg-src="{{controller.MoreIcon}}" alt="controller.moreText" />\n                    </button>\n                    <button\n                        ng-repeat="command in row.commands"\n                        ng-if="controller.hideCommandsInDropDown"\n                        ng-disabled="command.disabled"\n                        ng-style="{\'background\': (isHover && !command.disabled ? \'#F4F4F4\' : \'transparent\'), border: \'none\'}"\n                            ng-click="command.click()"\n                            ng-mouseenter="isHover = true;"\n                            ng-mouseleave="isHover = false;"\n                            title="{{::command.text}}"\n                            alt="{{::command.text}}"\n                            aria-label="{{::command.text}}"\n                            data-test="{{::command.name}}">\n                            <img svg-src="{{command.iconName}}" alt="{{command.text}}" ng-style="{ \'filter\': \'brightness(0%)\', \'max-width\': \'24px\', \'max-height\': \'24px\', \'display\': \'inline-block\'}"/>\n                    </button>\n                </td>\n                <td ng-if="!controller.isPerfImprovementEnabled" class="column small-1 show-for-small-only">\n                    <react-icon-button\n                        ng-if="!controller.hideCommandsInDropDown"\n                        menu-props="controller.asMenuProps(row.allCommands)"\n                        menu-icon-props="controller.menuIconProps"\n                        react-title="controller.moreText">\n                    </react-icon-button>\n                    <react-icon-button\n                        ng-repeat="command in row.commands"\n                        ng-if="controller.hideCommandsInDropDown"\n                        is-disabled="command.disabled"\n                        icon-name="command.iconName"\n                        class="command.iconUrl c-glyph command-button"\n                        react-title="::command.text"\n                        on-click="command.click"\n                        data-test="{{command.name}}">\n                    </react-icon-button>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <confirm-dialog\n        title="{{::controller.clientResources.Dialogs.DeleteApi.Title}}"\n        message="{{::controller.clientResources.Dialogs.DeleteApi.Message}}"\n        show="controller.showConfirmDelete"\n        on-confirm="controller.onConfirmDelete"></confirm-dialog>\n    <zero-custom-apis ng-show="model.rows.length === 0 && model.loaded === true"></zero-custom-apis>\n</div>'},33535:function(e,t,i){"use strict";i(33379)},33536:function(e,t,i){"use strict";i(33537),i(33558)},33537:function(e,t,i){"use strict";i(33538),i(33543),i(33547),i(33549),i(33554)},33538:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33539);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33541);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33542),this.bindings={approval:"<",approvalRequest:"<?",isSelected:"<",isDisabled:"<",onClick:"<",responseOptions:"<",responseOptionsType:"<"},this.controller=o.a,this.controllerAs="approvalCardCtrl"}));r.a.component(n.a.components.approvals.approvalCard,new c)},33539:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(33327),n=i(13240),o=i(26996),a=i(13031),s=i(20368),l=i(16884),c=i(17807),u=i(20936),d=i(12375),p=i(33540);function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g=function(){function e(t,i,r,a,s,d){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.assetService=i,this.clientResources=r,this.loggingService=a,this.routeCrafter=s,this.telemetryService=d,this.approval=void 0,this.approvalRequest=void 0,this.clockIconUrl=void 0,this.timerWhiteIconUrl=void 0,this.dropDownCommands=void 0,this.isSelected=void 0,this.isDisabled=void 0,this.isBasicApproveReject=void 0,this.approvalCardId=void 0,this.responseOptions=void 0,this.responseOptionsType=void 0,this.approveDisplayText=void 0,this.rejectDisplayText=void 0,this.respondDisplayText=void 0,this.facepilePersonaSize=l.c.medium,this.onClick=void 0,this.$onInit=()=>{this.approvalCardId=String(this.$scope.$id),this.isBasicApproveReject=!0,this.approveDisplayText=this.clientResources.Approvals.Actions.Approve,this.rejectDisplayText=this.clientResources.Approvals.Actions.Reject,this.respondDisplayText=this.clientResources.Approvals.Actions.RespondForCustomResponseOptions,this.dropDownCommands=[{text:this.approvalRequest?this.clientResources.Approvals.Actions.EmailRequester:this.clientResources.Approvals.Actions.EmailApprovers,iconUrl:"glyph-mail",click:()=>{this.telemetryService.tagEvent(n.c.ApprovalCardEmailClicked);var e={to:this.mailToAddresses};Object(p.a)(e)}}],this.approvalRequest&&this.dropDownCommands.push({text:this.clientResources.Approvals.Reassign,iconUrl:"glyph-test",disabled:!this.approvalRequest.properties.allowReassignment,click:e=>{this.telemetryService.tagEvent(n.c.ApprovalCardReassignClicked),this.onClick(e,this.approval.name,"Reassign")}}),this.responseOptionsType===o.a.BasicApproveReject&&this.responseOptions&&2===this.responseOptions.length?(this.approveDisplayText=this.responseOptions[0],this.rejectDisplayText=this.responseOptions[1]):this.responseOptionsType===o.a.CustomOptions&&(this.isBasicApproveReject=!1),this.dropDownCommands.push({text:this.clientResources.Approvals.Actions.CopyLink,iconUrl:"glyph-copy",click:()=>{this.telemetryService.tagEvent(n.c.ApprovalCardCopyLinkClicked);var e=this.approvalRequest?Object(c.h)(this.routeCrafter,this.approval.name,this.approvalRequest.name):Object(c.i)(this.routeCrafter,this.approval.name);Object(u.a)("".concat(window.location.origin).concat(e),this.loggingService)}})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ApprovalCardCtrl"}),this.clockIconUrl=this.assetService.clockGray,this.timerWhiteIconUrl=this.assetService.timerWhite}var t,i,r;return t=e,(i=[{key:"mailToAddresses",get:function(){return this.approvalRequest?this.approval.properties.owner.email:this.approval.properties.requestSummary.approvers.map(e=>e.email).join(";")}},{key:"hasOtherApprovers",get:function(){var e=this.approval.properties.requestSummary;return e.totalRequests>e.approvers.length}},{key:"localizedCreationDate",get:function(){return new Date(this.approval.properties.creationDate).toLocaleDateString(Object(d.a)(),{month:"short",day:"numeric"})}},{key:"otherApproversCount",get:function(){var e=this.approval.properties.requestSummary;return e.totalRequests-e.approvers.length}},{key:"principalNames",get:function(){if(!this.approvalRequest){var e=this.approval.properties.requestSummary.approvers.map(e=>e.displayName);return Object(a.a)(this.clientResources.Approvals.Owner.To,e.join(", "))}return this.approval.properties.owner.displayName?Object(a.a)(this.clientResources.Approvals.Owner.For,this.approval.properties.owner.displayName):Object(a.a)(this.clientResources.Approvals.Owner.For,this.clientResources.Approvals.Owner.Unknown)}},{key:"onCardClicked",value:function(e){Object(s.a)(document.getElementById("approval-list-commands-"+this.approvalCardId),e.target)||(this.telemetryService.tagEvent(n.c.ApprovalCardClicked),this.onClick(e,this.approval.name,"NotSpecified"))}}])&&h(t.prototype,i),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.$inject=[r.a.services.$scope,r.a.services.assetService,r.a.services.clientResources,r.a.services.logging,r.a.services.routeCrafter,r.a.services.telemetry]},33540:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=["to"];function n(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function o(e){var t=function(e){var{to:t}=e,i=n(e,r),o="mailto:".concat(t||""),a=Object.keys(i).filter(e=>!!i[e]).map(e=>"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(i[e]))).join("&");return a?[o,a].join("?"):o}(e);try{window.top.location.href=t}catch(i){window.open(t,"_blank")}}},33541:function(e,t,i){e.exports=i.p+"static/media/approvalCard.022467f9.less"},33542:function(e,t){e.exports='<div\n    class="disable-card-overlay"\n    ng-if="approvalCardCtrl.isSelected || approvalCardCtrl.isDisabled"\n    ng-class="{\'selected\': approvalCardCtrl.isSelected}">\n</div>\n<div\n    class="approval-card"\n    role="group"\n    aria-label="{{::approvalCardCtrl.approval.properties.title}}"\n    ng-class="{\'card-selected\' : approvalCardCtrl.isSelected}"\n    ng-click="approvalCardCtrl.onCardClicked($event)">\n    <div class="due-date">\n        <img ng-src="{{ approvalCardCtrl.clockIconUrl }}" alt="" role="presentation"/>\n        <span class="c-paragraph-3 c-glyph">{{ approvalCardCtrl.localizedCreationDate }}</span>\n    </div>\n    <div class="thumbnail-photos">\n        <react-persona\n            ng-if="approvalCardCtrl.approvalRequest"\n            text="approvalCardCtrl.approval.properties.owner.displayName"\n            image-url="approvalCardCtrl.approval.properties.owner.thumbnailPhoto"\n            size="approvalCardCtrl.thumbnailSize"\n            hide-details="true">\n        </react-persona>\n        <ul ng-if="!approvalCardCtrl.approvalRequest">\n            <li class="avatars-list-item" ng-repeat="approver in approvalCardCtrl.approval.properties.requestSummary.approvers">\n                <avatar\n                    mail="approver.email"\n                    display-name="approver.displayName"\n                    image-src="approver.thumbnailPhoto"\n                    object-id="approver.id">\n                </avatar>\n            </li>\n            <li class="avatars-list-item" ng-if="approvalCardCtrl.hasOtherApprovers">\n                <div class="grey-circle-count">\n                    +{{ approvalCardCtrl.otherApproversCount }}\n                </div>\n            </li>\n        </ul>\n    </div>\n    <p class="approver-names">{{ approvalCardCtrl.principalNames }}</p>\n    <p class="title">{{ approvalCardCtrl.approval.properties.title }}</p>\n    <div class="actions" ng-if="approvalCardCtrl.approvalRequest">\n        <button ng-if="approvalCardCtrl.isBasicApproveReject"\n                class="action-button c-action-trigger c-glyph glyph-checkmark"\n                ng-click="approvalCardCtrl.onClick($event, approvalCardCtrl.approval.name, \'Approve\')"\n                aria-label="{{::approvalCardCtrl.clientResources.Approvals.Actions.Approve}}"\n                data-event-name="ApprovalCardApproveClicked">\n                {{::approvalCardCtrl.clientResources.Approvals.Actions.Approve}}\n        </button>\n        <button ng-if="approvalCardCtrl.isBasicApproveReject"\n                class="action-button c-action-trigger c-glyph glyph-close"\n                ng-click="approvalCardCtrl.onClick($event, approvalCardCtrl.approval.name, \'Reject\')"\n                aria-label="{{::approvalCardCtrl.clientResources.Approvals.Actions.Reject}}"\n                data-event-name="ApprovalCardRejectClicked">\n                {{::approvalCardCtrl.clientResources.Approvals.Actions.Reject}}\n        </button>\n        <button ng-if="!approvalCardCtrl.isBasicApproveReject"\n                class="action-button c-action-trigger"\n                ng-click="approvalCardCtrl.onClick($event, approvalCardCtrl.approval.name, \'Respond\')"\n                aria-label="{{::approvalCardCtrl.respondDisplayText}}"\n                data-event-name="ApprovalCardRespondClicked">\n                <span class="respond-icon ms-Icon ms-Icon--Reply"></span>\n                {{::approvalCardCtrl.respondDisplayText }}\n        </button>\n        <list-commands\n            model="approvalCardCtrl.dropDownCommands"\n            id="approval-list-commands-{{::approvalCardCtrl.approvalCardId}}">\n        </list-commands>\n    </div>\n    <div class="actions" ng-if="!approvalCardCtrl.approvalRequest">\n        <img class="blue-circle" ng-src="{{ approvalCardCtrl.timerWhiteIconUrl }}"/>\n        <span class="status-text">{{ approvalCardCtrl.clientResources.Approvals.AwaitingResponse }}</span>\n        <list-commands\n            model="approvalCardCtrl.dropDownCommands"\n            id="approval-list-commands-{{::approvalCardCtrl.approvalCardId}}">\n        </list-commands>\n    </div>\n</div>\n'},33543:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33544);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33545);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33546),this.controller=o.a,this.controllerAs="firstDayApprovalsCtrl",this.bindings={nothingPendingText:"@"}}));n.a.component(r.a.components.approvals.firstDayApprovals,new c)},33544:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(33353),o=i(33383),a=i(17807),s=i(17827);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$sce=t,this.assetService=i,this.clientResources=r,this.routeCrafter=a,this.loggingService=s,this.oneClickApprovalFlowTemplatesSpinner={size:o.c.Large,show:!1,local:o.a.LocalHorizontal},this.oneClickApprovalFlowTemplatesHtml=void 0,this.errorAlert={type:n.a.None,message:"",options:{}},this.nothingPendingText=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FirstDayApprovalsCtrl"})}var t,i,r;return t=e,(i=[{key:"approvalsLearnMoreVideoLink",get:function(){return this.$sce.trustAsResourceUrl("https://www.youtube.com/embed/GATWcWulvgE?autoplay=1")}},{key:"createApprovalFlowLink",get:function(){return Object(a.g)(this.routeCrafter)}},{key:"approvalsLearnMoreRoute",get:function(){return this.$sce.trustAsResourceUrl(Object(s.b)())}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[r.a.services.$sce,r.a.services.assetService,r.a.services.clientResources,r.a.services.routeCrafter,r.a.services.logging]},33545:function(e,t,i){e.exports=i.p+"static/media/firstDayApprovals.96f35a6e.less"},33546:function(e,t){e.exports='\x3c!-- section class required for video player to size properly --\x3e\n<section class="first-day-approvals section hero-section">\n  <div class="first-day-approvals-content">\n      <div class="row">\n          <div class="column c-content medium-offset-2 medium-12 large-offset-1 large-6">\n                  <p class="c-paragraph-1">{{::firstDayApprovalsCtrl.nothingPendingText}}</p>\n              <h1 class="c-heading-6">{{::firstDayApprovalsCtrl.clientResources.Approvals.Zero.CreateFirstFlow}}</h1>\n              <p class="c-paragraph-1">{{::firstDayApprovalsCtrl.clientResources.Approvals.Zero.AddFlowOrTemplate}}</p>\n              <a class="learn-more-link"\n                  ng-href="{{::firstDayApprovalsCtrl.approvalsLearnMoreRoute}}"\n                  target="_blank"\n                  aria-label="{{::firstDayApprovalsCtrl.clientResources.Approvals.LearnMore}}"\n                  data-event-name="ApprovalsLearnMoreDocumentationClicked">\n                  {{::firstDayApprovalsCtrl.clientResources.Approvals.LearnMore}}\n              </a>\n              <div>\n                  <a class="c-button primary-button create-approval-button"\n                      role="button"\n                      aria-label="{{::firstDayApprovalsCtrl.clientResources.Approvals.CreateApprovalFlow}}"\n                      ng-href="{{::firstDayApprovalsCtrl.createApprovalFlowLink}}"\n                      data-event-name="ApprovalsCreateApprovalFlowHeroButtonClicked">\n                      {{::firstDayApprovalsCtrl.clientResources.Approvals.CreateApprovalFlow}}\n                  </a>\n                  <a class="c-button f-video-button c-action-trigger c-glyph glyph-play sd-playinsection"\n                      role="button"\n                      ng-href="{{::firstDayApprovalsCtrl.approvalsLearnMoreVideoLink}}"\n                      data-src="{{::firstDayApprovalsCtrl.approvalsLearnMoreVideoLink}}"\n                      data-event-name="ApprovalsLearnMoreVideoClicked"\n                      data-player="default"\n                      aria-label="{{::firstDayApprovalsCtrl.clientResources.Approvals.Zero.VideoButtonAriaLabel}}">\n                      {{::firstDayApprovalsCtrl.clientResources.Approvals.Zero.VideoButtonText}}\n                  </a>\n              </div>\n          </div>\n          <div class="column img-column medium-offset-2 medium-0 large-offset-0 large-6">\n              <img ng-src="{{::firstDayApprovalsCtrl.assetService.approvalsSplashArt}}" alt={{::firstDayApprovalsCtrl.clientResources.Approvals.Zero.CreateFirstFlow}} />\n          </div>\n      </div>\n  </div>\n</section>'},33547:function(e,t,i){"use strict";var r=i(33327),n=i(33548),o=i(33334),a=["tab","assetService","cdnService","clientResources"];o.a.directive(r.a.components.approvals.emptyApprovals,[r.a.modules.reactDirective,e=>e(n.a,a)])},33548:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(11766),n=i(26997),o=i(16828),a=i(12754),s=i(14962);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(m,e);var t,i,u,h=p(m);function m(){var e;l(this,m);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=h.call(this,...i)).styles=Object(a.db)({emptyApprovals:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"calc(100vh - ".concat(s.e,")")},emptyApprovalsText:{textAlign:"center",fontWeight:a.l.semilight,fontSize:a.k.mediumPlus,lineHeight:"1.35em"}}),e}return t=m,(i=[{key:"render",value:function(){var e,{assetService:t,clientResources:i,cdnService:a,tab:s}=this.props;return e=s===n.a.Received?i.Approvals.NoReceivedRequests:s===n.a.Sent?i.Approvals.NoSentRequests:s===n.a.History?i.Approvals.NoApprovalRequestsYet:"",r.createElement("section",{className:this.styles.emptyApprovals},r.createElement(o.b,{src:t.approvalsLogo,fallbackSrc:t.placeholder,cdnService:a}),e&&r.createElement("p",{className:this.styles.emptyApprovalsText},e))}}])&&c(t.prototype,i),u&&c(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(r.PureComponent)},33549:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33550);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33552);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33553),this.controller=o.a,this.controllerAs="receivedTabCtrl"}));n.a.component(r.a.components.approvals.receivedTab,new c)},33550:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var r=i(33327),n=i(11891),o=i(11804),a=i(33551),s=i(26996),l=i(33383),c=i(13031),u=i(28986),d=i(33355),p=i(13240),h=i(13003),m=i(26997),g=i(26995),f=i(16884),v=i(13009),b=i(14876),y=i(33384),w=i(17806),S=i(31420);function C(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function k(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var P=function(e){return e[e.NotSpecified=0]="NotSpecified",e[e.Approving=1]="Approving",e[e.Rejecting=2]="Rejecting",e[e.Reassigning=3]="Reassigning",e[e.Responding=4]="Responding",e[e.Confirmation=5]="Confirmation",e}(P||{}),x=function(){function e(t,i,r,o,a,c,u,g,S,C,k,x,A,T,R,O,D,E,F){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$location=t,this.$routeParams=i,this.$sce=r,this.$scope=o,this.approvalRequestsClient=a,this.appSettings=c,this.assetService=u,this.cdnService=g,this.clientResources=S,this.hostCommunicationService=C,this.loggingService=k,this.markdownService=x,this.navigationService=A,this.promiseHelperService=T,this.routeCrafter=R,this.sessionService=O,this.telemetryService=D,this.trialDialog=E,this.widgetUtilService=F,this.userId=void 0,this.approvalRequests=void 0,this.isPanelOpen=!1,this.panelState=void 0,this.approvalTypes=m.c,this.approvalCenterTabs=m.a,this.selectedRequest=void 0,this.renderedDetails=void 0,this.comments=void 0,this.listSpinner={size:l.c.Large,show:!1,local:l.a.Local},this.paneSpinner={size:l.c.Large,show:!1,local:l.a.Local},this.changeActionCommands=void 0,this.selectedAction=void 0,this.showZeroApprovals=!1,this.showFirstDayApprovals=!1,this.hideCloseButton=!1,this.hideLink=!1,this.fullPageErrorModel=void 0,this.approvalsFilter=void 0,this.responseStateCache=new Map,this.isDeeplink=!1,this.thumbnailSize=f.c.large,this.customResponseOptions=void 0,this.initializePageState=()=>{var{approvalName:e,approvalRequestName:t,response:i}=this.routeParams;if(!Object(b.a)(e)){var r=this.approvalRequests.map(e=>e.properties.approval.name).indexOf(e);-1===r||!Object(b.a)(t)&&t!==this.approvalRequests[r].name?this.navigationService.navigate(Object(w.e)(this.routeCrafter)):(this.isDeeplink=!0,this.selectedRequest=this.approvalRequests[r],this.setPanelStateFromResponse(i))}},this.openPanel=(e,t,i)=>{e&&e.stopPropagation&&e.stopPropagation();var r=this.approvalRequests.map(e=>e.properties.approval.name).indexOf(t);this.selectedRequest=this.approvalRequests[r],this.setPanelStateFromResponse(i)},this.setPanelState=(e,t)=>{var{selectedRequest:i,clientResources:r}=this;!this.customResponseOptions&&i&&i.properties.responseOptionsType===s.a.CustomOptions&&(this.customResponseOptions=i.properties.responseOptions,this.changeActionCommands=this.customResponseOptions.map(e=>({text:e,click:()=>this.handleCustomOptionsClicked(e)}))),this.paneSpinner.show=this.responseStateCache[i.name]&&this.responseStateCache[i.name].status===s.b.Commited,this.selectedRequest.properties.responseOptionsType===s.a.BasicApproveReject?this.selectedAction=e===P.Approving?r.Approvals.Actions.Approve:r.Approvals.Actions.Reject:this.selectedRequest.properties.responseOptionsType===s.a.CustomOptions&&(this.selectedAction=t),this.panelState=e},this.handleApproveClicked=()=>{this.setPanelState(P.Approving)},this.handleRejectClicked=()=>{this.setPanelState(P.Rejecting)},this.handleCustomOptionsClicked=e=>{this.setPanelState(P.Responding,e)},this.confirmResponse=()=>{this.paneSpinner.show=!0;var e=this.selectedRequest,t={properties:{response:this.selectedRequest.properties.responseOptionsType===s.a.CustomOptions?this.selectedAction:this.panelState===P.Approving?"Approve":"Reject",comments:this.comments}};this.responseStateCache[e.name]={status:s.b.Commited,approvalResponse:t};var i=this.loggingService.profileStart(d.a.approvalsConfirmResponseStart);this.approvalRequestsClient.postResponse({id:e.properties.approval.name},t).then(()=>{this.paneSpinner.show=!1,this.panelState=P.Confirmation,this.responseStateCache[e.name].status=s.b.Saved,this.comments="",this.loggingService.profileEndWithSuccess(i,d.a.approvalsConfirmResponseEnd,{approvalName:e.properties.approval.name,requestName:e.name,response:t.properties.response}),this.widgetUtilService.isWidgetPage()&&this.raiseWidgetEventForStatusChange(t.properties.response)}).catch(r=>{this.responseStateCache.delete(e.name),this.loggingService.profileEnd(i,d.a.approvalsConfirmResponseEnd,Object(v.y)(r),r,{approvalName:e.properties.approval.name,requestName:e.name,response:t.properties.response})})},this.handleAdvancedClicked=()=>{this.panelState===P.Reassigning?this.panelState=this.customResponseOptions?P.Responding:P.NotSpecified:this.panelState=P.Reassigning},this.reassignApprovalRequest=e=>{this.paneSpinner.show=!0;var t=this.selectedRequest,i={properties:{response:"Reassign"}};this.responseStateCache[t.name]={status:s.b.Commited,approvalResponse:i};var r=this.loggingService.profileStart(d.a.approvalsReassignStart);this.approvalRequestsClient.reassign({id:t.properties.approval.name,approvalRequest:t.name},{assignedTo:e}).then(()=>{this.paneSpinner.show=!1,this.panelState=P.Confirmation,this.responseStateCache[t.name].status=s.b.Saved,this.loggingService.profileEndWithSuccess(r,d.a.approvalsReassignEnd,{approvalName:t.properties.approval.name,requestName:t.name}),this.widgetUtilService.isWidgetPage()&&this.raiseWidgetEventForStatusChange(i.properties.response)}).catch(e=>{this.responseStateCache.delete(t.name),this.loggingService.profileEnd(r,d.a.approvalsReassignEnd,Object(v.y)(e),e,{approvalName:t.properties.approval.name,requestName:t.name})})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ReceivedTabCtrl"}),this.listSpinner.show=!0,this.changeActionCommands=[{text:this.clientResources.Approvals.Actions.Approve,iconUrl:"glyph-checkmark",click:this.handleApproveClicked},{text:this.clientResources.Approvals.Actions.Reject,iconUrl:"glyph-close",click:this.handleRejectClicked}],this.fullPageErrorModel={image:this.assetService.fullPageErrorDebugFlow,isPageErrored:!1,pageTitle:null},document.referrer&&n.a(Object(h.a)(document.referrer).hostname,Object(h.a)(this.appSettings.signUpRedirectUrl).hostname)&&this.$location.search().response&&this.telemetryService.tagEvent(p.c.TrialDialogOfficePortalSignupCompleted,{response:this.$location.search().response}),this.sessionService.isConsumerDomain?this.trialDialog.showUpgradeToProRequiredDialog(()=>window.location.assign("/")):(this.widgetUtilService.isWidgetPage()&&(this.hostCommunicationService.onCloseInfoPane(this.closePanel),this.hideCloseButton=this.widgetUtilService.widgetInfo.approvalCenterSettings&&this.widgetUtilService.widgetInfo.approvalCenterSettings.hideInfoPaneCloseButton,this.hideLink=this.widgetUtilService.widgetInfo.approvalCenterSettings&&this.widgetUtilService.widgetInfo.approvalCenterSettings.hideLink),this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(e=>{this.userId=e.userInfo.uniqueId,this.listReceivedApprovals(e.userInfo)}).catch(e=>{Object(y.b)(this.fullPageErrorModel,e),this.listSpinner.show=!1}),o.$watch(()=>this.selectedRequest,()=>{this.selectedRequest&&this.renderDetails()}))}var t,i,r;return t=e,(i=[{key:"listReceivedApprovals",value:function(e){var t=this.loggingService.profileStart(d.a.approvalsListReceivedApprovalsStart);this.approvalsFilter=Object(c.a)(a.a,e.uniqueId),this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetInfo.approvalCenterSettings.approvalsFilter&&(this.approvalsFilter+=" and ".concat(this.widgetUtilService.widgetInfo.approvalCenterSettings.approvalsFilter)),this.approvalRequests=this.approvalRequestsClient.query(this.$scope,{$filter:this.approvalsFilter}),this.approvalRequests.$promise.then(()=>{this.loggingService.profileEndWithSuccess(t,d.a.approvalsListReceivedApprovalsEnd),this.initializePageState(),this.listSpinner.show=!1,this.widgetUtilService.isWidgetPage()&&this.hostCommunicationService.triggerHostEvent(o.e.WIDGET_RENDERED)}).catch(e=>{this.loggingService.profileEnd(t,d.a.approvalsListReceivedApprovalsEnd,Object(v.y)(e),e),Object(y.b)(this.fullPageErrorModel,e,null),this.listSpinner.show=!1}),this.approvalRequests.$watch(this.$scope,()=>{var e=this.approvalRequests.map(e=>e.name);for(var t in this.responseStateCache)-1===e.indexOf(t)&&this.responseStateCache.delete(t);this.approvalRequests.length<1&&(this.showZeroApprovals=this.shouldShowZeroApprovals(),this.showFirstDayApprovals=!this.showZeroApprovals)})}},{key:"setPanelStateFromResponse",value:function(e){var{setPanelState:t}=this;e&&(n.a(e,"approve")||n.a(e,"'approve'")?t(P.Approving):n.a(e,"reject")||n.a(e,"'reject'")?t(P.Rejecting):n.a(e,"reassign")||n.a(e,"'reassign'")?t(P.Reassigning):n.a(e,"respond")||n.a(e,"'respond'")?t(P.Responding):t(P.NotSpecified)),this.isPanelOpen=!0}},{key:"closePanel",value:function(){this.showConfirmation&&this.approvalRequestsClient.refreshQuery({$filter:this.approvalsFilter}),this.isPanelOpen=!1,this.selectedRequest=void 0,this.customResponseOptions=void 0,this.panelState===P.Responding&&(this.panelState=P.NotSpecified),this.isDeeplink&&this.navigationService.navigate(Object(w.e)(this.routeCrafter))}},{key:"hasUserChosenAResponse",get:function(){return this.isUserApprovingOrRejecting()||this.panelState===P.Responding&&!!this.selectedAction}},{key:"isUserApprovingOrRejecting",value:function(){return this.panelState===P.Approving||this.panelState===P.Rejecting}},{key:"isCardSelected",value:function(e){return!Object(b.a)(this.selectedRequest)&&e.name===this.selectedRequest.name}},{key:"isCardDisabled",value:function(e){return!Object(b.a)(this.selectedRequest)&&!this.isCardSelected(e)}},{key:"hasContent",value:function(e){return!Object(b.a)(e)}},{key:"itemLinkDescription",get:function(){var e=this.selectedRequest.properties.approval.properties.itemLinkDescription,t=this.itemLink;return Object(b.a)(e)?t:e}},{key:"itemLink",get:function(){var e=this.selectedRequest.properties.approval.properties.itemLink,t=Object(u.a)(e)?e:"https://".concat(e);return Object(S.a)(t)?t:void 0}},{key:"isDoneLoading",get:function(){return!this.showZeroApprovals&&!this.listSpinner.show}},{key:"onBehalfOfNotice",get:function(){var e=null,{selectedRequest:t}=this;if(!(t&&t.properties&&t.properties.approval&&t.properties.approval.properties))return e;var i=t.properties.approval.properties.creator,r=t.properties.approval.properties.owner;return i&&i.displayName&&i.email&&!Object(g.o)(i,r)&&(e=Object(c.a)(this.clientResources.Approvals.OnBehalfOf.Notice,i.displayName,i.email),this.telemetryService.tagEvent(p.c.ApprovalsReceivedTabOnBehalfOfNoticeGenerated)),e}},{key:"routeParams",get:function(){return{approvalName:this.$routeParams.approvalName,approvalRequestName:this.$routeParams.approvalRequestName,response:this.$routeParams.response&&this.$routeParams.response.toLowerCase()}}},{key:"showConfirmation",get:function(){return this.hasRespondedToSelectedRequest&&this.responseStateCache[this.selectedRequest.name].status===s.b.Saved}},{key:"confirmationMessage",get:function(){var e=this.clientResources.Approvals.Confirmation;return this.hasApproved?e.Approved:this.hasRejected?e.Rejected:this.hasReassigned?e.Reassigned:this.hasRepondedWithCustomOption?e.RespondedWithCustomOption:null}},{key:"hasApproved",get:function(){return this.hasRespondedToSelectedRequest&&"Approve"===this.responseStateCache[this.selectedRequest.name].approvalResponse.properties.response}},{key:"hasRejected",get:function(){return this.hasRespondedToSelectedRequest&&"Reject"===this.responseStateCache[this.selectedRequest.name].approvalResponse.properties.response}},{key:"hasReassigned",get:function(){return this.hasRespondedToSelectedRequest&&"Reassign"===this.responseStateCache[this.selectedRequest.name].approvalResponse.properties.response}},{key:"hasRepondedWithCustomOption",get:function(){return this.hasRespondedToSelectedRequest&&!this.hasApproved&&!this.hasRejected&&!this.hasReassigned}},{key:"hasRespondedToSelectedRequest",get:function(){var{selectedRequest:e}=this;return!Object(b.a)(e)&&this.responseStateCache[e.name]&&this.responseStateCache[e.name].status===s.b.Saved}},{key:"statusMessage",get:function(){var e='<span class="bold-label">'.concat(this.selectedAction,"</span>");return Object(c.a)(this.clientResources.Approvals.ChosenResponse,e)}},{key:"renderDetails",value:function(){this.promiseHelperService.toAngularPromise(this.markdownService.getHtmlFromMarkdown(this.selectedRequest.properties.approval.properties.details)).then(e=>{this.renderedDetails=this.$sce.trustAsHtml(e)}).catch(e=>{this.renderedDetails="",this.loggingService.logError("ReceivedTabCtrl.renderDetails",e)})}},{key:"shouldShowZeroApprovals",value:function(){return this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetInfo.approvalCenterSettings.showSimpleEmptyPage}},{key:"shouldShowReassign",get:function(){return this.panelState===P.Reassigning}},{key:"shouldShowDefaultApprovalOptions",get:function(){return!this.isUserApprovingOrRejecting()&&!this.shouldShowReassign&&!this.shouldShowCustomOptions}},{key:"shouldShowCustomOptions",get:function(){return this.selectedRequest&&this.selectedRequest.properties&&this.selectedRequest.properties.responseOptions&&this.selectedRequest.properties.responseOptions.length>0&&this.selectedRequest.properties.responseOptionsType===s.a.CustomOptions&&!this.shouldShowReassign}},{key:"raiseWidgetEventForStatusChange",value:function(e){this.hostCommunicationService.triggerHostEvent(o.e.RECEIVED_APPROVAL_STATUS_CHANGED,{approvalRequestsCount:this.approvalRequests.length-1,approverAction:e})}}])&&C(t.prototype,i),r&&C(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();x.$inject=[r.a.services.$location,r.a.services.$routeParams,r.a.services.$sce,r.a.services.$scope,r.a.services.approvalRequestsClient,r.a.services.appSettings,r.a.services.assetService,r.a.services.cdnService,r.a.services.clientResources,r.a.services.hostCommunicationService,r.a.services.logging,r.a.services.markdownService,r.a.services.navigation,r.a.services.promiseHelperService,r.a.services.routeCrafter,r.a.services.session,r.a.services.telemetry,r.a.services.trialDialog,r.a.services.widgetUtilService]},33551:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33328),n=i(33327),o=i(31433),a=i(13144),s="properties/assignedTo/id eq '{0}'",l={query:42e4,get:48e4,evictionDelay:3e5},c={requestUrlPathWithoutEnvironment:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/approvalRequests"),responseUrlPathWithoutEnvironment:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/approvals/:id/approvalResponses"),resourceType:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/approvals/approvalRequests"),expandParams:"properties/approval,properties.principals.thumbnailphoto"};function u(e){return e?"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(e,"/approvalRequests"):c.requestUrlPathWithoutEnvironment}function d(e){return e?"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(e,"/approvals/:id/approvalResponses"):c.responseUrlPathWithoutEnvironment}r.a.factory(n.a.services.approvalRequestsClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment,(e,t,i)=>{var r,n=t=>(t.url=t.url.replace(/api-version=[^&]*/gi,"api-version="+function(e,t){return t.getCurrentEnvironmentName()?e.processSimpleResourceProviderApiVersionWithEnvironments:e.processSimpleResourceProviderApiVersion}(e,i)),t.url=t.url.replace(new RegExp(c.requestUrlPathWithoutEnvironment,"i"),u(i.getCurrentEnvironmentName())),t.url=t.url.replace(new RegExp(c.responseUrlPathWithoutEnvironment,"i"),d(i.getCurrentEnvironmentName())),t),s={interceptor:{request:n},name:"postResponse",method:"POST",urlPath:d(i.getCurrentEnvironmentName()),params:{id:"@id"}},p={interceptor:{request:n},name:"reassign",method:"POST",urlPath:(r=i.getCurrentEnvironmentName(),r?"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(r,"/approvals/:id/approvalRequests/:approvalRequest/reassign"):c.responseUrlPathWithoutEnvironment),params:{id:"@id",approvalRequest:"@approvalRequest"}};return t({urlBase:Object(a.c)(e).flowRP,urlPath:u(i.getCurrentEnvironmentName()),apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:c.resourceType,rest:{query:{requestInterceptor:n,params:{$filter:"@filter",$expand:c.expandParams}}},actions:[s,p],options:{atomize:!1,evictionDelay:l.evictionDelay}})}])},33552:function(e,t,i){e.exports=i.p+"static/media/receivedTab.f34d6eeb.less"},33553:function(e,t){e.exports='<spinner model="receivedTabCtrl.listSpinner"></spinner>\n<section class="list-section" ng-if="receivedTabCtrl.isDoneLoading && !receivedTabCtrl.fullPageErrorModel.isPageErrored">\n    <div class="list-container">\n        <ul class="row">\n            <li class="card-list-item" ng-repeat="approvalRequest in receivedTabCtrl.approvalRequests">\n                <approval-card\n                    approval="approvalRequest.properties.approval"\n                    approval-request="approvalRequest"\n                    is-disabled="receivedTabCtrl.isCardDisabled(approvalRequest)"\n                    is-selected="receivedTabCtrl.isCardSelected(approvalRequest)"\n                    on-click="receivedTabCtrl.openPanel"\n                    response-options="approvalRequest.properties.responseOptions"\n                    response-options-type="approvalRequest.properties.responseOptionsType">\n                </approval-card>\n            </li>\n        </ul>\n    </div>\n    <info-pane\n        pane-title="receivedTabCtrl.selectedRequest.properties.approval.properties.title"\n        pane-subtitle="receivedTabCtrl.onBehalfOfNotice"\n        expanded="receivedTabCtrl.isPanelOpen"\n        hide-close-button="receivedTabCtrl.hideCloseButton"\n        hide-parent-scrollbar="true"\n        on-close="receivedTabCtrl.closePanel()"\n        close-on-click-outside-pane="!receivedTabCtrl.shouldShowReassign">\n        <spinner model="receivedTabCtrl.paneSpinner"></spinner>\n        <div class="approval-content" ng-show="!receivedTabCtrl.paneSpinner.show && !receivedTabCtrl.showConfirmation">\n            <section class="approval-container from">\n                <h1 class="c-subheading-4">{{ ::receivedTabCtrl.clientResources.Approvals.Headers.For }}</h1>\n                <react-persona\n                    text="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.displayName"\n                    secondary-text="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.email"\n                    image-url="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.thumbnailPhoto"\n                    size="receivedTabCtrl.thumbnailSize">\n                </react-persona>\n            </section>\n            <section class="approval-container due-date">\n                <h1 class="c-subheading-4">{{ ::receivedTabCtrl.clientResources.Approvals.Headers.Requested }}</h1>\n                <span class="c-paragraph-3">{{ receivedTabCtrl.selectedRequest.properties.creationDate | date : "MMM d, y \'at\' h:mm a" }}</span>\n            </section>\n            <section class="approval-container details" ng-if="receivedTabCtrl.hasContent(receivedTabCtrl.selectedRequest.properties.approval.properties.details)">\n                <h1 class="c-subheading-4">{{ ::receivedTabCtrl.clientResources.Approvals.Headers.Details }}</h1>\n                <div class="c-paragraph-3 markdown-body" ng-bind-html="receivedTabCtrl.renderedDetails"></div>\n            </section>\n            <section\n                class="approval-container link"\n                ng-if="receivedTabCtrl.hasContent(receivedTabCtrl.selectedRequest.properties.approval.properties.itemLink) && !receivedTabCtrl.hideLink">\n                <h1 class="c-subheading-4">{{ ::receivedTabCtrl.clientResources.Approvals.Headers.Link }}</h1>\n                <a target="_blank" class= "c-hyperlink" ng-href="{{ receivedTabCtrl.itemLink }}" ng-bind="receivedTabCtrl.itemLinkDescription"></a>\n            </section>\n            <section class="approval-container advanced-options">\n                <div class="advanced-options-toggle" ng-click="receivedTabCtrl.handleAdvancedClicked()">\n                    <i class="ms-Icon" ng-class="receivedTabCtrl.shouldShowReassign ? \'ms-Icon--ChevronUp\' : \'ms-Icon--ChevronDown\'"></i>\n                    <span>{{ ::receivedTabCtrl.clientResources.Approvals.Reassign }}</span>\n                </div>\n                <approval-reassign\n                    ng-show="receivedTabCtrl.shouldShowReassign"\n                    user-id="receivedTabCtrl.userId"\n                    approval-owner-id="receivedTabCtrl.selectedRequest.properties.approval.properties.owner.id"\n                    on-filter-change="receivedTabCtrl.graphService.searchPeoplePickerItems"\n                    on-submit="receivedTabCtrl.reassignApprovalRequest"\n                    on-cancel="receivedTabCtrl.handleAdvancedClicked"></approval-reassign>\n            </section>\n            <section class="approveOrReject" ng-if="receivedTabCtrl.shouldShowDefaultApprovalOptions">\n                <react-divider></react-divider>\n                <react-button-group\n                    primaryButtonText="receivedTabCtrl.clientResources.Approvals.Actions.Approve"\n                    onPrimaryButtonClick="receivedTabCtrl.handleApproveClicked"\n                    secondaryButtonText="receivedTabCtrl.clientResources.Approvals.Actions.Reject"\n                    onSecondaryButtonClick="receivedTabCtrl.handleRejectClicked"\n                ></react-button-group>\n            </section>\n            <section class="customOptions" ng-if="receivedTabCtrl.shouldShowCustomOptions">\n                <react-default-button\n                    ng-repeat="changeActionCommand in receivedTabCtrl.changeActionCommands"\n                    primary="false"\n                    on-click="::changeActionCommand.click"\n                    text="::changeActionCommand.text"\n                ></react-default-button>\n            </section>\n            <section class="confirmSection" ng-show="receivedTabCtrl.hasUserChosenAResponse">\n                <div class="approval-container status">\n                    <h1 class="c-subheading-4" ng-bind="receivedTabCtrl.clientResources.Approvals.Headers.Status"></h1>\n                    <p class="c-paragraph-3" ng-bind-html="receivedTabCtrl.statusMessage"></p>\n                    <list-commands button-text="change" model="receivedTabCtrl.changeActionCommands"></list-commands>\n                </div>\n                <label class="c-label">\n                    {{ ::receivedTabCtrl.clientResources.Approvals.Labels.AddComments }}\n                    <span class="optional-label">\n                        ({{ ::receivedTabCtrl.clientResources.Approvals.Labels.Optional }})\n                    </span>\n                </label>\n                <div class="c-textarea">\n                    <textarea\n                        ng-model="receivedTabCtrl.comments"\n                        maxlength="2048"\n                        ng-attr-placeholder="{{ receivedTabCtrl.clientResources.Approvals.Placeholders.LeaveOpinion }}">\n                    </textarea>\n                </div>\n                <react-divider></react-divider>\n                <react-default-button\n                    primary="true"\n                    text="receivedTabCtrl.clientResources.Approvals.Actions.Confirm"\n                    on-click="receivedTabCtrl.confirmResponse"\n                ></react-default-button>\n            </section>\n        </div>\n        <div class="confirmation-content" ng-show="!receivedTabCtrl.paneSpinner.show && receivedTabCtrl.showConfirmation">\n            <section class="response-message">\n                <i class="confirmationIcon ms-Icon ms-Icon--CheckMark ms-fontColor-green" ng-if="receivedTabCtrl.hasApproved || receivedTabCtrl.hasRepondedWithCustomOption" ></i>\n                <i class="confirmationIcon ms-Icon ms-Icon--Cancel ms-fontColor-red" ng-if="receivedTabCtrl.hasRejected" ></i>\n                <i class="confirmationIcon ms-Icon ms-Icon--Switch ms-fontColor-neutralPrimary" ng-if="receivedTabCtrl.hasReassigned" ></i>\n                <p class="message" ng-bind="receivedTabCtrl.confirmationMessage"></p>\n            </section>\n        </div>\n    </info-pane>\n</section>\n<first-day-approvals\n    ng-if="receivedTabCtrl.showFirstDayApprovals && !receivedTabCtrl.fullPageErrorModel.isPageErrored"\n    nothing-pending-text="{{::receivedTabCtrl.clientResources.Approvals.Zero.NoPendingReceivedRequests}}"\n></first-day-approvals>\n<empty-approvals\n    tab="receivedTabCtrl.approvalCenterTabs.Received"\n    assetService="receivedTabCtrl.assetService"\n    cdnService="receivedTabCtrl.cdnService"\n    clientResources="receivedTabCtrl.clientResources"\n    ng-if="receivedTabCtrl.showZeroApprovals && !receivedTabCtrl.fullPageErrorModel.isPageErrored"\n></empty-approvals>\n<full-page-error model="receivedTabCtrl.fullPageErrorModel" ng-if="receivedTabCtrl.fullPageErrorModel.isPageErrored"></full-page-error>\n'},33554:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33555);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33552);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33557),this.controller=o.a,this.controllerAs="sentTabCtrl"}));n.a.component(r.a.components.approvals.sentTab,new c)},33555:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var r=i(33327),n=i(33556),o=i(26996),a=i(11804),s=i(33383),l=i(14876),c=i(28986),u=i(33355),d=i(26997),p=i(13031),h=i(26995),m=i(13240),g=i(16884),f=i(13260),v=i(12728),b=i(12754),y=i(13009),w=i(33384),S=i(17806),C=i(31420);function k(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,P(r.key),r)}}function P(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var x=function(){function e(t,i,r,n,a,l,c,p,h,m,S,C,k,P,x,A,T){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$sce=i,this.$scope=r,this.assetService=n,this.cdnService=a,this.clientResources=l,this.approvalsClient=c,this.hostCommunicationService=p,this.loggingService=h,this.markdownService=m,this.navigationService=S,this.promiseHelperService=C,this.routeCrafter=k,this.sessionService=P,this.telemetryService=x,this.trialDialog=A,this.widgetUtilService=T,this.approvalList=void 0,this.approvalTypes=d.c,this.approvalCenterTabs=d.a,this.isPanelOpen=!1,this.selectedApproval=void 0,this.renderedDetails=void 0,this.comments=void 0,this.listSpinner={size:s.c.Large,show:!1,local:s.a.Local},this.selectedAction=void 0,this.showZeroApprovals=!1,this.showFirstDayApprovals=!1,this.fullPageErrorModel=void 0,this.clockWhiteImage=void 0,this.linkWhiteImage=void 0,this.assignedToInfo=void 0,this.infoPaneClosed=!1,this.hideCloseButton=!1,this.hideLink=!1,this.showCancelConfirmation=!1,this.approvalsFilter=void 0,this.isDeeplink=!1,this.thumbnailSize=g.c.large,this.cancelTooltipProps=void 0,this.cancelStateCache=new Map,this.panelSpinner={size:s.c.Large,show:!1,local:s.a.Local},this.openPanel=(e,t)=>{e&&e.stopPropagation&&e.stopPropagation();var i=this.approvalList.map(e=>e.name).indexOf(t);this.selectedApproval=this.approvalList[i];var r=this.cancelStateCache[t];r&&r===o.b.Commited?(this.panelSpinner.show=!0,this.showCancelConfirmation=!1):r&&r===o.b.Saved?(this.panelSpinner.show=!1,this.showCancelConfirmation=!0):(this.panelSpinner.show=!1,this.showCancelConfirmation=!1),this.isPanelOpen=!0},this.cancelApproval=()=>{this.panelSpinner.show=!0;var e=this.selectedApproval;this.cancelStateCache[e.name]=o.b.Commited;var t=this.loggingService.profileStart(u.a.approvalsCancelStart);this.approvalsClient.cancel({id:e.name}).then(()=>{this.loggingService.profileEndWithSuccess(t,u.a.approvalsCancelEnd,{approvalName:e.name}),this.cancelStateCache[e.name]=o.b.Saved,this.approvalsClient.refreshQuery({$filter:this.approvalsFilter}),e===this.selectedApproval&&(this.panelSpinner.show=!1,this.showCancelConfirmation=!0)}).catch(i=>{this.cancelStateCache[e.name]=o.b.NotSpecified,e===this.selectedApproval&&(this.panelSpinner.show=!1),this.loggingService.profileEnd(t,u.a.approvalsCancelEnd,Object(y.y)(i),i,{approvalName:e.name})})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"SentTabCtrl"}),this.clockWhiteImage=this.assetService.clockWhite,this.linkWhiteImage=this.assetService.linkWhite,this.fullPageErrorModel={image:this.assetService.fullPageErrorDebugFlow,isPageErrored:!1,pageTitle:null},this.cancelTooltipProps={text:this.clientResources.Approvals.CancelNotSupported,id:Object(v.a)("cancel-approval-button"),delay:f.c.zero,directionalHint:f.a.bottomCenter,textColor:Object(b.Y)().palette.red},this.sessionService.isConsumerDomain?this.trialDialog.showUpgradeToProRequiredDialog(()=>{window.location.assign("/")}):(this.listSpinner.show=!0,this.hideCloseButton=this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetInfo.approvalCenterSettings&&this.widgetUtilService.widgetInfo.approvalCenterSettings.hideInfoPaneCloseButton,this.hideLink=this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetInfo.approvalCenterSettings&&this.widgetUtilService.widgetInfo.approvalCenterSettings.hideLink,this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(e=>{this.listSentApprovals(e.userInfo)}).catch(e=>{Object(w.b)(this.fullPageErrorModel,e),this.listSpinner.show=!1}),r.$watch(()=>this.selectedApproval,()=>{this.selectedApproval&&this.renderDetails()}))}var t,i,r;return t=e,(i=[{key:"listSentApprovals",value:function(e){this.approvalsFilter=Object(p.a)(n.a,e.uniqueId),this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetInfo.approvalCenterSettings.approvalsFilter&&(this.approvalsFilter+=" and ".concat(this.widgetUtilService.widgetInfo.approvalCenterSettings.approvalsFilter));var t=this.loggingService.profileStart(u.a.approvalsListSentApprovalsStart);this.approvalList=this.approvalsClient.query(this.$scope,{$filter:this.approvalsFilter}),this.approvalList.$promise.then(()=>{this.loggingService.profileEndWithSuccess(t,u.a.approvalsListSentApprovalsEnd),this.setStateFromParams(this.paramApprovalName),this.listSpinner.show=!1,this.widgetUtilService.isWidgetPage()&&this.hostCommunicationService.triggerHostEvent(a.e.WIDGET_RENDERED)}).catch(e=>{this.loggingService.profileEnd(t,u.a.approvalsListSentApprovalsEnd,Object(y.y)(e),e),this.listSpinner.show=!1,Object(w.b)(this.fullPageErrorModel,e,null)}),this.approvalList.$watch(this.$scope,()=>{var e=this.approvalList.map(e=>e.name);for(var t in this.cancelStateCache)-1===e.indexOf(t)&&this.cancelStateCache.delete(t);this.approvalList.length<1&&(this.showZeroApprovals=this.shouldShowZeroApprovals(),this.showFirstDayApprovals=!this.showZeroApprovals)})}},{key:"setStateFromParams",value:function(e){if(!Object(l.a)(e)){var t=this.approvalList.map(e=>e.name).indexOf(e);-1!==t&&e===this.approvalList[t].name?(this.isDeeplink=!0,this.selectedApproval=this.approvalList[t],this.isPanelOpen=!0):this.navigationService.navigate(Object(S.g)(this.routeCrafter))}}},{key:"closePanel",value:function(){this.showCancelConfirmation&&this.approvalsClient.refreshQuery({$filter:this.approvalsFilter}),this.isPanelOpen=!1,this.selectedApproval=void 0,this.isDeeplink&&this.navigationService.navigate(Object(S.e)(this.routeCrafter))}},{key:"isCardSelected",value:function(e){return!Object(l.a)(this.selectedApproval)&&e.name===this.selectedApproval.name}},{key:"isCardDisabled",value:function(e){return!Object(l.a)(this.selectedApproval)&&!this.isCardSelected(e)}},{key:"hasContent",value:function(e){return!Object(l.a)(e)}},{key:"itemLinkDescription",get:function(){var e=this.selectedApproval.properties.itemLinkDescription,t=this.itemLink;return Object(l.a)(e)?t:e}},{key:"itemLink",get:function(){var e=this.selectedApproval.properties.itemLink,t=Object(c.a)(e)?e:"https://".concat(e);return Object(C.a)(t)?t:void 0}},{key:"isDoneLoading",get:function(){return!this.showZeroApprovals&&!this.listSpinner.show}},{key:"paramApprovalName",get:function(){return this.$routeParams.approvalName}},{key:"hasOtherApprovers",get:function(){if(!Object(l.a)(this.selectedApproval)){var e=this.selectedApproval.properties.requestSummary;return e.totalRequests>e.approvers.length}return!1}},{key:"onBehalfOfNotice",get:function(){var e=null,{selectedApproval:t}=this;if(!t||!t.properties)return e;var i=t.properties.creator,r=t.properties.owner;return i&&i.displayName&&i.email&&!Object(h.o)(i,r)&&(e=Object(p.a)(this.clientResources.Approvals.OnBehalfOf.Notice,i.displayName,i.email),this.telemetryService.tagEvent(m.c.ApprovalsSentTabOnBehalfOfNoticeGenerated)),e}},{key:"otherApproversCount",get:function(){var e=this.selectedApproval.properties.requestSummary;return e.totalRequests-e.approvers.length}},{key:"renderDetails",value:function(){this.promiseHelperService.toAngularPromise(this.markdownService.getHtmlFromMarkdown(this.selectedApproval.properties.details)).then(e=>{this.renderedDetails=this.$sce.trustAsHtml(e)}).catch(e=>{this.renderedDetails="",this.loggingService.logError("SentTabCtrl.renderDetails",e)})}},{key:"shouldShowZeroApprovals",value:function(){return this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.widgetInfo.approvalCenterSettings.showSimpleEmptyPage}},{key:"shouldShowApprovalContent",get:function(){return!this.panelSpinner.show&&!this.showCancelConfirmation}},{key:"shouldShowCancelConfirmation",get:function(){return!this.panelSpinner.show&&this.showCancelConfirmation}},{key:"shouldEnableCancelButton",get:function(){return this.selectedApproval&&this.selectedApproval.properties&&this.selectedApproval.properties.allowCancel}},{key:"getCancelTooltipProps",value:function(){return this.shouldEnableCancelButton?void 0:this.cancelTooltipProps}}])&&k(t.prototype,i),r&&k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();x.$inject=[r.a.services.$routeParams,r.a.services.$sce,r.a.services.$scope,r.a.services.assetService,r.a.services.cdnService,r.a.services.clientResources,r.a.services.approvalsClient,r.a.services.hostCommunicationService,r.a.services.logging,r.a.services.markdownService,r.a.services.navigation,r.a.services.promiseHelperService,r.a.services.routeCrafter,r.a.services.session,r.a.services.telemetry,r.a.services.trialDialog,r.a.services.widgetUtilService]},33556:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33328),n=i(33327),o=i(31433),a=i(13144),s="properties/owner/id eq '{0}' and properties/status eq 'Pending'",l={query:42e4,get:48e4,evictionDelay:3e5};r.a.factory(n.a.services.approvalsClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment,(e,t,i)=>{var r=e=>(e.url=e.url.replace(new RegExp("environments/(.*?)/?approvals"),"environments/".concat(i.getCurrentEnvironmentName(),"/approvals")),e),n={urlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/approvals"),approvalsCancelUrlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/approvals/:id/cancel"),resourceType:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/approvals/approval"),expandParams:"properties/requestSummary,properties.principals.thumbnailphoto"},s=n.urlPath,c={interceptor:{request:r},name:"cancel",method:"POST",urlPath:n.approvalsCancelUrlPath,params:{id:"@id"}};return t({urlBase:Object(a.c)(e).flowRP,urlPath:s,apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:n.resourceType,rest:{query:{requestInterceptor:r,params:{$filter:"@filter",$expand:n.expandParams}}},actions:[c],options:{atomize:!1,evictionDelay:l.evictionDelay}})}])},33557:function(e,t){e.exports='<trial-dialog></trial-dialog>\n<spinner model="sentTabCtrl.listSpinner"></spinner>\n<section class="list-section" ng-if="sentTabCtrl.isDoneLoading && !sentTabCtrl.fullPageErrorModel.isPageErrored">\n    <div class="list-container">\n        <ul class="row">\n            <li class="card-list-item" ng-repeat="approval in sentTabCtrl.approvalList">\n                <approval-card\n                    approval="approval"\n                    is-disabled="sentTabCtrl.isCardDisabled(approval)"\n                    is-selected="sentTabCtrl.isCardSelected(approval)"\n                    on-click="sentTabCtrl.openPanel">\n                </approval-card>\n            </li>\n        </ul>\n    </div>\n    <info-pane\n        pane-title="sentTabCtrl.selectedApproval.properties.title"\n        pane-subtitle="sentTabCtrl.onBehalfOfNotice"\n        expanded="sentTabCtrl.isPanelOpen"\n        hide-close-button="sentTabCtrl.hideCloseButton"\n        hide-parent-scrollbar="true"\n        on-close="sentTabCtrl.closePanel()">\n        <spinner model="sentTabCtrl.panelSpinner"></spinner>\n        <div class="approval-content" ng-if="sentTabCtrl.shouldShowApprovalContent">\n            <section class="container due-date">\n                <h1 class="c-subheading-4">{{ ::sentTabCtrl.clientResources.Approvals.Headers.Created }}</h1>\n                <img class="black-circle" ng-src="{{ sentTabCtrl.clockWhiteImage }}"/>\n                <span class="c-paragraph-3">{{ sentTabCtrl.selectedApproval.properties.creationDate | date : "MMM d, y \'at\' h:mm a" }}</span>\n            </section>\n            <section class="container details" ng-if="sentTabCtrl.hasContent(sentTabCtrl.selectedApproval.properties.details)">\n                <h1 class="c-subheading-4">{{ ::sentTabCtrl.clientResources.Approvals.Headers.Details }}</h1>\n                <div class="c-paragraph-3 markdown-body" ng-bind-html="sentTabCtrl.renderedDetails"></div>\n            </section>\n            <section class="container link" ng-if="sentTabCtrl.hasContent(sentTabCtrl.selectedApproval.properties.itemLink) && !sentTabCtrl.hideLink">\n                <h1 class="c-subheading-4">{{ ::sentTabCtrl.clientResources.Approvals.Headers.Link }}</h1>\n                <img class="black-circle" ng-src="{{ sentTabCtrl.linkWhiteImage }}"/>\n                <a target="_blank" class= "c-hyperlink" ng-href="{{ sentTabCtrl.itemLink }}">{{ sentTabCtrl.itemLinkDescription }}</a>\n            </section>\n            <section class="container status">\n                <h1 class="c-subheading-4">{{ ::sentTabCtrl.clientResources.Approvals.Headers.Status }}</h1>\n                <p class="c-paragraph-3">{{ ::sentTabCtrl.clientResources.Approvals.WaitingForResponse }}</p>\n            </section>\n            <section class="container from">\n                <h1 class="c-subheading-4">{{ ::sentTabCtrl.clientResources.Approvals.Headers.SentTo }}</h1>\n                    <ul>\n                        <li class="avatars-list-item" ng-repeat="approver in sentTabCtrl.selectedApproval.properties.requestSummary.approvers">\n                            <react-persona\n                                text="approver.displayName"\n                                secondary-text="approver.email"\n                                image-url="approver.thumbnailPhoto"\n                                size="sentTabCtrl.thumbnailSize">\n                            </react-persona>\n                        </li>\n                        <li class="avatars-list-item" ng-if="sentTabCtrl.hasOtherApprovers">\n                            <div class="grey-circle-count">\n                                +{{ sentTabCtrl.otherApproversCount }}\n                            </div>\n                        </li>\n                    </ul>\n            </section>\n            <react-divider></react-divider>\n            <react-default-button\n                primary="::true"\n                text="::sentTabCtrl.clientResources.Approvals.CancelApproval"\n                on-click="::sentTabCtrl.cancelApproval"\n                is-disabled="!sentTabCtrl.shouldEnableCancelButton"\n                tooltip-props="sentTabCtrl.getCancelTooltipProps()">\n            </react-default-button>\n        </div>\n        <div class="confirmation-content" ng-if="sentTabCtrl.shouldShowCancelConfirmation">\n            <section class="response-message">\n                <i class="confirmationIcon ms-Icon ms-Icon--Blocked ms-fontColor-yellow" ></i>\n                <p class="message">{{ ::sentTabCtrl.clientResources.Approvals.Confirmation.Canceled }}</p>\n            </section>\n        </div>\n    </info-pane>\n</section>\n<first-day-approvals\n    ng-if="sentTabCtrl.showFirstDayApprovals && !receivedTabCtrl.fullPageErrorModel.isPageErrored"\n    nothing-pending-text="{{::sentTabCtrl.clientResources.Approvals.Zero.NoPendingSentRequests}}"></first-day-approvals>\n<empty-approvals\n    tab="sentTabCtrl.approvalCenterTabs.Sent"\n    assetService="sentTabCtrl.assetService"\n    cdnService="sentTabCtrl.cdnService"\n    clientResources="sentTabCtrl.clientResources"\n    ng-if="sentTabCtrl.showZeroApprovals && !sentTabCtrl.fullPageErrorModel.isPageErrored"\n></empty-approvals>\n<full-page-error model="sentTabCtrl.fullPageErrorModel" ng-if="sentTabCtrl.fullPageErrorModel.isPageErrored"></full-page-error>\n'},33558:function(e,t,i){"use strict";i(33556),i(33551),i(33403)},33559:function(e,t,i){"use strict";i(33560),i(33600),i(33755),i(33765)},33560:function(e,t,i){"use strict";i(33561),i(33420),i(33456),i(33391),i(33562),i(33563),i(33408),i(33564),i(33454),i(33565),i(33566),i(33569),i(33570),i(33571),i(33572),i(33573),i(33574),i(33575),i(33577),i(33578),i(33579),i(33580),i(33469),i(33581),i(33585),i(33588),i(33589),i(33592),i(33594),i(33595),i(33598),i(33599)},33561:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(22850),a=i(13009),s=i(13031),l=i(14883),c=i(33374);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function d(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var m=function(e){return e[e.Invalid=0]="Invalid",e[e.Pending=1]="Pending",e[e.Uploading=2]="Uploading",e[e.Paused=3]="Paused",e[e.Complete=4]="Complete",e[e.Canceled=5]="Canceled",e}({}),g=d((function e(){h(this,e),this.name=void 0,this.mimetype=void 0,this.size=void 0,this.status=void 0,this.progressPercent=void 0,this.errorMessage=void 0}));var f=function(){function e(t,i,r,n,o,a,s){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"application/octet-stream",c=arguments.length>8?arguments[8]:void 0;h(this,e),this.$q=t,this.$http=i,this.resources=r,this.fileReaderHelperService=n,this.file=a,this.sasUrl=s,this.contentType=l,this.loggingService=c,this.uploadInfo=void 0,this._blockIds=[],this._canceled=!1,this._disposed=!1,this._fileReaderHelper=void 0,this.defer=void 0,this.uploadInfo=new g,this.uploadInfo.status=m.Pending,this.uploadInfo.progressPercent=0,this.uploadInfo.name=a.name,this.uploadInfo.mimetype=a.type,this.uploadInfo.size=a.size,this._fileReaderHelper=n(a),o.$on("$destroy",()=>{this.dispose()})}return d(e,[{key:"startUploadToAzureBlob",value:function(){this.defer=this.$q.defer(),this.uploadInfo.status=m.Uploading,this._readChunkAndUpload();return this.defer.promise.catch(e=>(this.loggingService.logError(a.c.blobUploadFailure,new a.a(a.c.blobUploadFailure,Object(a.db)(e,Object(s.a)(this.resources.Services.AzureBlobUploader.failedMessage,this.file.name,this.file.size,Object(c.f)(this.sasUrl,"sig","REDACTED"))),null)),this.$q.reject(e)))}},{key:"cancelUpload",value:function(){if(!this._canceled)switch(this._canceled=!0,this.uploadInfo.status){case m.Pending:case m.Uploading:case m.Paused:this.uploadInfo.status=m.Canceled;break;case m.Invalid:case m.Canceled:case m.Complete:}this.defer.reject(new a.a(a.c.blobUploadCancelled,"Azure blob upload cancelled with status "+this.uploadInfo.status,null))}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._fileReaderHelper&&(this._fileReaderHelper.dispose(),this._fileReaderHelper=null))}},{key:"_readChunkAndUpload",value:function(){this._fileReaderHelper.readNextChunk().then(e=>{this._isCanceledOrDisposed()||this._processFileReadResult(e)})}},{key:"_processFileReadResult",value:function(e){switch(e.status){case o.a.Invalid:this._handleUploadRuntimeError(e.errorMessage?e.errorMessage:Object(s.a)(this.resources.Services.AzureBlobUploader.failedMessage,this.file.name,this.file.size,Object(c.f)(this.sasUrl,"sig","REDACTED")));break;case o.a.Reading:case o.a.Complete:this._uploadBlockBlobToTargetSasUri(e.content).then(()=>{if(!this._isCanceledOrDisposed())if(e.endByte!==this.uploadInfo.size){var t=Math.round(100*e.progressPercent);this.uploadInfo.progressPercent=t,this.defer.notify(t),this._readChunkAndUpload()}else this._commitBlockBlobUpload().then(()=>{this._isCanceledOrDisposed()||this._handleUploadCompletion()},e=>{this._handleUploadRuntimeError(e)})},e=>{this._handleUploadRuntimeError(e)});break;case o.a.Canceled:}}},{key:"_isCanceledOrDisposed",value:function(){return this._canceled||this._disposed}},{key:"_handleUploadCompletion",value:function(){this.uploadInfo.progressPercent=100,this.uploadInfo.status=m.Complete,this.defer.resolve()}},{key:"_handleUploadRuntimeError",value:function(e){this.uploadInfo.status=m.Invalid,this.defer.reject(e)}},{key:"deleteHeaderAuthorization",value:function(e){for(var t in e)if(Object(l.e)(t,"Authorization")){delete e[t];break}return e}},{key:"_uploadBlockBlobToTargetSasUri",value:function(e){var t=function(e){for(var t=""+e;t.length<8;)t="0"+t;return t="block-"+t}(this._blockIds.length);try{this._blockIds.push(btoa(t))}catch(r){this.defer.reject(r)}var i=this.sasUrl+"&comp=block&blockid="+this._blockIds[this._blockIds.length-1];return this._retryPromise(()=>{var t={headers:{"x-ms-blob-type":"BlockBlob"},transformRequest:(e,t)=>(delete t().Authorization,e)};return this.$http.put(i,e,t)})}},{key:"_commitBlockBlobUpload",value:function(){var e=this.sasUrl+"&comp=blocklist";return this._retryPromise(()=>{var t={headers:{"x-ms-blob-content-type":this.contentType},transformRequest:(e,t)=>{var i=t();return i=this.deleteHeaderAuthorization(i),e}};return this.$http.put(e,this._createCommitRequest(),t)})}},{key:"_createCommitRequest",value:function(){for(var e="<?xml version='1.0' encoding='utf-8'?><BlockList>",t=0;t<this._blockIds.length;t++)e+="<Latest>".concat(this._blockIds[t],"</Latest>");return e+="</BlockList>"}},{key:"_retryPromise",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=this.$q.defer();return this._retryPromiseWorker(e,n,t,1,r,i),n.promise}},{key:"_retryPromiseWorker",value:function(e,t,i,r,n,o){r>i?(this.loggingService.logError(a.c.blobUploadExceededMaximumRetry,new a.a(a.c.blobUploadExceededMaximumRetry,Object(s.a)(this.resources.Services.AzureBlobUploader.failedMessageExceededMaximumRetry,this.file.name,this.file.size,Object(c.f)(this.sasUrl,"sig","REDACTED"),i))),t.reject(Object(s.a)(this.resources.Services.AzureBlobUploader.failedMessageExceededMaximumRetry,this.file.name,this.file.size,Object(c.f)(this.sasUrl,"sig","REDACTED"),i))):e().then(t.resolve,l=>{this._isTransientHttpError(l.status)?setTimeout(()=>{this._retryPromiseWorker(e,t,i,r+1,n,o*(1+n))},o):(this.loggingService.logError(a.c.blobUploadFailure,new a.a(a.c.blobUploadFailure,Object(a.db)(l,Object(s.a)(this.resources.Services.AzureBlobUploader.failedMessage,this.file.name,this.file.size,Object(c.f)(this.sasUrl,"sig","REDACTED"))),null)),t.reject(Object(s.a)(this.resources.Services.AzureBlobUploader.failedMessage,this.file.name,this.file.size,Object(c.f)(this.sasUrl,"sig","REDACTED"))))})}},{key:"_isTransientHttpError",value:function(e){switch(e){case 408:case 504:case 502:case 500:case 503:return!0;default:return!1}}}]),e}();r.a.factory(n.a.services.azureBlobUploaderService,[n.a.services.$q,n.a.services.$http,n.a.services.clientResources,n.a.services.fileReaderHelperService,n.a.services.logging,(e,t,i,r,n)=>(o,a,s,l)=>new f(e,t,i,r,o,a,s,l,n)])},33562:function(e,t){},33563:function(e,t,i){"use strict";var r=i(33331),n=i(33327);function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function a(e,t,i){return(t=u(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function c(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=function(){function e(){s(this,e),this.$get=void 0,this.$q=void 0,this.authenticationService=void 0,this.promiseHelperService=void 0,this.options=void 0,this.sessionService=void 0,this.loggingService=void 0,this.widgetUtilsService=void 0,this.$get=[n.a.services.$q,n.a.services.logging,n.a.services.promiseHelperService,n.a.services.session,n.a.services.widgetUtilService,(e,t,i,r,n)=>(this.$q=e,this.loggingService=t,this.promiseHelperService=i,this.sessionService=r,this.widgetUtilsService=n,this.authenticationService=new p(this.$q,this.options,this.sessionService),this.authenticationService)]}return c(e,[{key:"init",value:function(e,t){this.options=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({endpoints:{}},e),t&&t.interceptors&&t.interceptors.push(this.getHttpInterceptor())}},{key:"getHttpInterceptor",value:function(){return()=>({request:e=>{var t;return e?null!==(t=e.headers)&&void 0!==t&&t.SkipAuthorization?(delete e.headers.SkipAuthorization,this.$q.resolve(e)):this.promiseHelperService.toAngularPromise(Promise.resolve()).then(()=>{if(!this.sessionService.isAuthenticated&&!this.widgetUtilsService.isLogicApps())return null;var t;e.headers=e.headers||{};var i=this.authenticationService.getEndpoints(),r=this.authenticationService.getEndpointPatterns();if(i)for(var n of Object.keys(i))e.url.indexOf(n)>-1&&(t=i[n]);if(!t&&r)for(var o of Object.keys(r)){var a=e.url.toUpperCase().indexOf(o.toUpperCase());a>-1&&(t=e.url.substring(0,a+o.length))}return t?this.authenticationService.getToken(t):null}).then(t=>(t&&(e.headers.Authorization="Bearer "+t),this.$q.resolve(e))).catch(e=>(this.loggingService.logWarning("AuthenticationProvider.GetHttpInterceptor",e),this.$q.reject(e))):this.$q.resolve(e)}})}}]),e}(),p=function(){function e(t,i,r){s(this,e),this.$q=t,this.options=i,this.sessionService=r}return c(e,[{key:"getEndpoints",value:function(){return this.options.endpoints}},{key:"getEndpointPatterns",value:function(){return this.options.endpointPatterns}},{key:"getToken",value:function(e){return this.$q((t,i)=>{this.sessionService.getToken(e).then(e=>t(e)).catch(e=>i(e))})}}]),e}();r.a.provider(n.a.services.authentication,[d])},33564:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(22850);r.a.factory(n.a.services.fileReaderHelperService,[n.a.services.clientResources,e=>(t,i)=>new o.b(e.Services,t,i)])},33565:function(e,t,i){"use strict";var r=i(33331),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeProvider=t}var t,i,r;return t=e,(i=[{key:"$get",get:function(){return this.$routeProvider.$get}},{key:"eagerInstantiationEnabled",value:function(e){if(null===e)throw new Error("enabled cannot be null");return void 0===e?this.$routeProvider.eagerInstantiationEnabled():(this.$routeProvider.eagerInstantiationEnabled(e),this)}},{key:"otherwise",value:function(e){return this.$routeProvider.otherwise(e),this}},{key:"when",value:function(e,t){return this.$routeProvider.when(e,t),this}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.$inject=["$routeProvider"],r.a.provider(n.a.providers.route,s)},33566:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33567);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$get=[n.a.services.token,e=>new o.a(e)]}));r.a.provider(n.a.services.session,[c])},33567:function(e,t,i){"use strict";var r=i(33568);i.d(t,"a",(function(){return r.a}));var n=i(12366);i.d(t,"b",(function(){return n.C}))},33568:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(13e3),n=i(15332),o=i(12345);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tokenService=t}var t,i,s;return t=e,(i=[{key:"isAuthenticated",get:function(){return r.a.isAuthenticated}},{key:"isConsumerDomain",get:function(){var e;return this.isAuthenticated&&!(null===(e=r.a.user)||void 0===e||!e.isConsumerDomain)}},{key:"isOrgId",get:function(){return this.isAuthenticated&&!this.isConsumerDomain}},{key:"sessionId",get:function(){return r.a.sessionId}},{key:"getToken",value:function(e){return this.tokenService.getAccessToken(e)}},{key:"getUserInfo",value:function(){return r.a.minimalUserInfo}},{key:"getUserSessionAsync",value:function(){return Promise.resolve({userInfo:r.a.user,environment:o.a.environmentClaim,isAuthenticated:this.isAuthenticated})}},{key:"isGuestUser",value:function(){var e;return!(null===(e=n.a.currentUserDetails)||void 0===e||!e.isGuestUser)}},{key:"hasSessionRefreshFailed",value:function(){return r.a.hasSessionRefreshFailed}},{key:"isDisallowedFromInternalPlans",get:function(){return!!n.a.isDisallowedFromInternalPlans}},{key:"userConsented",get:function(){return!!n.a.isConsented}}])&&a(t.prototype,i),s&&a(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33569:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(11806),a=i(33279),s=i.n(a),l=i(15492);function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function u(e,t,i){return(t=p(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reactNavigation=t,this.$window=i}var t,i,r;return t=e,(i=[{key:"navigate",value:function(e,t){var i=e;if(t){var r=Object(o.b)(t);r&&(i.includes("?")?i+="&"+r:i+="?"+r)}this.reactNavigation.navigate(i)}},{key:"confirmNavigateAway",value:function(e,t){t=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({confirmOnNavigate:!0,confirmOnUnload:!0},t);var i=s.a.noop;if(t.confirmOnUnload){var r=e=>{if(t.condition())return e.preventDefault(),e.returnValue=t.getMessage(),t.getMessage()};s.a.element(this.$window).on("beforeunload",r),i=()=>{s.a.element(this.$window).off("beforeunload",r)}}var n=s.a.noop,o=s.a.noop;if(t.confirmOnNavigate){var a=()=>"".concat(t.getMessage(),"\n\n").concat(t.confirmation);n=e.$on("$locationChangeStart",e=>{e.defaultPrevented||!t.condition()||l.a.allowNavigation(a())||e.preventDefault()}),o=this.reactNavigation.registerAllowNavigation(()=>!(t.condition()&&!l.a.allowNavigation(a())))}var d=()=>{i(),n(),o()};return e.$on("$destroy",d),d}}])&&d(t.prototype,i),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();h.$inject=[n.a.services.reactNavigation,n.a.services.$window],r.a.service(n.a.services.navigation,h)},33570:function(e,t,i){"use strict";var r=i(33331),n=i(33279),o=i(33327);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$interval=t,this.options=i,this.getPollInterval=void 0,this.isPolling=void 0,this.intervalPromise=void 0,this.pollRefCount=0,this.isDestroyed=void 0,this.getPollInterval=()=>{var e=this.options.interval;return n.isFunction(e)?e():e}}var t,i,r;return t=e,(i=[{key:"destroy",value:function(){this.pollRefCount=0,this.clearScheduledPoll(),this.isPolling=!1,this.isDestroyed=!0}},{key:"start",value:function(e){this.isDestroyed||(this.pollRefCount++,e.$on("$destroy",()=>{this.pollRefCount--,this.pollRefCount<=0&&(this.pollRefCount=0,this.clearScheduledPoll(),this.isPolling=!1)}),this.isPolling||(this.schedulePoll(),this.isPolling=!0))}},{key:"reset",value:function(){this.isPolling&&(this.clearScheduledPoll(),this.schedulePoll())}},{key:"schedulePoll",value:function(){this.isDestroyed||(this.intervalPromise=this.$interval(()=>{this.options.poll().finally(()=>this.schedulePoll())},this.getPollInterval(),1))}},{key:"clearScheduledPoll",value:function(){this.intervalPromise&&(this.$interval.cancel(this.intervalPromise),this.intervalPromise=null)}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.factory(o.a.services.poll,[o.a.services.$interval,e=>t=>new l(e,t)])},33571:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(33331),n=i(33327),o=i(12381),a=i(12345),s=i(19940),l=i(17266),c=i(13143),u=i(15523),d=i(15395),p=i(13015),h=i(13142);function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function g(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){f(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e,t,i){return(t=b(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y=function(e){return e[e.GET=0]="GET",e[e.POST=1]="POST",e[e.DELETE=2]="DELETE",e[e.PATCH=3]="PATCH",e}({}),w=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$http=i,this.authenticationService=r,this.clientResources=n}var t,i,r;return t=e,(i=[{key:"getXrmInstanceApiUrl",value:function(){var e=a.a.currentEnvironment.xrmInstanceApiUrl;if(e){var t=this.getXrmMajorVersion(a.a.currentEnvironment.xrmInstanceVersion),i="/api/data/v".concat(t,"/");return Object(o.a)(e,i)}return""}},{key:"makeXrmCall",value:function(e,t,i,r){var n="",u=this.$q.defer(),d=a.a.currentEnvironment.xrmInstanceApiUrl;return d?(n=this.getXrmMajorVersion(a.a.currentEnvironment.xrmInstanceVersion),this.authenticationService.getToken(d).then(a=>{var l="/api/data/v".concat(n,"/");return this.$http({method:Object(s.b)(y,e),url:Object(o.a)(Object(o.a)(d,l),t),data:i||{},headers:g(g({},r||{}),{},{Authorization:"Bearer ".concat(a),Consistency:"Strong"})})}).then(e=>{if(this.isSuccessResponse(e))return u.resolve(e);u.reject(new l.a(c.b.xrmRequestBadResponse,this.clientResources.Common.SomethingWentWrong,{responseStatusCode:e&&e.status}))}).catch(e=>u.reject(e))):this.rejectForNoCDSInstance(u),u.promise}},{key:"makeXrmBatchCall",value:function(e,t,i){var r=this.$q.defer(),n="",h="",m=a.a.currentEnvironment.xrmInstanceApiUrl;return m?(h=this.getXrmMajorVersion(a.a.currentEnvironment.xrmInstanceVersion),this.authenticationService.getToken(m).then(r=>{var a="/api/data/v".concat(h,"/"),l=Object(o.a)(a,"$batch");n=Object(u.a)();var c=Object(d.d)(n,a,t);return this.$http({method:Object(s.b)(y,e),url:Object(o.a)(m,l),data:c.data,headers:g(g({},i||{}),{},{Authorization:"Bearer ".concat(r),Consistency:"Strong",Accept:c.acceptHeaderValue},{"Content-Type":c.contentTypeHeaderValue})})}).then(e=>{if(this.isSuccessResponse(e))return r.resolve(e);r.reject(new l.a(c.b.xrmRequestBadResponse,this.clientResources.Common.SomethingWentWrong,{responseStatusCode:e&&e.status}))}).catch(e=>{var t=Object(d.g)(e.data,e.headers()["content-type"]),i=Object(d.f)(t);if(null!==i)return r.reject(i);r.reject(new l.a(c.b.xrmRequestBadResponse,Object(p.o)(e,this.clientResources.Common.SomethingWentWrong),e&&e.data,{responseStatusCode:e&&e.status}))}).catch(e=>{r.reject(e)})):this.rejectForNoCDSInstance(r),r.promise}},{key:"getXrmMajorVersion",value:function(e){var t=e.split(".");return[t[0],t[1]].join(".")}},{key:"isSuccessResponse",value:function(e){return 200===e.status||201===e.status||202===e.status||204===e.status}},{key:"rejectForNoCDSInstance",value:function(e){e.reject(new h.a(c.b.cds2InstanceNotProvisioned,"Xrm instance is not provisioned."))}}])&&v(t.prototype,i),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();w.$inject=[n.a.services.$q,n.a.services.$http,n.a.services.authentication,n.a.services.clientResources],r.a.service(n.a.services.xrmService,w)},33572:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33454),a=i(15395),s=i(13031),l=i(15427);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.xrmService=t}var t,i,r;return t=e,(i=[{key:"getFlow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.fetchWorkflow(e,t)}},{key:"getEligibleChildFlows",value:function(e){return this.fetchCandidateWorkflows(e)}},{key:"fetchCandidateWorkflows",value:function(e){var t=e?'workflows?$select=workflowid,name,clientdata,modernflowtype&$orderby=name&$filter=category eq 5 and statecode eq 1 and statuscode eq 2 and contains(clientdata,\'"type":"Request"\')':'workflows?$select=workflowid,name,clientdata&$orderby=name&$filter=category eq 5 and statecode eq 1 and statuscode eq 2 and contains(clientdata,\'"type":"Request"\')';return Object(o.a)(this.xrmService.makeXrmCall(a.a.GET,Object(s.a)(t))).then(t=>{var i=[];return t.data&&Array.isArray(t.data.value)&&t.data.value.forEach(t=>{t.name&&t.workflowid&&t.clientdata&&(!e||t.modernflowtype===l.f.CopilotStudioFlow)&&i.push({name:t.name,workflowid:t.workflowid,clientdata:t.clientdata,modernflowtype:t.modernflowtype})}),i})}},{key:"fetchWorkflow",value:function(e){return Object(o.a)(this.xrmService.makeXrmCall(a.a.GET,Object(s.a)("/workflows({0})",e))).then(e=>e.data)}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[n.a.services.xrmService],r.a.service(n.a.services.xrmChildFlowsClient,d)},33573:function(e,t,i){"use strict";var r=i(33331),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"getPowerbiClient",value:function(){return i.e(455).then(i.t.bind(null,35933,7))}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.service(n.a.services.powerbiClientService,s)},33574:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33354),a=i(33392),s=i(15412),l=i(15415);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.loggingService=i,this.entitlementsClient=r,this.environmentService=n,this.appSettings=o}var t,i,r;return t=e,(i=[{key:"setEntitlements",value:function(e){l.a.entitlements=e}},{key:"getEntitlements",value:function(){return l.a.entitlements||null}},{key:"refreshEntitlements",value:function(){return this.entitlementsClient.getEntitlements({environmentName:this.environmentService.getCurrentEnvironmentName()}).then(e=>{this.setEntitlements(e.data)})}},{key:"startTrial",value:function(e,t){var i=this.loggingService.profileStart(o.a.startOrRenewTrialWithTypeStart);return this.entitlementsClient.startOrRenewTrial({trialType:e,environmentName:this.environmentService.getCurrentEnvironmentName()}).then(e=>(this.loggingService.profileEndWithSuccess(i,o.a.startOrRenewTrialWithTypeEnd,{reasonForRenewal:t}),this.setEntitlements(e.data),!0)).catch(e=>(this.loggingService.profileEnd(i,o.a.startOrRenewTrialWithTypeEnd,Object(a.b)(e),e),this.loggingService.logError("EntitlementsService.StartOrRenewTrialFailed",e),!1))}},{key:"startAiBuilderTrial",value:function(e){return this.startTrial(s.c.AiBuilder,e)}},{key:"safeCheckAiBuilderEntitlementsStatus",value:function(){var e=this.$q.defer(),t=this.checkAiBuilderEntitlementsStatus();return t!==s.a.Allowed?this.refreshEntitlements().catch(e=>{this.loggingService.logError("entitlements.safeCheck: Failed to update entitlements",e)}).finally(()=>{t=this.checkAiBuilderEntitlementsStatus(),e.resolve(t)}):e.resolve(t),e.promise}},{key:"checkAiBuilderEntitlementsStatus",value:function(){var t=this.getEntitlements();if(!t||!t.aiBuilderEntitlements)return s.a.Allowed;var i=t.aiBuilderEntitlements;return i.hasEnvironmentCapacity||this.appSettings.featureFlags.useUnallocatedAICredits&&i.hasUnallocatedCredits?s.a.Allowed:i.hasActiveTrial?i.hasTrialCapacity?s.a.Allowed:s.a.NotAllowedTrialCapacityLimit:this.appSettings.featureFlags.useUnallocatedAICredits&&i.hasPurchasedCredits?s.a.NotAllowedToStartTrial:i.hasExpiredTrial?i.trialCount<e.MaxTrialCount?this.appSettings.featureFlags.enableAIBuilderTrialRenewalForm&&i.trialCount>=e.MaxTrialCountWithoutRenewalForm?s.a.NotAllowedExpiredTrialWithTrialRenewalForm:s.a.NotAllowedExpiredTrial:s.a.NotAllowedTrialCountLimit:s.a.NotAllowedNoTrial}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[n.a.services.$q,n.a.services.logging,n.a.services.entitlementsClient,n.a.services.environment,n.a.services.appSettings],d.MaxTrialCount=24,d.MaxTrialCountWithoutRenewalForm=3,r.a.service(n.a.services.entitlements,d)},33575:function(e,t,i){"use strict";var r=i(33331),n=i(13003),o=i(33394),a=i(33355),s=i(33392),l=i(33439),c=i(33327),u=i(33360),d=i(33576),p=i(33446),h=i(33567),m=i(15522);function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){v(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function v(e,t,i){return(t=y(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function b(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var w=function(){function e(t,i,r,n,o,c,d,h){var g=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.appSettings=r,this.assetService=n,this.clientResources=o,this.loggingService=c,this.promiseHelperService=d,this.sessionService=h,this.userRoles=void 0,this.oidToThumbnailPhotoCache=void 0,this.searchForPeoplePickerUsers=e=>this.searchPeoplePickerItems(e,!0),this.searchPeoplePickerItems=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=2;return Object(u.p)(e)||e.trim().length<i?Promise.resolve({tooFewCharactersInSearch:!0}):new Promise((i,r)=>{g.$q.all([g.queryUsers({searchText:e,excludeGuestUsers:g.appSettings.featureFlags.disableGuestUserSharing}),t?g.$q.resolve([]):g.queryGroups({searchText:e,queryModernGroups:!0})]).then(e=>{var[t,r]=e;i({items:[...t.map(e=>Object(p.c)({object:e,itemType:m.a.User})),...r.map(e=>Object(p.c)({object:e,itemType:m.a.Group}))]})}).catch(e=>{var i={ignoreGroups:t,isAuthenticated:g.sessionService.isAuthenticated,isConsumerDomain:g.sessionService.isConsumerDomain};g.loggingService.logError("GraphService.searchPeoplePickerItems",e,i),r(e)})})},this.getUsersGraphDetails=e=>{var t=e.filter(e=>e.properties.permissionType===l.c.Principal),i={};if(t.forEach(e=>i[e.properties.principal.id]=e),t&&t.length>0){var r=this.loggingService.profileStart(a.a.getGraphDetailsStart),n=this.getObjectsById(Object.keys(i)),o=this.getThumbnailPhotos(Object.keys(i));return this.$q.all([n,o]).then(e=>{var[t,n]=e;return this.loggingService.profileEndWithSuccess(r,a.a.getGraphDetailsEnd),{graphObjects:t,thumbnailPhotos:n,principalIdToRoleMap:i}}).catch(e=>{throw this.loggingService.profileEnd(r,a.a.getGraphDetailsEnd,Object(s.b)(e),e,{objectIds:Object.keys(i)}),e})}return this.$q.resolve({graphObjects:[],thumbnailPhotos:{},principalIdToRoleMap:i})},this.oidToThumbnailPhotoCache={}}var t,i,r;return t=e,(i=[{key:"getUserRoles",value:function(){var e=this.$q.defer();return this.userRoles?e.resolve(this.userRoles):this.$http({method:"GET",url:"".concat(this.appSettings.microsoftGraphUrl,"/me/memberOf"),headers:{"Content-Type":"application/json"}}).then(t=>{this.userRoles=t&&t.data?t.data.value:{},e.resolve(this.userRoles)},t=>{this.loggingService.logError("GraphService.GetUserRolesFailed",t),e.reject(t)}),e.promise}},{key:"getThumbnailPhotos",value:function(e){var t={},i=e.filter(e=>!this.oidToThumbnailPhotoCache[e.toLowerCase()]||(t[e.toLowerCase()]=this.oidToThumbnailPhotoCache[e.toLowerCase()],!1));return 0===i.length?this.$q.resolve(t):this.getNonCachedThumbnailPhotos(i).then(e=>f(f({},t),e))}},{key:"getCachedThumbnailPhotos",value:function(e){var t={};return e.forEach(e=>{this.oidToThumbnailPhotoCache[e.toLowerCase()]&&(t[e.toLowerCase()]=this.oidToThumbnailPhotoCache[e.toLowerCase()])}),t}},{key:"getObjectsById",value:function(e,t){var i=t;return this.getTenantIdFromUserSession(t).then(t=>(i=t,this.$http({method:"POST",url:"".concat(this.appSettings.microsoftGraphUrl,"/directoryObjects/getByIds"),data:{ids:e,types:[d.a.DirectoryObjectTypes.group,d.a.DirectoryObjectTypes.user]}}))).then(t=>{var r=this.parseGraphValueArrayResponse(t,{sessionTenantId:i,objectIds:e,method:"GraphService.getObjectsById"});return r.forEach(e=>{e.objectType=Object(p.d)(e)}),r})}},{key:"queryUsers",value:function(e){return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>this.sessionService.isOrgId?this.queryAADUser(e):this.queryMSAUser(e))}},{key:"querySharepointSites",value:function(e){var t=[],i={};return e.forEach(e=>{var r=this.loggingService.profileStart(a.a.graphServiceQuerySharepointSiteStart),n=this.querySharepointSite(e).then(t=>{i[e.toLowerCase()]=t,this.loggingService.profileEndWithSuccess(r,a.a.graphServiceQuerySharepointSiteEnd)}).catch(e=>{this.loggingService.profileEnd(r,a.a.graphServiceQuerySharepointSiteEnd,s.a.Warning,e)});t.push(n)}),this.$q.all(t).then(()=>i)}},{key:"querySharepointLists",value:function(e){var t=[],i={};return e.forEach(e=>{var r=this.loggingService.profileStart(a.a.graphServiceQuerySharepointListStart),n=this.querySharepointList(e).then(t=>{i[e.site.toLowerCase()]=i[e.site.toLowerCase()]||{},i[e.site.toLowerCase()][e.list.toLowerCase()]=t,this.loggingService.profileEndWithSuccess(r,a.a.graphServiceQuerySharepointListEnd)}).catch(e=>{this.loggingService.profileEnd(r,a.a.graphServiceQuerySharepointListEnd,s.a.Warning,e)});t.push(n)}),this.$q.all(t).then(()=>i)}},{key:"queryGroups",value:function(e){return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>{if(!this.sessionService.isOrgId)return this.$q.resolve([]);var t=e.tenantId,i=this.getStartsWithQueryValue(e.searchText,{key:"displayName",value:e.searchDisplayName},{key:"mail",value:e.searchMail});return this.getTenantIdFromUserSession(t).then(t=>{var r=!!Object(u.o)(e.securityEnabled)||e.securityEnabled,n="(groupTypes/any(c:c eq 'Unified') or securityEnabled eq ".concat(r,") and (").concat(i,")"),o=e.pageSize||10;return e.queryModernGroups||(n="securityEnabled eq ".concat(r," and (").concat(i,")")),this.$http({method:"GET",url:"".concat(this.appSettings.microsoftGraphUrl,"/groups?$filter=").concat(n,"&$top=").concat(o),timeout:e.cancel}).then(e=>this.parseGraphValueArrayResponse(e,{sessionTenantId:t,method:d.d.QueryGroups})).catch(e=>(this.loggingService.logWarning(d.d.QueryGroups,e),[]))})})}},{key:"queryTenantDetails",value:function(e){return this.getTenantIdFromUserSession(e).then(e=>this.$http({method:"GET",url:"".concat(this.appSettings.microsoftGraphUrl,"/organization")}).then(t=>this.parseGraphValueArrayResponse(t,{sessionTenantId:e,method:d.d.QueryTenantDetails})))}},{key:"getMemberGroups",value:function(e,t){return this.getTenantIdFromUserSession(t).then(t=>{var i={method:"POST",url:"".concat(this.appSettings.microsoftGraphUrl,"/users/").concat(e,"/getMemberGroups"),data:{securityEnabledOnly:!0}};return this.$http(i).then(e=>this.parseGraphValueArrayResponse(e,{sessionTenantId:t,method:d.d.QueryMemberGroups}))})}},{key:"escapeSearchText",value:function(e){return(e||"").replace(/'/g,"''")}},{key:"getNonCachedThumbnailPhotos",value:function(e){var t=[],i={},r=this.$q.defer();return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(n=>{e.forEach(e=>{if(n&&n.userInfo&&n.userInfo.tenantId){var r=this.loggingService.profileStart(a.a.graphServiceGetThumbnailStart),o="".concat(this.appSettings.microsoftGraphUrl,"/users/").concat(e,"/photo/$value"),l=this.$http.get(o,{responseType:"arraybuffer"}).then(t=>{i[e.toLowerCase()]="data:image/JPEG;base64,".concat(Object(u.a)(t.data)),this.loggingService.profileEndWithSuccess(r,a.a.graphServiceGetThumbnailEnd),this.oidToThumbnailPhotoCache[e.toLowerCase()]=i[e.toLowerCase()]}).catch(t=>{t&&t.status&&404===t.status?(this.loggingService.logWarning("GraphService.GetThumbnailPhotos","Thumbnail image not found",t),this.loggingService.profileEndWithSuccess(r,a.a.graphServiceGetThumbnailEnd),i[e.toLowerCase()]=this.assetService.userPlaceholder,this.oidToThumbnailPhotoCache[e.toLowerCase()]=i[e.toLowerCase()]):this.loggingService.profileEnd(r,a.a.graphServiceGetThumbnailEnd,Object(s.b)(t))});t.push(l)}else t.push(this.$q.resolve(()=>{i[e.toLowerCase()]=this.assetService.userPlaceholder}))}),this.$q.all(t).finally(()=>{r.resolve(i)})}),r.promise}},{key:"getTenantIdFromUserSession",value:function(e){return e?this.$q.resolve(e):this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(e=>e.isAuthenticated&&e.userInfo.userType!==h.b.MicrosoftAccount?this.$q.resolve(e.userInfo.tenantId):this.$q.resolve(""))}},{key:"querySharepointSite",value:function(e){var t=Object(n.a)(e);return this.$http({method:"GET",url:"".concat(this.appSettings.microsoftGraphUrl,"/sites/").concat(t.hostname,":").concat(t.path)}).then(e=>this.parseGraphValueResponse(e,{method:d.d.QuerySharepointSite})).then(e=>(e.webUrl=e.webUrl.toLowerCase(),e))}},{key:"querySharepointList",value:function(e){var t=Object(n.a)(e.site),i=Object(u.p)(t.path)||"/"===t.path?"".concat(this.appSettings.microsoftGraphUrl,"/sites/").concat(t.hostname,"/lists/").concat(e.list):"".concat(this.appSettings.microsoftGraphUrl,"/sites/").concat(t.hostname,":").concat(t.path,":/lists/").concat(e.list);return this.$http({method:"GET",url:i}).then(e=>this.parseGraphValueResponse(e,{method:d.d.QuerySharepointList})).then(e=>(e.webUrl=e.webUrl.toLowerCase(),e.id=e.id.toLowerCase(),e))}},{key:"queryAADUser",value:function(e){var t,i=e.tenantId,r=e.pageSize||10,n=this.getStartsWithQueryValue(e.searchText,{key:"userPrincipalName",value:e.searchUserPrincipalName},{key:"displayName",value:e.searchDisplayName},{key:"mail",value:e.searchMail}),o=e.excludeGuestUsers?"userType ne 'Guest' and (".concat(n,")"):n;return this.getTenantIdFromUserSession(i).then(i=>(t=i,this.$http(f(f({method:"GET",url:"".concat(this.appSettings.microsoftGraphUrl,"/users?$filter=").concat(o,"&$top=").concat(r).concat(e.excludeGuestUsers?"&$count=true":"").concat("&$select=businessPhones,displayName,givenName,id,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,externalUserState")},e.excludeGuestUsers?{headers:{ConsistencyLevel:"eventual"}}:{}),{},{timeout:e.cancel})))).then(e=>this.parseGraphValueArrayResponse(e,{sessionTenantId:t,method:d.d.QueryAADUser})).then(t=>e.excludeGuestUsers?t.filter(e=>{var t;return-1===(null===(t=e.userPrincipalName)||void 0===t?void 0:t.indexOf(d.c))}):t.filter(e=>e.externalUserState!==d.b.PendingAcceptance))}},{key:"queryMSAUser",value:function(e){var t=e.pageSize||10;return this.$http({method:"GET",url:"".concat(this.appSettings.microsoftGraphUrl,"/me/people/?$search=").concat(e.searchText,"&top=").concat(t),timeout:e.cancel}).then(e=>this.parseGraphValueArrayResponse(e,{method:d.d.QueryMSAUser}).reduce((e,t)=>(t.scoredEmailAddresses[0]&&t.scoredEmailAddresses[0].address&&e.push({mail:t.scoredEmailAddresses[0].address,displayName:t.displayName}),e),[]))}},{key:"getInvalidTenantIdError",value:function(){return this.getClientError(o.c.graphServiceInvalidTenantId,this.clientResources.GraphService.InvalidTenantId)}},{key:"getClientError",value:function(e,t){return new o.a(e,t,null,{isAuthenticated:this.sessionService.isAuthenticated,isConsumerDomain:this.sessionService.isConsumerDomain})}},{key:"getStartsWithQueryValue",value:function(e){e=this.escapeSearchText(e);for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return encodeURIComponent(i.filter(e=>e&&!1!==e.value).map(t=>"startswith(".concat(t.key,", '").concat(e,"')")).join(" or "))}},{key:"parseGraphValueArrayResponse",value:function(e,t){if(e&&200===e.status&&e.data&&e.data.value&&e.data.value.length>=0)return e.data.value;throw new o.a(o.c.graphServiceQueryBadResponse,this.clientResources.GraphService.Query.BadResponse,null,{errorInfo:t,responseStatusCode:e&&e.status,responseData:e&&e.data})}},{key:"parseGraphValueResponse",value:function(e,t){if(e&&200===e.status&&e.data)return e.data;throw new o.a(o.c.graphServiceQueryBadResponse,this.clientResources.GraphService.Query.BadResponse,null,{errorInfo:t,responseStatusCode:e&&e.status,responseData:e&&e.data})}}])&&b(t.prototype,i),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();w.$inject=[c.a.services.$http,c.a.services.$q,c.a.services.appSettings,c.a.services.assetService,c.a.services.clientResources,c.a.services.logging,c.a.services.promiseHelperService,c.a.services.session],r.a.service(c.a.services.graph,w)},33576:function(e,t,i){"use strict";var r=i(15521);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b})),i.d(t,"c",(function(){return r.c})),i.d(t,"d",(function(){return r.d})),i.d(t,"e",(function(){return r.e}))},33577:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33454),a=i(33360),s=i(33571);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.xrmService=t}var t,i,r;return t=e,(i=[{key:"searchUsers",value:function(e){return Object(o.a)(this.xrmService.makeXrmCall(s.a.GET,Object(a.d)("/systemusers?$filter=startswith(firstname, '{0}') or startswith(lastname, '{0}') or startswith(fullname, '{0}') or startswith(internalemailaddress, '{0}')",e)).then(e=>e.data.value))}},{key:"getXrmSystemUser",value:function(e){return Object(o.a)(this.xrmService.makeXrmCall(s.a.GET,Object(a.d)("/systemusers({0})",e))).then(e=>e.data)}},{key:"getXrmTeam",value:function(e){return Object(o.a)(this.xrmService.makeXrmCall(s.a.GET,Object(a.d)("/teams({0})",e))).then(e=>e.data)}},{key:"getXrmSystemUsers",value:function(e){if(0===e.length)return Promise.resolve([]);var t="".concat("/systemusers","?$filter=").concat(e.map(e=>"systemuserid eq '".concat(e,"'")).join(" or "));return Object(o.a)(this.xrmService.makeXrmCall(s.a.GET,t)).then(e=>e.data.value)}},{key:"searchTeams",value:function(e){return Object(o.a)(this.xrmService.makeXrmCall(s.a.GET,Object(a.d)("/teams?$filter=startswith(name, '{0}') or startswith(emailaddress, '{0}')",e)).then(e=>e.data.value))}},{key:"getXrmTeams",value:function(e){if(0===e.length)return Promise.resolve([]);var t="".concat("/teams","?$filter=").concat(e.map(e=>"teamid eq '".concat(e,"'")).join(" or "));return Object(o.a)(this.xrmService.makeXrmCall(s.a.GET,t)).then(e=>e.data.value)}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[n.a.services.xrmService],r.a.service(n.a.services.xrmSystemUsersClient,u)},33578:function(e,t,i){"use strict";var r=i(33331),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.alerts=void 0,this.alerts=[]}var t,i,r;return t=e,(i=[{key:"dequeueAlert",value:function(){var e=this.alerts.shift();return this.emptyAlerts(),e}},{key:"enqueueAlert",value:function(e){this.alerts.push(e)}},{key:"hasAlerts",value:function(){return this.alerts.length>0}},{key:"emptyAlerts",value:function(){this.alerts=[]}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.$inject=[],r.a.service(n.a.services.alertService,s)},33579:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33303),a=i(13078);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function c(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d="v0",p="msflowportal.storageCache",h=function(){function e(t,i,r,n,o){s(this,e),this.loggingService=t,this.storageService=i,this.cacheClearInterval=r,this.cacheId=n,this.storageType=o}return c(e,[{key:"get",value:function(e){var t=this.getItem(e);return t?t.value:void 0}},{key:"set",value:function(e,t){var i=this.fetchItemBundle();(i=this.cleanupItemBundle(i)).itemsByKey[e]={lastSavedTime:Date.now(),value:t},this.storeItemBundle(i)}},{key:"trySet",value:function(e,t){try{return void this.set(e,t)}catch(i){return this.loggingService.logError("StorageCache.trySet encountered exception saving to storage for cache ".concat(this.cacheId," and item ").concat(e),i),i}}},{key:"remove",value:function(e){var t=this.fetchItemBundle();t=this.cleanupItemBundle(t,[e]),this.storeItemBundle(t)}},{key:"getItem",value:function(e){var t=this.fetchItemBundle(),i=(t=this.cleanupItemBundle(t)).itemsByKey[e];return i||void 0}},{key:"isStorageAvailable",value:function(){return!(this.storageType===a.b.LocalStorage&&!this.storageService.isLocalStorageAvailable||this.storageType===a.b.SessionStorage&&!this.storageService.isSessionStorageAvailable)}},{key:"getStorageKey",value:function(){return"".concat(p,".").concat(this.cacheId)}},{key:"fetchItemBundle",value:function(){if(this.isStorageAvailable()){var e,t=this.storageService.getItem(this.getStorageKey(),this.storageType);try{e=JSON.parse(t)}catch(i){this.loggingService.logError("StorageCache.fetchItemBundle encountered invalid JSON in storage for cache ".concat(this.cacheId),i)}return e}}},{key:"storeItemBundle",value:function(e){if(this.isStorageAvailable()){var t=JSON.stringify(e);this.storageService.saveItem(this.getStorageKey(),t,this.storageType)}}},{key:"cleanupItemBundle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e&&e.version===d||(e={version:d,itemsByKey:{}}),Object(o.a)(e.itemsByKey,e=>{var i=e.value;(!i||i.lastSavedTime+this.cacheClearInterval<=this.getCurrentTime())&&t.push(e.key)});for(var i=0;i<t.length;i++)delete e.itemsByKey[t[i]];return e}},{key:"getCurrentTime",value:function(){return Date.now()}}]),e}(),m=function(){function e(t,i,r){s(this,e),this.appSettings=t,this.loggingService=i,this.storageService=r}return c(e,[{key:"Create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.b.SessionStorage,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.appSettings.storageCacheClearInterval;return new h(this.loggingService,this.storageService,i,e,t)}}]),e}();m.$inject=[n.a.services.appSettings,n.a.services.logging,n.a.services.storage],r.a.service(n.a.services.storageCacheFactory,m)},33580:function(e,t,i){"use strict";var r=i(33331),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$timeout=i,this.loggingService=r}var t,i,r;return t=e,(i=[{key:"asyncRetry",value:function(e,t,i,r){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=0,a=Date.now(),s=this.$q.defer(),l=()=>{i().then(e=>{s.resolve(e)}).catch(i=>{var c;if(this.loggingService.logError("AlgorithmsService.AsyncRetry",i),++o>=e||r&&Date.now()-a>=r||n.length>0&&!n.includes(null==i||null===(c=i.error)||void 0===c?void 0:c.code))s.reject(i);else{var u=this.$timeout(l,t);s.notify({failureReason:i,executionCount:o,timeoutPromise:u})}})};return l(),s.promise}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.$inject=[n.a.services.$q,n.a.services.$timeout,n.a.services.logging],r.a.service(n.a.services.algorithms,s)},33581:function(e,t,i){"use strict";var r=i(33582),n=i(33327),o=i(33360),a=i(33528),s=i(33583),l=i(33571),c=i(33331);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.oidToXrmPermissionsCache=void 0,this.oidToXrmPermissionsCache={}}var t,i,n;return t=e,(i=[{key:"getSystemUserInfo",value:function(e,t){var i=Object(o.d)(r.a.GetSystemUsersInfo,t);return e.makeXrmCall(l.a.GET,i).then(e=>e.data).catch(e=>{throw e})}},{key:"getTeamInfoWithOwnerId",value:function(e,t){return t.makeXrmCall(l.a.GET,"teams(".concat(e,")")).then(e=>e.data).catch(e=>{throw e})}},{key:"mapPermissionsToXrm",value:function(e){switch(e){case a.b.CanView:return s.b.ReadAccess;case a.b.CanViewWithShare:return s.b.ShareAccess;case a.b.CanEdit:return s.b.ReadWriteAccess;case a.b.Owner:return s.b.Owner;default:throw new Error("mapPermissionsToXrm: Unexpected role name ".concat(e))}}},{key:"mapPermissionsToRp",value:function(e){switch(e){case s.b.ReadAccess:case s.b.ReadAccessLegacy:return a.b.CanView;case s.b.ShareAccess:case s.b.ShareAccessLegacy:return a.b.CanViewWithShare;case s.b.ReadWriteAccess:return a.b.CanEdit;case s.b.Owner:return a.b.Owner;default:throw new Error("mapPermissionsToRp: Unexpected role name ".concat(e))}}},{key:"mapXrmPermissionsToRp",value:function(e,t,i,r,n){return this.$q.all(e.PrincipalAccesses.map(e=>{var o=e.Principal.ownerid,s=e.Principal.organizationid,l=e.Principal["@odata.type"],c=this.mapPermissionsToRp(e.AccessMask),u=o||s;if(this.oidToXrmPermissionsCache[u.toLowerCase()])return this.oidToXrmPermissionsCache[u.toLowerCase()].properties.roleName!==c&&(this.oidToXrmPermissionsCache[u.toLowerCase()].properties.roleName=c),this.$q.resolve(this.oidToXrmPermissionsCache[u.toLowerCase()]);if("#Microsoft.Dynamics.CRM.organization"===l){var d={name:s,id:i,type:"Microsoft.PowerApps/apis/permissions",properties:{roleName:c,principal:{id:s,type:a.a.Tenant,displayName:r,email:void 0}}};return this.oidToXrmPermissionsCache[s.toLowerCase()]=d,this.$q.resolve(d)}return"#Microsoft.Dynamics.CRM.team"===l?this.getTeamInfoWithOwnerId(o,t).then(e=>{var t;return e?(t={name:e.ownerid,id:i,type:"Microsoft.PowerApps/apis/permissions",properties:{roleName:c,principal:{id:o,type:a.a.Group,displayName:e.name,email:e.emailaddress}}},this.oidToXrmPermissionsCache[o.toLowerCase()]=t):n.logInfo("CustomApiShareTabCtrl.GetTeamInfoWithOwnerId","The team with id ".concat(o," no longer exists in Dataverse.")),t}).catch(e=>{throw e}):this.getSystemUserInfo(t,o).then(e=>{var t;return 1===e.value.length?(t={name:o,id:i,type:"Microsoft.PowerApps/apis/permissions",properties:{roleName:c,principal:{id:o,type:a.a.User,displayName:e.value[0].fullname,email:e.value[0].domainname}}},this.oidToXrmPermissionsCache[o.toLowerCase()]=t):n.logInfo("CustomApiShareTabCtrl.GetSystemUserInfo","The user with id ".concat(o," no longer exists in Dataverse.")),t}).catch(e=>{throw e})}))}}])&&u(t.prototype,i),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();p.$inject=[n.a.services.$q],c.a.service(n.a.services.xrmPermissionsService,p)},33582:function(e,t,i){"use strict";t.a={RetrieveSharedPrincipalAccess:"RetrieveSharedPrincipalsAndAccess(Target=@tid)?@tid={'@odata.id':'connectors({0})'}",RetrievePrincipalAccess:"/systemusers(azureactivedirectoryobjectid={0})/Microsoft.Dynamics.CRM.RetrievePrincipalAccess(Target=@tid)?@tid={'@odata.id':'connectors({1})'}",GetSystemUsersAad:"/systemusers(azureactivedirectoryobjectid={0})",GetSystemUsers:"/systemusers({0})",GetConnectorOwner:"connectors?$select=_ownerid_value&$filter= connectorinternalid eq '{0}'",ModifyAccess:"ModifyAccess",RevokeAccess:"RevokeAccess",GetSystemUsersInfo:"systemusers?$select=fullname,domainname&$filter=azureactivedirectoryobjectid eq '{0}' or systemuserid eq '{0}'",GetTeam:"teams?$filter=azureactivedirectoryobjectid eq '{0}'"}},33583:function(e,t,i){"use strict";var r=i(33584);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b}))},33584:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var r=function(e){return e.ReadAccessLegacy="ReadAccess",e.ReadAccess="ReadAccess, AppendAccess, AppendToAccess",e.ReadWriteAccess="ReadAccess, WriteAccess, AppendAccess, AppendToAccess, DeleteAccess, ShareAccess",e.ShareAccessLegacy="ReadAccess, ShareAccess",e.ShareAccess="ReadAccess, ShareAccess, AppendAccess, AppendToAccess",e.Owner="ReadAccess, WriteAccess, AppendAccess, AppendToAccess, CreateAccess, DeleteAccess, ShareAccess, AssignAccess",e}({}),n=function(e){return e.Team="Microsoft.Dynamics.CRM.team",e.Organization="Microsoft.Dynamics.CRM.organization",e.SystemUser="Microsoft.Dynamics.CRM.systemuser",e.Connector="Microsoft.Dynamics.CRM.connector",e}({})},33585:function(e,t,i){"use strict";var r=i(33331),n=i(33354),o=i(33392),a=i(33327),s=i(11891),l=i(13202),c=i(15341),u=i(33586),d=i(20920);function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function h(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){m(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function m(e,t,i){return(t=f(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,i,r,n,o,a,s,l,c,u,d,p,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.loggingService=i,this.plansClientCreateAndRenew=r,this.sessionService=n,this.widgetUtilService=o,this.planStore=a,this.planService=s,this.promiseHelper=l,this.clientResources=c,this.graphService=u,this.assetService=d,this.licenseManagementService=p,this.neptuneService=h}var t,i,r;return t=e,(i=[{key:"getUserPlan",value:function(){return this.planStore.currentUserPlan}},{key:"getActiveUserPlans",value:function(){return this.getUserPlans().filter(e=>Object(s.a)(e.properties.capabilityStatus,c.f.enabled)&&!this.isPlanExpired(e))}},{key:"getUserPlans",value:function(){return this.planStore.userPlans}},{key:"refreshUserPlans",value:function(){return this.promiseHelper.toAngularPromise(this.planService.refreshPlans())}},{key:"hasExpiredTrial",value:function(){return this.getUserPlans().filter(e=>this.isPlanTrial(e)&&this.isPlanExpired(e)).length>0}},{key:"isPlanExpired",value:function(e){return e=e||this.getUserPlan(),Date.parse(e.properties.expirationTime)<Date.now()&&e.properties.licenseSku!==c.g.free&&!0===e.properties.isTrial}},{key:"isPlanFree",value:function(){return Object(u.i)(this.getUserPlan())}},{key:"isPlanSeeded365",value:function(){return Object(u.j)(this.getUserPlan())}},{key:"isPlanFreeAndNotSeeded",value:function(){return Object(u.h)(this.getUserPlan())}},{key:"isP2Licensed",value:function(e){return(e=e||this.getUserPlan()).properties.licenseSku===c.g.p2}},{key:"isPlanTrial",value:function(e){return e=e||this.getUserPlan(),Object(u.k)(e)}},{key:"getPlanLicenseSku",value:function(){return this.getUserPlan().properties.licenseSku}},{key:"getPlanName",value:function(){return this.getUserPlan().name}},{key:"startOrExtendTrial",value:function(e){return this.planService.startOrExtendTrial(e,l.a,this.clientResources,this.clientResources,this.graphService,this.assetService,this.licenseManagementService,d.a,this.neptuneService)}},{key:"startTrial",value:function(e){var t=this.loggingService.profileStart(n.a.createTrialStart);return this.plansClientCreateAndRenew.createPlan({},{properties:{licenseId:e}}).then(e=>{this.loggingService.profileEnd(t,n.a.createTrialEnd,o.a.Success),this.setUserPlan(e.data)}).catch(e=>{throw this.loggingService.profileEnd(t,n.a.createTrialEnd,Object(o.b)(e),e),e})}},{key:"setUserPlan",value:function(e){this.planStore.addPlan(new c.d(h(h({},e),{},{isCurrent:!0})))}},{key:"setUserPlans",value:function(e){this.planStore.addUserPlansFromNgSessionInfo(e)}}])&&g(t.prototype,i),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[a.a.services.$q,a.a.services.logging,a.a.services.plansClientCreateAndRenew,a.a.services.session,a.a.services.widgetUtilService,a.a.services.planStore,a.a.services.planService,a.a.services.promiseHelperService,a.a.services.clientResources,a.a.services.graphService,a.a.services.assetService,a.a.services.licenseManagement,a.a.services.neptuneService],r.a.service(a.a.services.plan,v)},33586:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"m",(function(){return c})),i.d(t,"l",(function(){return u})),i.d(t,"e",(function(){return d})),i.d(t,"d",(function(){return p})),i.d(t,"i",(function(){return h})),i.d(t,"k",(function(){return m})),i.d(t,"j",(function(){return g})),i.d(t,"h",(function(){return f}));i(20430),i(31433),i(33360);var r=i(11891),n=(i(33355),i(15509)),o=i(15341);i.d(t,"b",(function(){return o.e}));var a=i(15342),s=i(33587);i.d(t,"c",(function(){return s.a}));i(33416),i(13144);i.d(t,"f",(function(){return n.a})),i.d(t,"g",(function(){return n.b}));var l={frequency:o.e.second,interval:1/0};function c(e){return e&&e.properties&&e.properties.policies&&e.properties.policies.calendarMonthFlowRunLimit?e.properties.policies.calendarMonthFlowRunLimit:o.a}function u(e,t){var i=Object(s.a)(t),l=Object(n.a)(e);return Object(r.a)(i.frequency,o.e.second)?i.interval>=l:!Object(r.a)(i.frequency,o.e.minute)||i.interval>=Object(a.a)(l)}function d(e){return e?e.filter(e=>e.properties&&Object(r.a)(e.properties.capabilityStatus,o.f.enabled)).map(e=>e&&e.properties&&e.properties.policies&&e.properties.policies.maxFlowExpiryInDays?e.properties.policies.maxFlowExpiryInDays:60).reduce((e,t)=>60===e?t:Math.max(e,t),60):60}function p(e){return!!e&&e.filter(e=>e.properties&&Object(r.a)(e.properties.capabilityStatus,o.f.enabled)).some(e=>!!(e&&e.properties&&e.properties.policies&&e.properties.policies.isFlowExpiryAutoRenewable)&&e.properties.policies.isFlowExpiryAutoRenewable,!1)}function h(e){return f(e)||g(e)}function m(e){return e&&e.properties&&e.properties.isTrial&&e.properties.licenseSku!==o.g.free}function g(e){return e&&e.properties&&(Object(r.a)(e.properties.licenseSku,o.g.o365)||Object(r.a)(e.properties.licenseSku,o.g.d365))}function f(e){return!e||!e.properties||Object(r.a)(e.properties.licenseSku,o.g.free)}},33587:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(15341);function n(e){var t;if(null===(t=e.properties.definition)||void 0===t||!t.triggers)return r.c;var i=Object.keys(e.properties.definition.triggers)[0],n=e.properties.definition.triggers[i].recurrence;return n||r.c}},33588:function(e,t,i){"use strict";var r=i(33331),n=i(33445),o=i(33327),a=i(33586),s=i(11891),l=i(33390),c=i(19922),u=i(12339),d=i(16926);function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var m=function(){function e(t,i,r,n,o,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.appSettings=i,this.environmentService=r,this.loggingService=n,this.planService=o,this.planStore=a,this.sessionService=s,this.widgetUtilService=l}var t,i,r;return t=e,(i=[{key:"getDefaultRecurrence",value:function(){return a.g(this.planService.getUserPlans())}},{key:"getMaxFlowFrequencyInSeconds",value:function(){return a.f(this.planService.getUserPlans())}},{key:"getMonthlyFlowRunAllotment",value:function(){return a.m(this.planService.getUserPlan())}},{key:"getMaxFlowExpiryInDays",value:function(){return a.e(this.planService.getUserPlans())}},{key:"getIsFlowExpiryAutoRenewable",value:function(){return a.d(this.planService.getUserPlans())}},{key:"checkUserCanShareFlow",value:function(e){return this.safeCheckTrue(()=>!this.sessionService.isConsumerDomain&&!this.environmentService.isDevEnvironment()&&(!this.planService.isPlanFreeAndNotSeeded()||this.shouldRemovePaywallsForPaygo||!!this.appSettings.featureFlags.removePaywalls&&!this.environmentService.isPayGoEnabled&&!!this.isCloudFlowNotContainUIFlow(e)))}},{key:"isCloudFlowNotContainUIFlow",value:function(e){var t;return!!e&&!Object(d.B)(e)&&!Object(d.j)(null===(t=e.properties)||void 0===t?void 0:t.definitionSummary)}},{key:"checkUserCanCreateGateways",value:function(){return this.shouldRemovePaywalls?this.$q.resolve(!0):this.safeCheckTrue(()=>!this.sessionService.isConsumerDomain&&!this.planService.isPlanFreeAndNotSeeded())}},{key:"checkFlowFrequencyIsAllowed",value:function(e){return this.safeCheckTrue(()=>a.l(this.planService.getUserPlans(),e))}},{key:"checkShouldShowFreePlanDialog",value:function(){return this.shouldRemovePaywalls?this.$q.resolve(!1):this.safeCheckFalse(()=>this.isBillingEnabled&&this.planService.isPlanFree()&&!this.environmentService.isDevEnvironment())}},{key:"checkShouldAllowPremiumApi",value:function(e){return this.shouldRemovePaywalls?this.$q.resolve(!0):this.safeCheckTrue(()=>this.shouldAllowPremiumApis(e))}},{key:"shouldShowUpgradeToProDialog",value:function(){return this.isBillingEnabled&&this.sessionService.isConsumerDomain}},{key:"shouldEnableFlowImportExport",value:function(){return!this.widgetUtilService.isWidgetPage()}},{key:"shouldEnableLogicAppTemplateExport",value:function(){return!this.widgetUtilService.isWidgetPage()}},{key:"shouldBlockWidgetUsage",value:function(){return this.safeCheckFalse(()=>this.widgetUtilService.isWidgetPage()&&(this.sessionService.isDisallowedFromInternalPlans||this.sessionService.userConsented||!!this.sessionService.isGuestUser())&&0===this.planStore.userPlans.length)}},{key:"checkCanAddOperation",value:function(e,t,i,r,o){if(o&&this.appSettings.featureFlags.enableUpsellingPremiumLicensesExperience&&this.appSettings.featureFlags.enableFlowLicensingChecker&&!this.sessionService.isConsumerDomain)return this.$q.resolve(!0);if(this.shouldRemovePaywalls)return this.$q.resolve(!0);if(r&&r.length>0&&Object(s.a)(r[0].type,l.h.manual)&&r[0].kind){var a=r[0];if(Object(s.a)(a.kind,l.f.POWERAPP)||Object(s.a)(a.kind,l.f.POWERAPPV2))return this.$q.resolve(!0)}return t===n.b.EnvironmentConsumption||i&&Object(u.h)(this.appSettings).includes(i)?this.$q.resolve(!0):this.safeCheckTrue(()=>Object(c.b)(e)?this.canUseHttp():!Object(c.d)(e)||this.shouldAllowPremiumApis([e.properties.api.id]))}},{key:"shouldAccessOnPremGateway",value:function(){if(this.shouldRemovePaywalls)return!0;var e=this.planStore.currentUserPlan;return!!e&&e.properties.policies.accessOnPremGateway}},{key:"shouldAllowPremiumApis",value:function(e){return this.planService.getActiveUserPlans().some(t=>t.properties.policies.accessPremiumApis||null!=e&&e.every(e=>this.planSpecificallyAllowsApi(t,e)))}},{key:"canUseHttp",value:function(){return this.planService.getActiveUserPlans().some(e=>e.properties.policies.accessPremiumApis||e.properties.policies.canUseCustomApis)}},{key:"planSpecificallyAllowsApi",value:function(e,t){return!!e.properties.policies.additionalAllowedPremiumApis&&e.properties.policies.additionalAllowedPremiumApis.some(e=>Object(s.a)(t,e))}},{key:"safeCheckTrue",value:function(e){var t=this.$q.defer();return e()?t.resolve(!0):this.planService.refreshUserPlans().catch(e=>{this.loggingService.logError("policiesService.safeCheck: Failed to update service plans",e)}).finally(()=>{t.resolve(e())}),t.promise}},{key:"safeCheckFalse",value:function(e){return this.safeCheckTrue(()=>!e()).then(e=>!e)}},{key:"isBillingEnabled",get:function(){return!this.widgetUtilService.isWidgetPage()}},{key:"shouldRemovePaywalls",get:function(){return(!!this.appSettings.featureFlags.removePaywalls||this.shouldRemovePaywallsForPaygo)&&!this.sessionService.isConsumerDomain}},{key:"shouldRemovePaywallsForPaygo",get:function(){return!!this.appSettings.featureFlags.removePaywallsForPayGoEnvironments&&!!this.environmentService.isPayGoEnabled}}])&&p(t.prototype,i),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();m.$inject=[o.a.services.$q,o.a.services.appSettings,o.a.services.environment,o.a.services.logging,o.a.services.plan,o.a.services.planStore,o.a.services.session,o.a.services.widgetUtilService],r.a.service(o.a.services.policies,m)},33589:function(e,t,i){"use strict";var r=i(33331),n=i(33590),o=i(33327),a=i(33437);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.planService=i,this.policiesService=r,this.sessionService=o,this.telemetryService=s,this.show=void 0,this.dialogType=void 0,this.callback=void 0,this.showUpgradeToProRequiredDialog=e=>{this.showDialog(n.b.upgradeToPro,e)},this.showDialog=(e,t,i)=>{this.hide(),this.sessionService.isConsumerDomain&&e!==n.b.recurrenceUpgradeToPro?this.dialogType=i?n.b.blockedFeatureUpgradeToPro:n.b.upgradeToPro:this.dialogType=e,this.telemetryService.tagEvent(a.a.BillingDialogShown,{dialogType:e}),this.callback=t,this.show=!0},this.hide=()=>{this.show=!1}}var t,i,r;return t=e,(i=[{key:"showStartFreeTrialDialog",value:function(e){this.showDialog(n.b.startFreeTrial,e)}},{key:"showStartAiBuilderTrialDialog",value:function(e){this.showDialog(n.b.startAiBuilderTrial,e)}},{key:"showExtendAiBuilderTrialDialog",value:function(e){this.showDialog(n.b.extendAiBuilderTrial,e)}},{key:"showAiBuilderTrialCapacityLimitDialog",value:function(e){this.showDialog(n.b.aiBuilderTrialCapacityLimit,e)}},{key:"showAiBuilderTrialCountLimitDialog",value:function(e){this.showDialog(n.b.aiBuilderTrialCountLimit,e)}},{key:"showAiBuilderNotAllowedToStartTrialDialog",value:function(e){this.showDialog(n.b.aiBuilderNotAllowedToStartTrial,e)}},{key:"showAiBuilderExtendAiBuilderTrialRenewalFormDialog",value:function(e){this.showDialog(n.b.extendAiBuilderTrialRenewalForm,e)}},{key:"showRecurrenceStartTrialDialog",value:function(e){this.showDialog(n.b.recurrenceStartTrial,e)}},{key:"showRecurrenceUpgradeToProRequiredDialog",value:function(e){this.showDialog(n.b.recurrenceUpgradeToPro,e)}},{key:"showBlockedFeatureStartTrialDialog",value:function(e){this.showDialog(n.b.blockedFeatureStartTrial,e,!0)}},{key:"showBillingAdminPurchaseDialog",value:function(e){this.showDialog(n.b.billingAdmin,e)}},{key:"showIndividualPurchaseNotSupportedDialog",value:function(e){this.showDialog(n.b.individualPurchaseNotSupported,e)}},{key:"showFeatureBlockedOnDeveloperEnvironment",value:function(e){this.showDialog(n.b.featureBlockedOnDeveloperEnvironment,e)}},{key:"showOfficePortalSignupDialog",value:function(e){this.showDialog(n.b.officePortalSignup,e)}},{key:"tryBlockMSA",value:function(){this.policiesService.shouldShowUpgradeToProDialog()&&this.showUpgradeToProRequiredDialog(()=>{window.location.assign("/")})}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[o.a.services.appSettings,o.a.services.plan,o.a.services.policies,o.a.services.session,o.a.services.telemetry],r.a.service(o.a.services.trialDialog,c)},33590:function(e,t,i){"use strict";i.d(t,"b",(function(){return g})),i.d(t,"a",(function(){return f}));var r=i(33327),n=i(33360),o=i(33398),a=i(13272),s=i(15412),l=i(16811),c=i(14900),u=i(33591),d=i(15342),p=i(12337);function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g={aiBuilderTrialCapacityLimit:"DIALOG_AIBUILDERTRIALCAPACITYLIMIT",aiBuilderTrialCountLimit:"DIALOG_AIBUILDERTRIALCOUNTLIMIT",aiBuilderNotAllowedToStartTrial:"DIALOG_AIBUILDERNOTALLOWEDTOSTARTTRIAL",billingAdmin:"DIALOG_BILLINGADMIN",blockedFeatureStartTrial:"DIALOG_BLOCKEDFEATURESTARTTRIAL",extendAiBuilderTrial:"DIALOG_EXTENDAIBUILDERTRIAL",extendAiBuilderTrialRenewalForm:"DIALOG_EXTENDAIBUILDERTRIALRENEWALFORM",blockedFeatureUpgradeToPro:"DIALOG_BLOCKEDFEATUREUPGRADETOPRO",officePortalSignup:"DIALOG_OFFICEPORTALSIGNUP",recurrenceStartTrial:"DIALOG_RECURRENCESTARTTRIAL",recurrenceUpgradeToPro:"DIALOG_RECURRENCEUPGRADETOPRO",startFreeTrial:"DIALOG_STARTFREETRIAL",startAiBuilderTrial:"DIALOG_STARTAIBUILDERTRIAL",upgradeToPro:"DIALOG_UPGRADETOPRO",individualPurchaseNotSupported:"DIALOG_INDIVIDUALPURCHASENOTSUPPORTED",featureBlockedOnDeveloperEnvironment:"DIALOG_FEATUREBLOCKEDONDEVELOPERENVIRONMENT"},f=function(){function e(t,i,r,n,o,a,s,l,c,u,d,p,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$scope=i,this.$sce=r,this.appSettings=n,this.clientResources=o,this.entitlementsService=a,this.loggingService=s,this.planService=l,this.policiesService=c,this.sessionService=u,this.trialDialogService=d,this.assetService=p,this.routeCrafter=h,this.dialog=void 0,this.isActionInProgress=void 0,this.showTrialRenewalForm=!1,this.dismissTrialRenewalForm=()=>{this.showTrialRenewalForm=!1,this.trialDialogService.showExtendAiBuilderTrialDialog(this.trialDialogService.callback)},this.extendAiBuilderTrial=e=>{this.showTrialRenewalForm=!1,this.entitlementsService.startAiBuilderTrial(e).then(e=>{this.hide(),this.executeCallback(e)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"TrialDialogCtrl"}),this.isActionInProgress=!1,i.$watch(()=>d.show,()=>{this.trialDialogService.show&&this.trialDialogService.dialogType?this.openDialog(this.trialDialogService.dialogType):this.trialDialogService.show||(this.dialog=null)})}var t,i,r;return t=e,(i=[{key:"createTrialAndSetAsCurrentPlan",value:function(e){return this.planService.startOrExtendTrial(e)}},{key:"showDialog",get:function(){return!!this.dialog}},{key:"executeCallback",value:function(e){var t=this.trialDialogService.callback;"function"==typeof t&&t(e)}},{key:"openDialog",value:function(e){switch(e){case g.billingAdmin:this.dialog=this.billingAdminDialog;break;case g.startFreeTrial:this.dialog=this.startFreeTrialDialog;break;case g.startAiBuilderTrial:this.dialog=this.startAiBuilderTrialDialog;break;case g.extendAiBuilderTrial:case g.extendAiBuilderTrialRenewalForm:this.dialog=this.extendAiBuilderTrialDialog;break;case g.aiBuilderTrialCapacityLimit:this.dialog=this.aiBuilderTrialCapacityLimitDialog;break;case g.aiBuilderTrialCountLimit:this.dialog=this.aiBuilderTrialCountLimitDialog;break;case g.aiBuilderNotAllowedToStartTrial:this.dialog=this.aiBuilderNotAllowedToStartTrialDialog;break;case g.recurrenceStartTrial:this.dialog=this.recurrenceStartTrialDialog;break;case g.upgradeToPro:this.dialog=this.premiumRequiredDialog;break;case g.recurrenceUpgradeToPro:this.dialog=this.recurrencePremiumRequiredDialog;break;case g.blockedFeatureStartTrial:var t=this.startFreeTrialDialog;this.dialog=t;break;case g.individualPurchaseNotSupported:this.dialog=this.individualPurchaseNotSupportedDialog;break;case g.blockedFeatureUpgradeToPro:var i=this.premiumRequiredDialog;i.acceptButton.action=()=>{this.hide(),this.redirectToFlows()},this.dialog=i;break;case g.featureBlockedOnDeveloperEnvironment:this.dialog=this.featureBlockedOnDeveloperEnvironmentDialog;break;case g.officePortalSignup:this.dialog=this.officePortalSignupDialog;break;default:this.dialog=null}}},{key:"redirectToFlows",value:function(){window.location.assign(Object(c.t)(this.routeCrafter))}},{key:"hide",value:function(){this.dialog=null,this.trialDialogService.hide()}},{key:"startFreeTrialDialog",get:function(){var e=this.planService.hasExpiredTrial()?this.clientResources.TrialDialog.StartTrial.TrialExpired.title:this.clientResources.TrialDialog.StartTrial.Title,t=Object(n.d)(this.clientResources.TrialDialog.StartTrial.Content,this.appSettings.brandName),i=this.planService.hasExpiredTrial()?this.getTextWithLink("".concat(this.clientResources.TrialDialog.StartTrial.TrialExpired.content," {0}"),Object(l.Ib)(),this.clientResources.Common.LearnMore,!0,o.a.BillingDialogLearnMoreClicked):this.getTextWithLink("".concat(t," {0}"),Object(l.Ib)(),this.clientResources.Common.LearnMore,!0,o.a.BillingDialogLearnMoreClicked);return{headerIcon:a.a.Diamond,title:e,content:i,cancelButton:{text:this.clientResources.Common.Cancel,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.StartFreeTrialDialogCancelClicked},acceptButton:{text:this.clientResources.TrialDialog.StartTrial.Button.StartTrial,action:()=>{this.createTrialAndSetAsCurrentPlan(this.appSettings.p2TrialPlanLicenseId).then(e=>{this.hide(),this.executeCallback(e)})},eventName:o.a.StartFreeTrialDialogStartTrialClicked},footerText:this.getTextWithLink(this.clientResources.TrialDialog.StartTrial.TermsAndConditions.Text,Object(p.F)(),this.clientResources.Common.TermsAndConditions,!0,o.a.BillingDialogTermAndConditionsClicked)}}},{key:"startAiBuilderTrialDialog",get:function(){return{headerImage:this.assetService.aiBuilderIcon,title:this.clientResources.AiBuilder.StartTrialDialog.Title,content:Object(n.d)("".concat(this.clientResources.AiBuilder.StartTrialDialog.Content," {0}"),this.getAiBuilderLearnMoreText(o.a.AiBuilderStartTrialDialogLearnMoreClicked,o.a.AiBuilderStartTrialDialogDocumentationClicked)),cancelButton:{text:this.clientResources.Common.Cancel,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.AiBuilderStartTrialDialogCancelClicked},acceptButton:{text:this.clientResources.TrialDialog.StartTrial.Button.StartTrial,action:()=>{this.entitlementsService.startAiBuilderTrial(void 0).then(e=>{this.hide(),this.executeCallback(e)})},eventName:o.a.AiBuilderStartTrialDialogStartTrialClicked}}}},{key:"extendAiBuilderTrialDialog",get:function(){return{headerImage:this.assetService.aiBuilderIcon,title:this.clientResources.AiBuilder.ExtendTrialDialog.Title,content:Object(n.d)("".concat(this.clientResources.AiBuilder.ExtendTrialDialog.Content," {0}"),this.getAiBuilderLearnMoreText(o.a.AiBuilderExtendTrialDialogLearnMoreClicked,o.a.AiBuilderExtendTrialDialogDocumentationClicked)),cancelButton:{text:this.clientResources.Common.Cancel,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.AiBuilderExtendTrialDialogCancelClicked},acceptButton:{text:this.clientResources.TrialDialog.StartTrial.Button.ExtendTrial,action:()=>{this.entitlementsService.checkAiBuilderEntitlementsStatus()===s.a.NotAllowedExpiredTrialWithTrialRenewalForm?(this.showTrialRenewalForm=!0,this.hide()):this.extendAiBuilderTrial(void 0)},eventName:o.a.AiBuilderExtendTrialDialogStartTrialClicked}}}},{key:"aiBuilderTrialCapacityLimitDialog",get:function(){return{headerImage:this.assetService.aiBuilderIcon,title:this.clientResources.AiBuilder.TrialCapacityLimitDialog.Title,content:Object(n.d)("".concat(this.clientResources.AiBuilder.TrialCapacityLimitDialog.Content," {0}"),this.getAiBuilderLearnMoreText(o.a.AiBuilderTrialCapacityLimitDialogLearnMoreClicked,o.a.AiBuilderTrialCapacityLimitDialogDocumentationClicked)),acceptButton:{text:this.clientResources.Common.GotIt,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.AiBuilderTrialCapacityLimitDialogCancelClicked}}}},{key:"aiBuilderTrialCountLimitDialog",get:function(){return{headerImage:this.assetService.aiBuilderIcon,title:this.clientResources.AiBuilder.TrialCountLimitDialog.Title,content:Object(n.d)("".concat(this.clientResources.AiBuilder.TrialCountLimitDialog.Content," {0}"),this.getAiBuilderLearnMoreText(o.a.AiBuilderTrialCountLimitDialogLearnMoreClicked,o.a.AiBuilderTrialCountLimitDialogDocumentationClicked)),acceptButton:{text:this.clientResources.Common.GotIt,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.AiBuilderTrialCountLimitDialogCancelClicked}}}},{key:"aiBuilderNotAllowedToStartTrialDialog",get:function(){return{headerImage:this.assetService.aiBuilderIcon,title:this.clientResources.AiBuilder.NotAllowedToStartTrialDialog.Title,content:Object(n.d)("".concat(this.clientResources.AiBuilder.NotAllowedToStartTrialDialog.Content," {0}"),this.getAiBuilderLearnMoreText(o.a.AiBuilderNotAllowedToStartTrialDialogLearnMoreClicked,o.a.AiBuilderNotAllowedToStartTrialDialogDocumentationClicked)),acceptButton:{text:this.clientResources.Common.GotIt,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.AiBuilderNotAllowedToStartTrialDialogCancelClicked}}}},{key:"recurrenceStartTrialDialog",get:function(){return{headerIcon:a.a.Diamond,title:this.clientResources.TrialDialog.StartTrial.Title,content:this.getTextWithLink("".concat(Object(n.d)(this.clientResources.TrialDialog.Recurrence.StartTrial.Content,Object(d.a)(this.policiesService.getMaxFlowFrequencyInSeconds()))," {0}"),Object(l.Ib)(),this.clientResources.Common.LearnMore,!0,o.a.BillingDialogLearnMoreClicked),cancelButton:{text:this.clientResources.Common.Cancel,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.StartFreeTrialDialogCancelClicked},acceptButton:{text:this.clientResources.TrialDialog.StartTrial.Button.StartTrial,action:()=>{this.createTrialAndSetAsCurrentPlan(this.appSettings.p2TrialPlanLicenseId).then(e=>{this.hide(),this.executeCallback(e)})},eventName:o.a.StartFreeTrialDialogStartTrialClicked},footerText:this.getTextWithLink(this.clientResources.TrialDialog.StartTrial.TermsAndConditions.Text,Object(p.F)(),this.clientResources.Common.TermsAndConditions,!0,o.a.BillingDialogTermAndConditionsClicked)}}},{key:"premiumRequiredDialog",get:function(){var e='<a data-event-name="'.concat(o.a.BillingDialogRedirectToSignupClicked,'"')+'href="'.concat(this.appSettings.signUpRedirectUrl,'">').concat(this.clientResources.Common.OrganizationAccount,"</a>"),t='<a data-event-name="'.concat(o.a.BillingDialogSignInWithOrgClicked,'"')+' href="'.concat(Object(l.Ob)(),'">').concat(this.clientResources.Common.WorkOrSchoolAccount,"</a>");return{headerIcon:a.a.Diamond,title:this.clientResources.TrialDialog.Premium.Title,content:this.$sce.trustAsHtml(Object(n.d)(this.clientResources.TrialDialog.Premium.Content,t,e)),acceptButton:{text:this.clientResources.Common.Ok,action:()=>{this.executeCallback(!1),this.hide()},eventName:o.a.PremiumRequiredDialogOkClicked}}}},{key:"recurrencePremiumRequiredDialog",get:function(){var e='<a data-event-name="'.concat(o.a.BillingDialogRedirectToSignupClicked,'"')+' href="'.concat(this.appSettings.signUpRedirectUrl,'">').concat(this.clientResources.Common.OrganizationAccount,"</a>"),t='<a data-event-name="'.concat(o.a.BillingDialogSignInWithOrgClicked,'"')+' href="'.concat(Object(l.Ob)(),'">').concat(this.clientResources.Common.WorkOrSchoolAccount,"</a>");return{headerIcon:a.a.Diamond,title:this.clientResources.TrialDialog.Premium.Title,content:this.$sce.trustAsHtml(Object(n.d)(this.clientResources.TrialDialog.Recurrence.Premium.Content,Object(d.a)(this.policiesService.getMaxFlowFrequencyInSeconds()),t,e)),acceptButton:{text:this.clientResources.Common.Ok,action:()=>{this.executeCallback(!1),this.hide()},eventName:o.a.PremiumRequiredDialogOkClicked}}}},{key:"billingAdminDialog",get:function(){return{headerIcon:a.a.Diamond,title:this.clientResources.TrialDialog.UpgradeToPro.Title,content:this.clientResources.TrialDialog.UpgradeToPro.Content,cancelButton:{text:this.clientResources.TrialDialog.UpgradeToPro.Button.Me,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.BillingAdminDialogJustMeClicked},acceptButton:{text:this.clientResources.TrialDialog.UpgradeToPro.Button.Team,action:()=>{this.executeCallback(!0),this.hide()},eventName:o.a.BillingAdminDialogForMyTeamClicked}}}},{key:"individualPurchaseNotSupportedDialog",get:function(){return{headerIcon:a.a.Diamond,title:this.clientResources.TrialDialog.IndividualPurchaseNotSupported.Title,content:this.clientResources.TrialDialog.IndividualPurchaseNotSupported.Content,acceptButton:{text:this.planService.isPlanTrial()?this.clientResources.Common.Ok:this.clientResources.TrialDialog.StartTrial.Button.StartTrial,action:()=>{this.createTrialAndSetAsCurrentPlan(this.appSettings.p2TrialPlanLicenseId).then(e=>{this.hide(),this.executeCallback(e),window.location.reload()})},eventName:o.a.IndividualPurchaseNotSupportedStartTrialClicked}}}},{key:"featureBlockedOnDeveloperEnvironmentDialog",get:function(){return{headerIcon:a.a.Diamond,title:this.clientResources.TrialDialog.FeatureBlockedOnDeveloperEnvironment.Title,content:this.clientResources.TrialDialog.FeatureBlockedOnDeveloperEnvironment.Content,acceptButton:{text:this.clientResources.Common.Ok,action:()=>{this.executeCallback(!1),this.hide()},eventName:o.a.FeatureBlockedOnDeveloperEnvironmentOKClicked}}}},{key:"officePortalSignupDialog",get:function(){return{headerIcon:a.a.Diamond,title:this.clientResources.TrialDialog.OfficePortalSignupRequired.Title,content:this.clientResources.TrialDialog.OfficePortalSignupRequired.Content,cancelButton:{text:this.clientResources.Common.Cancel,action:()=>{this.hide(),this.executeCallback(!1)},eventName:o.a.TrialDialogOfficePortalSignupDismissed},acceptButton:{text:this.clientResources.TrialDialog.OfficePortalSignupRequired.GetStarted,action:()=>{this.hide(),this.executeCallback(!0)},eventName:o.a.TrialDialogOfficePortalSignupClicked}}}},{key:"getTextWithLink",value:function(e,t,i,r,o){var a=r?"_blank":"_self",s='<a href="'.concat(t,'" target="').concat(a,'" data-event-name="').concat(o,'">').concat(i,"</a>");return Object(n.d)(e,s)}},{key:"getAiBuilderLearnMoreText",value:function(e,t){var i=this.getTextWithLink("{0}",Object(u.a)(this.appSettings),this.clientResources.AiBuilder.UpsellDialog.LearnMoreText,!0,e),r=this.getTextWithLink("{0}","https://go.microsoft.com/fwlink/?linkid=2101001",this.clientResources.AiBuilder.UpsellDialog.DocumentationPage,!0,t);return Object(n.d)(this.clientResources.AiBuilder.UpsellDialog.LearnMoreMessage,i,r)}}])&&h(t.prototype,i),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();f.$inject=[r.a.services.$q,r.a.services.$scope,r.a.services.$sce,r.a.services.appSettings,r.a.services.clientResources,r.a.services.entitlements,r.a.services.logging,r.a.services.plan,r.a.services.policies,r.a.services.session,r.a.services.trialDialog,r.a.services.assetService,r.a.services.routeCrafter]},33591:function(e,t,i){"use strict";function r(e){return"".concat(e.marketingPortalEndpoint,"/ai-builder")}i.d(t,"a",(function(){return r}))},33592:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(20107),a=i(33593),s=i(11806),l=i(11890),c=i(12339),u=i(20915),d=i(19997);function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var m=function(){function e(t,i,r,n,o,a,s,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$window=i,this.appSettings=r,this.connectionsClient=n,this.promiseHelperService=o,this.designerCoreLoader=a,this.xrmEntityHttpClient=s,this.loggingService=l,this.clientResources=c}var t,i,r;return t=e,(i=[{key:"renderDietDesigner",value:function(e,t,i,r){var n,c=this.connectionsClient.query(e),u=this.connectionsClient.refreshQuery().then(()=>this.getDesignerConnections(c,r));return this.$q.all([this.promiseHelperService.toAngularPromise(this.designerCoreLoader.loadDesignerScripts()),u]).then(e=>{var[r,n]=e;return i(r,n,t)}).then(e=>{var i=Object(s.c)(this.$window.location.search),r=Object(a.b)(t.properties.definition,i),c={};Object.keys(t.properties.definition&&t.properties.definition.parameters||{}).forEach(e=>{Object(l.a)(e,"$")||(c[a.a+e]="")});var u={definition:r=Object(a.b)(r,c),connectionReferences:t.properties.connectionReferences,references:t.properties.connectionReferences,properties:{sku:{name:"Consumption"}}},d={collapsePopulatedParameters:!0,expandAllCards:!1,skipValidation:!0,dietDesignerMarkup:t.properties.metadata&&t.properties.metadata.dietDesignerMarkup,initFromTemplate:!0};return n=Object(o.a)(e),this.promiseHelperService.toAngularPromise(n.loadWorkflow(u,d))}).then(()=>(n.render(),this.$q.resolve(n)))}},{key:"validateConnectionReferences",value:function(e){return(e||[]).map(e=>e&&e.connection&&!!e.connection.id).every(e=>!0===e)}},{key:"renderConnectionWizard",value:function(e,t,i,r,n){var a,s=this.connectionsClient.query(e),l=this.connectionsClient.refreshQuery().then(()=>this.getDesignerConnections(s,n)),u=t.properties.connectionReferences,d={expandAllCards:!1};return this.$q.all([this.promiseHelperService.toAngularPromise(this.designerCoreLoader.loadDesignerScripts()),l]).then(e=>{var[r,n]=e;return i(r,n,t)}).then(e=>{a=Object(o.b)(e,d)}).then(()=>a.initializeConnectionReferences(u,Object(c.l)(this.appSettings).definitionSchemaUri)).then(()=>(a.render(r),a))}},{key:"getXrmConnectionReferences",value:function(){return this.promiseHelperService.toAngularPromise(this.xrmEntityHttpClient.retrieveMultiple("connectionreferences").then(e=>e.data.value).catch(e=>(this.loggingService.logError("designerRenderService.getXrmConnectionReferences",e),[])))}},{key:"getDesignerConnections",value:function(e,t){return e?t?(this.loggingService.logInfo("designerRenderService.getDesignerConnections","isSolutionMode is true. Merging xrmConnectionReferences and availableConnections."),this.getXrmConnectionReferences().then(t=>{if(!t||t.length<1)return[];var i=Object(d.c)(e,t,u.a,this.clientResources);return this.loggingService.logInfo("designerRenderService.getDesignerConnections","Processed/merged connections with xrmConnectionReferences.",{startingConnectionCount:e.length,xrmConnectionReferencesCount:t.length,mergedConnectionsCount:i.length}),i})):this.$q.resolve(e):this.$q.resolve([])}}])&&p(t.prototype,i),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();m.$inject=[n.a.services.$q,n.a.services.$window,n.a.services.appSettings,n.a.services.connectionsClient,n.a.services.promiseHelperService,n.a.services.designerCoreLoader,n.a.services.xrmEntityClient,n.a.services.logging,n.a.services.clientResources],r.a.service(n.a.services.designerRenderService,m)},33593:function(e,t,i){"use strict";var r=i(17228);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.f}))},33594:function(e,t,i){"use strict";i.d(t,"a",(function(){return B}));var r=i(33331),n=i(33327),o=i(12066),a=i.n(o),s=i(33394),l=i(33586),c=i(33460),u=i(33360),d=i(18959),p=i(33396),h=i(33463),m=i(33354),g=i(33464),f=i(33459),v=i(33392),b=i(33593),y=i(13003),w=i(17914),S=i(13223),C=i(11890),k=i(33374),P=i(14867),x=i(11928),A=i.n(x),T=i(13144),R=i(12381),O=i(19997),D=i(18956);function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function F(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach((function(t){I(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function I(e,t,i){return(t=N(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function j(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,N(r.key),r)}}function N(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var M="diet",L="featured-oneclick",U="featured-skipdesigner";function B(e){return $(e,[U])}function $(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&e.properties&&e.properties.categoryNames&&e.properties.categoryNames.length>0){var r=e.properties.categoryNames.map(e=>(e||"").toUpperCase());return i?(t||[]).every(e=>-1!==r.indexOf(e.toUpperCase())):(t||[]).some(e=>-1!==r.indexOf(e.toUpperCase()))}return!1}var q=function(){function e(t,i,r,n,o,a,s,l,c,u,d,p,h,m,g,f,v,b){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.$window=r,this.apisClient=n,this.appSettings=o,this.clientResources=a,this.connectionHelper=s,this.connectionsClient=l,this.environmentService=c,this.flowsClient=u,this.loggingService=d,this.ngFlowService=p,this.policiesService=h,this.promiseHelperService=m,this.sessionService=g,this.templatesClient=f,this.widgetUtilService=v,this.environmentCapabilityService=b,this.$scope=void 0}var t,i,r;return t=e,(i=[{key:"shouldUseDietDesignerView",value:function(e,t){if(!e||!e.properties)return!1;var i=Object.keys(Object(k.b)(this.$window.location.search)).filter(e=>Object(C.a)(e,b.a)).length>0,r=!!e.properties.metadata&&!!e.properties.metadata.dietDesignerMarkup;return(t||!i||r)&&!B(e)&&!this.shouldRenderAsOneClickTemplate(e)&&(this.appSettings.featureFlags.forceDietDesigner||function(e,t){var i=t.isWidgetPage()&&t.getWidgetDietTemplateCategory()||null;return $(e,Object(u.p)(i)?[M]:[M,i])}(e,this.widgetUtilService))}},{key:"shouldRenderAsOneClickTemplate",value:function(e){var t=this.$window.location.search.toLowerCase().indexOf("forceoneclick=true")>-1;return function(e,t){var i=(null==t?void 0:t.isWidgetPage())&&t.getWidgetOneClickTemplateCategory()||null;return $(e,[L])||!Object(u.o)(i)&&!Object(u.n)(i)&&$(e,[i])}(e,this.widgetUtilService)||t}},{key:"getTemplate",value:function(e,t){this.$scope=e;var i=Object(h.c)(g.b.public,t,this.environmentService),r=this.templatesClient.get(this.$scope,{id:i});return r.$promise.then(()=>{if(!r||!r.properties){var e=new s.a(s.c.getTemplateError,"Error loading templateId: ".concat(i));return this.loggingService.logError(s.c.getTemplateError,e),this.$q.reject(e)}return this.$q.resolve(r)})}},{key:"autoCreateFlow",value:function(e,t,i){var r={templateName:t.templateName,galleryName:t.galleryName,defaultedToSolution:i},n=this.loggingService.profileStart(m.a.autoCreateFlowStart,r);return this.$scope=e,(t.connectionReferences?this.createFlowWithConnectionReferences(e,t):this.createFlow(t)).then(e=>{var t=Object(p.g)(e)?e.data.name:void 0;if(t)return this.widgetUtilService.isWidgetPage()&&(this.widgetUtilService.widgetCloseOnFlowSaveEnabled()&&this.widgetUtilService.setPostFlowSaveSucceeded(!0),this.widgetUtilService.fireFlowCreationSucceeded(t)),this.loggingService.profileEndWithSuccess(n,m.a.autoCreateFlowEnd,F({flowName:t},r)),this.flowsClient.refreshQuery(Object(p.c)({isPersonal:!0})),t;var i=new s.a(s.c.oneClickFlowCreationNoFlowName,this.clientResources.OneClickTemplate.NoFlowName,null,{responseStatusCode:e&&e.status,responseData:e&&e.data});throw this.widgetUtilService.isWidgetPage()&&(this.widgetUtilService.widgetCloseOnFlowSaveEnabled()&&this.widgetUtilService.setPostFlowSaveSucceeded(!1),this.widgetUtilService.fireFlowCreationError(i)),i}).catch(e=>{throw this.loggingService.profileEnd(n,m.a.autoCreateFlowEnd,Object(v.b)(e),e,r),e})}},{key:"createFlow",value:function(e){var t=this.connectionsClient.query(this.$scope),i=this.getFlowWithDefinitionFromTemplate(e),r=this.connectionsClient.refreshQuery(),n=this.apisClient.query(this.$scope);return this.$q.all([i,r,n.$promise]).then(e=>{var[i]=e,r=i,o=t.filter(e=>!Object(d.i)(e)),a=n;return this.createAndUpdateConnectionReferences(r,o,a)}).then(e=>this.createFlowOrSolutionFlow(e))}},{key:"createFlowWithConnectionReferences",value:function(e,t){var i={templateName:t.templateName,galleryName:t.galleryName},r=this.loggingService.profileStart(m.a.createFlowWithConnectionReferencesStart,i);return this.$scope=e,this.getFlowWithDefinitionFromTemplate(t).then(e=>{var i=e.properties.connectionReferences;return Object.keys(i||{}).forEach(t=>{i[t]&&this.updateRuntimeUrl(e,t,i[t])}),e.properties.connectionReferences=Object(P.j)(t.connectionReferences),this.createFlowOrSolutionFlow(e)}).then(e=>{var t=Object(p.g)(e)?e.data.name:void 0;if(t)return this.loggingService.profileEndWithSuccess(r,m.a.createFlowWithConnectionReferencesEnd,F(F({},i),{},{flowName:t})),e;throw new s.a(s.c.flowCreationNoFlowName,this.clientResources.TemplateCreationHelperService.CreateFlowFromTemplate.BadResponse,null,{responseStatusCode:e&&e.status,responseData:e&&e.data})}).catch(e=>(this.loggingService.profileEnd(r,m.a.createFlowWithConnectionReferencesEnd,Object(v.b)(e),e,i),this.$q.reject(e)))}},{key:"createFlowWithTemplateDefinition",value:function(e,t){var i=this.loggingService.profileStart(m.a.createFlowWithTemplateDefinitionStart);return this.$scope=e,this.getFlowWithDefinitionFromTemplateDefinition(t).then(e=>{var i=e.properties.connectionReferences;return Object.keys(i||{}).forEach(t=>{i[t]&&this.updateRuntimeUrl(e,t,i[t])}),e.properties.connectionReferences=Object(P.j)(t.connectionReferences),this.createFlowOrSolutionFlow(e)}).then(e=>{var t=Object(p.g)(e)?e.data.name:void 0;if(t)return this.loggingService.profileEndWithSuccess(i,m.a.createFlowWithTemplateDefinitionEnd,{flowName:t}),e;throw new s.a(s.c.flowCreationNoFlowName,this.clientResources.TemplateCreationHelperService.CreateFlowFromTemplateDefinition.BadResponse,null,{responseStatusCode:e&&e.status,responseData:e&&e.data})}).catch(e=>(this.loggingService.profileEnd(i,m.a.createFlowWithTemplateDefinitionEnd,Object(v.b)(e),e),this.$q.reject(e)))}},{key:"createFlowFromTemplateRoute",value:function(e,t){this.$scope=e;var i=g.b.public,r=Object(h.c)(i,t.templateName,this.environmentService),n={connectionReferences:Object(P.j)(t.connectionReferences),parameters:t.designTimeParameters,displayName:t.flowName},o=Object(u.d)("{0}/createFlow?api-version={1}",Object(R.a)(Object(T.c)(this.appSettings).flowRP,r),this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments),a={templateName:t.templateName,galleryName:t.galleryName},l=this.loggingService.profileStart(m.a.createFlowFromTemplateRouteStart,a);return this.promiseHelperService.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource)).then(e=>this.$http({method:"POST",url:o,data:n,headers:{Accept:"application/json",Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).then(e=>{if(this.loggingService.profileEndWithSuccess(l,m.a.createFlowFromTemplateRouteEnd,a),e&&201===e.status&&e.data&&e.data.flowDefinition&&e.data.flowDefinition.id){var t=this.flowsClient.get(this.$scope,{id:e.data.flowDefinition.id});return t.$promise.then(()=>({data:t}))}return this.$q.reject(new s.a(s.c.createFlowFromTemplateRouteFailed,this.clientResources.TemplateCreationHelperService.CreateFlowFromTemplateRoute.BadResponse,null,{responseStatusCode:e&&e.status,responseData:e&&e.data}))}).catch(e=>(this.loggingService.profileEnd(l,m.a.createFlowFromTemplateRouteEnd,Object(v.b)(e),e,F({url:o,request:null},a)),this.$q.reject(e)))}},{key:"createFlowOrSolutionFlow",value:function(e){var t,i,r,n;return this.promiseHelperService.toAngularPromise(Object(O.d)(this.loggingService,null===(t=this.environmentService.getCurrentEnvironment())||void 0===t?void 0:t.hasXrmInstance,this.widgetUtilService,this.sessionService.isConsumerDomain,this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,null!==(i=null===(r=this.sessionService.getUserInfo())||void 0===r?void 0:r.tenantId)&&void 0!==i?i:"",null===(n=this.environmentService.getCurrentEnvironment())||void 0===n?void 0:n.xrmInstanceVersion)).then(t=>{var i=(Object(y.a)(this.$window.location.href)||{}).parameters[w.h.solutionId];if(Object(u.p)(i)&&t===O.a.ShouldDefault)i=Object(D.a)(),this.loggingService.logInfo("templateCreationHelperService.createFlowOrSolutionFlow","Copying connectionName to connectionReferenceLogicalName to use Connection references."),Object(O.f)(e.properties.connectionReferences);else if(Object(u.p)(i)&&t===O.a.BlockFlowSave)throw new s.a(O.b,this.clientResources.DefaultToSolution.FlowSaveBlocked);return Object(u.p)(i)?this.ngFlowService.post({id:Object(p.d)(this.environmentService)},e):this.flowsClient.createSolutionFlow({solutionId:i},e)})}},{key:"getFlowWithDefinitionFromTemplateDefinition",value:function(e){var t={},i=JSON.parse(e.templateDefinition),r=a()({},i),n=e.designTimeParameters?Object(b.b)(r.properties.definition,e.designTimeParameters):r.properties.definition;return t.properties={},t.properties.definition=n,t.properties.definition.description=r.properties.description,t.properties.connectionReferences=r.properties.connectionReferences,t.properties.environment={name:this.environmentService.getCurrentEnvironmentName()},t.properties.displayName=e.flowName,this.updateRecurrenceFrequencyPerUserPlan(t),this.$q.resolve(t)}},{key:"getFlowWithDefinitionFromTemplate",value:function(e){var t=e.galleryName||g.b.public,i=Object(h.c)(t,e.templateName,this.environmentService);return this.templatesClient.get(this.$scope,{id:i}).$promise.then(()=>{var r=this.templatesClient.get(this.$scope,{id:i});if(r){var n={},o=a()({},r),l=e.designTimeParameters?Object(b.b)(o.properties.definition,e.designTimeParameters):o.properties.definition;return n.properties={},n.properties.definition=l,n.properties.definition.description=o.properties.description,n.properties.connectionReferences=o.properties.connectionReferences,n.properties.environment={name:this.environmentService.getCurrentEnvironmentName()},n.properties.templateName=e.templateName,n.properties.displayName=e.flowName,this.updateRecurrenceFrequencyPerUserPlan(n),n}throw new s.a(s.c.templateNotFoundError,Object(u.d)(this.clientResources.Manage.Flows.Template.NotFound,e.templateName,t),null,{galleryName:t,templateName:e.templateName})})}},{key:"createAndUpdateConnectionReferences",value:function(e,t,i){var r=e.properties.connectionReferences,n={},o=[];return Object.keys(r).forEach(a=>{var s=r[a];if(s.api){var l=s.api.id,c=this.getMatchingApi(l,i),u=this.getFlowDefinitionConnectionReference(s,t,c).then(t=>{n[a]=t,this.updateRuntimeUrl(e,a,s)});o.push(u)}else this.loggingService.logWarning("TemplateCreationService.createAndUpdateConnectionReferences","Api in connection reference ".concat(null==s?void 0:s.id," is null"))}),this.$q.all(o).then(()=>(e.properties.connectionReferences=n,e))}},{key:"getFlowDefinitionConnectionReference",value:function(e,t,i){var r={},n=e.api.id,o=this.getMatchingConnectionReference(n,t);return r.id=n,this.$q((e,t)=>{if(o)r.connectionName=o.name,e(r);else{var n=Object(S.a)(),a=Object(d.e)(i.name,n);this.connectionHelper.addConnection(i,a,null,!1).then(()=>{r.connectionName=n,e(r)}).catch(e=>{t(e)})}})}},{key:"getMatchingConnectionReference",value:function(e,t){var i=new RegExp("^"+e+"/"),r=t.filter(e=>i.test(e.id));return r.length>0?r[0]:void 0}},{key:"getMatchingApi",value:function(e,t){var i=new RegExp("^"+e+"$"),r=t.filter(e=>i.test(e.id));return r.length>0?r[0]:void 0}},{key:"updateRuntimeUrl",value:function(e,t,i){Object.keys(e.properties.definition.triggers).forEach(r=>{this.updateOperationRuntimeUrl(t,i,e.properties.definition.triggers[r])}),Object.keys(e.properties.definition.actions).forEach(r=>{this.updateOperationRuntimeUrl(t,i,e.properties.definition.actions[r])})}},{key:"updateOperationRuntimeUrl",value:function(e,t,i){if(i){if(i.type===c.a.If){var r=F(F({},i.actions),(i.else||{}).actions);Object.keys(r).forEach(i=>{this.updateOperationRuntimeUrl(e,t,r[i])})}else if(i.type===c.a.Foreach){var n=F({},i.actions);Object.keys(n).forEach(i=>{this.updateOperationRuntimeUrl(e,t,n[i])})}if(Object(f.a)(i)||!i.inputs||!i.inputs.host||!i.inputs.host.api||!t.api||!t.api.properties||!t.api.properties.primaryRuntimeUrl)return;var o=i.inputs.host.api.runtimeUrl,a="shared_"+o.substr(o.lastIndexOf("/")+1);e===a&&(i.inputs.host.api.runtimeUrl=t.api.properties.primaryRuntimeUrl)}}},{key:"updateRecurrenceFrequencyPerUserPlan",value:function(e){var t=Object(l.c)(e),i=this.policiesService.getDefaultRecurrence();if(!A()(t,l.a)&&(t.frequency===l.b.second||t.interval<i.interval&&t.frequency===l.b.minute)){var r=Object.keys(e.properties.definition.triggers)[0];e.properties.definition.triggers[r].recurrence=i}}}])&&j(t.prototype,i),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();q.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.$window,n.a.services.apisClient,n.a.services.appSettings,n.a.services.clientResources,n.a.services.connectionHelper,n.a.services.connectionsClient,n.a.services.environment,n.a.services.flowsClient,n.a.services.logging,n.a.services.ngReactBridge.ngFlowService,n.a.services.policies,n.a.services.promiseHelperService,n.a.services.session,n.a.services.templatesClient,n.a.services.widgetUtilService,n.a.services.environmentCapability],r.a.service(n.a.services.templateCreationHelper,q)},33595:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33596),a=i(33597),s=i(20799),l=i(12345),c=i(13e3),u=i(20915),d=i(20892),p=i(33472),h=i(21878),m=i(17258);function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,i,r,n,o,a,s,l,c,u,d,p,h,m,g,f,v,b){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.appSettings=i,this.authenticationService=r,this.clientResources=n,this.connectorHideKeyService=o,this.environmentService=a,this.loggingService=s,this.telemetryService=l,this.xrmChildFlowsClient=c,this.graphService=u,this.tokenService=d,this.designerOperationsService=p,this.apiOperationService=h,this.designerCreateContextService=m,this.assetService=g,this.oAuthService=f,this.policiesService=v,this.ppapiService=b}var t,i,r;return t=e,(i=[{key:"createDesignerConfig",value:function(e){return this.$q.all([e.downloadDesignerScriptsPromise,e.connectionsPromise||this.$q.resolve(void 0),this.connectorHideKeyService.getVisibleHideKeys()]).then(t=>{var[i,r,n]=t;return this.createConfig(e.designerConfig,i,r,n)})}},{key:"createConfig",value:function(e,t,i,r){var n,g={appSettings:this.appSettings,featureFlags:this.appSettings.featureFlags,defaultRecurrence:this.policiesService.getDefaultRecurrence(),designercore:t.designercore,designerElement:null,apiOperationAuthoringBehavior:e.apiOperationAuthoringBehavior,isSolutionFlow:e.isSolutionFlow,environment:{name:this.environmentService.getCurrentEnvironmentName(),features:(null===(n=l.a.currentEnvironment)||void 0===n?void 0:n.features)||{}},getArmAccessToken:()=>Object(p.a)(this.authenticationService.getToken(this.appSettings.authResource)),getFunctionsRPAccessToken:()=>Object(p.a)(this.authenticationService.getToken(this.appSettings.functionsAuthResource)),getRuntimeAccessToken:()=>Object(p.a)(this.authenticationService.getToken(this.appSettings.apiHubsRuntimeResource)),getConsentServerAccessToken:()=>Object(p.a)(this.authenticationService.getToken(this.appSettings.consentServerAadResourceUri)),getPPAPIAccessToken:()=>Object(p.a)(this.authenticationService.getToken(this.ppapiService.getTokenAudience())),oAuthService:this.oAuthService,ppapiService:this.ppapiService,connectorV2ServiceFactory:()=>new a.a(e.allowCoauthoring,this.clientResources,e.flowName,this.loggingService,i,this.graphService,this.xrmChildFlowsClient,l.a,this.tokenService,u.a,h.a,m.a,()=>c.a.user),operationManifestServiceFactory:()=>new o.a(this.apiOperationService,this.clientResources,l.a,null,this.loggingService,this.designerOperationsService,d.a,this.assetService,this.tokenService,this.ppapiService),prefetchedData:{connections:i},visibleHideKeys:r,telemetryService:this.telemetryService,canAddOperation:null,context:this.designerCreateContextService.getDesignerCreateContext()};return g.azureADServiceFactory=e=>new s.a(this.graphService,this.loggingService),this.updateDefaultDesignerConfig(g,e)}},{key:"updateDefaultDesignerConfig",value:function(e,t){return e.allowCoauthoring=t.allowCoauthoring,e.canAddOperation=t.canAddOperation,e.connectionWizardUIConfig=t.connectionWizardUIConfig,e.designerElement=t.designerElement,e.dietViewServiceFactory=t.dietViewServiceFactory,e.enableDietDesigner=t.enableDietDesigner,e.useDietDesignerParameterCards=t.useDietDesignerParameterCards,e.flowName=t.flowName||"",e.prefetchedData.connectionProviders=t.prefetchedData&&t.prefetchedData.connectionProviders||void 0,e.runInstanceServiceFactory=t.runInstanceServiceFactory,e.showCalloutHints=t.showCalloutHints,e.showViewPermissionsDialog=t.showViewPermissionsDialog,e}}])&&g(t.prototype,i),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[n.a.services.$q,n.a.services.appSettings,n.a.services.authentication,n.a.services.clientResources,n.a.services.connectorHideKey,n.a.services.environment,n.a.services.logging,n.a.services.telemetry,n.a.services.xrmChildFlowsClient,n.a.services.graphService,n.a.services.token,n.a.services.designerOperations,n.a.services.apiOperation,n.a.services.designerCreateContext,n.a.services.assetService,n.a.services.oAuthService,n.a.services.policies,n.a.services.ppapiService],r.a.service(n.a.services.designerConfig,v)},33596:function(e,t,i){"use strict";var r=i(20803);i.d(t,"a",(function(){return r.b}))},33597:function(e,t,i){"use strict";var r=i(20791);i.d(t,"a",(function(){return r.a}))},33598:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33354),a=i(33394),s=i(33392);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$window=i,this.clientResources=r,this.loggingService=n}var t,i,r;return t=e,(i=[{key:"get",value:function(){var e=this.$q.defer(),t=this.loggingService.profileStart(o.a.geocodeGetStart);if(this.$window.navigator.geolocation)this.$window.navigator.geolocation.getCurrentPosition(i=>{this.loggingService.profileEndWithSuccess(t,o.a.geocodeGetEnd),e.resolve(i)},i=>{this.loggingService.profileEnd(t,o.a.geocodeGetEnd,s.a.Warning,i),e.reject(new a.b(a.c.geocodeServiceGeolocationDisabled,this.clientResources.Geolocation.Disabled,null))},{timeout:5e3});else{var i=new a.b(a.c.geocodeServiceGeolocationUnsupported,this.clientResources.Geolocation.Unsupported.Message);this.loggingService.profileEnd(t,o.a.geocodeGetEnd,s.a.Warning,i),e.reject(i)}return e.promise}},{key:"getCoordinates",value:function(){return this.get().then(e=>({latitude:e.coords.latitude,longitude:e.coords.longitude}))}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[n.a.services.$q,n.a.services.$window,n.a.services.clientResources,n.a.services.logging],r.a.service(n.a.services.geocode,u)},33599:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(12381),a=i(33360),s=i(33392),l=i(33394),c=i(33396),u=i(33444),d=i(33355),p=i(11891),h=i(16926),m=i(13144);function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,i,r,n,o,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.appSettings=r,this.clientResources=n,this.loggingService=o,this.promiseHelper=a,this.sessionService=s,this.environmentService=l}var t,i,r;return t=e,(i=[{key:"getNonEmbeddedConnectionReferences",value:function(e,t){var i=e.properties.connectionReferences||{},r={};return Object.keys(i).forEach(e=>{!Object(p.a)(i[e].source,u.a.Embedded)&&t[e]&&(r[e]=t[e])}),r}},{key:"installFlow",value:function(e,t){var i=this.loggingService.profileStart(d.a.installFlowStart,{flowName:Object(h.c)(e),flowUserType:Object(h.e)(e)}),r=this.getNonEmbeddedConnectionReferences(e,t);return this.promiseHelper.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource)).then(t=>this.$http({method:"POST",url:this.getInstallFlowResourceProviderEndpoint(Object(h.c)(e)),data:this.getInstallFlowRequestBody(r),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})).then(t=>{if(t&&200===t.status)return this.loggingService.profileEndWithSuccess(i,d.a.installFlowEnd,{flowName:Object(h.c)(e),flowUserType:Object(h.e)(e)}),this.$q.resolve();throw new l.a(l.c.installFlowFailed,Object(a.d)(this.clientResources.RunFlow.BadRequest,Object(h.c)(e)),null,{flowName:Object(h.c)(e),flowUserType:Object(h.e)(e),method:"InstallFlowService.installFlow",responseStatusCode:t&&t.status,responseData:t&&t.data})}).catch(t=>(this.loggingService.profileEnd(i,d.a.installFlowEnd,Object(s.b)(t),t,{flowName:Object(h.c)(e),flowUserType:Object(h.e)(e)}),this.$q.reject(t)))}},{key:"getInstallFlowResourceProviderEndpoint",value:function(e){var t=Object(m.c)(this.appSettings).flowRP,i=Object(o.a)(Object(c.f)(this.environmentService),Object(o.a)(e,"install")),r=this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments;return Object(o.a)(t,i)+"?api-version=".concat(r)}},{key:"getInstallFlowRequestBody",value:function(e){return{connectionReferences:e}}}])&&g(t.prototype,i),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.appSettings,n.a.services.clientResources,n.a.services.logging,n.a.services.promiseHelperService,n.a.services.session,n.a.services.environment],r.a.service(n.a.services.installFlowService,v)},33600:function(e,t,i){"use strict";i(33601),i(33605),i(33609),i(33612),i(33615),i(33619),i(33622),i(33627),i(33630),i(33634),i(33638),i(33694),i(33697),i(33698),i(33702),i(33707),i(33711),i(33715),i(33718),i(33722),i(33725),i(33728),i(33732),i(33735),i(33739),i(33743),i(33747),i(33751)},33601:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33602);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33603);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33604),this.bindings={displayName:"<",mail:"<",imageSrc:"<",objectId:"<"},this.controller=o.a,this.controllerAs="avatarCtrl"}));n.a.component(r.a.components.avatar,new c)},33602:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.loggingService=i,this.assetService=r,this.graphService=n,this.displayName=void 0,this.mail=void 0,this.imageSrc=void 0,this.objectId=void 0,this.defaultPlaceholderImage=void 0,this.$onInit=()=>{this.imageSrc||this.objectId&&this.graphService.getThumbnailPhotos([this.objectId]).then(e=>{this.imageSrc=e.hasOwnProperty(this.objectId)?e[this.objectId]:this.assetService.userPlaceholder}).catch(e=>{this.loggingService.logError("AvatarCtrl.getThumbnailPhotos",e)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"AvatarCtrl"}),this.defaultPlaceholderImage=r.userPlaceholder}var t,i,r;return t=e,(i=[{key:"alt",get:function(){return this.mail&&this.displayName?"".concat(this.displayName," (").concat(this.mail,")"):this.mail?this.mail:this.displayName?this.displayName:""}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.$inject=[r.a.services.$scope,r.a.services.logging,r.a.services.assetService,r.a.services.graph]},33603:function(e,t,i){e.exports=i.p+"static/media/avatar.75a23bfe.less"},33604:function(e,t){e.exports='<img\n    class="avatar img-circle"\n    alt="{{avatarCtrl.alt}}"\n    ng-src="{{avatarCtrl.imageSrc || avatarCtrl.defaultPlaceholderImage}}" />\n'},33605:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33606);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33608),this.bindings={model:"=",dismissFocusElement:"<?",focusOnAction:"<?"},this.controller=o.a}));n.a.component(r.a.components.alert,new c)},33606:function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return d}));var r=i(33327),n=i(33353),o=i(33383),a=i(15523),s=i(33607);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return{[n.a.Warning]:t.statusWarning,[n.a.Error]:t.statusError,[n.a.Info]:t.statusInfo,[n.a.Progress]:t.statusProgress,[n.a.Success]:t.statusSuccess,[n.a.UniqueRedirectUrlSuccess]:t.statusSuccess,[n.a.None]:null}[e]}var d=function(){function e(t,i,r,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.clientResources=i,this.$timeout=r,this.assetService=s,this.loggingService=l,this.actionButtonId="alert-button-".concat(Object(a.a)()),this.iconUrl=void 0,this.isVisible=void 0,this.model=void 0,this.inProgress=void 0,this.spinner={size:o.c.Small,local:o.a.LocalStatic,show:!0},this.controlText=void 0,this.controlClass=void 0,this.controlTitle=void 0,this.dismissFocusElement=void 0,this.focusOnAction=void 0,this.$onInit=()=>{this.$scope.$watch(()=>this.model&&this.model.type,()=>{this.inProgress=this.model.type===n.a.Progress,this.iconUrl="",this.isVisible=!1,this.model.type!==n.a.None&&(this.iconUrl=u(this.model.type,this.assetService),this.isVisible=!0),this.controlText=this.model.options.control&&this.model.options.control.text?this.model.options.control.text:this.clientResources.Alert.AlertCloseLabel,this.controlClass=this.model.options.control&&this.model.options.control.className?this.model.options.control.className:"",this.controlTitle=this.model.options.control&&this.model.options.control.showTitle?this.controlText:""})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"AlertCtrl"}),this.iconUrl=this.assetService.statusWarning,this.$timeout(()=>{var e=document.getElementById(this.actionButtonId);this.focusOnAction&&e&&e.focus()}),this.controlText=this.clientResources.Alert.AlertCloseLabel}var t,i,r;return t=e,(i=[{key:"controlAction",value:function(e){e.stopPropagation(),this.model.options.control&&this.model.options.control.action?(this.model.options.control.action(),this.dismiss()):this.dismiss()}},{key:"dismiss",value:function(){this.model.type=n.a.None,this.dismissFocusElement&&this.$timeout(()=>{var e=document.getElementById(this.dismissFocusElement);if(e){var t=Object(s.a)(e);t&&t.focus()}})}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[r.a.services.$scope,r.a.services.clientResources,r.a.services.$timeout,r.a.services.assetService,r.a.services.logging]},33607:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r='button:not([type="hidden"]):not([disabled]):not(.ng-hide), [href]:not([type="hidden"]):not([disabled]):not(.ng-hide), input:not([type="hidden"]):not([disabled]):not(.ng-hide), select:not([type="hidden"]):not([disabled]):not(.ng-hide), textarea:not([type="hidden"]):not([disabled]):not(.ng-hide), [tabindex]:not([tabindex="-1"]):not([type="hidden"]):not([disabled]):not(.ng-hide)';function n(e){var t=function(e,t){if(!e)return;var i=[];if(function(e){if(!e)return!1;if(e.parentElement)for(var t=e.parentElement.querySelectorAll(r),i=0;i<t.length;++i){var n=t[i];if(n===e&&!o(n))return!0}return!1}(e)&&(i.push(e),t))return i;for(var n=e.querySelectorAll(r),a=0;a<n.length;++a){var s=n[a];if(!o(s)&&(i.push(s),t))break}return i}(e,!0);if(t&&0!==t.length)return t[0]}function o(e){return!!function(e){return e&&"none"===getComputedStyle(e).display}(e)||e.parentElement&&o(e.parentElement)}},33608:function(e,t){e.exports='<div class="fl-alert">\n    <div\n        class="alert-container"\n        ng-if="$ctrl.model.type"\n        ng-show="$ctrl.isVisible">\n        <div class="alert">\n            <div class="row">\n                <div class="column">\n                    <div class="alert-content-container">\n                        <div\n                            class="alert-content"\n                            role="alertdialog"\n                            aria-atomic="true"\n                            aria-live="assertive"\n                            aria-labelledby="alert-title-{{::$ctrl.$scope.$id}}"\n                            aria-describedby="alert-message-{{::$ctrl.$scope.$id}}">\n                            <div class="alert-image-container" aria-hidden="true" ng-class="{\'image-container-alert-has-title\': $ctrl.model.options.title}">\n                                <spinner model="$ctrl.spinner" ng-show="$ctrl.inProgress"></spinner>\n                                <svg svg-src="{{$ctrl.iconUrl}}" ng-hide="$ctrl.inProgress"></svg>\n                            </div>\n                            <span id="alert-title-{{::$ctrl.$scope.$id}}"\n                                class="alert-title"\n                                ng-attr-title="{{$ctrl.model.options.title}}"\n                                ng-bind="$ctrl.model.options.title">\n                            </span>\n                            <span\n                                id="alert-message-{{::$ctrl.$scope.$id}}"\n                                class="alert-message"\n                                ng-bind="$ctrl.model.message">\n                                <a class="c-hyperlink"\n                                    ng-if="$ctrl.model.options.link"\n                                    ng-href="{{::$ctrl.model.options.link.url}}"\n                                    target="_blank"\n                                    ng-bind="$ctrl.model.options.link.text"\n                                    ng-click="$ctrl.model.options.link.onClick()">\n                                </a>\n                            </span>\n                            <div class="alert-close-container">\n                                <a role="button"\n                                    ng-click="$ctrl.controlAction($event)"\n                                    title="{{$ctrl.controlTitle}}"\n                                    class="c-action-trigger alert-close-button c-glyph"\n                                    href=""\n                                    ng-class="[$ctrl.controlClass, {\'glyph-close\': !$ctrl.controlClass}]"\n                                    ng-bind="$ctrl.controlText"\n                                    id="{{$ctrl.actionButtonId}}">\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},33609:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33610);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33611),this.controller=o.a,this.controllerAs="confirmDialogCtrl",this.bindings={title:"@",message:"@",show:"=",onConfirm:"<"}}));r.a.component(n.a.components.confirmDialog,new c)},33610:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.clientResources=i,this.loggingService=r,this.title=void 0,this.message=void 0,this.show=void 0,this.onConfirm=void 0,this.innerDialog=void 0,this.$onInit=()=>{this.innerDialog={show:!1,buttons:[{label:this.clientResources.Common.Ok,action:()=>this.onOk(),primary:!0,name:"ok-button"},{label:this.clientResources.Common.Cancel,action:()=>this.onCancel(),name:"cancel-button"}]},this.$scope.$watch(()=>this.show,()=>this.innerDialog.show=this.show)},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ConfirmDialogCtrl"})}var t,i,r;return t=e,(i=[{key:"onOk",value:function(){this.onConfirm&&this.onConfirm(),this.hide()}},{key:"onCancel",value:function(){this.hide()}},{key:"hide",value:function(){this.show=!1}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.$inject=[r.a.services.$scope,r.a.services.clientResources,r.a.services.logging]},33611:function(e,t){e.exports='<div class="confirm-dialog-component">\n    <modal-dialog model="confirmDialogCtrl.innerDialog">\n        <dialog-header-content-template>\n            <h1\n                id="{{::confirmDialogCtrl.innerDialog.ariaLabelledById}}"\n                class="c-heading-3">\n                {{confirmDialogCtrl.title}}\n            </h1>\n        </dialog-header-content-template>\n        <dialog-body-content-template>\n            <p\n                id="{{::confirmDialogCtrl.innerDialog.ariaDescribedById}}"\n                class="c-paragraph-3">\n                {{confirmDialogCtrl.message}}\n            </p>\n        </dialog-body-content-template>\n    </modal-dialog>\n</div>\n'},33612:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33613);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33614),this.bindings={buttons:"=",showSpinner:"="},this.controller=o.a,this.controllerAs="dialogButtonsCtrl"}));n.a.component(r.a.components.dialogButtons,new c)},33613:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33383);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.buttons=void 0,this.spinner={size:r.c.Small,local:r.a.LocalStatic,show:!0}}var t,i,o;return t=e,(i=[{key:"getButtonLabel",value:function(e){return e.label||e.getLabel&&e.getLabel()}}])&&n(t.prototype,i),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33614:function(e,t){e.exports='<div class="dialog-buttons" ng-if="!!dialogButtonsCtrl.buttons">\n    <spinner model="dialogButtonsCtrl.spinner" ng-show="dialogButtonsCtrl.showSpinner"></spinner>\n    <div class="button-container">\n        <button class="dialog-button c-button {{button.primary ? \'btn-primary\' : \'\'}}"\n            aria-label="{{dialogButtonsCtrl.getButtonLabel(button)}}"\n            ng-repeat="button in dialogButtonsCtrl.buttons"\n            ng-click="button.action($event)"\n            title="{{dialogButtonsCtrl.getButtonLabel(button)}}"\n            type="{{button.primary ? \'submit\' : \'\'}}"\n            data-test="{{button.name}}"\n            ng-disabled="!!button.disabled">{{dialogButtonsCtrl.getButtonLabel(button)}}</button>\n    </div>\n</div>'},33615:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33616);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33617);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33618),this.bindings={model:"<"},this.controller=o.a,this.controllerAs="flowPermissionsListCtrl"}));r.a.component(n.a.components.flowPermissionsList,new c)},33616:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(33527),o=i(33279),a=i.n(o);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=4,u=function(){function e(t,i,r,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.assetService=i,this.graphService=r,this.clientResources=o,this.loggingService=s,this.model=void 0,this.userPlaceholderImage=void 0,this.permissions=void 0,this.expanded=void 0,this.$onInit=()=>{var e=Object(n.c)(this.model.permissions),t=this.graphService.getThumbnailPhotos(e);this.userPlaceholderImage=this.assetService.userPlaceholder,this.permissions=this.model.permissions.map(e=>{var i={primaryText:e.properties.principal.displayName,secondaryText:e.properties.principal.email};return t.then(t=>{var r=t[e.properties.principal.id];i.thumbnailUri=r}).catch(a.a.noop),i})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowPermissionsListCtrl"})}var t,i,r;return t=e,(i=[{key:"showLink",get:function(){return this.model.permissions.length>c&&this.permissions&&0!==this.permissions.length}},{key:"howMany",get:function(){return c}},{key:"linkText",get:function(){return this.expanded?this.clientResources.Manage.CustomApi.FlowPermissionsList.lessUsers:this.clientResources.Manage.CustomApi.FlowPermissionsList.moreUsers}},{key:"emptyMessage",get:function(){return this.clientResources.Manage.CustomApi.FlowPermissionsList.defaultEmptyMessage}},{key:"linkClicked",value:function(){this.expanded=!this.expanded}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[r.a.services.$scope,r.a.services.assetService,r.a.services.graph,r.a.services.clientResources,r.a.services.logging]},33617:function(e,t,i){e.exports=i.p+"static/media/flowPermissionsList.5b48fb8b.less"},33618:function(e,t){e.exports='<div>\n    <div ng-if="flowPermissionsListCtrl.permissions.length == 0">\n        {{flowPermissionsListCtrl.emptyMessage}}\n    </div>\n    <div ng-repeat="permission in flowPermissionsListCtrl.permissions | limitTo: flowPermissionsListCtrl.howMany"\n         class="permission-entry">\n        <div class="permission-photo">\n            <img ng-if="permission.thumbnailUri" ng-src="{{permission.thumbnailUri}}" alt="permission.primaryText"/>\n            <img ng-if="!permission.thumbnailUri" cdn-src="{{flowPermissionsListCtrl.userPlaceholderImage}}" />\n        </div>\n        <div class="permission-info">\n            <div class="permission-primary-text">\n                {{permission.primaryText}}\n            </div>\n            <div class="permission-secondary-text">\n                {{permission.secondaryText}}\n            </div>\n        </div>\n    </div>\n\n    <div class="more-link" ng-if="flowPermissionsListCtrl.showLink">\n        <a ng-click="flowPermissionsListCtrl.linkClicked()">{{flowPermissionsListCtrl.linkText}}</a>\n    </div>\n</div>'},33619:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33620);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33621),this.bindings={back:"<",buttons:"<",contextualMenu:"<",filter:"<",label:"<",links:"<",showSpinner:"<",coachmark:"<",tabs:"<",toggle:"<"},this.transclude={headingTemplate:"?headingTemplate"},this.controller=o.a,this.controllerAs="headingCtrl"}));n.a.component(r.a.components.heading,new c)},33620:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33279),n=i(33327),o=i(33383);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.widgetUtilService=t,this.$scope=i,this.loggingService=n,this.back=void 0,this.buttons=void 0,this.contextualMenu=void 0,this.coachmark=void 0,this.filter=void 0,this.label=void 0,this.links=void 0,this.tabs=void 0,this.spinner={size:o.c.Small,show:!0,local:o.a.LocalStatic},this.tab=void 0,this.toggle=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"HeadingCtrl"}),this.$scope.$watch(()=>(this.tab=document.getElementById("heading-tabs-"+String(this.$scope.$id)),!!this.tab&&this.tab.getElementsByClassName("tab-active")[0]),()=>{this.tab&&r.element(this.tab.getElementsByClassName("tab-active")).focus()})}var t,i,n;return t=e,(i=[{key:"shouldShowTabs",value:function(){return this.tabs&&(!this.widgetUtilService.isWidgetPage()||!this.widgetUtilService.widgetInfo.hideTabs)}},{key:"executeLinkAction",value:function(e,t){!e||e.disabled&&e.disabled()||!e.action||e.action(t)}}])&&a(t.prototype,i),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[n.a.services.widgetUtilService,n.a.services.$scope,n.a.services.logging]},33621:function(e,t){e.exports='<header class="heading-container" aria-label="{{headingCtrl.label}}" role="banner">\n    <div class="row heading-content">\n        <div class="heading-content-left">\n            <backbutton model="headingCtrl.back" ng-if="headingCtrl.back"></backbutton>\n            <h1 ng-if="headingCtrl.label">{{headingCtrl.label}}</h1>\n            <div id="heading-tabs-{{::headingCtrl.$scope.$id}}" class="heading-tabs" ng-if="headingCtrl.shouldShowTabs()" role="tablist">\n                <a ng-repeat="tab in headingCtrl.tabs.tabsInfo"\n                   role="tab"\n                   aria-selected="{{headingCtrl.tabs.tabSelected === tab.tabName}}"\n                   aria-setsize="{{headingCtrl.tabs.length}}"\n                   aria-posinset="{{$index+1}}"\n                   ng-class="{\'tab-active\': headingCtrl.tabs.tabSelected === tab.tabName}"\n                   data-event-name="{{tab.eventName}}"\n                   data-test="headingtab-{{tab.tabName}}"\n                   ng-href="{{tab.href}}">\n                    {{tab.tabHeader}}\n                </a>\n            </div>\n        </div>\n        <div class="heading-content-right">\n            <div class="heading-right">\n                <spinner model="headingCtrl.spinner" ng-if="headingCtrl.showSpinner"></spinner>\n                <a ng-repeat="link in headingCtrl.links"\n                    ng-href="{{link.href ? link.href : \'\'}}"\n                    class="heading-button text-ellipsis-button"\n                    role="link"\n                    ng-click="headingCtrl.executeLinkAction(link, $event)"\n                    data-event-name="{{link.eventName}}"\n                    ng-hide="link.hide"\n                    title="{{::link.label}}"\n                    tabindex="0"\n                    ng-attr-download="{{!!link.download}}"\n                    data-test="heading-{{link.name}}"\n                    aria-label="{{link.label}}" >\n                    <div class="c-glyph" ng-class="link.svgId">\n                        <img ng-if="link.image" ng-src="{{link.image}}" alt="{{::link.label}}" />\n                    </div>\n                    <span class="heading-link-label">{{link.label}}</span>\n                </a>\n                <button ng-repeat="button in headingCtrl.buttons" data-test="{{button.name}}" class="heading-button" ng-click="button.action($event)" ng-disabled="button.disabled()" aria-label="{{button.label}}" >\n                    <div class="c-glyph" ng-class="button.svgId">\n                        <img ng-if="button.image" cdn-src="{{button.image}}" alt="{{button.label}}" />\n                    </div>\n                    <span class="heading-button-label">{{button.label}}</span>\n                </button>\n                <select ng-if="headingCtrl.filter" type="text" ng-model="headingCtrl.filter.selected.key" ng-change="headingCtrl.filter.action()">\n                    <option ng-repeat="filter in headingCtrl.filter.available" value="{{filter.key}}" ng-disabled="filter.value === \'invalid\'">{{filter.name}}</option>\n                </select>\n\n                <react-default-button ng-if="headingCtrl.contextualMenu"\n                    class="heading-button heading-contextual-menu"\n                    icon-name="headingCtrl.contextualMenu.iconName"\n                    text="headingCtrl.contextualMenu.text"\n                    menu-props="headingCtrl.contextualMenu.menuProps"\n                    id="{{::headingCtrl.contextualMenu.buttonId}}">\n                </react-default-button>\n\n                <div class="header-divider" ng-if="headingCtrl.toggle"></div>\n\n                <react-toggle ng-if="headingCtrl.toggle"\n                    aria-label="{{headingCtrl.toggle.ariaLabel}}"\n                    checked="headingCtrl.toggle.isToggleOn()"\n                    off-text="headingCtrl.toggle.offText"\n                    on-text="headingCtrl.toggle.onText"\n                    onChange="headingCtrl.toggle.action">\n                </react-toggle>\n\n                <div ng-transclude="headingTemplate" class="heading-template"></div>\n\n            </div>\n            <react-coachmark-with-teaching-bubble\n                ng-if="headingCtrl.coachmark.show"\n                target="\'#{{::headingCtrl.contextualMenu.buttonId}}\'"\n                headline="headingCtrl.coachmark.headline"\n                bodyContent="headingCtrl.coachmark.bodyContent"\n                hyperLink="headingCtrl.coachmark.hyperLink"\n                hasCloseButton="\'true\'"\n                primaryButtonProps="headingCtrl.coachmark.primaryButtonProps"\n                onDismiss="headingCtrl.coachmark.onDismiss"\n                >\n            </react-coachmark-with-teaching-bubble>\n        </div>\n    </div>\n</header>\n<section class="heading-spacer">\n'},33622:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33623);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33625);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33626),this.bindings={closeOnClickOutsidePane:"<?",hideCloseButton:"<?",hideParentScrollbar:"<?",paneAnimation:"<?",paneTitle:"<",paneSubtitle:"<?",elementIdsToFocusOnClose:"<?",expanded:"=",overlay:"<?",onClose:"&",toggleButtonId:"<?",toggleButtonEvent:"<?"},this.controller=o.a,this.controllerAs="infoPaneCtrl",this.transclude=!0}));r.a.component(n.a.components.infoPane,new c)},33623:function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return d}));var r=i(33327),n=i(33624),o=i(11804),a=i(20368),s=i(15523);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u={SlideIn:"SlideIn",NoAnimation:"NoAnimation"},d=function(){function e(t,i,r,o,a,l,c,u,d){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=t,this.$element=i,this.$scope=r,this.$timeout=o,this.domHelper=a,this.hostCommunicationService=l,this.widgetUtilService=c,this.Resources=u,this.loggingService=d,this.elementIdsToFocusOnClose=void 0,this.expanded=void 0,this.closeOnClickOutsidePane=void 0,this.hideCloseButton=void 0,this.hideParentScrollbar=void 0,this.overlay=void 0,this.paneAnimation=void 0,this.toggleButtonId=void 0,this.toggleButtonEvent=void 0,this.onClose=void 0,this.titleId="infoPane-title".concat(Object(s.a)()),this.subtitleId="infoPane-subtitle".concat(Object(s.a)()),this.$onInit=()=>{this.registerCloseOnClickOutsidePane(),this.$scope.$watch(()=>this.expanded,(e,t)=>{this.elementIdsToFocusOnClose&&!1===e&&!0===t?this.$timeout(()=>{this.elementIdsToFocusOnClose.forEach(e=>{var t=document.getElementById(e);if(t){var i=Object(n.a)(t);i&&i.focus()}})}):!1===e&&!0===t?this.domHelper.removeTabTrap():!0===e&&!1===t&&this.domHelper.addTabTrapInferred(this.$element[0])}),this.hideParentScrollbar&&(this.$scope.$watch(()=>this.expanded,(e,t)=>{this.onInfoPaneVisibilityChanged(e)}),this.$scope.$on("$destroy",()=>{this.onInfoPaneVisibilityChanged(!1),this.domHelper.removeTabTrap()}))},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"InfoPaneCtrl"})}var t,i,r;return t=e,(i=[{key:"close",value:function(){this.onClose(),this.expanded=!1}},{key:"isSlideInAnimation",get:function(){return this.paneAnimation!==u.NoAnimation}},{key:"onInfoPaneVisibilityChanged",value:function(e){this.widgetUtilService.isWidgetPage()?this.hostCommunicationService.triggerHostEvent(o.e.SIDE_PANE_VISIBILITY_SET,{visible:e}):this.setVisibilityOfScrollbarUnderInfoPane(!e)}},{key:"setVisibilityOfScrollbarUnderInfoPane",value:function(e){document&&document.body&&document.body.parentElement&&(document.body.parentElement.style.overflow=e?"visible":"hidden")}},{key:"registerCloseOnClickOutsidePane",value:function(){var e=e=>{this.$scope.$applyAsync(()=>{var t=Object(a.a)(this.$element[0],e.target)||this.toggleButtonId&&this.toggleButtonId===e.target.id||this.toggleButtonEvent&&this.toggleButtonEvent.target===e.target;!this.expanded||t||!this.closeOnClickOutsidePane&&void 0!==this.closeOnClickOutsidePane||this.close()})};this.$document.on("click",e),this.$scope.$on("$destroy",()=>{this.$document.off("click",e)})}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[r.a.services.$document,r.a.services.$element,r.a.services.$scope,r.a.services.$timeout,r.a.services.domHelper,r.a.services.hostCommunicationService,r.a.services.widgetUtilService,r.a.services.clientResources,r.a.services.logging]},33624:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(33279),n=i(33331),o=i(33327),a=i(20368),s=i(20354);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u='button:not([type="hidden"]):not([disabled]):not(.ng-hide), [href]:not([type="hidden"]):not([disabled]):not(.ng-hide), input:not([type="hidden"]):not([disabled]):not(.ng-hide), select:not([type="hidden"]):not([disabled]):not(.ng-hide), textarea:not([type="hidden"]):not([disabled]):not(.ng-hide), [tabindex]:not([tabindex="-1"]):not([type="hidden"]):not([disabled]):not(.ng-hide)';function d(e,t){if(e){var i=[];if(function(e){if(!e)return!1;if(e.parentElement)for(var t=e.parentElement.querySelectorAll(u),i=0;i<t.length;++i){var r=t[i];if(r===e&&!h(r))return!0}return!1}(e)&&(i.push(e),t))return i;for(var r=e.querySelectorAll(u),n=0;n<r.length;++n){var o=r[n];if(!h(o)&&(i.push(o),t))break}return i}}function p(e){var t=d(e,!0);if(t&&0!==t.length)return t[0]}function h(e){return!!function(e){return e&&"none"===getComputedStyle(e).display}(e)||e.parentElement&&h(e.parentElement)}var m=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=t,this.$timeout=i,this.body=void 0,this.listeners=[],this.body=this.$document.find("body")}var t,i,n;return t=e,(i=[{key:"registerOpenOnClick",value:function(e,t,i,r,n,o){var s="#".concat(i);e.toggleButtonOnClick=i=>{i.preventDefault(),t.$apply(()=>{e.expanded=!e.expanded;var i=this.body.find(s);i.prop({"aria-expanded":e.expanded}),o&&o(),e.expanded?(e.documentOnClick=e=>{var n=Object(a.a)(r[0],e.target),o=Object(a.a)(i[0],e.target);n||o||t.$apply(()=>{l()})},this.$document.on("click",e.documentOnClick)):l()})},this.body.on("click",s,e.toggleButtonOnClick),n&&(e.toggleButtonOnKeyPress=e=>{13===e.keyCode&&n()},this.body.on("keydown",s,e.toggleButtonOnKeyPress)),t.$on("$destroy",()=>{this.body.off("click",e.toggleButtonOnClick),e.toggleButtonOnClick=null,this.body.off("keypress",e.toggleButtonOnKeyPress),e.toggleButtonOnKeyPress=null,l()});var l=()=>{e.documentOnClick&&(e.expanded=!1,this.body.find(s).prop({"aria-expanded":!1}),document.removeEventListener("click",e.documentOnClick),e.documentOnClick=null)}}},{key:"tabTrap",value:function(e,t){r.element("body").on("keydown",t,t=>{9!==t.keyCode||t.shiftKey||(t.preventDefault(),r.element(e).focus())}),r.element("body").on("keydown",e,e=>{9===e.keyCode&&e.shiftKey&&(e.preventDefault(),r.element(t).focus())})}},{key:"removeTabTrap",value:function(){for(;this.listeners.length>0;){var e=this.listeners.pop();e.element.removeEventListener(e.listenerType,e.listenerCallback)}}},{key:"addTabTrapInferred",value:function(e){this.$timeout(()=>{var t=p(e);t&&t.focus()});var t=t=>{if(Object(s.m)(t)||Object(s.l)(t)){var i=d(e);if(i&&0!==i.length){i.some(e=>e===t.target)||i[0].focus(),1===i.length&&(t.preventDefault(),i[0].focus());var r=i[0],n=i[i.length-1];Object(s.m)(t)&&t.target===n?(t.preventDefault(),r.focus()):Object(s.l)(t)&&t.target===r&&(t.preventDefault(),n.focus())}else t.preventDefault()}};e.addEventListener("keydown",t),this.listeners.push({element:e,listenerType:"keydown",listenerCallback:t});var i=t=>{if(!Object(a.a)(e,t.target)){var i=p(e);i&&i.focus()}};document.addEventListener("focusin",i),this.listeners.push({element:document,listenerType:"focusin",listenerCallback:i})}}])&&l(t.prototype,i),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();m.$inject=[o.a.services.$document,o.a.services.$timeout],n.a.service(o.a.services.domHelper,m)},33625:function(e,t,i){e.exports=i.p+"static/media/infoPane.099d1d4d.less"},33626:function(e,t){e.exports='<div class="infoPane-overlay" ng-if="infoPaneCtrl.overlay"></div>\n<section class="info-pane"\n    ng-class="{\n        \'slide-in-pane\': infoPaneCtrl.isSlideInAnimation,\n        \'static-pane\': !infoPaneCtrl.isSlideInAnimation,\n        \'expanded\': infoPaneCtrl.expanded,\n    }">\n    <div class="info-pane-content" role="dialog" aria-labelledby="{{::infoPaneCtrl.titleId}}">\n        <header>\n            <button\n                type="button"\n                ng-show="infoPaneCtrl.hideCloseButton"\n                class="c-action-trigger c-glyph glyph-arrowback"\n                ng-click="infoPaneCtrl.close()"\n                aria-label="{{::infoPaneCtrl.Resources.GoBackButtonLabel}}">\n            </button>\n            <button\n                type="button"\n                ng-hide="infoPaneCtrl.hideCloseButton"\n                class="c-action-trigger c-glyph glyph-close"\n                ng-click="infoPaneCtrl.close()"\n                alt="{{::infoPaneCtrl.Resources.Common.Close}}"\n                aria-label="{{::infoPaneCtrl.Resources.Common.Close}}">\n            </button>\n            <h1 id="{{::infoPaneCtrl.titleId}}" role="heading" aria-level="1">{{infoPaneCtrl.paneTitle}}</h1>\n            <p ng-if="infoPaneCtrl.paneSubtitle" id="{{::infoPaneCtrl.subtitleId}}" role="description">{{infoPaneCtrl.paneSubtitle}}</p>\n        </header>\n        <section class="pane-content">\n            <div ng-transclude class="info-pane-transclude-content"></div>\n        </section>\n    </div>\n</section>\n'},33627:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33628);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33629),this.bindings={resource:"<",text:"<?",linkAriaLabel:"<?"},this.controller=o.a,this.controllerAs="learnMoreCtrl"}));r.a.component(n.a.components.learnMore,new c)},33628:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(14754),o=i.n(n),a=i(14876),s=i(12330);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.widgetUtilService=i,this.loggingService=r,this.resource=void 0,this.text=void 0,this.linkAriaLabel=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"LearnMoreCtrl"})}var t,i,r;return t=e,(i=[{key:"href",get:function(){var e;return this.widgetUtilService.isWidgetPage()&&(e=o()(this.clientResources,"Widget.".concat(this.resource))),!Object(a.a)(e)&&this.widgetUtilService.isWidgetPage()||(e=o()(this.clientResources,"".concat(this.resource))),e||""}},{key:"linkText",get:function(){return Object(s.a)(this.text)?this.clientResources.Common.LearnMore:this.text}},{key:"ariaLabelText",get:function(){return this.linkAriaLabel||this.linkText}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[r.a.services.clientResources,r.a.services.widgetUtilService,r.a.services.logging]},33629:function(e,t){e.exports='<div class="learn-more-component">\n    <a href="{{learnMoreCtrl.href}}" target="_blank" data-event-name="LearnMoreClicked" aria-label="{{learnMoreCtrl.ariaLabelText}}">\n        {{learnMoreCtrl.linkText}}\n    </a>\n</div>\n'},33630:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33631);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33632);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33633),this.bindings={actions:"<?",ariaLabel:"@",dismissButtonAriaLabel:"<?",isMultiline:"<?",messageBarType:"<?",onDismiss:"<?"},this.transclude=!0,this.controller=o.a,this.controllerAs="messageBarCtrl"}));n.a.component(r.a.components.messageBar,new c)},33631:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function o(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=o((function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.loggingService=i,this.ariaLabel=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"MessageBarCtrl"})}));s.$inject=[r.a.services.$scope,r.a.services.logging]},33632:function(e,t,i){e.exports=i.p+"static/media/messageBar.060cd385.less"},33633:function(e,t){e.exports='<div class="message-bar-component" aria-label="{{messageBarCtrl.ariaLabel}}">\n    <div ng-transclude></div>\n</div>'},33634:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33635);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33637),this.bindings={model:"=",callback:"=?"},this.transclude={customDialogContentTemplate:"?customDialogContentTemplate",dialogHeaderContentTemplate:"?dialogHeaderContentTemplate",dialogBodyContentTemplate:"?dialogBodyContentTemplate"},this.controller=o.a}));n.a.component(r.a.components.modalDialog,new c)},33635:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33279),n=i(33327),o=i(33636),a=i(12999);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=["ms-Suggestions","ms-DatePicker-picker","ms-ContextualMenu-link","ms-ContextualMenu-container"],u=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$timeout=i,this.loggingService=n,this.model=void 0,this.modalDialog=void 0,this.$modalDialog=void 0,this.previousElement=void 0,this.enterModalDialogOnKeypress=void 0,this.$onInit=()=>{this.$scope.$watch(()=>this.model.show,()=>this.updateModalDialogFocusTrap()),this.$scope.$watch(()=>(this.modalDialog=document.getElementById("modal-dialog-"+String(this.$scope.$id)),!!this.modalDialog&&this.modalDialog.getElementsByClassName("btn-primary")[0]),()=>{var e;this.modalDialog&&(null===(e=this.modalDialog.getElementsByClassName("btn-primary")[0])||void 0===e||e.focus())}),this.model||(this.model={}),this.model.ariaDescribedById="modal-dialog-describedby-".concat(this.$scope.$id),this.model.ariaLabelledById="modal-dialog-label-".concat(this.$scope.$id)},this.addFocusTrapToModalDialog=()=>{this.enterModalDialogOnKeypress=e=>{var t=document.getElementById("modal-dialog-"+String(this.$scope.$id));if(t){if(this.$modalDialog=r.element(t),this.$modalDialog[0].contains(e.target))return;if(this.isExternalFocusAllowedOnElement(e.target))return;if(Object(a.a)().enableSaveAsACopyFocusOverride&&this.model.overrideFocus)return;this.$modalDialog[0].focus()}},this.previousElement=document.activeElement,document.addEventListener("focusin",this.enterModalDialogOnKeypress)},this.removeFocusTrapFromModalDialog=()=>{var e;(this.enterModalDialogOnKeypress&&(document.removeEventListener("focusin",this.enterModalDialogOnKeypress),this.enterModalDialogOnKeypress=null),this.previousElement)&&(null===(e=this.previousElement)||void 0===e||e.focus({preventScroll:!0}))},this.isExternalFocusAllowedUnderElement=e=>!!e&&c.some(t=>e.classList.contains(t)),this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ModalDialogCtrl"})}var t,i,n;return t=e,(i=[{key:"updateModalDialogFocusTrap",value:function(){this.model.show?this.addFocusTrapToModalDialog():this.removeFocusTrapFromModalDialog()}},{key:"isExternalFocusAllowedOnElement",value:function(e){return!!Object(o.a)({startingElement:e,predicateFunction:this.isExternalFocusAllowedUnderElement})}},{key:"onKeyDown",value:function(e){27===e.keyCode&&this.hide()}},{key:"hide",value:function(){this.model.show=!1,this.$timeout(()=>{this.model.elementToFocusOnClose&&this.model.elementToFocusOnClose.focus()})}},{key:"show",value:function(){this.model.show=!0}}])&&s(t.prototype,i),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[n.a.services.$scope,n.a.services.$timeout,n.a.services.logging]},33636:function(e,t,i){"use strict";function r(e){for(var{startingElement:t,predicateFunction:i}=e,r=t;r;){try{if(i(r))return r}catch(n){}r=r.parentElement}}i.d(t,"a",(function(){return r}))},33637:function(e,t){e.exports='<div class="ng-modal" ng-if="$ctrl.model.show">\n    <div class="ng-modal-overlay"></div>\n    <div\n        class="ng-modal-dialog"\n        id="modal-dialog-{{::$ctrl.$scope.$id}}"\n        tabindex="0"\n        role="alertdialog"\n        ng-keydown="$ctrl.onKeyDown($event)"\n        aria-modal="true"\n        aria-label="{{::$ctrl.model.ariaLabelledById}}"\n        aria-describedby="{{::$ctrl.model.ariaDescribedById}}"\n    >\n        <div class="ng-modal-dialog-content">\n            <div ng-transclude="customDialogContentTemplate" ng-if="!!$ctrl.model.disableDefaultStyles"></div>\n            <div class="ng-modal-dialog-header-content" ng-transclude="dialogHeaderContentTemplate" ng-if="!$ctrl.model.disableDefaultStyles">\n                <h2\n                    class="c-subheading-4"\n                    id="{{::$ctrl.model.ariaLabelledById}}"\n                    ng-if="$ctrl.model.title">\n                    {{$ctrl.model.title}}\n                </h2>\n            </div>\n            <div class="ng-modal-dialog-body-content" ng-transclude="dialogBodyContentTemplate" ng-if="!$ctrl.model.disableDefaultStyles"></div>\n            <div class="ng-modal-dialog-footer-content" ng-if="!$ctrl.model.disableDefaultStyles">\n                <dialog-buttons buttons="$ctrl.model.buttons" show-spinner="$ctrl.model.showProgressSpinner"></dialog-buttons>\n            </div>\n        </div>\n    </div>\n</div>'},33638:function(e,t,i){"use strict";i(33639),i(33643),i(33645),i(33647),i(33650),i(33640),i(33652),i(33653),i(33656),i(33657),i(33659),i(33661),i(33662),i(33663),i(33664),i(33665),i(33666),i(33667),i(33669),i(33672),i(33674),i(33675),i(33677),i(33678),i(33679),i(33680),i(33687),i(33688),i(33689),i(33690),i(33691),i(33693)},33639:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33640),a=i(33642),s=o.a.concat(["text","iconOnRight","title","buttonRole"]);r.a.directive(n.a.components.react.reactActionButton,[n.a.modules.reactDirective,e=>e(a.a,s)])},33640:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33334),n=i(33327),o=i(33641),a=["allowDisabledFocus","ariaControls","ariaExpanded","ariaHaspopup","ariaLabel","className","href","iconName","isDisabled","menuProps","menuIconProps","role","style","title","telemetryData","tooltipProps","uniqueId","onClick","onMouseUp"],s=a.concat(["primary","text"]);r.a.directive(n.a.components.react.reactDefaultButton,[n.a.modules.reactDirective,e=>e(o.a,s)])},33641:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(11766),n=i(12831),o=i(14680);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=e=>{var t=s(s({},e),{},{disabled:e.isDisabled});return r.createElement(n.a,{style:{display:"inline"}},r.createElement(o.a,t))}},33642:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11766),n=i(12831),o=i(20353),a=e=>r.createElement(n.a,{className:"fl-NgReactActionButton",style:{display:"inline-block"}},r.createElement(o.a,e))},33643:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33644),a=["iconName","items","text"];r.a.directive(n.a.components.react.reactButtonWithCustomMenu,[n.a.modules.reactDirective,e=>e(o.a,a)])},33644:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(11766),n=i(12961),o=i(16901);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=p(e);if(t){var n=p(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return d(this,i)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,i,l,d=u(p);function p(){var e;a(this,p);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=d.call(this,...i)).menuProps={shouldFocusOnMount:!0,items:e.props.items},e}return t=p,(i=[{key:"render",value:function(){return this.props.items.forEach(e=>{"toggle"===e.customType&&(e.onRender=this.renderToggle)}),r.createElement(n.a,{text:this.props.text,iconProps:{iconName:this.props.iconName},menuProps:this.menuProps})}},{key:"renderToggle",value:function(e,t){return r.createElement("div",null,r.createElement(o.a,{label:e.label,defaultChecked:e.getChecked(),onText:e.onText,offText:e.offText,onChange:e.onChange}))}}])&&s(t.prototype,i),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.Component)},33645:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33334),n=i(33327),o=i(33646),a=["options","direction","label","required","selectedKey","size","onChange"];r.a.directive(n.a.components.react.reactChoiceGroup,[n.a.modules.reactDirective,e=>e(o.a,a)])},33646:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(12831),n=i(15907),o=i(11766),a=e=>o.createElement(r.a,{className:"fl-NgReactChoiceGroup"},o.createElement(n.a,e))},33647:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33645),a=i(33648),s=o.a.concat(["labelLink"]);r.a.directive(n.a.components.react.reactChoiceGroupWithLink,[n.a.modules.reactDirective,e=>e(a.a,s)])},33648:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(12831),n=i(33649),o=i(13028),a=i(11766),s=i.n(a);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var c=e=>s.a.createElement(r.a,{className:"fl-NgReactChoiceGroupWithLearnMoreLink"},s.a.createElement(n.a,l({resources:Object(o.a)()},e)))},33649:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(11766),n=i(12728),o=i(15524),a=i(15907),s=i(14346),l=["labelLink"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=v(e);if(t){var n=v(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return f(this,i)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(f,e);var t,i,s,h=g(f);function f(){var e;d(this,f);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return(e=h.call(this,...i)).labelId=Object(n.a)("ChoiceGroupWithLinkCustomLabel"),e.onRenderChoiceGroupLabel=()=>{var{labelLink:t,label:i,required:n}=e.props;t.text=t.text||e.props.resources.Common.LearnMore;return r.createElement(o.a,{text:null!=i?i:"",id:e.labelId,required:n,onRenderContent:e=>r.createElement(r.Fragment,null,e," ",t&&r.createElement(y,t))})},e}return t=f,(i=[{key:"render",value:function(){var e=this.props,{labelLink:t}=e,i=u(e,l);return r.createElement(a.a,c({className:"fl-ChoiceGroupWithLink"},i,{ariaLabelledBy:this.labelId,onRenderLabel:this.onRenderChoiceGroupLabel}))}}])&&p(t.prototype,i),s&&p(t,s),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.Component),y=e=>r.createElement(s.a,{href:e.href,ariaLabel:e.ariaLabel,telemetryData:e.telemetryData,target:s.b.blank},e.text)},33650:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33651),a=["placeholder","value","copyButtonAriaLabel"];r.a.directive(n.a.components.react.reactCopyableTextField,[n.a.modules.reactDirective,e=>e(o.a,a)])},33651:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(11766),n=i(13028),o=i(19868);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,i,c,p=d(h);function h(){var e;s(this,h);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=p.call(this,...i)).clientResources=Object(n.a)(),e}return t=h,(i=[{key:"render",value:function(){return r.createElement(o.a,a({clientResources:this.clientResources},this.props))}}])&&l(t.prototype,i),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.Component)},33652:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(21965);r.a.directive(n.a.components.react.reactDivider,[n.a.modules.reactDirective,e=>e(o.a)])},33653:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33334),n=i(33327),o=i(33654),a=["label","multiSelect","options","placeholder","selectedKey","selectedKeys","onChange","isDisabled","required","labelledBy"];r.a.directive(n.a.components.react.reactDropdown,[n.a.modules.reactDirective,e=>e(o.a,a)])},33654:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return d}));var r=i(11766),n=i(17371),o=i(33655),a=i(12831);function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){c(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function c(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u=e=>{var t=l(l({},e),{},{disabled:e.isDisabled,ariaLabel:"dropdown"});return r.createElement(a.a,{className:"fl-Dropdown"},r.createElement(n.a,t))},d=e=>{var t=l(l({},e),{},{disabled:e.isDisabled,styles:e.isHeaderType?o.b:o.a});return r.createElement(a.a,{className:"fl-DropdownSwaggerStyle"},r.createElement(n.a,t))}},33655:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));var r={label:{fontSize:"12px",fontWeight:"normal"}},n={dropdown:{fontSize:"15px",height:"36px"},title:{height:"36px",lineHeight:"36px"}}},33656:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33653),a=i(33654),s=o.a.concat(["isHeaderType","headerKey","onHeaderTypeChange"]);r.a.directive(n.a.components.react.reactDropdownSwaggerStyle,[n.a.modules.reactDirective,e=>e(a.b,s)])},33657:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33658),a=["acceptedFileExtensions","importButtonAriaLabel","placeholder","textFieldAriaLabel","value","onImportFiles","label"];r.a.directive(n.a.components.react.reactFileImport,[n.a.modules.reactDirective,e=>e(o.a,a)])},33658:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(11766),n=i(13028),o=i(20836);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,i,c,p=d(h);function h(){return s(this,h),p.apply(this,arguments)}return t=h,(i=[{key:"render",value:function(){return r.createElement(o.a,a({resources:Object(n.a)()},this.props))}}])&&l(t.prototype,i),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.Component)},33659:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33660),a=i(33640).a.concat(["reactTitle","text"]);r.a.directive(n.a.components.react.reactIconButton,[n.a.modules.reactDirective,e=>e(o.a,a)])},33660:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(11766),n=i(12831),o=i(13259);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=e=>{var t=s(s({},e),{},{disabled:e.isDisabled,title:e.reactTitle});return r.createElement(n.a,{className:"fl-NgReactIconButton"},r.createElement(o.a,t))}},33661:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(15524),a=["text","htmlFor","required"];r.a.directive(n.a.components.react.reactLabel,[n.a.modules.reactDirective,e=>e(o.a,a)])},33662:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(20057),a=["className","disabled","height","languageConfiguration","loggingService","options","value","width","onChange","onError","editorDidMount","editorWillMount","editorWillUnmount"];r.a.directive(n.a.components.react.reactMonacoEditor,[n.a.modules.reactDirective,e=>e(o.a,a)])},33663:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(16884),a=["hideDetails","imageUrl","secondaryText","size","text"];r.a.directive(n.a.components.react.reactPersona,[n.a.modules.reactDirective,e=>e(o.a,a)])},33664:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(13241);r.a.directive(n.a.components.react.reactSpinner,[n.a.modules.reactDirective,e=>e(o.a,["size","text"])])},33665:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(15027),a=["value","delayValidation","description","className","isDisabled","label","multiline","placeholder","required","rows","type","onChange","onGetErrorMessage"];r.a.directive(n.a.components.react.reactTextField,[n.a.modules.reactDirective,e=>e(o.a,a)])},33666:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(20837),a=["buttonAriaLabel","buttonTelemetryData","buttonText","placeholder","textFieldAriaLabel","value","onButtonClick","label","buttonDisabled","onTextChanged","textFieldReadOnly"];r.a.directive(n.a.components.react.reactTextFieldWithInlineButton,[n.a.modules.reactDirective,e=>e(o.a,a)])},33667:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33334),n=i(33327),o=i(33668),a=["message","type","ariaLabel","dismissButtonAriaLabel","onDismiss","messageBarIconProps","styles","link","linksWithInterpolationProps"];r.a.directive(n.a.components.react.reactTextMessageBar,[n.a.modules.reactDirective,e=>e(o.a,a)])},33668:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11766),n=i(12831),o=i(16824),a=e=>r.createElement(n.a,{className:"fl-NgReactTextMessageBar"},r.createElement(o.a,e))},33669:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33670),a=i(33667).a.concat(["labelLink","deepLink"]);r.a.directive(n.a.components.react.reactTextMessageBarWithLink,[n.a.modules.reactDirective,e=>e(o.a,a)])},33670:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11766),n=i(12831),o=i(33671),a=e=>r.createElement(n.a,{className:"fl-NgReactTextMessageBar"},r.createElement(o.a,e))},33671:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(11766),n=i(13016),o=i(14346),a=i(16825),s=e=>{var t=e.ariaLabel;return t||"string"!=typeof e.message||(t=e.message),r.createElement(n.a,{className:e.className,ariaLabel:t,dismissButtonAriaLabel:e.dismissButtonAriaLabel,type:e.type,onDismiss:e.onDismiss,onRenderBody:()=>{var t=e.labelLink,i=e.deepLink,n=Object(a.a)();return r.createElement("div",{className:n},e.message," ",i&&r.createElement(l,i),i&&" |",t&&r.createElement(l,t))},messageBarIconProps:e.messageBarIconProps,styles:e.styles})},l=e=>r.createElement(o.a,{href:e.href,ariaLabel:e.ariaLabel,telemetryData:e.telemetryData,target:o.b.blank},e.label||e.ariaLabel)},33672:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33673),a=["ariaLabel","checked","isDisabled","label","offText","onText","styles","onChange"];r.a.directive(n.a.components.react.reactToggle,[n.a.modules.reactDirective,e=>e(o.a,a)])},33673:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(11766),n=i(12831),o=i(16901);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){return(t=d(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,i,a,l=h(d);function d(){return c(this,d),l.apply(this,arguments)}return t=d,(i=[{key:"render",value:function(){var e=s(s({},this.props),{},{disabled:this.props.isDisabled});return r.createElement(n.a,null,r.createElement(o.a,e))}}])&&u(t.prototype,i),a&&u(t,a),Object.defineProperty(t,"prototype",{writable:!1}),d}(r.PureComponent)},33674:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(15497),a=["hidden","title","subText","isLoading","onDismiss","buttonGroupProps","primaryButtonProps","secondaryButtonProps"];r.a.directive(n.a.components.react.reactDialog,[n.a.modules.reactDirective,e=>e(o.b,a)])},33675:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33676);r.a.directive(n.a.components.react.reactIconSet,[n.a.modules.reactDirective,e=>e(o.a,["icons","showErrorBadge","cdnService","assetService"])])},33676:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(11766),n=i(12754),o=i(15505),a=i(14962),s=i(14922),l=i(16828),c=i(12811),u=e=>{var{iconInfo:t,cdnService:i}=e;return r.createElement("div",{className:"flow-icon",style:{backgroundColor:t.brandColor}},r.createElement(l.b,{"aria-hidden":"true",src:t.iconUri,fallbackSrc:t.onErrorImagePath,cdnService:i}))},d=e=>{var{errorBadgeUrl:t,className:i,cdnService:n}=e;return r.createElement("div",{className:i},r.createElement(l.b,{"aria-hidden":"true",src:t,fallbackSrc:t,cdnService:n}))},p=e=>{var{excessCount:t,className:i}=e;return r.createElement("div",{className:Object(c.a)("flow-icon",i)},r.createElement("p",null,"+",t))},h=e=>{var{icons:t,showErrorBadge:i,assetService:l,cdnService:h}=e,m=(t=t||[]).length>s.b?s.a:t.length,g=Object(n.db)({contextIconTemplate:["context-icon-template",{height:"100%",width:"100%",position:"relative"}],errorBadge:["error-badge",{position:"absolute",margin:"-10px 0 0 calc(100% - 12px)",zIndex:a.f+1,selectors:{img:{height:"21px",width:"21px"}}}],multiIconSet:["multi-icon-set",{height:"100%",width:"100%",zIndex:a.f,selectors:{".flow-icon":{float:"left",textAlign:"center",selectors:{"&:after":{clear:"both"}}},img:{padding:"2px"}}}],iconSet1:["icon-set-1",{selectors:{div:{height:"100%",width:"100%"},img:{padding:"10px",height:"100%",width:"100%"}}}],iconSet2:["icon-set-2",{selectors:{div:{height:"50%",width:"100%"},img:{height:"100%",width:"50%"}}}],iconSet3:["icon-set-3",{selectors:{"div:first-child":{height:"50%",width:"100%",img:{height:"100%",width:"50%"}},"div:nth-child(2), div:nth-child(3)":{width:"50%",height:"50%",img:{height:"100%",width:"100%"}}}}],iconSet4:["icon-set-4",{selectors:{div:{width:"50%",height:"50%",img:{height:"100%",width:"100%"}}}}],multiIconExcessCount:["multi-icon-excess-count",{backgroundColor:a.p,p:{color:o.g,padding:"25% 25% 0 25%",textAlign:"center"}}]}),f="";switch(Math.min(s.b,t.length)){case 1:f=g.iconSet1;break;case 2:f=g.iconSet2;break;case 3:f=g.iconSet3;break;case 4:f=g.iconSet4}var v=t.length-m,b=t.slice(0,m);return r.createElement("div",{className:g.contextIconTemplate},i&&r.createElement(d,{errorBadgeUrl:l.notificationError,className:g.errorBadge,cdnService:h}),r.createElement("div",{className:Object(c.a)(g.multiIconSet,f)},b.map(e=>r.createElement(u,{key:"IconSet.icon.".concat(e.iconUri),iconInfo:e,cdnService:h})),v>0&&r.createElement(p,{excessCount:v,className:g.multiIconExcessCount})))}},33677:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(23044),a=["menuBarProps","backButtonProps","messageBarProps","additionalMessageBarProps","titleAriaLabel","titleText","titlePlaceholder","titleReadonly","statusText","ariaRole","ariaLevel","onBeforeGoBack","onTitleChange",["renderRightContent",{watchDepth:"reference",wrapApply:!1}],["clientResources",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactActionHeading,[n.a.modules.reactDirective,e=>e(o.a,a)])},33678:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(16816);r.a.directive(n.a.components.react.reactButtonGroup,[n.a.modules.reactDirective,e=>e(o.a,["primaryButtonText","onPrimaryButtonClick","primaryButtonDisabled","secondaryButtonText","onSecondaryButtonClick","secondaryButtonDisabled"])])},33679:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(22906),a=["cdsProvisioningState",["clientResources",{watchDepth:"reference"}],"assetService"];r.a.directive(n.a.components.react.reactFlowCreatorCdsProvisioning,[n.a.modules.reactDirective,e=>e(o.b,a)])},33680:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33681),a=[["triggers",{watchDepth:"collection"}],["actions",{watchDepth:"collection"}],"connectionReferences",["assetService",{watchDepth:"reference"}],["cdnService",{watchDepth:"reference"}],["clientResources",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactContactCards,[n.a.modules.reactDirective,e=>e(o.a,a)])},33681:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(12706),n=i(11766),o=i(33682),a=i(33683);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,i,c,p=d(h);function h(){var e;s(this,h);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=p.call(this,...i)).getClassNames=Object(r.a)(),e}return t=h,(i=[{key:"render",value:function(){var e=this.getClassNames(o.b);return n.createElement("div",{className:e.cards},n.createElement(a.a,{operations:this.props.triggers,cdnService:this.props.cdnService,clientResources:this.props.clientResources}),n.createElement(a.a,{operations:this.props.actions,cdnService:this.props.cdnService,clientResources:this.props.clientResources}))}}])&&l(t.prototype,i),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),h}(n.Component)},33682:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"h",(function(){return l})),i.d(t,"g",(function(){return c})),i.d(t,"d",(function(){return u})),i.d(t,"c",(function(){return d})),i.d(t,"f",(function(){return p})),i.d(t,"e",(function(){return h})),i.d(t,"b",(function(){return m}));var r=i(16817);function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=768,l=160,c=144,u=264,d=190,p=140,h=140,m=()=>({cards:["cards",o(o({},Object(r.e)()),{},{width:2*l,margin:"".concat(24,"px auto 0"),"> div":{float:"left",":first-child":{":before":{content:"''",position:"absolute",display:"block",zIndex:1,top:c/2-12,right:-12,width:24,height:24,borderRadius:"50%",backgroundColor:"white",boxShadow:"0 0 1px rgba(0, 0, 0, 0.6)"},":after":{position:"absolute",display:"block",zIndex:2,top:c/2-8,right:-8,fontFamily:"MWF-MDL2",fontSize:16,content:"'\\e72a'",color:"#333333"}}},["@media only screen and (min-width: ".concat(s,"px)")]:{width:2*u+24,marginTop:38,"> div:first-child":{marginRight:24,":before":{top:d/2-29,right:-41,width:58,height:58},":after":{top:d/2-15,right:-27,fontSize:30}}}},Object(r.q)({width:2*p}))]})},33683:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(12706),n=i(11766),o=i(13031),a=i(33684),s=i(33686);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(m,e);var t,i,u,h=p(m);function m(){var e;l(this,m);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=h.call(this,...i)).getClassNames=Object(r.a)(),e}return t=m,(i=[{key:"render",value:function(){var e=this.getClassNames(s.a);return n.createElement("div",{className:e.contactCardWithCaption},n.createElement("div",{className:"api-cell-container"},n.createElement(a.a,{operationInfosToRender:this.operationInfosToRender,totalOperations:this.props.operations.length,cdnService:this.props.cdnService,clientResources:this.props.clientResources})),n.createElement("div",{className:"contact-card-caption"},n.createElement("h3",{className:"c-subheading-4",title:this.contactCardLabel},this.contactCardLabel)))}},{key:"operationInfosToRender",get:function(){return this.props.operations.length<=4?this.props.operations:this.props.operations.slice(0,3)}},{key:"contactCardLabel",get:function(){var e=this.operationInfosToRender.map(e=>e.displayName);if(1===this.props.operations.length)return e[0];if(2===this.props.operations.length)return Object(o.a)(this.props.clientResources.TemplateDetails.ContactCard.TwoActions,e);if(this.props.operations.length<=4){var t=e.length-1;return Object(o.a)(this.props.clientResources.TemplateDetails.ContactCard.ThreeOrFourActions,e.slice(0,t).join(", "),e[t])}return Object(o.a)(this.props.clientResources.TemplateDetails.ContactCard.MoreThanFourActions,e.join(", "),this.props.operations.length-3)}}])&&c(t.prototype,i),u&&c(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(n.Component)},33684:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(12706),n=i(12811),o=i(14868),a=i(11766),s=i(16828),l=i(29086),c=i(11891),u=i(13223),d=i(33685);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=b(e);if(t){var n=b(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return v(this,i)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(b,e);var t,i,m,v=f(b);function b(){var e;p(this,b);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=v.call(this,...i)).getClassNames=Object(r.a)(),e.renderOperation=t=>{var i=Object(u.a)(),r=null;return(Object(c.a)(t.tier,o.d.premium)||t.isSponsored)&&(r="true"===t.isSponsored?e.props.clientResources.Common.Sponsored:e.props.clientResources.Common.Premium),a.createElement("div",{className:"api-cell",style:{background:t.brandColor},id:i,key:i,title:t.displayName},r&&a.createElement("div",{className:"contact-card-premium-label"},a.createElement(l.a,{premiumText:r})),a.createElement(s.a,{src:t.iconUri,fallbackSrc:t.onErrorImageSrc,cdnService:e.props.cdnService,alt:t.displayName}))},e.getIconClass=e=>{switch(e){case 1:return"f-one-icon";case 2:return"f-two-icons";case 3:return"f-three-icons";default:return"f-four-icons"}},e}return t=b,(i=[{key:"render",value:function(){var e=this.getClassNames(d.a);return a.createElement("div",{className:e.flowCContactCard},a.createElement("div",{className:Object(n.a)(e.apiCellContainer,this.getIconClass(this.props.totalOperations))},this.props.operationInfosToRender.map(this.renderOperation),this.props.totalOperations>this.props.operationInfosToRender.length&&a.createElement("div",{className:"api-cell api-placeholder"},a.createElement("p",null,"+",this.props.totalOperations-this.props.operationInfosToRender.length))))}}])&&h(t.prototype,i),m&&h(t,m),Object.defineProperty(t,"prototype",{writable:!1}),b}(a.Component)},33685:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=()=>({apiCellContainer:["api-cell-container",{width:"100%",height:"100%"}],flowCContactCard:["flow-c-contact-card",{padding:0,position:"relative",width:"100%",height:"100%",boxShadow:"0 0 2px rgba(0,0,0,0.2)",".contact-card-premium-label":{position:"absolute",right:-10,top:10,zIndex:2},".api-cell":{float:"left",textAlign:"center",img:{height:"75%",position:"relative",top:"10%"}},".f-one-icon":{".api-cell":{height:"100%",width:"100%"}},".f-two-icons":{".api-cell":{height:"50%",width:"100%"}},".f-three-icons":{".api-cell:first-child":{height:"50%",width:"100%"},".api-cell":{height:"50%",width:"50%"}},".f-four-icons":{div:{height:"50%",width:"50%"}}}]})},33686:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(16817),n=i(33682);function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var l=()=>({contactCardWithCaption:["contact-card-with-caption",{position:"relative",".api-cell-container":a({width:n.h,height:n.g,["@media only screen and (min-width: ".concat(n.a,"px)")]:{width:n.d,height:n.c}},Object(r.q)({width:n.f,height:n.e})),".contact-card-caption":{display:"none",width:"100%",height:74,float:"left",padding:"0 5px",backgroundColor:"white",textAlign:"center",position:"relative",["@media only screen and (min-width: ".concat(n.a,"px)")]:{display:"block"},h3:{width:"95%",padding:0,position:"absolute",top:"50%",transform:"translateY(-50%)"}}}]})},33687:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(15498),a=["checked","disabled","label","onChange"];r.a.directive(n.a.components.react.reactCheckbox,[n.a.modules.reactDirective,e=>e(o.b,a)])},33688:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(19933),a=["value","label","required","placeholder","onChanged","onFormatDate","onParseDateFromString",["clientResources",{watchDepth:"reference"}],["dateTimeResources",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactDatePicker,[n.a.modules.reactDirective,e=>e(o.a,a)])},33689:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(15519),a=["selectedItems","onFilterChange","onSelectionChange","isDisabled","placeholder","maxLength","required","onSelectedItemValidation","allowUserSpecifiedValues",["loggingService",{watchDepth:"reference"}],["sharedComponentsResources",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactPeoplePicker,[n.a.modules.reactDirective,e=>e(o.a,a)])},33690:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(23045);r.a.directive(n.a.components.react.reactBackButton,[n.a.modules.reactDirective,e=>e(o.b,["backUrl","isDisabled","showBackText","telemetryData","onBeforeNavigate","onClick","clientResources"])])},33691:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33692),a=["headline","target","bodyContent","hyperLink","hasCloseButton","primaryButtonProps","onDismiss"];r.a.directive(n.a.components.react.reactCoachmarkWithTeachingBubble,[n.a.modules.reactDirective,e=>e(o.a,a)])},33692:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11766),n=i(17720),o=i(17728),a=e=>{var{target:t,headline:i,bodyContent:a,hyperLink:s,hasCloseButton:l,primaryButtonProps:c,onDismiss:u}=e,d=r.createElement("div",{style:{marginTop:"20px"}},r.createElement("a",{href:s,target:"_blank",style:{textDecoration:"underline"}},a));return r.createElement(r.Fragment,null,r.createElement(n.a,{target:t},r.createElement(o.a,{headline:i,hasCondensedHeadline:!0,hasCloseButton:l,primaryButtonProps:c,onDismiss:u},d)))}},33693:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(20872),a=["ariaRole","ariaLevel","footerButtonProps","onClickEditInWorkflowsApp","onClickManageYourWorkflow",["clientResources",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactWidgetFooter,[n.a.modules.reactDirective,e=>e(o.a,a)])},33694:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33695);n.a.component(r.a.components.ngCommands,{template:i(33696),controller:o.a,controllerAs:"ngCommandsOverlayCtrl"})},33695:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(19862),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s={id:"noCommand",options:{}},l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.loggingService=i,this.command=void 0,this.onCommandChanged=()=>{this.$scope.$applyAsync(()=>{this.command=r.a.getCurrentCommand()||s,this.logCommandChange()})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"NgCommandsOverlayCtrl"}),this.command=r.a.getCurrentCommand()||s,this.logCommandChange(),r.a.addCommandChangedEventListener(this.onCommandChanged),t.$on("$destroy",()=>{r.a.removeCommandChangedEventListener(this.onCommandChanged)})}var t,i,n;return t=e,(i=[{key:"shouldShowSubmitTemplateCommand",value:function(){return"showSubmitAsTemplate"===this.command.id&&this.command.options.show}},{key:"shouldShowFlowRunOnlyUsersUI",value:function(){return"showRunOnlyUsersPane"===this.command.id}},{key:"shouldShowSaveAsDialog",value:function(){return"showSaveAsDialog"===this.command.id&&this.command.options.show}},{key:"shouldShowSendACopyPane",value:function(){return"showSendACopyPane"===this.command.id}},{key:"logCommandChange",value:function(){this.loggingService.logInfo("NgCommandsOverlayCtrl","Command changed.",{command:this.command.id})}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[n.a.services.$scope,n.a.services.logging]},33696:function(e,t){e.exports='<submit-template model="ngCommandsOverlayCtrl.command.options" ng-if="ngCommandsOverlayCtrl.shouldShowSubmitTemplateCommand()"></submit-template>\n<ng-flow-run-only-users-ui options="ngCommandsOverlayCtrl.command.options" ng-if="ngCommandsOverlayCtrl.shouldShowFlowRunOnlyUsersUI()"></ng-flow-run-only-users-ui>\n<ng-flow-save-as-ui options="ngCommandsOverlayCtrl.command.options" ng-if="ngCommandsOverlayCtrl.shouldShowSaveAsDialog()"></ng-flow-save-as-ui>\n<ng-flow-send-a-copy-ui options="ngCommandsOverlayCtrl.command.options" ng-if="ngCommandsOverlayCtrl.shouldShowSendACopyPane()"></ng-flow-send-a-copy-ui>\n'},33697:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(22395),a=[["widgetUtilService",{watchDepth:"reference"}],["sessionStore",{watchDepth:"reference"}],["environmentStore",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactDefaultNpsDialog,[n.a.modules.reactDirective,e=>e(o.a,a)])},33698:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33699);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33700);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.controllerAs="optionsCtrl",this.template=i(33701),this.bindings={model:"="}}));r.a.component(n.a.components.options,new c)},33699:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.loggingService=i,this.model=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"OptionsCtrl"})}var t,i,r;return t=e,(i=[{key:"selectOption",value:function(e){this.model.selectedOption=e}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.$inject=[r.a.services.$scope,r.a.services.logging]},33700:function(e,t,i){e.exports=i.p+"static/media/options.58310384.less"},33701:function(e,t){e.exports='<div class="context-option-items">\n    <div class="option-item" ng-repeat="option in optionsCtrl.model.options">\n        <button style="width: {{100 / optionsCtrl.model.options.length}}%" class="c-select-button" aria-pressed="{{option.displayName === optionsCtrl.model.selectedOption.displayName}}" name="{{option.displayName}}" ng-click="optionsCtrl.selectOption(option)" title="{{option.displayName}}">{{option.displayName}}</button>\n    </div>\n</div>'},33702:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33703);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33705);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33706),this.bindings={debounce:"<",error:"=",inputId:"<",inputPlaceholder:"<",inputRequired:"<?",inputValue:"=",items:"=",selectedIndex:"=",loading:"=",onChange:"<",onSelect:"<",isDisabled:"<"},this.transclude={itemTemplate:"autocompleteItemTemplate",errorTemplate:"?autocompleteErrorTemplate",suggestionTextTemplate:"?autocompleteSuggestionTextTemplate"},this.controller=o.a,this.controllerAs="autocompleteCtrl"}));n.a.component(r.a.components.autocomplete,new c)},33703:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(17929),n=i.n(r),o=i(33327),a=i(33704);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$element=t,this.$q=i,this.$scope=r,this.loggingService=n,this.inputId=void 0,this.inputValue=void 0,this.inputPlaceholder=void 0,this.inputRequired=void 0,this.isDisabled=void 0,this.debounce=void 0,this.error=void 0,this.items=void 0,this.onChange=void 0,this.onSelect=void 0,this.selectedIndex=void 0,this._debouncedOnChange=void 0,this._lastOnChangeText=null,this._cancelDeferred=void 0,this.$onInit=()=>{this._lastOnChangeText=this.inputValue,this.$scope.$on("destroy",()=>{this._cancelDeferred&&(this._cancelDeferred.resolve(),this._cancelDeferred=null)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"AutocompleteCtrl"})}var t,i,r;return t=e,(i=[{key:"handleChange",value:function(){this._debouncedOnChange||(this._debouncedOnChange=n()(()=>{this._lastOnChangeText!==this.inputValue&&(this._cancelDeferred&&this._cancelDeferred.resolve(),this._cancelDeferred=this.$q.defer(),this.$scope.$applyAsync(()=>{this._lastOnChangeText=this.inputValue,this.onChange(this.inputValue,this._cancelDeferred.promise)}))},this.debounce||350)),this._debouncedOnChange()}},{key:"handleSelect",value:function(e,t){this.onSelect&&this.onSelect(e,t)}},{key:"handleMouseEnter",value:function(e){e<this.getItems().length?this.selectedIndex=e:this.selectedIndex=-1}},{key:"handleKeyDown",value:function(e){switch(Object(a.b)(e)){case a.a.enter:e.preventDefault(),this.selectedIndex>=0&&this.selectedIndex<this.getItems().length&&this.handleSelect(this.getItems()[this.selectedIndex],e);break;case a.a.arrowUp:e.preventDefault(),this.selectedIndex>0&&(this.selectedIndex-=1),this.scrollSelectedItemIntoViewIfNeeded();break;case a.a.arrowDown:e.preventDefault(),this.selectedIndex<this.getItems().length-1&&(this.selectedIndex+=1),this.scrollSelectedItemIntoViewIfNeeded()}}},{key:"scrollSelectedItemIntoViewIfNeeded",value:function(){var e=this.$element[0].querySelectorAll("ul.autocomplete-list li.autocomplete-list-item")[this.selectedIndex];e&&e.scrollIntoView({block:"nearest"})}},{key:"getItems",value:function(){return this.items||[]}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[o.a.services.$element,o.a.services.$q,o.a.services.$scope,o.a.services.logging]},33704:function(e,t,i){"use strict";function r(e){return e.which?e.which:e.keyCode}i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var n={tab:9,enter:13,arrowUp:38,arrowDown:40}},33705:function(e,t,i){e.exports=i.p+"static/media/autocomplete.4b184a66.less"},33706:function(e,t){e.exports='<div class="autocomplete-container">\n    <form class="autocomplete-form">\n        <input\n            id="{{autocompleteCtrl.inputId}}"\n            placeholder="{{autocompleteCtrl.inputPlaceholder}}"\n            ng-model="autocompleteCtrl.inputValue"\n            ng-change="autocompleteCtrl.handleChange($event)"\n            ng-keydown="autocompleteCtrl.handleKeyDown($event)"\n            ng-disabled="autocompleteCtrl.isDisabled"\n            ng-required="autocompleteCtrl.inputRequired"\n            type="text"\n            class="c-text-field autocomplete-input"\n            autocomplete="off" />\n    </form>\n    <div class="autocomplete-list-wrapper">\n        <ul\n            class="autocomplete-list"\n            ng-if="autocompleteCtrl.getItems().length > 0"\n            ng-keydown="autocompleteCtrl.handleKeyDown($event)"\n            role="list">\n            <li\n                class="autocomplete-list-item"\n                ng-class="{\'autocomplete-selected-row\': $index === autocompleteCtrl.selectedIndex}"\n                ng-repeat="item in autocompleteCtrl.items"\n                ng-transclude="itemTemplate"\n                ng-click="autocompleteCtrl.handleSelect(item,$event)"\n                ng-mouseenter="autocompleteCtrl.handleMouseEnter($index)"\n                role="listitem">\n            </li>\n        </ul>\n        <div ng-transclude="suggestionTextTemplate" aria-live="assertive" class="autocomplete-hint" ng-if="autocompleteCtrl.getItems().length > 0"></div>\n        <div ng-transclude="errorTemplate" ng-if="!!autocompleteCtrl.error" class="autocomplete-error" role="alert"></div>\n    </div>\n</div>\n'},33707:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(33327),n=i(33335),o=i(33708);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i(33709);var u=s((function e(){c(this,e),this.template=i(33710),this.controller=o.a,this.bindings={onSelect:"<",onGetUsers:"&",isDisabled:"<",inputPlaceholder:"<",searchErrorTextFormat:"<",inputRequired:"<?",inputId:"<?"},this.controllerAs="userAutocompleteCtrl"})),d=function(){function e(t,i,r,n){c(this,e),this._id=t,this._mail=i,this._displayName=r,this._type=n}return s(e,[{key:"type",get:function(){return this._type}},{key:"id",get:function(){return this._id}},{key:"mail",get:function(){return this._mail}},{key:"displayName",get:function(){return this._displayName}}]),e}();n.a.component(r.a.components.userAutocomplete,new u)},33708:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33327),n=i(33360),o=i(33392);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.clientResources=i,this.loggingService=r,this.items=void 0,this.selectedIndex=-1,this.inputValue="",this.inputPlaceholder=void 0,this.loading=!1,this.isDisabled=void 0,this.onSelect=void 0,this.onGetUsers=void 0,this.searchErrorTextFormat=void 0,this.displayedSearchErrorText="",this.suggestionText="",this.handleChange=(e,t)=>{if(this.selectedIndex=-1,this.displayedSearchErrorText="",this.suggestionText="",e.trim().length<2)return this.items=[],void(this.loading=!1);this.loading=!0,this.onGetUsers({searchText:e,cancel:t}).then(t=>{this.items=t,this.items.length>0?(this.selectedIndex=0,this.suggestionText=Object(n.d)(this.clientResources.UserAutocomplete.SuggestionText,this.items.length)):e&&(this.displayedSearchErrorText=Object(n.d)(this.searchErrorTextFormat,e))}).catch(e=>{this.loggingService.logError("UserAutocompleteCtrl.handleChange",e),Object(o.b)(e)!==o.a.Abort&&(this.displayedSearchErrorText=Object(o.e)(e))}).finally(()=>{this.loading=!1})},this.handleSelect=(e,t)=>{this.selectedIndex=-1,this.items=[],this.inputValue="",this.onSelect&&this.onSelect(e,t)},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"UserAutocompleteCtrl"})}));c.$inject=[r.a.services.$q,r.a.services.clientResources,r.a.services.logging]},33709:function(e,t,i){e.exports=i.p+"static/media/userAutocomplete.0ebed3b2.less"},33710:function(e,t){e.exports='<div class="user-autocomplete">\n    <autocomplete input-value="userAutocompleteCtrl.inputValue"\n        input-placeholder="userAutocompleteCtrl.inputPlaceholder"\n        items="userAutocompleteCtrl.items"\n        input-required="userAutocompleteCtrl.inputRequired"\n        input-id="userAutocompleteCtrl.inputId"\n        selected-index="userAutocompleteCtrl.selectedIndex"\n        loading="userAutocompleteCtrl.loading"\n        on-change="userAutocompleteCtrl.handleChange"\n        on-select="userAutocompleteCtrl.handleSelect"\n        is-disabled="userAutocompleteCtrl.isDisabled"\n        error="userAutocompleteCtrl.displayedSearchErrorText">\n        <autocomplete-item-template>\n            <div title="{{$parent.item.displayName}}">{{$parent.item.displayName}}</div>\n            <div title="{{$parent.item.mail}}">{{$parent.item.mail}}</div>\n        </autocomplete-item-template>\n        <autocomplete-suggestion-text-template>\n            <p>{{userAutocompleteCtrl.suggestionText}}</p>\n        </autocomplete-suggestion-text-template>\n        <autocomplete-error-template>\n            <p>{{userAutocompleteCtrl.displayedSearchErrorText}}</p>\n        </autocomplete-error-template>\n    </autocomplete>\n</div>\n'},33711:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33712);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33713);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33714),this.bindings={model:"="},this.transclude={iconTemplate:"?infoCardIconTemplate",listTemplate:"?infoCardListTemplate",optionTemplate:"?infoCardOptionTemplate",pickerTemplate:"?infoCardPickerTemplate"},this.controller=o.a}));n.a.component(r.a.components.infoCard,new c)},33712:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33360);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function a(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=a((function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.assetService=i,this.loggingService=r,this.infoCardTitleId=Object(n.e)(),this.infoCardSubTitleId=Object(n.e)(),this.model=void 0,this.$onInit=()=>{this.$scope.model=this.model},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"InfoCardCtrl"})}));l.$inject=[r.a.services.$scope,r.a.services.assetService,r.a.services.logging]},33713:function(e,t,i){e.exports=i.p+"static/media/infoCard.c217f852.less"},33714:function(e,t){e.exports='<div class="info-card-item row">\n    <div class="info-card-icon" ng-transclude="iconTemplate"></div>\n    <div\n        class="info-card-text-section column medium-6 small-6"\n        aria-labelledby="{{::$ctrl.infoCardTitleId}}"\n        aria-describedby="{{::$ctrl.infoCardSubTitleId}}">\n        <div class="info-card-title" title="{{$ctrl.model.title}}" id="{{::$ctrl.infoCardTitleId}}">{{$ctrl.model.title}}</div>\n        <div class="info-card-subtitle" title="{{$ctrl.model.subTitle}}" id="{{::$ctrl.infoCardSubTitleId}}">\n            <img alt="{{$ctrl.model.subTitle}}" ng-show="$ctrl.model.statusIcon" ng-attr-src="{{$ctrl.model.statusIcon}}" img-on-error-src="{{::$ctrl.assetService.connection}}" />\n            {{$ctrl.model.subTitle}}\n        </div>\n        <div ng-transclude="listTemplate" class="info-card-list-option"></div>\n    </div>\n    <div class="info-card-options">\n        <div ng-transclude="pickerTemplate" class="dropdown-card-option"></div>\n        <div ng-transclude="optionTemplate" class="card-option"></div>\n    </div>\n</div>'},33715:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33716);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33717),this.bindings={model:"="},this.controller=o.a}));n.a.component(r.a.components.infoCardList,new c)},33716:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function o(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=o((function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.assetService=i,this.loggingService=r,this.model=void 0,this.$onInit=()=>{this.$scope.model=this.model},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"InfoCardListCtrl"})}));s.$inject=[r.a.services.$scope,r.a.services.assetService,r.a.services.logging]},33717:function(e,t){e.exports='<ps-list items="$ctrl.model">\n    <ps-list-item-template>\n        <info-card model="$parent.item">\n            <info-card-icon-template>\n                <img ng-attr-src="{{::$parent.model.iconUrl}}" img-on-error-src="{{::$ctrl.assetService.connection}}" alt="{{::$parent.model.title}}" />\n            </info-card-icon-template>\n            <info-card-picker-template></info-card-picker-template>\n            <info-card-option-template>\n                <div ng-click="$parent.model.click()" aria-label="{{::$parent.model.ariaLabel}}">\n                    <div class="c-glyph glyph-close option-block"></div>\n                </div>\n            </info-card-option-template>\n        </info-card>\n    </ps-list-item-template>\n</ps-list>'},33718:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33719);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33720);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33721),this.bindings={items:"="},this.transclude={itemTemplate:"psListItemTemplate"},this.controller=o.a,this.controllerAs="psListCtrl"}));n.a.component(r.a.components.psList,new c)},33719:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function n(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,"a",(function(){return a}));var a=n((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items=void 0}))},33720:function(e,t,i){e.exports=i.p+"static/media/psList.ea1fdcd5.less"},33721:function(e,t){e.exports='<ul class="ps-list">\n    <li\n        class="ps-list-item"\n        ng-repeat="item in psListCtrl.items"\n        ng-transclude="itemTemplate">\n    </li>\n</ul>\n'},33722:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33723);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33724),this.controller=o.a,this.bindings={inputId:"<?",onSelect:"<",isDisabled:"<",inputRequired:"<?"},this.controllerAs="graphAutocompleteCtrl"}));n.a.component(r.a.components.graphAutocomplete,new c)},33723:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33327),n=i(33707),o=i(33576),a=i(33439);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.clientResources=i,this.graphService=r,this.appSettings=n,this.loggingService=o,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"GraphAutocompleteCtrl"})}var t,i,r;return t=e,(i=[{key:"getUsers",value:function(e,t){return this.$q.all([this.graphService.queryUsers({searchText:e,cancel:t,excludeGuestUsers:this.appSettings.featureFlags.disableGuestUserSharing}),this.graphService.queryGroups({searchText:e,cancel:t,queryModernGroups:!0})]).then(e=>{var[t,i]=e,r=t.map(e=>new n.a(o.e(e),e.mail,e.displayName,a.b.User)).concat(i.map(e=>new n.a(o.e(e),e.mail,e.displayName,a.b.Group)));return r.length>0&&(r=r.slice(0,20)),r})}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[r.a.services.$q,r.a.services.clientResources,r.a.services.graph,r.a.services.appSettings,r.a.services.logging]},33724:function(e,t){e.exports='<user-autocomplete\n    on-select="graphAutocompleteCtrl.onSelect"\n    on-get-users="graphAutocompleteCtrl.getUsers(searchText, cancel)"\n    is-disabled="graphAutocompleteCtrl.disabled"\n    input-required="graphAutocompleteCtrl.inputRequired"\n    input-id="graphAutocompleteCtrl.inputId"\n    input-placeholder="::graphAutocompleteCtrl.clientResources.GraphAutocomplete.DefaultPlaceholder"\n    search-error-text-format="::graphAutocompleteCtrl.clientResources.GraphAutocomplete.NoResultText"\n></user-autocomplete>\n'},33725:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33726);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33727),this.bindings={model:"="},this.controller=o.a,this.controllerAs="spinnerCtrl"}));n.a.component(r.a.components.spinner,new c)},33726:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33383);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function a(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=a((function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.loggingService=i,this.isVisible=void 0,this.model=void 0,this.spinnerScopeCssClass=void 0,this.spinnerSize=void 0,this.$onInit=()=>{this.$scope.$watch(()=>this.model&&this.model.show,()=>{this.isVisible=this.model&&this.model.show}),this.$scope.$watch(()=>this.model&&this.model.local,()=>{if(this.model&&this.model.local)switch(this.model.local){case n.a.Global:this.spinnerScopeCssClass=n.b.global;break;case n.a.LocalHorizontal:this.spinnerScopeCssClass=n.b.localHorizontal;break;case n.a.LocalStatic:this.spinnerScopeCssClass=n.b.localStatic;break;case n.a.Local:default:this.spinnerScopeCssClass=n.b.local}else this.spinnerScopeCssClass=n.b.global}),this.$scope.$watch(()=>this.model&&this.model.size,()=>{this.spinnerSize=this.model&&this.model.size||n.c.Large})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"SpinnerCtrl"})}));l.$inject=[r.a.services.$scope,r.a.services.logging]},33727:function(e,t){e.exports='<div role="status" ng-class="spinnerCtrl.spinnerScopeCssClass" ng-if="spinnerCtrl.isVisible">\n    <div class="spinner-content" tabindex="0">\n        <react-spinner\n            size="spinnerCtrl.spinnerSize"\n            text="spinnerCtrl.model.message"\n        ></react-spinner>\n    </div>\n</div>\n'},33728:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33729);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33730);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bindings={model:"="},this.controller=o.a,this.controllerAs="fullPageErrorCtrl",this.template=i(33731)}));r.a.component(n.a.components.fullPageError,new c)},33729:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(12324),o=i(13015);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,r,n,o,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.appSettings=i,this.assetService=r,this.clientResources=n,this.widgetUtilService=o,this.loggingService=a,this.sessionStore=s,this.model=void 0,this.widgetCloseButton=void 0,this.sessionId=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FullPageErrorCtrl"}),this.widgetCloseButton={url:"",click:this.widgetUtilService.fireWidgetCloseEvent.bind(this.widgetUtilService)},this.sessionId=this.sessionStore.sessionId}var t,i,r;return t=e,(i=[{key:"getTime",value:function(){return this.model.time?this.model.time:new Date}},{key:"getImage",value:function(){return this.model.image||this.assetService.fullPageErrorGeneric}},{key:"getFriendlyErrorText",value:function(){return this.model.friendlyErrorText?this.model.friendlyErrorText:this.clientResources.FullPageError.FriendlyError.Text.Default}},{key:"getFriendlyErrorSubtext",value:function(){return this.model.friendlyErrorSubtext?this.model.friendlyErrorSubtext:this.clientResources.FullPageError.FriendlyError.Subtext.Default}},{key:"getErrorDetail",value:function(){return Object(o.o)(this.model.error,this.clientResources.Common.SomethingWentWrong)}},{key:"getXMsClientRequestId",value:function(){return this.model.error&&this.model.error.config&&this.model.error.config.headers&&this.model.error.config.headers["x-ms-client-request-id"]}},{key:"getXMsCorrelationRequestId",value:function(){return this.model.error&&Object(n.isFunction)(this.model.error.headers)&&this.model.error.headers()&&this.model.error.headers()["x-ms-correlation-request-id"]}},{key:"hasCustomButtons",value:function(){return this.model.customButtons&&this.model.customButtons.length>0}},{key:"emitCustomButtonEvent",value:function(e){e&&e.event&&this.$scope.$emit(e.event)}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[r.a.services.$scope,r.a.services.appSettings,r.a.services.assetService,r.a.services.clientResources,r.a.services.widgetUtilService,r.a.services.logging,r.a.services.session]},33730:function(e,t,i){e.exports=i.p+"static/media/fullPageError.636270f3.less"},33731:function(e,t){e.exports='<div class="full-page-error sd-toggle" ng-if="fullPageErrorCtrl.model.isPageErrored" data-animation="slide">\n    <div class="full-page-error-title-container">\n        <backbutton ng-if="fullPageErrorCtrl.widgetUtilService.isTeamsSolutionExplorerContext()" model="fullPageErrorCtrl.widgetCloseButton" class="full-page-error-widget-close-button"></backbutton>\n        <span class="c-heading-3 full-page-error-title">{{fullPageErrorCtrl.model.pageTitle}}</span>\n    </div>\n    <div class="full-page-error-image-container">\n        <img cdn-src="{{fullPageErrorCtrl.getImage()}}" />\n    </div>\n    <div class="row full-page-error-message">\n        <h1 class="c-heading-3">{{fullPageErrorCtrl.getFriendlyErrorText()}}</h1>\n        <div class="column medium-6 medium-offset-3">\n            <p class="c-paragraph-3" ng-bind-html="fullPageErrorCtrl.getFriendlyErrorSubtext()"></p>\n            <p>\n                <a ng-if="fullPageErrorCtrl.hasCustomButtons()" ng-attr-target="{{fullPageErrorCtrl.widgetUtilService.isWidgetPage() ? \'_blank\' : undefined}}" ng-href="{{fullPageErrorCtrl.appSettings.supportPageUrl}}" class="c-hyperlink subtle">{{fullPageErrorCtrl.clientResources.FullPageError.Buttons.ContactSupport}}</a>\n            </p>\n        </div>\n    </div>\n    <div>\n        <div class="arrow_box">\n            <div class="full-page-error-details">\n                <div class="row">\n                    <p class="c-paragraph-3">{{fullPageErrorCtrl.clientResources.FullPageError.Details.SupportInstructions}}</p>\n                    \x3c!-- Headings deliberately left in English because these will be given to us for debugging.\n                         IDs are listed in order of specificity - The x-ms-correlation-request-id (if defined) is likely closest to the root of the problem --\x3e\n                    <div class="error-info-container">\n                        <div class="error-info">Time: {{fullPageErrorCtrl.getTime()}}</div>\n                        <div class="error-info" ng-if="fullPageErrorCtrl.sessionId">Session ID: {{fullPageErrorCtrl.sessionId}}</div>\n                        <div class="error-info" ng-if="fullPageErrorCtrl.getXMsClientRequestId()">x-ms-client-request-id (Client->Backend Request Header): {{fullPageErrorCtrl.getXMsClientRequestId()}}</div>\n                        <div class="error-info" ng-if="fullPageErrorCtrl.getXMsCorrelationRequestId()">x-ms-correlation-request-id (Backend Response Header): {{fullPageErrorCtrl.getXMsCorrelationRequestId()}}</div>\n                        <div class="error-info">Error: {{fullPageErrorCtrl.getErrorDetail()}}</div>\n                    </div>\n                </div>\n                <div class="close-button small-screen-close-button-container">\n                    <a role="button" class="c-action-trigger error-detail-close-button c-glyph glyph-close toggler" href=""></a>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="full-page-error-button-container">\n        <a ng-if="!fullPageErrorCtrl.hasCustomButtons()" ng-attr-target="{{fullPageErrorCtrl.widgetUtilService.isWidgetPage() ? \'_blank\' : undefined}}" ng-href="{{fullPageErrorCtrl.appSettings.supportPageUrl}}" role="button" class="c-button full-page-error-button text-ellipsis-button">{{fullPageErrorCtrl.clientResources.FullPageError.Buttons.ContactSupport}}</a>\n        <a ng-if="fullPageErrorCtrl.hasCustomButtons()" ng-repeat="button in fullPageErrorCtrl.model.customButtons" ng-attr-target="{{fullPageErrorCtrl.widgetUtilService.isWidgetPage() && button.url ? \'_blank\' : undefined}}" ng-click="fullPageErrorCtrl.emitCustomButtonEvent(button)" ng-href="{{button.url}}" role="button" class="c-button full-page-error-button text-ellipsis-button">{{button.buttonText}}</a>\n    </div>\n</div>\n'},33732:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33733);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33734),this.controller=o.a,this.bindings={onSelect:"<",isDisabled:"<"},this.controllerAs="xrmSystemUserAutocompleteCtrl"}));n.a.component(r.a.components.xrmSystemUserAutocomplete,new c)},33733:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33327),n=i(33707),o=i(33439),a=i(15522);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,n,o,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.promiseHelperService=i,this.xrmSystemUsersClient=r,this.appSettings=n,this.flowRoleService=o,this.xrmUserService=a,this.loggingService=s,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"XrmSystemUserAutocompleteCtrl"})}var t,i,r;return t=e,(i=[{key:"noResultText",get:function(){return this.clientResources.XrmSystemUserAutocomplete.NoResultTeamText}},{key:"getPrincipals",value:function(e){if(this.appSettings.featureFlags.enableShareSolutionFlowWithAADUsers&&this.flowRoleService.dvInstanceSupportsAutoJIT()){var t=this.xrmUserService.getGraphAndDVPeoplePickerSuggestions(e).then(e=>e.items.map(e=>new n.a(e.uniqueId,e.mail,e.text,this.convertPeoplePickerItemTypeToFlowSharingPrincipalType(e.type))).slice(0,20));return this.promiseHelperService.toAngularPromise(t)}var i=this.xrmSystemUsersClient.searchUsers(e).then(e=>e.map(e=>new n.a(e.systemuserid,e.internalemailaddress,e.fullname,o.b.SystemUser)).slice(0,10)),r=this.xrmSystemUsersClient.searchTeams(e).then(e=>e.map(e=>new n.a(e.teamid,e.emailaddress,e.name,o.b.Team)).slice(0,10)),a=Promise.all([i,r]).then(e=>{var[t,i]=e;return[...t,...i]});return this.promiseHelperService.toAngularPromise(a)}},{key:"convertPeoplePickerItemTypeToFlowSharingPrincipalType",value:function(e){return e===a.a.User?o.b.User:e===a.a.Group?o.b.Group:e===a.a.DataverseTeam?o.b.Team:o.b.NotSpecified}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[r.a.services.clientResources,r.a.services.promiseHelperService,r.a.services.xrmSystemUsersClient,r.a.services.appSettings,r.a.services.flowRoleService,r.a.services.xrmUserService,r.a.services.logging]},33734:function(e,t){e.exports='<user-autocomplete\n    on-select="xrmSystemUserAutocompleteCtrl.onSelect"\n    on-get-users="xrmSystemUserAutocompleteCtrl.getPrincipals(searchText, cancel)"\n    is-disabled="xrmSystemUserAutocompleteCtrl.disabled"\n    input-placeholder="::xrmSystemUserAutocompleteCtrl.clientResources.XrmSystemUserAutocomplete.DefaultPlaceholder"\n    search-error-text-format="xrmSystemUserAutocompleteCtrl.noResultText"\n></user-autocomplete>\n'},33735:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33736);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33737);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33738),this.controller=o.a,this.controllerAs="backbuttonCtrl",this.bindings={model:"="}}));r.a.component(n.a.components.backbutton,new c)},33736:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$window=i,this.clientResources=r,this.navigation=n,this.loggingService=o,this.model=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"BackButtonCtrl"})}var t,i,r;return t=e,(i=[{key:"onGoBack",value:function(){this.model.click?this.model.click():this.navigation.navigate(this.model.url)}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.$inject=[r.a.services.$scope,r.a.services.$window,r.a.services.clientResources,r.a.services.navigation,r.a.services.logging]},33737:function(e,t,i){e.exports=i.p+"static/media/backbutton.69f94bf2.less"},33738:function(e,t){e.exports='<div class="context-glyph-tile back-button-container">\n    <button class="c-glyph glyph-arrowback" ng-click="backbuttonCtrl.onGoBack()"\n        aria-label="{{(backbuttonCtrl.model && backbuttonCtrl.model.ariaLabel) || backbuttonCtrl.clientResources.GoBackButtonDefaultAriaLabel}}">\n        <label ng-if="backbuttonCtrl.model.showLabel">{{backbuttonCtrl.clientResources.GoBackButtonLabel}}</label>\n    </button>\n</div>'},33739:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33740);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33741);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33742),this.bindings={header:"<",subHeader:"<",buttonText:"<",renderButton:"<",onClick:"&"},this.controller=o.a,this.controllerAs="fullPageSingleActionCtrl"}));r.a.component(n.a.components.fullPageSingleAction,new c)},33740:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function o(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=o((function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.clientResources=i,this.assetService=r,this.loggingService=n,this.header=void 0,this.subHeader=void 0,this.buttonText=void 0,this.renderButton=void 0,this.flowLogo=this.assetService.flowLogoBlue,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FullPageSingleActionCtrl"})}));s.$inject=[r.a.services.appSettings,r.a.services.clientResources,r.a.services.assetService,r.a.services.logging]},33741:function(e,t,i){e.exports=i.p+"static/media/fullPageSingleAction.667dc9d3.less"},33742:function(e,t){e.exports='<div class="full-page-single-action x-type-center">\n    <img class="flow-logo-image" cdn-src="{{fullPageSingleActionCtrl.flowLogo}}" alt="{{::fullPageSingleActionCtrl.appSettings.brandName}}" />\n    <h1 class="full-page-single-action-header c-heading-3">{{fullPageSingleActionCtrl.header}}</h1>\n    <h2 class="full-page-single-action-header c-heading-4"\n        ng-if="fullPageSingleActionCtrl.subHeader">{{fullPageSingleActionCtrl.subHeader}}</h2>\n    <button class="full-page-single-action-button c-button btn-primary"\n        ng-if="fullPageSingleActionCtrl.renderButton"\n        ng-click="fullPageSingleActionCtrl.onClick()"\n        type="submit">{{fullPageSingleActionCtrl.buttonText}}\n    </button>\n</div>\n'},33743:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33744);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33745);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33746),this.bindings={icons:"<",primaryText:"<",secondaryText:"<?",secondaryTextHtmlTitle:"<?"},this.controller=o.a,this.controllerAs="horizontalContactCardCtrl"}));r.a.component(n.a.components.horizontalContactCard,new c)},33744:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cdnService=t,this.assetService=i,this.loggingService=r,this.icons=void 0,this.primaryText=void 0,this.secondaryText=void 0,this.secondaryTextHtmlTitle=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"HorizontalContactCardCtrl"})}var t,i,r;return t=e,(i=[{key:"secondaryTextTitle",get:function(){return this.secondaryTextHtmlTitle||this.secondaryText}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.$inject=[r.a.services.cdnService,r.a.services.assetService,r.a.services.logging]},33745:function(e,t,i){e.exports=i.p+"static/media/horizontalContactCard.56fc47e0.less"},33746:function(e,t){e.exports='<div class="horizontalContactCard">\n    <span class="horizontalContactCard-iconContainer" ng-if="horizontalContactCardCtrl.icons">\n        <react-icon-set \n            icons="horizontalContactCardCtrl.icons" \n            assetService="horizontalContactCardCtrl.assetService"\n            cdnService="horizontalContactCardCtrl.cdnService">\n        </react-icon-set>\n    </span>\n    <div class="horizontalContactCard-textContainer">\n        <div class="horizontalContactCard-innerTextContainer">\n            <p class="horizontalContactCard-primaryText" title="{{horizontalContactCardCtrl.primaryText}}">\n                {{horizontalContactCardCtrl.primaryText}}\n            </p>\n            <p class="horizontalContactCard-secondaryText" ng-if="horizontalContactCardCtrl.secondaryText"\n                title="{{horizontalContactCardCtrl.secondaryTextTitle}}">\n                {{horizontalContactCardCtrl.secondaryText}}\n            </p>\n        </div>\n    </div>\n</div>'},33747:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33748);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33749);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.controllerAs="emailDisplayCtrl",this.template=i(33750),this.bindings={items:"<",onEmailDelete:"&"}}));r.a.component(n.a.components.emailDisplay,new c)},33748:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33360),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.loggingService=i,this.items=void 0,this.onEmailDelete=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"EmailDisplayCtrl"})}var t,i,n;return t=e,(i=[{key:"onDelete",value:function(e){this.onEmailDelete&&this.onEmailDelete({item:e})}},{key:"getAriaLabelText",value:function(e){return Object(r.d)(this.clientResources.Email.Delete.Button,e)}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.$inject=[n.a.services.clientResources,n.a.services.logging]},33749:function(e,t,i){e.exports=i.p+"static/media/emailDisplay.8b2dcf8d.less"},33750:function(e,t){e.exports='<div\n    class="email-display-component"\n    ng-if="emailDisplayCtrl.items.length > 0" >\n    <div\n        class="email-block"\n        ng-repeat="email in emailDisplayCtrl.items">\n        <div\n            class="email-text"\n            title="{{email.displayName}}<{{email.mail}}>">{{email.displayName}}</div>\n        <button\n            class="c-glyph glyph-close email-delete"\n            aria-label="{{emailDisplayCtrl.getAriaLabelText(email.displayName)}}"\n            ng-click="emailDisplayCtrl.onDelete(email)"></button>\n    </div>\n</div>\n'},33751:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33752);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33753);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33754),this.bindings={onFileChange:"<",config:"<?",placeholder:"<?",isRequired:"<?"},this.controller=o.a,this.controllerAs="filePickerCtrl"}));n.a.component(r.a.components.filePicker,new c)},33752:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33360);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function a(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=a((function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.assetService=i,this.loggingService=r,this.onFileChange=void 0,this.config=void 0,this.isRequired=void 0,this.selectedFileName=void 0,this.selectedFileId=Object(n.e)(),this.uploadFileIcon=this.assetService.contentUpload,this.handleFileSelection=e=>{var t=e.target.files[0];t&&(this.selectedFileName=t.name,this.onFileChange&&this.onFileChange(t))},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FilePickerCtrl"})}));l.$inject=[r.a.services.clientResources,r.a.services.assetService,r.a.services.logging]},33753:function(e,t,i){e.exports=i.p+"static/media/filePicker.603a60d4.less"},33754:function(e,t){e.exports='<div class="filePicker">\n    <div class="filePicker-selectedFileContainer">\n        <input class="filePicker-selectedFileName c-text-field"\n            type="text"\n            ng-model="filePickerCtrl.selectedFileName"\n            placeholder="{{filePickerCtrl.placeholder}}"\n            required="filePickerCtrl.isRequired"\n            readonly />\n        <input\n            class="filePicker-selectedFileInput"\n            type="file"\n            id="{{::filePickerCtrl.selectedFileId}}"\n            on-input-file-change="filePickerCtrl.handleFileSelection"\n            ngf-select\n            ngf-pattern="{{filePickerCtrl.config.ngInputPattern}}"\n            ngf-accept="{{filePickerCtrl.config.ngInputAccept}}"\n            ngf-max-size="{{filePickerCtrl.config.ngInputMaxSize}}" />\n    </div>\n    <div class="filePicker-fileInputIconContainer">\n        <label class="filePicker-fileInputIconLabel" for="{{::filePickerCtrl.selectedFileId}}">\n            <img class="filePicker-fileInputIcon"\n                cdn-src="{{filePickerCtrl.uploadFileIcon}}"\n                alt="{{::filePickerCtrl.clientResources.Common.chooseFile}}" />\n        </label>\n    </div>\n</div>'},33755:function(e,t,i){"use strict";i(33756),i(33760),i(33761),i(33762),i(33763),i(33764)},33756:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33758);i(33757),r.a.directive(n.a.directives.listCommands,()=>({restrict:"E",template:i(33759),scope:{model:"=",isDisabled:"<",showTextDropdown:"<",dropdownGlyph:"<?",isLargeCommandPanel:"<?",buttonText:"<?",buttonAriaLabel:"<?",focusOnLoad:"<?"},controller:o.a,controllerAs:"controller"}))},33757:function(e,t,i){e.exports=i.p+"static/media/listCommandsTemplate.fff86a38.less"},33758:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(20368),o=i(14876),a=i(20354),s=i(13272);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$timeout=i,this.clientResources=r,this.iconName=s.a,this.isDropdownOpen=void 0,this.isInProgress=void 0,this.currentElement=void 0,this.documentClickListener=void 0,this.elementToFocusOnClose=void 0,this.currentTarget=void 0,this.dismissDropDown=()=>{this.isDropdownOpen&&(this.isDropdownOpen=!1,document.removeEventListener("click",this.documentClickListener),this.elementToFocusOnClose&&this.elementToFocusOnClose.focus())},this.toggleDropDown=e=>{this.$scope.isDisabled||e&&(e.preventDefault(),this.elementToFocusOnClose=e.currentTarget,this.currentElement=e.currentTarget.nextElementSibling,this.isDropdownOpen=!this.isDropdownOpen,this.currentTarget=e.currentTarget,this.documentClickListener=e=>{Object(n.a)(this.currentTarget,e.target)||this.$scope.$applyAsync(()=>{this.dismissDropDown()})},document.addEventListener("click",this.documentClickListener))},this.toggleDropDownReact=()=>{this.$scope.isDisabled||(this.elementToFocusOnClose=this.getMenuButton().getElementsByTagName("button")[0],this.isDropdownOpen=!this.isDropdownOpen,this.documentClickListener=e=>{Object(n.a)(this.getMenuButton(),e.target)||this.$scope.$applyAsync(()=>{this.dismissDropDown()})},document.addEventListener("click",this.documentClickListener))},this.onBlur=e=>{this.isDropdownOpen&&(this.isDropdownOpen=!1)},this.getMenuButton=()=>this.$scope.showTextDropdown?document.getElementById(this.getWideListMenuButtonId()):document.getElementById(this.getListMenuButtonId()),this.getListMenuButtonId=()=>"command-list-menu-button-".concat(this.$scope.$id),this.getWideListMenuButtonId=()=>"command-list-wide-menu-button-".concat(this.$scope.$id),this.$scope.focusOnLoad&&this.$timeout(()=>{this.getMenuButton().focus()}),Object(o.a)(this.$scope.dropdownGlyph)&&(this.$scope.dropdownGlyph="glyph-ellipsis"),this.isDropdownOpen=!1,this.$scope.$on("$destroy",()=>{document.removeEventListener("click",this.documentClickListener)})}var t,i,r;return t=e,(i=[{key:"getCommandText",value:function(e){return e.inProgress&&e.inProgressText?e.inProgressText:e.text}},{key:"getButtonText",value:function(){return this.$scope.buttonText||""}},{key:"getButtonLabel",value:function(){return this.$scope.buttonAriaLabel||this.$scope.buttonText||this.clientResources.ListCommands.More}},{key:"getIsDropdownOpen",value:function(){return this.isDropdownOpen}},{key:"getCommandListMenuId",value:function(){return this.$scope.showTextDropdown?"command-list-wide-menu"+this.$scope.$id:"command-list-menu-"+this.$scope.$id}},{key:"isCommandDisabled",value:function(e){return e.disabled||e.inProgress}},{key:"clickDropdownToggle",value:function(e){e.stopPropagation()}},{key:"clickCommand",value:function(e,t){if(e.stopPropagation(),!this.isCommandDisabled(t)){var i=t.click(this.elementToFocusOnClose);i&&i.finally&&(t.inProgress=!0,i.finally(()=>t.inProgress=!1)),t.commands||this.dismissDropDown()}}},{key:"handleKeydown",value:function(e){Object(a.b)(e)&&(e.stopPropagation(),this.dismissDropDown())}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[r.a.services.$scope,r.a.services.$timeout,r.a.services.clientResources]},33759:function(e,t){e.exports='<div class="dropdown-block" ng-if="!showTextDropdown" ng-keydown="controller.handleKeydown($event)">\n  <react-icon-button\n      ng-if="!buttonText"\n      on-click="controller.toggleDropDownReact"\n      class="dropbtn"\n      is-disabled="{{isDisabled}}"\n      id="{{::controller.getListMenuButtonId()}}"\n      aria-haspopup="true"\n      aria-expanded="{{controller.getIsDropdownOpen()}}"\n      aria-controls="::controller.getCommandListMenuId()"\n      react-title="::controller.getButtonLabel()"\n      data-test="dropdown-button"\n      icon-name="controller.iconName.More">\n  </react-icon-button>\n  <button ng-click="controller.toggleDropDown($event)"\n      ng-if="buttonText"\n      class="dropbtn"\n      ng-disabled="isDisabled"\n      id="{{::controller.getListMenuButtonId()}}"\n      aria-haspopup="true"\n      aria-expanded="{{controller.isDropdownOpen}}"\n      aria-controls="command-list-menu-{{::controller.$scope.$id}}"\n      role="button"\n      aria-label="{{::controller.getButtonLabel()}}"\n      ng-attr-title="{{::controller.getButtonLabel()}}"\n      data-test="dropdown-button">\n      <span class="c-glyph" ng-class="dropdownGlyph" ></span>\n      <span class="toggle-button-text">{{::controller.getButtonText()}}</span>\n  </button>\n  <ul class="dropdown-content ms-u-slideDownIn20"\n      ng-show="controller.isDropdownOpen"\n      role="menu"\n      id="command-list-menu-{{::controller.$scope.$id}}"\n      aria-labelledby="{{::controller.getListMenuButtonId()}}">\n      <li class="command-container"\n          role="menuitem"\n          ng-repeat="command in model"\n          ng-click="controller.clickCommand($event, command); dropdownToggled = !dropdownToggled;"\n          ng-disabled="controller.isCommandDisabled(command)"\n          ng-mouseover="hoveringInChildCommandToggle = true"\n          ng-mouseleave="hoveringInChildCommandToggle = false"\n          ng-blur="$last ? controller.onBlur($event): null"\n          aria-setsize="{{model.length}}"\n          aria-posinset="{{$index+1}}">\n          <div ng-class="[command.iconUrl, {\n                  \'img-button dropdown-item c-glyph\': !isLargeCommandPanel,\n                  \'large-command-panel\': isLargeCommandPanel,\n                  \'child-dropdown-toggle\': command.commands,\n                  \'toggled\': dropdownToggled }]"\n              data-test="{{command.name}}"\n              ng-disabled="controller.isCommandDisabled(command)"\n              title="{{command.tooltip}}">\n              <img ng-if="command.iconSrc" cdn-src="{{command.iconSrc}}" alt="{{controller.getCommandText(command)}}" role="presentation" />\n              <i ng-if="command.iconClass" ng-class="command.iconClass"></i>\n              <span class="command-text" ng-class="{\'large-command-panel\': isLargeCommandPanel}">{{controller.getCommandText(command)}}</span>\n              <i ng-if="command.checked" class="ms-Icon ms-Icon--CheckMark"></i>\n          </div>\n          <ul\n              class="dropdown-content hover-menu"\n              role="menu"\n              ng-if="command.commands"\n              ng-show="hoveringInChildCommandToggle || hoveringInChildCommands || dropdownToggled"\n              ng-mouseover="hoveringInChildCommands = true"\n              ng-mouseleave="hoveringInChildCommands = false">\n              <li ng-repeat="childCommand in command.commands" data-test="{{childCommand.name}}" class="img-button dropdown-item"  ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li>\n          </ul>\n          <ul\n              class="dropdown-content click-menu"\n              role="menu"\n              ng-if="command.commands"\n              ng-show="dropdownToggled">\n              <li ng-repeat="childCommand in command.commands" data-test="{{childCommand.name}}" class="img-button dropdown-item"  ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li>\n          </ul>\n      </li>\n  </ul>\n</div>\n<div\n  class="dropdown-block-wide"\n  id="{{::controller.getWideListMenuButtonId()}}"\n  ng-if="showTextDropdown"\n  ng-attr-aria-label="{{controller.getButtonLabel()}}"\n  ng-keydown="controller.handleKeydown($event)">\n  <button ng-click="controller.toggleDropDown($event)"\n      class="dropbtn-text"\n      role="button"\n      ng-disabled="isDisabled"\n      ng-class="{ \'disabled\': isDisabled }"\n      aria-haspopup="true"\n      aria-expanded="{{controller.isDropdownOpen}}"\n      aria-controls="command-list-wide-menu-{{::controller.$scope.$id}}">\n      {{controller.getButtonText()}} <span class="c-glyph glyph-arrowdown"></span>\n  </button>\n  <ul class="dropdown-content wide ms-u-slideDownIn20"\n      ng-show="controller.isDropdownOpen"\n      role="menu"\n      id="command-list-wide-menu-{{::controller.$scope.$id}}"\n      aria-labelledby="{{::controller.getWideListMenuButtonId()}}"\n      tabindex="0">\n      <div ng-repeat="command in model" class="command-container">\n          <li\n              class="img-button dropdown-item c-glyph"\n              ng-class="[command.iconUrl, { \'disabled\': controller.isCommandDisabled(command) }]"\n              ng-click="controller.clickCommand($event, command)"\n              role="menuitem"\n              ng-mouseover="hoveringInChildCommandToggle = true"\n              ng-mouseleave="hoveringInChildCommandToggle = false">\n              <img ng-if="command.iconSrc" cdn-src="{{command.iconSrc}}" alt="{{controller.getCommandText(command)}}" />\n              &nbsp;{{controller.getCommandText(command)}}\n          </li>\n          <ul\n              class="dropdown-content hover-menu"\n              role="menu"\n              ng-if="command.commands"\n              ng-show="hoveringInChildCommandToggle || hoveringInChildCommands"\n              ng-mouseover="hoveringInChildCommands = true"\n              ng-mouseleave="hoveringInChildCommands = false">\n              <li ng-repeat="childCommand in command.commands" class="img-button dropdown-item"  ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li>\n          </ul>\n          <ul\n              class="dropdown-content click-menu"\n              role="menu"\n              ng-if="command.commands"\n              ng-show="dropdownToggled">\n              <li ng-repeat="childCommand in command.commands" class="img-button dropdown-item"  ng-class="{ \'disabled\': controller.isCommandDisabled(childCommand) }" ng-click="controller.clickCommand($event, childCommand)" ng-attr-title="{{controller.getCommandText(childCommand)}}" role="menuitem">&nbsp;{{controller.getCommandText(childCommand)}}</li>\n          </ul>\n      </div>\n  </ul>\n</div>\n'},33760:function(e,t,i){"use strict";var r=i(33279),n=i(33334),o=i(33327);n.a.directive(o.a.directives.cdnSrc,[()=>({restrict:"A",priority:99,link:(e,t,i)=>{var n=r.noop;i.$observe(o.a.directives.cdnSrc,e=>{e&&i.$set("src",e)}),e.$on("$destroy",()=>{t.off("error",n)})}})])},33761:function(e,t,i){"use strict";var r=i(33334),n=i(33327);r.a.directive(n.a.directives.imgOnErrorSrc,[()=>({restrict:"A",link:(e,t,i)=>{t.bind("error",()=>{i.src!==i.imgOnErrorSrc&&(i.$set("src",i.imgOnErrorSrc),i.$set("imgOnErrorSrc",null))})}})])},33762:function(e,t,i){"use strict";var r=i(33334),n=i(33327);r.a.directive(n.a.directives.ngBindHtmlCompile,[n.a.services.$compile,e=>({restrict:"A",link:(t,i,r)=>{r.$observe(n.a.directives.ngBindHtmlCompile,r=>{i.html(r),e(i.contents())(t)})}})])},33763:function(e,t,i){"use strict";var r=i(33334),n=i(33327);r.a.directive(n.a.directives.onInputFileChange,[()=>({restrict:"A",link:(e,t,i)=>{var r=e.$eval(i[n.a.directives.onInputFileChange]);t.bind("change",e=>{r(e)})}})])},33764:function(e,t,i){"use strict";var r=i(33334),n=i(33446),o=i(33327);r.a.directive(o.a.directives.validateMultipleEmails,[()=>({require:"ngModel",link:(e,t,i,r)=>{r.$parsers.unshift(e=>e.split(";").every(e=>Object(n.e)(e))?(r.$setValidity("multipleEmails",!0),e):void r.$setValidity("multipleEmails",!1))}})])},33765:function(e,t,i){"use strict";i(33766),i(33767),i(33525)},33766:function(e,t,i){"use strict";var r=i(33338),n=i(33327),o=i(17914),a=i(12375);r.a.factory(n.a.interceptors.localeInterceptor,[()=>({request:e=>(e&&Object(o.g)(e.url)&&(e.headers=e.headers||{},e.headers["Accept-Language"]=Object(a.a)()),e)})])},33767:function(e,t,i){"use strict";var r=i(33338),n=i(33360),o=i(13223),a=i(33327),s=i(13e3),l=i(33525),c="x-ms-client-request-id",u="x-ms-client-session-id",d="x-ms-correlation-request-id",p="x-ms-request-id",h="x-ms-routing-request-id",m="Content-Length";function g(e){var t=e.url;return Object(n.b)(t,"/api/invoke")?t.substr(0,t.length-"/api/invoke".length)+e.headers["x-ms-path-query"]:t}function f(e){return{correlationId:e.headers(d),serviceRequestId:e.headers(p),routingRequestId:e.headers(h)}}function v(e){if(!e)return{status:-1};var t={status:e.status};return e.headers(m)&&(t.contentLength=parseInt(e.headers(m),10)),e.headers(p)&&(t.serviceRequestId=e.headers(p)),t}r.a.factory(a.a.interceptors.loggingInterceptor,[a.a.services.logging,a.a.services.session,a.a.services.$q,(e,t,i)=>({request:t=>{if(t&&t.url){var i;t.requestTimestamp=e.performanceNow();var r=Object(o.a)();(null==t||null===(i=t.headers)||void 0===i?void 0:i[l.a])&&(r=void 0),t.headers=t.headers||{},t.headers[c]=r,t.headers[u]=s.a.sessionId;var n=g(t),a=(t.method||"").toUpperCase();e.logHttpRequestStart("OUTGOING_REQUEST_START",a,n,r)}return t},response:i=>{var r=i&&i.config;if(r&&r.url){var n=r.requestTimestamp,o=g(r),a=e.performanceNow()-n,s=f(i),l=(r.method||"").toUpperCase(),u=r.headers[c];e.logHttpRequestEnd("OUTGOING_REQUEST_END",l,o,v(i),a,u,{hasAuthorizationHeaderInRequest:!(!r.headers.Authorization&&!r.headers.authorization),hasSessionRefreshFailed:t?t.hasSessionRefreshFailed():void 0},s.correlationId)}return i},responseError:r=>{var n=r&&r.config;if(n&&n.url){var o=n.requestTimestamp,a=g(n),s=e.performanceNow()-o,l=f(r),u=(n.method||"").toUpperCase();e.logHttpRequestEnd("OUTGOING_REQUEST_END",u,a,v(r),s,n.headers[c],{response:r.data,hasAuthorizationHeaderInRequest:!(!n.headers.Authorization&&!n.headers.authorization),hasSessionRefreshFailed:t?t.hasSessionRefreshFailed():void 0},l.correlationId)}return i.reject(r)}})])},33768:function(e,t,i){"use strict";i(33769),i(33770),i(33771),i(33775)},33769:function(e,t,i){"use strict";i(33501)},33770:function(e,t,i){"use strict";i(33453),i(33438)},33771:function(e,t,i){"use strict";i(33772)},33772:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33773);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.restrict="E",this.template=i(33774),this.scope={model:"="},this.controller=o.a,this.controllerAs="controller"}));r.a.directive(n.a.directives.connectionForm,[()=>new c])},33773:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33327),n=i(13223);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connectionFormService=t,this.loggingService=i,this.formId=Object(n.a)(),this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ConnectionFormDirectiveCtrl"})}var t,i,r;return t=e,(i=[{key:"isSupportedType",value:function(e){return this.connectionFormService.isSupportedType(e)}},{key:"getControlId",value:function(e){return e.replace(/\s/g,"-")+this.formId}},{key:"getOptionDisplayName",value:function(e){return e.text||e.value}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.$inject=[r.a.services.connectionForm,r.a.services.logging]},33774:function(e,t){e.exports='<div ng-repeat="(key, formItem) in model.formItems">\n    <ng-switch on="formItem.type">\n        <label class="c-label" for="{{controller.getControlId(key)}}">{{formItem.displayName}} <span ng-show="formItem.required" class="context-required-text">*</span></label>\n        <input ng-switch-when="securestring" ng-model="formItem.value" type="password" class="c-password" id="{{controller.getControlId(key)}}" ng-required="formItem.required"/>\n\n        <select ng-switch-when="options" ng-model="formItem.value" class="c-input-select-field"\n                                ng-options="controller.getOptionDisplayName(option) for option in formItem.options"\n                                ng-required="formItem.required"></select>\n\n        <input ng-switch-default="string" ng-model="formItem.value" type="text" class="c-text-field" id="{{controller.getControlId(key)}}" ng-required="formItem.required"/>\n    </ng-switch>\n</div>\n'},33775:function(e,t,i){"use strict";i(33776),i(33788),i(33789)},33776:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var r=i(33327),n=i(13009),o=i(13015),a=i(14868),s=i(13085),l=i(17266),c=i(14876),u=i(33525),d=i(33331),p=i(13031),h=i(19793),m=i(33777),g=i(33357),f=i(33358),v=i(28986),b=i(13240),y=i(33373),w=i(33778),S=i(33779),C=i(33783),k=i(33360),P=i(33785);function x(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,A(r.key),r)}}function A(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var T=function(e){return e[e.PostmanCollectionV2_0Schema=0]="PostmanCollectionV2_0Schema",e[e.PostmanCollectionV2_1Schema=1]="PostmanCollectionV2_1Schema",e[e.PostmanCollectionV1Schema=2]="PostmanCollectionV1Schema",e}({}),R=function(){function e(t,i,r,n,o,a,s,l,c,u,d,p,h,m,g){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=t,this.$http=i,this.$q=r,this.$timeout=n,this.$window=o,this.apiClient=a,this.appSettings=s,this.azureBlobUploaderService=l,this.clientResources=c,this.fileReader=u,this.loggingService=d,this.promiseHelperService=p,this.sessionService=h,this.telemetryService=m,this.widgetUtilService=g,this.providersApiUri=void 0,this.parametersApiUri=void 0,this.providersApiUri=s.consentServerUri+"/api/providers",this.parametersApiUri=this.providersApiUri+"/{0}/parameters"}var t,i,r;return t=e,(i=[{key:"genericValidateSwaggerAgainstSchema",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this.apiClient.validateApiSwagger({objectId:e,enableopenapivalidation:!0},t).catch(e=>{var t=Object(n.cb)(e);if(t===n.c.InvalidSwagger){var r=Object(n.v)(e).join(", ").trim(),o=Object(p.a)(this.clientResources.Manage.CustomApi.SwaggerInvalidAgainstSchema,r);return this.$q.reject(new h.a(i||t,o,e))}if(t===n.c.InvalidSwaggerBasedOnExtendedValidation){var a=(e&&e.data&&e.data.error&&e.data.error.message).split("\n"),s=a.filter(e=>-1!==e.search("Critical :")||-1!==e.search("Error :")).join("   ##   "),l=a.filter(e=>-1!==e.search("Warning :")).join("   ##   "),c=Object(p.a)(this.clientResources.Manage.CustomApi.SwaggerInvalidAgainstExtendedValidation,s),u=Object(p.a)(this.clientResources.Manage.CustomApi.SwaggerWarningsAgainstExtendedValidation,l),d={error:e,errorMessage:c,warningMessage:u};if(""!==s)return this.$q.reject(new h.a(i||t,c,d));if(""!==l)return this.$q.resolve(new h.a(i||t,u,d))}return this.loggingService.logError("CustomApiHelperService.genericValidateSwaggerAgainstSchema",e),this.$q.resolve()})}},{key:"validateSwaggerAgainstSchema",value:function(e,t){return this.genericValidateSwaggerAgainstSchema(e,t)}},{key:"getIdentityProviders",value:function(){return this.$http.get(this.providersApiUri).then(e=>e.data.Providers)}},{key:"getIdentityProviderParameters",value:function(e){return this.$http.get(Object(p.a)(this.parametersApiUri,e)).then(e=>e.data.Parameters)}},{key:"deleteApi",value:function(e){var t=this.loggingService.profileStart(s.a.myCustomApiDeleteStart),i={almMode:e&&e.properties&&e.properties.almMode?e.properties.almMode:a.a.NotSpecified};return this.apiClient.delete({id:e.id}).then(()=>{this.loggingService.profileEndWithSuccess(t,s.a.myCustomApiDeleteEnd,i)}).catch(e=>{this.loggingService.profileEnd(t,s.a.myCustomApiDeleteEnd,Object(n.y)(e),e,i)})}},{key:"downgradeOpenApiContract",value:function(e){var t;if(null==e||null===(t=e.openApiContract)||void 0===t||!t.trim()){var i=new l.a(n.c.customApiOpenApiImportFromPayloadMissingParameter,this.clientResources.Manage.CustomConnector.Import.InvalidOpenApiContract);return this.$q.reject(i)}return this.apiClient.downgradeOpenApiContract({},e).then(e=>{var t,i=null==e?void 0:e.data;return 200!==(null==e?void 0:e.status)||null==i||!i.apiContract||null!=i&&null!==(t=i.errors)&&void 0!==t&&t.length?this.$q.reject(e):(this.telemetryService.tagEvent(b.c.OpenApiContractDowngraded),i.apiContract)}).catch(t=>{var i,r,o,a=null==t?void 0:t.status,s=null==t?void 0:t.data;if(403===a||404===a)return this.$q.resolve(e.openApiContract);var c=null==s||null===(i=s.errors)||void 0===i?void 0:i.length,u=200===a&&!(null!=s&&s.apiContract);return c||u?(r=n.c.customApiOpenApiImportFromPayloadInvalidResponse,o=this.clientResources.Manage.CustomConnector.Import.InvalidOpenApiContract):(r=n.c.customApiOpenApiImportFromPayloadServerError,o=this.clientResources.Manage.CustomConnector.Import.FailureDowngradingOpenApiContract),this.$q.reject(new l.a(r,o,null,{responseStatusCode:a,responseData:s}))})}},{key:"getSwaggerFromUrl",value:function(e,t){var i={headers:{}};return t&&(i.headers[u.a]=u.a),this.$http.get(e,i).then(e=>{if(Object(c.a)(e)||Object(c.a)(e.data)||200!==e.status){var t=new l.a(n.c.customApiGetSwaggerFromUrl,this.clientResources.Manage.CustomApi.NoSwaggerData.Error,null,{responseStatusCode:null==e?void 0:e.status,responseData:null==e?void 0:e.data});return this.$q.reject(t)}return e.data})}},{key:"getPluginFromUrl",value:function(e,t){var i={headers:{}};return t&&(i.headers[u.a]=u.a),this.$http.get(e,i).then(e=>{if(Object(c.a)(e)||Object(c.a)(e.data)||200!==e.status){var t=new l.a(n.c.customApiGetSwaggerFromUrl,this.clientResources.Manage.CustomApi.NoSwaggerData.Error,null,{responseStatusCode:null==e?void 0:e.status,responseData:null==e?void 0:e.data});return this.$q.reject(t)}return e.data})}},{key:"convertSwaggerResponseToFile",value:function(e){var t="string"!=typeof e?JSON.stringify(e):e,i=new Blob([t]);return new File([i],"swagger.json")}},{key:"validationError",value:function(e,t,i){return new h.a(n.c.customApiValidationError,e,t,i)}},{key:"tryParseContractAsJson",value:function(e){var t,i;try{t=JSON.parse(e)}catch(r){t=null,i=r}return t?this.ensureSwaggerVersionCompliance(t,e):this.$q.reject(this.validationError(this.clientResources.Manage.CustomConnector.Import.FileNotJson,i))}},{key:"tryParseContractAsYaml",value:function(e){var t=this.$q.defer();return P.a(this.$document,this.$q,this.$timeout,this.$window).then(()=>{var i,r;try{i=this.$window.jsyaml.load(e)}catch(n){i=null,r=n}i?t.resolve(this.ensureSwaggerVersionCompliance(i,e)):t.reject(this.validationError(this.clientResources.Manage.CustomConnector.Import.FailureToParseTheYamlContract,r))}).catch(e=>{this.loggingService.logError("CustomApiHelperService.tryParseContractAsYaml",e),t.reject(new Error(this.clientResources.Manage.CustomConnector.Import.FailureToLoadJsYaml))}),t.promise}},{key:"ensureSwaggerVersionCompliance",value:function(e,t){return Object(g.I)(e)?this.$q.resolve(e):this.appSettings.featureFlags.enableOpenApiDowngrade?this.downgradeOpenApiContract({openApiContract:t}).then(e=>JSON.parse(e)):this.$q.reject(this.validationError(this.clientResources.Manage.CustomConnector.Import.VersionNotSupported))}},{key:"parseSwaggerFromString",value:function(e){return this.tryParseContractAsJson(e).catch(t=>this.appSettings.featureFlags.enableYamlImportInCustomConnectors?this.tryParseContractAsYaml(e).catch(e=>{if(e instanceof h.a)return this.$q.reject(e);var i=this.validationError(this.clientResources.Manage.CustomConnector.Import.OpenApiContractParsingFailed,e,{previousError:t});return this.loggingService.logError("CustomApiHelperService.parseSwaggerFromString",i),this.$q.reject(i)}):this.$q.reject(t))}},{key:"importPostmanCollection",value:function(e,t){var i,r=this.loggingService.profileStart(s.a.myCustomApiImportPostmanStart);if(Object(k.k)(e)>=1){var o=this.validationError(this.clientResources.Manage.CustomApi.General.MaxPostmanCollectionFileSizeExceeded);return this.loggingService.profileEnd(r,s.a.myCustomApiImportPostmanEnd,Object(n.y)(o),o),this.$q.reject(o)}return this.promiseHelperService.toAngularPromise(this.fileReader(e).asText()).then(e=>{var n,o;try{n=JSON.parse(e)}catch(u){return this.$q.reject(this.validationError(this.clientResources.Manage.CustomApi.General.FileNotInJsonFormat))}if(n.info&&n.info.schema&&(n.info.schema===m.b||n.info.schema===m.c)){var a=n;if(!(a&&a.item&&a.item.length>0))return this.$q.reject(this.validationError(this.clientResources.Manage.CustomApi.General.InvalidPostmanCollection));var l=n.info.schema===m.c?T.PostmanCollectionV2_1Schema:T.PostmanCollectionV2_0Schema;i={schema:l},o=new S.a(this.loggingService,{assignTestValues:this.appSettings.featureFlags.enableAdvancedTestApiMode},this.clientResources).convertToSwagger(e)}else{var c=n;if(!(c&&c.requests&&c.requests.length>0))return this.$q.reject(this.validationError(this.clientResources.Manage.CustomApi.General.InvalidPostmanCollection));i={schema:T.PostmanCollectionV1Schema},o=new C.a(this.loggingService,{assignTestValues:this.appSettings.featureFlags.enableAdvancedTestApiMode},this.clientResources).convertToSwagger(e)}return t("generatedApiDefinition.swagger.json",Object(f.a)(o)),this.loggingService.profileEndWithSuccess(r,s.a.myCustomApiImportPostmanEnd),this.$q.resolve(i)}).catch(e=>(this.loggingService.profileEnd(r,s.a.myCustomApiImportPostmanEnd,Object(n.y)(e),e),this.$q.reject(e)))}},{key:"importSwaggerUrl",value:function(e,t){var i=this.loggingService.profileStart(s.a.myCustomApiImportSwaggerUrlStart);if(!Object(v.b)(e)){var r=this.validationError(this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Error.notHttps);return this.loggingService.profileEnd(i,s.a.myCustomApiImportSwaggerUrlEnd,Object(n.y)(r),r),this.$q.reject(r)}return this.telemetryService.tagEvent(b.c.SwaggerUrlUploaded),this.getSwaggerFromUrl(e,!0).catch(()=>this.$q.reject(this.validationError(this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Error.downloadFailed))).then(e=>{var i=this.convertSwaggerResponseToFile(e);return this.importSwaggerFile(i,t)}).then(()=>{this.loggingService.profileEndWithSuccess(i,s.a.myCustomApiImportSwaggerUrlEnd)}).catch(e=>(this.loggingService.profileEnd(i,s.a.myCustomApiImportSwaggerUrlEnd,Object(n.y)(e),e),this.$q.reject(e)))}},{key:"importOpenAIPluginUrl",value:function(e,t){var i=this.loggingService.profileStart(s.a.myCustomApiImportPluginUrlStart);if(!Object(v.b)(e)){var r=this.validationError(this.clientResources.Manage.CustomApi.RightPane.ImportOpenAIPlugin.PluginUrl.Error.notHttps);return this.loggingService.profileEnd(i,s.a.myCustomApiImportPluginUrlEnd,Object(n.y)(r),r),this.$q.reject(r)}return this.telemetryService.tagEvent(b.c.PluginUrlUploaded),this.getPluginFromUrl(e,!0).catch(()=>this.$q.reject(this.validationError(this.clientResources.Manage.CustomApi.RightPane.ImportOpenAIPlugin.PluginUrl.Error.manfiestDownloadFailed))).then(e=>{var t="string"!=typeof e?JSON.stringify(e):e;return this.getSwaggerFromUrl(JSON.parse(t).api.url,!0)}).catch(()=>this.$q.reject(this.validationError(this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Error.downloadFailed))).then(e=>{var i=this.convertSwaggerResponseToFile(e);return this.importSwaggerFile(i,t)}).then(()=>{this.loggingService.profileEndWithSuccess(i,s.a.myCustomApiImportPluginUrlEnd)}).catch(e=>(this.loggingService.profileEnd(i,s.a.myCustomApiImportPluginUrlEnd,Object(n.y)(e),e),this.$q.reject(e)))}},{key:"getSwaggerFileContent",value:function(e){var t=this.promiseHelperService.toAngularPromise(this.fileReader(e).asText());return this.$q.resolve(t)}},{key:"importSwaggerFile",value:function(e,t){var i,r=this.loggingService.profileStart(s.a.myCustomApiImportSwaggerFileStart);if(Object(k.k)(e)>=1){var o=this.validationError(this.clientResources.Manage.CustomApi.General.MaxSwaggerFileSizeExceeded);return this.loggingService.profileEnd(r,s.a.myCustomApiImportSwaggerFileEnd,Object(n.y)(o),o),this.$q.reject(o)}return this.getSwaggerFileContent(e).then(e=>this.parseSwaggerFromString(e)).then(e=>(i=Object(f.a)(Object(w.a)({},g.a,e)),Object(g.I)(i)?this.$q.resolve(i):this.$q.reject(this.validationError(this.clientResources.Manage.CustomConnector.Import.VersionNotSupported)))).then(n=>(t(e.name,i),this.loggingService.profileEndWithSuccess(r,s.a.myCustomApiImportSwaggerFileEnd),this.$q.resolve(n))).catch(e=>(this.loggingService.profileEnd(r,s.a.myCustomApiImportSwaggerFileEnd,Object(n.y)(e),e),this.$q.reject(e)))}},{key:"importSwagger",value:function(e,t){var i="CustomApiHelperService.importSwagger";return this.widgetUtilService.isLogicApps()?(this.loggingService.logWarning(i,"Unable to validate swagger against schema since LogicApps cannot call PowerApps RP"),this.$q.resolve()):e?this.validateSwaggerAgainstSchema(e.uniqueId,t):(this.loggingService.logWarning(i,"Unable to validate swagger against schema since there is no userInfo to use for calling PowerApps RP"),this.$q.resolve())}},{key:"importSwaggerJson",value:function(e,t,i){var r=this.loggingService.profileStart(s.a.myCustomApiImportSwaggerJsonStart),o=this.sessionService.getUserInfo(),a=Object(f.a)(Object(w.a)({},g.a,e)),l=JSON.parse(Object(y.a)(a));return this.importSwagger(o,l).then(()=>{i(t,a),this.loggingService.profileEndWithSuccess(r,s.a.myCustomApiImportSwaggerJsonEnd)}).catch(e=>(this.loggingService.profileEnd(r,s.a.myCustomApiImportSwaggerJsonEnd,Object(n.y)(e),e),this.$q.reject(e)))}},{key:"validateSwaggerAgainstSchemaOnSave",value:function(e,t){return this.genericValidateSwaggerAgainstSchema(e,t,n.c.customApiAttemptingToSaveInvalidSwagger)}},{key:"validateWadl",value:function(e,t){return this.apiClient.validateApiSwaggerToWadl({objectId:e},t).then(()=>this.$q.resolve(null)).catch(e=>this.$q.resolve(e))}},{key:"getBlobFromUrl",value:function(e){var t=this.loggingService.profileStart(s.a.myCustomApiGetBlobStart);return this.$http.get(e,{responseType:"blob"}).then(e=>(this.loggingService.profileEndWithSuccess(t,s.a.myCustomApiGetBlobEnd),e.data)).catch(e=>(this.loggingService.profileEnd(t,s.a.myCustomApiGetBlobEnd,Object(n.y)(e),e),this.$q.reject(e)))}},{key:"getSwaggerIconData",value:function(e){return this.$http.get(e,{responseType:"blob"}).then(e=>e.data).catch(e=>this.$q.reject(new l.a(n.c.customApiGetSwaggerIcon,Object(o.o)(e,this.clientResources.Manage.CustomApi.NoSwaggerIcon.Error),e,{responseStatusCode:e&&e.status})))}},{key:"generateResourceStorage",value:function(e,t){var i={environment:{name:t,id:"/providers/environments/".concat(t)}};return this.apiClient.generateResourceStorage({objectId:e},i)}},{key:"uploadFilesToStorage",value:function(e,t){if(!t)return this.$q.reject(this.clientResources.Manage.CustomConnection.Error.noFilesForUpload);var i=Object.keys(t).map(e=>t[e]).map(t=>this.azureBlobUploaderService(e,t.file,t.sasUri,t.file.type).startUploadToAzureBlob());return this.$q.all(i).then(()=>t)}},{key:"getSupportedOpenApiFileTypes",value:function(){var e=[".json"];return this.appSettings.featureFlags.enableYamlImportInCustomConnectors&&e.push(".yaml"),e}}])&&x(t.prototype,i),r&&x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();R.$inject=[r.a.services.$document,r.a.services.$http,r.a.services.$q,r.a.services.$timeout,r.a.services.$window,r.a.services.apisClient,r.a.services.appSettings,r.a.services.azureBlobUploaderService,r.a.services.clientResources,r.a.services.fileReaderHelperService,r.a.services.logging,r.a.services.promiseHelperService,r.a.services.session,r.a.services.telemetry,r.a.services.widgetUtilService],d.a.service(r.a.services.customApiHelper,R)},33777:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return o}));var r="https://schema.getpostman.com/json/collection/v2.0.0/collection.json",n="https://schema.getpostman.com/json/collection/v2.1.0/collection.json",o="oauth2"},33778:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(12330);function n(e){e=e||{};for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return i.forEach(t=>{Object(r.a)(t)||Object.keys(t).map(i=>{e[i]=t[i]})}),e}},33779:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(33359),n=i(33780),o=i(33777),a=i(33781),s=i(33363),l=i(11891),c=i(20342),u=i(33357),d=i(33782),p=i.n(d),h=i(12330),m=i(33360),g=i(33374);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;f(this,e),this.loggingService=t,this.options=i,this.clientResources=r}var t,i,d;return t=e,(i=[{key:"convertToSwagger",value:function(e){var t;try{t=JSON.parse(e)}catch(i){this.loggingService.logError("PostmanCollectionConverter.convertToSwagger",i)}return p()({},u.a,this.generateFromPostman(t))}},{key:"generateFromPostman",value:function(e){var t,i,r,n={},o={},s=this.flattenPostmanItems(e);return null!=e&&e.item&&s.forEach(e=>{var t;0===Object.keys(o).length&&(o=this.createSecurityDefinitions(e));var i=a.g(e);if(i){var r=a.f(i);if(r){var s=this.createOperation(i);if(s){var l=n[r]||{},u=null===(t=i.request)||void 0===t||null===(t=t.method)||void 0===t?void 0:t.toLowerCase();u&&(c.c[u]&&Object(h.a)(l[u])&&(l[u]=s),n[r]=l)}}}}),{swagger:"2.0",info:{version:"1.0.0",title:null==e||null===(t=e.info)||void 0===t?void 0:t.name,description:(null==e||null===(i=e.info)||void 0===i?void 0:i.description)||(null==e||null===(r=e.info)||void 0===r?void 0:r.name)},host:this.getHost(s),schemes:a.e(e&&s.filter(e=>{var t;return null==e||null===(t=e.request)||void 0===t?void 0:t.url}).map(e=>a.h(e))),produces:["application/json"],paths:n,definitions:{},securityDefinitions:o}}},{key:"flattenPostmanItems",value:function(e){for(var t=e?e.item:[],i=[];t.length>0;){var r=t.shift();r.request?i.push(r):r.item&&r.item.reverse().forEach(e=>{t.unshift(e)})}return i}},{key:"createSecurityDefinitions",value:function(e){var t,i,r,o={};if(null!=e&&null!==(t=e.request)&&void 0!==t&&t.auth)r=e.request.auth.type,this.addSecurityDefinition(r,o);else if(null!=e&&null!==(i=e.request)&&void 0!==i&&i.header)for(var a of e.request.header)if(a.key===n.a){var s=a.value,l=s?s.trim().split(" "):void 0;l&&l.length>0&&(r=l[0],this.addSecurityDefinition(r,o))}return o}},{key:"addSecurityDefinition",value:function(e,t){l.a(e,n.c)?t[n.b]={type:"basic"}:(l.a(e,n.e)||l.a(e,o.a))&&(t[n.d]={type:"oauth2",authorizationUrl:"https://your.authorization.url/here",tokenUrl:"https://your.token.url/here",flow:"accessCode"})}},{key:"createOperation",value:function(e){if(e&&e.request)return{summary:e.name,description:e.request.description||e.name,operationId:Object(m.l)(e.name),parameters:this.createOperationParameters(e),responses:this.createResponses(e)}}},{key:"createOperationParameters",value:function(e){var t=[].concat(a.d(e,{assignTestValue:this.options.assignTestValues}),a.c(e,{assignTestValue:this.options.assignTestValues}),a.b(e,{assignTestValue:this.options.assignTestValues})),i=Object(u.B)(e.request.method)&&a.a(e,{assignTestValue:this.options.assignTestValues},this.clientResources);return i&&t.push(i),t}},{key:"createResponses",value:function(e){var t={};return!Object(h.a)(e.response)&&e.response.length>0?e.response.forEach(e=>{var i=e.code.toString();t[i]||(t[i]={description:i.toString(),schema:s.b(e.body,this.clientResources)})}):t[r.c]={description:r.c,schema:{}},t}},{key:"getHost",value:function(e){var t;if((null==e?void 0:e.length)>0&&null!==(t=e[0].request)&&void 0!==t&&t.url){var i=a.h(e[0]);return Object(g.e)(i).host}return""}}])&&v(t.prototype,i),d&&v(t,d),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33780:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"d",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return s}));var r="Authorization",n="BasicAuth",o="OAuth",a="basic",s="bearer"},33781:function(e,t,i){"use strict";i.d(t,"d",(function(){return m})),i.d(t,"c",(function(){return g})),i.d(t,"b",(function(){return f})),i.d(t,"a",(function(){return b})),i.d(t,"g",(function(){return y})),i.d(t,"f",(function(){return w})),i.d(t,"e",(function(){return S})),i.d(t,"h",(function(){return C}));var r=i(14751),n=i.n(r),o=i(20342),a=i(33359),s=i(33780),l=i(33374),c=i(18111),u=i.n(c),d=i(11891),p=i(12330),h=i(33363);function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object(l.e)(C(e)).parameters;return Object.keys(i).map(e=>{var r={name:e,default:i[e],in:o.e.query,type:o.f.string,required:!0};return t.assignTestValue&&v(r),r})}function g(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return"string"!=typeof(null==e||null===(t=e.request)||void 0===t?void 0:t.url)&&e.request.url.variable&&(r=e.request.url.variable.map(e=>{var t={name:e.key,default:e.value,in:o.e.path,type:o.f.string,required:!0};return i.assignTestValue&&v(t),t})),r}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],r=e.request.header;return(null==r?void 0:r.length)>0&&r.forEach(e=>{var r=e.key,n=e.value;if(!d.a(r,s.a)){var a={name:r,in:o.e.header,required:!0,type:o.f.string,default:n,description:r};t.assignTestValue&&v(a),i.push(a)}}),i}function v(e){e[a.i.TestValue]=e.default,delete e.default}function b(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=null;if(k(e)||"raw"!==e.request.body.mode){if((null==e||null===(t=e.request)||void 0===t||null===(t=t.body)||void 0===t||null===(t=t.urlencoded)||void 0===t?void 0:t.length)>0){var a=e.request.body.urlencoded,s=Object(h.b)(JSON.stringify(a),r,{assignDefaultValue:!i.assignTestValue,assignTestValue:i.assignTestValue});n={name:o.e.body,in:o.e.body,schema:s,required:!0}}}else{var l=Object(h.b)(e.request.body.raw,r,{assignDefaultValue:!i.assignTestValue,assignTestValue:i.assignTestValue});n={name:o.e.body,in:o.e.body,schema:l,required:!0}}return n}function y(e){var t,i=n()(e),r=function(e){var t;if(null!=e&&null!==(t=e.request)&&void 0!==t&&t.url){if("string"!=typeof e.request.url&&e.request.url.raw){var i=e.request.url.raw.trim();return(e.request.url.variable||[]).forEach(e=>{var t=P(e.key),r=x(e.key);i=i.replace(t,r)}),Object(l.e)(i)}if("string"==typeof e.request.url)return Object(l.e)(e.request.url.trim())}return}(i);return null!=i&&null!==(t=i.request)&&void 0!==t&&t.url&&"string"!=typeof i.request.url&&i.request.url.variable&&i.request.url.variable.forEach(e=>{var t=x(e.key),n=P(e.key);r.host.indexOf(t)>-1&&"string"!=typeof i.request.url&&(i.request.url.raw=i.request.url.raw.replace(n,e.value))}),i}function w(e){var t;if(null!=e&&null!==(t=e.request)&&void 0!==t&&t.url){if("string"!=typeof e.request.url){var i=Object(l.e)(e.request.url.raw).path;return(e.request.url.variable||[]).forEach(e=>{var t=P(e.key),r=function(e){return"{".concat(e,"}")}(e.key);i=i.replace(t,r)}),i}if("string"==typeof e.request.url)return Object(l.e)(e.request.url).path}}function S(e){var t=[];return(e||[]).forEach(e=>{var i=Object(l.e)(e.trim()).protocol;t.some(e=>e===i)||t.push(i)}),t}function C(e){var t;if(null!=e&&null!==(t=e.request)&&void 0!==t&&t.url){if("string"==typeof e.request.url)return e.request.url;if(e.request.url.raw)return e.request.url.raw}return""}function k(e){var t,i;if(null==e||null===(t=e.request)||void 0===t||!t.body||Object(p.a)(e.request.body.raw))return!0;try{i=JSON.parse(e.request.body.raw)}catch(r){return!1}return u()(i)}function P(e){return":".concat(e)}function x(e){return"".concat(e,"__placeholder")}},33783:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(33359),n=i(33780),o=i(33784),a=i(33363),s=i(11891),l=i(20342),c=i(33374),u=i(33360),d=i(33357),p=i(33782),h=i.n(p),m=i(12330);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;g(this,e),this.loggingService=t,this.options=i,this.clientResources=r}var t,i,p;return t=e,(i=[{key:"convertToSwagger",value:function(e){var t;try{t=JSON.parse(e)}catch(i){this.loggingService.logError("PostmanCollectionConverter.convertToSwagger",i)}return h()({},d.a,this.generateFromPostman(t))}},{key:"generateFromPostman",value:function(e){var t={},i={};return e&&e.requests&&e.requests.forEach(e=>{0===Object.keys(i).length&&(i=this.createSecurityDefinitions(e));var r=o.g(e);if(r){var n=o.f(r);if(n){var a=this.createOperation(r);if(a){var s=t[n]||{},c=r&&r.method&&r.method.toLowerCase();c&&(l.c[c]&&Object(m.a)(s[c])&&(s[c]=a),t[n]=s)}}}}),{swagger:"2.0",info:{version:"1.0.0",title:e&&e.name,description:e&&(e.description||e.name)},host:this.getHost(e),schemes:o.e(e&&e.requests.map(e=>e.url)),produces:["application/json"],paths:t,definitions:{},securityDefinitions:i}}},{key:"createOperation",value:function(e){if(e)return{summary:e.name,description:e.description||e.name,operationId:Object(u.l)(e.name),parameters:this.createOperationParameters(e),responses:this.createResponses(e)}}},{key:"createOperationParameters",value:function(e){var t=[].concat(o.d(e,{assignTestValue:this.options.assignTestValues}),o.c(e,{assignTestValue:this.options.assignTestValues}),o.b(e,{assignTestValue:this.options.assignTestValues})),i=Object(d.B)(e.method)&&o.a(e,this.clientResources,{assignTestValue:this.options.assignTestValues});return i&&t.push(i),t}},{key:"createSecurityDefinitions",value:function(e){var t={};return((e.headers||"").split("\n").filter(e=>e.trim().length>0)||[]).forEach(e=>{var i=o.h(e);if(i&&Object.keys(i)[0]===n.a){var r=i[n.a];if(!Object(m.a)(r)){var a=r.trim().split(" ");if(a&&0!==a.length){var l=a[0];s.a(l,n.c)?t[n.b]={type:"basic"}:s.a(l,n.e)&&(t[n.d]={type:"oauth2",authorizationUrl:"https://your.authorization.url/here",tokenUrl:"https://your.token.url/here",flow:"accessCode"})}}}}),t}},{key:"createResponses",value:function(e){var t={};return!Object(m.a)(e.responses)&&e.responses.length>0?e.responses.forEach(e=>{var i=e.responseCode.code.toString();t[i]||(t[i]={description:i.toString(),schema:a.b(e.text,this.clientResources)})}):t[r.c]={description:r.c,schema:{}},t}},{key:"getHost",value:function(e){if(e&&e.requests&&e.requests.length>0&&e.requests[0]&&e.requests[0].url){var t=e.requests[0].url;return Object(c.e)(t).host}return""}}])&&f(t.prototype,i),p&&f(t,p),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33784:function(e,t,i){"use strict";i.d(t,"d",(function(){return h})),i.d(t,"c",(function(){return m})),i.d(t,"b",(function(){return g})),i.d(t,"a",(function(){return v})),i.d(t,"g",(function(){return b})),i.d(t,"f",(function(){return y})),i.d(t,"h",(function(){return w})),i.d(t,"e",(function(){return S}));var r=i(14751),n=i.n(r),o=i(20342),a=i(33359),s=i(33363),l=i(33780),c=i(33374),u=i(18111),d=i.n(u),p=i(12330);function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object(c.e)(e.url).parameters;return Object.keys(i).map(e=>{var r={name:e,default:i[e],in:o.e.query,type:o.f.string,required:!0};return t.assignTestValue&&f(r),r})}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return Object(p.a)(e.pathVariables)?i:i=Object.keys(e.pathVariables).map(i=>{var r={name:i,default:e.pathVariables[i],in:o.e.path,type:o.f.string,required:!0};return t.assignTestValue&&f(r),r})}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],r=(e.headers||"").split("\n").filter(e=>e.trim().length>0);return r&&r.length>0&&r.forEach(e=>{var r=w(e);if(r){var n=Object.keys(r)[0],a=r[n];if(n!==l.a){var s={name:n,in:o.e.header,required:!0,type:"string",default:a,description:n};t.assignTestValue&&f(s),i.push(s)}}}),i}function f(e){e[a.i.TestValue]=e.default,delete e.default}function v(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null;if(C(e)){if(e.data&&0!==e.data.length){var n=e.data,a=s.b(JSON.stringify(n),t,{assignDefaultValue:!i.assignTestValue,assignTestValue:i.assignTestValue});r={name:o.e.body,in:o.e.body,schema:a,required:!0}}}else{var l=s.b(e.rawModeData,t,{assignDefaultValue:!i.assignTestValue,assignTestValue:i.assignTestValue});r={name:o.e.body,in:o.e.body,schema:l,required:!0}}return r}function b(e){var t=n()(e),i=function(e){if(!e||!e.url)return;var t=e.url.trim();Object(p.a)(e.pathVariables)||Object.keys(e.pathVariables).forEach(e=>{var i=k(e),r=P(e);t=t.replace(i,r)});return Object(c.e)(t)}(t);return t&&t.pathVariables&&Object.keys(t.pathVariables).forEach(e=>{var r=P(e),n=k(e);i.host.indexOf(r)>-1&&(t.url=t.url.replace(n,t.pathVariables[e]),delete t.pathVariables[e])}),t}function y(e){if(e){var t=Object(c.e)(e.url).path;return Object.keys(e.pathVariables||{}).forEach(e=>{var i=k(e),r=function(e){return"{".concat(e,"}")}(e);t=t.replace(i,r)}),t}}function w(e){if(!e)return null;var t=e.indexOf(":");return-1===t?null:{[e.substr(0,t)]:e.substr(t+1)}}function S(e){var t=[];return(e||[]).forEach(e=>{var i=Object(c.e)(e.trim()).protocol;t.some(e=>e===i)||t.push(i)}),t}function C(e){if(Object(p.a)(e.rawModeData))return!0;var t;try{t=JSON.parse(e.rawModeData)}catch(i){return!1}return d()(t)}function k(e){return":".concat(e)}function P(e){return"".concat(e,"__placeholder")}},33785:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(11893),n=i(33786);function o(e,t,i,o){if(o.jsyaml)return t.resolve();var a,s=t.defer(),l=e[0].createElement("script"),c=new URL(n.a(),window.location.origin).toString();return l.src=Object(r.b)(c,r.a.allowlistedStaticUrls),l.addEventListener("load",()=>{i.cancel(a),i(()=>s.resolve())},{once:!0}),l.addEventListener("error",()=>{i.cancel(a),s.reject(new Error("Error while loading JsYaml"))},{once:!0}),e[0].head.appendChild(l),a=i(()=>s.reject(new Error("Timeout while loading JsYaml")),3e4),s.promise}},33786:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=()=>i(33787)},33788:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33375),a=i(13240),s=i(33308),l=i(13009),c=i(33279),u=i.n(c),d=i(33347),p=i(14892),h=i(18959);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=function(){function e(t,i,r,n,o,a,s,l,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.$q=i,this.$http=r,this.oAuthService=n,this.authenticationService=o,this.telemetryService=a,this.connectionClient=s,this.resources=l,this.loggingService=c,this.environmentService=u}var t,i,r;return t=e,(i=[{key:"startConsent",value:function(e){var t=this.oAuthService.openLoginPopup();return t.connectionId=e,t}},{key:"finishConsent",value:function(e){var t={id:e.connectionId},i={redirectUrl:e.getRedirectUrl()};return this.connectionClient.getConsentLink(t,i).then(t=>(e.url=t.data.consentLink,e.loginPromise)).then(e=>{var i;return e.code&&(i=this.connectionClient.confirmConsentCode(t,{code:e.code})),i}).catch(e=>(this.loggingService.logError("ConnectionHelperService.FinishConsent",e),e&&e.code===l.c.connectionAuthenticationPopupClosed?this.$q.resolve():this.$q.reject(e)))}},{key:"addConnection",value:function(e,t,i){var r,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.environmentService.getCurrentEnvironmentName();return i=null!==(r=i)&&void 0!==r&&null!==(r=r.properties)&&void 0!==r&&r.connectionParametersSet?Object(o.b)(i,!0,a):Object(o.a)(i,!0,a),(this._canAutoCreateSimpleConnection(e)&&!n||i.properties.connectionParametersSet?this._addSimpleConnection(e,t,i):this._canAutoCreateFirstPartyConnection(e)&&!n?this._tryAddFirstPartyConnectionAutomatically(e,t,i).catch(()=>this._addConnectionByPopup(e,t,i)):this._addConnectionByPopup(e,t,i)).finally(()=>{this.refreshConnectionClient()})}},{key:"testConnection",value:function(e){var t=e.properties.testLinks&&e.properties.testLinks.length>0&&e.properties.testLinks[0];return e.id&&t&&t.requestUri&&Object(s.validateUrl)(t.requestUri)?this.authenticationService.getToken(this.appSettings.flowAudience).then(e=>this.$http({method:t.method,url:t.requestUri,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},responseType:"text"})).then(e=>{var t=e.data;if(t.status>=400){var i=t.message?t.message:this.resources.Error.TestConnectionFailed;throw new Error(i)}}).catch(t=>{throw this.loggingService.logError("ConnectionHelperService.testConnection",t),this._deleteConnection(e),t.data?t.data:t}):this.$q.resolve()}},{key:"refreshConnectionClient",value:function(){this.connectionClient.refreshQuery().catch(u.a.noop)}},{key:"_deleteConnection",value:function(e){this.connectionClient.delete({id:e.id}).then(()=>{this.connectionClient.refreshQuery(),this.telemetryService.tagEvent(a.c.DeleteConnectionFromList,{status:a.d.succeeded,connectionId:e.id})}).catch(e=>{this.loggingService.logError("ConnectionHelperService._deleteConnection",e),this.telemetryService.tagEvent(a.c.DeleteConnectionFromList,{status:a.d.failed})})}},{key:"_addSimpleConnection",value:function(e,t,i){return this.connectionClient.put({id:t},i).then(e=>(this.telemetryService.tagEvent(a.c.CreateSimpleConnectionComplete,{status:a.d.succeeded,connectionId:e&&e.data&&e.data.id}),e&&e.data)).catch(t=>(this.loggingService.logError("ConnectionHelperService._addSimpleConnection",t),this.telemetryService.tagEvent(a.c.CreateSimpleConnectionComplete,{status:a.d.failed,api:e}),this.$q.reject(t)))}},{key:"_tryAddFirstPartyConnectionAutomatically",value:function(e,t,i){var r;return this.connectionClient.put({id:t},i).then(e=>(r=e.data,this._getFirstPartyConnectionConsentUri(r.id))).then(e=>this.consentFirstPartyConnection(e)).then(()=>(this.telemetryService.tagEvent(a.c.CreateFirstPartyConnectionComplete,{status:a.d.succeeded,connectionId:r.id}),r)).catch(i=>{throw this.loggingService.logError("ConnectionHelperService._tryAddFirstPartyConnectionAutomatically",i),this.telemetryService.tagEvent(a.c.CreateFirstPartyConnectionComplete,{status:a.d.failed,api:e}),this.connectionClient.delete({id:t}).then(()=>{this.telemetryService.tagEvent(a.c.DeleteFirstPartyConnectionComplete,{status:a.d.succeeded,connectionId:r.id})}).catch(t=>{this.loggingService.logError("ConnectionHelperService._tryAddFirstPartyConnectionAutomatically",t),this.telemetryService.tagEvent(a.c.DeleteFirstPartyConnectionComplete,{status:a.d.failed,api:e})}),i})}},{key:"_addConnectionByPopup",value:function(e,t,i){var r,n;if(Object(d.y)(e)&&!Object(h.k)(i))try{r=this.startConsent(t)}catch(o){return this.$q.reject(new l.a(Object(l.cb)(o),Object(l.db)(o),o,{eventName:"ConnectionHelperService._addConnectionByPopup",api:e}))}return this.connectionClient.put({id:t},i).then(e=>{n=e.data,this.telemetryService.tagEvent(a.c.CreateConnectionByPopupCompleted,{status:a.d.succeeded,connectionId:n.id})}).catch(e=>(r&&r.close(),this.loggingService.logError("ConnectionHelperService._addConnectionByPopup",e),this.telemetryService.tagEvent(a.c.CreateConnectionByPopupCompleted,{status:a.d.failed}),this.$q.reject(e))).then(()=>{var e=[];if(r){var i=this.finishConsent(r).catch(e=>(this.loggingService.logError("ConnectionHelperService._addConnectionByPopup.Consent",e),r.close(),this.connectionClient.delete({id:t}),this.$q.reject(e)));e.push(i)}return this.$q.all(e)}).then(()=>n)}},{key:"_getFirstPartyConnectionConsentUri",value:function(e){return this.connectionClient.getConsentLink({id:e},{redirectUrl:window.location.origin}).then(t=>(this.telemetryService.tagEvent(a.c.GetFirstPartyConnectionConsentUriComplete,{status:a.d.succeeded,connectionId:e}),t.data.firstPartyLoginUri)).catch(t=>(this.loggingService.logError("ConnectionHelperService._getFirstPartyConnectionConsentUri",t),this.telemetryService.tagEvent(a.c.GetFirstPartyConnectionConsentUriComplete,{status:a.d.failed,connectionId:e}),this.$q.reject(t)))}},{key:"consentFirstPartyConnection",value:function(e){return this.authenticationService.getToken(this.appSettings.consentServerAadResourceUri).then(t=>this.$http({method:"POST",url:e,headers:{"Content-Type":"application/json"},data:{accessToken:"".concat(t)},responseType:"text"}).then(e=>(this.telemetryService.tagEvent(a.c.ConsentFirstPartyConnectionComplete,{status:a.d.succeeded}),e.ok=200===e.status,e),e=>(this.telemetryService.tagEvent(a.c.ConsentFirstPartyConnectionComplete,{status:a.d.failed},{error:e}),this.$q.reject(e))))}},{key:"_canAutoCreateFirstPartyConnection",value:function(e){return e&&!Object(p.c)(e)&&Object(p.f)(e)}},{key:"_canAutoCreateSimpleConnection",value:function(e){return e&&!Object(p.c)(e)&&Object(p.j)(e)}}])&&m(t.prototype,i),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();f.$inject=[n.a.services.appSettings,n.a.services.$q,n.a.services.$http,n.a.services.oAuthService,n.a.services.authentication,n.a.services.telemetry,n.a.services.connectionsClient,n.a.services.clientResources,n.a.services.logging,n.a.services.environment],r.a.service(n.a.services.connectionHelper,f)},33789:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33790),a=i(33374),s=i(13083);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u="addConnectorHideKey",d="removeConnectorHideKey",p="showHiddenConnectors",h=function(e){return e[e.Add=0]="Add",e[e.Remove=1]="Remove",e}(h||{}),m=function(){function e(t,i,r,n,o,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.loggingService=i,this.powerAppsUserSettingsClient=r,this.promiseHelperService=n,this.sessionService=o,this.storageService=a,this.widgetUtilService=s,this.updatingConnectorHideKeyDeferred=void 0,this.showHiddenConnectors=!1,this.updatingConnectorHideKeyDeferred=this.$q.defer();var l=this.getQueryParameters(),c=l[p];this.showHiddenConnectors=l.hasOwnProperty(u)||"true"===c||"false"!==c&&"true"===this.storageService.getItem(p);try{this.storageService.saveItem(p,String(this.showHiddenConnectors))}catch(m){console.log(m)}this.updateConnectorHideKey(l[u],h.Add).then(()=>this.updateConnectorHideKey(l[d],h.Remove)).finally(()=>this.updatingConnectorHideKeyDeferred.resolve())}var t,i,r;return t=e,(i=[{key:"getQueryParameters",value:function(){return Object(a.c)(window.location.href).parameters}},{key:"getVisibleHideKeys",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if((null===(e=this.widgetUtilService.widgetInfo)||void 0===e||null===(e=e.visibleHideKeys)||void 0===e?void 0:e.length)>0)return this.$q.resolve(this.widgetUtilService.widgetInfo.visibleHideKeys);var i=t?this.$q.resolve({}):this.updatingConnectorHideKeyDeferred.promise;return t||this.showHiddenConnectors?i.then(()=>this.isConsumerDomainAsync()).then(e=>e?null:this.getUserSettings()).then(e=>e&&e.data&&e.data.properties&&e.data.properties.settings&&Array.isArray(e.data.properties.settings.visibleHideKeys)?e.data.properties.settings.visibleHideKeys:[]).catch(e=>(this.loggingService.logWarning("ConnectorHideKeyService.getVisibleHideKeys",e),[])):this.$q.resolve([])}},{key:"updateConnectorHideKey",value:function(e,t){return Object(s.a)(e)?this.$q.resolve():this.getVisibleHideKeys(!0).then(i=>{if(t===h.Add&&-1===i.indexOf(e))i.push(e);else{if(!(t===h.Remove&&i.indexOf(e)>-1))return null;i.splice(i.indexOf(e),1)}return this.setVisibleHideKeys(i)}).catch(e=>{this.loggingService.logWarning("ConnectorHideKeyService.updateConnectorHideKey",e)})}},{key:"setVisibleHideKeys",value:function(e){return this.isConsumerDomainAsync().then(e=>e?null:this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync())).then(t=>t?this.powerAppsUserSettingsClient.updateUserSettings({objectId:t.userInfo.uniqueId,settingGroup:o.a.connectors},{visibleHideKeys:e}):null)}},{key:"getUserSettings",value:function(){return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(e=>this.powerAppsUserSettingsClient.getUserSettings({objectId:e.userInfo.uniqueId,settingGroup:o.a.connectors}))}},{key:"isConsumerDomainAsync",value:function(){return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>this.sessionService.isConsumerDomain)}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.factory(n.a.services.connectorHideKey,[n.a.services.$q,n.a.services.logging,n.a.services.powerAppsUserSettingsClient,n.a.services.promiseHelperService,n.a.services.session,n.a.services.storage,n.a.services.widgetUtilService,(e,t,i,r,n,o,a)=>new m(e,t,i,r,n,o,a)])},33790:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33328),n=i(33327),o=i(13144),a=i(33350),s={connectors:"connectors",policyTemplates:"policyTemplates"};r.a.factory(n.a.services.powerAppsUserSettingsClient,[n.a.services.appSettings,n.a.services.azureResourceClientFactory,(e,t)=>{var i=Object(a.a)(),r="".concat(e.powerAppsResourceProviderPath,"/objectIds/:objectId/userSettings/:settingGroup");return t({urlBase:Object(o.c)(e).powerAppsRP,urlPath:r,apiVersion:e.powerAppsResourceProviderApiVersionWithEnvironments,actions:[{name:"updateUserSettings",urlPath:r,method:"PUT",requestInterceptor:i},{name:"getUserSettings",urlPath:r,method:"GET",requestInterceptor:i}]})}])},33791:function(e,t,i){"use strict";i(33792),i(33928),i(33945)},33792:function(e,t,i){"use strict";i(33793),i(33798),i(33806),i(33809),i(33815),i(33820),i(33825),i(33829),i(33833),i(33836),i(33840),i(33406),i(33844),i(33849),i(33853),i(33344),i(33859),i(33867),i(33871),i(33876),i(33878),i(33882),i(33889),i(33893),i(33897),i(33900),i(33905),i(33913),i(33917),i(33920),i(33923),i(33925)},33793:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33794);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33796);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33797),this.controller=o.a,this.controllerAs="codeSwaggerEditorTabCtrl"}));n.a.component(r.a.components.customApi.codeTab,new c)},33794:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(33327),n=i(33360),o=i(17371),a=i(33795),s=i(17914),l=i(33398),c=i(19793),u=i(13009),d=i(33376);function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var m=[".csx",".cs"],g=function(){function e(t,i,r,o,c,u,p){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.fileReader=i,this.swaggerEditorDataService=r,this.codeEditorDataService=o,this.telemetryService=c,this.loggingService=u,this.widgetUtilService=p,this.operationsOptions=void 0,this.swaggerEditorData=void 0,this.operationsLabel="codeEditorTab-operations-dropdown",this.confirmDialogShow=!1,this.previousTab=void 0,this.nextTab=void 0,this.operationOnChange=(e,t)=>{var i=this.codeEditorDataService.CodeEditorData.scriptOperations.indexOf(t.key);t.selected&&-1===i?this.codeEditorDataService.CodeEditorData.scriptOperations.push(t.key):!t.selected&&i>-1&&this.codeEditorDataService.CodeEditorData.scriptOperations.splice(i,1)},this.editorOnChange=e=>{this.codeEditorDataService.CodeEditorData.sourceCode=e},this.deleteCode=()=>{Object(n.p)(this.codeEditorDataService.CodeEditorData.deployedSourceCode)?this.onDeleteCodeConfirmed():(this.codeEditorDataService.CodeEditorData.codeEnabled=!0,this.confirmDialogShow=!0)},this.onDeleteCodeConfirmed=()=>{this.codeEditorDataService.CodeEditorData.codeEnabled=!1,this.codeEditorDataService.CodeEditorData.sourceCode=a.a,this.codeEditorDataService.CodeEditorData.deployedSourceCode="",this.codeEditorDataService.CodeEditorData.scriptOperations=[],this.codeEditorDataService.CodeEditorData.deployedScriptOperations=[],this.codeEditorDataService.CodeEditorData.operationSelectedKeys=[]},this.onChangeCodeEditorUsageStatus=()=>{this.codeEditorDataService.CodeEditorData.codeEnabled=!this.codeEditorDataService.CodeEditorData.codeEnabled,this.codeEditorDataService.CodeEditorData.codeEnabled||this.deleteCode(),this.loggingService.logInfo("codeSwaggerEditorCtrl.onChangeCodeEditorUsageStatus","Toggling ".concat(this.codeEditorDataService.CodeEditorData.codeEnabled?"on":"off"," code editor"),{codeInUse:this.codeEditorDataService.CodeEditorData.codeEnabled})},this.onImportCodeFile=e=>{e&&(this.dismissValidationError(),this.telemetryService.tagEvent(l.a.CustomApiCodeUploaded),Object(n.k)(e)>=1?this.setValidationError(this.clientResources.Manage.CustomApi.Code.MaxCodeSizeExceeded):m.includes(".".concat(Object(n.i)(e.name)))?this.fileReader(e).asText().then(e=>{this.codeEditorDataService.CodeEditorData.sourceCode=e,this.codeEditorDataService.CodeEditorData.userUploadedCode=!0,this.codeEditorDataService.CodeEditorData.codeEnabled=!0}):this.setValidationError(this.clientResources.Manage.CustomApi.Code.InvalidCodeFileFormat))},this.telemetryService.tagEvent(l.a.CustomApiCodeTabVisited),this.previousTab=void 0,this.widgetUtilService.isLogicApps()||(Object(d.a)()?this.previousTab=s.c.copilot:this.previousTab=s.c.definition),this.nextTab=this.widgetUtilService.isLogicApps()?void 0:s.c.test,this.swaggerEditorData=this.swaggerEditorDataService.SwaggerEditorData,this.operationsOptions=this.buildOperationOptions()}var t,i,r;return t=e,(i=[{key:"acceptedExtensions",get:function(){var e=m.join(",");return"'".concat(e,"'")}},{key:"editorOptions",get:function(){return{language:"csharp",fontSize:11,lineNumbers:"on",theme:"vs",quickSuggestions:!0,acceptSuggestionOnEnter:"on",suggestOnTriggerCharacters:!0,wordBasedSuggestions:!0,acceptSuggestionOnCommitCharacter:!0,accessibilitySupport:"auto",readOnly:!this.codeEditorDataService.CodeEditorData.codeEnabled,snippetSuggestions:"inline",suggest:{filterGraceful:!0,snippetsPreventQuickSuggestions:!1},parameterHints:{enabled:!0,cycle:!0}}}},{key:"height",get:function(){return"40vh"}},{key:"buildOperationOptions",value:function(){var e=[],{actions:t,triggers:i}=this.swaggerEditorData.swagger;if(t.sort((e,t)=>e.operation.operationId.localeCompare(t.operation.operationId)),i.sort((e,t)=>e.operation.operationId.localeCompare(t.operation.operationId)),t&&0!==t.length)for(var r of(e.push({key:"Actions_Header",text:this.clientResources.Manage.CustomApi.RightPane.Code.Actions.Dropdown.Label,itemType:o.b.Header}),t))e.push({key:r.operation.operationId,text:r.operation.operationId,itemType:o.b.Normal,selected:this.codeEditorDataService.CodeEditorData.scriptOperations.includes(r.operation.operationId)});if(t&&0!==t.length&&i&&0!==i.length&&e.push({key:"Divider",text:"-",itemType:o.b.Divider}),i&&0!==i.length)for(var n of(e.push({key:"Triggers_Header",text:this.clientResources.Manage.CustomApi.RightPane.Code.Triggers.Dropdown.Label,itemType:o.b.Header}),i))e.push({key:n.operation.operationId,text:n.operation.operationId,itemType:o.b.Normal,selected:this.codeEditorDataService.CodeEditorData.scriptOperations.includes(n.operation.operationId)});return e}},{key:"dismissValidationError",value:function(){this.codeEditorDataService.CodeEditorData.validationError=null}},{key:"setValidationError",value:function(e){this.codeEditorDataService.CodeEditorData.validationError=new c.a(u.c.customApiValidationError,e)}}])&&p(t.prototype,i),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.$inject=[r.a.services.clientResources,r.a.services.fileReaderHelperService,r.a.services.swaggerEditorData,r.a.services.codeEditorData,r.a.services.telemetry,r.a.services.logging,r.a.services.widgetUtilService]},33795:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));var r='public class Script : ScriptBase\n{\n    public override async Task<HttpResponseMessage> ExecuteAsync()\n    {\n        HttpResponseMessage response = new HttpResponseMessage(HttpStatusCode.OK);\n        response.Content = CreateJsonContent("{\\"message\\": \\"Hello World\\"}");\n        return response;\n    }\n}\n';function n(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,i)=>e===t[i])}},33796:function(e,t,i){e.exports=i.p+"static/media/codeSwaggerEditorTab.f71c55c1.less"},33797:function(e,t){e.exports='<div class="codeSwaggerEditorTab">\n    \x3c!-- Code section --\x3e\n    <section class="row">\n        \x3c!-- Left pane --\x3e\n        <div class="column medium-3 left-pane codeSwaggerEditorTab-scrollbox" ng-class="{\'codeSwaggerEditorTab-scrollbox--shifted\': codeSwaggerEditorTabCtrl.swaggerEditorData.statusAlert.type}">\n            <div class="codeSwaggerEditorTab-scrollbox-content" >\n                <h1 class="title">{{::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.Code.Heading}}</h1>\n                <p class="codeSwaggerEditorTab-description">\n                    {{::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.Code.Description}}\n                    <learn-more\n                        resource="\'Manage.CustomApi.Code.LeftPane.Hyperlink\'"\n                        link-aria-label="::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Code.LeftPane.LearnMoreAriaLabel"\n                    ></learn-more>\n                </p>\n            </div>\n        </div>\n        \x3c!-- Right pane --\x3e\n        <div class="column medium-8 medium-offset-1 right-pane codeSwaggerEditorTab-scrollbox" ng-class="{\'codeSwaggerEditorTab-scrollbox--shifted\': codeSwaggerEditorTabCtrl.swaggerEditorData.statusAlert.type}">\n            <div class="codeSwaggerEditorTab-scrollbox-content" >\n                \x3c!-- Code Editor section --\x3e\n                <section class="codeSwaggerEditorTab-section">\n                    <p class="c-subheading-5">{{::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Code.Upload.Description}}</p>\n                    <div>\n                        <button class="icon-upload-label"\n                            ngf-select="codeSwaggerEditorTabCtrl.onImportCodeFile($file)"\n                            ngf-pattern="{{codeSwaggerEditorTabCtrl.acceptedExtensions}}"\n                            ngf-accept="{{codeSwaggerEditorTabCtrl.acceptedExtensions}}">\n                            <div>\n                                {{::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Code.Upload.Button.Label}}\n                            </div>\n                        </button>\n                    </div>\n                    <div class="pane-title pane-title--hasIconOrButton">\n                        <h2 class="pane-title-text--hasIconOrButton">\n                            {{::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Code.Heading}}\n                        </h2>\n                        <react-toggle\n                            on-change="codeSwaggerEditorTabCtrl.onChangeCodeEditorUsageStatus"\n                            checked="codeSwaggerEditorTabCtrl.codeEditorDataService.CodeEditorData.codeEnabled"\n                            off-text="::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Code.CodeDisabled"\n                            on-text="::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Code.CodeEnabled"\n                            >\n                        </react-toggle>\n                    </div>\n                    <div class="pane-content">\n                        \x3c!-- Operations --\x3e\n                        <div class="pane-field">\n\n                            <label id="codeSwaggerEditorTab.operationsLabel" class="pane-field-label">\n                                {{::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Code.Operation.Label}}\n                            </label>\n                            <label class="subtitle">\n                                {{::codeSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Code.Operation.Description}}\n                            </label>\n                            <react-dropdown multi-select="::true"\n                                is-disabled="!codeSwaggerEditorTabCtrl.codeEditorDataService.CodeEditorData.codeEnabled"\n                                options="::codeSwaggerEditorTabCtrl.operationsOptions"\n                                selected-keys="codeSwaggerEditorTabCtrl.codeEditorDataService.CodeEditorData.operationSelectedKeys"\n                                on-change="::codeSwaggerEditorTabCtrl.operationOnChange"\n                                labelled-by="::codeSwaggerEditorTab.operationsLabel">\n                            </react-dropdown>\n                        </div>\n                        <div class="pane-field">\n                            <react-monaco-editor\n                                logging-service="codeSwaggerEditorTabCtrl.loggingService"\n                                height="::codeSwaggerEditorTabCtrl.height"\n                                value="codeSwaggerEditorTabCtrl.codeEditorDataService.CodeEditorData.sourceCode"\n                                on-change="::codeSwaggerEditorTabCtrl.editorOnChange"\n                                options="codeSwaggerEditorTabCtrl.editorOptions">\n                            </react-monaco-editor>\n                        </div>\n                    </div>\n                </section>\n                \x3c!-- Tab navigation --\x3e\n                <custom-api-tab-navigation\n                    previous-tab="codeSwaggerEditorTabCtrl.previousTab"\n                    next-tab="codeSwaggerEditorTabCtrl.nextTab">\n                </custom-api-tab-navigation>\n            </div>\n        </div>\n    </section>\n    <confirm-dialog\n        title="{{::codeSwaggerEditorTabCtrl.clientResources.Dialogs.DeleteCustomApiCode.Title}}"\n        message="{{::codeSwaggerEditorTabCtrl.clientResources.Dialogs.DeleteCustomApiCode.Message}}"\n        show="codeSwaggerEditorTabCtrl.confirmDialogShow"\n        on-confirm="codeSwaggerEditorTabCtrl.onDeleteCodeConfirmed">\n    </confirm-dialog>\n</div>\n'},33798:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33799);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33805),this.controller=o.a,this.controllerAs="customApiActionCtrl"}));n.a.component(r.a.components.customApi.customApiAction,new c)},33799:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(13272),n=i(13240),o=i(17914),a=i(15523),s=i(33327),l=i(33359),c=i(33800),u=i(33801),d=i(33357),p=i(33802),h=i(20342),m=i(33803);function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,i,o,s,g,f,v,b,y,w){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$timeout=o,this.assetService=s,this.clientResources=g,this.customConnectorUrlService=f,this.navigationService=v,this.swaggerEditorDataService=b,this.swaggerValidationService=y,this.telemetryService=w,this.iconName=r.a,this.importRequestButtonId="customApiAction-importRequestButton-".concat(a.a),this.importRequestDayZeroButtonId="customApiAction-importRequestDayZeroButton-".concat(a.a),this.importResponseButtonId="customApiAction-importResponseButton-".concat(a.a),this.summaryInputId="customApiAction-summary-".concat(a.a),this.baseViolator=void 0,this.validationFilters={},this.actionIndex=void 0,this.verbs=Object.keys(h.c).map(e=>h.c[e]).map(e=>({method:e,displayName:e.toUpperCase()})),this.visibilityOptions=Object.keys(l.l).map(e=>({key:l.l[e],text:l.l[e]})),this.visibilityOptionsLabelLink=void 0,this.request=void 0,this.responses=void 0,this.operationVisibility=void 0,this.dropdownCommands=void 0,this.importPanel=void 0,this.onVisibilityChange=(e,t)=>{this.operationVisibility=t.key,this.visibilityChanged()},this.processRequest=()=>{var e=d.u(this.action.operation.parameters,this.swaggerEditorDataService.swagger);e.forEach(e=>{this.validationFilters[u.f(e)]||(this.validationFilters[u.f(e)]=new c.a(new c.i({itemPath:Object(p.g)(e,this.action.operation,this.baseViolator,this.swaggerEditorDataService.SwaggerEditorData)})))}),this.request.pathParameters=e.filter(e=>e.in&&e.in===h.e.path),this.request.queryParameters=e.filter(e=>e.in&&e.in===h.e.query),this.request.headerParameters=e.filter(e=>e.in&&e.in===h.e.header),this.request.bodyParameter=e.filter(e=>e.in&&e.in===h.e.body)[0]},this.processResponses=()=>{this.responses=[],this.action.operation&&Array.isArray(this.action.operation.responses)&&this.action.operation.responses.forEach(e=>{var t;if(d.G(e.item)){var i=e.item;t=d.l(this.swaggerEditorDataService.swagger,i.$ref)}else t=e.item;this.responses.push({name:e.name,responseWithResolvedReference:t}),this.validationFilters[e.name]||(this.validationFilters[e.name]=new c.a(new c.i({itemPath:Object(p.h)(e,this.action.operation,this.baseViolator,this.swaggerEditorDataService.SwaggerEditorData)})))})},this.navigateToReferenceParameter=(e,t)=>{var i=d.v(this.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl(e,i))},this.showRequestPane=()=>{this.$timeout(()=>{this.importPanel={elementIdsToFocusOnClose:[this.importRequestButtonId,this.importRequestDayZeroButtonId],item:this.action,itemType:m.a.OperationItem,panelType:m.c.Request,isVisible:!0,onUpdateSuccessful:this.processRequest}})},this.showResponsePane=()=>{this.$timeout(()=>{this.importPanel={elementIdsToFocusOnClose:[this.importResponseButtonId],item:this.action,itemType:m.a.OperationItem,panelType:m.c.Response,isVisible:!0,onUpdateSuccessful:this.processResponses}})},this.visibilityOptionsLabelLink={href:this.clientResources.Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.RightPane.Action.Visibility.LearnMoreAriaLabel,telemetryData:{name:"CustomApiAction.Visibility.LearnMoreClicked"}},this.telemetryService.tagEvent(n.c.CustomApiActionVisited),this.actionIndex=this.$routeParams.operationIndex,this.baseViolator=new c.i({itemPath:"".concat(c.d.Actions,"[").concat(this.actionIndex,"]")}),this.validationFilters={summary:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationSummary})),description:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationDescription})),operationId:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationId})),path:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.Path})),bodyParameter:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationParameters}))},this.dropdownCommands=this.getDropdownCommands(),this.resetActionData(),this.processRequest(),this.processResponses(),this.operationVisibility=this.action.operation[l.i.Visibility]||l.l.none,this.$scope.$watchGroup([()=>this.swaggerValidationService.resultCollection.results,()=>this.validationFilters],()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.$timeout(()=>{var e=document.getElementById(this.summaryInputId);e&&e.focus()})}var t,i,s;return t=e,(i=[{key:"action",get:function(){return this.swaggerEditorDataService.swagger.actions[this.actionIndex]}},{key:"actionRequestVerb",get:function(){return this.action.method&&this.action.method.toUpperCase()}},{key:"fullActionUrl",get:function(){return Object(d.k)(this.swaggerEditorDataService.swagger,this.action)}},{key:"resetActionData",value:function(){this.request={pathParameters:[],queryParameters:[],headerParameters:[],bodyParameter:null},this.responses=[]}},{key:"getDropdownCommands",value:function(){return[{text:this.clientResources.Manage.Apis.EditToolTip,click:e=>{this.telemetryService.tagEvent(n.c.CustomApiEditParameterClicked);var t=d.s(e,this.action.operation.parameters,this.swaggerEditorDataService.swagger),i=this.action.operation.parameters[t],r=d.L(i,this.swaggerEditorDataService.swagger);d.G(i)?this.navigateToReferenceParameter({name:r.name,source:l.g.parameters},r):this.navigateToInlineParameter(t,r)},iconName:r.a.Edit},{text:this.clientResources.Manage.Apis.DeleteToolTip,click:e=>{this.telemetryService.tagEvent(n.c.CustomApiDeleteParameterClicked);var t=d.u(this.action.operation.parameters,this.swaggerEditorDataService.swagger).indexOf(e);this.action.operation.parameters.splice(t,1),this.isPathParameter(this.request.pathParameters,e)&&this.removePathParameter(this.action,e),this.processRequest(),this.processResponses()},iconName:r.a.Delete}]}},{key:"isPathParameter",value:function(e,t){return d.u(e,this.swaggerEditorDataService.swagger).indexOf(t)>-1}},{key:"removePathParameter",value:function(e,t){var i=e.path.split("/"),r=i.indexOf("{"+t.name+"}");r>0&&(i.splice(r-1,2),e.path=i.join("/"))}},{key:"getIconUrlForParameter",value:function(e){return this.validationFilters[u.f(e)]?this.validationFilters[u.f(e)].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"getIconUrlForResponse",value:function(e){return this.validationFilters[e.name]?this.validationFilters[e.name].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"getIconTextForResponse",value:function(e){return this.validationFilters[e.name]?this.validationFilters[e.name].resultCollection.mostSevereResultTypeImageText(this.clientResources):""}},{key:"navigateToResponse",value:function(e){var t=this.action.operation.responses.map(e=>e.name).indexOf(e),i=this.action.operation.responses[t];if(d.G(i.item)){var r=d.l(this.swaggerEditorDataService.swagger,i.item.$ref);this.navigateToReferenceResponse({name:e,source:l.g.responses},r)}else this.navigationService.navigate(this.customConnectorUrlService.getInlineOperationUrl(this.actionIndex,o.a.actions,o.a.responses,t))}},{key:"navigateToReferenceResponse",value:function(e,t){var i=d.w(this.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl(e,i))}},{key:"navigateToInlineParameter",value:function(e,t){d.E(e,this.action)&&this.navigationService.navigate(this.customConnectorUrlService.getInlineOperationUrl(this.actionIndex,o.a.actions,o.a.parameters,e))}},{key:"visibilityChanged",value:function(){this.operationVisibility===l.l.none?delete this.action.operation[l.i.Visibility]:this.action.operation[l.i.Visibility]=this.operationVisibility}}])&&g(t.prototype,i),s&&g(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[s.a.services.$routeParams,s.a.services.$scope,s.a.services.$timeout,s.a.services.assetService,s.a.services.clientResources,s.a.services.customConnectorUrlService,s.a.services.navigation,s.a.services.swaggerEditorData,s.a.services.swaggerValidationService,s.a.services.telemetry]},33800:function(e,t,i){"use strict";i.d(t,"b",(function(){return f})),i.d(t,"d",(function(){return v})),i.d(t,"c",(function(){return b})),i.d(t,"e",(function(){return y})),i.d(t,"i",(function(){return w})),i.d(t,"g",(function(){return k})),i.d(t,"f",(function(){return P})),i.d(t,"h",(function(){return x})),i.d(t,"a",(function(){return A}));var r,n=i(33359),o=i(33353),a=i(14883),s=i(14876);function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=d(e);if(t){var n=d(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return u(this,i)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function h(e,t,i){return t&&p(e.prototype,t),i&&p(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=985,v=h((function e(){g(this,e)}));function b(e){return{Body:e.Validate.CustomApi.DisplayNames.Body,OperationID:e.Validate.CustomApi.DisplayNames.OperationId,Description:e.Validate.CustomApi.DisplayNames.Description,URL:e.Validate.CustomApi.DisplayNames.URL,Summary:e.Validate.CustomApi.DisplayNames.Summary,Title:e.Validate.CustomApi.DisplayNames.Title,Parameter:e.Validate.CustomApi.DisplayNames.Parameter,Response:e.Validate.CustomApi.DisplayNames.Response,BodyParameter:e.Validate.CustomApi.DisplayNames.BodyParameter,Name:e.Validate.CustomApi.DisplayNames.Name,Type:e.Validate.CustomApi.DisplayNames.Type,Path:e.Validate.CustomApi.DisplayNames.Path,Visibility:e.Validate.CustomApi.DisplayNames.Visibility,Default:e.Validate.CustomApi.DisplayNames.Default,Required:e.Validate.CustomApi.DisplayNames.Required,Definition:e.Validate.CustomApi.DisplayNames.Definition,ResponseDefinition:e.Validate.CustomApi.DisplayNames.ResponseDefinition,ParameterDefinition:e.Validate.CustomApi.DisplayNames.ParameterDefinition,TriggerConfiguration:e.Validate.CustomApi.DisplayNames.TriggerConfiguration,WebhookResponse:e.Validate.CustomApi.DisplayNames.WebhookResponse}}r=v,v.Description=".description",v.Item=".item",v.Schema=".schema",v.Summary=".summary",v.Name=".name",v.Type=".type",v.Path=".path",v.Title=".title",v.Default=".default",v.Required=".required",v.Actions=".actions",v.Triggers=".triggers",v.Parameters=".parameters",v.Definitions=".definitions",v.Responses=".responses",v.XMsSummary="[".concat(n.i.Summary,"]"),v.XMsVisibility="[".concat(n.i.Visibility,"]"),v.XMsNotificationContent="[".concat(n.i.NotificationContent,"]"),v.Operation=".operation",v.OperationId="".concat(r.Operation,".operationId"),v.OperationDescription="".concat(r.Operation).concat(r.Description),v.OperationParameters="".concat(r.Operation).concat(r.Parameters),v.OperationResponses="".concat(r.Operation).concat(r.Responses),v.OperationSummary="".concat(r.Operation).concat(r.Summary);var y=function(e){return e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Success=3]="Success",e[e.None=4]="None",e}({}),w=function(){function e(t,i){g(this,e),this.swaggerItem=t,this.schemaPropertyItem=i}return h(e,[{key:"fullSwaggerPath",get:function(){return this.swaggerItem?"".concat(this.swaggerItem.itemPath).concat(this.swaggerItem.propertyPath?this.swaggerItem.propertyPath:""):""}},{key:"schemaProperty",get:function(){return this.schemaPropertyItem?this.schemaPropertyItem.schemaProperty:null}},{key:"schemaPropertyKey",get:function(){return this.schemaProperty?this.schemaProperty.key:""}},{key:"schemaPropertySubPath",get:function(){return this.schemaPropertyItem&&this.schemaPropertyItem.subPath?this.schemaPropertyItem.subPath:""}},{key:"actionIndex",get:function(){return this.getPathIndex(v.Actions)}},{key:"triggerIndex",get:function(){return this.getPathIndex(v.Triggers)}},{key:"getPathIndex",value:function(e){var t=this.fullSwaggerPath.indexOf(e);if(t<0)return-1;var i=this.fullSwaggerPath.substr(t+e.length).indexOf("[")+t+e.length;if(i<0)return-1;var r=this.fullSwaggerPath.substr(i).indexOf("]")+i;return r<0?-1:Number(this.fullSwaggerPath.substr(i+1,r-i-1))}},{key:"getSwaggerPathDisplayName",value:function(e){return this.fullSwaggerPath===e.fullSwaggerPath?"":this.swaggerItem.propertyPath&&Object(a.c)(e.fullSwaggerPath,this.swaggerItem.itemPath)?this.swaggerItem.propertyDisplayName||this.generateDisplayNameFromPath(this.swaggerItem.propertyPath):this.swaggerItem.itemDisplayName||this.generateDisplayNameFromPath(this.swaggerItem.itemPath)}},{key:"getSchemaPropertyKeyDisplayName",value:function(e){return this.schemaProperty&&e.schemaPropertyKey!==this.schemaPropertyKey?this.schemaProperty.title||this.schemaProperty.name:""}},{key:"schemaPropertySubPathDisplayName",get:function(){return this.schemaPropertyItem&&this.schemaPropertyItem.subPathDisplayName?this.schemaPropertyItem.subPathDisplayName:this.generateDisplayNameFromPath(this.schemaPropertySubPath)}},{key:"generateDisplayNameFromPath",value:function(e){return e.split(".").map(e=>Object(a.a)(e)).join(" ").trim()}}]),e}();function S(e,t){return{[y.Error]:e.statusError,[y.Warning]:e.statusWarning,[y.Info]:e.statusInfo,[y.Success]:e.statusSuccess}[t]}function C(e,t){return{[y.Error]:e.Common.Error,[y.Warning]:e.Common.Warning,[y.Info]:e.Common.Information,[y.Success]:e.Common.Success}[t]}var k=function(){function e(t,i){g(this,e),this.type=t,this.message=i}return h(e,[{key:"resultTypeImage",value:function(e){return S(e,this.type)}},{key:"resultTypeImageText",value:function(e){return C(e,this.type)}}],[{key:"Error",value:function(t){return new e(y.Error,t)}},{key:"Warning",value:function(t){return new e(y.Warning,t)}}]),e}(),P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(i,e);var t=c(i);function i(e,r,n,o){var a;return g(this,i),(a=t.call(this,r,n)).ruleId=e,a.violator=o,a}return h(i)}(k),x=function(){function e(t){g(this,e),this.ResultTypeToAlertType={[y.Error]:o.a.Error,[y.Warning]:o.a.Warning,[y.Info]:o.a.Info,[y.Success]:o.a.Success,[y.None]:o.a.Success,null:o.a.None,undefined:o.a.None},this.results=[],this.results=Array.isArray(t)?t:[]}return h(e,[{key:"isEmpty",get:function(){return 0===this.results.length}},{key:"mostSevereResultType",get:function(){var e=y.None;return this.results.forEach(t=>{t.type<e&&(e=t.type),y.Error}),e}},{key:"mostSevereResultTypeImage",value:function(e){return S(e,this.mostSevereResultType)}},{key:"mostSevereResultTypeImageText",value:function(e){return C(e,this.mostSevereResultType)}},{key:"mostSevereAlertType",get:function(){return this.ResultTypeToAlertType[this.mostSevereResultType]}},{key:"errorCount",get:function(){return this.results.filter(e=>e.type===y.Error).length}},{key:"warningCount",get:function(){return this.results.filter(e=>e.type===y.Warning).length}},{key:"clear",value:function(){this.results=[]}},{key:"add",value:function(t){t&&(Array.isArray(t)?Array.isArray(t[0])?this.results=[].concat.apply(this.results,t):this.results=this.results.concat(t):t instanceof e&&Array.isArray(t.results)?this.results=this.results.concat(t.results):t instanceof k&&this.results.push(t))}},{key:"filter",value:function(t){return new e(this.results.filter(e=>t(e)))}},{key:"filterOnViolator",value:function(t){return t?new e(this.results.filter(e=>e instanceof P&&e.violator&&Object(a.i)(e.violator.fullSwaggerPath,t.fullSwaggerPath)&&(Object(s.a)(t.schemaPropertyKey)||e.violator.schemaPropertyKey===t.schemaPropertyKey)&&(Object(s.a)(t.schemaPropertySubPath)||e.violator.schemaPropertySubPath===t.schemaPropertySubPath))):this}}],[{key:"Error",value:function(t){return new e([k.Error(t)])}},{key:"Warning",value:function(t){return new e([k.Warning(t)])}}]),e}(),A=function(){function e(t){g(this,e),this.filter=t,this.resultCollection=new x}return h(e,[{key:"updateFilteredResults",value:function(e){this.resultCollection=e.filterOnViolator(this.filter)}}]),e}()},33801:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return l})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return d})),i.d(t,"f",(function(){return p}));var r=i(20342),n=i(33360),o=i(33363);function a(e,t,i,a){var l=function(e){if(Object(n.n)(e)||"/"===e)return[];return c(e).map(e=>({name:e,in:"path",required:!0,type:"string"}))}(e.path).concat(function(e){if(Object(n.n)(e))return[];return Object.keys(e).map(t=>({name:t,in:"query",required:!1,type:u(e[t])}))}(e.parameters)).concat(function(e){if(Object(n.n)(e))return[];var t=s(e);return Object.keys(t).map(e=>({name:e,in:"header",required:!1,type:t[e]}))}(t)),d=function(e,t){if(Object(n.n)(e))return{};return{name:r.e.body,in:"body",required:!1,schema:o.b(e,t)}}(i,a);return Object(n.n)(d)||l.push(d),l}function s(e){var t=e.replace(new RegExp("/\n/\r","g"),"\n").split("\n"),i={};return t.forEach(e=>{if(!Object(n.n)(e.trim())){var t=e.trim().split(" "),r=t[0].replace(/:$/,""),o="";t.length>=2&&(o=t.splice(1).join(" ")),i[r]=u(o)}}),i}function l(e){if(e){var t=s(e),i={};return Object.keys(t).map(e=>{i[e]={description:e,type:t[e]}}),Object(n.n)(i)?void 0:i}}function c(e){for(var t=[],i=/\{(.*?)\}/g,r=i.exec(e);null!==r;)Object(n.n)(r[1])||t.push(r[1]),r=i.exec(e);return t}function u(e){var t="string";if(Object(n.n)(e))return t;(e=e.trim(),isNaN(Number(e)))?"true"===e||"false"===e?t="boolean":e.length>=1&&"["===e[0]&&"]"===e[e.length-1]&&(t="array"):t=Number(e)%1==0?"integer":"number";return t}function d(e,t){return Object(n.n)(e)||Object(n.n)(e.trim())?e:(e=e.trim(),"boolean"===t?"true"===e.toLowerCase():"number"===t||"integer"===t?Number(e):"array"===t&&e.length>1?e.substr(1,e.length-2).split(","):e)}function p(e){return"".concat(e.name).concat(e.in)}},33802:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"b",(function(){return d})),i.d(t,"d",(function(){return h})),i.d(t,"f",(function(){return m})),i.d(t,"i",(function(){return g})),i.d(t,"e",(function(){return f})),i.d(t,"g",(function(){return v})),i.d(t,"h",(function(){return b}));var r=i(33800),n=i(20342),o=i(33357),a=i(33359),s=i(13031),l=i(12330);function c(e,t,i){return p(e,r.e.Error,t,i)}function u(e,t,i){return p(e,r.e.Warning,t,i)}function d(e,t,i){return p(e,r.e.Info,t,i)}function p(e,t,i,n){return new r.f(e.ruleId,t,i,n)}function h(e){return e&&e.operation?e.operation.operationId:""}function m(e,t,i){if(!e)return"";var l=e;if(o.G(e)&&(l=o.L(e,t)),l.in===n.e.body)return r.c(i).BodyParameter;var c=l[a.i.Summary]||l.name;return Object(s.a)(r.c(i).Parameter,l.in,c)}function g(e,t){return Object(s.a)(r.c(t).Response,e.name)}function f(e,t,i){var n=new r.h,a=[];return e.operation&&Array.isArray(e.operation.parameters)&&e.operation.parameters.forEach(e=>{o.G(e)&&a.push(function(e,t){if(Object(l.a)(t))return null;var i=t.split("/");if(i&&i.length>2&&"#"===i[0]){var n=i[2];if("parameters"===i[1]){var o=e.parameters.map(e=>e.name).indexOf(n);return o<0?null:new r.i({itemPath:"".concat(r.d.Parameters,"[").concat(o,"]").concat(r.d.Item)})}if("definitions"===i[1]){var a=e.definitions.map(e=>e.name).indexOf(n);return a<0?null:new r.i({itemPath:"".concat(r.d.Definitions,"[").concat(a,"]").concat(r.d.Item)})}}return null}(t,e.$ref))}),a.forEach(e=>{e&&n.add(i.filterOnViolator(e))}),n}function v(e,t,i,n){var s=o.s(e,t.parameters,n.swagger),l=t.parameters[s];if(o.G(l)){var c=o.L(l,n.swagger),u=o.v(n,{name:c.name,source:a.g.parameters},c);return"".concat(r.d.Parameters,"[").concat(u,"]")}return"".concat(i.fullSwaggerPath).concat(r.d.OperationParameters,"[").concat(s,"]")}function b(e,t,i,n){var s=t.responses.map(e=>e.name).indexOf(e.name),l=t.responses[s];if(o.G(l.item)){var c=o.l(n.swagger,l.item.$ref),u=o.w(n,{name:name,source:a.g.responses},c);return"".concat(r.d.Responses,"[").concat(u,"]")}return"".concat(i.fullSwaggerPath).concat(r.d.OperationResponses,"[").concat(s,"]")}},33803:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"c",(function(){return y})),i.d(t,"b",(function(){return w}));var r=i(33394),n=i(33355),o=i(33398),a=i(33327),s=i(33360),l=i(33374),c=i(33359),u=i(33804),d=i(33801),p=i(33363),h=i(33800),m=i(11891),g=i(33392);function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(e){return e[e.OperationItem=0]="OperationItem",e[e.Response=1]="Response",e}({}),y=function(e){return e[e.Request=0]="Request",e[e.Response=1]="Response",e[e.WebhookResponse=2]="WebhookResponse",e}({});var w=function(){function e(t,i,a,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$timeout=t,this.clientResources=i,this.loggingService=a,this.swaggerEditorDataService=l,this.telemetryService=c,this.contentMaxLength=1048576,this.verbChoiceGroupOptions=Object.keys(u.b).map(e=>{var t=u.b[e];return{key:t,text:t.toUpperCase()}}),this.model=void 0,this.importSample={},this.selectedVerbKey=void 0,this.$onInit=()=>{this.model||(this.model={})},this.handleImportClicked=()=>{switch(this.model.panelType){case y.Request:this.telemetryService.tagEvent(o.a.CustomApiImportFromSampleRequestClicked),this.updateOperationRequest();break;case y.Response:this.telemetryService.tagEvent(o.a.CustomApiImportFromSampleResponseClicked),this.model.itemType===b.OperationItem?this.updateOperationResponse():this.model.itemType===b.Response&&this.updateResponse();break;case y.WebhookResponse:this.telemetryService.tagEvent(o.a.CustomApiImportFromSampleWebhookResponseClicked),this.updateWebhookResponse();break;default:this.loggingService.logError("ImportFromSamplePanel.HandleImportClicked",new r.a(n.a.switchCaseUnhandled,"Switch case does not handle this panelType",null,{panelType:this.model.panelType}))}this.model.onUpdateSuccessful(),this.closePane()},this.closePane=()=>{this.model.isVisible=!1,this.onClose()},this.getErrorMessageForUrl=e=>{var t=h.b;return e&&e.length>t?Object(s.d)(this.clientResources.Common.ExceedsMaxLength,e.length,t):""},this.getErrorMessageForHeaders=e=>e&&e.length>this.contentMaxLength?Object(s.d)(this.clientResources.Common.ExceedsMaxLength,e.length,this.contentMaxLength):"",this.getErrorMessageForBody=e=>{if(!e)return"";if(e.length>this.contentMaxLength)return Object(s.d)(this.clientResources.Common.ExceedsMaxLength,e.length,this.contentMaxLength);try{if(!Object(p.b)(e,this.clientResources,{returnUndefinedOnError:!0}))return this.clientResources.Manage.CustomApi.BodyInvalidJson}catch(t){return Object(g.e)(t)}return""},this.onVerbChoiceChanged=(e,t)=>{this.selectedVerbKey=t.key,this.importSample.verb=t.key},this.onUrlChange=(e,t)=>{this.importSample.url=t},this.onHeadersChange=(e,t)=>{this.importSample.headers=t},this.onBodyChange=(e,t)=>{this.importSample.body=t},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ImportFromSamplePanelCtrl"})}var t,i,a;return t=e,(i=[{key:"isRequestPane",get:function(){return this.model.panelType===y.Request}},{key:"isUrlValid",get:function(){return this.importSample.url&&!this.getErrorMessageForUrl(this.importSample.url)}},{key:"areHeadersValid",get:function(){return!this.getErrorMessageForHeaders(this.importSample.headers)}},{key:"isBodyValidJson",get:function(){return!this.getErrorMessageForBody(this.importSample.body)}},{key:"isImportButtonDisabled",get:function(){switch(this.model.panelType){case y.Request:return!this.isUrlValid||!this.importSample.verb||this.bodyAllowed&&!this.isBodyValidJson||!this.areHeadersValid;case y.Response:case y.WebhookResponse:default:return!this.isBodyValidJson||!this.areHeadersValid}}},{key:"headerDescription",get:function(){switch(this.model.panelType){case y.Request:return this.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description;case y.Response:case y.WebhookResponse:default:return this.clientResources.Manage.CustomApi.RightPane.Response.Headers.Description}}},{key:"bodyDescription",get:function(){switch(this.model.panelType){case y.Request:return this.clientResources.Manage.CustomApi.RightPane.Request.Body.Description;case y.Response:case y.WebhookResponse:default:return this.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}},{key:"bodyAllowed",get:function(){return!(this.isRequestPane&&(e=this.importSample.verb,!e||Object(m.a)(e,u.b.get)||Object(m.a)(e,u.b.head)||Object(m.a)(e,u.b.options)));var e}},{key:"onClose",value:function(){this.importSample.url="",this.importSample.headers="",this.importSample.body=""}},{key:"updateOperationRequest",value:function(){var e=this.model.item;e.method=this.importSample.verb;var t=decodeURI((this.importSample.url||"").trim()),i=Object(l.d)(t),r=i.path,n=this.swaggerEditorDataService.swagger.basePath;n&&0===r.indexOf(n)&&(r=r.substr(n.length)),e.path=0===r.indexOf("/")?r:"/".concat(r),e.operation.parameters=Object(d.b)(i,this.importSample.headers,this.bodyAllowed?this.importSample.body:void 0,this.clientResources),this.telemetryService.tagEvent(o.a.CustomApiUpdateOperationRequest,{method:e.method,queryParameterCount:this.getParameterTypeCount(e.operation.parameters,"query"),pathParamterCount:this.getParameterTypeCount(e.operation.parameters,"path"),headerParameterCount:this.getParameterTypeCount(e.operation.parameters,"header"),bodyParameterCount:this.getParameterTypeCount(e.operation.parameters,"body")})}},{key:"getParameterTypeCount",value:function(e,t){return(e||[]).filter(e=>e&&e.in===t).length}},{key:"updateOperationResponse",value:function(){var e=this.model.item,t={description:c.c,schema:Object(p.b)(this.importSample.body,this.clientResources),headers:Object(d.a)(this.importSample.headers)},i=e.operation.responses.filter(e=>e.name===c.c)[0];i?i.item=t:e.operation.responses.push({name:c.c,item:t}),this.telemetryService.tagEvent(o.a.CustomApiUpdateOperationResponse,{responseHasHeaders:!!t.headers})}},{key:"updateResponse",value:function(){var e=this.model.item;e.schema=Object(p.b)(this.importSample.body,this.clientResources);var t=Object(d.a)(this.importSample.headers);t?e.headers=t:delete e.headers,this.telemetryService.tagEvent(o.a.CustomApiUpdateResponse,{responseHasHeaders:!!e.headers})}},{key:"updateWebhookResponse",value:function(){var e=this.model.item[c.i.NotificationContent];e.schema=Object(p.b)(this.importSample.body,this.clientResources),e.headers=Object(d.a)(this.importSample.headers),this.telemetryService.tagEvent(o.a.CustomApiUpdateWebhookResponse,{responseHasHeaders:!!e.headers})}}])&&f(t.prototype,i),a&&f(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();w.$inject=[a.a.services.$timeout,a.a.services.clientResources,a.a.services.logging,a.a.services.swaggerEditorData,a.a.services.telemetry]},33804:function(e,t,i){"use strict";var r=i(20342);i.d(t,"a",(function(){return r.b})),i.d(t,"b",(function(){return r.c})),i.d(t,"c",(function(){return r.e})),i.d(t,"d",(function(){return r.f}))},33805:function(e,t){e.exports='<div class="subsection-manage customApiAction">\n    \x3c!-- General section --\x3e\n    <section>\n        <h2 class="pane-title">\n            {{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Heading}}\n        </h2>\n        <div class="pane-content">\n            \x3c!-- Summary --\x3e\n            <div class="pane-field">\n                <validated-input\n                    input-id="::customApiActionCtrl.summaryInputId"\n                    input-model="customApiActionCtrl.action.operation.summary"\n                    label="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Summary.Label"\n                    validation-result-collection="customApiActionCtrl.validationFilters.summary.resultCollection"\n                    learn-more-resource="\'Manage.CustomApi.Definition.RightPane.Summary.Hyperlink\'"\n                    learn-more-link-aria-label="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Action.Summary.LearnMoreAriaLabel" >\n                </validated-input>\n            </div>\n            \x3c!-- Description --\x3e\n            <div class="pane-field">\n                <validated-input\n                    input-model="customApiActionCtrl.action.operation.description"\n                    label="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Description.Label"\n                    validation-result-collection="customApiActionCtrl.validationFilters.description.resultCollection"\n                    learn-more-resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"\n                    learn-more-link-aria-label="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Action.Description.LearnMoreAriaLabel" >\n                </validated-input>\n            </div>\n            \x3c!-- Operation id --\x3e\n            <div class="pane-field">\n                <validated-input\n                    input-model="customApiActionCtrl.action.operation.operationId"\n                    label="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Label"\n                    description="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Subtitle"\n                    validation-result-collection="customApiActionCtrl.validationFilters.operationId.resultCollection"\n                    is-required="true" >\n                </validated-input>\n            </div>\n            \x3c!-- Visibility --\x3e\n            <div class="pane-field">\n                <react-choice-group-with-link\n                    options="::customApiActionCtrl.visibilityOptions"\n                    label="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Visibility.Label"\n                    label-link="::customApiActionCtrl.visibilityOptionsLabelLink"\n                    direction="\'horizontal\'"\n                    selected-key="customApiActionCtrl.operationVisibility"\n                    on-change="::customApiActionCtrl.onVisibilityChange"\n                ></react-choice-group-with-link>\n            </div>\n        </div>\n    </section>\n    \x3c!-- Request --\x3e\n    <section class="customApiAction-section">\n        <h3 class="c-heading-5">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</h3>\n        <p class="c-subheading-5">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Request.Description}}</p>\n        <div class="customApiAction-pane" ng-if="customApiActionCtrl.action.path">\n            <div class="pane-title pane-title--hasIconOrButton">\n                <h4 class="pane-title-text--hasIconOrButton">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</h4>\n                <react-default-button\n                    id="{{::customApiActionCtrl.importRequestButtonId}}"\n                    class-name="\'pane-title-button\'"\n                    primary="true"\n                    icon-name="customApiActionCtrl.iconName.Add"\n                    on-click="customApiActionCtrl.showRequestPane"\n                    text="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label"\n                ></react-default-button>\n            </div>\n            <div class="pane-content">\n                \x3c!-- Verbs --\x3e\n                <div class="pane-field">\n                    <legend class="pane-field-label">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading}} <span class="context-required-text">*</span></legend>\n                    <label class="subtitle">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Description}}</label>\n                    <span class="customApiAction-pane-field-value">{{customApiActionCtrl.actionRequestVerb}}</span>\n                </div>\n                \x3c!-- URL --\x3e\n                <div class="pane-field">\n                    <validated-input\n                        input-model="customApiActionCtrl.fullActionUrl"\n                        label="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading"\n                        validation-result-collection="customApiActionCtrl.validationFilters.path.resultCollection"\n                        is-read-only="true"\n                        is-required="true"\n                        description="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Description" >\n                    </validated-input>\n                </div>\n                \x3c!-- Path parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Heading}}</label>\n                    <label class="subtitle">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="pathParameter in customApiActionCtrl.request.pathParameters track by pathParameter.name"\n                            commands="customApiActionCtrl.dropdownCommands"\n                            token="pathParameter"\n                            required="pathParameter.required"\n                            text="pathParameter.name"\n                            icon-url="customApiActionCtrl.getIconUrlForParameter(pathParameter)" ></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Query parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Heading}}</label>\n                    <label class="subtitle">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="queryParameter in customApiActionCtrl.request.queryParameters track by queryParameter.name"\n                            commands="customApiActionCtrl.dropdownCommands"\n                            token="queryParameter"\n                            required="queryParameter.required"\n                            text="queryParameter.name"\n                            icon-url="customApiActionCtrl.getIconUrlForParameter(queryParameter)" ></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Header parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label>\n                    <label class="subtitle">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="headerParameter in customApiActionCtrl.request.headerParameters track by headerParameter.name"\n                            commands="customApiActionCtrl.dropdownCommands"\n                            token="headerParameter"\n                            required="headerParameter.required"\n                            text="headerParameter.name"\n                            icon-url="customApiActionCtrl.getIconUrlForParameter(headerParameter)" ></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Body parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label>\n                    <label class="subtitle">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-if="customApiActionCtrl.request.bodyParameter"\n                            commands="customApiActionCtrl.dropdownCommands"\n                            token="customApiActionCtrl.request.bodyParameter"\n                            required="customApiActionCtrl.request.bodyParameter.required"\n                            text="customApiActionCtrl.request.bodyParameter.name"\n                            icon-url="customApiActionCtrl.validationFilters.bodyParameter.resultCollection.mostSevereResultTypeImage" ></react-token-block>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="customApiAction-section-buttons" ng-if="!customApiActionCtrl.action.path">\n            <react-action-button\n                id="{{::customApiActionCtrl.importRequestDayZeroButtonId}}"\n                icon-name="customApiActionCtrl.iconName.Add"\n                on-click="customApiActionCtrl.showRequestPane"\n                text="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label">\n            </react-action-button>\n        </div>\n    </section>\n    \x3c!-- Response --\x3e\n    <section class="customApiAction-section">\n        <h3 class="c-heading-5">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Heading}}</h3>\n        <p class="c-subheading-5">{{::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Description}}</p>\n        <div class="pane-content response-item" ng-repeat="response in customApiActionCtrl.responses" ng-click="customApiActionCtrl.navigateToResponse(response.name)">\n            <span class="status-code" title="{{response.name}}">{{response.name}}</span>\n            <span class="display-name" title="{{response.responseWithResolvedReference.description}}">{{response.responseWithResolvedReference.description}}</span>\n            <img ng-src="{{customApiActionCtrl.getIconUrlForResponse(response)}}" alt="{{customApiActionCtrl.getIconTextForResponse(response)}}"/>\n        </div>\n        <div class="customApiAction-section-buttons">\n            <react-action-button\n                id="{{::customApiActionCtrl.importResponseButtonId}}"\n                icon-name="customApiActionCtrl.iconName.Add"\n                on-click="customApiActionCtrl.showResponsePane"\n                text="::customApiActionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.AddResponse.Label">\n            </react-action-button>\n        </div>\n    </section>\n    \x3c!-- Validation --\x3e\n    <section class="customApiAction-section">\n        <validation-results\n            heading-above-pane="::customApiActionCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading"\n            sub-heading-above-pane="::customApiActionCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Action"\n            base-violator="customApiActionCtrl.baseViolator"\n            include-referenced-results="true">\n        </validation-results>\n    </section>\n\n    <import-from-sample-panel model="customApiActionCtrl.importPanel"></import-from-sample-panel>\n</div>\n'},33806:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33807);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33808),this.controller=o.a,this.controllerAs="customApiTabNavigationCtrl",this.bindings={previousTab:"<?",nextTab:"<?"}}));n.a.component(r.a.components.customApi.customApiTabNavigation,new c)},33807:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(13272),o=i(13009),a=i(13240),s=i(17914);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.customConnectorUrlService=i,this.loggingService=r,this.iconName=n.a,this.previousTab=void 0,this.nextTab=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"CustomApiTabNavigationCtrl"})}var t,i,r;return t=e,(i=[{key:"previousTabTelemetryData",get:function(){return{name:a.c[a.c.CustomApiPreviousTabNavigationButtonClicked],tab:this.previousTab,url:this.previousTabUrl}}},{key:"nextTabTelemetryData",get:function(){return{name:a.c[a.c.CustomApiNextTabNavigationButtonClicked],tab:this.nextTab,url:this.nextTabUrl}}},{key:"previousTabUrl",get:function(){return this.customConnectorUrlService.getCustomApiTabUrl(this.previousTab)}},{key:"nextTabUrl",get:function(){return this.customConnectorUrlService.getCustomApiTabUrl(this.nextTab)}},{key:"previousTabDisplayName",get:function(){return this.getTabDisplayName(this.previousTab)}},{key:"nextTabDisplayName",get:function(){return this.getTabDisplayName(this.nextTab)}},{key:"getTabDisplayName",value:function(e){switch(e){case s.c.general:return this.clientResources.Manage.CustomApi.Tabs.general;case s.c.security:return this.clientResources.Manage.CustomApi.Tabs.security;case s.c.definition:return this.clientResources.Manage.CustomApi.Tabs.definition;case s.c.code:return this.clientResources.Manage.CustomApi.Tabs.code;case s.c.test:return this.clientResources.Manage.CustomApi.Tabs.test;case s.c.copilot:return this.clientResources.Manage.CustomApi.Tabs.copilot;default:return void this.loggingService.logError("CustomApiTabNavigationCtrl.getTabDisplayName",new o.a("CustomApiTabNavigationCtrl.getTabDisplayName","Tab value not handled",{tab:e}))}}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[r.a.services.clientResources,r.a.services.customConnectorUrlService,r.a.services.logging]},33808:function(e,t){e.exports='<div class="customApiTabNavigation">\n    <react-action-button\n        class="customApiTabNavigation-navigationButton--previous"\n        ng-if="customApiTabNavigationCtrl.previousTab"\n        icon-name="customApiTabNavigationCtrl.iconName.Back"\n        href="customApiTabNavigationCtrl.previousTabUrl"\n        telemetry-data="customApiTabNavigationCtrl.previousTabTelemetryData"\n        text="customApiTabNavigationCtrl.previousTabDisplayName"\n        button-role="true">\n    </react-action-button>\n    <react-action-button\n        class="customApiTabNavigation-navigationButton--next"\n        ng-if="customApiTabNavigationCtrl.nextTab"\n        icon-name="customApiTabNavigationCtrl.iconName.Forward"\n        icon-on-right="true"\n        href="customApiTabNavigationCtrl.nextTabUrl"\n        telemetry-data="customApiTabNavigationCtrl.nextTabTelemetryData"\n        text="customApiTabNavigationCtrl.nextTabDisplayName"\n        button-role="true">\n    </react-action-button>\n    <div class="ms-clearfix"></div>\n</div>'},33809:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33810);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33814),this.controllerAs="customConnectorDialogCtrl",this.bindings={model:"=",onCancel:"&",onContinue:"&"}}));r.a.component(n.a.components.customConnectorDialog,new c)},33810:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var r=i(14751),n=i.n(r),o=i(33327),a=i(33381),s=i(33811),l=i(33357),c=i(12330),u=i(13085),d=i(13015),p=i(13009),h=i(33356),m=i(33812),g=i(13016),f=i(33795),v=i(14876),b=i(33813),y=i(33776),w=i(14898),S=i(15548),C=i(33524);function k(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,P(r.key),r)}}function P(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var x={[a.a.Blank]:h.a.none,[a.a.AzureService]:h.a.none,[a.a.OpenApiFile]:h.a.swaggerFile,[a.a.OpenApiUrl]:h.a.swaggerUrl,[a.a.Postman]:h.a.postman,[a.a.Github]:h.a.github,[a.a.OpenAIUrl]:h.a.swaggerUrl},A={[m.a.apiManagement]:h.a.azureApim,[m.a.functions]:h.a.azureFunctions,[m.a.logicApps]:h.a.azureLogicApps},T=function(){function e(t,i,r,o,S,C,k,P,T,R,O,D,E){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.appSettings=i,this.assetService=r,this.clientResources=o,this.customApiHelperService=S,this.loggingService=C,this.fileReader=k,this.codeEditorDataService=P,this.promiseHelperService=T,this.policyDataService=R,this.swaggerEditorDataService=O,this.apisClientARM=D,this.apisClientGithub=E,this.messageBarType=g.c,this.azureServiceDropdown=void 0,this.githubBranchDropdown=[{key:s.a.dev,text:s.a.dev},{key:s.a.master,text:s.a.master}],this.githubConnectorTypeSelection=[{key:s.b.certified,text:"Certified"},{key:s.b.custom,text:"Custom"}],this.DialogModeToHeaderIcon={[a.a.Blank]:void 0,[a.a.AzureService]:void 0,[a.a.OpenApiFile]:void 0,[a.a.OpenApiUrl]:void 0,[a.a.Postman]:void 0,[a.a.Github]:this.assetService.githubIcon,[a.a.OpenAIUrl]:void 0},this.model=void 0,this.onContinue=void 0,this.onCancel=void 0,this.errorMessage=void 0,this.errorFromTitle=void 0,this.warningMessage=void 0,this.learnMoreLink=void 0,this.deepLink=void 0,this.dialogData=void 0,this.selectedImportType=void 0,this.customApiDialog=void 0,this.$onInit=()=>{this.selectedImportType=this.importTypes()[a.a.Blank],this.dialogData={swagger:n()(l.b)},this.customApiDialog={show:this.model.show,buttons:[{label:this.clientResources.Manage.CustomApi.General.Continue,action:()=>{if(this.swaggerEditorDataService.clear(),this.policyDataService.clear(),this.codeEditorDataService.clear(),this.swaggerEditorDataService.SwaggerEditorData.displayName=this.dialogData.displayName,!this.isModeGithub){var e=Object(b.a)(this.swaggerEditorDataService.SwaggerEditorData.displayName,this.clientResources);if(e)return this.errorMessage=e.message,void(this.errorFromTitle=!0)}this.swaggerEditorDataService.swagger=this.dialogData.swagger,this.codeEditorDataService.CodeEditorData.codeEnabled=this.dialogData.codeEnabled,this.dialogData.codeEnabled?this.importGithubCodeFile():this.codeEditorDataService.CodeEditorData.sourceCode=f.a,this.model.dialogMode===a.a.Blank&&(this.swaggerEditorDataService.SwaggerEditorData.swagger.info.title=this.dialogData.displayName),this.swaggerEditorDataService.SwaggerEditorData.swaggerFileName=this.dialogData.swaggerFileName||"".concat(Object(w.a)(this.swaggerEditorDataService.SwaggerEditorData.displayName),".swagger.json"),this.swaggerEditorDataService.swaggerEditorUIData.swaggerUpdatedFromList=!!this.model.api,this.model.show=!1,this.swaggerEditorDataService.SwaggerEditorData.importFormat=x[this.model.dialogMode],this.model.dialogMode===a.a.AzureService&&(this.swaggerEditorDataService.SwaggerEditorData.importFormat=A[this.dialogData.azureServiceSelected.key]),this.model.dialogMode===a.a.Postman&&(this.swaggerEditorDataService.SwaggerEditorData.importFormat=this.dialogData.postmanImportSchema===y.a.PostmanCollectionV1Schema?h.a.postman:h.a.postmanV2),this.policyDataService.fetchPolicyTypes(this.$scope).then(()=>{this.setImportedApiProps()}).finally(()=>{this.onContinue({api:this.model.api})})},primary:!0,disabled:!0},{label:this.clientResources.Common.Cancel,action:()=>{this.dialogData={swagger:n()(l.b)},this.errorMessage=void 0,this.warningMessage=void 0,this.errorFromTitle=!1,this.model.show=!1,this.onCancel()},primary:!1}]},this.customApiDialog.buttons[1].disabled=this.customApiDialog.showProgressSpinner,this.$scope.$watch(()=>this.model.show,()=>{this.selectedImportType=this.importTypes()[this.model.dialogMode],this.customApiDialog.show=this.model.show,this.dialogData.displayName=this.model.api?this.model.api.properties.displayName:"",this.model.show&&this.model.dialogMode===a.a.AzureService&&Object(v.a)(this.dialogData.subscriptionList)&&this.readAzureSubscriptions()}),this.$scope.$watch(()=>JSON.stringify(this.dialogData),()=>{switch(this.customApiDialog.buttons[0].disabled=!0,this.model.dialogMode){case a.a.Blank:this.customApiDialog.buttons[0].disabled=!this.dialogData.displayName;break;case a.a.OpenApiFile:case a.a.OpenApiUrl:case a.a.OpenAIUrl:case a.a.Postman:case a.a.Github:case a.a.AzureService:this.customApiDialog.buttons[0].disabled=!this.dialogData.displayName||Object(c.a)(this.dialogData.swagger)||Object(c.a)(this.dialogData.swaggerFileName)||JSON.stringify(this.dialogData.swagger)===JSON.stringify(l.b)||void 0!==this.errorMessage}})},this.onConnectorNameChange=(e,t)=>{this.errorFromTitle&&(this.errorMessage=void 0,this.errorFromTitle=!1),this.dialogData.displayName=t},this.onSwaggerUrlChanged=e=>{this.dialogData.swaggerUrl=e},this.onImportFiles=(e,t)=>{var i=e&&e[0];i&&t(i)},this.onImportUrl=e=>{this.errorMessage=void 0,this.customApiDialog.showProgressSpinner=!0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogImportSwaggerUrlStart);this.customApiHelperService.importSwaggerUrl(e,this.updateDialogData).then(()=>{this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportSwaggerUrlEnd)}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.updateLinksInError(this.clientResources.Manage.CustomConnector.Import.LearnMoreTarget,"CustomApiImportUrlFailedLearnMore"),this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportSwaggerUrlEnd,Object(p.y)(e),e)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})},this.onOpenAIPluginImportUrl=e=>{this.errorMessage=void 0,this.customApiDialog.showProgressSpinner=!0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogImportPluginUrlStart),i=new URL(e),r=this.getManifestURL(i);this.customApiHelperService.importOpenAIPluginUrl(r,this.updateDialogData).then(()=>{this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportPluginUrlEnd)}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.updateLinksInError(this.clientResources.Manage.CustomConnector.Import.LearnMoreTarget,"CustomApiImportUrlFailedLearnMore"),this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportPluginUrlEnd,Object(p.y)(e),e)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})},this.onImportPostmanCollection=e=>{this.errorMessage=void 0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogImportPostmanStart);this.customApiHelperService.importPostmanCollection(e,this.updateDialogData).then(e=>{this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportPostmanEnd,e),this.dialogData.postmanImportSchema=e.schema}).catch(i=>{this.errorMessage=Object(d.o)(i),this.errorFromTitle=!1,this.updateLinksInError(this.clientResources.Manage.CustomConnector.ImportPostman.LearnMoreTarget,"CustomApiImportPostmanFailedLearnMore"),this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportPostmanEnd,Object(p.y)(i),i),this.updateDialogData(e.name,void 0)})},this.onImportSwaggerFile=e=>{this.errorMessage=void 0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogImportSwaggerFileStart);this.customApiHelperService.importSwaggerFile(e,this.updateDialogData).then(e=>{this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportSwaggerFileEnd),e.innerException&&e.innerException.warningMessage&&"Specified swagger has the following errors: ''"!==e.innerException.warningMessage?this.warningMessage=e.innerException.warningMessage:this.warningMessage=void 0,this.customApiDialog.buttons[0].disabled=!1}).catch(i=>{this.errorMessage=Object(d.o)(i),this.errorFromTitle=!1,this.updateLinksInError(this.clientResources.Manage.CustomConnector.Import.LearnMoreTarget,"CustomApiImportFileFailedLearnMore"),i.innerException&&i.innerException.warningMessage&&"Specified swagger has the following warnings: ''"!==i.innerException.warningMessage&&(this.warningMessage=i.innerException.warningMessage),this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportSwaggerFileEnd,Object(p.y)(i),i),this.customApiDialog.buttons[0].disabled=!0,this.updateDialogData(e.name,void 0)})},this.updateDialogData=(e,t)=>{this.dialogData.swaggerFileName=e,this.dialogData.swagger=t},this.onGitHubConnectorTypeChange=(e,t)=>{this.dialogData.githubDirectorySelected=t,this.resetErrorMessage(),this.resetGithubBranchSelection(),this.resetGithubConnectorSelection()},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"CustomConnectorDialogCtrl"}),this.azureServiceDropdown=[{key:m.a.functions,text:this.clientResources.Manage.CustomApi.Create.FromAzureService.Option.Functions.Label},{key:m.a.logicApps,text:this.clientResources.Manage.CustomApi.Create.FromAzureService.Option.LogicApps.Label},{key:m.a.apiManagement,text:this.clientResources.Manage.CustomApi.Create.FromAzureService.Option.ApiManagement.Label}]}var t,i,r;return t=e,(i=[{key:"DialogModeToHeaderIconAlt",value:function(){return{[a.a.Blank]:void 0,[a.a.AzureService]:void 0,[a.a.OpenApiFile]:void 0,[a.a.OpenApiUrl]:void 0,[a.a.Postman]:void 0,[a.a.Github]:this.clientResources.Manage.CustomApi.Create.FromGithub.Dialog.Headericon.Alt,[a.a.OpenAIUrl]:void 0}}},{key:"DialogModeToApiLineItem",value:function(){return{[a.a.Blank]:this.clientResources.Manage.CustomApi.Create.FromBlank.MenuLabel,[a.a.AzureService]:this.clientResources.Manage.CustomApi.Create.FromAzureService.MenuLabel,[a.a.OpenApiFile]:this.clientResources.Manage.CustomApi.Create.FromOpenAPIFile.MenuLabel,[a.a.OpenApiUrl]:this.clientResources.Manage.CustomApi.Create.FromOpenAPIUrl.MenuLabel,[a.a.Postman]:this.clientResources.Manage.CustomApi.Create.FromPostman.MenuLabel,[a.a.Github]:this.clientResources.Manage.CustomApi.Create.FromGithub.MenuLabel,[a.a.OpenAIUrl]:this.clientResources.Manage.CustomApi.Create.FromOpenAIUrl.MenuLabel}}},{key:"importTypes",value:function(){return{[a.a.Blank]:void 0,[a.a.AzureService]:void 0,[a.a.Github]:void 0,[a.a.OpenApiFile]:{label:this.clientResources.Manage.CustomApi.Create.FromOpenAPIFile.Upload.Label,importButtonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.ButtonAriaLabel,placeholder:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.PlaceHolder,textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.TextFieldAriaLabel,acceptedFileExtensions:this.customApiHelperService.getSupportedOpenApiFileTypes(),onImportFiles:e=>this.onImportFiles(e,this.onImportSwaggerFile)},[a.a.OpenApiUrl]:{label:this.clientResources.Manage.CustomApi.Create.FromOpenAPIUrl.Upload.Label,buttonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.ButtonAriaLabel,placeholder:"https://",textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.TextFieldAriaLabel,onTextChanged:e=>this.onSwaggerUrlChanged(e),buttonText:this.clientResources.Common.Import,onButtonClick:e=>this.onImportUrl(e)},[a.a.OpenAIUrl]:{label:this.clientResources.Manage.CustomApi.Create.FromOpenAIUrl.Upload.Label,buttonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportOpenAIPlugin.PluginUrl.ButtonAriaLabel,placeholder:this.clientResources.Manage.CustomApi.RightPane.ImportOpenAIPlugin.PluginUrl.Placeholder,textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportOpenAIPlugin.PluginUrl.TextFieldAriaLabel,onTextChanged:e=>this.onSwaggerUrlChanged(e),buttonText:this.clientResources.Common.Import,onButtonClick:e=>this.onOpenAIPluginImportUrl(e)},[a.a.Postman]:{label:this.clientResources.Manage.CustomApi.Create.FromPostman.Upload.Label,importButtonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.ButtonAriaLabel,placeholder:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.PlaceHolder,textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.TextFieldAriaLabel,acceptedFileExtensions:[".json"],onImportFiles:e=>this.onImportFiles(e,this.onImportPostmanCollection)}}}},{key:"paneTitle",get:function(){return this.DialogModeToApiLineItem()[this.model.dialogMode]}},{key:"isModeOpenApiFile",get:function(){return this.model.dialogMode===a.a.OpenApiFile}},{key:"isModePostman",get:function(){return this.model.dialogMode===a.a.Postman}},{key:"isModeOpenApiUrl",get:function(){return this.model.dialogMode===a.a.OpenApiUrl}},{key:"isModeOpenAIUrl",get:function(){return this.model.dialogMode===a.a.OpenAIUrl}},{key:"isModeAzureService",get:function(){return this.model.dialogMode===a.a.AzureService}},{key:"isModeApiManagement",get:function(){return!Object(c.a)(this.dialogData.azureServiceSelected)&&this.dialogData.azureServiceSelected.key===m.a.apiManagement}},{key:"isModeGithub",get:function(){return this.model.dialogMode===a.a.Github}},{key:"isGithubBranchSelected",get:function(){return!Object(c.a)(this.dialogData.githubBranchSelected)}},{key:"isGithubConnectorTypeSelected",get:function(){return!Object(c.a)(this.dialogData.githubDirectorySelected)}},{key:"isAzureSubscriptionSelected",get:function(){return!Object(c.a)(this.dialogData.azureSubscriptionSelected)}},{key:"isAppNameDropDownEnabled",get:function(){return Object(c.a)(this.dialogData.azureSubscriptionSelected)||Object(c.a)(this.dialogData.azureServiceSelected)}},{key:"isApiNameDropDownEnabled",get:function(){return Object(c.a)(this.dialogData.azureSubscriptionSelected)||Object(c.a)(this.dialogData.azureServiceSelected)||Object(c.a)(this.dialogData.azureAppSelected)}},{key:"isAzureServiceDropDownEnabled",get:function(){return Object(c.a)(this.dialogData.azureSubscriptionSelected)}},{key:"headerIcon",get:function(){return this.DialogModeToHeaderIcon[this.model.dialogMode]}},{key:"headerIconAlt",get:function(){return this.DialogModeToHeaderIconAlt()[this.model.dialogMode]}},{key:"subHeader",get:function(){return this.clientResources.Manage.CustomApi.Create.FromGithub.Dialog.Subheader.Label}},{key:"updateLinksInError",value:function(e,t,i,r){this.learnMoreLink={href:e,ariaLabel:this.clientResources.Manage.CustomApi.Create.FromAzureService.LearnMore,telemetryData:{name:t}},i&&(this.deepLink={href:Object(S.a)(this.clientResources.Manage.CustomApi.Create.FromAzureService.AzureDeepLink,encodeURIComponent(i)),ariaLabel:this.clientResources.Manage.CustomApi.Create.FromAzureService.FixItInAzure,telemetryData:{name:r}})}},{key:"onAzureSubscriptionChanged",value:function(){this.resetErrorMessage(),this.resetAzureServiceSelection(),this.resetAppNameSelection(),this.resetApiNameSelection(),this.resetSwagger()}},{key:"onAzureServiceChanged",value:function(){this.resetErrorMessage(),this.resetAppNameSelection(),this.resetApiNameSelection(),this.resetSwagger(),this.readAzureServicesForSubscription()}},{key:"onAzureAppNameChanged",value:function(){this.resetErrorMessage(),this.resetApiNameSelection(),this.resetSwagger(),this.importAzureService()}},{key:"onAzureApiNameChanged",value:function(){this.resetErrorMessage(),this.resetSwagger(),this.importApiManagementApiDefinition()}},{key:"onGithubPathChanged",value:function(){this.resetErrorMessage(),this.resetGithubConnectorSelection(),this.listGithubConnectors()}},{key:"onGithubConnectorChanged",value:function(){this.resetErrorMessage(),this.resetSwagger(),this.importGithubConnector(),this.isCodeEnabled(),this.model.api||this.importGithubApiProps()}},{key:"resetGithubConnectorSelection",value:function(){this.resetSwagger(),this.dialogData.githubConnectorSelected=void 0,this.dialogData.githubConnectors=void 0}},{key:"resetGithubBranchSelection",value:function(){this.dialogData.githubBranchSelected=void 0}},{key:"resetAzureServiceSelection",value:function(){this.dialogData.azureServiceSelected=void 0}},{key:"resetAppNameSelection",value:function(){this.dialogData.azureServices=void 0,this.dialogData.azureAppSelected=void 0,this.resetSwagger()}},{key:"resetErrorMessage",value:function(){this.errorMessage=void 0,this.errorFromTitle=!1,this.learnMoreLink=void 0,this.deepLink=void 0,this.warningMessage=void 0}},{key:"resetSwagger",value:function(){this.dialogData.swaggerUrl=void 0,this.dialogData.swagger=void 0}},{key:"resetApiNameSelection",value:function(){this.dialogData.azureApiSelected=void 0,this.dialogData.azureApiManagementApis=void 0}},{key:"getManifestURL",value:function(e){return e.pathname&&"/"!==e.pathname?e.toString():"".concat(e.protocol,"//").concat(e.hostname,"/.well-known/ai-plugin.json")}},{key:"readAzureServicesForSubscription",value:function(){this.customApiDialog.showProgressSpinner=!0;var e="customConnectorDialogCtrl.readAzureServicesForSubscription",t=this.loggingService.profileStart(u.a.myCustomApiDialogReadAzureServicesForSubscriptionStart);if(Object(c.a)(this.dialogData.azureSubscriptionSelected)||Object(c.a)(this.dialogData.azureServiceSelected))this.loggingService.logWarning(e,"Azure subscription or the Azure Services is not selected in the dropdown list");else{var i={subscriptionId:this.dialogData.azureSubscriptionSelected.id,resourceType:this.dialogData.azureServiceSelected.key.toString()};this.apisClientARM.listSubscriptionResources(i).then(i=>{!Object(c.a)(i.value)&&i.value.length>0?(this.dialogData.azureServices=i.value,this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogReadAzureServicesForSubscriptionEnd)):(this.errorMessage=Object(S.a)(this.clientResources.Manage.CustomApi.Create.FromAzureService.NoResourceError,this.dialogData.azureServiceSelected.text),this.loggingService.logWarning(e,"The resource list from ARM is undefined or empty for resource type:"+this.dialogData.azureServiceSelected.key.toString()))}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(t,u.a.myCustomApiDialogReadAzureServicesForSubscriptionEnd,Object(p.y)(e),e)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})}}},{key:"importAzureService",value:function(){switch(this.dialogData.azureServiceSelected.key){case m.a.functions:var e={resourceId:this.dialogData.azureAppSelected.id};this.importAzureFunctionApp(e);break;case m.a.logicApps:this.importAzureLogicApps(this.dialogData.azureAppSelected.id);break;case m.a.apiManagement:this.listAzureApiManagementApis(this.dialogData.azureAppSelected.id)}}},{key:"importApiManagementApiDefinition",value:function(){this.importAzureApiManagementApi(this.dialogData.azureApiSelected.id)}},{key:"readAzureSubscriptions",value:function(){this.customApiDialog.showProgressSpinner=!0;var e=this.loggingService.profileStart(u.a.myCustomApiDialogReadAzureSubscriptionsStart),t="CustomConnectorDialogCtrl.readAzureSubscriptions";this.apisClientARM.listSubscriptions().then(i=>{if(Object(c.a)(i))this.loggingService.logWarning(t,"The response from ARM is null or undefined"),this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoSubscriptionError;else if(Object(v.a)(i))this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoSubscriptionError,this.loggingService.logWarning(t,"Logged in user has no azure subscription. The subscription list from ARM is empty");else{var r=i.value.filter(e=>"Enabled"===e.state);Object(v.a)(r)?(this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoSubscriptionError,this.loggingService.logWarning(t,"Logged in user has no azure subscription that is Enabled.")):(this.dialogData.subscriptionList=r,this.loggingService.profileEndWithSuccess(e,u.a.myCustomApiDialogReadAzureSubscriptionsEnd))}}).catch(t=>{this.errorMessage=Object(d.o)(t),this.errorFromTitle=!1,this.loggingService.profileEnd(e,u.a.myCustomApiDialogReadAzureSubscriptionsEnd,Object(p.y)(t),t)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})}},{key:"listGithubConnectors",value:function(){this.customApiDialog.showProgressSpinner=!0;var e=this.dialogData.githubBranchSelected.text,t=this.dialogData.githubDirectorySelected.key,i={branch:e,dir:t},r=this.loggingService.profileStart(u.a.myCustomApiGetGithubConnectorsStart,i);this.apisClientGithub.listDirectoryContents(t,e).then(e=>{var t=(e||[]).filter(e=>"dir"===e.type);if(Object(v.a)(t))throw new p.b("Github.NoConnectorsError",this.clientResources.Manage.CustomApi.Create.FromGithub.NoConnectorError);this.dialogData.githubConnectors=t,this.loggingService.profileEndWithSuccess(r,u.a.myCustomApiGetGithubConnectorsEnd,i)}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(r,u.a.myCustomApiGetGithubConnectorsEnd,Object(p.y)(e),e,i)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})}},{key:"importAzureFunctionApp",value:function(e){this.customApiDialog.showProgressSpinner=!0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogImportAzureFunctionAppStart),i="CustomConnectorDialogCtrl.importAzureFunctionApp";this.apisClientARM.getResourceSiteConfig(e).then(r=>{Object(c.a)(r)||Object(v.a)(r.value)?(this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoApiDefinitionError,this.loggingService.logWarning(i,"The resourceSiteConfigResource is null")):Object(c.a)(r.value[0].properties.apiDefinition)||Object(c.a)(r.value[0].properties.apiDefinition.url)?(this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoApiDefinitionError,this.updateLinksInError(this.clientResources.Manage.CustomApi.Create.FromAzureService.ApiDefHelpLink,"CustomApiAzureIntegrationApiDefHelpVisited",e.resourceId,"CustomApiAzureIntegrationAzurePortalVisited"),this.loggingService.logWarning(i,"There is no API definition for this resource")):Object(c.a)(r.value[0].properties.cors)||!Object(c.a)(r.value[0].properties.cors.allowedOrigins)&&!r.value[0].properties.cors.allowedOrigins.some(e=>this.appSettings.portalUrl.startsWith(e)||"*"===e||e.startsWith("https://local.flow.microsoft.com/"))?(this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.CorsError,this.updateLinksInError(this.clientResources.Manage.CustomApi.Create.FromAzureService.CorsHelpLink,"CustomApiAzureIntegrationCorsHelpVisited",e.resourceId,"CustomApiAzureIntegrationAzurePortalVisited"),this.loggingService.logWarning(i,"Cross-Origin Resource Sharing (CORS) is not enabled for this resource")):(this.dialogData.swaggerUrl=r.value[0].properties.apiDefinition.url,this.onImportUrl(this.dialogData.swaggerUrl),this.customApiDialog.showProgressSpinner=!0,this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportAzureFunctionAppEnd))}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportAzureFunctionAppEnd,Object(p.y)(e),e)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})}},{key:"importGithubConnector",value:function(){this.customApiDialog.showProgressSpinner=!0;var e=this.loggingService.profileStart(u.a.myCustomApiImportGithubStart);this.apisClientGithub.getSwaggerFile(this.dialogData.githubBranchSelected.text,this.dialogData.githubConnectorSelected.path).then(e=>{if(Object(c.a)(e))throw new p.b("Github.SwaggerNotFound",this.clientResources.Manage.CustomApi.Create.FromGithub.NoSwaggerError);return this.customApiHelperService.importSwaggerJson(e,this.dialogData.githubConnectorSelected.name+".json",this.updateDialogData)}).then(()=>{this.dialogData.displayName=this.dialogData.githubConnectorSelected.name,this.loggingService.profileEndWithSuccess(e,u.a.myCustomApiImportGithubStart)}).catch(t=>{this.errorMessage=Object(d.o)(t),this.errorFromTitle=!1,this.loggingService.profileEnd(e,u.a.myCustomApiImportGithubEnd,Object(p.y)(t),t)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1,this.customApiDialog.buttons[0].disabled=!1})}},{key:"importGithubApiProps",value:function(){var e=this.loggingService.profileStart(u.a.myCustomApiImportGithubPropsStart);this.apisClientGithub.getApiProperties(this.dialogData.githubBranchSelected.text,this.dialogData.githubConnectorSelected.path).then(t=>{if(Object(c.a)(t))throw new p.b("Github.ApiPropertiesNotFound",this.clientResources.Manage.CustomApi.Create.FromGithub.NoApiPropertiesError);this.dialogData.apiProperties=t.properties,this.loggingService.profileEndWithSuccess(e,u.a.myCustomApiImportGithubPropsEnd)}).catch(t=>{this.errorMessage=Object(d.o)(t),this.errorFromTitle=!1,this.loggingService.profileEnd(e,u.a.myCustomApiImportGithubPropsEnd,Object(p.y)(t),t)})}},{key:"isCodeEnabled",value:function(){var e=this.loggingService.profileStart(u.a.myCustomApiImportGithubCheckForCodeFileStart),t=this.dialogData.githubBranchSelected.text,i=this.dialogData.githubConnectorSelected.path;this.apisClientGithub.listDirectoryContents(i,t).then(t=>{this.dialogData.codeEnabled=t.some(e=>e.name===C.a),this.loggingService.profileEndWithSuccess(e,u.a.myCustomApiImportGithubCheckForCodeFileEnd)}).catch(t=>{this.loggingService.profileEnd(e,u.a.myCustomApiImportGithubCheckForCodeFileEnd,Object(p.y)(t),t)})}},{key:"importGithubCodeFile",value:function(){var e=this.loggingService.profileStart(u.a.myCustomApiImportGithubCodeFileStart);this.apisClientGithub.getCodeFile(this.dialogData.githubBranchSelected.text,this.dialogData.githubConnectorSelected.path).then(e=>this.promiseHelperService.toAngularPromise(this.fileReader(new File([e],C.a)).asText())).then(t=>{this.codeEditorDataService.CodeEditorData.sourceCode=t,this.loggingService.profileEndWithSuccess(e,u.a.myCustomApiImportGithubCodeFileEnd)}).catch(t=>{this.loggingService.profileEnd(e,u.a.myCustomApiImportGithubCodeFileEnd,Object(p.y)(t),t)})}},{key:"setImportedApiProps",value:function(){var e=this.dialogData.apiProperties;Object(c.a)(e)||(Object(c.a)(e.policyTemplateInstances)||(this.policyDataService.policyTemplateInstances=e.policyTemplateInstances),Object(c.a)(e.scriptOperations)||(this.codeEditorDataService.CodeEditorData.scriptOperations=e.scriptOperations),Object(v.a)(e.connectionParameters)||(this.swaggerEditorDataService.SwaggerEditorData.securityTabDetails.connectionParameters=e.connectionParameters,this.swaggerEditorDataService.connectionParametersAreImported=!0))}},{key:"importAzureLogicApps",value:function(e){this.customApiDialog.showProgressSpinner=!0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogImportLogicAppStart);this.apisClientARM.getLogicAppsSwagger(e).then(i=>{Object(c.a)(i)?(this.updateLinksInError(this.clientResources.Manage.CustomApi.Create.FromAzureService.LogicAppSwaggerHelpLink,"CustomApiAzureIntegrationLogicAppHelpVisited"),this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoSwaggerError,this.loggingService.logWarning("CustomConnectorDialogCtrl.importAzureLogicApps","The swagger is null for this resourceId:"+e)):(this.customApiHelperService.importSwaggerJson(i,this.dialogData.azureAppSelected.name+".json",this.updateDialogData).then(()=>this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportLogicAppEnd)).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportLogicAppEnd,Object(p.y)(e),e)}),this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportLogicAppEnd))}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportLogicAppEnd,Object(p.y)(e),e)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})}},{key:"importAzureApiManagementApi",value:function(e){this.customApiDialog.showProgressSpinner=!0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogImportAzureApiManagementApiStart);this.apisClientARM.getApiManagementApiSwagger(e).then(i=>{Object(c.a)(i)?(this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoSwaggerError,this.loggingService.logWarning("CustomConnectorDialogCtrl.importAzureApiManagementApi","The swagger is null for this apiId:"+e)):this.customApiHelperService.importSwaggerJson(i,this.dialogData.azureAppSelected.name+".json",this.updateDialogData).then(()=>this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogImportAzureApiManagementApiEnd)).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportAzureApiManagementApiEnd,Object(p.y)(e),e)})}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(t,u.a.myCustomApiDialogImportAzureApiManagementApiEnd,Object(p.y)(e),e)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})}},{key:"listAzureApiManagementApis",value:function(e){this.customApiDialog.showProgressSpinner=!0;var t=this.loggingService.profileStart(u.a.myCustomApiDialogListAzureApiManagementApisStart),i="CustomConnectorDialogCtrl.listAzureApiManagementApis";this.apisClientARM.listApiManagementApis(e).then(e=>{Object(c.a)(e)?(this.loggingService.logWarning(i,"The response from ARM is null or undefined"),this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoApiError):Object(v.a)(e.value)?(this.errorMessage=this.clientResources.Manage.CustomApi.Create.FromAzureService.NoApiError,this.loggingService.logWarning(i,"Logged in user has no Apis in this APIM instance. The API list from ARM is empty")):(this.dialogData.azureApiManagementApis=e.value.filter(e=>"soap"!==e.properties.type),this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiDialogListAzureApiManagementApisEnd))}).catch(e=>{this.errorMessage=Object(d.o)(e),this.errorFromTitle=!1,this.loggingService.profileEnd(t,u.a.myCustomApiDialogListAzureApiManagementApisEnd,Object(p.y)(e),e)}).finally(()=>{this.customApiDialog.showProgressSpinner=!1})}}])&&k(t.prototype,i),r&&k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();T.$inject=[o.a.services.$scope,o.a.services.appSettings,o.a.services.assetService,o.a.services.clientResources,o.a.services.customApiHelper,o.a.services.logging,o.a.services.fileReaderHelperService,o.a.services.codeEditorData,o.a.services.promiseHelperService,o.a.services.policyDataService,o.a.services.swaggerEditorData,o.a.services.apisClientARM,o.a.services.apisClientGithub]},33811:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var r=function(e){return e.custom="custom-connectors",e.certified="certified-connectors",e}({}),n=function(e){return e.dev="dev",e.master="master",e}({})},33812:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){return e.functions="Microsoft.Web/sites",e.logicApps="Microsoft.Logic/workflows",e.apiManagement="Microsoft.ApiManagement/service",e}({})},33813:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(13143),n=i(13031),o=i(13083),a=i(33364);function s(e,t){return Object(o.a)(e)?new a.a(r.b.customApiNameError,t.Manage.CustomConnector.DisplayName.Empty,null):/^[a-zA-Z0-9_\- ]*$/.test(e)?e.length>30?new a.a(r.b.customApiNameError,Object(n.a)(t.Manage.CustomConnector.DisplayName.TooLong,30)):null:new a.a(r.b.customApiNameError,t.Manage.CustomConnector.DisplayName.InvalidCharacters,null)}},33814:function(e,t){e.exports='<div class="customConnectorDialog">\n    <modal-dialog model="customConnectorDialogCtrl.customApiDialog">\n        <dialog-header-content-template>\n            <h1 class="title" ng-if="!customConnectorDialogCtrl.isModeGithub">{{::customConnectorDialogCtrl.paneTitle}}</h1>\n            <div class="header-icon-container" ng-if="customConnectorDialogCtrl.isModeGithub">\n                <img class="header-icon" src="{{customConnectorDialogCtrl.headerIcon}}" alt="{{customConnectorDialogCtrl.headerIconAlt}}">\n                <div class="header-container">\n                    <h1 class="title">{{::customConnectorDialogCtrl.paneTitle}}</h1>\n                    <div class="header-text">\n                        <a class="header-github-link" href="https://github.com/microsoft/PowerPlatformConnectors" aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.Dialog.Subheader.Href}}">\n                            {{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.Dialog.Subheader.Href}}\n                        </a>\n                        {{::customConnectorDialogCtrl.subHeader}}\n                    </div>\n                </div>\n            </div>\n            <div class="customConnectorDialog-messageBarWrapper" ng-if="customConnectorDialogCtrl.errorMessage">\n                <react-text-message-bar-with-link\n                    type="customConnectorDialogCtrl.messageBarType.error"\n                    message="customConnectorDialogCtrl.errorMessage"\n                    labelLink="customConnectorDialogCtrl.learnMoreLink"\n                    deepLink="customConnectorDialogCtrl.deepLink">\n                </react-text-message-bar-with-link>\n            </div>\n            <div class="customConnectorDialog-messageBarWrapper" ng-if="customConnectorDialogCtrl.warningMessage">\n                <react-text-message-bar\n                    type="customConnectorDialogCtrl.messageBarType.warning"\n                    message="customConnectorDialogCtrl.warningMessage">\n                </react-text-message-bar>\n            </div>\n        </dialog-header-content-template>\n        <dialog-body-content-template>\n            <div class="pane-content">\n                <div class="pane-field">\n                    <react-text-field\n                        label="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromBlank.Name.Label"\n                        placeholder="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.AddName.Label"\n                        is-disabled="customConnectorDialogCtrl.model.api"\n                        type="text"\n                        value="customConnectorDialogCtrl.dialogData.displayName"\n                        on-change="::customConnectorDialogCtrl.onConnectorNameChange"\n                        ng-if="!customConnectorDialogCtrl.isModeGithub"\n                    ></react-text-field>\n                    <div class="customConnectorDialog-container" ng-if="customConnectorDialogCtrl.isModeGithub">\n                        <react-choice-group\n                            options="::customConnectorDialogCtrl.githubConnectorTypeSelection"\n                            label="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.Options.Types.Label"\n                            direction="\'horizontal\'"\n                            required="true"\n                            selected-key="customConnectorDialogCtrl.dialogData.githubConnectorTypeSelected"\n                            on-change="customConnectorDialogCtrl.onGitHubConnectorTypeChange"\n                        ></react-choice-group>\n                        <react-label\n                            text="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.Options.Branches.Label"\n                        ></react-label>\n                        <select\n                            aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.SelectBranch.Label}}"\n                            id="{{\'customConnectorDialog-githubBranch\' + $index}}"\n                            class="c-select customConnectorDialog-dropDown"\n                            ng-model="customConnectorDialogCtrl.dialogData.githubBranchSelected"\n                            ng-change="customConnectorDialogCtrl.onGithubPathChanged()"\n                            ng-disabled="!customConnectorDialogCtrl.isGithubConnectorTypeSelected"\n                            ng-options="branch.text for branch in customConnectorDialogCtrl.githubBranchDropdown | orderBy:\'name\'">\n                            <option disabled selected value>{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.SelectBranch.Label}}</option>\n                        </select>\n                        <react-label\n                            text="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.Options.Connectors.Label"\n                        ></react-label>\n                        <select\n                            aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.SelectConnector.Label}}"\n                            id="{{\'customConnectorDialog-githubConnector\' + $index}}"\n                            class="c-select customConnectorDialog-dropDown"\n                            ng-model="customConnectorDialogCtrl.dialogData.githubConnectorSelected"\n                            ng-change="customConnectorDialogCtrl.onGithubConnectorChanged()"\n                            ng-disabled="!customConnectorDialogCtrl.isGithubBranchSelected"\n                            ng-options="content.name for content in customConnectorDialogCtrl.dialogData.githubConnectors | orderBy:\'name\'">\n                            <option disabled selected value>{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromGithub.SelectConnector.Label}}</option>\n                        </select>\n                    </div>\n                    <div class="customConnectorDialog-container" ng-if="customConnectorDialogCtrl.isModeAzureService">\n                        <react-label\n                            text="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.Subscription.Label"\n                        ></react-label>\n                        <select\n                            aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectSubscription.Label}}"\n                            id="{{\'customConnectorDialog-subscription\' + $index}}"\n                            class="c-select customConnectorDialog-dropDown"\n                            ng-model="customConnectorDialogCtrl.dialogData.azureSubscriptionSelected"\n                            ng-change="customConnectorDialogCtrl.onAzureSubscriptionChanged()"\n                            ng-options="subscription.displayName for subscription in customConnectorDialogCtrl.dialogData.subscriptionList | orderBy:\'displayName\'">\n                            <option disabled selected value>{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectSubscription.Label}}</option>\n                        </select>\n                        <react-label\n                            text="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.AzureService.Label"\n                        ></react-label>\n                        <select\n                            aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectService.Label}}"\n                            id="{{\'customConnectorDialog-azureService\' + $index}}"\n                            class="c-select customConnectorDialog-dropDown"\n                            ng-model="customConnectorDialogCtrl.dialogData.azureServiceSelected"\n                            ng-change="customConnectorDialogCtrl.onAzureServiceChanged()"\n                            ng-disabled="customConnectorDialogCtrl.isAzureServiceDropDownEnabled"\n                            ng-options="azureService.text for azureService in customConnectorDialogCtrl.azureServiceDropdown | orderBy:\'text\'">\n                            <option disabled selected value>{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectService.Label}}</option>\n                        </select>\n                        <div ng-if="!customConnectorDialogCtrl.isModeApiManagement">\n                            <react-label\n                                text="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.AppName.Label"\n                            ></react-label>\n                            <select\n                                aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectAppName.Label}}"\n                                id="{{\'customConnectorDialog-azureApp\' + $index}}"\n                                class="c-select customConnectorDialog-dropDown"\n                                ng-model="customConnectorDialogCtrl.dialogData.azureAppSelected"\n                                ng-change="customConnectorDialogCtrl.onAzureAppNameChanged()"\n                                ng-disabled="customConnectorDialogCtrl.isAppNameDropDownEnabled"\n                                ng-options="azureApp.name for azureApp in customConnectorDialogCtrl.dialogData.azureServices | orderBy:\'name\'">\n                                <option disabled selected value>{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectAppName.Label}}</option>\n                            </select>\n                        </div>\n                        <div ng-if="customConnectorDialogCtrl.isModeApiManagement">\n                            <react-label\n                                text="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.ServiceName.Label"\n                            ></react-label>\n                            <select\n                                aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectApiManagementServiceName.Label}}"\n                                id="{{\'customConnectorDialog-azureServiceName\' + $index}}"\n                                class="c-select customConnectorDialog-dropDown"\n                                ng-model="customConnectorDialogCtrl.dialogData.azureAppSelected"\n                                ng-change="customConnectorDialogCtrl.onAzureAppNameChanged()"\n                                ng-disabled="customConnectorDialogCtrl.isAppNameDropDownEnabled"\n                                ng-options="azureApp.name for azureApp in customConnectorDialogCtrl.dialogData.azureServices | orderBy:\'name\'">\n                                <option disabled selected value>{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectApiManagementServiceName.Label}}</option>\n                            </select>\n                            <react-label\n                                text="::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.ApiName.Label"\n                            ></react-label>\n                            <select\n                                aria-label="{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectApiName.Label}}"\n                                id="{{\'customConnectorDialog-azureApi\' + $index}}"\n                                class="c-select customConnectorDialog-dropDown"\n                                ng-model="customConnectorDialogCtrl.dialogData.azureApiSelected"\n                                ng-change="customConnectorDialogCtrl.onAzureApiNameChanged()"\n                                ng-disabled="customConnectorDialogCtrl.isApiNameDropDownEnabled"\n                                ng-options="azureApi.name for azureApi in customConnectorDialogCtrl.dialogData.azureApiManagementApis | orderBy:\'name\'">\n                                <option disabled selected value>{{::customConnectorDialogCtrl.clientResources.Manage.CustomApi.Create.FromAzureService.SelectApiName.Label}}</option>\n                            </select>\n                        </div>\n                    </div>\n                </div>\n                <div class="pane-field">\n                    <react-file-import\n                        ng-if="customConnectorDialogCtrl.isModeOpenApiFile || customConnectorDialogCtrl.isModePostman"\n                        on-import-files="customConnectorDialogCtrl.selectedImportType.onImportFiles"\n                        placeholder="customConnectorDialogCtrl.selectedImportType.placeholder"\n                        value="customConnectorDialogCtrl.dialogData.swaggerFileName"\n                        label="customConnectorDialogCtrl.selectedImportType.label"\n                        text-field-aria-label="customConnectorDialogCtrl.selectedImportType.textFieldAriaLabel"\n                        accepted-file-extensions="customConnectorDialogCtrl.selectedImportType.acceptedFileExtensions"\n                        import-button-aria-label="customConnectorDialogCtrl.selectedImportType.importButtonAriaLabel"\n                    ></react-file-import>\n                    <react-text-field-with-inline-button\n                        ng-if="customConnectorDialogCtrl.isModeOpenApiUrl || customConnectorDialogCtrl.isModeOpenAIUrl "\n                        value="customConnectorDialogCtrl.dialogData.swaggerUrl"\n                        label="customConnectorDialogCtrl.selectedImportType.label"\n                        placeholder="customConnectorDialogCtrl.selectedImportType.placeholder"\n                        text-field-aria-label="customConnectorDialogCtrl.selectedImportType.textFieldAriaLabel"\n                        button-aria-label="customConnectorDialogCtrl.selectedImportType.buttonAriaLabel"\n                        on-text-changed="customConnectorDialogCtrl.selectedImportType.onTextChanged"\n                        button-disabled="!customConnectorDialogCtrl.dialogData.swaggerUrl"\n                        on-button-click="customConnectorDialogCtrl.selectedImportType.onButtonClick"\n                        button-text="customConnectorDialogCtrl.selectedImportType.buttonText"\n                    ></react-text-field-with-inline-button>\n                </div>\n            </div>\n        </dialog-body-content-template>\n    </modal-dialog>\n</div>\n'},33815:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33816);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33818);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33819),this.bindings={model:"="},this.controller=o.a,this.controllerAs="customApiDetailsTabCtrl"}));n.a.component(r.a.components.customApi.detailsTab,new c)},33816:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(33327),n=i(33528),o=i(33477),a=i(33357),s=i(33360),l=i(33398),c=i(11891),u=i(13016),d=i(20342),p=i(33817);function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g=function(){function e(t,i,r,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.clientResources=i,this.telemetryService=r,this.appSettings=h,this.messageBarType=u.c,this.bannerLearnMoreLink=void 0,this.model=void 0,this.authenticationType=void 0,this.redirectUrl=void 0,this.flowPermissionsList=void 0,this.isRedirectModeGlobalPerConnector=void 0,this.federatedIdentityCredentials=void 0,this.ficDisplayValue=void 0,this.authenticationTypes=void 0,this.$onInit=()=>{this.telemetryService.tagEvent(l.a.CustomApiDetailsTabVisited),this.bannerLearnMoreLink={href:this.clientResources.Manage.CustomApi.Details.BannerForUpdateToUniqueRedirectURL.BannerLink.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.Details.BannerForUpdateToUniqueRedirectURL.BannerLink.AriaLabel},this.authenticationTypes=[{value:o.b.None,displayName:this.clientResources.Manage.CustomApi.Security.noAuth},{value:o.b.Basic,displayName:this.clientResources.Manage.CustomApi.Security.basic},{value:o.b.ApiKey,displayName:this.clientResources.Manage.CustomApi.Security.apiKey},{value:o.b.Oauth2,displayName:this.clientResources.Manage.CustomApi.Security.oauth2},{value:o.b.Windows,displayName:this.clientResources.Manage.CustomApi.Security.windows}],this.$scope.$watch(()=>this.model.api,()=>{if(!Object(s.n)(this.model.api)&&!Object(s.n)(this.model.api.properties)&&!Object(s.n)(this.model.api.properties.swagger)){var e=this.model.api.properties.swagger,t=Object(a.i)(e),i=this.model.api.properties.connectionParameters;if(i&&i.authType&&i.authType.allowedValues&&(t=i.authType.allowedValues[0].value),this.authenticationType=this.authenticationTypes.filter(e=>Object(c.a)(e.value,t))[0],Object(c.a)(this.authenticationType.value,o.b.Oauth2)&&!Object(s.n)(this.model.api.properties.connectionParameters)&&this.model.api.properties.connectionParameters.hasOwnProperty("token")){if(this.redirectUrl=this.model.api.properties.connectionParameters.token.oAuthSettings.redirectUrl,Object(p.a)()&&this.model.api.properties.connectionParameters.token.oAuthSettings.properties.FederatedIdentityCredentials){this.federatedIdentityCredentials={issuer:this.model.api.properties.connectionParameters.token.oAuthSettings.properties.FederatedIdentityCredentials.Issuer,audience:this.model.api.properties.connectionParameters.token.oAuthSettings.properties.FederatedIdentityCredentials.Audience,subject:this.model.api.properties.connectionParameters.token.oAuthSettings.properties.FederatedIdentityCredentials.Subject};var{issuer:r,subject:n,audience:l}=this.federatedIdentityCredentials||{};this.ficDisplayValue=this.clientResources.Manage.CustomApi.RightPane.Fields.ManagedIdentity.FICStringsFormat.replace("{0}",r||"").replace("{1}",n||"").replace("{2}",l||"")}this.isRedirectModeGlobalPerConnector=this.model.api.properties.connectionParameters.token.oAuthSettings.redirectMode===d.g.GlobalPerConnector}}}),this.model.permissions.$watch(this.$scope,()=>{this.flowPermissionsList={permissions:this.model.permissions.filter(e=>Object(c.a)(e.properties.roleName,n.b.Owner))}})},this.telemetryService.tagEvent("NgCtrl.constructor",void 0,{component:"CustomApiDetailsTabCtrl"})}var t,i,r;return t=e,(i=[{key:"isOauth2",get:function(){var e,t=null===(e=this.model)||void 0===e||null===(e=e.api)||void 0===e||null===(e=e.properties)||void 0===e?void 0:e.swagger;return Object(a.i)(t)===o.b.Oauth2}}])&&h(t.prototype,i),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.$inject=[r.a.services.$scope,r.a.services.clientResources,r.a.services.telemetry,r.a.services.appSettings]},33817:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.EcosystemsAndExperience,owners:["jianblu"],description:"ECS feature to enable Managed Identity support for CC Oauth2 AAD",ecsURL:"https://ecs.skype.com/PowerAutomate/EcosystemsAndExperience/configurations/1532667",createdOn:"12/26/2024",fallback:{enableManagedIdentitySupportForCCOauth2AAD:!1}}),{getFeatureValue:a}=Object(n.b)(o,"enableManagedIdentitySupportForCCOauth2AAD")},33818:function(e,t,i){e.exports=i.p+"static/media/customApiDetailsTab.8272873d.less"},33819:function(e,t){e.exports='<section class="subsection-manage section-custom-api-details-tab">\n    <div class="row top-align">\n        <spinner model="customApiDetailsTabCtrl.spinner"></spinner>\n        <div class="column" ng-hide="customApiDetailsTabCtrl.spinner.show">\n            <div ng-if="customApiDetailsTabCtrl.isOauth2 && !customApiDetailsTabCtrl.isRedirectModeGlobalPerConnector">\n                <react-text-message-bar-with-link\n                    type="customApiDetailsTabCtrl.messageBarType.warning"\n                    message="::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.Details.BannerForUpdateToUniqueRedirectURL.BannerText"\n                    labelLink="::customApiDetailsTabCtrl.bannerLearnMoreLink">\n                </react-text-message-bar-with-link>\n            </div>\n            <div class="form-row">\n                <h2 class="ng-binding">{{::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.Details.Description}}</h2>\n                <span class="form-element details-description">{{customApiDetailsTabCtrl.model.api.properties.description}}</span>\n            </div>\n            <div class="form-row" ng-if="!!customApiDetailsTabCtrl.flowPermissionsList">\n                <h2 class="ng-binding">{{::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.Details.Owner}}</h2>\n                <flow-permissions-list model="customApiDetailsTabCtrl.flowPermissionsList"></flow-permissions-list>\n            </div>\n            <div class="form-row">\n                <h2 class="ng-binding">{{::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.Details.AuthenticationType}}</h2>\n                <span class="form-element">{{customApiDetailsTabCtrl.authenticationType.displayName}}</span>\n            </div>\n            <div class="form-row" ng-if="customApiDetailsTabCtrl.redirectUrl">\n                <h2 class="ng-binding">{{::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.RedirectUrl.Label}}</h2>\n                <react-copyable-text-field\n                    copy-button-aria-label="::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.CopyRedirectUrl.Label"\n                    placeholder="::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.RedirectUrl.PlaceHolder"\n                    value="customApiDetailsTabCtrl.redirectUrl">\n                </react-copyable-text-field>\n            </div>\n            <div class="form-row" ng-if="customApiDetailsTabCtrl.federatedIdentityCredentials">\n                <h2 class="ng-binding">{{::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.ManagedIdentity.Label}}</h2>\n                <react-copyable-text-field\n                    copy-button-aria-label="::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.CopyFICStrings.Label"\n                    placeholder="::customApiDetailsTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.ManagedIdentity.PlaceHolder"\n                    value="customApiDetailsTabCtrl.ficDisplayValue">\n                </react-copyable-text-field>\n            </div>\n        </div>\n    </div>\n</section>'},33820:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33821);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33823);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33824),this.controller=o.a,this.controllerAs="generalSwaggerEditorTabCtrl"}));n.a.component(r.a.components.customApi.generalTab,new c)},33821:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(13009),n=i(13272),o=i(20342),a=i(13240),s=i(17914),l=i(14868),c=i(33352),u=i(33364),d=i(33327),p=i(33360),h=i(33800),m=i(33822);function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=["image/jpeg","image/jpg","image/png"],b=function(){function e(t,i,r,l,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.clientResources=i,this.fileReader=r,this.swaggerEditorDataService=l,this.telemetryService=c,this.widgetUtilService=u,this.swaggerEditorData=void 0,this.uploadIcon=n.a.Upload,this.schemeOptions=void 0,this.swaggerScheme=void 0,this.nextTab=s.c.security,this.customApiUploadMaxFileSize=m.c,this.onImportIconFile=e=>{e&&(this.dismissValidationError(),this.telemetryService.tagEvent(a.c.CustomApiIconUploaded),Object(p.k)(e)>=1?this.setValidationError(this.clientResources.Manage.CustomApi.General.MaxIconSizeExceeded):this.isValidImageFileFormat(e.type)?(this.swaggerEditorData.swaggerIconFile=e,this.fileReader(this.swaggerEditorData.swaggerIconFile).asDataURL().then(e=>{this.swaggerEditorData.swaggerIconFileContentUrl=e,this.swaggerEditorDataService.setIconDisplay()})):this.setValidationError(this.clientResources.Manage.CustomApi.General.InvalidIconFileFormat),this.swaggerEditorData.userUploadedIcon=!0)},this.validateIconBrandColor=e=>{var t=this.swaggerEditorDataService.validateSwaggerIconBrandColor(e);return t?h.h.Error(t.message):void this.swaggerEditorDataService.setIconDisplay()},this.validateHost=e=>{var t=this.swaggerEditorDataService.validateSwaggerHost(e);return t&&h.h.Error(t.message)},this.validateBasePath=e=>{var t=this.swaggerEditorDataService.validateSwaggerBasePath(e);return t&&h.h.Error(t.message)},this.onSchemeChange=(e,t)=>{this.swaggerScheme=t.key,this.swaggerEditorData.swagger.schemes=[o.a[this.swaggerScheme]]},this.telemetryService.tagEvent("NgCtrl.constructor",void 0,{component:"GeneralSwaggerEditorTabCtrl"}),this.schemeOptions=[{key:"https",text:this.clientResources.Manage.CustomApi.General.Scheme.https},{key:"http",text:this.clientResources.Manage.CustomApi.General.Scheme.http}],this.telemetryService.tagEvent(a.c.CustomApiGeneralTabVisited),this.swaggerEditorData=this.swaggerEditorDataService.SwaggerEditorData,this.swaggerScheme=o.a[this.swaggerEditorDataService.getSwaggerScheme()],this.$scope.$watch(()=>this.swaggerEditorData.swagger.schemes,(e,t)=>{e!==t&&(this.swaggerScheme=o.a[this.swaggerEditorDataService.getSwaggerScheme()])}),this.$scope.$watch(()=>this.swaggerScheme,(e,t)=>{e!==t&&(this.swaggerEditorData.swagger.schemes=[o.a[this.swaggerScheme]])})}var t,i,d;return t=e,(i=[{key:"isBaseUrlReadOnly",get:function(){return this.widgetUtilService.isLogicApps()&&this.swaggerEditorData.apiLogicApps.properties.apiType===c.a.Soap&&this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod===c.b.SoapToRest}},{key:"dismissValidationError",value:function(){this.swaggerEditorData.validationError=null}},{key:"setValidationError",value:function(e){this.swaggerEditorData.validationError=new u.a(r.c.customApiValidationError,e)}},{key:"isValidImageFileFormat",value:function(e){return v.some(t=>t===e.toLowerCase())}},{key:"onIsOnPremiseDataGatewayChanged",value:function(){this.swaggerEditorDataService.isCustomConnectorMultiAuthEnabled?this.swaggerEditorDataService.onAuthenticationTypesChangedV2([]):this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationType=l.b.None,this.swaggerEditorData.editMode&&(this.swaggerEditorData.uiDetails.isOnPremiseDataGatewayUpdated=!0,this.swaggerEditorDataService.securityTabDetails.isLocked=!1)}}])&&g(t.prototype,i),d&&g(t,d),Object.defineProperty(t,"prototype",{writable:!1}),e}();b.$inject=[d.a.services.$scope,d.a.services.clientResources,d.a.services.fileReaderHelperService,d.a.services.swaggerEditorData,d.a.services.telemetry,d.a.services.widgetUtilService]},33822:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return o}));var r=40,n="^[a-zA-Z0-9!#$%&'^+-._~|]+$",o="1MB"},33823:function(e,t,i){e.exports=i.p+"static/media/generalSwaggerEditorTab.6eeacd39.less"},33824:function(e,t){e.exports='<div class="generalSwaggerEditorTab">\n    \x3c!-- Import swagger section --\x3e\n    <div ng-if="generalSwaggerEditorTabCtrl.widgetUtilService.isLogicApps()">\n        <section class="row">\n            <custom-api-import-section></custom-api-import-section>\n        </section>\n        <hr class="generalSwaggerEditorTab-section-divider"/>\n    </div>\n    \x3c!-- General information section --\x3e\n    <section class="row generalSwaggerEditorTab-section">\n        <div class="column medium-3 left-pane">\n            <h1 class="title">{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Heading}}</h1>\n            <p>{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.GeneralInformation.Description}}</p>\n        </div>\n        <div class="column medium-8 medium-offset-1 right-pane">\n            <h2 class="pane-title">{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Heading}}</h2>\n            <div class="pane-content">\n                <div class="icon-section">\n                    <div class="icon-holder">\n                        <button class="c-button icon-holder-button"\n                            ngf-select="generalSwaggerEditorTabCtrl.onImportIconFile($file)"\n                            ngf-pattern="\'image/*\'"\n                            ngf-accept="\'image/*\'"\n                            ngf-max-size="{{generalSwaggerEditorTabCtrl.customApiUploadMaxFileSize}}"\n                            aria-label="{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Label}}"\n                            aria-describedby="generalSwaggerEditorTab-iconFileImport-description">\n                            <div class="icon-holder-image"\n                                ng-style="generalSwaggerEditorTabCtrl.swaggerEditorData.swaggerIconDisplay"\n                                alt="{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Label}}"></div>\n                            <div class="c-label icon-holder-label c-glyph glyph-upload">\n                                {{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Upload}}\n                            </div>\n                        </button>\n                    </div>\n                    <div class="icon-description">\n                        <a id="generalSwaggerEditorTab-iconFileImport" ngf-select="generalSwaggerEditorTabCtrl.onImportIconFile($file)" >{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Label}}</a>\n                        <label id="generalSwaggerEditorTab-iconFileImport-description" for="generalSwaggerEditorTab-iconFileImport">{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Icon.Description}}</label>\n                    </div>\n                </div>\n                <div class="pane-field">\n                    <validated-input\n                        input-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swaggerIconBrandColor"\n                        input-placeholder="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.IconBrandColor.PlaceHolder"\n                        input-maxlength="7"\n                        validator="generalSwaggerEditorTabCtrl.validateIconBrandColor"\n                        label="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.IconBrandColor.Label">\n                    </validated-input>\n                </div>\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Description.Label}}</label>\n                    <div class="c-textarea">\n                        <textarea\n                            class="generalSwaggerEditorTab-input--resizable"\n                            ng-attr-placeholder="{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Description.PlaceHolder}}"\n                            ng-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swagger.info.description"\n                            maxlength="500"\n                            aria-label="{{::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Description.Label}}">\n                        </textarea>\n                    </div>\n                </div>\n                <div class="pane-field">\n                    <div class="c-checkbox">\n                        <label class="pane-field-label">\n                            <input\n                                aria-label="{{::generalSwaggerEditorTabCtrl.clientResources.Manage.Connection.Create.UseGatewayCheckboxLabel}}"\n                                ng-change="generalSwaggerEditorTabCtrl.onIsOnPremiseDataGatewayChanged()"\n                                ng-model="generalSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.isOnPremiseDataGateway"\n                                type="checkbox" />\n                            <span>{{::generalSwaggerEditorTabCtrl.clientResources.Manage.Connection.Create.UseGatewayCheckboxLabel}}</span>\n                            <learn-more\n                                resource="\'Manage.CustomApi.General.Gateway.Hyperlink\'"\n                                link-aria-label="::generalSwaggerEditorTabCtrl.clientResources.Manage.Connection.Create.UseGatewayCheckbox.LearnMoreAriaLabel"\n                            ></learn-more>\n                        </label>\n                    </div>\n                </div>\n                <div class="pane-field">\n                    <react-choice-group\n                        options="::generalSwaggerEditorTabCtrl.schemeOptions"\n                        label="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.General.Scheme.Label"\n                        direction="\'horizontal\'"\n                        required="true"\n                        selected-key="generalSwaggerEditorTabCtrl.swaggerScheme"\n                        on-change="::generalSwaggerEditorTabCtrl.onSchemeChange"\n                    ></react-choice-group>\n                </div>\n                <div class="pane-field">\n                    <validated-input\n                        input-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swagger.host"\n                        input-maxlength="100",\n                        input-placeholder="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Host.PlaceHolder"\n                        validator="generalSwaggerEditorTabCtrl.validateHost"\n                        label="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Host.Label"\n                        is-required="true"\n                        aria-required="true">\n                    </validated-input>\n                </div>\n                <div class="pane-field">\n                    <validated-input\n                        input-model="generalSwaggerEditorTabCtrl.swaggerEditorData.swagger.basePath"\n                        input-maxlength="100"\n                        validator="generalSwaggerEditorTabCtrl.validateBasePath"\n                        label="::generalSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.BaseUrl.Label"\n                        is-read-only="generalSwaggerEditorTabCtrl.isBaseUrlReadOnly">\n                    </validated-input>\n                </div>\n            </div>\n            <custom-api-tab-navigation\n                next-tab="generalSwaggerEditorTabCtrl.nextTab">\n            </custom-api-tab-navigation>\n        </div>\n    </section>\n</div>\n'},33825:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33826);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33827);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33828),this.controller=o.a,this.controllerAs="definitionSwaggerEditorTabCtrl"}));n.a.component(r.a.components.customApi.definitionTab,new c)},33826:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(33353),n=i(33327),o=i(13016),a=i(33800),s=i(33357),l=i(33802),c=i(33359),u=i(17914),d=i(12330),p=i(13240),h=i(13031),m=i(12344),g=i(33376);function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(){function e(t,i,n,a,l,f,v,b,y,w,S,C,k){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$interval=t,this.$routeParams=i,this.$scope=n,this.$timeout=a,this.appSettings=l,this.clientResources=f,this.customConnectorUrlService=v,this.navigationService=b,this.policyDataService=y,this.swaggerEditorDataService=w,this.swaggerValidationService=S,this.telemetryService=C,this.widgetUtilService=k,this.messageBarType=o.c,this.pageFullyRendered=!1,this.confirmDialog={title:"",message:"",show:!1,onConfirm:void 0},this.actionStatuses=[],this.triggerStatuses=[],this.definitionsStatuses=[],this.parameterStatuses=[],this.responseStatuses=[],this.selectedActionIndex=null,this.selectedTriggerIndex=null,this.selectedReferenceIndex=null,this.selectedPolicyIndex=null,this.references=[],this.referenceIndexFromRoute={definitions:-1,parameters:-1,responses:-1},this.inlineIndexFromRoute={inlineParameter:-1,inlineResponse:-1},this.previousTab=u.c.security,this.nextTab=void 0,this.addNewAction=()=>{var e=s.m();this.swaggerEditorDataService.SwaggerEditorData.swagger.actions.push(e),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(u.a.actions,this.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length-1))},this.addNewTrigger=()=>{var e=s.p();this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.push(e),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(u.a.triggers,this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.length-1))},this.deleteAction=e=>{Array.isArray(this.swaggerEditorDataService.SwaggerEditorData.swagger.actions)&&(this.swaggerEditorDataService.isDeployedSwaggerAction(e)?(this.confirmDialog.title=this.clientResources.Dialogs.DeleteCustomApiAction.Title,this.confirmDialog.message=Object(h.a)(this.clientResources.Dialogs.DeleteCustomApiAction.Message,e.operation.operationId),this.confirmDialog.onConfirm=()=>this.onDeleteActionConfirmed(e),this.confirmDialog.show=!0):this.onDeleteActionConfirmed(e))},this.deleteTrigger=e=>{this.policyDataService.deleteOperationPolicyItems(e),Array.isArray(this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers)&&(this.swaggerEditorDataService.isDeployedSwaggerTrigger(e)?(this.confirmDialog.title=this.clientResources.Dialogs.DeleteCustomApiTrigger.Title,this.confirmDialog.message=Object(h.a)(this.clientResources.Dialogs.DeleteCustomApiTrigger.Message,e.operation.operationId),this.confirmDialog.onConfirm=()=>this.onDeleteTriggerConfirmed(e),this.confirmDialog.show=!0):this.onDeleteTriggerConfirmed(e))},this.onDeleteActionConfirmed=e=>{this.telemetryService.tagEvent(p.c.CustomApiActionDeleted),this.spliceItem(this.swaggerEditorDataService.SwaggerEditorData.swagger.actions,e)&&(this.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length>0?this.navigateToAction(this.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length-1):this.navigationService.navigate(this.customConnectorUrlService.getCustomApiTabUrl(u.c.definition)))},this.onDeleteTriggerConfirmed=e=>{this.telemetryService.tagEvent(p.c.CustomApiTriggerDeleted),this.spliceItem(this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers,e)&&(this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.length>0?this.navigateToTrigger(this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.length-1):this.navigationService.navigate(this.customConnectorUrlService.getCustomApiTabUrl(u.c.definition)))},this.addNewPolicy=()=>{var e=this.policyDataService.addEmptyPolicyItem();this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(u.a.policies,e))},this.deletePolicy=e=>{this.policyDataService.deletePolicyItem(e)&&(this.policyDataService.policyItems.length>0?this.navigateToPolicy(this.policyDataService.policyItems.length-1):this.navigationService.navigate(this.customConnectorUrlService.getCustomApiTabUrl(u.c.definition)))},this.movePolicyUp=e=>{var t=this.policyDataService.movePolicyItemUp(e);t<0||(t===this.selectedPolicyIndex?this.navigateToPolicy(this.selectedPolicyIndex-1):t===this.selectedPolicyIndex+1&&this.navigateToPolicy(this.selectedPolicyIndex+1))},this.movePolicyDown=e=>{var t=this.policyDataService.movePolicyItemDown(e);t<0||(t===this.selectedPolicyIndex?this.navigateToPolicy(this.selectedPolicyIndex+1):t===this.selectedPolicyIndex-1&&this.navigateToPolicy(this.selectedPolicyIndex-1))},this.navigateToAction=(e,t)=>{this.saveLeftColumnScrollPosition(),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(u.a.actions,e))},this.navigateToTrigger=(e,t)=>{this.saveLeftColumnScrollPosition(),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(u.a.triggers,e))},this.navigateToReference=(e,t)=>{this.saveLeftColumnScrollPosition(),this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl(t,this.getSourceIndex(t)))},this.navigateToPolicy=e=>{this.saveLeftColumnScrollPosition(),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(u.a.policies,e))},this.getActionStatus=(e,t)=>!e||Object(d.a)(t)?r.a.None:this.actionStatuses[t]||r.a.None,this.getTriggerStatus=(e,t)=>!e||Object(d.a)(t)?r.a.None:this.triggerStatuses[t]||r.a.None,this.getReferenceStatus=(e,t)=>{if(!e)return r.a.None;switch(e.source){case c.g.parameters:return this.parameterStatuses[this.getSourceIndex(e)]||r.a.None;case c.g.responses:return this.responseStatuses[this.getSourceIndex(e)]||r.a.None;case c.g.definitions:return this.definitionsStatuses[this.getSourceIndex(e)]||r.a.None;default:return r.a.None}},this.getPolicyStatus=(e,t)=>!e||Object(d.a)(t)?r.a.None:e.validationResults.mostSevereAlertType,this.telemetryService.tagEvent("NgCtrl.constructor",void 0,{component:"DefinitionSwaggerEditorTabCtrl"}),this.nextTab=void 0,this.widgetUtilService.isLogicApps()||(Object(m.c)(this.appSettings.featureFlags)&&!Object(g.a)()?this.nextTab=u.c.test:Object(m.c)(this.appSettings.featureFlags)||Object(g.a)()?this.nextTab=u.c.copilot:this.nextTab=u.c.code);var P,x,A,T,R,O,D=this.$routeParams.operation,E=parseInt(this.$routeParams.operationIndex,10);switch(D){case u.a.actions:P=E;break;case u.a.triggers:x=E;break;case u.a.policies:A=E;break;case u.a.definitions:T=E;break;case u.a.parameters:R=E;break;case u.a.responses:O=E}var F=this.$routeParams.refOperation,I=parseInt(this.$routeParams.refOperationIndex,10);switch(F){case u.a.parameters:R=I;break;case u.a.responses:O=I}this.inlineIndexFromRoute={inlineParameter:P>=0||x>=0?R:-1,inlineResponse:P>=0||x>=0?O:-1},this.referenceIndexFromRoute={definitions:T,parameters:P>=0||x>=0?-1:R,responses:P>=0||x>=0?-1:O},this.$scope.$watchGroup([()=>this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions,()=>this.swaggerEditorDataService.SwaggerEditorData.swagger.responses,()=>this.swaggerEditorDataService.SwaggerEditorData.swagger.parameters],()=>{this.references=[].concat(c.m(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions,c.g.definitions),c.m(this.swaggerEditorDataService.SwaggerEditorData.swagger.parameters,c.g.parameters),c.m(this.swaggerEditorDataService.SwaggerEditorData.swagger.responses,c.g.responses))}),this.$scope.$watch(()=>this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers,()=>{s.J(x,this.swaggerEditorDataService.SwaggerEditorData)&&(this.selectedTriggerIndex=x)}),this.$scope.$watch(()=>this.policyDataService.policyItems,()=>{y.isValidIndex(A)&&(this.selectedPolicyIndex=A)}),this.$scope.$watch(()=>this.swaggerEditorDataService.SwaggerEditorData.swagger.actions,()=>{s.A(P,this.swaggerEditorDataService.SwaggerEditorData)&&(this.selectedActionIndex=P),this.isItemSelected||(this.swaggerEditorDataService.SwaggerEditorData.swagger.actions&&this.swaggerEditorDataService.SwaggerEditorData.swagger.actions.length>0?this.navigateToAction(0,this.swaggerEditorDataService.SwaggerEditorData.swagger.actions[0].operation):this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers&&this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers.length>0&&this.navigateToTrigger(0,this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers[0].operation))}),this.$scope.$watch(()=>this.references,()=>{var e=c.h.filter(e=>s.H(e,this.referenceIndexFromRoute[e],this.swaggerEditorDataService.SwaggerEditorData))[0];e&&(this.selectedReferenceIndex=this.getIndex(this.referenceIndexFromRoute[e],e))}),this.$scope.$watch(()=>this.swaggerValidationService.resultCollection.results,()=>{this.updateFoldingListStatuses()}),this.swaggerValidationService.validateIfSwaggerChanged(this.swaggerEditorDataService.swagger,this.policyDataService.operationPolicyInfo),this.$interval(()=>this.swaggerValidationService.validateIfSwaggerChanged(this.swaggerEditorDataService.swagger,this.policyDataService.operationPolicyInfo),5e3);var j=document.getElementById("customApiDefinitionTab-scrollbox--left");j&&(j.scrollTop=this.swaggerEditorDataService.swaggerEditorUIData.leftColumnScrollPosition),this.$timeout(()=>this.pageFullyRendered=!0)}var t,i,n;return t=e,(i=[{key:"isItemSelected",get:function(){return!Object(d.a)(this.selectedActionIndex)&&this.selectedActionIndex>=0||!Object(d.a)(this.selectedTriggerIndex)&&this.selectedTriggerIndex>=0||!Object(d.a)(this.selectedPolicyIndex)&&this.selectedPolicyIndex>=0||!Object(d.a)(this.inlineIndexFromRoute.inlineParameter)&&this.inlineIndexFromRoute.inlineParameter>=0||!Object(d.a)(this.inlineIndexFromRoute.inlineResponse)&&this.inlineIndexFromRoute.inlineResponse>=0||!Object(d.a)(this.referenceIndexFromRoute.definitions)&&this.referenceIndexFromRoute.definitions>=0||!Object(d.a)(this.referenceIndexFromRoute.parameters)&&this.referenceIndexFromRoute.parameters>=0||!Object(d.a)(this.referenceIndexFromRoute.responses)&&this.referenceIndexFromRoute.responses>=0}},{key:"hasNoOperations",get:function(){var e,t;return!(0!==(null===(e=this.swaggerEditorDataService.SwaggerEditorData.swagger.actions)||void 0===e?void 0:e.length)||0!==(null===(t=this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers)||void 0===t?void 0:t.length))}},{key:"shouldShowAction",get:function(){return s.A(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&!this.shouldShowInlineActionParameter&&!this.shouldShowInlineActionResponse}},{key:"shouldShowTrigger",get:function(){return s.J(this.selectedTriggerIndex,this.swaggerEditorDataService.SwaggerEditorData)&&!this.shouldShowInlineTriggerParameter&&!this.shouldShowInlineTriggerResponse}},{key:"shouldShowInlineParameter",get:function(){return this.shouldShowInlineActionParameter||this.shouldShowInlineTriggerParameter}},{key:"shouldShowInlineResponse",get:function(){return this.shouldShowInlineActionResponse||this.shouldShowInlineTriggerResponse}},{key:"shouldShowInlineActionParameter",get:function(){return s.A(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&s.E(this.inlineIndexFromRoute.inlineParameter,this.swaggerEditorDataService.swagger.actions[this.selectedActionIndex])}},{key:"shouldShowInlineActionResponse",get:function(){return s.A(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&s.F(this.inlineIndexFromRoute.inlineResponse,this.swaggerEditorDataService.swagger.actions[this.selectedActionIndex])}},{key:"shouldShowInlineTriggerParameter",get:function(){return s.J(this.selectedTriggerIndex,this.swaggerEditorDataService.SwaggerEditorData)&&s.E(this.inlineIndexFromRoute.inlineParameter,this.swaggerEditorDataService.swagger.triggers[this.selectedTriggerIndex])}},{key:"shouldShowInlineTriggerResponse",get:function(){return s.J(this.selectedTriggerIndex,this.swaggerEditorDataService.SwaggerEditorData)&&s.F(this.inlineIndexFromRoute.inlineResponse,this.swaggerEditorDataService.swagger.triggers[this.selectedTriggerIndex])}},{key:"shouldShowPolicy",get:function(){return this.policyDataService.isValidIndex(this.selectedPolicyIndex)}},{key:"spliceItem",value:function(e,t){var i=e.indexOf(t);return i>=0&&(e.splice(i,1),!0)}},{key:"updateFoldingListStatuses",value:function(){Array.isArray(this.swaggerEditorDataService.swagger.actions)&&this.swaggerEditorDataService.swagger.actions.forEach((e,t)=>{this.updateActionStatus(e,t)}),Array.isArray(this.swaggerEditorDataService.swagger.triggers)&&this.swaggerEditorDataService.swagger.triggers.forEach((e,t)=>{this.updateTriggerStatus(e,t)}),Array.isArray(this.swaggerEditorDataService.swagger.definitions)&&this.swaggerEditorDataService.swagger.definitions.forEach((e,t)=>{this.updateDefinitionStatus(t)}),Array.isArray(this.swaggerEditorDataService.swagger.parameters)&&this.swaggerEditorDataService.swagger.parameters.forEach((e,t)=>{this.updateParameterStatus(t)}),Array.isArray(this.swaggerEditorDataService.swagger.responses)&&this.swaggerEditorDataService.swagger.responses.forEach((e,t)=>{this.updateResponseStatus(t)})}},{key:"updateActionStatus",value:function(e,t){var i=new a.i({itemPath:"".concat(a.d.Actions,"[").concat(t,"]")}),r=this.swaggerValidationService.resultCollection.filterOnViolator(i);r.add(l.e(e,this.swaggerEditorDataService.swagger,this.swaggerValidationService.resultCollection)),this.actionStatuses[t]=r.mostSevereAlertType}},{key:"updateTriggerStatus",value:function(e,t){var i=new a.i({itemPath:"".concat(a.d.Triggers,"[").concat(t,"]")}),r=this.swaggerValidationService.resultCollection.filterOnViolator(i);r.add(l.e(e,this.swaggerEditorDataService.swagger,this.swaggerValidationService.resultCollection)),r.add(this.policyDataService.getOperationValidationResults(e)),this.triggerStatuses[t]=r.mostSevereAlertType}},{key:"updateDefinitionStatus",value:function(e){var t=new a.i({itemPath:"".concat(a.d.Definitions,"[").concat(e,"]")}),i=this.swaggerValidationService.resultCollection.filterOnViolator(t);this.definitionsStatuses[e]=i.mostSevereAlertType}},{key:"updateParameterStatus",value:function(e){var t=new a.i({itemPath:"".concat(a.d.Parameters,"[").concat(e,"]")}),i=this.swaggerValidationService.resultCollection.filterOnViolator(t);this.parameterStatuses[e]=i.mostSevereAlertType}},{key:"updateResponseStatus",value:function(e){var t=new a.i({itemPath:"".concat(a.d.Responses,"[").concat(e,"]")}),i=this.swaggerValidationService.resultCollection.filterOnViolator(t);this.responseStatuses[e]=i.mostSevereAlertType}},{key:"saveLeftColumnScrollPosition",value:function(){var e;this.swaggerEditorDataService.swaggerEditorUIData.leftColumnScrollPosition=null===(e=document.getElementById("customApiDefinitionTab-scrollbox--left"))||void 0===e?void 0:e.scrollTop}},{key:"getOperationText",value:function(e){return e.operation.operationId}},{key:"getPolicyText",value:function(e){return e.name}},{key:"getReferenceText",value:function(e){return e.name}},{key:"getIndex",value:function(e,t){var i=this.references.filter(e=>e.source===t);return this.references.indexOf(i[e])}},{key:"getSourceIndex",value:function(e){return this.references.filter(t=>t.source===e.source).indexOf(e)}}])&&f(t.prototype,i),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();b.$inject=[n.a.services.$interval,n.a.services.$routeParams,n.a.services.$scope,n.a.services.$timeout,n.a.services.appSettings,n.a.services.clientResources,n.a.services.customConnectorUrlService,n.a.services.navigation,n.a.services.policyDataService,n.a.services.swaggerEditorData,n.a.services.swaggerValidationService,n.a.services.telemetry,n.a.services.widgetUtilService]},33827:function(e,t,i){e.exports=i.p+"static/media/definitionSwaggerEditorTab.72d0d151.less"},33828:function(e,t){e.exports='<div class="customApiDefinitionTab">\n    <section class="row">\n        \x3c!-- Left pane --\x3e\n        <div class="column medium-3 left-pane customApiDefinitionTab-scrollbox" ng-class="{\'customApiDefinitionTab-scrollbox--shifted\': definitionSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.statusAlert.type}"\n            id="customApiDefinitionTab-scrollbox--left">\n            <div class="customApiDefinitionTab-scrollbox-content customApiDefinitionTab-scrollbox-content--preRendered"\n                 ng-class="definitionSwaggerEditorTabCtrl.pageFullyRendered ? \'customApiDefinitionTab-scrollbox-content--rendered\' : \'\'">\n                <folding-list title="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Actions.Heading"\n                              description="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Actions.Description"\n                              add-new-text="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Actions.AddNew"\n                              on-add-new="definitionSwaggerEditorTabCtrl.addNewAction"\n                              filter-text="definitionSwaggerEditorTabCtrl.filterText"\n                              items="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.swagger.actions"\n                              get-item-text="definitionSwaggerEditorTabCtrl.getOperationText"\n                              get-item-status="definitionSwaggerEditorTabCtrl.getActionStatus"\n                              on-delete="definitionSwaggerEditorTabCtrl.deleteAction"\n                              on-item-click="definitionSwaggerEditorTabCtrl.navigateToAction"\n                              selected-item-index="definitionSwaggerEditorTabCtrl.selectedActionIndex"\n                              is-collapsed="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.actions">\n                </folding-list>\n                <hr class="customApiDefinitionTab-content-divider" />\n                <folding-list ng-if="(definitionSwaggerEditorTabCtrl.widgetUtilService.isLogicApps() || !definitionSwaggerEditorTabCtrl.widgetUtilService.isWidgetPage())"\n                              title="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Triggers.Heading"\n                              description="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Triggers.Description"\n                              add-new-text="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Triggers.AddNew"\n                              on-add-new="definitionSwaggerEditorTabCtrl.addNewTrigger"\n                              filter-text="definitionSwaggerEditorTabCtrl.filterText"\n                              items="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.swagger.triggers"\n                              get-item-text="definitionSwaggerEditorTabCtrl.getOperationText"\n                              get-item-status="definitionSwaggerEditorTabCtrl.getTriggerStatus"\n                              on-delete="definitionSwaggerEditorTabCtrl.deleteTrigger"\n                              on-item-click="definitionSwaggerEditorTabCtrl.navigateToTrigger"\n                              selected-item-index="definitionSwaggerEditorTabCtrl.selectedTriggerIndex"\n                              is-collapsed="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.triggers">\n                </folding-list>\n                <hr class="customApiDefinitionTab-content-divider" ng-if="!definitionSwaggerEditorTabCtrl.widgetUtilService.isWidgetPage()" />\n                <folding-list title="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.References.Heading"\n                              description="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.References.Description"\n                              filter-text="definitionSwaggerEditorTabCtrl.filterText"\n                              items="definitionSwaggerEditorTabCtrl.references"\n                              get-item-text="definitionSwaggerEditorTabCtrl.getReferenceText"\n                              get-item-status="definitionSwaggerEditorTabCtrl.getReferenceStatus"\n                              on-item-click="definitionSwaggerEditorTabCtrl.navigateToReference"\n                              selected-item-index="definitionSwaggerEditorTabCtrl.selectedReferenceIndex"\n                              is-collapsed="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.references">\n                </folding-list>\n                <div ng-if="::!definitionSwaggerEditorTabCtrl.widgetUtilService.isLogicApps()">\n                    <hr class="customApiDefinitionTab-content-divider" />\n                    <folding-list title="::definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Policies.Heading"\n                                  description="::definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Policies.Description"\n                                  add-new-text="::definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Definition.LeftPane.Policies.AddNew"\n                                  on-add-new="::definitionSwaggerEditorTabCtrl.addNewPolicy"\n                                  filter-text="::definitionSwaggerEditorTabCtrl.filterText"\n                                  items="definitionSwaggerEditorTabCtrl.policyDataService.policyItems"\n                                  get-item-text="::definitionSwaggerEditorTabCtrl.getPolicyText"\n                                  get-item-status="::definitionSwaggerEditorTabCtrl.getPolicyStatus"\n                                  on-delete="::definitionSwaggerEditorTabCtrl.deletePolicy"\n                                  on-move-up="::definitionSwaggerEditorTabCtrl.movePolicyUp"\n                                  on-move-down="::definitionSwaggerEditorTabCtrl.movePolicyDown"\n                                  on-item-click="::definitionSwaggerEditorTabCtrl.navigateToPolicy"\n                                  selected-item-index="definitionSwaggerEditorTabCtrl.selectedPolicyIndex"\n                                  is-collapsed="definitionSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.policies">\n                    </folding-list>\n                </div>\n            </div>\n        </div>\n        \x3c!-- Right pane --\x3e\n        <div class="column medium-8 medium-offset-1 right-pane customApiDefinitionTab-scrollbox" ng-class="{\'customApiDefinitionTab-scrollbox--shifted\': definitionSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.statusAlert.type}">\n            <div class="customApiDefinitionTab-scrollbox-content">\n                <custom-api-action ng-if="definitionSwaggerEditorTabCtrl.shouldShowAction"></custom-api-action>\n                <custom-api-trigger ng-if="definitionSwaggerEditorTabCtrl.shouldShowTrigger"></custom-api-trigger>\n                <custom-api-parameter ng-if="definitionSwaggerEditorTabCtrl.shouldShowInlineParameter"></custom-api-parameter>\n                <custom-api-response ng-if="definitionSwaggerEditorTabCtrl.shouldShowInlineResponse"></custom-api-response>\n                <custom-api-policy ng-if="definitionSwaggerEditorTabCtrl.shouldShowPolicy"></custom-api-policy>\n                <div ng-if="definitionSwaggerEditorTabCtrl.selectedReferenceIndex !== null" ng-switch on="definitionSwaggerEditorTabCtrl.references[definitionSwaggerEditorTabCtrl.selectedReferenceIndex].source">\n                    <custom-api-definition ng-switch-when="definitions"></custom-api-definition>\n                    <custom-api-parameter ng-switch-when="parameters"></custom-api-parameter>\n                    <custom-api-response ng-switch-when="responses"></custom-api-response>\n                </div>\n                <react-text-message-bar\n                    ng-if="definitionSwaggerEditorTabCtrl.hasNoOperations"\n                    type="definitionSwaggerEditorTabCtrl.messageBarType.info"\n                    message="definitionSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CreateOperationHint">\n                </react-text-message-bar>\n                <custom-api-tab-navigation\n                    previous-tab="definitionSwaggerEditorTabCtrl.previousTab"\n                    next-tab="definitionSwaggerEditorTabCtrl.nextTab">\n                </custom-api-tab-navigation>\n            </div>\n        </div>\n    </section>\n    <confirm-dialog\n        title="{{definitionSwaggerEditorTabCtrl.confirmDialog.title}}"\n        message="{{definitionSwaggerEditorTabCtrl.confirmDialog.message}}"\n        show="definitionSwaggerEditorTabCtrl.confirmDialog.show"\n        on-confirm="definitionSwaggerEditorTabCtrl.confirmDialog.onConfirm">\n    </confirm-dialog>\n</div>'},33829:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33830);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33831);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33832),this.bindings={title:"<",description:"<",learnMoreHyperlink:"<",addNewText:"<",onAddNew:"<",filterText:"=",items:"<",getItemText:"<",getItemStatus:"<",onDelete:"<",onMoveUp:"<",onMoveDown:"<",onItemClick:"<",selectedItemIndex:"=",isCollapsed:"="},this.controller=o.a,this.controllerAs="foldingListCtrl"}));r.a.component(n.a.components.foldingList,new c)},33830:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33606),o=i(13272);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.assetService=t,this.clientResources=i,this.loggingService=r,this.iconName=o.a,this.title=void 0,this.description=void 0,this.learnMoreHyperlink=void 0,this.addNewText=void 0,this.onAddNew=void 0,this.filterText=void 0,this.items=void 0,this.getItemText=void 0,this.getItemStatus=void 0,this.onDelete=void 0,this.onMoveUp=void 0,this.onMoveDown=void 0,this.onItemClick=void 0,this.selectedItemIndex=void 0,this.isCollapsed=void 0,this.commandsPerItem=void 0,this.$onInit=()=>{this.populateCommands()},this.onTabKeydown=(e,t)=>{switch(e.code){case"Enter":case"Space":this.onItemClick(t)}},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FoldingListCtrl"})}var t,i,r;return t=e,(i=[{key:"shouldDisplayCommands",get:function(){return!!this.onDelete||!!this.onMoveDown||!!this.onMoveDown}},{key:"populateCommands",value:function(){var e=this;if(this.commandsPerItem=new Map,this.shouldDisplayCommands)for(var t=function(){var t=e.items[i],n=[];e.onDelete&&n.push({text:e.clientResources.Manage.Apis.DeleteToolTip,iconUrl:"glyph-delete",click:()=>{e.onDelete(t),e.populateCommands()}}),0!==i&&e.onMoveUp&&n.push({text:e.clientResources.Manage.Apis.MoveUpToolTip,iconUrl:"glyph-arrowup",click:()=>{e.onMoveUp(t),e.populateCommands()}}),i!==r-1&&e.onMoveDown&&n.push({text:e.clientResources.Manage.Apis.MoveDownToolTip,iconUrl:"glyph-arrowdown",click:()=>{e.onMoveDown(t),e.populateCommands()}}),0!==n.length&&e.commandsPerItem.set(t,n)},i=0,r=this.items.length;i<r;i++)t()}},{key:"getCommands",value:function(e){return this.commandsPerItem.get(e)}},{key:"getIconUrl",value:function(e,t){return this.getItemStatus?Object(n.b)(this.getItemStatus(e,t),this.assetService):null}},{key:"getIconText",value:function(e,t){return this.getItemStatus?Object(n.b)(this.getItemStatus(e,t),this.assetService):null}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[r.a.services.assetService,r.a.services.clientResources,r.a.services.logging]},33831:function(e,t,i){e.exports=i.p+"static/media/foldingList.9deab296.less"},33832:function(e,t){e.exports='<div class="context-folding-list" title="{{foldingListCtrl.title}}">\n    <h1 class="title" ng-click="foldingListCtrl.isCollapsed = !foldingListCtrl.isCollapsed" role="heading" aria-expanded="{{!foldingListCtrl.isCollapsed}}">\n        <span class="folding-list-collapse c-glyph glyph-arrow" ng-if="foldingListCtrl.isCollapsed"></span>\n        <span class="folding-list-collapse c-glyph glyph-arrowdown" ng-if="!foldingListCtrl.isCollapsed"></span>\n        <span class="title">{{foldingListCtrl.title}} ({{foldingListCtrl.items ? foldingListCtrl.items.length : 0}})</span>\n    </h1>\n    <div ng-if="!foldingListCtrl.isCollapsed">\n        <p class="description">{{foldingListCtrl.description}}</p>\n        <a ng-if="foldingListCtrl.learnMoreHyperlink" class="c-hyperlink" target="_blank" href="{{foldingListCtrl.learnMoreHyperlink}}">{{foldingListCtrl.clientResources.Manage.CustomApi.LearnMore}}</a>\n        <ul>\n            <li class="list-item" ng-repeat="item in foldingListCtrl.items" title="{{foldingListCtrl.getItemText(item)}}">\n                <a ng-class="{\'selected\': foldingListCtrl.selectedItemIndex === $index}" ng-click="foldingListCtrl.onItemClick($index, item)">\n                    <img ng-if="foldingListCtrl.getIconUrl(item, $index)" class="item-status" ng-src="{{foldingListCtrl.getIconUrl(item, $index)}}" alt="{{foldingListCtrl.getIconText(item, $index)}}"/>\n                    <span class="index">{{$index+1}}</span>\n                    <span tabindex="0" class="item-text" ng-class="{\'commands\': foldingListCtrl.shouldDisplayCommands}" ng-keydown="foldingListCtrl.onTabKeydown($event, $index)">{{foldingListCtrl.getItemText(item)}}</span>\n                </a>\n                <list-commands class="command-item" ng-if="foldingListCtrl.shouldDisplayCommands" model="foldingListCtrl.getCommands(item)"></list-commands>\n            </li>\n        </ul>\n        <div class="list-item" ng-if="foldingListCtrl.addNewText" title="{{foldingListCtrl.addNewText}}">\n            <div ng-click="foldingListCtrl.onAddNew()" role="button">\n                <span class="index add-new c-glyph glyph-create"></span>\n                <span class="add-new-text">{{foldingListCtrl.addNewText}}</span>\n            </div>\n        </div>\n    </div>\n</div>'},33833:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33803);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33834);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.b,this.template=i(33835),this.controllerAs="importFromSamplePanelCtrl",this.bindings={model:"<"}}));r.a.component(n.a.components.importFromSamplePanel,new c)},33834:function(e,t,i){e.exports=i.p+"static/media/importFromSamplePanel.b0db3114.less"},33835:function(e,t){e.exports='<info-pane class="importFromSamplePanel"\n    pane-title="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label"\n    expanded="importFromSamplePanelCtrl.model.isVisible"\n    on-close="importFromSamplePanelCtrl.onClose()"\n    element-ids-to-focus-on-close="importFromSamplePanelCtrl.model.elementIdsToFocusOnClose"\n>\n    <div ng-if="importFromSamplePanelCtrl.isRequestPane">\n        \x3c!-- Verb fieldset, only for request pane --\x3e\n        <react-choice-group\n            class="importFromSamplePanel-choiceGroup"\n            options="importFromSamplePanelCtrl.verbChoiceGroupOptions"\n            label="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading"\n            direction="\'horizontal\'"\n            required="true"\n            selected-key="importFromSamplePanelCtrl.selectedVerbKey"\n            on-change="importFromSamplePanelCtrl.onVerbChoiceChanged"\n        ></react-choice-group>\n        \x3c!-- URL input, only for request pane --\x3e\n        <react-text-field\n            value="importFromSamplePanelCtrl.importSample.url"\n            description="importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Definition.UrlSample.Description"\n            label="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading"\n            required="true"\n            placeholder="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Url.Placeholder"\n            on-change="importFromSamplePanelCtrl.onUrlChange"\n            on-get-error-message="importFromSamplePanelCtrl.getErrorMessageForUrl"\n        ></react-text-field>\n    </div>\n    \x3c!-- Textarea for sample headers, visible in both sample request and response pane --\x3e\n    <react-text-field\n        class="importFromSamplePanel-textArea--multiline"\n        value="importFromSamplePanelCtrl.importSample.headers"\n        description="importFromSamplePanelCtrl.headerDescription"\n        label="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading"\n        multiline="true"\n        placeholder="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Headers.Placeholder"\n        rows="5"\n        on-change="importFromSamplePanelCtrl.onHeadersChange"\n        on-get-error-message="importFromSamplePanelCtrl.getErrorMessageForHeaders"\n    ></react-text-field>\n    \x3c!-- Textarea for sample body, visible in both sample request and response pane --\x3e\n    <react-text-field\n        class="importFromSamplePanel-textArea--multiline"\n        ng-if="importFromSamplePanelCtrl.bodyAllowed"\n        value="importFromSamplePanelCtrl.importSample.body"\n        delay-validation="true"\n        description="importFromSamplePanelCtrl.bodyDescription"\n        label="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading"\n        multiline="true"\n        placeholder="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Body.Placeholder"\n        rows="10"\n        on-change="importFromSamplePanelCtrl.onBodyChange"\n        on-get-error-message="importFromSamplePanelCtrl.getErrorMessageForBody"\n    ></react-text-field>\n\n    <div class="importFromSamplePanelCtrl-buttons">\n        <react-default-button\n            class="importFromSamplePanelCtrl-button"\n            primary="true"\n            on-click="importFromSamplePanelCtrl.handleImportClicked"\n            is-disabled="importFromSamplePanelCtrl.isImportButtonDisabled"\n            text="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Import.Label"\n        ></react-default-button>\n        <react-default-button\n            class="importFromSamplePanelCtrl-button"\n            on-click="importFromSamplePanelCtrl.closePane"\n            text="::importFromSamplePanelCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Close.Label"\n        ></react-default-button>\n    </div>\n</info-pane>'},33836:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33837);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33838);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(33839),this.controllerAs="importSectionCtrl"}));r.a.component(n.a.components.customApi.importSection,new c)},33837:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(33352),n=i(33353),o=i(33355),a=i(33437),s=i(33392),l=i(33327),c=i(33360),u=i(33356),d=i(33394),p=i(33358),h=i(19793);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f={swagger:"2.0",info:{title:"SOAP pass-through",description:"SOAP pass-through",version:"1.0"},host:"",basePath:"/",consumes:[],produces:[],paths:{"/SoapPassThrough":{post:{operationId:"SoapPassThrough",parameters:[{name:"body",in:"body",schema:{type:"object"}}],responses:{200:{description:"OK"}}}}},definitions:{},parameters:{},responses:{},securityDefinitions:{},security:[],tags:[]},v=function(){function e(t,i,l,d,p,h,m,g){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.apisClientLA=t,this.clientResources=i,this.customApiHelperService=l,this.fileReader=d,this.loggingService=p,this.swaggerEditorDataService=h,this.telemetryService=m,this.widgetUtilService=g,this.swaggerEditorData=void 0,this.wsdlServices=[],this.wsdlServiceOptions=[],this.importTypeOptions=[{key:r.a[r.a.Rest],text:this.clientResources.Manage.CustomApi.RightPane.Import.ApiType.Rest.Label},{key:r.a[r.a.Soap],text:this.clientResources.Manage.CustomApi.RightPane.Import.ApiType.Soap.Label}],this.restImportModeUIDetails={[u.b.OpenApiFile]:{importButtonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.ButtonAriaLabel,placeholder:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.PlaceHolder,textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.TextFieldAriaLabel,acceptedFileExtensions:[".json"],onImportFiles:e=>this.onImportFiles(e,this.onImportOpenApiFile)},[u.b.OpenApiUrl]:{buttonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.ButtonAriaLabel,placeholder:"https://",textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.TextFieldAriaLabel,onTextChanged:e=>this.onOpenApiUrlChanged(e),buttonText:this.clientResources.Common.Import,onButtonClick:e=>this.onImportOpenApiUrl(e)},[u.b.PostmanFile]:{importButtonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.ButtonAriaLabel,placeholder:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.PlaceHolder,textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.TextFieldAriaLabel,acceptedFileExtensions:[".json"],onImportFiles:e=>this.onImportFiles(e,this.onImportPostmanFile)}},this.restImportModeOptions=[{key:u.b.OpenApiFile,text:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerFile.Label},{key:u.b.OpenApiUrl,text:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.SwaggerUrl.Label},{key:u.b.PostmanFile,text:this.clientResources.Manage.CustomApi.RightPane.ImportSwagger.PostmanCollectionFile.Label}],this.soapImportModeUIDetails={[u.c.WsdlFile]:{importButtonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.File.ButtonAriaLabel,placeholder:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.File.PlaceHolder,textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.File.TextFieldAriaLabel,acceptedFileExtensions:[".wsdl"],onImportFiles:e=>this.onImportFiles(e,this.onImportWsdlFile)},[u.c.WsdlUrl]:{buttonAriaLabel:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.Url.ButtonAriaLabel,placeholder:"https://",textFieldAriaLabel:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.Url.TextFieldAriaLabel,onTextChanged:e=>this.onWsdlurlChanged(e),buttonText:this.clientResources.Common.Import,onButtonClick:e=>this.onImportWsdlUrl(e)}},this.soapImportModeOptions=[{key:u.c.WsdlFile,text:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.File.Label},{key:u.c.WsdlUrl,text:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.Url.Label}],this.soapOperationTypeDropdownOptions=[{key:r.b.SoapToRest,text:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.ImportMethod.Soap.To.Rest.Label},{key:r.b.SoapPassThrough,text:this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.ImportMethod.Soap.Label}],this.onImportFiles=(e,t)=>{var i=e&&e[0];i&&t(i)},this.onImportTypeChanged=(e,t)=>{this.dismissValidationError(),this.swaggerEditorData.apiLogicApps.properties.apiType=r.a[t.key]},this.onWsdlServiceOptionsChanged=(e,t)=>{this.dismissValidationError(),this.swaggerEditorData.uiDetails.importSectionUIDetails.selectedWsdlService=t.key,this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.service=this.wsdlServices.find(e=>e.qualifiedName===t.key),this.extractSwaggerFromWsdl()},this.onSoapOperationTypeChanged=(e,t)=>{this.dismissValidationError(),this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod=t.key,this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod===r.b.SoapPassThrough&&this.populateSoapPassthroughSwagger()},this.onRestImportModeChanged=(e,t)=>{this.dismissValidationError(),this.swaggerEditorData.uiDetails.importSectionUIDetails.selectedRestImportMode=t.key},this.onSoapImportModeChanged=(e,t)=>{this.dismissValidationError(),this.swaggerEditorData.uiDetails.importSectionUIDetails.selectedSoapImportMode=t.key},this.onOpenApiUrlChanged=e=>{this.swaggerEditorData.swaggerUrl=e},this.onImportOpenApiUrl=e=>{this.dismissValidationError(),this.swaggerEditorData.spinner.show=!0,this.swaggerEditorData.statusAlert.options.show(n.a.Progress,this.clientResources.Manage.CustomApi.DownloadingSwagger);var t=this.loggingService.profileStart(o.a.myCustomApiInlineImportSwaggerUrlStart);this.customApiHelperService.importSwaggerUrl(e,this.importFromSwaggerUrlCompletion).then(()=>{this.loggingService.profileEndWithSuccess(t,o.a.myCustomApiInlineImportSwaggerUrlEnd)}).catch(e=>{this.setValidationError(Object(s.e)(e)),this.loggingService.profileEnd(t,o.a.myCustomApiInlineImportSwaggerUrlEnd,Object(s.b)(e),e)}).finally(()=>{this.swaggerEditorData.spinner.show=!1})},this.importFromSwaggerUrlCompletion=(e,t)=>{this.swaggerEditorData.importFormat=u.a.swaggerUrl,this.swaggerEditorData.statusAlert.options.hide(),this.updateSwaggerEditorData(e,t)},this.onWsdlurlChanged=e=>{this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url=e},this.onImportWsdlUrl=e=>{this.dismissValidationError(),e&&(this.resetWsdlImportState(),this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url=e,this.telemetryService.tagEvent(a.a.WsdlUrlUploaded),this.listWsdlServices(),this.swaggerEditorData.importFormat=u.a.wsdlUrl)},this.onImportPostmanFile=e=>{this.dismissValidationError(),this.telemetryService.tagEvent(a.a.PostmanCollectionUploaded);var t=this.loggingService.profileStart(o.a.myCustomApiInlineImportPostmanStart);this.customApiHelperService.importPostmanCollection(e,this.importFromPostmanCompletion).then(()=>{this.loggingService.profileEndWithSuccess(t,o.a.myCustomApiInlineImportPostmanEnd)}).catch(e=>{this.setValidationError(Object(s.e)(e)),this.loggingService.profileEnd(t,o.a.myCustomApiInlineImportPostmanEnd,Object(s.b)(e),e)})},this.importFromPostmanCompletion=(e,t)=>{this.swaggerEditorData.importFormat=u.a.postman,this.updateSwaggerEditorData(e,t)},this.onImportOpenApiFile=e=>{this.dismissValidationError(),this.telemetryService.tagEvent(a.a.SwaggerFileUploaded);var t=this.loggingService.profileStart(o.a.myCustomApiInlineImportSwaggerFileStart);this.customApiHelperService.importSwaggerFile(e,this.importFromSwaggerFileCompletion).then(()=>{this.loggingService.profileEndWithSuccess(t,o.a.myCustomApiInlineImportSwaggerFileEnd)}).catch(e=>{this.setValidationError(Object(s.e)(e)),this.loggingService.profileEnd(t,o.a.myCustomApiInlineImportSwaggerFileEnd,Object(s.b)(e),e)})},this.importFromSwaggerFileCompletion=(e,t)=>{this.swaggerEditorData.importFormat=u.a.swaggerFile,this.updateSwaggerEditorData(e,t)},this.onImportWsdlFile=e=>{this.telemetryService.tagEvent(a.a.WsdlFileUploaded),this.dismissValidationError(),Object(c.k)(e)>=2?this.setValidationError(this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.MaxWsdlFileSizeExceeded):(this.resetWsdlImportState(),this.fileReader(e).asText().then(t=>{this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.content=t,this.swaggerEditorData.uiDetails.importSectionUIDetails.wsdlFileName=e.name,this.swaggerEditorData.importFormat=u.a.wsdlFile,this.listWsdlServices(t)}))},this.dismissValidationError=()=>{this.swaggerEditorData.validationError=null},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ImportSectionCtrl"}),this.telemetryService.tagEvent(a.a.CustomApiGeneralTabVisited),this.swaggerEditorData=this.swaggerEditorDataService.SwaggerEditorData}var t,i,l;return t=e,(i=[{key:"selectedImportTypeKey",get:function(){return r.a[this.swaggerEditorData.apiLogicApps.properties.apiType]}},{key:"isSoap",get:function(){return this.swaggerEditorData.apiLogicApps.properties.apiType===r.a.Soap}},{key:"isSoapToRestSelected",get:function(){return this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod===r.b.SoapToRest}},{key:"isOpenApiUrlImportMode",get:function(){return this.swaggerEditorData.uiDetails.importSectionUIDetails.selectedRestImportMode===u.b.OpenApiUrl}},{key:"isWsdlUrlImportMode",get:function(){return this.swaggerEditorData.uiDetails.importSectionUIDetails.selectedSoapImportMode===u.c.WsdlUrl}},{key:"selectedRestImportModeUIDetails",get:function(){return this.restImportModeUIDetails[this.swaggerEditorData.uiDetails.importSectionUIDetails.selectedRestImportMode]}},{key:"selectedSoapImportModeUIDetails",get:function(){return this.soapImportModeUIDetails[this.swaggerEditorData.uiDetails.importSectionUIDetails.selectedSoapImportMode]}},{key:"showWsdlServices",get:function(){var e;return this.isSoapToRestSelected&&(null===(e=this.wsdlServiceOptions)||void 0===e?void 0:e.length)>1}},{key:"populateSoapPassthroughSwagger",value:function(){this.resetWsdlImportState(),this.swaggerEditorDataService.swagger=Object(p.a)(f),this.swaggerEditorDataService.hasSecurityDefinitionBeenModified&&(this.swaggerEditorDataService.securityTabDetails.isLocked=!1)}},{key:"updateSwaggerEditorData",value:function(e,t){this.swaggerEditorData.swaggerFileName=e,this.swaggerEditorDataService.swagger=t,this.swaggerEditorDataService.hasSecurityDefinitionBeenModified&&(this.swaggerEditorDataService.securityTabDetails.isLocked=!1),this.swaggerEditorData.editMode||this.swaggerEditorDataService.updateDisplayName()}},{key:"setValidationError",value:function(e){this.swaggerEditorData.validationError=new h.a(d.c.customApiValidationError,e)}},{key:"listWsdlServices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.loggingService.profileStart(o.a.WsdlServicesLoadStart),i={url:this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url,content:e};return this.swaggerEditorData.statusAlert.options.show(n.a.Progress,this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.GettingServices),this.apisClientLA.listWsdlServices(this.widgetUtilService.isWidgetPage()?this.widgetUtilService.widgetInfo.logicAppsSettings:void 0,this.swaggerEditorData.apiLogicApps.location,i).then(e=>this.populateWsdlServicesAndExtractSwagger(e)).then(()=>{this.loggingService.profileEndWithSuccess(t,o.a.WsdlServicesLoadEnd)}).catch(e=>{var i=e&&400===e.status?s.a.Warning:Object(s.b)(e);this.loggingService.profileEnd(t,o.a.WsdlServicesLoadEnd,i,e);var r=Object(s.e)(e,this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.ParsingFailed);this.setValidationError(r)})}},{key:"extractSwaggerFromWsdl",value:function(){if(this.dismissValidationError(),this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url||this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.content){var e={url:this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url,content:this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.content,service:this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.service,importMethod:Object(c.h)(r.b,this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod)};this.swaggerEditorData.spinner.show=!0,this.swaggerEditorData.statusAlert.options.show(n.a.Progress,this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.ExtractSwagger);var t=this.loggingService.profileStart(o.a.ExtractSwaggerFromWsdlStart);this.apisClientLA.extractSwaggerFromWsdl(this.widgetUtilService.isWidgetPage()?this.widgetUtilService.widgetInfo.logicAppsSettings:void 0,this.swaggerEditorData.apiLogicApps.location,e).then(e=>{this.swaggerEditorDataService.swagger=Object(p.a)(e),this.swaggerEditorDataService.hasSecurityDefinitionBeenModified&&(this.swaggerEditorDataService.securityTabDetails.isLocked=!1)}).then(()=>{this.loggingService.profileEndWithSuccess(t,o.a.ExtractSwaggerFromWsdlEnd),this.swaggerEditorData.statusAlert.options.hide()}).catch(e=>{var i=e&&400===e.status?s.a.Warning:Object(s.b)(e);this.loggingService.profileEnd(t,o.a.WsdlServicesLoadEnd,i,e);var r=Object(s.e)(e,this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.ParsingFailed);this.setValidationError(r)}).finally(()=>{this.swaggerEditorData.spinner.show=!1})}else this.setValidationError(this.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.Input.Missing)}},{key:"populateWsdlServicesAndExtractSwagger",value:function(e){if(this.wsdlServiceOptions=[],this.wsdlServices=[],null!=e&&e.length){if(this.wsdlServices=e,1===e.length)return this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.service=e[0],this.extractSwaggerFromWsdl();this.wsdlServiceOptions=[],this.wsdlServices.forEach(e=>{e.qualifiedName=e.qualifiedName.substring(e.qualifiedName.indexOf("}")+1),this.wsdlServiceOptions.push({key:e.qualifiedName,text:e.qualifiedName})}),this.swaggerEditorData.statusAlert.options.hide()}}},{key:"resetWsdlImportState",value:function(){this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url=void 0,this.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.content=void 0,this.swaggerEditorData.uiDetails.importSectionUIDetails.wsdlFileName=void 0}}])&&m(t.prototype,i),l&&m(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[l.a.services.apisClientLA,l.a.services.clientResources,l.a.services.customApiHelper,l.a.services.fileReaderHelperService,l.a.services.logging,l.a.services.swaggerEditorData,l.a.services.telemetry,l.a.services.widgetUtilService]},33838:function(e,t,i){e.exports=i.p+"static/media/importSection.689add68.less"},33839:function(e,t){e.exports='<div class="section-custom-api-import">\n    <div class="column medium-3 left-pane">\n        <h1 class="title">{{::importSectionCtrl.clientResources.Manage.CustomApi.LeftPane.ImportSwagger.Heading}}</h1>\n        <p>\n            {{::importSectionCtrl.clientResources.Manage.CustomApi.LeftPane.General.Import.Description}}\n            <learn-more\n                resource="\'Manage.CustomApi.General.LeftPane.Hyperlink\'"\n                link-aria-label="::importSectionCtrl.clientResources.Manage.CustomApi.LeftPane.ImportSwagger.LearnMoreAriaLabel"\n            ></learn-more>\n        </p>\n    </div>\n    <div class="column medium-8 medium-offset-1 right-pane">\n        <h2 class="pane-title">\n            {{::importSectionCtrl.clientResources.Manage.CustomApi.RightPane.Import.Heading}}\n        </h2>\n        <div class="pane-content">\n            <div class="pane-field">\n                <react-choice-group\n                    options="::importSectionCtrl.importTypeOptions"\n                    label="::importSectionCtrl.clientResources.Manage.CustomApi.RightPane.Import.ApiType.Label"\n                    direction="\'horizontal\'"\n                    selected-key="importSectionCtrl.selectedImportTypeKey"\n                    on-change="importSectionCtrl.onImportTypeChanged"\n                ></react-choice-group>\n            </div>\n            \x3c!-- REST --\x3e\n            <div ng-if="!importSectionCtrl.isSoap">\n                <div class="pane-field">\n                    <react-choice-group\n                        options="importSectionCtrl.restImportModeOptions"\n                        label="::importSectionCtrl.clientResources.Common.ImportMode"\n                        selected-key="importSectionCtrl.swaggerEditorData.uiDetails.importSectionUIDetails.selectedRestImportMode"\n                        on-change="importSectionCtrl.onRestImportModeChanged"\n                    ></react-choice-group>\n                </div>\n                <div class="pane-field">\n                    <react-file-import\n                        ng-if="!importSectionCtrl.isOpenApiUrlImportMode"\n                        on-import-files="importSectionCtrl.selectedRestImportModeUIDetails.onImportFiles"\n                        placeholder="importSectionCtrl.selectedRestImportModeUIDetails.placeholder"\n                        value="importSectionCtrl.swaggerEditorData.swaggerFileName"\n                        accepted-file-extensions="importSectionCtrl.selectedRestImportModeUIDetails.acceptedFileExtensions"\n                        import-button-aria-label="importSectionCtrl.selectedRestImportModeUIDetails.importButtonAriaLabel"\n                        text-field-aria-label="importSectionCtrl.selectedRestImportModeUIDetails.textFieldAriaLabel"\n                    ></react-file-import>\n                    <react-text-field-with-inline-button\n                        ng-if="importSectionCtrl.isOpenApiUrlImportMode"\n                        value="importSectionCtrl.swaggerEditorData.swaggerUrl"\n                        placeholder="importSectionCtrl.selectedRestImportModeUIDetails.placeholder"\n                        text-field-aria-label="importSectionCtrl.selectedRestImportModeUIDetails.textFieldAriaLabel"\n                        on-text-changed="importSectionCtrl.selectedRestImportModeUIDetails.onTextChanged"\n                        button-text="importSectionCtrl.selectedRestImportModeUIDetails.buttonText"\n                        button-disabled="!importSectionCtrl.swaggerEditorData.swaggerUrl"\n                        button-aria-label="importSectionCtrl.selectedRestImportModeUIDetails.buttonAriaLabel"\n                        on-button-click="importSectionCtrl.selectedRestImportModeUIDetails.onButtonClick"\n                    ></react-text-field-with-inline-button>\n                </div>\n            </div>\n            \x3c!-- SOAP --\x3e\n            <div ng-if="importSectionCtrl.isSoap">\n                <div class="pane-field">\n                    <react-dropdown-swagger-style\n                        label="::importSectionCtrl.clientResources.Manage.CustomApi.RightPane.Import.SoapOperationType.Label"\n                        options="::importSectionCtrl.soapOperationTypeDropdownOptions"\n                        selected-key="importSectionCtrl.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.importMethod"\n                        place-holder="::importSectionCtrl.clientResources.Manage.CustomApi.RightPane.Import.SOAPCallmode.Dropdown.Placeholder"\n                        on-change="importSectionCtrl.onSoapOperationTypeChanged"\n                    ></react-dropdown-swagger-style>\n                </div>\n                <div ng-if="importSectionCtrl.isSoapToRestSelected">\n                    <div class="pane-field">\n                        <react-choice-group\n                            options="importSectionCtrl.soapImportModeOptions"\n                            label="::importSectionCtrl.clientResources.Common.ImportMode"\n                            selected-key="importSectionCtrl.swaggerEditorData.uiDetails.importSectionUIDetails.selectedSoapImportMode"\n                            on-change="importSectionCtrl.onSoapImportModeChanged"\n                        ></react-choice-group>\n                    </div>\n                    <div class="pane-field">\n                        <react-file-import\n                            ng-if="!importSectionCtrl.isWsdlUrlImportMode"\n                            on-import-files="importSectionCtrl.selectedSoapImportModeUIDetails.onImportFiles"\n                            placeholder="importSectionCtrl.selectedSoapImportModeUIDetails.placeholder"\n                            value="importSectionCtrl.swaggerEditorData.uiDetails.importSectionUIDetails.wsdlFileName"\n                            accepted-file-extensions="importSectionCtrl.selectedSoapImportModeUIDetails.acceptedFileExtensions"\n                            import-button-aria-label="importSectionCtrl.selectedSoapImportModeUIDetails.importButtonAriaLabel"\n                            text-field-aria-label="importSectionCtrl.selectedSoapImportModeUIDetails.textFieldAriaLabel"\n                        ></react-file-import>\n                        <react-text-field-with-inline-button\n                            ng-if="importSectionCtrl.isWsdlUrlImportMode"\n                            value="importSectionCtrl.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url"\n                            placeholder="importSectionCtrl.selectedSoapImportModeUIDetails.placeholder"\n                            text-field-aria-label="importSectionCtrl.selectedSoapImportModeUIDetails.textFieldAriaLabel"\n                            on-text-changed="importSectionCtrl.selectedSoapImportModeUIDetails.onTextChanged"\n                            button-text="importSectionCtrl.selectedSoapImportModeUIDetails.buttonText"\n                            button-disabled="!importSectionCtrl.swaggerEditorData.apiLogicApps.properties.wsdlDefinition.url"\n                            button-aria-label="importSectionCtrl.selectedSoapImportModeUIDetails.buttonAriaLabel"\n                            on-button-click="importSectionCtrl.selectedSoapImportModeUIDetails.onButtonClick"\n                        ></react-text-field-with-inline-button>\n                    </div>\n                </div>\n                <div class="pane-field" ng-if="importSectionCtrl.showWsdlServices">\n                    <react-dropdown-swagger-style\n                        label="::importSectionCtrl.clientResources.Manage.CustomApi.RightPane.Import.Wsdl.Service.Label"\n                        options="importSectionCtrl.wsdlServiceOptions"\n                        selected-key="importSectionCtrl.swaggerEditorData.uiDetails.importSectionUIDetails.selectedWsdlService"\n                        placeholder="importSectionCtrl.clientResources.Manage.CustomApi.RightPane.Import.WSDLService.Dropdown.Placeholder"\n                        on-change="importSectionCtrl.onWsdlServiceOptionsChanged"\n                    ></react-dropdown-swagger-style>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},33840:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33841);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33842);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33843),this.bindings={parameter:"=",schemaProperty:"=",operationItems:"<"},this.controller=o.a,this.controllerAs="parameterDropdownEditorCtrl"}));r.a.component(n.a.components.parameterDropdownEditor,new c)},33841:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(33327),n=i(33360),o=i(33359),a=i(33804),s=i(33363),l=i(33357),c=i(33801),u=i(12330),d=i(33398);function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var m=function(e){return e.disabled="disabled",e.static="static",e.dynamic="dynamic",e}(m||{}),g=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.clientResources=i,this.swaggerEditorDataService=r,this.telemetryService=n,this.parameter=void 0,this.schemaProperty=void 0,this.operationItems=void 0,this.useCustomValueDropdownOption=void 0,this.dropdownTypeOptions=void 0,this.selectedDropdownType=m.disabled,this.dropdownTypeOptionsLabelLink=void 0,this.enumString="",this.currentOperationParameterNames=[],this.dynamicValueOperationIndex=-1,this.dynamicValueOperationOptions=[],this.valuePathIndex=-1,this.valuePathOptions=[],this.valueTitleIndex=-1,this.valueTitleOptions=[],this.dynamicValueParameters=[],this.$onInit=()=>{this.dynamicValueOperationOptions=this.swaggerEditorDataService.swagger.actions.filter(e=>"get"===e.method).map(e=>e.operation),this.initializeDropdownType(),this.$scope.$watch(()=>this.enumString,()=>{this.updateEnum()}),this.$scope.$watch(()=>this.dynamicValueOperationIndex,(e,t)=>{e!==t&&this.onDynamicValueOperationChanged()}),this.$scope.$watch(()=>this.valuePathIndex,(e,t)=>{e!==t&&(this.populateValueTitleOptions(),this.valuePathOutputParameter&&this.saveDynamicValues())}),this.$scope.$watch(()=>this.valueTitleIndex,(e,t)=>{e!==t&&this.valueTitleOutputParameter&&this.saveDynamicValues()})},this.onDropdownTypeChange=(e,t)=>{this.selectedDropdownType=t.key,this.updateDropdownType()},this.telemetryService.tagEvent("NgCtrl.constructor",void 0,{component:"ParameterDropdownEditorCtrl"}),this.useCustomValueDropdownOption=this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueParameter.UseCustomValue,this.dropdownTypeOptions=[{key:m.disabled,text:this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Disabled},{key:m.static,text:this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Static},{key:m.dynamic,text:this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Dynamic}],this.dropdownTypeOptionsLabelLink={href:this.clientResources.Manage.CustomApi.Definition.RightPane.DropdownType.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.LearnMoreAriaLabel,telemetryData:{name:"ParameterDropdownEditor.DropdownType.LearnMoreClicked"}}}var t,i,r;return t=e,(i=[{key:"initializeDropdownType",value:function(){this.dynamicValues?this.selectedDropdownType=m.dynamic:this.isSchemaProperty&&this.schemaProperty.enum||!this.isSchemaProperty&&this.parameter.enum?this.selectedDropdownType=m.static:this.selectedDropdownType=m.disabled,this.updateDropdownType(),this.telemetryService.tagEvent(d.a.CustomApiParameterDropdownTypeInitialized,{selectedDropdownType:this.selectedDropdownType})}},{key:"isSchemaProperty",get:function(){return Object(u.a)(this.parameter)&&!Object(u.a)(this.schemaProperty)}},{key:"operationDropdownEnabled",get:function(){return this.swaggerEditorDataService.swagger.actions.length>1}},{key:"isStaticDropdown",get:function(){return this.selectedDropdownType===m.static}},{key:"isDynamicDropdown",get:function(){return this.selectedDropdownType===m.dynamic}},{key:"dynamicValueOperation",get:function(){return this.dynamicValueOperationOptions?this.dynamicValueOperationOptions[this.dynamicValueOperationIndex]:null}},{key:"valuePathOutputParameter",get:function(){return this.valuePathOptions[this.valuePathIndex]}},{key:"valueTitleOutputParameter",get:function(){return this.valueTitleOptions[this.valueTitleIndex]}},{key:"dynamicValues",get:function(){return this.isSchemaProperty?this.schemaProperty.dynamicValues:this.parameter[o.i.DynamicValues]}},{key:"updateDropdownType",value:function(){switch(this.telemetryService.tagEvent(d.a.CustomApiParameterDropdownTypeChanged,{selectedDropdownType:this.selectedDropdownType}),this.selectedDropdownType){case m.static:this.clearDynamicValues(),this.enumString=this.getEnumString();break;case m.dynamic:this.clearEnum(),this.initializeDynamicValueDropdowns();break;case m.disabled:default:this.clearDynamicValues(),this.clearEnum()}}},{key:"updateEnum",value:function(){n.p(this.enumString)?this.clearEnum():this.setEnum(this.splitEnumStringOnCommas(this.enumString))}},{key:"onDynamicValueOperationChanged",value:function(){if(this.dynamicValueOperation){var e=l.u(this.dynamicValueOperation.parameters,this.swaggerEditorDataService.swagger);this.dynamicValueParameters=e.filter(e=>e.in!==a.c.body).map(e=>e).filter(e=>e.required).map(e=>({parameter:e,customValue:Object(u.a)(e.default)?"":e.default,useCustomValue:this.currentOperationParameterNames.length<=1,referencedParameterName:void 0}));var t=this.dynamicValueOperation.responses.filter(e=>"200"===e.name)[0]||this.dynamicValueOperation.responses.filter(e=>"default"===e.name)[0];if(t&&t.item){var i;i=l.G(t.item)?l.l(this.swaggerEditorDataService.swagger,t.item.$ref):t;var r=s.g(this.swaggerEditorDataService.swagger,i.item.schema),n=s.c(r.schema);this.valuePathOptions=n.filter(e=>e.isInsideArray),this.valuePathIndex=-1,this.valueTitleIndex=-1}}}},{key:"populateValueTitleOptions",value:function(){this.valueTitleOptions=this.valuePathOutputParameter?this.valuePathOptions.filter(e=>e.parentArray===this.valuePathOutputParameter.parentArray):[],this.valueTitleIndex=-1}},{key:"initializeDynamicValueDropdowns",value:function(){var e=this;if(this.updateParameterNamesForCurrentOperations(),this.dynamicValueParameters=[],this.dynamicValueOperationIndex=-1,this.valuePathIndex=-1,this.valueTitleIndex=-1,this.dynamicValues&&this.dynamicValues[o.d.valuePath]&&this.dynamicValues.operationId&&(this.dynamicValueOperationIndex=this.dynamicValueOperationOptions.map(e=>e.operationId).indexOf(this.dynamicValues.operationId),!(this.dynamicValueOperationIndex<0)&&(this.onDynamicValueOperationChanged(),this.valuePathIndex=this.valuePathOptions.filter(e=>(e.parentArray?e.parentArray.replace(/\./g,"/"):e.parentArray)===this.dynamicValues[o.d.valueCollection]).map(e=>e.name.replace(/\./g,"/")).indexOf(this.dynamicValues[o.d.valuePath]),this.populateValueTitleOptions(),this.dynamicValues[o.d.valueTitle]&&(this.valueTitleIndex=this.valueTitleOptions.map(e=>e.name.replace(/\./g,"/")).indexOf(this.dynamicValues[o.d.valueTitle])),this.dynamicValues.parameters))){var t=function(t){var i=e.dynamicValueParameters.filter(e=>e.parameter.name===t)[0];if(!i)return 1;"string"==typeof e.dynamicValues.parameters[t]?(i.useCustomValue=!0,i.customValue=e.dynamicValues.parameters[t]):e.currentOperationParameterNames.length>1?(i.useCustomValue=!1,i.referencedParameterName=e.dynamicValues.parameters[t].parameter):(i.useCustomValue=!0,i.customValue="")};for(var i in this.dynamicValues.parameters)if(t(i))break}}},{key:"updateParameterNamesForCurrentOperations",value:function(){var e;this.currentOperationParameterNames=[],this.operationItems.forEach(t=>{var i=this.getParameterNamesInOperation(t);e=i.filter(t=>Object(u.a)(e)||-1!==e.indexOf(t))}),e.forEach(e=>this.currentOperationParameterNames.push(e)),this.currentOperationParameterNames.push(this.useCustomValueDropdownOption)}},{key:"getParameterNamesInOperation",value:function(e){var t=l.u(e.operation.parameters,this.swaggerEditorDataService.swagger);if(!Array.isArray(t))return[];var i=t.filter(e=>e.in!==a.c.body).map(e=>e.name),r=t.filter(e=>e.in===a.c.body)[0];if(r){var o=s.g(this.swaggerEditorDataService.swagger,r.schema),c=s.c(o.schema).map(e=>e.name);i=i.concat(c)}return n.f(i)}},{key:"saveDynamicValues",value:function(){if(this.dynamicValueOperation){var e={};if(Array.isArray(this.dynamicValueParameters)&&this.dynamicValueParameters.forEach(t=>{if(t.referencedParameterName===this.useCustomValueDropdownOption&&(t.useCustomValue=!0,t.referencedParameterName=null),t.useCustomValue){if(n.p(t.customValue))return;e[t.parameter.name]=t.customValue}else{if(n.p(t.referencedParameterName))return;var i={parameter:t.referencedParameterName};e[t.parameter.name]=i}}),this.valuePathOutputParameter){var t={operationId:this.dynamicValueOperation.operationId,"value-path":this.valuePathOutputParameter.name.replace(/\./g,"/")},i=this.valuePathOutputParameter.parentArray;i&&(t[o.d.valueCollection]=i.replace(/\./g,"/"));var r=this.valueTitleOutputParameter?this.valueTitleOutputParameter.name.replace(/\./g,"/"):null;r&&(t[o.d.valueTitle]=r),n.n(e)||(t.parameters=e),this.setDynamicValues(t)}}}},{key:"splitEnumStringOnCommas",value:function(e){var t=[],i=!1,r=!1,o="";for(var a of e)r||"\\"!==a?(r?o+=a:i?'"'===a?(t.push(o.trim()),o="",i=!1):o+=a:","!==a||n.p(o)?'"'===a?i=!0:","!==a&&(o+=a):(t.push(o.trim()),o=""),r=!1):r=!0;return!i&&o.trim().length>0&&t.push(o.trim()),t}},{key:"surroundStringWithQuotes",value:function(e){var t=c.d(String(e));return"integer"===t||"number"===t||"boolean"===t?"".concat(e):'"'.concat(e,'"')}},{key:"getUniqueOutputParameterName",value:function(e){return e.parentArray?"".concat(e.parentArray,"[").concat(e.name,"]"):e.name}},{key:"setEnum",value:function(e){if(this.isSchemaProperty){var t=[];e.forEach(e=>{t.push({displayName:e,value:c.e(e,c.d(e))})}),this.schemaProperty.enum=t}else{var i=[];e.forEach(e=>{i.push(c.e(e,c.d(e)))}),this.parameter.enum=i}}},{key:"getEnumString",value:function(){return this.isSchemaProperty?Array.isArray(this.schemaProperty.enum)?this.schemaProperty.enum.map(e=>this.surroundStringWithQuotes(e.value)).join(", ").trim():"":Array.isArray(this.parameter.enum)?this.parameter.enum.map(e=>this.surroundStringWithQuotes(e)).join(", ").trim():""}},{key:"clearEnum",value:function(){this.isSchemaProperty?delete this.schemaProperty.enum:delete this.parameter.enum}},{key:"clearDynamicValues",value:function(){this.isSchemaProperty?delete this.schemaProperty.dynamicValues:delete this.parameter[o.i.DynamicValues]}},{key:"setDynamicValues",value:function(e){this.isSchemaProperty?this.schemaProperty.dynamicValues=e:this.parameter[o.i.DynamicValues]=e}}])&&p(t.prototype,i),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.$inject=[r.a.services.$scope,r.a.services.clientResources,r.a.services.swaggerEditorData,r.a.services.telemetry]},33842:function(e,t,i){e.exports=i.p+"static/media/parameterDropdownEditor.010d3cab.less"},33843:function(e,t){e.exports='<div class="parameter-dropdown-editor-container">\n    <div class="pane-field">\n        <react-choice-group-with-link\n            options="::parameterDropdownEditorCtrl.dropdownTypeOptions"\n            label="::parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DropdownType.Label"\n            label-link="::parameterDropdownEditorCtrl.dropdownTypeOptionsLabelLink"\n            direction="\'horizontal\'"\n            selected-key="parameterDropdownEditorCtrl.selectedDropdownType"\n            on-change="parameterDropdownEditorCtrl.onDropdownTypeChange"\n        ></react-choice-group-with-link>\n    </div>\n    \x3c!-- Dropdown type is an enum --\x3e\n    <div ng-if="parameterDropdownEditorCtrl.isStaticDropdown">\n        <div class="pane-field">\n            <label class="pane-field-label" for="parameterDropdownEditor-enumValues" >{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.EnumValues.Label}}</label>\n            <input class="c-text-field" id="parameterDropdownEditor-enumValues" type="text" ng-model="parameterDropdownEditorCtrl.enumString"\n                placeholder="{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.EnumValues.Placeholder}}" />\n        </div>\n    </div>\n    \x3c!-- Dropdown type is dynamic value --\x3e\n    <div ng-if="parameterDropdownEditorCtrl.isDynamicDropdown">\n        <div class="pane-field">\n            \x3c!-- Operation ID --\x3e\n            <div class="pane-field">\n                <label class="pane-field-label" for="parameterDropdownEditor-operationId">{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.OperationId.Label}} <span class="context-required-text">*</span></label>\n                <div class="c-select">\n                    <select\n                        id="parameterDropdownEditor-operationId"\n                        ng-disabled="!parameterDropdownEditorCtrl.operationDropdownEnabled"\n                        ng-model="parameterDropdownEditorCtrl.dynamicValueOperationIndex"\n                        ng-options="parameterDropdownEditorCtrl.dynamicValueOperationOptions.indexOf(operation) as operation.operationId for operation in parameterDropdownEditorCtrl.dynamicValueOperationOptions">\n                        <option disabled selected value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.OperationId.Placeholder}}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Dynamic value parameters --\x3e\n            <div class="pane-field" ng-repeat="dynamicValueParameter in parameterDropdownEditorCtrl.dynamicValueParameters">\n                <label class="pane-field-label" for="{{dynamicValueParameter.useCustomValue ? (\'parameterDropdownEditor-dynamicValueParameterCustomValue\' + $index) : (\'parameterDropdownEditor-dynamicValueParameter\' + $index)}}">\n                    {{dynamicValueParameter.parameter.name}} <span class="context-required-text" ng-if="dynamicValueParameter.parameter.required">*</span>\n                </label>\n                <div class="input-with-image-container" ng-if="dynamicValueParameter.useCustomValue">\n                    <input id="{{\'parameterDropdownEditor-dynamicValueParameterCustomValue\' + $index}}" class="c-text-field" type="text" ng-model="dynamicValueParameter.customValue" ng-change="parameterDropdownEditorCtrl.saveDynamicValues()" />\n                    \x3c!-- Do not give user the option to use the dropdown if there are no options in the dropdown (other than the useCustomValue option) --\x3e\n                    <span ng-if="parameterDropdownEditorCtrl.currentOperationParameterNames.length > 1" ng-click="dynamicValueParameter.useCustomValue = false" class="c-glyph glyph-arrowdown"></span>\n                </div>\n                <div class="c-select" ng-if="!dynamicValueParameter.useCustomValue">\n                    <select\n                        id="{{\'parameterDropdownEditor-dynamicValueParameter\' + $index}}"\n                        ng-disabled="!parameterDropdownEditorCtrl.dynamicValueOperation"\n                        ng-model="dynamicValueParameter.referencedParameterName"\n                        ng-change="parameterDropdownEditorCtrl.saveDynamicValues()"\n                        ng-options="parameterName for parameterName in parameterDropdownEditorCtrl.currentOperationParameterNames">\n                        <option disabled selected value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueParameter.Placeholder}}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Value path --\x3e\n            <div class="pane-field">\n                <label class="pane-field-label" for="parameterDropdownEditor-valuePath">{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValue.Label}} <span class="context-required-text">*</span></label>\n                <div class="c-select">\n                    <select\n                        id="parameterDropdownEditor-valuePath"\n                        ng-disabled="!parameterDropdownEditorCtrl.dynamicValueOperation"\n                        ng-model="parameterDropdownEditorCtrl.valuePathIndex"\n                        ng-options="parameterDropdownEditorCtrl.valuePathOptions.indexOf(outputParameter) as parameterDropdownEditorCtrl.getUniqueOutputParameterName(outputParameter) for outputParameter in parameterDropdownEditorCtrl.valuePathOptions">\n                        <option disabled selected value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValue.Placeholder}}</option>\n                    </select>\n                </div>\n            </div>\n            \x3c!-- Value title --\x3e\n            <div class="pane-field">\n                <label class="pane-field-label" for="parameterDropdownEditor-valueTitle">{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueDisplayName.Label}}</label>\n                <div class="c-select">\n                    <select\n                        id="parameterDropdownEditor-valueTitle"\n                        ng-disabled="!parameterDropdownEditorCtrl.valuePathOutputParameter"\n                        ng-model="parameterDropdownEditorCtrl.valueTitleIndex"\n                        ng-options="parameterDropdownEditorCtrl.valueTitleOptions.indexOf(outputParameter) as parameterDropdownEditorCtrl.getUniqueOutputParameterName(outputParameter) for outputParameter in parameterDropdownEditorCtrl.valueTitleOptions">\n                        <option disabled selected value>{{parameterDropdownEditorCtrl.clientResources.Manage.CustomApi.ParameterDropdownEditor.DynamicValueDisplayName.Placeholder}}</option>\n                    </select>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},33844:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33845);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33848),this.controller=o.a,this.controllerAs="securitySwaggerEditorTabCtrl"}));n.a.component(r.a.components.customApi.securityTab,new c)},33845:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var r=i(33352),n=i(33327),o=i(33624),a=i(15523),s=i(13272),l=i(13240),c=i(33817),u=i(11891),d=i(14868),p=i(13016),h=i(17914),m=i(33846),g=i(33847);function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b="query",y="header",w=function(){function e(t,i,r,n,c,u,m){var g,f,v=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$timeout=i,this.clientResources=r,this.securityDetailsValidationService=n,this.swaggerEditorDataService=c,this.telemetryService=u,this.widgetUtilService=m,this.iconName=s.a,this.messageBarType=p.c,this.authTypeDropdownId="securitySwaggerEditor-authTypeDropdown-".concat(Object(a.a)()),this.editButtonId="securitySwaggerEditor-editAuthTypeButton-".concat(Object(a.a)()),this.identityTypeDropdownId="securitySwaggerEditorTab-identityProvider",this.swaggerEditorData=void 0,this.apiKeyNameValidationResults=void 0,this.apiKeyLabelValidationResults=void 0,this.apiKeyLocationTypes=void 0,this.authenticationTypesForCloud=void 0,this.authenticationTypesForSoap=void 0,this.authenticationTypesForOnPremise=void 0,this.aadSecretOptions=void 0,this.aadSecretOption=void 0,this.previousTab=h.c.general,this.nextTab=h.c.definition,this.onAadSecretOptionChange=(e,t)=>{this.aadSecretOption=t.key,this.telemetryService.tagEvent(l.c.AadSecretOptionChange,{aadSecretOption:t.key}),this.swaggerEditorDataService.updateAadSecretOption("managedIdentity"===t.key)},this.onEditSecurityDefinitionClicked=()=>{this.swaggerEditorDataService.securityTabDetails.isLocked=!1},this.onSelectedApiKeyLocationChanged=(e,t)=>{this.swaggerEditorDataService.securityTabDetails.selectedApiKeyLocation=t.key,this.validateApiKeyName()},this.onEnableServicePrincipalChanged=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v.telemetryService.tagEvent(l.c.CustomApiEnableServicePrincipalClicked),v.swaggerEditorDataService.updateServicePrincipalSupport(t)},this.onAuthenticationTypeChanged=(e,t)=>{this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationType=t.key},this.onIdentityProviderChanged=(e,t)=>{this.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId=t.key,this.$timeout(()=>{var e=Object(o.a)(document.getElementById(this.identityTypeDropdownId));e&&e.focus()})},this.onUniqueRedirectUrlCheckboxChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v.telemetryService.tagEvent(l.c.CustomApiEnableGlobalPerConnectorRedirectModeForOAuth2),v.swaggerEditorDataService.securityTabDetails.uniqueRedirectUrlChecked=t},this.swaggerEditorData=c.SwaggerEditorData,this.telemetryService.tagEvent(l.c.CustomApiSecurityTabVisited),this.apiKeyLocationTypes=[{key:b,text:this.clientResources.Manage.CustomApi.Security.ApiKey.Location.query},{key:y,text:this.clientResources.Manage.CustomApi.Security.ApiKey.Location.header}],this.authenticationTypesForCloud=[{key:d.b.None,text:this.clientResources.Manage.CustomApi.Security.noAuth},{key:d.b.Basic,text:this.clientResources.Manage.CustomApi.Security.basic},{key:d.b.ApiKey,text:this.clientResources.Manage.CustomApi.Security.apiKey},{key:d.b.Oauth2,text:this.clientResources.Manage.CustomApi.Security.oauth2}],this.authenticationTypesForOnPremise=[{key:d.b.None,text:this.clientResources.Manage.CustomApi.Security.noAuth},{key:d.b.Basic,text:this.clientResources.Manage.CustomApi.Security.basic},{key:d.b.Windows,text:this.clientResources.Manage.CustomApi.Security.windows}],this.authenticationTypesForSoap=[{key:d.b.None,text:this.clientResources.Manage.CustomApi.Security.noAuth},{key:d.b.Basic,text:this.clientResources.Manage.CustomApi.Security.basic}],this.aadSecretOptions=[{key:"clientSecret",text:this.clientResources.Manage.CustomApi.Security.aadSecretOptions.clientSecret},{key:"managedIdentity",text:this.clientResources.Manage.CustomApi.Security.aadSecretOptions.managedIdentity}];var w=null!==(g=this.swaggerEditorDataService.securityTabDetails)&&void 0!==g&&g.federatedIdentityCredentials||null!==(f=this.swaggerEditorDataService.securityTabDetails)&&void 0!==f&&f.useManagedIdentity?1:0;this.aadSecretOption=this.aadSecretOptions[w].key,this.$scope.$watch(()=>this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationType,(e,t)=>{e!==t&&this.swaggerEditorDataService.onAuthenticationTypeChanged()}),this.$scope.$watch(()=>this.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId,(e,t)=>{e!==t&&this.swaggerEditorDataService.onIdentityProviderChanged()}),this.$scope.$watch(()=>this.swaggerEditorDataService.securityTabDetails.apiKeyName,()=>this.validateApiKeyName()),this.$scope.$watch(()=>this.swaggerEditorDataService.securityTabDetails.apiKeyLabel,()=>this.validateApiKeyLabel())}var t,i,n;return t=e,(i=[{key:"authenticationTypes",get:function(){return this.widgetUtilService.isLogicApps()&&this.swaggerEditorData.apiLogicApps.properties.apiType===r.a.Soap?this.authenticationTypesForSoap:this.swaggerEditorData.isOnPremiseDataGateway?this.authenticationTypesForOnPremise:this.authenticationTypesForCloud}},{key:"identityProviders",get:function(){return this.swaggerEditorDataService.securityTabDetails.cache.identityProviders.map(e=>({key:e.Id,text:e.DisplayName}))}},{key:"isBasic",get:function(){return this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationType===d.b.Basic}},{key:"isOauth2",get:function(){return this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationType===d.b.Oauth2}},{key:"showUniqueRedirectUrlCheckbox",get:function(){return Object(m.h)(this.swaggerEditorDataService.securityTabDetails)}},{key:"isApiKey",get:function(){return this.swaggerEditorDataService.securityTabDetails.selectedAuthenticationType===d.b.ApiKey}},{key:"isManagedIdentityEnabled",get:function(){return!!Object(c.a)()}},{key:"isManagedIdentityEnabledForAAD",get:function(){return this.isManagedIdentityEnabled&&this.isOauth2&&Object(u.a)(this.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId,g.a.AAD)}},{key:"showManagedIdentityComponent",get:function(){return this.isManagedIdentityEnabledForAAD&&"managedIdentity"===this.aadSecretOption}},{key:"showFICDisplayValue",get:function(){var e,t=null===(e=this.swaggerEditorDataService.securityTabDetails)||void 0===e?void 0:e.federatedIdentityCredentials,{issuer:i,subject:r,audience:n}=t||{};return this.clientResources.Manage.CustomApi.RightPane.Fields.ManagedIdentity.FICStringsFormat.replace("{0}",i||"").replace("{1}",r||"").replace("{2}",n||"")}},{key:"showRadioGroupsForAADSecretOptions",value:function(e,t){return Object(u.a)(e,"ClientSecret")&&this.isFormItemSecureString(t)&&this.isManagedIdentityEnabledForAAD}},{key:"showValidatedInputComponentForAuthenticationFormItem",value:function(e,t){return!(Object(u.a)(e,"ClientSecret")&&this.isFormItemSecureString(t)&&this.showManagedIdentityComponent)}},{key:"isFormItemSecureString",value:function(e){return"securestring"===e.type}},{key:"getFormItemInputType",value:function(e){return this.isFormItemSecureString(e)?"password":"text"}},{key:"getFormItemPlaceholder",value:function(e){return this.isFormItemSecureString(e)?"********":e.placeholder||e.displayName}},{key:"getFormItemLabelId",value:function(e){return"authentication-form-"+e}},{key:"getFormItemLabelledBy",value:function(e){return"securitySwaggerEditorTab-basic-auth-label authentication-form-"+e}},{key:"getBasicFormItemDescribedBy",value:function(){return"securitySwaggerEditorTab-basic-auth-description"}},{key:"validateApiKeyName",value:function(){this.apiKeyNameValidationResults=this.securityDetailsValidationService.validateApiKeyName(this.swaggerEditorDataService.securityTabDetails)}},{key:"validateApiKeyLabel",value:function(){this.apiKeyLabelValidationResults=this.securityDetailsValidationService.validateApiKeyLabel(this.swaggerEditorDataService.securityTabDetails)}}])&&f(t.prototype,i),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();w.$inject=[n.a.services.$scope,n.a.services.$timeout,n.a.services.clientResources,n.a.services.securityDetailsValidationService,n.a.services.swaggerEditorData,n.a.services.telemetry,n.a.services.widgetUtilService]},33846:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"d",(function(){return c})),i.d(t,"f",(function(){return u})),i.d(t,"g",(function(){return d})),i.d(t,"e",(function(){return p})),i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return m})),i.d(t,"h",(function(){return g}));var r=i(14868),n=i(33817),o=i(11891),a=i(33847),s=i(20342),l={ConnectionParameterSetName:"certOauth",IdentityProvider:"aad",ClientCertificateSecretTokenKey:"token:clientCertificateSecret",ParameterType:"clientCertificate"};function c(e){return e&&e.properties&&e.properties.connectionParameters&&e.properties.connectionParameters.authType&&e.properties.connectionParameters.authType.allowedValues&&e.properties.connectionParameters.authType.allowedValues.length>0&&e.properties.connectionParameters.authType.allowedValues[0].value}function u(e){return Object(o.a)(e,r.b.None)||Object(o.a)(e,r.b.Basic)||Object(o.a)(e,r.b.Oauth2)||Object(o.a)(e,r.b.ApiKey)||Object(o.a)(e,r.b.Windows)}function d(e){return e.every(e=>u(e))}function p(e){if(!e)return null;var t=Object.keys(e);for(var i of t)if(Object(o.a)(i,"oAuthSettings"))return e[i];return null}function h(e){return(e||[]).reduce((e,t)=>(e[t]=t,e),{})}function m(e,t){var i;for(var r of Object.keys(e||{})){var s=e[r];switch(r.toUpperCase()){case"CLIENTID":t.token.oAuthSettings.clientId=s;break;case"CLIENTSECRET":t.token.oAuthSettings.clientSecret=s;break;default:t.token.oAuthSettings.customParameters[r]={value:s}}}null!=t&&null!==(i=t.token)&&void 0!==i&&i.oAuthSettings&&(Object(n.a)()&&Object(o.a)(t.token.oAuthSettings.identityProvider,a.a.AAD)&&!t.token.oAuthSettings.clientSecret?(t.token.oAuthSettings.clientAssertionType="genericFederatedIdentityCredential",t.token.oAuthSettings.customParameters.GrantType={value:"authorization_code_with_federated_identity_credentials"}):t.token.oAuthSettings.clientAssertionType=void 0)}function g(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i?null===(t=e.selectedAuthenticationTypes)||void 0===t?void 0:t.includes(r.b.Oauth2):e.selectedAuthenticationType===r.b.Oauth2;return n&&!!e.redirectUrl&&e.redirectMode!==s.g.GlobalPerConnector}},33847:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){return e.AAD="aad",e.GenericOAuth="oauth2",e}({})},33848:function(e,t){e.exports='<div class="securitySwaggerEditorTab">\n    \x3c!-- Authentication type section --\x3e\n    <section class="row">\n        \x3c!-- Left pane --\x3e\n        <div class="column medium-3 left-pane securitySwaggerEditorTab-scrollbox" ng-class="{\'securitySwaggerEditorTab-scrollbox--shifted\': securitySwaggerEditorTabCtrl.swaggerEditorData.statusAlert.type}">\n            <div class="securitySwaggerEditorTab-scrollbox-content" >\n                <h1 class="title">{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.Security.Heading}}</h1>\n                <p class="securitySwaggerEditorTab-description">\n                    {{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.LeftPane.Security.Description}}\n                    <learn-more\n                        resource="\'Manage.CustomApi.Security.LeftPane.Hyperlink\'"\n                        link-aria-label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Security.LeftPane.LearnMoreAriaLabel"\n                    ></learn-more>\n                </p>\n            </div>\n        </div>\n        \x3c!-- Right pane --\x3e\n        <div class="column medium-8 medium-offset-1 right-pane securitySwaggerEditorTab-scrollbox" ng-class="{\'securitySwaggerEditorTab-scrollbox--shifted\': securitySwaggerEditorTabCtrl.swaggerEditorData.statusAlert.type}">\n            <div class="securitySwaggerEditorTab-scrollbox-content" >\n                \x3c!-- Authentication type section --\x3e\n                <section class="securitySwaggerEditorTab-section">\n                    <h2 class="pane-title">\n                        {{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.AuthenticationType.Heading}}\n                    </h2>\n                    <div class="pane-content" ng-class="{\'securitySwaggerEditorTab-pane-content--hasButton\' : securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked}">\n                        <div class="pane-field securitySwaggerEditorTab-pane-field--hasButton">\n                            <react-dropdown-swagger-style\n                                id="{{::securitySwaggerEditorTabCtrl.authTypeDropdownId}}"\n                                label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.AuthenticationType.Type.Label"\n                                options="::securitySwaggerEditorTabCtrl.authenticationTypes"\n                                selected-key="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.selectedAuthenticationType"\n                                on-change="securitySwaggerEditorTabCtrl.onAuthenticationTypeChanged"\n                                is-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                required="true">\n                            </react-dropdown-swagger-style>\n                        </div>\n                        <div ng-if="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked">\n                            <react-action-button\n                                allow-disabled-focus="true"\n                                icon-name="securitySwaggerEditorTabCtrl.iconName.Edit"\n                                on-click="securitySwaggerEditorTabCtrl.onEditSecurityDefinitionClicked"\n                                disabled="!securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                text="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Security.Edit"\n                                id="{{::securitySwaggerEditorTabCtrl.editButtonId}}">\n                            </react-action-button>\n                        </div>\n                    </div>\n                </section>\n                \x3c!-- Basic Auth --\x3e\n                <section class="securitySwaggerEditorTab-section" ng-if="securitySwaggerEditorTabCtrl.isBasic">\n                    \x3c!-- Warning Message --\x3e\n                    <react-text-message-bar\n                        type="securitySwaggerEditorTabCtrl.messageBarType.warning"\n                        message="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Warning">\n                    </react-text-message-bar>\n                    <h2 class="pane-title">\n                        {{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Basic.Heading}}\n                    </h2>\n                    <div class="pane-content" ng-class="{\'securitySwaggerEditorTab-pane-content--hasButton\' : securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked}">\n                        <div class="pane-field securitySwaggerEditorTab-pane-field--hasButton">\n                            <label class="pane-field-label" id="securitySwaggerEditorTab-basic-auth-description">{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Label}}</label>\n                            <div class="pane-table">\n                                <div class="row pane-table-header">\n                                    <div class="column medium-6">\n                                        <label id="securitySwaggerEditorTab-basic-auth-label">\n                                            {{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Label.Heading}}\n                                            <span aria-hidden="true" class="context-required-text">*</span>\n                                        </label>\n                                    </div>\n                                    <div class="column medium-5 medium-offset-1">\n                                        <label>{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Key.Heading}}</label>\n                                    </div>\n                                    <hr/>\n                                </div>\n                                <hr />\n                                <div ng-repeat="(key, formItem) in securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.authenticationFormItems">\n                                    <div class="row pane-table-body">\n                                        <ng-form name="apiAuthForm">\n                                            <div class="column medium-6">\n                                                <div class="pane-row-input">\n                                                    <span>\n                                                        <validated-input\n                                                            input-model="formItem.value"\n                                                            input-aria-labelled-by="securitySwaggerEditorTabCtrl.getFormItemLabelledBy(key)"\n                                                            input-aria-described-by="securitySwaggerEditorTabCtrl.getBasicFormItemDescribedBy()"\n                                                            input-placeholder="securitySwaggerEditorTabCtrl.getFormItemPlaceholder(formItem)"\n                                                            input-type="{{securitySwaggerEditorTabCtrl.getFormItemInputType(formItem)}}"\n                                                            is-required="formItem.required"\n                                                            is-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                                            hide-results="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                                            validator="securitySwaggerEditorTabCtrl.securityDetailsValidationService.getConnectionFormItemValidator(formItem)"\n                                                            icon-on-left="true">\n                                                        </validated-input>\n                                                    </span>\n                                                </div>\n                                            </div>\n                                            <div class="column medium-5 medium-offset-1">\n                                                <label id="{{securitySwaggerEditorTabCtrl.getFormItemLabelId(key)}}" class="pane-row-label">{{formItem.displayName}}</label>\n                                            </div>\n                                        </ng-form>\n                                    </div>\n                                    <hr />\n                                </div>\n                            </div>\n                        </div>\n                        <div ng-if="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked">\n                            <react-action-button\n                                allow-disabled-focus="true"\n                                icon-name="securitySwaggerEditorTabCtrl.iconName.Edit"\n                                on-click="securitySwaggerEditorTabCtrl.onEditSecurityDefinitionClicked"\n                                disabled="!securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                text="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Security.Edit">\n                            </react-action-button>\n                        </div>\n                    </div>\n                </section>\n                \x3c!-- OAuth 2 --\x3e\n                <section class="securitySwaggerEditorTab-section" ng-if="securitySwaggerEditorTabCtrl.isOauth2">\n                    <h2 class="pane-title">\n                        {{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.OAuth2.Heading}}\n                    </h2>\n                    <div class="pane-content" ng-class="{\'securitySwaggerEditorTab-pane-content--hasButton\' : securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked}">\n                        <div class="pane-field">\n                            <react-dropdown-swagger-style\n                                id="{{::securitySwaggerEditorTabCtrl.identityTypeDropdownId}}"\n                                label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.IdentityProvider.Label"\n                                options="securitySwaggerEditorTabCtrl.identityProviders"\n                                selected-key="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId"\n                                on-change="securitySwaggerEditorTabCtrl.onIdentityProviderChanged"\n                                is-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked">\n                            </react-dropdown-swagger-style>\n                            <react-checkbox\n                                ng-if="securitySwaggerEditorTabCtrl.swaggerEditorDataService.multiAuthSupported"\n                                label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.EnableServicePrincipal.Label"\n                                checked="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.enableServicePrincipalSupport"\n                                on-change="::securitySwaggerEditorTabCtrl.onEnableServicePrincipalChanged"\n                                disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked">\n                            </react-checkbox>\n                        </div>\n                        <ng-form name="apiAuthForm">\n                            <div class="pane-field" ng-repeat="(key, formItem) in securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.authenticationFormItems">\n                                <div class="pane-field" ng-if="securitySwaggerEditorTabCtrl.showRadioGroupsForAADSecretOptions(key, formItem)">\n                                    <react-choice-group\n                                        options="::securitySwaggerEditorTabCtrl.aadSecretOptions"\n                                        label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.AADSecretOptions.Label"\n                                        direction="\'horizontal\'"\n                                        required="true"\n                                        selected-key="securitySwaggerEditorTabCtrl.aadSecretOption"\n                                        on-change="::securitySwaggerEditorTabCtrl.onAadSecretOptionChange">\n                                    </react-choice-group>\n                                </div>\n                                <validated-input\n                                    ng-if="securitySwaggerEditorTabCtrl.showValidatedInputComponentForAuthenticationFormItem(key, formItem)"\n                                    input-model="formItem.value"\n                                    input-placeholder="securitySwaggerEditorTabCtrl.getFormItemPlaceholder(formItem)"\n                                    input-type="{{securitySwaggerEditorTabCtrl.getFormItemInputType(formItem)}}"\n                                    label="formItem.displayName"\n                                    is-required="formItem.required"\n                                    is-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                    hide-results="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                    validator="securitySwaggerEditorTabCtrl.securityDetailsValidationService.getConnectionFormItemValidator(formItem, securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId)">\n                                </validated-input>\n                            </div>\n                            <div class="pane-field">\n                                <label class="pane-field-label">{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.Scope.Label}}</label>\n                                <input ng-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked" type="text" class="c-text-field" ng-model="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.scopeInput" placeholder="{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.Scope.Label}}">\n                            </div>\n                            <div class="pane-field">\n                                <label class="pane-field-label">{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.RedirectUrl.Label}}</label>\n                                <react-copyable-text-field\n                                    copy-button-aria-label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopyRedirectUrl.Label"\n                                    placeholder="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.RedirectUrl.PlaceHolder"\n                                    value="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.redirectUrl">\n                                </react-copyable-text-field>\n                                <div class="securitySwaggerEditorTab-checkbox" ng-if="securitySwaggerEditorTabCtrl.showUniqueRedirectUrlCheckbox">\n                                    <react-checkbox\n                                        disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                        label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.OAuth2.UniqueRedirectUrlCheckbox"\n                                        checked="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.uniqueRedirectUrlChecked"\n                                        on-change="::securitySwaggerEditorTabCtrl.onUniqueRedirectUrlCheckboxChange">\n                                    </react-checkbox>\n                                    <span class="learn-more">\n                                        <learn-more\n                                            resource="\'Manage.CustomApi.RightPane.OAuth2.LearnMore.Hyperlink\'"\n                                            link-aria-label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.OAuth2.LearnMore.AriaLabel"\n                                        ></learn-more>\n                                    </span>\n                                </div>\n                            </div>\n                            <div class="pane-field" ng-if="securitySwaggerEditorTabCtrl.showManagedIdentityComponent">\n                                <label class="pane-field-label">{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.ManagedIdentity.Label}}</label>\n                                <react-copyable-text-field\n                                    copy-button-aria-label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopyFICStrings.Label"\n                                    placeholder="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.Fields.ManagedIdentity.PlaceHolder"\n                                    value="securitySwaggerEditorTabCtrl.showFICDisplayValue">\n                                </react-copyable-text-field>\n                            </div>\n                        </ng-form>\n                        <div ng-if="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked">\n                            <react-action-button\n                                allow-disabled-focus="true"\n                                icon-name="securitySwaggerEditorTabCtrl.iconName.Edit"\n                                on-click="securitySwaggerEditorTabCtrl.onEditSecurityDefinitionClicked"\n                                disabled="!securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                text="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Security.Edit">\n                            </react-action-button>\n                        </div>\n                    </div>\n                </section>\n                \x3c!-- API Key --\x3e\n                <section class="securitySwaggerEditorTab-section" ng-if="securitySwaggerEditorTabCtrl.isApiKey">\n                    <h2 class="pane-title">\n                        {{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.ApiKey.Heading.Label}}\n                    </h2>\n                    <div class="pane-content" ng-class="{\'securitySwaggerEditorTab-pane-content--hasButton\' : securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked}">\n                        <div class="pane-field securitySwaggerEditorTab-pane-field--hasButton">\n                            <label class="pane-field-label">{{::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.ApiKey.Label}}</label>\n                        </div>\n                        <div class="pane-field">\n                            \x3c!-- TODO(nidurak): add description --\x3e\n                            <validated-input\n                                label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Label.Heading"\n                                input-model="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.apiKeyLabel"\n                                is-required="true"\n                                is-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                hide-results="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                validation-result-collection="securitySwaggerEditorTabCtrl.apiKeyLabelValidationResults">\n                            </validated-input>\n                        </div>\n                        <div class="pane-field">\n                            <validated-input\n                                label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.BasicAuth.Table.Key.Heading"\n                                input-model="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.apiKeyName"\n                                is-required="true"\n                                is-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                hide-results="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                validation-result-collection="securitySwaggerEditorTabCtrl.apiKeyNameValidationResults">\n                            </validated-input>\n                        </div>\n                        <div class="pane-field">\n                            <react-dropdown-swagger-style\n                                id="securitySwaggerEditorTabCtrl.apiKeyLocation"\n                                label="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.RightPane.ApiKey.Location.Heading"\n                                options="::securitySwaggerEditorTabCtrl.apiKeyLocationTypes"\n                                selected-key="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.selectedApiKeyLocation"\n                                on-change="securitySwaggerEditorTabCtrl.onSelectedApiKeyLocationChanged"\n                                is-disabled="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                required="true">\n                            </react-dropdown-swagger-style>\n                        </div>\n                        <div ng-if="securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked">\n                            <react-action-button\n                                allow-disabled-focus="true"\n                                icon-name="securitySwaggerEditorTabCtrl.iconName.Edit"\n                                on-click="securitySwaggerEditorTabCtrl.onEditSecurityDefinitionClicked"\n                                disabled="!securitySwaggerEditorTabCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n                                text="::securitySwaggerEditorTabCtrl.clientResources.Manage.CustomApi.Security.Edit">\n                            </react-action-button>\n                        </div>\n                    </div>\n                </section>\n                \x3c!-- Tab navigation --\x3e\n                <custom-api-tab-navigation\n                    previous-tab="securitySwaggerEditorTabCtrl.previousTab"\n                    next-tab="securitySwaggerEditorTabCtrl.nextTab">\n                </custom-api-tab-navigation>\n            </div>\n        </div>\n    </section>\n</div>\n'},33849:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33850);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33851);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33852),this.controller=o.a,this.bindings={items:"=",index:"=",baseViolator:"<",referencingOperationItems:"<",inRequest:"<"},this.controllerAs="schemaPropertyCtrl"}));r.a.component(n.a.components.schemaProperty,new c)},33850:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(33359),o=i(33804),a=i(33800),s=i(33360);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$timeout=i,this.clientResources=r,this.swaggerValidationService=l,this.loggingService=c,this.titleInputId="schemaProperty-title-".concat(Object(s.e)()),this.items=void 0,this.index=void 0,this.baseViolator=void 0,this.referencingOperationItems=void 0,this.inRequest=void 0,this.validationFilters=void 0,this.requiredOptions=void 0,this.availableTypes=[o.d.string,o.d.integer,o.d.number,o.d.boolean],this.availableFormats={string:["","byte","binary","date","date-time","password"],integer:["int32","int64"],number:["float","double"],boolean:null},this.selectedVisibilityOption=void 0,this.visibilityOptions=Object.keys(n.l).map(e=>({key:n.l[e],text:n.l[e]})),this.visibilityOptionsLabelLink=void 0,this.$onInit=()=>{this.availableFormats.string.push("html"),this.selectedVisibilityOption=this.item.visibility||n.l.none,this.validationFilters={title:new a.a(new a.i(this.baseViolator?this.baseViolator.swaggerItem:void 0,{schemaProperty:this.item,subPath:a.d.Title})),description:new a.a(new a.i(this.baseViolator?this.baseViolator.swaggerItem:void 0,{schemaProperty:this.item,subPath:a.d.Description})),default:new a.a(new a.i(this.baseViolator?this.baseViolator.swaggerItem:void 0,{schemaProperty:this.item,subPath:a.d.Default}))},this.$scope.$watch(()=>this.swaggerValidationService.resultCollection.results,()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.$timeout(()=>{var e=document.getElementById(this.titleInputId);e&&e.focus()})},this.onVisibilityChange=(e,t)=>{this.selectedVisibilityOption=t.key,this.item.visibility=this.selectedVisibilityOption},this.onRequiredOptionChange=(e,t)=>{this.item.required=t.key===(!0).toString()},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"SchemaPropertyCtrl"}),this.requiredOptions=[{key:(!0).toString(),text:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.Yes},{key:(!1).toString(),text:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.No}],this.visibilityOptionsLabelLink={href:this.clientResources.Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Visibility.LearnMoreAriaLabel,telemetryData:{name:"SchemaProperty.Visibility.LearnMoreClicked"}}}var t,i,r;return t=e,(i=[{key:"selectedRequiredOption",get:function(){return(!!this.item.required).toString()}},{key:"item",get:function(){return this.items[this.index]}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[r.a.services.$scope,r.a.services.$timeout,r.a.services.clientResources,r.a.services.swaggerValidationService,r.a.services.logging]},33851:function(e,t,i){e.exports=i.p+"static/media/schemaProperty.e62e6e55.less"},33852:function(e,t){e.exports='<div class="subsection-manage schema-property">\n    <div class="pane-title">\n        <span>{{::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Heading}}</span>\n    </div>\n    <div class="pane-content">\n        \x3c!-- Title --\x3e\n        <div class="pane-field">\n            <validated-input\n                input-id="::schemaPropertyCtrl.titleInputId"\n                input-model="schemaPropertyCtrl.item.leafTitle"\n                label="::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Title.Label"\n                validation-result-collection="schemaPropertyCtrl.validationFilters.title.resultCollection">\n            </validated-input>\n        </div>\n        \x3c!-- Description --\x3e\n        <div class="pane-field">\n            <validated-input\n                input-model="schemaPropertyCtrl.item.description"\n                validation-result-collection="schemaPropertyCtrl.validationFilters.description.resultCollection"\n                label="::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Description.Label"\n                learn-more-resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"\n                learn-more-link-aria-label="::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Description.LearnMoreAriaLabel">\n            </validated-input>\n        </div>\n        \x3c!-- Default --\x3e\n        <div class="pane-field" ng-if="schemaPropertyCtrl.inRequest">\n            <validated-input\n                input-model="schemaPropertyCtrl.item.default"\n                label="::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.DefaultValue.Label"\n                validation-result-collection="schemaPropertyCtrl.validationFilters.default.resultCollection">\n            </validated-input>\n        </div>\n        \x3c!-- Required --\x3e\n        <div class="pane-field" ng-if="schemaPropertyCtrl.inRequest !== undefined">\n            <react-choice-group\n                options="::schemaPropertyCtrl.requiredOptions"\n                label="::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.Label"\n                direction="\'horizontal\'"\n                selected-key="schemaPropertyCtrl.selectedRequiredOption"\n                on-change="::schemaPropertyCtrl.onRequiredOptionChange"\n            ></react-choice-group>\n        </div>\n        \x3c!-- Visibility --\x3e\n        <div class="pane-field">\n            <react-choice-group-with-link\n                options="::schemaPropertyCtrl.visibilityOptions"\n                label="::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Visibility.Label"\n                label-link="::schemaPropertyCtrl.visibilityOptionsLabelLink"\n                direction="\'horizontal\'"\n                selected-key="schemaPropertyCtrl.selectedVisibilityOption"\n                on-change="::schemaPropertyCtrl.onVisibilityChange"\n            ></react-choice-group-with-link>\n        </div>\n        \x3c!-- Type --\x3e\n        <div class="pane-field pane-field-multiselect">\n            <div class="select-option-container">\n                <label class="pane-field-label" for="schemaProperty-type">{{::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Type.Label}}</label>\n                <select id="schemaProperty-type" ng-model="schemaPropertyCtrl.item.type" type="text" class="select-option">\n                    <option ng-repeat="type in schemaPropertyCtrl.availableTypes" value="{{type}}" >{{type}}</option>\n                </select>\n            </div>\n            <div class="select-option-container">\n                <label class="pane-field-label" for="schemaProperty-format">{{::schemaPropertyCtrl.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Format.Label}}</label>\n                <select id="schemaProperty-format" ng-model="schemaPropertyCtrl.item.format" type="text" ng-disabled="schemaPropertyCtrl.item.type == null || schemaPropertyCtrl.availableFormats[schemaPropertyCtrl.item.type] === null" class="select-option">\n                    <option ng-repeat="format in schemaPropertyCtrl.availableFormats[schemaPropertyCtrl.item.type]" value="{{format}}">{{format}}</option>\n                </select>\n            </div>\n        </div>\n        \x3c!-- Dropdown Editor --\x3e\n        <parameter-dropdown-editor ng-if="schemaPropertyCtrl.inRequest"\n            schema-property="schemaPropertyCtrl.item"\n            operation-items="schemaPropertyCtrl.referencingOperationItems" >\n        </parameter-dropdown-editor>\n    </div>\n\n    \x3c!-- Validation --\x3e\n    <section>\n        <validation-results\n            heading-above-pane="::schemaPropertyCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading"\n            sub-heading-above-pane="::schemaPropertyCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.SchemaProperty"\n            base-violator="schemaPropertyCtrl.baseViolator">\n        </validation-results>\n    </section>\n</div>'},33853:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33854);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33857);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33858),this.controller=o.a,this.bindings={model:"="},this.controllerAs="customApiShareTabCtrl"}));n.a.component(r.a.components.customApi.shareTab,new c)},33854:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var r=i(11891),n=i(33527),o=i(33349),a=i(33528),s=i(33353),l=i(33582),c=i(33355),u=i(33392),d=i(33327),p=i(13016),h=i(33360),m=i(33436),g=i(33398),f=i(12330),v=i(17451),b=i(33855),y=i(33408),w=i(33383),S=i(33571),C=i(33583),k=i(33477);function P(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function A(e){if(e===v.b.User)return"User";if(e===v.b.Group)return"Group";throw new Error("Cannot get graph object type for flow sharing principal type '".concat(e,"'."))}var T=function(){function e(t,i,a,l,d,m,v,b,S,C,k,P,x,T){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$routeParams=i,this.$scope=a,this.assetService=l,this.clientResources=d,this.environmentService=m,this.graphService=v,this.loggingService=b,this.permissionsClient=S,this.sessionService=C,this.telemetryService=k,this.xrmService=P,this.appSettings=x,this.xrmPermissionsService=T,this.messageBarType=p.c,this.currentlySharedWithHeaderId=Object(h.e)(),this.users=[],this.disableActionButtons=void 0,this.memberDetails=void 0,this.roles=void 0,this.currentUserPermission=void 0,this.isCurrentUserReader=void 0,this.isCurrentUserViewWithShare=void 0,this.canCurrentUserShare=void 0,this.isSolutionApi=void 0,this.isSolutionApiUpdated=void 0,this.solutionApiOwner=void 0,this.isSaveInProgress=void 0,this.selectedUserPermission=void 0,this.selectedUserRole=void 0,this.selectedOption=void 0,this.currentUserTenantId=void 0,this.currentUserTenantDisplayName=void 0,this.currentUserOrganizationId=void 0,this.groupIcon=void 0,this.model=void 0,this.defaultPlaceholderImage=void 0,this.shareSpinner={size:w.c.Large,local:w.a.Local,show:!0},this.permissionsInProgress=void 0,this.initInProgress=void 0,this.memberDetailsIndexable=void 0,this.deletedPermissionsIndexable=void 0,this.domainsRegularExpressions=void 0,this.queryParameters=void 0,this.$onInit=()=>{this.telemetryService.tagEvent(g.a.CustomApiShareTabVisited),this.disableActionButtons=!0,this.memberDetailsIndexable={},this.deletedPermissionsIndexable={},this.domainsRegularExpressions=[],this.currentUserTenantId=this.sessionService.getUserInfo().tenantId,this.defaultPlaceholderImage=this.assetService.userPlaceholder,this.initInProgress=!0,this.groupIcon=this.assetService.groupIcon;var e=this.$routeParams.apiName;this.queryParameters=Object(y.a)({apiName:e},!0,this.environmentService.getCurrentEnvironmentName()),this.$scope.$watch(()=>this.model.api,()=>{this.isSolutionApi=Object(r.a)(this.model.api.properties.almMode,"solution"),this.permissionsInProgress=!0,this.isSolutionApi&&this.appSettings.featureFlags.enableShareSolutionCustomConnectors?void 0===this.model.api.properties.xrmConnectorId?(this.model.statusAlert.options.show(s.a.Error,this.clientResources.Manage.CustomApi.GetApi.Error),this.canCurrentUserShare=!1):this.populateInformationForSolutionApi():this.isSolutionApi||(this.canCurrentUserShare=!1,this.model.permissions.$watch(this.$scope,()=>{this.permissionsInProgress=!0;var e=n.c(this.model.permissions),t=this.graphService.getCachedThumbnailPhotos(e),i=this.sessionService.getUserInfo().uniqueId,r=this.loggingService.profileStart(c.a.myCustomApiGetCurrentUserPermissionStart);this.getCurrentUserPermission(i).then(o=>(this.loggingService.profileEndWithSuccess(r,c.a.myCustomApiGetCurrentUserPermissionEnd),this.setCurrentUserPermissions(o,i),this.roles=n.e(this.clientResources),this.users=this.populateAndGetUserPermissions(this.model.permissions,t),this.updateActionButtons(),this.graphService.getThumbnailPhotos(e))).then(e=>{this.populateUserThumbnails(this.users,e)}).catch(e=>{this.loggingService.profileEnd(r,c.a.myCustomApiGetCurrentUserPermissionEnd,Object(u.b)(e),e),this.model.statusAlert.options.show(s.a.Error,this.clientResources.Manage.CustomApi.Share.GetCurrentUserPermission.Error)}).finally(()=>{this.permissionsInProgress=!1})}))});var t=this.loggingService.profileStart(c.a.myCustomApiGetTenantDetailsStart);this.graphService.queryTenantDetails().then(e=>{this.loggingService.profileEndWithSuccess(t,c.a.myCustomApiGetTenantDetailsEnd),this.currentUserTenantDisplayName=e[0].displayName,this.updateTenantDisplayName()}).catch(e=>{this.loggingService.profileEnd(t,c.a.myCustomApiGetTenantDetailsEnd,Object(u.b)(e),e)}).finally(()=>{this.initInProgress=!1})},this.saveChanges=()=>{this.telemetryService.tagEvent(g.a.CustomApiShareTabSaveChangesClicked),this.model.statusAlert.options.show(s.a.Progress,this.clientResources.Manage.CustomApi.Share.SavingPermissions),this.disableActionButtons=!0,this.isSaveInProgress=!0;var e=this.loggingService.profileStart(c.a.myCustomApiModifyPermissionsStart,{almMode:this.model.api.properties.almMode});(this.isSolutionApi&&this.appSettings.featureFlags.enableShareSolutionCustomConnectors?this.modifyPermissionsSolution(this.users):this.modifyPermissions(this.users)).then(t=>{this.loggingService.profileEndWithSuccess(e,c.a.myCustomApiModifyPermissionsEnd),this.deletedPermissionsIndexable={},this.updateActionButtons(),this.displayShareResults(t)}).catch(t=>{var i=Object(u.e)(t);this.loggingService.profileEnd(e,c.a.myCustomApiModifyPermissionsEnd,Object(u.b)(t),t,{almMode:this.model.api.properties.almMode}),this.model.statusAlert.options.show(s.a.Error,i)}).finally(()=>{this.isSolutionApi&&this.appSettings.featureFlags.enableShareSolutionCustomConnectors?this.refreshUserPermissionsXrm(this.model.api.properties.xrmConnectorId).catch(e=>{this.model.statusAlert.options.show(s.a.Error,e)}).finally(()=>{this.isSaveInProgress=!1}):this.isSaveInProgress=!1})},this.discardChanges=()=>{this.telemetryService.tagEvent(g.a.CustomApiShareTabDiscardChangesClicked),this.disableActionButtons=!0,this.model.statusAlert.options.hide();for(var e=this.users.length-1;e>=0;e--){var t=this.users[e].userPermission;t.allowRoleToChange&&(!t.role&&t.permission?this.restoreDeletedUnsavedUser(t):t.role&&t.permission?this.users[e].userPermission.setRole(o.b(t.permission.properties.roleName,this.clientResources)):(this.deletedPermissionsIndexable[t.email]&&delete this.deletedPermissionsIndexable[t.email],delete this.memberDetailsIndexable[t.email],this.users.splice(e,1)))}},this.onGraphAutocompleteSelect=(e,t)=>{var i=this.users.filter(t=>Object(r.a)(t.id,e.id));if(i.length>0){var n=i[0].userPermission;this.deletedPermissionsIndexable[e.mail]&&Object(f.a)(n.role)&&(this.restoreDeletedUnsavedUser(n),this.updateActionButtons())}else{var o={objectId:e.id,displayName:e.displayName,email:e.mail,principalType:A(e.type),thumbnailPhoto:this.defaultPlaceholderImage};this.addPermission(o)}}}var t,i,d;return t=e,(i=[{key:"getPermissionButtonText",value:function(e){return this.userHasPermissionRole(e)?e.userPermission.role.displayName:""}},{key:"getCommandsInDropdown",value:function(e){return e.commandsInDropDown}},{key:"isCustomApiSharedWithTenant",value:function(){return!!this.users.some(e=>n.h(e.userPermission.principalType)&&!!e.userPermission.role)}},{key:"populateAndGetUserPermissions",value:function(e,t){var i=[];return e.forEach(e=>{var o=e.properties.principal,a=t[o.id]||this.defaultPlaceholderImage,s=n.g(e);if(this.isNewUser(o.id)||s){var l={objectId:s?o.tenantId:o.id,displayName:s?this.clientResources.Manage.CustomApi.Share.ToggleTenantText:o.displayName,email:s?this.currentUserTenantDisplayName:o.email,principalType:o.type,thumbnailPhoto:s?this.groupIcon:a},c=new b.a(e,l,this.canCurrentUserShare,o.type,this.clientResources),u={id:l.objectId,iconUrl:l.thumbnailPhoto,click:()=>{for(var e=0;e<this.users.length&&!Object(r.a)(this.users[e].id,l.objectId);e++);this.removePermission(e,this.isUserPermissionRemovable(c))},title:l.displayName,subTitle:l.email,userPermission:c,type:m.a.NotSpecified};this.createCommandForUserCard(u),i.push(u)}else for(var d of this.users)if(Object(r.a)(d.id,o.id)){this.isSolutionApi&&this.appSettings.featureFlags.enableShareSolutionCustomConnectors&&(d.userPermission.permission=e),d.iconUrl=a,i.push(d);break}}),i.sort((e,t)=>this.userHasPermissionRole(e)&&(n.g(e.userPermission.permission)||n.i(e.userPermission.permission)&&!n.g(t.userPermission.permission)?-1:1))}},{key:"displayShareResults",value:function(e){var t=e.filter(e=>e.alertType===s.a.Error)[0]||e.filter(e=>e.alertType===s.a.Warning)[0]||e.filter(e=>e.alertType===s.a.Info)[0]||e.filter(e=>e.alertType===s.a.Progress)[0]||e.filter(e=>e.alertType===s.a.Success)[0]||e.filter(e=>e.alertType===s.a.None)[0];this.model.statusAlert.options.show(t.alertType,t.message)}},{key:"populateUserThumbnails",value:function(e,t){e.forEach(e=>{var i=t[e.id];i&&(e.iconUrl=i)})}},{key:"removePermission",value:function(e,t){if(!this.isSaveInProgress&&t&&this.users.length>0&&this.users[e]){var i=this.users[e].userPermission;delete this.memberDetailsIndexable[i.email],i.permission?(i.setRole(null),this.deletedPermissionsIndexable[i.email]=i.email):this.users.splice(e,1),this.updateActionButtons()}}},{key:"addTenantPermission",value:function(){if(!this.isCustomApiSharedWithTenant()){var e={objectId:this.currentUserTenantId,displayName:this.clientResources.Manage.CustomApi.Share.ToggleTenantText,email:this.currentUserTenantDisplayName,thumbnailPhoto:this.groupIcon,principalType:a.a.Tenant};this.addPermission(e)}}},{key:"updateActionButtons",value:function(){this.users.filter(e=>e.userPermission.allowRoleToChange).filter(e=>{var t=e.userPermission;return!(t.role&&t.permission&&t.allowRoleToChange&&t.permission.properties.roleName===t.getRoleName())}).length>0&&!this.isSaveInProgress?this.disableActionButtons=!1:this.disableActionButtons=!0}},{key:"isUserVisible",value:function(e){return!!this.userHasPermissionRole(e)}},{key:"canUserRoleBeChanged",value:function(e){return!(!(this.canCurrentUserShare&&this.userHasPermissionRole(e)&&e.userPermission.allowRoleToChange)||e.userPermission.isTenantPermission)&&!(this.isCurrentUserReader&&Object(r.a)(e.userPermission.role.name,a.b.CanEdit))&&this.userHasPermissionRole(e)&&!this.isCurrentUserPermission(e.userPermission.permission)}},{key:"canUserInfoCardBeRemoved",value:function(e){return this.userHasPermissionRole(e)&&this.isUserPermissionRemovable(e.userPermission)}},{key:"getCurrentUserPermission",value:function(e){var t=n.d(this.model.permissions,e);if(n.i(t))return this.$q.resolve(t);var i=this.model.api.properties&&o.a(this.model.api.properties.permissions,this.clientResources);return i?this.$q.resolve(i):n.f(this.model.permissions)?this.graphService.getMemberGroups(e,this.currentUserTenantId).then(e=>{var i=this.model.permissions.filter(e=>e.properties.principal.type===a.a.Group).filter(t=>{var i=t.properties.principal.id;return-1!==e.indexOf(i)});return this.$q.resolve(o.a(i.concat(t),this.clientResources))}):this.$q.resolve(t)}},{key:"getCurrentUserPermissionsXrm",value:function(e,t){var i,r=this.loggingService.profileStart(c.a.myCustomApiGetCurrentUserPermissionStart,{almMode:k.a.Solution}),n=Object(h.d)(l.a.RetrievePrincipalAccess,t,e);return this.xrmService.makeXrmCall(S.a.GET,n).then(e=>(i=this.xrmPermissionsService.mapPermissionsToRp(e.data.AccessRights).toString(),this.getCurrentUserOrganizationId(t))).then(e=>(this.loggingService.profileEndWithSuccess(r,c.a.myCustomApiGetCurrentUserPermissionEnd,{almMode:k.a.Solution}),this.currentUserOrganizationId=e,{name:t,id:this.model.api.name,type:"Microsoft.PowerApps/apis/permissions",properties:{roleName:i,principal:{type:"User"}}})).catch(e=>{throw this.loggingService.profileEnd(r,c.a.myCustomApiGetCurrentUserPermissionEnd,e,{almMode:k.a.Solution}),this.model.statusAlert.options.show(s.a.Error,this.clientResources.Manage.CustomApi.Share.GetCurrentUserPermission.Error),e})}},{key:"isUserPermissionRemovable",value:function(e){return e.isTenantPermission?this.currentUserPermission&&!this.isCurrentUserReader||this.isCurrentUserViewWithShare:e.allowRoleToChange&&!this.isCurrentUserReader&&!this.isCurrentUserPermission(e.permission)}},{key:"isNewUser",value:function(e){var t=this.users.filter(t=>Object(r.a)(t.id,e)&&this.userPermissionInitialized(t));return!t||0===t.length}},{key:"isCurrentUserPermission",value:function(e){return e&&Object(r.a)(this.currentUserPermission.id,e.id)}},{key:"userHasPermissionRole",value:function(e){return!Object(f.a)(e)&&!Object(f.a)(e.userPermission)&&!Object(f.a)(e.userPermission.role)}},{key:"userPermissionInitialized",value:function(e){return!Object(f.a)(e)&&!Object(f.a)(e.userPermission)&&!Object(f.a)(e.userPermission.permission)}},{key:"createCommandForUserCard",value:function(e){var t=[{text:this.clientResources.Manage.CustomApi.Share.RoleView,iconUrl:"",click:()=>{var t=o.b(a.b.CanView,this.clientResources);e.userPermission.setRole(t),this.updateActionButtons()}},{text:this.clientResources.Manage.CustomApi.Share.RoleViewWithShare,iconUrl:"",click:()=>{var t=o.b(a.b.CanViewWithShare,this.clientResources);e.userPermission.setRole(t),this.updateActionButtons()}}];this.canCurrentUserShare&&!Object(r.a)(this.currentUserPermission.properties.roleName,a.b.CanViewWithShare)&&t.push({text:this.clientResources.Manage.CustomApi.Share.RoleEdit,iconUrl:"",click:()=>{var t=o.b(a.b.CanEdit,this.clientResources);e.userPermission.setRole(t),this.updateActionButtons()}}),e.commandsInDropDown=t}},{key:"updateTenantDisplayName",value:function(){var e=this.users.filter(e=>this.userHasPermissionRole(e)&&e.userPermission.isTenantPermission);e.length>0&&(this.users[this.users.indexOf(e[0])].subTitle=this.currentUserTenantDisplayName)}},{key:"addMemberDetails",value:function(e,t,i){this.memberDetailsIndexable[e.email]={displayName:e.displayName,email:e.email,objectId:t,thumbnailPhoto:e.thumbnailPhoto,principalType:e.principalType}}},{key:"addPermission",value:function(e){if(e){var t,i=e;if(this.memberDetailsIndexable[i.email]||this.deletedPermissionsIndexable[i.email]){var a=this.users.filter(e=>e.userPermission.email===i.email);a.length>0&&a[0].userPermission.setRole(o.b(a[0].userPermission.role?a[0].userPermission.role.name:n.b(this.clientResources).name,this.clientResources)),this.deletedPermissionsIndexable[i.email]&&delete this.deletedPermissionsIndexable[i.email]}else{t=new b.a(null,i,this.canCurrentUserShare,i.principalType,this.clientResources);var s=n.b(this.clientResources);t.setRole(s);var l={id:e.objectId,iconUrl:Object(r.a)(e.objectId,this.currentUserTenantId)?this.assetService.groupIcon:this.defaultPlaceholderImage,click:()=>{for(var i=0;i<this.users.length&&!Object(r.a)(this.users[i].id,e.objectId);i++);this.removePermission(i,this.isUserPermissionRemovable(t))},title:e.displayName,subTitle:e.email,userPermission:t,type:m.a.NotSpecified};this.createCommandForUserCard(l),this.users.unshift(l)}this.memberDetailsIndexable[i.email]=i,this.updateActionButtons()}}},{key:"modifyPermissions",value:function(e){var t=e.filter(e=>e.userPermission.isRevoked()).map(e=>({id:e.userPermission.permission.id})),i=e.filter(e=>e.userPermission.isUpdated()||e.userPermission.isNew()).map(e=>{var t=e.userPermission;return{properties:{roleName:t.getRoleName(),principal:{email:t.email,id:t.objectId,type:t.principalType,tenantId:t.isTenantPermission?t.objectId:null}}}}),r=t.length?{delete:t}:null,n=i.length?{put:i}:null,o=[];return this.callModifyPermissions(r).then(e=>(Object(f.a)(e)||o.push(e),this.callModifyPermissions(n))).then(e=>{Object(f.a)(e)||o.push(e)}).then(()=>o.length?o:(this.disableActionButtons=!1,[{message:this.clientResources.Manage.CustomApi.Share.NothingToSave,alertType:s.a.Info}]))}},{key:"modifyPermissionsSolution",value:function(e){var t=this.xrmService.getXrmInstanceApiUrl(),i={requestType:S.a.POST,path:l.a.RevokeAccess,body:{Target:{connectorid:this.model.api.properties.xrmConnectorId,"@odata.type":C.a.Connector},Revokee:void 0}},n=e.filter(e=>e.userPermission.isRevoked()).map(e=>{var t=e.userPermission.principalType;return e.userPermission.isTenantPermission?i.body.Revokee={"@odata.type":C.a.Organization,organizationid:this.currentUserOrganizationId}:Object(r.a)(t,a.a.Group)?i.body.Revokee=i.body.Revokee={"@odata.type":C.a.Team,ownerid:e.userPermission.objectId}:i.body.Revokee=i.body.Revokee={"@odata.type":C.a.SystemUser,ownerid:e.userPermission.objectId},i}),o=this.$q.all(e.filter(e=>e.userPermission.isUpdated()||e.userPermission.isNew()).map(e=>{var i=e.userPermission.getRoleName(),n=e.userPermission.principalType,o=this.xrmPermissionsService.mapPermissionsToXrm(i).toString(),s=e.userPermission,c={requestType:S.a.POST,path:l.a.ModifyAccess,body:{Target:{connectorid:this.model.api.properties.xrmConnectorId,"@odata.type":C.a.Connector},PrincipalAccess:{Principal:{"@odata.id":void 0},AccessMask:s.isTenantPermission?C.b.ReadAccess:o}}};if(Object(r.a)(n,a.a.Group))return s.isUpdated()?(c.body.PrincipalAccess.Principal["@odata.id"]="teams(".concat(s.objectId,")"),c):this.getTeamInfo(s.objectId).then(e=>(c.body.PrincipalAccess.Principal["@odata.id"]="teams(".concat(e.ownerid,")"),c)).catch(e=>{throw e});if(s.isTenantPermission){var u="".concat(t,"organizations(").concat(this.currentUserOrganizationId,")");return c.body.PrincipalAccess.Principal["@odata.id"]=u,c}return this.xrmPermissionsService.getSystemUserInfo(this.xrmService,s.objectId).then(e=>{if(e.value.length){var i=e.value[0].systemuserid,r="".concat(t,"systemusers(").concat(i,")");return c.body.PrincipalAccess.Principal["@odata.id"]=r,c}var n="No user ".concat(s.email," exists within Dataverse");return this.loggingService.logInfo("CustomApiShareTabCtrl.GetSystemUserInfo","User does not exist within Dataverse"),this.$q.reject(new Error(n))}).catch(e=>{throw e})})),c=n.length?n:[],u=[];return this.callModifyOrRevokePermissionsSolution(c).then(e=>(Object(f.a)(e)||u.push(e),o)).then(e=>this.callModifyOrRevokePermissionsSolution(e)).then(e=>(Object(f.a)(e)||u.push(e),u.length?u:(this.disableActionButtons=!1,[{message:this.clientResources.Manage.CustomApi.Share.NothingToSave,alertType:s.a.Info}])))}},{key:"callModifyPermissions",value:function(e){return Object(f.a)(e)?this.$q.resolve(null):this.permissionsClient.modify(this.queryParameters,e).then(e=>{var t=e.data.remove&&e.data.remove.filter(e=>!!e.error),i=e.data.add&&e.data.add.filter(e=>!!e.error),r=t||i;return this.model.permissions.$refresh(),r?{message:Object(u.e)(r,this.clientResources.Manage.CustomApi.Share.SaveActionFailed),alertType:s.a.Error}:{message:this.clientResources.Manage.CustomApi.Share.Success,alertType:s.a.Success}})}},{key:"callModifyOrRevokePermissionsSolution",value:function(e){return this.model.api.properties.xrmConnectorId,Object(f.a)(e)?this.$q.resolve(null):this.xrmService.makeXrmBatchCall(S.a.POST,e).then(()=>({message:this.clientResources.Manage.CustomApi.Share.Success,alertType:s.a.Success})).catch(e=>(this.model.statusAlert.options.show(s.a.Error,Object(u.e)(e,this.clientResources.Manage.CustomApi.Share.SaveActionFailed)),this.discardChanges(),{message:Object(u.e)(e,this.clientResources.Manage.CustomApi.Share.SaveActionFailed),alertType:s.a.Error}))}},{key:"refreshUserPermissionsXrm",value:function(e){var t=Object(h.d)(l.a.RetrieveSharedPrincipalAccess,e),i=this.loggingService.profileStart(c.a.myCustomApiPropertiesRefreshPermissionsStart,{almMode:k.a.Solution});return this.xrmService.makeXrmCall(S.a.GET,t).then(t=>this.xrmPermissionsService.mapXrmPermissionsToRp(t.data,this.xrmService,e,this.currentUserTenantDisplayName,this.loggingService)).then(e=>{var t=e.filter(e=>void 0!==e);t.push(this.solutionApiOwner);var r=n.c(t),o=this.graphService.getCachedThumbnailPhotos(r);this.users=this.populateAndGetUserPermissions(t,o),this.loggingService.profileEndWithSuccess(i,c.a.myCustomApiPropertiesRefreshPermissionsEnd,{almMode:k.a.Solution})}).catch(e=>{this.loggingService.profileEnd(i,c.a.myCustomApiPropertiesRefreshPermissionsEnd,Object(u.b)(e),e,{almMode:k.a.Solution})})}},{key:"getCurrentUserOrganizationId",value:function(e){var t=Object(h.d)(l.a.GetSystemUsersAad,e);return this.xrmService.makeXrmCall(S.a.GET,t).then(e=>e.data.organizationid).catch(e=>{throw e})}},{key:"getTeamInfo",value:function(e){return this.xrmService.makeXrmCall(S.a.GET,Object(h.d)(l.a.GetTeam,e)).then(t=>{if(1===t.data.value.length)return{ownerid:t.data.value[0].ownerid,emailaddress:t.data.value[0].emailaddress,name:t.data.value[0].name};var i=Object(h.d)(this.clientResources.Manage.CustomApi.Share.AadGroupDoesNotExistInCrm,e);return this.loggingService.logInfo("CustomApiShareTabCtrl.GetTeamInfo",i),this.$q.reject(new Error(i))}).catch(e=>{throw this.model.statusAlert.options.show(s.a.Error,Object(u.e)(e)),e})}},{key:"restoreDeletedUnsavedUser",value:function(e){this.addMemberDetails(e,e.objectId,e.principalType),delete this.deletedPermissionsIndexable[e.email],e.setRole(o.b(e.permission.properties.roleName,this.clientResources))}},{key:"setCurrentUserPermissions",value:function(e,t){this.currentUserPermission=e,this.currentUserPermission||this.loggingService.logWarning("CustomApiShareTabCtrl.GetCurrentUserPermissionForApi","Resource does not have permission for user ".concat(t)),this.isCurrentUserReader=!!this.currentUserPermission&&n.j(this.currentUserPermission),this.isCurrentUserViewWithShare=!!this.currentUserPermission&&n.k(this.currentUserPermission),this.canCurrentUserShare=!!this.currentUserPermission&&n.a(this.currentUserPermission),this.roles=n.e(this.clientResources),this.canCurrentUserShare||this.model.statusAlert.options.show(s.a.Info,this.clientResources.Manage.CustomApi.Share.ViewPermissionsInfo)}},{key:"populateInformationForSolutionApi",value:function(){var e,t=this.model.api.properties.xrmConnectorId,i=this.sessionService.getUserInfo().uniqueId,r=Object(h.d)(l.a.RetrieveSharedPrincipalAccess,t),o=this.loggingService.profileStart(c.a.myCustomApiPropertiesGetPermissionsStart,{almMode:k.a.Solution});this.getCurrentUserPermissionsXrm(t,i).then(e=>(this.setCurrentUserPermissions(e,i),this.xrmService.makeXrmCall(S.a.GET,r))).then(e=>this.xrmPermissionsService.mapXrmPermissionsToRp(e.data,this.xrmService,t,this.currentUserTenantDisplayName,this.loggingService)).then(t=>{e=t.filter(e=>void 0!==e);var i=Object(h.d)(l.a.GetConnectorOwner,this.model.api.name);return this.xrmService.makeXrmCall(S.a.GET,i)}).then(e=>{var t=e.data.value[0]._ownerid_value,i=Object(h.d)(l.a.GetSystemUsers,t);return this.xrmService.makeXrmCall(S.a.GET,i)}).then(i=>{var r=i.data.azureactivedirectoryobjectid,o=n.c(e);this.solutionApiOwner={name:r,id:t,type:"Microsoft.PowerApps/apis/permissions",properties:{roleName:a.b.Owner,principal:{id:r,type:a.a.User,displayName:i.data.fullname,email:i.data.domainname}}},e.push(this.solutionApiOwner),o.push(r);var s=this.graphService.getCachedThumbnailPhotos(o);return this.users=this.populateAndGetUserPermissions(e,s),this.updateActionButtons(),this.graphService.getThumbnailPhotos(o)}).then(e=>{this.populateUserThumbnails(this.users,e),this.loggingService.profileEndWithSuccess(o,c.a.myCustomApiPropertiesGetPermissionsEnd,{almMode:k.a.Solution})}).catch(e=>{this.loggingService.profileEnd(o,c.a.myCustomApiPropertiesGetPermissionsEnd,Object(u.b)(e),e,{almMode:k.a.Solution}),this.model.statusAlert.options.show(s.a.Error,this.clientResources.Manage.CustomApi.Share.GetCurrentUserPermission.Error)}).finally(()=>{this.permissionsInProgress=!1})}},{key:"getDeleteButtonAriaLabel",value:function(e){return Object(h.d)(this.clientResources.Manage.CustomApi.Share.DeleteButton.AriaLabel,this.getPermissionButtonText(e),e.title)}}])&&P(t.prototype,i),d&&P(t,d),Object.defineProperty(t,"prototype",{writable:!1}),e}();T.$inject=[d.a.services.$q,d.a.services.$routeParams,d.a.services.$scope,d.a.services.assetService,d.a.services.clientResources,d.a.services.environment,d.a.services.graph,d.a.services.logging,d.a.services.permissionsClient,d.a.services.session,d.a.services.telemetry,d.a.services.xrmService,d.a.services.appSettings,d.a.services.xrmPermissionsService]},33855:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33348),n=i(14876),o=i(33856),a=i(11891);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,n,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.objectId=void 0,this.displayName=void 0,this.principalType=void 0,this.email=void 0,this.thumbnailPhoto=void 0,this.isTenantPermission=void 0,this.permission=void 0,this.role=void 0,this.allowRoleToChange=void 0,this.email=i.email,this.principalType=s,this.isTenantPermission=Object(a.a)(this.principalType,r.a.Tenant),this.displayName=i.displayName,this.objectId=i.objectId,this.thumbnailPhoto=i.thumbnailPhoto,this.allowRoleToChange=n,t&&t.properties&&t.properties.roleName&&(this.permission=t,this.allowRoleToChange=this.allowRoleToChange&&!Object(o.b)(t),this.setRole(Object(o.a)(this.permission.properties.roleName,l)))}var t,i,l;return t=e,(i=[{key:"isRevoked",value:function(){return!this.role&&!!this.permission}},{key:"isUpdated",value:function(){return!(!this.role||!this.permission||Object(n.a)(this.permission)||Object(a.a)(this.role.name,this.permission.properties.roleName))}},{key:"isNew",value:function(){return!this.permission}},{key:"setRole",value:function(e){this.role=e}},{key:"getRoleName",value:function(){return this.role&&this.role.name}},{key:"getRoleDisplayName",value:function(){return this.role&&this.role.displayName}}])&&s(t.prototype,i),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33856:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return a}));var r=i(33348),n=i(11891);function o(e){return!(!e||!e.properties)&&Object(n.a)(e.properties.roleName,r.b.Owner)}function a(e,t){switch(e){case r.b.CanView:return{name:r.b.CanView,displayName:t.Manage.CustomApi.Share.RoleView,priority:1};case r.b.CanViewWithShare:return{name:r.b.CanViewWithShare,displayName:t.Manage.CustomApi.Share.RoleViewWithShare,priority:2};case r.b.CanEdit:return{name:r.b.CanEdit,displayName:t.Manage.CustomApi.Share.RoleEdit,priority:3};case r.b.Owner:return{name:r.b.Owner,displayName:t.Manage.CustomApi.Share.RoleOwner,priority:4};default:return null}}},33857:function(e,t,i){e.exports=i.p+"static/media/customApiShareTab.50299cdd.less"},33858:function(e,t){e.exports='<div>\n    <section class="row section-share" ng-hide="customApiShareTabCtrl.spinner.show || customApiShareTabCtrl.initInProgress || customApiShareTabCtrl.permissionsInProgress">\n        <react-text-message-bar\n            ng-if="customApiShareTabCtrl.environmentService.isDevEnvironment()"\n            type="customApiShareTabCtrl.messageBarType.warning"\n            message="::customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.UnsupportedInDevEnvironment"\n        ></react-text-message-bar>\n        <div ng-if="!customApiShareTabCtrl.environmentService.isDevEnvironment()">\n            <div class="column medium-3 left-pane">\n                <h1>{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.LeftPane.Header}}</h1>\n                <p>{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.LeftPane.Description}}</p>\n            </div>\n            <div class="column medium-8 medium-offset-1 right-pane">\n                <h2>{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.RightPane.AddPeople}}</h2>\n                <graph-autocomplete on-select="customApiShareTabCtrl.onGraphAutocompleteSelect" class="autocomplete-container" is-disabled="!customApiShareTabCtrl.canCurrentUserShare"></graph-autocomplete>\n                <div class="tenant-share" ng-if="customApiShareTabCtrl.canCurrentUserShare && !customApiShareTabCtrl.isCustomApiSharedWithTenant() && customApiShareTabCtrl.currentUserTenantDisplayName ">\n                    <img ng-src="{{customApiShareTabCtrl.groupIcon}}" alt="customApiShareTabCtrl.currentUserTenantDisplayName"/>\n                    <span class="display-name">{{customApiShareTabCtrl.currentUserTenantDisplayName}}</span>\n                    <a class="toggle" ng-click="customApiShareTabCtrl.addTenantPermission()" tabindex="0">\n                        {{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.ToggleTenantText}}\n                    </a>\n                </div>\n                <h2 id="{{::customApiShareTabCtrl.currentlySharedWithHeaderId}}">{{customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.RightPane.CurrentlySharedWith}}</h2>\n                <ul aria-labelledby="{{::customApiShareTabCtrl.currentlySharedWithHeaderId}}">\n                    <li class="ps-list-item" ng-repeat="item in customApiShareTabCtrl.users track by item.id" ng-show="customApiShareTabCtrl.isUserVisible(item)">\n                        <info-card model="item">\n                            <info-card-icon-template>\n                                <avatar mail="item.subTitle" display-name="item.title" image-src="item.iconUrl"></avatar>\n                            </info-card-icon-template>\n                            <info-card-picker-template>\n                                <list-commands\n                                    model="customApiShareTabCtrl.getCommandsInDropdown(item)"\n                                    button-text="customApiShareTabCtrl.getPermissionButtonText(item)"\n                                    is-disabled="!customApiShareTabCtrl.canUserRoleBeChanged(item)"\n                                    button-aria-label="::customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.ChoosePermission"\n                                    show-text-dropdown="true">\n                                </list-commands>\n                            </info-card-picker-template>\n                            <info-card-option-template>\n                                    <div ng-click="$parent.model.click()" aria-disabled="!customApiShareTabCtrl.canUserInfoCardBeRemoved(item)" aria-label="{{customApiShareTabCtrl.getDeleteButtonAriaLabel(item)}}">\n                                        <div class="c-glyph glyph-delete option-block" ng-disabled="!customApiShareTabCtrl.canUserInfoCardBeRemoved(item)"></div>\n                                    </div>\n                                </info-card-option-template>\n                        </info-card>\n                    </li>\n                </ul>\n                <hr>\n                <div class="action-buttons">\n                    <react-default-button\n                        class="action-button"\n                        primary="true"\n                        on-click="customApiShareTabCtrl.saveChanges"\n                        is-disabled="!customApiShareTabCtrl.canCurrentUserShare || customApiShareTabCtrl.disableActionButtons || customApiShareTabCtrl.isSaveInProgress"\n                        text="::customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.Save">\n                    </react-default-button>\n                    <react-default-button\n                        class="action-button"\n                        on-click="customApiShareTabCtrl.discardChanges"\n                        is-disabled="!customApiShareTabCtrl.canCurrentUserShare || customApiShareTabCtrl.disableActionButtons"\n                        text="::customApiShareTabCtrl.clientResources.Manage.CustomApi.Share.Discard">\n                    </react-default-button>\n                </div>\n            </div>\n        </div>\n    </section>\n    <spinner model="customApiShareTabCtrl.shareSpinner" ng-if="customApiShareTabCtrl.initInProgress || customApiShareTabCtrl.permissionsInProgress"></spinner>\n</div>'},33859:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33860);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33865);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33866),this.controller=o.a,this.controllerAs="swaggerEditorTabCtrl"}));n.a.component(r.a.components.customApi.swaggerEditorTab,new c)},33860:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var r=i(33327),n=i(33861),o=i.n(n),a=i(33862),s=i.n(a),l=i(33863),c=i.n(l),u=i(33864),d=i.n(u),p=i(33787),h=i.n(p);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=new URL(o.a,window.location.origin),v=new URL(s.a,window.location.origin),b=new URL(c.a,window.location.origin),y=new URL(d.a,window.location.origin),w=new URL(h.a,window.location.origin),S=function(){function e(t,i,r,n,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.$scope=i,this.$interval=r,this.swaggerEditorDataService=n,this.loggingService=o,this.navigationService=a,this.inlineEditor=void 0,this.swaggerEditorPoll=void 0,this.$onInit=()=>{var e=document.createElement("iframe");e.id="swagger-editor-iframe",e.ariaLabel="".concat(this.clientResources.Manage.CustomApi.inlineSwaggerEditor),e.src=this.getIFrameSrcURL(),document.getElementById("swagger-editor-container").appendChild(e),e.addEventListener("load",e=>{this.inlineEditor.createEditor(this.swaggerEditorDataService.SwaggerEditorData.inlineEditorSwagger),this.swaggerEditorPoll=this.$interval(()=>this.swaggerEditorDataService.SwaggerEditorData.inlineEditorSwagger=this.inlineEditor.getSwaggerData(),200)}),this.inlineEditor=e.contentWindow.window,this.$scope.$on("$locationChangeStart",(e,t,i)=>{this.swaggerEditorDataService.SwaggerEditorData.inlineEditorSwagger=this.inlineEditor.getSwaggerData(),this.swaggerEditorDataService.updateUISwaggerFromInlineSwagger()})},this.$onDestroy=()=>{this.$interval.cancel(this.swaggerEditorPoll),this.inlineEditor=null},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"SwaggerEditorTabCtrl"})}var t,i,r;return t=e,(i=[{key:"getIFrameSrcURL",value:function(){var e,t='\n    <html>\n      <head>\n        <link rel="stylesheet" href='.concat(y,' />\n        <link rel="stylesheet" href="').concat(v,'" />\n        <script src=').concat(b,"><\/script>\n        <script src=").concat(w,'><\/script>\n        <script src="').concat(f,'"><\/script>\n      </head>\n      <body>\n        <div class="inline-swagger-editor-content" id="inline-swagger-editor"></div>\n      </body>\n    </html>\n  ');return e=new Blob([t],{type:"text/html"}),URL.createObjectURL(e)}}])&&m(t.prototype,i),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();S.$inject=[r.a.services.clientResources,r.a.services.$scope,r.a.services.$interval,r.a.services.swaggerEditorData,r.a.services.logging,r.a.services.navigation]},33861:function(e,t,i){e.exports=i.p+"static/inlineEditor.0b602ed0.js"},33862:function(e,t,i){e.exports=i.p+"static/SwaggerInlineEditorIFrame.c29ffe4c.css"},33865:function(e,t,i){e.exports=i.p+"static/media/swaggerEditorTab.aee2c581.less"},33866:function(e,t){e.exports='<div class="swagger-editor-content-tab" id="swagger-editor-container">\n</div>'},33867:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33640),a=i(33868),s=o.a.concat(["text","iconUrl","iconText","required","token","commands"]);r.a.directive(n.a.components.react.reactTokenBlock,[n.a.modules.reactDirective,e=>e(a.a,s)])},33868:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(12831),n=i(33869),o=i(11766);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=e=>{var t,i,a,l=s(s({},e),{},{menuProps:(t=e.commands,i=e.token,a=t.map(e=>({onClick:()=>e.click(i),key:e.text,iconProps:{iconName:e.iconName},text:e.text,disabled:e.disabled})),{items:a})});return o.createElement(r.a,{className:"fl-NgReactTokenBlock",style:{display:"inline-block"}},o.createElement(n.a,l))}},33869:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(11766),n=i(12728),o=i(14672),a=i(33870),s=i(12706),l=["ariaLabel","className","telemetryData"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=v(e);if(t){var n=v(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return f(this,i)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(v,e);var t,i,h,f=g(v);function v(){var e;d(this,v);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return(e=f.call(this,...i)).labelId=Object(n.a)("ChoiceGroupWithLinkCustomLabel"),e.getClassNames=Object(s.a)(),e.onRenderText=()=>{var{iconUrl:t,iconText:i,required:n}=e.props,o=e.getClassNames(Object(a.b)());return r.createElement("div",{className:o.textContainer},t&&r.createElement("img",{alt:i,src:t,role:"presentation"}),n&&r.createElement("span",{className:o.requiredSymbol},"*"),r.createElement("span",{id:e.labelId,className:o.label},e.props.text))},e}return t=v,(i=[{key:"render",value:function(){var e=this.props,{ariaLabel:t,className:i,telemetryData:n}=e,s=u(e,l);return r.createElement(o.a,c({ariaLabel:t||this.props.text,className:"fl-TokenBlock"+(i?" ".concat(i):""),menuIconProps:{iconName:"More"},onRenderText:this.onRenderText},s,{styles:Object(a.a)()}))}}])&&p(t.prototype,i),h&&p(t,h),Object.defineProperty(t,"prototype",{writable:!1}),v}(r.Component)},33870:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var r=i(12754),n=()=>{var e=Object(r.Y)().palette;return{root:[{height:"32px",fontSize:"12px",marginRight:"8px",marginBottom:"8px",paddingLeft:"8px",backgroundColor:e.themeLight,paddingRight:"0px",border:"1px solid transparent"}],rootHovered:[{borderWidth:"1px",borderStyle:"solid",borderColor:e.themePrimary,backgroundColor:e.themeLight}],rootChecked:[{borderWidth:"1px",borderStyle:"solid",borderColor:e.themePrimary,backgroundColor:e.themeLight}],menuIcon:[{backgroundColor:e.themeTertiary,lineHeight:"32px",width:"30px",height:"100%",margin:"0px",color:e.neutralPrimary}]}},o=()=>({textContainer:["fl-TokenBlock-TextContainer",{paddingRight:"8px","> *":{marginRight:"3px",lineHeight:"30px",verticalAlign:"middle",display:"inline-block"}}],label:["fl-TokenBlock-Text",{maxWidth:"120px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}],requiredSymbol:["fl-TokenBlock-RequiredSymbol",{color:Object(r.Y)().palette.redDark}]})},33871:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33872);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33874);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33875),this.bindings={description:"<?",hideResults:"<?",iconOnLeft:"<?",inputAriaLabel:"<?",inputAriaLabelledBy:"<?",inputAriaDescribedBy:"<?",inputId:"<?",inputMaxlength:"@?",inputModel:"=",inputOptions:"<?",inputPlaceholder:"<?",inputType:"@?",isDisabled:"<?",isReadOnly:"<?",isRequired:"<?",label:"<?",learnMoreLinkAriaLabel:"<?",learnMoreResource:"<?",learnMoreText:"<?",validationResultCollection:"<?",validator:"<?"},this.controller=o.a,this.controllerAs="validatedInputCtrl"}));r.a.component(n.a.components.validatedInput,new c)},33872:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(15523),n=i(33327),o=i(33873);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.loggingService=i,this.inputModel=void 0,this.inputId=void 0,this.inputType=void 0,this.validationResultCollection=void 0,this.hideResults=void 0,this.iconOnLeft=void 0,this.validator=void 0,this.inputAriaDescribedBy=void 0,this.generatedInputId=void 0,this.describeById=void 0,this.description=void 0,this.$onInit=()=>{this.validationResultCollection&&this.validator&&console.warn("validated input should only define validationResultCollection OR validator, not both."),this.validator&&this.$scope.$watch(()=>this.inputModel,()=>{this.validationResultCollection=this.validator(this.inputModel)}),this.generatedInputId=Object(r.a)(),this.describeById=this.description?this.inputAriaDescribedBy+" "+Object(r.a)():this.inputAriaDescribedBy},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ValidatedInputCtrl"})}var t,i,n;return t=e,(i=[{key:"$inputId",get:function(){return this.inputId||this.generatedInputId}},{key:"type",get:function(){return this.inputType||"text"}},{key:"tooltipPosition",get:function(){return this.iconOnLeft?o.a.BottomRight:o.a.BottomLeft}},{key:"isToolTipVisible",get:function(){return this.validationResultCollection&&!this.validationResultCollection.isEmpty&&!this.hideResults}}])&&a(t.prototype,i),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[n.a.services.$scope,n.a.services.logging]},33873:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return c}));var r=i(15523),n=i(33327);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(e){return e[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight",e}({}),l={[s.TopLeft]:"topLeft",[s.TopRight]:"topRight",[s.BottomLeft]:"bottomLeft",[s.BottomRight]:"bottomRight",undefined:"bottomLeft",null:"bottomLeft"},c=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.assetService=t,this.clientResources=i,this.loggingService=n,this.validationResultCollection=void 0,this.position=void 0,this.toolTipId=Object(r.a)(),this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ValidationResultTooltipCtrl"})}var t,i,n;return t=e,(i=[{key:"tooltipPosition",get:function(){return l[this.position]}},{key:"tooltipIcon",get:function(){return this.validationResultCollection?this.validationResultCollection.mostSevereResultTypeImage(this.assetService):""}},{key:"tooltipIconAlt",get:function(){return this.validationResultCollection?this.validationResultCollection.mostSevereResultTypeImageText(this.clientResources):""}},{key:"resultIcon",value:function(e){return e.resultTypeImage(this.assetService)}},{key:"resultText",value:function(e){return e.resultTypeImageText(this.clientResources)}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[n.a.services.assetService,n.a.services.clientResources,n.a.services.logging]},33874:function(e,t,i){e.exports=i.p+"static/media/validatedInput.03160af1.less"},33875:function(e,t){e.exports='<div class="validatedInput">\n    <div ng-if="validatedInputCtrl.type === \'checkbox\'" class="c-checkbox">\n        <label class="validatedInput-label">\n            <input type="checkbox"\n                   ng-model="validatedInputCtrl.inputModel"\n                   ng-attr-aria-label="{{validatedInputCtrl.inputAriaLabel || validatedInputCtrl.label}}" />\n            <span>{{::validatedInputCtrl.label}}</span>\n            <span class="context-required-text" ng-if="validatedInputCtrl.isRequired">*</span>\n            <learn-more ng-if="validatedInputCtrl.learnMoreResource"\n                        resource="validatedInputCtrl.learnMoreResource"\n                        link-aria-label="validatedInputCtrl.learnMoreLinkAriaLabel"\n                        text="validatedInputCtrl.learnMoreText">\n            </learn-more>\n        </label>\n    </div>\n    <label ng-if="validatedInputCtrl.label && validatedInputCtrl.type !== \'checkbox\'"\n           class="validatedInput-label"\n           for="{{::validatedInputCtrl.inputId}}">\n        <span>{{::validatedInputCtrl.label}}</span>\n        <span class="context-required-text" ng-if="validatedInputCtrl.isRequired">*</span>\n        <learn-more ng-if="validatedInputCtrl.learnMoreResource"\n                    resource="validatedInputCtrl.learnMoreResource"\n                    link-aria-label="validatedInputCtrl.learnMoreLinkAriaLabel"\n                    text="validatedInputCtrl.learnMoreText">\n        </learn-more>\n    </label>\n    <label class="validatedInput-description" id="{{::validatedInputCtrl.describeById}}" ng-if="validatedInputCtrl.description">\n        {{::validatedInputCtrl.description}}\n    </label>\n\n    <input ng-if="validatedInputCtrl.type !== \'checkbox\' && validatedInputCtrl.type !== \'select\'"\n           class="form-control validatedInput-input"\n           ng-attr-id="{{::validatedInputCtrl.$inputId}}"\n           ng-class="{\n            \'validatedInput-input--toolTipLeft\': validatedInputCtrl.isToolTipVisible && validatedInputCtrl.iconOnLeft,\n            \'validatedInput-input--toolTipRight\': validatedInputCtrl.isToolTipVisible && !validatedInputCtrl.iconOnLeft\n           }"\n           type="{{validatedInputCtrl.type}}"\n           ng-attr-aria-labelledby="{{::validatedInputCtrl.inputAriaLabelledBy}}"\n           ng-attr-aria-describedby="{{::validatedInputCtrl.describeById}}"\n           ng-model="validatedInputCtrl.inputModel"\n           ng-readonly="validatedInputCtrl.isReadOnly"\n           ng-disabled="validatedInputCtrl.isDisabled"\n           placeholder="{{::validatedInputCtrl.inputPlaceholder}}"\n           ng-attr-aria-label="{{validatedInputCtrl.inputAriaLabel || validatedInputCtrl.label}}"\n           ng-attr-maxlength="{{::validatedInputCtrl.inputMaxlength}}"\n           ng-attr-aria-required="{{::!!validatedInputCtrl.isRequired}}">\n\n    <div class="c-select" ng-if="validatedInputCtrl.type === \'select\'">\n        <select class="validatedInput-input"\n                ng-attr-id="{{validatedInputCtrl.inputId}}"\n                ng-class="{\n                    \'validatedInput-input--toolTipLeft\': validatedInputCtrl.isToolTipVisible && validatedInputCtrl.iconOnLeft,\n                    \'validatedInput-input--toolTipRight\': validatedInputCtrl.isToolTipVisible && !validatedInputCtrl.iconOnLeft\n                }"\n                ng-attr-aria-describedby="{{::validatedInputCtrl.describeById}}"\n                ng-model="validatedInputCtrl.inputModel"\n                ng-options="::option.select as option.label for option in validatedInputCtrl.inputOptions"\n                ng-readonly="validatedInputCtrl.isReadOnly"\n                ng-disabled="validatedInputCtrl.isDisabled"\n                ng-attr-aria-label="{{validatedInputCtrl.inputAriaLabel || validatedInputCtrl.label}}"\n                ng-attr-maxlength="{{::validatedInputCtrl.inputMaxlength}}"\n                ng-attr-aria-required="{{::!!validatedInputCtrl.isRequired}}">\n            <option value="" disabled selected>{{validatedInputCtrl.inputPlaceholder}}</option>\n        </select>\n    </div>\n\n    <validation-result-tooltip class="validatedInput-validationResultTooltip"\n                               ng-class="{\n                                   \'validatedInput-validationResultTooltip--left\': validatedInputCtrl.iconOnLeft,\n                                   \'validatedInput-validationResultTooltip--right\': !validatedInputCtrl.iconOnLeft\n                               }"\n                               ng-if="!validatedInputCtrl.hideResults"\n                               validation-result-collection="validatedInputCtrl.validationResultCollection"\n                               position="validatedInputCtrl.tooltipPosition" >\n    </validation-result-tooltip>\n</div>\n'},33876:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33873);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33877),this.bindings={validationResultCollection:"<",position:"<?"},this.controller=o.b,this.controllerAs="validationResultTooltipCtrl"}));r.a.component(n.a.components.validationResultTooltip,new c)},33877:function(e,t){e.exports='<div\n    class="validationResultTooltip"\n    tabindex="0"\n    aria-roledescription="{{::validationResultTooltipCtrl.clientResources.Manage.CustomApi.ValidationResultTooltip.AriaRoleDescription}}"\n    aria-labelledby="{{::validationResultTooltipCtrl.toolTipId}}"\n    ng-if="validationResultTooltipCtrl.tooltipIcon"\n    role="img">\n    <img\n        class="validationResultTooltip-icon"\n        ng-src="{{validationResultTooltipCtrl.tooltipIcon}}"\n        alt="{{validationResultTooltipCtrl.tooltipIconAlt}}">\n    <div\n        class="validationResultTooltip-tooltip validationResultTooltip-tooltip--{{validationResultTooltipCtrl.tooltipPosition}}"\n        role="tooltip"\n        ng-attr-id="{{::validationResultTooltipCtrl.toolTipId}}">\n        <div class="validationResultTooltip-result" ng-repeat="result in validationResultTooltipCtrl.validationResultCollection.results">\n            <img class="validationResultTooltip-result-icon" alt="{{validationResultTooltipCtrl.resultText(result)}}" ng-src="{{validationResultTooltipCtrl.resultIcon(result)}}">\n            <span class="validationResultTooltip-result-message">{{result.message}}</span>\n            <hr class="validationResultTooltip-result-divider" ng-if="!$last" />\n        </div>\n    </div>\n</div>'},33878:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33879);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33881),this.bindings={headingAbovePane:"<",subHeadingAbovePane:"<",baseViolator:"<",includeReferencedResults:"&?"},this.controller=o.a,this.controllerAs="validationResultsCtrl"}));r.a.component(n.a.components.validationResults,new c)},33879:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33327),n=i(33800),o=i(33880),a=i(33802);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,o,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.assetService=i,this.clientResources=r,this.swaggerEditorDataService=o,this.swaggerValidationService=a,this.loggingService=s,this.baseViolator=void 0,this.headingAbovePane=void 0,this.subHeadingAbovePane=void 0,this.includeReferencedResults=void 0,this.validationResultHierarchy=void 0,this.validationResultsForBaseViolator=new n.h,this.$onInit=()=>{this.$scope.$watch(()=>this.swaggerValidationService.resultCollection.results,()=>{this.processValidationResults()})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ValidationResultsCtrl"})}var t,i,r;return t=e,(i=[{key:"iconUrl",get:function(){return!this.validationResultsForBaseViolator||this.validationResultsForBaseViolator.isEmpty?this.assetService.statusSuccess:this.validationResultsForBaseViolator.mostSevereResultTypeImage(this.assetService)}},{key:"iconImageText",get:function(){return!this.validationResultsForBaseViolator||this.validationResultsForBaseViolator.isEmpty?this.clientResources.Common.Success:this.validationResultsForBaseViolator.mostSevereResultTypeImageText(this.clientResources)}},{key:"processValidationResults",value:function(){var e;if(this.validationResultsForBaseViolator=this.swaggerValidationService.resultCollection.filterOnViolator(this.baseViolator),this.includeReferencedResults){var t=this.baseViolator.actionIndex;e=t>=0?this.swaggerEditorDataService.swagger.actions[t]:e;var i=this.baseViolator.triggerIndex;e=i>=0?this.swaggerEditorDataService.swagger.triggers[i]:e}e&&this.validationResultsForBaseViolator.add(a.e(e,this.swaggerEditorDataService.swagger,this.swaggerValidationService.resultCollection)),this.validationResultHierarchy=new o.a,this.validationResultsForBaseViolator.results.forEach(e=>this.insertResultInHierarchy(e))}},{key:"insertResultInHierarchy",value:function(e){e&&(e.violator?e.violator.swaggerItem&&e.violator.schemaPropertyItem&&e.violator.schemaPropertyItem.schemaProperty&&e.violator.schemaPropertyItem.subPath?this.validationResultHierarchy.addChild(e.violator.getSwaggerPathDisplayName(this.baseViolator)).addChild(e.violator.getSchemaPropertyKeyDisplayName(this.baseViolator)).addChild(e.violator.schemaPropertySubPathDisplayName).addResult(e):e.violator.swaggerItem&&e.violator.schemaPropertyItem&&e.violator.schemaPropertyItem.schemaProperty?this.validationResultHierarchy.addChild(e.violator.getSwaggerPathDisplayName(this.baseViolator)).addChild(e.violator.getSchemaPropertyKeyDisplayName(this.baseViolator)).addResult(e):e.violator.swaggerItem?this.validationResultHierarchy.addChild(e.violator.getSwaggerPathDisplayName(this.baseViolator)).addResult(e):this.validationResultHierarchy.addResult(e):this.validationResultHierarchy.addResult(e))}},{key:"resultIcon",value:function(e){return e.resultTypeImage(this.assetService)}},{key:"resultText",value:function(e){return e.resultTypeImageText(this.clientResources)}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[r.a.services.$scope,r.a.services.assetService,r.a.services.clientResources,r.a.services.swaggerEditorData,r.a.services.swaggerValidationService,r.a.services.logging]},33880:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,"a",(function(){return o}));var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.children={},this.results=[]}var t,i,n;return t=e,(i=[{key:"addChild",value:function(t){return this.children[t]||(this.children[t]=new e),this.children[t]}},{key:"addResult",value:function(e){return this.results.push(e),this}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33881:function(e,t){e.exports='<div class="validation-results-container">\n    <h3 class="c-heading-5" ng-if="validationResultsCtrl.headingAbovePane">{{validationResultsCtrl.headingAbovePane}}</h3>\n    <p class="c-subheading-5" ng-if="validationResultsCtrl.subHeadingAbovePane">{{validationResultsCtrl.subHeadingAbovePane}}</p>\n    <div class="validation-pane">\n        <div class="pane-title pane-title--hasIconOrButton">\n            <h4 class="pane-title-text--hasIconOrButton">{{validationResultsCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading}}</h4>\n            <img class="validation-icon" ng-src="{{validationResultsCtrl.iconUrl}}" alt="{{validationResultsCtrl.iconImageText}}"/>\n        </div>\n        <div class="pane-content">\n            <div class="pane-field" ng-if="validationResultsCtrl.validationResultsForBaseViolator.isEmpty">\n            <span>{{validationResultsCtrl.clientResources.Manage.CustomApi.ValidationResults.Success}}</span>\n            </div>\n            <div>\n                \x3c!-- Results for base path --\x3e\n                <div class="result-messages" ng-repeat="result in validationResultsCtrl.validationResultHierarchy.results">\n                    <img ng-src="{{validationResultsCtrl.resultIcon(result)}}" alt="{{validationResultsCtrl.resultText(result)}}"/>\n                    <label class="subtitle">{{result.message}}</label>\n                </div>\n                \x3c!-- Results by swagger subpath --\x3e\n                <div class="pane-field entity-result" ng-repeat="(swaggerPathKey, swaggerPathValue) in validationResultsCtrl.validationResultHierarchy.children">\n                    <label class="pane-field-label">{{swaggerPathKey}}</label>\n                    \x3c!-- Results for swagger subpath --\x3e\n                    <div class="result-messages indent" ng-repeat="result in swaggerPathValue.results">\n                        <img ng-src="{{validationResultsCtrl.resultIcon(result)}}" alt="{{validationResultsCtrl.resultText(result)}}"/>\n                        <label class="subtitle">{{result.message}}</label>\n                    </div>\n                    \x3c!-- Results by schema property key --\x3e\n                    <div class="pane-field entity-result indent" ng-repeat="(schemaPropertyKey, schemaPropertyValue) in swaggerPathValue.children">\n                        <label class="pane-field-label">{{schemaPropertyKey}}</label>\n                        \x3c!-- Results for schema property key --\x3e\n                        <div class="result-messages indent" ng-repeat="result in schemaPropertyValue.results">\n                            <img ng-src="{{validationResultsCtrl.resultIcon(result)}}" alt="{{validationResultsCtrl.resultText(result)}}"/>\n                            <label class="subtitle">{{result.message}}</label>\n                        </div>\n                        \x3c!-- Results by schema property subpath --\x3e\n                        <div class="pane-field entity-result indent" ng-repeat="(schemaPropertySubPathKey, schemaPropertySubPathValue) in schemaPropertyValue.children">\n                            <label class="pane-field-label">{{schemaPropertySubPathKey}}</label>\n                            \x3c!-- Results for schema property subpath --\x3e\n                            <div class="result-messages indent" ng-repeat="result in schemaPropertySubPathValue.results">\n                                <img ng-src="{{validationResultsCtrl.resultIcon(result)}}" alt="{{validationResultsCtrl.resultText(result)}}"/>\n                                <label class="subtitle">{{result.message}}</label>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},33882:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33883);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33887);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33888),this.controller=o.a,this.controllerAs="customApiResponseCtrl"}));n.a.component(r.a.components.customApi.customApiResponse,new c)},33883:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(33327),n=i(33363),o=i(33884),a=i(33359),s=i(33360),l=i(33886),c=i(33800),u=i(33803),d=i(13272),p=i(12330),h=i(17914),m=i(33398);function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,i,r,a,g,f,v,b,y,w){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$timeout=r,this.assetService=a,this.clientResources=g,this.customConnectorUrlService=f,this.navigationService=v,this.swaggerEditorDataService=b,this.swaggerValidationService=y,this.telemetryService=w,this.iconName=d.a,this.importFromSampleButtonId="customApiResponse-importFromSampleButton-".concat(Object(s.e)()),this.nameInputId="customApiResponse-name-".concat(Object(s.e)()),this.backButtonTelemetryData={name:m.a.CustomApiResponseBackButtonClicked},this.baseViolator=void 0,this.schemaSwaggerItem=void 0,this.actionIndex=void 0,this.triggerIndex=void 0,this.responseIndex=void 0,this.mode=void 0,this.headerTypes=[{key:"boolean",text:"boolean"},{key:"integer",text:"integer"},{key:"number",text:"number"},{key:"string",text:"string"}],this.resolvedSchema=void 0,this.schemaProperties=[],this.dropdownCommands=void 0,this.selectedSchemaPropertyIndex=void 0,this.selectedSchemaPropertyViolator=void 0,this.validationFilters={},this.responseGetter={[l.a.InlineAction]:()=>this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation.responses[this.responseIndex],[l.a.InlineTrigger]:()=>this.swaggerEditorDataService.swagger.triggers[this.triggerIndex].operation.responses[this.responseIndex],[l.a.Definition]:()=>this.swaggerEditorDataService.swagger.responses[this.responseIndex],[l.a.Undefined]:()=>({})},this.responseReferenceGetter={[l.a.InlineAction]:()=>"",[l.a.InlineTrigger]:()=>"",[l.a.Definition]:()=>"#/responses/".concat(this.swaggerEditorDataService.swagger.responses[this.responseIndex].name),[l.a.Undefined]:()=>""},this.baseViolatorGetter={[l.a.InlineAction]:()=>new c.i({itemPath:"".concat(c.d.Actions,"[").concat(this.actionIndex,"]").concat(c.d.OperationResponses,"[").concat(this.responseIndex,"]")}),[l.a.InlineTrigger]:()=>new c.i({itemPath:"".concat(c.d.Triggers,"[").concat(this.triggerIndex,"]").concat(c.d.OperationResponses,"[").concat(this.responseIndex,"]")}),[l.a.Definition]:()=>new c.i({itemPath:"".concat(c.d.Responses,"[").concat(this.responseIndex,"]")}),[l.a.Undefined]:()=>null},this.importPanel=void 0,this.onClickBack=()=>{Object(p.a)(this.selectedSchemaPropertyIndex)?Object(p.a)(this.actionIndex)?Object(p.a)(this.triggerIndex)||this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(h.a.triggers,this.triggerIndex)):this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(h.a.actions,this.actionIndex)):(this.selectedSchemaPropertyIndex=void 0,this.processSchema())},this.processSchema=()=>{this.response.item.schema&&(this.resolvedSchema=n.g(this.swaggerEditorDataService.SwaggerEditorData.swagger,this.response.item.schema),this.schemaProperties=n.c(this.resolvedSchema.schema),this.schemaProperties.forEach(e=>{this.validationFilters[e.key]||(this.validationFilters[e.key]=new c.a(new c.i(this.schemaSwaggerItem,{schemaProperty:e})))}))},this.showResponsePane=()=>{this.$timeout(()=>{this.importPanel={elementIdsToFocusOnClose:[this.importFromSampleButtonId],item:this.response.item,itemType:u.a.Response,panelType:u.c.Response,isVisible:!0,onUpdateSuccessful:this.processSchema}})},this.onResponseHeaderTypeChanged=(e,t)=>{this.response.item.headers[t].type=e.key},this.telemetryService.tagEvent(m.a.CustomApiResponseVisited);var S=this.$routeParams.operation;S===h.a.actions?this.actionIndex=this.$routeParams.operationIndex:S===h.a.triggers&&(this.triggerIndex=this.$routeParams.operationIndex),this.responseIndex=Object(p.a)(this.$routeParams.refOperationIndex)?this.$routeParams.operationIndex:this.$routeParams.refOperationIndex,this.mode=l.a.Undefined,Object(p.a)(this.actionIndex)||Object(p.a)(this.responseIndex)?Object(p.a)(this.triggerIndex)||Object(p.a)(this.responseIndex)?Object(p.a)(this.responseIndex)||(this.mode=l.a.Definition):this.mode=l.a.InlineTrigger:this.mode=l.a.InlineAction,this.baseViolator=this.baseViolatorGetter[this.mode](),this.schemaSwaggerItem={itemPath:"".concat(this.baseViolator.fullSwaggerPath).concat(c.d.Item),propertyPath:c.d.Schema},this.validationFilters={name:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.Name}))},this.processSchema(),this.selectedSchemaPropertyIndex=void 0,this.dropdownCommands=[{text:this.clientResources.Manage.Apis.EditToolTip,click:e=>{this.selectedSchemaPropertyIndex=this.schemaProperties.indexOf(e),this.selectedSchemaPropertyViolator=new c.i(this.schemaSwaggerItem,{schemaProperty:e})},iconName:d.a.Edit}],this.$scope.$watch(()=>this.selectedSchemaProperty,(e,t)=>{e&&t&&e.key===t.key&&Object(o.a)(this.swaggerEditorDataService.swagger,this.selectedSchemaProperty,this.response.item.schema,this.responseReferenceGetter[this.mode](),!1)},!0),this.$scope.$watchGroup([()=>this.swaggerValidationService.resultCollection.results,()=>this.validationFilters],()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.$timeout(()=>{var e=document.getElementById(this.nameInputId);e&&e.focus()})}var t,i,r;return t=e,(i=[{key:"selectedSchemaProperty",get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null}},{key:"response",get:function(){return this.responseGetter[this.mode]()}},{key:"shouldDisplayBackButton",get:function(){return!Object(p.a)(this.selectedSchemaPropertyIndex)||!Object(p.a)(this.actionIndex)||!Object(p.a)(this.triggerIndex)}},{key:"getSchemaPropertyIconUrl",value:function(e){return this.validationFilters[e.key]?this.validationFilters[e.key].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"navigateToReference",value:function(e){var t=this.swaggerEditorDataService.SwaggerEditorData.swagger,i=t.definitions.indexOf(t.definitions.filter(t=>t.name===e)[0]);this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl({name:"",source:a.g.definitions},i))}},{key:"getHeaderLabelId",value:function(e){return"customApiResponse-header-".concat(e)}},{key:"getHeaderTypeLabelledBy",value:function(e){return"customApiResponse-header-type-label ".concat(this.getHeaderLabelId(e))}},{key:"getHeaderDescriptionLabelledBy",value:function(e){return"customApiResponse-header-description-label ".concat(this.getHeaderLabelId(e))}}])&&g(t.prototype,i),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[r.a.services.$routeParams,r.a.services.$scope,r.a.services.$timeout,r.a.services.assetService,r.a.services.clientResources,r.a.services.customConnectorUrlService,r.a.services.navigation,r.a.services.swaggerEditorData,r.a.services.swaggerValidationService,r.a.services.telemetry]},33884:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(33359),n=i(33360),o=i(33363),a=i(33361),s=i(14754),l=i.n(s),c=i(33885),u=i.n(c),d=i(33801),p=i(12067),h=i.n(p);function m(e,t,i,s,l){var c=Object(o.h)(t,i,e);t.forEach(t=>{var p=c[t.key],m=e.definitions&&e.definitions.indexOf(e.definitions.filter(e=>e.name===p.reference)[0]),g=p.reference?e.definitions[m].item:i;if(function(e,t,i){var n=Object(a.b)(t,".","~1");h()(n,Object(o.d)("".concat(i,".description")),e.description),h()(n,Object(o.d)("".concat(i,".title")),e.leafTitle),h()(n,Object(o.d)("".concat(i,".type")),e.type),h()(n,Object(o.d)("".concat(i,".format")),e.format),e.visibility===r.l.none||null===e.visibility?u()(n,Object(o.d)("".concat(i,".").concat(r.i.Visibility))):h()(n,Object(o.d)("".concat(i,".").concat(r.i.Visibility)),e.visibility);e.dynamicValues?h()(n,Object(o.d)("".concat(i,".").concat(r.i.DynamicValues)),e.dynamicValues):u()(n,Object(o.d)("".concat(i,".").concat(r.i.DynamicValues)));e.enum?h()(n,Object(o.d)("".concat(i,".enum")),e.enum.map(e=>e.value)):u()(n,Object(o.d)("".concat(i,".enum")));if(e.default){var s=Object(d.d)(e.default);"integer"===s||"number"===s||"boolean"===s||"array"===s?h()(n,Object(o.d)("".concat(i,".default")),JSON.parse(e.default)):h()(n,Object(o.d)("".concat(i,".default")),e.default)}else u()(n,Object(o.d)("".concat(i,".default")));f(t,Object(a.b)(n,"~1","."))}(t,g,p.path),l){var y=p.reference?"#/definitions/".concat(p.reference):s;!function e(t,i,r,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=Object(a.b)(i,".","~1"),c=r;for(;!Object(n.p)(c);){var u=v(l,c);b(l,u,c,o),c=u}!Object(n.p)(s)&&Array.isArray(t.definitions)&&t.definitions.forEach(r=>{var n=Object(a.a)(r.item);Array.isArray(n[s])&&n[s].forEach(n=>{e(t,r.item,n,Array.isArray(i.required)||o,"#/definitions/".concat(r.name))})});f(i,Object(a.b)(l,"~1","."))}(e,g,p.path,t.required,y)}})}function g(e,t,i,r,n){m(e,[t],i,r,n)}function f(e,t){Object.keys(e).forEach(t=>delete e[t]),Object.keys(t).forEach(i=>e[i]=t[i])}function v(e,t){var i=t.split(".");for(i.pop();i.length>0;){var r=i.join("."),n=l()(e,r);if(n&&"object"===n.type)return r;i.pop()}return""}function b(e,t,i,r){var a=l()(e,Object(o.d)("".concat(i,".required")));r=r||Array.isArray(a)&&a.length>0;var s=Object(o.d)("".concat(t,".required")),c=l()(e,s);if(Array.isArray(c)||r){var d=function(e,t){var i=e.split(".").filter(e=>!Object(n.p)(e));return t.split(".").filter(e=>!Object(n.p)(e)).slice(0,i.length+2).pop().split("~1").join(".")}(t,i);Array.isArray(c)?r&&-1===c.indexOf(d)?c.push(d):!r&&c.indexOf(d)>-1&&c.splice(c.indexOf(d),1):c=[d],0===c.length?u()(e,s):h()(e,s,c)}}},33886:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){return e[e.InlineAction=0]="InlineAction",e[e.InlineTrigger=1]="InlineTrigger",e[e.Definition=2]="Definition",e[e.Undefined=3]="Undefined",e}({})},33887:function(e,t,i){e.exports=i.p+"static/media/customApiResponse.65eb329d.less"},33888:function(e,t){e.exports='<div class="subsection-manage customApiResponse">\n    \x3c!-- Back button --\x3e\n    <section ng-if="customApiResponseCtrl.shouldDisplayBackButton">\n        <react-action-button on-click="customApiResponseCtrl.onClickBack"\n            icon-name="customApiResponseCtrl.iconName.Back"\n            telemetry-data="customApiResponseCtrl.backButtonTelemetryData"\n            title="customApiResponseCtrl.clientResources.GoBackButtonDefaultAriaLabel"\n            text="customApiResponseCtrl.clientResources.GoBackButtonLabel">\n        </react-action-button>\n    </section>\n\n    \x3c!-- Response section --\x3e\n    <div ng-if="customApiResponseCtrl.selectedSchemaPropertyIndex === undefined">\n        <section>\n            <div class="pane-title pane-title--hasIconOrButton">\n                <h2 class="pane-title-text--hasIconOrButton">\n                    {{::customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Heading}}</h2>\n                <react-default-button id="{{::customApiResponseCtrl.importFromSampleButtonId}}"\n                    class-name="\'pane-title-button\'" primary="true" icon-name="customApiResponseCtrl.iconName.Add"\n                    on-click="customApiResponseCtrl.showResponsePane"\n                    text="::customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label">\n                </react-default-button>\n            </div>\n            <div class="pane-content">\n                \x3c!-- Name --\x3e\n                <div class="pane-field">\n                    <validated-input input-id="::customApiResponseCtrl.nameInputId"\n                        input-model="customApiResponseCtrl.response.name"\n                        validation-result-collection="customApiResponseCtrl.validationFilters.name.resultCollection"\n                        is-required="true"\n                        label="::customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Name.Label">\n                    </validated-input>\n                </div>\n                \x3c!-- Headers --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Heading}}</label>\n                    <label\n                        class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Description}}</label>\n                    <div ng-if="customApiResponseCtrl.response.item.headers">\n                        <div class="pane-field">\n                            <div class="pane-table">\n                                <div class="row pane-table-header">\n                                    <div class="column medium-4">\n                                        <label>{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Name}}</label>\n                                    </div>\n                                    <div class="column medium-5">\n                                        <label\n                                            id="customApiResponse-header-description-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Description}}</label>\n                                    </div>\n                                    <div class="column medium-3">\n                                        <label\n                                            id="customApiResponse-header-type-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Type}}</label>\n                                    </div>\n                                    <hr />\n                                </div>\n                                <div ng-repeat="(headerKey, header) in customApiResponseCtrl.response.item.headers">\n                                    <div class="row pane-table-body">\n                                        <div class="column medium-4">\n                                            <div class="c-label"\n                                                id="{{customApiResponseCtrl.getHeaderLabelId(headerKey)}}">\n                                                {{headerKey}}\n                                            </div>\n                                        </div>\n                                        <div class="column medium-5">\n                                            <div class="pane-row-input">\n                                                <input type="text" class="c-text-field" ng-model="header.description"\n                                                    ng-attr-aria-labelledby="{{::customApiResponseCtrl.getHeaderDescriptionLabelledBy(headerKey)}}" />\n                                            </div>\n                                        </div>\n                                        <div class="field column medium-3">\n                                            <div class="pane-row-input">\n                                                <react-dropdown-swagger-style\n                                                    options="::customApiResponseCtrl.headerTypes"\n                                                    selected-key="header.type"\n                                                    on-header-type-change="customApiResponseCtrl.onResponseHeaderTypeChanged"\n                                                    header-key="::headerKey"\n                                                    labelled-by="::customApiResponseCtrl.getHeaderTypeLabelledBy(headerKey)"\n                                                    is-header-type="true">\n                                                </react-dropdown-swagger-style>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                \x3c!-- References used --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Heading}}</label>\n                    <label\n                        class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Description}}</label>\n                    <div class="pane-elements" ng-if="customApiResponseCtrl.resolvedSchema.referencesUsed.length > 0">\n                        <div ng-repeat="reference in customApiResponseCtrl.resolvedSchema.referencesUsed">\n                            <a class="reference-link"\n                                ng-click="customApiResponseCtrl.navigateToReference(reference)">{{reference}}</a>\n                        </div>\n                    </div>\n                </div>\n                \x3c!-- Schema --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label>\n                    <label\n                        class="subtitle">{{customApiResponseCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label>\n                    <div class="pane-elements" ng-if="customApiResponseCtrl.schemaProperties.length > 0">\n                        <react-token-block\n                            ng-repeat="schemaproperty in customApiResponseCtrl.schemaProperties track by schemaproperty.key"\n                            commands="customApiResponseCtrl.dropdownCommands" token="schemaproperty"\n                            required="schemaproperty.required" text="schemaproperty.title || schemaproperty.name"\n                            icon-url="customApiResponseCtrl.getSchemaPropertyIconUrl(schemaproperty)">\n                        </react-token-block>\n                    </div>\n                </div>\n            </div>\n        </section>\n        \x3c!-- Validation --\x3e\n        <section>\n            <validation-results\n                heading-above-pane="customApiResponseCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading"\n                sub-heading-above-pane="customApiResponseCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Response"\n                base-violator="customApiResponseCtrl.baseViolator">\n            </validation-results>\n        </section>\n    </div>\n    \x3c!-- Schema Property section --\x3e\n    <section ng-if="customApiResponseCtrl.selectedSchemaPropertyIndex !== undefined">\n        <schema-property items="customApiResponseCtrl.schemaProperties"\n            index="customApiResponseCtrl.selectedSchemaPropertyIndex"\n            base-violator="customApiResponseCtrl.selectedSchemaPropertyViolator">\n        </schema-property>\n    </section>\n\n    <import-from-sample-panel model="customApiResponseCtrl.importPanel"></import-from-sample-panel>\n</div>'},33889:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33890);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33891);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33892),this.controller=o.a,this.controllerAs="customApiDefinitionCtrl"}));n.a.component(r.a.components.customApi.customApiDefinition,new c)},33890:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(33327),n=i(33363),o=i(33884),a=i(33357),s=i(33359),l=i(33800),c=i(33360),u=i(13272),d=i(33398);function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var m=function(){function e(t,i,r,n,s,p,h,m,g,f){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$timeout=r,this.assetService=n,this.clientResources=s,this.customConnectorUrlService=p,this.navigationService=h,this.swaggerEditorDataService=m,this.swaggerValidationService=g,this.telemetryService=f,this.iconName=u.a,this.nameInputId="customApiParameter-name-".concat(Object(c.e)()),this.backButtonTelemetryData={name:d.a.CustomApiDefinitionBackButtonClicked},this.baseViolator=void 0,this.schemaSwaggerItem=void 0,this.resolvedSchema=void 0,this.schemaProperties=[],this.dropdownCommands=void 0,this.selectedSchemaPropertyIndex=void 0,this.referencingOperationItems=[],this.inRequest=void 0,this.selectedSchemaPropertyViolator=void 0,this.validationFilters={},this.definitionIndex=void 0,this.onClickBack=()=>{this.selectedSchemaPropertyIndex=void 0,this.processSchema()},this.telemetryService.tagEvent(d.a.CustomApiDefinitionVisited),this.definitionIndex=this.$routeParams.operationIndex,this.baseViolator=new l.i({itemPath:"".concat(l.d.Definitions,"[").concat(this.definitionIndex,"]")}),this.schemaSwaggerItem={itemPath:"".concat(this.baseViolator.fullSwaggerPath).concat(l.d.Item)},this.validationFilters={name:new l.a(new l.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:l.d.Name}))},this.processSchema(),this.selectedSchemaPropertyIndex=void 0,this.dropdownCommands=[{text:this.clientResources.Manage.Apis.EditToolTip,click:e=>{this.selectedSchemaPropertyIndex=this.schemaProperties.indexOf(e),this.selectedSchemaPropertyViolator=new l.i(this.schemaSwaggerItem,{schemaProperty:e})},iconName:u.a.Edit}];var v=a.x(this.swaggerEditorDataService.swagger,this.definition.name);this.referencingOperationItems=v.map(e=>e.operationItem),this.inRequest=v.some(e=>e.referenceType===a.K),this.$scope.$watch(()=>this.selectedSchemaProperty,(e,t)=>{e&&t&&e.key===t.key&&Object(o.a)(this.swaggerEditorDataService.swagger,this.selectedSchemaProperty,this.definition.item,"#/definitions/".concat(this.definition.name),e.required!==t.required)},!0),this.$scope.$watchGroup([()=>this.swaggerValidationService.resultCollection.results,()=>this.validationFilters],()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.$timeout(()=>{var e=document.getElementById(this.nameInputId);e&&e.focus()})}var t,i,r;return t=e,(i=[{key:"definition",get:function(){return this.swaggerEditorDataService.swagger.definitions[this.definitionIndex]}},{key:"selectedSchemaProperty",get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null}},{key:"processSchema",value:function(){this.resolvedSchema=n.g(this.swaggerEditorDataService.swagger,this.definition.item),this.schemaProperties=n.c(this.resolvedSchema.schema),this.schemaProperties.forEach(e=>{this.validationFilters[e.key]||(this.validationFilters[e.key]=new l.a(new l.i(this.schemaSwaggerItem,{schemaProperty:e})))})}},{key:"getSchemaPropertyIconUrl",value:function(e){return this.validationFilters[e.key]?this.validationFilters[e.key].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"navigateToReference",value:function(e){var t=this.swaggerEditorDataService.swagger.definitions.indexOf(this.swaggerEditorDataService.swagger.definitions.filter(t=>t.name===e)[0]);this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl({name:"",source:s.g.definitions},t))}}])&&p(t.prototype,i),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();m.$inject=[r.a.services.$routeParams,r.a.services.$scope,r.a.services.$timeout,r.a.services.assetService,r.a.services.clientResources,r.a.services.customConnectorUrlService,r.a.services.navigation,r.a.services.swaggerEditorData,r.a.services.swaggerValidationService,r.a.services.telemetry]},33891:function(e,t,i){e.exports=i.p+"static/media/customApiDefinition.ca8a1230.less"},33892:function(e,t){e.exports='<div class="subsection-manage custom-api-definition">\n    \x3c!-- Back button --\x3e\n    <section ng-if="customApiDefinitionCtrl.selectedSchemaPropertyIndex !== undefined">\n        <react-action-button\n            on-click="customApiDefinitionCtrl.onClickBack"\n            icon-name="customApiDefinitionCtrl.iconName.Back"\n            telemetry-data="customApiDefinitionCtrl.backButtonTelemetryData"\n            title="customApiDefinitionCtrl.clientResources.GoBackButtonDefaultAriaLabel"\n            text="customApiDefinitionCtrl.clientResources.GoBackButtonLabel">\n        </react-action-button>\n    </section>\n\n    \x3c!-- Definition section --\x3e\n    <div ng-if="customApiDefinitionCtrl.selectedSchemaPropertyIndex === undefined">\n        <section>\n            <h2 class="pane-title">\n                {{customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Heading}}\n            </h2>\n            <div class="pane-content">\n                \x3c!-- Name --\x3e\n                <div class="pane-field">\n                    <validated-input\n                        input-id="::customApiDefinitionCtrl.nameInputId"\n                        label="::customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Definition.Name.Label"\n                        input-model="customApiDefinitionCtrl.definition.name"\n                        validation-result-collection="customApiDefinitionCtrl.validationFilters.name.resultCollection"\n                        is-required="true" >\n                    </validated-input>\n                </div>\n                \x3c!-- References Used --\x3e\n                <div class="pane-field" ng-if="customApiDefinitionCtrl.resolvedSchema.referencesUsed.length > 0">\n                    <label class="pane-field-label">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Heading}}</label>\n                    <label class="subtitle">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Description}}</label>\n                    <div class="pane-elements">\n                        <div ng-repeat="reference in customApiDefinitionCtrl.resolvedSchema.referencesUsed">\n                            <a class="reference-link" ng-click="customApiDefinitionCtrl.navigateToReference(reference)">{{reference}}</a>\n                        </div>\n                    </div>\n                </div>\n                \x3c!-- Schema --\x3e\n                <div class="pane-field" ng-if="customApiDefinitionCtrl.schemaProperties.length > 0">\n                    <label class="pane-field-label">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label>\n                    <label class="subtitle">{{customApiDefinitionCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="schemaProperty in customApiDefinitionCtrl.schemaProperties track by schemaProperty.key"\n                            commands="customApiDefinitionCtrl.dropdownCommands"\n                            token="schemaProperty"\n                            required="schemaProperty.required"\n                            text="schemaProperty.title || schemaProperty.name"\n                            icon-url="customApiDefinitionCtrl.getSchemaPropertyIconUrl(schemaProperty)" >\n                        </react-token-block>\n                    </div>\n                </div>\n            </div>\n        </section>\n        \x3c!-- Validation --\x3e\n        <section>\n            <validation-results\n                heading-above-pane="customApiDefinitionCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading"\n                sub-heading-above-pane="customApiDefinitionCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Definition"\n                base-violator="customApiDefinitionCtrl.baseViolator">\n            </validation-results>\n        </section>\n    </div>\n\n    \x3c!-- Schema Property section --\x3e\n    <section ng-if="customApiDefinitionCtrl.selectedSchemaPropertyIndex !== undefined">\n        <schema-property\n            items="customApiDefinitionCtrl.schemaProperties"\n            index="customApiDefinitionCtrl.selectedSchemaPropertyIndex"\n            base-violator="customApiDefinitionCtrl.selectedSchemaPropertyViolator"\n            referencing-operation-items="customApiDefinitionCtrl.referencingOperationItems"\n            in-request="customApiDefinitionCtrl.inRequest" >\n        </schema-property>\n    </section>\n</div>'},33893:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33894);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33896),this.controller=o.a,this.controllerAs="customApiPolicyCtrl"}));n.a.component(r.a.components.customApi.customApiPolicy,new c)},33894:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33327),n=i(17371),o=i(33895),a=i(33398);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.clientResources=i,this.policyDataService=r,this.swaggerEditorDataService=n,this.telemetryService=o,this.policyItem=void 0,this.policyResources=void 0,this.operationOptions=void 0,this.policyTypeOptions=void 0,this.parameterOptions=new Map,this.operationOnChange=(e,t)=>{var i=this.policyDataService.getOperationItemById(t.key);if(t.selected)this.policyItem.operations.push(i);else{var r=this.policyItem.operations.indexOf(i);r>-1&&this.policyItem.operations.splice(r,1)}},this.policyResources=this.clientResources.Manage.CustomApi.RightPane.Policy,this.telemetryService.tagEvent(a.a.CustomApiPolicyVisited),this.policyItem=this.policyDataService.policyItems[this.$routeParams.operationIndex],this.operationOptions=this.buildOperationOptions(),this.policyTypeOptions=this.buildPolicyTypeOptions()}var t,i,r;return t=e,(i=[{key:"buildOperationOptions",value:function(){var e=[],{actions:t,triggers:i}=this.swaggerEditorDataService.swagger;if(t&&0!==t.length)for(var r of(e.push({key:"Actions_Header_1fa8160d-36ab-34da-1aef-2816abe393af",text:"Actions",itemType:n.b.Header}),t))e.push({key:r.operation.operationId,text:r.operation.operationId,itemType:n.b.Normal,selected:this.policyItem.operations.includes(r)});if(t&&0!==t.length&&i&&0!==i.length&&e.push({key:"Divider_8774fcda-2ba8-43a5-8fb4-1fdb498f4a86",text:"-",itemType:n.b.Divider}),i&&0!==i.length)for(var o of(e.push({key:"Triggers_Header_e3d251f2-9c02-ac9c-1aa8-e2e0df41ad17",text:"Triggers",itemType:n.b.Header}),i))e.push({key:o.operation.operationId,text:o.operation.operationId,itemType:n.b.Normal,selected:this.policyItem.operations.includes(o)});return e}},{key:"buildPolicyTypeOptions",value:function(){return this.policyDataService.policyTypes.filter(e=>e.flavor===o.h.General).map(e=>({select:e.id,label:e.title+(e.isPreview?" ("+this.policyResources.Type.PreviewTag+")":"")}))}},{key:"policyTypeId",get:function(){return this.policyItem.type.id},set:function(e){this.policyItem.type=this.policyDataService.getPolicyTypeById(e),this.parameterOptions.clear(),this.policyItem.operations.length=0}},{key:"getParameterInputType",value:function(e){switch(e.parameter.type){case o.f.Boolean:return"checkbox";case o.f.String:return void 0!==e.parameter.allowedValues?"select":"text";case o.f.Integer:return"number";default:return"text"}}},{key:"getParameterOptions",value:function(e){var t=e.parameter;if(!this.parameterOptions.has(t.id)){if(t.type!==o.f.String||void 0===t.allowedValues)return;var i=t.allowedValues.map(e=>({select:e,label:e}));this.parameterOptions.set(t.id,i)}return this.parameterOptions.get(t.id)}},{key:"showOperations",value:function(){return this.policyItem.type!==o.g.Empty&&!this.policyItem.type.allOperations}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[r.a.services.$routeParams,r.a.services.clientResources,r.a.services.policyDataService,r.a.services.swaggerEditorData,r.a.services.telemetry]},33895:function(e,t,i){"use strict";i.d(t,"f",(function(){return w})),i.d(t,"a",(function(){return C})),i.d(t,"b",(function(){return k})),i.d(t,"i",(function(){return P})),i.d(t,"c",(function(){return x})),i.d(t,"h",(function(){return A})),i.d(t,"g",(function(){return T})),i.d(t,"e",(function(){return R})),i.d(t,"d",(function(){return O}));var r,n=i(14751),o=i.n(n),a=i(33800),s=i(13083),l=i(13031),c=i(14876),u=i(12330);function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function b(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var w=function(e){return e[e.Boolean=0]="Boolean",e[e.Integer=1]="Integer",e[e.String=2]="String",e[e.KeyValue=3]="KeyValue",e}({}),S=function(){function e(t,i,r,n,o,a,s){if(f(this,e),this.clientResources=t,this.id=i,this.title=r,this.description=n,this.type=o,this.isRequired=a,this.defaultValue=s,this.parameterValidationResults=void 0,F(this.id,"id"),F(this.title,"title"),F(this.description,"description"),this.parameterValidationResults=t.Validate.CustomApi.PolicyResults.Parameter,void 0!==this.defaultValue&&!this.validate(I(this.defaultValue)).isEmpty)throw new Error("Default value '".concat(this.defaultValue,"' of parameter '").concat(this.id,"' is not valid"))}return b(e,[{key:"validate",value:function(e){var t=new a.h;return!this.isRequired&&Object(c.a)(e)||(Object(c.a)(e)&&t.add(a.g.Error(this.parameterValidationResults.Base.MustNotBeEmpty)),/^\s*@\s*[{(]/.test(e)&&t.add(a.g.Error(this.parameterValidationResults.Base.MustNotBeExpression)),this.validateBasedOnType(e,t)),t}}]),e}(),C=function(e){d(i,e);var t=h(i);function i(e,r,n,o,a,s){var l;return f(this,i),(l=t.call(this,e,r,n,o,w.Boolean,a,s)).clientResources=e,l}return b(i,[{key:"validateBasedOnType",value:function(e,t){}}]),i}(S),k=function(e){d(i,e);var t=h(i);function i(e,r,n,o,a,s,l,c){var u;return f(this,i),(u=t.call(this,e,r,n,o,w.Integer,a,s)).clientResources=e,u.minValue=l,u.maxValue=c,u}return b(i,[{key:"validateBasedOnType",value:function(e,t){var i=/^(?:0|[1-9]\d*)$/.test(e),r=Number(e);void 0!==this.minValue&&void 0!==this.maxValue&&(!i||r>this.maxValue||r<this.minValue)?t.add(a.g.Error(Object(l.a)(this.parameterValidationResults.Integer.MustBeBetween,this.minValue,this.maxValue))):void 0!==this.minValue&&(!i||r<this.minValue)?t.add(a.g.Error(Object(l.a)(this.parameterValidationResults.Integer.MustBeGreater,this.minValue))):void 0!==this.maxValue&&(!i||r>this.maxValue)?t.add(a.g.Error(Object(l.a)(this.parameterValidationResults.Integer.MustBeLess,this.maxValue))):i||t.add(a.g.Error(this.parameterValidationResults.Integer.MustBeInteger))}}]),i}(S),P=function(e){d(i,e);var t=h(i);function i(e,r,n,o,a,s,l){var c;return f(this,i),(c=t.call(this,e,r,n,o,w.String,a,s)).clientResources=e,c.allowedValues=l,c}return b(i,[{key:"validateBasedOnType",value:function(e,t){void 0===this.allowedValues||this.allowedValues.includes(e)||t.add(a.g.Error(this.parameterValidationResults.String.MustBeAllowed))}}]),i}(S),x=function(e){d(i,e);var t=h(i);function i(e,r,n,o,a){var s;return f(this,i),(s=t.call(this,e,r,n,o,w.KeyValue,a,{key:"",value:""})).clientResources=e,s}return b(i,[{key:"validateBasedOnType",value:function(e,t){}}]),i}(S),A=function(e){return e[e.General=0]="General",e[e.PollingTrigger=1]="PollingTrigger",e}({}),T=b((function e(t,i,r,n,o,a,s,l,c){var u=arguments.length>9&&void 0!==arguments[9]&&arguments[9];f(this,e),this.id=t,this.title=i,this.description=r,this.flavor=n,this.isPreview=o,this.allOperations=a,this.operationTitle=s,this.operationDescription=l,this.parameters=c,u||(F(this.id,"id"),F(this.title,"title"),F(this.description,"description"),this.allOperations||(F(this.operationTitle,"operationTitle"),F(this.operationDescription,"operationDescription")))}));r=T,T.PollingTrigger="pollingtrigger",T.Empty=new r("","","",A.General,!1,!1,"","",[],!0);var R=function(){function e(t,i){f(this,e),this.parameter=t,this.value=i,this.validationResults=new a.h,E(t,"parameter"),void 0===this.value&&(this.value=o()(t.defaultValue))}return b(e,[{key:"validate",value:function(){D(this.parameter.validate(I(this.value)),this.validationResults)}}]),e}(),O=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T.Empty,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];f(this,e),this.clientResources=t,this.name=i,this.operations=n,this.nameValidationResults=new a.h,this.typeValidationResults=new a.h,this.parameterItems=void 0,this.policyValidationResult=void 0,this._type=void 0,E(n,"operations"),E(o,"parameterItems"),this.policyValidationResult=this.clientResources.Validate.CustomApi.PolicyResults.Item,this.type=r,this.updateParameterItems(o)}return b(e,[{key:"type",get:function(){return this._type},set:function(e){this._type!==e&&(this._type=e,this.parameterItems=this._type.parameters.map(e=>new R(e)))}},{key:"validationResults",get:function(){var e=new a.h;for(var t of(e.add(this.nameValidationResults),e.add(this.typeValidationResults),this.parameterItems))e.add(t.validationResults);return e}},{key:"validate",value:function(e){this.validateName(e),this.validateType(),this.validateParameterItems()}},{key:"updateParameterItems",value:function(e){for(var t of e)for(var i of this.parameterItems)if(i.parameter.id===t.parameter.id){i.value=t.value;break}}},{key:"validateName",value:function(e){var t=new a.h;Object(c.a)(this.name)?t.add(a.g.Error(this.policyValidationResult.NameNotDefined)):e.filter(e=>this.name===e).length>1&&t.add(a.g.Error(this.policyValidationResult.NameNotUnique)),D(t,this.nameValidationResults)}},{key:"validateType",value:function(){var e=new a.h;this.type===T.Empty&&e.add(a.g.Error(this.policyValidationResult.TypeNotDefined)),D(e,this.typeValidationResults)}},{key:"validateParameterItems",value:function(){for(var e of this.parameterItems)e.validate()}}]),e}();function D(e,t){if(e.results.length===t.results.length){for(var i=e.results.length-1;i>=0;i--)if(e.results[i].type!==t.results[i].type||e.results[i].message!==t.results[i].message)return void(t.results=e.results)}else t.results=e.results}function E(e,t){if(Object(u.a)(e))throw new Error("Value of '".concat(t,"' cannot be null"))}function F(e,t){if(Object(s.a)(e))throw new Error("Value of string '".concat(t,"' cannot be empty"))}function I(e){return void 0===e?void 0:String(e)}},33896:function(e,t){e.exports='<div class="subsection-manage">\n    \x3c!-- General section --\x3e\n    <section>\n        <h2 class="pane-title">{{::customApiPolicyCtrl.policyResources.PolicyDetails.Heading}}</h2>\n        <div class="pane-content">\n            \x3c!-- Name --\x3e\n            <div class="pane-field">\n                <validated-input label="::customApiPolicyCtrl.policyResources.Name.Label"\n                                 input-model="customApiPolicyCtrl.policyItem.name"\n                                 validation-result-collection="customApiPolicyCtrl.policyItem.nameValidationResults"\n                                 is-required="true">\n                </validated-input>\n            </div>\n            \x3c!-- Type --\x3e\n            <div class="pane-field">\n                <validated-input label="::customApiPolicyCtrl.policyResources.Type.Label"\n                                 input-model="customApiPolicyCtrl.policyTypeId"\n                                 input-placeholder="::customApiPolicyCtrl.policyResources.Type.Placeholder"\n                                 input-options="::customApiPolicyCtrl.policyTypeOptions"\n                                 input-type="select"\n                                 validation-result-collection="customApiPolicyCtrl.policyItem.typeValidationResults"\n                                 is-required="true"\n                                 learn-more-resource="::\'Manage.CustomApi.RightPane.Policy.Type.LearnMoreLink\'"\n                                 learn-more-link-aria-label="::customApiPolicyCtrl.policyResources.Type.LearnMoreAriaLabel">\n                </validated-input>\n                <label class="pane-field-label">{{customApiPolicyCtrl.policyItem.type.description}}</label>\n            </div>\n            <div ng-if="customApiPolicyCtrl.policyTypeId">\n                \x3c!-- Operations --\x3e\n                <div class="pane-field" ng-if="customApiPolicyCtrl.showOperations()">\n                    <label class="pane-field-label">\n                        {{::customApiPolicyCtrl.policyItem.type.operationTitle}}\n                    </label>\n                    <label class="subtitle">\n                        {{::customApiPolicyCtrl.policyItem.type.operationDescription}}\n                    </label>\n                    <react-dropdown multi-select="::true"\n                                    options="::customApiPolicyCtrl.operationOptions"\n                                    selected-keys="customApiPolicyCtrl.operationSelectedKeys"\n                                    on-change="::customApiPolicyCtrl.operationOnChange">\n                    </react-dropdown>\n                </div>\n                \x3c!-- Policy Parameters --\x3e\n                <div class="pane-field" ng-repeat="parameterItem in customApiPolicyCtrl.policyItem.parameterItems">\n                    <validated-input label="::parameterItem.parameter.title"\n                                     description="::parameterItem.parameter.description"\n                                     input-model="parameterItem.value"\n                                     input-options="::customApiPolicyCtrl.getParameterOptions(parameterItem)"\n                                     input-type="{{::customApiPolicyCtrl.getParameterInputType(parameterItem)}}"\n                                     validation-result-collection="parameterItem.validationResults"\n                                     is-required="::parameterItem.parameter.isRequired">\n                    </validated-input>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>'},33897:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33898);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33899),this.controller=o.a,this.controllerAs="customApiParameterCtrl"}));r.a.component(n.a.components.customApi.customApiParameter,new c)},33898:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var r=i(13083),n=i(33327),o=i(33360),a=i(33359),s=i(33886),l=i(33804),c=i(33800),u=i(33884),d=i(33363),p=i(33357),h=i(33801),m=i(13272),g=i(12330),f=i(33398),v=i(17914);function b(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var w=function(){function e(t,i,n,d,b,y,w,S,C,k){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$timeout=n,this.assetService=d,this.clientResources=b,this.customConnectorUrlService=y,this.navigationService=w,this.swaggerEditorDataService=S,this.swaggerValidationService=C,this.telemetryService=k,this.iconName=m.a,this.nameInputId="customApiParameter-name-".concat(Object(o.e)()),this.backButtonTelemetryData={name:f.a.CustomApiParameterBackButtonClicked},this.actionIndex=void 0,this.triggerIndex=void 0,this.parameterIndex=void 0,this.referencingOperationItems=[],this.selectedSchemaPropertyViolator=void 0,this.defaultParameterValue=void 0,this.baseViolator=void 0,this.schemaSwaggerItem=void 0,this.validationFilters={},this.mode=void 0,this.resolvedSchema=void 0,this.requiredOptions=void 0,this.locationOptions=void 0,this.schemaProperties=[],this.selectedSchemaPropertyIndex=void 0,this.parameterVisibility=void 0,this.dropdownCommands=void 0,this.availableTypes=[{key:l.d.string,text:l.d.string},{key:l.d.integer,text:l.d.integer},{key:l.d.number,text:l.d.number},{key:l.d.boolean,text:l.d.boolean},{key:l.d.array,text:l.d.array}],this.availableFormats={string:[{key:"",text:""},{key:"byte",text:"byte"},{key:"binary",text:"binary"},{key:"date",text:"date"},{key:"date-time",text:"date-time"},{key:"password",text:"password"}],integer:[{key:"int32",text:"int32"},{key:"int64",text:"int64"}],number:[{key:"float",text:"float"},{key:"double",text:"double"}],boolean:[],array:[],object:[]},this.visibilityOptions=Object.keys(a.l).map(e=>({key:a.l[e],text:a.l[e]})),this.visibilityOptionsLabelLink=void 0,this.parameterGetter={[s.a.InlineAction]:()=>this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation.parameters[this.parameterIndex],[s.a.InlineTrigger]:()=>this.swaggerEditorDataService.swagger.triggers[this.triggerIndex].operation.parameters[this.parameterIndex],[s.a.Definition]:()=>this.swaggerEditorDataService.swagger.parameters[this.parameterIndex].item,[s.a.Undefined]:()=>({})},this.parameterReferenceGetter={[s.a.InlineAction]:()=>"",[s.a.InlineTrigger]:()=>"",[s.a.Definition]:()=>"#/parameters/".concat(this.swaggerEditorDataService.swagger.parameters[this.parameterIndex].name),[s.a.Undefined]:()=>""},this.operationItemGetter={[s.a.InlineAction]:()=>this.swaggerEditorDataService.swagger.actions[this.actionIndex],[s.a.InlineTrigger]:()=>this.swaggerEditorDataService.swagger.triggers[this.triggerIndex],[s.a.Definition]:()=>null,[s.a.Undefined]:()=>null},this.baseViolatorGetter={[s.a.InlineAction]:()=>new c.i({itemPath:"".concat(c.d.Actions,"[").concat(this.actionIndex,"]").concat(c.d.OperationParameters,"[").concat(this.parameterIndex,"]")}),[s.a.InlineTrigger]:()=>new c.i({itemPath:"".concat(c.d.Triggers,"[").concat(this.triggerIndex,"]").concat(c.d.OperationParameters,"[").concat(this.parameterIndex,"]")}),[s.a.Definition]:()=>new c.i({itemPath:"".concat(c.d.Parameters,"[").concat(this.parameterIndex,"]").concat(c.d.Item)}),[s.a.Undefined]:()=>null},this.onClickBack=()=>{Object(g.a)(this.selectedSchemaPropertyIndex)?Object(g.a)(this.actionIndex)?Object(g.a)(this.triggerIndex)||this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(v.a.triggers,this.triggerIndex)):this.navigationService.navigate(this.customConnectorUrlService.getCustomApiDefinitionTypeUrl(v.a.actions,this.actionIndex)):(this.selectedSchemaPropertyIndex=void 0,this.processSchema())},this.onRequiredOptionChange=(e,t)=>{this.parameter.required=t.key===(!0).toString()},this.onVisibilityChange=(e,t)=>{this.parameterVisibility=t.key,this.visibilityChanged()},this.onLocationChange=(e,t)=>{this.parameter.in=t.key},this.onTypeChanged=(e,t)=>{this.parameter.type=t.key},this.onFormatChanged=(e,t)=>{this.parameter.format=t.key},this.requiredOptions=[{key:(!0).toString(),text:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.Yes},{key:(!1).toString(),text:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.No}],this.locationOptions=[{key:l.c.path,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Path,disabled:!0},{key:l.c.query,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Query,disabled:!0},{key:l.c.header,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Header,disabled:!0},{key:l.c.body,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Body,disabled:!0}],this.visibilityOptionsLabelLink={href:this.clientResources.Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.RightPane.Parameter.Visibility.LearnMoreAriaLabel,telemetryData:{name:"CustomApiParameter.Visibility.LearnMoreClicked"}},this.telemetryService.tagEvent(f.a.CustomApiParameterVisited);var P=this.$routeParams.operation;P===v.a.actions?this.actionIndex=this.$routeParams.operationIndex:P===v.a.triggers&&(this.triggerIndex=this.$routeParams.operationIndex),this.parameterIndex=Object(g.a)(this.$routeParams.refOperationIndex)?this.$routeParams.operationIndex:this.$routeParams.refOperationIndex,this.availableFormats.string.push({key:"html",text:"html"}),this.mode=s.a.Undefined,Object(g.a)(this.actionIndex)||Object(g.a)(this.parameterIndex)?Object(g.a)(this.triggerIndex)||Object(g.a)(this.parameterIndex)?Object(g.a)(this.parameterIndex)||(this.mode=s.a.Definition):this.mode=s.a.InlineTrigger:this.mode=s.a.InlineAction,this.baseViolator=this.baseViolatorGetter[this.mode](),this.schemaSwaggerItem={itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.Schema},this.validationFilters={name:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.Name})),summary:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.XMsSummary})),description:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.Description})),default:new c.a(new c.i({itemPath:this.baseViolator?this.baseViolator.fullSwaggerPath:void 0,propertyPath:c.d.Default}))},this.parameterVisibility=this.parameter[a.i.Visibility]||a.l.none,this.selectedSchemaPropertyIndex=void 0,this.processSchema(),this.dropdownCommands=[{text:this.clientResources.Manage.Apis.EditToolTip,click:e=>{this.selectedSchemaPropertyIndex=this.schemaProperties.indexOf(e),this.selectedSchemaPropertyViolator=new c.i(this.schemaSwaggerItem,{schemaProperty:e})},iconName:m.a.Edit}],this.mode===s.a.InlineAction||this.mode===s.a.InlineTrigger?this.referencingOperationItems=[this.operationItem]:this.mode===s.a.Definition&&(this.referencingOperationItems=p.r(this.swaggerEditorDataService.swagger,this.swaggerEditorDataService.swagger.parameters[this.parameterIndex].name)),this.$scope.$watch(()=>this.selectedSchemaProperty,(e,t)=>{e&&t&&e.key===t.key&&Object(u.a)(this.swaggerEditorDataService.swagger,this.selectedSchemaProperty,this.parameter.schema,this.parameterReferenceGetter[this.mode](),e.required!==t.required)},!0),this.$scope.$watchGroup([()=>this.swaggerValidationService.resultCollection.results,()=>this.validationFilters],()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.isBodyParameter||(this.defaultParameterValue=this.parameter.default,this.$scope.$watch(()=>this.defaultParameterValue,e=>{var t=Object(h.d)(e);this.parameter.default="integer"===t||"number"===t||"boolean"===t||"array"===t?JSON.parse(e):Object(r.a)(e)?void 0:e})),this.$timeout(()=>{var e=document.getElementById(this.nameInputId);e&&e.focus()})}var t,i,n;return t=e,(i=[{key:"selectedVisibilityOption",get:function(){return this.parameter[a.i.Visibility]}},{key:"selectedRequiredOption",get:function(){return(!!this.parameter.required).toString()}},{key:"selectedLocationOption",get:function(){return this.parameter.in}},{key:"parameter",get:function(){return this.parameterGetter[this.mode]()}},{key:"operationItem",get:function(){return this.operationItemGetter[this.mode]()}},{key:"shouldDisplayBackButton",get:function(){return!Object(g.a)(this.selectedSchemaPropertyIndex)||!Object(g.a)(this.actionIndex)||!Object(g.a)(this.triggerIndex)}},{key:"isBodyParameter",get:function(){return"body"===this.parameter.in}},{key:"selectedSchemaProperty",get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null}},{key:"processSchema",value:function(){this.isBodyParameter&&this.parameter.schema&&(this.resolvedSchema=d.g(this.swaggerEditorDataService.swagger,this.parameter.schema),this.schemaProperties=d.c(this.resolvedSchema.schema),this.schemaProperties.forEach(e=>{this.validationFilters[e.key]||(this.validationFilters[e.key]=new c.a(new c.i(this.schemaSwaggerItem,{schemaProperty:e})))}))}},{key:"getSchemaPropertyIconUrl",value:function(e){return this.validationFilters[e.key]?this.validationFilters[e.key].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"visibilityChanged",value:function(){this.parameterVisibility===a.l.none?(delete this.parameter[a.i.Visibility],this.parameter.schema&&delete this.parameter.schema[a.i.Visibility]):(this.parameter[a.i.Visibility]=this.parameterVisibility,this.parameter.schema&&(this.parameter.schema[a.i.Visibility]=this.parameterVisibility))}}])&&b(t.prototype,i),n&&b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();w.$inject=[n.a.services.$routeParams,n.a.services.$scope,n.a.services.$timeout,n.a.services.assetService,n.a.services.clientResources,n.a.services.customConnectorUrlService,n.a.services.navigation,n.a.services.swaggerEditorData,n.a.services.swaggerValidationService,n.a.services.telemetry]},33899:function(e,t){e.exports='<div class="subsection-manage custom-api-parameter">\n    \x3c!-- Back button --\x3e\n    <section ng-if="customApiParameterCtrl.shouldDisplayBackButton">\n        <react-action-button on-click="customApiParameterCtrl.onClickBack"\n            icon-name="customApiParameterCtrl.iconName.Back"\n            telemetry-data="customApiParameterCtrl.backButtonTelemetryData"\n            title="customApiParameterCtrl.clientResources.GoBackButtonDefaultAriaLabel"\n            text="customApiParameterCtrl.clientResources.GoBackButtonLabel">\n        </react-action-button>\n    </section>\n    <div>\n        <section ng-if="customApiParameterCtrl.selectedSchemaPropertyIndex === undefined">\n            <h2 class="pane-title">\n                {{::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Heading}}\n            </h2>\n            <div class="pane-content">\n                \x3c!-- Name --\x3e\n                <div class="pane-field">\n                    <validated-input input-id="::customApiParameterCtrl.nameInputId"\n                        input-model="customApiParameterCtrl.parameter.name"\n                        validation-result-collection="customApiParameterCtrl.validationFilters.name.resultCollection"\n                        is-required="true"\n                        label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Name.Label">\n                    </validated-input>\n                </div>\n                \x3c!-- Description --\x3e\n                <div class="pane-field" ng-if="!customApiParameterCtrl.isBodyParameter">\n                    <validated-input input-model="customApiParameterCtrl.parameter.description"\n                        validation-result-collection="customApiParameterCtrl.validationFilters.description.resultCollection"\n                        label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Description.Label"\n                        learn-more-resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"\n                        learn-more-link-aria-label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Description.LearnMoreAriaLabel">\n                    </validated-input>\n                </div>\n                \x3c!-- Summary --\x3e\n                <div class="pane-field" ng-if="!customApiParameterCtrl.isBodyParameter">\n                    <validated-input input-model="customApiParameterCtrl.parameter[\'x-ms-summary\']"\n                        validation-result-collection="customApiParameterCtrl.validationFilters.summary.resultCollection"\n                        label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Summary.Label"\n                        learn-more-resource="\'Manage.CustomApi.Definition.RightPane.XMSSummary.Hyperlink\'"\n                        learn-more-link-aria-label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Summary.LearnMoreAriaLabel">\n                    </validated-input>\n                </div>\n                \x3c!-- Default --\x3e\n                <div class="pane-field" ng-if="!customApiParameterCtrl.isBodyParameter">\n                    <validated-input input-model="customApiParameterCtrl.defaultParameterValue"\n                        validation-result-collection="customApiParameterCtrl.validationFilters.default.resultCollection"\n                        label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.DefaultValue.Label">\n                    </validated-input>\n                </div>\n                \x3c!-- Required --\x3e\n                <div class="pane-field">\n                    <react-choice-group options="::customApiParameterCtrl.requiredOptions"\n                        label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Required.Label"\n                        direction="\'horizontal\'" selected-key="customApiParameterCtrl.selectedRequiredOption"\n                        on-change="::customApiParameterCtrl.onRequiredOptionChange"></react-choice-group>\n                </div>\n                \x3c!-- Visibility --\x3e\n                <div class="pane-field">\n                    <react-choice-group-with-link options="::customApiParameterCtrl.visibilityOptions"\n                        label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.General.Visibility.Label"\n                        label-link="::customApiParameterCtrl.visibilityOptionsLabelLink" direction="\'horizontal\'"\n                        selected-key="customApiParameterCtrl.parameterVisibility"\n                        on-change="::customApiParameterCtrl.onVisibilityChange"></react-choice-group-with-link>\n                </div>\n                \x3c!-- Location --\x3e\n                <div class="pane-field">\n                    <react-choice-group options="::customApiParameterCtrl.locationOptions"\n                        label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Label"\n                        direction="\'horizontal\'" required="true"\n                        selected-key="customApiParameterCtrl.selectedLocationOption"\n                        on-change="::customApiParameterCtrl.onLocationChange"></react-choice-group>\n                </div>\n                \x3c!-- Type --\x3e\n                <div class="pane-field pane-field-multiselect" ng-if="!customApiParameterCtrl.isBodyParameter">\n                    <div class="select-option-container">\n                        <react-dropdown-swagger-style id="customApiParameter-type"\n                            label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Type.Label"\n                            options="::customApiParameterCtrl.availableTypes"\n                            selected-key="customApiParameterCtrl.parameter.type"\n                            on-change="customApiParameterCtrl.onTypeChanged">\n                        </react-dropdown-swagger-style>\n                    </div>\n                    <div class="select-option-container">\n                        <react-dropdown-swagger-style id="customApiParameter-format"\n                            is-disabled="customApiParameterCtrl.parameter.type.length === 0 || customApiParameterCtrl.availableFormats[customApiParameterCtrl.parameter.type].length === 0"\n                            label="::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Format.Label"\n                            options="customApiParameterCtrl.availableFormats[customApiParameterCtrl.parameter.type]"\n                            selected-key="customApiParameterCtrl.parameter.format"\n                            on-change="customApiParameterCtrl.onFormatChanged">\n                        </react-dropdown-swagger-style>\n                    </div>\n                </div>\n                \x3c!-- Dropdown Editor --\x3e\n                <parameter-dropdown-editor\n                    ng-if="!customApiParameterCtrl.isBodyParameter"\n                    parameter="customApiParameterCtrl.parameter"\n                    operation-items="customApiParameterCtrl.referencingOperationItems">\n                </parameter-dropdown-editor>\n                \x3c!-- Schema --\x3e\n                <div class="pane-field"\n                    ng-if="customApiParameterCtrl.isBodyParameter && customApiParameterCtrl.schemaProperties.length > 0">\n                    <label\n                        class="pane-field-label">{{::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiParameterCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="schemaProperty in customApiParameterCtrl.schemaProperties track by schemaProperty.key"\n                            commands="customApiParameterCtrl.dropdownCommands" token="schemaProperty"\n                            required="schemaProperty.required" text="schemaProperty.title || schemaProperty.name"\n                            icon-url="customApiParameterCtrl.getSchemaPropertyIconUrl(schemaProperty)"></react-token-block>\n                    </div>\n                </div>\n            </div>\n        </section>\n        \x3c!-- Validation --\x3e\n        <section ng-if="customApiParameterCtrl.selectedSchemaPropertyIndex === undefined ">\n            <validation-results\n                heading-above-pane="::customApiParameterCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading"\n                sub-heading-above-pane="::customApiParameterCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Parameter"\n                base-violator="customApiParameterCtrl.baseViolator">\n            </validation-results>\n        </section>\n    </div>\n    \x3c!-- Schema Property section --\x3e\n    <section ng-if="customApiParameterCtrl.selectedSchemaPropertyIndex !== undefined">\n        <schema-property items="customApiParameterCtrl.schemaProperties"\n            index="customApiParameterCtrl.selectedSchemaPropertyIndex"\n            base-violator="customApiParameterCtrl.selectedSchemaPropertyViolator"\n            referencing-operation-items="customApiParameterCtrl.referencingOperationItems" in-request="true">\n        </schema-property>\n    </section>\n</div>'},33900:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33901);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33903);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33904),this.controller=o.a,this.controllerAs="customApiTriggerCtrl"}));n.a.component(r.a.components.customApi.customApiTrigger,new c)},33901:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var r=i(12067),n=i.n(r),o=i(33885),a=i.n(o),s=i(12330),l=i(33327),c=i(13272),u=i(33360),d=i(33359),p=i(33895),h=i(33804),m=i(33902),g=i(33800),f=i(33801),v=i(33884),b=i(33357),y=i(33802),w=i(33803),S=i(33363),C=i(15700),k=i(33398),P=i(17914);function x(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,A(r.key),r)}}function A(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var T=function(){function e(t,i,r,n,o,a,s,l,C,P,x){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$timeout=r,this.assetService=n,this.clientResources=o,this.customConnectorUrlService=a,this.navigationService=s,this.policyDataService=l,this.swaggerEditorDataService=C,this.swaggerValidationService=P,this.telemetryService=x,this.iconName=c.a,this.importRequestButtonId="customApiTrigger-importRequestButton-".concat(Object(u.e)()),this.importRequestDayZeroButtonId="customApiTrigger-importRequestDayZeroButton-".concat(Object(u.e)()),this.importResponseButtonId="customApiTrigger-importResponseButton-".concat(Object(u.e)()),this.importWebhookResponseButtonId="customApiTrigger-importWebhookResponseButton-".concat(Object(u.e)()),this.importWebhookResponseDayZeroButtonId="customApiTrigger-importWebhookResponseDayZeroButton-".concat(Object(u.e)()),this.summaryInputId="customApiTrigger-summary-".concat(Object(u.e)()),this.triggerCallbackLabel="customApiTrigger-trigger-callback-label",this.urlMaxLength=1024,this.parameterLocationMap=void 0,this.PollingTriggerMetadata={mode:"polling",kind:"query"},this.backButtonTelemetryData={name:k.a.CustomApiTriggerBackButtonClicked},this.baseViolator=void 0,this.validationFilters={},this.headerTypes=[{key:"boolean",text:"boolean"},{key:"integer",text:"integer"},{key:"number",text:"number"},{key:"string",text:"string"}],this.valueCollectionOptions=[],this.valuePaths=[],this.schemaProperties=[],this.resolvedSchema=void 0,this.triggerIndex=void 0,this.verbs=Object.keys(h.b).map(e=>h.b[e]).map(e=>({method:e,displayName:e.toUpperCase()})),this.visibilityOptions=Object.keys(d.l).map(e=>({key:d.l[e],text:d.l[e]})),this.visibilityOptionsLabelLink=void 0,this.triggerTypeOptions=void 0,this.triggerTypeOptionsLabelLink=void 0,this.pollingTriggerPolicy=void 0,this.pollingTriggerPolicyConfig=void 0,this.pollingTriggerPolicyDataPath=void 0,this.internalQueryParameterNames=[],this.webhookCallbackParameters=[],this.selectedCallbackParameter=void 0,this.selectedValuePath=void 0,this.selectedQueryParameter=void 0,this.selectedSchemaPropertyIndex=void 0,this.triggerType=void 0,this.operationVisibility=void 0,this.request=void 0,this.responses=void 0,this.dropdownCommands=void 0,this.schemaDropdownCommands=void 0,this.importPanel=void 0,this.selectedCallbackParameterIndex=void 0,this.selectedValuePathIndex=void 0,this.selectedQueryParameterIndex=void 0,this.onClickBack=()=>{this.selectedSchemaPropertyIndex=void 0,this.processNotificationSchema()},this.processRequest=()=>{var e=b.u(this.trigger.operation.parameters,this.swaggerEditorDataService.swagger);e.forEach(e=>{this.validationFilters[f.f(e)]||(this.validationFilters[f.f(e)]=new g.a(new g.i({itemPath:Object(y.g)(e,this.trigger.operation,this.baseViolator,this.swaggerEditorDataService.SwaggerEditorData)})))}),this.request.pathParameters=e.filter(e=>e.in&&e.in===h.c.path),this.request.queryParameters=e.filter(e=>e.in&&e.in===h.c.query),this.request.headerParameters=e.filter(e=>e.in&&e.in===h.c.header),this.request.bodyParameter=e.filter(e=>e.in&&e.in===h.c.body)[0],this.internalQueryParameterNames=e.filter(e=>e.in&&e.in===h.c.query&&e[d.i.Visibility]===d.l.internal).map(e=>e.name)},this.processNotificationSchema=()=>{this.notificationContent&&this.notificationContent.schema&&(this.resolvedSchema=S.g(this.swaggerEditorDataService.swagger,this.notificationContent.schema),this.schemaProperties=S.c(this.resolvedSchema.schema))},this.navigateToReferenceParameter=(e,t)=>{var i=b.v(this.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl(e,i))},this.showRequestPane=e=>{this.$timeout(()=>{this.importPanel={elementIdsToFocusOnClose:[this.importRequestButtonId,this.importRequestDayZeroButtonId],item:this.trigger,itemType:w.a.OperationItem,panelType:w.c.Request,isVisible:!0,onUpdateSuccessful:this.onRequestUpdated}})},this.showResponsePane=()=>{this.$timeout(()=>{this.importPanel={elementIdsToFocusOnClose:[this.importResponseButtonId],item:this.trigger,itemType:w.a.OperationItem,panelType:w.c.Response,isVisible:!0,onUpdateSuccessful:this.onResponseUpdated}})},this.showWebhookResponsePane=()=>{this.$timeout(()=>{this.importPanel={elementIdsToFocusOnClose:[this.importWebhookResponseButtonId,this.importWebhookResponseDayZeroButtonId],item:this.trigger,itemType:w.a.OperationItem,panelType:w.c.WebhookResponse,isVisible:!0,onUpdateSuccessful:this.processNotificationSchema}})},this.onRequestUpdated=()=>{this.addTriggerPathPrefix(),this.processRequest(),this.updateWebhookCallbackParameters()},this.onResponseUpdated=()=>{this.processResponses(),this.updateValuePathsAndCollections()},this.onVisibilityChange=(e,t)=>{this.operationVisibility=t.key,this.visibilityChanged()},this.onTriggerTypeChange=(e,t)=>{this.updateTriggerType(t.key)},this.onNotificationContentHeaderTypeChanged=(e,t)=>{this.notificationContent.headers[t].type=e.key},this.onQueryParameterChanged=(e,t)=>{this.selectedQueryParameter=this.request.queryParameters[t.key]},this.onValuePathChanged=(e,t)=>{this.selectedValuePath=this.valuePaths[t.key]},this.onQueryParameterWithPolicyChanged=(e,t)=>{this.pollingTriggerPolicyConfig.value.key=t.key},this.onCallbackChanged=(e,t)=>{this.selectedCallbackParameter=this.webhookCallbackParameters[t.key]},this.parameterLocationMap=[{keyName:"pathParameters",displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Path,in:h.c.path},{keyName:"queryParameters",displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Query,in:h.c.query},{keyName:"headerParameters",displayName:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Header,in:h.c.header}],this.visibilityOptionsLabelLink={href:this.clientResources.Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.RightPane.Trigger.Visibility.LearnMoreAriaLabel,telemetryData:{name:"CustomApiTrigger.Visibility.LearnMoreClicked"}},this.triggerTypeOptions=[{key:m.b,text:this.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Webhook.DisplayName},{key:m.a,text:this.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.DisplayName}],this.triggerTypeOptionsLabelLink={href:this.clientResources.Manage.CustomApi.Definition.RightPane.TriggerType.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.RightPane.Trigger.Type.LearnMoreAriaLabel,telemetryData:{name:"CustomApiTrigger.TriggerType.LearnMoreClicked"}},this.telemetryService.tagEvent(k.a.CustomApiTriggerVisited),this.triggerIndex=this.$routeParams.operationIndex,this.baseViolator=new g.i({itemPath:"".concat(g.d.Triggers,"[").concat(this.triggerIndex,"]")}),this.validationFilters={summary:new g.a(new g.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.d.OperationSummary})),description:new g.a(new g.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.d.OperationDescription})),operationId:new g.a(new g.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.d.OperationId})),path:new g.a(new g.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.d.Path})),bodyParameter:new g.a(new g.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:g.d.OperationParameters}))},this.policyDataService.isPollingTriggerPolicyFeatureEnabled()&&(this.pollingTriggerPolicy=this.policyDataService.getOperationPolicyItem(p.g.PollingTrigger,this.trigger)),this.notificationContent?this.updateTriggerType(m.b):this.trigger.operation[d.i.Trigger]&&this.updateTriggerType(m.a),this.policyDataService.isPollingTriggerPolicyFeatureEnabled()&&!this.isPollingTrigger&&void 0===this.pollingTriggerPolicy){var A=this.policyDataService.getPolicyTypeById(p.g.PollingTrigger,!1);void 0!==A&&(this.pollingTriggerPolicy=new p.d(this.clientResources,"PollingTriggerPolicy_".concat(Object(u.e)()),A,[this.trigger]))}void 0!==this.pollingTriggerPolicy&&(this.pollingTriggerPolicyConfig=this.pollingTriggerPolicy.parameterItems.find(e=>"x-ms-apimTemplateParameter.triggerConfig"===e.parameter.id),this.pollingTriggerPolicyDataPath=this.pollingTriggerPolicy.parameterItems.find(e=>"x-ms-apimTemplateParameter.triggerDataPath"===e.parameter.id)),this.selectedSchemaPropertyIndex=void 0,this.selectedCallbackParameterIndex=void 0,this.selectedValuePathIndex=void 0,this.selectedQueryParameterIndex=void 0,this.dropdownCommands=this.getDropdownCommands(),this.schemaDropdownCommands=this.getSchemaDropdownCommands(),this.resetTriggerData(),this.processRequest(),this.processResponses(),this.processNotificationSchema(),this.operationVisibility=this.trigger.operation[d.i.Visibility]||d.l.none,this.$scope.$watch(()=>this.selectedCallbackParameter,(e,t)=>{if(t&&this.unsetNotificationUrl(t),e){this.setNotificationUrl(e);var i=this.webhookCallbackParameters.findIndex(t=>t.name===e.name);this.selectedCallbackParameterIndex=i}else this.selectedCallbackParameterIndex=void 0}),this.$scope.$watch(()=>this.selectedValuePath,()=>{if(this.selectedValuePath){this.onSelectedValuePathChanged();var e=this.valuePaths.findIndex(e=>e.name===this.selectedValuePath.name&&e.parentArray===this.selectedValuePath.parentArray);this.selectedValuePathIndex=e}else this.selectedValuePathIndex=void 0}),this.$scope.$watch(()=>this.request,()=>{this.triggerType===m.b?(this.updateWebhookCallbackParameters(),this.updateSelectedCallbackParameter()):this.triggerType===m.a&&(this.updateSelectedQueryParameter(),this.updateValuePathsAndCollections(),this.updateSelectedValuePath())}),this.$scope.$watch(()=>this.selectedQueryParameter,(e,t)=>{if(t&&this.unsetTriggerValue(t),e){this.setTriggerValue(e);var i=this.request.queryParameters.findIndex(t=>t.name===e.name);this.selectedQueryParameterIndex=i}else this.selectedQueryParameterIndex=void 0}),this.$scope.$watch(()=>this.selectedSchemaProperty,(e,t)=>{e&&t&&e.key===t.key&&Object(v.a)(this.swaggerEditorDataService.swagger,this.selectedSchemaProperty,this.notificationContent.schema,"",e.required!==t.required)},!0),this.$scope.$watchGroup([()=>this.swaggerValidationService.resultCollection.results,()=>this.validationFilters],()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.$timeout(()=>{var e=document.getElementById(this.summaryInputId);e&&e.focus()})}var t,i,r;return t=e,(i=[{key:"resetTriggerData",value:function(){this.request={pathParameters:[],queryParameters:[],headerParameters:[],bodyParameter:null}}},{key:"trigger",get:function(){return this.swaggerEditorDataService.swagger.triggers[this.triggerIndex]}},{key:"triggerRequestVerb",get:function(){return this.trigger.method&&this.trigger.method.toUpperCase()}},{key:"notificationContent",get:function(){return this.trigger[d.i.NotificationContent]}},{key:"selectedSchemaProperty",get:function(){return this.schemaProperties?this.schemaProperties[this.selectedSchemaPropertyIndex]:null}},{key:"fullTriggerUrl",get:function(){return Object(b.k)(this.swaggerEditorDataService.swagger,this.trigger)}},{key:"isWebhookTrigger",get:function(){return this.triggerType===m.b}},{key:"isPollingTrigger",get:function(){return this.triggerType===m.a}},{key:"hasPollingTriggerPolicy",get:function(){return void 0!==this.pollingTriggerPolicy}},{key:"shouldShowRequestSection",get:function(){return this.triggerType&&void 0===this.selectedSchemaPropertyIndex}},{key:"shouldShowResponseSection",get:function(){return this.triggerType&&this.trigger.path&&void 0===this.selectedSchemaPropertyIndex&&this.isPollingTrigger}},{key:"shouldShowWebhookResponseSection",get:function(){return this.triggerType&&this.trigger.path&&void 0===this.selectedSchemaPropertyIndex&&this.isWebhookTrigger}},{key:"shouldShowTriggerConfiguration",get:function(){return this.triggerType&&this.trigger.path&&void 0===this.selectedSchemaPropertyIndex}},{key:"shouldShowValidationSection",get:function(){return void 0===this.selectedSchemaPropertyIndex}},{key:"updateTriggerType",value:function(e){var t=this.triggerType;this.triggerType=e,this.triggerType===m.b?(delete this.trigger.operation[d.i.TriggerMetadata],this.trigger.operation[d.i.Trigger]=d.j.Single,this.notificationContent||(this.trigger[d.i.NotificationContent]={}),t===m.a&&this.removeTriggerPathPrefix(),this.hasPollingTriggerPolicy&&this.policyDataService.deletePolicyItem(this.pollingTriggerPolicy)):this.triggerType===m.a&&(delete this.trigger[d.i.NotificationContent],this.trigger.operation[d.i.Trigger]=d.j.Batch,this.trigger.operation[d.i.TriggerMetadata]=this.PollingTriggerMetadata,t===m.b&&this.addTriggerPathPrefix(),this.hasPollingTriggerPolicy&&this.policyDataService.addPolicyItem(this.pollingTriggerPolicy))}},{key:"onSelectedValuePathChanged",value:function(){if(this.selectedQueryParameter&&this.selectedValuePath){var e=this.trigger.operation.parameters.map(e=>e.in===h.c.query?e.name:"").indexOf(this.selectedQueryParameter.name);if(-1!==e)this.trigger.operation.parameters[e][d.i.TriggerValue]={[d.k.ValueCollection]:this.selectedValuePath.parentArray||"",[d.k.ValuePath]:this.selectedValuePath.name};else{var t=this.trigger.operation.parameters.map(e=>b.G(e)?b.L(e,this.swaggerEditorDataService.swagger).name:"").indexOf(this.selectedQueryParameter.name);-1!==t&&(this.swaggerEditorDataService.swagger.parameters[t][d.i.TriggerValue]={[d.k.ValueCollection]:this.selectedValuePath.parentArray||"",[d.k.ValuePath]:this.selectedValuePath.name})}}}},{key:"updateSelectedQueryParameter",value:function(){if(this.selectedQueryParameter=this.request.queryParameters.filter(e=>!!e[d.i.TriggerValue])[0],this.hasPollingTriggerPolicy){var e=this.pollingTriggerPolicyConfig.value;this.internalQueryParameterNames.includes(e.key)||(e.key="")}}},{key:"updateValuePathsAndCollections",value:function(){var e=this.responses.filter(e=>"200"===e.name)[0]||this.responses.filter(e=>"201"===e.name)[0]||this.responses.filter(e=>"default"===e.name)[0];if(e){var t=S.g(this.swaggerEditorDataService.swagger,e.responseWithResolvedReference.schema);this.valuePaths=S.c(t.schema).filter(e=>e.isInsideArray);var i=Array.from(new Set(this.valuePaths.map(e=>e.parentArray))).map(e=>"@triggerBody()"+(void 0===e?"":"."+e));this.valueCollectionOptions=i.map(e=>({select:e,label:e})),this.hasPollingTriggerPolicy&&(i.includes(this.pollingTriggerPolicyDataPath.value)||(this.pollingTriggerPolicyDataPath.value=""))}}},{key:"updateSelectedValuePath",value:function(){if(this.selectedQueryParameter){var e=this.trigger.operation.parameters.map(e=>e.in===h.c.query?e.name:"").indexOf(this.selectedQueryParameter.name);if(-1!==e){var t=this.trigger.operation.parameters[e][d.i.TriggerValue];if(t){var i=t[d.k.ValueCollection];this.selectedValuePath=this.valuePaths.filter(e=>(Object(u.n)(i)||e.parentArray===i)&&e.name===t[d.k.ValuePath])[0]}}else{var r=this.trigger.operation.parameters.map(e=>b.G(e)?b.L(e,this.swaggerEditorDataService.swagger).name:"").indexOf(this.selectedQueryParameter.name);if(-1!==r){var n=this.swaggerEditorDataService.swagger.parameters[r][d.i.TriggerValue];if(n){var o=n[d.k.ValueCollection];this.selectedValuePath=this.valuePaths.filter(e=>(Object(u.n)(o)||e.parentArray===o)&&e.name===n[d.k.ValuePath])[0]}}}}}},{key:"updateWebhookCallbackParameters",value:function(){if(this.webhookCallbackParameters=[],this.parameterLocationMap.forEach(e=>{this.request[e.keyName]&&this.request[e.keyName].length>0&&(this.webhookCallbackParameters.push({name:e.displayName,isDisabled:!0,in:e.in,isHeader:!0}),this.request[e.keyName].forEach(t=>{this.webhookCallbackParameters.push({name:t.name,isDisabled:!1,in:e.in})}))}),this.request.bodyParameter){var e=S.g(this.swaggerEditorDataService.SwaggerEditorData.swagger,this.request.bodyParameter.schema),t=S.c(e.schema);t&&t.length>0&&(this.webhookCallbackParameters.push({name:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Body,isDisabled:!0,in:"body",isHeader:!0}),t.forEach(e=>{this.webhookCallbackParameters.push({name:e.name,isDisabled:!1,in:"body",key:e.key})}))}}},{key:"updateSelectedCallbackParameter",value:function(){var e,t=b.u(this.trigger.operation.parameters,this.swaggerEditorDataService.swagger),i=t.filter(e=>"body"!==e.in&&!0===e[d.i.NotificationUrl]&&e[d.i.Visibility]===d.l.internal)[0];if(i)e=this.webhookCallbackParameters.filter(e=>e.in===i.in&&e.name===i.name)[0];else{var r=t.filter(e=>"body"===e.in)[0];if(!r)return void(this.selectedCallbackParameter=this.webhookCallbackParameters[0]);var n=S.g(this.swaggerEditorDataService.SwaggerEditorData.swagger,r.schema),o=S.c(n.schema).filter(e=>!!e.isNotificationUrl)[0];o&&(e=this.webhookCallbackParameters.filter(e=>e.key===o.key)[0])}this.selectedCallbackParameter=e||this.webhookCallbackParameters[0]}},{key:"unsetTriggerValue",value:function(e){var t=this.trigger.operation.parameters.map(e=>e.in===h.c.query?e.name:"").indexOf(e.name);-1!==t&&delete this.trigger.operation.parameters[t][d.i.TriggerValue];var i=this.trigger.operation.parameters.map(e=>b.G(e)?b.L(e,this.swaggerEditorDataService.swagger).name:"").indexOf(e.name);-1!==i&&delete this.swaggerEditorDataService.swagger.parameters[i][d.i.TriggerValue]}},{key:"setTriggerValue",value:function(e){if(this.selectedValuePath){var t=this.trigger.operation.parameters.map(e=>e.in===h.c.query?e.name:"").indexOf(e.name);-1!==t&&(this.trigger.operation.parameters[t][d.i.TriggerValue]={[d.k.ValueCollection]:this.selectedValuePath.parentArray||"",[d.k.ValuePath]:this.selectedValuePath.name});var i=this.trigger.operation.parameters.map(e=>b.G(e)?b.L(e,this.swaggerEditorDataService.swagger).name:"").indexOf(e.name);-1!==i&&(this.swaggerEditorDataService.swagger.parameters[i][d.i.TriggerValue]={[d.k.ValueCollection]:this.selectedValuePath.parentArray||"",[d.k.ValuePath]:this.selectedValuePath.name})}}},{key:"unsetNotificationUrl",value:function(e){if(e)switch(e.in){case"path":case"query":case"header":var t=this.getRawParameterInfo(e);if(!t)break;if(b.G(t.parameter)){var i=this.swaggerEditorDataService.swagger.parameters.indexOf(this.swaggerEditorDataService.swagger.parameters.filter(e=>"#/parameters/".concat(e.name)===t.parameter.$ref)[0]);delete this.swaggerEditorDataService.swagger.parameters[i][d.i.NotificationUrl],this.swaggerEditorDataService.swagger.parameters[i][d.i.Visibility]=d.l.important}else delete this.trigger.operation.parameters[t.index][d.i.NotificationUrl],this.trigger.operation.parameters[t.index][d.i.Visibility]=d.l.important;break;case"body":var r=this.getResolvedPathInfo(e);if(!r)break;var o=r.resolvedPath,s=r.index;if(o.reference)a()(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[s].item,S.d("".concat(o.path,".").concat(d.i.NotificationUrl))),n()(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[s].item,S.d("".concat(o.path,".").concat(d.i.Visibility)),d.l.important);else{var l=this.trigger.operation.parameters.filter(e=>"body"===e.in)[0],c=this.trigger.operation.parameters.indexOf(l);a()(this.trigger.operation.parameters[c].schema,S.d("".concat(o.path,".").concat(d.i.NotificationUrl))),n()(this.trigger.operation.parameters[c].schema,S.d("".concat(o.path,".").concat(d.i.Visibility)),d.l.important)}}}},{key:"setNotificationUrl",value:function(e){switch(e.in){case"path":case"query":case"header":var t=this.getRawParameterInfo(e);if(!t)break;if(b.G(t.parameter)){var i=this.swaggerEditorDataService.swagger.parameters.indexOf(this.swaggerEditorDataService.swagger.parameters.filter(e=>"#/parameters/".concat(e.name)===t.parameter.$ref)[0]);this.swaggerEditorDataService.swagger.parameters[i][d.i.NotificationUrl]=!0,this.swaggerEditorDataService.swagger.parameters[i][d.i.Visibility]=d.l.internal}else{if(!this.trigger.operation.parameters[t.index])break;this.trigger.operation.parameters[t.index][d.i.NotificationUrl]=!0,this.trigger.operation.parameters[t.index][d.i.Visibility]=d.l.internal}break;case"body":var r=this.getResolvedPathInfo(e);if(!r)return;var o=r.resolvedPath,a=r.index;if(o.reference)n()(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[a].item,"".concat(o.path,".").concat(d.i.NotificationUrl),!0),n()(this.swaggerEditorDataService.SwaggerEditorData.swagger.definitions[a].item,"".concat(o.path,".").concat(d.i.Visibility),d.l.internal);else{var s=this.trigger.operation.parameters.filter(e=>"body"===e.in)[0],l=this.trigger.operation.parameters.indexOf(s);n()(this.trigger.operation.parameters[l].schema,"".concat(o.path,".").concat(d.i.NotificationUrl),!0),n()(this.trigger.operation.parameters[l].schema,"".concat(o.path,".").concat(d.i.Visibility),d.l.internal)}}}},{key:"getRawParameterInfo",value:function(e){var t=b.u(this.trigger.operation.parameters,this.swaggerEditorDataService.swagger),i=t.filter(t=>t.name===e.name&&t.in===e.in)[0];if(!Object(s.a)(i)){var r=t.indexOf(i);return{parameter:this.trigger.operation.parameters[r],index:r}}}},{key:"getResolvedPathInfo",value:function(e){var t=S.g(this.swaggerEditorDataService.SwaggerEditorData.swagger,this.request.bodyParameter.schema),i=S.c(t.schema).filter(t=>t.key===e.key)[0];if(!Object(s.a)(i)){var r=this.swaggerEditorDataService.SwaggerEditorData.swagger,n=S.h([i],this.request.bodyParameter.schema,r)[i.key],o=r.definitions.indexOf(r.definitions.filter(e=>e.name===n.reference)[0]);return{resolvedPath:n,index:o}}}},{key:"getDropdownCommands",value:function(){return[{text:this.clientResources.Manage.Apis.EditToolTip,click:e=>{this.telemetryService.tagEvent(k.a.CustomApiEditParameterClicked);var t=b.s(e,this.trigger.operation.parameters,this.swaggerEditorDataService.swagger),i=this.trigger.operation.parameters[t],r=b.L(i,this.swaggerEditorDataService.swagger);b.G(i)?this.navigateToReferenceParameter({name:r.name,source:d.g.parameters},r):this.navigateToInlineParameter(t,r)},iconName:c.a.Edit},{text:this.clientResources.Manage.Apis.DeleteToolTip,click:e=>{this.telemetryService.tagEvent(k.a.CustomApiDeleteParameterClicked);var t=b.u(this.trigger.operation.parameters,this.swaggerEditorDataService.swagger).indexOf(e);this.trigger.operation.parameters.splice(t,1),this.isPathParameter(this.request.pathParameters,e)&&this.removePathParameter(this.trigger,e),this.processRequest()},iconName:c.a.Delete}]}},{key:"getSchemaDropdownCommands",value:function(){return[{text:this.clientResources.Manage.Apis.EditToolTip,click:e=>{this.selectedSchemaPropertyIndex=this.schemaProperties.indexOf(e)},iconName:c.a.Edit}]}},{key:"isPathParameter",value:function(e,t){return b.u(e,this.swaggerEditorDataService.swagger).indexOf(t)>-1}},{key:"removePathParameter",value:function(e,t){var i=e.path.split("/"),r=i.indexOf("{"+t.name+"}");r>0&&(i.splice(r-1,2),e.path=i.join("/"))}},{key:"getIconUrlForParameter",value:function(e){return this.validationFilters[f.f(e)]?this.validationFilters[f.f(e)].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"processResponses",value:function(){this.responses=[],this.trigger.operation&&Array.isArray(this.trigger.operation.responses)&&this.trigger.operation.responses.forEach(e=>{var t;t=b.G(e.item)?b.l(this.swaggerEditorDataService.swagger,e.item.$ref):e.item,this.responses.push({name:e.name,responseWithResolvedReference:t}),this.validationFilters[e.name]||(this.validationFilters[e.name]=new g.a(new g.i({itemPath:Object(y.h)(e,this.trigger.operation,this.baseViolator,this.swaggerEditorDataService.SwaggerEditorData)})))})}},{key:"getIconUrlForResponse",value:function(e){return this.validationFilters[e.name]?this.validationFilters[e.name].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"navigateToResponse",value:function(e){var t=this.trigger.operation.responses.map(e=>e.name).indexOf(e),i=this.trigger.operation.responses[t];if(b.G(i.item)){var r=b.l(this.swaggerEditorDataService.swagger,i.item.$ref);this.navigateToReferenceResponse({name:e,source:d.g.responses},r)}else this.navigationService.navigate(this.customConnectorUrlService.getInlineOperationUrl(this.triggerIndex,P.a.triggers,P.a.responses,t))}},{key:"navigateToReferenceResponse",value:function(e,t){var i=b.w(this.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl(e,i))}},{key:"navigateToInlineParameter",value:function(e,t){b.E(e,this.trigger)&&this.navigationService.navigate(this.customConnectorUrlService.getInlineOperationUrl(this.triggerIndex,P.a.triggers,P.a.parameters,e))}},{key:"removeTriggerPathPrefix",value:function(){this.trigger.path&&this.trigger.path.startsWith("/trigger/")&&(this.trigger.path=this.trigger.path.substr("/trigger/".length-1))}},{key:"addTriggerPathPrefix",value:function(){this.trigger.path&&this.triggerType===m.a&&(this.trigger.path="/trigger".concat(0===this.trigger.path.indexOf("/")?this.trigger.path:"/".concat(this.trigger.path)))}},{key:"navigateToReference",value:function(e){var t=this.swaggerEditorDataService.SwaggerEditorData.swagger,i=t.definitions.indexOf(t.definitions.filter(t=>t.name===e)[0]);this.navigationService.navigate(this.customConnectorUrlService.getReferenceUrl({name:"",source:d.g.definitions},i))}},{key:"visibilityChanged",value:function(){this.operationVisibility===d.l.none?delete this.trigger.operation[d.i.Visibility]:this.trigger.operation[d.i.Visibility]=this.operationVisibility}},{key:"queryParametersAsOptions",get:function(){return this.request.queryParameters.map((e,t)=>({key:t,text:e.name}))}},{key:"valuePathsAsOptions",get:function(){return this.valuePaths.map((e,t)=>{var i=e;return{key:t,text:i.parentArray+": "+i.name}})}},{key:"queryParametersWithPolicyAsOptions",get:function(){return this.internalQueryParameterNames.map(e=>({key:e,text:e}))}},{key:"callbackAsOptions",get:function(){return this.webhookCallbackParameters.map((e,t)=>e.isHeader?{key:"".concat(e.in,"-header"),text:e.in,itemType:C.a.Header}:{key:t,text:e.name,disabled:e.isDisabled})}},{key:"getHeaderLabelId",value:function(e){return"customApiTrigger-header-".concat(e)}},{key:"getHeaderTypeLabelledBy",value:function(e){return"customApiTrigger-header-type-label ".concat(this.getHeaderLabelId(e))}},{key:"getHeaderDescriptionLabelledBy",value:function(e){return"customApiTrigger-header-description-label ".concat(this.getHeaderLabelId(e))}}])&&x(t.prototype,i),r&&x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();T.$inject=[l.a.services.$routeParams,l.a.services.$scope,l.a.services.$timeout,l.a.services.assetService,l.a.services.clientResources,l.a.services.customConnectorUrlService,l.a.services.navigation,l.a.services.policyDataService,l.a.services.swaggerEditorData,l.a.services.swaggerValidationService,l.a.services.telemetry]},33902:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var r="Webhook",n="Polling"},33903:function(e,t,i){e.exports=i.p+"static/media/customApiTrigger.4b12d80d.less"},33904:function(e,t){e.exports='<div class="subsection-manage customApiTrigger">\n    \x3c!-- Back button --\x3e\n    <section ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex !== undefined">\n        <react-action-button on-click="customApiTriggerCtrl.onClickBack" icon-name="customApiTriggerCtrl.iconName.Back"\n            telemetry-data="customApiTriggerCtrl.backButtonTelemetryData"\n            title="customApiTriggerCtrl.clientResources.GoBackButtonDefaultAriaLabel"\n            text="customApiTriggerCtrl.clientResources.GoBackButtonLabel">\n        </react-action-button>\n    </section>\n    \x3c!-- General section --\x3e\n    <section ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex === undefined">\n        <h2 class="pane-title">\n            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Heading}}\n        </h2>\n        <div class="pane-content">\n            \x3c!-- Summary --\x3e\n            <div class="pane-field">\n                <validated-input input-id="::customApiTriggerCtrl.summaryInputId"\n                    input-model="customApiTriggerCtrl.trigger.operation.summary"\n                    label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Summary.Label"\n                    validation-result-collection="customApiTriggerCtrl.validationFilters.summary.resultCollection"\n                    learn-more-resource="\'Manage.CustomApi.Definition.RightPane.Summary.Hyperlink\'"\n                    learn-more-link-aria-label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Summary.LearnMoreAriaLabel">\n                </validated-input>\n            </div>\n            \x3c!-- Description --\x3e\n            <div class="pane-field">\n                <validated-input input-model="customApiTriggerCtrl.trigger.operation.description"\n                    label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Description.Label"\n                    validation-result-collection="customApiTriggerCtrl.validationFilters.description.resultCollection"\n                    learn-more-resource="\'Manage.CustomApi.Definition.RightPane.Description.Hyperlink\'"\n                    learn-more-link-aria-label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Description.LearnMoreAriaLabel">\n                </validated-input>\n            </div>\n            \x3c!-- Operation id --\x3e\n            <div class="pane-field">\n                <validated-input input-model="customApiTriggerCtrl.trigger.operation.operationId"\n                    label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Label"\n                    description="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.OperationId.Subtitle"\n                    validation-result-collection="customApiTriggerCtrl.validationFilters.operationId.resultCollection"\n                    is-required="true">\n                </validated-input>\n            </div>\n            \x3c!-- Visibility --\x3e\n            <div class="pane-field">\n                <react-choice-group-with-link options="::customApiTriggerCtrl.visibilityOptions"\n                    label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Visibility.Label"\n                    label-link="::customApiTriggerCtrl.visibilityOptionsLabelLink" direction="\'horizontal\'"\n                    selected-key="customApiTriggerCtrl.operationVisibility"\n                    on-change="::customApiTriggerCtrl.onVisibilityChange"></react-choice-group-with-link>\n            </div>\n            \x3c!-- Trigger type --\x3e\n            <div class="pane-field">\n                <react-choice-group-with-link options="::customApiTriggerCtrl.triggerTypeOptions"\n                    label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Label"\n                    label-link="::customApiTriggerCtrl.triggerTypeOptionsLabelLink" direction="\'horizontal\'"\n                    required="true" selected-key="customApiTriggerCtrl.triggerType"\n                    on-change="::customApiTriggerCtrl.onTriggerTypeChange"></react-choice-group-with-link>\n            </div>\n        </div>\n    </section>\n\n    \x3c!-- Request --\x3e\n    <section class="customApiTrigger-section" ng-if="customApiTriggerCtrl.shouldShowRequestSection">\n        <h5 class="c-heading-5">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}\n        </h5>\n        \x3c!-- TODO(nidurak): update this description when polling request --\x3e\n        <p class="c-subheading-5">\n            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Request.Description}}\n        </p>\n        <div class="customApiTrigger-pane" ng-if="customApiTriggerCtrl.trigger.path">\n            <div class="pane-title pane-title--hasIconOrButton">\n                <h6 class="pane-title-text--hasIconOrButton">\n                    {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</h6>\n                <react-default-button id="{{::customApiTriggerCtrl.importRequestButtonId}}"\n                    class-name="\'pane-title-button\'" primary="true" icon-name="customApiTriggerCtrl.iconName.Add"\n                    on-click="customApiTriggerCtrl.showRequestPane"\n                    text="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label">\n                </react-default-button>\n            </div>\n            <div class="pane-content">\n                \x3c!-- Verbs --\x3e\n                <div class="pane-field">\n                    <fieldset class="c-radio f-inline">\n                        <legend class="pane-field-label">\n                            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading}}\n                            <span class="context-required-text">*</span></legend>\n                        <label\n                            class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Description}}</label>\n                        <span\n                            class="customApiTrigger-pane-field-value">{{customApiTriggerCtrl.triggerRequestVerb}}</span>\n                    </fieldset>\n                </div>\n                \x3c!-- URL --\x3e\n                <div class="pane-field">\n                    <validated-input input-model="customApiTriggerCtrl.fullTriggerUrl"\n                        label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading"\n                        description="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Description"\n                        validation-result-collection="customApiTriggerCtrl.validationFilters.path.resultCollection"\n                        is-read-only="true" is-required="true">\n                    </validated-input>\n                </div>\n                \x3c!-- Path parameters --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="pathParameter in customApiTriggerCtrl.request.pathParameters track by pathParameter.name"\n                            commands="customApiTriggerCtrl.dropdownCommands" token="pathParameter"\n                            required="pathParameter.required" text="pathParameter.name"\n                            icon-url="customApiTriggerCtrl.getIconUrlForParameter(pathParameter)"></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Query parameters --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="queryParameter in customApiTriggerCtrl.request.queryParameters track by queryParameter.name"\n                            commands="customApiTriggerCtrl.dropdownCommands" token="queryParameter"\n                            required="queryParameter.required" text="queryParameter.name"\n                            icon-url="customApiTriggerCtrl.getIconUrlForParameter(queryParameter)"></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Header parameters --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="headerParameter in customApiTriggerCtrl.request.headerParameters track by headerParameter.name"\n                            commands="customApiTriggerCtrl.dropdownCommands" token="headerParameter"\n                            required="headerParameter.required" text="headerParameter.name"\n                            icon-url="customApiTriggerCtrl.getIconUrlForParameter(headerParameter)"></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Body parameters --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block ng-if="customApiTriggerCtrl.request.bodyParameter"\n                            commands="customApiTriggerCtrl.dropdownCommands"\n                            token="customApiTriggerCtrl.request.bodyParameter"\n                            required="customApiTriggerCtrl.request.bodyParameter.required"\n                            text="customApiTriggerCtrl.request.bodyParameter.name"\n                            icon-url="customApiTriggerCtrl.validationFilters.bodyParameter.resultCollection.mostSevereResultTypeImage">\n                        </react-token-block>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="customApiTrigger-section-buttons" ng-if="!customApiTriggerCtrl.trigger.path">\n            <react-action-button id="{{::customApiTriggerCtrl.importRequestDayZeroButtonId}}"\n                icon-name="customApiTriggerCtrl.iconName.Add" on-click="customApiTriggerCtrl.showRequestPane"\n                text="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label">\n            </react-action-button>\n        </div>\n    </section>\n    \x3c!-- Response --\x3e\n    <section class="customApiTrigger-section" ng-if="customApiTriggerCtrl.shouldShowResponseSection">\n        <h5 class="c-heading-5">\n            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Heading}}</h5>\n        <p class="c-subheading-5">\n            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.Response.Description}}</p>\n        <div class="pane-content response-item" ng-repeat="response in customApiTriggerCtrl.responses"\n            ng-click="customApiTriggerCtrl.navigateToResponse(response.name)">\n            <span class="status-code" title="{{response.name}}">{{response.name}}</span>\n            <span class="display-name"\n                title="{{response.responseWithResolvedReference.description}}">{{response.responseWithResolvedReference.description}}</span>\n            <img ng-src="{{customApiTriggerCtrl.getIconUrlForResponse(response)}}" />\n        </div>\n        <div class="customApiTrigger-section-buttons">\n            <react-action-button id="{{::customApiTriggerCtrl.importResponseButtonId}}"\n                icon-name="customApiTriggerCtrl.iconName.Add" on-click="customApiTriggerCtrl.showResponsePane"\n                text="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Definition.AddResponse.Label">\n            </react-action-button>\n        </div>\n    </section>\n    \x3c!-- Webhook Response --\x3e\n    <section class="customApiTrigger-section" ng-if="customApiTriggerCtrl.shouldShowWebhookResponseSection">\n        <h5 class="c-heading-5">\n            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Response.Heading}}</h5>\n        <p class="c-subheading-5">\n            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Response.Description}}\n        </p>\n        <div class="customApiTrigger-pane" ng-if="customApiTriggerCtrl.notificationContent">\n            <div class="pane-title pane-title--hasIconOrButton">\n                <h6 class="pane-title-text--hasIconOrButton">\n                    {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Response.Heading}}\n                </h6>\n                <react-default-button id="{{::customApiTriggerCtrl.importWebhookResponseButtonId}}"\n                    class-name="\'pane-title-button\'" primary="true" icon-name="customApiTriggerCtrl.iconName.Add"\n                    on-click="customApiTriggerCtrl.showWebhookResponsePane"\n                    text="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label">\n                </react-default-button>\n            </div>\n            <div class="pane-content">\n                \x3c!-- Description --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label" for="customApiTrigger-webhookDescription">\n                        {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.GeneralInformation.Description.Label}}\n                        <span class="context-required-text">*</span>\n                    </label>\n                    <input class="c-text-field" id="customApiTrigger-webhookDescription" type="text"\n                        ng-model="customApiTriggerCtrl.notificationContent.description" aria-required="true" />\n                </div>\n                \x3c!-- Headers --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Headers.Description}}</label>\n                    <div ng-if="customApiTriggerCtrl.notificationContent.headers">\n                        <div class="pane-field">\n                            <div class="pane-table">\n                                <div class="row pane-table-header">\n                                    <div class="column medium-4">\n                                        <label>{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Name}}</label>\n                                    </div>\n                                    <div class="column medium-5">\n                                        <label\n                                            id="customApiTrigger-header-description-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Description}}</label>\n                                    </div>\n                                    <div class="column medium-3">\n                                        <label\n                                            id="customApiTrigger-header-type-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.Response.Headers.Type}}</label>\n                                    </div>\n                                    <hr />\n                                </div>\n                                <div\n                                    ng-repeat="(headerKey, header) in customApiTriggerCtrl.notificationContent.headers">\n                                    <div class="row pane-table-body">\n                                        <div class="column medium-4">\n                                            <div class="c-label"\n                                                id="{{customApiTriggerCtrl.getHeaderLabelId(headerKey)}}">\n                                                {{headerKey}}\n                                            </div>\n                                        </div>\n                                        <div class="column medium-5">\n                                            <div class="pane-row-input">\n                                                <input type="text" class="c-text-field" ng-model="header.description"\n                                                    ng-attr-aria-labelledby="{{::customApiTriggerCtrl.getHeaderDescriptionLabelledBy(headerKey)}}" />\n                                            </div>\n                                        </div>\n                                        <div class="field column medium-3">\n                                            <div class="pane-row-input">\n                                                <react-dropdown-swagger-style is-header-type="true"\n                                                    header-key="::headerKey"\n                                                    options="::customApiTriggerCtrl.headerTypes"\n                                                    selected-key="header.type"\n                                                    on-header-type-change="customApiTriggerCtrl.onNotificationContentHeaderTypeChanged"\n                                                    labelled-by="::customApiTriggerCtrl.getHeaderTypeLabelledBy(headerKey)">\n                                                </react-dropdown-swagger-style>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                \x3c!-- References used --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.Definition.RightPane.ReferencesUsed.Description}}</label>\n                    <div class="pane-elements" ng-if="customApiTriggerCtrl.resolvedSchema.referencesUsed.length > 0">\n                        <div ng-repeat="reference in customApiTriggerCtrl.resolvedSchema.referencesUsed">\n                            <a class="reference-link"\n                                ng-click="customApiTriggerCtrl.navigateToReference(reference)">{{reference}}</a>\n                        </div>\n                    </div>\n                </div>\n                \x3c!-- Schema --\x3e\n                <div class="pane-field">\n                    <label\n                        class="pane-field-label">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Heading}}</label>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Response.Body.Description}}</label>\n                    <div class="pane-elements" ng-if="customApiTriggerCtrl.schemaProperties.length > 0">\n                        <react-token-block\n                            ng-repeat="schemaProperty in customApiTriggerCtrl.schemaProperties track by schemaProperty.key"\n                            commands="customApiTriggerCtrl.schemaDropdownCommands" token="schemaProperty"\n                            required="schemaProperty.required" text="schemaProperty.title || schemaProperty.name">\n                        </react-token-block>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n        <div class="customApiTrigger-section-buttons" ng-if="!customApiTriggerCtrl.notificationContent">\n            <react-action-button id="{{::customApiTriggerCtrl.importWebhookResponseDayZeroButtonId}}"\n                icon-name="customApiTriggerCtrl.iconName.Add" on-click="customApiTriggerCtrl.showWebhookResponsePane"\n                text="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.General.ImportFromSample.Label">\n            </react-action-button>\n        </div>\n    </section>\n    \x3c!-- Trigger configuration --\x3e\n    <section class="customApiTrigger-section" ng-if="customApiTriggerCtrl.shouldShowTriggerConfiguration">\n        <h5 class="c-heading-5">\n            {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Heading}}\n        </h5>\n        <div class="customApiTrigger-pane">\n            <h6 class="pane-title">\n                {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Heading}}\n            </h6>\n            <div class="pane-content" ng-if="customApiTriggerCtrl.isWebhookTrigger">\n                <div class="pane-field">\n                    <legend class="pane-field-label" id="{{::customApiTriggerCtrl.triggerCallbackLabel}}">\n                        {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Callback.Heading}}\n                        <span class="context-required-text" aria-hidden="true">*</span></legend>\n                    <label\n                        class="subtitle">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Configuration.Callback.Description}}</label>\n                    <react-dropdown-swagger-style options="customApiTriggerCtrl.callbackAsOptions"\n                        selected-key="customApiTriggerCtrl.selectedCallbackParameterIndex"\n                        on-change="customApiTriggerCtrl.onCallbackChanged"\n                        labelled-by="::customApiTriggerCtrl.triggerCallbackLabel">\n                    </react-dropdown-swagger-style>\n                </div>\n                <message-bar\n                    aria-label="{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.AriaLabel}}">\n                    {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.Highlight.Pre}}<strong>{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.Highlight.Required}}</strong>{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Webhook.Delete.Highlight.Post}}\n                </message-bar>\n            </div>\n            <div class="pane-content" ng-if="customApiTriggerCtrl.isPollingTrigger">\n                \x3c!-- Query parameter selection (without policy) --\x3e\n                <div class="pane-field" ng-if="::!customApiTriggerCtrl.hasPollingTriggerPolicy">\n                    <react-dropdown-swagger-style\n                        label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.Description"\n                        options="customApiTriggerCtrl.queryParametersAsOptions"\n                        selected-key="customApiTriggerCtrl.selectedQueryParameterIndex"\n                        on-change="customApiTriggerCtrl.onQueryParameterChanged" required="true"\n                        placeholder="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.PlaceHolder">\n                    </react-dropdown-swagger-style>\n                </div>\n                \x3c!-- Value path selection (without policy) --\x3e\n                <div class="pane-field" ng-if="::!customApiTriggerCtrl.hasPollingTriggerPolicy">\n                    <react-dropdown-swagger-style\n                        label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.Value.Description"\n                        options="customApiTriggerCtrl.valuePathsAsOptions"\n                        selected-key="customApiTriggerCtrl.selectedValuePathIndex"\n                        on-change="customApiTriggerCtrl.onValuePathChanged" required="true"\n                        placeholder="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.ValuePath.PlaceHolder">\n                    </react-dropdown-swagger-style>\n                </div>\n                \x3c!-- Query parameter selection (through policy) --\x3e\n                <div class="pane-field" ng-if="::customApiTriggerCtrl.hasPollingTriggerPolicy">\n                    <react-dropdown-swagger-style\n                        label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.Description"\n                        options="customApiTriggerCtrl.queryParametersWithPolicyAsOptions"\n                        selected-key="customApiTriggerCtrl.pollingTriggerPolicyConfig.value.key"\n                        on-change="customApiTriggerCtrl.onQueryParameterWithPolicyChanged" required="true"\n                        placeholder="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryParameter.PlaceHolder">\n                    </react-dropdown-swagger-style>\n                </div>\n                \x3c!-- Query expression text field (through policy) --\x3e\n                <div class="pane-field" ng-if="::customApiTriggerCtrl.hasPollingTriggerPolicy">\n                    <label class="pane-field-label" for="customApiTrigger-queryExpression">\n                        {{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.QueryExpression.Label}}\n                        <span class="context-required-text">*</span>\n                    </label>\n                    <input class="c-text-field" id="customApiTrigger-queryExpression" type="text"\n                        ng-model="customApiTriggerCtrl.pollingTriggerPolicyConfig.value.value" aria-required="true" />\n                </div>\n                \x3c!-- Value collection selection (through policy) --\x3e\n                <div class="pane-field" ng-if="::customApiTriggerCtrl.hasPollingTriggerPolicy">\n                    <validated-input\n                        label="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.ValueCollection.Label"\n                        input-model="customApiTriggerCtrl.pollingTriggerPolicyDataPath.value"\n                        input-options="customApiTriggerCtrl.valueCollectionOptions"\n                        input-placeholder="::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Type.Polling.ValueCollection.PlaceHolder"\n                        input-type="select"\n                        validation-result-collection="customApiTriggerCtrl.pollingTriggerPolicyDataPath.validationResults"\n                        is-required="::customApiTriggerCtrl.pollingTriggerPolicyDataPath.parameter.isRequired">\n                    </validated-input>\n                </div>\n                \x3c!-- Trigger hint text field (common field) --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label"\n                        for="customApiTrigger-triggerHint">{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Hint.Description}}\n                        <span class="context-required-text">*</span></label>\n                    <input class="c-text-field" id="customApiTrigger-triggerHint" type="text"\n                        ng-model="customApiTriggerCtrl.trigger.operation[\'x-ms-trigger-hint\']"\n                        maxlength="customApiTriggerCtrl.urlMaxLength"\n                        placeholder="{{::customApiTriggerCtrl.clientResources.Manage.CustomApi.RightPane.Trigger.Hint.Placeholder}}"\n                        aria-required="true" />\n                </div>\n            </div>\n        </div>\n    </section>\n    \x3c!-- Validation --\x3e\n    <section class="customApiTrigger-section" ng-if="customApiTriggerCtrl.shouldShowValidationSection">\n        <validation-results\n            heading-above-pane="::customApiTriggerCtrl.clientResources.Manage.CustomApi.ValidationResults.Heading"\n            sub-heading-above-pane="::customApiTriggerCtrl.clientResources.Manage.CustomApi.ValidationResults.Description.Trigger"\n            base-violator="customApiTriggerCtrl.baseViolator" include-referenced-results="true">\n        </validation-results>\n    </section>\n\n    \x3c!-- Schema Property section --\x3e\n    <section ng-if="customApiTriggerCtrl.selectedSchemaPropertyIndex !== undefined">\n        <schema-property items="customApiTriggerCtrl.schemaProperties"\n            index="customApiTriggerCtrl.selectedSchemaPropertyIndex"></schema-property>\n    </section>\n\n    <import-from-sample-panel model="customApiTriggerCtrl.importPanel"></import-from-sample-panel>\n</div>'},33905:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33906);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33911);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33912),this.controller=o.a,this.controllerAs="customApiTestTabCtrl"}));n.a.component(r.a.components.customApi.customApiTestTab,new c)},33906:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));var r=i(33279),n=i(14751),o=i.n(n),a=i(11891),s=i(13223),l=i(33353),c=i(33383),u=i(33355),d=i(33493),p=i(33327),h=i(13016),m=i(33360),g=i(33359),f=i(33804),v=i(33363),b=i(33357),y=i(13272),w=i(12339),S=i(17914),C=i(33398),k=i(12330),P=i(13009),x=i(13007),A=i(33347),T=i(18959),R=i(11806),O=i(33358),D=i(33907),E=i(33909),F=i(14901),I=i(12344),j=i(33910);function N(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function M(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var L=function(){function e(t,i,r,n,o,a,p,f,v,b,w,x,R,O,j,N,M,L,U,B,$,q,W,z){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$element=t,this.$http=i,this.$location=r,this.$q=n,this.$scope=o,this.$window=a,this.apisClient=p,this.appSettings=f,this.assetService=v,this.clientResources=b,this.connectionHelper=w,this.fileReader=x,this.connectionsClient=R,this.hostCommunicationService=O,this.loggingService=j,this.promiseHelperService=N,this.sessionService=M,this.swaggerEditorDataService=L,this.codeEditorDataService=U,this.telemetryService=B,this.customConnectorUrlService=$,this.customApiHelperService=q,this.widgetUtilService=W,this.routeCrafter=z,this.messageBarType=h.c,this.iconName=y.a,this.TriggerStateName="triggerState",this.warningImage=void 0,this.allConnections=void 0,this.previousTab=void 0,this.connectionsSpinner={size:c.c.Small,local:c.a.LocalHorizontal},this.onOperationClicked=(e,t)=>{this.testData.selectedOperationIndex=e,this.testData.currentOperation=this.testData.testOperations.filter(e=>e.operation.operationId===t.operation.operationId)[0]},this.testAll=()=>{this.testData.testOperations.forEach((e,t)=>{if(!e.operation[g.i.NoGenericTest]){var i=!0;e.nonBodyParameters.forEach(e=>{e.required&&Object(m.p)(e.default)&&(i=!1)}),i&&(this.onOperationClicked(t,e),this.toggleRawBody(!1),e.bodyParameterFields.forEach(e=>{e.required&&Object(m.p)(e.default)&&(i=!1)}),i&&this.testCurrentOperationWithApimTrace())}})},this.testCurrentOperationWithApimTrace=()=>{this.testData.currentOperation.progressSpinner.show=!0;var e=this.testData.currentOperation,t={isTrigger:!Object(k.a)(e.operation[g.i.Trigger])};this.currentOperationHasCodeLog&&this.getCustomCodeBlobSasUri();var i=this.loggingService.profileStart(u.a.myCustomApiTestOperationStartNoSLA,t);this.telemetryService.tagEvent(C.a.TestCurrentOperationClicked,t),e.alert.show=!1,this.clearResponseCodeLogAndTrace();var r=this.isSubscriptionKeyEntered;this.testOperation(e,r,this.currentOperationHasCodeLog).then(e=>this.$q.resolve(e)).catch(t=>this.isFailedAttemptToGetApimTrace(t)?this.testOperation(e,!1,this.currentOperationHasCodeLog):this.isFailedAttemptToGetCodeTraceLogs(t)?this.testOperation(e,r,!1):this.$q.reject(t)).then(t=>this.updateResponseAndTraceLocation(e,t)).catch(t=>this.updateResponseAndTraceLocation(e,t)).finally(()=>{this.currentOperationHasCodeLog&&this.getCodeTraceLogs(),this.loggingService.profileEndWithSuccess(i,u.a.myCustomApiTestOperationEndNoSLA),e.progressSpinner.show=!1})},this.openAddConnection=()=>{var e=this.testData.apiInfo.api;if(this.widgetUtilService.isWidgetPage())this.hostCommunicationService.triggerHostEvent(d.d.ON_ADD_CONNECTION_CLICKED,{apiName:e.name});else{this.telemetryService.tagEvent(C.a.CreateConnectionFromTestPage,null,{});var t=this.loggingService.profileStart(u.a.myCustomApiTestCreateConnectionStartNoSLA,{}),i=Object(A.w)(e);if(Object(A.u)(e)||i)this.$window.open(Object(F.A)(this.routeCrafter,e.name,{closeOnCreate:!0}));else{this.connectionsSpinner.show=!0;var r=Object(s.a)(),n=Object(T.e)(e.name,r);this.connectionHelper.addConnection(e,n).then(()=>{this.loggingService.profileEndWithSuccess(t,u.a.myCustomApiTestCreateConnectionEndNoSLA,{api:e.name})}).catch(e=>{this.loggingService.profileEnd(t,u.a.myCustomApiTestCreateConnectionEndNoSLA,P.e.Warning,e,{}),this.connectionsSpinner.show=!1})}}},this.onConnectionChanged=(e,t)=>{this.testData.selectedConnectionName=null==t?void 0:t.key},this.telemetryService.tagEvent(C.a.TestTabVisited),this.previousTab=Object(I.c)(this.appSettings.featureFlags)?S.c.definition:S.c.code,this.connectionsSpinner.show=!0,this.warningImage=this.assetService.statusWarning,this.testData.apimSubscriptionKey=this.$location.search()["apim-key"],Object(k.a)(this.$element)||Object(E.a)(this.$element[0].querySelectorAll(".c-pivot"),D.a),this.$scope.$watch(()=>this.swaggerEditorDataService.SwaggerEditorData.api,()=>{var e;Object(k.a)(this.swaggerEditorDataService.SwaggerEditorData.api)||Object(k.a)(this.swaggerEditorDataService.SwaggerEditorData.api.properties)||(this.updateApiInfo(this.swaggerEditorDataService.SwaggerEditorData.api),this.swaggerEditorDataService.hasSwaggerBeenModified&&(null===(e=this.swaggerEditorDataService.SwaggerEditorData.statusAlert.options)||void 0===e||e.show(l.a.Warning,this.clientResources.Manage.CustomApi.Test.Warning.ConnectorDefinitionModifiedLocally)))}),this.allConnections=this.connectionsClient.query(this.$scope),this.allConnections.$watch(this.$scope,()=>{this.connectionsSpinner.show=!0,this.updateConnections()}),this.widgetUtilService.isWidgetPage()&&this.hostCommunicationService.onCustomApiRefreshConnections(()=>{this.connectionHelper.refreshConnectionClient()})}var t,i,n;return t=e,(i=[{key:"hasNoOperations",get:function(){var e,t;return 0===(null===(e=this.swaggerEditorDataService.SwaggerEditorData.swagger.actions)||void 0===e?void 0:e.length)&&0===(null===(t=this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers)||void 0===t?void 0:t.length)}},{key:"testData",get:function(){return this.swaggerEditorDataService.CustomApiTestData}},{key:"currentConnection",get:function(){return this.testData.connections.filter(e=>e.name===this.testData.selectedConnectionName)[0]}},{key:"currentOperationHasParameters",get:function(){return!Object(m.n)(this.testData.currentOperation.nonBodyParameters)||!Object(k.a)(this.testData.currentOperation.bodyParameter)}},{key:"rawBodyToggleLabel",get:function(){return this.testData.currentOperation.useRawBody?this.clientResources.Manage.CustomApi.Test.RawBodyToggle.On:this.clientResources.Manage.CustomApi.Test.RawBodyToggle.Off}},{key:"formatedRequestHeaders",get:function(){return Object(k.a)(this.testData.currentOperation)||Object(k.a)(this.testData.currentOperation.lastSentRequest)?"":this.getFormatedJsonObject(this.testData.currentOperation.lastSentRequest.headers)}},{key:"formatedRequestData",get:function(){return Object(k.a)(this.testData.currentOperation)||Object(k.a)(this.testData.currentOperation.lastSentRequest)?"":"object"!=typeof this.testData.currentOperation.lastSentRequest.data?this.testData.currentOperation.lastSentRequest.data:this.getFormatedJsonObject(this.testData.currentOperation.lastSentRequest.data)}},{key:"formatedResponseData",get:function(){if(Object(k.a)(this.testData.currentOperation)||Object(m.n)(this.testData.currentOperation.lastReceivedResponse))return"";try{var e=JSON.parse(this.testData.currentOperation.lastReceivedResponse.body);if(Object(j.a)())try{var t;void 0!==(null===(t=e)||void 0===t?void 0:t.response)&&(e=JSON.parse(atob(e.response)))}catch(i){this.loggingService.logError("CustomApiTestTabCtrl.formatedResponseData",i)}return JSON.stringify(e,null,2)}catch(i){return this.testData.currentOperation.lastReceivedResponse.body}}},{key:"currentOperationHasCodeLog",get:function(){var e;return!!this.codeEditorDataService.CodeEditorData.codeEnabled&&(!!Object(m.n)(this.codeEditorDataService.CodeEditorData.scriptOperations)||this.codeEditorDataService.CodeEditorData.scriptOperations.includes(null===(e=this.testData.currentOperation)||void 0===e?void 0:e.operation.operationId))}},{key:"getCustomCodeBlobSasUri",value:function(){var e={id:this.swaggerEditorDataService.SwaggerEditorData.apiId,$expand:"CustomCodeLogsBlob"},t=this.loggingService.profileStart(u.a.getCustomCodeLogBlobSasUriStart,e),i=this.apisClient.get(this.$scope,e);i.$promise.then(()=>{var e;this.testData.logSasUri=null!==(e=null==i?void 0:i.customCodeLogsBlobSas)&&void 0!==e?e:"",this.loggingService.profileEndWithSuccess(t,u.a.getCustomCodeLogBlobSasUriEnd)}).catch(e=>{this.loggingService.profileEnd(t,u.a.getCustomCodeLogBlobSasUriEnd,P.e.Warning,e)})}},{key:"getTraceLogData",get:function(){return Object(k.a)(this.testData.currentOperation)||Object(m.n)(this.testData.currentOperation.lastReceivedCodeLogContent)?"":this.testData.currentOperation.lastReceivedCodeLogContent}},{key:"schemaValidationErrors",get:function(){if(Object(k.a)(this.testData.currentOperation)||Object(m.n)(this.testData.currentOperation.lastReceivedResponse))return[];try{var e=v.b(this.testData.currentOperation.lastReceivedResponse.body,this.clientResources,{allowNullType:!0}),t=this.getExpectedResponseSchema(),i=v.e(t,e);return this.getSchemaComparisonErrors(i)}catch(r){return[]}}},{key:"getExpectedResponseSchema",value:function(){var e=this.testData.currentOperation.operation.responses;if(Array.isArray(e)){var t=this.testData.currentOperation.lastReceivedResponse.statusCode,i=this.getExpectedOperationResponse(e,t).schema;return v.g(this.swaggerEditorDataService.swagger,i).schema}return{type:f.d.string}}},{key:"getExpectedOperationResponse",value:function(e,t){return(e.filter(e=>e.name===t.toString())[0]||e.filter(e=>t>=200&&t<300&&"200"===e.name)[0]||e.filter(e=>"default"===e.name)[0]||e[0]).item}},{key:"getSchemaComparisonErrors",value:function(e){return e.map(e=>e.propertyPresent?Object(m.d)(this.clientResources.Manage.CustomApi.Test.SchemaValidation.PropertyMismatch,e.propertyName,e.expectedType,e.actualType):Object(m.d)(this.clientResources.Manage.CustomApi.Test.SchemaValidation.PropertyMissing,e.propertyName))}},{key:"isSubscriptionKeyEntered",get:function(){return!Object(m.p)(this.testData.apimSubscriptionKey)}},{key:"currentOperationHasResults",get:function(){return!Object(k.a)(this.testData.currentOperation)&&!Object(k.a)(this.testData.currentOperation.lastReceivedResponse)&&!Object(m.p)(this.testData.currentOperation.lastReceivedResponse.status)}},{key:"shouldDisplayResults",get:function(){return!(Object(k.a)(this.testData.currentOperation)||Object(k.a)(this.testData.currentOperation.progressSpinner)||this.testData.currentOperation.progressSpinner.show||Object(k.a)(this.testData.currentOperation.lastSentRequest)||Object(k.a)(this.testData.currentOperation.lastSentRequest.url))}},{key:"isTestOperationButtonDisabled",get:function(){return Object(k.a)(this.testData.currentOperation)||!this.testData.currentOperation.operation||this.testData.currentOperation.progressSpinner.show||!this.currentConnection}},{key:"canAddTriggerParameters",get:function(){return this.appSettings.featureFlags.enableAdvancedTestApiMode&&!Object(k.a)(this.testData.currentOperation.operation[g.i.Trigger])}},{key:"canCurrentOperationHaveRequestBody",get:function(){var e=this.testData.currentOperation;if(!e)return!1;var t=Object(k.a)(e.lastSentRequest)?"":e.lastSentRequest.method;return this.canMethodHaveRequestBody(t)}},{key:"testingInProgress",get:function(){return this.testData.testOperations.some(e=>e.progressSpinner.show)}},{key:"triggerConnectionsRefresh",value:function(){this.connectionsSpinner.show||this.allConnections.$refresh()}},{key:"isNonBodyParameterReadOnlyInTestUI",value:function(e){return!e[g.i.NotificationUrl]&&(e[g.i.Visibility]===g.l.internal||e[g.i.Permission]===g.f.readOnly)}},{key:"isInputParameterReadOnlyInTestUI",value:function(e){return!e.isNotificationUrl&&(e.readOnly||e.visibility===g.l.internal)}},{key:"getNonBodyParameterTooltip",value:function(e){return this.isNonBodyParameterReadOnlyInTestUI(e)?e[g.i.Permission]===g.f.readOnly?this.clientResources.Manage.CustomApi.Test.ToolTip.ReadonlyParameter:e[g.i.Visibility]===g.l.internal?this.clientResources.Manage.CustomApi.Test.ToolTip.InternalParameter:"":""}},{key:"getInputParameterTooltip",value:function(e){return this.isInputParameterReadOnlyInTestUI(e)?e.readOnly?this.clientResources.Manage.CustomApi.Test.ToolTip.ReadonlyParameter:e.visibility===g.l.internal?this.clientResources.Manage.CustomApi.Test.ToolTip.InternalParameter:"":""}},{key:"updateApiInfo",value:function(e){if(Object(k.a)(this.testData.apiInfo.api)||Object(k.a)(this.testData.apiInfo.api.properties)||Object(k.a)(this.testData.apiInfo.api.properties.swagger)||JSON.stringify(this.testData.apiInfo.api.properties.swagger)!==JSON.stringify(e.properties.swagger)){var t,i;this.testData.apiInfo.api=o()(e),this.testData.apiInfo.apimSwagger=Object(O.a)(this.testData.apiInfo.api.properties.swagger);var r=[];null===(t=this.testData.apiInfo.apimSwagger.actions)||void 0===t||t.forEach(e=>r.push(e.operation)),null===(i=this.testData.apiInfo.apimSwagger.triggers)||void 0===i||i.forEach(e=>r.push(e.operation)),this.testData.testOperations=r.map(e=>{var t={operation:e,nonBodyParameters:[],userDefinedQueryParameters:[],bodyParameter:void 0,bodyParameterFields:[],unableToResolveBodyParameterRefs:!1,usesDynamicSchema:!1,rawBody:"",useRawBody:!1,lastSentRequest:{},lastReceivedResponse:{statusCode:0,status:"",headers:"",body:""},lastReceivedCodeLogContent:"",traceLocation:"",progressSpinner:{size:c.c.Large,show:!1,local:c.a.LocalHorizontal},alert:{show:!1,message:""}};return this.updateOperationParameters(t),t})}if(this.updateConnections(),this.testData.testOperations.length>0){var n=Object(k.a)(this.testData.selectedOperationIndex)?0:this.testData.selectedOperationIndex%this.testData.testOperations.length;this.onOperationClicked(n,this.testData.testOperations[n])}}},{key:"updateConnections",value:function(){Object(k.a)(this.allConnections)||!this.allConnections.$resolved||Object(k.a)(this.testData.apiInfo.api)||(this.testData.connections=this.allConnections.filter(e=>a.a(e.properties.apiId,this.testData.apiInfo.api.id)&&e.properties.statuses.filter(e=>Object(T.h)(e.status)).length>0).sort((e,t)=>new Date(e.properties.createdTime).valueOf()>new Date(t.properties.createdTime).valueOf()?-1:1),this.testData.connections.length>0&&this.testData.connections.filter(e=>e.name===this.testData.selectedConnectionName).length<1&&(this.testData.selectedConnectionName=this.testData.connections[0].name),this.connectionsSpinner.show=!1)}},{key:"updateOperationParameters",value:function(e){var t=void 0!==e.operation.parameters?o()(b.t(e.operation.parameters,this.testData.apiInfo.apimSwagger)):[];t=t.filter(e=>"connectionId"!==e.name),e.nonBodyParameters=t.filter(e=>e.in!==f.c.body).map(e=>this.setNonBodyParameterDefaultToTestValue(e)),e.bodyParameter=t.filter(e=>e.in===f.c.body)[0],e.unableToResolveBodyParameterRefs=Object(m.m)(e.bodyParameter,"$ref"),e.bodyParameterFields=e.unableToResolveBodyParameterRefs?[]:b.c(e.bodyParameter),e.usesDynamicSchema=e.bodyParameter&&e.bodyParameter.schema&&v.f(e.bodyParameter.schema),e.usesDynamicSchema||e.unableToResolveBodyParameterRefs?(e.useRawBody=!0,this.setRawBodyToDefaultOrTestValue(e)):e.bodyParameterFields.length>0&&v.i(e.bodyParameterFields,e.bodyParameter.schema[g.i.TestValue],!0)}},{key:"setNonBodyParameterDefaultToTestValue",value:function(e){return Object(m.p)(e.default)&&(e.default=e[g.i.TestValue]),e}},{key:"setRawBodyToDefaultOrTestValue",value:function(e){Object(k.a)(e)||Object(k.a)(e.bodyParameter)||Object(k.a)(e.bodyParameter.schema)||(e.bodyParameter.schema.default?e.rawBody=JSON.stringify(e.bodyParameter.schema.default,null,2):e.bodyParameter.schema[g.i.TestValue]&&(e.rawBody=JSON.stringify(e.bodyParameter.schema[g.i.TestValue],null,2)))}},{key:"onAddNewUserDefinedQueryParameter",value:function(){this.testData.currentOperation.userDefinedQueryParameters.push({name:"",value:""})}},{key:"onRemoveUserDefinedQueryParameter",value:function(e){this.testData.currentOperation.userDefinedQueryParameters.splice(e,1)}},{key:"onRawBodyToggled",value:function(){this.telemetryService.tagEvent(C.a.ToggleRawBodyClicked,{toggleOn:!this.testData.currentOperation.useRawBody}),this.testData.currentOperation.useRawBody=!this.testData.currentOperation.useRawBody,this.toggleRawBody(this.testData.currentOperation.useRawBody)}},{key:"toggleRawBody",value:function(e){if(e){var t=v.a(this.testData.currentOperation.bodyParameterFields);this.testData.currentOperation.rawBody=JSON.stringify(t,null,2)}else{var i=null;try{i=JSON.parse(this.testData.currentOperation.rawBody)}catch(r){return}v.i(this.testData.currentOperation.bodyParameterFields,i,!0)}}},{key:"getParameterDisplayName",value:function(e){return e.name?e.name:e.parentArray?e.parentArray.replace("$.",""):""}},{key:"testOperation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.getRequestConfig(e,t,i).then(t=>(e.lastSentRequest=t,this.$http(e.lastSentRequest)))}},{key:"getRequestConfig",value:function(e,t,i){var r=this.getOperationById(this.testData.apiInfo.apimSwagger,e.operation.operationId),n=this.getUrl(this.testData.apiInfo.apimSwagger,r,e,this.currentConnection),o=r.method;return this.getAccessToken(n).then(r=>{var a={method:o,url:n,headers:{Authorization:"Bearer ".concat(r),SkipAuthorization:!0},transformResponse:(e,t)=>e};return this.canMethodHaveRequestBody(o)&&this.addBodyContent(e,a),t&&this.addOcpApimTraceHeaders(this.testData.apimSubscriptionKey,a),i&&this.addCodeTraceHeaders(this.testData.logSasUri,a),this.addAdditionalHeaders(e.nonBodyParameters,a),a})}},{key:"getFormatedJsonObject",value:function(e){return Object(k.a)(e)?"":JSON.stringify(e,null,2)}},{key:"getAccessToken",value:function(e){return Object(w.j)(this.appSettings,e)||Object(w.k)(this.appSettings,e)?this.promiseHelperService.toAngularPromise(this.sessionService.getToken(this.appSettings.apiHubsRuntimeResource)):this.promiseHelperService.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource))}},{key:"canMethodHaveRequestBody",value:function(e){return[f.b.post,f.b.put,f.b.patch,f.b.delete,f.b.options].indexOf(e)>-1}},{key:"getOperationById",value:function(e,t){return(e.actions||[]).concat(e.triggers||[]).filter(e=>a.a(e.operation.operationId,t))[0]}},{key:"getUrl",value:function(e,t,i,r){var n,o="".concat(null===(n=e.schemes)||void 0===n?void 0:n[0],"://").concat(e.host).concat(e.basePath).concat(t.path);"/"!==o.charAt(o.length-1)&&(o+="/");var a=o.replace("{connectionId}",r.name);return this.addParametersToBaseUrl(a,i)}},{key:"addParametersToBaseUrl",value:function(e,t){var i={},r=e,n=t.nonBodyParameters.filter(e=>a.a(e.in,f.c.path));return t.nonBodyParameters.filter(e=>a.a(e.in,f.c.query)&&!Object(m.p)(e.default)).forEach(e=>i[e.name]=e.default),t.userDefinedQueryParameters.length>0&&t.userDefinedQueryParameters.filter(e=>!Object(m.p)(e.name)&&!Object(m.p)(e.value)).forEach(e=>i[e.name.trim()]=e.value.trim()),n.forEach(e=>r=r.replace("{".concat(e.name,"}"),encodeURIComponent(e.default))),r=Object(x.a)(r),Object.keys(i).length>0&&(r="".concat(r,"?").concat(Object(R.b)(i))),r}},{key:"addOcpApimTraceHeaders",value:function(e,t){this.appSettings.featureFlags.enableAdvancedTestApiMode&&(t.headers[g.e.Trace]="true",t.headers[g.e.TraceLocation]="",t.headers[g.e.SubscriptionKey]=e)}},{key:"addCodeTraceHeaders",value:function(e,t){Object(m.p)(e)||(t.headers[g.a]=btoa(e)),Object(j.a)()&&(t.headers[g.b]="true")}},{key:"addAdditionalHeaders",value:function(e,t){e.filter(e=>a.a(e.in,f.c.header)).map(e=>e).forEach(e=>{Object(m.p)(e.default)||(t.headers[e.name]=e.default)})}},{key:"addBodyContent",value:function(e,t){e.useRawBody?(this.telemetryService.tagEvent(C.a.TestingOperationUsingRawBody),t.data=e.rawBody):(this.telemetryService.tagEvent(C.a.TestingOperationUsingParsedBody),t.data=v.a(e.bodyParameterFields.filter(e=>e.required||!Object(m.p)(e.default))))}},{key:"isFailedAttemptToGetCodeTraceLogs",value:function(e){return Object(k.a)(e.headers()[g.a])}},{key:"isFailedAttemptToGetApimTrace",value:function(e){return this.isSubscriptionKeyEntered&&Object(k.a)(e.headers()[g.e.TraceLocation])}},{key:"clearResponseCodeLogAndTrace",value:function(){this.testData.currentOperation.lastReceivedResponse={statusCode:0,status:"",headers:"",body:""},this.testData.currentOperation.traceLocation="",this.testData.currentOperation.lastReceivedCodeLogContent=""}},{key:"updateResponseAndTraceLocation",value:function(e,t){this.updateTestOperationAlert(e,t),e.lastReceivedResponse.statusCode=t.status,-1===e.lastReceivedResponse.statusCode?(e.lastReceivedResponse.status=this.clientResources.Manage.CustomApi.Test.Unknown,e.lastReceivedResponse.headers=this.clientResources.Manage.CustomApi.Test.Unknown,e.lastReceivedResponse.body=this.clientResources.Manage.CustomApi.Test.Unknown):(e.lastReceivedResponse.status=Object(k.a)(t.status)?"":t.statusText+Object(m.d)(" ({0})",t.status),e.lastReceivedResponse.headers=Object(k.a)(t.headers)?"":JSON.stringify(t.headers(),null,2),e.lastReceivedResponse.body=Object(k.a)(t.data)?"":t.data),e.traceLocation=Object(k.a)(t.headers)?"":t.headers()[g.e.TraceLocation],!Object(m.p)(e.traceLocation)&&(e.lastReceivedResponse.statusCode<200||e.lastReceivedResponse.statusCode>299)&&this.$window.open(e.traceLocation)}},{key:"updateTestOperationAlert",value:function(e,t){if(Object(k.a)(t)||Object(k.a)(t.status)||Object(k.a)(t.data)||Object(k.a)(t.headers))e.alert.show=!0,e.alert.message=this.clientResources.Manage.CustomApi.Test.Alert.InvalidResponse;else if(this.isFailedAttemptToGetApimTrace(t))e.alert.show=!0,e.alert.message=this.clientResources.Manage.CustomApi.Test.Alert.OperationFailedInvalidKey;else if(t.status<200||t.status>=300){e.alert.show=!0;try{var i=JSON.parse(t.data);if(i&&(i.error&&404===i.error.code&&"Unable to match incoming request to an operation."===i.error.message||404===i.statusCode&&"Resource not found"===i.message))return void(e.alert.message=this.clientResources.Manage.CustomApi.Test.NotYetProvisioned)}catch(n){r.noop()}e.alert.message=Object(m.d)(this.clientResources.Manage.CustomApi.Test.Alert.OperationFailed,t.status)}else e.alert.show=!1}},{key:"getOperationText",value:function(e){return e.operation.operationId}},{key:"getOperationStatus",value:function(e,t){return e?e.progressSpinner.show?l.a.Progress:e.lastReceivedResponse&&e.lastReceivedResponse.statusCode?e.lastReceivedResponse.statusCode>=200&&e.lastReceivedResponse.statusCode<300?l.a.Success:l.a.Error:l.a.None:l.a.None}},{key:"getCodeLogs",value:function(){if(Object(j.a)())try{var e=JSON.parse(this.testData.currentOperation.lastReceivedResponse.body).logs.join("\r\n");if(!Object(k.a)(e))return this.promiseHelperService.toAngularPromise(new Promise(t=>{t(e)}))}catch(t){this.loggingService.logError("CustomApiTestTabCtrl.getCodeLogs",t)}return this.getCodeLogsFromSasUri(this.testData.logSasUri).then(e=>this.promiseHelperService.toAngularPromise(this.fileReader(e).asText()))}},{key:"getCodeLogsFromSasUri",value:function(e){return this.customApiHelperService.getBlobFromUrl(e)}},{key:"getCodeTraceLogs",value:function(){var e=this.loggingService.profileStart(u.a.myCustomApiGetCodeLogFromUrlStart);return this.getCodeLogs().then(t=>{this.testData.currentOperation.lastReceivedCodeLogContent=t,this.loggingService.profileEndWithSuccess(e,u.a.myCustomApiGetCodeLogFromUrlEnd)}).catch(t=>{this.testData.currentOperation.lastReceivedCodeLogContent="ERROR: Unable to get code trace log to an operation",this.loggingService.profileEnd(e,u.a.myCustomApiGetCodeLogFromUrlEnd,P.e.Warning,t)})}},{key:"getConnectionText",value:function(e){return Object(m.d)(this.clientResources.Manage.CustomApi.Test.Connection.DisplayName,e.properties.displayName,e.properties.createdTime)}},{key:"connectionsAsOptions",get:function(){return this.testData.connections.map(e=>({key:e.name,text:this.getConnectionText(e)}))}}])&&N(t.prototype,i),n&&N(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();L.$inject=[p.a.services.$element,p.a.services.$http,p.a.services.$location,p.a.services.$q,p.a.services.$scope,p.a.services.$window,p.a.services.apisClient,p.a.services.appSettings,p.a.services.assetService,p.a.services.clientResources,p.a.services.connectionHelper,p.a.services.fileReaderHelperService,p.a.services.connectionsClient,p.a.services.hostCommunicationService,p.a.services.logging,p.a.services.promiseHelperService,p.a.services.session,p.a.services.swaggerEditorData,p.a.services.codeEditorData,p.a.services.telemetry,p.a.services.customConnectorUrlService,p.a.services.customApiHelper,p.a.services.widgetUtilService,p.a.services.routeCrafter]},33907:function(e,t,i){"use strict";var r=i(33908),n=function(e){return this.element=e,this.contentSections=this.element.getElementsByTagName("section"),this.activePivotHeader=this.element.querySelector(".f-active"),this.secondaryTriggerClass="tab-heading-secondary",this.tabHeadingsSecondary=this.element.getElementsByClassName(this.secondaryTriggerClass),this.init()};n.prototype.init=function(){if(this.update(document.getElementById(this.activePivotHeader.getAttribute("aria-controls"))),this.headerElement=this.element.querySelector("header"),this.headerElement.addEventListener("click",this,!1),this.tabHeadingsSecondary)for(var e=0;e<this.tabHeadingsSecondary.length;e++)this.tabHeadingsSecondary[e].addEventListener("click",this,!1);return this},n.prototype.handleEvent=function(e){(e=e||window.event).preventDefault();var t=e.target||e.srcElement;if("A"===t.tagName){var i=this.element.querySelectorAll("a.tab-heading.f-active"),n=t.getAttribute("aria-controls");if(i.length>1)for(var o=0;o<i.length;o++){var a;Object(r.c)(i[o],"f-active"),i[o].setAttribute("aria-selected","false");var s=Object(r.b)(t,this.secondaryTriggerClass)?'a[aria-controls="'.concat(n,'"]:not(.').concat(this.secondaryTriggerClass,")"):'a[aria-controls="'.concat(n,'"].').concat(this.secondaryTriggerClass);Object(r.a)(document.querySelector(s),"f-active"),null===(a=document.querySelector(s))||void 0===a||a.setAttribute("aria-selected","true")}else Object(r.c)(this.activePivotHeader,"f-active"),this.activePivotHeader.setAttribute("aria-selected","false"),this.activePivotHeader=t;Object(r.a)(t,"f-active"),t.setAttribute("aria-selected","true"),this.update(document.getElementById(n))}},n.prototype.update=function(e){if(e)for(var t=0;t<this.contentSections.length;t++){var i=this.contentSections[t];e===i?this.show(i):this.hide(i)}},n.prototype.show=function(e){e.style.display="block",e.style.overflow="hidden",e.setAttribute("aria-hidden","false")},n.prototype.hide=function(e){e.style.display="none",e.setAttribute("aria-hidden","true")},t.a=n},33908:function(e,t,i){"use strict";function r(e,t){if(e.className){var i=" "+t+" ";return-1!==(" "+e.className+" ").indexOf(i)}return!1}function n(e,t){for(var i=[],r=t.split(","),n=0;n<r.length;n++){var o=r[n].trim();-1===e.className.indexOf(o)&&(e.className+=" "+o,i.push(o))}return i}function o(e,t){for(var i=[],r=t.split(","),n=0;n<r.length;n++){var o=r[n].trim();-1!==e.className.indexOf(o)&&(e.className=e.className.replace(o,"").trim(),i.push(o))}}i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return o}))},33909:function(e,t,i){"use strict";function r(e,t){!function(e,t){for(var i=[],r=0;r<e.length;r++)i.push(new t(e[r]))}(e,t)}i.d(t,"a",(function(){return r}))},33910:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(11808);function n(){return!!Object(r.a)().customConnectorLogsToResponse.getConfig().enableCustomConnectorLogsToResponse}},33911:function(e,t,i){e.exports=i.p+"static/media/customApiTestTab.4dde10c2.less"},33912:function(e,t){e.exports='<div class="customApiTestTab">\n    \x3c!-- Custom API not created --\x3e\n    <div ng-if="!customApiTestTabCtrl.swaggerEditorDataService.SwaggerEditorData.api">\n        <react-text-message-bar\n            type="customApiTestTabCtrl.messageBarType.warning"\n            message="::customApiTestTabCtrl.clientResources.Manage.CustomApi.MustCreateApi.Label">\n        </react-text-message-bar>\n        \x3c!-- Tab navigation --\x3e\n        <custom-api-tab-navigation\n            previous-tab-navigator="customApiTestTabCtrl.previousTabNavigator">\n        </custom-api-tab-navigation>\n    </div>\n    \x3c!-- NOTE(nidurak): must be ng-show in order to initialize the containing c-pivot --\x3e\n    <div ng-show="customApiTestTabCtrl.testData.apiInfo.api">\n        <section class="row">\n            <div class="column medium-3 left-pane">\n                <div>\n                    <div>\n                        <h1 class="column-title">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Operation.Heading}}</h1>\n                        <p>{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Operation.Description}}</p>\n                    </div>\n                </div>\n            </div>\n            <div class="column medium-8 medium-offset-1 right-pane">\n                <div>\n                    \x3c!-- Connection Section --\x3e\n                    <section>\n                        \x3c!-- Title --\x3e\n                        <div class="pane-title pane-title--hasIconOrButton">\n                            <h2 class="pane-title-text--hasIconOrButton">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Connections.Heading}}</h2>\n                            <a\n                                title="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RefreshConnectionsButton.Title}}"\n                                ng-click="customApiTestTabCtrl.triggerConnectionsRefresh()"\n                                role="button"\n                                class="c-glyph"\n                                tabindex="0"\n                                aria-label="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RefreshConnectionsButton.Title}}"\n                                ng-class="customApiTestTabCtrl.connectionsSpinner.show ? \'glyph-inprogress disabled\' : \'glyph-refresh\'" >\n                            </a>\n                        </div>\n                        \x3c!-- Content --\x3e\n                        <div class="pane-content">\n                            <div class="pane-field">\n                                <react-dropdown-swagger-style\n                                    id="customApiTestTab-connections"\n                                    is-disabled="customApiTestTabCtrl.testData.connections.length <= 0 || customApiTestTabCtrl.connectionsSpinner.show"\n                                    label="::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Connections.Selected.Label"\n                                    options="customApiTestTabCtrl.connectionsAsOptions"\n                                    selected-key="customApiTestTabCtrl.testData.selectedConnectionName"\n                                    on-change="customApiTestTabCtrl.onConnectionChanged"\n                                    required="true"\n                                    placeholder="::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.MustCreateConnection.Message">\n                                </react-dropdown-swagger-style>\n                            </div>\n                            <div class="pane-field">\n                                <react-action-button\n                                    on-click="customApiTestTabCtrl.openAddConnection"\n                                    disabled="customApiTestTabCtrl.connectionsSpinner.show"\n                                    text="::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Connections.AddNew"\n                                    icon-name="customApiTestTabCtrl.iconName.Add">\n                                </react-action-button>\n                                <spinner model="customApiTestTabCtrl.connectionsSpinner"></spinner>\n                            </div>\n                        </div>\n                    </section>\n                </div>\n            </div>\n        </section>\n        <hr class="customApiTestTab-sectionDivider" />\n        <section class="row">\n            <div class="column medium-3 left-pane">\n                <div>\n                    <folding-list\n                        title="customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.LeftPane.Operations.Heading"\n                        description="customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.LeftPane.Operations.Description"\n                        learn-more-hyperlink=""\n                        add-new-text=""\n                        filter-text="customApiTestTabCtrl.filterText"\n                        items="customApiTestTabCtrl.testData.testOperations"\n                        get-item-text="customApiTestTabCtrl.getOperationText"\n                        on-item-click="customApiTestTabCtrl.onOperationClicked"\n                        selected-item-index="customApiTestTabCtrl.testData.selectedOperationIndex"\n                        get-item-status="customApiTestTabCtrl.getOperationStatus"\n                        is-collapsed="customApiTestTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.test">\n                    </folding-list>\n                    <react-default-button\n                        class="left-pane-button"\n                        ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode && !customApiTestTabCtrl.hasNoOperations"\n                        primary="true"\n                        on-click="customApiTestTabCtrl.testAll"\n                        is-disabled="customApiTestTabCtrl.testingInProgress || !customApiTestTabCtrl.currentConnection"\n                        text="::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Label.TestAll">\n                    </react-default-button>\n                </div>\n            </div>\n            <div class="column medium-8 medium-offset-1 right-pane">\n                <div ng-show="customApiTestTabCtrl.testData.currentOperation.operation">\n                    \x3c!-- Parameter Section --\x3e\n                    <section class="margin-bottom">\n                        \x3c!-- Title --\x3e\n                        <h2 class="pane-title">\n                            {{customApiTestTabCtrl.testData.currentOperation.operation.operationId}}\n                        </h2>\n                        \x3c!-- Content --\x3e\n                        <div class="pane-content">\n                            \x3c!-- Non Body Parameters --\x3e\n                            <div class="pane-field" ng-repeat="param in customApiTestTabCtrl.testData.currentOperation.nonBodyParameters">\n                                <label class="pane-field-label" for="{{\'customApiTestTabCtrl-nonBodyParameter\' + $index}}" >{{param.name}} <span ng-if="param.required" class="context-required-text">*</span></label>\n                                <input\n                                    id="{{\'customApiTestTabCtrl-nonBodyParameter\' + $index}}"\n                                    class="c-text-field"\n                                    type="text"\n                                    title="{{customApiTestTabCtrl.getNonBodyParameterTooltip(param)}}"\n                                    ng-model="param.default"\n                                    ng-readonly="customApiTestTabCtrl.isNonBodyParameterReadOnlyInTestUI(param)" />\n                            </div>\n                            \x3c!-- Body Parameters --\x3e\n                            <div ng-if="customApiTestTabCtrl.testData.currentOperation.bodyParameter">\n                                <hr ng-if="customApiTestTabCtrl.testData.currentOperation.nonBodyParameters.length > 0" />\n                                <div class="c-toggle pane-field">\n                                    <label class="pane-field-label" for="raw-body-toggle">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RawBodyToggle.Label}}</label>\n                                    <button\n                                        id="raw-body-toggle"\n                                        role="checkbox"\n                                        ng-click="customApiTestTabCtrl.onRawBodyToggled()"\n                                        ng-disabled="customApiTestTabCtrl.testData.currentOperation.usesDynamicSchema || customApiTestTabCtrl.testData.currentOperation.unableToResolveBodyParameterRefs"\n                                        aria-checked="{{customApiTestTabCtrl.testData.currentOperation.useRawBody}}"\n                                        aria-labelledby="c-label-1 c-state-label-1" >\n                                    </button>\n                                    <span>{{customApiTestTabCtrl.rawBodyToggleLabel}}</span>\n                                </div>\n                                <div class="pane-field" ng-if="!customApiTestTabCtrl.testData.currentOperation.useRawBody" ng-repeat="param in customApiTestTabCtrl.testData.currentOperation.bodyParameterFields">\n                                    <label class="pane-field-label" for="{{\'customApiTestTab-bodyParameter\' + $index}}">\n                                        {{customApiTestTabCtrl.getParameterDisplayName(param)}} <span class="context-required-text" ng-if="param.required === true">*</span>\n                                    </label>\n                                    <input\n                                        id="{{\'customApiTestTab-bodyParameter\' + $index}}"\n                                        class="c-text-field"\n                                        type="text"\n                                        title="{{customApiTestTabCtrl.getInputParameterTooltip(param)}}"\n                                        ng-model="param.default"\n                                        ng-readonly="customApiTestTabCtrl.isInputParameterReadOnlyInTestUI(param)" />\n                                </div>\n                                <div class="pane-field" ng-if="customApiTestTabCtrl.testData.currentOperation.useRawBody">\n                                    <label class="pane-field-label error-message" for="customApiTestTab-rawBody" ng-if="customApiTestTabCtrl.testData.currentOperation.unableToResolveBodyParameterRefs">\n                                        {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ReasonForDisablingRawBodyToggle.UnresolvedReferences}}</label>\n                                    <label class="pane-field-label" for="customApiTestTab-rawBody" ng-if="customApiTestTabCtrl.testData.currentOperation.usesDynamicSchema">\n                                        {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ReasonForDisablingRawBodyToggle.DynamicSchema}}</label>\n                                    <textarea id="customApiTestTab-rawBody" class="c-text-field" type="text" ng-model="customApiTestTabCtrl.testData.currentOperation.rawBody" ></textarea>\n                                </div>\n                            </div>\n                            \x3c!-- User Defined Query Parameters --\x3e\n                            <div class="pane-field" ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode">\n                                <hr ng-if="customApiTestTabCtrl.testData.currentOperation.bodyParameter || customApiTestTabCtrl.testData.currentOperation.nonBodyParameters.length > 0"/>\n                                <label class="pane-field-label" for="customApiTestTab-customQueryParameter">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.Label}}</label>\n                                <div class="row pane-table-body" id="customApiTestTab-customQueryParameter" ng-repeat="queryParameter in customApiTestTabCtrl.testData.currentOperation.userDefinedQueryParameters">\n                                    <div class="column medium-3">\n                                        <input class="c-text-field" type="text" ng-model="queryParameter.name" placeholder="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.NamePlaceholder}}" />\n                                    </div>\n                                    <div class="column medium-7">\n                                        <input class="c-text-field" type="text" ng-model="queryParameter.value" placeholder="{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.ValuePlaceholder}}" />\n                                    </div>\n                                    <div class="column medium-2">\n                                        <a class="add-element c-glyph glyph-delete" ng-click="customApiTestTabCtrl.onRemoveUserDefinedQueryParameter($index)">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.Remove}}</a>\n                                    </div>\n                                </div>\n                                <a class="add-element c-glyph glyph-create" ng-click="customApiTestTabCtrl.onAddNewUserDefinedQueryParameter()">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.TiggerParameters.Add}}</a>\n                            </div>\n                            <div class="pane-field">\n                                <react-default-button\n                                    class="right"\n                                    primary="true"\n                                    on-click="customApiTestTabCtrl.testCurrentOperationWithApimTrace"\n                                    is-disabled="customApiTestTabCtrl.isTestOperationButtonDisabled"\n                                    text="::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Button.Text">\n                                </react-default-button>\n                            </div>\n                        </div>\n                    </section>\n                    \x3c!-- Loading Spinner --\x3e\n                    <div class="margin-top" ng-if="customApiTestTabCtrl.testData.currentOperation.progressSpinner.show">\n                        <spinner model="customApiTestTabCtrl.testData.currentOperation.progressSpinner"></spinner>\n                    </div>\n                    \x3c!-- Operation Result Section --\x3e\n                    <section class="c-pivot margin-bottom" id="results-section-pivot" ng-show="customApiTestTabCtrl.shouldDisplayResults">\n                        \x3c!-- Warning Message --\x3e\n                        <react-text-message-bar\n                            ng-if="customApiTestTabCtrl.testData.currentOperation.alert.show"\n                            type="customApiTestTabCtrl.messageBarType.error"\n                            message="customApiTestTabCtrl.testData.currentOperation.alert.message">\n                        </react-text-message-bar>\n                        <header role="tablist" class="pane-title pane-tabs">\n                            <a class="pane-header" role="tab" tabindex="0" aria-controls="request-section" ng-click="">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Request.Label}}</a>\n                            <a class="f-active pane-header" role="tab" aria-controls="result-section">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.Response.Label}}</a>\n                            <a class="pane-header" role="tab" ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode" aria-controls="apim-trace-section">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ApimTraceTitle.Label}}</a>\n                            <a class="pane-header" role="tab" ng-if="customApiTestTabCtrl.currentOperationHasCodeLog" tabindex="0" aria-controls="codelogs-section">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.CodeLogs.Label}}</a>\n                        </header>\n                        \x3c!-- Request Section --\x3e\n                        <section id="request-section" role="tabpanel" aria-hidden="false">\n                            <div class="pane-content">\n                                <div class="pane-field">\n                                    <label class="pane-field-label" for="customApiTestTab-requestUrl">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestUrl.Label}}</label>\n                                    <input class="c-text-field" id="customApiTestTab-requestUrl" type="text" ng-value="customApiTestTabCtrl.testData.currentOperation.lastSentRequest.url" readonly="readonly" />\n                                </div>\n                                <div class="pane-field">\n                                    <label class="pane-field-label" for="customApiTestTab-requestMethod">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestMethod.Label}}</label>\n                                    <div class="raw-output" id="customApiTestTab-requestMethod" >{{customApiTestTabCtrl.testData.currentOperation.lastSentRequest.method}}</div>\n                                </div>\n                                <div class="pane-field">\n                                    <label class="pane-field-label" for="customApiTestTab-requestHeaders">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestHeaders.Label}}</label>\n                                    <textarea class="raw-output small" id="customApiTestTab-requestHeaders" readonly="readonly">{{customApiTestTabCtrl.formatedRequestHeaders}}</textarea>\n                                </div>\n                                <div class="pane-field" ng-if="customApiTestTabCtrl.canCurrentOperationHaveRequestBody">\n                                    <label class="pane-field-label" for="customApiTestTab-requestBody">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.RequestBody.Label}}</label>\n                                    <textarea class="raw-output" id="customApiTestTab-requestBody" readonly="readonly">{{customApiTestTabCtrl.formatedRequestData}}</textarea>\n                                </div>\n                            </div>\n                        </section>\n                        \x3c!-- Response Section --\x3e\n                        <section id="result-section" role="tabpanel" aria-hidden="true">\n                            <div class="pane-content">\n                                <div class="pane-field">\n                                    <label class="pane-field-label" for="customApiTestTab-responseStatus" >{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ResponseStatus.Label}}</label>\n                                    <div class="raw-output" id="customApiTestTab-responseStatus">{{customApiTestTabCtrl.testData.currentOperation.lastReceivedResponse.status}}</div>\n                                </div>\n                                <div class="pane-field">\n                                    <label class="pane-field-label" for="customApiTestTab-responseHeaders">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ResponseHeaders.Label}}</label>\n                                    <textarea class="raw-output small" id="customApiTestTab-responseHeaders" readonly="readonly">{{customApiTestTabCtrl.testData.currentOperation.lastReceivedResponse.headers}}</textarea>\n                                </div>\n                                <div class="pane-field">\n                                    <label class="pane-field-label" for="customApiTestTab-responseBody">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ResponseBody.Label}}</label>\n                                    <textarea class="raw-output" id="customApiTestTab-responseBody" readonly="readonly">{{customApiTestTabCtrl.formatedResponseData}}</textarea>\n                                </div>\n                            </div>\n                        </section>\n                        \x3c!-- APIM Trace Section --\x3e\n                        <section id="apim-trace-section" ng-if="customApiTestTabCtrl.appSettings.featureFlags.enableAdvancedTestApiMode" role="tabpanel" aria-hidden="true">\n                            <div class="pane-content">\n                                <div class="pane-field">\n                                    <label class="pane-field-label" for="customApiTestTab-ocpApimSubscriptionKey">\n                                        {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.OcpSubscriptionKey.Label}}\n                                        <span class="context-required-text">*</span>\n                                    </label>\n                                    <input class="c-text-field" id="customApiTestTab-ocpApimSubscriptionKey" type="text" ng-model="customApiTestTabCtrl.testData.apimSubscriptionKey" />\n                                </div>\n                                <div class="pane-field" ng-if="customApiTestTabCtrl.testData.currentOperation.traceLocation">\n                                    <a class="c-hyperlink" target="_blank" href="{{customApiTestTabCtrl.testData.currentOperation.traceLocation}}">{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.ApimTraceUrl.Label}}</a>\n                                </div>\n                                <div class="pane-field" ng-if="!customApiTestTabCtrl.testData.currentOperation.traceLocation">\n                                    <label class="subtitle">\n                                        {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.MissingApimTraceLocation}}\n                                    </label>\n                                </div>\n                            </div>\n                        </section>\n                         \x3c!-- Code Trace Logs Section --\x3e\n                         <section id="codelogs-section"  ng-if="customApiTestTabCtrl.currentOperationHasCodeLog" role="tabpanel" aria-hidden="true">\n                            <div class="pane-content">\n                                <div class="pane-field">\n                                    <textarea class="raw-output" id="customApiTestTab-codeLogsBody" readonly="readonly">{{customApiTestTabCtrl.getTraceLogData}}</textarea>\n                                </div>\n                            </div>\n                        </section>\n                    </section>\n                    \x3c!-- Schema Validation Section --\x3e\n                    <section ng-if="customApiTestTabCtrl.shouldDisplayResults">\n                        <h2 class="pane-title">\n                            {{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.SchemaValidation.Label}}\n                        </h2>\n                        <div class="pane-content">\n                            <div class="pane-field">\n                                <div class="validation-errors" ng-repeat="error in customApiTestTabCtrl.schemaValidationErrors">\n                                    <img ng-src="{{customApiTestTabCtrl.warningImage}}" />\n                                    <label class="subtitle">{{error}}</label>\n                                </div>\n                                <div class="pane-field" ng-show="customApiTestTabCtrl.schemaValidationErrors.length === 0">\n                                    <span>{{::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.SchemaValidation.Success}}</span>\n                                </div>\n                            </div>\n                        </div>\n                    </section>\n                </div>\n                <react-text-message-bar\n                    ng-if="customApiTestTabCtrl.hasNoOperations"\n                    type="customApiTestTabCtrl.messageBarType.info"\n                    message="::customApiTestTabCtrl.clientResources.Manage.CustomApi.Test.NoOperations">\n                </react-text-message-bar>\n                \x3c!-- Tab navigation --\x3e\n                <custom-api-tab-navigation previous-tab="customApiTestTabCtrl.previousTab"></custom-api-tab-navigation>\n            </div>\n        </section>\n    </div>\n</div>\n'},33913:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33914);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33915);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33916),this.controller=o.a,this.controllerAs="copilotSwaggerEditorTabCtrl"}));n.a.component(r.a.components.customApi.copilotTab,new c)},33914:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(33353),n=i(33327),o=i(13016),a=i(33800),s=i(33357),l=i(33802),c=i(33359),u=i(17914),d=i(12330),p=i(13240),h=i(12344);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=function(){function e(t,i,n,a,l,m,g,f,v,b,y,w,S,C){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$interval=t,this.$routeParams=i,this.$scope=n,this.$timeout=a,this.appSettings=l,this.clientResources=m,this.customConnectorUrlService=g,this.navigationService=f,this.policyDataService=v,this.swaggerEditorDataService=b,this.swaggerValidationService=y,this.copilotPluginValidationService=w,this.telemetryService=S,this.widgetUtilService=C,this.messageBarType=o.c,this.swaggerEditorData=void 0,this.pageFullyRendered=!1,this.actionStatuses=[],this.emailValidationResults=void 0,this.selectedActionIndex=null,this.selectedReferenceIndex=null,this.isRefParameter=!1,this.references=[],this.referenceIndexFromRoute={parameters:-1},this.inlineParameter=-1,this.previousTab=u.c.definition,this.nextTab=void 0,this.navigateToAction=(e,t)=>{this.saveLeftColumnScrollPosition(),s.z(e,this.swaggerEditorDataService.SwaggerEditorData)||(this.swaggerEditorDataService.swagger.actions[e].operation["x-ms-openai-data"]=s.o(this.swaggerEditorData,e)),this.navigationService.navigate(this.customConnectorUrlService.getCustomApiCopilotTypeUrl(u.a.actions,e))},this.getActionStatus=(e,t)=>!e||Object(d.a)(t)?r.a.None:this.actionStatuses[t]||r.a.None,this.telemetryService.tagEvent(p.c.CustomApiCopilotTabVisited),this.swaggerEditorData=this.swaggerEditorDataService.SwaggerEditorData,this.nextTab=void 0,this.widgetUtilService.isLogicApps()||(Object(h.c)(this.appSettings.featureFlags)?this.nextTab=u.c.test:this.nextTab=u.c.code);var k,P,x=this.$routeParams.operation,A=parseInt(this.$routeParams.operationIndex,10);switch(x){case u.a.actions:k=A;break;case u.a.parameters:P=A}var T=this.$routeParams.refOperation,R=parseInt(this.$routeParams.refOperationIndex,10);switch(this.isRefParameter=this.$routeParams.refOperation===u.a.refParameter,T){case u.a.parameters:case u.a.refParameter:P=R}this.inlineParameter=k>=0?P:-1,this.referenceIndexFromRoute={parameters:k>=0&&T===u.a.refParameter?P:-1},this.$scope.$watchGroup([()=>this.swaggerEditorDataService.SwaggerEditorData.swagger.parameters],()=>{this.references=[].concat(c.m(this.swaggerEditorDataService.SwaggerEditorData.swagger.parameters,c.g.parameters))}),this.$scope.$watch(()=>this.swaggerEditorDataService.SwaggerEditorData.swagger.actions,()=>{s.z(k,this.swaggerEditorDataService.SwaggerEditorData)?this.selectedActionIndex=k:this.selectedActionIndex=null}),this.$scope.$watch(()=>this.references,()=>{var e=c.h.filter(e=>s.H(e,this.referenceIndexFromRoute[e],this.swaggerEditorDataService.SwaggerEditorData))[0];e&&(this.selectedReferenceIndex=this.getIndex(this.referenceIndexFromRoute[e],e))}),this.$scope.$watch(()=>this.swaggerValidationService.resultCollection.results,()=>{this.updateFoldingListStatuses()});var O=document.getElementById("copilotSwaggerEditorTab-scrollbox--left");O&&(O.scrollTop=this.swaggerEditorDataService.swaggerEditorUIData.leftColumnScrollPosition),this.$scope.$watch(()=>{var e;return null===(e=this.swaggerEditorDataService.swagger["x-ms-openai-manifest"])||void 0===e?void 0:e.contactEmail},()=>this.validateEmail()),this.$timeout(()=>this.pageFullyRendered=!0)}var t,i,n;return t=e,(i=[{key:"saveLeftColumnScrollPosition",value:function(){var e;this.swaggerEditorDataService.swaggerEditorUIData.leftColumnScrollPosition=null===(e=document.getElementById("copilotSwaggerEditorTab-scrollbox--left"))||void 0===e?void 0:e.scrollTop}},{key:"hasNoOperations",get:function(){var e,t;return!(0!==(null===(e=this.swaggerEditorDataService.SwaggerEditorData.swagger.actions)||void 0===e?void 0:e.length)||0!==(null===(t=this.swaggerEditorDataService.SwaggerEditorData.swagger.triggers)||void 0===t?void 0:t.length))}},{key:"shouldShowAction",get:function(){return s.z(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&!this.shouldShowInlineParameter&&!this.isRefParameter}},{key:"shouldShowInlineParameter",get:function(){return this.shouldShowInlineActionParameter&&!this.isRefParameter}},{key:"shouldShowInlineActionParameter",get:function(){return s.A(this.selectedActionIndex,this.swaggerEditorDataService.SwaggerEditorData)&&s.E(this.inlineParameter,this.swaggerEditorDataService.swagger.actions[this.selectedActionIndex])&&s.C(this.inlineParameter,this.swaggerEditorDataService.swagger.actions[this.selectedActionIndex])}},{key:"shouldShowInlineRefParameter",get:function(){return null!==this.selectedReferenceIndex&&this.isRefParameter&&s.D(this.selectedReferenceIndex,this.swaggerEditorDataService.swagger.actions[this.selectedActionIndex],this.swaggerEditorData.swagger)}},{key:"updateFoldingListStatuses",value:function(){Array.isArray(this.swaggerEditorDataService.swagger.actions)&&this.swaggerEditorDataService.swagger.actions.forEach((e,t)=>{this.updateActionStatus(e,t)})}},{key:"updateActionStatus",value:function(e,t){var i=new a.i({itemPath:"".concat(a.d.Actions,"[").concat(t,"]")}),r=this.swaggerValidationService.resultCollection.filterOnViolator(i);r.add(l.e(e,this.swaggerEditorDataService.swagger,this.swaggerValidationService.resultCollection)),this.actionStatuses[t]=this.filterOutSuccess(r.mostSevereAlertType)}},{key:"getOperationText",value:function(e){return e.operation.operationId}},{key:"filterOutSuccess",value:function(e){return e===r.a.Success?r.a.None:e}},{key:"getIndex",value:function(e,t){var i=this.references.filter(e=>e.source===t);return this.references.indexOf(i[e])}},{key:"validateEmail",value:function(){var e,t,i=null!==(e=null===(t=this.swaggerEditorDataService.swagger)||void 0===t||null===(t=t["x-ms-openai-manifest"])||void 0===t?void 0:t.contactEmail)&&void 0!==e?e:"";this.emailValidationResults=this.copilotPluginValidationService.validatePluginManifestEmail(i)}}])&&m(t.prototype,i),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();f.$inject=[n.a.services.$interval,n.a.services.$routeParams,n.a.services.$scope,n.a.services.$timeout,n.a.services.appSettings,n.a.services.clientResources,n.a.services.customConnectorUrlService,n.a.services.navigation,n.a.services.policyDataService,n.a.services.swaggerEditorData,n.a.services.swaggerValidationService,n.a.services.copilotPluginValidationService,n.a.services.telemetry,n.a.services.widgetUtilService]},33915:function(e,t,i){e.exports=i.p+"static/media/copilotSwaggerEditorTab.d5a714fe.less"},33916:function(e,t){e.exports='<div class="copilotSwaggerEditorTab">\n    <section class="row">\n        <div class="column medium-3 left-pane">\n            <div>\n                <div>\n                    <h1 class="column-title">{{::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.LeftPane.PluginManifest.Heading}}</h1>\n                    <p>{{::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.LeftPane.PluginManifest.Description}}</p>\n                </div>\n            </div>\n        </div>\n        <div class="column medium-8 medium-offset-1 right-pane">\n            <div>\n                \x3c!-- Plugin Manifest Details --\x3e\n                <section>\n                    <h2 class="pane-title">{{::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.LeftPane.PluginManifest.Heading}}</h2>\n                    <div class="pane-content">\n                        <div class="pane-field">\n                            \x3c!--  description --\x3e\n                            <validated-input\n                                label="::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.Name.Label"\n                                input-model="copilotSwaggerEditorTabCtrl.swaggerEditorData.swagger[\'x-ms-openai-manifest\'].humanName">\n                            </validated-input>\n                        </div>\n                        <div class="pane-field">\n                            <label class="pane-field-label">{{::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.Description.Label}}\n                                <learn-more\n                                    resource="\'Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.Description.Hyperlink\'"\n                                    text="::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.Description.LearnMore"\n                                ></learn-more>\n                            </label>\n                            <div class="c-textarea">\n                                <textarea\n                                    class="copilotSwaggerEditorTab-input--resizable"\n                                    ng-attr-placeholder="{{::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.Description.PlaceHolder}}"\n                                    ng-model="copilotSwaggerEditorTabCtrl.swaggerEditorData.swagger[\'x-ms-openai-manifest\'].modelDescription"\n                                    aria-label="{{::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.Description.Label}}">\n                                </textarea>\n                            </div>\n                        </div>\n                        <div class="pane-field">\n                            <validated-input\n                                label="::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.ContactEmail.Label"\n                                input-model="copilotSwaggerEditorTabCtrl.swaggerEditorData.swagger[\'x-ms-openai-manifest\'].contactEmail"\n                                validation-result-collection="copilotSwaggerEditorTabCtrl.emailValidationResults">\n                            </validated-input>\n                        </div>\n                        <div class="pane-field">\n                            <validated-input\n                                label="::copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.RightPane.PluginManifestDetails.LegalInfoUrl.Label"\n                                input-model="copilotSwaggerEditorTabCtrl.swaggerEditorData.swagger[\'x-ms-openai-manifest\'].legalUrl">\n                            </validated-input>\n                        </div>\n                    </div>\n                </section>\n                <custom-api-tab-navigation\n                    previous-tab="copilotSwaggerEditorTabCtrl.previousTab"\n                    next-tab="copilotSwaggerEditorTabCtrl.nextTab">\n                </custom-api-tab-navigation>\n            </div>\n        </div>\n    </section>\n    <hr class="copilotSwaggerEditorTab-section-divider" />\n    <section class="row">\n        <div class="column medium-3 left-pane copilotSwaggerEditorTab-scrollbox" ng-class="{\'copilotSwaggerEditorTab-scrollbox--shifted\': copilotSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.statusAlert.type}"\n         id="copilotSwaggerEditorTab-scrollbox--left">\n            <div class="copilotSwaggerEditorTab-scrollbox-content copilotSwaggerEditorTab-scrollbox-content--preRendered"\n                     ng-class="copilotSwaggerEditorTabCtrl.pageFullyRendered ? \'copilotSwaggerEditorTab-scrollbox-content--rendered\' : \'\'">\n                    <folding-list title="copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.LeftPane.Actions.Heading"\n                                  description="copilotSwaggerEditorTabCtrl.clientResources.Manage.CustomApi.CopilotTab.LeftPane.Actions.Description"\n                                  filter-text="copilotSwaggerEditorTabCtrl.filterText"\n                                  items="copilotSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.swagger.actions"\n                                  get-item-text="copilotSwaggerEditorTabCtrl.getOperationText"\n                                  get-item-status="copilotSwaggerEditorTabCtrl.getActionStatus"\n                                  on-item-click="copilotSwaggerEditorTabCtrl.navigateToAction"\n                                  selected-item-index="copilotSwaggerEditorTabCtrl.selectedActionIndex"\n                                  is-collapsed="copilotSwaggerEditorTabCtrl.swaggerEditorDataService.swaggerEditorUIData.foldingListCollapseState.actions">\n                    </folding-list>\n            </div>\n        </div>\n\n        \x3c!-- Right pane --\x3e\n        <div class="column medium-8 medium-offset-1 right-pane copilotSwaggerEditorTab-scrollbox" ng-class="{\'copilotSwaggerEditorTab-scrollbox--shifted\': copilotSwaggerEditorTabCtrl.swaggerEditorDataService.SwaggerEditorData.statusAlert.type}">\n            <div class="copilotSwaggerEditorTab-scrollbox-content">\n                <custom-api-copilot-action ng-if="copilotSwaggerEditorTabCtrl.shouldShowAction"></custom-api-copilot-action>\n                <custom-api-copilot-parameter ng-if="copilotSwaggerEditorTabCtrl.shouldShowInlineParameter"></custom-api-copilot-parameter>\n                <div ng-if="copilotSwaggerEditorTabCtrl.shouldShowInlineRefParameter" ng-switch on="copilotSwaggerEditorTabCtrl.references[copilotSwaggerEditorTabCtrl.selectedReferenceIndex].source">\n                    <custom-api-copilot-parameter ng-switch-when="parameters"></custom-api-copilot-parameter>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n'},33917:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33918);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33919),this.controller=o.a,this.controllerAs="customApiCopilotActionCtrl"}));n.a.component(r.a.components.customApi.customApiCopilotAction,new c)},33918:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(13272),n=i(13240),o=i(17914),a=i(15523),s=i(33327),l=i(33359),c=i(33800),u=i(33801),d=i(33357),p=i(33802),h=i(20342),m=i(33803);function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,i,s,g,f,v,b,y,w,S){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$timeout=s,this.assetService=g,this.clientResources=f,this.customConnectorUrlService=v,this.navigationService=b,this.swaggerEditorDataService=y,this.swaggerValidationService=w,this.telemetryService=S,this.iconName=r.a,this.importRequestButtonId="customApiAction-importRequestButton-".concat(a.a),this.importRequestDayZeroButtonId="customApiAction-importRequestDayZeroButton-".concat(a.a),this.importResponseButtonId="customApiAction-importResponseButton-".concat(a.a),this.summaryInputId="customApiAction-summary-".concat(a.a),this.baseViolator=void 0,this.validationFilters={},this.actionIndex=void 0,this.copilotOperationIndex=void 0,this.verbs=Object.keys(h.c).map(e=>h.c[e]).map(e=>({method:e,displayName:e.toUpperCase()})),this.visibilityOptions=Object.keys(l.l).map(e=>({key:l.l[e],text:l.l[e]})),this.visibilityOptionsLabelLink=void 0,this.request=void 0,this.responses=void 0,this.operationVisibility=void 0,this.dropdownCommands=void 0,this.importPanel=void 0,this.isUserConfirmationDisabled=void 0,this.onVisibilityChange=(e,t)=>{this.operationVisibility=t.key,this.visibilityChanged()},this.processRequest=()=>{var e=d.u(this.action.operation.parameters,this.swaggerEditorDataService.swagger);e.forEach(e=>{this.validationFilters[u.f(e)]||(this.validationFilters[u.f(e)]=new c.a(new c.i({itemPath:Object(p.g)(e,this.action.operation,this.baseViolator,this.swaggerEditorDataService.SwaggerEditorData)})))}),this.request.pathParameters=e.filter(e=>e.in&&e.in===h.e.path),this.request.queryParameters=e.filter(e=>e.in&&e.in===h.e.query),this.request.headerParameters=e.filter(e=>e.in&&e.in===h.e.header),this.request.bodyParameter=e.filter(e=>e.in&&e.in===h.e.body)[0]},this.navigateToReferenceParameter=(e,t)=>{var i=d.v(this.swaggerEditorDataService.SwaggerEditorData,e,t);i>=0&&(this.populateCopilotOperationParameter(!0,i,t),this.navigationService.navigate(this.customConnectorUrlService.getInlineCopilotOperationUrl(this.actionIndex,o.a.actions,o.a.refParameter,i)))},this.showRequestPane=()=>{this.$timeout(()=>{this.importPanel={elementIdsToFocusOnClose:[this.importRequestButtonId,this.importRequestDayZeroButtonId],item:this.action,itemType:m.a.OperationItem,panelType:m.c.Request,isVisible:!0,onUpdateSuccessful:this.processRequest}})},this.telemetryService.tagEvent(n.c.CustomApiCopilotActionVisited),this.actionIndex=this.$routeParams.operationIndex,this.baseViolator=new c.i({itemPath:"".concat(c.d.Actions,"[").concat(this.actionIndex,"]")}),this.validationFilters={summary:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationSummary})),description:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationDescription})),operationId:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationId})),path:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.Path})),bodyParameter:new c.a(new c.i({itemPath:this.baseViolator.fullSwaggerPath,propertyPath:c.d.OperationParameters}))},this.dropdownCommands=this.getDropdownCommands(),this.resetActionData(),this.processRequest(),this.isUserConfirmationDisabled=this.action.method===h.c.get||this.action.method===h.c.head||this.action.method===h.c.options,this.operationVisibility=this.action.operation[l.i.Visibility]||l.l.none,this.$scope.$watchGroup([()=>this.swaggerValidationService.resultCollection.results,()=>this.validationFilters],()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.$timeout(()=>{var e=document.getElementById(this.summaryInputId);e&&e.focus()}),this.copilotOperationIndex=0}var t,i,s;return t=e,(i=[{key:"action",get:function(){return this.swaggerEditorDataService.swagger.actions[this.actionIndex]}},{key:"copilotPluginOperation",get:function(){return this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"].operations[this.copilotOperationIndex]}},{key:"copilotPluginData",get:function(){return this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"]}},{key:"actionRequestVerb",get:function(){return this.action.method&&this.action.method.toUpperCase()}},{key:"fullActionUrl",get:function(){return Object(d.k)(this.swaggerEditorDataService.swagger,this.action)}},{key:"resetActionData",value:function(){this.request={pathParameters:[],queryParameters:[],headerParameters:[],bodyParameter:null},this.responses=[]}},{key:"getDropdownCommands",value:function(){return[{text:this.clientResources.Manage.Apis.EditToolTip,click:e=>{this.telemetryService.tagEvent(n.c.CustomApiEditParameterClicked);var t=d.s(e,this.action.operation.parameters,this.swaggerEditorDataService.swagger),i=this.action.operation.parameters[t],r=d.L(i,this.swaggerEditorDataService.swagger);d.G(i)?this.navigateToReferenceParameter({name:r.name,source:l.g.parameters},r):this.navigateToInlineParameter(t,r)},iconName:r.a.Edit}]}},{key:"isPathParameter",value:function(e,t){return d.u(e,this.swaggerEditorDataService.swagger).indexOf(t)>-1}},{key:"getIconUrlForParameter",value:function(e){return this.validationFilters[u.f(e)]?this.validationFilters[u.f(e)].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"getIconUrlForResponse",value:function(e){return this.validationFilters[e.name]?this.validationFilters[e.name].resultCollection.mostSevereResultTypeImage(this.assetService):null}},{key:"getIconTextForResponse",value:function(e){return this.validationFilters[e.name]?this.validationFilters[e.name].resultCollection.mostSevereResultTypeImageText(this.clientResources):""}},{key:"navigateToResponse",value:function(e){var t=this.action.operation.responses.map(e=>e.name).indexOf(e),i=this.action.operation.responses[t];d.G(i.item)?d.l(this.swaggerEditorDataService.swagger,i.item.$ref):this.navigationService.navigate(this.customConnectorUrlService.getInlineOperationUrl(this.actionIndex,o.a.actions,o.a.responses,t))}},{key:"navigateToInlineParameter",value:function(e,t){d.E(e,this.action)&&(this.populateCopilotOperationParameter(!1,e,t),this.navigationService.navigate(this.customConnectorUrlService.getInlineCopilotOperationUrl(this.actionIndex,o.a.actions,o.a.parameters,e)))}},{key:"populateCopilotOperationParameter",value:function(e,t,i){var r,n,o;if(null!==(r=this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"])&&void 0!==r&&r.operations[0]&&null!==(n=this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"])&&void 0!==n&&n.operations[0].parameters&&(null===(o=this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"])||void 0===o?void 0:o.operations[0].parameters.length)>=0){for(var a of this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"].operations[0].parameters)if(a.name===i.name&&"upsert"===a.type)return void(a.properties||(a.properties=[]));this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"].operations[0].parameters.push(d.n(e,this.swaggerEditorDataService.SwaggerEditorData,this.actionIndex,t))}else this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"].operations[0].parameters=[d.n(e,this.swaggerEditorDataService.SwaggerEditorData,this.actionIndex,t)]}},{key:"visibilityChanged",value:function(){this.operationVisibility===l.l.none?delete this.action.operation[l.i.Visibility]:this.action.operation[l.i.Visibility]=this.operationVisibility}}])&&g(t.prototype,i),s&&g(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[s.a.services.$routeParams,s.a.services.$scope,s.a.services.$timeout,s.a.services.assetService,s.a.services.clientResources,s.a.services.customConnectorUrlService,s.a.services.navigation,s.a.services.swaggerEditorData,s.a.services.swaggerValidationService,s.a.services.telemetry]},33919:function(e,t){e.exports='<div class="subsection-manage customApiAction">\n    \x3c!-- General section --\x3e\n    <section>\n        <h2 class="pane-title">\n            {{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.CopilotAction.Heading}}\n        </h2>\n        <div class="pane-content">\n            <div class="pane-field">\n                \x3c!-- Enable copilot operation --\x3e\n                <div class="column medium-6 right-pane">\n                    <div class="c-checkbox">\n                        <label class="pane-field-label">\n                            <input\n                                aria-label="{{::customApiCopilotActionCtrl.clientResources.Manage.Connection.Create.UseGatewayCheckboxLabel}}"\n                                ng-change="customApiCopilotActionCtrl.onIsOnPremiseDataGatewayChanged()"\n                                ng-model="customApiCopilotActionCtrl.copilotPluginData[\'openai-enabled\']"\n                                type="checkbox" />\n                            <span>{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.CopilotAction.RightPane.EnableCoPilotOperation.Label}}</span>\n                        </label>\n                    </div>\n                </div>\n                \x3c!-- user confirmation required --\x3e\n                <div class="column medium-6 right-pane">\n                    <div class="c-checkbox">\n                        <label class="pane-field-label">\n                            <input\n                                aria-label="{{::customApiCopilotActionCtrl.clientResources.Manage.Connection.Create.UseGatewayCheckboxLabel}}"\n                                ng-change="customApiCopilotActionCtrl.onIsOnPremiseDataGatewayChanged()"\n                                ng-model="customApiCopilotActionCtrl.copilotPluginOperation[\'x-ms-require-user-confirmation\']"\n                                type="checkbox"\n                                ng-disabled="customApiCopilotActionCtrl.isUserConfirmationDisabled" />\n                            <span>{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.CopilotAction.RightPane.UserConfirmation.Label}}</span>\n                        </label>\n                    </div>\n                </div>\n            </div>\n            \x3c!-- Summary --\x3e\n            <div class="pane-field">\n                <validated-input\n                    input-id="::customApiCopilotActionCtrl.summaryInputId"\n                    input-model="customApiCopilotActionCtrl.action.operation.summary"\n                    label="::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.CopilotAction.RightPane.Summary.Label"\n                    learn-more-resource="\'Manage.CustomApi.CopilotAction.RightPane.Summary.Hyperlink\'"\n                    learn-more-link-aria-label="::customApiActionCtrl.clientResources.Manage.CustomApi.CopilotAction.RightPane.Summary.LearnMoreAriaLabel"\n                    is-read-only="true">\n                </validated-input>\n            </div>\n            \x3c!-- Description --\x3e\n            <div class="pane-field">\n                <validated-input\n                    input-model="customApiCopilotActionCtrl.action.operation.description"\n                    label="::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.CopilotAction.RightPane.Description.Label"\n                    learn-more-resource="\'Manage.CustomApi.CopilotAction.RightPane.Description.Hyperlink\'"\n                    learn-more-link-aria-label="::customApiActionCtrl.clientResources.Manage.CustomApi.CopilotAction.RightPane.Description.LearnMoreAriaLabel"\n                    is-read-only="true">\n                </validated-input>\n            </div>\n            \x3c!-- Operation id --\x3e\n            <div class="pane-field">\n                <validated-input\n                    input-model="customApiCopilotActionCtrl.copilotPluginOperation.operationId"\n                    label="::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.CopilotAction.RightPane.CoPilotOperationId.Label"\n                    validation-result-collection="customApiCopilotActionCtrl.validationFilters.operationId.resultCollection"\n                    is-required="true"\n                    is-read-only="true">\n                </validated-input>\n            </div>\n        </div>\n    </section>\n    \x3c!-- Request --\x3e\n    <section class="customApiAction-section">\n        <h5 class="c-heading-5">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}</h5>\n        <p class="c-subheading-5">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.General.Request.Description}}</p>\n        <div class="customApiAction-pane" ng-if="customApiCopilotActionCtrl.action.path">\n            <h2 class="pane-title">\n                {{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Heading}}\n            </h2>\n            <div class="pane-content">\n                \x3c!-- Verbs --\x3e\n                <div class="pane-field">\n                    <legend class="pane-field-label">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Heading}} <span class="context-required-text">*</span></legend>\n                    <label class="subtitle">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Verb.Description}}</label>\n                    <span class="customApiAction-pane-field-value">{{customApiCopilotActionCtrl.actionRequestVerb}}</span>\n                </div>\n                \x3c!-- URL --\x3e\n                <div class="pane-field">\n                    <validated-input\n                        input-model="customApiCopilotActionCtrl.fullActionUrl"\n                        label="::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Heading"\n                        validation-result-collection="customApiCopilotActionCtrl.validationFilters.path.resultCollection"\n                        is-read-only="true"\n                        is-required="true"\n                        description="::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Url.Description" >\n                    </validated-input>\n                </div>\n                \x3c!-- Path parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Heading}}</label>\n                    <label class="subtitle">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Path.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="pathParameter in customApiCopilotActionCtrl.request.pathParameters track by pathParameter.name"\n                            commands="customApiCopilotActionCtrl.dropdownCommands"\n                            token="pathParameter"\n                            required="pathParameter.required"\n                            text="pathParameter.name" ></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Query parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Heading}}</label>\n                    <label class="subtitle">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Query.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="queryParameter in customApiCopilotActionCtrl.request.queryParameters track by queryParameter.name"\n                            commands="customApiCopilotActionCtrl.dropdownCommands"\n                            token="queryParameter"\n                            required="queryParameter.required"\n                            text="queryParameter.name" ></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Header parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Heading}}</label>\n                    <label class="subtitle">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Headers.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-repeat="headerParameter in customApiCopilotActionCtrl.request.headerParameters track by headerParameter.name"\n                            commands="customApiCopilotActionCtrl.dropdownCommands"\n                            token="headerParameter"\n                            required="headerParameter.required"\n                            text="headerParameter.name" ></react-token-block>\n                    </div>\n                </div>\n                \x3c!-- Body parameters --\x3e\n                <div class="pane-field">\n                    <label class="pane-field-label">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Heading}}</label>\n                    <label class="subtitle">{{::customApiCopilotActionCtrl.clientResources.Manage.CustomApi.RightPane.Request.Body.Description}}</label>\n                    <div class="pane-elements">\n                        <react-token-block\n                            ng-if="customApiCopilotActionCtrl.request.bodyParameter"\n                            commands="customApiCopilotActionCtrl.dropdownCommands"\n                            token="customApiCopilotActionCtrl.request.bodyParameter"\n                            required="customApiCopilotActionCtrl.request.bodyParameter.required"\n                            text="customApiCopilotActionCtrl.request.bodyParameter.name" ></react-token-block>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n'},33920:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33921);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33922),this.controller=o.a,this.controllerAs="customApiCopilotParameterCtrl"}));r.a.component(n.a.components.customApi.customApiCopilotParameter,new c)},33921:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(13083),n=i(33327),o=i(33360),a=i(33359),s=i(33886),l=i(33804),c=i(33800),u=i(33357),d=i(33801),p=i(13272),h=i(12330),m=i(33398),g=i(17914);function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(){function e(t,i,r,n,d,f,v,b,y,w){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.$scope=i,this.$timeout=r,this.assetService=n,this.clientResources=d,this.customConnectorUrlService=f,this.navigationService=v,this.swaggerEditorDataService=b,this.swaggerValidationService=y,this.telemetryService=w,this.iconName=p.a,this.nameInputId="customApiParameter-name-".concat(Object(o.e)()),this.backButtonTelemetryData={name:m.a.CustomApiCopilotParameterBackButtonClicked},this.parameterProperty={description:"","x-ms-summary":"",required:!1,default:"","x-ms-explicit-input":!1},this.copilotParameterIndex=void 0,this.actionIndex=void 0,this.triggerIndex=void 0,this.parameterIndex=void 0,this.referencingOperationItems=[],this.selectedSchemaPropertyViolator=void 0,this.defaultParameterValue=void 0,this.isRefParameter=!1,this.baseViolator=void 0,this.schemaSwaggerItem=void 0,this.validationFilters={},this.mode=void 0,this.resolvedSchema=void 0,this.requiredOptions=void 0,this.locationOptions=void 0,this.selectedSchemaPropertyIndex=void 0,this.parameterVisibility=void 0,this.dropdownCommands=void 0,this.visibilityOptions=Object.keys(a.l).map(e=>({key:a.l[e],text:a.l[e],disabled:!0})),this.visibilityOptionsLabelLink=void 0,this.parameterGetter={[s.a.InlineAction]:()=>this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation.parameters[this.parameterIndex],[s.a.InlineTrigger]:()=>this.swaggerEditorDataService.swagger.triggers[this.triggerIndex].operation.parameters[this.parameterIndex],[s.a.Definition]:()=>this.swaggerEditorDataService.swagger.parameters[this.parameterIndex].item,[s.a.Undefined]:()=>({})},this.parameterReferenceGetter={[s.a.InlineAction]:()=>"",[s.a.InlineTrigger]:()=>"",[s.a.Definition]:()=>"#/parameters/".concat(this.swaggerEditorDataService.swagger.parameters[this.parameterIndex].name),[s.a.Undefined]:()=>""},this.operationItemGetter={[s.a.InlineAction]:()=>this.swaggerEditorDataService.swagger.actions[this.actionIndex],[s.a.InlineTrigger]:()=>this.swaggerEditorDataService.swagger.triggers[this.triggerIndex],[s.a.Definition]:()=>null,[s.a.Undefined]:()=>null},this.baseViolatorGetter={[s.a.InlineAction]:()=>new c.i({itemPath:"".concat(c.d.Actions,"[").concat(this.actionIndex,"]").concat(c.d.OperationParameters,"[").concat(this.parameterIndex,"]")}),[s.a.InlineTrigger]:()=>new c.i({itemPath:"".concat(c.d.Triggers,"[").concat(this.triggerIndex,"]").concat(c.d.OperationParameters,"[").concat(this.parameterIndex,"]")}),[s.a.Definition]:()=>new c.i({itemPath:"".concat(c.d.Parameters,"[").concat(this.parameterIndex,"]").concat(c.d.Item)}),[s.a.Undefined]:()=>null},this.onClickBack=()=>{Object(h.a)(this.actionIndex)||this.navigationService.navigate(this.customConnectorUrlService.getCustomApiCopilotTypeUrl(g.a.actions,this.actionIndex))},this.onRequiredOptionChange=(e,t)=>{this.parameterProperty.required=t.key===(!0).toString()},this.requiredOptions=[{key:(!0).toString(),text:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.Yes,disabled:!0},{key:(!1).toString(),text:this.clientResources.Manage.CustomApi.RightPane.SchemaProperty.Required.No,disabled:!0}],this.locationOptions=[{key:l.c.path,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Path,disabled:!0},{key:l.c.query,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Query,disabled:!0},{key:l.c.header,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Header,disabled:!0},{key:l.c.body,text:this.clientResources.Manage.CustomApi.RightPane.Parameter.Location.Body,disabled:!0}],this.visibilityOptionsLabelLink={href:this.clientResources.Manage.CustomApi.Definition.RightPane.Visibility.Hyperlink,ariaLabel:this.clientResources.Manage.CustomApi.RightPane.Parameter.Visibility.LearnMoreAriaLabel,telemetryData:{name:"CustomApiParameter.Visibility.LearnMoreClicked"}},this.telemetryService.tagEvent(m.a.CustomApiCopilotParameterVisited);var S=this.$routeParams.operation;this.isRefParameter=this.$routeParams.refOperation===g.a.refParameter,S===g.a.actions&&(this.actionIndex=this.$routeParams.operationIndex),this.parameterIndex=Object(h.a)(this.$routeParams.refOperationIndex)?this.$routeParams.operationIndex:this.$routeParams.refOperationIndex,this.mode=s.a.Undefined,Object(h.a)(this.actionIndex)||Object(h.a)(this.parameterIndex)||this.isRefParameter?Object(h.a)(this.parameterIndex)||(this.mode=s.a.Definition):this.mode=s.a.InlineAction,this.parameterVisibility=this.parameter[a.i.Visibility]||a.l.none,this.selectedSchemaPropertyIndex=void 0,this.mode===s.a.InlineAction?this.referencingOperationItems=[this.operationItem]:this.mode===s.a.Definition&&(this.referencingOperationItems=u.r(this.swaggerEditorDataService.swagger,this.swaggerEditorDataService.swagger.parameters[this.parameterIndex].name)),this.$scope.$watchGroup([()=>this.swaggerValidationService.resultCollection.results,()=>this.validationFilters],()=>{Object.keys(this.validationFilters).map(e=>this.validationFilters[e]).forEach(e=>e.updateFilteredResults(this.swaggerValidationService.resultCollection))}),this.parameterProperty.required=!!this.parameter.required,this.syncParameterProperty(),this.$scope.$watch(()=>this.swaggerEditorDataService.swagger.actions[this.actionIndex].operation["x-ms-openai-data"],()=>this.syncParameterProperty()),this.$scope.$watchGroup([()=>this.parameterProperty.default,()=>this.parameterProperty.description,()=>this.parameterProperty.required,()=>this.parameterProperty["x-ms-summary"],()=>this.parameterProperty["x-ms-explicit-input"]],()=>this.updateOrCreateCopliotParamProperties()),this.$timeout(()=>{var e=document.getElementById(this.nameInputId);e&&e.focus()})}var t,i,n;return t=e,(i=[{key:"selectedVisibilityOption",get:function(){return this.parameter[a.i.Visibility]}},{key:"selectedRequiredOption",get:function(){return(!!this.parameterProperty.required).toString()}},{key:"selectedLocationOption",get:function(){return this.parameter.in}},{key:"parameter",get:function(){return this.parameterGetter[this.mode]()}},{key:"operationItem",get:function(){return this.operationItemGetter[this.mode]()}},{key:"shouldDisplayBackButton",get:function(){return!Object(h.a)(this.selectedSchemaPropertyIndex)||!Object(h.a)(this.actionIndex)||!Object(h.a)(this.triggerIndex)}},{key:"isBodyParameter",get:function(){return"body"===this.parameter.in}},{key:"visibilityChanged",value:function(){this.parameterVisibility===a.l.none?(delete this.parameter[a.i.Visibility],this.parameter.schema&&delete this.parameter.schema[a.i.Visibility]):(this.parameter[a.i.Visibility]=this.parameterVisibility,this.parameter.schema&&(this.parameter.schema[a.i.Visibility]=this.parameterVisibility))}},{key:"syncParameterProperty",value:function(){var e,t;if(void 0!==(null===(e=this.copilotPluginData)||void 0===e?void 0:e.parameters)&&null!==(null===(t=this.copilotPluginData)||void 0===t?void 0:t.parameters)){var i,r,n=this.getCopilotParamIndex();if(-1===n)return;if(null!==(i=this.copilotPluginData)&&void 0!==i&&null!==(i=i.parameters[n])&&void 0!==i&&i.properties&&(null===(r=this.copilotPluginData)||void 0===r||null===(r=r.parameters[n])||void 0===r?void 0:r.properties.length)>=0)for(var o of null===(a=this.copilotPluginData)||void 0===a?void 0:a.parameters[n].properties){var a;this.parameterProperty.hasOwnProperty(o.name)&&(this.parameterProperty[o.name]=o.value)}}}},{key:"getCopilotParamIndex",value:function(){var e,t;return(null===(e=this.copilotPluginData)||void 0===e||null===(e=e.parameters)||void 0===e?void 0:e.length)>=0?null===(t=this.copilotPluginData)||void 0===t?void 0:t.parameters.findIndex(e=>e.name===this.parameter.name&&e.type===l.a.upsert):-1}},{key:"copilotPluginData",get:function(){var e;return null===(e=this.swaggerEditorDataService.swagger.actions[this.actionIndex])||void 0===e||null===(e=e.operation)||void 0===e?void 0:e["x-ms-openai-data"].operations[0]}},{key:"updateOrCreateCopliotParamProperties",value:function(){for(var e in this.parameterProperty)if(this.parameterProperty.hasOwnProperty(e)){var t=this.parameterProperty[e];"default"===e&&(t=this.getDefaultPropNewValue(t)),this.updateOrCreateCopliotParamProperty(e,t)}}},{key:"updateOrCreateCopliotParamProperty",value:function(e,t){var i,n=this.getCopilotParamIndex(),o=null===(i=this.copilotPluginData)||void 0===i?void 0:i.parameters[n].properties.findIndex(t=>t.name===e);-1!==o?Object(r.a)(t)?this.copilotPluginData.parameters[n].properties.splice(o,1):this.copilotPluginData.parameters[n].properties[o].value=t:Object(r.a)(t)||this.copilotPluginData.parameters[n].properties.push({name:e,value:t,type:"upsert"})}},{key:"getDefaultPropNewValue",value:function(e){var t=Object(d.d)(e);return"integer"===t||"number"===t||"boolean"===t||"array"===t?JSON.parse(e):Object(r.a)(e)?void 0:e}}])&&f(t.prototype,i),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();b.$inject=[n.a.services.$routeParams,n.a.services.$scope,n.a.services.$timeout,n.a.services.assetService,n.a.services.clientResources,n.a.services.customConnectorUrlService,n.a.services.navigation,n.a.services.swaggerEditorData,n.a.services.swaggerValidationService,n.a.services.telemetry]},33922:function(e,t){e.exports='<div class="subsection-manage custom-api-parameter">\n    <div>\n        <section ng-if="customApiCopilotParameterCtrl.selectedSchemaPropertyIndex === undefined">\n            <h2 class="pane-title">\n                {{::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Heading}}\n            </h2>\n            <div class="pane-content">\n                \x3c!-- Name --\x3e\n                <div class="pane-field">\n                    <validated-input input-id="::customApiCopilotParameterCtrl.nameInputId"\n                        input-model="customApiCopilotParameterCtrl.parameter.name"\n                        is-required="true"\n                        is-read-only="true"\n                        label="::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Name.Label">\n                    </validated-input>\n                </div>\n                \x3c!-- x-ms-explicit-input --\x3e\n                <div class="pane-field">\n                    <div class="column medium-6 right-pane">\n                        <div class="c-checkbox">\n                            <label class="pane-field-label">\n                                <input\n                                    aria-label="{{::customApiCopilotParameterCtrl.clientResources.Manage.Connection.Create.UseGatewayCheckboxLabel}}"\n                                    ng-change="customApiCopilotParameterCtrl.onIsOnPremiseDataGatewayChanged()"\n                                    ng-model="customApiCopilotParameterCtrl.parameterProperty[\'x-ms-explicit-input\']"\n                                    type="checkbox" />\n                                <span>{{::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.CopilotParameterProperty.ExplicitInput.Label}}</span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n                \x3c!-- Description --\x3e\n                <div class="pane-field" ng-if="!customApiCopilotParameterCtrl.isBodyParameter">\n                    <validated-input input-model="customApiCopilotParameterCtrl.parameter.description"\n                        label="::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.CopilotParameterProperty.Description.Label"\n                        learn-more-resource="\'Manage.CustomApi.CopilotAction.RightPane.Summary.Hyperlink\'"\n                        learn-more-link-aria-label="::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Description.LearnMoreAriaLabel"\n                        is-read-only="true">\n                    </validated-input>\n                </div>\n                \x3c!-- Summary --\x3e\n                <div class="pane-field" ng-if="!customApiCopilotParameterCtrl.isBodyParameter">\n                    <validated-input input-model="customApiCopilotParameterCtrl.parameter[\'x-ms-summary\']"\n                        label="::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.CopilotParameterProperty.Summary.Label"\n                        learn-more-resource="\'Manage.CustomApi.CopilotAction.RightPane.Summary.Hyperlink\'"\n                        learn-more-link-aria-label="::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Summary.LearnMoreAriaLabel"\n                        is-read-only="true">\n                    </validated-input>\n                </div>\n                \x3c!-- Default --\x3e\n                <div class="pane-field" ng-if="!customApiCopilotParameterCtrl.isBodyParameter">\n                    <validated-input input-model="customApiCopilotParameterCtrl.parameter.default"\n                        label="::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.DefaultValue.Label"\n                        is-read-only="true">\n                    </validated-input>\n                </div>\n                \x3c!-- Required --\x3e\n                <div class="pane-field">\n                    <react-choice-group options="::customApiCopilotParameterCtrl.requiredOptions"\n                        label="::customApiCopilotParameterCtrl.clientResources.Manage.CustomApi.RightPane.Parameter.Required.Label"\n                        direction="\'horizontal\'" selected-key="customApiCopilotParameterCtrl.selectedRequiredOption"\n                        on-change="::customApiCopilotParameterCtrl.onRequiredOptionChange"></react-choice-group>\n                </div>\n            </div>\n        </section>\n    </div>\n</div>'},33923:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33924);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var l=["authenticationTypeOptions","selectedAuthenticationTypes","onSelectedAuthenticationTypesChanged","isReadOnly","enableEditMode","usernameLabel","passwordLabel","onUsernameLabelChanged","onPasswordLabelChanged","apiKeyLabel","apiKeyName","apiKeyLocation","onApiKeyLabelChanged","onApiKeyNameChanged","onApiKeyLocationChanged","identityProviders","selectedIdentityProviderId","onIdentityProviderIdChanged","showServicePrincipalSupport","enableServicePrincipalSupport","onEnableServicePrincipalSupportChanged","redirectUrl","scope","onScopeChanged",,"showUniqueRedirectUrlCheckbox","isUniqueRedirectUrl","onIsUniqueRedirectUrlChanged","showSpinner","getIdentityProviderParameters","getOAuthFormItemParameterValues","updateOAuthFormItemParameterValue","isManagedIdentitySupportEnabled","useManagedIdentity","federatedIdentityCredentials","onAadSecretOptionChanged"];r.a.directive(n.a.components.react.reactCustomConnectorSecurityTab,[n.a.modules.reactDirective,e=>e(c,l)]);var c=e=>{var t=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e);return Object(o.a)(t)}},33924:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(12246),n=i(11776),o=i(11766),a=i.n(o);function s(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function l(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){s(o,r,n,a,l,"next",e)}function l(e){s(o,r,n,a,l,"throw",e)}a(void 0)}))}}var c=Object(n.a)(l((function*(){var[e]=yield Promise.all([i.e(456).then(i.bind(null,35934)),Object(r.j)("PowerAutomateCustomConnectors")]);return e.CustomConnectorSecurityComponent})),{fallback:a.a.createElement("div",null)}),u=e=>a.a.createElement(c,e)},33925:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33926);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33927),this.controller=o.a,this.controllerAs="reactSecurityTabWrapperCtrl"}));n.a.component(r.a.components.customApi.reactCustomApiSecurityTabWrapper,new c)},33926:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(14868),n=i(33327),o=i(33352),a=i(33817),s=i(17914),l=i(33846);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=[r.b.None,r.b.Basic,r.b.ApiKey,r.b.Oauth2],p=[r.b.None,r.b.Basic,r.b.Windows],h=[r.b.None,r.b.Basic],m=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.swaggerEditorDataService=t,this.widgetUtilService=i,this.previousTab=s.c.general,this.nextTab=s.c.definition,this.swaggerEditorData=void 0,this.onAuthenticationTypesChanged=e=>{this.swaggerEditorDataService.onAuthenticationTypesChangedV2(e)},this.onEditSecurityDefinitionClicked=()=>{this.swaggerEditorDataService.securityTabDetails.isLocked=!1},this.onUsernameLabelChanged=e=>{this.swaggerEditorDataService.securityTabDetails.basicAuthFormItems.usernameLabel=e},this.onPasswordLabelChanged=e=>{this.swaggerEditorDataService.securityTabDetails.basicAuthFormItems.passwordLabel=e},this.onApiKeyLabelChanged=e=>{this.swaggerEditorDataService.securityTabDetails.apiKeyLabel=e},this.onApiKeyNameChanged=e=>{this.swaggerEditorDataService.securityTabDetails.apiKeyName=e},this.onApiKeyLocationChanged=e=>{this.swaggerEditorDataService.securityTabDetails.selectedApiKeyLocation=e},this.onIdentityProviderIdChanged=e=>{this.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId!==e&&(this.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId=e,this.swaggerEditorDataService.setIdentityProvider())},this.onEnableServicePrincipalSupportChanged=e=>{this.swaggerEditorDataService.updateServicePrincipalSupport(e)},this.onScopeChanged=e=>{this.swaggerEditorDataService.securityTabDetails.scopeInput=e},this.onIsUniqueRedirectUrlChanged=e=>{this.swaggerEditorDataService.securityTabDetails.uniqueRedirectUrlChecked=e},this.getIdentityProviderParameters=e=>{var t;return null===(t=this.swaggerEditorDataService.securityTabDetails.cache.identityProviderParameters)||void 0===t?void 0:t[e]},this.getOAuthFormItemParameterValues=()=>{var e;return null===(e=this.swaggerEditorDataService)||void 0===e||null===(e=e.securityTabDetails)||void 0===e?void 0:e.oAuthFormItemValues},this.updateOAuthFormItemParameterValue=(e,t)=>{this.swaggerEditorDataService.securityTabDetails.oAuthFormItemValues[e]=t},this.onAadSecretOptionChanged=e=>{this.swaggerEditorDataService.updateAadSecretOption(e)},this.swaggerEditorData=t.SwaggerEditorData}var t,i,r;return t=e,(i=[{key:"authenticationTypeOptions",get:function(){return this.widgetUtilService.isLogicApps()&&this.swaggerEditorData.apiLogicApps.properties.apiType===o.a.Soap?h:this.swaggerEditorData.isOnPremiseDataGateway?p:d}},{key:"showUniqueRedirectUrlCheckbox",get:function(){return Object(l.h)(this.swaggerEditorDataService.securityTabDetails,!0)}},{key:"isManagedIdentitySupportEnabled",get:function(){return!!Object(a.a)()}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();m.$inject=[n.a.services.swaggerEditorData,n.a.services.widgetUtilService]},33927:function(e,t){e.exports='<div>\n    <react-custom-connector-security-tab\n        authentication-type-options="reactSecurityTabWrapperCtrl.authenticationTypeOptions"\n        selected-authentication-types="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.selectedAuthenticationTypes"\n        on-selected-authentication-types-changed="reactSecurityTabWrapperCtrl.onAuthenticationTypesChanged"\n        is-read-only="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.isLocked"\n        enable-edit-mode="reactSecurityTabWrapperCtrl.onEditSecurityDefinitionClicked"\n\n        username-label="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.basicAuthFormItems.usernameLabel"\n        password-label="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.basicAuthFormItems.passwordLabel"\n        on-username-label-changed="reactSecurityTabWrapperCtrl.onUsernameLabelChanged"\n        on-password-label-changed="reactSecurityTabWrapperCtrl.onPasswordLabelChanged"\n\n        api-key-label="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.apiKeyLabel"\n        api-key-name="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.apiKeyName"\n        api-key-location="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.selectedApiKeyLocation"\n        on-api-key-label-changed="reactSecurityTabWrapperCtrl.onApiKeyLabelChanged"\n        on-api-key-name-changed="reactSecurityTabWrapperCtrl.onApiKeyNameChanged"\n        on-api-key-location-changed="reactSecurityTabWrapperCtrl.onApiKeyLocationChanged"\n\n        identity-providers="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.cache.identityProviders"\n        selected-identity-provider-id="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.selectedIdentityProviderId"\n        on-identity-provider-id-changed="reactSecurityTabWrapperCtrl.onIdentityProviderIdChanged"\n\n        show-service-principal-support="reactSecurityTabWrapperCtrl.swaggerEditorDataService.multiAuthSupported"\n        enable-service-principal-support="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.enableServicePrincipalSupport"\n        on-enable-service-principal-support-changed="reactSecurityTabWrapperCtrl.onEnableServicePrincipalSupportChanged"\n        redirect-url="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.redirectUrl"\n        scope="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.scopeInput"\n        on-scope-changed="reactSecurityTabWrapperCtrl.onScopeChanged"\n        show-unique-redirect-url-checkbox="reactSecurityTabWrapperCtrl.showUniqueRedirectUrlCheckbox"\n        is-unique-redirect-url="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.uniqueRedirectUrlChecked"\n        on-is-unique-redirect-url-changed="reactSecurityTabWrapperCtrl.onUniqueRedirectUrlChanged"\n\n        show-spinner="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.showSpinner"\n        get-identity-provider-parameters="reactSecurityTabWrapperCtrl.getIdentityProviderParameters"\n        get-o-auth-form-item-parameter-values="reactSecurityTabWrapperCtrl.getOAuthFormItemParameterValues"\n        update-o-auth-form-item-parameter-value="reactSecurityTabWrapperCtrl.updateOAuthFormItemParameterValue"\n\n        is-managed-identity-support-enabled="reactSecurityTabWrapperCtrl.isManagedIdentitySupportEnabled"\n        use-managed-identity="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.useManagedIdentity"\n        federated-identity-credentials="reactSecurityTabWrapperCtrl.swaggerEditorDataService.securityTabDetails.federatedIdentityCredentials"\n        on-aad-secret-option-changed="reactSecurityTabWrapperCtrl.onAadSecretOptionChanged"\n    >\n    </react-custom-connector-security-tab>\n    <section class="row" >\n        <div class="column medium-8 medium-offset-4">\n            <custom-api-tab-navigation\n                previous-tab="reactSecurityTabWrapperCtrl.previousTab"\n                next-tab="reactSecurityTabWrapperCtrl.nextTab">\n            </custom-api-tab-navigation>\n        </div>\n    </section>\n</div>'},33928:function(e,t,i){"use strict";i(33929),i(33930),i(33931),i(33939)},33929:function(e,t,i){"use strict";var r=i(33331),n=i(33353),o=i(33327),a=i(33795),s=i(13083),l=i(14883);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$timeout=t,this.codeEditorData=void 0,this.hideAlertInProgress=void 0,this.autoHideNotificationInterval=3e3,this.initializeData()}var t,i,r;return t=e,(i=[{key:"CodeEditorData",get:function(){return this.codeEditorData}},{key:"hasScriptOperationsBeenModified",value:function(){return!Object(a.b)(this.codeEditorData.scriptOperations,this.codeEditorData.deployedScriptOperations)}},{key:"hasSourceCodeBeenModified",value:function(){return!Object(l.e)(this.codeEditorData.sourceCode,this.codeEditorData.deployedSourceCode)}},{key:"isSourceCodeEmptyString",value:function(){return Object(s.a)(this.codeEditorData.sourceCode)}},{key:"hasDefaultCode",value:function(){return Object(l.e)(this.codeEditorData.sourceCode,a.a)}},{key:"clear",value:function(){this.initializeData()}},{key:"initializeData",value:function(){this.codeEditorData={userUploadedCode:!1,sourceCode:a.a,codeEnabled:!1,operationSelectedKeys:[],validationError:null,statusAlert:{message:"",type:n.a.None,options:{title:null,show:(e,t)=>{this.codeEditorData.statusAlert.type=e,this.codeEditorData.statusAlert.message=t,-1===[n.a.Success,n.a.Info].indexOf(e)||this.hideAlertInProgress||(this.hideAlertInProgress=!0,this.$timeout(()=>{this.codeEditorData.statusAlert.options.hide(),this.hideAlertInProgress=!1},this.autoHideNotificationInterval))},hide:()=>this.codeEditorData.statusAlert.options.show(n.a.None,""),control:{action:()=>this.codeEditorData.validationError=null}}},deployedSourceCode:"",scriptOperations:[],deployedScriptOperations:[]}}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.factory(o.a.services.codeEditorData,[o.a.services.$timeout,e=>new d(e)])},33930:function(e,t,i){"use strict";var r=i(33328),n=i(33327),o=i(12366),a=i(13144),s=i(33350);function l(e,t,i){var r=Object(s.a)();return t({urlBase:Object(a.c)(e).powerAppsRP,urlPath:"".concat(o.M,"/").concat(i.getCurrentEnvironmentName(),"/policyTemplates"),apiVersion:e.powerAppsResourceProviderApiVersionWithEnvironments,rest:{query:{requestInterceptor:r}}})}l.$inject=[n.a.services.appSettings,n.a.services.azureResourceClientFactory,n.a.services.environment],r.a.factory(n.a.services.policyTemplatesClient,l)},33931:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33847),a=i(33932),s=i(33357),l=i(14868),c=i(20342),u=i(11891),d=i(14876),p=i(33846),h=i(33933),m=i(33934),g=i(33935),f=i(33936);function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=w(e);if(t){var n=w(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return y(this,i)}}function y(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?S(Object(i),!0).forEach((function(t){k(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function k(e,t,i){return(t=T(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function A(e,t,i){return t&&x(e.prototype,t),i&&x(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var R=function(){function e(){P(this,e)}return A(e,[{key:"initializeConnectionParameterSetsFromSwagger",value:function(e,t){t.connectionParameterSets=null}},{key:"updateMultiAuthAvailabilityFromSwagger",value:function(e,t){}},{key:"getOAuthParamValues",value:function(e){}},{key:"getOAuthRedirectMode",value:function(e,t){}},{key:"constructOAuth2ConnectionParameterSets",value:function(e,t){t.connectionParameterSets=null}},{key:"populateInlineSwaggerEditorSecurityDefinitions",value:function(e,t,i){}},{key:"updateMultiAuthSupport",value:function(e,t,i){}},{key:"updateAadSecretOption",value:function(e,t,i){}},{key:"enabled",get:function(){return!1}}]),e}(),O=function(){function e(t,i){P(this,e),this.connectionFormService=t,this.resources=i}return A(e,[{key:"formItemValue",value:function(e){var t;return(null==e||null===(t=e.value)||void 0===t?void 0:t.toString())||""}},{key:"getOAuthParamValuesFromSet",value:function(e){if(e){var t=e[a.a.token],i=Object(p.e)(t);if(!Object(d.a)(i)){var r={clientId:i.clientId};return i.customParameters&&Object.keys(i.customParameters).forEach(e=>{r[e]=i.customParameters[e].value}),r}}}},{key:"getAADTokenAndAuthUrls",value:function(e){var t;return{tokenUrl:"https://login.windows.net/common/oauth2/authorize",authorizationUrl:null===(t=e.cache)||void 0===t||null===(t=t.identityProviders)||void 0===t||null===(t=t.find(e=>Object(u.a)(e.Id,o.a.AAD)))||void 0===t||null===(t=t.AuthorizationEndPoints)||void 0===t?void 0:t[0]}}},{key:"updateSwaggerSecurityDefinitionFromParameterValues",value:function(e,t,i,r,n){if(i.scopes=Object(p.b)(r.scopes||[]),i.tokenUrl=n.TokenUrl,i.authorizationUrl=n.AuthorizationUrl,Object(u.a)(r.selectedIdentityProviderId,o.a.AAD)){var{tokenUrl:a,authorizationUrl:s}=this.getAADTokenAndAuthUrls(r);i.tokenUrl=a,i.authorizationUrl=s}i.flow===c.d.Application&&delete i.authorizationUrl,e.securityDefinitions[t]=C({},i)}},{key:"getSecurityTabDetailsScopes",value:function(e){return[...e.scopes||[]]}},{key:"updateSwaggerSecurityRequirement",value:function(e,t,i){e.security||(e.security=[]);var r=e.security.find(e=>e[t]);r||(r={[t]:[]},e.security.push(r)),r[t]=this.getSecurityTabDetailsScopes(i)}},{key:"isCertOauth",value:function(e){return e===p.a.ConnectionParameterSetName}},{key:"addConnectionParameterSet",value:function(e,t,i,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],[o]=Object(m.a)(),a=this.getSupportedGrantTypeFromSwaggerFlow(t.flow),s=a===l.e.ClientCredentials,c=o&&this.isCertOauth(e),{displayName:u,description:d}=s?c?this.resources.Services.MultiAuthService.ConnectionParameterSet.CertOauthConnection:this.resources.Services.MultiAuthService.ConnectionParameterSet.ServicePrincipalConnection:this.resources.Services.MultiAuthService.ConnectionParameterSet.OAuthConnection,h=c?this.resources.Services.MultiAuthService.ConnectionParameterSet.CertOauthGeneralTokenUiDefinition.displayName:u,g=c?this.resources.Services.MultiAuthService.ConnectionParameterSet.CertOauthGeneralTokenUiDefinition.description:d,f={name:e,parameters:{token:{type:"oAuthSetting",oAuthSettings:{identityProvider:c?p.a.IdentityProvider:i.selectedIdentityProviderId,scopes:this.getSecurityTabDetailsScopes(i),redirectMode:this.getOAuthRedirectMode(i,n),customParameters:{GrantType:{value:a}}},uiDefinition:{displayName:h,description:g,constraints:{required:(!s).toString().toLowerCase(),hidden:s.toString().toLowerCase()}}}},metadata:{allowSharing:s},uiDefinition:{displayName:u,description:d,constraints:{hidden:"false"}}};Object(p.c)(r,f.parameters),s&&this.fillClientCredentialsConnectionParameter(f,c),i.connectionParameterSets.values.push(f)}},{key:"fillClientCredentialsConnectionParameter",value:function(e,t){e.parameters["token:clientId"]={type:"string",uiDefinition:{displayName:this.resources.Services.MultiAuthService.ConnectionParameterSet.ClientId.UiDefinition.displayName,schema:{type:"string",description:this.resources.Services.MultiAuthService.ConnectionParameterSet.ClientId.UiDefinition.description},constraints:{required:"true",hidden:"false"}}},t?e.parameters[p.a.ClientCertificateSecretTokenKey]={type:p.a.ParameterType,uiDefinition:{displayName:this.resources.Services.MultiAuthService.ConnectionParameterSet.ClientCertificateSecret.UiDefinition.displayName,description:this.resources.Services.MultiAuthService.ConnectionParameterSet.ClientCertificateSecret.UiDefinition.description,constraints:{required:"true",hidden:"false"}}}:e.parameters["token:clientSecret"]={type:"securestring",uiDefinition:{displayName:this.resources.Services.MultiAuthService.ConnectionParameterSet.ClientSecret.UiDefinition.displayName,schema:{type:"securestring",description:this.resources.Services.MultiAuthService.ConnectionParameterSet.ClientSecret.UiDefinition.description},constraints:{required:"true",hidden:"false"}}},e.parameters["token:TenantId"]={type:"string",uiDefinition:{displayName:this.resources.Services.MultiAuthService.ConnectionParameterSet.TenantId.UiDefinition.displayName,schema:{type:"string",description:this.resources.Services.MultiAuthService.ConnectionParameterSet.TenantId.UiDefinition.description},constraints:{required:"true",hidden:"false"}}}}},{key:"getNewSecurityDefinitionName",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"oAuthClientCredentials",i=20,r=0,n=0,o=t,a=Object.keys((null==e?void 0:e.securityDefinitions)||{});a.includes(o)&&++n<i;)o="".concat(t,"-").concat(++r);return n>=i&&(o="".concat(t,"-").concat(Date.now())),o}},{key:"removeAllApplicationFlowSecurityDefinitions",value:function(e){var t;do{(t=this.findFirstSecurityDefinitionKeyByFlow(e,c.d.Application))&&delete e.securityDefinitions[t]}while(t)}},{key:"getSupportedGrantTypeFromSwaggerFlow",value:function(e){switch(e){case c.d.Application:return l.e.ClientCredentials;case c.d.AccessCode:return l.e.Code}}},{key:"getSupportedSecurityDefinitions",value:function(e){var t=Object(s.d)(e,l.b.Oauth2),i=Object.keys(t).filter(e=>this.getSupportedGrantTypeFromSwaggerFlow(t[e].flow)),r={};for(var n of i)r[n]=t[n];return r}},{key:"findFirstSecurityDefinitionKeyByFlow",value:function(e,t){var i=this.getSupportedSecurityDefinitions(e);return Object.keys(i).find(e=>{var r;return(null===(r=i[e])||void 0===r?void 0:r.flow)===t})}},{key:"firstSecurityDefinitionByFlow",value:function(e,t){var i;return null===(i=e.securityDefinitions)||void 0===i?void 0:i[this.findFirstSecurityDefinitionKeyByFlow(e,t)]}},{key:"hasAccessCodeAndApplicationFlows",value:function(e){if(!e)return!1;var t=!!this.firstSecurityDefinitionByFlow(e,c.d.AccessCode),i=!!this.firstSecurityDefinitionByFlow(e,c.d.Application);return t&&i}},{key:"resetSwaggerSecurityProperties",value:function(e){e.securityDefinitions={},e.security=[]}},{key:"ensureSecurityDefinitionKeyCompliance",value:function(e){return e.replace(/[\_\s]/g,"-")}},{key:"getDefaultConnectionParameterSets",value:function(){return{uiDefinition:this.resources.Services.MultiAuthService.ConnectionParameterSet.UiDefinition,values:[]}}},{key:"updateOAuth2DetailsFromForm",value:function(e,t,i,r){t.connectionParameterSets=this.getDefaultConnectionParameterSets();var n=this.getSupportedSecurityDefinitions(e);this.resetSwaggerSecurityProperties(e);var o=Object.keys(n);for(var a of o){var s=n[a];a=this.ensureSecurityDefinitionKeyCompliance(a),this.updateSwaggerSecurityDefinitionFromParameterValues(e,a,s,t,i),this.updateSwaggerSecurityRequirement(e,a,t),this.addConnectionParameterSet(a,s,t,i,r)}}},{key:"combineScopesFromSecurityDefinitionsAndUpdateSecurityTabDetails",value:function(e,t){var i=Object(s.d)(e,l.b.Oauth2),r=[];for(var n of Object.keys(i)){var o=i[n];Array.isArray(o.scopes)?r=r.concat(o.scopes):o.scopes instanceof Object&&(r=r.concat(Object.keys(o.scopes)))}t.scopes=[...new Set(r)],t.scopeInput=t.scopes.join(", ")}},{key:"initializeConnectionParameterSetsFromSwagger",value:function(e,t){if(t.connectionParameterSets=null,t.enableServicePrincipalSupport=!1,this.hasAccessCodeAndApplicationFlows(e)){var i=this.getDefaultConnectionParameterSets(),r=this.getSupportedSecurityDefinitions(e),n=Object.keys(r);if(!(n.length<2)){for(var o of(this.combineScopesFromSecurityDefinitionsAndUpdateSecurityTabDetails(e,t),n)){var s=r[o],l=this.getSupportedGrantTypeFromSwaggerFlow(s.flow),c={name:o,parameters:{[a.a.token]:{type:"oauthSetting",oAuthSettings:{identityProvider:t.selectedIdentityProviderId||"",scopes:this.getSecurityTabDetailsScopes(t),customParameters:{GrantType:{value:l}}}}}};i.values.push(c)}t.connectionParameterSets=i,t.enableServicePrincipalSupport=!0}}}},{key:"updateMultiAuthAvailabilityFromSwagger",value:function(e,t){t.enableServicePrincipalSupport=this.hasAccessCodeAndApplicationFlows(e)}},{key:"getOAuthParamValues",value:function(e){var t,i=(null==e||null===(t=e.connectionParameterSets)||void 0===t?void 0:t.values)||[];for(var r of i){var n,o,s=null==r||null===(n=r.parameters)||void 0===n||null===(n=n[a.a.token])||void 0===n?void 0:n.oAuthSettings;if((null==s||null===(o=s.customParameters)||void 0===o||null===(o=o.grantType)||void 0===o?void 0:o.value)===l.e.Code){var c=this.getOAuthParamValuesFromSet(r.parameters);if(c)return c}}}},{key:"getOAuthRedirectMode",value:function(e,t){var i;if(e.uniqueRedirectUrlChecked)i=c.g.GlobalPerConnector;else if(t&&e.redirectMode!==c.g.Global)i=c.g.GlobalPerConnector;else{var r;i=null!==(r=e.redirectMode)&&void 0!==r?r:null}return i}},{key:"constructOAuth2ConnectionParameterSets",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.connectionParameterSets=null,this.hasAccessCodeAndApplicationFlows(e)&&t.enableServicePrincipalSupport){t.connectionParameterSets=this.getDefaultConnectionParameterSets(),this.combineScopesFromSecurityDefinitionsAndUpdateSecurityTabDetails(e,t);var r=this.connectionFormService.convertFormItemsToParameterValues(t.authenticationFormItems);this.updateOAuth2DetailsFromForm(e,t,r,i)}}},{key:"populateInlineSwaggerEditorSecurityDefinitions",value:function(e,t,i){var{authenticationFormItems:r}=t,n=this.formItemValue(null==r?void 0:r.TokenUrl),a=this.formItemValue(null==r?void 0:r.AuthorizationUrl);Object(u.a)(t.selectedIdentityProviderId,o.a.AAD)&&({tokenUrl:n,authorizationUrl:a}=this.getAADTokenAndAuthUrls(t)),this.resetSwaggerSecurityProperties(i);var d=Object(s.d)(e,l.b.Oauth2);for(var p of Object.keys(d)){var{flow:h,scopes:m}=d[p];p=this.ensureSecurityDefinitionKeyCompliance(p);var g={type:l.b.Oauth2,flow:h,tokenUrl:n,scopes:m};switch(h){case c.d.Application:i.securityDefinitions[p]=g;break;case c.d.AccessCode:i.securityDefinitions[p]=C(C({},g),{},{authorizationUrl:a});break;default:continue}i.security.push({[p]:Object.keys(m||{})})}}},{key:"updateMultiAuthSupport",value:function(e,t,i){if(t.enableServicePrincipalSupport=i,i){if(!this.firstSecurityDefinitionByFlow(e,c.d.Application)){var r=C({},Object(s.g)(e,l.b.Oauth2));r.flow=c.d.Application,delete r.authorizationUrl;var n=this.getNewSecurityDefinitionName(e);e.securityDefinitions[n]=r;var[a]=Object(m.a)();if(a&&i&&Object(u.a)(t.selectedIdentityProviderId,o.a.AAD)){var d=p.a.ConnectionParameterSetName;e.securityDefinitions[d]=r}}}else this.hasAccessCodeAndApplicationFlows(e)&&this.removeAllApplicationFlowSecurityDefinitions(e)}},{key:"updateAadSecretOption",value:function(e,t,i){t&&(t.useManagedIdentity=i)}},{key:"enabled",get:function(){return!0}}]),e}(),D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(i,e);var t=b(i);function i(e,r){return P(this,i),t.call(this,e,r)}return A(i,[{key:"constructOAuth2ConnectionParameterSets",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.connectionParameterSets=null,this.hasAccessCodeAndApplicationFlows(e)&&t.enableServicePrincipalSupport){t.connectionParameterSets=this.getDefaultConnectionParameterSets(),this.combineScopesFromSecurityDefinitionsAndUpdateSecurityTabDetails(e,t);var r=Object(f.a)(t.cache.identityProviderParameters[t.selectedIdentityProviderId],t.oAuthFormItemValues);this.updateOAuth2DetailsFromForm(e,t,r,i)}}},{key:"updateOAuth2DetailsFromForm",value:function(e,t,i,r){t.connectionParameterSets=this.getDefaultConnectionParameterSets();var n=this.getSupportedSecurityDefinitions(e);1===t.selectedAuthenticationTypes.length&&this.resetSwaggerSecurityProperties(e);var o=Object.keys(n);for(var a of o){var s=n[a];a=this.ensureSecurityDefinitionKeyCompliance(a),this.updateSwaggerSecurityDefinitionFromParameterValues(e,a,s,t,i),this.updateSwaggerSecurityRequirement(e,a,t),this.addConnectionParameterSet(a,s,t,i,r)}}},{key:"populateInlineSwaggerEditorSecurityDefinitions",value:function(e,t,i){var{oAuthFormItemValues:r}=t,n=r.tokenurl,a=r.authorizationurl;Object(u.a)(t.selectedIdentityProviderId,o.a.AAD)&&({tokenUrl:n,authorizationUrl:a}=this.getAADTokenAndAuthUrls(t));var d=Object(s.d)(e,l.b.Oauth2);for(var p of Object.keys(d)){var{flow:h,scopes:m}=d[p];p=this.ensureSecurityDefinitionKeyCompliance(p);var g={type:l.b.Oauth2,flow:h,tokenUrl:n,scopes:m};switch(h){case c.d.Application:i.securityDefinitions[p]=g;break;case c.d.AccessCode:i.securityDefinitions[p]=C(C({},g),{},{authorizationUrl:a});break;default:continue}i.security.push({[p]:Object.keys(m||{})})}}}]),i}(O),E=function(){function e(t,i,r){P(this,e),this.connectionFormService=t,this.resources=i,this.widgetUtilService=r,this.noMultiAuthService=void 0,this.servicePrincipalMultiAuthService=void 0,this.ServicePrincipalMultiAuthServiceV2=void 0,this.isCustomConnectorMultiAuthEnabled=void 0;var[n]=Object(g.a)();this.isCustomConnectorMultiAuthEnabled=!this.widgetUtilService.isLogicApps()&&n}return A(e,[{key:"servicePrincipalMultiAuthServiceInstance",get:function(){return this.isCustomConnectorMultiAuthEnabled?(this.ServicePrincipalMultiAuthServiceV2||(this.ServicePrincipalMultiAuthServiceV2=new D(this.connectionFormService,this.resources)),this.ServicePrincipalMultiAuthServiceV2):(this.servicePrincipalMultiAuthService||(this.servicePrincipalMultiAuthService=new O(this.connectionFormService,this.resources)),this.servicePrincipalMultiAuthService)}},{key:"noMultiAuthServiceInstance",get:function(){return this.noMultiAuthService||(this.noMultiAuthService=new R),this.noMultiAuthService}},{key:"forIdentityProvider",value:function(e){switch(e){case o.a.AAD:if(Object(h.a)())return this.servicePrincipalMultiAuthServiceInstance;break;case o.a.GenericOAuth:if(Object(h.b)())return this.servicePrincipalMultiAuthServiceInstance}return this.noMultiAuthServiceInstance}}]),e}();E.$inject=[n.a.services.connectionForm,n.a.services.clientResources,n.a.services.widgetUtilService],r.a.service(n.a.services.multiAuthServiceSelector,E)},33932:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r={api_key:"api_key",username:"username",password:"password",token:"token"}},33933:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var r=i(11808);function n(){return!!Object(r.a)().customConnectorServicePrincipal.getConfig().enableServicePrincipalAlmForAAD}function o(){return!!Object(r.a)().customConnectorServicePrincipal.getConfig().enableServicePrincipalAlmForGenericOAuth}},33934:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.EcosystemsAndExperience,owners:["jianblu"],description:"ECS feature to enable features for Client Certificate support for CC Oauth2 AAD",ecsURL:"https://ecs.skype.com/PowerAutomate/EcosystemsAndExperience/configurations/1295117",createdOn:"07/24/2024",fallback:{enableClientCertificateSupportForCCOauth2AAD:!1}}),{getFeatureState:a}=Object(n.b)(o,"enableClientCertificateSupportForCCOauth2AAD")},33935:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(11809),n=i(11896),o=Object(n.a)({teamName:r.a.EcosystemsAndExperience,owners:["cheir"],description:"ESC feature to enable multi-auth for custom connectors",ecsURL:"https://ecs.skype.com/PowerAutomate/EcosystemsAndExperience/configurations/1455600",createdOn:"10/16/2024",fallback:{enableCustomConnectorMultiAuth:!1}}),{getFeatureState:a}=Object(n.b)(o,"enableCustomConnectorMultiAuth")},33936:function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"a",(function(){return d}));var r=i(33937),n="bool",o="int",a="number",s=["securestring","string",a,o,n,"options"];function l(e){var t={},i=[];return Object.keys(e||{}).forEach(n=>{var o=e[n];if(p(o.type)){var a,s,l=!Object(r.a)(o.type,"bool")&&(null===(a=o.uiDefinition)||void 0===a||null===(a=a.constraints)||void 0===a?void 0:a.required)===(!0).toString();t[n]={type:o.type,displayName:(null===(s=o.uiDefinition)||void 0===s?void 0:s.displayName)||n,required:l}}else i.push(o.type)}),t}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};return e.forEach(e=>{var i={type:e.Type,metadata:e.Metadata,uiDefinition:{displayName:e.DisplayName,description:e.Description,constraints:{required:(!e.Default).toString(),allowedValues:e.AllowedValues}}};t[e.Name]=i}),l(t)}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={};return Object.keys(t).forEach(e=>{i[e.toLowerCase()]=t[e]}),e.forEach(e=>{if(p(e.Type)){var t=e.Name.toLowerCase();!Object(r.a)(e.Type,"bool")||null!==i[t]&&void 0!==i[t]||(i[t]=!1),!i[t]&&e.Default&&(i[t]=e.Default)}}),i}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={};return Object.keys(t).forEach(s=>{var l=t[s],c=e.find(e=>Object(r.a)(e.Name,s));switch(null==c?void 0:c.Type.toLowerCase()){case n:l=Object(r.a)(l,"true");break;case o:case a:try{l=JSON.parse(l)}catch(u){}}"granttype"!==s.toLowerCase()&&c&&(i[c.Name]=l)}),i}function p(e){return s.some(t=>Object(r.a)(t,e))}},33937:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return s}));var r=i(33938),n=i(11892);i.d(t,"a",(function(){return n.a}));function o(e,t){if(!e||(e=>(e=>""===e)(e)||(e=>!!e&&/^\s*$/.test(e))(e))(e))return t(r.b.Validation.CannotBeEmpty)}function a(e,t){var i=(e||"").trim();if(!i.startsWith("https://")&&!i.startsWith("http://"))return t(r.b.Validation.InvalidUrl)}function s(e,t){var i=(e||"").trim();if(!/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/.test(i))return t(r.b.Validation.InvalidGuid)}},33938:function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return o}));var r="CustomConnectors",n={AuthenticationType:{Heading:"CustomConnectors:SecurityResources.AuthenticationType.Heading",Label:"CustomConnectors:SecurityResources.AuthenticationType.Label"},ApiKeyAuth:"CustomConnectors:SecurityResources.ApiKeyAuth",BasicAuth:"CustomConnectors:SecurityResources.BasicAuth",NoAuth:"CustomConnectors:SecurityResources.NoAuth",Oauth2Auth:"CustomConnectors:SecurityResources.Oauth2Auth",WindowsAuth:"CustomConnectors:SecurityResources.WindowsAuth",Parameter:{Key:"CustomConnectors:SecurityResources.Parameter.Key",Name:"CustomConnectors:SecurityResources.Parameter.Name",Location:"CustomConnectors:SecurityResources.Parameter.Location"},ApiKey:{Label:"CustomConnectors:SecurityResources.ApiKey.Label",Description:"CustomConnectors:SecurityResources.ApiKey.Description",Location:{Header:"CustomConnectors:SecurityResources.ApiKey.Location.Header",Query:"CustomConnectors:SecurityResources.ApiKey.Location.Query"}},OAuth2:{Label:"CustomConnectors:SecurityResources.OAuth2.Label",Description:"CustomConnectors:SecurityResources.OAuth2.Description",IdentityProvider:"CustomConnectors:SecurityResources.OAuth2.IdentityProvider",Scope:"CustomConnectors:SecurityResources.OAuth2.Scope",RedirectUrl:{Label:"CustomConnectors:SecurityResources.OAuth2.RedirectUrl.Label",PlaceHolder:"CustomConnectors:SecurityResources.OAuth2.RedirectUrl.PlaceHolder"},EnableServicePrincipal:"CustomConnectors:SecurityResources.OAuth2.EnableServicePrincipal",UniqueRedirectUrl:{Label:"CustomConnectors:SecurityResources.OAuth2.UniqueRedirectUrl.Label",LearnMore:"CustomConnectors:SecurityResources.OAuth2.UniqueRedirectUrl.LearnMore"},AADSecretOptions:{Label:"CustomConnectors:SecurityResources.OAuth2.AADSecretOptions.Label",UseClientSecret:"CustomConnectors:SecurityResources.OAuth2.AADSecretOptions.UseClientSecret",UseManagedIdentity:"CustomConnectors:SecurityResources.OAuth2.AADSecretOptions.UseManagedIdentity"},ManagedIdentity:{Label:"CustomConnectors:SecurityResources.OAuth2.ManagedIdentity.Label",PlaceHolder:"CustomConnectors:SecurityResources.OAuth2.ManagedIdentity.PlaceHolder",FICStringsFormat:"CustomConnectors:SecurityResources.OAuth2.ManagedIdentity.FICStringsFormat"}},Basic:{Label:"CustomConnectors:SecurityResources.Basic.Label",Description:"CustomConnectors:SecurityResources.Basic.Description",ParameterPassword:"CustomConnectors:SecurityResources.Basic.ParameterPassword",ParameterUsername:"CustomConnectors:SecurityResources.Basic.ParameterUsername",ParameterLabelFor:"CustomConnectors:SecurityResources.Basic.ParameterLabelFor",Warning:"CustomConnectors:SecurityResources.Basic.Warning"},Validation:{AuthenticationTypeRequired:"CustomConnectors:SecurityResources.Validation.AuthenticationTypeRequired",CannotBeEmpty:"CustomConnectors:SecurityResources.Validation.CannotBeEmpty",HeaderNotAllowed:"CustomConnectors:SecurityResources.Validation.HeaderNotAllowed",InvalidUrl:"CustomConnectors:SecurityResources.Validation.InvalidUrl",HeaderDoesNotMatchRegex:"CustomConnectors:SecurityResources.Validation.HeaderDoesNotMatchRegex",InvalidGuid:"CustomConnectors:SecurityResources.Validation.InvalidGuid"},LeftPane:{Description:"CustomConnectors:SecurityResources.LeftPane.Description",Heading:"CustomConnectors:SecurityResources.LeftPane.Heading",LearnMoreAriaLabel:"CustomConnectors:SecurityResources.LeftPane.LearnMoreAriaLabel"},Edit:"CustomConnectors:SecurityResources.Edit"},o={LearnMore:"CustomConnectors:CommonResources.LearnMore",Tabs:{Definition:"CustomConnectors:CommonResources.Tabs.Definition",Security:"CustomConnectors:CommonResources.Tabs.Security",General:"CustomConnectors:CommonResources.Tabs.General",Details:"CustomConnectors:CommonResources.Tabs.Details",Share:"CustomConnectors:CommonResources.Tabs.Share",Code:"CustomConnectors:CommonResources.Tabs.Code",Test:"CustomConnectors:CommonResources.Tabs.Test",Copilot:"CustomConnectors:CommonResources.Tabs.Copilot"}}},33939:function(e,t,i){"use strict";var r=i(33356),n=i(20342),o=i(33331),a=i(33327),s=i(33355),l=i(14868),c=i(33383),u=i(33353),d=i(33352),p=i(33357),h=i(14751),m=i.n(h),g=i(11891),f=i(12330),v=i(33846),b=i(33358),y=i(33373),w=i(14876),S=i(17266),C=i(13015),k=i(14883),P=i(14898),x=i(19793),A=i(13143),T=i(13083),R=i(33351),O=i(33813),D=i(33940),E=i(33932),F=i(33279),I=i(13003),j=i(13009),N=i(11890),M=i(13031),L=i(33503),U=i(33941),B=i(33822),$=i(13272),q=i(33847),W=i(33935),z=i(33936),H=i(33942);function V(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function _(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?V(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):V(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function G(e,t,i){return(t=X(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function K(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,X(r.key),r)}}function X(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Q=function(){function e(t,i,r,n,o,a,s,l,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$timeout=i,this.apisClient=r,this.assetService=n,this.clientResources=o,this.connectionFormService=a,this.customApiHelper=s,this.loggingService=l,this.widgetUtilService=c,this.multiAuthServiceSelector=u,this.swaggerEditorData=void 0,this.customApiTestData=void 0,this.hideAlertInProgress=void 0,this.autoHideNotificationInterval=3e3,this.maxPostFix=20,this.connectionParametersImported=void 0,this.defaultIconFile=void 0,this._isCustomConnectorMultiAuthEnabled=void 0,this.defaultIconFile=this.assetService.defaultSwaggerIcon;var[d]=Object(W.a)();this._isCustomConnectorMultiAuthEnabled=!this.widgetUtilService.isLogicApps()&&d,this.initializeData()}var t,i,o;return t=e,(i=[{key:"multiAuthService",get:function(){return this.multiAuthServiceSelector.forIdentityProvider(this.securityTabDetails.selectedIdentityProviderId)}},{key:"isCustomConnectorMultiAuthEnabled",get:function(){return this._isCustomConnectorMultiAuthEnabled}},{key:"SwaggerEditorData",get:function(){return this.swaggerEditorData}},{key:"swaggerEditorUIData",get:function(){return this.swaggerEditorData.uiDetails}},{key:"securityTabDetails",get:function(){return this.swaggerEditorData.securityTabDetails}},{key:"swagger",get:function(){return this.swaggerEditorData.swagger},set:function(e){this.SwaggerEditorData.swagger=e,this.initializeSecurityDetailsFromSwagger()}},{key:"inlineEditorSwagger",get:function(){return this.swaggerEditorData.inlineEditorSwagger},set:function(e){this.SwaggerEditorData.inlineEditorSwagger=e}},{key:"connectionParametersAreImported",get:function(){return this.connectionParametersImported},set:function(e){this.securityTabDetails.isLocked=this.securityTabDetails.isLocked||e,this.connectionParametersImported=e}},{key:"hasSwaggerBeenModified",get:function(){return!F.equals(this.swagger,this.swaggerEditorData.deployedSwagger)}},{key:"isDeployedApiSameAsLocalApi",get:function(){return this.widgetUtilService.isLogicApps()?this.swaggerEditorData.apiLogicApps&&Object(g.a)(this.swaggerEditorData.apiName,this.swaggerEditorData.apiLogicApps.name):this.swaggerEditorData.api&&Object(g.a)(this.swaggerEditorData.apiName,this.swaggerEditorData.api.name)}},{key:"hasSecurityDefinitionBeenModified",get:function(){return!this.swaggerEditorData.deployedSwagger||!this.swagger||!F.equals(this.swagger.securityDefinitions,this.swaggerEditorData.deployedSwagger.securityDefinitions)}},{key:"CustomApiTestData",get:function(){return this.customApiTestData}},{key:"loggableSwaggerEditorData",get:function(){var e;return{apiId:this.swaggerEditorData.apiId||null,editMode:this.swaggerEditorData.editMode,importFormat:this.swaggerEditorData.importFormat||null,isInlineSwaggerEditor:this.swaggerEditorData.isInlineSwaggerEditor,isOnPremiseDataGateway:this.swaggerEditorData.isOnPremiseDataGateway,selectedAuthenticationType:this.swaggerEditorData.securityTabDetails&&this.swaggerEditorData.securityTabDetails.selectedAuthenticationType||null,selectedIdentityProviderId:this.swaggerEditorData.securityTabDetails&&this.swaggerEditorData.securityTabDetails.selectedIdentityProviderId||null,redirectMode:null===(e=this.swaggerEditorData.securityTabDetails)||void 0===e?void 0:e.redirectMode}}},{key:"multiAuthSupported",get:function(){return this.multiAuthService.enabled}},{key:"initializeSecurityDetailsFromSwagger",value:function(){this.securityTabDetails.selectedIdentityProviderId=void 0,this.securityTabDetails.connectionParameters=void 0,this.isCustomConnectorMultiAuthEnabled?(this.updateConnectionParametersFromSwaggerV2(),this.updateAuthenticationTypeV2(),this.setUpAuthenticationTypes()):(this.updateConnectionParametersFromSwagger(),this.updateAuthenticationType(),this.onAuthenticationTypeChanged(),this.multiAuthService.initializeConnectionParameterSetsFromSwagger(this.swagger,this.securityTabDetails))}},{key:"updateConnectionParametersFromSwagger",value:function(){var e={},t=this.securityTabDetails.connectionParameters||{},i=Object(p.i)(this.swagger);this.setupConnectionParameters(i,e,t),this.securityTabDetails.connectionParameters=e}},{key:"updateConnectionParametersFromSwaggerV2",value:function(){var e={};if(this.getAuthTypesWithoutDupes().length>1)this.setupConnectionParameterSets();else{var t=this.securityTabDetails.connectionParameters||{},i=Object(p.i)(this.swagger);this.setupConnectionParameters(i,e,t)}this.securityTabDetails.connectionParameters=e}},{key:"setupConnectionParameterSets",value:function(){var e=this.securityTabDetails.connectionParameterSets||{values:[]},t=Object.keys(this.swagger.securityDefinitions);for(var i of t){var r=this.swagger.securityDefinitions[i].type,n={};if(this.connectionParameterSets(r));else{this.setupConnectionParameters(r,n,{});var o={name:i,parameters:n};e.values.push(o)}}this.securityTabDetails.connectionParameterSets=e}},{key:"setupConnectionParameters",value:function(e,t,i){switch(e){case l.b.None:break;case l.b.Basic:t[E.a.username]=i[E.a.username]||{type:"string",uiDefinition:{displayName:this.clientResources.Manage.CustomApi.Security.Basic.username,placeholder:this.clientResources.Manage.CustomApi.Security.Basic.UsernameLabelPlaceholder}},t[E.a.password]=i[E.a.password]||{type:"securestring",uiDefinition:{displayName:this.clientResources.Manage.CustomApi.Security.Basic.password,placeholder:this.clientResources.Manage.CustomApi.Security.Basic.PasswordLabelPlaceholder}};break;case l.b.ApiKey:t[E.a.api_key]=i[E.a.api_key]||{type:"securestring",uiDefinition:{displayName:this.clientResources.Manage.CustomApi.Security.apiKey}};break;case l.b.Oauth2:if(i[E.a.token])t[E.a.token]=i[E.a.token];else{var r=this.isCustomConnectorMultiAuthEnabled?Object(p.e)(this.swagger,l.b.Oauth2):Object.keys(this.swagger.securityDefinitions)[0];if(!r){this.loggingService.logWarning("CustomApi.setupConnectionParameters.noOAuthKey",void 0);break}var n=this.swagger.securityDefinitions[r],o={type:"oauthSetting",oAuthSettings:{customParameters:{}}};o.oAuthSettings.customParameters.authorizationUrl={value:n.authorizationUrl},o.oAuthSettings.customParameters.tokenUrl={value:n.tokenUrl},o.oAuthSettings.scopes=Object(f.a)(n.scopes)?[]:Object.keys(n.scopes).map(e=>e),t[E.a.token]=o}}}},{key:"updateAuthenticationType",value:function(){var e=this.widgetUtilService.isLogicApps()?this.swaggerEditorData.apiLogicApps:this.swaggerEditorData.api;this.securityTabDetails.selectedAuthenticationType=Object(v.d)(e)||Object(p.i)(this.swagger),Object(v.f)(this.securityTabDetails.selectedAuthenticationType)||(this.loggingService.logWarning("CustomApi.isValidAuthenticationType",this.clientResources.Manage.CustomApi.Security.invalidAuthType),this.securityTabDetails.selectedAuthenticationType=l.b.None)}},{key:"getAuthTypesWithoutDupes",value:function(){var e=Object(p.j)(this.swagger),t=Object(p.d)(this.swagger,l.b.Oauth2);return Object.keys(t||{}).length>1&&(e=e.reduce((e,t)=>(e.includes(t)||e.push(t),e),[])),e}},{key:"updateAuthenticationTypeV2",value:function(){var e=this.widgetUtilService.isLogicApps()?this.swaggerEditorData.apiLogicApps:this.swaggerEditorData.api;if(Object(p.y)(this.swagger))this.securityTabDetails.selectedAuthenticationTypes=this.restrictedAuthTypes(this.getAuthTypesWithoutDupes());else{var t=Object(v.d)(e)||Object(p.i)(this.swagger);this.securityTabDetails.selectedAuthenticationTypes=[t]}Object(v.g)(this.securityTabDetails.selectedAuthenticationTypes)||(this.loggingService.logWarning("CustomApi.isValidAuthenticationType",this.clientResources.Manage.CustomApi.Security.invalidAuthType),this.securityTabDetails.selectedAuthenticationTypes=[l.b.None])}},{key:"updateUISwaggerFromInlineSwagger",value:function(){this.swaggerEditorData.swagger=m()(Object(b.a)(this.swaggerEditorData.inlineEditorSwagger)),this.isCustomConnectorMultiAuthEnabled?this.convertSwaggerToUISecurityV2():this.convertSwaggerToUISecurity()}},{key:"updateInlineSwaggerFromUISwagger",value:function(){this.swaggerEditorData.inlineEditorSwagger=JSON.parse(Object(y.a)(this.swaggerEditorData.swagger)),this.isCustomConnectorMultiAuthEnabled?this.convertUISecurityTabToSwaggerV2():this.convertUISecurityTabToSwagger()}},{key:"convertUISecurityTabToSwaggerV2",value:function(){for(var e of(this.SwaggerEditorData.inlineEditorSwagger.securityDefinitions={},this.SwaggerEditorData.inlineEditorSwagger.security=[],this.securityTabDetails.selectedAuthenticationTypes)){var t=void 0,i=[],r=!0;switch(e){case l.b.Basic:t=this.securityTabDetails.basicLabel;break;case l.b.Oauth2:this.securityTabDetails.selectedIdentityProviderId===l.b.Oauth2&&(this.securityTabDetails.authorizationUrl=this.securityTabDetails.oAuthFormItemValues.authorizationurl,this.securityTabDetails.tokenUrl=this.securityTabDetails.oAuthFormItemValues.tokenurl),this.convertOAuthScopes(),t=this.swaggerEditorData.securityTabDetails.oAuthLabel,i=this.securityTabDetails.scopes,this.multiAuthService.populateInlineSwaggerEditorSecurityDefinitions(this.swagger,this.securityTabDetails,this.swaggerEditorData.inlineEditorSwagger),this.multiAuthService.enabled&&(r=!1);break;case l.b.ApiKey:t=this.securityTabDetails.apiKeySecurityLabel;break;case l.b.None:case l.b.Windows:}var n=r&&this.generateSecurityDefinition(e,!0);n&&(this.SwaggerEditorData.inlineEditorSwagger.securityDefinitions=_(_({},this.SwaggerEditorData.inlineEditorSwagger.securityDefinitions),n),this.SwaggerEditorData.inlineEditorSwagger.security=[...this.SwaggerEditorData.inlineEditorSwagger.security,{[t]:i}])}}},{key:"convertUISecurityTabToSwagger",value:function(){switch(this.swaggerEditorData.securityTabDetails.selectedAuthenticationType){case l.b.None:break;case l.b.Basic:this.populateSecurityDefinitionBasic();break;case l.b.Oauth2:this.populateSecurityDefinitionOauth2(),this.multiAuthService.populateInlineSwaggerEditorSecurityDefinitions(this.swagger,this.securityTabDetails,this.swaggerEditorData.inlineEditorSwagger);break;case l.b.ApiKey:this.populateSecurityDefinitionApiKey();break;case l.b.Windows:}}},{key:"populateSecurityDefinitionApiKey",value:function(){this.swaggerEditorData.inlineEditorSwagger.securityDefinitions=this.generateSecurityDefinition(l.b.ApiKey,!0),this.SwaggerEditorData.inlineEditorSwagger.security=[{[this.swaggerEditorData.securityTabDetails.apiKeySecurityLabel]:[]}]}},{key:"populateSecurityDefinitionOauth2",value:function(){this.securityTabDetails.oAuthLabel||(this.securityTabDetails.oAuthLabel="oauth2-auth"),this.securityTabDetails.selectedIdentityProviderId===l.b.Oauth2&&(this.securityTabDetails.authorizationUrl=this.securityTabDetails.authenticationFormItems.AuthorizationUrl.value?this.securityTabDetails.authenticationFormItems.AuthorizationUrl.value.toString():void 0,this.securityTabDetails.tokenUrl=this.securityTabDetails.authenticationFormItems.TokenUrl.value?this.securityTabDetails.authenticationFormItems.TokenUrl.value.toString():void 0),this.convertOAuthScopes(),this.swaggerEditorData.inlineEditorSwagger.securityDefinitions=this.generateSecurityDefinition(l.b.Oauth2,!0),this.SwaggerEditorData.inlineEditorSwagger.security=[{[this.swaggerEditorData.securityTabDetails.oAuthLabel]:this.securityTabDetails.scopes}]}},{key:"populateSecurityDefinitionBasic",value:function(){this.securityTabDetails.basicLabel||(this.securityTabDetails.basicLabel="basic-auth"),this.swaggerEditorData.inlineEditorSwagger.securityDefinitions=this.generateSecurityDefinition(l.b.Basic),this.SwaggerEditorData.inlineEditorSwagger.security=[{[this.swaggerEditorData.securityTabDetails.basicLabel]:[]}]}},{key:"restrictedAuthTypes",value:function(e){var t=e.slice(0,H.c);return(null==t?void 0:t.length)!==H.c||H.b.some(e=>e.includes(t[0])&&e.includes(t[1]))?t:[l.b.None]}},{key:"convertSwaggerToUISecurityV2",value:function(){var e=Object.keys(this.swagger.securityDefinitions||{});if(0!==e.length){var t=this.getAuthTypesWithoutDupes();for(var i of e)switch(this.swagger.securityDefinitions[i].type){case l.b.Basic:this.securityTabDetails.basicLabel=i;break;case l.b.Oauth2:var r=Object(p.d)(this.swagger,l.b.Oauth2);if(r.oAuthClientCredentials&&!r["oauth2-auth"]){this.onAuthenticationTypesChangedV2([l.b.None]);break}this.securityTabDetails.oAuthLabel=i;break;case l.b.ApiKey:this.securityTabDetails.apiKeySecurityLabel=i;break;case l.b.Windows:}var n=this.restrictedAuthTypes(t);this.onAuthenticationTypesChangedV2(n)}else this.onAuthenticationTypesChangedV2([l.b.None])}},{key:"convertSwaggerToUISecurity",value:function(){var e=Object.keys(this.swagger.securityDefinitions||{})[0];switch(this.securityTabDetails.selectedAuthenticationType=e?this.swagger.securityDefinitions[e].type:l.b.None,this.securityTabDetails.selectedAuthenticationType){case l.b.None:this.showNoAuthenticationForm();break;case l.b.Basic:this.populateBasicAuthenticationForm(),this.securityTabDetails.basicLabel=e;break;case l.b.Oauth2:var t=Object(p.d)(this.swagger,l.b.Oauth2);if(t.oAuthClientCredentials&&!t["oauth2-auth"]){this.securityTabDetails.selectedAuthenticationType=l.b.None,this.showNoAuthenticationForm(),this.swagger.security=[];break}this.initializeSecurityDetailsFromSwagger(),this.securityTabDetails.oAuthLabel=e;break;case l.b.ApiKey:this.securityTabDetails.apiKeyName="",this.populateApiKeyForm(),this.securityTabDetails.apiKeyLabel=e;break;case l.b.Windows:this.populateWindowsAuthenticationForm()}}},{key:"onAuthenticationTypeChanged",value:function(){switch(this.securityTabDetails.selectedAuthenticationType){case l.b.None:this.showNoAuthenticationForm();break;case l.b.Basic:this.populateBasicAuthenticationForm();break;case l.b.Oauth2:this.populateOAuthForm();break;case l.b.ApiKey:this.populateApiKeyForm();break;case l.b.Windows:this.populateWindowsAuthenticationForm()}}},{key:"setUpAuthenticationTypes",value:function(){0===this.securityTabDetails.selectedAuthenticationTypes.length&&this.setUpNoAuthenticationTypes(),this.addSecurityDefinitions(this.securityTabDetails.selectedAuthenticationTypes,!0)}},{key:"setUpNoAuthenticationTypes",value:function(){this.swagger.securityDefinitions={},this.securityTabDetails.authenticationFormItems={},this.securityTabDetails.selectedIdentityProviderId=void 0,this.securityTabDetails.selectedAuthenticationTypes=[]}},{key:"onAuthenticationTypesChangedV2",value:function(e){if(0!==e.length){var t=this.securityTabDetails.selectedAuthenticationTypes.filter(t=>!e.includes(t)),i=e.filter(e=>!this.securityTabDetails.selectedAuthenticationTypes.includes(e));t.length>0&&this.removeSecurityDefinitions(t),i.length>0&&this.addSecurityDefinitions(i),this.securityTabDetails.selectedAuthenticationTypes=e}else this.setUpNoAuthenticationTypes()}},{key:"addSecurityDefinitions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var i of e){var r=this.generateSecurityDefinition(i);r&&!Object(p.g)(this.swagger,i)&&(this.swagger.securityDefinitions=_(_({},this.swagger.securityDefinitions),r)),this.populateAuthenticationFormItems(i,t)}}},{key:"populateAuthenticationFormItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.connectionParameters(),r=!1;switch(t&&this.securityTabDetails.selectedAuthenticationTypes.length>1&&(i=this.connectionParameterSets(e),r=!0),e){case l.b.Basic:var n=this.populateBasicAuthValuesFromConnectionParameters(i);this.securityTabDetails.basicAuthFormItems={usernameLabel:n.username,passwordLabel:n.password};break;case l.b.Oauth2:this.convertSwaggerToOAuthSecurityDetails(),this.setIdentityProvider(r);break;case l.b.ApiKey:this.setupApiKeyForm(r);break;case l.b.Windows:}}},{key:"removeSecurityDefinitions",value:function(e){for(var t of e){var i=Object(p.e)(this.swagger,t);switch(i&&delete this.swagger.securityDefinitions[i],t){case l.b.Basic:this.securityTabDetails.basicAuthFormItems=void 0;break;default:case l.b.Oauth2:}}}},{key:"showNoAuthenticationForm",value:function(){this.swagger.securityDefinitions={},this.securityTabDetails.authenticationFormItems={},this.securityTabDetails.selectedIdentityProviderId=void 0}},{key:"basicAuthParameters",value:function(){return[{Name:E.a.username,Type:"string",DisplayName:this.clientResources.Manage.CustomApi.Security.Basic.username},{Name:E.a.password,Type:"string",DisplayName:this.clientResources.Manage.CustomApi.Security.Basic.password}]}},{key:"connectionParameters",value:function(){var e,t,i=this.widgetUtilService.isLogicApps()?null===(e=this.swaggerEditorData.apiLogicApps)||void 0===e||null===(e=e.properties)||void 0===e?void 0:e.connectionParameters:null===(t=this.swaggerEditorData.api)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.connectionParameters;return null!=i?i:this.securityTabDetails.connectionParameters}},{key:"connectionParameterSets",value:function(e){var t,i,r=e;e===l.b.Oauth2&&(r="".concat(e,"-").concat(this.securityTabDetails.selectedIdentityProviderId));var n=null===(t=this.swaggerEditorData.api)||void 0===t||null===(t=t.properties)||void 0===t||null===(t=t.connectionParameterSets)||void 0===t||null===(t=t.values.find(e=>e.name===r))||void 0===t?void 0:t.parameters;return null!=n?n:null===(i=this.securityTabDetails.connectionParameterSets)||void 0===i||null===(i=i.values.find(e=>e.name===r))||void 0===i?void 0:i.parameters}},{key:"populateBasicAuthenticationForm",value:function(){Object(p.g)(this.swagger,l.b.Basic)||(this.swagger.securityDefinitions=this.generateSecurityDefinition(l.b.Basic)),this.securityTabDetails.authenticationFormItems=this.connectionFormService.createFormItemsFromProviderParameters(L.a.Create,this.basicAuthParameters(),this.getBasicAuthValues(this.connectionParameters())),this.securityTabDetails.selectedIdentityProviderId=void 0}},{key:"generateSecurityDefinition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case l.b.Basic:return this.securityTabDetails.basicLabel||(this.securityTabDetails.basicLabel="basic-auth"),{[this.securityTabDetails.basicLabel]:{type:l.b.Basic}};case l.b.Oauth2:return this.securityTabDetails.oAuthLabel||(this.securityTabDetails.oAuthLabel="oauth2-auth"),t?{[this.swaggerEditorData.securityTabDetails.oAuthLabel]:{type:l.b.Oauth2,flow:"accessCode",authorizationUrl:this.securityTabDetails.authorizationUrl||"",tokenUrl:this.securityTabDetails.tokenUrl||"https://login.windows.net/common/oauth2/authorize",scopes:Object(v.b)(this.securityTabDetails.scopes)}}:{[this.swaggerEditorData.securityTabDetails.oAuthLabel]:{type:l.b.Oauth2,flow:"accessCode",authorizationUrl:"",tokenUrl:"https://login.windows.net/common/oauth2/authorize"}};case l.b.ApiKey:if(this.securityTabDetails.apiKeySecurityLabel||(this.securityTabDetails.apiKeySecurityLabel=E.a.api_key),t)return{[this.securityTabDetails.apiKeySecurityLabel]:{type:l.b.ApiKey,in:this.swaggerEditorData.securityTabDetails.selectedApiKeyLocation||"header",name:this.swaggerEditorData.securityTabDetails.apiKeyName||""}};var i=this.isCustomConnectorMultiAuthEnabled&&this.swaggerEditorData.securityTabDetails.apiKeyName||"";return{[this.securityTabDetails.apiKeySecurityLabel]:{type:l.b.ApiKey,in:"header",name:i}};case l.b.None:case l.b.Windows:default:return null}}},{key:"getBasicAuthValues",value:function(e){var t={};if(!Object(w.a)(e))return this.populateBasicAuthValuesFromConnectionParameters(e);var i=this.securityTabDetails.authenticationFormItems;return i&&!Object(w.a)(i[E.a.username])&&(t[E.a.username]=i[E.a.username].value),i&&!Object(w.a)(i[E.a.password])&&(t[E.a.password]=i[E.a.password].value),t}},{key:"populateBasicAuthValuesFromConnectionParameters",value:function(e){var t={};return Object(w.a)(e)||(Object(w.a)(e[E.a.username])||(t[E.a.username]=e[E.a.username].uiDefinition.displayName),Object(w.a)(e[E.a.password])||(t[E.a.password]=e[E.a.password].uiDefinition.displayName)),t}},{key:"populateOAuthForm",value:function(){Object(p.g)(this.swagger,l.b.Oauth2)||(this.swagger.securityDefinitions=this.generateSecurityDefinition(l.b.Oauth2)),this.convertSwaggerToOAuthSecurityDetails(),this.setIdentityProvider()}},{key:"convertSwaggerToOAuthSecurityDetails",value:function(){var e=this.isCustomConnectorMultiAuthEnabled?Object(p.g)(this.swagger,l.b.Oauth2):Object(p.h)(this.swagger,l.b.Oauth2);e&&(this.securityTabDetails.authorizationUrl=e.authorizationUrl||this.securityTabDetails.authorizationUrl,this.securityTabDetails.tokenUrl=e.tokenUrl||this.securityTabDetails.tokenUrl,e.scopes instanceof Object?this.securityTabDetails.scopes=Object.keys(e.scopes):Array.isArray(e.scopes)&&(this.securityTabDetails.scopes=e.scopes)),this.securityTabDetails.scopeInput=this.securityTabDetails.scopes&&this.securityTabDetails.scopes.length>0?this.securityTabDetails.scopes.join(", "):""}},{key:"setIdentityProvider",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isCustomConnectorMultiAuthEnabled?this.securityTabDetails.showSpinner=!0:this.swaggerEditorData.spinner.show=!0;var t=this.loggingService.profileStart(s.a.myCustomApiSetIdentityProviderStart),i=Object(w.a)(this.securityTabDetails.cache.identityProviders),r=this.securityTabDetails.authorizationUrl&&Object(I.a)(this.securityTabDetails.authorizationUrl).host;return(i?this.updateCachedIdentityProviders():this.$q.resolve()).then(()=>this.securityTabDetails.selectedIdentityProviderId?Object(U.b)(this.securityTabDetails.cache.identityProviders,this.securityTabDetails.selectedIdentityProviderId):Object(U.a)(this.securityTabDetails.cache.identityProviders,r)).then(e=>{if(e)Object(g.a)(this.securityTabDetails.selectedIdentityProviderId,e.Id)||(this.securityTabDetails.selectedIdentityProviderId=e.Id),Object(g.a)(e.Id,l.b.Oauth2)||(this.securityTabDetails.authorizationUrl=e.AuthorizationEndPoints[0]);else{var t=new S.a(A.b.customApiNoMatchingIdentityProvider,"matchingIdentityProvider is undefined",{identityProviderKeys:Object.keys(this.securityTabDetails.cache.identityProviderParameters||{}),useExistingCache:!i,selectedIdentityProviderId:this.securityTabDetails.selectedIdentityProviderId,hostUri:r});this.loggingService.logError("SwaggerEditorDataService.setIdentityProvider",t)}}).then(()=>this.securityTabDetails.cache.identityProviderParameters[this.securityTabDetails.selectedIdentityProviderId]?this.$q.resolve():this.updateCachedIdentityProviderParameters(this.securityTabDetails.selectedIdentityProviderId)).then(()=>{var i;this.securityTabDetails.cache.identityProviderParameters[this.securityTabDetails.selectedIdentityProviderId]||this.loggingService.logError("SwaggerEditorDataService.setIdentityProvider.NoIdentityProviderParameters",void 0,{identityProviderKeys:Object.keys(this.securityTabDetails.cache.identityProviderParameters||{}),selectedIdentityProviderId:this.securityTabDetails.selectedIdentityProviderId});var r,n,o,a=e&&this.isCustomConnectorMultiAuthEnabled?this.connectionParameterSets(l.b.Oauth2):this.connectionParameters();null!=a&&null!==(i=a.token)&&void 0!==i&&null!==(i=i.oAuthSettings)&&void 0!==i&&null!==(i=i.properties)&&void 0!==i&&i.FederatedIdentityCredentials&&(this.securityTabDetails.federatedIdentityCredentials={issuer:null==a||null===(r=a.token)||void 0===r||null===(r=r.oAuthSettings)||void 0===r||null===(r=r.properties)||void 0===r||null===(r=r.FederatedIdentityCredentials)||void 0===r?void 0:r.Issuer,audience:null==a||null===(n=a.token)||void 0===n||null===(n=n.oAuthSettings)||void 0===n||null===(n=n.properties)||void 0===n||null===(n=n.FederatedIdentityCredentials)||void 0===n?void 0:n.Audience,subject:null==a||null===(o=a.token)||void 0===o||null===(o=o.oAuthSettings)||void 0===o||null===(o=o.properties)||void 0===o||null===(o=o.FederatedIdentityCredentials)||void 0===o?void 0:o.Subject});var c=_(_({},this.getOAuthParamValues(a)),this.multiAuthService.getOAuthParamValues(this.securityTabDetails)),u=this.securityTabDetails.cache.identityProviderParameters[this.securityTabDetails.selectedIdentityProviderId];return this.isCustomConnectorMultiAuthEnabled?this.securityTabDetails.oAuthFormItemValues=Object(z.c)(u,c):this.securityTabDetails.authenticationFormItems=this.connectionFormService.createFormItemsFromProviderParameters(L.a.Create,u,c),this.loggingService.profileEndWithSuccess(t,s.a.myCustomApiSetIdentityProviderEnd),this.$q.resolve()}).then(()=>this.multiAuthService.updateMultiAuthAvailabilityFromSwagger(this.swagger,this.securityTabDetails)).catch(e=>{this.swaggerEditorData.statusAlert.options.show(u.a.Error,Object(C.o)(e)),this.loggingService.profileEnd(t,s.a.myCustomApiSetIdentityProviderEnd,Object(j.y)(e),e)}).finally(()=>{this.isCustomConnectorMultiAuthEnabled?this.securityTabDetails.showSpinner=!1:this.swaggerEditorData.spinner.show=!1})}},{key:"updateCachedIdentityProviders",value:function(){var e=this.loggingService.profileStart(s.a.myCustomApiGetIdentityProvidersStart);return this.customApiHelper.getIdentityProviders().then(t=>{this.loggingService.profileEndWithSuccess(e,s.a.myCustomApiGetIdentityProvidersEnd),this.securityTabDetails.cache.identityProviders=t.filter(e=>Object(g.a)(e.AuthenticationType,l.b.Oauth2)&&(!Object(w.a)(e.AuthorizationEndPoints)||Object(g.a)(e.Id,l.b.Oauth2))).sort((e,t)=>e.DisplayName>t.DisplayName?1:-1)}).catch(t=>{this.swaggerEditorData.statusAlert.options.show(u.a.Error,this.clientResources.Manage.CustomApi.Security.LoadProviders.Error),this.loggingService.profileEnd(e,s.a.myCustomApiGetIdentityProvidersEnd,Object(j.y)(t),t),this.$q.reject(t)})}},{key:"updateCachedIdentityProviderParameters",value:function(e){var t=this.loggingService.profileStart(s.a.myCustomApiGetIdentityProviderParametersStart);return this.customApiHelper.getIdentityProviderParameters(e).then(i=>{this.loggingService.profileEndWithSuccess(t,s.a.myCustomApiGetIdentityProviderParametersEnd),this.securityTabDetails.cache.identityProviderParameters[e]=i}).catch(e=>{this.swaggerEditorData.statusAlert.options.show(u.a.Error,this.clientResources.Manage.CustomApi.Security.LoadProviderParameters.Error),this.loggingService.profileEnd(t,s.a.myCustomApiGetIdentityProviderParametersEnd,Object(j.y)(e),e),this.$q.reject(e)})}},{key:"getOAuthParamValues",value:function(e){if(!e)return{};var t={},i=e.token;return!e||Object(w.a)(i)||Object(w.a)(i.oAuthSettings)||(t.clientId=i.oAuthSettings.clientId,i.oAuthSettings.customParameters&&Object.keys(i.oAuthSettings.customParameters).forEach(e=>{t[e]=i.oAuthSettings.customParameters[e].value})),t}},{key:"populateApiKeyForm",value:function(){Object(p.g)(this.swagger,l.b.ApiKey)||(this.swagger.securityDefinitions=this.generateSecurityDefinition(l.b.ApiKey)),this.setupApiKeyForm(),this.securityTabDetails.authenticationFormItems={},this.securityTabDetails.selectedIdentityProviderId=null}},{key:"setupApiKeyForm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.isCustomConnectorMultiAuthEnabled?Object(p.g)(this.swagger,l.b.ApiKey):Object(p.h)(this.swagger,l.b.ApiKey);t&&(this.securityTabDetails.selectedApiKeyLocation=t.in,this.securityTabDetails.apiKeyName=t.name);var i=e&&this.isCustomConnectorMultiAuthEnabled?this.connectionParameterSets(l.b.ApiKey):this.connectionParameters();if(!Object(w.a)(i)){var r,n,o=i[E.a.api_key];this.securityTabDetails.apiKeyLabel=null!==(r=null==o||null===(n=o.uiDefinition)||void 0===n?void 0:n.displayName)&&void 0!==r?r:""}}},{key:"populateWindowsAuthenticationForm",value:function(){this.swagger.securityDefinitions={},this.securityTabDetails.authenticationFormItems={},this.securityTabDetails.selectedIdentityProviderId=null}},{key:"onIdentityProviderChanged",value:function(){this.securityTabDetails.selectedIdentityProviderId&&this.setIdentityProvider()}},{key:"getSwaggerScheme",value:function(){return this.swagger&&Array.isArray(this.swagger.schemes)&&-1!==this.swagger.schemes.indexOf(n.a.http)&&-1===this.swagger.schemes.indexOf(n.a.https)?n.a.http:n.a.https}},{key:"isDeployedSwaggerAction",value:function(e){return this.swaggerEditorData.deployedSwagger.actions.some(t=>this.areSameOperationItem(t,e))}},{key:"isDeployedSwaggerTrigger",value:function(e){return this.swaggerEditorData.deployedSwagger.triggers.some(t=>this.areSameOperationItem(t,e))}},{key:"areSameOperationItem",value:function(e,t){return e&&t&&e.path&&t.path&&e.method&&t.method&&e.operation&&t.operation&&Object(k.e)(e.path,t.path,!0)&&Object(k.e)(e.method,t.method,!1)&&Object(k.e)(e.operation.operationId,t.operation.operationId,!0)}},{key:"clear",value:function(){this.initializeData(!1)}},{key:"updateDisplayName",value:function(){this.swaggerEditorData.displayName=this.swaggerEditorData.swagger&&this.swaggerEditorData.swagger.info&&!Object(f.a)(this.swaggerEditorData.swagger.info.title)?Object(P.a)(this.swaggerEditorData.swagger.info.title.substring(0,B.b),!0).replace(/-+/g," "):Object(P.a)(this.swaggerEditorData.swaggerFileName.substring(0,B.b),!0)}},{key:"setUniqueDisplayName",value:function(e){for(var t=this.swaggerEditorData.displayName,i=!e.some(e=>Object(k.e)(e.properties.displayName,t)),r="",n=1;!i&&n<this.maxPostFix;n++)r=" - ".concat(n),t="".concat(this.swaggerEditorData.displayName.slice(0,B.b-r.length)).concat(r),i=!e.some(e=>Object(k.e)(e.properties.displayName,t));this.swaggerEditorData.displayName=t}},{key:"setIconDisplay",value:function(){this.swaggerEditorData.swaggerIconDisplay={"background-image":'url("'.concat(this.swaggerEditorData.swaggerIconFileContentUrl,'")'),"background-color":this.swaggerEditorData.swaggerIconBrandColor}}},{key:"setIconDisplayNotFound",value:function(){this.swaggerEditorData.swaggerIconDisplay={"background-image":'url("'.concat($.a.Warning,'")'),"background-size":"16px","background-position":"center","background-color":this.swaggerEditorData.swaggerIconBrandColor}}},{key:"convertOAuthScopes",value:function(){this.securityTabDetails.scopes=(this.securityTabDetails.scopeInput||"").split(",").filter(e=>e).map(e=>e.trim())}},{key:"convertOAuthSecurityDetailsToSwagger",value:function(e){this.convertOAuthScopes();var t=this.isCustomConnectorMultiAuthEnabled?Object(p.e)(this.swagger,l.b.Oauth2):Object(p.f)(this.swagger,l.b.Oauth2);if(t)if(this.SwaggerEditorData.swagger.securityDefinitions[t].scopes=Object(v.b)(this.securityTabDetails.scopes),Object(g.a)(this.securityTabDetails.selectedIdentityProviderId,q.a.GenericOAuth)?(this.SwaggerEditorData.swagger.securityDefinitions[t].authorizationUrl=e.AuthorizationUrl,this.SwaggerEditorData.swagger.securityDefinitions[t].tokenUrl=e.TokenUrl):this.SwaggerEditorData.swagger.securityDefinitions[t].authorizationUrl=this.securityTabDetails.authorizationUrl,this.SwaggerEditorData.swagger.security&&this.SwaggerEditorData.swagger.security.hasOwnProperty(t))this.SwaggerEditorData.swagger.security[t]=this.securityTabDetails.scopes;else{var i={};i[t]=this.securityTabDetails.scopes,this.SwaggerEditorData.swagger.security=[i]}}},{key:"convertApiKeySecurityDetailsToSwagger",value:function(){if(this.SwaggerEditorData.swagger.securityDefinitions&&Object.keys(this.SwaggerEditorData.swagger.securityDefinitions).length>0){var e=this.isCustomConnectorMultiAuthEnabled?Object(p.e)(this.SwaggerEditorData.swagger,l.b.ApiKey):Object.keys(this.SwaggerEditorData.swagger.securityDefinitions)[0],t=this.SwaggerEditorData.swagger.securityDefinitions[e];t&&(t.in=this.securityTabDetails.selectedApiKeyLocation,t.name=this.securityTabDetails.apiKeyName)}}},{key:"validateFormDetailsLogicApps",value:function(e){return this.SwaggerEditorData.validationError=this.validateGeneralTabDetails(),this.SwaggerEditorData.validationError?this.$q.reject(this.SwaggerEditorData.validationError):this.$q.resolve()}},{key:"validateFormDetails",value:function(e){if(this.swaggerEditorData.validationError=this.validateGeneralTabDetails(),this.swaggerEditorData.validationError)return this.$q.reject(this.SwaggerEditorData.validationError);if(this.swaggerEditorData.editMode)return this.$q.resolve();var t=this.apisClient.query(e);return t.$refresh().then(()=>(this.setUniqueDisplayName(t),this.swaggerEditorData.validationError=Object(O.a)(this.swaggerEditorData.displayName,this.clientResources),this.SwaggerEditorData.validationError?this.$q.reject(this.SwaggerEditorData.validationError):this.$q.resolve()))}},{key:"validateGeneralTabDetails",value:function(){return this.validateSwaggerIconBrandColor(this.SwaggerEditorData.swaggerIconBrandColor)||this.validateSwaggerDescription(this.swagger.info.description)||this.validateSwaggerHost(this.swagger.host)||this.validateSwaggerBasePath(this.swagger.basePath)}},{key:"validateSwaggerIconBrandColor",value:function(e){return Object(w.a)(e)||/^#[0-9a-fA-F]{6}$/.test(e)?null:new x.a(A.b.customApiInvalidIconBrandColor,this.clientResources.Manage.CustomConnection.Create.Api.IconBrandColor.invalidFormat,null)}},{key:"validateSwaggerDescription",value:function(e){return!Object(w.a)(e)&&e.length<30?new x.a(A.b.customApiInvalidDescription,this.clientResources.Manage.CustomConnection.Create.Api.CustomConnectorDescription.invalidDescription,null):null}},{key:"validateSwaggerHost",value:function(e){var t;return Object(T.a)(e)?t=this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.missing:Object(R.a)(e)?t=this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.scheme:this.isLocalHost(e)&&!this.swaggerEditorData.isOnPremiseDataGateway?t=this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.localhost:e.includes("/")?t=this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.subPaths:Object(D.a)(e)?t=this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.pathTemplating:e.includes("?")?t=this.clientResources.Manage.CustomConnection.Create.Api.Host.Invalid.queryParameter:e.includes("#")&&(t=this.clientResources.Manage.CustomConnector.Create.Api.Host.Invalid.fragmentIdentifier),t&&new x.a(A.b.customApiInvalidHost,t)}},{key:"isLocalHost",value:function(e){return"localhost"===(e=e.toLowerCase())||"127.0.0.1"===e||e.startsWith("localhost:")||e.startsWith("127.0.0.1:")}},{key:"validateSwaggerBasePath",value:function(e){var t;return Object(w.a)(e)?F.noop():Object(N.a)(e,"/")?Object(D.a)(e)?t=this.clientResources.Manage.CustomConnection.Create.Api.BasePath.Invalid.pathTemplating:e.includes("?")?t=this.clientResources.Manage.CustomConnection.Create.Api.BasePath.Invalid.queryParameter:e.includes("#")&&(t=this.clientResources.Manage.CustomConnector.Create.Api.BasePath.Invalid.fragmentIdentifier):t=this.clientResources.Manage.CustomConnection.Create.Api.BasePath.Invalid.noLeadingSlash,t&&new x.a(A.b.customApiInvalidBasePath,t)}},{key:"constructConnectionParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._constructConnectionParameters(e,this.securityTabDetails.selectedAuthenticationType)}},{key:"_constructConnectionParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,i={};switch(this.isCustomConnectorMultiAuthEnabled&&1===this.securityTabDetails.selectedAuthenticationTypes.length&&(t=this.securityTabDetails.selectedAuthenticationTypes[0]),t){case l.b.Basic:i=this.constructBasicAuthConnectionParameters();break;case l.b.Oauth2:i=this.constructOAuth2ConnectionParameters(e);break;case l.b.ApiKey:i=this.constructApiKeyAuthConnectionParameters();break;case l.b.Windows:i=this.constructWindowsAuthConnectionParameters()}return this.swaggerEditorData.isOnPremiseDataGateway&&(i&&Object.keys(i).forEach(e=>{i[e].uiDefinition&&i[e].uiDefinition.constraints&&(i[e].uiDefinition.constraints=_(_({},i[e].uiDefinition.constraints),{capability:["gateway"]}))}),i=_(_({},i),this.constructOnPremiseConnectionParameters(t))),i}},{key:"constructConnectionParameterSets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isCustomConnectorMultiAuthEnabled&&this.securityTabDetails.selectedAuthenticationTypes.length>1&&(this.swagger.security=[]),this.isCustomConnectorMultiAuthEnabled&&this.securityTabDetails.selectedAuthenticationTypes.length>1&&this.securityTabDetails.enableServicePrincipalSupport){this.convertOAuthScopes();var t=this.isCustomConnectorMultiAuthEnabled?Object(p.e)(this.swagger,l.b.Oauth2):Object(p.f)(this.swagger,l.b.Oauth2);t&&(this.SwaggerEditorData.swagger.securityDefinitions[t].scopes=Object(v.b)(this.securityTabDetails.scopes))}if(this.multiAuthService.constructOAuth2ConnectionParameterSets(this.swagger,this.securityTabDetails,e),this.isCustomConnectorMultiAuthEnabled&&this.securityTabDetails.selectedAuthenticationTypes.length>1){var i,r=null!==(i=this.securityTabDetails.connectionParameterSets)&&void 0!==i?i:{uiDefinition:{displayName:this.clientResources.Services.MultiAuthService.ConnectionParameterSet.UiDefinition.displayName,description:this.clientResources.Services.MultiAuthService.ConnectionParameterSet.UiDefinition.description},values:[]};for(var n of this.securityTabDetails.selectedAuthenticationTypes)if(n!==l.b.Oauth2||!this.securityTabDetails.connectionParameterSets){var o=this._constructConnectionParameters(e,n),a=n;n===l.b.Oauth2&&(a="".concat(n,"-").concat(this.securityTabDetails.selectedIdentityProviderId));var s={name:a,uiDefinition:this.generateUIDefinitionForConnectionParameterSet(n),parameters:o};r.values.push(s)}return r}return this.securityTabDetails.connectionParameterSets}},{key:"generateUIDefinitionForConnectionParameterSet",value:function(e){switch(e){case l.b.Basic:return{displayName:this.clientResources.Manage.CustomApi.Security.basic,description:this.clientResources.Manage.CustomApi.Security.basic};case l.b.Oauth2:return{displayName:this.clientResources.Services.MultiAuthService.ConnectionParameterSet.OAuthConnection.displayName,description:this.clientResources.Services.MultiAuthService.ConnectionParameterSet.OAuthConnection.description};case l.b.ApiKey:return{displayName:this.clientResources.Manage.CustomApi.Security.apiKey,description:this.clientResources.Manage.CustomApi.Security.apiKey};default:return{displayName:e,description:e}}}},{key:"constructBasicAuthConnectionParameters",value:function(){var e="Username",t="Password";if(this.isCustomConnectorMultiAuthEnabled)e=this.securityTabDetails.basicAuthFormItems.usernameLabel,t=this.securityTabDetails.basicAuthFormItems.passwordLabel;else{var i=this.connectionFormService.convertFormItemsToParameterValues(this.securityTabDetails.authenticationFormItems);i&&Object.keys(i).forEach(r=>{var n=i[r];switch(r.toUpperCase()){case"USERNAME":e=n;break;case"PASSWORD":t=n}})}return{[E.a.username]:{type:"securestring",uiDefinition:{displayName:e,description:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Basic.descriptionMessage,e),tooltip:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Basic.tooltipMessage,e),constraints:{tabIndex:2,clearText:!0,required:"true"}}},[E.a.password]:{type:"securestring",uiDefinition:{displayName:t,description:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Basic.descriptionMessage,t),tooltip:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Basic.tooltipMessage,t),constraints:{tabIndex:3,clearText:!1,required:"true"}}}}}},{key:"getOAuthRedirectMode",value:function(e){var t,i,r,o=this.securityTabDetails.uniqueRedirectUrlChecked;return!(null!==(t=this.swaggerEditorData)&&void 0!==t&&null!==(t=t.securityTabDetails)&&void 0!==t&&t.redirectMode||null!==(i=this.swaggerEditorData)&&void 0!==i&&null!==(i=i.securityTabDetails)&&void 0!==i&&i.redirectUrl)||o?n.g.GlobalPerConnector:null!==(r=this.securityTabDetails.redirectMode)&&void 0!==r?r:null}},{key:"constructOAuth2ConnectionParameters",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i={};return e=this.isCustomConnectorMultiAuthEnabled?Object(z.a)(this.securityTabDetails.cache.identityProviderParameters[this.securityTabDetails.selectedIdentityProviderId],this.securityTabDetails.oAuthFormItemValues):this.connectionFormService.convertFormItemsToParameterValues(this.securityTabDetails.authenticationFormItems),this.convertOAuthSecurityDetailsToSwagger(e),i={token:{type:"oAuthSetting",oAuthSettings:{identityProvider:this.securityTabDetails.selectedIdentityProviderId,scopes:this.securityTabDetails.scopes,redirectMode:this.getOAuthRedirectMode(t),customParameters:{}},uiDefinition:{displayName:this.clientResources.Services.MultiAuthService.ConnectionParameterSet.OAuthConnection.displayName,description:this.clientResources.Services.MultiAuthService.ConnectionParameterSet.OAuthConnection.description,constraints:{required:"true",hidden:"false"}}}},Object(v.c)(e,i),i}},{key:"constructApiKeyAuthConnectionParameters",value:function(){var e={};return this.convertApiKeySecurityDetailsToSwagger(),e[E.a.api_key]={type:"securestring",uiDefinition:{displayName:this.securityTabDetails.apiKeyLabel,description:Object(M.a)(this.clientResources.Manage.CustomApi.Security.ApiKey.descriptionMessage,this.securityTabDetails.apiKeyLabel),tooltip:Object(M.a)(this.clientResources.Manage.CustomApi.Security.ApiKey.tooltipMessage,this.securityTabDetails.apiKeyLabel),constraints:{tabIndex:2,clearText:!1,required:"true"}}},e}},{key:"constructWindowsAuthConnectionParameters",value:function(){return{[E.a.username]:{type:"securestring",uiDefinition:{displayName:"Username",description:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Windows.descriptionMessage,"Username"),tooltip:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Windows.tooltipMessage,"Username"),constraints:{tabIndex:2,clearText:!0,required:"true",capability:["gateway"]}}},[E.a.password]:{type:"securestring",uiDefinition:{displayName:"Password",description:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Windows.descriptionMessage,"Password"),tooltip:Object(M.a)(this.clientResources.Manage.CustomApi.Security.Windows.tooltipMessage,"Password"),constraints:{tabIndex:3,clearText:!1,required:"true",capability:["gateway"]}}}}}},{key:"constructOnPremiseConnectionParameters",value:function(e){return{authType:{type:"string",allowedValues:[{value:e}],uiDefinition:{displayName:this.clientResources.Manage.CustomApi.Security.AuthType.displayName,description:this.clientResources.Manage.CustomApi.Security.AuthType.descriptionMessage,tooltip:this.clientResources.Manage.CustomApi.Security.AuthType.tooltipMessage,constraints:{tabIndex:1,required:"true",allowedValues:[{text:e,value:"none"===e?"anonymous":e}],capability:["gateway"]}}},gateway:{type:"gatewaySetting",gatewaySettings:{dataSourceType:"CustomConnector",connectionDetails:[]},uiDefinition:{constraints:{tabIndex:4,required:"true",capability:["gateway"]}}}}}},{key:"updateServicePrincipalSupport",value:function(e){this.multiAuthService.updateMultiAuthSupport(this.swagger,this.securityTabDetails,e)}},{key:"updateAadSecretOption",value:function(e){this.multiAuthService.updateAadSecretOption(this.swagger,this.securityTabDetails,e)}},{key:"initializeData",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!e&&this.swaggerEditorData&&this.swaggerEditorData.securityTabDetails&&this.SwaggerEditorData.securityTabDetails.cache?this.SwaggerEditorData.securityTabDetails.cache:{identityProviders:[],identityProviderParameters:{}};this.swaggerEditorData={apiName:null,displayName:null,editMode:!1,isInlineSwaggerEditor:!1,securityTabDetails:{oAuthLabel:"oauth2-auth",authenticationFormItems:{},isLocked:!1,selectedAuthenticationType:l.b.None,selectedAuthenticationTypes:[],scopes:[],cache:t},spinner:{size:c.c.Large,local:c.a.Local},statusAlert:{message:"",type:u.a.None,options:{title:null,show:(e,t)=>{this.swaggerEditorData.statusAlert.type=e,this.swaggerEditorData.statusAlert.message=t,-1===[u.a.Success,u.a.Info].indexOf(e)||this.hideAlertInProgress||(this.hideAlertInProgress=!0,this.$timeout(()=>{this.swaggerEditorData.statusAlert.options.hide(),this.hideAlertInProgress=!1},this.autoHideNotificationInterval))},hide:()=>this.swaggerEditorData.statusAlert.options.show(u.a.None,""),control:{action:()=>this.swaggerEditorData.validationError=null}}},swagger:m()(p.b),deployedSwagger:p.b,inlineEditorSwagger:p.a,swaggerFileName:null,swaggerIconFile:null,swaggerIconFileContentUrl:this.defaultIconFile,swaggerIconBrandColor:null,swaggerIconDisplay:{"background-image":null,"background-color":null},validationError:null,uiDetails:{leftColumnScrollPosition:0,foldingListCollapseState:{actions:!1,triggers:!1,references:!1,policies:!1,test:!1},importSectionUIDetails:{selectedRestImportMode:r.b.OpenApiFile,selectedSoapImportMode:r.c.WsdlFile}},apiLogicApps:{properties:{apiType:d.a.Rest,wsdlDefinition:{importMethod:d.b.SoapToRest}}},importFormat:r.a.none},this.customApiTestData={connections:[],apiInfo:{api:void 0,apimSwagger:void 0},currentOperation:void 0,testOperations:[],logSasUri:null,selectedOperationIndex:null,selectedConnectionName:null}}}])&&K(t.prototype,i),o&&K(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.a.factory(a.a.services.swaggerEditorData,[a.a.services.$q,a.a.services.$timeout,a.a.services.apisClient,a.a.services.assetService,a.a.services.clientResources,a.a.services.connectionForm,a.a.services.customApiHelper,a.a.services.logging,a.a.services.widgetUtilService,a.a.services.multiAuthServiceSelector,(e,t,i,r,n,o,a,s,l,c)=>new Q(e,t,i,r,n,o,a,s,l,c)])},33940:function(e,t,i){"use strict";function r(e){return/{.*}/.test(e)}i.d(t,"a",(function(){return r}))},33941:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i(11891),n=i(13003),o=i(33847);function a(e,t){var i=e.filter(e=>e.AuthorizationEndPoints.some(e=>Object(r.a)(Object(n.a)(e).host,t)));return i.length>0?i[0]:e.filter(e=>Object(r.a)(e.Id,o.a.GenericOAuth))[0]}function s(e,t){var i=e.filter(e=>Object(r.a)(e.Id,t));return i.length>0?i[0]:e.filter(e=>Object(r.a)(e.Id,o.a.GenericOAuth))[0]}},33942:function(e,t,i){"use strict";i.d(t,"c",(function(){return f})),i.d(t,"b",(function(){return v})),i.d(t,"a",(function(){return b}));var r=i(16335),n=i(16519),o=i(16128),a=i(16196),s=i(13778),l=i(12246),c=i(11766),u=i.n(c),d=i(14868),p=i(33938),h=i(33943),m=i(13957),g={[d.b.None]:p.b.NoAuth,[d.b.Basic]:p.b.BasicAuth,[d.b.ApiKey]:p.b.ApiKeyAuth,[d.b.Oauth2]:p.b.Oauth2Auth,[d.b.Windows]:p.b.WindowsAuth},f=2,v=[[d.b.Oauth2,d.b.ApiKey],[d.b.Oauth2,d.b.Basic],[d.b.Basic,d.b.ApiKey]],b=Object(l.l)("PowerAutomateCustomConnectors")(e=>{var{t:t,authenticationTypeOptions:i,onSelectedAuthenticationTypesChanged:l}=e,d=Object(h.a)(),[b,y]=Object(c.useState)(e.selectedAuthenticationTypes?[...e.selectedAuthenticationTypes]:[]),w=Object(c.useCallback)((e,t)=>{var i,{optionValue:r}=t;r&&(i=b.includes(r)?b.filter(e=>e!==r):b.concat(r),l(i),y(i))},[b,l]),S=e=>{if(b.includes(e))return!1;if((null==b?void 0:b.length)===f&&!b.includes(e))return!0;if((null==b?void 0:b.length)>=1&&(null==b?void 0:b.length)<=f-1){var t=b[0];return!v.some(i=>i.includes(t)&&i.includes(e))}return!1};return u.a.createElement("div",{className:d.root},u.a.createElement(r.a,{className:d.panelTitle,block:!0},t(p.b.AuthenticationType.Heading)),u.a.createElement("div",{className:d.panel},u.a.createElement(n.a,{label:t(p.b.AuthenticationType.Label),required:!0,validationMessage:(e=>{if(!e||0===e.length)return t(p.b.Validation.AuthenticationTypeRequired)})(b)},u.a.createElement(o.a,{"aria-label":t(p.b.AuthenticationType.Label),multiselect:!0,onOptionSelect:w,selectedOptions:b,disabled:e.isReadOnly,value:b?b.map(e=>t(g[e])).join(", "):""},i.map(e=>u.a.createElement(a.a,{key:e,value:e,disabled:S(e),text:t(g[e])},t(g[e]))))),u.a.createElement("br",null),e.isReadOnly&&u.a.createElement(s.a,{onClick:()=>e.enableEditMode(),icon:u.a.createElement(m.b,null),iconPosition:"before"},t(p.b.Edit))))})},33943:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(13859),n=i(13680),o=i(33944),a=Object(r.a)({root:{marginTop:"32px"},panel:{backgroundColor:n.a.colorNeutralBackground1,padding:"0px 24px 24px 24px"},panelTitle:Object(o.a)()})},33944:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i(13859),n=i(13680),o=()=>({fontSize:"14px",fontWeight:600,padding:"8px 8px 8px 24px",lineHeight:"normal",backgroundColor:"#cce0ff"}),a=Object(r.a)({root:{backgroundColor:n.a.colorNeutralBackground1,padding:"16px 24px 24px 24px"}}),s=Object(r.a)({checkbox:{marginTop:"16px",marginLeft:"-8px"},link:{color:n.a.colorBrandForegroundLink+" !important"}})},33945:function(e,t,i){"use strict";i(33946),i(33947),i(33948),i(33949),i(33950),i(33978),i(33979)},33946:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(17914),a=i(17913),s=i(11806),l=i(33359),c=i(14901);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$routeParams=t,this.routeCrafter=i,this.swaggerEditorDataService=r}var t,i,r;return t=e,(i=[{key:"getCustomApiTabUrl",value:function(e){var{apiName:t,editMode:i}=this.swaggerEditorDataService.SwaggerEditorData;return this.getCustomApiTabUrlFromCaller(t,i,e)}},{key:"getCustomApiTabUrlFromCaller",value:function(e,t,i){var r=this.getSolutionQueryParams(t);if(i===o.c.definition){var{swagger:n}=this.swaggerEditorDataService.SwaggerEditorData;if(n.actions&&n.actions.length>0)return Object(a.d)(this.routeCrafter,{apiName:e,editMode:t,operation:o.a.actions},r);if(n.triggers&&n.triggers.length>0)return Object(a.d)(this.routeCrafter,{apiName:e,editMode:t,operation:o.a.triggers},r)}return Object(a.g)(this.routeCrafter,{apiName:e,editMode:t,tabName:i},r)}},{key:"getCustomApiDefinitionTypeUrl",value:function(e,t){var{apiName:i,editMode:r}=this.swaggerEditorDataService.SwaggerEditorData;return Object(a.d)(this.routeCrafter,{apiName:i,editMode:r,operationIndex:t,operation:e},this.getSolutionQueryParams(r))}},{key:"getCustomApiCopilotTypeUrl",value:function(e,t){var{apiName:i,editMode:r}=this.swaggerEditorDataService.SwaggerEditorData;return Object(a.b)(this.routeCrafter,{apiName:i,editMode:r,operationIndex:t,operation:e},this.getSolutionQueryParams(r))}},{key:"getCustomApiNewDefaultUrl",value:function(e){return this.getCustomApiTabUrlFromCaller(e,!1,o.c.general)}},{key:"getCustomApisListUrl",value:function(){return Object(c.m)(this.routeCrafter)}},{key:"getReferenceUrl",value:function(e,t){var i,{apiName:r,editMode:n}=this.swaggerEditorDataService.SwaggerEditorData;switch(e.source){case l.g.parameters:i=o.a.parameters;break;case l.g.responses:i=o.a.responses;break;default:i=o.a.definitions}return Object(a.d)(this.routeCrafter,{apiName:r,editMode:n,operationIndex:t,operation:i},this.getSolutionQueryParams(n))}},{key:"getInlineOperationUrl",value:function(e,t,i,r){var{apiName:n,editMode:o}=this.swaggerEditorDataService.SwaggerEditorData,s=this.getSolutionQueryParams(o);return Object(a.c)(this.routeCrafter,{apiName:n,editMode:o,operationIndex:e,operation:t,refOperation:i,refOperationIndex:r},s)}},{key:"getInlineCopilotOperationUrl",value:function(e,t,i,r){var{apiName:n,editMode:o}=this.swaggerEditorDataService.SwaggerEditorData,s=this.getSolutionQueryParams(o);return Object(a.a)(this.routeCrafter,{apiName:n,editMode:o,operationIndex:e,operation:t,refOperation:i,refOperationIndex:r},s)}},{key:"getDefaultEditCustomApisUrl",value:function(e){return this.getCustomApiTabUrlFromCaller(e,!0,o.c.general)}},{key:"getCustomApiDetailsTab",value:function(e,t){return Object(a.e)(this.routeCrafter,{apiName:e,tabName:t})}},{key:"getSolutionQueryString",value:function(){var{editMode:e}=this.swaggerEditorDataService.SwaggerEditorData;return Object(s.b)(this.getSolutionQueryParams(e))}},{key:"getSolutionQueryParams",value:function(e){var t=this.$routeParams[o.h.solutionId];return!e&&t?{[o.h.solutionId]:t}:void 0}}])&&u(t.prototype,i),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();p.$inject=[n.a.services.$routeParams,n.a.services.routeCrafter,n.a.services.swaggerEditorData],r.a.service(n.a.services.customConnectorUrlService,p)},33947:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33790),a=i(33360),s=i(33374);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(e){return e[e.Add=0]="Add",e[e.Remove=1]="Remove",e}(u||{}),d=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.powerAppsUserSettingsClient=i,this.sessionService=r}var t,i,r;return t=e,(i=[{key:"updateHideKeys",value:function(){var e=this.getHideKeyActions();if(0!==e.length&&!this.sessionService.isConsumerDomain){var t=this.sessionService.getUserInfo();this.powerAppsUserSettingsClient.getUserSettings({objectId:t.uniqueId,settingGroup:o.a.policyTemplates}).then(e=>Array.isArray(e.data.properties.settings.hideKeys)?e.data.properties.settings.hideKeys:[]).then(i=>{this.powerAppsUserSettingsClient.updateUserSettings({objectId:t.uniqueId,settingGroup:o.a.policyTemplates},{hideKeys:this.applyHideKeyActions(i,e)})}).catch(e=>{this.loggingService.logWarning("PolicyConfigurationService.updateHideKeys",e)})}}},{key:"getHideKeyActions",value:function(){var e=[],{addPolicyTemplateHideKey:t,removePolicyTemplateHideKey:i}=Object(s.c)(window.location.href).parameters;return Object(a.o)(t)||t.split(";").map(e=>e.trim()).filter(e=>e.length>0).forEach(t=>e.push({hideKey:t,actionType:u.Add})),Object(a.o)(i)||i.split(";").map(e=>e.trim()).filter(e=>e.length>0).forEach(t=>e.push({hideKey:t,actionType:u.Remove})),e}},{key:"applyHideKeyActions",value:function(e,t){var i=new Set(e);for(var r of t)switch(r.actionType){case u.Add:i.add(r.hideKey);break;case u.Remove:i.delete(r.hideKey)}return Array.from(i)}}])&&l(t.prototype,i),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[n.a.services.logging,n.a.services.powerAppsUserSettingsClient,n.a.services.session],r.a.service(n.a.services.policyConfigurationService,d)},33948:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33895),a=i(14876);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.operationParameterId="x-ms-apimTemplate-operationName"}var t,i,r;return t=e,(i=[{key:"convertToPolicyType",value:function(e){var t=e.properties.parameters.find(e=>e.id===this.operationParameterId);return new o.g(e.properties.id,e.properties.title,e.properties.description,this.convertToPolicyTypeFlavor(e.properties.type),!0===e.properties.isInPreview,void 0===t,t&&t.title,t&&t.description,this.convertToPolicyParameters(e.properties.parameters,e.properties.requiredParameters))}},{key:"convertToPolicyTypeFlavor",value:function(e){switch(e){case void 0:return o.h.General;case"PollingTrigger":return o.h.PollingTrigger;default:throw new Error("Unrecognized policy template type '".concat(e,"'"))}}},{key:"convertToPolicyParameters",value:function(e,t){var i=[];for(var r of e)switch(r.type){case"Boolean":i.push(new o.a(this.clientResources,r.id,r.title,r.description,null==t?void 0:t.includes(r.id),this.toBoolean(r.defaultValue)));break;case"Integer":i.push(new o.b(this.clientResources,r.id,r.title,r.description,null==t?void 0:t.includes(r.id),this.toNumber(r.defaultValue),this.toNumber(r.minValue),this.toNumber(r.maxValue)));break;case"String":i.push(new o.i(this.clientResources,r.id,r.title,r.description,null==t?void 0:t.includes(r.id),r.defaultValue,r.allowedValues));break;case"Object":switch(r.format){case"KeyValue":i.push(new o.c(this.clientResources,r.id,r.title,r.description,null==t?void 0:t.includes(r.id)));break;default:throw new Error("Unrecognized policy template parameter format '".concat(r.format,"'"))}break;default:if(r.id===this.operationParameterId)continue;throw new Error("Unrecognized policy template parameter type '".concat(r.type,"'"))}return i}},{key:"toBoolean",value:function(e){return void 0===e?void 0:Boolean(e)}},{key:"toNumber",value:function(e){return void 0===e?void 0:Number(e)}},{key:"convertToPolicyItem",value:function(e,t,i){var r=i(e.templateId),n=e.parameters[this.operationParameterId];return new o.d(this.clientResources,e.title,r,(n||[]).map(t),this.convertToPolicyParameterItems(r,e.parameters))}},{key:"convertToPolicyParameterItems",value:function(e,t){return e.parameters.map(e=>new o.e(e,this.convertToPolicyParameterValue(e.type,t[e.id])))}},{key:"convertToPolicyParameterValue",value:function(e,t){if(void 0!==t)return e===o.f.KeyValue?{key:Object.keys(t)[0],value:Object.values(t)[0]}:t}},{key:"convertToPolicyTemplateInstance",value:function(e,t){return{title:e.name,templateId:e.type.id,type:this.convertToPolicyTemplateInstanceType(e.type.flavor),parameters:this.convertToPolicyTemplateInstanceParameters(e,t)}}},{key:"convertToPolicyTemplateInstanceType",value:function(e){switch(e){case o.h.General:return;case o.h.PollingTrigger:return"PollingTrigger";default:throw new Error("Unhandled policy type flavor '".concat(o.h[e]," (").concat(e,")'"))}}},{key:"convertToPolicyTemplateInstanceParameters",value:function(e,t){var i={};for(var r of e.parameterItems)Object(a.a)(r.value)&&!r.parameter.isRequired||(i[r.parameter.id]=this.convertToPolicyTemplateInstanceParameterValue(r.parameter.type,r.value));var n=e.operations.filter(t).map(e=>e.operation.operationId);return Object(a.a)(n)||(i[this.operationParameterId]=n),i}},{key:"convertToPolicyTemplateInstanceParameterValue",value:function(e,t){if(void 0!==t){if(e===o.f.KeyValue){var i=t;return{[i.key]:i.value}}return t}}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[n.a.services.clientResources],r.a.service(n.a.services.policyConversionService,c)},33949:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(13009),a=i(17266),s=i(19940),l=i(33895),c=i(33800);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t,i,r,n,o,a,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$interval=t,this.$q=i,this.clientResources=r,this.loggingService=n,this.policyConversionService=o,this.policyTemplateClient=a,this.swaggerEditorDataService=c,this.widgetUtilService=u,this.shouldFetchPolicyTypes=!0,this._policyItemsArray=Object(s.c)(l.h).map(e=>[]),this._policyItems=this._policyItemsArray[l.h.General],this._policyTypes=[],this.policyItems=this._policyItems,this.policyTypes=this._policyTypes,this.isCustomApiPolicyFeatureEnabled()&&this.$interval(()=>this.validatePolicyItems(),2e3)}var t,i,r;return t=e,(i=[{key:"allPolicyItems",get:function(){return[].concat(...this._policyItemsArray)}},{key:"operationPolicyInfo",get:function(){var e,t=()=>{};return this.isPollingTriggerPolicyFeatureEnabled()&&(e=this._policyItemsArray[l.h.PollingTrigger].map(e=>this.policyConversionService.convertToPolicyTemplateInstance(e,e=>this.isValidOperation(e))),t=()=>this.validatePolicyItems(l.h.PollingTrigger)),{state:e,validate:t}}},{key:"operationValidationErrorCount",get:function(){var e=0;return this.isPollingTriggerPolicyFeatureEnabled()&&(e+=this._policyItemsArray[l.h.PollingTrigger].map(e=>e.validationResults.errorCount).reduce((e,t)=>e+t,0)),e}},{key:"policyTemplateInstances",get:function(){return this.allPolicyItems.map(e=>this.policyConversionService.convertToPolicyTemplateInstance(e,e=>this.isValidOperation(e)))},set:function(e){if(this._policyItemsArray.forEach(e=>e.length=0),void 0!==e)for(var t of e)try{var i=this.policyConversionService.convertToPolicyItem(t,e=>this.getOperationItemById(e),e=>this.getPolicyTypeById(e));this._policyItemsArray[i.type.flavor].push(i)}catch(n){var r="Skipping policy template instance with title '".concat(t.title,"'. ").concat(n.message,".");console.error(r)}}},{key:"validationErrorCount",get:function(){return this.isCustomApiPolicyFeatureEnabled()?(this.validatePolicyItems(),this._policyItems.map(e=>e.validationResults.errorCount).reduce((e,t)=>e+t,0)):0}},{key:"addEmptyPolicyItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.h.General;return this._policyItemsArray[e].push(new l.d(this.clientResources))-1}},{key:"addPolicyItem",value:function(e,t){void 0===t&&(t=e.type.flavor);var i=this._policyItemsArray[t].indexOf(e);return i>=0?i:this._policyItemsArray[t].push(e)-1}},{key:"clear",value:function(){this._policyItemsArray.forEach(e=>e.length=0),this._policyTypes.length=0,this.shouldFetchPolicyTypes=!0}},{key:"deleteOperationPolicyItems",value:function(e){if(this.isPollingTriggerPolicyFeatureEnabled()){var t=this.getOperationPolicyItem(l.g.PollingTrigger,e);void 0!==t&&this.deletePolicyItem(t)}}},{key:"deletePolicyItem",value:function(e,t){void 0===t&&(t=e.type.flavor);var i=this._policyItemsArray[t].indexOf(e);return i>=0&&(this._policyItemsArray[t].splice(i,1),!0)}},{key:"fetchPolicyTypes",value:function(e){return this.isCustomApiPolicyFeatureEnabled()&&this.shouldFetchPolicyTypes?(this.shouldFetchPolicyTypes=!1,this.policyTemplateClient.query(e).$promise.then(e=>this.populatePolicyTypes(e))):this.$q.resolve()}},{key:"getOperationItemById",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=[...this.swaggerEditorDataService.swagger.actions,...this.swaggerEditorDataService.swagger.triggers];for(var r of i)if(r.operation.operationId===e)return r;if(t)throw new Error("No operation with id '".concat(e,"' found"))}},{key:"getOperationPolicyItem",value:function(e,t,i){if("string"==typeof e&&(e=this.getPolicyTypeById(e,!1)),void 0!==e)return void 0===i&&(i=e.flavor),this._policyItemsArray[i].find(i=>i.type===e&&i.operations.includes(t))}},{key:"getPolicyTypeById",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var i of this._policyTypes)if(i.id===e)return i;if(t)throw new Error("No policy type with id '".concat(e,"' found"))}},{key:"getOperationValidationResults",value:function(e){var t=new c.h;if(this.isPollingTriggerPolicyFeatureEnabled()){var i=this.getOperationPolicyItem(l.g.PollingTrigger,e);void 0!==i&&t.add(i.validationResults)}return t}},{key:"isCustomApiPolicyFeatureEnabled",value:function(){return!this.widgetUtilService.isLogicApps()}},{key:"isPollingTriggerPolicyFeatureEnabled",value:function(){return!this.widgetUtilService.isLogicApps()}},{key:"isValidIndex",value:function(e){return null!==e&&e>=0&&e<this._policyItems.length}},{key:"isValidOperation",value:function(e){return[...this.swaggerEditorDataService.swagger.actions,...this.swaggerEditorDataService.swagger.triggers].includes(e)}},{key:"movePolicyItemUp",value:function(e){var t=this._policyItems.indexOf(e);return t>0?([this._policyItems[t-1],this._policyItems[t]]=[this._policyItems[t],this._policyItems[t-1]],t):-1}},{key:"movePolicyItemDown",value:function(e){var t=this._policyItems.indexOf(e);return t>=0&&t<this._policyItems.length-1?([this._policyItems[t],this._policyItems[t+1]]=[this._policyItems[t+1],this._policyItems[t]],t):-1}},{key:"updateOperations",value:function(){for(var e of this.allPolicyItems){var t=e.operations.map(e=>this.getOperationItemById(e.operation.operationId,!1)).filter(e=>void 0!==e);e.operations.length=0,e.operations.push(...t)}}},{key:"populatePolicyTypes",value:function(e){for(var t of(this._policyTypes.length=0,e))try{this._policyTypes.push(this.policyConversionService.convertToPolicyType(t))}catch(r){var i="Skipping policy template with name '".concat(t.name,"'. ").concat(r.message,".");console.error(i),this.loggingService.logError("PolicyDataService.populatePolicyTypes",new a.a(o.c.customApiPolicyError,i))}}},{key:"validatePolicyItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.h.General,t=this.allPolicyItems.map(e=>e.name);for(var i of this._policyItemsArray[e])i.validate(t)}}])&&u(t.prototype,i),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();p.$inject=[n.a.services.$interval,n.a.services.$q,n.a.services.clientResources,n.a.services.logging,n.a.services.policyConversionService,n.a.services.policyTemplatesClient,n.a.services.swaggerEditorData,n.a.services.widgetUtilService],r.a.service(n.a.services.policyDataService,p)},33950:function(e,t,i){"use strict";var r=i(14751),n=i.n(r),o=i(33279),a=i(33331),s=i(33327),l=i(20342),c=i(33800),u=i(33363),d=i(33357),p=i(33802),h=i(33951),m=i(12330),g=i(14876),f=i(33355);function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.clientResources=i,this.loggingService=r,this.refPropertyKey="$ref",this.swagger=void 0,this.rules=void 0,this.resultCollection=void 0,this.lastSwaggerValidated=void 0,this.rules=[new h.b(this.clientResources),new h.c(this.clientResources),new h.f(this.clientResources),new h.g(this.clientResources),new h.e(this.clientResources),new h.h(this.clientResources),new h.i(this.clientResources),new h.j(this.clientResources),new h.l(this.clientResources),new h.m(this.clientResources),new h.n(this.clientResources),new h.o(this.clientResources),new h.p(this.clientResources),new h.q(this.clientResources),new h.s(this.clientResources),new h.r(this.clientResources),new h.t(this.clientResources),new h.u(this.clientResources),new h.w(this.clientResources),new h.x(this.clientResources),new h.y(this.clientResources)],this.appSettings.featureFlags.enableAdvancedSwaggerValidation&&(this.rules.push(new h.a(this.clientResources)),this.rules.push(new h.d(this.clientResources)),this.rules.push(new h.k(this.clientResources)),this.rules.push(new h.v(this.clientResources))),this.resultCollection=new c.h}var t,i,r;return t=e,(i=[{key:"validateIfSwaggerChanged",value:function(e,t){o.equals(this.lastSwaggerValidated,{swagger:e,policyState:t.state})||this.validate(e,t)}},{key:"validate",value:function(e,t){if(this.resultCollection.clear(),!Object(g.a)(e))try{this.swagger=e,this.lastSwaggerValidated=n()({swagger:e,policyState:t.state}),this.rules.forEach(t=>{t.setSwaggerUsedForValidation(e)}),Array.isArray(e.actions)&&e.actions.forEach((e,t)=>{var i={itemPath:"".concat(c.d.Actions,"[").concat(t,"]"),itemDisplayName:p.d(e)};this.resultCollection.add(this.validateOperation(e,i))}),Array.isArray(e.triggers)&&e.triggers.forEach((e,t)=>{var i={itemPath:"".concat(c.d.Triggers,"[").concat(t,"]"),itemDisplayName:p.d(e)};this.resultCollection.add(this.validateOperation(e,i))}),Array.isArray(e.definitions)&&e.definitions.forEach((t,i)=>{if(t&&t.item){var r,n={itemPath:"".concat(c.d.Definitions,"[").concat(i,"]"),itemDisplayName:c.c(this.clientResources).Definition};this.resultCollection.add(this.rules.map(e=>e.validateDefinitionItem(t,n))),n.itemPath+=c.d.Item,n.itemDisplayName=c.c(this.clientResources).Body,this.resultCollection.add(this.rules.map(e=>e.validateUnresolvedSchema(t.item,n)));try{var o=u.g(e,t.item);this.resultCollection.add(this.rules.map(e=>e.validateResolvedSchema(o,n))),r=u.c(o.schema)}catch(a){return void this.resultCollection.add(this.getSchemaResolutionViolation(n))}r.forEach(e=>{this.resultCollection.add(this.rules.map(t=>t.validateSchemaProperty(e,n)))})}}),Array.isArray(e.parameters)&&e.parameters.forEach((e,t)=>{if(e&&e.item){var i={itemPath:"".concat(c.d.Parameters,"[").concat(t,"]"),itemDisplayName:c.c(this.clientResources).ParameterDefinition};this.resultCollection.add(this.rules.map(t=>t.validateParameterDefinitionItem(e,i))),i.itemPath+=c.d.Item,i.itemDisplayName=p.f(e.item,this.swagger,this.clientResources),this.resultCollection.add(this.validateParameter(e.item,i))}}),Array.isArray(e.responses)&&e.responses.forEach((e,t)=>{if(e&&e.item){var i={itemPath:"".concat(c.d.Responses,"[").concat(t,"]"),itemDisplayName:c.c(this.clientResources).ResponseDefinition};this.resultCollection.add(this.rules.map(t=>t.validateResponseDefinitionItem(e,i))),i.itemPath+=c.d.Item,i.itemDisplayName=p.i(e,this.clientResources),this.resultCollection.add(this.validateResponse(e.item,i))}}),t.validate()}catch(i){this.loggingService.logError(f.a.swaggerValidationException,i)}}},{key:"validateOperation",value:function(e,t){var i=new c.h;if(!e||Object(m.a)(t)||!this.swagger)return i;i.add(this.rules.map(i=>i.validateOperation(e,t)));var r={itemPath:"".concat(t.itemPath).concat(c.d.Operation),itemDisplayName:t.itemDisplayName};return i.add(this.validateInlineParameters(e.operation,r)),i.add(this.validateInlineResponses(e.operation,r)),i}},{key:"validateInlineParameters",value:function(e,t){var i=new c.h;return e&&Array.isArray(e.parameters)?(e.parameters.forEach((e,r)=>{var n={itemPath:"".concat(t.itemPath).concat(c.d.Parameters,"[").concat(r,"]"),itemDisplayName:p.f(e,this.swagger,this.clientResources)};d.G(e)?i.add(this.rules.map(t=>t.validateJsonReference(e,n))):i.add(this.validateParameter(e,n))}),i):i}},{key:"validateInlineResponses",value:function(e,t){var i=new c.h;return e&&Array.isArray(e.responses)?(e.responses.forEach((e,r)=>{if(e.item){var n={itemPath:"".concat(t.itemPath).concat(c.d.Responses,"[").concat(r,"]"),itemDisplayName:p.i(e,this.clientResources)};i.add(this.rules.map(t=>t.validateInlineResponseDefinitionItem(e,n)));var o={itemPath:"".concat(n.itemPath).concat(c.d.Item),itemDisplayName:n.itemDisplayName};d.G(e.item)?i.add(this.rules.map(t=>t.validateJsonReference(e.item,o))):i.add(this.validateResponse(e.item,o))}}),i):i}},{key:"validateParameter",value:function(e,t){var i=new c.h;if(!e||!e.in||Object(m.a)(t)||!this.swagger)return i;var r={itemPath:t.itemPath,itemDisplayName:t.itemDisplayName};if(e.in===l.e.body){var n;r.propertyPath=c.d.Schema,r.propertyDisplayName=c.c(this.clientResources).Body,i.add(this.rules.map(t=>t.validateUnresolvedSchema(e.schema,r)));try{var o=u.g(this.swagger,e.schema);i.add(this.rules.map(e=>e.validateResolvedSchema(o,r))),n=u.c(o.schema)}catch(a){return i.add(this.getSchemaResolutionViolation(r)),i}n.forEach(e=>{i.add(this.rules.map(t=>t.validateSchemaProperty(e,r)))})}else i.add(this.rules.map(t=>t.validateNonBodyParameter(e,r)));return i}},{key:"validateResponse",value:function(e,t){var i=new c.h;if(!e||!e.schema||e.schema.type===l.f.file||!this.swagger)return i;var r,n={itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:c.d.Schema,propertyDisplayName:c.c(this.clientResources).Body};i.add(this.rules.map(t=>t.validateUnresolvedSchema(e.schema,n)));try{var o=u.g(this.swagger,e.schema);i.add(this.rules.map(e=>e.validateResolvedSchema(o,n))),r=u.c(o.schema)}catch(a){return i.add(this.getSchemaResolutionViolation(n)),i}return r.forEach(e=>{i.add(this.rules.map(t=>t.validateSchemaProperty(e,n)))}),i}},{key:"getSchemaResolutionViolation",value:function(e){return new c.f("SwaggerValidationService",c.e.Warning,this.clientResources.Validate.CustomApi.Results.UnableToResolveSchema,new c.i(e))}}])&&v(t.prototype,i),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();y.$inject=[s.a.services.appSettings,s.a.services.clientResources,s.a.services.logging],a.a.service(s.a.services.swaggerValidationService,y)},33951:function(e,t,i){"use strict";var r=i(33952);i.d(t,"a",(function(){return r.a}));var n=i(33954);i.d(t,"b",(function(){return n.a}));var o=i(33955);i.d(t,"c",(function(){return o.a}));var a=i(33956);i.d(t,"d",(function(){return a.a}));var s=i(33957);i.d(t,"g",(function(){return s.a}));var l=i(33958);i.d(t,"f",(function(){return l.a}));var c=i(33959);i.d(t,"e",(function(){return c.a}));var u=i(33960);i.d(t,"h",(function(){return u.a}));var d=i(33961);i.d(t,"i",(function(){return d.a}));var p=i(33962);i.d(t,"j",(function(){return p.a}));var h=i(33963);i.d(t,"k",(function(){return h.a}));var m=i(33964);i.d(t,"l",(function(){return m.a}));var g=i(33965);i.d(t,"m",(function(){return g.a}));var f=i(33966);i.d(t,"n",(function(){return f.a}));var v=i(33967);i.d(t,"o",(function(){return v.a}));var b=i(33968);i.d(t,"p",(function(){return b.a}));var y=i(33969);i.d(t,"q",(function(){return y.a}));var w=i(33970);i.d(t,"s",(function(){return w.a}));var S=i(33971);i.d(t,"r",(function(){return S.a}));var C=i(33972);i.d(t,"t",(function(){return C.a}));var k=i(33973);i.d(t,"u",(function(){return k.a}));var P=i(33974);i.d(t,"v",(function(){return P.a}));var x=i(33975);i.d(t,"w",(function(){return x.a}));var A=i(33976);i.d(t,"x",(function(){return A.a}));var T=i(33977);i.d(t,"y",(function(){return T.a}))},33952:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(33800),n=i(33802),o=i(33953),a=i(12330),s=i(13083);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,o,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.AllDescriptionsAreSentencesRule,t}return t=p,(i=[{key:"validateNonBodyParameter",value:function(e,t){if(Object(a.a)(e))return[];var i=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:r.d.Description,propertyDisplayName:r.c(this.clientResources).Description});return this.validateDescription(e.description,i)}},{key:"validateOperation",value:function(e,t){if(Object(a.a)(e)||Object(a.a)(e.operation))return[];var i=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:r.d.OperationDescription,propertyDisplayName:r.c(this.clientResources).Description});return this.validateDescription(e.operation.description,i)}},{key:"validateSchemaProperty",value:function(e,t){if(Object(a.a)(e))return[];var i=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:r.d.Description,subPathDisplayName:r.c(this.clientResources).Description});return this.validateDescription(e.description,i)}},{key:"validateDescription",value:function(e,t){var i=[];if(Object(s.a)(e))return i;this.hasMultipleWords(e)||i.push(n.b(this,this.clientResources.Validate.CustomApi.Results.AllDescriptionsAreSentencesRule.OneWord,t)),"."!==e.trim().charAt(e.length-1)&&i.push(n.b(this,this.clientResources.Validate.CustomApi.Results.AllDescriptionsAreSentencesRule.Period,t));var r=e.trim().charAt(0);return r!==r.toUpperCase()&&i.push(n.b(this,this.clientResources.Validate.CustomApi.Results.AllDescriptionsAreSentencesRule.DoesNotStartWithUpper,t)),i}},{key:"hasMultipleWords",value:function(e){return e.trim().indexOf(" ")>0}}])&&l(t.prototype,i),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),p}(o.a)},33953:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,"a",(function(){return o}));var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ruleDescription=void 0,this.swagger=void 0,this.clientResources=void 0,this.clientResources=t}var t,i,n;return t=e,(i=[{key:"ruleId",get:function(){return e=(e=(e=this.constructor.toString()).substr("function ".length)).substr(0,e.indexOf("("));var e}},{key:"setSwaggerUsedForValidation",value:function(e){this.swagger=e}},{key:"validateOperation",value:function(e,t){return[]}},{key:"validateResolvedSchema",value:function(e,t){return[]}},{key:"validateNonBodyParameter",value:function(e,t){return[]}},{key:"validateJsonReference",value:function(e,t){return[]}},{key:"validateUnresolvedSchema",value:function(e,t){return[]}},{key:"validateSchemaProperty",value:function(e,t){return[]}},{key:"validateDefinitionItem",value:function(e,t){return[]}},{key:"validateResponseDefinitionItem",value:function(e,t){return[]}},{key:"validateParameterDefinitionItem",value:function(e,t){return[]}},{key:"validateInlineResponseDefinitionItem",value:function(e,t){return[]}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},33954:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(13083),l=i(13031);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=p(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=f(e);if(t){var n=f(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return g(this,i)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(p,e);var t,i,a,u=m(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e)).basePathEndsWithForwardSlash=!1,t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.AllPathsHaveCorrectFormatRule,t}return t=p,(i=[{key:"setSwaggerUsedForValidation",value:function(e){d(f(p.prototype),"setSwaggerUsedForValidation",this).call(this,e),this.basePathEndsWithForwardSlash=!Object(s.a)(e.basePath)&&"/"===e.basePath.substr(-1)}},{key:"validateOperation",value:function(e,t){var i=[],a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Path,propertyDisplayName:n.c(this.clientResources).URL});if(Object(r.a)(e)||Object(s.a)(e.path))return i;var c=e.path.trim();return this.basePathEndsWithForwardSlash||"/"===c.charAt(0)||i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.AllPathsHaveCorrectFormatRule.DoesNotStartWithSlash,a)),c.indexOf("?")>=0&&i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.AllPathsHaveCorrectFormatRule.ContainsQuestionMark,a)),c.length>n.b&&i.push(o.a(this,Object(l.a)(this.clientResources.Validate.CustomApi.Results.AllPathsHaveCorrectFormatRule.TooLong,c.length,n.b),a)),i}}])&&c(t.prototype,i),a&&c(t,a),Object.defineProperty(t,"prototype",{writable:!1}),p}(a.a)},33955:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(33802),n=i(33953),o=i(12330),a=i(33800),s=i(14876);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,n,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.DefaultValueExistsInEnumRule,t}return t=p,(i=[{key:"validateNonBodyParameter",value:function(e,t){var i=new a.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:a.d.Default,propertyDisplayName:Object(a.c)(this.clientResources).Default});return this.validateDefaultValueExistsInEnum(e,i)}},{key:"validateSchemaProperty",value:function(e,t){var i=new a.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:a.d.Default,subPathDisplayName:Object(a.c)(this.clientResources).Default});return this.validateDefaultValueExistsInEnum(e,i)}},{key:"validateDefaultValueExistsInEnum",value:function(e,t){if(Object(o.a)(e)||Object(o.a)(e.default))return[];var i=e.enum;if(Object(s.a)(i))return[];var n="".concat(e.default);return i.some(e=>String(e.value)===n||String(e)===n)?[]:[r.a(this,this.clientResources.Validate.CustomApi.Results.DefaultValueExistsInEnumRule.NotInEnum,t)]}}])&&l(t.prototype,i),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(n.a)},33956:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(33359),l=i(13083);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(h,e);var t,i,a,u=p(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=u.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.DescriptionsDifferentFromNameRule,t}return t=h,(i=[{key:"validateNonBodyParameter",value:function(e,t){if(Object(r.a)(e))return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Description,propertyDisplayName:n.c(this.clientResources).Description});return this.validateDescription(e.description,e.name,e[s.i.Summary],null,i)}},{key:"validateOperation",value:function(e,t){if(Object(r.a)(e)||Object(r.a)(e.operation))return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.OperationDescription,propertyDisplayName:n.c(this.clientResources).Description});return this.validateDescription(e.operation.description,null,e.operation.summary,null,i)}},{key:"validateSchemaProperty",value:function(e,t){if(Object(r.a)(e))return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:n.d.Description,subPathDisplayName:n.c(this.clientResources).Description});return this.validateDescription(e.description,e.name,null,e.leafTitle,i)}},{key:"validateDescription",value:function(e,t,i,r,n){var a=[];return Object(l.a)(e)||(e===t&&a.push(o.b(this,this.clientResources.Validate.CustomApi.Results.DescriptionsDifferentFromNameRule.SameAsName,n)),e===i&&a.push(o.b(this,this.clientResources.Validate.CustomApi.Results.DescriptionsDifferentFromNameRule.SameAsSummary,n)),e===r&&a.push(o.b(this,this.clientResources.Validate.CustomApi.Results.DescriptionsDifferentFromNameRule.SameAsTitle,n))),a}}])&&c(t.prototype,i),a&&c(t,a),Object.defineProperty(t,"prototype",{writable:!1}),h}(a.a)},33957:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(33359),l=i(13083);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(h,e);var t,i,a,u=p(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=u.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.InternalRequiredFieldsHaveDefaultsRule,t}return t=h,(i=[{key:"validateNonBodyParameter",value:function(e,t){var i=[];if(Object(r.a)(e)||e[s.i.NotificationUrl])return i;if(e.required&&e[s.i.Visibility]===s.l.internal&&Object(l.a)(e.default)){var a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Default,propertyDisplayName:n.c(this.clientResources).Default});i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.InternalRequiredFieldsHaveDefaultsRule.RequiredInternalNoDefault,a))}return i}},{key:"validateSchemaProperty",value:function(e,t){var i=[];if(Object(r.a)(e)||e.isNotificationUrl)return i;if(e.required&&e.visibility===s.l.internal&&Object(l.a)(e.default)){var a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:n.d.Default,subPathDisplayName:n.c(this.clientResources).Default});i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.InternalRequiredFieldsHaveDefaultsRule.RequiredInternalNoDefault,a))}return i}}])&&c(t.prototype,i),a&&c(t,a),Object.defineProperty(t,"prototype",{writable:!1}),h}(a.a)},33958:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(33359);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,a,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.InternalFieldsIsRequiredRule,t}return t=p,(i=[{key:"validateNonBodyParameter",value:function(e,t){var i=[];if(Object(r.a)(e))return i;if(e[s.i.Visibility]===s.l.internal&&!e.required&&(e["x-ms-notification-url"]||e.default)){var a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Required,propertyDisplayName:n.c(this.clientResources).Required});i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.InternalFieldsIsRequiredRule.InternalIsRequired,a))}return i}},{key:"validateSchemaProperty",value:function(e,t){var i=[];if(Object(r.a)(e))return i;if(e.visibility===s.l.internal&&!e.required&&(e.isNotificationUrl||e.default)){var a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:n.d.Required,subPathDisplayName:n.c(this.clientResources).Required});i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.InternalFieldsIsRequiredRule.InternalIsRequired,a))}return i}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),p}(a.a)},33959:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(33800),n=i(33802);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=u(e);if(t){var n=u(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return c(this,i)}}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(u,e);var t,i,a,c=l(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.HeaderNameValidRule,t}return t=u,(i=[{key:"validateNonBodyParameter",value:function(e,t){if(!e||"header"!==e.in||!e.name)return[];if("authorization"===e.name.trim().toLowerCase()){var i=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:r.d.Name,propertyDisplayName:Object(r.c)(this.clientResources).Name});return[n.a(this,this.clientResources.Validate.CustomApi.Results.HeaderNameValidRule.AuthorizationHeaderNotAllowed,i)]}return[]}}])&&o(t.prototype,i),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),u}(i(33953).a)},33960:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(20342);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,a,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ObjectAndArraySchemaHaveCorrectTypeRule,t}return t=p,(i=[{key:"validateUnresolvedSchema",value:function(e,t){var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName});return this.validateUnresolvedSchemaInternal(e,i)}},{key:"validateUnresolvedSchemaInternal",value:function(e,t){var i=[];return Object(r.a)(e)||!Object(r.a)(e.$ref)||(Object(r.a)(e.properties)?Object(r.a)(e.items)||(e.type!==s.f.array&&i.push(o.c(this,this.clientResources.Validate.CustomApi.Results.ObjectAndArraySchemaHaveCorrectTypeRule.ArrayTypeMissing,t)),i=i.concat(this.validateUnresolvedSchemaInternal(e.items,t))):(e.type!==s.f.object&&i.push(o.c(this,this.clientResources.Validate.CustomApi.Results.ObjectAndArraySchemaHaveCorrectTypeRule.ObjectTypeMissing,t)),Object.keys(e.properties).forEach(r=>i=i.concat(this.validateUnresolvedSchemaInternal(e.properties[r],t))))),i}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),p}(a.a)},33961:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(13083);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,a,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.OperationIdsShouldBeProperlyNamedRule,t}return t=p,(i=[{key:"validateOperation",value:function(e,t){var i=[],a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.OperationId,propertyDisplayName:n.c(this.clientResources).OperationID});return Object(r.a)(e)||Object(r.a)(e.operation)||Object(s.a)(e.operation.operationId)||(!1===/^[a-zA-Z0-9-_./ ]*$/.test(e.operation.operationId)&&i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeProperlyNamedRule.NoSpecialCharacters,a)),-1!==e.operation.operationId.indexOf(" ")&&i.push(o.c(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeProperlyNamedRule.NoSpaces,a)),e.operation.operationId.charAt(0)!==e.operation.operationId.charAt(0).toUpperCase()&&i.push(o.b(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeProperlyNamedRule.StartWithUpper,a))),i}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),p}(a.a)},33962:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(13083);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=d(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,i,a,c=h(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=c.call(this,e)).operationIdOccurences=void 0,t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.OperationIdsShouldBeUniqueRule,t}return t=d,(i=[{key:"setSwaggerUsedForValidation",value:function(e){u(g(d.prototype),"setSwaggerUsedForValidation",this).call(this,e),this.operationIdOccurences=this.getOperationIdOccurences()}},{key:"validateOperation",value:function(e,t){var i=[],a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.OperationId,propertyDisplayName:n.c(this.clientResources).OperationID});if(Object(r.a)(e)||Object(r.a)(e.operation)||Object(s.a)(e.operation.operationId))return i;var l=e.operation.operationId.toLowerCase();return this.operationIdOccurences[l]>1&&i.push(o.a(this,this.clientResources.Validate.CustomApi.Results.OperationIdsShouldBeUniqueRule.NotUnique,a)),i}},{key:"getOperationIdOccurences",value:function(){var e=this.swagger.actions.concat(this.swagger.triggers),t={};return e.forEach(e=>{if(!Object(r.a)(e.operation)&&!Object(r.a)(e.operation.operationId)){var i=e.operation.operationId.toLowerCase();t[i]=t[i]?t[i]+1:1}}),t}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),d}(a.a)},33963:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(33800),n=i(33802),o=i(33953),a=i(33359),s=i(13031);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=d(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,i,o,c=h(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=c.call(this,e)).actionsMarkedAsImportant={},t.triggersMarkedAsImportant={},t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.OperationVisibilityCorrectlyMarkedRule,t}return t=d,(i=[{key:"setSwaggerUsedForValidation",value:function(e){u(g(d.prototype),"setSwaggerUsedForValidation",this).call(this,e),this.updateOperationVisibilityCounts()}},{key:"validateOperation",value:function(e,t){var i=[];if(!e||!e.operation)return i;var o=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:"".concat(r.d.Operation).concat(r.d.XMsVisibility),propertyDisplayName:r.c(this.clientResources).Visibility}),a=this.getUniqueOperationKey(e);return Object.keys(this.actionsMarkedAsImportant).length>1&&this.actionsMarkedAsImportant[a]?i.push(n.b(this,Object(s.a)(this.clientResources.Validate.CustomApi.Results.OperationVisibilityCorrectlyMarkedRule.TooManyImportantActions,Object.keys(this.actionsMarkedAsImportant).length,this.getCommaSeparatedStringOfValues(this.actionsMarkedAsImportant,e.operation.operationId)),o)):Object.keys(this.triggersMarkedAsImportant).length>1&&this.triggersMarkedAsImportant[a]&&i.push(n.b(this,Object(s.a)(this.clientResources.Validate.CustomApi.Results.OperationVisibilityCorrectlyMarkedRule.TooManyImportantTriggers,Object.keys(this.triggersMarkedAsImportant).length,this.getCommaSeparatedStringOfValues(this.triggersMarkedAsImportant,e.operation.operationId)),o)),i}},{key:"updateOperationVisibilityCounts",value:function(){this.actionsMarkedAsImportant={},this.triggersMarkedAsImportant={},Array.isArray(this.swagger.actions)&&this.swagger.actions.forEach(e=>{e.operation&&e.operation[a.i.Visibility]===a.l.important&&(this.actionsMarkedAsImportant[this.getUniqueOperationKey(e)]=e.operation.operationId)}),Array.isArray(this.swagger.triggers)&&this.swagger.triggers.forEach(e=>{e.operation&&e.operation[a.i.Visibility]===a.l.important&&(this.triggersMarkedAsImportant[this.getUniqueOperationKey(e)]=e.operation.operationId)})}},{key:"getUniqueOperationKey",value:function(e){return"".concat(e.method).concat(e.path)}},{key:"getCommaSeparatedStringOfValues",value:function(e,t){return Object.keys(e).map(t=>e[t]).filter(e=>e!==t).join(", ").trim()}}])&&l(t.prototype,i),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.a)},33964:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(33800),n=i(33802),o=i(33953),a=i(12330),s=i(33801),l=i(15548),c=i(12324);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,i,o,d=h(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=d.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ParameterDefaultValueTypeRule,t}return t=m,(i=[{key:"validateNonBodyParameter",value:function(e,t){var i=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:r.d.Default,propertyDisplayName:r.c(this.clientResources).Default});return this.validateDefaultValueType(e,i)}},{key:"validateSchemaProperty",value:function(e,t){var i=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:r.d.Default,subPathDisplayName:r.c(this.clientResources).Default});return this.validateDefaultValueType(e,i)}},{key:"validateDefaultValueType",value:function(e,t){if(Object(a.a)(e)||Object(c.isEmpty)(e.default))return[];var i="".concat(e.default);if(["string","file","object"].includes(e.type))return[];var r=Object(s.d)(i);return e.type===r||"integer"===r&&"number"===e.type?[]:[n.a(this,Object(l.a)(this.clientResources.Validate.CustomApi.Results.ParameterDefaultValueTypeRule.ValueDoesNotMatchType,e.type),t)]}}])&&u(t.prototype,i),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),m}(o.a)},33965:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(15548);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=d(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,i,a,c=h(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=c.call(this,e)).operationPathMap=void 0,t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.PathAndMethodAreUniqueRule,t}return t=d,(i=[{key:"setSwaggerUsedForValidation",value:function(e){u(g(d.prototype),"setSwaggerUsedForValidation",this).call(this,e),this.operationPathMap=this.getOperationPathMap()}},{key:"validateOperation",value:function(e,t){var i=[];if(Object(r.a)(e)||Object(r.a)(e.operation))return i;var a="".concat(e.path).concat(e.method).toLowerCase();if(this.operationPathMap[a].length<2)return i;var l=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Path,propertyDisplayName:n.c(this.clientResources).URL});return i.push(o.a(this,Object(s.a)(this.clientResources.Validate.CustomApi.Results.PathAndMethodAreUniqueRule.PathAndMethodNotUnique,this.operationPathMap[a].length,this.operationPathMap[a].join(", ").trim()),l)),i}},{key:"getOperationPathMap",value:function(){var e=this.swagger.actions.concat(this.swagger.triggers),t={};return e.forEach(e=>{if(!Object(r.a)(e.operation)){var i="".concat(e.path).concat(e.method).toLowerCase();t[i]||(t[i]=[]),t[i].push(e.operation.operationId)}}),t}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),d}(a.a)},33966:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(12330),n=i(33357),o=i(33801),a=i(33800),s=i(33802),l=i(33953),c=i(20342),u=i(13031);function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=f(e);if(t){var n=f(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return g(this,i)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(g,e);var t,i,l,p=m(g);function g(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=p.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.PathInSyncWithParametersRule,t}return t=g,(i=[{key:"validateOperation",value:function(e,t){var i=[];if(Object(r.a)(e)||Object(r.a)(e.operation))return i;var l=o.c(e.path),c=this.getAllPathParameterNameIndexPairs(e.operation.parameters);return l.forEach(e=>{if(Object(r.a)(c[e])){var n=new a.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:a.d.Path,propertyDisplayName:a.c(this.clientResources).URL});i.push(s.a(this,Object(u.a)(this.clientResources.Validate.CustomApi.Results.PathInSyncWithParametersRule.ReferenceNotFound,e),n))}}),Object.keys(c).forEach(r=>{if(l.indexOf(r)<0){var o=c[r],d=e.operation.parameters[o],p=new a.i({itemPath:"".concat(t.itemPath).concat(a.d.OperationParameters,"[").concat(o,"]").concat(a.d.Item),itemDisplayName:s.f(d,this.swagger,this.clientResources),propertyPath:a.d.Path,propertyDisplayName:a.c(this.clientResources).URL});if(n.G(d)){var h=d.$ref.split("/"),m=this.swagger.parameters.map(e=>e.name).indexOf(h[h.length-1]);p.swaggerItem.itemPath="".concat(a.d.Parameters,"[").concat(m,"]").concat(a.d.Item),i.push(s.a(this,Object(u.a)(this.clientResources.Validate.CustomApi.Results.PathInSyncWithParametersRule.ReferenceParameterNotUsedInPath,e.operation.operationId),p))}else i.push(s.a(this,Object(u.a)(this.clientResources.Validate.CustomApi.Results.PathInSyncWithParametersRule.InlineParameterNotUsedInPath,r),p))}}),i}},{key:"getAllPathParameterNameIndexPairs",value:function(e){var t={};return e?(n.u(e,this.swagger).forEach((e,i)=>{e.in===c.e.path&&(t[e.name]=i)}),t):t}}])&&d(t.prototype,i),l&&d(t,l),Object.defineProperty(t,"prototype",{writable:!1}),g}(l.a)},33967:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(12330),n=i(33800),o=i(33802);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=d(e);if(t){var n=d(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return u(this,i)}}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(d,e);var t,i,s,u=c(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=u.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.PathParameterMarkedAsRequiredRule,t}return t=d,(i=[{key:"validateNonBodyParameter",value:function(e,t){if(Object(r.a)(e)||"path"!==e.in||e.required)return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Required,propertyDisplayName:n.c(this.clientResources).Required});return[o.a(this,this.clientResources.Validate.CustomApi.Results.PathParameterMarkedAsRequiredRule.NotMarkedAsRequired,i)]}}])&&a(t.prototype,i),s&&a(t,s),Object.defineProperty(t,"prototype",{writable:!1}),d}(i(33953).a)},33968:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(33359);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,a,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReadOnlyRequiredParametersNotAllowedRule,t}return t=p,(i=[{key:"validateNonBodyParameter",value:function(e,t){if(Object(r.a)(e)||!e.required||e[s.i.Permission]!==s.f.readOnly)return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Required,propertyDisplayName:n.c(this.clientResources).Required});return[o.c(this,this.clientResources.Validate.CustomApi.Results.ReadOnlyRequiredParametersNotAllowedRule.RequiredAndReadOnly,i)]}},{key:"validateSchemaProperty",value:function(e,t){if(Object(r.a)(e)||!e.required||!e.readOnly)return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:n.d.Required,subPathDisplayName:n.c(this.clientResources).Required});return[o.c(this,this.clientResources.Validate.CustomApi.Results.ReadOnlyRequiredParametersNotAllowedRule.RequiredAndReadOnly,i)]}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),p}(a.a)},33969:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(15548);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=d(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,i,a,c=h(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=c.call(this,e)).referenceCount=void 0,t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReferenceNameUniqueRule,t}return t=d,(i=[{key:"setSwaggerUsedForValidation",value:function(e){u(g(d.prototype),"setSwaggerUsedForValidation",this).call(this,e),this.referenceCount=this.getReferencesCount()}},{key:"validateDefinitionItem",value:function(e,t){if(Object(r.a)(e))return[];var i="#/definitions/".concat(e.name);return this.validateReference(i,e.name,this.clientResources.Validate.CustomApi.Results.ReferenceNameUniqueRule.DefinitionNameNotUnique,t)}},{key:"validateResponseDefinitionItem",value:function(e,t){if(Object(r.a)(e))return[];var i="#/responses/".concat(e.name);return this.validateReference(i,e.name,this.clientResources.Validate.CustomApi.Results.ReferenceNameUniqueRule.ResponseDefinitionNameNotUnique,t)}},{key:"validateParameterDefinitionItem",value:function(e,t){if(Object(r.a)(e))return[];var i="#/parameters/".concat(e.name);return this.validateReference(i,e.name,this.clientResources.Validate.CustomApi.Results.ReferenceNameUniqueRule.ParameterDefinitionNameNotUnique,t)}},{key:"validateReference",value:function(e,t,i,r){var a=[];if(1===this.referenceCount[e])return a;var l=new n.i({itemPath:r.itemPath,itemDisplayName:r.itemDisplayName,propertyPath:n.d.Name,propertyDisplayName:n.c(this.clientResources).Name});return a.push(o.a(this,Object(s.a)(i,t,this.referenceCount[e]),l)),a}},{key:"getReferencesCount",value:function(){var e={};return Array.isArray(this.swagger.definitions)&&this.swagger.definitions.forEach(t=>{var i="#/definitions/".concat(t.name);e[i]=Object(r.a)(e[i])?1:e[i]+1}),Array.isArray(this.swagger.responses)&&this.swagger.responses.forEach(t=>{var i="#/responses/".concat(t.name);e[i]=Object(r.a)(e[i])?1:e[i]+1}),Array.isArray(this.swagger.parameters)&&this.swagger.parameters.forEach(t=>{var i="#/parameters/".concat(t.name);e[i]=Object(r.a)(e[i])?1:e[i]+1}),e}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),d}(a.a)},33970:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(33800),n=i(33802),o=i(33953),a=i(33360);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=p(e);if(t){var n=p(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return d(this,i)}}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,i,o,l=u(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=l.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReferencesFullyResolvedRule,t}return t=d,(i=[{key:"validateResolvedSchema",value:function(e,t){return this.isSchemaUnresolved(e)?[n.c(this,this.clientResources.Validate.CustomApi.Results.UnableToResolveSchema,new r.i(t))]:[]}},{key:"isSchemaUnresolved",value:function(e){return!e||Object(a.m)(e,"$ref")}}])&&s(t.prototype,i),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.a)},33971:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(13031),n=i(33361),o=i(33800),a=i(33802);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=u(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(h,e);var t,i,l,u=p(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=u.call(this,e)).validReferences=[],t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ReferencesExistRule,t}return t=h,(i=[{key:"setSwaggerUsedForValidation",value:function(e){c(m(h.prototype),"setSwaggerUsedForValidation",this).call(this,e),this.setValidReferences()}},{key:"validateJsonReference",value:function(e,t){return this.checkIfReferencesAreValid(e,t)}},{key:"validateUnresolvedSchema",value:function(e,t){return this.checkIfReferencesAreValid(e,t)}},{key:"checkIfReferencesAreValid",value:function(e,t){var i=[];return e?(Object.keys(Object(n.a)(e)).forEach(e=>{if(this.validReferences.indexOf(e)<0){var n=new o.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName});i.push(a.a(this,Object(r.a)(this.clientResources.Validate.CustomApi.Results.ReferencesExistRule.ReferenceNotFound,e),n))}}),i):i}},{key:"setValidReferences",value:function(){this.validReferences=[],this.swagger&&(Array.isArray(this.swagger.definitions)&&this.swagger.definitions.forEach(e=>{this.validReferences.push("#/definitions/".concat(e.name))}),Array.isArray(this.swagger.parameters)&&this.swagger.parameters.forEach(e=>{this.validReferences.push("#/parameters/".concat(e.name))}),Array.isArray(this.swagger.responses)&&this.swagger.responses.forEach(e=>{this.validReferences.push("#/responses/".concat(e.name))}))}}])&&s(t.prototype,i),l&&s(t,l),Object.defineProperty(t,"prototype",{writable:!1}),h}(i(33953).a)},33972:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(20342),l=i(13083),c=i(13031);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,i,a,d=h(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=d.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.RequiredFieldsExistRule,t}return t=m,(i=[{key:"validateNonBodyParameter",value:function(e,t){var i=[];if(Object(r.a)(e))return i;if(Object(l.a)(e.name)){var a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Name,propertyDisplayName:n.c(this.clientResources).Name});i.push(o.a(this,this.constructValidationMessage(n.c(this.clientResources).Name),a))}if(Object(l.a)(e.type)){var s=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Type,propertyDisplayName:n.c(this.clientResources).Type});i.push(o.a(this,this.constructValidationMessage(n.c(this.clientResources).Type),s))}return i}},{key:"validateOperation",value:function(e,t){var i=[];if(Object(r.a)(e))return i;if(Object(l.a)(e.operation.operationId)){var a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.OperationId,propertyDisplayName:n.c(this.clientResources).OperationID});i.push(o.a(this,this.constructValidationMessage(n.c(this.clientResources).OperationID),a))}if(Object(l.a)(e.path)){var s=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Path,propertyDisplayName:n.c(this.clientResources).URL});i.push(o.a(this,this.constructValidationMessage(n.c(this.clientResources).Path),s))}if(Object(l.a)(e.operation.summary)){var c=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.OperationSummary,propertyDisplayName:n.c(this.clientResources).Summary});i.push(o.b(this,this.constructValidationMessage(n.c(this.clientResources).Summary),c))}if(Object(l.a)(e.operation.description)){var u=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.OperationDescription,propertyDisplayName:n.c(this.clientResources).Description});i.push(o.b(this,this.constructValidationMessage(n.c(this.clientResources).Description),u))}return i}},{key:"validateSchemaProperty",value:function(e,t){var i=[];if(Object(r.a)(e))return i;if(e.type===s.f.any){var a=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:n.d.Type,subPathDisplayName:n.c(this.clientResources).Type});i.push(o.c(this,this.constructValidationMessage(n.c(this.clientResources).Type),a))}return i}},{key:"validateDefinitionItem",value:function(e,t){return this.validateDefinitionItemName(e,t)}},{key:"validateResponseDefinitionItem",value:function(e,t){return this.validateDefinitionItemName(e,t)}},{key:"validateParameterDefinitionItem",value:function(e,t){return this.validateDefinitionItemName(e,t)}},{key:"validateDefinitionItemName",value:function(e,t){if(Object(r.a)(e)||!Object(l.a)(e.name))return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Name,propertyDisplayName:n.c(this.clientResources).Name});return[o.a(this,this.constructValidationMessage(n.c(this.clientResources).Name),i)]}},{key:"constructValidationMessage",value:function(e){return Object(c.a)(this.clientResources.Validate.CustomApi.Results.RequiredFieldsExistRule.NotDefined,e)}}])&&u(t.prototype,i),a&&u(t,a),Object.defineProperty(t,"prototype",{writable:!1}),m}(a.a)},33973:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(15548);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,a,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).referenceCount=void 0,t.ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.ResponseNameValidRule,t}return t=p,(i=[{key:"validateInlineResponseDefinitionItem",value:function(e,t){return this.validateResponseName(e,t)}},{key:"validateResponseName",value:function(e,t){if(Object(r.a)(e)||Object(r.a)(e.name)||"default"===e.name||Number(e.name)>=100&&Number(e.name)<600)return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.Name,propertyDisplayName:n.c(this.clientResources).Name});return[o.a(this,Object(s.a)(this.clientResources.Validate.CustomApi.Results.ResponseNameValidRule.ResponseNameInvalid,e.name),i)]}}])&&l(t.prototype,i),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),p}(a.a)},33974:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(12330),n=i(33800),o=i(33802),a=i(33953),s=i(33359),l=i(15548),c=i(13083),u=i(14883);function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=f(e);if(t){var n=f(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return g(this,i)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(g,e);var t,i,a,p=m(g);function g(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=p.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.SummariesShouldBeProperlyNamedRule,t}return t=g,(i=[{key:"validateNonBodyParameter",value:function(e,t){if(Object(r.a)(e))return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.XMsSummary,propertyDisplayName:n.c(this.clientResources).Summary});return this.validateSummary(e[s.i.Summary],i,n.c(this.clientResources).Summary)}},{key:"validateOperation",value:function(e,t){if(Object(r.a)(e)||Object(r.a)(e.operation))return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:n.d.OperationSummary,propertyDisplayName:n.c(this.clientResources).Summary});return this.validateSummary(e.operation.summary,i,n.c(this.clientResources).Summary)}},{key:"validateSchemaProperty",value:function(e,t){if(Object(r.a)(e))return[];var i=new n.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:t.propertyPath,propertyDisplayName:t.propertyDisplayName},{schemaProperty:e,subPath:n.d.Title,subPathDisplayName:n.c(this.clientResources).Title});return this.validateSummary(e.leafTitle,i,n.c(this.clientResources).Title)}},{key:"validateSummary",value:function(e,t,i){var r=[];if(Object(c.a)(e))return r;Object(u.d)(e.trim(),".")&&r.push(o.b(this,Object(l.a)(this.clientResources.Validate.CustomApi.Results.SummariesShouldBeProperlyNamedRule.Period,i),t));var n=e.trim().charAt(0);return n!==n.toUpperCase()&&r.push(o.b(this,Object(l.a)(this.clientResources.Validate.CustomApi.Results.SummariesShouldBeProperlyNamedRule.DoesNotStartUpper,i),t)),r}}])&&d(t.prototype,i),a&&d(t,a),Object.defineProperty(t,"prototype",{writable:!1}),g}(a.a)},33975:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(33800),n=i(33802),o=i(33953),a=i(33359),s=i(13031);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,i,o,c=d(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.WebhookNotificationContentRule,t}return t=p,(i=[{key:"validateOperation",value:function(e,t){if(!e||!e.operation||!e.operation.hasOwnProperty(a.i.NotificationContent))return[];var i=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:"".concat(r.d.Operation).concat(r.d.XMsNotificationContent),propertyDisplayName:r.c(this.clientResources).WebhookResponse});return[n.c(this,Object(s.a)(this.clientResources.Validate.CustomApi.Results.WebhookNotificationContentRule.WrongLocation,e.path,e.method),i)]}}])&&l(t.prototype,i),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),p}(o.a)},33976:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(33800),n=i(33802),o=i(33953),a=i(33359),s=i(33363),l=i(33357),c=i(20342);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,i,o,d=h(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=d.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.WebhookNotificationParamInternalRequiredRule,t}return t=m,(i=[{key:"validateOperation",value:function(e,t){var i=[];if(!e||!e.operation||e.operation[a.i.Trigger]!==a.j.Single||!e.hasOwnProperty(a.i.NotificationContent))return i;var o=!1,u=Object(l.t)(e.operation.parameters,this.swagger),d=u.filter(e=>e.in!==c.e.body),p=d?d.filter(e=>e[a.i.NotificationUrl])[0]:null;if(p&&(o=this.validateWebhookParamSpec(p[a.i.Visibility],p.required)),!o){var h=u.filter(e=>e.in===c.e.body)[0];if(h){var m=Object(s.c)(h.schema),g=m?m.filter(e=>e.isNotificationUrl)[0]:null;g&&(o=this.validateWebhookParamSpec(g.visibility,g.required))}}if(o){var f=new r.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:"".concat(r.d.Operation),propertyDisplayName:Object(r.c)(this.clientResources).TriggerConfiguration});i.push(n.a(this,this.clientResources.Validate.CustomApi.Results.WebhookNotificationParamInternalRequiredRule.WebhookNotificationParamInternalRequired,f))}return i}},{key:"validateWebhookParamSpec",value:function(e,t){return!(e===a.l.internal&&t)}}])&&u(t.prototype,i),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),m}(o.a)},33977:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(20342),n=i(13031),o=i(33359),a=i(33800),s=i(33363),l=i(33357),c=i(33802);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(g,e);var t,i,d,m=h(g);function g(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=m.call(this,e)).ruleDescription=t.clientResources.Validate.CustomApi.RuleDescriptions.WebhookSingleNotificationUrlRequiredRule,t}return t=g,(i=[{key:"validateOperation",value:function(e,t){if(!e||!e.operation||e.operation[o.i.Trigger]!==o.j.Single||!e.hasOwnProperty(o.i.NotificationContent))return[];var i=Object(l.t)(e.operation.parameters,this.swagger),u=i.filter(e=>e.in!==r.e.body),d=u?u.filter(e=>e[o.i.NotificationUrl]).length:0,p=i.filter(e=>e.in===r.e.body)[0];if(p&&(d+=Object(s.c)(p.schema).filter(e=>e.isNotificationUrl).length),0===d){var h=new a.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:"".concat(a.d.Operation),propertyDisplayName:Object(a.c)(this.clientResources).TriggerConfiguration});return[Object(c.a)(this,this.clientResources.Validate.CustomApi.Results.WebhookSingleNotificationUrlRequiredRule.None,h)]}if(d>1){var m=new a.i({itemPath:t.itemPath,itemDisplayName:t.itemDisplayName,propertyPath:"".concat(a.d.Operation),propertyDisplayName:Object(a.c)(this.clientResources).TriggerConfiguration});return[Object(c.c)(this,Object(n.a)(this.clientResources.Validate.CustomApi.Results.WebhookSingleNotificationUrlRequiredRule.MoreThanOne,d),m)]}return[]}}])&&u(t.prototype,i),d&&u(t,d),Object.defineProperty(t,"prototype",{writable:!1}),g}(i(33953).a)},33978:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(11891),a=i(33847),s=i(33800),l=i(14868),c=i(14876),u=i(13083),d=i(33822),p=i(33936),h=i(13031);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=["connection","content-length","host","keep-alive","transfer-encoding"],v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.resultCollection=void 0,this.validateApiKeyLabel=e=>{var t=new s.h;return t.add(this.verifyRequiredValueIsDefined(e.apiKeyLabel)),t},this.validateApiKeyName=e=>{var t=new s.h;return t.add(this.verifyRequiredValueIsDefined(e.apiKeyName)),"header"===e.selectedApiKeyLocation&&t.add(this.verifyHeaderNameIsAllowed(e.apiKeyName)),t},this.verifyRequiredUrl=e=>{var t=new s.h;return t.add(this.verifyRequiredValueIsDefined(e)),t.add(this.verifyValueIsUrlFormat(e)),t},this.verifyRequiredValueIsDefined=e=>(Object(c.a)(e)||Object(u.a)(e))&&s.h.Error(this.clientResources.Manage.CustomApi.SecurityValidation.CannotBeEmpty),this.verifyValueIsUrlFormat=e=>{var t=(e||"").trim();return!Object(c.a)(t)&&!(t.startsWith("https://")&&t.length>"https://".length)&&!(t.startsWith("http://")&&t.length>"http://".length)&&s.h.Warning(this.clientResources.Manage.CustomApi.SecurityValidation.InvalidUrl)},this.resultCollection=new s.h}var t,i,r;return t=e,(i=[{key:"validate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.resultCollection.clear(),e&&!e.isLocked)if(t)for(var i of(0===e.selectedAuthenticationTypes.length&&this.resultCollection.add(s.g.Error(this.clientResources.Manage.CustomApi.SecurityValidation.NoAuthenticationSelected)),e.selectedAuthenticationTypes))switch(i){case l.b.Basic:this.resultCollection.add(this.validateBasicAuthV2(e));break;case l.b.Oauth2:this.resultCollection.add(this.validateOAuthV2(e));break;case l.b.ApiKey:this.resultCollection.add(this.validateApiKey(e))}else switch(e.selectedAuthenticationType){case l.b.Basic:case l.b.Oauth2:this.resultCollection.add(this.validateBasicOrOAuth(e));break;case l.b.ApiKey:this.resultCollection.add(this.validateApiKey(e))}}},{key:"shouldSkipValidateAADClientSecret",value:function(e,t,i){return o.a(e,"clientsecret")&&o.a(t,a.a.AAD)&&i}},{key:"validateOAuthV2",value:function(e){var t=new s.h,i=e.oAuthFormItemValues,r=e.cache.identityProviderParameters[e.selectedIdentityProviderId];if(r){var n=Object(p.b)(r);Object.keys(n).forEach(r=>{if(!this.shouldSkipValidateAADClientSecret(r,e.selectedIdentityProviderId,!!e.useManagedIdentity)){var o=n[r],a=i[r.toLowerCase()],s=this.getConnectionFormItemValidator(o);s&&t.add(s(a))}})}return t}},{key:"validateBasicOrOAuth",value:function(e){var t=new s.h,i=e.authenticationFormItems;return Object.keys(i||{}).forEach(r=>{if(!this.shouldSkipValidateAADClientSecret(r,e.selectedIdentityProviderId,!!e.useManagedIdentity)){var n=i[r],o=this.getConnectionFormItemValidator(n);o&&t.add(o(n.value))}}),t}},{key:"getConnectionFormItemValidator",value:function(e,t){var i=e.displayName.endsWith("URL")&&("aad"!==t||"Resource URL"!==e.displayName);return e.required&&i?this.verifyRequiredUrl:e.required?this.verifyRequiredValueIsDefined:i?this.verifyValueIsUrlFormat:void 0}},{key:"validateBasicAuthV2",value:function(e){var t=new s.h;return t.add(this.verifyRequiredValueIsDefined(e.basicAuthFormItems.usernameLabel)),t.add(this.verifyRequiredValueIsDefined(e.basicAuthFormItems.passwordLabel)),t}},{key:"validateApiKey",value:function(e){var t=new s.h;return t.add(this.validateApiKeyLabel(e)),t.add(this.validateApiKeyName(e)),t}},{key:"verifyHeaderNameIsAllowed",value:function(e){return new RegExp(d.a).test(e)?(f.forEach(i=>{o.a(e,i)&&(t=s.g.Error(this.clientResources.Manage.CustomApi.SecurityValidation.HeaderNotAllowed))}),t):s.g.Error(Object(h.a)(this.clientResources.Manage.CustomApi.SecurityValidation.HeaderDoesNotMatchRegex,d.a));var t}}])&&m(t.prototype,i),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.factory(n.a.services.securityDetailsValidationService,[n.a.services.clientResources,e=>new v(e)])},33979:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33800),a=i(15520),s=i(13083),l=i(33376);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.resultCollection=void 0,this.resultCollection=new o.h}var t,i,r;return t=e,(i=[{key:"validate",value:function(e){var t,i;this.resultCollection.clear(),Object(l.a)()&&this.resultCollection.add(this.validatePluginManifestEmail(null!==(t=null==e||null===(i=e["x-ms-openai-manifest"])||void 0===i?void 0:i.contactEmail)&&void 0!==t?t:""))}},{key:"validatePluginManifestEmail",value:function(e){var t=new o.h;return void 0===e||Object(s.a)(e)||Object(a.b)(e)||t.add(o.h.Error(this.clientResources.SignUp.Error.invalidEmail)),t}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.a.factory(n.a.services.copilotPluginValidationService,[n.a.services.clientResources,e=>new d(e)])},33980:function(e,t,i){"use strict";i(33981),i(34123),i(34140),i(34145),i(34168)},33981:function(e,t,i){"use strict";i(33424),i(33491),i(33982),i(33986),i(33991),i(33995),i(33999),i(34003),i(34004),i(34010),i(34012),i(34066),i(34074),i(34077),i(34084),i(34086),i(34089),i(34093),i(34098),i(34101),i(34107),i(34112),i(34116),i(33512),i(34120)},33982:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33983);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33984);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33985),this.controller=o.a,this.controllerAs="zeroFlowRunsCtrl",this.bindings={filter:"="}}));r.a.component(n.a.components.zeroFlowRuns,new c)},33983:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33390);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function a(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=a((function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.assetService=i,this.loggingService=r,this.filter=void 0,this.image=void 0,this.heading=void 0,this.description=void 0,this.$onInit=()=>{this.filter===n.a.failedRuns?(this.image=this.assetService.flowsZeroFailures,this.heading=this.clientResources.FlowRun.No.Failure.Heading,this.description=this.clientResources.FlowRun.No.Failure.Description):(this.image=this.assetService.flowsZeroRuns,this.heading=this.clientResources.FlowRun.No.Runs.Heading,this.description=this.clientResources.FlowRun.No.Runs.Description)},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ZeroFlowRunsCtrl"})}));l.$inject=[r.a.services.clientResources,r.a.services.assetService,r.a.services.logging]},33984:function(e,t,i){e.exports=i.p+"static/media/zeroFlowRuns.786e7fd4.less"},33985:function(e,t){e.exports='<div class="context-manage-zeroflowruns">\n    <div class="row">\n        <div class="column medium-4 medium-offset-4">\n            <img cdn-src="{{zeroFlowRunsCtrl.image}}" alt="{{zeroFlowRunsCtrl.zeroFlowRunsHeading}}" />\n        </div>\n    </div>\n    <div class="row">\n        <div class="column medium-6 medium-offset-3">\n            <h2 class="c-heading-1">{{zeroFlowRunsCtrl.heading}}</h2>\n            <p class="c-paragraph-1">{{zeroFlowRunsCtrl.description}}</p>\n        </div>\n    </div>\n</div>'},33986:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33987);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33989);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33990),this.bindings={flowName:"<"},this.controller=o.a,this.controllerAs="zeroFlowRunsSlideInPaneCtrl"}));r.a.component(n.a.components.zeroFlowRunsSlideInPane,new c)},33987:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var r=i(33327),n=i(33353),o=i(33394),a=i(33360),s=i(33415),l=i(33458),c=i(16927),u=i(14835),d=i(33419),p=i(33396),h=i(33988),m=i(33355),g=i(33383),f=i(33392),v=i(14877);function b(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function y(e,t,i){return t&&b(e.prototype,t),i&&b(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var C=y((function e(){S(this,e),this.flowCreationTime=void 0,this.flowStatus=void 0,this.lastChecked=void 0,this.name=void 0,this.apiDefinitionName=void 0,this.frequency=void 0,this.iconUri=void 0})),k=function(){function e(t,i,r,n,o,a,s,l,c,u){S(this,e),this.$scope=t,this.clientResources=i,this.dateTimeService=r,this.flowConnectionsClient=n,this.flowTriggerHistoriesClient=o,this.flowTriggerClient=a,this.flowsClient=s,this.loggingService=l,this.environmentService=c,this.assetService=u,this.flowtriggerDetails=void 0,this.flowTrigger=void 0,this.showSlideInPane=!0,this.flowName=void 0,this.statusAlert=void 0,this.isManualTrigger=void 0,this.paneSpinner={size:g.c.Large,show:!0,local:g.a.Local},this.$onInit=()=>{this.getFlowTriggerDetails()},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ZeroFlowRunsSlideInPaneCtrl"})}return y(e,[{key:"getFlowTriggerDetails",value:function(){var e=this.loggingService.profileStart(m.a.zeroFlowRunsInfoPaneGetStart);this.flowtriggerDetails=new C,this.paneSpinner.show=!0;var t=this.flowsClient.get(this.$scope,{id:Object(p.b)(this.flowName,this.environmentService)});t.$promise.then(()=>{var e=t.properties&&t.properties.definition,i=Object.keys(e.triggers);if(i&&i.length>0){var r=Object(u.y)(t),n=Object(l.a)(r,t);this.flowtriggerDetails.iconUri=Object(d.c)(Object(u.v)(t),this.assetService.trigger,t.properties.connectionReferences,this.assetService,this.clientResources).iconUri,this.flowtriggerDetails.apiDefinitionName=this.getFlowTriggerApiDefinitionDisplayName(n),this.flowtriggerDetails.name=this.getFlowTriggerName(r);var a=e.triggers[r]&&e.triggers[r].recurrence;return this.flowtriggerDetails.frequency=this.getFlowTriggerRecurrence(a),this.flowTriggerClient.get(this.$scope,{id:Object(h.a)(this.flowName,r,this.environmentService)})}throw new o.a(o.c.invalidFlowDefinition,this.clientResources.FlowRuns.Errors.InvalidFlowDefinition,null,{flowName:t.name})}).then(e=>e.$refresh().then(()=>e)).then(e=>{var i=e.properties,r=i&&i.createdTime;return this.flowtriggerDetails.flowCreationTime=this.dateTimeService.getTimeAtDateTimeString(Object(c.a)(r)),this.flowtriggerDetails.lastChecked=this.getLastExecutionTime(i),this.flowTriggerHistoriesClient.query(this.$scope,{flowName:t.name,flowTriggerName:Object(u.y)(t)}).$promise}).then(t=>{this.flowtriggerDetails.flowStatus=this.getFlowTriggerStatus(t),this.loggingService.profileEndWithSuccess(e,m.a.zeroFlowRunsInfoPaneGetEnd)}).catch(t=>{this.loggingService.profileEnd(e,m.a.zeroFlowRunsInfoPaneGetEnd,f.a.Failure,t),this.showErrorAlert(Object(f.e)(t,this.clientResources.Common.SomethingWentWrong))}).finally(()=>{this.paneSpinner.show=!1})}},{key:"showErrorAlert",value:function(e){this.statusAlert.type=n.a.Error,this.statusAlert.message=e}},{key:"getFlowTriggerRecurrence",value:function(e){var t=e&&e.frequency,i=e.interval,r=Object(s.e)(this.clientResources.DateTime,!1),n=Object(s.d)(r,t,i);return Object(a.d)(this.clientResources.FlowRun.No.Runs.TriggerFrequency.Description,i,n)}},{key:"getFlowTriggerApiDefinitionDisplayName",value:function(e){var t=e&&e.apiDefinition&&e.apiDefinition.properties&&e.apiDefinition.properties.displayName;return t?Object(a.d)(this.clientResources.FlowRun.No.Runs.TriggerKind.Text,t):null}},{key:"getFlowTriggerName",value:function(e){return Object(a.d)(this.clientResources.FlowRun.No.Runs.TriggerName.Text,Object(u.w)(e))}},{key:"getFlowTriggerStatus",value:function(e){var t=e.filter(e=>Object(v.m)(e));return 0===e.length?this.clientResources.FlowRun.No.Runs.NeverRun:0===t.length?this.clientResources.FlowRun.No.Runs.Trigger.Failed:this.clientResources.FlowRun.No.Runs.Trigger.Succeeded}},{key:"getLastExecutionTime",value:function(e){var t=e&&e.lastExecutionTime;return t?this.dateTimeService.getTimeAtDateTimeString(Object(c.a)(t)):this.clientResources.FlowRun.No.Runs.NeverRun}}]),e}();k.$inject=[r.a.services.$scope,r.a.services.clientResources,r.a.services.dateTime,r.a.services.flowConnectionsClient,r.a.services.flowTriggerHistoriesClient,r.a.services.flowTriggersClient,r.a.services.flowsClient,r.a.services.logging,r.a.services.environment,r.a.services.assetService]},33988:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33328),n=i(33327),o=i(31433),a=i(33390),s=i(13144),l={urlPath:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/flows/:flowName/triggers"),urlPathWithEnvironmentsFn:e=>"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(e.getCurrentEnvironmentName(),"/flows/:flowName/triggers"),resourceType:"".concat(Object(o.a)().processSimpleResourceProviderPath,"/flows/triggers")},c={listFlowTriggers:6e4,getFlowTriggers:45e3,evictionDelay:3e5};function u(e,t,i){return"".concat(Object(o.a)().processSimpleResourceProviderPath,"/environments/").concat(i.getCurrentEnvironmentName(),"/flows/").concat(e,"/triggers/").concat(t)}r.a.factory(n.a.services.flowTriggersClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,n.a.services.environment,(e,t,i)=>{var r=l.urlPathWithEnvironmentsFn(i),n={urlBase:Object(s.c)(t).flowRP,urlPath:"".concat(r,"/:triggerName/run"),name:"run",method:"POST",params:{flowName:"@flowName",triggerName:"@triggerName"}},o={urlBase:Object(s.c)(t).flowRP,urlPath:"".concat(r,"/:triggerName/run"),name:"runAsTest",method:"POST",params:{flowName:"@flowName",triggerName:"@triggerName"},headers:{[a.n.clientKeywords]:a.l.testFlow}},u={urlBase:Object(s.c)(t).flowRP,urlPath:"".concat(r,"/:triggerName/simulate"),name:"simulate",method:"POST",params:{flowName:"@flowName",triggerName:"@triggerName"},headers:{[a.n.clientKeywords]:a.l.testFlow}};return e({apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,urlBase:Object(s.c)(t).flowRP,urlPath:r,resourceType:l.resourceType,rest:{get:{params:{flowName:"@flowName",id:"@id"}},query:{params:{flowName:"@flowName"}}},actions:[n,o,u],options:{atomize:!1,evictionDelay:c.evictionDelay}})}])},33989:function(e,t,i){e.exports=i.p+"static/media/zeroFlowRunsSlideInPane.f6032fa1.less"},33990:function(e,t){e.exports='<spinner model="zeroFlowRunsSlideInPaneCtrl.paneSpinner"></spinner>\n<div class = "zero-flow-runs-pane-content" ng-if = "!zeroFlowRunsSlideInPaneCtrl.paneSpinner.show">\n    <div class="pane-section">\n      <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.CreatedOn}}</h1>\n      <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.flowCreationTime}}</p>\n    </div>\n    <div class="pane-section">\n      <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.Status}}</h1>\n      <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.flowStatus}}</p>\n    </div>\n    <div class="pane-section">\n      <h1 class="pane-heading trigger-details-label">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.TriggerDetails}}</h1>\n      <div class="info-card-item row">\n        <div class = "info-card-icon">\n          <img ng-attr-src="{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.iconUri}}" />\n        </div>\n        <div class="info-card-text-section column medium-6 small-6">\n          <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.apiDefinitionName}}</h1>\n          <p class="pane-subheading info-card-subtitle">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.name}}</p>\n        </div>\n      </div>\n    </div>\n    <div class="pane-section">\n      <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.TriggerFrequency.Label}}</h1>\n      <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.frequency}}</p>\n    </div>\n    <div class="pane-section">\n      <h1 class="pane-heading">{{zeroFlowRunsSlideInPaneCtrl.clientResources.FlowRun.No.Runs.LastRun}}</h1>\n      <p class="pane-subheading">{{zeroFlowRunsSlideInPaneCtrl.flowtriggerDetails.lastChecked}}</p>\n    </div>\n</div>'},33991:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33992);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33993);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bindings={model:"="},this.controller=o.a,this.controllerAs="submitTemplateCtrl",this.template=i(33994)}));r.a.component(n.a.components.submitTemplate,new c)},33992:function(e,t,i){"use strict";i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return y})),i.d(t,"d",(function(){return S})),i.d(t,"e",(function(){return C})),i.d(t,"a",(function(){return k}));var r=i(33327),n=i(33390),o=i(33353),a=i(33420),s=i(33383),l=i(33437),c=i(33360),u=i(16927),d=i(33392),p=i(33279),h=i(14900),m=i(14685);function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(e){return e[e.Spin=0]="Spin",e[e.RunHistory=1]="RunHistory",e[e.SubmitForm=2]="SubmitForm",e[e.ContainsCustomApis=3]="ContainsCustomApis",e[e.Error=4]="Error",e[e.Success=5]="Success",e}({});function b(e){var t=!1;if(!e||!e.properties||!e.properties.connectionReferences)return t;for(var i of Object.keys(e.properties.connectionReferences)){/.+\.[a-fA-F0-9]+\.[a-fA-F0-9]+/.test(i)&&(t=!0)}return t}function y(e){var t=!1;if(!e||!e.properties||!e.properties.definition)return t;var i=JSON.stringify(e.properties.definition);return/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/.test(i)&&(t=!0),t}function w(e){if(e)return e.sort((e,t)=>Object(u.a)(t.properties.startTime).getTime()-Object(u.a)(e.properties.startTime).getTime())}function S(e){if(e){var t=w(e);for(var i of t)if(i.properties.status!==n.j.running)return i.properties.status===n.j.succeeded}}function C(e,t){if(e&&e.properties&&e.properties.lastModifiedTime){var i=Object(u.a)(e.properties.lastModifiedTime);if(!t)return!0;var r=w(t),o=!0;for(var a of r)if(a.properties.status===n.j.succeeded&&Object(u.a)(a.properties.startTime)>i){o=!1;break}return o}}var k=function(){function e(t,i,r,a,l,c,u,d,p,h,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$scope=i,this.appSettings=r,this.clientResources=a,this.flowRunsClient=l,this.flowsClient=c,this.logging=u,this.telemetry=d,this.templatePublishService=p,this.dateTimeService=h,this.routeCrafter=m,this.maxRunHistoryToLoad=n.k.MaxRunHistoryToLoad,this.maxTitleLength=n.k.MaxTitleLength,this.minDescriptionLength=n.k.MinDescriptionLength,this.maxDescriptionLength=n.k.MaxDescriptionLength,this.modeType=v,this.mode=v.Spin,this.model=void 0,this.paneSpinner={size:s.c.Large,show:!0,local:s.a.Local},this.flowRunsTile=void 0,this.flowRunList=void 0,this.lastModifiedFriendlyTime=void 0,this.flowRunHistoryError=void 0,this.flow=void 0,this.templateTitle=void 0,this.templateDescription=void 0,this.templateCategories=void 0,this.formSubmitSpinner={size:s.c.Large,show:!1,local:s.a.Local},this.errorStatusAlert={type:o.a.Error,message:"",options:{control:{action:()=>this.onClose()}}},this.extendedSubmissionContent={flowBenefits:"",teamBenefits:"",flowRuns:"",customCategory:""},this.$onInit=()=>{this.$q.all([this.loadFlowData(),this.loadRunListData()]).then(()=>{b(this.flow)?this.mode=v.ContainsCustomApis:this.isFlowRunningSuccessfully()?(this.templateTitle=this.flow.properties.displayName,this.templateDescription=this.flow.properties.definition.description,this.templateCategories=this.getTemplateCategories().map(e=>({id:e.id,name:e.name,selected:!1})),this.mode=v.SubmitForm):this.mode=v.RunHistory}).catch(e=>this.showError(e))},this.logging.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"SubmitTemplateCtrl"})}var t,i,r;return t=e,(i=[{key:"getTemplateCategories",value:function(){return[m.a.remoteWork,m.a.approval,m.a.button,m.a.collectData,m.a.email,m.a.eventsAndCalendar,m.a.mobile,m.a.notifications,m.a.productivity,m.a.socialMedia,m.a.sync].map(e=>({id:e,name:this.clientResources.TemplateCategory[e]}))}},{key:"maxTitleErrorMessage",get:function(){return Object(c.d)(this.clientResources.Publish.Invalid.Title.Error,this.maxTitleLength)}},{key:"minDescriptionErrorMessage",get:function(){return Object(c.d)(this.clientResources.Publish.Invalid.Description.ErrorTooShort,this.minDescriptionLength)}},{key:"maxDescriptionErrorMessage",get:function(){return Object(c.d)(this.clientResources.Publish.Invalid.Description.ErrorTooLong,this.maxDescriptionLength)}},{key:"isMode",value:function(e){return this.mode===e}},{key:"onClose",value:function(){this.model.show=!1}},{key:"onSubmit",value:function(e){if(e){this.telemetry.tagEvent(l.a.PublishFlowStarted,{},this.extendedSubmissionContent),this.formSubmitSpinner.show=!0;var t=this.templateCategories.filter(e=>e.selected).map(e=>e.id);this.templatePublishService.submitToPendingGallery({templateTitle:this.templateTitle,templateDescription:this.templateDescription,templateCategories:t,flow:this.flow,extendedSubmissionContent:this.extendedSubmissionContent}).then(()=>this.mode=v.Success).catch(e=>this.showError(e))}}},{key:"loadFlowData",value:function(){var e=this.flowsClient.get(this.$scope,{id:this.model.flow.id});return e.$promise.then(()=>this.flow=e).catch(e=>(this.logging.logError("submitTemplateCtrl.loadFlowData.flowsClient.get",e),this.$q.reject(e)))}},{key:"loadRunListData",value:function(){var e={size:s.c.Small,show:!1},t=this.model.flow.name;this.flowRunsTile={title:this.clientResources.FlowPropertyTile.FlowRunsTile.Title,showAll:!0,showAllLink:Object(h.p)(this.routeCrafter,{flowName:t,solutionId:this.model.solutionId,isLegacyShared:this.model.isShared,isUIFlow:!1}),searchParameters:{backUrl:Object(h.m)(this.routeCrafter,{flowName:t,isLegacyShared:this.model.isShared,solutionId:this.model.solutionId})}};var i={flowName:t,$top:this.maxRunHistoryToLoad};return this.flowRunsClient.refreshQuery(i).then(()=>{var r=this.flowRunsClient.query(this.$scope,i);return this.flowRunList={id:"flowRuns",filter:n.a.allRuns,flowName:t,flowTriggerHistoriesWithRun:void 0,flowRuns:r,flowTriggerHistoryFilter:e=>!0,flowRunFilter:e=>!0,hasMore:()=>!1,isLoadingMore:!1,spinner:e,loadingMoreSpinner:e,loadNextPage:()=>p.noop(),showInTile:!0},r.$promise}).catch(e=>(this.logging.logError("submitTemplateCtrl.loadRunListData.flowRunsClient.query",e),this.$q.reject(e)))}},{key:"isFlowRunningSuccessfully",value:function(){if(this.flow&&this.flow.properties&&this.flow.properties.lastModifiedTime){var e=Object(u.a)(this.flow.properties.lastModifiedTime);this.lastModifiedFriendlyTime=this.dateTimeService.getFriendlyTimeSinceString(a.a,e)}return!1===S(this.flowRunList.flowRuns)?(this.flowRunHistoryError=this.clientResources.TemplateSubmission.Message.LastRunNotSuccessful,!1):!0!==C(this.flow,this.flowRunList.flowRuns)||(this.flowRunHistoryError=this.clientResources.TemplateSubmission.Message.NoSuccessSinceModified,!1)}},{key:"showError",value:function(e){this.errorStatusAlert.message=Object(d.e)(e,this.clientResources.Common.SomethingWentWrong),this.mode=v.Error}}])&&g(t.prototype,i),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();k.$inject=[r.a.services.$q,r.a.services.$scope,r.a.services.appSettings,r.a.services.clientResources,r.a.services.flowRunsClient,r.a.services.flowsClient,r.a.services.logging,r.a.services.telemetry,r.a.services.templatePublish,r.a.services.dateTime,r.a.services.routeCrafter]},33993:function(e,t,i){e.exports=i.p+"static/media/submitTemplate.3c9550db.less"},33994:function(e,t){e.exports='<section class="section-flow-submit-template">\n    <info-pane pane-title="submitTemplateCtrl.clientResources.TemplateSubmission.Action.Name" expanded="submitTemplateCtrl.model.show" on-close="submitTemplateCtrl.onClose()">\n        <spinner model="submitTemplateCtrl.paneSpinner" ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.Spin)"></spinner>\n        <div ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.SubmitForm)">\n            <spinner model="submitTemplateCtrl.formSubmitSpinner" ng-if="submitTemplateCtrl.formSubmitSpinner.show"></spinner>\n            <form name="submitTemplate" ng-submit="submitTemplateCtrl.onSubmit(submitTemplate.$valid)" novalidate>\n                <div>\n                    <label for="submitTemplateTitle" class="c-label template-submission-required">{{::submitTemplateCtrl.clientResources.TemplateSubmission.Title.Label}}</label>\n                    <input id="submitTemplateTitle"\n                        name="title"\n                        type="text"\n                        class="c-input c-text-field submit-input"\n                        ng-model="submitTemplateCtrl.templateTitle"\n                        ng-readonly="submitTemplateCtrl.formSubmitSpinner.show"\n                        ng-attr-placeholder="{{::submitTemplateCtrl.clientResources.TemplateSubmission.Title.Placeholder}}"\n                        required="required"\n                        ng-maxlength="submitTemplateCtrl.maxTitleLength" />\n                    <div class="publish-validation" ng-if="submitTemplate.$submitted || submitTemplate.title.$touched">\n                        <p class="publish-error" ng-if="submitTemplate.title.$error.required">{{::submitTemplateCtrl.clientResources.Publish.Empty.Title.Error}}</p>\n                        <p class="publish-error" ng-if="submitTemplate.title.$error.maxlength">{{submitTemplateCtrl.maxTitleErrorMessage}}</p>\n                    </div>\n                </div>\n                <div class="c-textarea">\n                    <label for="submitTemplateDescription" class="c-label template-submission-required">{{::submitTemplateCtrl.clientResources.TemplateSubmission.Description.Label}}</label>\n                    <textarea id="submitTemplateDescription"\n                        name="description"\n                        class="c-input c-textarea f-no-resize"\n                        ng-model="submitTemplateCtrl.templateDescription"\n                        ng-readonly="submitTemplateCtrl.formSubmitSpinner.show"\n                        ng-attr-placeholder="{{::submitTemplateCtrl.clientResources.TemplateSubmission.Description.Placeholder}}"\n                        required="required"\n                        ng-minlength="submitTemplateCtrl.minDescriptionLength"\n                        ng-maxlength="submitTemplateCtrl.maxDescriptionLength">\n                    </textarea>\n                    <div class="publish-validation" ng-if="submitTemplate.$submitted || submitTemplate.description.$touched">\n                        <p class="publish-error" ng-if="submitTemplate.description.$error.required">{{submitTemplateCtrl.clientResources.Publish.Empty.Description.Error}}</p>\n                        <p class="publish-error" ng-if="submitTemplate.description.$error.minlength">{{submitTemplateCtrl.minDescriptionErrorMessage}}</p>\n                        <p class="publish-error" ng-if="submitTemplate.description.$error.maxlength">{{submitTemplateCtrl.maxDescriptionErrorMessage}}</p>\n                    </div>\n                </div>\n                <div class="c-textarea">\n                    <label for="flow-benefits" class="c-label">{{::submitTemplateCtrl.clientResources.TemplateSubmission.FlowBenefits.Label}}</label>\n                    <textarea\n                        type="text"\n                        id="flow-benefits"\n                        name="flow-benefits"\n                        ng-readonly="submitTemplateCtrl.formSubmitSpinner.show"\n                        class="c-input c-textarea f-no-resize"\n                        ng-model="submitTemplateCtrl.extendedSubmissionContent.flowBenefits"\n                        ng-attr-placeholder="{{::submitTemplateCtrl.clientResources.TemplateSubmission.FlowBenefits.Placeholder}}" >\n                    </textarea>\n                </div>\n                <div class="c-textarea">\n                    <label for="team-benefits" class="c-label">{{::submitTemplateCtrl.clientResources.TemplateSubmission.TeamBenefits.Label}}</label>\n                    <textarea\n                        type="text"\n                        id="team-benefits"\n                        name="team-benefits"\n                        ng-readonly="submitTemplateCtrl.extendedSubmissionContentformSubmitSpinner.show"\n                        class="c-input c-textarea f-no-resize"\n                        ng-model="submitTemplateCtrl.teamBenefits"\n                        ng-attr-placeholder="{{::submitTemplateCtrl.clientResources.TemplateSubmission.TeamBenefits.Placeholder}}" >\n                    </textarea>\n                </div>\n                <div>\n                    <label for="flow-runs" class="c-label">{{::submitTemplateCtrl.clientResources.TemplateSubmission.FlowRuns.Label}}</label>\n                    <input\n                        type="text"\n                        id="flow-runs"\n                        name="flow-runs"\n                        class="c-input c-text-field"\n                        ng-model="submitTemplateCtrl.extendedSubmissionContent.flowRuns"\n                        ng-readonly="submitTemplateCtrl.formSubmitSpinner.show"\n                        ng-attr-placeholder="{{::submitTemplateCtrl.clientResources.TemplateSubmission.FlowRuns.Placeholder}}" />\n                </div>\n                <div class="template-categories-container">\n                    <label class="c-label">{{::submitTemplateCtrl.clientResources.TemplateSubmission.Categories.Label}}</label>\n                    <div class="submit-template-categories c-checkbox" ng-repeat="templateCategory in submitTemplateCtrl.templateCategories">\n                        <label class="c-label">\n                            <input type="checkbox" name="{{templateCategory.id}}" ng-model="templateCategory.selected" ng-disabled="submitTemplateCtrl.formSubmitSpinner.show" />\n                            <span>{{templateCategory.name}}</span>\n                        </label>\n                    </div>\n                </div>\n                <div>\n                    <label for="custom-category" class="c-label">{{::submitTemplateCtrl.clientResources.TemplateSubmission.CustomCategory.Label}}</label>\n                    <input\n                        type="text"\n                        id="custom-category"\n                        name="custom-category"\n                        class="c-input c-text-field"\n                        ng-model="submitTemplateCtrl.extendedSubmissionContent.customCategory"\n                        ng-readonly="submitTemplateCtrl.formSubmitSpinner.show"\n                        ng-attr-placeholder="{{::submitTemplateCtrl.clientResources.TemplateSubmission.CustomCategory.Placeholder}}" />\n                </div>\n                <p class="c-paragraph-4 submit-template-disclaimer">\n                    {{::submitTemplateCtrl.clientResources.TemplateSubmission.Disclaimer}}\n                </p>\n                <div class="submit-template-actions">\n                    <button class="c-button" ng-click="submitTemplateCtrl.onClose()" ng-disabled="submitTemplateCtrl.formSubmitSpinner.show">{{::submitTemplateCtrl.clientResources.TemplateSubmission.Command.Cancel}}</button>\n                    <button class="c-button" type="submit" ng-disabled="submitTemplateCtrl.formSubmitSpinner.show">{{::submitTemplateCtrl.clientResources.TemplateSubmission.Command.Submit}}</button>\n                </div>\n            </form>\n        </div>\n        <div ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.RunHistory)">\n            <div>\n                <div class="x-type-center">\n                    <a class="yellow-warning c-glyph glyph-warning"></a>\n                </div>\n\n                <p>{{submitTemplateCtrl.flowRunHistoryError}}</p>\n                <p>{{::submitTemplateCtrl.clientResources.TemplateSubmission.Message.LastModifiedTime}} {{submitTemplateCtrl.lastModifiedFriendlyTime}}</p>\n            </div>\n            <property-tile show-tile="true" model="submitTemplateCtrl.flowRunsTile" class="flow-runs-tile">\n                <tile-content-template>\n                    <flow-run-list model="submitTemplateCtrl.flowRunList"></flow-run-list>\n                </tile-content-template>\n            </property-tile>\n        </div>\n        <div ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.ContainsCustomApis)">\n            <div>\n                <div class="x-type-center">\n                    <a class="yellow-warning c-glyph glyph-warning"></a>\n                </div>\n\n                <p>{{::submitTemplateCtrl.clientResources.TemplateSubmission.Message.ContainsCustomApis}}</p>\n            </div>\n        </div>\n        <div class="success-response" ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.Success)">\n            <a class="green-circle-border c-glyph glyph-checkmark"></a>\n            <p class="c-paragraph-1">{{::submitTemplateCtrl.clientResources.TemplateSubmission.Message.Success}}</p>\n        </div>\n        <div ng-if="submitTemplateCtrl.isMode(submitTemplateCtrl.modeType.Error)">\n            <alert model="submitTemplateCtrl.errorStatusAlert"></alert>\n        </div>\n    </info-pane>\n</section>\n'},33995:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33996);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(33997);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(33998),this.bindings={model:"=",showTile:"<"},this.transclude={tileBannerTemplate:"?tileBannerTemplate",tileContentTemplate:"tileContentTemplate"},this.controller=o.a}));n.a.component(r.a.components.propertyTile,new c)},33996:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.navigationService=i,this.loggingService=r,this.model=void 0,this.showTile=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"PropertyTileCtrl"})}var t,i,r;return t=e,(i=[{key:"showAllClick",value:function(e){this.model.showAllAction&&this.model.showAllAction(e),this.model.showAllLink&&this.navigationService.navigate(this.model.showAllLink,this.model.searchParameters)}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.$inject=[r.a.services.clientResources,r.a.services.navigation,r.a.services.logging]},33997:function(e,t,i){e.exports=i.p+"static/media/propertyTile.a1e60685.less"},33998:function(e,t){e.exports='<div ng-class="{\'property-tile\': true, \'property-tile-reset\': {{!$ctrl.showTile}}}">\n    <div ng-show="$ctrl.showTile" ng-transclude="tileBannerTemplate"></div>\n    <div ng-show="$ctrl.showTile" class="tile-header" ng-if="$ctrl.model.title">\n        <h1 class="tile-title">{{$ctrl.model.title}}</h1>\n        <button class="tile-see-all" ng-click="$ctrl.showAllClick($event)" ng-show="$ctrl.model.showAll">\n            <span>{{$ctrl.clientResources.FlowPropertyTile.SeeAll}}</span>\n            <span class="c-glyph glyph-arrow"></span>\n        </button>\n    </div>\n    <div ng-transclude="tileContentTemplate"></div>\n</div>'},33999:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34e3);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34001);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34002),this.controller=o.a,this.controllerAs="zeroActivitiesCtrl"}));r.a.component(n.a.components.zeroActivities,new c)},34e3:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(33327),n=i(33398),o=i(14900),a=i(14897);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.navigationService=i,this.telemetryService=r,this.routeCrafter=n,this.image=void 0,this.telemetryService.tagEvent("NgCtrl.constructor",void 0,{component:"ZeroActivitiesCtrl"}),this.image=o.activityFeed.activitiesZero}var t,i,r;return t=e,(i=[{key:"createFromBlank",value:function(){this.telemetryService.tagEvent(n.a.CreateFlowStarted,{source:"Manage Activity - Zero Activity"}),this.navigationService.navigate(Object(o.q)(this.routeCrafter))}},{key:"browseTemplates",value:function(){this.telemetryService.tagEvent(n.a.BrowseTemplatesClicked,{source:"Manage Activity - Zero Activity"}),this.navigationService.navigate(Object(a.d)(this.routeCrafter))}}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[r.a.services.clientResources,r.a.services.navigation,r.a.services.telemetry,r.a.services.routeCrafter,r.a.services.assetService]},34001:function(e,t,i){e.exports=i.p+"static/media/zeroActivities.42d16fcf.less"},34002:function(e,t){e.exports='<div class="context-manage-zeroactivities">\n    <div class="row">\n        <div class="column medium-4 medium-offset-4">\n            <img cdn-src="{{zeroActivitiesCtrl.image}}" alt="{{zeroActivitiesCtrl.clientResources.Manage.Activity.Zero.Heading}}"/>\n        </div>\n    </div>\n    <div class="row">\n        <div class="column medium-8 medium-offset-2">\n            <h2>{{zeroActivitiesCtrl.clientResources.Manage.Activity.Zero.Heading}}</h2>\n            <p class="c-paragraph-1">{{zeroActivitiesCtrl.clientResources.Manage.Activity.Zero.Description}}</p>\n        </div>\n    </div>\n    <div class="row">\n        <div class="column medium-3 medium-offset-3">\n            <button class="c-button" ng-click="zeroActivitiesCtrl.createFromBlank()">{{zeroActivitiesCtrl.clientResources.Manage.Flows.ZeroFlowsCreateNew}}</button>\n        </div>\n        <div class="column medium-3">\n            <button class="c-button btn btn-primary" ng-click="zeroActivitiesCtrl.browseTemplates()">{{zeroActivitiesCtrl.clientResources.Manage.Flows.ZeroFlowsBrowseTemplates}}</button>\n        </div>\n    </div>\n</div>\n'},34003:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(23064),a=["flowIsDirty","triggerNewTestRunAllowed","flowIsSimulateTriggerSupported","flowIsTriggerConcurrencyEnabled","isDisabled","isOpen","messageBarProps",["previousRuns",{watchDepth:"collection"}],"selectedChoice","selectedSubChoice","selectedRun","triggerConnectorDisplayName","triggerHint","onChoiceSelectionChange","onChoiceAutomaticallySubSelectionChange","onClose","onDismissed","onInvokeFlowAsTest","onInvokeRunAsTest","onInvokeSimulate","onRunSelectionChange","clientResources","loggingService"];r.a.directive(n.a.components.react.reactTestFlowPanel,[n.a.modules.reactDirective,e=>e(o.b,a)])},34004:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34005),a=["actions","connectionErrors","connectionWarnings","flowCheckerErrors","flowCheckerWarnings","isOpen","onDismissed","parametersErrors","triggers","isSolutionFlow","isCurrentUserFlowOwner","onOperationItemClicked","clientResources","appSettings",["assetService",{watchDepth:"reference"}],["telemetryService",{watchDepth:"reference"}],["planService",{watchDepth:"reference"}],["graphService",{watchDepth:"reference"}],["licenseManagementService",{watchDepth:"reference"}],["neptuneService",{watchDepth:"reference"}],["widgetUtilService",{watchDepth:"reference"}],["licenseManagementStore",{watchDepth:"reference"}],["cdnService",{watchDepth:"reference"}],["userDetailsStore",{watchDepth:"reference"}],["consentService",{watchDepth:"reference"}],["sessionStore",{watchDepth:"reference"}],["planStore",{watchDepth:"reference"}],["surfaceStore",{watchDepth:"reference"}],["featureFlags",{watchDepth:"reference"}],["loggingService",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactFlowCheckerPanel,[n.a.modules.reactDirective,e=>e(o.a,a)])},34005:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(11766),n=i(14947),o=i(21035),a=i(34006),s=i(19863);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(m,e);var t,i,u,h=p(m);function m(){return l(this,m),h.apply(this,arguments)}return t=m,(i=[{key:"render",value:function(){var{isOpen:e,onDismissed:t}=this.props;return r.createElement(n.a,{isOpen:e,title:this.props.clientResources.FlowChecker.Title,onDismissed:t,dataAutomationId:o.a.flow_checker_panel},e&&this.renderContent())}},{key:"renderContent",value:function(){var e=Object(s.f)(this.props),t=Object(s.e)({items:e,clientResources:this.props.clientResources});return r.createElement(a.a,{items:e,groups:t,onOperationCellClicked:this.props.onOperationItemClicked,dataAutomationIdGroup:"flowChecker",featureFlags:this.props.featureFlags,loggingService:this.props.loggingService,isSolutionFlow:this.props.isSolutionFlow,isCurrentUserFlowOwner:this.props.isCurrentUserFlowOwner,appSettings:this.props.appSettings,assetService:this.props.assetService,clientResources:this.props.clientResources,telemetryService:this.props.telemetryService,planService:this.props.planService,planStore:this.props.planStore,sessionStore:this.props.sessionStore,surfaceStore:this.props.surfaceStore,graphService:this.props.graphService,licenseManagementService:this.props.licenseManagementService,licenseManagementStore:this.props.licenseManagementStore,neptuneService:this.props.neptuneService,widgetUtilService:this.props.widgetUtilService,cdnService:this.props.cdnService,userDetailsStore:this.props.userDetailsStore,consentService:this.props.consentService})}}])&&c(t.prototype,i),u&&c(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(r.Component)},34006:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(11766),n=i(20340),o=i(34007),a=i(12706),s=i(34009);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(m,e);var t,i,u,h=p(m);function m(){var e;l(this,m);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=h.call(this,...i)).getClassNames=Object(a.a)(),e.renderOperationAlertCell=(t,i,n)=>e.props.items.length>0?t&&i&&void 0!==n&&r.createElement(o.a,{featureFlags:e.props.featureFlags,loggingService:e.props.loggingService,itemIndex:n,nestingDepth:t,operationAlert:i,onOperationCellClicked:e.props.onOperationCellClicked,dataAutomationIdGroup:e.props.dataAutomationIdGroup,isSolutionFlow:e.props.isSolutionFlow,isCurrentUserFlowOwner:e.props.isCurrentUserFlowOwner,appSettings:e.props.appSettings,assetService:e.props.assetService,clientResources:e.props.clientResources,telemetryService:e.props.telemetryService,planService:e.props.planService,planStore:e.props.planStore,sessionStore:e.props.sessionStore,surfaceStore:e.props.surfaceStore,graphService:e.props.graphService,licenseManagementService:e.props.licenseManagementService,licenseManagementStore:e.props.licenseManagementStore,neptuneService:e.props.neptuneService,widgetUtilService:e.props.widgetUtilService,cdnService:e.props.cdnService,userDetailsStore:e.props.userDetailsStore,consentService:e.props.consentService}):null,e.renderGroupTitle=t=>{var i=null==t?void 0:t.group;return i?r.createElement("div",{"data-automation-id":"".concat(e.props.dataAutomationIdGroup,"_").concat(i.name),className:"fl-OperationAlertsGroupedList-title"},r.createElement("span",{className:"fl-OperationAlertsGroupedList-title-text",title:i.name},i.name),r.createElement("span",{"data-automation-id":"".concat(e.props.dataAutomationIdGroup,"_").concat(i.name,"_count"),className:"fl-OperationAlertsGroupedList-title-counter"},"(",i.count,")")):null},e}return t=m,(i=[{key:"render",value:function(){var e={showEmptyGroups:!0,headerProps:{onRenderTitle:this.renderGroupTitle}},t=this.getClassNames(s.a,this.props);return r.createElement(n.a,{className:t.root,groupProps:e,groups:this.props.groups,items:this.props.items,onRenderCell:this.renderOperationAlertCell})}}])&&c(t.prototype,i),u&&c(t,u),Object.defineProperty(t,"prototype",{writable:!1}),m}(r.Component)},34007:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var r=i(11766),n=i(15021),o=i(12706),a=i(34008),s=i(13015),l=i(27988),c=i(14983),u=i(15018),d=i(27985),p=i(27984);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=y(e);if(t){var n=y(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return b(this,i)}}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(y,e);var t,i,g,b=v(y);function y(){var e;h(this,y);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return(e=b.call(this,...i)).getClassNames=Object(o.a)(),e.selection=new n.a,e.onRenderItem=e=>{var t,i=e.fixInstructions&&e.fixInstructions.htmlText||e.errorMessage;return(null==e||null===(t=e.fixInstructions)||void 0===t?void 0:t.messageId)!==s.a.ConnectionToConnectionReference&&(i=i&&Object(l.a)(i)),r.createElement("span",{dangerouslySetInnerHTML:{__html:i}})},e.onOperationCellClicked=()=>{var t,i,{operationAlert:r}=e.props;(r.nodeId||r.groupId||r.parameterId)&&(null===(t=(i=e.props).onOperationCellClicked)||void 0===t||t.call(i,r.nodeId,r.groupId,r.parameterId))},e}return t=y,(i=[{key:"render",value:function(){var e,{itemIndex:t,nestingDepth:i,operationAlert:n}=this.props,o=this.getClassNames(a.a,this.props),s=[{className:o.errorMessage,fieldName:n.errorMessage,key:n.errorMessage,minWidth:0,name:n.errorMessage,onRender:this.onRenderItem}],l=this.props.onOperationCellClicked?{onClick:this.onOperationCellClicked,style:{cursor:"pointer"}}:{};return r.createElement("div",{className:o.cell},r.createElement("div",l,r.createElement(u.a,{className:o.detailsRow,columns:s,groupNestingDepth:i,item:n,itemIndex:t,selection:this.selection,"data-automation-id":"".concat(this.props.dataAutomationIdGroup,"_").concat(n.type,"_").concat(n.name,"_details"),selectionMode:c.d.none})),null!==(e=n.fixInstructions)&&void 0!==e&&e.messageId&&Object(p.a)(n.fixInstructions.messageId)?r.createElement(d.a,{billingRestrictionType:n.fixInstructions.messageId,isSolutionFlow:this.props.isSolutionFlow,isCurrentUserFlowOwner:this.props.isCurrentUserFlowOwner,appSettings:this.props.appSettings,featureFlags:this.props.featureFlags,loggingService:this.props.loggingService,assetService:this.props.assetService,clientResources:this.props.clientResources,telemetryService:this.props.telemetryService,planService:this.props.planService,planStore:this.props.planStore,sessionStore:this.props.sessionStore,surfaceStore:this.props.surfaceStore,graphService:this.props.graphService,licenseManagementService:this.props.licenseManagementService,licenseManagementStore:this.props.licenseManagementStore,neptuneService:this.props.neptuneService,widgetUtilService:this.props.widgetUtilService,cdnService:this.props.cdnService,userDetailsStore:this.props.userDetailsStore,consentService:this.props.consentService}):null)}}])&&m(t.prototype,i),g&&m(t,g),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.Component)},34008:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(12754),n=e=>{var t=Object(r.Y)().palette;return{cell:["fl-OperationAlertCell-cell",{borderBottom:"1px solid",borderBottomColor:t.neutralLight}],detailsRow:["fl-OperationAlertCell-detailsRow",{fontSize:r.k.size14,width:"100%",borderBottom:"none",selectors:{"&.ms-DetailsRow":{selectors:{".ms-GroupSpacer":{flex:"0 0 ".concat(46)},".ms-DetailsRow-fields":{width:"calc(100% ~'-' ".concat(46,")")},a:{color:t.themePrimary},p:{fontSize:r.k.size14,padding:0,whiteSpace:"normal",lineHeight:"normal",width:"auto",height:"auto"}}}}}],errorMessage:["fl-OperationAlertCell-errorMessage",{whiteSpace:"normal",display:"block"}]}}},34009:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(15504),n=i(15506),o=i(16817);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=e=>{var t=n.c,i="calc(100% - ".concat(2*t+16,"px)");return{root:["fl-OperationAlertsGroupedList",{".ms-GroupHeader-expand":s(s({},Object(r.j)()),{},{width:t+8,paddingLeft:0,paddingRight:8}),".ms-GroupSpacer":{flex:"0 0 ".concat(t+8,"px")},".fl-OperationAlertsGroupedList-title":s(s({},Object(r.h)()),{},{display:"flex",width:i,".fl-OperationAlertsGroupedList-title-text":s({},Object(o.i)()),".fl-OperationAlertsGroupedList-title-counter":{paddingLeft:4}})}]}}},34010:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34011);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bindings={entityData:"<?",flowName:"<",isOpen:"=",isTestRun:"<?",onDone:"<?"},this.controller=o.a,this.controllerAs="ngInvokeFlowPanelWrapperCtrl"}));r.a.component(n.a.components.ngInvokeFlowPanelWrapper,new c)},34011:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(21028),n=i(33327),o=i(18933),a=i(13152),s=i(13202);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r,n,o,s,l,c,u,d){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.flowRunsClient=i,this.promiseHelperService=r,this.sessionService=n,this.widgetUtilService=o,this.flowRunsService=s,this.environmentService=l,this.designerCoreLoader=c,this.designerContextService=u,this.loggingService=d,this.entityData=void 0,this.flowName=void 0,this.isOpen=void 0,this.isTestRun=void 0,this.onDone=void 0,this.invokeFlowSurfaceProps=void 0,this.$onInit=()=>{this.$scope.$watch(()=>this.isOpen,(e,t)=>{e&&this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>{this.handlePanelOpen()})}),this.$scope.$watch(()=>this.isTestRun,(e,t)=>{this.invokeFlowSurfaceProps.isTestRun=e})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"NgInvokeFlowPanelWrapperCtrl"}),this.invokeFlowSurfaceProps={isTestRun:this.isTestRun,entityData:this.entityData,flowName:null,onDone:()=>{this.onDone&&this.onDone()},onClose:()=>{this.handleClose()},surfaceType:a.a.SmallPanel,hasCloseButton:!0}}var t,i,n;return t=e,(i=[{key:"handlePanelOpen",value:function(){this.flowName&&(this.invokeFlowSurfaceProps.autoConsentUser=this.widgetUtilService.allowBackgroundConsent(),this.invokeFlowSurfaceProps.flowName=this.flowName,this.invokeFlowSurfaceProps.onFlowRunRequestComplete=()=>{this.flowRunsClient.refreshQuery({flowName:this.flowName}),this.flowRunsService.getFlowRuns({environmentName:this.environmentService.getCurrentEnvironmentName(),flowName:this.flowName,status:o.a.all,forceRefresh:!0})},Object(r.a)(s.a,this.invokeFlowSurfaceProps))}},{key:"handleClose",value:function(){this.isOpen=!1}}])&&l(t.prototype,i),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[n.a.services.$scope,n.a.services.flowRunsClient,n.a.services.promiseHelperService,n.a.services.session,n.a.services.widgetUtilService,n.a.services.flowrunsService,n.a.services.environment,n.a.services.designerCoreLoader,n.a.services.designerCreateContext,n.a.services.logging]},34012:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34013),a=["flowName","isOpen","searchText","title","apiBrandColor","apiIconUri","description","documentUrl","connectorDisplayName","connectorId","actionFriendlyName","isRecommendation","recommendationContext","onDismissed","onInvokeSearch","flowClientResources",["widgetUtilService",{watchDepth:"reference"}],["telemetryService",{watchDepth:"reference"}],["cdnService",{watchDepth:"reference"}],["loggingService",{watchDepth:"reference"}],["doNotShowAgainService",{watchDepth:"reference"}],["tokenService",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactContextualHelpPanel,[n.a.modules.reactDirective,e=>e(o.a,a)])},34013:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var r=i(11766),n=i(34014),o=i(12706),a=i(34064),s=i(34065),l=i(12375),c=i(13031),u=i(13272),d=i(14682),p=i(13240),h=i(12999),m=i(17524),g=i(17755);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=C(e);if(t){var n=C(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return S(this,i)}}function S(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(C,e);var t,i,b,S=w(C);function C(){var e;f(this,C);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=S.call(this,...i)).classNames=Object(o.a)()(a.c),e.compRef=r.createRef(),e.homeUrlFormat="help://contextualHelp?title={0}&searchText={1}&locale={2}",e.renderDescription=(t,i,n,o,a)=>r.createElement(s.a,{title:t,description:n,onHelpItemClicked:e.onHelpItemClicked,isCollapsed:i,detailSectionLearnMoreLink:o,isRecommendation:a,flowClientResources:e.props.flowClientResources}),e.getHelpContentToShow=(t,i,n,o)=>{var{telemetryService:a}=e.props;return a.tagEvent(p.c.ContextualHelpPaneSearchResults,{searchText:e.props.searchText,connectorDisplayName:e.props.connectorDisplayName,connectorId:e.props.connectorId,actionFriendlyName:e.props.actionFriendlyName}),r.createElement("div",null,r.createElement("div",{className:e.classNames.title}),e.renderDescription(t,!1,i,n,o),e.renderAskTheBotSection())},e.onRenderCommandBar=()=>null,e.loadInAppBrowser=()=>{var{description:t,title:i,documentUrl:r,isRecommendation:n}=e.props;return Promise.resolve(e.getHelpContentToShow(i,t,r,n))},e.onDismissed=()=>{var{searchText:t,title:i}=e.props;e.props.telemetryService.tagEvent(p.c.ContextualHelpPaneClosed,{title:i,searchText:t}),e.props.onDismissed&&e.props.onDismissed()},e.onRenderDocument=e=>{var t;return null!==(t=null==e?void 0:e.document)&&void 0!==t?t:null},e.onHelpItemClicked=t=>{var i=t&&t.currentTarget&&t.currentTarget.textContent,r=t&&t.currentTarget&&t.currentTarget.getAttribute("href");e.props.telemetryService.tagEvent(p.c.ContextualHelpPaneHelpItemClicked,{selectedItemTitle:i,contentUrl:r,searchText:e.props.searchText,connectorDisplayName:e.props.connectorDisplayName,connectorId:e.props.connectorId,actionFriendlyName:e.props.actionFriendlyName}),e.props.onHelpItemClicked&&e.props.onHelpItemClicked(t)},e.onError=t=>{var{title:i,searchText:r}=e.props;e.props.loggingService.logError("ContextualHelpPanel.Render.InAppBrowser",t,{title:i,searchText:r})},e}return t=C,(i=[{key:"render",value:function(){var{isOpen:e,searchText:t,title:i}=this.props,o=Object(c.a)(this.homeUrlFormat,i,t,Object(l.a)());return e&&t&&i&&!this.props.widgetUtilService.isWidgetPage()?r.createElement(n.a,{title:this.props.flowClientResources.ContextualHelp.Title,isOpen:!0,isBlocking:!1,styles:a.d,componentRef:this.compRef,homeUrl:o,onClose:this.onDismissed,loadFn:this.loadInAppBrowser,onRenderDocument:this.onRenderDocument,onError:this.onError,errorStateProps:{iconProps:{iconName:u.a.Error}},strings:{subComponentStrings:{errorState:e=>({title:e.message})}},commandBarAs:this.onRenderCommandBar,panelProps:{closeButtonAriaLabel:"close",[d.a]:"contextualhelp-panel"}}):null}},{key:"componentDidUpdate",value:function(e){var{isOpen:t,searchText:i,title:r}=this.props;if(t&&i&&r&&i!==e.searchText){var n=Object(c.a)(this.homeUrlFormat,r,i,Object(l.a)());this.compRef.current&&this.compRef.current.navigateTo(n)}}},{key:"renderAskTheBotSection",value:function(){var{flowName:e,searchText:t}=this.props,{telemetryService:i}=this.props;return Object(h.a)().enableSkylightBot?(i.tagEvent(p.c.ChatbotLinkShown,{flowName:e,searchText:t}),r.createElement("div",null,r.createElement("div",{className:this.classNames.shadowedStyle},r.createElement(m.a,{className:this.classNames.chatBotContainerSkylight,iconClassName:this.classNames.chatIcon,searchText:t,flowName:e,skylightBotGreetingId:g.b.flows,skylightBotPartnerName:g.c.flows,iconWithLink:!0,onDismiss:this.onDismissed,context:p.c.ChatBotOpenedFromContextualHelp,flowClientResources:this.props.flowClientResources,doNotShowAgainService:this.props.doNotShowAgainService,loggingService:this.props.loggingService,telemetryService:this.props.telemetryService,tokenService:this.props.tokenService})))):null}}])&&v(t.prototype,i),b&&v(t,b),Object.defineProperty(t,"prototype",{writable:!1}),C}(r.Component)},34014:function(e,t,i){"use strict";var r=i(34015);i.d(t,"a",(function(){return r.a}));i(34055),i(34056),i(34054),i(34029),i(34057),i(34016),i(31694)},34015:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(29209),n=i(12720),o=i(34016),a=i(34053),s=i(34054),l=Object(n.a)(o.a,s.a),c=l=Object(r.a)(l,a.a)},34016:function(e,t,i){"use strict";i.d(t,"a",(function(){return A}));var r=i(34017),n=i(29209),o=i(14665),a=i(34043),s=i(14956),l=i(14958),c=i(14350),u=i(14354),d=i(12706),p=i(34022),h=i(11766),m=i(34030),g=i(34028),f=i(34029),v=["item"],b=["item"],y=["item"];function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function k(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?C(Object(i),!0).forEach((function(t){P(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function P(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var x=Object(d.a)();function A(e){var t,i,d,g,C,P,A;!function(e){var{homeUrl:t,url:i,locale:r}=e;try{new URL(t)}catch(n){throw new Error("homeUrl")}if(void 0!==i)try{new URL(i)}catch(n){throw new Error("url")}if(r&&!/^[A-Za-z]{2,4}([_-][A-Za-z]{4})?([_-]([A-Za-z]{2}|[0-9]{3}))?$/.test(r))throw new Error("locale")}(e);var{homeUrl:R,title:O,url:D,locale:E,loadFn:F,onRenderDocument:I,onRenderInternalPage:j,isOpen:N,isLightDismiss:M,isHiddenOnDismiss:L,isBlocking:U,elementToFocusOnDismiss:B,onNavigating:$,onNavigate:q,onError:W,onClose:z,onClosed:H,cacheKey:V,componentRef:_,strings:G,styles:K,className:X,theme:Q}=e,J=Object(p.a)(new URL(D||R).toString()),Y=h.useRef(!0),Z=J.current,ee=x(K,{isFirstLoad:Y.current,theme:Q,className:X}),{isIdle:te,isFetching:ie,isSuccess:re,isError:ne,error:oe,refetch:ae,data:se}=Object(m.a)(["InAppBrowser",V||"",Z||R,E||""],{queryFn:h.useCallback(()=>F(Z||R,E),[F,Z,R,E]),enabled:!T(Z),staleTime:1/0,refetchOnWindowFocus:!1,retry:0}),le=h.useMemo(()=>Object(n.b)(G)({error:oe}),[oe]);h.useEffect(()=>{(re||ne)&&(Y.current=!1)},[re,ne]);var{keytipLayerProps:ce,panelProps:ue,commandBarProps:de,homeButtonProps:pe,backButtonProps:he,overflowButtonProps:me,backMenuItemProps:ge,forwardMenuItemProps:fe,refreshMenuItemProps:ve,titleShimmerProps:be,mediaBlockShimmerProps:ye,textBlockShimmerProps:we,errorStateProps:Se,disableError:Ce=!1}=e,{keytipLayerAs:ke=a.a,panelAs:Pe=s.a,titleShimmerAs:xe=c.a,mediaBlockShimmerAs:Ae=c.a,textBlockShimmerAs:Te=c.a,commandBarAs:Re=o.a,errorStateAs:Oe=r.a}=e,De=h.useCallback(()=>{ae()},[ae]),Ee=h.useCallback((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===e&&(e=R);try{e=new URL(e,Z).toString()}catch(i){throw new Error("url")}e!==Z?null!=$&&$(e)||(null==q||q(e),t?J.replace(e):J.push(e)):De()}),[R,Z,J.push,J.replace,De,q,$]),Fe=h.useCallback(()=>{Ee(null)},[Ee]),Ie=h.useCallback(()=>{J.goBack()},[J.goBack]),je=h.useCallback(()=>{J.goForward()},[J.goForward]),Ne=h.useMemo(()=>({navigateHome:Fe,navigateTo:Ee,navigateBack:Ie,navigateForward:je,refresh:De}),[Fe,Ee,Ie,je,De]);h.useImperativeHandle(_,()=>Ne,[Ne]);var Me=h.useCallback((e,t)=>{var i;null==pe||null===(i=pe.onClick)||void 0===i||i.call(pe,e,t),null!=e&&e.defaultPrevented||Fe()},[null==pe?void 0:pe.onClick,Fe]),Le=h.useCallback((e,t)=>{var i;null==he||null===(i=he.onClick)||void 0===i||i.call(he,e,t),null!=e&&e.defaultPrevented||Ie()},[null==he?void 0:he.onClick,Ie]),Ue=h.useCallback((e,t)=>{var i,r,n=null==ge||null===(i=ge.item)||void 0===i||null===(r=i.onClick)||void 0===r?void 0:r.call(i,e,t);if(null==e||!e.defaultPrevented)return Ie(),n},[null==ge||null===(t=ge.item)||void 0===t?void 0:t.onClick,Ie]),Be=h.useCallback((e,t)=>{var i,r,n=null==fe||null===(i=fe.item)||void 0===i||null===(r=i.onClick)||void 0===r?void 0:r.call(i,e,t);if(null==e||!e.defaultPrevented)return je(),n},[null==fe||null===(i=fe.item)||void 0===i?void 0:i.onClick,je]),$e=h.useCallback((e,t)=>{var i,r,n=null==ve||null===(i=ve.item)||void 0===i||null===(r=i.onClick)||void 0===r?void 0:r.call(i,e,t);if(null==e||!e.defaultPrevented)return De(),n},[null==ve||null===(d=ve.item)||void 0===d?void 0:d.onClick,De]),qe=h.useCallback(()=>{De()},[De]);h.useEffect(()=>{oe&&(null==W||W(oe))},[W,oe]),h.useEffect(()=>{"DocumentLocationChangedError"===(null==oe?void 0:oe.name)&&oe.newUrl!==Z&&Ee(oe.newUrl,!0)},[oe,Ee,Z]);var We="";"string"==typeof O?We=O:!T(Z)&&re&&"function"==typeof O&&(We=O(se));var ze,He,Ve,_e,Ge=[],Ke=[];(J.canGoBack||J.canGoForward)&&(Ge=[k(k({title:le.backButtonTooltip,buttonStyles:null===(ze=(He=ee.subComponentStyles).backButton)||void 0===ze?void 0:ze.call(He,{}),iconProps:{iconName:"Back"}},he),{},{commandBarButtonAs:e.backButtonAs,key:"back",type:"button",disabled:!J.canGoBack,onClick:Le}),k(k({title:le.homeButtonTooltip,buttonStyles:null===(Ve=(_e=ee.subComponentStyles).homeButton)||void 0===Ve?void 0:Ve.call(_e,{}),iconProps:{iconName:"Home"}},pe),{},{commandBarButtonAs:e.homeButtonAs,key:"home",type:"button",onClick:Me})],Ke=[k(k({text:le.refreshMenuItemText,title:le.refreshMenuItemTooltip,iconProps:{iconName:"Refresh"},itemProps:k({styles:ee.subComponentStyles.refreshMenuItem},(()=>{if(ve){var{item:e}=ve;return S(ve,v)}})())},(null==ve?void 0:ve.item)||{}),{},{key:"refresh",type:"button",onClick:$e}),k(k({text:le.backMenuItemText,title:le.backMenuItemTooltip,iconProps:{iconName:"Back"},itemProps:k({styles:ee.subComponentStyles.backMenuItem},(()=>{if(ge){var{item:e}=ge;return S(ge,b)}})())},(null==ge?void 0:ge.item)||{}),{},{key:"back",type:"button",disabled:!J.canGoBack,onClick:Ue}),k(k({text:le.forwardMenuItemText,title:le.forwardMenuItemTooltip,iconProps:{iconName:"Forward"},itemProps:k({styles:ee.subComponentStyles.forwardMenuItem},(()=>{if(fe){var{item:e}=fe;return S(fe,y)}})())},(null==fe?void 0:fe.item)||{}),{},{key:"forward",type:"button",disabled:!J.canGoForward,onClick:Be})]);var Xe=[...Ke,...(null==me||null===(g=me.menuProps)||void 0===g?void 0:g.items)||[]],Qe=Xe.length>0?[k(k({title:le.overflowButtonTooltip,buttonStyles:null===(C=(P=ee.subComponentStyles).overflowButton)||void 0===C?void 0:C.call(P,{}),iconProps:{iconName:"MoreVertical"},split:!1},me),{},{commandBarButtonAs:e.overflowButtonAs,key:"overflow",type:"button",subMenuProps:k(k({},(null==me?void 0:me.subMenuProps)||{}),{},{items:Xe})}),...(null==de?void 0:de.farItems)||[]].filter(Boolean):[...(null==de?void 0:de.farItems)||[]].filter(Boolean);return h.createElement(h.Fragment,null,h.createElement(ke,w({content:"",styles:ee.subComponentStyles.keytipLayer},ce,ke!==a.a?{defaultRender:a.a}:{})),h.createElement(Pe,w({role:"region",isOpen:N,type:l.a.smallFixedFar,isBlocking:U,isLightDismiss:M,isHiddenOnDismiss:L,hasCloseButton:!0,closeButtonAriaLabel:le.closeButtonAriaLabel,elementToFocusOnDismiss:B,headerText:We},ue,Pe!==s.a?{defaultRender:s.a}:{},{styles:ee.subComponentStyles.panel,className:X,onDismiss:z,onDismissed:H}),h.createElement(f.a.Provider,{value:Ne},h.createElement("div",{className:ee.commandBarContainer},h.createElement(Re,w({styles:ee.subComponentStyles.commandBar},de,Re!==o.a?{defaultRender:o.a}:{},{items:[...Ge,...(null==de?void 0:de.items)||[]],farItems:Qe.length>0?Qe:[]}))),h.createElement("div",{className:ee.privacyWarningContainer},le.privacyWarning),!T(Z)&&h.createElement(h.Fragment,null,(te||ie)&&h.createElement(h.Fragment,null,h.createElement(xe,w({styles:ee.subComponentStyles.titleShimmer,shimmerElements:[{type:u.a.line,height:28,width:"70%"},{type:u.a.gap,height:28,width:"30%"}]},be,xe!==c.a?{defaultRender:c.a}:{})),[...Array(3).keys()].map((e,t)=>h.createElement(h.Fragment,{key:"shimmerGroup".concat(t)},h.createElement(Ae,w({styles:ee.subComponentStyles.mediaBlockShimmer,shimmerElements:[{type:u.a.line,height:170,width:"90%"}]},ye,Ae!==c.a?{defaultRender:c.a}:{})),h.createElement(Te,w({styles:ee.subComponentStyles.textBlockShimmer,shimmerElements:[{type:u.a.line,height:16,width:"80%"},{type:u.a.gap,height:16,width:"20%"}]},we,Te!==c.a?{defaultRender:c.a}:{}))))),(re||Ce)&&!ie&&(null==I?void 0:I({url:Z,document:se})),ne&&!Ce&&"DocumentLocationChangedError"!==oe.name&&h.createElement(Oe,w({showPrimaryButton:!0,primaryButtonText:le.retryButtonText,onPrimaryButtonClick:qe,styles:ee.subComponentStyles.errorState,strings:null===(A=le.subComponentStrings)||void 0===A?void 0:A.errorState},Se,Oe!==r.a?{defaultRender:r.a}:{},{error:oe}))),T(Z)&&(null==j?void 0:j({url:Z,locale:E})))))}function T(e){return null!==e&&e.toLowerCase().startsWith("internal://")}Object(g.a)()},34017:function(e,t,i){"use strict";var r=i(34018);i.d(t,"a",(function(){return r.a}));i(34021)},34018:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(29209),n=i(34019),o=i(34020),a=Object(r.a)(n.a,o.a)},34019:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(11766),n=i(31694),o=i(29209),a=i(12706),s=["error","strings","styles","className","theme"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var u=Object(a.a)(),d=e=>{var{error:t,strings:i,styles:a,className:d,theme:p}=e,h=c(e,s),m=u(a,{error:t,theme:p,className:d}),g=r.useMemo(()=>Object(o.b)(i)({error:t}),[t]);return r.createElement(n.a,l({iconProps:{iconName:"StatusCircleErrorX"},title:g.title,description:g.description,styles:m},h))}},34020:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=e=>({title:"Error",description:e.error.message})},34021:function(e,t,i){},34022:function(e,t,i){"use strict";i(34023),i(34024),i(34025),i(34026);var r=i(34027);i.d(t,"a",(function(){return r.a}))},34023:function(e,t,i){"use strict";i(11766)},34024:function(e,t,i){"use strict";i(11766),i(20666)},34025:function(e,t,i){"use strict";i(11766)},34026:function(e,t,i){"use strict";i(11766)},34027:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(11766);function n(e,t){switch(t.type){case"BACK":if(e.history.length<=1)throw new Error("Invalid operation");if(0===e.currentIndex)throw new Error("Invalid operation");return{history:e.history,currentIndex:e.currentIndex-1};case"FORWARD":if(e.history.length<=1)throw new Error("Invalid operation");if(e.currentIndex===e.history.length)throw new Error("Invalid operation");return{history:e.history,currentIndex:e.currentIndex+1};case"PUSH":return{history:e.history.slice(0,e.currentIndex+1).concat(t.value),currentIndex:e.currentIndex+1};case"REPLACE":return{history:e.history.slice(0,e.currentIndex).concat(t.value),currentIndex:e.currentIndex};case"RESET":return{history:void 0===t.initial?[]:[t.initial],currentIndex:void 0===t.initial?-1:0};default:throw new Error("Invalid operation")}}function o(e){"function"==typeof e&&(e=e());var[t,i]=r.useReducer(n,{history:void 0===e?[]:[e],currentIndex:void 0===e?-1:0}),{history:o,currentIndex:a}=t,s=0===o.length?void 0:o[a],l=a>0,c=-1!==a&&a<o.length-1,u=r.useCallback(()=>{i({type:"BACK"})},[i]),d=r.useCallback(()=>{i({type:"FORWARD"})},[i]),p=r.useCallback(e=>{"function"==typeof e&&(e=e(s)),i({type:"PUSH",value:e})},[i]),h=r.useCallback(e=>{"function"==typeof e&&(e=e(s)),i({type:"REPLACE",value:e})},[i]),m=r.useCallback(e=>{i({type:"RESET",initial:e})},[i]);return{current:s,push:p,replace:h,canGoBack:l,canGoForward:c,goBack:u,goForward:d,reset:m}}},34028:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(11766),n=i(12754),o=()=>{Object(n.ib)({icons:{"learningpath-help-not-found":r.createElement("svg",{viewBox:"0 0 190 150",fill:"none"},r.createElement("g",{opacity:"0.6"},r.createElement("path",{d:"M125.609 29.9561C133.215 39.3652 127.134 48.1493 136.86 56.341C150.069 67.4604 159.456 58.2896 172.433 65.799C179.703 73.3037 180.224 74.8555 177.126 93.7289C175.98 100.709 169.355 108.511 163.912 114.145C156.671 121.641 145.028 126.588 139.02 129.639C106.758 145.793 55.515 124.867 27.5812 97.8512C15.0706 85.742 12.6667 76.8015 11.9405 73.0577C8.26306 54.5414 21.2274 40.0106 23.5815 37.3989C48.7274 9.13715 109.377 9.7967 125.609 29.9561Z",fill:"url(#paint0_radial)"}),r.createElement("path",{d:"M67.6193 14.522L65.7408 8.46285C64.8225 8.13085 64.3215 7.96484 64.3215 7.96484C62.8188 8.42135 55.5553 10.6624 54.0525 11.1189C52.4662 11.6169 45.1193 13.858 43.4495 14.3975C43.4495 14.3975 43.4495 14.3975 43.4078 14.3975C43.1573 14.4805 42.9486 14.688 42.9069 14.937C42.8651 15.103 42.8651 15.2275 42.9069 15.3935C43.533 17.427 44.2009 19.5021 44.8271 21.5356C44.9106 21.8261 45.2445 21.9921 45.5785 21.9091L67.2019 15.269C67.5358 15.1445 67.7028 14.8125 67.6193 14.522Z",fill:"url(#paint1_linear)"}),r.createElement("path",{d:"M95.3792 3.93928C95.0452 3.93928 94.1269 3.89778 93.2085 3.19227C92.4988 2.65276 92.1231 1.94724 91.9562 1.61523C69.4144 8.54588 46.9144 15.4765 24.3726 22.4072C24.2891 22.4487 21.6592 23.2372 21.5757 23.2787C20.8661 23.4862 20.4904 24.2747 20.7409 25.0217C31.3856 59.0524 41.9886 93.0831 52.6333 127.114V127.155C52.8838 127.902 53.6352 128.359 54.3031 128.151C78.0972 120.806 101.933 113.46 125.727 106.073C126.437 105.865 126.812 105.077 126.562 104.33C122.555 91.4646 118.547 78.6409 114.54 65.7756C108.236 45.1912 101.808 24.5652 95.3792 3.93928Z",fill:"#36475C"}),r.createElement("path",{d:"M95.3792 3.93928C95.0452 3.93928 94.1269 3.89778 93.2085 3.19227C92.4988 2.65276 92.1231 1.94724 91.9562 1.61523C69.4144 8.54588 46.9144 15.4765 24.3726 22.4072C24.2891 22.4487 21.6592 23.2372 21.5757 23.2787C20.8661 23.4862 20.4904 24.2747 20.7409 25.0217C31.3856 59.0524 41.9886 93.0831 52.6333 127.114V127.155C52.8838 127.902 53.6352 128.359 54.3031 128.151C78.0972 120.806 101.933 113.46 125.727 106.073C126.437 105.865 126.812 105.077 126.562 104.33C122.555 91.4646 118.547 78.6409 114.54 65.7756C108.236 45.1912 101.808 24.5652 95.3792 3.93928Z",fill:"url(#paint2_linear)"}),r.createElement("path",{d:"M126.061 105.201L55.8475 126.865C54.9709 127.155 54.0108 126.657 53.7603 125.786L22.2018 24.8557C21.9096 23.9842 22.4105 23.0297 23.2872 22.7807L93.5006 1.11725C94.3772 0.826749 95.3373 1.32476 95.5878 2.19628L127.146 103.126C127.438 103.998 126.938 104.952 126.061 105.201Z",fill:"#737F8E"}),r.createElement("path",{d:"M126.061 105.201L55.8475 126.865C54.9709 127.155 54.0108 126.657 53.7603 125.786L22.2018 24.8557C21.9096 23.9842 22.4105 23.0297 23.2872 22.7807L93.5006 1.11725C94.3772 0.826749 95.3373 1.32476 95.5878 2.19628L127.146 103.126C127.438 103.998 126.938 104.952 126.061 105.201Z",fill:"url(#paint3_linear)"}),r.createElement("g",{opacity:"0.8",fillRule:"evenodd",clipRule:"evenodd"},r.createElement("path",{d:"M87.4585 104.745C82.9732 106.136 79.8932 107.1 79.3914 107.275C79.3705 107.275 79.3392 107.286 79.2922 107.301C79.2453 107.317 79.1826 107.338 79.0992 107.358C79.0992 107.358 77.8468 107.69 76.4693 107.566C66.7847 106.653 56.3487 88.517 56.3487 88.517C44.3264 67.642 34.0991 39.3799 30.3004 28.3407C30.0499 27.5522 30.4256 26.7222 31.1353 26.5147L90.37 8.25428C90.704 8.12978 91.0797 8.21278 91.3719 8.37878C91.7667 8.57503 91.9748 8.99401 92.0668 9.17931C92.0721 9.18994 92.077 9.1998 92.0816 9.2088C92.2557 9.5607 92.7929 10.9411 93.6284 13.0881C98.6732 26.0524 114.596 66.9697 127.168 78.212C131.177 76.962 133.784 76.1497 133.784 76.1497C133.784 76.1497 135.955 75.8592 136.998 76.4817C138.292 77.2702 140.004 78.6813 140.63 81.0053C141.34 83.5784 140.463 86.0684 139.378 87.3549C138.352 88.7002 136.763 89.4849 136.628 89.5516L136.622 89.5545L136.497 89.596L135.918 89.775C135.915 89.7936 135.913 89.8035 135.913 89.8035C135.913 89.8035 123.987 93.4698 111.084 97.4463L87.4585 104.745Z",fill:"#E1DFDD"}),r.createElement("path",{d:"M87.4585 104.745C82.9732 106.136 79.8932 107.1 79.3914 107.275C79.3705 107.275 79.3392 107.286 79.2922 107.301C79.2453 107.317 79.1826 107.338 79.0992 107.358C79.0992 107.358 77.8468 107.69 76.4693 107.566C66.7847 106.653 56.3487 88.517 56.3487 88.517C44.3264 67.642 34.0991 39.3799 30.3004 28.3407C30.0499 27.5522 30.4256 26.7222 31.1353 26.5147L90.37 8.25428C90.704 8.12978 91.0797 8.21278 91.3719 8.37878C91.7667 8.57503 91.9748 8.99401 92.0668 9.17931C92.0721 9.18994 92.077 9.1998 92.0816 9.2088C92.2557 9.5607 92.7929 10.9411 93.6284 13.0881C98.6732 26.0524 114.596 66.9697 127.168 78.212C131.177 76.962 133.784 76.1497 133.784 76.1497C133.784 76.1497 135.955 75.8592 136.998 76.4817C138.292 77.2702 140.004 78.6813 140.63 81.0053C141.34 83.5784 140.463 86.0684 139.378 87.3549C138.352 88.7002 136.763 89.4849 136.628 89.5516L136.622 89.5545L136.497 89.596L135.918 89.775C135.915 89.7936 135.913 89.8035 135.913 89.8035C135.913 89.8035 123.987 93.4698 111.084 97.4463L87.4585 104.745Z",fill:"url(#paint4_linear)"})),r.createElement("g",{opacity:"0.75"},r.createElement("path",{d:"M140.63 81.0053C140.004 78.6813 138.292 77.2703 136.998 76.4817C135.955 75.8592 133.784 76.1497 133.784 76.1497C133.784 76.1497 85.5695 91.1731 84.9434 91.4221C84.9016 91.4221 84.9016 91.4636 84.9016 91.4636C84.5677 91.5881 84.4007 91.8371 84.3172 91.9201C84.2755 92.0031 84.0667 92.2521 84.025 92.6256C84.025 92.8746 84.0667 93.0821 84.0667 93.1651C84.0667 93.2481 84.1085 93.2896 84.1085 93.3311C85.1103 96.2777 85.4025 97.7302 85.4025 97.7302C85.5278 98.1452 85.6948 98.8092 85.6948 99.7222C85.6948 102.586 84.025 105.034 81.6456 106.238C80.5185 106.902 79.5166 107.234 79.2662 107.275C98.3432 101.382 117.42 95.4891 136.497 89.596L136.622 89.5545C136.706 89.513 138.334 88.7245 139.378 87.355C140.463 86.0684 141.34 83.5784 140.63 81.0053Z",fill:"#A19F9D"}),r.createElement("path",{d:"M140.63 81.0053C140.004 78.6813 138.292 77.2703 136.998 76.4817C135.955 75.8592 133.784 76.1497 133.784 76.1497C133.784 76.1497 85.5695 91.1731 84.9434 91.4221C84.9016 91.4221 84.9016 91.4636 84.9016 91.4636C84.5677 91.5881 84.4007 91.8371 84.3172 91.9201C84.2755 92.0031 84.0667 92.2521 84.025 92.6256C84.025 92.8746 84.0667 93.0821 84.0667 93.1651C84.0667 93.2481 84.1085 93.2896 84.1085 93.3311C85.1103 96.2777 85.4025 97.7302 85.4025 97.7302C85.5278 98.1452 85.6948 98.8092 85.6948 99.7222C85.6948 102.586 84.025 105.034 81.6456 106.238C80.5185 106.902 79.5166 107.234 79.2662 107.275C98.3432 101.382 117.42 95.4891 136.497 89.596L136.622 89.5545C136.706 89.513 138.334 88.7245 139.378 87.355C140.463 86.0684 141.34 83.5784 140.63 81.0053Z",fill:"url(#paint5_linear)",fillOpacity:"0.5"})),r.createElement("path",{d:"M57.267 4.27083C54.1779 5.26685 52.4664 8.54542 53.4266 11.6165C54.4284 14.6876 57.7262 16.3891 60.8152 15.4346C63.9043 14.4385 65.6158 11.16 64.6557 8.08891C63.6538 4.97635 60.3561 3.27481 57.267 4.27083ZM59.7299 12.0315C58.5193 12.405 57.1835 11.741 56.8078 10.5375C56.4321 9.33394 57.1 8.00591 58.3106 7.6324C59.5212 7.25889 60.857 7.92291 61.2327 9.12643C61.6084 10.33 60.9822 11.658 59.7299 12.0315Z",fill:"#A19F9D"}),r.createElement("path",{d:"M57.267 4.27083C54.1779 5.26685 52.4664 8.54542 53.4266 11.6165C54.4284 14.6876 57.7262 16.3891 60.8152 15.4346C63.9043 14.4385 65.6158 11.16 64.6557 8.08891C63.6538 4.97635 60.3561 3.27481 57.267 4.27083ZM59.7299 12.0315C58.5193 12.405 57.1835 11.741 56.8078 10.5375C56.4321 9.33394 57.1 8.00591 58.3106 7.6324C59.5212 7.25889 60.857 7.92291 61.2327 9.12643C61.6084 10.33 60.9822 11.658 59.7299 12.0315Z",fill:"url(#paint6_linear)",fillOpacity:"0.75"}),r.createElement("path",{d:"M77.0118 15.4757L47.4987 24.6059C47.0396 24.7304 46.5804 24.4814 46.4551 24.0664L43.6583 15.1852C43.5331 14.7287 43.7835 14.2722 44.201 14.1477L73.714 5.01751C74.1732 4.89301 74.6324 5.14201 74.7576 5.55702L77.5544 14.4382C77.7214 14.8947 77.471 15.3512 77.0118 15.4757Z",fill:"#A19F9D"}),r.createElement("path",{d:"M77.0118 15.4757L47.4987 24.6059C47.0396 24.7304 46.5804 24.4814 46.4551 24.0664L43.6583 15.1852C43.5331 14.7287 43.7835 14.2722 44.201 14.1477L73.714 5.01751C74.1732 4.89301 74.6324 5.14201 74.7576 5.55702L77.5544 14.4382C77.7214 14.8947 77.471 15.3512 77.0118 15.4757Z",fill:"url(#paint7_linear)"}),r.createElement("path",{d:"M111.966 14.474C110.693 14.9305 110.333 15.2796 109.89 16.5418C109.447 15.2796 109.087 14.9037 107.814 14.474C109.087 14.0175 109.447 13.6684 109.89 12.4062C110.333 13.6684 110.693 14.0175 111.966 14.474Z",fill:"#737F8E"}),r.createElement("path",{d:"M24.2442 68.7524C22.0157 69.5513 21.3859 70.1622 20.6107 72.371C19.8356 70.1622 19.2058 69.5043 16.9773 68.7524C19.2058 67.9535 19.8356 67.3425 20.6107 65.1338C21.3859 67.3425 22.0157 67.9535 24.2442 68.7524Z",fill:"#737F8E"}),r.createElement("path",{d:"M154.53 103.906C152.301 104.705 151.671 105.316 150.896 107.524C150.121 105.316 149.491 104.658 147.263 103.906C149.491 103.107 150.121 102.496 150.896 100.287C151.671 102.496 152.301 103.107 154.53 103.906Z",fill:"#737F8E"})),r.createElement("defs",null,r.createElement("radialGradient",{id:"paint0_radial",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"matrix(7.22649 147.33989 -218.72708 10.72777 74.681 -19.011)"},r.createElement("stop",{stopColor:"#C8C6C4"}),r.createElement("stop",{offset:"1",stopColor:"#B7C4D3",stopOpacity:"0"})),r.createElement("linearGradient",{id:"paint1_linear",x1:"46.162",y1:"11.824",x2:"40.37",y2:"22.436",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#C8C6C4"}),r.createElement("stop",{offset:"1",stopColor:"#3B3A39"})),r.createElement("linearGradient",{id:"paint2_linear",x1:"73.651",y1:"1.615",x2:"73.651",y2:"128.202",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#737F8E"}),r.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})),r.createElement("linearGradient",{id:"paint3_linear",x1:"74.674",y1:"1.034",x2:"74.674",y2:"126.948",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#B7C4D3"}),r.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})),r.createElement("linearGradient",{id:"paint4_linear",x1:"80.823",y1:"72.888",x2:"65.627",y2:"131.074",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#fff"}),r.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})),r.createElement("linearGradient",{id:"paint5_linear",x1:"116.638",y1:"54.278",x2:"89.841",y2:"127.755",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#EDEBE9"}),r.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})),r.createElement("linearGradient",{id:"paint6_linear",x1:"61.399",y1:"0.411",x2:"57.063",y2:"15.572",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.114",stopColor:"#F3F2F1"}),r.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})),r.createElement("linearGradient",{id:"paint7_linear",x1:"86.236",y1:"-7.267",x2:"42.807",y2:"26.802",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#EDEBE9"}),r.createElement("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"}))))}},{disableWarnings:!0})}},34029:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(11766),n=r.createContext(void 0)},34053:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=e=>({homeButtonTooltip:"Home",backButtonTooltip:"Back",overflowButtonTooltip:"More items",refreshMenuItemText:"Refresh",refreshMenuItemTooltip:"Refresh",backMenuItemText:"Back",backMenuItemTooltip:"Back",forwardMenuItemText:"Forward",forwardMenuItemTooltip:"Forward",retryButtonText:"Try again",closeButtonAriaLabel:"Close panel",privacyWarning:"",subComponentStrings:{errorState:e=>{var{error:t}=e;return{InvalidUrlError:{title:"Bad Request",description:"The address you are trying to access is not valid."},DocumentNotFoundError:{title:"It's feeling a little empty here",description:"You don't have any help content at this time."},DocumentForbiddenError:{title:"Unauthorized",description:"Sorry, you don't have access to this document."},DocumentResolutionError:{title:"Error",description:"Sorry, there was an error loading the document you requested."}}[null==t?void 0:t.name]||{title:"Error",description:"Sorry, an error has occurred. Please try again later."}}}})},34054:function(e,t,i){"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",(function(){return a}));var a=e=>({commandBarContainer:{position:"sticky",top:0,zIndex:1,"@media (max-height: 480px)":{position:"relative",marginTop:26,marginBottom:24}},subComponentStyles:{panel:{main:n({},e.isFirstLoad?{}:{animation:"none"}),header:{paddingLeft:10,paddingRight:10},content:{paddingLeft:10,paddingRight:10},scrollableContent:{selectors:{"::-webkit-scrollbar":{width:4,height:4},"::-webkit-scrollbar-track":{},"::-webkit-scrollbar-thumb":{backgroundColor:"rgba(110, 111, 119, 0.6)",borderRadius:7}}},commands:{"@media (max-height: 480px)":{paddingBottom:0,paddingRight:0}}},titleShimmer:{root:{marginTop:12}},mediaBlockShimmer:{root:{marginTop:16}},textBlockShimmer:{root:{marginTop:5}},commandBar:{root:{height:32,paddingTop:32,paddingRight:0,paddingBottom:16,paddingLeft:0}},homeButton:{root:{color:e.theme.palette.neutralSecondary},rootHovered:{color:e.theme.palette.neutralPrimary}},backButton:{root:{color:e.theme.palette.neutralSecondary},rootHovered:{color:e.theme.palette.neutralPrimary},rootDisabled:{backgroundColor:"transparent"}},overflowButton:{root:{color:e.theme.palette.neutralSecondary,marginLeft:5},menuIcon:{display:"none"},rootHovered:{color:e.theme.palette.neutralPrimary}},errorState:{root:{position:"absolute",width:"100%",top:"30%",left:0,right:10}}}})},34055:function(e,t,i){},34056:function(e,t,i){"use strict";i(11766),i(13254),i(34029)},34057:function(e,t,i){"use strict";i(34058),i(34061),i(34062),i(34059),i(34060),i(34063)},34058:function(e,t,i){"use strict";var r=i(34059);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=u(e);if(t){var n=u(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return l(this,i)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.a},34059:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(34060);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=u(e);if(t){var n=u(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return l(this,i)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(l,e);var t,i,r,o=s(l);function l(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(i=o.call(this,t)).url=e,i.name="DocumentResolutionError",Object.setPrototypeOf(c(i),new.target.prototype),i}return t=l,i&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(r.a)},34060:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function o(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return l(e,arguments,d(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u(i,e)})(e)}function l(e,t,i){if(c())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var n=new(e.bind.apply(e,r));return i&&u(n,i.prototype),n}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(c=function(){return!!e})()}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i.d(t,"a",(function(){return p}));var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,i,n,s,l,p=(t=h,i=c(),function(){var e,r=d(t);if(i){var n=d(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return o(this,e)});function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=p.call(this,e)).name="InAppBrowserError",Object.setPrototypeOf(a(t),new.target.prototype),t}return n=h,s&&r(n.prototype,s),l&&r(n,l),Object.defineProperty(n,"prototype",{writable:!1}),n}(s(Error))},34061:function(e,t,i){"use strict";var r=i(34059);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=u(e);if(t){var n=u(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return l(this,i)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.a},34062:function(e,t,i){"use strict";var r=i(34059);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=u(e);if(t){var n=u(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return l(this,i)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.a},34063:function(e,t,i){"use strict";var r=i(34059);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=u(e);if(t){var n=u(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return l(this,i)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.a},34064:function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"a",(function(){return c}));var r=i(12754),n=i(17719),o=(i(14962),Object(r.Y)().palette),a=e=>({groupHeader:["fl-ContextualHelpPanel-groupHeader",{fontSize:r.k.medium,color:o.neutralSecondary,fontWeight:r.l.semibold,paddingTop:10,paddingBottom:5,display:"block"}],title:["fl-ContextualHelpPanel-Title",{display:"flex",alignItems:"center",selectors:{".fl-ApiIcon":{borderRadius:2,padding:0},h2:{fontSize:r.k.medium,color:o.neutralPrimary,fontWeight:r.l.semibold,lineHeight:20,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:8,whiteSpace:"normal",width:254}}}],descriptionLearnMoreLinkStyle:["fl-ContextualHelpPanel-Description-LearnMore-Link",{display:"flex",alignItems:"start",alignSelf:"flex-start",flexGrow:0,color:n.a.Blue,paddingTop:8,fontSize:r.k.medium,textDecoration:"underline"}],documentationCard:["fl-ContextualHelpPanel-DocumentationCard",{background:o.white,selectors:{".ba-Card":{paddingTop:0,marginTop:17,paddingLeft:16,paddingRight:16,paddingBottom:12,a:{":hover, :focus, :active":{textDecoration:"none"},color:n.a.Blue,whiteSpace:"normal"}}}}],documentationCardTitleStyle:["fl-ContextualHelpPanel-DocumentationCard-Title",{display:"flex",alignItems:"start",alignSelf:"flex-start",flexGrow:0,marginTop:12,selectors:{i:{width:24,height:24,color:n.a.Blue,display:"flex",alignItems:"center",textAlign:"center",fontSize:r.k.large},p:{flex:"none",order:1,alignSelf:"center",flexGrow:0,fontSize:r.k.medium,fontWeight:r.l.semibold,textDecoration:"underline",marginLeft:2,padding:0,width:244}}}],documentationCardSummaryStyle:["fl-ContextualHelpPanel-DocumentationCard-Summary",{selectors:{p:{display:"-webkit-box",WebkitLineClamp:"2",WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal",flex:"none",order:"1",alignSelf:"flex-start",flexGrow:"0",fontSize:r.k.medium,paddingTop:14,color:o.neutralSecondary}}}],shadowedStyle:["fl-ContextualHelpPanel-Shadow",{boxShadow:"rgba(0, 0, 0, 0.14) 0px 2px 4px",padding:"12px 16px",background:o.white}],chatBotContainerSkylight:["fl-ChatBot-container--skylight",{marginTop:90}],chatIcon:["fl-ContextualHelpPanel-botHelp-circleIcon",{selectors:{":hover":{backgroundColor:n.a.Blue,boxShadow:"none"},":focus":{boxShadow:"none"},":active":{backgroundColor:n.a.Blue,boxShadow:"none"}}}]}),s=()=>({padding:0,fontSize:r.k.medium,overflow:"hidden",textOverflow:"ellipsis",color:o.neutralSecondary}),l=()=>({subComponentStyles:{panel:{main:{backgroundColor:o.neutralLighterAlt},root:{top:90,left:"70%",width:"30%"},header:{paddingLeft:16,paddingRight:53},headerText:{left:15,fontSize:r.k.xLarge,color:o.neutralPrimary},content:{paddingTop:10,paddingLeft:16,paddingRight:16,collapsibleSection:{root:{mariginTop:20}}},collapsibleSection:{root:{mariginTop:20}},closeButton:{fontSize:r.k.mediumPlus,color:o.neutralPrimary}}}}),c=()=>({root:{marginTop:16,marginLeft:0,marginRight:0,selectors:{button:{height:"auto",padding:12,alignItems:"baseline"}}},subComponentStyles:{title:{text:{fontSize:14,textAlign:"left",whiteSpace:"normal",color:o.neutralSecondary,fontWeight:r.l.semibold}}},body:{paddingTop:0,paddingBottom:12}})},34065:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(11766),n=i(22925),o=i(34064),a=i(12706),s=i(14682),l=i(14346);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(g,e);var t,i,d,m=h(g);function g(){var e;c(this,g);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=m.call(this,...i)).classNames=Object(a.a)()(o.c),e}return t=g,(i=[{key:"render",value:function(){var{title:e,isCollapsed:t,description:i,detailSectionLearnMoreLink:a,isRecommendation:c,onHelpItemClicked:u,flowClientResources:d}=this.props;return r.createElement("div",{key:e},r.createElement(n.a,{key:e,title:e,collapsed:t,styles:o.a,titleProps:{[s.a]:"contextualhelp-description-collapsible",role:"button"}},!c&&i&&r.createElement("p",{style:Object(o.b)()},i),a&&r.createElement("span",{className:this.classNames.descriptionLearnMoreLinkStyle},r.createElement(l.a,{"aria-label":d.ContextualHelp.LearnMore,href:a,target:l.b.blank,"data-automation-id":"contextualhelp-description-link",onClick:u},d.ContextualHelp.LearnMore))))}}])&&u(t.prototype,i),d&&u(t,d),Object.defineProperty(t,"prototype",{writable:!1}),g}(r.Component)},34066:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34067),a=["isOpen","processName","activityRecommendations","defaultConnectorRecommendation","onDismiss","clientResources","cdnService"];r.a.directive(n.a.components.react.reactRecommendationPanel,[n.a.modules.reactDirective,e=>e(o.a,a)])},34067:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(11766),n=i(34068),o=i(12706),a=i(14956),s=i(13275),l=i(14650),c=i(13254),u=i(13285),d=i(34073),p=i(22925),h=i(34070),m=i(13259),g=i(13272),f=i(22784),v=i(34072);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var y=e=>{var t,i=e.clientResources,{isOpen:y,processName:w,activityRecommendations:S,defaultConnectorRecommendation:C,onDismiss:k}=e,[P,x]=r.useState(!1),A=Object(o.a)()(Object(d.a)(P)),T=Object(d.a)(P),R=(e,t)=>r.createElement(s.a,null,r.createElement(l.a,{className:A.defaultCardLabel},e),r.createElement(u.a,{className:A.description},t));return y?r.createElement(a.a,{isOpen:!0,headerText:i.AutomationPanel.Title,closeButtonAriaLabel:i.Manage.CustomApi.RightPane.Definition.Close.Label,isBlocking:!1,onDismiss:k,styles:A.subComponentStyles.panel,"data-automation-id":v.a.root},(t=S.map(t=>r.createElement(n.a,b({key:"RecommendationPanel.card.".concat(t.activityName)},t,{clientResources:e.clientResources,cdnService:e.cdnService}))),r.createElement(r.Fragment,null,r.createElement(l.a,{className:A.processName},w),r.createElement(u.a,{className:A.description},i.AutomationPanel.Description,r.createElement(c.a,{className:A.learnMoreLink,href:"https://go.microsoft.com/fwlink/?linkid=".concat(f.a.learnMore.automationPanelPresentation),target:"_blank","aria-label":i.AutomationPanel.LearnMoreConnectors},i.AutomationPanel.LearnMore)),t,(()=>{var{CustomConnector:t,DesktopFlowConnector:n}=i.AutomationPanel.DefaultCard,{Label:o,Description:a}=t,{Label:l,Description:u}=n,d=r.createElement(r.Fragment,null,a,r.createElement(c.a,{className:A.learnMoreLink,href:"https://go.microsoft.com/fwlink/?linkid=".concat(f.a.learnMore.customConnectorDescription),target:"_blank","aria-label":i.Manage.CustomConnections.ZeroCustomApis.learnMore},i.AutomationPanel.LearnMore));return r.createElement(p.a,{title:i.AutomationPanel.DefaultCard.Title,collapsed:P,styles:A.subComponentStyles.collapsible,roleAsButton:!0,onCollapsed:x},!P&&r.createElement(r.Fragment,null,r.createElement(m.a,{className:A.defaultCardIcon,iconName:g.a.Info,title:i.AutomationPanel.DefaultCard.Tooltip,styles:T.infoButtonTooltip}),r.createElement(s.a,{tokens:{childrenGap:12}},R(o,d),R(l,u),r.createElement(h.a,{recommendation:C,clientResources:e.clientResources,cdnService:e.cdnService}))))})()))):null}},34068:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(11766),n=i(12706),o=i(14650),a=i(13275),s=i(34069),l=i(22925),c=i(34070),u=e=>{var t,{activityName:i,connectorRecommendations:u,clientResources:d}=e,p=Object(n.a)()(s.a),[h,m]=r.useState(!1);return r.createElement(l.a,{title:i,collapsed:h,styles:p.subComponentStyles.collapsible,onCollapsed:m},!h&&r.createElement(a.a,null,r.createElement(o.a,null,d.AutomationPanel.Card.Description),(t=u,r.createElement("ul",null,t.map(t=>r.createElement("li",{key:"RecommendationCard.item.".concat(t.connectorFriendlyName)},r.createElement(c.a,{recommendation:t,clientResources:e.clientResources,cdnService:e.cdnService})))))))}},34069:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(12754),n=e=>{var t=Object(r.Y)().palette;return{description:["recommendationCard-description",{fontWeight:r.l.semibold,color:t.neutralPrimary}],subComponentStyles:{collapsible:{subComponentStyles:{title:{text:{fontWeight:r.l.semibold}}},root:{marginTop:20,minHeight:44},body:{paddingTop:0}}}}}},34070:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(11766),n=i(12706),o=i(13254),a=i(34071),s=i(13031),l=i(14343),c=i(34072),u=e=>{var{recommendation:t,cdnService:i}=e,u=Object(n.a)()(a.a),d=e.clientResources,p=t.connectorFriendlyName?Object(s.a)(d.Manage.CustomConnector.Icon.AriaLabel,t.connectorFriendlyName):d.Manage.CustomApi.General.icon;return r.createElement(o.a,{className:u.connectorButton,onClick:t.openConnectorRecommendation,"data-automation-id":c.a.recommendationButton},r.createElement(l.a,{brandColor:t.apiBrandColor,iconUri:t.apiIconUri,size:l.b.medium,className:u.connectorIcon,iconAriaLabel:p,cdnService:i}),t.connectorFriendlyName)}},34071:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(12754),n=e=>({connectorButton:["recommendationCard-button",{display:"flex",alignItems:"center",marginTop:12,color:Object(r.Y)().palette.neutralSecondary}],connectorIcon:["recommendationCard-icon",{marginRight:12}]})},34072:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r={root:"recommendation-panel",recommendationButton:"recommendation-button"}},34073:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(12754),n=e=>{var t=Object(r.Y)(),{palette:i,semanticColors:n}=t;return{processName:["recommendationPanel-process-name",{marginBottom:12}],description:["recommendationPanel-description",{color:i.neutralSecondary}],learnMoreLink:["recommendationPanel-learn-more-link",{marginLeft:4,"&:link, &:visited":{color:i.themeDark},"&:active, &:hover":{color:n.linkHovered}}],defaultCardLabel:["recommendationPanel-defaultCardLabel",{fontWeight:r.l.semibold}],defaultCardIcon:["recommendationPanel-defaultCardIcon",{"&:hover":{backgroundColor:"transparent"},selectors:{".ms-Icon":{fontSize:r.k.small}}}],subComponentStyles:{panel:{main:{backgroundColor:i.neutralLighterAlt},navigation:{backgroundColor:i.neutralLighterAlt},headerText:[t.fonts.xLarge,{color:i.neutralPrimary}],closeButton:[t.fonts.mediumPlus,{color:i.neutralPrimary}]},collapsible:{subComponentStyles:{title:{text:{fontWeight:r.l.semibold},root:{width:e?void 0:"calc(100% - 32px)"}}},root:{marginTop:20,minHeight:44},body:{paddingTop:0,paddingBottom:e?0:12,marginTop:e?0:-20}}},infoButtonTooltip:{root:{position:"relative",bottom:"16px",left:"calc(100% - 18px)"}}}}},34074:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(33440);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34075);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34076),this.bindings={errorAlert:"=",flow:"=",flowId:"<",flowName:"=",context:"=",populateRunOnlyUser:"<",showTile:"<",infoPane:"=?"},this.controller=o.a,this.controllerAs="flowRunOnlyTileCtrl"}));n.a.component(r.a.components.flowTiles.flowRunOnlyTile,new c)},34075:function(e,t,i){e.exports=i.p+"static/media/flowRunOnlyTile.a4510507.less"},34076:function(e,t){e.exports='<property-tile show-tile="flowRunOnlyTileCtrl.showTile" model="flowRunOnlyTileCtrl.flowRunOnlyTile" class="flow-run-only-tile">\n    <tile-content-template>\n        <spinner model="flowRunOnlyTileCtrl.runOnlySpinner"></spinner>\n        <div ng-show="flowRunOnlyTileCtrl.showTile" ng-repeat="sharepointPermission in flowRunOnlyTileCtrl.addedSharepointPermissions" class="info-card-item">\n            <div class="info-card-icon">\n                <img ng-src="{{sharepointPermission.iconUrl}}" />\n            </div>\n            <div class="info-card-text-section column medium-9">\n                <div class="info-card-title" title="{{sharepointPermission.title}}">{{sharepointPermission.title}}</div>\n                <div class="info-card-subtitle" title="{{sharepointPermission.subTitle}}">{{sharepointPermission.subTitle}}</div>\n            </div>\n        </div>\n        <div ng-show="flowRunOnlyTileCtrl.showTile" ng-repeat="user in flowRunOnlyTileCtrl.addedUsers | limitTo: 4" class="info-card-item">\n            <div class="info-card-icon">\n                <avatar mail="user.subTitle" display-name="user.title" image-src="user.iconUri" object-id="user.id"></avatar>\n            </div>\n            <div class="info-card-text-section column medium-9">\n                <div class="info-card-title" title="{{user.title}}">{{user.title}}</div>\n                <div class="info-card-subtitle" title="{{user.subTitle}}">{{user.subTitle}}</div>\n            </div>\n        </div>\n\n        <div ng-show="flowRunOnlyTileCtrl.showTile" class="info-card-item" ng-click="flowRunOnlyTileCtrl.addPersonClick($event)">\n            <div class="info-card-icon add-owner-icon">\n                <svg class="img-circle" svg-src="{{flowRunOnlyTileCtrl.addUserImage}}"></svg>\n            </div>\n            <div class="info-card-text-section column medium-9">\n                <a class="add-owner-title">\n                    {{::flowRunOnlyTileCtrl.clientResources.FlowPropertyTile.RunOnly.AddRunOnly}}\n                </a>\n            </div>\n        </div>\n        <info-pane pane-title="flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Title" expanded="flowRunOnlyTileCtrl.infoPane" toggle-button-event="flowRunOnlyTileCtrl.toggleButtonEvent" on-close="flowRunOnlyTileCtrl.onClose()">\n            <pane-content ng-show="flowRunOnlyTileCtrl.flow">\n                <div class="pane-section pane-alert" ng-if="flowRunOnlyTileCtrl.errorAlert && flowRunOnlyTileCtrl.errorAlert.message && !flowRunOnlyTileCtrl.showErrorMessageBar" ng-bind="flowRunOnlyTileCtrl.errorAlert.message"></div>\n                <div ng-if="flowRunOnlyTileCtrl.showErrorMessageBar" class="flow-runonly-section-react-text-message-bar">\n                    <react-text-message-bar\n                        type="flowRunOnlyTileCtrl.getMessageBarTypeForError"\n                        link="flowRunOnlyTileCtrl.textMessageBarLink"\n                        links-with-interpolation-props="flowRunOnlyTileCtrl.linksWithInterpolationProps"\n                        message="flowRunOnlyTileCtrl.textMessageBarMessage">\n                    </react-text-message-bar>\n                </div>\n                <div class="run-only-tabs" role="tablist" ng-if="flowRunOnlyTileCtrl.showTabs">\n                    <a class="run-only-tab"\n                        role="tab"\n                        tabindex="0"\n                        href\n                        aria-selected="{{flowRunOnlyTileCtrl.currentTab === flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Users}}"\n                        aria-label="{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Title}}"\n                        ng-class="{\'tab-active\': flowRunOnlyTileCtrl.isCurrentTab(flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Users)}"\n                        ng-click="flowRunOnlyTileCtrl.currentTab = flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Users">\n                        {{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.Users.Title}}\n                    </a>\n                    <a class="run-only-tab"\n                        role="tab"\n                        tabindex="0"\n                        href\n                        aria-selected="{{flowRunOnlyTileCtrl.currentTab === flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Sharepoint}}"\n                        aria-label="{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Title}}"\n                        ng-class="{\'tab-active\': flowRunOnlyTileCtrl.isCurrentTab(flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Sharepoint)}"\n                        ng-click="flowRunOnlyTileCtrl.currentTab = flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Sharepoint">\n                        {{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Title}}\n                    </a>\n                </div>\n                <div ng-show="flowRunOnlyTileCtrl.isCurrentTab(flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Users)" class="run-tile-users-section">\n                    <div class="pane-section">\n                        <h1 class="pane-heading">{{flowRunOnlyTileCtrl.getAddUsersTitle()}}</h1>\n                        <p class="pane-subheading">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Common.Invite.Description}}</p>\n                        <div class="run-tile-graph-container">\n                            <graph-autocomplete\n                                ng-if="!flowRunOnlyTileCtrl.isEntityFlow"\n                                on-select="flowRunOnlyTileCtrl.onUserAutocompleteSelect"></graph-autocomplete>\n                            <xrm-system-user-autocomplete\n                                ng-if="flowRunOnlyTileCtrl.isEntityFlow"\n                                on-select="flowRunOnlyTileCtrl.onUserAutocompleteSelect"></xrm-system-user-autocomplete>\n                            <p class="pane-alert" ng-show="flowRunOnlyTileCtrl.userAddedErrorMessage">{{flowRunOnlyTileCtrl.userAddedErrorMessage}}</p>\n                        </div>\n                        <info-card ng-repeat="user in flowRunOnlyTileCtrl.pendingUsersToAdd" model="user">\n                            <info-card-icon-template>\n                                <avatar mail="user.subTitle" display-name="user.title" image-src="user.iconUri" object-id="user.id"></avatar>\n                            </info-card-icon-template>\n                            <info-card-option-template>\n                                <button class="c-glyph glyph-delete option-block" ng-click="flowRunOnlyTileCtrl.onDeletePendingToAddUser($event,user)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneSaveButton" aria-label={{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Common.DeleteUser}}></button>\n                            </info-card-option-template>\n                        </info-card>\n                    </div>\n                    <div class="pane-section">\n                        <h1 class="pane-heading">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Common.Shared.Title}}</h1>\n                        <div class="info-card-container" ng-repeat="user in flowRunOnlyTileCtrl.addedUsers" ng-class="{\'disabled\': user.disabled}">\n                            <info-card model="user">\n                                <info-card-icon-template>\n                                    <avatar mail="user.subTitle" display-name="user.title" image-src="user.iconUri" object-id="user.id"></avatar>\n                                </info-card-icon-template>\n                                <info-card-option-template>\n                                    <button class="c-glyph glyph-delete option-block" ng-click="flowRunOnlyTileCtrl.onDeleteAddedUser(user)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton" ng-hide="user.disabled" aria-label={{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Common.DeleteUser}}></button>\n                                    <button class="c-glyph glyph-create option-block" ng-click="flowRunOnlyTileCtrl.onAddAddedUser(user)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton" ng-show="user.disabled" aria-label={{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Common.AddUser}}></button>\n                                </info-card-option-template>\n                            </info-card>\n                        </div>\n                        <p class="pane-subheading" ng-if="flowRunOnlyTileCtrl.addedUsers.length === 0">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.Users.ZeroShared}}</p>\n                    </div>\n                </div>\n                <div ng-show="flowRunOnlyTileCtrl.isCurrentTab(flowRunOnlyTileCtrl.flowRunOnlyTileTabs.Sharepoint)" class="run-tile-sharepoint-section">\n                    <div class="pane-section">\n                        <h1 class="pane-heading">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Invite.Title}}</h1>\n                        <p class="pane-subheading">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Common.Invite.Description}}</p>\n                        <div class="run-tile-sharepoint-container">\n                            <div class="dropdown-label">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Site}}</div>\n                            <select name="sharepoint-site-selection" id="sharepoint-site-selection" ng-options="sharepointSiteUrls as flowRunOnlyTileCtrl.allSharepointSites[sharepointSiteUrls].displayName || sharepointSiteUrls for sharepointSiteUrls in flowRunOnlyTileCtrl.sharepointSiteUrls" ng-model="flowRunOnlyTileCtrl.selectedSharepointListIdentifier.site"\n                                ng-change="flowRunOnlyTileCtrl.onSelectSharepointSite()" data-js="flowrunonlytile-sharepointsite-selection">\n                            </select>\n                            <div class="dropdown-label">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.ListLibrary}}</div>\n                            <select name="sharepoint-list-selection" id="sharepoint-list-selection" ng-options="sharepointListOption.id as sharepointListOption.displayName || sharepointListOption.id for sharepointListOption in flowRunOnlyTileCtrl.sharepointListOptions | orderBy:\'displayName\'"\n                                ng-model="flowRunOnlyTileCtrl.selectedSharepointListIdentifier.list" ng-change="flowRunOnlyTileCtrl.onSelectSharepointList()" ng-disabled="!flowRunOnlyTileCtrl.sharepointListOptions || flowRunOnlyTileCtrl.sharepointListOptions.length < 1" data-js="flowrunonlytile-sharepointlist-selection">\n                            </select>\n                            <button class="c-button" type="submit" ng-click="flowRunOnlyTileCtrl.onAddPendingSharepointPermission()" ng-disabled="!flowRunOnlyTileCtrl.enableAddSharepointListButton">{{flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Invite.AddList}}</button>\n                        </div>\n                        <info-card ng-repeat="sharepointPermission in flowRunOnlyTileCtrl.pendingSharepointPermissionsToAdd" model="sharepointPermission">\n                            <info-card-icon-template>\n                                <img ng-src="{{sharepointPermission.iconUrl}}" />\n                            </info-card-icon-template>\n                            <info-card-option-template>\n                                <button class="c-glyph glyph-delete option-block" ng-click="flowRunOnlyTileCtrl.onDeletePendingToAddSharepointPermission($event,sharepointPermission)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneSaveButton"></button>\n                            </info-card-option-template>\n                        </info-card>\n                        <p class="pane-alert" ng-show="flowRunOnlyTileCtrl.sharepointListAddedErrorMessage">{{flowRunOnlyTileCtrl.sharepointListAddedErrorMessage}}</p>\n                    </div>\n                    <div class="pane-section">\n                        <h1 class="pane-heading">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Common.Shared.Title}}</h1>\n                        <div class="info-card-container" ng-repeat="sharepointPermission in flowRunOnlyTileCtrl.addedSharepointPermissions" ng-class="{\'disabled\': sharepointPermission.disabled}">\n                            <info-card model="sharepointPermission">\n                                <info-card-icon-template>\n                                    <img ng-src="{{sharepointPermission.iconUrl}}" />\n                                </info-card-icon-template>\n                                <info-card-option-template>\n                                    <button class="c-glyph glyph-delete option-block" ng-click="flowRunOnlyTileCtrl.onDeleteAddedSharepointPermission(sharepointPermission)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton" ng-hide="sharepointPermission.disabled"></button>\n                                    <button class="c-glyph glyph-create option-block" ng-click="flowRunOnlyTileCtrl.onAddAddedSharepointPermission(sharepointPermission)" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton" ng-show="sharepointPermission.disabled"></button>\n                                </info-card-option-template>\n                            </info-card>\n                        </div>\n                        <p class="pane-subheading" ng-if="flowRunOnlyTileCtrl.addedSharepointPermissions.length === 0">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.ZeroShared}}</p>\n                    </div>\n                </div>\n                <div class="pane-section" ng-if="flowRunOnlyTileCtrl.showNewConnectionsManagementSection">\n                    <h1 class="pane-heading">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Connections.NewConnections.Title}}</h1>\n                    <div class="c-checkbox">\n                        <label class="c-label">\n                            <input type="checkbox" ng-model="flowRunOnlyTileCtrl.defaultToEmbeddedConnections" ng-change="flowRunOnlyTileCtrl.onDefaultToEmbeddedConnectionsChange()"><span>{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Connections.NewConnections.DefaultToEmbeddedConnectionsDescription}}</span>\n                        </label>\n                    </div>\n                </div>\n                <div class="pane-section" ng-if="flowRunOnlyTileCtrl.showConnectionManagementSection">\n                    <spinner model="flowRunOnlyTileCtrl.connectionSpinner"></spinner>\n                    <h1 class="pane-heading" ng-if="!flowRunOnlyTileCtrl.connectionSpinner.show">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Connections.ConnectionsUsed.Title}}</h1>\n                    <p class="pane-subheading" ng-if="!flowRunOnlyTileCtrl.connectionSpinner.show">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Connections.ConnectionsUsed.Description}}</p>\n                    <div class="row connection-warning-message" ng-if="flowRunOnlyTileCtrl.showConnectionWarningMessage">\n                        <div class="column small-1 icon-column">\n                            <div class="c-glyph glyph-warning">\n                            </div>\n                        </div>\n                        <div class="column small-11">\n                            <p class="error-details">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Connections.ConnectionsUsed.Warning}}</p>\n                        </div>\n                    </div>\n                    <div class="row connection-warning-message" ng-if="flowRunOnlyTileCtrl.showDraftFlowWarningMessage">\n                        <div class="column small-1 icon-column">\n                            <div class="c-glyph glyph-warning">\n                            </div>\n                        </div>\n                        <div class="column small-11">\n                            <p class="error-details">{{::flowRunOnlyTileCtrl.clientResources.FlowInfoPane.RunOnly.Connections.ConnectionsUsed.DraftFlowWarning}}</p>\n                        </div>\n                    </div>\n\n                    <div class="info-card-container connection-card-container" ng-repeat="connectionReference in flowRunOnlyTileCtrl.runtimeConnectionCards">\n                        <info-card model="connectionReference">\n                            <info-card-icon-template>\n                                <img ng-attr-src="{{connectionReference.iconUrl}}" img-on-error-src="{{::flowRunOnlyTileCtrl.assetService.connection}}" role="presentation" />\n                            </info-card-icon-template>\n                            <info-card-option-template>\n                                <select\n                                    ng-if="connectionReference.availableConnectionOptions"\n                                    type="text"\n                                    ng-model="connectionReference.selectedConnection"\n                                    ng-change="flowRunOnlyTileCtrl.onRuntimeConnectionSelectionChange(connectionReference.id)"\n                                    aria-label="{{::flowRunOnlyTileCtrl.getAriaLabelForConnectionSelectElement(connectionReference)}}">\n                                    <option ng-repeat="connectionOption in connectionReference.availableConnectionOptions" value="{{connectionOption.value}}">{{connectionOption.displayName}}</option>\n                                </select>\n                            </info-card-option-template>\n                        </info-card>\n                    </div>\n                </div>\n                <div class="pane-section pane-actions">\n                    <button class="c-button" type="submit" ng-click="flowRunOnlyTileCtrl.onSave()" ng-disabled="!flowRunOnlyTileCtrl.enablePaneSaveButton">{{::flowRunOnlyTileCtrl.clientResources.Common.Save}}</button>\n                    <button class="c-button btn-secondary" ng-click="flowRunOnlyTileCtrl.onCancel()" ng-disabled="!flowRunOnlyTileCtrl.enablePaneCancelButton">{{::flowRunOnlyTileCtrl.clientResources.Common.Cancel}}</button>\n                    <spinner model="flowRunOnlyTileCtrl.infoPaneSpinner"></spinner>\n                </div>\n            </pane-content>\n        </info-pane>\n        <modal-dialog model="flowRunOnlyTileCtrl.useEmbeddedConnectionDialog" aria-label="{{flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Title}} {{flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Description}}">\n            <dialog-header-content-template>\n                <span>{{::flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Title}}</span>\n            </dialog-header-content-template>\n            <dialog-body-content-template>\n                <div>{{::flowRunOnlyTileCtrl.clientResources.ModalDialog.RunOnly.Description}}</div>\n            </dialog-body-content-template>\n        </modal-dialog>\n    </tile-content-template>\n</property-tile>\n'},34077:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34078);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34082);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34083),this.bindings={modalDialog:"<"},this.controller=o.a,this.controllerAs="flowSaveAsDialogCtrl"}));r.a.component(n.a.components.flowSaveAsDialog,new c)},34078:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var r=i(14751),n=i.n(r),o=i(33327),a=i(33360),s=i(33396),l=i(33353),c=i(33394),u=i(33390),d=i(33354),p=i(33383),h=i(33437),m=i(33392),g=i(16806),f=i(34079),v=i(12366),b=i(16926),y=i(14867),w=i(34080),S=i(13009),C=i(15339),k=i(13e3),P=i(13202),x=i(20920),A=i(12999),T=i(20808),R=i(18956),O=i(15422);function D(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var F=function(e){return e[e.Initializing=0]="Initializing",e[e.InitFailed=1]="InitFailed",e[e.ConnectionWizard=2]="ConnectionWizard",e[e.SavingDialog=3]="SavingDialog",e}(F||{}),I=function(){function e(t,i,r,n,o,a,c,u,d,h,m,f,S,T,O,D,E,I,j,N,M,L,U,B,$,q,W,z,H){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$scope=i,this.$timeout=r,this.$routeParams=n,this.appSettings=o,this.clientResources=a,this.connectionsClient=c,this.flowsClient=u,this.loggingService=d,this.ngFlowService=h,this.policiesService=m,this.promiseHelperService=f,this.sessionService=S,this.telemetryService=T,this.apisClient=O,this.designerCoreLoaderService=D,this.environmentService=E,this.planService=I,this.telemetry=j,this.graphService=N,this.assetService=M,this.licenseManagementService=L,this.consentService=U,this.cdnService=B,this.userDetailsStore=$,this.xrmConnectionReferenceService=q,this.xrmConnectionReferenceStore=W,this.designerConnectionStore=z,this.neptuneService=H,this.flowDisplayName=void 0,this.flowNameMaxLength=v.n,this.flow=void 0,this.isLegacySharedFlow=void 0,this.isSolutionFlow=void 0,this.solutionId=void 0,this.modalDialog=void 0,this.state=F.Initializing,this.savingDialogDescription="",this.creatingConnectionDescription="",this.connections=void 0,this.connectionReferencesToFill=void 0,this.connectionReferencesForConnectionDisambiguationComponent=void 0,this.updatedConnectionReferences=null,this.designerCreateConfigParameters=void 0,this.saveActionButton={label:this.clientResources.Dialogs.FlowSaveAs.Save,action:()=>{this.onSave()},primary:!0,disabled:!0},this.cancelActionButton={label:this.clientResources.Common.Cancel,action:()=>{this.onCancel()}},this.savingDialogButtons=[this.saveActionButton,this.cancelActionButton],this.showButtonActionProgressSpinner=!1,this.errorAlert={type:l.a.None,message:"",options:{}},this.loadingSpinner={size:p.c.Large,local:p.a.Global,show:!0},this.$onInit=()=>{var e;this.modalDialog.disableDefaultStyles=!0,this.modalDialog.overrideFocus=!0;var t=this.flowsClient.refresh({id:this.modalDialog.flowId});this.connectionsClient.refreshQuery().then(()=>{this.connections=this.connectionsClient.query(this.$scope)}).then(()=>this.$q.all([t,this.connections.$promise]).then(()=>this.modalDialog.flowData?(e=this.modalDialog.flowData,this.$q.resolve()):(e=this.flowsClient.get(this.$scope,{id:this.modalDialog.flowId})).$promise).then(()=>{this.flow=e,this.isSolutionFlow=Object(b.y)(this.flow),Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow&&this.environmentService.getCurrentEnvironment().hasXrmInstance?this.xrmConnectionReferenceService.getXrmConnectionReferences({forceRefresh:!0}):this.$q.resolve()}).then(()=>{Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow&&(this.solutionId=this.flow.properties.isManaged?Object(R.a)():Object(s.e)()),this.loggingService.logInfo("flowSaveAsDialogCtrl.onInit","Status of flow definition",{isFlowDefinitionPresent:!!this.flow.properties.definition,isSolutionFlow:this.isSolutionFlow}),this.ensureFlowConnectionReferenceConnectionName();var e=!1,t=!1;if(Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow&&this.environmentService.getCurrentEnvironment().hasXrmInstance){var i=this.getConnectionReferencesInEnvironment(),r=this.getUserOwnedConnectionsFromConnectionReferences(i);e=Object(w.c)(this.flow,r),t=!Object(y.a)(this.flow.properties.connectionReferences)}!Object(A.a)().enableSolutionFlowSaveAsACopy&&Object(w.b)(this.flow,this.connections)||e||t||!this.isSolutionFlow&&Object(w.b)(this.flow,this.connections)?this.prepareToShowConnectionWizard():this.prepareToShowSavingDialog()}).catch(e=>{this.state=F.InitFailed,this.loggingService.logError("FlowSaveAsDialogCtrl.Constructor",e),this.showErrorMessage(e)}))},this.onInadequateQuotaLinkClick=()=>{this.$scope.$applyAsync(()=>{Object(g.e)({dialogType:this.sessionService.isConsumerDomain?g.b.blockedFeatureUpgradeToPro:g.b.blockedFeatureStartTrial,appSettings:this.appSettings,clientResources:this.clientResources,planService:this.planService,planStore:C.a,sessionStore:k.a,surfaceStore:P.a,telemetryService:this.telemetry,graphService:this.graphService,assetService:this.assetService,licenseManagementService:this.licenseManagementService,licenseManagementStore:x.a,neptuneService:this.neptuneService,consentService:this.consentService,featureFlags:this.appSettings.featureFlags,cdnService:this.cdnService,userDetailsStore:this.userDetailsStore,loggingService:this.loggingService})})},this.onConnectionReferencesResolved=e=>{Object(A.a)().enableSolutionFlowSaveAsACopy?this.updatedConnectionReferences=Object(y.p)(e,this.flow,!!Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow):this.updatedConnectionReferences=Object(y.o)(e,this.flow),this.connectionsClient.refreshQuery(),this.prepareToShowSavingDialog()},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowSaveAsDialogCtrl"})}var t,i,r;return t=e,(i=[{key:"prepareToShowConnectionWizard",value:function(){return this.ensureFlowConnectionReferenceApiDefinition().then(()=>{var e;if(this.isSolutionFlow&&Object(A.a)().enableSolutionFlowSaveAsACopy){this.loggingService.logInfo("flowSaveAsDialogCtrl.prepareToShowConnectionWizard","Formatting to connection references for user to choose for solution flow",{isFlowDefinitionPresent:!!this.flow.properties.definition,isSolutionFlow:this.isSolutionFlow}),this.connectionReferencesForConnectionDisambiguationComponent=Object(w.a)(this.flow,this.connections,this.isSolutionFlow);var t=this.getConnectionReferencesInEnvironment(),i=this.convertConnectionsToConnectionReferences(t);e=this.createCustomizedDesignerConfig(i),this.designerCreateConfigParameters={connectionsPromise:this.$q.resolve(i),downloadDesignerScriptsPromise:this.downloadDesignerScripts(),designerConfig:e}}else this.connectionReferencesForConnectionDisambiguationComponent=Object(w.a)(this.flow,this.connections),e=this.createCustomizedDesignerConfig(this.connections),this.designerCreateConfigParameters={connectionsPromise:this.$q.resolve(this.connections),downloadDesignerScriptsPromise:this.downloadDesignerScripts(),designerConfig:e};this.isSolutionFlow&&Object(A.a)().enableSolutionFlowSaveAsACopy?this.creatingConnectionDescription=1===Object.keys(this.connectionReferencesForConnectionDisambiguationComponent).length?this.clientResources.Dialogs.FlowSaveAs.CreateConnectionReferenceDescription:this.clientResources.Dialogs.FlowSaveAs.CreateConnectionReferencesDescription:this.creatingConnectionDescription=1===Object.keys(this.connectionReferencesForConnectionDisambiguationComponent).length?this.clientResources.Dialogs.FlowSaveAs.CreateConnectionDescription:this.clientResources.Dialogs.FlowSaveAs.CreateConnectionsDescription,this.state=F.ConnectionWizard})}},{key:"getConnectionReferencesInEnvironment",value:function(){this.xrmConnectionReferenceService.getXrmConnectionReferences({forceRefresh:!0});var e=this.environmentService.getCurrentEnvironmentName();return this.xrmConnectionReferenceStore.xrmConnectionReferences.getCollection(T.a.getCollectionType({environmentName:e})).list.map(e=>{var t;return null===(t=this.xrmConnectionReferenceStore.xrmConnectionReferences.getEntity(e))||void 0===t?void 0:t.toJS()}).filter(e=>!!e)}},{key:"convertConnectionsToConnectionReferences",value:function(e){var t=[],i=this.connections?new Map(this.connections.map(e=>[e.name,e])):new Map;return e.forEach(e=>{if(i.has(e.connectionid)){var r=n()(i.get(e.connectionid));r.id=e.connectionreferencelogicalname,r.name=e.connectionreferencelogicalname,r.properties.displayName=e.connectionreferencedisplayname,t.push(r)}}),t}},{key:"getUserOwnedConnectionsFromConnectionReferences",value:function(e){var t=[],i=this.connections?new Map(this.connections.map(e=>[e.name,e])):new Map;return e.forEach(e=>{i.has(e.connectionid)&&t.push(n()(e))}),t}},{key:"ensureFlowConnectionReferenceApiDefinition",value:function(){var e=this.loggingService.profileStart(d.a.saveAsFlowEnsureApiStart),t=Object(y.k)(this.flow),i=Object.entries(t).filter(e=>{var[,t]=e;return Object(a.o)(t.apiDefinition)&&!!t.id}).map(e=>{var[t,i]=e;return[t,this.apisClient.get(this.$scope,{id:i.id})]});return this.promiseHelperService.toAngularPromise(Promise.all(i.map(e=>e[1].$promise)).then(()=>{i.forEach(e=>{t[e[0]].apiDefinition={name:e[1].name,id:e[1].id,type:e[1].type,location:e[1].location,properties:e[1].properties}}),this.loggingService.profileEndWithSuccess(e,d.a.saveAsFlowEnsureApiEnd,{flowName:this.flow.name,totalReferences:Object.keys(t).length,missingApis:i.length})}).catch(r=>{throw this.showErrorMessage(r),this.loggingService.profileEnd(e,d.a.saveAsFlowEnsureApiEnd,Object(m.b)(r),r,{flowName:this.flow.name,totalReferences:Object.keys(t).length,missingApis:i.length}),r}))}},{key:"ensureFlowConnectionReferenceConnectionName",value:function(){Object.values(Object(y.k)(this.flow)).filter(e=>!Object(a.o)(e.connectionReferenceLogicalName)&&Object(a.o)(e.connectionName)).forEach(e=>{e.connectionName=Object(f.a)(this.designerConnectionStore.getConnectionIdFromDesignerConnectionId(e.connectionReferenceLogicalName))})}},{key:"prepareToShowSavingDialog",value:function(){this.flowDisplayName=this.getNewFlowDefaultDisplayName(),this.isLegacySharedFlow=Object(b.s)(this.flow),this.savingDialogDescription=this.isLegacySharedFlow?Object(a.d)(this.clientResources.Dialogs.FlowSaveAs.TeamFlowDescription,this.clientResources.Manage.Flows.MyFlows):Object(a.d)(this.clientResources.Dialogs.FlowSaveAs.PersonalFlowDescription,this.clientResources.Manage.Flows.MyFlows),this.saveActionButton.disabled=!1,this.state=F.SavingDialog}},{key:"createCustomizedDesignerConfig",value:function(e){var t={};return t.prefetchedData={connectionProviders:Object(y.b)(this.flow)?Object.keys(this.flow.properties.connectionReferences).map(e=>this.flow.properties.connectionReferences[e].apiDefinition):null},t.canAddOperation=e=>new Promise(t=>{this.$scope.$applyAsync(()=>{this.policiesService.checkCanAddOperation(e).then(e=>{t(e)})})}),t.connectionWizardUIConfig={defaultAccountDisplayName:this.sessionService.getUserInfo().displayName,hideConnectionWizardHeader:!0},Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow&&(t.isXrmConnectionReferenceMode=!0,t.solutionId=this.solutionId),t}},{key:"downloadDesignerScripts",value:function(){return this.promiseHelperService.toAngularPromise(this.designerCoreLoaderService.loadDesignerScripts())}},{key:"onCancel",value:function(){this.hideModalDialog(),this.telemetryService.tagEvent(h.a.FlowSaveAsDialogCancelButtonClicked,null,{originalFlowName:this.flow.name,isTeamFlow:this.isLegacySharedFlow,flowState:this.flow.properties.state})}},{key:"onSave",value:function(){this.showButtonActionProgressSpinner=!0,this.setAllButtonsDisabledState(!0),this.saveActionButton.label=this.clientResources.Dialogs.FlowSaveAs.Saving,this.telemetryService.tagEvent(h.a.FlowSaveAsDialogSaveButtonClicked,null,{originalFlowName:this.flow.name,isTeamFlow:this.isLegacySharedFlow,flowState:this.flow.properties.state,isFlowDefinitionPresent:!!this.flow.properties.definition});var e=this.loggingService.profileStart(this.isSolutionFlow?d.a.solutionFlowSaveAsFlowStart:d.a.saveAsFlowStart);Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow&&this.loggingService.logInfo("flowSaveAsDialogCtrl.onSave","Saving a solution flow using SaveAs",{isFlowDefinitionPresent:!!this.flow.properties.definition,isSolutionFlow:this.isSolutionFlow}),this.$q.when(this.flowDisplayName).then(()=>Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow?this.flowsClient.createSolutionFlow({solutionId:this.solutionId},this.getNewFlowDefinition()):this.ngFlowService.post({id:Object(s.d)(this.environmentService)},this.getNewFlowDefinition())).then(t=>{if(!Object(s.g)(t)){var i,r,n=new c.a(c.c.flowSaveAsFailed,this.clientResources.Error.FlowSaveAsFailed,null,{responseStatusCode:t&&t.status,responseData:t&&t.data,isFlowDefinitionPresent:!!this.flow.properties.definition});throw null===(i=(r=this.modalDialog).onError)||void 0===i||i.call(r,n),n}var o=t.data;this.flowsClient.refreshQuery(Object(s.c)({isPersonal:!0})),this.loggingService.profileEndWithSuccess(e,this.isSolutionFlow?d.a.solutionFlowSaveAsFlowEnd:d.a.saveAsFlowEnd,{newFlowName:o.name,originalFlowName:this.flow.name,isTeamFlow:this.isLegacySharedFlow,isSolutionFlow:this.isSolutionFlow,flowState:this.flow.properties.state,isFlowDefinitionPresent:!!this.flow.properties.definition}),this.modalDialog.show=!1,this.modalDialog.onHide({flowName:o.name})}).catch(t=>{var i,r,n=Object(m.b)(t);throw Object(O.p)(t)&&(n=S.e.Warning),this.loggingService.profileEnd(e,this.isSolutionFlow?d.a.solutionFlowSaveAsFlowEnd:d.a.saveAsFlowEnd,n,t,{originalFlowName:this.flow.name,isTeamFlow:this.isLegacySharedFlow,isSolutionFlow:this.isSolutionFlow,flowState:this.flow.properties.state,isFlowDefinitionPresent:!!this.flow.properties.definition}),this.showErrorMessage(t),null===(i=(r=this.modalDialog).onError)||void 0===i||i.call(r,t),Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow&&this.loggingService.logError("FlowSaveAsDialogCtrl.onSave.onSolutionFlowSave",t),t}).finally(()=>{this.setAllButtonsDisabledState(!1),this.saveActionButton.label=this.clientResources.Dialogs.FlowSaveAs.SaveAs,this.showButtonActionProgressSpinner=!1})}},{key:"getNewFlowDefinition",value:function(){var e,t={properties:{}};return e=Object(A.a)().enableSolutionFlowSaveAsACopy&&this.isSolutionFlow&&this.updatedConnectionReferences?this.updatedConnectionReferences:Object(y.j)(this.updatedConnectionReferences||this.flow.properties.connectionReferences),t.properties.displayName=this.flowDisplayName,t.properties.state=u.c.stopped,t.properties.connectionReferences=e,t.properties.definition=n()(this.flow.properties.definition),this.loggingService.logInfo("flowSaveAsDialogCtrl.getNewFlowDefinition","Status of cloned flow definition",{isFlowDefinitionPresent:!!this.flow.properties.definition,isClonedFlowDefinitionPresent:!!t.properties.definition}),t}},{key:"getNewFlowDefaultDisplayName",value:function(){return this.flow&&this.flow.properties&&this.flow.properties.displayName&&this.clientResources.Dialogs.FlowSaveAs.DefaultNamePrefix+this.flow.properties.displayName}},{key:"setAllButtonsDisabledState",value:function(e){this.savingDialogButtons.forEach(t=>{t.disabled=e})}},{key:"showErrorMessage",value:function(e){this.errorAlert.type=l.a.Error,this.errorAlert.message=Object(m.e)(e,this.clientResources.Common.SomethingWentWrong),Object(S.T)(e)&&(this.errorAlert.options.link={url:"#",text:"Upgrade",onClick:this.onInadequateQuotaLinkClick})}},{key:"isInputReadOnly",value:function(){return this.state===F.InitFailed}},{key:"hideModalDialog",value:function(){this.modalDialog.show=!1,this.$timeout(()=>{this.modalDialog.elementToFocusOnClose&&this.modalDialog.elementToFocusOnClose.focus()}),this.modalDialog.onHide({cancelledByUser:!0})}}])&&D(t.prototype,i),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();I.$inject=[o.a.services.$q,o.a.services.$scope,o.a.services.$timeout,o.a.services.$routeParams,o.a.services.appSettings,o.a.services.clientResources,o.a.services.connectionsClient,o.a.services.flowsClient,o.a.services.logging,o.a.services.ngReactBridge.ngFlowService,o.a.services.policies,o.a.services.promiseHelperService,o.a.services.session,o.a.services.telemetry,o.a.services.apisClient,o.a.services.designerCoreLoader,o.a.services.environment,o.a.services.plan,o.a.services.telemetry,o.a.services.graphService,o.a.services.assetService,o.a.services.licenseManagement,o.a.services.consentService,o.a.services.cdnService,o.a.services.userDetailsStore,o.a.services.xrmConnectionReferenceService,o.a.services.xrmConnectionReferenceStore,o.a.services.designerConnectionStore,o.a.services.neptuneService]},34079:function(e,t,i){"use strict";var r=i(14894);i.d(t,"a",(function(){return r.a}))},34080:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return c}));var r=i(14867),n=i(11891),o=(i(34081),i(12999));function a(e,t){var i=Object(r.k)(e);return Object.keys(i).some(e=>l(i[e],t))}function s(e,t){var i=Object(r.k)(e);return Object.keys(i).some(e=>!function(e,t){if(e.connectionReferenceLogicalName){var i=e.connectionReferenceLogicalName.toLowerCase(),r=!1;return t.forEach(e=>{e.connectionreferencelogicalname===i&&(r=!0)}),r}return!1}(i[e],t))}function l(e,t){var i={};(t||[]).forEach(e=>{e.name&&e.properties&&e.properties.apiId&&(i[e.name.toLowerCase()]=e.properties.apiId)});var o=Object(r.h)(e);if(o&&e.connectionName){var a=e.connectionName.toLowerCase();return!i[a]||!Object(n.a)(i[a],o)}return!0}function c(e,t,i){var n={},a=Object(r.k)(e);return Object.keys(a).forEach(e=>{var r,s;(l(a[e],t)||Object(o.a)().enableSolutionFlowSaveAsACopy&&i&&!((null==(r=a[e])?void 0:r.connectionReferenceLogicalName)&&(null==r||null===(s=r.connectionReferenceLogicalName)||void 0===s?void 0:s.length)>0))&&(n[e]={api:a[e].apiDefinition})}),n}},34081:function(e,t,i){"use strict";var r=i(14895);i.d(t,"a",(function(){return r.c}))},34082:function(e,t,i){e.exports=i.p+"static/media/flowSaveAsDialog.ac90590e.less"},34083:function(e,t){e.exports='<section class="section-flow-save-as-dialog">\n    <modal-dialog model="flowSaveAsDialogCtrl.modalDialog">\n        <custom-dialog-content-template>\n            <div class="flow-save-as-dialog-content">\n                <a role="button" aria-label="Cancel" ng-click="flowSaveAsDialogCtrl.hideModalDialog()" href="" class="c-glyph glyph-close ng-modal-close"></a>\n                <div class="dialog-loading-content" ng-if="flowSaveAsDialogCtrl.state === 0">\n                    <spinner model="flowSaveAsDialogCtrl.loadingSpinner"></spinner>\n                </div>\n                <div class="connection-disambiguation-content" ng-if="flowSaveAsDialogCtrl.state === 2">\n                    <p class="c-paragraph-2 create-connection-description">{{flowSaveAsDialogCtrl.creatingConnectionDescription}}</p>\n                    <connection-disambiguation\n                        connection-references="flowSaveAsDialogCtrl.connectionReferencesForConnectionDisambiguationComponent"\n                        designer-create-config-parameters="flowSaveAsDialogCtrl.designerCreateConfigParameters"\n                        on-connection-references-resolved="flowSaveAsDialogCtrl.onConnectionReferencesResolved"\n                        on-connection-disambiguation-loaded="flowSaveAsDialogCtrl.onConnectionDisambiguationLoaded">\n                    </connection-disambiguation>\n                </div>\n                <div class="dialog-saving-content" ng-if="flowSaveAsDialogCtrl.state === 3 || flowSaveAsDialogCtrl.state === 1">\n                    <h1\n                        id="{{::flowSaveAsDialogCtrl.modalDialog.ariaLabelledById}}"\n                        class="c-subheading-1">\n                        {{::flowSaveAsDialogCtrl.clientResources.Dialogs.FlowSaveAs.Header}}\n                    </h1>\n                    <p\n                        id="{{::flowSaveAsDialogCtrl.modalDialog.ariaDescribedById}}"\n                        class="c-paragraph-2 flow-save-as-description">\n                        {{flowSaveAsDialogCtrl.savingDialogDescription}}\n                    </p>\n                    <form ng-submit="!flowSaveAsDialogCtrl.isInputReadOnly() && flowSaveAsDialogCtrl.onSave()">\n                        <label for="saveas-flowname" class="c-label">{{::flowSaveAsDialogCtrl.clientResources.Dialogs.FlowSaveAs.FlowNameInputLabel}}</label>\n                        <input\n                            id="saveas-flowname"\n                            type="text"\n                            class="c-text-field flow-name-input"\n                            ng-model="flowSaveAsDialogCtrl.flowDisplayName"\n                            title="{{flowSaveAsDialogCtrl.flowDisplayName}}"\n                            ng-readonly="flowSaveAsDialogCtrl.isInputReadOnly()"\n                            placeholder="{{::flowSaveAsDialogCtrl.clientResources.Common.Untitled}}"/>\n                    </form>\n                    <alert model="flowSaveAsDialogCtrl.errorAlert"></alert>\n                    <dialog-buttons buttons="flowSaveAsDialogCtrl.savingDialogButtons" show-spinner="flowSaveAsDialogCtrl.showButtonActionProgressSpinner"></dialog-buttons>\n                </div>\n            </div>\n        <custom-dialog-content-template>\n    </modal-dialog>\n</section>'},34084:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34085),a=["alerts","copyDescription","copyTitle","disableInput","isLoading","isOpen","sendButtonDisabled","shareWith","onCancelClicked","onCopyDescriptionChange","onCopyTitleChange","onDismissed","onGetDescriptionErrorMessage","onGetTitleErrorMessage","onSendClicked","onShareWithFilterChange","onShareWithSelectionChange","clientResources","loggingService"];r.a.directive(n.a.components.react.reactSendACopyPanel,[n.a.modules.reactDirective,e=>e(o.a,a)])},34085:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(11766),n=i(16816),o=i(21965),a=i(13016),s=i(14947),l=i(15519),c=i(15027),u=i(13240);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=v(e);if(t){var n=v(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return f(this,i)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){return(e||[]).sort((e,t)=>a.d[e.type]-a.d[t.type])}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(f,e);var t,i,a,h=g(f);function f(){var e;d(this,f);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=h.call(this,...i)).buttonGroupStyle={marginTop:0},e.primaryButtonTelemetryData={name:u.c.FlowSendACopyClicked},e.secondaryButtonTelemetryData={name:u.c.FlowSendACopyCancelClicked},e.getMessageBarProps=()=>{var{alerts:t}=e.props;if(t&&0!==t.length){var i;if(1===t.length){var n=t[0];i={ariaLabel:n.message,type:n.type,onRenderBody:()=>n.message}}else{var o=b(t),a="";o.forEach(e=>{a+=e});var s={listStyleType:"disc",paddingLeft:40};i={ariaLabel:a,type:o[0].type,onRenderBody:()=>r.createElement("ul",{style:s},o.map(e=>r.createElement("li",{key:e.key},e.message)))}}return i}},e}return t=f,(i=[{key:"render",value:function(){var{copyDescription:e,copyTitle:t,disableInput:i,isLoading:a,isOpen:u,shareWith:d,sendButtonDisabled:p,onCancelClicked:h,onGetTitleErrorMessage:m,onGetDescriptionErrorMessage:g,onSendClicked:f,onDismissed:v,onCopyDescriptionChange:b,onCopyTitleChange:y,onShareWithFilterChange:w,onShareWithSelectionChange:S}=this.props;return r.createElement(s.a,{isLoading:a,isOpen:u,messageBarProps:this.getMessageBarProps(),title:this.props.clientResources.FlowProperties.SendACopy.Title,onDismissed:v},r.createElement(c.b,{className:"SendACopyPanel-CopyTitle",value:t,label:this.props.clientResources.FlowProperties.SendACopy.CopyTitle.Label,placeholder:this.props.clientResources.FlowProperties.SendACopy.CopyTitle.Placeholder,onChange:y,onGetErrorMessage:m,required:!0,disabled:i}),r.createElement(c.b,{className:"SendACopyPanel-CopyDescription",value:e,label:this.props.clientResources.FlowProperties.SendACopy.CopyDescription.Label,placeholder:this.props.clientResources.FlowProperties.SendACopy.CopyDescription.Placeholder,onChange:b,onGetErrorMessage:g,required:!0,disabled:i,resizable:!1,multiline:!0,rows:5}),r.createElement(l.a,{required:!0,selectedItems:d,placeholder:this.props.clientResources.FlowProperties.SendACopy.SendTo.Placeholder,onFilterChange:w,onSelectionChange:S,label:this.props.clientResources.FlowProperties.SendACopy.SendTo.Label,description:this.props.clientResources.FlowProperties.SendACopy.SendTo.Description,isDisabled:i,allowUserSpecifiedValues:!1,sharedComponentsResources:this.props.clientResources,loggingService:this.props.loggingService}),r.createElement(o.a,null),r.createElement(n.a,{style:this.buttonGroupStyle,primaryButtonText:this.props.clientResources.FlowProperties.SendACopy.SendButton.Text,onPrimaryButtonClick:f,primaryButtonDisabled:p||i,primaryButtonTelemetryData:this.primaryButtonTelemetryData,secondaryButtonText:this.props.clientResources.Common.Cancel,secondaryButtonTelemetryData:this.secondaryButtonTelemetryData,onSecondaryButtonClick:h}))}}])&&p(t.prototype,i),a&&p(t,a),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.PureComponent)},34086:function(e,t,i){"use strict";var r=i(33327),n=i(33335),o=i(34087);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34088),this.bindings={flow:"<",flowName:"<",isOpen:"="},this.controller=o.a,this.controllerAs="sendACopyPanelCtrl"}));n.a.component(r.a.components.flowSendACopyPanel,new c)},34087:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var r=i(33327),n=i(33360),o=i(33390),a=i(33464),s=i(33992),l=i(13016),c=i(33437),u=i(33354),d=i(33392),p=i(33394),h=i(15522),m=i(17258);function g(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function f(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){g(o,r,n,a,s,"next",e)}function s(e){g(o,r,n,a,s,"throw",e)}a(void 0)}))}}function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function b(e,t,i){return(t=w(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var S={[h.a.User]:a.a.User,[h.a.Group]:a.a.Group,[h.a.NotSpecified]:a.a.NotSpecified,[h.a.DataverseTeam]:a.a.NotSpecified},C=function(){function e(t,i,r,a,g,y,w,C,k,P,x,A,T,R,O){var D=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$q=i,this.clientResources=r,this.environmentService=a,this.environmentsClient=g,this.flowRunsClient=y,this.flowsClient=w,this.graphService=C,this.loggingService=k,this.policiesService=P,this.promiseHelperService=x,this.sessionService=A,this.telemetryService=T,this.templatePublishService=R,this.trialDialog=O,this.flow=void 0,this.flowName=void 0,this.isOpen=void 0,this.sendACopyPanel={alerts:[],copyDescription:void 0,copyTitle:void 0,disableInput:!1,isLoading:!1,shareWith:[],onCancelClicked:()=>{this.onClose()},onCopyDescriptionChange:(e,t)=>{this.sendACopyPanel.copyDescription=t},onCopyTitleChange:(e,t)=>{this.sendACopyPanel.copyTitle=t},onDismissed:()=>{this.telemetryService.tagEvent(c.a.FlowSendACopyPanelDismissed),this.onClose()},onSendClicked:()=>{this.onSend()},onShareWithFilterChange:this.graphService.searchPeoplePickerItems,onShareWithSelectionChange:e=>{this.loggingService.logInfo("SendACopyPanelCtrl.OnShareWithSelectionChange","".concat((e||[]).length," items selected.")),this.sendACopyPanel.shareWith=e}},this.flowRuns=void 0,this.$onInit=()=>{this.$scope.$watch(()=>this.isOpen,(e,t)=>{e&&this.tryOpenPanel()})},this.getCopyTitleErrorMessage=e=>e&&e.length>o.k.MaxTitleLength?Object(n.d)(this.clientResources.Publish.Invalid.Title.Error,o.k.MaxTitleLength):"",this.getCopyDescriptionErrorMessage=e=>e?e.length>o.k.MaxDescriptionLength?Object(n.d)(this.clientResources.Publish.Invalid.Description.ErrorTooLong,o.k.MaxDescriptionLength):e.length<o.k.MinDescriptionLength?Object(n.d)(this.clientResources.Publish.Invalid.Description.ErrorTooShort,o.k.MinDescriptionLength):"":"",this.onSend=()=>{this.sendACopyPanel.isLoading=!0;var e={acls:[]},t=0,i=0;this.sendACopyPanel.shareWith.forEach(r=>{r.type===h.a.User?t++:r.type===h.a.Group&&i++,void 0===S[r.type]&&this.loggingService.logWarning("SendACopyPanelCtrl.OnSend","Unable to resolve template shareing aclType. entityToShareWith.type = '".concat(r.type,"'.\n                     entityToShareWith.uniqueId = '").concat(r.uniqueId,"'")),e.acls.push({aclType:S[r.type],objectId:r.uniqueId})});var r={flowId:this.flow.id,usersShareWithCount:t,groupShareWithCount:i},n=this.loggingService.profileStart(u.a.sendAFlowCopyStart,r);this.templatePublishService.submitToPrivateGallery({templateTitle:this.sendACopyPanel.copyTitle,templateDescription:this.sendACopyPanel.copyDescription,templateCategories:["featured-oneClick"],flow:this.flow,extendedSubmissionContent:{flowBenefits:"",teamBenefits:"",flowRuns:"",customCategory:""}},e).then(e=>{this.loggingService.profileEndWithSuccess(n,u.a.sendAFlowCopyEnd,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){b(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({templateName:e},r)),this.sendACopyPanel.alerts=[{type:l.c.success,message:this.clientResources.SendACopy.SuccessMessage.CopySent,key:0}],this.sendACopyPanel.disableInput=!0}).catch(e=>{this.loggingService.profileEnd(n,u.a.sendAFlowCopyEnd,Object(d.b)(e),e,r),this.sendACopyPanel.alerts=[{type:l.c.error,message:this.clientResources.SendACopy.ErrorMessage.SubmissionFailed,key:0}],this.sendACopyPanel.disableInput=!1}).finally(()=>{this.sendACopyPanel.isLoading=!1})},this.tryOpenPanel=f((function*(){!D.flow&&D.flowName&&(D.flow=m.a.flows.getEntity(D.flowName).toJS());var e=yield D.policiesService.checkUserCanShareFlow(D.flow),t=D.environmentService.isDevEnvironment();D.promiseHelperService.toAngularPromise(D.sessionService.getUserSessionAsync()).then(()=>e||t).then(e=>{e?D.openPanel():(D.isOpen=!1,D.trialDialog.showBlockedFeatureStartTrialDialog(e=>{e&&(D.isOpen=!0,D.openPanel())}))})})),this.openPanel=()=>{this.flowName&&(this.flow=m.a.flows.getEntity(this.flowName).toJS());var e=!!this.flow.properties.definition,t={flowId:this.flow.id,hasFlowDefinition:e},i=this.loggingService.profileStart(u.a.sendAFlowCopyPageOpenStart,t);this.sendACopyPanel.alerts=[],this.sendACopyPanel.isLoading=!0,this.sendACopyPanel.copyTitle=this.flow.properties.displayName,this.sendACopyPanel.copyDescription=this.flow.properties.description;var r=e?this.$q.resolve():this.getFlowDefinition(),n=this.environmentsClient.checkEnvironmentAccess({environmentName:this.environmentService.getCurrentEnvironmentName()});return this.$q.all([this.refreshFlowRuns(),r,n]).then(()=>{!1===Object(s.d)(this.flowRuns)&&(this.sendACopyPanel.alerts.push({type:l.c.error,message:this.clientResources.SendACopy.ValidationMessage.LastRunUnsuccessful,key:0}),this.sendACopyPanel.disableInput=!0),!0===Object(s.e)(this.flow,this.flowRuns)&&(this.sendACopyPanel.alerts.push({type:l.c.error,message:this.clientResources.SendACopy.ValidationMessage.ModifiedSinceLastSuccessfulRun,key:1}),this.sendACopyPanel.disableInput=!0),Object(s.b)(this.flow)&&this.sendACopyPanel.alerts.push({type:l.c.warning,message:this.clientResources.SendACopy.ValidationMessage.ContainsCustomConnector,key:2}),Object(s.c)(this.flow)&&this.sendACopyPanel.alerts.push({type:l.c.warning,message:this.clientResources.SendACopy.ValidationMessage.ContainsEmailAddress,key:3}),this.loggingService.profileEndWithSuccess(i,u.a.sendAFlowCopyPageOpenEnd,t)}).catch(e=>{var r=Object(d.d)(e),n=r===p.c.sendACopyFailedToGetFlowRuns||r===p.c.sendACopyFailedToGetFlowDefinition||r===p.c.EnvironmentAccessDenied?Object(d.e)(e):this.clientResources.SendACopy.ErrorMessage.FailedToOpenPanel;this.loggingService.profileEnd(i,u.a.sendAFlowCopyPageOpenEnd,r===p.c.EnvironmentAccessDenied?d.a.ValidationError:Object(d.b)(e),e,t),this.sendACopyPanel.alerts=[{type:l.c.error,message:n,key:0}],this.sendACopyPanel.disableInput=!0}).finally(()=>{this.sendACopyPanel.isLoading=!1})},this.refreshFlowRuns=()=>{var e={flowName:this.flow.name,$top:o.k.MaxRunHistoryToLoad},t=this.loggingService.profileStart(u.a.sendAFlowCopyRefreshFlowRunsStart,this.telemetryData);return this.flowRunsClient.refreshQuery(e).then(()=>(this.flowRuns=this.flowRunsClient.query(this.$scope,e),this.loggingService.profileEndWithSuccess(t,u.a.sendAFlowCopyRefreshFlowRunsEnd,this.telemetryData),this.flowRuns.$promise)).catch(e=>{this.loggingService.profileEnd(t,u.a.sendAFlowCopyRefreshFlowRunsEnd,Object(d.b)(e),e,this.telemetryData);var i=new p.a(p.c.sendACopyFailedToGetFlowRuns,this.clientResources.SendACopy.ErrorMessage.FailedToGetFlowRuns,e,this.telemetryData);return this.$q.reject(i)})},this.getFlowDefinition=()=>{var e=this.loggingService.profileStart(u.a.sendAFlowCopyGetFlowDefinitionStart,this.telemetryData),t=this.flowsClient.get(this.$scope,{id:this.flow.id});return t.$promise.then(()=>{this.loggingService.profileEndWithSuccess(e,u.a.sendAFlowCopyGetFlowDefinitionEnd,this.telemetryData),this.flow=t}).catch(t=>{this.loggingService.profileEnd(e,u.a.sendAFlowCopyGetFlowDefinitionEnd,Object(d.b)(t),t,this.telemetryData);var i=new p.a(p.c.sendACopyFailedToGetFlowDefinition,this.clientResources.SendACopy.ErrorMessage.FailedToGetFlow,t,this.telemetryData);return this.$q.reject(i)})},this.onClose=()=>{this.isOpen=!1,this.sendACopyPanel.alerts=[],this.sendACopyPanel.isLoading=!1,this.sendACopyPanel.copyTitle=void 0,this.sendACopyPanel.copyDescription=void 0,this.sendACopyPanel.shareWith=[],this.sendACopyPanel.disableInput=!1},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"SendACopyPanelCtrl"})}var t,i,r;return t=e,(i=[{key:"isTitleValid",get:function(){return!(!this.sendACopyPanel.copyTitle||!this.sendACopyPanel.copyTitle.trim())&&0===this.getCopyTitleErrorMessage(this.sendACopyPanel.copyTitle).length}},{key:"isDescriptionValid",get:function(){return!(!this.sendACopyPanel.copyDescription||!this.sendACopyPanel.copyDescription.trim())&&0===this.getCopyDescriptionErrorMessage(this.sendACopyPanel.copyDescription).length}},{key:"isShareWithValid",get:function(){return!!this.sendACopyPanel.shareWith&&this.sendACopyPanel.shareWith.length>0}},{key:"isSendButtonDisabled",get:function(){return this.sendACopyPanel.isLoading||!this.isTitleValid||!this.isDescriptionValid||!this.isShareWithValid}},{key:"telemetryData",get:function(){return{flowId:this.flow.id,hasFlowDefinition:!!this.flow.properties.definition}}}])&&y(t.prototype,i),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();C.$inject=[r.a.services.$scope,r.a.services.$q,r.a.services.clientResources,r.a.services.environment,r.a.services.environmentsClient,r.a.services.flowRunsClient,r.a.services.flowsClient,r.a.services.graph,r.a.services.logging,r.a.services.policies,r.a.services.promiseHelperService,r.a.services.session,r.a.services.telemetry,r.a.services.templatePublish,r.a.services.trialDialog]},34088:function(e,t){e.exports='<react-send-a-copy-panel\n    alerts="sendACopyPanelCtrl.sendACopyPanel.alerts"\n    copy-description="sendACopyPanelCtrl.sendACopyPanel.copyDescription"\n    copy-title="sendACopyPanelCtrl.sendACopyPanel.copyTitle"\n    disable-input="sendACopyPanelCtrl.sendACopyPanel.disableInput"\n    is-loading="sendACopyPanelCtrl.sendACopyPanel.isLoading"\n    is-open="sendACopyPanelCtrl.isOpen"\n    send-button-disabled="sendACopyPanelCtrl.isSendButtonDisabled"\n    share-with="sendACopyPanelCtrl.sendACopyPanel.shareWith"\n    on-cancel-clicked="sendACopyPanelCtrl.sendACopyPanel.onCancelClicked"\n    on-copy-description-change="sendACopyPanelCtrl.sendACopyPanel.onCopyDescriptionChange"\n    on-copy-title-change="sendACopyPanelCtrl.sendACopyPanel.onCopyTitleChange"\n    on-dismissed="sendACopyPanelCtrl.sendACopyPanel.onDismissed"\n    on-get-description-error-message="sendACopyPanelCtrl.getCopyDescriptionErrorMessage"\n    on-get-title-error-message="sendACopyPanelCtrl.getCopyTitleErrorMessage"\n    on-send-clicked="sendACopyPanelCtrl.sendACopyPanel.onSendClicked"\n    on-share-with-filter-change="sendACopyPanelCtrl.sendACopyPanel.onShareWithFilterChange"\n    on-share-with-selection-change="sendACopyPanelCtrl.sendACopyPanel.onShareWithSelectionChange"\n    client-resources="sendACopyPanelCtrl.clientResources"\n    logging-service="sendACopyPanelCtrl.loggingService"\n>\n</react-send-a-copy-panel>'},34089:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34090);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34091);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34092),this.bindings={flowName:"<",flowRunName:"<",flowTriggerName:"<",isFlowCheckPage:"<",onError:"&?",onDismiss:"&",showPane:"="},this.controller=o.a,this.controllerAs="flowRemediationPaneCtrl"}));r.a.component(n.a.components.flowRemediationPane,new c)},34090:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(13085),n=i(33623),o=i(33327),a=i(17266),s=i(13009);function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,i,r,o,a,s,l,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.flowRunService=i,this.loggingService=r,this.universalSearchService=o,this.appSettings=a,this.assetService=s,this.clientResources=l,this.cdnService=c,this.telemetryService=u,this.failedOperations=void 0,this.flowName=void 0,this.flowRunName=void 0,this.isMigrationSource=void 0,this.flowTriggerName=void 0,this.isFlowCheckPage=void 0,this.onError=void 0,this.onDismiss=void 0,this.showPane=void 0,this.supportMessage=void 0,this.paneAnimation=n.b.NoAnimation,this.summaryPaneEventCorrelationId=void 0,this.remediationUIState={},this.$onInit=()=>{this.initializeDataForPane()},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowRemediationPaneCtrl"})}var t,i,o;return t=e,(i=[{key:"initializeDataForPane",value:function(){this.showPane=!0,this.summaryPaneEventCorrelationId=this.loggingService.profilePageStart(r.a.remediationPaneLoadStart);var e=this.loggingService.profileStart(r.a.remediationPanelApiCallStart);this.flowRunService.getRemediationAndDebugFlowData(this.$scope,this.flowName,this.flowRunName,this.isFlowCheckPage?this.flowTriggerName:null,this.isMigrationSource).then(e=>(this.remediationUIState=e,this.$scope.$applyAsync(),e)).then(t=>{this.loggingService.profileEndWithSuccess(e,r.a.remediationPanelApiCallEnd,{flowName:this.flowName,flowRunName:this.flowRunName,remediationType:t&&t.remediationData&&t.remediationData.remediationType}),this.loggingService.profileEndWithSuccess(this.summaryPaneEventCorrelationId,r.a.remediationPaneLoadEnd,{flowName:this.flowName,flowRunName:this.flowRunName,remediationType:this.remediationUIState&&this.remediationUIState.remediationData&&this.remediationUIState.remediationData.remediationType})}).catch(t=>{t instanceof a.a&&this.loggingService.profileEnd(e,r.a.remediationPanelApiCallEnd,Object(s.y)(t),t,{flowName:this.flowName,flowRunName:this.flowRunName}),this.loggingService.profileEnd(this.summaryPaneEventCorrelationId,r.a.remediationPaneLoadEnd,Object(s.y)(t),t,{flowName:this.flowName,flowRunName:this.flowRunName}),this.onError&&(this.onError({error:t}),this.showPane=!1)})}}])&&l(t.prototype,i),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.$inject=[o.a.services.$scope,o.a.services.flowRun,o.a.services.logging,o.a.services.universalSearchService,o.a.services.appSettings,o.a.services.assetService,o.a.services.clientResources,o.a.services.cdnService,o.a.services.telemetry]},34091:function(e,t,i){e.exports=i.p+"static/media/flowRemediationPane.b9b1c555.less"},34092:function(e,t){e.exports='<react-remediation-pane\n    ng-if="flowRemediationPaneCtrl.showPane"\n    run="flowRemediationPaneCtrl.remediationUIState.run"\n    failed-operation="flowRemediationPaneCtrl.remediationUIState.failedOperation"\n    remediation-data="flowRemediationPaneCtrl.remediationUIState.remediationData"\n    broken-connections-url="flowRemediationPaneCtrl.remediationUIState.brokenConnectionsUrl"\n    is-open="flowRemediationPaneCtrl.showPane"\n    on-dismiss="flowRemediationPaneCtrl.onDismiss"\n    app-settings="flowRemediationPaneCtrl.appSettings"\n    asset-service="flowRemediationPaneCtrl.assetService"\n    client-resources="flowRemediationPaneCtrl.clientResources"\n    cdn-service="flowRemediationPaneCtrl.cdnService"\n    telemetry-service="flowRemediationPaneCtrl.telemetryService"\n    shared-component-resources="flowRemediationPaneCtrl.clientResources"\n    date-time-resources="flowRemediationPaneCtrl.clientResources.DateTime">\n</react-remediation-pane>'},34093:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34094),a=["brokenConnectionsUrl","failedOperation","isOpen","onDismiss","run","remediationData",["appSettings",{watchDepth:"reference"}],["assetService",{watchDepth:"reference"}],["clientResources",{watchDepth:"reference"}],["cdnService",{watchDepth:"reference"}],["telemetryService",{watchDepth:"reference"}],["sharedComponentResources",{watchDepth:"reference"}],["dateTimeResources",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactRemediationPane,[n.a.modules.reactDirective,e=>e(o.a,a)])},34094:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r,n=i(11766),o=i(14337),a=i(31322),s=i(34095),l=i(34097);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=Object(o.c)(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,i,r,o=h(d);function d(){var e;c(this,d);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=o.call(this,...i)).onRenderBody=()=>n.createElement(s.a,e.props),e.onRenderFooter=()=>n.createElement(l.a,e.props),e}return t=d,(i=[{key:"render",value:function(){return n.createElement(a.a,{className:"fl-RemediationPane",isOpen:this.props.isOpen,title:this.props.title||this.props.sharedComponentResources.FlowRun.Operation.RunDetails.Title,onRenderBody:this.onRenderBody,onRenderFooter:this.onRenderFooter,onDismiss:this.props.onDismiss,clientResources:this.props.clientResources,hideCloseButton:this.props.hideCloseButton})}}])&&u(t.prototype,i),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(n.Component))||r},34095:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var r,n=i(11766),o=i(11773),a=i(31286),s=i(13031),l=i(31281),c=i(19873),u=i(20769),d=i(34096),p=i(31288),h=i(12327),m=i(31290);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=S(e);if(t){var n=S(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return w(this,i)}}function w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C,k,P,x,A,T,R=(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(v,e);var t,i,r,o=y(v);function v(){var e;g(this,v);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=o.call(this,...i)).renderHelpSection=()=>{var{actionName:t,run:i,failedOperation:r,remediationData:o}=e.props,a=O(i,t);return n.createElement(n.Fragment,null,a===l.a.Failed&&r&&e.renderFixDetails(r),o&&e.renderHelp())},e.renderUiFlowHelpSection=()=>{var t,i,r,{actionName:o,run:a,failedOperation:s,remediationData:c}=e.props,u=O(a,o),d=c&&c.universalSearchResults&&((null===(t=c.universalSearchResults.article)||void 0===t?void 0:t.length)||(null===(i=c.universalSearchResults.community)||void 0===i?void 0:i.length)||(null===(r=c.universalSearchResults.blog)||void 0===r?void 0:r.length));return n.createElement(n.Fragment,null,d&&e.renderHelp(),u===l.a.Failed&&s&&s.fixDescription&&e.renderFixDetails(s))},e.renderFailedRunDetails=()=>{var{failedOperation:t,remediationData:i,renderErrorDetailMessage:r,renderErrorContext:o,renderExpectedContext:a,run:s,clientResources:l,sharedComponentResources:u}=e.props,d=i&&i.errorSubject||t&&t.title&&t.fixDescription,p=t&&t.hasFriendlyErrorMessage?t&&t.errorDetails:i&&i.errorDescription||t&&t.errorDetails;return p=Object(h.k)(p)?p:JSON.stringify(p),n.createElement(n.Fragment,null,d&&n.createElement(c.a,{label:l.Common.Error,text:d}),p&&Object(m.c)({errorDescription:p,hideHeader:!0},u),s&&r&&r(s),s&&o&&o(s),s&&a&&a(s),i&&e.renderRemediationSteps())},e.renderHelp=()=>{var{remediationData:t,appSettings:i,assetService:r,cdnService:o,clientResources:a,sharedComponentResources:s,telemetryService:l}=e.props;return n.createElement("div",null,n.createElement(u.a,{remediationData:t,appSettings:i,assetService:r,cdnService:o,clientResources:a,sharedComponentResources:s,telemetryService:l}))},e}return t=v,(i=[{key:"title",get:function(){return this.props.title||this.props.sharedComponentResources.FlowRun.Operation.ErrorDetails.Title}},{key:"render",value:function(){var{failedOperation:e,numberSelected:t,remediationData:i,renderEmptyState:r,run:o,isUIFlow:a,sharedComponentResources:l}=this.props;return 0===t?n.createElement("div",null,l.Runs.Details.NoneSelected):t&&t>1?n.createElement("div",null,Object(s.a)(l.Runs.Details.Num.Selected,t)):1!==t&&t||!o||!o.properties?r?r():null:n.createElement("div",null,this.props.displayActionSection&&this.props.actionName&&this.renderActionSection(),this.renderFlowRunTimeDetails(),(e||i)&&this.renderFailedRunDetails(),a?this.renderUiFlowHelpSection():this.renderHelpSection())}},{key:"renderErrorDescription",value:function(e){return Object(m.c)({errorDescription:e},this.props.sharedComponentResources)}},{key:"renderActionSection",value:function(){return Object(m.b)({actionName:this.props.actionName},this.props.sharedComponentResources)}},{key:"renderFlowRunTimeDetails",value:function(){return Object(m.e)({actionName:this.props.actionName,isDesktopV2:this.props.isDesktopV2,run:this.props.run},this.props.sharedComponentResources,this.props.dateTimeResources)}},{key:"renderFixDetails",value:function(e){return Object(m.d)({description:e.fixDescription},this.props.sharedComponentResources)}},{key:"renderRemediationSteps",value:function(){var{brokenConnectionsUrl:e,remediationData:t,run:i,sharedComponentResources:r}=this.props;return i&&t.remediationType===a.a.BrokenConnections&&e?n.createElement(d.a,{brokenConnectionsUrl:e,runId:i.name,sharedComponentResources:r}):n.createElement(p.a,{remediationData:t,sharedComponentResources:r})}},{key:"action",get:function(){var{run:e,actionName:t}=this.props;return Object(m.a)({actionName:t,run:e})}}])&&f(t.prototype,i),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),v}(n.Component),C=r.prototype,k="action",P=[o.computed],x=Object.getOwnPropertyDescriptor(r.prototype,"action"),A=r.prototype,T={},Object.keys(x).forEach((function(e){T[e]=x[e]})),T.enumerable=!!T.enumerable,T.configurable=!!T.configurable,("value"in T||T.initializer)&&(T.writable=!0),T=P.slice().reverse().reduce((function(e,t){return t(C,k,e)||e}),T),A&&void 0!==T.initializer&&(T.value=T.initializer?T.initializer.call(A):void 0,T.initializer=void 0),void 0===T.initializer&&(Object.defineProperty(C,k,T),T=null),r);function O(e,t){return e?t&&e.properties&&e.properties.actions&&e.properties.actions[t]?e.properties.actions[t].status:e.properties.status:null}},34096:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(11766),n=i(13240),o=i(19873),a=i(14346);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,i,c,p=d(h);function h(){var e;s(this,h);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return(e=p.call(this,...i)).renderBrokenConnectionRemediationText=()=>{var{brokenConnectionsUrl:t,runId:i}=e.props,o={name:n.c.ViewBrokenConnectionsFromFailedRunRemediationClicked,runId:i};return r.createElement(r.Fragment,null,r.createElement("div",null,e.props.sharedComponentResources.RemediationPane.BrokenConnections.Fix),r.createElement(a.a,{href:t,target:a.b.blank,telemetryData:o},e.props.sharedComponentResources.RemediationPane.BrokenConnections.FixConnections))},e}return t=h,(i=[{key:"render",value:function(){return r.createElement(o.a,{label:this.props.sharedComponentResources.Remediation.HowToFix.Heading,onRenderText:this.renderBrokenConnectionRemediationText})}}])&&l(t.prototype,i),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.Component)},34097:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var r,n,o,a=i(11766),s=i(11773),l=i(31291),c=i(12706),u=i(14337),d=i(13272),p=i(13259),h=i(13240);function m(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=C(e);if(t){var n=C(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return w(this,i)}}function w(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t,i,r,n){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var P=(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(v,e);var t,i,r,s=y(v);function v(){var e;g(this,v);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=s.call(this,...i)).classNames=Object(c.a)()(l.a),m(e,"iconToggle",n,S(e)),e.onHappyClick=()=>{e.submitFeedback(h.c.RemediationHelpHappyClicked)},e.onSadClick=()=>{e.submitFeedback(h.c.RemediationHelpSadClicked)},m(e,"submitFeedback",o,S(e)),e}return t=v,(i=[{key:"componentDidMount",value:function(){this.setIconToggle(!0)}},{key:"render",value:function(){var{remediationData:e,isUIFlow:t}=this.props;return!t&&e?this.renderRemediationHelpResponse():null}},{key:"renderRemediationHelpResponse",value:function(){return a.createElement(u.a,null,()=>a.createElement("div",null,a.createElement("div",{className:this.classNames.remediationPaneFeedback},a.createElement("div",{className:this.classNames.remediationPaneFeedbackContent},this.iconToggle?a.createElement(a.Fragment,null,this.props.sharedComponentResources.Remediation.Is.This.Content.Helpful,a.createElement(p.a,{className:this.classNames.feedbackButton,title:this.props.sharedComponentResources.Remediation.Helpful,iconName:d.a.Like,toggle:this.iconToggle,onClick:this.onHappyClick}),a.createElement(p.a,{className:this.classNames.feedbackButton,title:this.props.sharedComponentResources.Remediation.Not.Helpful,iconName:d.a.Dislike,toggle:this.iconToggle,onClick:this.onSadClick})):a.createElement("div",{className:this.classNames.remediationPaneFeedbackResponse},this.props.sharedComponentResources.Remediation.Feedback.Response)))))}},{key:"setIconToggle",value:function(e){this.iconToggle=e}}])&&f(t.prototype,i),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),v}(a.Component),n=k(r.prototype,"iconToggle",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k(r.prototype,"setIconToggle",[s.action],Object.getOwnPropertyDescriptor(r.prototype,"setIconToggle"),r.prototype),o=k(r.prototype,"submitFeedback",[s.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.setIconToggle(!1),this.props.telemetryService.tagEvent(e)}}}),r)},34098:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34099);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34100),this.bindings={flow:"<"},this.controller=o.a,this.controllerAs="flowContactCardCtrl"}));r.a.component(n.a.components.flowContactCard,new c)},34099:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(33327),n=i(33443),o=i(33439),a=i(33419),s=i(33390),l=i(21046),c=i(33452);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t,i,r,n,o,s,l,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.appSettings=i,this.clientResources=r,this.flowRolesClient=n,this.graphService=o,this.loggingService=s,this.promiseHelperService=l,this.sessionService=c,this.assetService=u,this.flow=void 0,this.flowIcons=void 0,this.useCreatorText=!1,this.allDisplayNames=void 0,this.visibleDisplayNames=void 0,this.$onInit=()=>{this.flowIcons=Object(a.b)(this.flow,this.assetService,this.clientResources),this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>{!this.sessionService.isConsumerDomain&&this.sessionService.userConsented&&this.createOwnerDisplayNames(this.flow.name)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowContactCardCtrl"})}var t,i,r;return t=e,(i=[{key:"createOwnerDisplayNames",value:function(e){var t=this.flowRolesClient.query(this.$scope,{flowName:e,roleName:n.a.owners});t.$promise.then(()=>{var e=t.reduce((e,t)=>(t.properties.permissionType===o.c.Principal&&e.push(t.properties.principal.id),e),[]);return this.flow.properties.provisioningMethod===s.i.FromTemplate&&this.hasNowOwnersOrOnlyHasDelegatedAuth(e)?null:(this.hasNowOwnersOrOnlyHasDelegatedAuth(e)?(this.useCreatorText=!0,e=[this.flow.properties.creator.objectId]):e=e.filter(e=>e!==c.f),this.graphService.getObjectsById(e))}).then(e=>{if(e){var t=e.map(e=>e.displayName);this.allDisplayNames=Object(l.b)(t,this.clientResources,{useCreatorText:this.useCreatorText}),this.visibleDisplayNames=Object(l.b)(t,this.clientResources,{maxVisibleOwners:2,useCreatorText:this.useCreatorText})}}).catch(e=>{this.loggingService.logError("flowContactCardCtrl.createOwnerDisplayNames",e),this.visibleDisplayNames=null,this.allDisplayNames=null})}},{key:"hasNowOwnersOrOnlyHasDelegatedAuth",value:function(e){return 0===e.length||1===e.length&&e[0]===c.f}}])&&u(t.prototype,i),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();p.$inject=[r.a.services.$scope,r.a.services.appSettings,r.a.services.clientResources,r.a.services.flowRolesClient,r.a.services.graph,r.a.services.logging,r.a.services.promiseHelperService,r.a.services.session,r.a.services.assetService]},34100:function(e,t){e.exports='<div class="flow-contact-card" ng-if="flowContactCardCtrl.flow">\n    <horizontal-contact-card\n        icons="flowContactCardCtrl.flowIcons"\n        primary-text="flowContactCardCtrl.flow.properties.displayName"\n        secondary-text="flowContactCardCtrl.visibleDisplayNames",\n        secondary-text-html-title="flowContactCardCtrl.allDisplayNames">\n    </horizontal-contact-card>\n</div>\n'},34101:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34102);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34105);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34106),this.bindings={flow:"<",expandFlowDescription:"="},this.controller=o.a,this.controllerAs="flowDetailsCtrl"}));r.a.component(n.a.components.flowDetails,new c)},34102:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(33279),n=i(33360),o=i(33441),a=i(33327),s=i(34103),l=i(34104),c=i(16926),u=i(16928);function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.clientResources=i,this.loggingService=r,this.flow=void 0,this.expandFlowDescription=!1,this.flowDescription=void 0,this.flowOperationsSummary=void 0,this.sharePointReferencedSites=[],this.containsDynamicSite=void 0,this.$onInit=()=>{this.flowDescription=Object(c.a)(this.flow),this.flowOperationsSummary=this.getFlowOperationsSummary(this.flow),(this.flow.properties.referencedResources||[]).filter(e=>e.service===o.a.sharepoint&&e.resource&&e.resource.site).forEach(e=>{var t=e.resource.site;-1===this.sharePointReferencedSites.indexOf(t)&&(this.isDynamicResource(t)?this.containsDynamicSite=!0:this.sharePointReferencedSites.push(t))})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowDetailsCtrl"})}var t,i,a;return t=e,(i=[{key:"shouldShowFlowDescriptionToggle",get:function(){return!Object(n.p)(this.flowDescription)||this.flowOperationsSummary&&Object.keys(this.flowOperationsSummary).length>0}},{key:"onToggleFlowDescription",value:function(){this.expandFlowDescription=!this.expandFlowDescription}},{key:"getFlowOperationsSummary",value:function(e){var t={},i=this.flow.properties.referencedResources||[];return(Object(u.a)(e)||[]).forEach(e=>{var n=e&&e.apiOperation&&e.apiOperation.properties,a=e&&e.apiOperation&&e.apiOperation.id;if(n&&a){var s=this.getOperationSummaryDetails(n),l=n.api&&n.api.displayName,c=n.api&&n.api.iconUri,u=e.api&&e.api.id;if(s&&l&&c&&u){var d=[];a&&i.filter(e=>e.referencers&&this.referencerHasApiOperation(e.referencers,a)).forEach(e=>{if(e.resource){var t=e.service===o.a.sharepoint&&e.resource.site?{site:e.resource.site}:e.resource;d.some(e=>r.equals(e,t))||d.push(t)}}),t[a]={details:s,displayName:l,iconUri:c,id:u,referencedResources:d}}}}),t}},{key:"getOperationSummaryDetails",value:function(e){return e.summary&&e.description?"".concat(e.summary," - ").concat(e.description):e.summary||e.description||""}},{key:"getFriendlyResourceName",value:function(e){return l.a.getLocalizedName(e,this.clientResources)||e}},{key:"isDynamicResource",value:function(e){return e===s.a}},{key:"referencerHasApiOperation",value:function(e,t){return"string"==typeof e[0]?-1!==e.indexOf(t):e.some(e=>e&&e.operationId&&e.operationId===t)}}])&&d(t.prototype,i),a&&d(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();h.$inject=[a.a.services.appSettings,a.a.services.clientResources,a.a.services.logging]},34103:function(e,t,i){"use strict";var r=i(21040);i.d(t,"a",(function(){return r.d}))},34104:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(21042);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,o;return t=e,o=[{key:"getLocalizedName",value:function(e,t){return Object(r.a)(e,t)}}],(i=null)&&n(t.prototype,i),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},34105:function(e,t,i){e.exports=i.p+"static/media/flowDetails.c1be3ab8.less"},34106:function(e,t){e.exports='<div class="flowDetails" ng-if="flowDetailsCtrl.shouldShowFlowDescriptionToggle">\n    <div class="flowDetails-title" ng-click="flowDetailsCtrl.onToggleFlowDescription()" aria-expanded="{{flowDetailsCtrl.expandFlowDescription}}">\n        <span class="flowDetails-title-text">{{::flowDetailsCtrl.clientResources.RunFlow.DescriptionExpandTitle}}</span>\n        <span class="c-glyph flowDetails-title-icon" ng-class="flowDetailsCtrl.expandFlowDescription ? \'glyph-arrowup\' : \'glyph-arrowdown\'"></span>\n    </div>\n    <div class="flowDetails-content" ng-if="flowDetailsCtrl.expandFlowDescription">\n        <p class="flowDetails-description" ng-if="flowDetailsCtrl.flowDescription.length > 0" title="{{flowDetailsCtrl.flowDescription}}">{{flowDetailsCtrl.flowDescription}}</p>\n        <div ng-if="flowDetailsCtrl.sharePointReferencedSites.length > 0" class="flowDetails-permissionsSection">\n            <div class="flowDetails-permissionTitle">{{::flowDetailsCtrl.clientResources.RunFlow.SharePoint.PermissionsTitle}}</div>\n            <ul class="flowDetails-permissions">\n                <li class="flowDetails-permission" ng-repeat="sharePointReferencedSite in flowDetailsCtrl.sharePointReferencedSites">{{sharePointReferencedSite}}</li>\n                <li ng-if="flowDetailsCtrl.containsDynamicSite" class="flowDetails-permission flowDetails-permission--bold">{{::flowDetailsCtrl.clientResources.RunFlow.DynamicSiteInFlow}}</li>\n            </ul>\n            <div class="flowDetails-permissionSubtext">{{::flowDetailsCtrl.clientResources.RunFlow.SharePoint.PermissionsSubtext}}</div>\n        </div>\n        <div ng-repeat="operationSummary in flowDetailsCtrl.flowOperationsSummary" class="flowDetails-infoCard">\n            <div class="flowDetails-infoCard-iconContainer">\n                <img class="flowDetails-infoCard-icon" ng-attr-src="{{operationSummary.iconUri}}" />\n            </div>\n            <div class="flowDetails-infoCard-textContainer">\n                <div class="flowDetails-infoCard-label">{{operationSummary.displayName}}</div>\n                <div class="flowDetails-infoCard-description">{{operationSummary.details}}</div>\n                <div ng-repeat="referencedResource in operationSummary.referencedResources">\n                    <div ng-repeat="(referencedResourceName, referencedResourceValue) in referencedResource">\n                        <span class="flowDetails-infoCard-label">{{flowDetailsCtrl.getFriendlyResourceName(referencedResourceName)}}:</span>\n                        <span ng-if="flowDetailsCtrl.isDynamicResource(referencedResourceValue)" class="flowDetails-infoCard-description flowDetails-infoCard-description--bold">{{::flowDetailsCtrl.clientResources.RunFlow.DynamicSiteInOperation}}</span>\n                        <span ng-if="!flowDetailsCtrl.isDynamicResource(referencedResourceValue)" class="flowDetails-infoCard-description">{{referencedResourceValue}}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},34107:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34108);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34110);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34111),this.bindings={inputParameters:"<",onReadyChanged:"<"},this.controller=o.a,this.controllerAs="inputParameterFormCtrl"}));r.a.component(n.a.components.inputParameterForm,new c)},34108:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33360),o=i(34109);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,i,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.graphService=i,this.sessionService=r,this.clientResources=n,this.loggingService=a,this.inputParameters=void 0,this.onReadyChanged=void 0,this.isReady=void 0,this.$onInit=()=>{var e=this.inputParameters||{};this.$scope.$watchCollection(()=>Object.keys(e).map(t=>e[t].value),()=>{this.handleInputChanged()}),Object.keys(e).map(t=>e[t]).filter(e=>e.type===o.a.MultiSelect).forEach(e=>{this.$scope.$watchCollection(()=>e.value,()=>{this.handleInputChanged()})})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"InputParameterFormCtrl"})}var t,i,r;return t=e,(i=[{key:"useFabricPeoplePicker",get:function(){return this.sessionService.isOrgId}},{key:"handleInputChanged",value:function(){var e=this.isReady;this.isReady=this.inputParametersValid,e!==this.isReady&&this.onReadyChanged&&this.onReadyChanged(this.isReady)}},{key:"inputParametersValid",get:function(){return!this.inputParameters||Object.keys(this.inputParameters).every(e=>{var t=this.inputParameters[e];return!(t.isRequired&&Object(n.p)(t.value)||t.parameterValidator&&t.parameterValidator(t.value))})}},{key:"isEnum",value:function(e){return e.type===o.a.Enum}},{key:"isFile",value:function(e){return e.type===o.a.File}},{key:"isText",value:function(e){return e.type===o.a.Text}},{key:"isEmail",value:function(e){return e.type===o.a.Email}},{key:"isMultiSelect",value:function(e){return e.type===o.a.MultiSelect}},{key:"isBoolean",value:function(e){return e.type===o.a.Boolean}},{key:"isNumber",value:function(e){return e.type===o.a.Number}},{key:"isInteger",value:function(e){return e.type===o.a.Integer}},{key:"isDate",value:function(e){return e.type===o.a.Date}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[r.a.services.$scope,r.a.services.graph,r.a.services.session,r.a.services.clientResources,r.a.services.logging]},34109:function(e,t,i){"use strict";var r=i(22852);i.d(t,"a",(function(){return r.a})),i.d(t,"b",(function(){return r.b})),i.d(t,"c",(function(){return r.c})),i.d(t,"d",(function(){return r.d})),i.d(t,"e",(function(){return r.e})),i.d(t,"f",(function(){return r.f}))},34110:function(e,t,i){e.exports=i.p+"static/media/inputParameterForm.1cbdeb7f.less"},34111:function(e,t){e.exports='<div class="inputParameterForm">\n    <div ng-if="!inputParameter.isImplicit"\n        class="inputParameterForm-inputParameter"\n        ng-repeat="inputParameter in inputParameterFormCtrl.inputParameters"\n        ng-class="{\'inputParameterForm-inputParameter--first\': $first }" >\n        \x3c!-- Enum input parameter --\x3e\n        <div ng-if="::inputParameterFormCtrl.isEnum(inputParameter)" >\n            <react-label\n                html-for="::inputParameter.labelId"\n                text="::inputParameter.title"\n                required="::inputParameter.isRequired"\n            ></react-label>\n            \x3c!-- TODO(nidurak): replace with fabric dropdown once available--\x3e\n            <div class="c-select inputParameterForm-enumContainer" >\n                <select aria-label="{{::inputParameter.title}}"\n                    id="{{::inputParameter.labelId}}"\n                    class="inputParameterForm-enum"\n                    ng-model="inputParameter.value"\n                    ng-options="inputOptions for inputOptions in inputParameter.enumOptions"\n                    ng-required="inputParameter.isRequired">\n                    <option value="" selected disabled>{{::inputParameter.description}}</option>\n                </select>\n            </div>\n        </div>\n        \x3c!-- File input parameter --\x3e\n        <div ng-if="::inputParameterFormCtrl.isFile(inputParameter)" >\n            <react-label\n                text="::inputParameter.title"\n                required="::inputParameter.isRequired"\n            ></react-label>\n            \x3c!-- TODO(nidurak): replace with fabric file picker once available--\x3e\n            <file-picker\n                class="file-input-parameter"\n                on-file-change="::inputParameter.onChange"\n                placeholder="::inputParameter.description"\n                config="::inputParameter.filePickerConfig"\n                is-required="inputParameter.isRequired"></file-picker>\n        </div>\n        \x3c!-- Text input parameter --\x3e\n        <react-text-field\n            ng-if="::inputParameterFormCtrl.isText(inputParameter)"\n            value="inputParameter.value"\n            placeholder="::inputParameter.description"\n            label="::inputParameter.title"\n            required="::inputParameter.isRequired"\n            multiline="true"\n            rows="5"\n            on-change="::inputParameter.onChange"\n            on-get-error-message="::inputParameter.parameterValidator"\n        ></react-text-field>\n        \x3c!-- Email input parameter --\x3e\n        <div ng-if="::inputParameterFormCtrl.isEmail(inputParameter)"\n            class="inputParameterForm-emailInput"\n            ng-switch="::inputParameterFormCtrl.sessionService.isOrgId">\n            <react-label\n                html-for="::inputParameter.labelId"\n                text="::inputParameter.title"\n                required="::inputParameter.isRequired"\n            ></react-label>\n            \x3c!-- People picker --\x3e\n            <div ng-switch-when="true" ng-switch="::inputParameterFormCtrl.useFabricPeoplePicker">\n                \x3c!-- Fabric people picker --\x3e\n                <react-people-picker ng-switch-when="true"\n                    on-filter-change="::inputParameterFormCtrl.graphService.searchPeoplePickerItems"\n                    on-selection-change="::inputParameter.onChange"\n                    selected-items="inputParameter.peoplePickerItems"\n                    placeholder="::inputParameter.description"\n                    required="::inputParameter.isRequired"\n                    allow-user-specified-values="true"\n                    shared-components-resources="inputParameterFormCtrl.clientResources"\n                    logging-service="inputParameterFormCtrl.loggingService"></react-people-picker>\n                \x3c!-- Legacy people picker --\x3e\n                \x3c!-- NOTE(nidurak): legacy picker used when this is in a modal dialog since that blocks the click event of\n                    the fabric people picker\'s suggestion list --\x3e\n                <div ng-switch-when="false">\n                    <graph-autocomplete class="inputParameterForm-autoCompleteContainer"\n                        on-select="inputParameter.onEmailAdd"\n                        input-required="::inputParameter.isRequired"\n                        input-id="::inputParameter.labelId"></graph-autocomplete>\n                    <email-display items="inputParameter.emails"\n                        on-email-delete="inputParameter.onEmailDelete(item)" ></email-display>\n                </div>\n            </div>\n            \x3c!-- Raw input --\x3e\n            <input ng-switch-when="false"\n                id="{{::inputParameter.labelId}}"\n                aria-label="{{::inputParameter.title}}"\n                class="c-text-field"\n                validate-multiple-emails\n                ng-attr-placeholder="{{::inputParameter.description}}"\n                ng-model="inputParameter.value"\n                ng-model-options="{ debounce: 500 }"\n                ng-required="::inputParameter.isRequired"\n                type="text" />\n        </div>\n        \x3c!-- Multiselect input parameter --\x3e\n        <div ng-if="::inputParameterFormCtrl.isMultiSelect(inputParameter)" >\n            <react-label\n                text="::inputParameter.title"\n            ></react-label>\n            <react-checkbox\n                ng-repeat="inputOption in inputParameter.multiSelectOptions"\n                checked="inputOption.checked"\n                label="::inputOption.value"\n                on-change="::inputOption.onChange" ></react-checkbox>\n        </div>\n        \x3c!-- Boolean input parameter --\x3e\n        <react-toggle ng-if="::inputParameterFormCtrl.isBoolean(inputParameter)"\n            checked="inputParameter.value"\n            on-change="::inputParameter.onChange"\n            label="::inputParameter.title" ></react-toggle>\n        \x3c!-- Number input parameter --\x3e\n        <react-text-field ng-if="::(inputParameterFormCtrl.isNumber(inputParameter) || inputParameterFormCtrl.isInteger(inputParameter))"\n            type="\'number\'"\n            value="inputParameter.value"\n            placeholder="::inputParameter.description"\n            on-change="::inputParameter.onChange"\n            on-get-error-message="::inputParameter.parameterValidator"\n            label="::inputParameter.title"\n            required="::inputParameter.isRequired" ></react-text-field>\n        \x3c!-- Date input parameter --\x3e\n        <div ng-if="::inputParameterFormCtrl.isDate(inputParameter)">\n            <react-date-picker\n                value="inputParameter.date"\n                label="::inputParameter.title"\n                required="::inputParameter.isRequired"\n                placeholder="::inputParameter.description"\n                on-changed="::inputParameter.onChange"\n                on-format-date="::inputParameter.onFormatDate"\n                on-parse-date-from-string="::inputParameter.onParseDateFromString"\n                client-resources="inputParameterFormCtrl.clientResources"\n                date-time-resources="inputParameterFormCtrl.clientResources.DateTime" ></react-date-picker>\n        </div>\n    </div>\n</div>\n'},34112:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34113);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34114);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34115),this.controller=o.a,this.bindings={consentOnActionName:"<"},this.controllerAs="widgetConsentCtrl"}));r.a.component(n.a.components.widgetConsent,new c)},34113:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33327),n=i(33360);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.clientResources=i,this.sessionService=r,this.userConsentService=n,this.loggingService=o,this.consentOnActionName=void 0,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"WidgetConsentCtrl"})}var t,i,r;return t=e,(i=[{key:"termsAndConditionsHtml",get:function(){return Object(n.d)(this.clientResources.UserConsent.TermsAndConditions.Text,this.consentOnActionName,this.userConsentService.termsAndConditionsLink,this.appSettings.brandName)}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.$inject=[r.a.services.appSettings,r.a.services.clientResources,r.a.services.session,r.a.services.userConsent,r.a.services.logging]},34114:function(e,t,i){e.exports=i.p+"static/media/widgetConsent.0351379c.less"},34115:function(e,t){e.exports='<div class="widget-consent">\n    <section ng-if="widgetConsentCtrl.userConsentService.shouldShowIntegratedConsent()">\n        <div class="c-checkbox" ng-show="widgetConsentCtrl.userConsentService.isCheckboxShown">\n            <label class="c-label email-consent-input">\n                <input\n                    ng-model="widgetConsentCtrl.userConsentService.isEmailOptedIn"\n                    type="checkbox">\n                <span>{{widgetConsentCtrl.userConsentService.getPromotionalEmailText()}}</span>\n            </label>\n        </div>\n        <div class="fine-print terms-and-conditions" ng-bind-html="widgetConsentCtrl.termsAndConditionsHtml"></div>\n        <p ng-show="!widgetConsentCtrl.userConsentService.isCheckboxShown" class="fine-print email-consent-not-required-text">{{widgetConsentCtrl.userConsentService.getPromotionalEmailText()}}</p>\n        <a class="fine-print privacy-link" target="_blank" ng-href="{{widgetConsentCtrl.userConsentService.privacyUrl}}">{{widgetConsentCtrl.clientResources.UserConsent.MicrosoftPrivacyLink}}</a>\n    </section>\n</div>'},34116:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34117);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34118);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34119),this.bindings={dialog:"<",inputData:"=",isPanelOpen:"=?",isTestRun:"<?",onCancel:"<",onDone:"<",onRender:"<",onFlowRunRequestCompletion:"<",onFlowRunRequestError:"<",onFlowRunRequestStart:"<"},this.controller=o.a,this.controllerAs="invokeFlowFormCtrl"}));r.a.component(n.a.components.invokeFlow.invokeFlowForm,new c)},34117:function(e,t,i){"use strict";i.d(t,"a",(function(){return q}));var r=i(12066),n=i.n(r),o=i(11891),a=i(33360),s=i(33452),l=i(33394),c=i(33353),u=i(33383),d=i(33354),p=i(33437),h=i(33392),m=i(33453),g=i(33327),f=i(15519),v=i(33415),b=i(33390),y=i(33443),w=i(34109),S=i(19999),C=i(12328),k=i.n(C),P=i(33624),x=i(18933),A=i(12339),T=i(33493),R=i(14839),O=i(14835),D=i(16926),E=i(14867),F=i(12366),I=i(14900),j=i(20819);function N(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function M(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?N(Object(i),!0).forEach((function(t){L(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function L(e,t,i){return(t=B(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function U(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,B(r.key),r)}}function B(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var $=function(e){return e[e.Consent=0]="Consent",e[e.NotSpecified=1]="NotSpecified",e[e.TestConnections=2]="TestConnections",e[e.ShowConnections=3]="ShowConnections",e[e.ShowInputs=4]="ShowInputs",e[e.ShowCompleted=5]="ShowCompleted",e}($||{}),q=function(){function e(t,i,r,n,o,s,l,m,g,f,v,b,y,w,C,k,P,x,A,O,D,F,I,j,N,M,L){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.$scope=r,this.$timeout=n,this.$window=o,this.connectionsClient=s,this.environmentService=l,this.fileReader=m,this.flowRunsClient=g,this.flowsClient=f,this.flowRolesClient=v,this.geocodeService=b,this.graphService=y,this.installFlowService=w,this.policiesService=C,this.promiseHelperService=k,this.sessionService=P,this.userConsentService=x,this.widgetUtilService=A,this.assetService=O,this.clientResources=D,this.telemetryService=F,this.loggingService=I,this.appSettings=j,this.flowRunsService=N,this.routeCrafter=M,this.designerCoreLoader=L,this.dialog=void 0,this.isTestRun=void 0,this.inputData=void 0,this.onDone=void 0,this.onCancel=void 0,this.onFlowRunRequestCompletion=void 0,this.onFlowRunRequestError=void 0,this.onFlowRunRequestStart=void 0,this.onRender=void 0,this.runFlowActionButton={getLabel:this.widgetUtilService.getOverrideableWidgetStringCallback(this.clientResources.Dialogs.RunFlow.Button.RunFlow,T.a.INVOKE_FLOW_RUN_FLOW_BUTTON),action:()=>this.onRunFlow(),primary:!0},this.cancelActionButton={label:this.clientResources.Dialogs.RunFlow.Button.Cancel,action:()=>this.handleCancel(this.flow)},this.invokeFlowButtons=[this.runFlowActionButton,this.cancelActionButton],this.flowRunRequestCompletionButton=[{label:this.clientResources.Dialogs.RunFlow.Button.Done,action:()=>this.handleDone(this.flow)}],this.flowDetailsLoadingSpinner={size:u.c.Large,local:u.a.Global,show:!1},this.designerLoadingSpinner={size:u.c.Small,local:u.a.LocalHorizontal,show:!1},this.errorAlert={type:c.a.None,message:"",options:{}},this.pageState=void 0,this.hasInvokerConnections=void 0,this.isAdditionalInputNeededWithoutLocationParams=void 0,this.loadAdditionalInputParameters=void 0,this.inputParameters=void 0,this.showProgressSpinner=void 0,this.isMiniWidget=this.widgetUtilService.isMiniWidget(),this.runStartedConfirmationImage=this.assetService.runStartedConfirmation,this.runRowData=void 0,this.connections=void 0,this.connectionReferences={},this.designerCreateConfigParameters=void 0,this.designerConfig=void 0,this.enableDesignerCallback=!0,this.enableOnRenderEvent=!0,this.expandFlowDescription=!1,this.flow=void 0,this.flowName=void 0,this.flowUserType=void 0,this.flowDescription=void 0,this.flowDisplayName=void 0,this.flowTriggerName=void 0,this.flowRunHistoryUrl=void 0,this.getFlowRequestId=void 0,this.isUserTypeFlow=void 0,this.runStoppedMessage=void 0,this.locationInfo=void 0,this.isConsenting=void 0,this.$onInit=()=>{this.$scope.$watch(()=>this.inputData,()=>{this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>this.handleInputDataChange())}),this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>{this.userConsentService.shouldShowIntegratedConsent()?(this.loggingService.logInfo(d.a.invokeFlowFormLoadedWithNonConsentedUser,void 0,{isCheckboxShown:this.userConsentService.isCheckboxShown,isEmailOptedIn:this.userConsentService.isEmailOptedIn}),this.pageState=$.Consent,this.handleOnRender()):this.loggingService.logInfo(d.a.invokeFlowFormLoadedWithConsentedUser,"User is already consented")})},this.onParameterFormReadyChanged=e=>{this.inputParameters&&Object(R.b)(this.flow)&&(this.runFlowActionButton.disabled=!e)},this.onConsentClicked=()=>{var e={isCheckboxShown:this.userConsentService.isCheckboxShown,isEmailOptedIn:this.userConsentService.isEmailOptedIn};this.telemetryService.tagEvent(p.a.InvokeFlowFormConsentClicked),this.isConsenting=!0;var t=this.loggingService.profileStart(d.a.invokeFlowFormConsentUserStart,e);this.userConsentService.consentIfNecessary().then(()=>{this.loggingService.profileEndWithSuccess(t,d.a.invokeFlowFormConsentUserEnd,e),this.handleInvokerConnections(this.flow),this.isConsenting=!1}).catch(i=>{this.loggingService.profileEnd(t,d.a.invokeFlowFormConsentUserEnd,Object(h.b)(i),Object(h.f)(i),e),this.enableDesignerCallback=!0})},this.setFocusToConnectionWizard=()=>{var e=document.getElementsByClassName("msla-connection-container-body"),t=e&&e.length>0&&e[0];t?t.focus():this.loggingService.logWarning("invokeFlowFormCtrl.showConnections","could not find connection wizard connection selector to set focus to")},this.handleContinueButtonAvailable=e=>{this.pageState===$.ShowConnections&&this.setFocusToConnectionWizard()},this.onConnectionWizardStateChange=e=>{switch(e){case S.a.ready:this.$scope.$applyAsync(()=>{this.pageState===$.TestConnections&&this.showInputs()});break;case S.a.failed:this.$scope.$applyAsync(()=>{this.showConnections()});break;case S.a.working:case S.a.pending:default:this.$scope.$applyAsync(()=>{})}},this.onClickingContinue=e=>{this.enableDesignerCallback&&(this.enableDesignerCallback=!1,this.flowDetailsLoadingSpinner.show=!0,this.installFlow(this.flow,Object(E.j)(e)).then(()=>this.connectionsClient.refreshQuery()).then(()=>this.connections=this.connectionsClient.query(this.$scope)).then(()=>this.$q.all(this.connections.$promise)).then(()=>this.designerCreateConfigParameters.connectionsPromise=this.$q.resolve(this.connections)).then(()=>{this.flowDetailsLoadingSpinner.show=!1,this.showInputs()}))},this.onConnectionDisambiguationLoaded=e=>{this.handleOnRender()},this.areInputParametersValid=()=>!this.inputParameters||Object.values(this.inputParameters).every(e=>(!e.isRequired||!Object(a.p)(e.value))&&(!e.parameterValidator||!e.parameterValidator(e.value))),this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"InvokeFlowFormCtrl"})}var t,i,r;return t=e,(i=[{key:"header",get:function(){return this.widgetUtilService.getOverrideableString(this.clientResources.Widget.InvokeFlow.Header,T.a.INVOKE_FLOW_HEADER)}},{key:"useFabricPeoplePicker",get:function(){return this.sessionService.isOrgId}},{key:"handleInputDataChange",value:function(){if(this.inputData&&this.inputData.flowId){this.resetState();var e,t=this.loggingService.profileStart(d.a.invokeFlowInputContentLoadStart,{flowId:this.inputData.flowId}),i=Object(a.e)();this.getFlowRequestId=i;var r={id:this.inputData.flowId,$expand:"properties.connectionreferences.apidefinition,properties.definitionSummary.operations.apiOperation"},n=this.inputData.flowId.substring(this.inputData.flowId.lastIndexOf("/")+1);this.flowRolesClient.query(this.$scope,{flowName:n,roleName:y.a.owners}),this.$q.all([this.flowsClient.refresh(r),this.connectionsClient.refreshQuery({$top:m.a.maxPageSize})]).then(()=>(this.connections=this.connectionsClient.query(this.$scope,{$top:m.a.maxPageSize}),e=this.flowsClient.get(this.$scope,r),this.$q.all([this.connections.$promise,e.$promise]))).then(()=>{if(Object(o.a)(this.getFlowRequestId,i)){this.updateFlowDetails(e),this.handleInvokerConnections(e);var r=Object(O.e)(e);if(this.isAdditionalInputNeededWithoutLocationParams=Object(O.m)(e),this.isAdditionalInputNeededWithoutLocationParams&&(this.loadAdditionalInputParameters=!0),r)return this.geocodeService.getCoordinates()}else this.loggingService.profileEnd(t,d.a.invokeFlowInputContentLoadEnd,h.a.Abort);return null}).then(e=>{e&&(this.locationInfo=e,this.loadAdditionalInputParameters=!0),this.inputParameters=this.createInputParameters(this.flow),this.enableAllButtons(),Object(R.b)(this.flow)||(this.runFlowActionButton.disabled=!0,this.runStoppedMessage=Object(a.d)(Object(R.d)(this.flow)?this.clientResources.RunFlow.FlowSuspended:this.clientResources.RunFlow.FlowStopped,Object(D.b)(this.flow))),this.loggingService.profileEndWithSuccess(t,d.a.invokeFlowInputContentLoadEnd,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName})}).catch(e=>{this.loggingService.profileEnd(t,d.a.invokeFlowInputContentLoadEnd,Object(h.b)(e),e,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName}),this.errorAlert.type=c.a.Error,this.errorAlert.message=Object(h.e)(e,this.clientResources.Common.SomethingWentWrong),this.handleFlowRunRequestError(e)}).finally(()=>{this.flowDetailsLoadingSpinner.show=!1})}}},{key:"updateFlowDetails",value:function(e){this.flow=e,this.flowDisplayName=Object(D.b)(e),this.flowName=Object(D.c)(e),this.flowTriggerName=Object(O.y)(e),this.flowUserType=Object(D.e)(e),Object(j.a)()&&(this.isUserTypeFlow=Object(D.C)(e))}},{key:"handleInvokerConnections",value:function(e){this.hasInvokerConnections=Object(E.d)(e),this.hasInvokerConnections&&(this.connectionReferences=Object(E.l)(e),this.initDesignerCreateConfigParameters(e)),this.userConsentService.shouldShowIntegratedConsent()?this.pageState=$.Consent:(Object(D.r)(e)?this.hasInvokerConnections?this.testConnections():this.showInputs():this.hasInvokerConnections?this.showConnections(!1):this.installFlow(e).then(()=>{this.showInputs()}),this.handleOnRender())}},{key:"downloadDesignerScripts",value:function(){return this.promiseHelperService.toAngularPromise(this.designerCoreLoader.loadDesignerScripts())}},{key:"showInputs",value:function(){this.designerLoadingSpinner.show=!1,this.pageState=$.ShowInputs,this.$timeout(()=>{var e=document.getElementsByClassName("invoke-flow-form-body"),t=e&&e.length>0&&e[0];if(k()(t,"could not fund the invoke flow form body"),t){var i=Object(P.a)(t);k()(i,"could not find focusable element in the invoke flow form"),i&&i.focus()}})}},{key:"testConnections",value:function(){this.designerLoadingSpinner.show=!0,this.pageState=$.TestConnections}},{key:"showConnections",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.designerLoadingSpinner.show=!1,this.userConsentService.shouldShowIntegratedConsent()?this.pageState=$.Consent:(this.enableDesignerCallback=!0,this.pageState=$.ShowConnections,e&&this.$timeout(this.setFocusToConnectionWizard))}},{key:"shouldShowConsent",get:function(){return this.pageState===$.Consent}},{key:"shouldShowConnections",get:function(){return this.pageState===$.ShowConnections}},{key:"shouldShowInputs",get:function(){return this.pageState===$.ShowInputs}},{key:"shouldShowCompleted",get:function(){return this.pageState===$.ShowCompleted}},{key:"shouldShowWizard",get:function(){return this.inputData&&this.inputData.flowId&&!this.flowDetailsLoadingSpinner.show}},{key:"shouldShowAdditionalInputs",get:function(){return Object.keys(this.inputParameters||{}).length>0}},{key:"shouldShowEditConnections",get:function(){return this.shouldShowInputs&&Object(E.c)(this.flow)}},{key:"initDesignerCreateConfigParameters",value:function(e){this.designerCreateConfigParameters={connectionsPromise:this.$q.resolve(this.connections),downloadDesignerScriptsPromise:this.downloadDesignerScripts(),designerConfig:this.createCustomizedDesignerConfig(e)}}},{key:"createCustomizedDesignerConfig",value:function(e){var t={};return t.prefetchedData={connectionProviders:Object(E.d)(e)?Object.keys(this.connectionReferences).map(e=>n()({},this.connectionReferences[e].api,{hidden:this.connectionReferences[e].hidden||!1})):null},t.canAddOperation=e=>new Promise(t=>{this.$scope.$applyAsync(()=>{this.policiesService.checkCanAddOperation(e).then(e=>{t(e)})})}),t.connectionWizardUIConfig={defaultAccountDisplayName:this.sessionService.getUserInfo().displayName,hideConnectionWizardHeader:!0,onConnectionWizardStateChange:this.onConnectionWizardStateChange,onContinueButtonAvailable:this.handleContinueButtonAvailable},t}},{key:"installFlow",value:function(e,t){var i;return this.installFlowService.installFlow(e,t).then(()=>this.flowsClient.refresh({id:e.id})).then(()=>(i=this.flowsClient.get(this.$scope,{id:e.id})).$promise).then(()=>{if(this.flow=i,!this.flow.properties.flowTriggerUri)throw new l.a(l.c.flowTriggerUriMissing,Object(a.d)(this.clientResources.RunFlow.FlowTriggerUriMissing,e.properties.displayName),null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName})}).catch(e=>{this.invokeFlowButtons.filter(e=>e.primary).forEach(e=>e.disabled=!0),this.enableDesignerCallback=!0,this.loggingService.logError("InvokeFlowFormCtrl.installFlow",e),this.errorAlert.type=c.a.Error,this.errorAlert.message=Object(h.e)(e,this.clientResources.Common.SomethingWentWrong),this.handleFlowRunRequestError(e)})}},{key:"createInputParameters",value:function(e){var t={},i=Object(O.B)(e),r=!1,n=!1;return i&&i.properties&&Object.keys(i.properties).forEach(s=>{if(!Object(w.e)(s))if(Object(O.I)(s))r=!0;else if(Object(w.f)(s))n=!0;else{var c=i.properties[s],u={key:Object(a.e)()};if(u.labelId=Object(a.e)(),u.isImplicit=!1,u.type=Object(w.d)(c),u.title=Object(w.c)(c,s),u.description=Object(w.b)(c),u.isRequired=Object(O.H)(s,e),u.type===w.a.Text){var p=u;p.onChange=(e,t)=>{u.value=t},p.parameterValidator=e=>{var t=c.maxLength;return t&&e.length>t?Object(a.d)(this.clientResources.RunFlow.ValidateInput.Text.MaxLimit,t):void 0}}if(u.type===w.a.Enum&&(u.enumOptions=c.enum.map(e=>e.trim())),u.type===w.a.Number||u.type===w.a.Integer){var m=u;m.onChange=(e,t)=>{if(""===t)m.value=void 0;else try{if(m.value=Number(t),isNaN(m.value))throw m.value=null,new l.a(l.c.invalidNumberInput,Object(a.d)(this.clientResources.RunFlow.InvalidNumberInput),null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName})}catch(i){this.loggingService.logError("InvokeFlow.UpdateNumberParam",i)}}}if(u.type===w.a.MultiSelect){var g=u;g.multiSelectOptions=c.items.enum.map(e=>{var t={onChange:(e,i)=>{t.checked=i,i&&-1===t.valueIndex?(g.value.push(t.value),t.valueIndex=g.value.length-1):i||-1===t.valueIndex||(g.value.splice(t.valueIndex,1),g.multiSelectOptions.forEach(e=>{e.valueIndex>t.valueIndex&&e.valueIndex--}),t.valueIndex=-1)},value:e.trim(),checked:!1,valueIndex:-1,key:Object(a.e)()};return t}),u.value=[]}if(u.type===w.a.Email)if(u.description=u.description||this.clientResources.GraphAutocomplete.DefaultPlaceholder,this.useFabricPeoplePicker){var b=u;b.onChange=e=>{b.peoplePickerItems=e,b.value=Object(f.c)({peoplePickerItems:e,loggingService:this.loggingService})},b.peoplePickerItems=[],b.searchPeoplePickerItems=this.graphService.searchPeoplePickerItems}else{var y=u;y.onEmailAdd=e=>{!Object(a.n)(y.value)&&(y.emails||[]).map(e=>e.mail).indexOf(e.mail)>-1||(y.emails=(y.emails||[]).concat(e),y.value=y.emails.map(e=>e.mail).join(";"))},y.onEmailDelete=e=>{y.emails=(y.emails||[]).filter(t=>!Object(o.a)(t.mail,e.mail)),y.value=y.emails.map(e=>e.mail).join(";")},y.emails=[]}if(u.type===w.a.File){var S=u;S.onChange=e=>{var t=this.loggingService.profileStart(d.a.invokeFlowInputContentFileReadStart,{flowName:this.flowName});this.fileReader(e).asBase64Encoded().then(i=>{S.value={contentBytes:i,name:e.name},this.loggingService.profileEndWithSuccess(t,d.a.invokeFlowInputContentFileReadEnd,{flowName:this.flowName})}).catch(e=>{this.loggingService.profileEnd(t,d.a.invokeFlowInputContentFileReadEnd,Object(h.b)(e),e,{flowName:this.flowName})})}}if(u.type===w.a.Boolean){var C=u;C.value=!1,C.onChange=(e,t)=>{u.value=t}}if(u.type===w.a.Date){var k=u;k.onChange=e=>{k.date=e,k.value=e?Object(v.c)(e,v.a.ISO8601DateOnly):""},k.onFormatDate=e=>e?Object(v.c)(e,v.a.ISO8601DateOnly):"",k.onParseDateFromString=e=>Object(v.i)(e)}t[s]=u}}),r&&(t[s.b.latitude]={key:Object(a.e)(),isImplicit:!0,value:this.getLocationParameterValue(s.b.latitude)},t[s.b.longitude]={key:Object(a.e)(),isImplicit:!0,value:this.getLocationParameterValue(s.b.longitude)}),n&&(t[F.g]={key:Object(a.e)(),isImplicit:!0,value:Object(v.c)(new Date,v.a.ISO8601DateOnly)}),t}},{key:"getLocationParameterValue",value:function(e){if(this.locationInfo)switch(e){case s.b.latitude:return this.locationInfo&&this.locationInfo.latitude||void 0;case s.b.longitude:return this.locationInfo&&this.locationInfo.longitude||void 0}return null}},{key:"onRunFlow",value:function(){this.telemetryService.tagEvent(p.a.InvokeFlowFormRunFlowButtonClicked,null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName,flowTriggerUri:this.flow.properties.flowTriggerUri}),this.disableAllButtons(),this.widgetUtilService.isWidgetPage()?this.isMiniWidget&&this.inputData&&this.inputData.implicitData&&this.inputData.implicitData.selectedRows&&(this.runRowData=this.inputData.implicitData.selectedRows):this.showProgressSpinner=!0;var e=this.loggingService.profileStart(this.isTestRun?d.a.invokeFlowRequestAsTestStart:d.a.invokeFlowRequestStart,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName,flowTriggerUri:this.flow.properties.flowTriggerUri,isMini:this.isMiniWidget,isTestRun:this.isTestRun});this.handleFlowRunRequestStart(),this.checkIfFlowStarted(this.flow).then(()=>this.userConsentService.consentIfNecessary()).then(()=>Object(A.j)(this.appSettings,this.flow.properties.flowTriggerUri)?this.promiseHelperService.toAngularPromise(this.sessionService.getToken(this.appSettings.apiHubsRuntimeResource)):this.promiseHelperService.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource))).then(e=>this.httpRequestToRunFlow(e,this.isTestRun)).then(t=>{if(!(t&&200===t.status||202===t.status))throw new l.a(l.c.flowRunRequestFailed,Object(a.d)(this.clientResources.RunFlow.BadRequest,this.flow.properties.displayName),null,{flowName:this.flowName,flowTriggerUri:this.flow.properties.flowTriggerUri,method:"InvokeFlowFormCtrl.onRunFlow",responseStatusCode:t&&t.status,responseData:t&&t.data,isMini:this.isMiniWidget,isTestRun:this.isTestRun});this.loggingService.profileEndWithSuccess(e,this.isTestRun?d.a.invokeFlowRequestAsTestEnd:d.a.invokeFlowRequestEnd,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName,flowTriggerUri:this.flow.properties.flowTriggerUri,isMini:this.isMiniWidget,isTestRun:this.isTestRun}),this.handleFlowRunRequestCompletion(this.flow)}).catch(t=>{t&&502===t.status&&t.headers&&t.headers()&&t.headers()["x-ms-workflow-run-id"]?(this.loggingService.profileEndWithSuccess(e,this.isTestRun?d.a.invokeFlowRequestAsTestEnd:d.a.invokeFlowRequestEnd,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName,flowTriggerUri:this.flow.properties.flowTriggerUri,isMini:this.isMiniWidget,isTestRun:this.isTestRun}),this.handleFlowRunRequestCompletion(this.flow)):(this.loggingService.profileEnd(e,this.isTestRun?d.a.invokeFlowRequestAsTestEnd:d.a.invokeFlowRequestEnd,Object(h.b)(t),t,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName,flowTriggerUri:this.flow.properties.flowTriggerUri,isMini:this.isMiniWidget,isTestRun:this.isTestRun}),this.errorAlert.type=c.a.Error,this.errorAlert.message=Object(h.e)(t,this.clientResources.Common.SomethingWentWrong),this.handleFlowRunRequestError(t))}).finally(()=>{this.showProgressSpinner=!1,this.enableAllButtons()})}},{key:"httpRequestToRunFlow",value:function(e,t){var i={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)};return t&&(i[b.n.clientKeywords]=b.l.testFlow),this.$http({method:"POST",url:this.flow.properties.flowTriggerUri,data:this.getRequestBody(this.inputParameters),headers:i})}},{key:"getRequestBody",value:function(e){var t=this.constructRequestBodyParameters(e);return Object(O.j)(this.flow)?this.generateRequestBodyWithImplicitData(t,this.inputData.implicitData):JSON.stringify(t)}},{key:"checkIfFlowStarted",value:function(e){return Object(R.b)(e)?this.$q.resolve():this.$q.reject(new l.b(Object(R.d)(e)?l.c.flowSuspended:l.c.flowStopped,Object(a.d)(Object(R.d)(e)?this.clientResources.RunFlow.FlowSuspended:this.clientResources.RunFlow.FlowStopped,Object(D.b)(e)),null,{flowName:Object(D.c)(e),flowUserType:Object(D.e)(e),triggerName:Object(O.y)(e)}))}},{key:"generateRequestBodyWithImplicitData",value:function(e,t){var i=[],r={};return t&&t.length>0?t.forEach(t=>{Array.isArray(t)?this.loggingService.logError("InvokeFlow.ImpicitDataObjectWrongFormat",new l.a("InvokeFlow.ImpicitDataObjectWrongFormat","Implicit data object should not be an array")):i.push(M(M({},e),{},{entity:t}))}):i.push(e),r.rows=i,JSON.stringify(r)}},{key:"constructRequestBodyParameters",value:function(e){var t={};return Object.keys(e||{}).forEach(i=>{var r=i.split("."),n=e[i].value;t=this.constructRequestBodyFormat(t,r,n)}),t}},{key:"constructRequestBodyFormat",value:function(e,t,i){return 1===t.length?e[t[0]]=i:(e[t[0]]=e[t[0]]||{},e[t[0]]=this.constructRequestBodyFormat(e[t[0]],t.slice(1),i)),e}},{key:"handleCancel",value:function(e){this.telemetryService.tagEvent(p.a.InvokeFlowFormCancelButtonClicked,null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName}),this.onCancel&&this.onCancel(e)}},{key:"handleDone",value:function(e){this.telemetryService.tagEvent(p.a.InvokeFlowFormDoneButtonClicked,null,{flowName:this.flowName,flowUserType:this.flowUserType,triggerName:this.flowTriggerName}),this.onDone&&this.onDone(e)}},{key:"handleFlowRunRequestStart",value:function(){this.onFlowRunRequestStart&&this.onFlowRunRequestStart()}},{key:"handleFlowRunRequestCompletion",value:function(e){this.isUserTypeFlow=Object(D.C)(e),this.flowRunHistoryUrl=this.getFlowRunHistoryUrl(e);var t=Object(D.c)(e);this.flowRunsClient.refreshQuery({flowName:t}),this.flowRunsService.getFlowRuns({environmentName:this.environmentService.getCurrentEnvironmentName(),flowName:t,status:x.a.all,forceRefresh:!0}),this.onFlowRunRequestCompletion&&this.onFlowRunRequestCompletion({flowName:this.flowName,flowRunUrl:this.flowRunHistoryUrl}),this.widgetUtilService.widgetCloseOnFlowRunEnabled()?this.widgetUtilService.fireWidgetCloseEvent():this.pageState=$.ShowCompleted}},{key:"handleFlowRunRequestError",value:function(e){this.onFlowRunRequestError&&this.onFlowRunRequestError(e)}},{key:"getFlowRunHistoryUrl",value:function(e){return Object(I.p)(this.routeCrafter,{flowName:Object(D.c)(e),isLegacyShared:!1,isUIFlow:!1,solutionId:void 0})}},{key:"enableAllButtons",value:function(){this.invokeFlowButtons.forEach(e=>{e.disabled=!1})}},{key:"disableAllButtons",value:function(){this.invokeFlowButtons.forEach(e=>{e.disabled=!0})}},{key:"resetState",value:function(){this.flowName=null,this.flowDetailsLoadingSpinner.show=!0,this.pageState=$.NotSpecified,this.isAdditionalInputNeededWithoutLocationParams=!1,this.invokeFlowButtons.filter(e=>e.primary).forEach(e=>e.disabled=!0),this.errorAlert.type=c.a.None,this.errorAlert.message="",this.enableOnRenderEvent=!0}},{key:"handleOnRender",value:function(){this.onRender&&this.enableOnRenderEvent&&(this.onRender(),this.enableOnRenderEvent=!1)}},{key:"flowAdvertisementHtml",get:function(){var e='<a href="'.concat(this.appSettings.portalUrl,'" target="_blank">').concat(this.appSettings.brandName,"</a>");return Object(a.d)(this.clientResources.UserConsent.PoweredByFormat,e)}}])&&U(t.prototype,i),r&&U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();q.$inject=[g.a.services.$http,g.a.services.$q,g.a.services.$scope,g.a.services.$timeout,g.a.services.$window,g.a.services.connectionsClient,g.a.services.environment,g.a.services.fileReaderHelperService,g.a.services.flowRunsClient,g.a.services.flowsClient,g.a.services.flowRolesClient,g.a.services.geocode,g.a.services.graph,g.a.services.installFlowService,g.a.services.policies,g.a.services.promiseHelperService,g.a.services.session,g.a.services.userConsent,g.a.services.widgetUtilService,g.a.services.assetService,g.a.services.clientResources,g.a.services.telemetry,g.a.services.logging,g.a.services.appSettings,g.a.services.flowrunsService,g.a.services.routeCrafter,g.a.services.designerCoreLoader]},34118:function(e,t,i){e.exports=i.p+"static/media/invokeFlowForm.781493ff.less"},34119:function(e,t){e.exports='<div class="modal-spinner-container" ng-if="invokeFlowFormCtrl.flowDetailsLoadingSpinner.show">\n    <spinner model="invokeFlowFormCtrl.flowDetailsLoadingSpinner"></spinner>\n</div>\n<div class="invoke-flow-form" ng-if="invokeFlowFormCtrl.shouldShowWizard && invokeFlowFormCtrl.flow">\n    <section class="run-flow-setup" ng-if="!invokeFlowFormCtrl.shouldShowCompleted">\n        <h3\n            id="{{::invokeFlowFormCtrl.dialog.ariaLabelledById}}"\n            class="flow-header ms-fontSize-xl ms-fontWeight-semilight">\n            {{invokeFlowFormCtrl.header}}\n        </h3>\n\n        <flow-contact-card flow="invokeFlowFormCtrl.flow"></flow-contact-card>\n        <flow-details ng-if="!invokeFlowFormCtrl.widgetUtilService.isWidgetPage()" flow="invokeFlowFormCtrl.flow" expand-flow-description="invokeFlowFormCtrl.expandFlowDescription"></flow-details>\n\n        <react-default-button\n            ng-if="invokeFlowFormCtrl.shouldShowConsent"\n            class="full-width-button"\n            primary="true"\n            on-click="invokeFlowFormCtrl.onConsentClicked"\n            text="invokeFlowFormCtrl.isConsenting ? invokeFlowFormCtrl.clientResources.UserConsent.Consenting : invokeFlowFormCtrl.clientResources.UserConsent.Continue"\n            is-disabled="invokeFlowFormCtrl.isConsenting"\n        ></react-default-button>\n\n        <div class="designerload-spinner-container" ng-if="invokeFlowFormCtrl.designerLoadingSpinner.show">\n            <spinner model="invokeFlowFormCtrl.designerLoadingSpinner"></spinner>\n        </div>\n        <connection-disambiguation ng-show="invokeFlowFormCtrl.shouldShowConnections && (invokeFlowFormCtrl.widgetUtilService.isWidgetPage() || !invokeFlowFormCtrl.expandFlowDescription)"\n            connection-references="invokeFlowFormCtrl.connectionReferences"\n            designer-create-config-parameters="invokeFlowFormCtrl.designerCreateConfigParameters"\n            on-connection-references-resolved="invokeFlowFormCtrl.onClickingContinue"\n            on-connection-disambiguation-loaded="invokeFlowFormCtrl.onConnectionDisambiguationLoaded"\n            is-user-type-flow="invokeFlowFormCtrl.isUserTypeFlow"></connection-disambiguation>\n\n        \x3c!-- NOTE(nidurak): intentionaly using ng-show along side ng-if. We do not want to reconstruct these elements when toggling flow description --\x3e\n        <div class="invoke-flow-form-body" ng-if="invokeFlowFormCtrl.shouldShowInputs" ng-show="invokeFlowFormCtrl.widgetUtilService.isWidgetPage() || !invokeFlowFormCtrl.expandFlowDescription">\n            <div class="scroll-content additional-inputs-info" ng-if="invokeFlowFormCtrl.shouldShowAdditionalInputs">\n                <input-parameter-form\n                    input-parameters="invokeFlowFormCtrl.inputParameters"\n                    on-ready-changed="invokeFlowFormCtrl.onParameterFormReadyChanged"\n                ></input-parameter-form>\n            </div>\n            <div class="no-additional-input-text-wrapper"\n                ng-if="!invokeFlowFormCtrl.isAdditionalInputNeededWithoutLocationParams && !invokeFlowFormCtrl.runStoppedMessage">\n                <span class="no-additional-input-text">\n                    {{::invokeFlowFormCtrl.clientResources.Dialogs.RunFlow.NoAddionalInputNeeded}}\n                </span>\n            </div>\n            <div\n                ng-if="invokeFlowFormCtrl.runStoppedMessage">\n                {{::invokeFlowFormCtrl.runStoppedMessage}}\n            </div>\n            <alert class="alert-container" model="invokeFlowFormCtrl.errorAlert"></alert>\n            <dialog-buttons ng-if="invokeFlowFormCtrl.shouldShowInputs"\n                buttons="invokeFlowFormCtrl.invokeFlowButtons"\n                show-spinner="invokeFlowFormCtrl.showProgressSpinner">\n            </dialog-buttons>\n        </div>\n\n        \x3c!-- See details --\x3e\n        <div ng-if="invokeFlowFormCtrl.widgetUtilService.isWidgetPage()" >\n            <hr class="see-details-divider" />\n            <flow-details flow="invokeFlowFormCtrl.flow" expand-flow-description="invokeFlowFormCtrl.expandFlowDescription"></flow-details>\n        </div>\n    </section>\n    <div aria-live="assertive">\n        <section class="flow-run-request-completion-content" ng-if="invokeFlowFormCtrl.shouldShowCompleted">\n            <span class="ms-Icon ms-Icon--Completed ms-fontColor-green" ng-if="!invokeFlowFormCtrl.isMiniWidget"></span>\n            <img class="mobile-icon" cdn-src="{{invokeFlowFormCtrl.runStartedConfirmationImage}}" role="presentation" ng-if="invokeFlowFormCtrl.isMiniWidget" />\n            <p class="c-paragraph-1">{{::invokeFlowFormCtrl.clientResources.Dialogs.RunFlow.RunStartedSuccessfully}}</p>\n            <a class="flow-run-activity c-paragraph-3"\n                ng-if="!invokeFlowFormCtrl.isUserTypeFlow"\n                ng-href="{{invokeFlowFormCtrl.flowRunHistoryUrl}}"\n                target="_blank">{{::invokeFlowFormCtrl.clientResources.Dialogs.RunFlow.SeeFlowRunActivity}}\n            </a>\n            <div class="c-table flow-run-data" ng-if="invokeFlowFormCtrl.runRowData">\n                <table>\n                    <tr>\n                        <th>{{::invokeFlowFormCtrl.clientResources.Dialogs.RunFlow.RowsSelected}}</th>\n                    </tr>\n                    <tr ng-repeat="runRowData in invokeFlowFormCtrl.runRowData">\n                        <td>{{runRowData}}</td>\n                    </tr>\n                </table>\n            </div>\n            <dialog-buttons buttons="invokeFlowFormCtrl.flowRunRequestCompletionButton"></dialog-buttons>\n        </section>\n    </div>\n    <section class="widget-footer">\n        <widget-consent ng-if="invokeFlowFormCtrl.widgetUtilService.isWidgetPage()"\n            consent-on-action-name="::invokeFlowFormCtrl.clientResources.UserConsent.Continue;">\n        </widget-consent>\n        <button class="edit-button c-glyph glyph-edit"\n            ng-if="invokeFlowFormCtrl.shouldShowEditConnections"\n            ng-click="invokeFlowFormCtrl.showConnections()">\n            {{::invokeFlowFormCtrl.clientResources.RunFlow.EditConnections}}\n        </button>\n        <p class="para-microsoft-flow"\n            ng-if="invokeFlowFormCtrl.widgetUtilService.isWidgetPage()"\n            ng-bind-html="invokeFlowFormCtrl.flowAdvertisementHtml">\n        </p>\n    </section>\n</div>\n'},34120:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34121),a=[["resources",{watchDepth:"reference"}],["store",{watchDepth:"reference"}]];r.a.directive(n.a.components.react.reactEasyAutomationPanel,[n.a.modules.reactDirective,e=>e(o.a,a)])},34121:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r,n=i(14337),o=i(11766),a=i(12999),s=i(20007),l=i(34122);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=g(e);if(t){var n=g(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return m(this,i)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=Object(n.c)(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,i,r,n=h(d);function d(){return c(this,d),n.apply(this,arguments)}return t=d,(i=[{key:"render",value:function(){var{store:e,resources:t}=this.props;return o.createElement(o.Fragment,null,Object(a.a)().enableEasyAutomationDataTrainingExperience&&o.createElement(l.a,{store:e}),o.createElement(s.a,{isOpen:e.isFeedbackPanelOpen,onDismiss:e.onFeedbackPanelDismiss,getUserContext:e.getFeedbackSurveyUserContext,resources:t}))}}])&&u(t.prototype,i),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.Component))||r},34122:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(15501),n=i(14965),o=i(15028),a=i(11773),s=i(14337),l=i(11766),c=i(14947),u=i(21035),d=i(20914),p=Object(s.c)(e=>{var{store:t}=e,{isTrainingDataSharingPanelOpen:i,onTrainingDataSharingPanelDismiss:r,getWorkflowDefinitionFunction:n,sendTrainingData:o}=t;return n?l.createElement(c.a,{isOpen:i,title:"Add this action to EasyAutomation training data",dataAutomationId:u.a.easy_automation_panel,onDismissed:r,footerButtons:[{dismissableOnClick:e=>{o(),e()},primary:!0,text:"Save"},{dismissableOnClick:r,primary:!1,text:"Cancel"}]},i&&l.createElement(h,{store:t})):null}),h=Object(s.c)(e=>{var t,{store:i}=e,{tokenContext:s,nodeIds:c,onCheckboxChange:u,getWorkflowDefinitionFunction:p,prompt:h,onPromptChange:m}=i,g=l.useMemo(()=>null==p?void 0:p(),[p]),f=l.useMemo(()=>{var e;return Object(d.b)((null==g||null===(e=g.definition)||void 0===e?void 0:e.actions)||{})},[g]);return p?l.createElement(l.Fragment,null,l.createElement(o.a,{label:"What would you have asked in human language to get this action?",value:h,onChange:m}),l.createElement(n.a,null),l.createElement("div",null,l.createElement("b",null,"Select the action or actions that you are describing:")),g&&g.definition&&Object.keys((null==g||null===(t=g.definition)||void 0===t?void 0:t.triggers)||{}).concat(Object.keys(f)).map(e=>l.createElement(r.a,{key:e,label:e,checked:null==c?void 0:c.includes(e.toLowerCase()),onChange:Object(a.action)((t,i)=>u(e,i))})),l.createElement(n.a,null),l.createElement("div",null,s?l.createElement("div",null,l.createElement("b",null,"Detected dynamic values:"),l.createElement("br",null),s.map(e=>e&&l.createElement("div",{key:e[0].nodeId},l.createElement("br",null),l.createElement("b",null,e[0].nodeId),l.createElement("br",null),e.length," dynamic values detected",l.createElement("br",null)))):l.createElement("b",null,"No tokens detected for this context. Please open the action to generate tokens for it"))):null})},34123:function(e,t,i){"use strict";i(33434),i(33388),i(34124),i(33428),i(33450),i(34128),i(34132),i(34136)},34124:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34125),a=["downloadButton","isFilterSelectedFromFiltersMenu","isLoading","filters",["flow",{watchDepth:"collection"}],"flowDetailsUrl",["runs",{watchDepth:"collection"}],"runsPageUrl","isLoadingMore","isLoadingTriggerOutputs","messageBarProps","hasMore","getRemediation","getSupportDocuments","getRunLink","onCancel","onEdit","onFlowNameClick","onLoadMore","onResubmit","throttlingMessage","latestColumnHeaderList","savedColumnHeaders","triggerOutputs","friendlyMappingForButtonTriggerParameters","onSaveColumnHeaders","onRunClick","onAddColumnClick","clientResources","appSettings","assetService","cdnService","telemetryService","loggingService","flowService","sessionStore"];r.a.directive(n.a.components.react.reactRunsPage,[n.a.modules.reactDirective,e=>e(o.a,a)])},34125:function(e,t,i){"use strict";i.d(t,"a",(function(){return ie}));var r,n=i(14672),o=i(12812),a=i(12862),s=i(14982),l=i(12831),c=i(15021),u=i(12754),d=i(13262),p=i(12728),h=i(12839),m=i(14337),g=i(11766),f=i(22769),v=i(14657),b=i(16845),y=i(14346),w=i(15941),S=i(13016),C=i(19878),k=i(21946),P=i(34094),x=i(22264),A=i(20357),T=i(13154),R=i(13272),O=i(12339),D=i(12999),E=i(12375),F=i(16926),I=i(14877),j=i(22771),N=i(13031),M=i(22770),L=i(22779),U=i(22775),B=i(14835),$=i(34126),q=i(33399),W=i(13202),z=i(13240),H=i(17142),V=i(16824);function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function G(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,K(r.key),r)}}function K(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function X(e,t){return(X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Q(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=Z(e);if(t){var n=Z(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return J(this,i)}}function J(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Y(e)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee=function(e){return e.cancel="cancel",e.download="download",e.edit="edit",e.filter="filter",e.info="info",e.resubmit="resubmit",e.clearSelection="clearSelection",e.cancelAllRuns="cancelAllRuns",e}({}),te=function(e){return e.flowDisplayName="flowDisplayName",e.runHistoryText="runHistoryText",e}({}),ie=Object(m.c)(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(K,e);var t,i,r,m=Q(K);function K(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,K),(t=m.call(this,e)).featureFlags=Object(D.a)(),t.appSettings=Object(O.b)(),t.palette=Object(u.Y)().palette,t.async=void 0,t.filtersFarItemRef=void 0,t.disposed=!1,t.cancelAllRunsStatus=void 0,t.onLoadError=(e,i,r)=>{t.props.loggingService.logError(e,i,r)},t.durationColumn={key:M.b.duration,name:t.clientResources.ListHeader.Duration,fieldName:M.b.duration,minWidth:M.a.commonMin,maxWidth:M.a.commonMax,columnActionsMode:s.b.disabled,onRender:e=>g.createElement(x.a,{clientResources:t.clientResources.DateTime,startDateTime:e.properties.startTime,endDateTime:e.properties.endTime})},t.addColumn={key:M.b.addColumn,name:t.clientResources.ListHeader.AddColumn,fieldName:M.b.addColumn,minWidth:M.a.mediumMin,maxWidth:M.a.smallMax,styles:{filterChevron:{visibility:"hidden"}},columnActionsMode:s.b.hasDropdown,onColumnClick:()=>{t.props.onAddColumnClick&&t.props.onAddColumnClick(),t.setState({isEditColumnsPanelOpen:!0,isRemediationSidePaneOpen:!1})},onRenderHeader:()=>g.createElement("div",null,g.createElement(o.a,{iconName:R.a.Add,styles:{root:{marginRight:"5px",fontSize:u.p.small}}}),g.createElement("span",null,t.clientResources.ListHeader.AddColumn))},t.selection=void 0,t.renderPageHeader=()=>g.createElement(C.a,t.getPageHeaderProps()),t.renderDetailsList=()=>g.createElement(b.a,t.getDetailsListProps()),t.getSidePane=()=>{var e,{brokenConnectionsUrl:i,failedOperation:r,isRemediationSidePaneOpen:n,isEditColumnsPanelOpen:o,remediationData:a,run:s,selected:l}=t.state;return n?g.createElement(P.a,{brokenConnectionsUrl:i||void 0,isOpen:n,failedOperation:r||void 0,numberSelected:l.length,remediationData:a,run:s,onDismiss:t.onDismiss,appSettings:t.props.appSettings,assetService:t.props.assetService,cdnService:t.props.cdnService,clientResources:t.props.clientResources,dateTimeResources:t.props.clientResources.DateTime,sharedComponentResources:t.props.clientResources,telemetryService:t.props.telemetryService}):o?g.createElement(L.a,{latestRunOutputs:null===(e=t.props.latestColumnHeaderList)||void 0===e?void 0:e.slice(),previouslySelectedColumns:t.props.savedColumnHeaders.slice(),friendlyMappingForButtonTriggerParameters:t.props.friendlyMappingForButtonTriggerParameters,clientResources:t.props.clientResources,triggerDoesNotSupportOutputs:!!t.props.flow&&!Object(B.o)(t.props.flow),surfaceKey:Object(p.a)("edit-run-history-columns-panel"),onSave:t.props.onSaveColumnHeaders,dismiss:t.onDismiss}):g.createElement(g.Fragment,null)},t.onDismiss=()=>{t.setState({isRemediationSidePaneOpen:!1,isEditColumnsPanelOpen:!1})},t.onSelectionChanged=()=>{if(!t.disposed){var{getRemediation:e,getSupportDocuments:i}=t.props,r=t.selection.getSelection();if(1===r.length)t.setState({selected:r,brokenConnectionsUrl:null,failedOperation:null,remediationData:null,run:r[0]}),r[0].properties.status!==T.u.failed||Object(I.j)(r[0])||e(r[0].name,r[0].isMigrationSource).then(e=>{var n;if(!t.disposed)return null!=e&&null!==(n=e.remediationData)&&void 0!==n&&n.searchText?(t.setState({brokenConnectionsUrl:e.brokenConnectionsUrl,failedOperation:e.failedOperation,remediationData:e.remediationData,isRemediationPaneUniversalSearchCompleted:!1}),i(r[0].name,e)):null}).then(e=>{t.disposed||(e?t.setState({brokenConnectionsUrl:e.brokenConnectionsUrl,failedOperation:e.failedOperation,remediationData:e.remediationData,isRemediationPaneUniversalSearchCompleted:!0}):t.setState({isRemediationPaneUniversalSearchCompleted:!0}))});else{var n;if(0===r.length&&0===(null===(n=t.state.selected)||void 0===n?void 0:n.length))return;t.setState({selected:r,run:null})}}},t.renderCommandBar=()=>{var e=t.getCommandBarProps();return e?g.createElement(v.a,e):null},t.renderMessageBar=()=>{var e=t.getMessageBarProps();return e?g.createElement(S.a,e):null},t.getCommandBarProps=()=>{var{filters:e,isLoading:i,isLoadingMore:r}=t.props,n=i||r,o=[];return e&&(o=[{componentRef:t.setFiltersFarItemRef,key:ee.filter,name:e.selected&&e.selected.name||"",iconProps:{iconName:R.a.Breadcrumb},disabled:n,subMenuProps:{isBeakVisible:!1,items:e.available.map(t=>({canCheck:""!==t.name,checked:t.name===(e.selected&&e.selected.name),key:t.key,name:t.name,itemType:""===t.name?a.a.Divider:a.a.Normal,"data-automation-id":t.key})),directionalHintFixed:!0,onItemClick:e.onSelect},"data-automation-id":ee.filter},{key:ee.info,ariaLabel:t.clientResources.Common.Details,iconProps:{iconName:R.a.Info},style:t.state.isRemediationSidePaneOpen?{backgroundColor:t.palette.neutralLighter}:{},onClick:()=>{t.setState({isRemediationSidePaneOpen:!t.state.isRemediationSidePaneOpen,isEditColumnsPanelOpen:!1})},title:t.clientResources.Common.Details,"data-automation-id":ee.info}]),t.selection.count>0&&o.unshift({key:ee.clearSelection,name:Object(N.a)(t.clientResources.FlowRun.ClearSelection,t.selection.count.toString()),ariaLabel:Object(N.a)(t.clientResources.FlowRun.ClearSelectionAriaLabel,t.selection.count.toString()),iconProps:{iconName:R.a.Cancel},onClick:()=>{t.selection.setAllSelected(!1)},"data-automation-id":ee.clearSelection}),{items:t.getCommandBarItems(n),farItems:o}},t.setFiltersFarItemRef=e=>{t.filtersFarItemRef=e},t.getCommandBarItems=e=>{var{downloadButton:i,onCancel:r,onEdit:n,onResubmit:o,flow:a}=t.props,{selected:s}=t.state;if(s&&0!==s.length)return[{key:ee.resubmit,name:t.featureFlags.enableFlowRunBulkOperations?t.clientResources.FlowRun.BulkResubmit:t.clientResources.FlowRun.Resubmit,iconProps:{iconName:R.a.Refresh},disabled:e||Object(I.b)(s)||s.length>t.appSettings.flowRunsBulkResubmitBatchSize||Object(I.i)(t.props.flow,t.props.sessionStore.user),onClick:o,tooltipHostProps:Object(I.i)(t.props.flow,t.props.sessionStore.user)?{content:g.createElement(g.Fragment,null,t.clientResources.FlowRun.ResubmitTenantSettingDisabled,g.createElement(y.a,{href:I.d,target:y.b.blank},t.clientResources.Common.LearnMore)),closeDelay:1e3}:void 0,commandBarButtonAs:Object(I.i)(t.props.flow,t.props.sessionStore.user)?t.commandBarButtonWithTooltip:void 0,data:s,"data-automation-id":ee.resubmit},{key:ee.cancel,name:t.featureFlags.enableFlowRunBulkOperations?t.clientResources.FlowRun.BulkCancel:t.clientResources.FlowRun.Cancel,iconProps:{iconName:R.a.Cancel},disabled:e||Object(I.b)(s)||s.length>t.appSettings.flowRunsBulkCancelBatchSize||!Object(I.c)(s),onClick:r,data:s,"data-automation-id":ee.cancel}];var l=[{key:ee.edit,name:t.clientResources.Flow.Commands.EditFlow,iconProps:{iconName:R.a.Edit},disabled:e,onClick:n,"data-automation-id":ee.edit}];return i&&l.push({key:ee.download,name:t.clientResources.FlowRuns.GenerateCsv.Text,iconProps:{iconName:R.a.Download},disabled:i.disabled,onClick:i.onClick,"data-automation-id":ee.download}),Object(q.a)()&&l.push({key:ee.cancelAllRuns,name:t.clientResources.FlowRuns.CancelAllRuns,iconProps:{iconName:R.a.Cancel},disabled:e||Object(F.C)(a),onClick:t.renderCancelAllRunsSurface,"data-automation-id":ee.cancelAllRuns}),l},t.commandBarButtonWithTooltip=e=>g.createElement(d.a,_({content:e.title},e.tooltipHostProps),g.createElement(n.a,e)),t.renderCancelAllRunsSurface=()=>{var{flowService:e,telemetryService:i,loggingService:r,clientResources:n,flow:o}=t.props;i.tagEvent(z.c.CancelAllRunsClicked);var a=Object(F.c)(o);t.props.flowService.loadFlow(a).then(()=>{var o=e.getFlow(a);if(!o)throw new Error("The flow could not be found");t.setState({isCancelAllRunsSurfaceOpen:!0}),Object($.a)(W.a,{flow:o,onSuccess:()=>{t.cancelAllRunsStatus=t.clientResources.Common.Success},onError:()=>{t.cancelAllRunsStatus=t.clientResources.Common.Error},onClose:()=>{t.setState({isCancelAllRunsSurfaceOpen:!1})},flowService:e,clientResources:n,loggingService:r,telemetryService:i})}).catch(e=>{r.logError("runsPage.renderCancelAllRunsSurface",e)})},t.getDetailsListProps=()=>{var{hasMore:e,isLoading:i,onLoadMore:r,runs:n}=t.props,o=t.columns;return t.showRunIdentifierColumns()&&o.indexOf(t.addColumn)<0&&o.splice(o.length-1,0,t.addColumn),{ariaLabelForSelectionColumn:"".concat(t.clientResources.Common.Select," ").concat(t.clientResources.FlowRun.Title),checkButtonAriaLabel:t.clientResources.Common.RowSelectionAriaLabel,columns:o,emptyProps:{message:t.clientResources.FlowRun.No.Runs.Heading,details:t.clientResources.FlowRun.No.Runs.Description},isLoading:i,items:n,showLoadMoreButton:e,onLoadMore:r,selection:t.selection,singleSelectionMode:!t.featureFlags.enableFlowRunBulkOperations,getKey:e=>e.name,onShouldVirtualize:()=>!1}},t.getMessageBarProps=()=>{var{downloadButton:e,messageBarProps:i,throttlingMessage:r,runs:n}=t.props;if(i)return i;var{selected:o}=t.state;if(o&&(o.length>t.appSettings.flowRunsBulkResubmitBatchSize||o.length>t.appSettings.flowRunsBulkCancelBatchSize&&Object(I.c)(o)))return{ariaLabel:t.clientResources.Common.Warning,type:S.c.warning,onRenderBody:()=>g.createElement("div",null,o.length>t.appSettings.flowRunsBulkResubmitBatchSize&&o.length>t.appSettings.flowRunsBulkCancelBatchSize&&Object(I.c)(o)?Object(N.a)(t.clientResources.FlowRun.ResubmitCancelLimitWarning,t.appSettings.flowRunsBulkCancelBatchSize):o.length>t.appSettings.flowRunsBulkResubmitBatchSize?Object(N.a)(t.clientResources.FlowRun.ResubmitCancelLimitWarning,t.appSettings.flowRunsBulkResubmitBatchSize):Object(N.a)(t.clientResources.FlowRun.CancelLimitWarning,t.appSettings.flowRunsBulkCancelBatchSize))};if(r)return{ariaLabel:t.clientResources.Common.Warning,type:S.c.warning,onRenderBody:()=>g.createElement("div",null,g.createElement(w.b,{interpolatedString:r,links:[{text:t.clientResources.Common.LearnMore,href:t.clientResources.FlowsRuns.PowerAutomateRateLimits.Link,target:y.b.blank}]}))};if(Object(q.a)()){if(t.cancelAllRunsStatus===t.clientResources.Common.Success)return t.cancelAllRunsStatus=null,{ariaLabel:t.clientResources.Common.Success,type:S.c.info,onRenderBody:()=>g.createElement("div",null,t.clientResources.FlowRuns.CancellingRunsMessage,g.createElement(y.a,{href:"https://go.microsoft.com/fwlink/?linkid=2252869",target:y.b.blank},t.clientResources.Common.LearnMore))};if(t.cancelAllRunsStatus===t.clientResources.Common.Error)return t.cancelAllRunsStatus=null,{ariaLabel:t.clientResources.Common.Error,type:S.c.error,onRenderBody:()=>t.clientResources.Common.SomethingWentWrong}}return e&&e.href?{ariaLabel:t.clientResources.FlowRuns.DownloadCsv.Text,type:S.c.success,onRenderBody:()=>g.createElement(y.a,{href:e.href},t.clientResources.FlowRuns.DownloadCsv.Text)}:Object(q.a)()&&null!=n&&n.find(e=>e.properties.status===T.u.cancelling)?{ariaLabel:t.clientResources.FlowRuns.CancellingRunsMessage,type:S.c.info,onRenderBody:()=>g.createElement("div",null,t.clientResources.FlowRuns.CancellingRunsMessage,g.createElement(y.a,{href:"https://go.microsoft.com/fwlink/?linkid=2252869",target:y.b.blank},t.clientResources.Common.LearnMore))}:null},t.getPageHeaderProps=()=>{var{flow:e,flowDetailsUrl:i,onFlowNameClick:r,runsPageUrl:n}=t.props;return{breadcrumbProps:{items:[{key:te.flowDisplayName,text:Object(F.b)(e),href:i,onClick:r},{key:te.runHistoryText,text:t.clientResources.FlowPropertyTile.FlowRunsTile.Title,href:n,isCurrentItem:!0}]}}},t.selection=new c.a({onSelectionChanged:t.onSelectionChanged}),t.state={brokenConnectionsUrl:null,failedOperation:null,isRemediationSidePaneOpen:!1,isEditColumnsPanelOpen:!1,isRemediationPaneUniversalSearchCompleted:!1,remediationData:null,run:null,selected:[],isCancelAllRunsSurfaceOpen:!1},t.async=new h.a(Y(t)),t}return t=K,(i=[{key:"clientResources",get:function(){return this.props.clientResources}},{key:"columns",get:function(){var e=this.showRunIdentifierColumns()&&this.props.savedColumnHeaders?this.getAdditionalColumns():[this.durationColumn];return[{key:M.b.startTime,name:this.clientResources.ListHeader.StartTime,fieldName:M.b.startTime,minWidth:M.a.mediumMin,maxWidth:M.a.commonMax,isRowHeader:!0,columnActionsMode:s.b.disabled,onRender:e=>this.disposed?null:g.createElement(y.a,{href:this.props.getRunLink(e),onClick:this.props.onRunClick},g.createElement(A.a,{iso:e.properties.startTime,locale:Object(E.a)(),dateTimeResources:this.clientResources.DateTime}))},...e,{key:M.b.status,name:this.clientResources.ListHeader.Status,fieldName:M.b.status,minWidth:M.a.commonMin,className:b.b.reset,columnActionsMode:s.b.disabled,onRender:e=>g.createElement(f.a,{status:e.properties.status,tooltip:Object(j.b)(e,this.clientResources)||"",width:M.a.smallMax},Object(j.b)(e,this.clientResources))}]}},{key:"render",value:function(){var e="fl-RunsPage".concat(this.state.isRemediationSidePaneOpen||this.state.isEditColumnsPanelOpen?" fl-PageList--sidePaneIsOpen":"");return g.createElement(l.a,null,g.createElement(H.a,{key:"fl-RunsPage",onError:this.onLoadError,globalResources:this.props.clientResources,sharedComponentResources:this.props.clientResources,fallbackUI:()=>g.createElement(V.a,{type:S.c.error,ariaLabel:this.props.clientResources.Common.SomethingWentWrong,message:this.props.clientResources.Common.SomethingWentWrong})},g.createElement(k.a,{className:e,isLoading:!this.props.runs&&!this.props.flow,updateHeightForRunsPage:this.featureFlags.enableFlowRunIdentifier,renderCommandBar:this.renderCommandBar,renderDetailsList:this.renderDetailsList,renderMessageBar:this.renderMessageBar,renderPageHeader:this.renderPageHeader,onRenderSidePane:this.getSidePane})))}},{key:"componentDidUpdate",value:function(){this.props.isFilterSelectedFromFiltersMenu&&this.filtersFarItemRef&&this.filtersFarItemRef.focus&&this.async.setTimeout(()=>{this.filtersFarItemRef.focus()},0)}},{key:"componentWillUnmount",value:function(){this.disposed=!0}},{key:"getAdditionalColumns",value:function(){for(var{savedColumnHeaders:e}=this.props,t=[],i=0;i<e.length;i++)e[i]===M.b.duration?t.unshift(this.durationColumn):t.push(this.getDynamicColumn(e[i]));return t}},{key:"getDynamicColumn",value:function(e){var{friendlyMappingForButtonTriggerParameters:t}=this.props,i=e;return t&&t[e]&&(i=t[e]),{key:e,name:i,fieldName:e,minWidth:M.a.mediumMin,maxWidth:M.a.commonMax,columnActionsMode:s.b.disabled,isResizable:!0,onRender:t=>this.onRenderCustom(t,e)}}},{key:"onRenderCustom",value:function(e,t){var{triggerOutputs:i,isLoadingTriggerOutputs:r}=this.props,n=i&&i[e.name],o=n?JSON.stringify(n[t]):"";return g.createElement(U.a,{text:o,isLoading:r})}},{key:"showRunIdentifierColumns",value:function(){var e=this.props.filters.selected.key;return this.featureFlags.enableFlowRunIdentifier&&e!==T.c.skippedRuns&&e!==T.c.failedTriggers}}])&&G(t.prototype,i),r&&G(t,r),Object.defineProperty(t,"prototype",{writable:!1}),K}(g.Component))||r},34126:function(e,t,i){"use strict";i.d(t,"a",(function(){return N}));var r,n,o,a,s,l,c=i(12706),u=i(12728),d=i(11766),p=i(14337),h=i(11773),m=i(34127),g=i(15497),f=i(13240),v=i(16926),b=i(13085),y=i(14839),w=i(13009),S=i(13143),C=i(14346);function k(){return(k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function P(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function T(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function R(e,t){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,r=F(e);if(t){var n=F(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return D(this,i)}}function D(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t,i,r,n){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var j=Object(p.c)((n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(u,e);var t,i,r,n=O(u);function u(){var e;x(this,u);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=n.call(this,...i)).getClassNames=Object(c.a)(),P(e,"isDisableBoxChecked",o,E(e)),P(e,"isAbortRunsThrottled",a,E(e)),P(e,"onCheckBoxChange",s,E(e)),e.onConfirm=()=>{var{flow:t,flowService:i,loggingService:r,onError:n}=e.props,o=Object(v.c)(t),a={flow:o,isSolutionFlow:Object(v.y)(t)},s=r.profileStart(b.a.cancelAllRunsOperationStart);Object(y.b)(t)&&e.isDisableBoxChecked?(e.props.telemetryService.tagEvent(f.c.DisablingFlowFromBulkCancel),i.toggleFlowState(o).then(()=>{e.AbortAllRuns(o,a,s)}).catch(t=>{r.profileEnd(s,b.a.cancelAllRunsOperationEnd,w.e.Failure,t,a),n(),e.onDismiss()})):e.AbortAllRuns(o,a,s)},e.AbortAllRuns=(t,i,r)=>{var{flowService:n,loggingService:o,onError:a,onSuccess:s}=e.props;n.abortAllRuns(t).then(()=>{o.profileEndWithSuccess(r,b.a.cancelAllRunsOperationEnd,i),s(),e.onDismiss()}).catch(t=>{o.profileEnd(r,b.a.cancelAllRunsOperationEnd,Object(w.y)(t),t,i),Object(w.cb)(t)===S.b.RequestConflict?e.displayThrottledMessage():(a(),e.onDismiss())})},P(e,"displayThrottledMessage",l,E(e)),e.onDismiss=()=>{e.props.dismiss(),e.props.onClose()},e}return t=u,(i=[{key:"render",value:function(){var e=this.getClassNames(m.b);return this.isAbortRunsThrottled?d.createElement(g.b,{className:e.dialog,hidden:!1,maxWidth:m.a,primaryButtonProps:this.okButtonProps,title:this.props.clientResources.FlowRuns.CancelAllRunsInProgressMessage.Title,onDismiss:this.onDismiss},d.createElement("p",{className:e.subText,"aria-live":"polite"},this.props.clientResources.FlowRuns.CancelAllRunsInProgressMessage.SubText)):d.createElement(g.b,{className:e.dialog,hidden:!1,maxWidth:m.a,primaryButtonProps:this.yesButtonProps,secondaryButtonProps:this.noButtonProps,title:this.props.clientResources.FlowRuns.CancelAllRunsSurface.Title,onDismiss:this.onDismiss,checkboxProps:this.checkboxProps},d.createElement("p",{className:e.subText},this.props.clientResources.FlowRuns.CancelAllRunsSurface.SubText),d.createElement("ul",{className:e.list},d.createElement("li",{className:e.listItem},this.props.clientResources.FlowRuns.CancelAllRunsSurface.FlowState),d.createElement("li",{className:e.listItem},this.props.clientResources.FlowRuns.CancelAllRunsSurface.FlowThrottled),d.createElement("li",{className:e.listItem},this.props.clientResources.FlowRuns.CancelAllRunsSurface.ExpediteCancellation)),d.createElement("p",{className:e.subText},d.createElement("div",{className:e.link},d.createElement(C.a,{href:"https://go.microsoft.com/fwlink/?linkid=2252869",target:C.b.blank},this.props.clientResources.Common.LearnMore))))}},{key:"checkboxProps",get:function(){return{checked:this.isDisableBoxChecked,label:this.props.clientResources.FlowRuns.CancelAllRunsSurface.CheckBoxText,onChange:this.onCheckBoxChange}}},{key:"yesButtonProps",get:function(){return{primary:!0,text:this.props.clientResources.Common.Yes,onClick:this.onConfirm}}},{key:"noButtonProps",get:function(){return{text:this.props.clientResources.Common.No,onClick:this.onDismiss}}},{key:"okButtonProps",get:function(){return{primary:!0,text:this.props.clientResources.Common.Ok,onClick:this.onDismiss}}}])&&A(t.prototype,i),r&&A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(d.Component),o=I(n.prototype,"isDisableBoxChecked",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=I(n.prototype,"isAbortRunsThrottled",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I(n.prototype,"yesButtonProps",[h.computed],Object.getOwnPropertyDescriptor(n.prototype,"yesButtonProps"),n.prototype),I(n.prototype,"noButtonProps",[h.computed],Object.getOwnPropertyDescriptor(n.prototype,"noButtonProps"),n.prototype),I(n.prototype,"okButtonProps",[h.computed],Object.getOwnPropertyDescriptor(n.prototype,"okButtonProps"),n.prototype),s=I(n.prototype,"onCheckBoxChange",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.props.telemetryService.tagEvent(f.c.TurnOffFlowCheckBoxClicked,{isChecked:t}),this.isDisableBoxChecked=t}}}),l=I(n.prototype,"displayThrottledMessage",[h.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.props.telemetryService.tagEvent(f.c.CancelAllRunsThrottledMessageShown),this.isAbortRunsThrottled=!0}}}),r=n))||r;function N(e,t){e.spawn({key:Object(u.a)("cancel-all-runs-surface"),render:e=>d.createElement(j,k({},t,e))})}},34127:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var r=i(12754),n=440,o=()=>{var e=Object(r.Y)().palette;return{dialog:["fl-cancelAllRunsDialog",{selectors:{".ms-Dialog-actions":{margin:"24px 0 0 0"},".ms-Dialog-title":{fontSize:"20px",lineHeight:"28px"},".ms-Dialog-subText":{paddingTop:"0px"},".ms-Checkbox":{padding:"20px 0 0 0"}}}],subText:["fl-cancelAllRunsDialog-subText",{font:r.k.medium,padding:"0px",color:e.neutralPrimary,lineHeight:"20px",wordWrap:"break-word",fontWeight:r.l.regular,fontSize:r.k.size14}],link:["fl-learnMore",{color:e.themePrimary,":hover":{color:"inherit"},".ms-Link, .fl-Link, .root":{color:e.themePrimary,":hover":{color:e.themeTertiary}}}],list:["fl-cancelAllRunsDialog-list",{listStyleType:"disc",paddingLeft:"20px"}],listItem:["fl-cancelAllRunsDialog-listItem",{marginBottom:"5px"}]}}},34128:function(e,t,i){"use strict";i(34129)},34129:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34130);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bindings={options:"="},this.controller=o.a,this.template=i(34131),this.controllerAs="ngFlowRunOnlyUsersUICtrl"}));r.a.component(n.a.components.ngReactBridge.ngFlowRunOnlyUsersUI,new c)},34130:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(33327),n=i(33396),o=i(33353),a=i(13009);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=l((function e(t,i,r,s,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$scope=i,this.clientResources=r,this.flowsClient=s,this.environmentService=l,this.loggingService=c,this.context=void 0,this.errorAlert={type:o.a.None,message:"",options:{}},this.flow=void 0,this.flowId=void 0,this.flowName=void 0,this.showInfoPane=void 0,this.populateRunOnlyUser=!1,this.options=void 0,this.$onInit=()=>{this.onShowRunOnlyUsersPane(),this.$scope.$watch(()=>this.options,this.onShowRunOnlyUsersPane)},this.onShowRunOnlyUsersPane=()=>{this.$scope.$applyAsync(()=>{this.populateRunOnlyUser=this.options.populateRunOnlyUser,this.flowName=this.options.flowName,this.flowId=Object(n.b)(this.flowName,this.environmentService),this.flowsClient.refresh({id:this.flowId,draftflow:!0}).then(()=>this.flowsClient.get(this.$scope,{id:this.flowId,draftflow:!0}).$promise).then(e=>{this.flow=e,this.showInfoPane=!0}).catch(e=>{this.errorAlert={type:o.a.Error,message:Object(a.db)(e,this.clientResources.Common.SomethingWentWrong)}})})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"NgFlowRunOnlyUsersUICtrl"}),this.context={onInit:()=>this.$q.resolve()}}));u.$inject=[r.a.services.$q,r.a.services.$scope,r.a.services.clientResources,r.a.services.flowsClient,r.a.services.environment,r.a.services.logging]},34131:function(e,t){e.exports='<flow-run-only-tile\n    flow-name="ngFlowRunOnlyUsersUICtrl.flowName"\n    flow-id="ngFlowRunOnlyUsersUICtrl.flowId"\n    flow="ngFlowRunOnlyUsersUICtrl.flow"\n    error-alert="ngFlowRunOnlyUsersUICtrl.errorAlert"\n    context="ngFlowRunOnlyUsersUICtrl.context"\n    populate-run-only-user="ngFlowRunOnlyUsersUICtrl.populateRunOnlyUser"\n    show-tile="false"\n    info-pane="ngFlowRunOnlyUsersUICtrl.showInfoPane">\n</flow-run-only-tile>\n'},34132:function(e,t,i){"use strict";i(34133)},34133:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34134);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bindings={options:"="},this.controller=o.a,this.template=i(34135),this.controllerAs="ngFlowSaveAsCtrl"}));r.a.component(n.a.components.ngReactBridge.ngFlowSaveAsUI,new c)},34134:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(33327),n=i(33396);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function a(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=a((function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.environmentService=i,this.loggingService=r,this.flowSaveAsDialog={show:!1,flowId:null,flowData:null,onHide:()=>{}},this.options=void 0,this.onShowSaveAsDialog=()=>{this.$scope.$applyAsync(()=>{this.options&&(this.flowSaveAsDialog.flowId=Object(n.b)(this.options.flowName,this.environmentService),this.flowSaveAsDialog.flowData=this.options.flowData,this.flowSaveAsDialog.onError=this.options.reject,this.flowSaveAsDialog.onHide=e=>{this.options.show=!1,this.options.resolve(e)},this.flowSaveAsDialog.show=!0)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"NgFlowSaveAsUICtrl"}),this.onShowSaveAsDialog(),this.$scope.$watch(()=>this.options,this.onShowSaveAsDialog)}));l.$inject=[r.a.services.$scope,r.a.services.environment,r.a.services.logging]},34135:function(e,t){e.exports='<flow-save-as-dialog\n    modal-dialog="ngFlowSaveAsCtrl.flowSaveAsDialog"\n    ng-if="ngFlowSaveAsCtrl.flowSaveAsDialog.show">\n</flow-save-as-dialog>'},34136:function(e,t,i){"use strict";i(34137)},34137:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34138);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bindings={options:"="},this.controller=o.a,this.template=i(34139),this.controllerAs="ngFlowSendACopyUICtrl"}));r.a.component(n.a.components.ngReactBridge.ngFlowSendACopyUI,new c)},34138:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function o(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=o((function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.loggingService=i,this.flowSendACopyPanel={isOpen:!1},this.options=void 0,this.onShowSendACopyPane=()=>{this.$scope.$applyAsync(()=>{this.options&&(this.flowSendACopyPanel.isOpen=!0,this.flowSendACopyPanel.flowName=this.options.flowName)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"NgFlowSendACopyUICtrl"}),this.$scope.$watch(()=>this.options,this.onShowSendACopyPane)}));s.$inject=[r.a.services.$scope,r.a.services.logging]},34139:function(e,t){e.exports='<flow-send-a-copy-panel \n    flow-name="ngFlowSendACopyUICtrl.flowSendACopyPanel.flowName"\n    is-open="ngFlowSendACopyUICtrl.flowSendACopyPanel.isOpen">\n</flow-send-a-copy-panel>'},34140:function(e,t,i){"use strict";i(33457),i(33462),i(33988),i(33396),i(33443),i(34141),i(34144),i(33468)},34141:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33454),a=i(33439),s=i(33360),l=i(34142),c=i(33571),u=i(34143),d=i(17237),p=i(17239);function h(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function m(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){h(o,r,n,a,s,"next",e)}function s(e){h(o,r,n,a,s,"throw",e)}a(void 0)}))}}function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v="ReadAccess, WriteAccess, AppendAccess, AppendToAccess, CreateAccess, DeleteAccess, ShareAccess, AssignAccess",b="Microsoft.Dynamics.CRM.team",y=function(){function e(t,i,r,n,o,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.promiseHelperService=i,this.xrmService=r,this.xrmSystemUsersClient=n,this.environmentService=o,this.environmentCapabilityService=a,this.loggingService=s,this.cache=new u.a,this.enableSolutionFlowSharepointDelegatedAuth=void 0,this.enableSolutionFlowSharepointDelegatedAuth=Object(d.c)(this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,this.loggingService)}var t,i,r,n,h,f,y,w,S,C;return t=e,(i=[{key:"getFlowUsers",value:(C=m((function*(e){return this.enableSolutionFlowSharepointDelegatedAuth.then(t=>{if(t){var i=this.getFlowSharingPrincipalsWithAccessLevel(e,a.a.User),r=this.getFlowSharingSharepointTeams(e,a.a.User);return Promise.all([i,r]).then(e=>{var[t,i]=e;return t.forEach((e,r)=>{i.forEach(i=>{i.id===e.id&&(t[r]=i)})}),t}).catch(e=>{throw this.loggingService.logError("xrmRolesClient.getFlowOwners.delegatedAuthEnabled",e),e})}return this.getFlowSharingPrincipalsWithAccessLevel(e,a.a.User)})})),function(e){return C.apply(this,arguments)})},{key:"getFlowOwners",value:(S=m((function*(e){var t=this.getWorkflowEntityOwner(e),i=this.getFlowSharingPrincipalsWithAccessLevel(e,a.a.Owner);return this.enableSolutionFlowSharepointDelegatedAuth.then(r=>{if(r){var n=this.getFlowSharingSharepointTeams(e,a.a.Owner);return Promise.all([t,i,n]).then(e=>{var[t,i,r]=e;return i.forEach((e,t)=>{r.forEach(r=>{r.id===e.id&&(i[t]=r)})}),[t].concat(i.filter(e=>e.id!==t.id))})}return Promise.all([t,i]).then(e=>{var[t,i]=e;return[t].concat(i.filter(e=>e.id!==t.id))})}).catch(e=>{throw this.loggingService.logError("xrmRolesClient.getFlowOwners.delegatedAuthEnabled",e),e})})),function(e){return S.apply(this,arguments)})},{key:"addFlowOwner",value:function(e,t){return this.grantFlowAccess(e,t,v)}},{key:"addSharepointListAccessToFlow",value:(w=m((function*(e,t,i,r){return this.getTeamIdForSharepointListSite(t,i).then(t=>{var i={id:t,displayName:t,isNonRemovableOwner:!1,email:"",iconUri:"",accessLevel:r,type:a.b.Team};return r===a.a.Owner?this.grantFlowAccess(e,i,v).then(()=>t):this.grantFlowAccess(e,i,"ReadAccess").then(()=>t)})})),function(e,t,i,r){return w.apply(this,arguments)})},{key:"getTeamIdForSharepointListSite",value:(y=m((function*(e,t){return(yield this.provisionDelegation(e,t)).teamid})),function(e,t){return y.apply(this,arguments)})},{key:"removeFlowOwner",value:function(e,t){return this.revokeFlowAccess(e,t)}},{key:"addFlowUser",value:function(e,t){return this.grantFlowAccess(e,t,"ReadAccess")}},{key:"removeFlowUser",value:function(e,t){return this.revokeFlowAccess(e,t)}},{key:"clearFlowAccessCache",value:function(e){this.clearFlowCacheEntry(e)}},{key:"revokeFlowAccess",value:function(e,t){this.clearFlowCacheEntry(e);var i={Target:{"@odata.type":"Microsoft.Dynamics.CRM.workflow",workflowid:e},Revokee:{"@odata.type":t.type===a.b.SystemUser?"Microsoft.Dynamics.CRM.systemuser":b,ownerid:t.id}};return Object(o.a)(this.xrmService.makeXrmCall(c.a.POST,"/RevokeAccess",i)).then(e=>e.data)}},{key:"grantFlowAccess",value:function(e,t,i){this.clearFlowCacheEntry(e);var r={Target:{"@odata.type":"Microsoft.Dynamics.CRM.workflow",workflowid:e},PrincipalAccess:{AccessMask:i,Principal:{"@odata.type":t.type===a.b.SystemUser?"Microsoft.Dynamics.CRM.systemuser":b,ownerid:t.id}}};return Object(o.a)(this.xrmService.makeXrmCall(c.a.POST,"/GrantAccess",r)).then(e=>e.data)}},{key:"provisionDelegation",value:function(e,t){var i={delegatedauthorization:{providertype:1,sharepointsite:e,sharepointlistid:t}};return Object(o.a)(this.xrmService.makeXrmCall(c.a.POST,"/ProvisionDelegation",i)).then(e=>e.data)}},{key:"getWorkflowEntityOwner",value:(f=m((function*(e){var t=yield this.fetchWorkflow(e);if(t._owninguser_value){var i=yield this.xrmSystemUsersClient.getXrmSystemUser(t._owninguser_value);return this.convertSystemUserToFlowSharingPrincipal(i,a.a.Owner,!0)}var r=yield this.xrmSystemUsersClient.getXrmTeam(t._owningteam_value);return this.convertTeamToFlowSharingPrincipal(r,a.a.Owner,!0)})),function(e){return f.apply(this,arguments)})},{key:"getFlowSharingPrincipalsWithAccessLevel",value:(h=m((function*(e,t){return(yield this.getPrincipalsWithFlowAccess(e)).filter(e=>e.accessLevel===t)})),function(e,t){return h.apply(this,arguments)})},{key:"getFlowSharingSharepointTeams",value:(n=m((function*(e,t){var i=this.constructFetchXmlStringForDelegatedAuth(e);return Object(o.a)(this.xrmService.makeXrmCall(c.a.GET,i)).then(e=>{var i,r=null==e||null===(i=e.data)||void 0===i?void 0:i.value,n=[];return r?(r.forEach(e=>{if(e.sharepointlistid){var i={id:e["team1.teamid"],displayName:"",isNonRemovableOwner:!1,email:"",iconUri:"",accessLevel:t,type:a.b.SharepointList,listIdentifier:{list:e.sharepointlistid,site:e.sharepointsite}};n.push(i)}else{var r={id:e["team1.teamid"],displayName:"",isNonRemovableOwner:!1,email:"",iconUri:"",accessLevel:t,type:a.b.SharepointList};n.push(r)}}),n):n})})),function(e,t){return n.apply(this,arguments)})},{key:"getPrincipalsWithFlowAccess",value:function(e){var t={cacheKey:e,valueFactory:()=>this.fetchPrincipalsWithFlowAccess(e)};return this.cache.getValue(t)}},{key:"fetchPrincipalsWithFlowAccess",value:function(e){return Object(o.a)(this.xrmService.makeXrmCall(c.a.GET,Object(s.d)("/RetrieveSharedPrincipalsAndAccess(Target=@wid)?@wid={'@odata.id':'workflows({0})'}",e))).then(e=>this.fetchPrincipalsWithFlowAccessHelper(e)).catch(t=>this.enableSolutionFlowSharepointDelegatedAuth.then(i=>{if(Object(d.a)(t,{delAuthEnabled:i}))return Object(o.a)(this.xrmService.makeXrmCall(c.a.GET,Object(s.d)("/RetrieveSharedPrincipalsAndAccess(Target=@wid)?@wid={'@odata.id':'workflows({0})'}&DelegatedAuthorization=*",e))).then(e=>this.fetchPrincipalsWithFlowAccessHelper(e));throw t}))}},{key:"fetchPrincipalsWithFlowAccessHelper",value:function(e){var t=e.data.PrincipalAccesses.filter(e=>e.Principal["@odata.type"].toLowerCase()==="#".concat("Microsoft.Dynamics.CRM.systemuser".toLowerCase())),i=e.data.PrincipalAccesses.filter(e=>e.Principal["@odata.type"].toLowerCase()==="#".concat(b.toLowerCase())),r=this.xrmSystemUsersClient.getXrmSystemUsers(t.map(e=>e.Principal.ownerid)).then(e=>t.map(t=>{var i=e.find(e=>e.systemuserid===t.Principal.ownerid);return this.convertSystemUserToFlowSharingPrincipal(i,Object(l.a)(t.AccessMask),!1)})),n=this.xrmSystemUsersClient.getXrmTeams(i.map(e=>e.Principal.ownerid)).then(e=>i.map(t=>{var i=e.find(e=>e.teamid===t.Principal.ownerid);return this.convertTeamToFlowSharingPrincipal(i,Object(l.a)(t.AccessMask),!1)}));return Promise.all([r,n]).then(e=>{var[t,i]=e;return[...t,...i]})}},{key:"convertSystemUserToFlowSharingPrincipal",value:function(e,t,i){return{id:e.systemuserid,alternativeId:e.azureactivedirectoryobjectid,displayName:e.fullname,email:e.internalemailaddress,iconUri:"",isNonRemovableOwner:i,accessLevel:t,type:a.b.SystemUser}}},{key:"convertTeamToFlowSharingPrincipal",value:function(e,t,i){return{id:e.teamid,alternativeId:e.azureactivedirectoryobjectid,displayName:e.name,email:e.emailaddress,iconUri:"",isNonRemovableOwner:i,accessLevel:t,type:a.b.Team}}},{key:"fetchWorkflow",value:function(e){return Object(p.c)(this.loggingService,this.environmentCapabilityService,this.environmentService.getCurrentEnvironmentName(),this.environmentService.getCurrentEnvironment().hasXrmInstance,this.environmentService.getCurrentEnvironment().protectionStatus.keyManagedBy).then(t=>{var i=t?{"mscrm.IncludeUnpublished":"true"}:void 0;return Object(o.a)(this.xrmService.makeXrmCall(c.a.GET,Object(s.d)("/workflows({0})",e),void 0,i))}).then(e=>e.data).catch(t=>this.enableSolutionFlowSharepointDelegatedAuth.then(i=>{if(Object(d.a)(t,{delAuthEnabled:i}))return Object(o.a)(this.xrmService.makeXrmCall(c.a.GET,Object(s.d)("/workflows({0})?DelegatedAuthorization=*",e))).then(e=>e.data);throw t}))}},{key:"clearFlowCacheEntry",value:function(e){this.cache.clearKey(e)}},{key:"constructFetchXmlStringForDelegatedAuth",value:function(e){return"delegatedauthorizations?".concat("fetchXml=<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='true'><entity name='delegatedauthorization' ><all-attributes /><link-entity name='team' from='delegatedauthorizationid' to='delegatedauthorizationid' link-type='inner' ><attribute name='teamid' /><link-entity name='principalobjectaccess' from='principalid' to='teamid' link-type='inner' ><filter><condition attribute='objectid' operator='eq' value='",e,"' /></filter></link-entity></link-entity></entity></fetch>")}}])&&g(t.prototype,i),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();y.$inject=[n.a.services.$q,n.a.services.promiseHelperService,n.a.services.xrmService,n.a.services.xrmSystemUsersClient,n.a.services.environment,n.a.services.environmentCapability,n.a.services.logging],r.a.service(n.a.services.xrmRolesClient,y)},34142:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(33439);function n(e){return e?e.includes("WriteAccess")?r.a.Owner:e.includes("ReadAccess")?r.a.User:r.a.NotSpecified:r.a.NoAccess}},34143:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,"a",(function(){return a}));var o=function(e){return e[e.pending=0]="pending",e[e.error=1]="error",e[e.success=2]="success",e}({}),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=new Map}var t,i,n;return t=e,(i=[{key:"getValue",value:function(e){if(this.cache.has(e.cacheKey)){var t=this.cache.get(e.cacheKey);if(!e.isStale||!e.isStale(t))return t.promise;this.cache.delete(e.cacheKey)}var i={cacheKey:e.cacheKey,state:o.pending,cacheCreatedDate:new Date,promise:new Promise((t,r)=>{e.valueFactory().then(e=>{i.cachedDate=new Date,i.result=e,i.state=o.success,t(e)}).catch(t=>{i.cachedDate=new Date,i.error=t,i.state=o.error,!e.preserveError&&this.cache.has(e.cacheKey)&&this.cache.delete(e.cacheKey),r(t)})})};return this.cache.set(e.cacheKey,i),i.promise}},{key:"dispose",value:function(){this.clear()}},{key:"clearKey",value:function(e){this.cache.delete(e)}},{key:"clear",value:function(){this.cache.clear()}},{key:"size",value:function(){return this.cache.size}},{key:"hasKey",value:function(e){return this.cache.has(e)}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},34144:function(e,t,i){"use strict";var r=i(33328),n=i(33327),o=i(33360),a=i(16926),s=i(15395),l=i(12330),c=i(17237),u=i(17226),d="/workflows({0})?$select={1}&$filter=category eq 5 and type eq 1 ",p="/workflows({0})?$select={1}&$filter=category eq 5 and type eq 1&DelegatedAuthorization=*",h=["workflowid","name","uniquename","statecode","ismanaged","solutionid","modifiedon","iscustomizable"];r.a.factory(n.a.services.modernFlowClient,[n.a.services.xrmService,e=>({checkIfModernFlowIsManagedFlow(t,i,r,n,u){var m=Object(a.g)(t),g=u?{"mscrm.IncludeUnpublished":"true"}:void 0;return e.makeXrmCall(s.a.GET,Object(o.d)(d,m,h.join(",")),void 0,g).then(e=>{var t;return!(null===(t=e.data)||void 0===t||!t.ismanaged||Object(l.a)(e.data.ismanaged))&&e.data.ismanaged}).catch(t=>!!(i&&r&&n&&Object(c.a)(t,{environmentName:i,environmentCapabilityService:r,loggingService:n}))&&e.makeXrmCall(s.a.GET,Object(o.d)(p,m,h.join(",")),void 0,g).then(e=>{var t;return!(null===(t=e.data)||void 0===t||!t.ismanaged||Object(l.a)(e.data.ismanaged))&&e.data.ismanaged}))},checkIfFlowIsCustomizable(t,i,r,n,u){var m=Object(a.g)(t),g=u?{"mscrm.IncludeUnpublished":"true"}:void 0;return e.makeXrmCall(s.a.GET,Object(o.d)(d,m,h.join(",")),void 0,g).then(e=>{var t;return!(null===(t=e.data)||void 0===t||!t.iscustomizable.Value||Object(l.a)(e.data.iscustomizable.Value))&&e.data.iscustomizable.Value}).catch(t=>r&&n&&Object(c.a)(t,{environmentName:r,environmentCapabilityService:n,loggingService:i})?e.makeXrmCall(s.a.GET,Object(o.d)(p,m,h.join(",")),void 0,g).then(e=>{var t;return!(null===(t=e.data)||void 0===t||!t.iscustomizable.Value||Object(l.a)(e.data.iscustomizable.Value))&&e.data.iscustomizable.Value}).catch(e=>(i.logError("modernFlowClient.checkIfFlowIsCustomizable",e),!1)):(i.logError("modernFlowClient.checkIfFlowIsCustomizable",t),!1))},checkIfModernFlowIsManagedFlowAndIfFlowIsCustomizable(t,i,r,n,m){var g=Object(a.g)(t),f=m?{"mscrm.IncludeUnpublished":"true"}:void 0;return e.makeXrmCall(s.a.GET,Object(o.d)(d,g,h.join(",")),void 0,f).then(e=>Object(u.d)(e.data)).catch(t=>r&&n&&i&&Object(c.a)(t,{environmentName:r,environmentCapabilityService:n,loggingService:i})?e.makeXrmCall(s.a.GET,Object(o.d)(p,g,h.join(",")),void 0,f).then(e=>{var t,i;return[!(null===(t=e.data)||void 0===t||!t.ismanaged||Object(l.a)(e.data.ismanaged))&&e.data.ismanaged,!(null===(i=e.data)||void 0===i||!i.iscustomizable.Value||Object(l.a)(e.data.iscustomizable.Value))&&e.data.iscustomizable.Value]}).catch(e=>(i.logError("modernFlowClient.checkIfModernFlowIsManagedFlowAndIfFlowIsCustomizable",e),[!1,!1])):(i.logError("modernFlowClient.checkIfModernFlowIsManagedFlowAndIfFlowIsCustomizable",t),[!1,!1]))}})])},34145:function(e,t,i){"use strict";i(34146),i(34150),i(34165)},34146:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34147);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34148);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.controllerAs="flowRunListDirectiveCtrl",this.restrict="E",this.scope={model:"="},this.template=i(34149)}));r.a.directive(n.a.directives.flowRunList,[()=>new c])},34147:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(33390),n=i(33327),o=i(11891),a=i(16927),s=i(33420),l=i(14900);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=function(){function e(t,i,r,n,o,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.appsettings=i,this.clientResources=r,this.dateTimeService=n,this.navigationService=o,this.routeCrafter=a,this.assetService=s,this.loggingService=l,this.showSlideInPane=!1,this.isWatchingFlowTriggerHistoriesWithRun=!1,this.isWatchingFlowRuns=!1,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowRunListDirectiveCtrl"}),this.$scope.model.rows=[],this.$scope.$watch("model.flowTriggerHistoriesWithRun",(e,t)=>{!this.isWatchingFlowTriggerHistoriesWithRun&&this.$scope.model.flowTriggerHistoriesWithRun&&(this.isWatchingFlowTriggerHistoriesWithRun=!0,this.$scope.model.flowTriggerHistoriesWithRun.$watch(this.$scope,()=>{this.onFlowTriggerHistoriesWithRunLoadComplete()}))}),this.$scope.$watch("model.flowRuns",(e,t)=>{!this.isWatchingFlowRuns&&this.$scope.model.flowRuns&&(this.isWatchingFlowRuns=!0,this.$scope.model.flowRuns.$watch(this.$scope,()=>{this.onFlowRunsLoadComplete()}))})}var t,i,n;return t=e,(i=[{key:"rowDefaultAction",value:function(e){var t=this.$scope.model.backUrl;!function(e){return!!(e&&e.type&&Object(o.a)(e.type,r.e.check))}(e)?this.navigationService.navigate(Object(l.n)(this.routeCrafter,{flowName:this.$scope.model.flowName,runName:e.name,isLegacyShared:!1,isUIFlow:!1,solutionId:void 0}),{backUrl:t,runStatus:p(e)}):this.navigationService.navigate(Object(l.k)(this.routeCrafter,{flowName:this.$scope.model.flowName,solutionId:void 0,runName:e.name}),{backUrl:t,runStatus:p(e)})}},{key:"toggleSlideInPane",value:function(e){e.stopPropagation(),this.showSlideInPane=!this.showSlideInPane}},{key:"onFlowRunsLoadComplete",value:function(){var e=this.mergeRows(this.$scope.model.rows,this.$scope.model.flowRuns.map(e=>this.createFlowRunRow(e)));this.$scope.model.rows=this.sortRows(this.filterRows(e));var t=this.$scope.model.top;t&&(this.$scope.model.rows=this.$scope.model.rows.slice(0,t))}},{key:"onFlowTriggerHistoriesWithRunLoadComplete",value:function(){var e=this.mergeRows(this.$scope.model.rows,this.$scope.model.flowTriggerHistoriesWithRun.map(e=>this.createFlowRunRowFromTriggerHistory(e)));this.$scope.model.rows=this.sortRows(this.filterRows(e));var t=this.$scope.model.top;t&&(this.$scope.model.rows=this.$scope.model.rows.slice(0,t))}},{key:"filterRows",value:function(e){return this.$scope.model.flowTriggerHistoriesWithRun?this.$scope.model.flowTriggerHistoryFilter?e.filter(e=>this.$scope.model.flowTriggerHistoryFilter(e.triggerHistoryItem)):e:this.$scope.model.flowRunFilter?e.filter(e=>this.$scope.model.flowRunFilter(e.flowRunItem)):e}},{key:"mergeRows",value:function(e,t){var i=e.reduce((e,t)=>(e[t.id]=t,e),{}),r=t.reduce((e,t)=>(e[t.id]=t,e),i);return Object.keys(r).map(e=>r[e])}},{key:"sortRows",value:function(e){return e.sort((e,t)=>{var i=t&&t.flowRunItem&&t.flowRunItem.properties&&t.flowRunItem.properties.startTime||t&&t.triggerHistoryItem&&t.triggerHistoryItem.properties&&t.triggerHistoryItem.properties.startTime,r=e&&e.flowRunItem&&e.flowRunItem.properties&&e.flowRunItem.properties.startTime||e&&e.triggerHistoryItem&&e.triggerHistoryItem.properties&&e.triggerHistoryItem.properties.startTime;return this.dateTimeService.compareDates(i,r)})}},{key:"createFlowRunRow",value:function(e){var t=e.properties.startTime,i=e.properties.endTime;return{flowRunItem:e,commands:[],duration:this.dateTimeService.getFriendlyTimeSinceString(s.a,Object(a.a)(t),i?Object(a.a)(i):null),endTime:e.properties.endTime,flowRun:e,id:e.id,name:e.name,startTime:this.$scope.model.showInDialog?this.dateTimeService.getTimeAtDateTimeString(Object(a.a)(t)):this.dateTimeService.getFriendlyTimeSinceString(s.a,Object(a.a)(t)),status:e.properties.status,statusImage:this.getStatusImage(e.properties.status),type:e.type,isTestRun:h(e)}}},{key:"getStatusImage",value:function(e){var t=this.assetService.statusInfo;switch(e){case r.j.succeeded:t=this.assetService.statusSuccess;break;case r.j.running:t=this.assetService.statusProgress;break;case r.j.failed:t=this.assetService.statusError}return t}},{key:"createFlowRunRowFromTriggerHistory",value:function(e){var t=e.properties.startTime,i=e.properties.endTime,r=e.properties.run&&e.properties.run.properties&&e.properties.run.properties.status||e.properties.status,n=e.properties.run;return n&&(t=n.properties.startTime,i=n.properties.endTime),{flowRunItem:e.properties.run,triggerHistoryItem:e,commands:[],duration:this.dateTimeService.getFriendlyTimeSinceString(s.a,Object(a.a)(t),i?Object(a.a)(i):null),endTime:e.properties.endTime,flowRun:e,id:e.id,name:e.name,startTime:this.dateTimeService.getFriendlyTimeSinceString(s.a,Object(a.a)(t)),status:r,statusImage:this.getStatusImage(e.properties.status),type:e.type,isTestRun:h(e)}}}])&&c(t.prototype,i),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return e&&e.status||null}function h(e){return!!(e.properties&&e.properties.correlation&&e.properties.correlation.clientKeywords&&e.properties.correlation.clientKeywords.some(e=>e.includes(r.l.testFlow)))}d.$inject=[n.a.services.$scope,n.a.services.appSettings,n.a.services.clientResources,n.a.services.dateTime,n.a.services.navigation,n.a.services.routeCrafter,n.a.services.assetService,n.a.services.logging]},34148:function(e,t,i){e.exports=i.p+"static/media/flowRunListDirective.8c14d2b4.less"},34149:function(e,t){e.exports='<div class="c-table flow-runs">\n    <table ng-if="model.rows.length !== 0" ng-class="[{\'tile-row\': !!model.showInTile || !!model.showInDialog}]">\n        <thead ng-hide="!!model.showInTile">\n            <tr>\n                <th ng-hide="model.showInDialog">{{::flowRunListDirectiveCtrl.clientResources.ListHeader.Status}}</th>\n                <th>{{::flowRunListDirectiveCtrl.clientResources.ListHeader.StartTime}}</th>\n                <th>{{::flowRunListDirectiveCtrl.clientResources.ListHeader.Duration}}</th>\n                <th></th>\n            </tr>\n        </thead>\n        <tbody>\n            <spinner model="model.spinner"></spinner>\n            <tr ng-repeat="row in model.rows" style="cursor: pointer;" ng-click="flowRunListDirectiveCtrl.rowDefaultAction(row)" ng-hide="model.spinner.show">\n                <td class="text-ellipse" ng-hide="model.showInDialog">\n                    <svg class="status-image" svg-src="{{row.statusImage}}" ng-show="!!model.showInTile"></svg> {{row.isTestRun ? flowRunListDirectiveCtrl.clientResources.Common.Test : \'\'}} {{row.status}}\n                </td>\n                <td class="text-ellipse">{{row.startTime}}</td>\n                <td class="text-ellipse">{{row.duration}}</td>\n                <td>\n                    <span class="img-button c-glyph glyph-arrow" ng-attr-title="{{::flowRunListDirectiveCtrl.clientResources.FlowRuns.View.FlowRun}}" ng-hide="model.showInDialog"></span>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <div class="load-more" ng-hide="model.spinner.show || model.rows.length === 0 || !!model.showInTile">\n        <a ng-show="model.hasMore() && !model.isLoadingMore" ng-click="model.loadNextPage()" href="" aria-label="{{::flowRunListDirectiveCtrl.clientResources.FlowRuns.AriaLabel.LoadMore}}">{{::flowRunListDirectiveCtrl.clientResources.List.ShowMore}}</a>\n        <spinner model="model.loadingMoreSpinner"></spinner>\n    </div>\n    <div ng-if="!model.spinner.show && model.rows.length === 0">\n        <div ng-if="!model.showInTile">\n            <zero-flow-runs filter="model.filter"></zero-flow-runs>\n        </div>\n        <div ng-if="!!model.showInTile">\n            <p class="zero-run-text">{{::flowRunListDirectiveCtrl.clientResources.FlowPropertyTile.ZeroFlowRun.Text}}\n                <a class="learn-more-button c-paragraph-3" role="button" aria-label="{{::flowRunListDirectiveCtrl.clientResources.FlowPropertyTile.ZeroFlowRun.LearnMoreButton.Text}}" ng-if="flowRunListDirectiveCtrl.appsettings.featureFlags.enableSummaryPaneOnZeroFlowRuns && model.isPollingOrRecurrenceTrigger"\n                    ng-click="flowRunListDirectiveCtrl.toggleSlideInPane($event)">\n                        {{::flowRunListDirectiveCtrl.clientResources.FlowPropertyTile.ZeroFlowRun.LearnMoreButton.Text}}\n                </a>\n            </p>\n            <info-pane pane-title="flowRunListDirectiveCtrl.clientResources.FlowRun.No.Runs.Pane.Title" expanded="flowRunListDirectiveCtrl.showSlideInPane" ng-if="!!flowRunListDirectiveCtrl.appsettings.featureFlags.enableSummaryPaneOnZeroFlowRuns">\n                <zero-flow-runs-slide-in-pane flow-name="model.flowName" ng-if="flowRunListDirectiveCtrl.showSlideInPane"></zero-flow-runs-slide-in-pane>\n            </info-pane>\n        </div>\n    </div>\n</div>'},34150:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34151);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.controllerAs="flowDesignerDirectiveCtrl",this.restrict="E",this.scope={context:"=",model:"=",onInit:"&"},this.template=i(34164)}));r.a.directive(n.a.directives.flowDesigner,[()=>new c])},34151:function(e,t,i){"use strict";i.d(t,"b",(function(){return M})),i.d(t,"a",(function(){return B}));var r=i(33327),n=i(33354),o=i(11891),a=i(17929),s=i.n(a),l=i(34152),c=i(20799),u=i(17266),d=i(34153),p=i(13009),h=i(12339),m=i(20789),g=i(20791),f=i(14883),v=i(20107),b=i(13031),y=i(12345),w=i(20892),S=i(13e3),C=i(20915),k=i(21878),P=i(17258),x=i(20803),A=i(12366),T=i(15339),R=i(15509),O=i(19923),D=i(15412);function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function F(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach((function(t){I(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function I(e,t,i){return(t=N(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function j(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,N(r.key),r)}}function N(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34163);function M(e){return window.Promise?new Promise((t,i)=>{e.then(e=>t(e)).catch(e=>i(e))}):e}var L=function(e){return e.Invoker="invoker",e}({}),U={ignoreNonCriticalErrors:!0,skipValidation:!1},B=function(){function e(t,i,r,o,a,s,E,I,j,N,L,B,$,q,W,z,H,V,_,G,K,X,Q,J,Y,Z,ee,te,ie,re){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$element=t,this.$q=i,this.$scope=r,this.appSettings=o,this.authenticationService=a,this.clientResources=s,this.connectionsClient=E,this.connectorHideKeyService=I,this.designerDocumentationLinkService=j,this.designerValidationService=N,this.environmentService=L,this.flowConnectionsClient=B,this.loggingService=$,this.telemetryService=q,this.sessionService=W,this.xrmChildFlowsClient=z,this.widgetUtilService=H,this.graphService=V,this.tokenService=_,this.designerOperationsService=G,this.designerUserPreferenceServiceFactory=K,this.apiOperationService=X,this.designerCreateContextService=Q,this.assetService=J,this.designerCoreLoader=Y,this.oAuthService=Z,this.policiesService=ee,this.entitlementsService=te,this.trialDialogService=ie,this.ppapiService=re,this.designerReady=void 0,this.designer=void 0,this.connectionReferencesStoreSubscription=void 0,this.disposeFuncs=[],this.onParameterChanged=void 0,this.onDesignerFlowChanged=void 0,this.onCardChanged=void 0,this.invokerStateStore=new l.a,this.onSelectedActionOrTriggerChanged=void 0,this.onSelectedRecommendationOperationChanged=void 0,this.connectionProvider=void 0,this._disposed=!1,this.viewPermissionsDialog=void 0,this.isSolutionFlow=void 0,this.startTime=void 0,this.correlationId=void 0,this.pageEventData={},this.loadDesigner=()=>{var e=this.$element.children()[0],t=this.designerCoreLoader.loadDesignerScripts();this.$scope.onInit().then(e=>this.$q.all([e,this.toAngularPromise(t,"loadDesignerScripts"),this.toAngularPromise(this.sessionService.getUserSessionAsync(),"getUserSession"),this.connectorHideKeyService.getVisibleHideKeys(),e.allowCoauthoring?this.flowConnectionsClient.query(this.$scope,{flowName:e.flowName}).$promise:[]])).then(t=>{var[i,r,n,o,a]=t,s=i||{},l=s.prefetchedData||{},u={designercore:r.designercore,designerElement:e,appSettings:this.appSettings,featureFlags:this.appSettings.featureFlags,apiOperationAuthoringBehavior:s.apiOperationAuthoringBehavior,environment:{name:this.environmentService.getCurrentEnvironmentName(),features:y.a.currentEnvironment.features},telemetryService:this.telemetryService,oAuthService:this.oAuthService,ppapiService:this.ppapiService,connectorV2ServiceFactory:()=>new g.a(i.allowCoauthoring,this.clientResources,s.flowName,this.loggingService,i.prefetchedData.connections,this.graphService,this.xrmChildFlowsClient,y.a,this.tokenService,C.a,k.a,P.a,()=>S.a.user,i.isXrmConnectionReferenceMode),operationManifestServiceFactory:()=>new x.b(this.apiOperationService,this.clientResources,y.a,l.connectionReferences,this.loggingService,this.designerOperationsService,w.a,this.assetService,this.tokenService,this.ppapiService),apiOperationService:this.apiOperationService,getArmAccessToken:()=>M(this.authenticationService.getToken(this.appSettings.authResource)),getFunctionsRPAccessToken:()=>M(this.authenticationService.getToken(this.appSettings.functionsAuthResource)),getRuntimeAccessToken:()=>M(this.authenticationService.getToken(this.appSettings.apiHubsRuntimeResource)),getConsentServerAccessToken:()=>M(this.authenticationService.getToken(this.appSettings.consentServerAadResourceUri)),getPPAPIAccessToken:()=>M(this.authenticationService.getToken(this.ppapiService.getTokenAudience())),prefetchedData:{connections:l.connections,connectionProviders:l.apis&&Array.isArray(l.apis)?l.apis.filter(e=>!e||!Object(f.e)(e.id,A.B.connectorId)):l.apis},azureADServiceFactory:e=>new c.a(this.graphService,this.loggingService),documentationLinkServiceFactory:e=>this.designerDocumentationLinkService,operationResultSchemaServiceFactory:e=>new d.a(this.clientResources,e),flowManagementServiceFactory:e=>({saveFlow:s.onSaveFlow}),userPreferenceServiceFactory:()=>this.designerUserPreferenceServiceFactory.createDesignerUserPreferenceService(),canAddOperation:e=>new Promise(t=>{this.$scope.$applyAsync(()=>{var i=this.designer.Data.Triggers.getData();this.policiesService.checkCanAddOperation(e,l.plan,s.templateName,i,!0).then(i=>{if(i){var r=e.id.split("/").pop();return Object(O.l)(r)&&!Object(O.m)(r)?void this.entitlementsService.safeCheckAiBuilderEntitlementsStatus().then(e=>{switch(e){case D.a.Allowed:t(!0);break;case D.a.NotAllowedNoTrial:this.trialDialogService.showStartAiBuilderTrialDialog(e=>{t(e)});break;case D.a.NotAllowedExpiredTrial:case D.a.NotAllowedExpiredTrialWithTrialRenewalForm:this.trialDialogService.showExtendAiBuilderTrialDialog(e=>{t(e)});break;case D.a.NotAllowedTrialCapacityLimit:this.trialDialogService.showAiBuilderTrialCapacityLimitDialog(e=>{t(e)});break;case D.a.NotAllowedTrialCountLimit:this.trialDialogService.showAiBuilderTrialCountLimitDialog(e=>{t(e)});break;case D.a.NotAllowedToStartTrial:this.trialDialogService.showAiBuilderNotAllowedToStartTrialDialog(e=>{t(e)});break;default:t(!0)}}):void t(!0)}this.trialDialogService.showStartFreeTrialDialog(e=>{t(e)})})})}),showViewPermissionsDialog:e=>{this.$scope.$applyAsync(()=>{this.connectionProvider=e,this.viewPermissionsDialog.show=!0})},allowCoauthoring:s.allowCoauthoring,showCalloutHints:s.showCalloutHints,flowName:s.flowName,loadScenario:s.loadScenario,defaultRecurrence:Object(R.b)(T.a.activeUserPlans),visibleHideKeys:o,templateName:s.templateName,isSolutionFlow:s.isSolutionFlow,containsNativeCDSOperation:s.containsNativeCDSOperation,isXrmConnectionReferenceMode:i.isXrmConnectionReferenceMode,solutionId:i.solutionId,setRecommendationContext:i.setRecommendationContext,getWorkflowForEasyAutomation:()=>this.designer?this.designer.getWorkflow({skipValidation:!0,ignoreNonCriticalErrors:!0}):null,context:this.designerCreateContextService.getDesignerCreateContext()};this.isSolutionFlow=s.isSolutionFlow,i.allowCoauthoring&&(u.isCoauthoredConnection=e=>{var{enableUIChangesForXRMConnectionReferences:t,enableHostConnectionService:r}=this.appSettings.featureFlags,n=i.isXrmConnectionReferenceMode&&(this.widgetUtilService.isTeamsSolutionExplorerContext()||t&&r)?C.a.getConnectionIdFromDesignerConnectionId(e.id):e.id;return a.some(e=>e.id===n)}),u.onFirstPartyConnectionFailureCallback=(e,t)=>Object(p.S)(e)?this.oAuthService.consentFirstPartyUriAfterMFA(t):Promise.reject(new Error(e)),u.validationServiceFactory=e=>Object(v.d)(u,this.designerValidationService),u.invokerStateStore=this.invokerStateStore,this.designer=Object(v.a)(u),this.designerReady.resolve(this.designer)}).then(()=>{this.pageEventData={loadDuration:this.loggingService.performanceNow()-this.startTime,isSolutionFlow:this.isSolutionFlow},this.loggingService.profileEndWithSuccess(this.correlationId,n.a.v1DesignerLoadEnd,F({},this.pageEventData))}).catch(e=>{this.loggingService.logError("FlowDesignerDirectiveCtrl.LoadDesigner",e,{scenario:"initDesigner"}),this.loggingService.profilePageEnd(this.correlationId,n.a.v1DesignerLoadEnd,F({},this.pageEventData)),this.designerReady.reject(new u.a(p.c.flowsDesignerScriptLoadError,Object(b.a)(this.clientResources.FlowDesignerDirectiveBase.DesignerScriptLoadError,Object(p.db)(e)),e))})},this.correlationId=this.loggingService.profileStart(n.a.v1DesignerLoadStart),this.startTime=this.loggingService.performanceNow(),this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowDesignerDirectiveCtrl"}),this.viewPermissionsDialog={show:!1,buttons:[{label:this.clientResources.Dialogs.ViewPermissions.Button.Close,action:()=>{this.viewPermissionsDialog.show=!1},primary:!0}]},this.designerReady=i.defer(),r.$on("$destroy",()=>{this.connectionReferencesStoreSubscription&&this.connectionReferencesStoreSubscription.unsubscribe(),this.disposeFuncs.forEach(e=>e()),this.disposeFuncs=[],this.designerReady.promise.then(e=>{e&&!this._disposed&&(this._disposed=!0,e.dispose())})});var ne=r.context;ne.getDefinition=e=>this.designerReady.promise.then(t=>{var i=this.$q.defer();try{i.resolve(t.getWorkflow(e))}catch(n){var r=Object(p.H)(n)||Object(p.G)(n)||Object(p.J)(n)?n:new u.a(p.c.flowsDesignerGetDefinitionError,Object(p.db)(n),n);i.reject(r)}return i.promise}),ne.getDefinitionSync=e=>this.designer?(U.skipValidation=e||U.skipValidation,this.designer.getWorkflow(U)):null,ne.getSwaggerSync=e=>this.designer?this.designer.Data._designerContext.SwaggerStore.getSwagger(e):null,ne.loadTrigger=e=>this.designerReady.promise.then(t=>this.toAngularPromise(t.loadTrigger(e,{schema:Object(h.l)(this.appSettings).definitionSchemaUri,contentVersion:"1.0.0.0"}),"loadTrigger")).then(()=>this.render()).catch(e=>{throw new u.a(p.c.flowsDesignerLoadDefinitionError,Object(p.db)(e),e)}),ne.loadTriggerAndAction=(e,t)=>this.designerReady.promise.then(i=>this.toAngularPromise(i.loadTriggerAndAction(e,t,{schema:Object(h.l)(this.appSettings).definitionSchemaUri,contentVersion:"1.0.0.0"}),"loadTriggerAndAction")).then(()=>this.render()).catch(e=>{throw new u.a(p.c.flowsDesignerLoadDefinitionError,Object(p.db)(e),e)}),ne.openConnectorRecommendation=e=>this.designerReady.promise.then(t=>this.toAngularPromise(t.openConnectorRecommendation(e),"openConnectorRecommendation")).then(()=>this.render()).catch(t=>{throw new u.a(p.c.flowsDesignerOpenConnectorRecommendationError,Object(p.db)(t),t,{connectorId:e})}),ne.loadDefinition=(e,t,i,r,n)=>{var o=i===m.a.newFlowFromTemplate;return this.initInvokerStateStore(t),this.designerReady.promise.then(i=>{var a={definition:e,connectionReferences:t,references:t,properties:{sku:{name:"Consumption"}}},s={expandAllCards:!1,initFromTemplate:o,skipValidation:o};this.appSettings.featureFlags.enableUndoForDesigner&&i&&n&&i.dispose();var l=r?i.loadWorkflowAndAction(a,r,s):i.loadWorkflow(a,s);return this.toAngularPromise(l,r?"loadWorkflowAndAction":"loadWorkflow").then(()=>this.render())}).catch(e=>{throw new u.a(p.c.flowsDesignerLoadDefinitionError,Object(p.db)(e),e)})},ne.getActions=()=>this.designerReady.promise.then(e=>e.Data.Actions.getData()),ne.getActionsSync=()=>this.designer?this.designer.Data.Actions.getData():[],ne.getTriggers=()=>this.designerReady.promise.then(e=>e.Data.Triggers.getData?e.Data.Triggers.getData():e.Data.Triggers),ne.getTriggersSync=()=>this.designer&&this.designer.Data.Triggers.getData?this.designer.Data.Triggers.getData():[],ne.getParameters=()=>this.designerReady.promise.then(e=>e.Data.Parameters.getData()),ne.getConnections=()=>this.designerReady.promise.then(e=>e.Data.Connections.getData()),ne.getSelectedActionOrTrigger=()=>this.designerReady.promise.then(e=>e.Data.SelectedActionOrTrigger&&e.Data.SelectedActionOrTrigger.getData()),ne.getSelectedRecommendationOperation=()=>this.designerReady.promise.then(e=>e.Data.SelectedRecommendationOperation&&e.Data.SelectedRecommendationOperation.getData()),ne.onParameterChanged=e=>{this.onParameterChanged=e},ne.onDesignerFlowChanged=e=>{this.onDesignerFlowChanged=e},ne.onCardChanged=e=>{this.onCardChanged=e},ne.onSelectedActionOrTriggerChanged=e=>{this.onSelectedActionOrTriggerChanged=e},ne.onSelectedRecommendationOperationChanged=e=>{this.onSelectedRecommendationOperationChanged=e},ne.areAllConnectionReferencesValid=!1,ne.setReadOnly=e=>{this.designerReady.promise.then(t=>{t.setReadOnly(e)})},ne.updateCallbacksOnSave=e=>{this.designerReady.promise.then(t=>{t.updateCallbacksOnSave(e)})},ne.navigateTo=(e,t,i)=>{this.designerReady.promise.then(r=>{r.navigateTo&&r.navigateTo(e,t,i)})},this.loadDesigner()}var t,i,r;return t=e,r=[{key:"isConnectionReferenceValid",value:function(e){return e&&e.connection&&!!e.connection.id}}],(i=[{key:"render",value:function(){return this.designerReady.promise.then(e=>{if(this.initializeParametersSubscription(e),this.initializeTriggersAndActionsSubscription(e),this.initializeFlowChangedSubscription(e),this.connectionReferencesStoreSubscription=this.getConnectionReferencesStoreSubscription(e.Data.ConnectionReferences),this.validateConnectionReferences(e.Data.ConnectionReferences),this.initializeSelectedActionOrTriggerSubscription(e),this.initializeSelectedRecommendationOperationSubscription(e),this._disposed)throw new u.a(p.c.ClientErrorAborted,this.clientResources.FlowDesignerDirectiveBase.DesignerDisposed,null);e.render()})}},{key:"initializeParametersSubscription",value:function(e){var t=s()(()=>this.onParameterChanged&&this.onParameterChanged(),500),i=e.Data.Parameters.onChanged(t);this.disposeFuncs.push(()=>{t.cancel(),i.unsubscribe()})}},{key:"initializeTriggersAndActionsSubscription",value:function(e){var t=s()(()=>this.onCardChanged&&this.onCardChanged(),500),i=e.Data.Triggers.onChanged(t),r=e.Data.Actions.onChanged(t);this.disposeFuncs.push(()=>{t.cancel(),i.unsubscribe(),r.unsubscribe()})}},{key:"initializeFlowChangedSubscription",value:function(e){if(this.appSettings.flowCheckerDebounceRate>250){var t=this.appSettings.flowCheckerDebounceRate,i=s()(()=>this.onDesignerFlowChanged&&this.onDesignerFlowChanged(),t),r=e.Data.Parameters.onChanged(i);this.disposeFuncs.push(()=>{i.cancel(),r.unsubscribe()})}}},{key:"initializeSelectedActionOrTriggerSubscription",value:function(e){if(e.Data.SelectedActionOrTrigger){var t=s()(()=>this.onSelectedActionOrTriggerChanged&&this.onSelectedActionOrTriggerChanged(),500),i=e.Data.SelectedActionOrTrigger.onChanged(t);this.disposeFuncs.push(()=>{t.cancel(),i.unsubscribe()})}}},{key:"initializeSelectedRecommendationOperationSubscription",value:function(e){if(e.Data.SelectedRecommendationOperation){var t=s()(()=>this.onSelectedRecommendationOperationChanged&&this.onSelectedRecommendationOperationChanged(),500),i=e.Data.SelectedRecommendationOperation.onChanged(t);this.disposeFuncs.push(()=>{t.cancel(),i.unsubscribe()})}}},{key:"toAngularPromise",value:function(e,t){return this.$q((i,r)=>{e.then(e=>i(e)).catch(e=>{this.loggingService.logError("FlowDesignerDirectiveCtrl.LoadDesigner",e,{scenario:t}),r(e)})})}},{key:"getConnectionReferencesStoreSubscription",value:function(e){return e.onChanged(()=>{this.$scope.context.areAllConnectionReferencesValid,this.cacheNewConnections(e),this.validateConnectionReferences(e)})}},{key:"cacheNewConnections",value:function(t){var i=t.getData(),r=this.connectionsClient.query(this.$scope),n=!1;i&&i.forEach(t=>{e.isConnectionReferenceValid(t)&&!r.some(e=>o.a(e.id,t.connection.id))&&(n=!0)}),n&&this.connectionsClient.refreshQuery()}},{key:"validateConnectionReferences",value:function(t){var i=t.getData();i&&(this.$scope.context.areAllConnectionReferencesValid=i.map(t=>e.isConnectionReferenceValid(t)).every(e=>!0===e))}},{key:"initInvokerStateStore",value:function(e){Object.keys(e||{}).forEach(t=>{var i=e[t];(i.impersonation&&i.impersonation.source)===L.Invoker&&this.invokerStateStore.updateInvokerState(t,!0)})}}])&&j(t.prototype,i),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();B.$inject=[r.a.services.$element,r.a.services.$q,r.a.services.$scope,r.a.services.appSettings,r.a.services.authentication,r.a.services.clientResources,r.a.services.connectionsClient,r.a.services.connectorHideKey,r.a.services.designerDocumentationLinkService,r.a.services.designerValidationService,r.a.services.environment,r.a.services.flowConnectionsClient,r.a.services.logging,r.a.services.telemetry,r.a.services.session,r.a.services.xrmChildFlowsClient,r.a.services.widgetUtilService,r.a.services.graphService,r.a.services.token,r.a.services.designerOperations,r.a.services.designerUserPreference,r.a.services.apiOperation,r.a.services.designerCreateContext,r.a.services.assetService,r.a.services.designerCoreLoader,r.a.services.oAuthService,r.a.services.policies,r.a.services.entitlements,r.a.services.trialDialog,r.a.services.ppapiService]},34152:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,"a",(function(){return o}));var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=void 0,this.data=t||{}}var t,i,n;return t=e,(i=[{key:"getInvokerState",value:function(e){return!!this.data[e]}},{key:"updateInvokerState",value:function(e,t){this.data[e]=t}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},34153:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(34154);function n(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemaFactory=void 0,this.schemaFactory=new r.a(t,i)}var t,i,a,s,l;return t=e,(i=[{key:"getOperationResultSchema",value:(s=function*(e,t){return this.schemaFactory.getStaticResultRootSchema(e,t)},l=function(){var e=this,t=arguments;return new Promise((function(i,r){var o=s.apply(e,t);function a(e){n(o,i,r,a,l,"next",e)}function l(e){n(o,i,r,a,l,"throw",e)}a(void 0)}))},function(e,t){return l.apply(this,arguments)})}])&&o(t.prototype,i),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},34154:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(34155),n=i(34156),o=i(34157),a=i(34159),s=i(34160),l=i(34161),c=i(34162),u=i(18960);function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._designerContext=void 0,this._resources=void 0,this._designerContext=i,this._resources=t}var t,i,p;return t=e,(i=[{key:"getStaticResultRootSchema",value:function(e,t){switch(e.toLowerCase()){case r.a.HTTP_GROUP.toLowerCase():switch(t.toLowerCase()){case r.b.HTTP:case r.b.HTTP_WEBHOOK:case r.b.HTTP_WITH_SWAGGER:return Object(l.a)(this._resources)}break;case r.c.FLAT_FILE_GROUP.toLowerCase():switch(t.toLowerCase()){case r.b.FLAT_FILE_DECODING:return Object(o.a)(this._resources);case r.b.FLAT_FILE_ENCODING:return a.a}break;case r.a.APIMANAGEMENT.toLowerCase():return Object(l.a)(this._resources);case r.a.DATA_OPERATIONS_GROUP.toLowerCase():switch(t.toLowerCase()){case r.b.PARSE_JSON:return Object(s.a)(this._resources);case r.b.QUERY:case r.b.SELECT:return c.a}break;default:if(Object(n.a)(e))return this.getStaticResultSchemaForAPIConnector(t,e)}}},{key:"getStaticResultSchemaForAPIConnector",value:function(e,t){var i=this._designerContext.SwaggerStore.getParsedSwagger(t);if(i){var r=i.getOutputSchema(e);return this.wrapOutputsSchemaToOperationSchema(r)}}},{key:"wrapOutputsSchemaToOperationSchema",value:function(e){var t=Object(u.a)(Object(l.a)(this._resources));if(e){var i=this.cleanDynamicSchemaParameters(Object(u.a)(e));t.properties.outputs.properties.body=i}else delete t.properties.outputs.properties.body;return t}},{key:"cleanDynamicSchemaParameters",value:function(e){if(!e)return e;if(e["x-ms-dynamic-schema"])return{title:e.title};var{properties:t,additionalProperties:i,items:r}=e;if(t)for(var n of Object.keys(t))t[n]=this.cleanDynamicSchemaParameters(t[n]);return r&&this.cleanDynamicSchemaParameters(r),i&&"object"==typeof i&&(e.additionalProperties=this.cleanDynamicSchemaParameters(i)),e}}])&&d(t.prototype,i),p&&d(t,p),Object.defineProperty(t,"prototype",{writable:!1}),e}()},34155:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o}));var r={APIMANAGEMENT:"connectionProviders/apimanagement",APPSERVICES:"connectionProviders/appservice",FUNCTION:"connectionProviders/function",WORKFLOW:"connectionProviders/workflow",BATCH_GROUP:"connectionProviders/batch",BUTTON_GROUP:"connectionProviders/buttonGroup",CONTROL_GROUP:"connectionProviders/control",DATA_OPERATIONS_GROUP:"connectionProviders/dataOperation",DATETIME_GROUP:"connectionProviders/datetime",GEOFENCE_GROUP:"connectionProviders/geofenceGroup",HTTP_GROUP:"connectionProviders/http",INTEGRATION_ACCOUNT_GROUP:"connectionProviders/integrationAccount",POWERAPPS_GROUP:"connectionProviders/powerappsGroup",REQUEST_RESPONSE_GROUP:"connectionProviders/request",SCHEDULE_GROUP:"connectionProviders/schedule",VARIABLE_GROUP:"connectionProviders/variable"},n={ADD_TO_TIME:"add_to_time",APIMANAGEMENT:"apimanagement",APPEND_TO_ARRAY_VARIABLE:"append_to_array_variable",APPEND_TO_STRING_VARIABLE:"append_to_string_variable",BATCH:"batch",BUTTON:"button",COMPOSE:"compose",CONVERT_TIME_ZONE:"convert_time_zone",CURRENT_TIME:"current_time",DECREMENT_VARIABLE:"decrementvariable",DELAY:"delay",DELAYUNTIL:"delay_until",EVENT_GRID:"event_grid",FLAT_FILE_DECODING:"flat_file_decoding",FLAT_FILE_ENCODING:"flat_file_encoding",FOREACH:"foreach",FUNCTION:"function",GEOFENCE_REQUEST:"geofence_request",GET_FUTURE_TIME:"get_future_time",GET_PAST_TIME:"get_past_time",HTTP_WITH_SWAGGER:"http_with_swagger",HTTP:"http",HTTPREQUESTTRIGGER:"request",HTTP_WEBHOOK:"httpwebhook",IF:"if",INCREMENT_VARIABLE:"increment_variable",INITIALIZE_VARIABLE:"initializevariable",INTEGRATION_ACCOUNT_ARTIFACT_LOOKUP:"integration_account_artifact_lookup",INTEGRATION_ACCOUNT_GET_SCHEMAS:"content_and_schema_operation_get_schemas",JOIN:"join",LIQUID_JSON_TO_JSON:"liquid_json_to_json",LIQUID_JSON_TO_TEXT:"liquid_json_to_text",LIQUID_XML_TO_JSON:"liquid_xml_to_json",LIQUID_XML_TO_TEXT:"liquid_xml_to_text",MANUALTRIGGER:"manual",PARSE_JSON:"parsejson",POWERAPPS_RESPONSE:"powerappsresponse",QUERY:"query",RECURRENCETRIGGER:"recurrence",RESPONSE:"response",SCOPE:"scope",SECURITY_CENTER_ALERT:"securitycenteralert",SELECT:"select",SEND_TO_BATCH:"sendtobatch",SET_VARIABLE:"setvariable",SUBTRACT_FROM_TIME:"subtract_from_time",SWITCH_CASE:"switchcase",SWITCH:"switch",TABLE_CSV:"table_csv",TABLE_HTML:"table_html",TERMINATE:"terminate",UNTIL:"until",WORKFLOW:"workflow",XML_VALIDATION:"xml_validation",XSLT_GET_CONTAINERS:"xslt_get_containers",XSLT_GET_FUNCTIONS:"xslt_get_functions_in_container",XSLT_GET_MAP:"xslt_get_map",XSLT_GET_MAPS:"xslt_get_maps",XSLT_TRANSFORM:"xslt_transform"},o={FLAT_FILE_GROUP:"connectionProviders/flatFile",LIQUID_GROUP:"connectionProviders/liquid",XML_GROUP:"connectionProviders/xml"}},34156:function(e,t,i){"use strict";var r=i(18971);i.d(t,"a",(function(){return r.r}))},34157:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(34158);function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=e=>{var t=Object(r.a)(e);return o(o({},t),{},{properties:o(o({},t.properties),{},{outputs:{properties:{body:{type:"string",format:"binary",title:e.Static.Result.Http.Body.Title,default:"Sample file data"}},type:"object",title:e.Static.Result.Operation.Output.Title,required:["body"]}}),required:[...t.required]})}},34158:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=["NotSpecified","InternalServerError","ServerTimeout","AuthorizationFailed","BadRequest","InvalidRequestContent","UnsupportedContentEncoding","UnsupportedMediaType","MissingSubscription","MismatchingWorkflowName","MismatchingWorkflowAccessKeyName","MismatchingResourceGroupName","MismatchingSubscription","InvalidWorkflow","WorkflowNotFound","WorkflowVersionNotFound","EnabledRegionalWorkflowsQuotaExceeded","EnabledHostingPlanWorkflowsQuotaExceeded","SubscriptionNotFound","SubscriptionMissingTenantId","ReadOnlyDisabledSubscription","InvalidContinuationToken","InvalidTopInQueryString","WorkflowRunNotFound","WorkflowRunOperationNotFound","WorkflowRunActionNotFound","WorkflowRunActionRequestHistoryNotFound","InvalidPatchWorkflowRequest","InvalidWorkflowTriggerName","InvalidWorkflowTriggerRecurrence","InvalidWorkflowTriggerRecurrenceSchedule","InvalidWorkflowRunAction","InvalidWorkflowRunActionName","InvalidVariableName","InvalidStaticResultName","InvalidTemplate","ActionSkipped","ActionAborted","ActionIgnored","ActionDependencyFailed","ActionConditionFailed","ActionUntilConditionFailed","WorkflowRunActionUntilLimitInvalid","InvalidWorkflowAccessKey","WorkflowAccessKeyNotFound","WorkflowAccessKeyQuotaExceeded","WorkflowTriggerNotFound","WorkflowTriggerTypeUnsupported","WorkflowTriggerInputsPropertyMissing","WorkflowTriggerInputsPropertyInvalid","WorkflowTriggerInputsPropertyUnsupported","WorkflowActionInputsPropertyUnsupported","WorkflowRunActionTypeUnsupported","WorkflowRunActionInputsPropertyMissing","UnsupportedWorkflowStateFilterValue","UnsupportedWorkflowStatusFilterValue","WorkflowTriggerHistoryNotFound","PreviewFeaturesNotAllowed","InvalidHostName","MissingApiVersionParameter","InvalidApiVersionParameter","MissingClientIpInformation","IPBlacklisted","WorkflowRequestsThrottled","RequestsThrottled","InvalidActionRepeatExpression","PageSizeLimitExceeded","IntegrationAccountNotEnabled","WorkflowNotEnabled","WorkflowNotDisabled","WorkflowOutputParameterUnsupportedType","PushTriggerNameNotUnique","InvalidSku","ActionCancelled","WorkflowRunCanNotBeCancelled","WorkflowRunCanNotBeDeletedDueToStatus","WorkflowRunCanNotBeDeletedDueToCreationTime","WorkflowTriggerIsNotEnabled","WorkflowTriggerAlreadyRunning","WorkflowAccessKeyCanNotBeDeleted","TooManyConcurrentRequests","ServiceTemporarilyUnavailable","DestinationWorkflowExists","SourceWorkflowDoesNotExist","ResourceMoveLimitExceeded","MultipleErrorsOccurred","NoMicrosoftLogicResourcesToMove","WorkflowLocked","WorkflowAuthenticationTypeNotSupported","WorkflowManagedServiceIdentityNotSpecified","SubscriptionMoveNotSupportedInRenameApi","InvalidOperationId","AsyncOperationNotFound","AsyncOperationCompletedUnexpectedly","OutputParameterEvaluationFailed","ActionFailed","WorkflowTriggerNotReady","WorkflowTriggerCompleted","ApiNotIntroduced","ApiDeprecated","DirectApiAuthorizationRequired","WorkflowRunNotRunning","WorkflowRunActionNotReady","WorkflowRunActionAlreadyRun","ActionTimedOut","ApiNotSupported","WorkflowRunActionResponseStatusCodeNotSupported","InvalidQueryFilter","InvalidQuerySearch","InvalidSwagger","HealthCheckRequestsThrottled","InvalidHealthCheckType","WorkflowTriggerVersionNotFound","InvalidWorkflowTriggerVersionId","WorkflowTriggerVersionNotLatest","WorkflowCannotHaveSkuAtTopLevel","WorkflowConsumptionSkuNotSupportedForApiVersion","WorkflowHostingPlanNotSupportedForApiVersion","CannotUpdateHostingPlanBasedWorkflowWithEmptySkuProperty","CannotUpdateConsumptionBasedWorkflowWithNonemptySkuProperty","PatchWorkflowSkuTierNotSpecified","PatchWorkflowPropertiesNotSupported","PatchSkuForConsumptionWorkflowNotSupported","WorkflowUnsupportedRecurrenceTriggerForResponseAction","WorkflowUnsupportedSplitOnTriggerForResponseAction","WorkflowUnsupportedBatchTriggerForResponseAction","ActionResponseSkipped","ActionResponseAlreadyDefined","ActionResponseTimedOut","ClientClosedRequest","NoResponse","ResponseTimeout","ApiNotFound","ApiConnectionNotFound","MissingApiName","MissingApiConnectionName","InvalidApiDefinition","InvalidApiConnection","InvalidApiConnectionApiReference","MissingQueryFilter","InvalidExportInQueryString","ApiSwaggerNotFound","MissingWorkflowTriggerInputs","InvalidWorkflowTriggerInputs","InvalidApiConnectionName","MissingConsentLinksDefinition","ConnectionsParameterInvalid","RequestBodyNotSupported","GatewayTimeout","InvalidGatewayHost","BadGatewayConnection","BadGateway","InvalidResourceName","MismatchingIntegrationAccountName","EnabledRegionalIntegrationAccountsQuotaExceeded","EnabledIntegrationAccountsInIntegrationServiceEnvironmentQuotaExceeded","InvalidIntegrationAccount","IntegrationAccountNotFound","InvalidPatchIntegrationAccountRequest","WorkflowRunActionInputsMissingProperty","WorkflowActionWorkflowIdMalformed","WorkflowRunActionInvalidHostInput","NestedWorkflowNotFound","SchemaNotFound","NoSchemaResolved","MultipleSchemasResolved","MapNotFound","CertificateNotFound","PartnerNotFound","AgreementNotFound","RosettaNetProcessConfigurationNotFound","AssemblyNotFound","InvalidOperationOnCertificate","OperationNotAllowed","KeyVaultNotFound","KeyVaultOperationFailed","SessionNotFound","SessionIsLatestPreconditionFailed","SessionIsNotLatestPreconditionFailed","SessionAlreadyDeletedOrDoesNotExist","InvalidEtag","UnsupportedHttpHeader","InvalidSchema","UnsupportedSchemaTypeFilter","UnsupportedMapTypeFilter","UnsupportedPartnerTypeFilter","UnsupportedAgreementTypeFilter","UnsupportedSchemaTypeFilterValue","UnsupportedMapTypeFilterValue","UnsupportedPartnerTypeFilterValue","UnsupportedAgreementTypeFilterValue","UnsupportedAssemblyNameFilterValue","SchemaQuotaExceeded","AssemblyQuotaExceeded","AssemblyAlreadyExists","MapQuotaExceeded","CertificateQuotaExceeded","PartnerQuotaExceeded","AgreementQuotaExceeded","RosettaNetProcessConfigurationQuotaExceeded","IntegrationAccountLocked","SourceIntegrationAccountDoesNotExist","DestinationIntegrationAccountExists","InvalidLocation","KeyVaultUnderWrongSubscription","MissingConfirmConsentCodeContent","UnsupportedWorkflowTriggerTypeFilterValue","UnsupportedWorkflowFilter","UnsupportedConnectionFilter","IntegrationAccountRequestsThrottled","ContentNameNotFound","FunctionNotFound","InvalidFunctionType","FunctionInvokeUrlNotFound","FunctionUnderWrongSubscription","WorkflowRunActionInputsInvalidProperty","InvalidXml","ValidationFailed","NestedWorkflowContainsSplitOnTrigger","NestedWorkflowDoesNotContainResponseAction","WorkflowSelfReference","PropertyNotAllowed","PropertyNotSpecified","WorkflowDescriptionTooLong","TriggerDescriptionTooLong","ActionDescriptionTooLong","InputParameterDescriptionTooLong","OutputParameterDescriptionTooLong","ExpressionEvaluationFailed","ActionBranchingConditionNotSatisfied","TrackedPropertiesSizeLimitExceeded","TrackedPropertiesEvaluationFailed","AmbiguousSchema","ValueNotSupported","InvalidMap","InvalidMapRequest","WorkflowRunTimedOut","DuplicateSchemaReference","IdenticalBusinessIdentities","ConnectionGatewayNotFound","InvalidConnectionGateway","CannotUpdateGatewayInstallationReference","ConnectionGatewayFailure","ConnectionGatewaySettingNameMissing","ConnectionGatewayReferenceMissing","ConnectionGatewayReferenceInvalid","ConnectionGatewayAuthTypeMissing","ConnectionGatewayAuthTypeInvalid","ConnectionGatewayInstallationUnavailable","ManagedApiNotRegisteredForOnPremise","CannotResolveClusterUri","MissingConnectionGatewayInstallationId","InvalidConnectionGatewayInstallationId","InvalidClientTrackingId","ClientTrackingIdLengthLimitExceeded","InvalidConsentLinkParameter","Terminated","InvalidArtifactType","IntegrationAccountAssociationRequired","NestedForeachActionNotAllowed","NestedUntilActionNotAllowed","ApiManagementServiceUnderWrongSubscription","ApiManagementServiceNotFound","WorkflowOperationInputsApiOperationNotFound","WorkflowOperationInputsInvalidProperty","WorkflowOperationInputsMissingProperty","WorkflowOperationInputsPropertyInvalidConnectionsReference","WorkflowOperationParametersAmbiguousProperty","WorkflowOperationParametersArrayInvalidLength","WorkflowOperationParametersExtraParameter","WorkflowOperationParametersIncorrectEnum","WorkflowOperationParametersIncorrectParameterType","WorkflowOperationParametersInternalValueProvided","WorkflowOperationParametersMissingRequiredParameter","WorkflowOperationParametersNumberInvalidMultiple","WorkflowOperationParametersInvalidParameterName","WorkflowOperationParametersNumberInvalidRange","WorkflowOperationParametersReadOnlyParameter","InvalidWorkflowOperationParametersRuntimeValue","WorkflowOperationParametersRuntimeMissingValue","WorkflowOperationParametersStringInvalidLength","NotPlatformSubscription","ActionResultsSizeLimitExceeded","WorkflowTriggerHistoryCannotBeResubmitted","DestinationResourceExists","TrackingEventsLimitExceeded","TrackingRecordTypeNotSpecfied","TrackingEventsSourceTypeNotSpecfied","InvalidTrackingEventsSourceType","InvalidSystemId","MissingAccessKeyRegenerateActionContent","InvalidAccessKeyType","PatchApiConnectionPropertiesNotSupported","InvalidPatchApiConnectionRequest","WorkflowRunInProgress","WorkflowMaximumWaitingRunCountExceeded","WorkflowConnectionParameterUnderWrongSubscription","WorkflowUnderWrongSubscription","AllowedSwitchCaseLimitExceeded","MapCompilationFailed","EnabledRegionalFreeSkuIntegrationAccountsQuotaExceeded","IntegrationAccountNotReady","MapNotReady","InvalidContentOperation","UnsupportedComparisonOperator","InvalidJSON","InvalidMultipart","UnsupportedChangedTimeFilter","UnsupportedChangedTimeFilterValue","TriggerRequestMethodNotValid","TriggerRelativePathNotValid","ContentMissing","InvalidFunctionRoute","InvalidFunctionAuthorizationLevel","ActionRepetitionNotFound","IntegrationAccountConfigurationChanged","TagsConfigurationChanged","AccessControlConfigurationChanged","WorkflowNotUnderAllowedResourceGroup","FunctionNotUnderAllowedResourceGroup","ConnectionParameterNotUnderAllowedSubscriptionOrResourceGroup","ApiManagementServiceUnderNotUnderAllowedResourceGroup","WorkflowRunActionTimeoutLimitInvalid","InvalidInputParameter","InvalidTemplateParameter","MissingBatchConfiguration","MissingBatchReleaseCriteria","InvalidBatchConfiguration","InvalidBatchConfigurationName","InvalidVariableInitialization","InvalidVariableOperation","TriggerOperationNotValid","MissingBatchTriggerOperationInputs","InvalidBatchTriggerOperationInputs","InvalidBatchPartitionName","InvalidBatchMessageId","WorkflowVersionTriggerTypeNotRequest","VariableSizeLimitExceeded","ExpressionTraceNotSupported","ExpressionTraceSizeLimitExceeded","WorkflowActionNotFound","InvalidPaginationPolicy","InvalidPageResponse","InvalidFlowLifetime","UnsupportedPatchConnectionGatewayRequest","InvalidSubscriptionNotificationDefinition","InvalidSubscriptionNotificationProperties","SubscriptionNotificationMissingTenantId","ClassicServiceDeploymentSlotNotFound","ClassicServiceRoleNotFound","ClassicServiceRoleInstancesNotFound","UnexpectedAutoscaleSettingsFound","UnexpectedAutoscaleSettingProfilesFound","SchemaNullOrEmpty","UnknownError","InvalidPartialContent","InvalidContentLink","InvalidMapCompilationRequest","InvalidTransformRequest","InvalidXmlContent","InvalidXsltContent","InvalidXsltTransformOptions","InvalidMapCompiledContent","InvalidContentTransferConfiguration","InvalidContentRangeHeader","InvalidProtocolResponse","MaxRequestCountReached","ListFunctionKeysFailed","InvalidExpandInQueryString","ExpandedContentsNotSupported","InvalidMaxExpandedContentSizeInQueryString","ScopeRepetitionNotFound","UnresolvableHostName","InvalidSlidingWindowTriggerInput","InvalidSlidingWindowTriggerRecurrence","InvalidConcurrencyConfiguration","InvalidCollectionsConfiguration","InvalidRangeHeader","InvalidBatchConfigurationRecurrenceSchedule","InvalidBatchConfigurationRecurrence","InvalidPatchCustomApiRequest","RegionalCustomApisQuotaExceeded","InvalidExpressionActionKind","InvalidExpressionActionInputs","MissingSourceTimeZone","InvalidSourceTimeZone","ConflictingSourceTimeZone","FunctionAppUnderWrongSubscription","FunctionAppNotUnderAllowedResourceGroup","FunctionInputsContainConflictingProperties","ListFunctionAppMasterKeyFailed","BatchConfigurationNotFound","BatchConfigurationQuotaExceeded","InvalidBatchGroupName","MissingBatchGroupName","CannotDeleteApi","InvalidAvailabilityMode","InvalidPerformanceProfile","MissingApiOperationName","ApiOperationNotFound","InvalidWsdlDefinition","WsdlParsingFailed","WsdlOperationCountLimitExceeded","MapCompilationNotSupported","ApiConnectionManagementServiceFailure","ApiManagementServiceFailure","ClassicComputeServiceFailure","RedisCacheServiceFailure","StorageServiceFailure","NetworkServiceFailure","FunctionServiceFailure","InsightServiceFailure","ResourceManagerFailure","MissingLiquidActionKind","InvalidLiquidActionKind","ClientKeywordsEmpty","InvalidClientKeywordsCount","InvalidClientKeywordLength","InvalidClientKeywordCharacters","IntegrationAccountXsltFunctionAppContextNotFound","IntegrationAccountXsltFunctionAppSecretsNotFound","TriggerInputSchemaMismatch","TriggerInputSchemaInvalid","TriggerInputSchemaNotSupported","ActionSchemaInvalid","ActionSchemaNotSupported","InvalidRetryPolicy","WorkflowTriggerResetNotSupported","WorkflowTriggerResetBlocked","CannotDisableTriggerConcurrency","WorkflowTriggerSetStateNotSupported","TriggerConcurrencyLimitReached","PairedRegionNotAvailable","InvalidIntegrationServiceEnvironment","IntegrationServiceEnvironmentSubscriptionQuotaExceeded","IntegrationServiceEnvironmentProvisioningInProgress","MismatchingIntegrationServiceEnvironmentName","IntegrationServiceEnvironmentNotFound","IntegrationServiceEnvironmentSubscriptionMismatch","IntegrationServiceEnvironmentNotReady","InvalidIntegrationServiceEnvironmentPatchRequest","InvalidIntegrationServiceEnvironmentNetworkConfiguration","MissingIntegrationServiceEnvironmentNetworkConfiguration","DuplicateIntegrationServiceEnvironmentNetworkConfigurationSubnets","InvalidIntegrationServiceEnvironmentNetworkConfigurationSubnetReference","InvalidIntegrationServiceEnvironmentPutRequest","IntegrationServiceEnvironmentVirtualNetworkNotFound","IntegrationServiceEnvironmentVirtualNetworkSubnetNotFound","InvalidIntegrationServiceEnvironmentVirtualNetworkSubnet","IntegrationServiceEnvironmentNetworkConfigurationMismatch","IntegrationServiceEnvironmentVirtualNetworkReferencesMismatch","InvalidApiManagementAccountId","RuntimeApisNotAllowed","RuntimeApiManagementAccountMappingLoadFailed","RuntimeApiManagementAccountMappingNotFound","ApiManagementAccountNotSupported","OpenApiOperationRuntimeUrlsNotWellFormed","OpenApiOperationTooManyDynamicSchemaRequests","OpenApiOperationRuntimeSwaggerTooLarge","WorkflowIntegrationServiceEnvironmentMismatch","WorkflowMoveNotSupported","WorkflowNotInSameIntegrationServiceEnvironmentAsIntegrationAccount","IntegrationAccountInIntegrationServiceEnvironment","WorkflowInIntegrationServiceEnvironment","WorkflowInIntegrationServiceEnvironmentDirectAccessUpdate","NestedWorkflowIntegrationServiceEnvironmentMismatch","IntegrationAccountIntegrationServiceEnvironmentMismatch","WorkflowManagedServiceIdentityDirectAccessUpdateNotSupported","WorkflowManagedServiceIdentityInvalid","WorkflowManagedServiceIdentityQuotaExceeded","WorkflowManagedServiceIdentityTypeNotSupported","IntegrationAccountMoveNotSupported","WorkflowTriggerTypeSimulateNotSupported","WorkflowTriggerSimulateConcurrencyNotSupported","InvalidTypeConversion","DynamicParameterInputInvalid","DynamicSchemaInvalidConnection","DynamicSchemaRequestServerFailure","DynamicSchemaRequestClientFailure","DynamicSchemaResponseNotSchema","DynamicSchemaResponseContainsRefs","DynamicSchemaResponseTooLarge","DynamicListResponseInvalid","DynamicTreeResponseInvalid","DynamicTreeFilterExpressionInvalid","OpenApiOperationParameterValidationFailed","OpenApiOperationParameterTypeConversionFailed","AppServicePlanServiceFailure","ApiManagementAccountServiceFailure","ManagedServiceIdentityServiceFailure","ConnectorDeploymentEnvironmentFailure","AppServiceEnvironmentServiceFailure","KustoServiceFailure","UnsupportedOperation","MissingRecommendOperationGroupRequestDefinition","RecommendOperationGroupLimitInvalidValue","InvalidOperationGroupId","MissingOperationGroupId","ApiConnectionIsInConflictState","CustomApiIsInConflictState","IntegrationServiceEnvironmentMismatch","IntegrationServiceEnvironmentApiReferenceMismatch","HeaderNotSupported","InvalidOpenApiConnectionOperationType","InvalidOpenApiConnectionWebhookOperationType","UnsupportedApiRunFlowForOpenApiFlow","ReceiveSideSchemaReferenceNamespaceNotAllowed","UnauthorizedOperation","GetFunctionAppFailed","GetFunctionFailed","ResponseSwaggerSchemaValidationFailure","CountLimitReached","TimeLimitReached","ConnectionReferenceInvalid","WorkflowConnectionReferenceUnderWrongSubscription","ConnectionReferenceNotUnderAllowedSubscriptionOrResourceGroup","ConnectionReferenceNotSupported","AsyncOperationFailed","RuntimeConnectionReferencesNotAllowed","HidxContentNotValid","InvalidApiConnectionActionInputAuthentication","InvalidApiConnectionActionInputRuntimeUrl","InvalidOpenApiConnectionActionInputApiId","ConnectionReferencePropertyUnsupported","InvokerConnectionOverrideFailed","InvokerConnectionNotAllowed","MismatchingApiName","WorkflowAuthenticationInvalidExpression","WorkflowInvalidStaticResults","FlowRunActionTerminated","DynamicInvokeAuthenticationInvalid"],n=e=>({properties:{status:{title:e.Static.Result.Operation.Status.Title,type:"string",minLength:1,enum:["Succeeded","Failed"],default:"Succeeded"},code:{title:e.Static.Result.Operation.Code.Title,type:"string"},error:{title:e.Static.Result.Operation.Error.Title,type:"object",properties:{code:{title:e.Static.Result.Operation.Error.Object.Code.Title,type:"string",enum:r},message:{title:e.Static.Result.Operation.Error.Object.Message.Title,type:"string",default:"Unknown error"}},required:["message"]}},required:["status"],type:"object",title:e.Static.Result.Page.Title,additionalProperties:!1})},34159:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(34158);function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=e=>{var t=Object(r.a)(e);return o(o({},t),{},{properties:o(o({},t.properties),{},{outputs:{properties:{body:{type:"string",title:e.Static.Result.Http.Body.Title}},type:"object",title:e.Static.Result.Operation.Output.Title,required:["body"]}}),required:[...t.required]})}},34160:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(18960),n=i(34158);function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e){var t={type:"object",title:e.Static.Result.Validation.Error.Title,properties:{message:{type:"string",title:e.Static.Result.Validation.Error.Message},lineNumber:{type:"integer",title:e.Static.Result.Error.Line.Number},linePosition:{type:"integer",title:e.Static.Result.Error.Line.Position},path:{type:"string",title:e.Static.Result.Validation.Error.Path},value:{title:e.Static.Result.Validation.Error.Value},errorType:{type:"string",title:e.Static.Result.Validation.Error.Type,enum:["None","MultipleOf","Maximum","Minimum","MaximumLength","MinimumLength","Pattern","AdditionalItems","Items","MaximumItems","MinimumItems","UniqueItems","MaximumProperties","MinimumProperties","Required","AdditionalProperties","Dependencies","Enum","Type","AllOf","AnyOf","OneOf","Not","Format","Id","PatternProperties","Validator","Valid","Const","Contains"]},schemaId:{type:"string",title:e.Static.Result.Validation.Error.Schema.Id,format:"uri"},schemaBaseUri:{type:"string",title:e.Static.Result.Validation.Error.Schema.Base.Uri,format:"uri"},schema:{type:"object",title:e.Static.Result.Validation.Error.Error.Schema},childErrors:{title:e.Static.Result.Parse.Json.Child.Errors,type:"array",items:{}}}},i=Object(r.a)(t);return t.properties.childErrors.items=i,t}function c(e){var t=Object(n.a)(e);return a(a({},t),{},{properties:a(a({},t.properties),{},{outputs:{properties:{body:{title:e.Static.Result.Http.Body.Title},errors:{type:"array",title:e.Static.Result.Parse.Json.Validation.Errors,items:l(e)}},type:"object",title:e.Static.Result.Operation.Output.Title}}),required:[...t.required]})}},34161:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(34158);function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=e=>{var t=Object(r.a)(e);return o(o({},t),{},{properties:o(o({},t.properties),{},{outputs:{properties:{statusCode:{type:"string",title:e.Static.Result.Http.Status.Code.Title,default:"OK",enum:l(!0)},body:{title:e.Static.Result.Http.Body.Title},headers:{type:"object",additionalProperties:{type:"string"},title:e.Static.Result.Http.Headers.Title}},type:"object",title:e.Static.Result.Operation.Output.Title,required:["statusCode","headers"]}}),required:[...t.required]})};function l(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=["Accepted","Ambiguous","BadGateway","BadRequest","Conflict","Continue","Created","ExpectationFailed","Forbidden","Found","GatewayTimeout","Gone","HttpVersionNotSupported","InternalServerError","LengthRequired","MethodNotAllowed","Moved","MovedPermanently","MultipleChoices","NoContent","NonAuthoritativeInformation","NotAcceptable","NotFound","NotImplemented","NotModified","OK","PartialContent","PaymentRequired","PreconditionFailed","ProxyAuthenticationRequired","Redirect","RedirectKeepVerb","RedirectMethod","RequestedRangeNotSatisfiable","RequestEntityTooLarge","RequestTimeout","RequestUriTooLong","ResetContent","SeeOther","ServiceUnavailable","SwitchingProtocols","TemporaryRedirect","Unauthorized","UnsupportedMediaType","Unused","UpgradeRequired","UseProxy"];if(e)for(var i=200;i<600;i++)t.push(i.toString());return t}},34162:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(34158);function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=e=>{var t=Object(r.a)(e);return o(o({},t),{},{properties:o(o({},t.properties),{},{outputs:{properties:{body:{type:"array",title:e.Static.Result.Query.Output.Title}},type:"object",title:e.Static.Result.Operation.Output.Title,required:["body"]}}),required:[...t.required]})}},34163:function(e,t,i){e.exports=i.p+"static/media/flowDesignerDirective.6306f6b5.less"},34164:function(e,t){e.exports='<div class="msla-container msla-host-processsimple"></div>\n<view-permissions-dialog\n    connection-providers="[flowDesignerDirectiveCtrl.connectionProvider]"\n    modal-dialog="flowDesignerDirectiveCtrl.viewPermissionsDialog">\n</view-permissions-dialog>'},34165:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(34166);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.controllerAs="flowMonitorCtrl",this.restrict="E",this.scope={context:"=",model:"=",onInit:"&",onLoadComplete:"&",onLoadError:"&"},this.template=i(34167)}));r.a.directive(n.a.directives.flowMonitor,[()=>new c])},34166:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var r=i(20107),n=i(20791),o=i(17266),a=i(13143),s=i(20803),l=i(20915),c=i(20892),u=i(12345),d=i(13e3),p=i(13031),h=i(15478),m=i.n(h),g=i(33383),f=i(33327),v=i(34151),b=i(21878),y=i(17258);function w(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C=function(){function e(t,i,o,p,h,m,f,w,S,C,k,P,x,A,T,R,O,D,E,F,I,j,N,M){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$element=t,this.$q=i,this.$routeParams=o,this.$scope=p,this.appSettings=h,this.authenticationService=m,this.clientResources=f,this.connectionsClient=w,this.connectorHideKeyService=S,this.environmentService=C,this.flowConnectionsClient=k,this.loggingService=P,this.runInstanceService=x,this.telemetryService=A,this.xrmChildFlowsClient=T,this.designerCoreLoader=R,this.graphService=O,this.tokenService=D,this.apiOperationService=E,this.designerOperationsService=F,this.assetService=I,this.designerCreateContextService=j,this.oAuthService=N,this.ppapiService=M,this.monitorReady=void 0,this._disposed=!1,this.spinner=void 0,this.loadMonitor=()=>{var e=this.$element.children()[0],t=this.shouldExpandSharedConnections?this.getConnectionsForCoauthoredFlow():this.getUserConnections();Promise.all([this.designerCoreLoader.loadDesignerScripts(),this.connectorHideKeyService.getVisibleHideKeys(),t]).then(t=>{var[i,o,p]=t,h={designercore:i.designercore,designerElement:e,appSettings:this.appSettings,featureFlags:this.appSettings.featureFlags,environment:{name:this.environmentService.getCurrentEnvironmentName(),features:u.a.currentEnvironment.features},telemetryService:this.telemetryService,oAuthService:this.oAuthService,ppapiService:this.ppapiService,flowName:this.flowName,connectorV2ServiceFactory:()=>new n.a(!0,this.clientResources,this.flowName,this.loggingService,p,this.graphService,this.xrmChildFlowsClient,u.a,this.tokenService,l.a,b.a,y.a,()=>d.a.user),operationManifestServiceFactory:()=>new s.b(this.apiOperationService,this.clientResources,u.a,null,this.loggingService,this.designerOperationsService,c.a,this.assetService,this.tokenService,this.ppapiService),getArmAccessToken:()=>Object(v.b)(this.authenticationService.getToken(this.appSettings.authResource)),getFunctionsRPAccessToken:()=>Object(v.b)(this.authenticationService.getToken(this.appSettings.functionsAuthResource)),getRuntimeAccessToken:()=>Object(v.b)(this.authenticationService.getToken(this.appSettings.apiHubsRuntimeResource)),getConsentServerAccessToken:()=>Object(v.b)(this.authenticationService.getToken(this.appSettings.consentServerAadResourceUri)),getPPAPIAccessToken:()=>Object(v.b)(this.authenticationService.getToken(this.ppapiService.getTokenAudience())),prefetchedData:{connections:p&&p.length>1?p:void 0},runInstanceServiceFactory:e=>this.runInstanceService.createDesignerRunInstanceService(this.$scope.model.isFlowCheck),visibleHideKeys:o,canAddOperation:void 0,context:this.designerCreateContextService.getDesignerCreateContext(!1)},m=Object(r.c)(h);return m.loadRun(this.$scope.model.flowRunId).then(()=>{m.render(),this.monitorReady.resolve(m),this.spinner.show=!1}).catch(e=>{e.code&&e.error&&e.error.message&&e.code===a.b.AzureResourceManagerRequestFailed&&e.error.message.includes("WorkflowRunNotFound")?(m.render(),this.monitorReady.resolve(m),this.spinner.show=!1):this.handleDesignerLoadError(e,"loadRunInstance")})}).catch(e=>{this.handleDesignerLoadError(e,"loadScriptsAndConnections")}).then(()=>{this.$scope.onLoadComplete()})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"FlowMonitorDirectiveCtrl"}),this.monitorReady=this.$q.defer(),this.$scope.$on("$destroy",()=>{this.monitorReady.promise.then(e=>{e&&!this._disposed&&(this._disposed=!0,e.dispose())})}),this.$scope.context.refreshRun=()=>{var e=this.$scope.model.flowRunId;this.monitorReady.promise.then(t=>{t&&t.refreshRun(e)})},this.spinner={size:g.c.Large,show:!0,local:g.a.Local},this.$scope.onInit(),this.loadMonitor()}var t,i,h;return t=e,(i=[{key:"getConnectionsForCoauthoredFlow",value:function(){return this.$q.all([this.getUserConnections(),this.getFlowConnections()]).then(e=>{var[t,i]=e;return m()([...t,...i],e=>e.id)})}},{key:"getUserConnections",value:function(){return this.connectionsClient.query(this.$scope).$promise.catch(e=>(this.loggingService.logError("FlowMonitorDirectiveCtrl.getUserConnections",e),[]))}},{key:"getFlowConnections",value:function(){return this.flowConnectionsClient.query(this.$scope,{flowName:this.flowName}).$promise.catch(e=>(this.loggingService.logError("FlowMonitorDirectiveCtrl.getFlowConnections",e),[]))}},{key:"shouldExpandSharedConnections",get:function(){return this.$scope.model.isShared||this.isSolutionFlow}},{key:"isSolutionFlow",get:function(){return!!this.$scope.model.solutionId}},{key:"flowName",get:function(){return this.$routeParams.flowName}},{key:"handleDesignerLoadError",value:function(e,t){this.loggingService.logError("FlowDesignerDirectiveCtrl.LoadDesigner",e,{scenario:t});var i=Object(p.a)(this.clientResources.FlowDesignerDirectiveBase.DesignerScriptLoadError,e.message);this.monitorReady.reject(new o.a(a.b.flowsDesignerScriptLoadError,i,e)),this.spinner.show=!1,this.$scope.model.monitorLoadError=e,this.$scope.onLoadError()}}])&&w(t.prototype,i),h&&w(t,h),Object.defineProperty(t,"prototype",{writable:!1}),e}();C.$inject=[f.a.services.$element,f.a.services.$q,f.a.services.$routeParams,f.a.services.$scope,f.a.services.appSettings,f.a.services.authentication,f.a.services.clientResources,f.a.services.connectionsClient,f.a.services.connectorHideKey,f.a.services.environment,f.a.services.flowConnectionsClient,f.a.services.logging,f.a.services.runInstanceService,f.a.services.telemetry,f.a.services.xrmChildFlowsClient,f.a.services.designerCoreLoader,f.a.services.graphService,f.a.services.token,f.a.services.apiOperation,f.a.services.designerOperations,f.a.services.assetService,f.a.services.designerCreateContext,f.a.services.oAuthService,f.a.services.ppapiService]},34167:function(e,t){e.exports='<div class="msla-container msla-host-processsimple">\n    <spinner model="flowMonitorCtrl.spinner"></spinner>\n</div>\n'},34168:function(e,t,i){"use strict";i(34169),i(34170),i(34171),i(34172),i(34173),i(34174),i(34176),i(34177),i(34178),i(34179),i(34180),i(34181)},34169:function(e,t,i){"use strict";var r=i(14751),n=i.n(r),o=i(33331),a=i(33327),s=i(33360),l=i(33472),c=i(33396),u=i(12366),d=i(17266),p=i(33395),h=i(13144);function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=function(){function e(t,i,r,n,o,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.$scope=r,this.appSettings=n,this.clientResources=o,this.environmentService=a,this.flowsClient=s,this.loggingService=l}var t,i,r;return t=e,(i=[{key:"createDesignerRunInstanceService",value:function(e){return{getRunInstance:(t,i,r)=>this.getRunInstance(t,i,e,!0===r)}}},{key:"getOperationOutput",value:function(e,t){if(t.outputsLink)return this.$http({method:"GET",url:t.outputsLink.uri}).then(e=>[].concat(e.data)).catch(e=>{throw this.loggingService.logError("RunInstanceService.GetOperationOutput",e),e});var i=this.$q.defer();return i.resolve([{statusCode:t.code,error:t.error}]),i.promise}},{key:"getRunInstance",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=e.split("/"),o=n[0],a=n[2];if(!o||!a){var c=new d.a(p.a.runInstanceServiceInvalidId,Object(s.d)(this.clientResources.RunInstanceService.invalidRunId,e),null,{runId:e});return this.loggingService.logError("RunInstanceService.getRunInstance",c),Promise.reject(c)}var h=this.getRunOrCheck(e,o,a,t,i,r).then(i=>{var r=t?i.properties.flow:null,n=r?v(r):null,o=i.properties.actions;return i.properties.actions&&delete i.properties.actions,{run:i,runActions:Object.keys(o||{}).map(t=>({id:"".concat(e,"/actions/").concat(t),type:"".concat(u.P,"/flows/runs/actions/"),name:t,properties:o[t]})),workflowVersion:r,apis:n}});return h.catch(i=>{this.loggingService.logError("RunInstanceService.getRunInstance",i,{runId:e,flowName:o,runName:a,includeWorkflow:t})}),Object(l.a)(h)}},{key:"getRunOrCheck",value:function(e,t,i,r,n,o){return n?this.getRunByTriggerHistory(t,i):this.getRunOrCheckOnRunNotFound(e,t,i,r,o)}},{key:"getRunOrCheckOnRunNotFound",value:function(e,t,i,r,n){return this.getRun(t,i,r,n).then(t=>{if(t&&200===t.status)return t.data;throw new d.a(p.a.runInstanceServiceInvalidStatusCode,Object(s.d)(this.clientResources.RunInstanceService.invalidGetRunStatusCode,e,t&&t.status),null,{status:t&&t.status})}).catch(e=>{if(e&&e.data&&404===e.status)return this.loggingService.logInfo("RunInstanceService.getRunInstance.RunNotFound","run not found",{flowName:t,runName:i}),this.getRunByTriggerHistory(t,i);throw e})}},{key:"getRun",value:function(e,t,i,r){var n=Object(h.f)(this.appSettings)+"/environments/".concat(this.environmentService.getCurrentEnvironmentName(),"/")+"flows/".concat(e,"/runs/").concat(t),o=["properties/actions"];return i&&o.push("properties/flow"),this.$http({method:"GET",url:n,params:{"api-version":this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments,$expand:o.join(","),include:"repetitionCount",isMigrationSource:r||!1}})}},{key:"getRunByTriggerHistory",value:function(e,t){var i,r=this.flowsClient.get(this.$scope,{id:Object(c.b)(e,this.environmentService)});return r.$promise.then(()=>{var n=r.properties.definition.triggers;return i=Object.keys(n||{})[0],this.getTriggerHistory(e,i,t)}).then(r=>{if(r&&r.data&&200===r.status)return r.data;throw new d.a(p.a.runInstanceServiceInvalidTriggerHistoryResponse,Object(s.d)(this.clientResources.RunInstanceService.invalidTriggerHistoryResponse,"flows/".concat(e,"/runs/").concat(t)),null,{flowName:e,runName:t,triggerName:i})}).then(n=>{var o=n.properties;return o.name=i,{name:t,id:"/providers/".concat(u.P,"/flows/").concat(e,"/runs/").concat(t),type:"".concat(u.P,"/flows/runs"),properties:{startTime:o.startTime,endTime:o.endTime,status:o.status,actions:{},trigger:o,flow:r.toJSON()}}})}},{key:"getTriggerHistory",value:function(e,t,i){var r=Object(h.f)(this.appSettings)+"/environments/".concat(this.environmentService.getCurrentEnvironmentName(),"/")+"flows/".concat(e,"/triggers/").concat(t,"/histories/").concat(i);return this.$http({method:"GET",url:r,params:{"api-version":this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments}})}}])&&m(t.prototype,i),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e){var t={},i=[];return Object.keys(e.properties.connectionReferences||{}).forEach(r=>{var o=e.properties.connectionReferences[r];if(o){var a=n()(o.apiDefinition||o.api);if(a&&a.properties){a.properties.swagger||(a.properties.swagger=o.swagger);var s=a.name.toUpperCase();t[s]||(t[s]=!0,i.push(a))}}}),i}f.$inject=[a.a.services.$http,a.a.services.$q,a.a.services.$rootScope,a.a.services.appSettings,a.a.services.clientResources,a.a.services.environment,a.a.services.flowsClient,a.a.services.logging],o.a.service(a.a.services.runInstanceService,f)},34170:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33452),a=i(12381),s=i(33390),l=i(13144);function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.appSettings=r,this.backendService=n,this.environmentService=o}var t,i,r;return t=e,(i=[{key:"getDownloadLinkAsyncPollState",value:function(e){var t=Object(a.a)(Object(l.c)(this.appSettings).flowRP,this.appSettings.processSimpleResourceProviderPath),i="environments/".concat(this.environmentService.getCurrentEnvironmentName(),"/flows/").concat(e.flowName,"/exportRuns"),r={method:"POST",url:Object(a.a)(t,i),headers:{[o.a.contentType]:o.c.applicationJson},params:{"api-version":this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments},data:{statusFilter:this.getStatusFilter(e.filter)}};return this.backendService.getOrCreateCachedAsyncPoller({evictionDelay:e.reset?-1:3e5,cacheParams:r,action:()=>this.$http(r),eventName:"FlowRunsHistoryCsvDownload",eventData:{flowName:e.flowName}})}},{key:"getStatusFilter",value:function(e){switch(e){case s.a.successfulRuns:return"Succeeded";case s.a.failedRuns:return"Failed";case s.a.runningRuns:return"Running";case s.a.cancelledRuns:return"Cancelled";case s.a.allRuns:default:return"NotSpecified"}}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.appSettings,n.a.services.backend,n.a.services.environment],r.a.service(n.a.services.flowRunsHistoryCsvDownloadService,d)},34171:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33354),a=i(33437),s=i(33463),l=i(33464),c=i(33392),u=i(13240);function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){h(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function h(e,t,i){return(t=g(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.loggingService=i,this.telemetry=r,this.templatesClient=n,this.environmentService=o}var t,i,r;return t=e,(i=[{key:"submitToPendingGallery",value:function(e){return this.submitToGallery(e,{galleryName:l.b.pending})}},{key:"submitToPrivateGallery",value:function(e,t){var i={sharing:t};return this.submitToGallery(e,{galleryName:l.b.private,includeEnvironment:!0,metadata:i})}},{key:"submitToGallery",value:function(e,t){var{flow:i,extendedSubmissionContent:r,templateCategories:n,templateDescription:l,templateTitle:d}=e,{galleryName:h,includeEnvironment:m,metadata:g}=t,f={properties:{displayName:d,summary:l,description:l,connectionReferences:this.getTemplateConnectionReferences(i),categoryNames:n,definition:i.properties.definition,metadata:g}},v=m?Object(s.b)(h,this.environmentService):Object(s.a)(h),b={flowName:i.name,galleryName:h,extendedSubmissionContent:r},y=this.loggingService.profileStart(o.a.publishTemplateStart,b);return this.templatesClient.post({id:v},f).then(e=>(this.telemetry.tagEvent(a.a.PublishFlowCompleted,{status:u.d.succeeded},p(p({},b),{},{templateName:e.data.name})),this.loggingService.profileEndWithSuccess(y,o.a.publishTemplateEnd,b),e.data.name)).catch(e=>(this.loggingService.logError("TemplatePublishService.SubmitToGallery",e,b),this.loggingService.profileEnd(y,o.a.publishTemplateEnd,Object(c.b)(e),e,b),this.telemetry.tagEvent(a.a.PublishFlowCompleted,{status:u.d.failed},p(p({},b),{},{error:e})),this.$q.reject(e)))}},{key:"getTemplateConnectionReferences",value:function(e){var t={},i=e.properties.connectionReferences||{};return Object.keys(i).forEach(e=>{t[e]={api:{id:i[e].id}}}),t}}])&&m(t.prototype,i),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();f.$inject=[n.a.services.$q,n.a.services.logging,n.a.services.telemetry,n.a.services.templatesClient,n.a.services.environment],r.a.service(n.a.services.templatePublish,f)},34172:function(e,t,i){"use strict";var r=i(20903),n=i(20908),o=i(20911),a=i(20913),s=i(20915),l=i(17865),c=i(15459),u=i(12345),d=i(17258),p=i(20962),h=i(20920),m=i(17150),g=i(15339),f=i(13e3),v=i(13202),b=i(17159),y=i(33327),w=i(33331);function S(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function C(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var k=function(){function e(t,i,r,n,o,a,s,l,c,u,d,p,h,m,g,f,v,b,y,w,S,C,k,P,x,A,T,R,O,D,E,F,I,j,N,M,L,U,B,$,q,W,z,H){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.clientResources=i,this.analyticsService=r,this.gatewayService=n,this.xrmMachineManagementService=o,this.rpaLocalService=a,this.assetService=s,this.widgetService=l,this.universalSearchService=c,this.cdnService=u,this.doNotShowAgainService=d,this.flowService=p,this.hostCommunicationService=h,this.loggingService=m,this.graphService=g,this.tokenService=f,this.snippetService=v,this.connectionService=b,this.environmentCapabilityService=y,this.flowRunInputsOutputsService=w,this.routeCrafter=S,this.uiFlowService=C,this.designerCoreLoaderService=k,this.licenseManagementService=P,this.consentService=x,this.navigationService=A,this.planService=T,this.winAutomationService=R,this.neptuneService=O,this.desktopFlowStore=D,this.flowRunsService=E,this.telemetryService=F,this.uiFlowRunService=I,this.uiFlowRunStore=j,this.gptService=N,this.xrmEntityHttpClient=M,this.flowHttpClient=L,this.flowRpHttpClient=U,this.desktopFlowAIHttpClient=B,this.desktopFlowRuntimeHttpClient=$,this.xrmConnectionReferenceStore=q,this.xrmConnectionReferenceService=W,this.neptuneHttpClient=z,this.azureResourceGraphHttpClient=H}var t,i,y;return t=e,(i=[{key:"getDesignerCreateContext",value:function(){return{appSettings:this.appSettings,featureFlags:this.appSettings.featureFlags,designerHostContextStore:o.a,sessionStore:f.a,clientResources:this.clientResources,errorHandlingResources:this.clientResources,dateTimeResources:this.clientResources.DateTime,planStore:g.a,analyticsService:this.analyticsService,gatewayService:this.gatewayService,gatewayStore:p.a,xrmMachineManagementService:this.xrmMachineManagementService,machineManagementStore:r.a,rpaLocalService:this.rpaLocalService,surfaceStore:v.a,assetService:this.assetService,environmentStore:u.a,widgetUtilService:this.widgetService,widgetService:this.widgetService,userFeaturesStore:b.a,universalSearchService:this.universalSearchService,cdnService:this.cdnService,easyAutomationPanelStore:Object(a.a)(this.loggingService,this.telemetryService),commentingPaneStore:n.a,doNotShowAgainService:this.doNotShowAgainService,flowService:this.flowService,hostCommunicationService:this.hostCommunicationService,loggingService:this.loggingService,designerConnectionStore:s.a,graphService:this.graphService,tokenService:this.tokenService,snippetService:this.snippetService,connectionService:this.connectionService,connectionStore:l.a,environmentCapabilityService:this.environmentCapabilityService,environmentCapabilityStore:c.a,flowRunInputsOutputsService:this.flowRunInputsOutputsService,flowStore:d.a,routeCrafter:this.routeCrafter,uiFlowService:this.uiFlowService,licenseManagementService:this.licenseManagementService,licenseManagementStore:h.a,consentService:this.consentService,navigationService:this.navigationService,planService:this.planService,winAutomationService:this.winAutomationService,neptuneStore:m.a,neptuneService:this.neptuneService,loadDesignerScripts:()=>this.designerCoreLoaderService.loadDesignerScripts(),desktopFlowStore:this.desktopFlowStore,flowRunsService:this.flowRunsService,uiFlowRunService:this.uiFlowRunService,uiFlowRunStore:this.uiFlowRunStore,gptService:this.gptService,telemetryService:this.telemetryService,desktopFlowAIHttpClient:this.desktopFlowAIHttpClient,desktopFlowRuntimeHttpClient:this.desktopFlowRuntimeHttpClient,flowHttpClient:this.flowHttpClient,flowRpHttpClient:this.flowRpHttpClient,xrmEntityHttpClient:this.xrmEntityHttpClient,xrmConnectionReferenceStore:this.xrmConnectionReferenceStore,xrmConnectionReferenceService:this.xrmConnectionReferenceService,neptuneHttpClient:this.neptuneHttpClient,azureResourceGraphHttpClient:this.azureResourceGraphHttpClient}}}])&&S(t.prototype,i),y&&S(t,y),Object.defineProperty(t,"prototype",{writable:!1}),e}();k.$inject=[y.a.services.appSettings,y.a.services.clientResources,y.a.services.analytics,y.a.services.gateway,y.a.services.xrmMachineManagement,y.a.services.rpaLocal,y.a.services.assetService,y.a.services.widgetUtilService,y.a.services.universalSearchService,y.a.services.cdnService,y.a.services.doNotShowAgain,y.a.services.flow,y.a.services.hostCommunicationService,y.a.services.logging,y.a.services.graphService,y.a.services.token,y.a.services.codeSnippet,y.a.services.connection,y.a.services.environmentCapability,y.a.services.flowRunInputsOutputs,y.a.services.routeCrafter,y.a.services.uiFlow,y.a.services.designerCoreLoader,y.a.services.licenseManagement,y.a.services.consentService,y.a.services.navigation,y.a.services.planService,y.a.services.winAutomationService,y.a.services.neptuneService,y.a.services.desktopFlowStore,y.a.services.flowrunsService,y.a.services.telemetry,y.a.services.uiFlowRunService,y.a.services.uiFlowRunStore,y.a.services.gptService,y.a.services.xrmEntityClient,y.a.services.flowHttpClient,y.a.services.flowRpHttpClient,y.a.services.desktopFlowAIHttpClient,y.a.services.neptuneHttpClient,y.a.services.azureResourceGraphHttpClient],w.a.service(y.a.services.designerCreateContext,k)},34173:function(e,t,i){"use strict";var r=i(33331),n=i(34153),o=i(33327);function a(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.internalService=void 0,this.internalService=new n.a(i,t)}var t,i,r,o,l;return t=e,(i=[{key:"getOperationResultSchema",value:(o=function*(e,t){return this.internalService.getOperationResultSchema(e,t)},l=function(){var e=this,t=arguments;return new Promise((function(i,r){var n=o.apply(e,t);function s(e){a(n,i,r,s,l,"next",e)}function l(e){a(n,i,r,s,l,"throw",e)}s(void 0)}))},function(e,t){return l.apply(this,arguments)})}])&&s(t.prototype,i),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.$inject=[o.a.services.flowAnalyticsService,o.a.services.clientResources],r.a.service(o.a.services.designerOperationResultSchemaService,c)},34174:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(34175);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.internalService=void 0,this.internalService=new o.a(t)}var t,i,r;return t=e,(i=[{key:"validateParameter",value:function(e,t,i,r,n,o){return this.internalService.validateParameter(e,t,i,r,n,o)}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[n.a.services.parameterValidationServices.sharepointDatasetParameterValidationService],r.a.service(n.a.services.designerValidationService,l)},34175:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(14875);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.validators=void 0,this.noSuggestions=Promise.resolve({errors:[]}),this.validators={SHARED_SHAREPOINTONLINE:{"PATH.$.DATASET":t,"INPUTS.$.DATASET":t}}}var t,i,o;return t=e,(i=[{key:"validateParameter",value:function(e,t,i,n,o,a){var s=Object(r.e)(e).toUpperCase(),l=i.toUpperCase();return this.validators[s]&&this.validators[s][l]?this.validators[s][l].validateParameter(e,t,i,n,o,a):this.noSuggestions}}])&&n(t.prototype,i),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},34176:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33354),a=i(13031),s=i(17266),l=i(13143),c=i(13009),u=i(13144),d=i(12381),p=i(13e3);function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g=function(){function e(t,i,r,n,o,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=i,this.appSettings=r,this.clientResources=n,this.environmentService=o,this.loggingService=a,this.promiseHelperService=s,this.tokenService=l,this.inferErrorStatusGetDashboard=e=>{var t,i;return i=!(null===(t=p.a.user)||void 0===t||!t.isConsumerDomain),Object(c.C)(e)&&i?c.e.Warning:Object(c.y)(e)}}var t,i,r;return t=e,(i=[{key:"getDashboards",value:function(){var e=this.loggingService.profileStart(o.a.flowAnalyticsGetDashboardsStart),t=Object(a.a)("{0}/environments/{1}/reportTypes/flow/reports?api-version={2}",Object(d.a)(Object(u.c)(this.appSettings).bapRP,this.appSettings.businessAppPlatformResourceProviderPath),this.environmentService.getCurrentEnvironmentName(),this.appSettings.businessAppPlatformResourceProviderApiVersion);return this.promiseHelperService.toAngularPromise(this.tokenService.getAccessToken(this.appSettings.authResource)).then(e=>this.$http({method:"GET",url:t,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).then(t=>(this.loggingService.profileEndWithSuccess(e,o.a.flowAnalyticsGetDashboardsEnd),t&&200===t.status&&t.data?t.data.value:this.$q.reject(new s.a(l.b.flowAnalyticsGetDashboardsBadResponse,this.clientResources.FlowAnalyticsService.GetDashboards.BadResponse,null,{responseStatusCode:t&&t.status,responseData:t&&t.data})))).catch(i=>(this.loggingService.profileEnd(e,o.a.flowAnalyticsGetDashboardsEnd,Object(c.y)(i),i,{url:t}),this.$q.reject(i)))}},{key:"getDashboardsV2",value:function(e){var t=this.loggingService.profileStart(o.a.flowAnalyticsGetDashboardsV2Start),i=Object(a.a)("{0}/api/powerbi/reportTypes/flow/dashboards?api-version={1}",Object(u.a)(e,this.appSettings),this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments);return this.promiseHelperService.toAngularPromise(this.tokenService.getAccessToken(this.appSettings.adminAnalyticsAudience)).then(e=>this.$http({method:"GET",url:i,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).then(e=>(this.loggingService.profileEndWithSuccess(t,o.a.flowAnalyticsGetDashboardsV2End),e&&200===e.status&&e.data?e.data:this.$q.reject(new s.a(l.b.flowAnalyticsGetDashboardsBadResponse,this.clientResources.FlowAnalyticsService.GetDashboards.BadResponse,null,{responseStatusCode:e&&e.status,responseData:e&&e.data})))).catch(e=>(this.loggingService.profileEnd(t,o.a.flowAnalyticsGetDashboardsV2End,this.inferErrorStatusGetDashboard(e),e,{url:i,errorCode:e.status,error:e.data}),this.$q.reject(e)))}},{key:"getEmbeddedReportLink",value:function(e,t,i,r){var n={flow:e,reportName:t},p=this.loggingService.profileStart(o.a.flowAnalyticsGetEmbeddedReportLinkStart,n),h={aggregationValue:i,aggregationType:r,reportType:"flow",reportName:t},m=Object(a.a)("{0}/environments/{1}/flows/{2}/getEmbeddedReport?api-version={3}",Object(d.a)(Object(u.c)(this.appSettings).flowRP,this.appSettings.processSimpleResourceProviderPath),this.environmentService.getCurrentEnvironmentName(),e,this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments);return this.promiseHelperService.toAngularPromise(this.tokenService.getAccessToken(this.appSettings.authResource)).then(e=>this.$http({method:"POST",url:m,data:h,headers:{Accept:"application/json",Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).then(e=>(this.loggingService.profileEndWithSuccess(p,o.a.flowAnalyticsGetEmbeddedReportLinkEnd,n),e&&200===e.status&&e.data?e.data:this.$q.reject(new s.a(l.b.flowAnalyticsGetEmbeddedReportLinkBadResponse,this.clientResources.FlowAnalyticsService.GetEmbeddedReportLink.BadResponse,null,{responseStatusCode:e&&e.status,responseData:e&&e.data})))).catch(e=>(this.loggingService.profileEnd(p,o.a.flowAnalyticsGetEmbeddedReportLinkEnd,Object(c.y)(e),e,{url:m,request:h,loggingData:n,errorCode:e.status,error:e.data}),this.$q.reject(e)))}},{key:"getEmbeddedReportLinkV2",value:function(e,t,i,r,n){var d={flow:e,reportName:t},p=this.loggingService.profileStart(o.a.flowAnalyticsGetEmbeddedReportLinkV2Start,d),h=new Date,m=new Date(h);m.setDate(h.getDate()-i);var[g,f,v]=m.toLocaleDateString("en-US").split("/"),[b,y,w]=h.toLocaleDateString("en-US").split("/"),S={parameters:[{name:"FromDate",value:[g.padStart(2,"0"),f.padStart(2,"0"),v].join("-")},{name:"ToDate",value:[b.padStart(2,"0"),y.padStart(2,"0"),w].join("-")}]},C=Object(a.a)("{0}/api/powerbi/environments/{1}/resources/{2}/reportTypes/flow/reports/{3}/embedtoken",Object(u.a)(n,this.appSettings),r,e,t,this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments);return this.promiseHelperService.toAngularPromise(this.tokenService.getAccessToken(this.appSettings.adminAnalyticsAudience)).then(e=>this.$http({method:"POST",url:C,data:S,headers:{Accept:"application/json",Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).then(e=>(this.loggingService.profileEndWithSuccess(p,o.a.flowAnalyticsGetEmbeddedReportLinkV2End,d),e&&200===e.status&&e.data?e.data:this.$q.reject(new s.a(l.b.flowAnalyticsGetEmbeddedReportLinkBadResponse,this.clientResources.FlowAnalyticsService.GetEmbeddedReportLink.BadResponse,null,{responseStatusCode:e&&e.status,responseData:e&&e.data})))).catch(e=>(this.loggingService.profileEnd(p,o.a.flowAnalyticsGetEmbeddedReportLinkV2End,Object(c.y)(e),e,{url:C,request:S,loggingData:d,errorCode:e.status,error:e.data}),this.$q.reject(e)))}}])&&h(t.prototype,i),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();g.$inject=[n.a.services.$http,n.a.services.$q,n.a.services.appSettings,n.a.services.clientResources,n.a.services.environment,n.a.services.logging,n.a.services.promiseHelperService,n.a.services.token],r.a.service(n.a.services.flowAnalyticsService,g)},34177:function(e,t,i){"use strict";var r=i(17237),n=i(12366),o=i(22205),a=i(16926),s=i(14751),l=i.n(s),c=i(33331),u=i(33395),d=i(33441),p=i(33354),h=i(33392),m=i(33327),g=i(33443),f=i(33439),v=i(33475),b=i(33360);function y(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var S=function(){function e(t,i,n,o,s,l,c,u,d,m,v){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.clientResources=i,this.flowRolesClient=n,this.graphService=o,this.loggingService=s,this.promiseHelperService=l,this.sessionService=c,this.sharePointPermissionService=u,this.xrmRolesClient=d,this.environmentService=m,this.environmentCapabilityService=v,this.enableSolutionFlowSharepointDelegatedAuth=void 0,this.getFlowOwners=(e,t)=>{var i=Object(a.y)(e),r=i?this.getFlowOwnersForEntityFlow(e):this.getFlowOwnersForNonEntityFlow(e,t),n={flow:e.name,isSolutionFlow:i},o=this.loggingService.profileStart(p.a.flowOwnersLoadStart,n);return r.then(e=>(this.loggingService.profileEndWithSuccess(o,p.a.flowOwnersLoadEnd,n),e)).catch(e=>{throw this.loggingService.profileEnd(o,p.a.flowOwnersLoadEnd,Object(h.b)(e),e),e})},this.getFlowUsers=(e,t)=>{var i=Object(a.y)(e),r=i?this.getFlowUsersForEntityFlow(e):this.getFlowUsersForNonEntityFlow(e,t),n={flow:e.name,isSolutionFlow:i},o=this.loggingService.profileStart(p.a.flowRunOnlyLoadStart,n);return r.then(e=>(this.loggingService.profileEndWithSuccess(o,p.a.flowRunOnlyLoadEnd,n),e)).catch(e=>{throw this.loggingService.profileEnd(o,p.a.flowRunOnlyLoadEnd,Object(h.b)(e),e,n),e})},this.fetchUsersForNonEntityFlow=(e,t)=>this.flowRolesClient.query(e,{flowName:t,roleName:g.a.users}).$promise,this.getFlowSharingPrincipalsFromGraphUserDetails=(e,t,i)=>e.graphObjects.map(r=>this.convertGraphModelToFlowSharingPrincipal(r,e.thumbnailPhotos,e.principalIdToRoleMap,t,i)),this.fetchOwnersFromFlowRp=(e,t)=>{var i={flowName:e,roleName:g.a.owners};return this.flowRolesClient.query(t,i).$promise},this.convertGraphModelToFlowSharingPrincipal=(e,t,i,r,n)=>{var o=e.id,a=i[e.id],s=a&&a.properties&&a.properties.principal&&a.properties.principal.id===r;return{id:o,iconUri:t.hasOwnProperty(o)?t[o]:"",displayName:e.displayName,email:e.mail,isNonRemovableOwner:s,accessLevel:n,type:Object(f.d)(e.objectType)}},this.getSharepointListInfo=(e,t)=>{var i=this.loggingService.profileStart(p.a.getGraphSharepointDetailsStart),r=this.sharePointPermissionService.getFlowReferencedSharepointLists(t),n=r.map(e=>e.site),o=e.map(e=>e.listIdentifier.site).concat(n).filter((e,t,i)=>i.indexOf(e)===t),a=e.map(e=>e.listIdentifier).concat(r).filter((e,t,i)=>i.findIndex(t=>t.site===e.site&&t.list===e.list)===t),s=this.promiseHelperService.toAngularPromise(this.graphService.querySharepointSites(o)),l=this.promiseHelperService.toAngularPromise(this.graphService.querySharepointLists(a));return this.$q.all([s,l]).then(t=>{var[r,n]=t;return this.loggingService.profileEnd(i,p.a.getGraphSharepointDetailsEnd,h.a.Success),{sharepointSites:r,sharepointLists:n,sharepointPermissions:e}}).catch(t=>{throw this.loggingService.profileEnd(i,p.a.getGraphSharepointDetailsEnd,Object(h.b)(t),t,{sharepointSites:e}),t})},this.enableSolutionFlowSharepointDelegatedAuth=Object(r.c)(this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,this.loggingService)}var t,i,s;return t=e,(i=[{key:"addFlowOwner",value:function(e,t){var i=Object(a.y)(e),r=i?this.addEntityFlowOwner(e.properties.workflowEntityId,t):this.addNonEntityFlowOwner(e.name,t),n={flow:e.name,isSolutionFlow:i},o=this.loggingService.profileStart(p.a.addFlowOwnerStart,n);return r.then(()=>{this.loggingService.profileEndWithSuccess(o,p.a.addFlowOwnerEnd,n)}).catch(e=>{throw this.loggingService.profileEnd(o,p.a.addFlowOwnerEnd,Object(h.b)(e),e,n),e})}},{key:"modifyFlowRunOnlyUsers",value:function(e,t){var i=Object(a.y)(e),r=i?this.modifyEntityFlowUsers(e.properties.workflowEntityId,t):this.modifyNonEntityFlowUsers(e.name,t),n={flow:e.name,isSolutionFlow:i},o=this.loggingService.profileStart(p.a.flowRunOnlySaveStart,n);return r.then(()=>{this.loggingService.profileEndWithSuccess(o,p.a.flowRunOnlySaveEnd,n)}).catch(e=>{var t=Object(h.d)(e)===u.a.PermissionDowngradeNotAllowed?h.a.Warning:Object(h.b)(e);throw this.loggingService.profileEnd(o,p.a.flowRunOnlySaveEnd,t,e,n),e})}},{key:"removeFlowOwner",value:function(e,t){var i=Object(a.y)(e),r=i?this.removeEntityFlowOwner(e.properties.workflowEntityId,t):this.removeNonEntityFlowOwner(e.name,t),n={user:{id:t.id,accessLevel:t.accessLevel},flow:e.name,isSolutionFlow:i},o=this.loggingService.profileStart(p.a.deleteFlowOwnerStart,n);return r.then(()=>{this.loggingService.profileEndWithSuccess(o,p.a.deleteFlowOwnerEnd,n)}).catch(e=>{throw this.loggingService.profileEnd(o,p.a.deleteFlowOwnerEnd,Object(h.b)(e),e,n),e})}},{key:"removeEntityFlowOwner",value:function(e,t){return this.promiseHelperService.toAngularPromise(this.xrmRolesClient.removeFlowOwner(e,t))}},{key:"removeNonEntityFlowOwner",value:function(e,t){var i={id:Object(g.b)(e,g.a.owners,t.id,this.environmentService.getCurrentEnvironmentName())};return this.flowRolesClient.delete(i).then(()=>{})}},{key:"checkCanAddUserAsRunOnlyUser",value:function(e,t){return e.properties.workflowEntityId?this.getFlowOwners(e,null).then(e=>e.owners.find(e=>e.id===t||e.alternativeId===t)?{canAddUser:!1,error:this.clientResources.Permissions.Errors.AddOwnerAsRunOnlyUser}:{canAddUser:!0}):this.$q.resolve({canAddUser:!0})}},{key:"modifyEntityFlowUsers",value:function(e,t){var i=t.add.users.map(t=>()=>this.promiseHelperService.toAngularPromise(this.xrmRolesClient.addFlowUser(e,t))),r=t.remove.users.map(t=>()=>this.promiseHelperService.toAngularPromise(this.xrmRolesClient.removeFlowUser(e,t))),n=i.concat(r);return 0===n.length?this.$q.resolve():this.sequentiallyExecutePromises(n)}},{key:"modifyNonEntityFlowUsers",value:function(e,t){var i=t.add.users.map(e=>this.convertFlowSharingPrincipalToFlowRole(e)).concat(t.add.sharepointLists),r=t.remove.users.map(e=>this.convertFlowSharingPrincipalToFlowRole(e)).concat(t.remove.sharepointLists);return this.flowRolesClient.modify({flowName:e,roleName:g.a.users},{put:i,delete:r}).then(()=>{})}},{key:"addEntityFlowOwner",value:function(e,t){return this.promiseHelperService.toAngularPromise(this.xrmRolesClient.addFlowOwner(e,t))}},{key:"addNonEntityFlowOwner",value:function(e,t){var i={put:[this.convertFlowSharingPrincipalToFlowRole(t)]};return this.flowRolesClient.modify({flowName:e,roleName:g.a.owners},i).then(()=>{})}},{key:"convertFlowSharingPrincipalToFlowRole",value:function(e){return{name:e.id,properties:{principal:{id:e.id,displayName:e.displayName,email:e.email,type:Object(o.b)(e.type)}}}}},{key:"getFlowUsersForNonEntityFlow",value:function(e,t){return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(i=>i.userInfo.userType===n.C.MicrosoftAccount?this.$q.resolve([]):this.fetchUsersForNonEntityFlow(t,e.name)).then(t=>{var i=[];return(t=t||[]).forEach(e=>{e.properties.permissionType===f.c.AuthorizationDelegate&&i.push(Object(v.a)(e))}),this.$q.all([this.promiseHelperService.toAngularPromise(this.graphService.getUsersGraphDetails(t)),this.getSharepointListInfo(i,e)])}).then(e=>{var[t,i]=e;return{users:this.getFlowSharingPrincipalsFromGraphUserDetails(t,null,f.a.User),sharepointListInfo:i}})}},{key:"getFlowUsersForEntityFlow",value:function(e){return this.$q.all([this.promiseHelperService.toAngularPromise(this.xrmRolesClient.getFlowUsers(e.properties.workflowEntityId)),this.promiseHelperService.toAngularPromise(this.enableSolutionFlowSharepointDelegatedAuth)]).then(t=>{var i=t[0];if(t[1]){var r,n;this.loggingService.logInfo("flowPermissionsService.getFlowUsersForEntityFlow","Solution flow with delegated auth enabled detected, attempting to get users",{workflowId:null==e||null===(r=e.properties)||void 0===r?void 0:r.workflowEntityId});var o=[];return n=l()(i),i.forEach(e=>{Object(f.f)(e)&&o.push(Object(v.b)(e))}),this.$q.all([this.getSharepointListInfo(o,e)]).then(e=>{var[t]=e;return this.$q.resolve({users:n,sharepointListInfo:t})})}return this.$q.resolve({users:i,sharepointListInfo:{sharepointLists:{},sharepointSites:{},sharepointPermissions:[]}})})}},{key:"getFlowOwnersForEntityFlow",value:function(e){return this.promiseHelperService.toAngularPromise(this.enableSolutionFlowSharepointDelegatedAuth).then(t=>{if(t){var i;this.loggingService.logInfo("flowPermissionsService.getFlowUsersForEntityFlow","Solution flow with delegated auth enabled detected, attempting to get owners",{workflowId:null==e||null===(i=e.properties)||void 0===i?void 0:i.workflowEntityId});var r=[],n=[];return this.$q.all([this.promiseHelperService.toAngularPromise(this.xrmRolesClient.getFlowOwners(e.properties.workflowEntityId))]).then(t=>{var[i]=t;return n=l()(i),i.forEach(e=>{Object(f.f)(e)&&r.push(Object(v.b)(e))}),this.$q.all([this.sharePointPermissionService.retrieveSharepointListDetails(e,r)])}).then(()=>({owners:n,isRoadmapAuthorizationDelegate:!1}))}return this.promiseHelperService.toAngularPromise(this.xrmRolesClient.getFlowOwners(e.properties.workflowEntityId)).then(e=>({owners:e,isRoadmapAuthorizationDelegate:!1}))})}},{key:"getFlowOwnersForNonEntityFlow",value:function(e,t){var i=!1;return this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(i=>i.userInfo.userType===n.C.MicrosoftAccount?[]:this.fetchOwnersFromFlowRp(e.name,t)).then(t=>{var r=[];return(t=t||[]).forEach(e=>{if(e.properties.permissionType===f.c.AuthorizationDelegate){var t,n=null===(t=e.properties.authorizationDelegate.delegationSource)||void 0===t||null===(t=t.delegationService)||void 0===t?void 0:t.toLowerCase();Object(b.o)(n)||n!==d.a.sharepoint?Object(b.o)(n)||n!==d.a.roadmap||(i=!0):r.push(Object(v.a)(e))}}),this.$q.all([this.promiseHelperService.toAngularPromise(this.graphService.getUsersGraphDetails(t)),this.sharePointPermissionService.retrieveSharepointListDetails(e,r)])}).then(t=>{var[r]=t,n=e&&e.properties&&e.properties.creator&&e.properties.creator.objectId;return{owners:this.getFlowSharingPrincipalsFromGraphUserDetails(r,n,f.a.Owner),isRoadmapAuthorizationDelegate:i}})}},{key:"sequentiallyExecutePromises",value:function(e){return 0===e.length?this.$q.resolve():e.pop()().then(()=>this.sequentiallyExecutePromises(e))}}])&&y(t.prototype,i),s&&y(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();S.$inject=[m.a.services.$q,m.a.services.clientResources,m.a.services.flowRolesClient,m.a.services.graphService,m.a.services.logging,m.a.services.promiseHelperService,m.a.services.session,m.a.services.sharePointPermissionService,m.a.services.xrmRolesClient,m.a.services.environment,m.a.services.environmentCapability],c.a.service(m.a.services.flowPermissions,S)},34178:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33354),a=i(33441),s=i(33392),l=i(33360),c=i(33443),u=i(33436),d=i(21040),p=i(33364),h=i(33475),m=i(33439),g=i(17237),f=i(16926);function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function b(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){y(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function y(e,t,i){return(t=S(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function w(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function S(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C=function(){function e(t,i,r,n,l,c,u,p,h,m,f){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.appSettings=i,this.clientResources=r,this.flowRolesClient=n,this.xrmRolesClient=l,this.graphService=c,this.loggingService=u,this.assetService=p,this.promiseHelperService=h,this.environmentService=m,this.environmentCapabilityService=f,this.allSharepointSites={},this.allSharepointLists={},this.sharepointSiteUrls=[],this.sharepointListOptions=[],this.delegatedSharePointCoauthors=[],this.enableSolutionFlowSharepointDelegatedAuth=void 0,this.retrieveSharepointListDetails=(e,t,i)=>{var r=this.loggingService.profileStart(o.a.getGraphSharepointDetailsStart),n=this.getFlowReferencedSharepointLists(e),a=n.map(e=>e.site),l=t.map(e=>e.listIdentifier.site).concat(a).filter((e,t,i)=>i.indexOf(e)===t),c=t.map(e=>e.listIdentifier).concat(n).filter((e,t,i)=>i.findIndex(t=>t.site===e.site&&t.list===e.list)===t),u=this.promiseHelperService.toAngularPromise(this.graphService.querySharepointSites(l)),d=this.promiseHelperService.toAngularPromise(this.graphService.querySharepointLists(c));return this.$q.all([u,d]).then(n=>{var[a,l]=n;this.loggingService.profileEnd(r,o.a.getGraphSharepointDetailsEnd,s.a.Success),this.populateSharepointFields(e,i,t,a,l)}).catch(e=>{throw this.loggingService.profileEnd(r,o.a.getGraphSharepointDetailsEnd,Object(s.b)(e),e,{sharepointSites:t}),e})},this.getFlowReferencedSharepointLists=e=>e&&e.properties?(e.properties.referencedResources||[]).filter(e=>{if(e.service!==a.a.sharepoint)return!1;var t=e.resource;return t&&t.site&&t.site!==d.d&&t.list&&t.list!==d.d}).map(e=>({site:e.resource.site.toLowerCase(),list:e.resource.list.toLowerCase()})):[],this.populateSharepointFields=(e,t,i,r,n)=>{this.delegatedSharePointCoauthors=[],this.allSharepointSites={},this.allSharepointLists={},this.getFlowReferencedSharepointLists(e).concat(i.map(e=>e.listIdentifier)).forEach(e=>{this.allSharepointSites[e.site]=r[e.site]||{webUrl:e.site},this.allSharepointLists[e.site]=this.allSharepointLists[e.site]||{},n[e.site]&&n[e.site][e.list]?this.allSharepointLists[e.site][e.list]=n[e.site][e.list]:this.allSharepointLists[e.site][e.list]={id:e.list}}),i.forEach(e=>{this.delegatedSharePointCoauthors.push(this.prepareSharepointListCard(e,t))}),this.sharepointSiteUrls=Object.keys(this.allSharepointSites)},this.sharepointListNotAlreadyAdded=e=>0===this.delegatedSharePointCoauthors.filter(t=>t.sharepointPermission.listIdentifier.site===e.site&&t.sharepointPermission.listIdentifier.list===e.list).length,this.enableSolutionFlowSharepointDelegatedAuth=Object(g.c)(this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,this.loggingService)}var t,i,r;return t=e,(i=[{key:"shouldUseSharePointPermissions",value:function(e){return this.getFlowReferencedSharepointLists(e).length>0||this.delegatedSharePointCoauthors.length>0}},{key:"shouldShowSharepointTabs",value:function(e,t){var i;return this.loggingService.logInfo("sharePointPermissionService.shouldShowSharepointTabs","Attempting to show tabs for sharepoint",{workflowEntityId:null==e||null===(i=e.properties)||void 0===i?void 0:i.workflowEntityId}),e&&this.shouldUseSharePointPermissions(e)&&(t&&Object(f.y)(e)||!Object(f.y)(e))}},{key:"prepareSharepointListCard",value:function(e,t){var i=this.allSharepointSites[e.listIdentifier.site],r=this.allSharepointLists[e.listIdentifier.site][e.listIdentifier.list],n={id:e.id,title:i.displayName||Object(l.d)(this.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.SiteUrl,i.webUrl.toLowerCase()),subTitle:r.displayName||Object(l.d)(this.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.ListId,r.id.toLowerCase()),iconUrl:this.assetService.sharepointOnline,sharepointPermission:e,click:()=>t&&t(n),type:u.a.SharepointList};return n}},{key:"updateSharepointListOptions",value:function(e){this.sharepointListOptions=e?Object.keys(this.allSharepointLists[e]).map(t=>this.allSharepointLists[e][t]):[]}},{key:"addPermission",value:function(e,t,i,r){if(!this.sharepointListNotAlreadyAdded(t))throw new p.a("SharePointPermissionService.addPermission",this.clientResources.FlowInfoPane.RunOnly.Tabs.SharePoint.Invite.ListAlreadyAdded);var n=this.loggingService.profileStart(o.a.addSharePointFlowOwnerStart);return this.promiseHelperService.toAngularPromise(this.enableSolutionFlowSharepointDelegatedAuth).then(u=>{if(r&&u)return this.loggingService.logInfo("sharePointPermissionService.addPermission","Solution flow with delegated auth enabled detected, adding permission",{workflowId:r}),this.promiseHelperService.toAngularPromise(this.xrmRolesClient.addSharepointListAccessToFlow(r,t.site,t.list,m.a.Owner)).then(e=>{var r={id:e,listIdentifier:b({},t),accessDefinition:a.b},s=this.prepareSharepointListCard(r,i);s.loading=!1,this.delegatedSharePointCoauthors.push(s),this.loggingService.profileEndWithSuccess(n,o.a.addSharePointFlowOwnerEnd)}).catch(e=>{throw this.loggingService.profileEnd(n,o.a.addSharePointFlowOwnerEnd,Object(s.b)(e),e),e});var d="DELEGATED-"+Object(l.e)(),p={id:d,listIdentifier:b({},t),accessDefinition:a.b},g=this.prepareSharepointListCard(p,i);return g.loading=!0,this.delegatedSharePointCoauthors.push(g),this.flowRolesClient.modify({flowName:e,roleName:c.a.owners},{put:[Object(h.c)(g.sharepointPermission)]}).then(()=>{this.delegatedSharePointCoauthors.forEach(e=>{e.id===d&&(e.loading=!1)}),this.loggingService.profileEndWithSuccess(n,o.a.addSharePointFlowOwnerEnd)}).catch(e=>{throw this.delegatedSharePointCoauthors=this.delegatedSharePointCoauthors.filter(e=>e.id!==d),this.loggingService.profileEnd(n,o.a.addSharePointFlowOwnerEnd,Object(s.b)(e),e),e})})}},{key:"filterOutPermission",value:function(e){this.delegatedSharePointCoauthors=this.delegatedSharePointCoauthors.filter(t=>t.id!==e)}}])&&w(t.prototype,i),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();C.$inject=[n.a.services.$q,n.a.services.appSettings,n.a.services.clientResources,n.a.services.flowRolesClient,n.a.services.xrmRolesClient,n.a.services.graphService,n.a.services.logging,n.a.services.assetService,n.a.services.promiseHelperService,n.a.services.environment,n.a.services.environmentCapability],r.a.service(n.a.services.sharePointPermissionService,C)},34179:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33396),a=i(11773),s=i(17212),l=i(17258),c=i(17208),u=i(12364),d=i(33364),p=i(33394);function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function g(e,t,i){return(t=b(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function v(e,t,i){return t&&f(e.prototype,t),i&&f(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y=v((function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.flowsClient=t,this.flowService=i,this.post=(e,t)=>(Object(a.runInAction)(()=>{l.a.flows.getCollection(s.a.widgetCustomFilter).lastFetched=null}),this.flowsClient.post(e,t).then(e=>{if(Object(o.g)(e)){var t=new c.a(e.data);this.flowService.addFlowToSpecifiedCollections(t,[s.a.personal,s.a.allOwnedFlows]),l.a.flows.entities.setEntitySuccess(t.name),l.a.setFlowMetadata(t.name,{propertiesPageCount:0,savedRecently:!0,isNewFlow:!0})}return e})),this.patch=(e,t,i,r)=>(l.a.flows.entities.setEntityUpdating(t.name),(i?this.flowsClient.patchCommentingSetup(e,t):r?this.flowsClient.patchSolutionFlow(m(m({},e),{},{lastModifiedTimeOfFlow:r}),t):this.flowsClient.patch(e,t)).then(e=>{var t=new c.a(e.data);return l.a.flows.addEntity(t,u.a),l.a.flows.entities.setEntitySuccess(t.name),l.a.setFlowMetadata(t.name,{propertiesPageCount:0,savedRecently:!0,isNewFlow:!1}),e}).catch(e=>{var i,r,n=null!==(i=null==e||null===(r=e.data)||void 0===r?void 0:r.error)&&void 0!==i?i:w(e);throw l.a.flows.entities.setEntityError(t.name,n),n})),this.delete=(e,t)=>this.flowsClient.delete(e).then(()=>{l.a.flows.entities.setEntityDeleting(t.name),l.a.flows.removeEntity(t.name),l.a.removeFlowMetadata(t.name)}).catch(e=>{var i,r,n=null!==(i=null==e||null===(r=e.data)||void 0===r?void 0:r.error)&&void 0!==i?i:w(e);throw l.a.flows.entities.setEntityError(t.name,n),n})}));y.$inject=[n.a.services.flowsClient,n.a.services.flow];var w=e=>new d.a(p.c.UnknownAngularClientResponseError,"The call from the Angular client has failed for an unknown reason.",void 0,{httpStatusCode:e.status});r.a.service(n.a.services.ngReactBridge.ngFlowService,y)},34180:function(e,t,i){"use strict";var r=i(33327),n=i(33331),o=i(28986),a=i(11890),s=i(33493),l=i(12366),c=i(17914),u=i(14900),d=i(17807),p=i(17806),h=i(14901),m=i(14897),g=i(17366),f=i(17141),v=i(15998);function b(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var w=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$rootScope=t,this.widgetUtilService=i,this.routeCrafter=r,this.appSettings=n,this.previousUrl=void 0,t.$on("$routeChangeSuccess",this.onRouteChangeSuccess.bind(this))}var t,i,r;return t=e,(i=[{key:"onRouteChangeSuccess",value:function(e,t,i){i&&i.$$route?!i.$$route.originalPath||t.$$route&&t.$$route.originalPath===i.$$route.redirectTo||(this.previousUrl=i.$$route.originalPath):this.previousUrl=document.referrer}},{key:"cameFromTemplateDetailsPage",get:function(){return this.previousUrl&&this.isTemplateDetailsPage(this.previousUrl)}},{key:"isTemplateDetailsPage",value:function(e){return!(Object(o.a)(e)&&!Object(a.a)(e,window.location.hostname))&&-1!==e.indexOf("galleries")&&-1!==e.indexOf("templates")}},{key:"defaultPathAlias",value:function(){if(this.widgetUtilService.isWidgetPage()){if(this.widgetUtilService.widgetInfo.pathAlias)return this.widgetUtilService.widgetInfo.pathAlias;var e=s.b[this.widgetUtilService.widgetInfo.widgetType];return e.length>0?e[0]:l.w.myFlows}return l.w.myFlows}},{key:"routeWithPathAlias",value:function(e,t){switch(Object(c.i)(e)){case l.w.sharedFlows:return Object(u.v)(this.routeCrafter);case l.w.draftFlows:return Object(u.c)(this.routeCrafter);case l.w.receivedApprovals:return Object(d.b)(this.routeCrafter);case l.w.sentApprovals:return Object(d.c)(this.routeCrafter);case l.w.historyApprovals:return Object(d.a)(this.routeCrafter);case l.w.flowCreation:return Object(h.q)(this.routeCrafter,p.l);case l.w.flowsRuntime:return Object(h.q)(this.routeCrafter,p.o);case l.w.templates:return Object(m.d)(this.routeCrafter);case l.w.connectors:return Object(g.b)(this.routeCrafter);case l.w.customConnectors:return Object(h.m)(this.routeCrafter);case l.w.connections:return Object(h.d)(this.routeCrafter);case l.w.newFlow:return Object(u.q)(this.routeCrafter);case l.w.solutions:return Object(h.E)(this.routeCrafter);case l.w.rpaScripts:return Object(f.h)(this.routeCrafter);case l.w.monitorRuns:return Object(v.R)(this.routeCrafter);case l.w.monitorRunsFromApiFlowRun:return Object(v.S)(this.routeCrafter,{parentFlowId:t.parentFlowId,parentFlowRunId:t.parentFlowRunId});case l.w.monitorRunQueues:case l.w.monitorRunQueueDetails:return Object(v.M)(this.routeCrafter);case l.w.myFlows:default:return Object(u.t)(this.routeCrafter)}}}])&&b(t.prototype,i),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();w.$inject=[r.a.services.$rootScope,r.a.services.widgetUtilService,r.a.services.routeCrafter],n.a.service(r.a.services.ngUrl,w)},34181:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(33354),a=i(12381),s=i(14894),l=i(14875),c=i(34151),u=i(13144);function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var h=function(){function e(t,i,r,n,o,a,s,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$scope=i,this.appSettings=r,this.apisClient=n,this.clientResources=o,this.environmentService=a,this.loggingService=s,this.promiseHelper=l,this.sessionService=c}var t,i,r;return t=e,(i=[{key:"validateParameter",value:function(e,t,i,r,n,a){var u=this.loggingService.profileStart(o.a.parameterValidationServiceValidateParameterStart,{connectorId:e,operationId:t,parameterKey:i}),d=this.apisClient.get(this.$scope,{id:e}),p=d.$promise.then(()=>{var t=d&&d.properties&&d.properties.primaryRuntimeUrl,i=Object(s.a)(n),o=encodeURIComponent(encodeURIComponent(r)),c=Object(l.e)(e);return a?this.getSharepointTablesUsingProxyCall(a,c,i,o):this.getSharepointTables(t,i,o)}).then(r=>(this.loggingService.profileEndWithSuccess(u,o.a.parameterValidationServiceValidateParameterEnd,{connectorId:e,operationId:t,parameterKey:i,isValid:r&&200===r.status,hasSuggestion:!1}),r&&200===r.status?this.createValidParameterValueResponse(e,t,i):this.createInvalidParameterValueResponse(n,t,i))).catch(r=>{var a=this.hasValidSuggestion(r);return this.loggingService.profileEndWithSuccess(u,o.a.parameterValidationServiceValidateParameterEnd,{connectorId:e,operationId:t,parameterKey:i,isValid:!1,hasSuggestion:a,error:r}),a?this.createValidParameterSuggestionResponse(n,t,i,r.data.errors[1]):this.createInvalidParameterValueResponse(n,t,i)});return Object(c.b)(p)}},{key:"hasValidSuggestion",value:function(e){return!!(e&&e.status&&404===e.status&&e.data&&e.data.errors&&2===e.data.errors.length&&"normalized_url"===e.data.errors[0]&&e.data.errors[1])}},{key:"createInvalidParameterValueResponse",value:function(e,t,i){return{errors:[{message:this.clientResources.ParameterValidationServices.SharepointDatasetParameter.NotFound,suggestions:[]}]}}},{key:"createValidParameterSuggestionResponse",value:function(e,t,i,r){return{errors:[{suggestions:[{title:this.clientResources.ParameterValidationServices.SharepointDatasetParameter.Suggestion.CalloutTitle,description:this.clientResources.ParameterValidationServices.SharepointDatasetParameter.Suggestion.CalloutDescription,value:r}]}]}}},{key:"createValidParameterValueResponse",value:function(e,t,i){return{errors:[]}}},{key:"getSharepointTables",value:function(e,t,i){return this.promiseHelper.toAngularPromise(this.sessionService.getToken(this.appSettings.apiHubsRuntimeResource)).then(r=>this.$http({method:"GET",url:this.getSharepointTablesRequestUrl(e,t,i),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}}))}},{key:"getSharepointTablesUsingProxyCall",value:function(e,t,i,r){return this.promiseHelper.toAngularPromise(this.sessionService.getToken(this.appSettings.authResource)).then(n=>this.$http({method:"GET",url:this.getSharepointTablesProxyRequestUrl(e,t,i),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n),"x-ms-flow-proxy-wildcard":Object(a.a)("datasets",Object(a.a)(r,"tables"))}}))}},{key:"getSharepointTablesProxyRequestUrl",value:function(e,t,i){var r=this.environmentService.getCurrentEnvironmentName(),n=this.appSettings.processSimpleResourceProviderApiVersionWithEnvironments;return Object(a.a)(Object(u.f)(this.appSettings),"/environments/".concat(r,"/flows/").concat(e,"/apis/").concat(t,"/connections/").concat(i,"/proxy?api-version=").concat(n))}},{key:"getSharepointTablesRequestUrl",value:function(e,t,i){var r=Object(a.a)(e,t);return Object(a.a)(Object(a.a)(r,"datasets"),Object(a.a)(i,"tables"))}}])&&d(t.prototype,i),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();h.$inject=[n.a.services.$http,n.a.services.$rootScope,n.a.services.appSettings,n.a.services.apisClient,n.a.services.clientResources,n.a.services.environment,n.a.services.logging,n.a.services.promiseHelperService,n.a.services.session],r.a.service(n.a.services.parameterValidationServices.sharepointDatasetParameterValidationService,h)},34182:function(e,t,i){"use strict";i(34183),i(34184)},34183:function(e,t,i){"use strict";i(33463)},34184:function(e,t,i){"use strict";i(34185)},34185:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34186);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34187);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34188),this.controller=o.a,this.controllerAs="templateManagerCtrl",this.bindings={galleryName:"@",templateDisplayName:"@",templateName:"@",redirectUrl:"@",submitterUserId:"@",template:"<"}}));r.a.component(n.a.components.templateManager,new c)},34186:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(33327),n=i(33464),o=i(33360),a=i(33463),s=i(33355),l=i(33398),c=i(13e3),u=i(33392),d=i(14897);function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function h(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){m(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function m(e,t,i){return(t=f(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,i,r,n,o,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientResources=t,this.environmentService=i,this.loggingService=r,this.navigationService=n,this.routeCrafter=o,this.templatesClient=c,this.templateDisplayName=void 0,this.templateName=void 0,this.galleryName=void 0,this.redirectUrl=void 0,this.submitterUserId=void 0,this.template=void 0,this.deleteDialogVisible=!1,this.deletionInProgress=!1,this.confirmTemplateDeleteButton=void 0,this.cancelTemplateDeleteButton=void 0,this.dialogSubtext=void 0,this.deleteTemplateButtonTelemetryData=h({name:l.a.TemplateManagerTemplateDeleteButtonClicked},this.loggingData),this.continueToFlowCreationButtonTelemetryData=h({name:l.a.TemplateManagerContinueToFlowCreationButtonClicked},this.loggingData),this.showConnectionWizard=!1,this.continueToFlowCreation=()=>{this.showConnectionWizard=!0},this.showDeleteDialog=()=>{this.deleteDialogVisible=!0,this.dialogSubtext=this.clientResources.Dialogs.DeleteTemplate.DeleteSubtitle,this.deletionInProgress=!1,this.cancelTemplateDeleteButton.disabled=!1,this.confirmTemplateDeleteButton.disabled=!1},this.onDismissDialog=()=>{this.deleteDialogVisible=!1},this.deleteTemplate=()=>{this.deletionInProgress=!0,this.cancelTemplateDeleteButton.disabled=!0,this.confirmTemplateDeleteButton.disabled=!0;var e=Object(a.c)(this.galleryName,this.templateName,this.environmentService),t=this.loggingService.profileStart(s.a.templateManagerDeleteTemplateStart,this.loggingData);this.templatesClient.delete({id:e}).then(()=>{this.loggingService.profileEndWithSuccess(t,s.a.templateManagerDeleteTemplateEnd,this.loggingData),this.navigationService.navigate(Object(d.d)(this.routeCrafter))}).catch(e=>{this.loggingService.profileEnd(t,s.a.templateManagerDeleteTemplateEnd,Object(u.b)(e),e,this.loggingData),this.cancelTemplateDeleteButton.disabled=!1,this.deletionInProgress=!1,this.dialogSubtext=Object(u.e)(e,this.clientResources.Manage.Template.DefaultFailedToDeleteMessage)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"TemplateManagerCtrl"}),this.confirmTemplateDeleteButton={primary:!0,text:this.clientResources.Common.Delete,onClick:()=>this.deleteTemplate(),telemetryData:h({name:l.a.TemplateManagerConfirmTemplateDeleteButtonClicked},this.loggingData)},this.cancelTemplateDeleteButton={text:this.clientResources.Common.Cancel,onClick:()=>{this.deleteDialogVisible=!1},telemetryData:h({name:l.a.TemplateManagerCancelTemplateDeleteButtonClicked},this.loggingData)}}var t,i,r;return t=e,(i=[{key:"loggingData",get:function(){return{templatename:this.templateName,galleryname:this.galleryName,submitteruserid:this.submitterUserId}}},{key:"dialogTitle",get:function(){return Object(o.d)(this.clientResources.Dialogs.DeleteTemplate.DeleteHeader,this.templateDisplayName)}},{key:"canDelete",get:function(){return this.isPrivateGalleryTemplate&&this.isSubmitter}},{key:"isPrivateGalleryTemplate",get:function(){return this.galleryName===n.b.private}},{key:"isSubmitter",get:function(){return this.submitterUserId&&c.a.isAuthenticated&&c.a.user&&c.a.user.uniqueId===this.submitterUserId}}])&&g(t.prototype,i),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();v.$inject=[r.a.services.clientResources,r.a.services.environment,r.a.services.logging,r.a.services.navigation,r.a.services.routeCrafter,r.a.services.templatesClient]},34187:function(e,t,i){e.exports=i.p+"static/media/templateManager.64d14f18.less"},34188:function(e,t){e.exports='<div class="templateManager" ng-if="templateManagerCtrl.canDelete && !templateManagerCtrl.showConnectionWizard">\n    <react-default-button\n        class="templateManager-createFlowButton"\n        on-click="::templateManagerCtrl.continueToFlowCreation"\n        text="::templateManagerCtrl.clientResources.Manage.Template.ContinueToFlowCreation"\n        primary="::true"\n        telemetry-data="::templateManagerCtrl.continueToFlowCreationButtonTelemetryData">\n    </react-default-button>\n    <react-default-button\n        class="templateManager-deleteButton"\n        on-click="::templateManagerCtrl.showDeleteDialog"\n        text="::templateManagerCtrl.clientResources.Manage.Template.Delete"\n        telemetry-data="::templateManagerCtrl.deleteTemplateButtonTelemetryData">\n    </react-default-button>\n\n    <react-dialog\n        hidden="!templateManagerCtrl.deleteDialogVisible"\n        title="templateManagerCtrl.dialogTitle"\n        sub-text="templateManagerCtrl.dialogSubtext"\n        primary-button-props="::templateManagerCtrl.confirmTemplateDeleteButton"\n        secondary-button-props="::templateManagerCtrl.cancelTemplateDeleteButton"\n        on-dismiss="::templateManagerCtrl.onDismissDialog"\n        is-loading="templateManagerCtrl.deletionInProgress"\n    ></react-dialog>\n</div>\n\n<connection-wizard\n    ng-if="!templateManagerCtrl.canDelete || templateManagerCtrl.showConnectionWizard"\n    redirect-url="{{templateManagerCtrl.redirectUrl}}"\n    prefetched-template="templateManagerCtrl.template"\n>\n</connection-wizard>\n'},34189:function(e,t,i){"use strict";i(34190),i(34191),i(34195)},34190:function(e,t,i){"use strict";i(33414)},34191:function(e,t,i){"use strict";i(34192)},34192:function(e,t,i){"use strict";var r=i(33334),n=i(33327),o=i(33417);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34193);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.restrict="E",this.template=i(34194),this.scope={model:"="},this.controller=o.a,this.controllerAs="controller"}));r.a.directive(n.a.directives.actvityFeedList,[()=>new c])},34193:function(e,t,i){e.exports=i.p+"static/media/activityFeedListDirective.ef3180f3.less"},34194:function(e,t){e.exports='<div class="c-table context-activity-feed">\n    <div ng-hide="controller.activityFeedPresent() || model.spinner.show">\n        <zero-activities></zero-activities>\n    </div>\n    <div ng-show="controller.activityFeedPresent()">\n        <div ng-repeat="table in model.tables">\n            <div class="activityfeed-timeheading">\n                <span>{{table.heading}}</span>\n            </div>\n            <table>\n                <tbody>\n                    <tr\n                        ng-repeat="row in table.rows | filter: {type: model.options.selectedOption.name} | filter: model.searchFilter"\n                        ng-click="controller.rowDefaultAction(row)"\n                        ng-hide="controller.spinner.show"\n                        class="row">\n                        <td class="column medium-10">\n                            <div class="activityfeed-item-imageholder">\n                                <react-icon-set\n                                    icons="row.allIcons"\n                                    show-error-badge="row.isFeedEventFailed"\n                                    assetService="controller.assetService"\n                                    cdnService="controller.cdnService">\n                                </icon-set>\n                            </div>\n                            <div class="activityfeed-item-description">\n                                <p class="c-paragraph-4">{{row.title}}</p>\n                                <p class="type-c1 c-caption-1 sd-truncateText">{{row.description}}</p>\n                            </div>\n                        </td>\n                        <td class="column medium-2">\n                            <div class="activityfeed-item-timesince type-c1 c-caption-1">\n                                <span>{{row.timeSince}}</span>\n                        </div>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n        <div class="activityfeed-showmore">\n            <a ng-show="model.hasMore() && !model.loadingMore" ng-click="model.loadMore()" data-event-name="ActivityFeedShowMoreClicked" href="" >{{controller.clientResources.List.ShowMore}}</a>\n            <spinner model="model.loadingMoreSpinner"></spinner>\n        <div>\n    </div>\n</div>\n<modal-dialog model="controller.modalDialog"></modal-dialog>\n'},34195:function(e,t,i){"use strict";i(33412)},34196:function(e,t,i){"use strict";i(34197),i(34206)},34197:function(e,t,i){"use strict";i(34198),i(34202)},34198:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34199);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34200);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34201),this.bindings={connectionReferences:"<",designerCreateConfigParameters:"<",onConnectionReferencesResolved:"<",onConnectionDisambiguationLoaded:"<",isUserTypeFlow:"<",hideContinueButton:"<?",hideViewPermissionsLink:"<?",hideConnectionOptions:"<?"},this.controller=o.a,this.controllerAs="connectionDisambiguationCtrl"}));r.a.component(n.a.components.connectionDisambiguation,new c)},34199:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(33327),n=i(33392),o=i(33354),a=i(33383),s=i(20107),l=i(12339),c=i(12999);function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t,i,r,n,o,s,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$element=t,this.$q=i,this.$scope=r,this.appSettings=n,this.clientResources=o,this.designerConfigService=s,this.loggingService=l,this.promiseHelperService=c,this.connectionReferences=void 0,this.designerCreateConfigParameters=void 0,this.onConnectionReferencesResolved=void 0,this.onConnectionDisambiguationLoaded=void 0,this.isUserTypeFlow=void 0,this.connectionProvider=void 0,this.isConnectionDisambiguationRendered=!1,this.connectionDisambiguationLoadingSpinner={size:a.c.Large,local:a.a.LocalHorizontal,show:!1},this.viewPermissionsDialog={show:!1,buttons:[{label:this.clientResources.Dialogs.ViewPermissions.Button.Close,action:()=>{this.viewPermissionsDialog.show=!1},primary:!0}]},this.$onInit=()=>{this.designerCreateConfigParameters&&this.designerCreateConfigParameters.designerConfig&&this.loadConnectionDisambiguation()},this.handleOnConnectionReferencesResolved=e=>{this.$scope.$applyAsync(()=>{this.onConnectionReferencesResolved&&this.onConnectionReferencesResolved(e)})},this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ConnectionDisambiguationCtrl"})}var t,i,r;return t=e,(i=[{key:"loadConnectionDisambiguation",value:function(){this.connectionDisambiguationLoadingSpinner.show=!0;var e=this.loggingService.profileStart(o.a.loadConnectionDisambiguationStart);this.$q.resolve(this.updateDesignerConfigParameters(this.designerCreateConfigParameters)).then(e=>this.designerConfigService.createDesignerConfig(e)).then(e=>this.renderConnectionDisambiguation(e)).then(()=>{this.loggingService.profileEndWithSuccess(e,o.a.loadConnectionDisambiguationEnd),this.handleOnConnectionDisambiguationLoaded()}).catch(t=>{this.loggingService.profileEnd(e,o.a.loadConnectionDisambiguationEnd,Object(n.b)(t),t),this.handleOnConnectionDisambiguationLoaded(t)}).finally(()=>{this.connectionDisambiguationLoadingSpinner.show=!1})}},{key:"updateDesignerConfigParameters",value:function(e){return e.designerConfig.designerElement=this.$element[0].querySelector(".msla-container"),e.designerConfig.connectionWizardUIConfig||(e.designerConfig.connectionWizardUIConfig={}),e.designerConfig.connectionWizardUIConfig.enableFabricStyle=!0,e.designerConfig.showViewPermissionsDialog=e=>{this.$scope.$applyAsync(()=>{this.connectionProvider=e,this.viewPermissionsDialog.show=!0})},e}},{key:"renderConnectionDisambiguation",value:function(e){var t=this.loggingService.profileStart(o.a.renderConnectionWizardStart);Object(c.a)().enableSolutionFlowSaveAsACopy&&(e.isXrmConnectionReferenceMode=this.designerCreateConfigParameters.designerConfig.isXrmConnectionReferenceMode);var i=Object(s.b)(e,{expandAllCards:!1}),r=i.initializeConnectionReferences(this.connectionReferences,Object(l.l)(this.appSettings).definitionSchemaUri).then(()=>i.render(this.handleOnConnectionReferencesResolved)),a=this.$q.defer();return this.promiseHelperService.toAngularPromise(r).then(()=>{this.isConnectionDisambiguationRendered=!0,this.loggingService.profileEndWithSuccess(t,o.a.renderConnectionWizardEnd),a.resolve()}).catch(e=>{this.loggingService.profileEnd(t,o.a.renderConnectionWizardEnd,Object(n.b)(e),e),a.reject(e)}),a.promise}},{key:"handleOnConnectionDisambiguationLoaded",value:function(e){this.onConnectionDisambiguationLoaded&&this.onConnectionDisambiguationLoaded(e)}},{key:"shouldShowHeaderMessage",get:function(){return!!(this.isConnectionDisambiguationRendered&&this.designerCreateConfigParameters&&this.designerCreateConfigParameters.designerConfig&&this.designerCreateConfigParameters.designerConfig.prefetchedData&&this.designerCreateConfigParameters.designerConfig.prefetchedData.connectionProviders&&this.designerCreateConfigParameters.designerConfig.prefetchedData.connectionProviders.some(e=>!e.hidden))}}])&&u(t.prototype,i),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();p.$inject=[r.a.services.$element,r.a.services.$q,r.a.services.$scope,r.a.services.appSettings,r.a.services.clientResources,r.a.services.designerConfig,r.a.services.logging,r.a.services.promiseHelperService]},34200:function(e,t,i){e.exports=i.p+"static/media/connectionDisambiguation.3b1302c5.less"},34201:function(e,t){e.exports='<div class="connection-disambiguation">\n    <div ng-if="connectionDisambiguationCtrl.shouldShowHeaderMessage && !connectionDisambiguationCtrl.isUserTypeFlow" class="header-message">{{connectionDisambiguationCtrl.clientResources.ConnectionDisambiguation.HeaderMessage}}</div>\n    <div ng-if="connectionDisambiguationCtrl.shouldShowHeaderMessage && connectionDisambiguationCtrl.isUserTypeFlow" class="header-message">\n      <div class="header-message-run-only-title">{{connectionDisambiguationCtrl.clientResources.ConnectionDisambiguation.HeaderMessageRunOnlyTitle}}</div>\n      <div class="header-message-run-only-description">{{connectionDisambiguationCtrl.clientResources.ConnectionDisambiguation.HeaderMessageRunOnlyDescription}}</div>\n    </div>\n    <div ng-show="connectionDisambiguationCtrl.isConnectionDisambiguationRendered"\n        class="msla-container msla-host-processsimple msla-host-flow-template"\n        ng-class="{\n            \'hide-continue-button\': connectionDisambiguationCtrl.hideContinueButton,\n            \'hide-view-permissions-link\': connectionDisambiguationCtrl.hideViewPermissionsLink,\n            \'hide-connection-options\': connectionDisambiguationCtrl.hideConnectionOptions}">\n    </div>\n    <view-permissions-dialog\n        connection-providers="[connectionDisambiguationCtrl.connectionProvider]"\n        modal-dialog="connectionDisambiguationCtrl.viewPermissionsDialog">\n    </view-permissions-dialog>\n    <spinner model="connectionDisambiguationCtrl.connectionDisambiguationLoadingSpinner"></spinner>\n</div>'},34202:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34203);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34204);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=i(34205),this.bindings={connectionProviders:"<",modalDialog:"="},this.controller=o.a,this.controllerAs="viewPermissionsDialogCtrl"}));r.a.component(n.a.components.viewPermissionsDialog,new c)},34203:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(33327);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.connectionProviders=void 0,this.modalDialog=void 0,this.hasMultiple=!1,this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ViewPermissionsDialogCtrl"})}var t,i,r;return t=e,(i=[{key:"$onChanges",value:function(e){e.connectionProviders&&e.connectionProviders.currentValue&&(this.hasMultiple=e.connectionProviders.currentValue.length>1)}}])&&n(t.prototype,i),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.$inject=[r.a.services.logging]},34204:function(e,t,i){e.exports=i.p+"static/media/viewPermissionsDialog.314c1b71.less"},34205:function(e,t){e.exports='<div class="section-view-permissions-dialog">\n    <modal-dialog\n        model="viewPermissionsDialogCtrl.modalDialog"\n        aria-label="{{ viewPermissionsDialogCtrl.hasMultiple ?\n            viewPermissionsDialogCtrl.clientResources.FlowOwners.CoauthWarningDialog.Header :\n            viewPermissionsDialogCtrl.connectionProviders[0].properties.description }}">\n        <dialog-header-content-template>\n            <div ng-if="viewPermissionsDialogCtrl.hasMultiple">\n                {{::viewPermissionsDialogCtrl.clientResources.FlowOwners.CoauthWarningDialog.Header}}\n            </div>\n            <div ng-if="!viewPermissionsDialogCtrl.hasMultiple">\n                <img class="connection-icon" ng-src="{{viewPermissionsDialogCtrl.connectionProviders[0].properties.iconUri}}" />\n                <span class="connection-display-name">{{viewPermissionsDialogCtrl.connectionProviders[0].properties.displayName}}</span>\n            </div>\n        </dialog-header-content-template>\n        <dialog-body-content-template>\n            <div ng-repeat="connectionProvider in viewPermissionsDialogCtrl.connectionProviders">\n                <div class="permission-title" ng-if="viewPermissionsDialogCtrl.hasMultiple">\n                    <img class="connection-icon" ng-src="{{connectionProvider.properties.iconUri}}" />\n                    <span class="connection-display-name">{{connectionProvider.properties.displayName}}</span>\n                </div>\n                <div>{{connectionProvider.properties.description}}</div>\n                <div class="permission-info" ng-if="connectionProvider.properties.scopes.will.length > 0">\n                    <div class="permission-header">{{::viewPermissionsDialogCtrl.clientResources.Dialogs.ViewPermissions.ConnectionScopeWill}}</div>\n                    <ul ng-repeat="item in connectionProvider.properties.scopes.will">\n                        <li class="permission-list-item">{{item}}</li>\n                    </ul>\n                </div>\n                <div class="permission-info" ng-if="connectionProvider.properties.scopes.wont.length > 0">\n                    <div class="permission-header">{{::viewPermissionsDialogCtrl.clientResources.Dialogs.ViewPermissions.ConnectionScopeWont}}</div>\n                    <ul ng-repeat="item in connectionProvider.properties.scopes.wont">\n                        <li class="permission-list-item">{{item}}</li>\n                    </ul>\n                </div>\n                <hr class="permission-divider" ng-if="!$last"/>\n            </div>\n        </dialog-body-content-template>\n    </modal-dialog>\n</div>'},34206:function(e,t,i){"use strict";i(34207)},34207:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(34208);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34211);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(34212),this.controllerAs="connectionWizardCtrl",this.bindings={redirectUrl:"@",prefetchedTemplate:"<"}}));r.a.component(n.a.components.connectionWizard,new c)},34208:function(e,t,i){"use strict";i.d(t,"a",(function(){return J}));var r=i(33279),n=i(33327),o=i(33353),a=i(33453),s=i(33396),l=i(33354),c=i(33596),u=i(33437),d=i(33597),p=i(33392),h=i(34209),m=i(33594),g=i(11806),f=i(33383),v=i(33493),b=i(34210),y=i(20799),w=i(13016),S=i(33472),C=i(20807),k=i(13009),P=i(13240),x=i(20824),A=i(14875),T=i(17209),R=i(16926),O=i(14896),D=i(20829),E=i(12345),F=i(13e3),I=i(20915),j=i(21878),N=i(17258),M=i(20892),L=i(14900),U=i(15412),B=i(33360),$=i(19997),q=i(13005),W=i(18956),z=i(18968);function H(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function V(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?H(Object(i),!0).forEach((function(t){_(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _(e,t,i){return(t=Q(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function G(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(r,n)}function K(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){G(o,r,n,a,s,"next",e)}function s(e){G(o,r,n,a,s,"throw",e)}a(void 0)}))}}function X(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Q(r.key),r)}}function Q(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var J=function(){function e(t,i,n,s,l,g,v,C,P,x,L,B,$,H,V,_,G,X,Q,J,Y,Z,ee,te,ie,re,ne,oe,ae,se,le,ce,ue,de,pe){var he=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.$scope=i,this.$window=n,this.appSettings=s,this.assetService=l,this.authenticationService=g,this.clientResources=v,this.connectorHideKeyService=C,this.designerRenderService=P,this.entitlementsService=x,this.environmentService=L,this.reactEnvironmentService=B,this.hostCommunicationService=$,this.loggingService=H,this.policiesService=V,this.promiseHelperService=_,this.sessionService=G,this.storageCacheFactory=X,this.telemetryService=Q,this.templateCreationHelper=J,this.trialDialogService=Y,this.oAuthService=Z,this.widgetUtilService=ee,this.xrmChildFlowsClient=te,this.businessAppPlatformService=ie,this.graphService=re,this.tokenService=ne,this.apiOperationService=oe,this.designerOperationsService=ae,this.designerCreateContextService=se,this.designerUserPreferenceServiceFactory=le,this.navigationService=ce,this.routeCrafter=ue,this.environmentCapabilityService=de,this.ppapiService=pe,this.prefetchedTemplate=void 0,this.messageBarType=w.c,this.cdsProvisioningStateEnum=D.a,this.$useThisTemplateButton=void 0,this.$designerElement=void 0,this.useThisTemplateButtonId="template-use-flow-button",this.template=void 0,this.redirectUrl=void 0,this.useThisTemplateOnClickHandler=void 0,this.enableCallBack=!0,this.cdsProvisioningState=void 0,this.cdsProvisioningErrorMessage=void 0,this.loadCurrentEnvironmentErrorMessage=void 0,this.aiBuilderMessage=void 0,this.aiBuilderErrorMessage=void 0,this.learnMoreLink=void 0,this.connectionWizard=void 0,this.designer=void 0,this.parametersLoading=void 0,this.connectionProvider=void 0,this.viewPermissionsDialog=void 0,this.spinner={size:f.c.Large,local:f.a.LocalHorizontal,show:!1},this.expanded=!1,this.showDesigner=!1,this.isDietView=!1,this.isSolutionMode=!1,this.errorAlert={type:o.a.None,message:"",options:{}},this.$onInit=()=>{this.promiseHelperService.toAngularPromise(this.sessionService.getUserSessionAsync()).then(()=>{this.sessionService.isAuthenticated&&this.sessionService.userConsented&&this.prefetchedTemplate&&this.getTemplate().then(e=>{this.template=e,this.isDietView=this.templateCreationHelper.shouldUseDietDesignerView(this.template),this.$designerElement=r.element(document.querySelectorAll(".msla-container"))[0],Object(O.f)(this.template)?this.hasAiBuilderAction?this.loadEnvironmentAndInitializeView():this.showTrialDialogIfRequiredAndExpandConnectionWizard():(this.expanded=!0,this.spinner.show=!0,this.$window.location.assign(this.redirectUrl))})})},this.loadEnvironmentAndInitializeView=()=>{this.spinner.show=!0,this.loadCurrentEnvironmentErrorMessage=void 0,this.aiBuilderMessage=void 0,this.aiBuilderErrorMessage=void 0,this.learnMoreLink=void 0,this.promiseHelperService.toAngularPromise(this.reactEnvironmentService.loadCurrentEnvironment().then(()=>this.initializeForCdsProvisioningView(!0)).catch(this.onLoadCurrentEnvironmentFailed))},this.onLoadCurrentEnvironmentFailed=()=>{this.$scope.$applyAsync(()=>{this.spinner.show=!1,this.loadCurrentEnvironmentErrorMessage=this.clientResources.SignUp.Error.tryAgain})},this.provisionCds=()=>{this.cdsProvisioningErrorMessage=void 0,this.promiseHelperService.toAngularPromise(this.businessAppPlatformService.provisionInstance(E.a.currentEnvironmentName).then(this.pollCdsProvisioningStateForReady).catch(this.handleCdsProvisioningCallFailure)),this.cdsProvisioningState=D.a.Provisioning},this.pollCdsProvisioningStateForReady=()=>{this.promiseHelperService.toAngularPromise(this.reactEnvironmentService.pollLoadEnvironmentForInstanceReady(E.a.currentEnvironmentName).then(()=>this.initializeForCdsProvisioningView()).catch(this.handleCdsProvisioningCallFailure))},this.handleCdsProvisioningCallFailure=e=>{this.cdsProvisioningErrorMessage=Object(p.e)(e,this.clientResources.FlowCreator.CDSProvisioning.ErrorMessage),this.initializeForCdsProvisioningView()},this.createDesignerConfig=(e,t,i)=>this.connectorHideKeyService.getVisibleHideKeys().then(r=>{var n=(t||[]).filter(e=>!Object(b.a)(e,this.urlTemplateParameters,this.loggingService)),o=this.template.properties.connectionReferences,a=Object.keys(o).map(e=>o[e].api),s={designercore:e.designercore,designerElement:this.$designerElement,environment:this.environmentService.getCurrentEnvironment(),appSettings:this.appSettings,featureFlags:this.appSettings.featureFlags,apiOperationAuthoringBehavior:Object(A.f)(i.properties.definitionSummary,this.isSolutionMode),telemetryService:this.telemetryService,oAuthService:this.oAuthService,ppapiService:this.ppapiService,connectorV2ServiceFactory:()=>new d.a(!1,this.clientResources,null,this.loggingService,n,this.graphService,this.xrmChildFlowsClient,E.a,this.tokenService,I.a,j.a,N.a,()=>F.a.user,this.isSolutionMode),operationManifestServiceFactory:()=>new c.a(this.apiOperationService,this.clientResources,E.a,null,this.loggingService,this.designerOperationsService,M.a,this.assetService,this.tokenService,this.ppapiService),getArmAccessToken:()=>Object(S.a)(this.authenticationService.getToken(this.appSettings.authResource)),getFunctionsRPAccessToken:()=>Object(S.a)(this.authenticationService.getToken(this.appSettings.functionsAuthResource)),getRuntimeAccessToken:()=>Object(S.a)(this.authenticationService.getToken(this.appSettings.apiHubsRuntimeResource)),getConsentServerAccessToken:()=>Object(S.a)(this.authenticationService.getToken(this.appSettings.consentServerAadResourceUri)),getPPAPIAccessToken:()=>Object(S.a)(this.authenticationService.getToken(this.ppapiService.getTokenAudience())),azureADServiceFactory:e=>new y.a(this.graphService,this.loggingService),prefetchedData:{connections:n,connectionProviders:this.appSettings.featureFlags.ignorePrefetchedDFApiDefinition?a.filter(e=>!e||!Object(z.b)(e.id)):a},canAddOperation:e=>new Promise(t=>{this.$scope.$applyAsync(()=>{this.policiesService.checkCanAddOperation(e).then(e=>{t(e)})})}),showViewPermissionsDialog:e=>{this.$scope.$applyAsync(()=>{this.connectionProvider=e,this.viewPermissionsDialog.show=!0})},defaultRecurrence:this.policiesService.getDefaultRecurrence(),userPreferenceServiceFactory:()=>this.designerUserPreferenceServiceFactory.createDesignerUserPreferenceService(),visibleHideKeys:r,templateName:i.name,context:this.designerCreateContextService.getDesignerCreateContext(),isSolutionFlow:this.isSolutionMode,solutionId:this.isSolutionMode?Object(W.a)():null,isXrmConnectionReferenceMode:this.isSolutionMode};return s.flowManagementServiceFactory=e=>({saveFlow:()=>Object(S.a)(this.saveDietTemplate())}),s.onFirstPartyConnectionFailureCallback=(e,t)=>Object(k.S)(e)?this.oAuthService.consentFirstPartyUriAfterMFA(t):Promise.reject(new Error(e)),s.connectionWizardUIConfig={defaultAccountDisplayName:this.sessionService.getUserInfo().displayName,initButtonText:(this.templateCreationHelper.shouldRenderAsOneClickTemplate(this.template)||Object(m.a)(this.template))&&this.clientResources.ConnectionWizard.CreateFlow,hideContinueButton:this.shouldBlockContinueNoAiBuilderCapacity},s.enableDietDesigner=this.isDietView,this.isDietView&&(s.dietViewServiceFactory=e=>({getEditInAdvancedModeLink:this.getEditInAdvancedModeLink,enableTokenPicker:!1})),s}),this.getEditInAdvancedModeLink=e=>{var t=this.redirectUrl;Object.keys(e||{}).map(i=>{var r=e[i],n=Object(h.a)(r.connection.id).connections;this.isSolutionMode&&(n=Object(q.a)(r.connection.id));var o="connection.".concat(i);t=t.concat("&".concat(o,"=").concat(n))});var i=(this.connectionWizard||this.designer).Data.Connections.getData();return this.storageCacheFactory.Create(a.a.storageCacheId).trySet(a.a.urlPath,i),t},this.onConnectionReferencesResolved=function(){var e=K((function*(e){var t,i;he.appSettings.featureFlags.enableUpsellingPremiumLicensesExperience&&he.appSettings.featureFlags.enableFlowLicensingChecker&&Object(R.i)(null===(t=he.template.properties)||void 0===t?void 0:t.definitionSummary)&&he.telemetryService.tagEvent(u.a.PremiumTemplateCreateFlowClicked,{isAccessibleByUser:yield he.policiesService.checkShouldAllowPremiumApi(Object(T.c)(null===(i=he.template.properties)||void 0===i?void 0:i.definitionSummary).map(e=>e.id))});if(he.enableCallBack){if(he.enableCallBack=!1,he.aiBuilderMessage)if(he.aiBuilderErrorMessage=void 0,(yield he.entitlementsService.safeCheckAiBuilderEntitlementsStatus())===U.a.NotAllowedExpiredTrialWithTrialRenewalForm){var r=!1;if(yield new Promise(e=>he.$scope.$applyAsync(()=>{he.trialDialogService.showAiBuilderExtendAiBuilderTrialRenewalFormDialog(t=>{r=!t,e()})})),r)return void(he.enableCallBack=!0)}else{if(!(yield he.entitlementsService.startAiBuilderTrial(void 0))){var n=yield he.entitlementsService.safeCheckAiBuilderEntitlementsStatus();if(n!==U.a.Allowed)return yield new Promise(e=>{he.$scope.$applyAsync(()=>{he.aiBuilderErrorMessage=he.getAiBuilderFailureMessage(n),e()})}),void(he.enableCallBack=!0)}}he.templateCreationHelper.shouldRenderAsOneClickTemplate(he.template)||Object(m.a)(he.template)?(he.spinner.show=!0,he.expanded=!1,he.templateCreationHelper.autoCreateFlow(he.$scope,{templateName:he.template.name,galleryName:he.template.properties.galleryName,connectionReferences:e,designTimeParameters:he.urlTemplateParameters},he.isSolutionMode).then(e=>{he.widgetUtilService.isWidgetPage()&&he.widgetUtilService.navigationAfterAutoCreationDisabled()||he.redirectToPublishPage(e)}).catch(e=>{he.redirectToDesignerPage()}).finally(()=>{he.spinner.show=!1,he.enableCallBack=!0})):(he.navigateToFlowDesigner(e),he.enableCallBack=!0)}}));return function(t){return e.apply(this,arguments)}}(),this.loggingService.logInfo("NgCtrl.constructor","Initialized Angular component.",{component:"ConnectionWizardCtrl"}),this.viewPermissionsDialog={show:!1,buttons:[{label:this.clientResources.Dialogs.ViewPermissions.Button.Close,action:()=>{this.viewPermissionsDialog.show=!1},primary:!0}]}}var t,i,n,H;return t=e,(i=[{key:"initializeForCdsProvisioningView",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$scope.$applyAsync(()=>{this.cdsProvisioningState=void 0,this.spinner.show=!1;var{isDatabaseReady:t,isDatabaseProvisioning:i,isDatabaseInUnexpectedState:r}=E.a.currentEnvironment;t?this.showTrialDialogIfRequiredAndExpandConnectionWizard():i?(this.cdsProvisioningState=D.a.Provisioning,this.pollCdsProvisioningStateForReady()):(r&&!e&&(this.cdsProvisioningErrorMessage=this.clientResources.FlowCreator.CDSProvisioning.ErrorMessage),this.cdsProvisioningState=D.a.NotProvisioned)})}},{key:"getTemplate",value:function(){return this.$q.resolve(this.prefetchedTemplate)}},{key:"hasAiBuilderAction",get:function(){return this.appSettings.featureFlags.enableAIBuilderUpsellForTemplateDetails&&Object(x.a)(this.template.properties)}},{key:"isMsaUser",get:function(){return this.sessionService.isConsumerDomain}},{key:"getAiBuilderStartTrialMessage",value:function(e){var t,i,r=this.templateCreationHelper.shouldRenderAsOneClickTemplate(this.template)||Object(m.a)(this.template)?this.clientResources.ConnectionWizard.CreateFlow:this.clientResources.UserConsent.Continue,n=null!==(t=null===(i=this.entitlementsService.getEntitlements())||void 0===i?void 0:i.aiBuilderEntitlements.numberOfDaysLeft)&&void 0!==t?t:-1;switch(e){case U.a.NotAllowedNoTrial:return Object(B.d)(this.clientResources.AiBuilder.UpsellTemplate.StartTrial,r,"");case U.a.NotAllowedExpiredTrial:case U.a.NotAllowedExpiredTrialWithTrialRenewalForm:return Object(B.d)(this.clientResources.AiBuilder.UpsellTemplate.ExtendTrial,r,"");case U.a.NotAllowedTrialCapacityLimit:case U.a.NotAllowedTrialCountLimit:return Object(B.d)(this.clientResources.AiBuilder.UpsellTemplate.NoMoreCapacity,n,"");case U.a.NotAllowedToStartTrial:return Object(B.d)(this.clientResources.AiBuilder.UpsellTemplate.NotAllowedToStartTrial,"");case U.a.Allowed:default:return}}},{key:"getAiBuilderFailureMessage",value:function(e){switch(e){case U.a.NotAllowedNoTrial:return this.clientResources.AiBuilder.StartTrial.Failure;case U.a.NotAllowedExpiredTrial:case U.a.NotAllowedExpiredTrialWithTrialRenewalForm:return this.clientResources.AiBuilder.ExtendTrial.Failure;case U.a.NotAllowedTrialCapacityLimit:case U.a.NotAllowedTrialCountLimit:case U.a.NotAllowedToStartTrial:case U.a.Allowed:default:return}}},{key:"expandConnectionWizardAsync",value:(H=K((function*(){var e=this,t=this.loggingService.profileStart(l.a.expandConnectionWizardStart,{isDietView:this.isDietView,defaultedToSolution:this.isSolutionMode});r.element(document.querySelector(".context-footer")).css("display","none"),this.expanded=!0,this.spinner.show=!0,this.showDesigner=!1,this.parametersLoading=!1,(this.isDietView?this.designerRenderService.renderDietDesigner(this.$scope,this.template,this.createDesignerConfig,this.isSolutionMode):this.designerRenderService.renderConnectionWizard(this.$scope,this.template,this.createDesignerConfig,this.onConnectionReferencesResolved,this.isSolutionMode)).then(i=>{var r=function(){var r=K((function*(){if(e.isDietView?e.designer=i:e.connectionWizard=i,e.parametersLoading||(e.spinner.show=!1),e.hasAiBuilderAction){var r=yield e.entitlementsService.safeCheckAiBuilderEntitlementsStatus();e.aiBuilderMessage=e.getAiBuilderStartTrialMessage(r),e.learnMoreLink={href:"https://go.microsoft.com/fwlink/?linkid=2101001",ariaLabel:e.clientResources.Manage.CustomApi.Create.FromAzureService.LearnMore}}e.showDesigner=!0,e.loggingService.profileEndWithSuccess(t,l.a.expandConnectionWizardEnd,{isDietView:e.isDietView,defaultedToSolution:e.isSolutionMode})}));return function(){return r.apply(this,arguments)}}();return this.promiseHelperService.toAngularPromise(r())}).catch(e=>{this.loggingService.profileEnd(t,l.a.expandConnectionWizardEnd,Object(p.b)(e),e,{isDietView:this.isDietView,defaultedToSolution:this.isSolutionMode}),this.$window.location.assign(this.redirectUrl)})})),function(){return H.apply(this,arguments)})},{key:"shouldBlockContinueNoAiBuilderCapacity",get:function(){var e=this.entitlementsService.checkAiBuilderEntitlementsStatus();return this.hasAiBuilderAction&&(e===U.a.NotAllowedTrialCountLimit||e===U.a.NotAllowedTrialCapacityLimit||e===U.a.NotAllowedToStartTrial)}},{key:"saveDietTemplate",value:function(){var e={fromTemplate:this.template.name,isDietView:this.isDietView,defaultedToSolution:this.isSolutionMode},t=this.loggingService.profileStart(l.a.saveFlowStart,e),i=!1;return this.getFlowFromDesigner().then(e=>(e.properties.displayName="",e.properties.templateName=this.template.name,this.applyTemplateOverrides(e),i=!0,this.templateCreationHelper.createFlowOrSolutionFlow(e))).then(i=>{var r=i.data;this.telemetryService.tagEvent(u.a.CreateFlowCompleted,V({status:P.d.succeeded,flowName:r.name},e)),this.loggingService.profileEndWithSuccess(t,l.a.saveFlowEnd,V({flowName:r.name},e)),this.widgetUtilService.isWidgetPage()&&(this.hostCommunicationService.triggerHostEvent(v.d.FLOW_CREATION_SUCCEEDED,V({flowUrl:Object(s.b)(r.name,this.environmentService),flowId:r.name,flowName:r.name},e)),this.widgetUtilService.widgetCloseOnFlowSaveEnabled())?this.widgetUtilService.fireWidgetCloseEvent():this.redirectToPublishPage(r.name)}).catch(r=>{if(this.loggingService.profileEnd(t,l.a.saveFlowEnd,Object(p.b)(r),r,e),this.telemetryService.tagEvent(u.a.CreateFlowCompleted,V({status:P.d.failed},e)),i)this.loggingService.logWarning("ConnectionWizardCtrl.saveDietTemplate","redirecting to designer page",e),this.$window.location.assign(this.redirectUrl);else{var n=Object(p.e)(r,this.clientResources.Common.SomethingWentWrong);this.errorAlert.type=o.a.Error,this.errorAlert.message=n}throw r})}},{key:"applyTemplateOverrides",value:function(e){if(["d8d4c6c9ba8b443eb29de93b0ae6253d","221012a4a405471ca382534402d7087a","e9ff7beaedef4aff866f4bf8494ae72d","b35474d5c24c4063988cdd932d8994b3"].indexOf(this.template.name)>-1){var t=e.properties.definition.triggers;for(var i of Object.keys(t)){var r=t[i];r.splitOn&&delete r.splitOn}}}},{key:"getRawWorkflowFromDesigner",value:function(){var e=this.$q.defer();try{e.resolve(this.designer.getWorkflow({ignoreNonCriticalErrors:!0}))}catch(t){e.reject(t)}return e.promise}},{key:"getFlowFromDesigner",value:function(){var e=this.$q.defer();return this.getRawWorkflowFromDesigner().then(t=>{var i={};return t.displayName=this.template.properties.displayName,t.connectionReferences=this.getConnectionReferences(t.connectionReferences),t.definition=Object(C.b)(t.definition),i.properties=t,e.resolve(i),e.promise}).catch(t=>(Object(k.G)(t)||this.loggingService.logError("ConnectionWizardCtrl.GetFlowFromDesigner",t),e.reject(t),e.promise))}},{key:"getConnectionReferences",value:function(e){return Object.keys(e).forEach(t=>{delete e[t].connectionId}),e}},{key:"navigateToFlowDesigner",value:function(e){this.navigationService.navigate(this.getEditInAdvancedModeLink(e))}},{key:"urlTemplateParameters",get:function(){return Object(g.c)(this.$window.location.search)}},{key:"showTrialDialogIfRequiredAndExpandConnectionWizard",value:function(){var e,t,i,r,n=this.appSettings.templatesWhitelistedForAddingAnyPremiumConnector.includes(this.template.id)&&this.widgetUtilService.isWidgetPage();this.promiseHelperService.toAngularPromise(Object($.d)(this.loggingService,null===(e=this.environmentService.getCurrentEnvironment())||void 0===e?void 0:e.hasXrmInstance,this.widgetUtilService,this.sessionService.isConsumerDomain,this.environmentService.getCurrentEnvironmentName(),this.environmentCapabilityService,null!==(t=null===(i=this.sessionService.getUserInfo())||void 0===i?void 0:i.tenantId)&&void 0!==t?t:"",null===(r=this.environmentService.getCurrentEnvironment())||void 0===r?void 0:r.xrmInstanceVersion)).then(e=>{var t,i;this.isSolutionMode=e===$.a.ShouldDefault,n||this.appSettings.featureFlags.enableUpsellingPremiumLicensesExperience&&this.appSettings.featureFlags.enableFlowLicensingChecker||!Object(R.i)(null===(t=this.template.properties)||void 0===t?void 0:t.definitionSummary)?this.expandConnectionWizardAsync():this.policiesService.checkShouldAllowPremiumApi(Object(T.c)(null===(i=this.template.properties)||void 0===i?void 0:i.definitionSummary).map(e=>e.id)).then(e=>{e?this.expandConnectionWizardAsync():this.trialDialogService.showStartFreeTrialDialog(e=>{e&&this.expandConnectionWizardAsync()})})})}},{key:"redirectToPublishPage",value:function(e){this.navigationService.navigate(Object(L.m)(this.routeCrafter,{flowName:e,solutionId:void 0,isLegacyShared:!1,showCreateSuccessAlert:!0}))}},{key:"redirectToDesignerPage",value:function(){this.template.properties.galleryName&&this.template.name?this.navigationService.navigate(Object(L.q)(this.routeCrafter,{createFromTemplateInfo:{templateName:this.template.name,gallery:this.template.properties.galleryName}})):this.navigationService.navigate(Object(L.q)(this.routeCrafter))}}])&&X(t.prototype,i),n&&X(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();J.$inject=[n.a.services.$q,n.a.services.$scope,n.a.services.$window,n.a.services.appSettings,n.a.services.assetService,n.a.services.authentication,n.a.services.clientResources,n.a.services.connectorHideKey,n.a.services.designerRenderService,n.a.services.entitlements,n.a.services.environment,n.a.services.environmentService,n.a.services.hostCommunicationService,n.a.services.logging,n.a.services.policies,n.a.services.promiseHelperService,n.a.services.session,n.a.services.storageCacheFactory,n.a.services.telemetry,n.a.services.templateCreationHelper,n.a.services.trialDialog,n.a.services.oAuthService,n.a.services.widgetUtilService,n.a.services.xrmChildFlowsClient,n.a.services.businessAppPlatformService,n.a.services.graphService,n.a.services.token,n.a.services.apiOperation,n.a.services.designerOperations,n.a.services.designerCreateContext,n.a.services.designerUserPreference,n.a.services.navigation,n.a.services.routeCrafter,n.a.services.environmentCapability,n.a.services.ppapiService]},34209:function(e,t,i){"use strict";var r=i(14902);i.d(t,"a",(function(){return r.c}))},34210:function(e,t,i){"use strict";function r(e,t,i){if(!t.filterConnection)return!1;var r={};try{var n=atob(t.filterConnection);r=JSON.parse(decodeURI(n))}catch(a){return i.logWarning("connectionWizardCtrlHelper.shouldFilterOutConnection",a),!1}var o=r[e.properties&&e.properties&&e.properties.apiId];if(o){if(e.properties.connectionParametersSet)return function(e,t){return Object.keys(t).every(i=>Object.keys(e.values||[]).every(r=>i!==r||t[i]!==e.values[r].value))}(e.properties.connectionParametersSet,o);if(e.properties.connectionParameters)return function(e,t){return Object.keys(e).every(i=>Object.keys(t).every(r=>r!==i||t[r]!==e[i]))}(e.properties.connectionParameters,o)}return!1}i.d(t,"a",(function(){return r}))},34211:function(e,t,i){e.exports=i.p+"static/media/connectionWizard.cea1e197.less"},34212:function(e,t){e.exports='<trial-dialog></trial-dialog>\n<alert model="connectionWizardCtrl.errorAlert"></alert>\n<spinner model="connectionWizardCtrl.spinner"></spinner>\n<div ng-if="!!connectionWizardCtrl.aiBuilderErrorMessage" class="ai-builder-trial-message-bar">\n    <react-text-message-bar\n        type="connectionWizardCtrl.messageBarType.error"\n        message="connectionWizardCtrl.aiBuilderErrorMessage">\n    </react-text-message-bar>\n</div>\n<section class="connection-wizard" ng-show="connectionWizardCtrl.expanded">\n    <div ng-if="!!connectionWizardCtrl.aiBuilderMessage" class="ai-builder-trial-message-bar">\n        <react-text-message-bar-with-link\n            type="connectionWizardCtrl.messageBarType.warning"\n            message="connectionWizardCtrl.aiBuilderMessage"\n            labelLink="connectionWizardCtrl.learnMoreLink">\n        </react-text-message-bar-with-link>\n    </div>\n    <div class="connection-wizard-container msla-container msla-host-flow-template"></div>\n    <view-permissions-dialog\n        connection-providers="[connectionWizardCtrl.connectionProvider]"\n        modal-dialog="connectionWizardCtrl.viewPermissionsDialog">\n    </view-permissions-dialog>\n    \x3c!-- NOTE(wifun): Have not encountered a scenario where this is needed, consent should be obtained higher up at the UserConsentGuard provider --\x3e\n    \x3c!-- <div class="consent-widget" ng-if="connectionWizardCtrl.isSessionInfoPopulated && connectionWizardCtrl.userConsentService.shouldShowIntegratedConsent()">\n        <user-consent></user-consent>\n    </div> --\x3e\n</section>\n<div ng-if="!!connectionWizardCtrl.loadCurrentEnvironmentErrorMessage" class="load-current-env-error-section">\n    <react-text-message-bar\n        type="connectionWizardCtrl.messageBarType.error"\n        message="connectionWizardCtrl.loadCurrentEnvironmentErrorMessage"></react-text-message-bar>\n    <react-button-group\n        primaryButtonText="::connectionWizardCtrl.clientResources.RpaSeleniumRecording.Modal.RetryButton"\n        onPrimaryButtonClick="connectionWizardCtrl.loadEnvironmentAndInitializeView"></react-button-group>\n</div>\n<div ng-if="!!connectionWizardCtrl.cdsProvisioningState" class="cds-provisioning-section">\n    <react-text-message-bar\n        ng-if="!!connectionWizardCtrl.cdsProvisioningErrorMessage"\n        type="connectionWizardCtrl.messageBarType.error"\n        message="connectionWizardCtrl.cdsProvisioningErrorMessage"></react-text-message-bar>\n    <react-flow-creator-cds-provisioning\n        assetService="::connectionWizardCtrl.assetService"\n        cds-provisioning-state="connectionWizardCtrl.cdsProvisioningState"\n        clientResources="::connectionWizardCtrl.clientResources"></react-flow-creator-cds-provisioning>\n    <div ng-if="!connectionWizardCtrl.isMsaUser">\n        <react-button-group\n            primaryButtonText="::connectionWizardCtrl.clientResources.UserConsent.Continue"\n            onPrimaryButtonClick="connectionWizardCtrl.provisionCds"\n            primary-button-disabled="connectionWizardCtrl.cdsProvisioningState === connectionWizardCtrl.cdsProvisioningStateEnum.Provisioning"></react-button-group>\n    </div>\n</div>\n'},34213:function(e,t,i){"use strict";i(34214)},34214:function(e,t,i){"use strict";i(34215)},34215:function(e,t,i){"use strict";var r=i(33328),n=i(33327),o=i(13144);r.a.factory(n.a.services.environmentsClient,[n.a.services.azureResourceClientFactory,n.a.services.appSettings,(e,t)=>{var i={environmentRoute:"".concat(t.processSimpleResourceProviderPath,"/environments")},r={name:"getEnvironments",method:"GET",urlPath:i.environmentRoute,params:{}},n={name:"createEnvironment",method:"POST",urlPath:i.environmentRoute,params:{}},a={name:"checkEnvironmentAccess",method:"GET",urlPath:"".concat(i.environmentRoute,"/:environmentName/checkaccess"),params:{environmentName:"@environmentName"}};return e({urlBase:Object(o.c)(t).flowRP,urlPath:i.environmentRoute,apiVersion:t.processSimpleResourceProviderApiVersionWithEnvironments,actions:[r,n,a]})}])},34216:function(e,t,i){"use strict";i(34217)},34217:function(e,t,i){"use strict";var r=i(33328),n=i(31433),o=i(33327),a=i(13144),s={resourceType:"".concat(Object(n.a)().processSimpleResourceProviderPath,"/trials")};r.a.factory(o.a.services.entitlementsClient,[o.a.services.appSettings,o.a.services.azureResourceClientFactory,(e,t)=>{var i={name:"startOrRenewTrial",method:"PUT",urlPath:"".concat(e.processSimpleResourceProviderPath,"/environments/:environmentName/trials/:trialType"),params:{environmentName:"@environmentName",trialType:"@trialType"}},r={name:"getEntitlements",method:"GET",urlPath:"".concat(e.processSimpleResourceProviderPath,"/environments/:environmentName/entitlements"),params:{environmentName:"@environmentName"}};return t({urlBase:Object(a.c)(e).flowRP,urlPath:"".concat(e.processSimpleResourceProviderPath),actions:[i,r],apiVersion:e.processSimpleResourceProviderApiVersionWithEnvironments,resourceType:s.resourceType})}])},34218:function(e,t,i){"use strict";i(33509),i(34219)},34219:function(e,t,i){"use strict";var r=i(33335),n=i(33327),o=i(33590);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i(34220);var c=s((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=o.a,this.template=i(34221),this.controllerAs="trialDialogCtrl",this.bindings={controls:"<"}}));r.a.component(n.a.components.trialDialog,new c)},34220:function(e,t,i){e.exports=i.p+"static/media/trialDialog.042b72e1.less"},34221:function(e,t){e.exports='<div class="c-dialog trial-dialog" ng-if="trialDialogCtrl.showDialog">\n    <div role="presentation" tabindex="-1" data-js-dialog-hide></div>\n    <div role="dialog" tabindex="-1" class="x-type-center">\n        <div class="trial-dialog-header">\n            <div class="trial-dialog-header-image">\n                <img ng-if="trialDialogCtrl.dialog.headerImage" cdn-src="{{trialDialogCtrl.dialog.headerImage}}" />\n                <i ng-if="trialDialogCtrl.dialog.headerIcon" class="ms-Icon ms-Icon--{{trialDialogCtrl.dialog.headerIcon}}" aria-hidden="true"></i>\n            </div>\n            <div>\n                <h3>\n                    {{trialDialogCtrl.dialog.title}}\n                </h3>\n            </div>\n            <div class="trial-dialog-content" ng-bind-html-compile="{{trialDialogCtrl.dialog.content}}"></div>\n        </div>\n        <div class="row trial-dialog-action">\n            <div class="trial-dialog-action-footer" ng-if="trialDialogCtrl.dialog.footerText" ng-show="trialDialogCtrl.appSettings.featureFlags.enablePurchaseNow" ng-bind-html="trialDialogCtrl.dialog.footerText"></div>\n            <div class="trial-dialog-action-button-group">\n                <button data-event-name="{{trialDialogCtrl.dialog.acceptButton.eventName}}"\n                        class="c-button btn btn-primary trial-dialog-button"\n                        ng-click="trialDialogCtrl.dialog.acceptButton.action()"\n                        ng-disabled="trialCtrl.startTrialInProgress"\n                        data-js-dialog-hide>\n                    {{trialDialogCtrl.dialog.acceptButton.text}}\n                </button>\n                <button ng-if="trialDialogCtrl.dialog.cancelButton"\n                        data-event-name="{{trialDialogCtrl.dialog.cancelButton.eventName}}"\n                        class="c-button trial-dialog-button"\n                        ng-click="trialDialogCtrl.dialog.cancelButton.action()"\n                        data-js-dialog-hide>\n                    {{trialDialogCtrl.dialog.cancelButton.text}}\n                </button>\n            </div>\n            <div class="trial-dialog-error" ng-if="trialDialogCtrl.dialog.errorMessage">\n                <p class="error-message">{{trialDialogCtrl.dialog.errorMessage}}</p>\n            </div>\n        </div>\n    </div>\n</div>\n<react-trial-renewal-form\n    is-modal-open="trialDialogCtrl.showTrialRenewalForm"\n    dismiss-modal="::trialDialogCtrl.dismissTrialRenewalForm"\n    extend-trial="::trialDialogCtrl.extendAiBuilderTrial"\n    clientResources="::trialDialogCtrl.clientResources"></react-trial-renewal-form>'},34222:function(e,t,i){"use strict";i(34223)},34223:function(e,t,i){"use strict";var r=i(33331),n=i(33327),o=i(12337);function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$q=t,this.isEmailOptedIn=!1,this.isCheckboxShown=!1,this.termsAndConditionsLink=Object(o.F)(),this.privacyLink=Object(o.E)()}var t,i,r;return t=e,(i=[{key:"shouldShowIntegratedConsent",value:function(){return!1}},{key:"consentIfNecessary",value:function(e){return this.$q.resolve()}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l.$inject=[n.a.services.$q],r.a.service(n.a.services.userConsent,l)},34224:function(e,t,i){"use strict";i(34225)},34225:function(e,t,i){"use strict";i(33507)},34226:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}i.d(t,"a",(function(){return o}));var o=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.loggingService=i,this.loaderFunction=r}var t,i,n;return t=e,(i=[{key:"loadDesignerScripts",value:function(){return this.loaderFunction(this.appSettings.featureFlags,this.appSettings,this.loggingService)}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/19.ad4e010d.chunk.js.map