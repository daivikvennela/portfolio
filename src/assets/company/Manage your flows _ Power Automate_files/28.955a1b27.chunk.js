/*! For license information please see 28.955a1b27.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{14688:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(12345),o=t(14689),i=t(12339),a=t(13e3),s=new o.a(Object(i.b)(),r.a,a.a)},14689:function(e,n,t){"use strict";t.d(n,"c",(function(){return O})),t.d(n,"a",(function(){return A}));var r=t(13214),o=t(11795),i=t(14690),a=t(14691),s=t(14694),p=t(11891),c=t(13144),u=t(14697),d=t(14698),l=t(12341),v=t(13180),m=t(11890),f=t(14699),h=t(12366),g=t(13186);function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach((function(n){b(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function b(e,n,t){return(n=E(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function w(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function E(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}t.d(n,"b",(function(){return g.a}));var O=new Map([[s.b.tie,"preprod"],[s.b.test,Object(l.c)()?"test":"preprod"],[s.b.preprod,"preprod"],[s.b.preview,"firstrelease"],[s.b.prod,"prod"],[s.b.gov,"gov"],[s.b.high,"high"],[s.b.dod,"dod"],[s.b.mooncake,"mooncake"],[s.b.ex,"ex"],[s.b.rx,"rx"]]),A=function(){function e(n,t,i){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=n,this.environmentStore=t,this.sessionStore=i,this.powerPlatformApiDiscovery=void 0;var{region:a}=Object(o.h)(),p=O.get(s.b[a]);this.powerPlatformApiDiscovery=new r.a(p)}var n,t,l;return n=e,(t=[{key:"getTokenAudience",value:function(){return this.powerPlatformApiDiscovery.getTokenAudience()}},{key:"isPPAPIUrl",value:function(e){return!(!this.extractPPAPIEndpoint(e.url)||e.baseUrl&&!this.extractPPAPIEndpoint(e.baseUrl))}},{key:"getEnvironmentEndpoint",value:function(){return!this.environmentStore.currentEnvironmentName||this.environmentStore.currentEnvironmentName===f.m||Object(d.a)()&&this.environmentStore.currentEnvironmentName===h.J?"":Object(i.a)(this.powerPlatformApiDiscovery.getEnvironmentEndpoint(this.environmentStore.currentEnvironmentName))}},{key:"extractPPAPIEndpoint",value:function(e){return e.indexOf(this.getEnvironmentEndpoint())>-1&&this.getEnvironmentEndpoint()?this.getEnvironmentEndpoint():e.indexOf(this.getTenantEndpoint())>-1&&this.getTenantEndpoint()?this.getTenantEndpoint():""}},{key:"getTenantEndpoint",value:function(){var e,n;return null!==(e=this.sessionStore.minimalUserInfo)&&void 0!==e&&e.tenantId?Object(i.a)(this.powerPlatformApiDiscovery.getTenantEndpoint(null===(n=this.sessionStore.minimalUserInfo)||void 0===n?void 0:n.tenantId)):""}},{key:"tryConvertPARPRequestUrl",value:function(e){var n=new URL(e),t={};return n.searchParams.forEach((e,n)=>{t[n]=e}),this.tryConvertPARPRequest(n.origin,n.pathname,t)}},{key:"tryConvertPARPRequest",value:function(e,n,t){var r=Object(c.c)(this.appSettings).powerAppsRP,o=this.getEnvironmentEndpoint(),i=this.getTenantEndpoint();if(!Object(u.a)()||!Object(p.a)(e,r)||this.extractPPAPIEndpoint(e))return{converted:!1};var s=Object(a.h)(n,a.a.concat(a.b));if(!s.converted)return{converted:!1};var d=o;if(s.ppapiNamespace===a.c.Tenant&&(d=i),!d)return{converted:!1};var l=t?P({},t):{};return s.newQueryParams&&Object.keys(s.newQueryParams).forEach(e=>{l[e]=s.newQueryParams[e]}),{converted:!0,endpoint:d,path:s.newPath,queryParams:l}}},{key:"tryConvertFlowRPRequestUrl",value:function(e){var n=new URL(e),t={};return n.searchParams.forEach((e,n)=>{t[n]=e}),this.tryConvertFlowRPRequest(n.origin,n.pathname,t)}},{key:"tryConvertFlowRPRequest",value:function(e,n,t){var r,o,i,u,d,l=Object(c.c)(this.appSettings).flowRP,f=this.getEnvironmentEndpoint(),h=this.getTenantEndpoint();if(!Object(v.a)()||!Object(m.a)(l,e)||this.extractPPAPIEndpoint(e))return{converted:!1};var g=null!==(r=null===(o=this.sessionStore.user)||void 0===o?void 0:o.isConsumerDomain)&&void 0!==r&&r,y=Object(a.g)(n,null!==(i=null===(u=this.sessionStore.minimalUserInfo)||void 0===u?void 0:u.tenantId)&&void 0!==i?i:"",null!==(d=this.environmentStore.currentEnvironmentName)&&void 0!==d?d:"");if(!y.converted)return{converted:!1};var b=f;if(y.ppapiNamespace===a.c.Tenant){if(g||Object(p.a)(this.powerPlatformApiDiscovery.clusterCategory,O.get(s.b.preview)))return{converted:!1};b=h}if(!b)return{converted:!1};var w=t?P({},t):{};return y.newQueryParams&&Object.keys(y.newQueryParams).forEach(e=>{w[e]=y.newQueryParams[e]}),{converted:!0,endpoint:b,path:y.newPath,queryParams:w}}}])&&w(n.prototype,t),l&&w(n,l),Object.defineProperty(n,"prototype",{writable:!1}),e}()},14690:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(11890);function o(e){return e?(e=e.trim(),Object(r.a)(e,"https://")||Object(r.a)(e,"http://")?e:"https://".concat(e)):e}},14691:function(e,n,t){"use strict";t.d(n,"e",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return p})),t.d(n,"h",(function(){return c})),t.d(n,"g",(function(){return d})),t.d(n,"i",(function(){return v})),t.d(n,"f",(function(){return m}));var r=t(14693),o=t(14692);t.d(n,"d",(function(){return o.a}));var i=function(e){return e.RP="pa-rp",e.PPAPI="ppapi",e.PPAPIPAUTO="ppapi-pauto",e}({}),a=function(e){return e.Environment="Environment",e.Tenant="Tenant",e.TenantIsland="TenantIsland",e.Token="Token",e}({}),s=[{from:["/providers/Microsoft.PowerApps/apps","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apps"],to:"/powerapps/apps",ppapiNamespace:a.Environment},{from:"/apps",to:"/powerapps/unifiedApps",ppapiNamespace:a.Tenant},{from:["/providers/Microsoft.PowerApps/apps/:appId","/environments/:environmentName/apps/:appId","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apps/:appId","/providers/Microsoft.PowerApps/environments/:environmentName/apps/:appId"],to:"/powerapps/apps/:appId",ppapiNamespace:a.Environment},{from:"/groups/:groupid/createEnvironment",to:"/powerapps/groups/:groupid/createEnvironment",ppapiNamespace:a.Tenant},{from:"/environments/:environmentName/saveappmodule",to:"/powerapps/saveappmodule",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apps/:appId/versions",to:"/powerapps/apps/:appId/versions",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apps/:appId/versions/:versionString",to:"/powerapps/apps/:appId/versions/:versionString",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apps/:appId/publish",to:"/powerapps/apps/:appId/publish",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apps/:appId/versions/:versionString/promote"],to:"/powerapps/apps/:appId/versions/:versionString/promote",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apps/:appId/displayName",to:"/powerapps/apps/:appId/updateDisplayName",ppapiNamespace:a.Environment,method:"POST"},{from:"/providers/Microsoft.PowerApps/apps/:appId/publishedSettings",to:"/powerapps/apps/:appId/updatePublishedSettings",ppapiNamespace:a.Environment,method:"POST"},{from:"/providers/Microsoft.PowerApps/apps/:appId/unpublishedSettings",to:"/powerapps/apps/:appId/updateUnpublishedSettings",ppapiNamespace:a.Environment,method:"POST"},{from:"/providers/Microsoft.PowerApps/environments/:environmentName/apps/:appId/makeSolutionAware",to:"/powerapps/apps/:appId/makeSolutionAware",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/environments/:environmentName/solutions/:solutionId/apps",to:"/powerapps/solutions/:solutionId/apps",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apps/:appId/acquireLease",to:"/powerapps/apps/:appId/acquireLease",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apps/:appId/releaseLease",to:"/powerapps/apps/:appId/releaseLease",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apps/:appId/permissions","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apps/:appId/permissions"],to:"/powerapps/apps/:appId/permissions",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apps/:appId/modifyPermissions","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apps/:appId/modifyPermissions"],to:"/powerapps/apps/:appId/modifyPermissions",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apps/:appId/connections","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apps/:appId/connections"],to:"/powerapps/apps/:appId/connections",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/objectIds/:objectId/appPermissions"],to:"/powerapps/objectIds/:objectId/appPermissions",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apps/:appId/createTeamsAppPackage","/environments/:environmentName/apps/:appId/createTeamsAppPackage"],to:"/powerapps/apps/:appId/createTeamsAppPackage",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/environments/:environmentName/validateAppDisplayName",to:"/powerapps/validateAppDisplayName",ppapiNamespace:a.Environment},{from:"/environments/:environmentName/organizationalApps",to:"/powerapps/modifyOrganizationAppPermissions",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apps/:appId/listPackage",to:"/powerapps/apps/:appId/listPackage",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/features",to:"/powerapps/features",ppapiNamespace:a.Tenant},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/notifications",to:"/powerapps/notifications",ppapiNamespace:a.Tenant},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/generateResourceStorage",to:"/powerapps/generateResourceStorage",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/notifications/:notificationId",to:"/powerapps/notifications/:notificationId",ppapiNamespace:a.Tenant},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/notifications/:notificationId/setLastSeen",to:"/powerapps/notifications/:notificationId/setLastSeen",ppapiNamespace:a.Tenant},{from:"/providers/Microsoft.PowerApps/globalApps",to:"/powerapps/globalApps",ppapiNamespace:a.Tenant},{from:"/curatedApps",to:"/powerapps/curatedApps",ppapiNamespace:a.Tenant},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/userSettings/:settingGroup",to:"/powerapps/userSettings/:settingGroup",ppapiNamespace:a.Tenant},{from:"/teamsPackages/:packageId/operations/:operationId/parameters",to:"/powerapps/teamsPackages/:packageId/operations/:operationId/parameters",ppapiNamespace:a.Tenant},{from:"/teamsPackages/:packageId/operations/:operationId/arguments",to:"/powerapps/teamsPackages/:packageId/operations/:operationId/arguments",ppapiNamespace:a.Tenant},{from:"/teamsPackages/:packageId/acquire",to:"/powerapps/teamsPackages/:packageId/acquire",ppapiNamespace:a.Tenant},{from:"/waitlists/:waitlistNameString/checkEligibility",to:"/powerapps/waitlists/:waitlistNameString/checkEligibility",ppapiNamespace:a.Tenant},{from:"/waitlists/:waitlistNameString/join",to:"/powerapps/waitlists/:waitlistNameString/join",ppapiNamespace:a.Tenant}],p=[{from:["/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/permissions","/providers/Microsoft.PowerApps/scopes/service/apis/:apiName/connections/:connectionId/permissions","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis/:apiName/connections/:connectionName/permissions"],to:"/connectivity/connectors/:apiName/connections/:connectionId/permissions",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/permissions/:permissionId","/providers/Microsoft.PowerApps/scopes/service/apis/:apiName/connections/:connectionId/permissions/:permissionId"],to:"/connectivity/connectors/:apiName/connections/:connectionId/permissions/:permissionId",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/modifyPermissions","/providers/Microsoft.PowerApps/scopes/service/apis/:apiName/connections/:connectionId/modifyPermissions","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis/:apiName/connections/:connectionName/modifyPermissions"],to:"/connectivity/connectors/:apiName/connections/:connectionId/modifyPermissions",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/transferConnection","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis/:apiName/connections/:connectionName/transferConnection"],to:"/connectivity/connectors/:apiName/connections/:connectionId/transferConnection",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/scopes/service/apis/:apiName/connections/:connectionId/modifyPermissionsForServicePrincipal",to:"/connectivity/connectors/:apiName/connections/:connectionId/modifyPermissionsForServicePrincipal",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/environments/:environmentName/apis/:apiName/connections/:connectionName/addAadAppToConnectionAcl","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis/:apiName/connections/:connectionName/addAadAppToConnectionAcl"],to:"/connectivity/connectors/:apiName/connections/:connectionName/addAadAppToConnectionAcl",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/environments/:environmentName/apis/:apiName/connections/:connectionName/removeAadAppToConnectionAcl","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis/:apiName/connections/:connectionName/removeAadAppToConnectionAcl"],to:"/connectivity/connectors/:apiName/connections/:connectionName/removeAadAppToConnectionAcl",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/connections","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/connections"],to:"/connectivity/connections",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apis/:apiName/connections","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis/:apiName/connections"],to:"/connectivity/connectors/:apiName/connections",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis/:apiName/connections/:connectionName"],to:"/connectivity/connectors/:apiName/connections/:connectionId",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/environments/:environmentName/apis/:apiName/connections/firstParty",to:"/connectivity/connectors/:apiName/connections/firstParty",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/getConsentLink",to:"/connectivity/connectors/:apiName/connections/:connectionId/getConsentLink",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/confirmConsentCode",to:"/connectivity/connectors/:apiName/connections/:connectionId/confirmConsentCode",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/revokeGatewayAccess",to:"/connectivity/connectors/:apiName/connections/:connectionId/revokeGatewayAccess",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/apis","/providers/Microsoft.PowerApps/scopes/admin/environments/:environmentName/apis"],to:"/connectivity/connectors",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apis/:apiName",to:"/connectivity/connectors/:apiName",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/validateApiSwaggerToWadl",to:"/connectivity/objectIds/:objectId/validateConnectorSwaggerToWadl",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/validateApiSwagger",to:"/connectivity/objectIds/:objectId/validateConnectorSwagger",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/downgradeOpenApiContract",to:"/connectivity/downgradeOpenConnectorContract",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apis/:apiName/permissions",to:"/connectivity/connectors/:apiName/permissions",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apis/:apiName/modifyPermissions",to:"/connectivity/connectors/:apiName/modifyPermissions",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/gateways","/providers/Microsoft.PowerApps/scopes/service/gateways"],to:"/connectivity/gateways",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/gateways/:gatewayId"],to:"/connectivity/gateways/:gatewayId",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/gateways/:gatewayId/listCapabilities",to:"/connectivity/gateways/:gatewayId/listCapabilities",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/gatewayClusters","/providers/Microsoft.PowerApps/scopes/service/gatewayClusters"],to:"/connectivity/gatewayClusters",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/gatewayClusters/:anchorGatewayId/status","/providers/Microsoft.PowerApps/scopes/service/gatewayClusters/:anchorGatewayId/status"],to:"/connectivity/gatewayClusters/:anchorGatewayId/status",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/gatewayClusters/:gatewayClusterId","/providers/Microsoft.PowerApps/scopes/service/gatewayClusters/:gatewayClusterId"],to:"/connectivity/gatewayClusters/:gatewayClusterId",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/gateways/:gatewayName/maxPermission","/providers/Microsoft.PowerApps/scopes/service/gateways/:gatewayName/maxPermission"],to:"/connectivity/gateways/:gatewayName/maxPermission",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/gateways/:gatewayId/permissions",to:"/connectivity/gateways/:gatewayId/permissions",ppapiNamespace:a.Environment},{from:["/providers/Microsoft.PowerApps/gateways/:gatewayId/permissions/:permissionName"],to:"/connectivity/gateways/:gatewayId/permissions/:permissionName",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/gateways/:gatewayId/modifyPermissions",to:"/connectivity/gateways/:gatewayId/modifyPermissions",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/scopes/service/environments/:environmentName/getTokenLink",to:"/connectivity/getTokenLink",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/environments/:environmentName/policyTemplates",to:"/connectivity/policyTemplates",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/apis/:apiName/connections/:connectionId/usages",to:"/powerapps/apis/:apiName/connections/:connectionId/usages",ppapiNamespace:a.Environment},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/userSettings/:settingGroup",to:"/powerapps/userSettings/:settingGroup",ppapiNamespace:a.Tenant},{from:"/providers/Microsoft.PowerApps/objectIds/:objectId/generateResourceStorage",to:"/powerapps/generateResourceStorage",ppapiNamespace:a.Environment}];function c(e,n){var t,o,i=e.replace("//","/"),s=!1,p=a.Environment;for(var c of(i=i.startsWith("/api/")?i.slice(4):i.slice(0),n)){var u=Object(r.a)(c.from,{strict:!0})(i);if(u){i=c.to,o=u.params,i=m(i,o),c.method&&(t=c.method),s=!0,p=c.ppapiNamespace;break}}return s?{converted:s,newPath:i,ppapiNamespace:p,newMethod:t,matchedParams:o,newQueryParams:{"api-version":"1"}}:{converted:s}}var u=[{from:"/powerapps/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/powerapps/",ppapiNamespace:a.Environment},{from:"/powerapps/tenants/:tenantId/(.*)",prefix:"/powerapps/",ppapiNamespace:a.Tenant},{from:"/powerapps/notifications",prefix:"/powerapps/notifications",ppapiNamespace:a.Tenant},{from:"/powerapps/notifications/(.*)",prefix:"/powerapps/notifications/",ppapiNamespace:a.Tenant},{from:"/powerapps/notifications/setStatus",prefix:"/powerapps/notifications/setStatus",ppapiNamespace:a.Tenant},{from:"/powerapps/channels/notifications/subscribe",prefix:"/powerapps/channels/notifications/subscribe",ppapiNamespace:a.Tenant},{from:"/analytics/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/analytics/",ppapiNamespace:a.Environment},{from:"/analytics/tenants/:tenantId/(.*)",prefix:"/analytics/",ppapiNamespace:a.Tenant},{from:"/appmanagement/tenants/:tenantId/(.*)",prefix:"/appmanagement/",ppapiNamespace:a.Tenant},{from:"/appmanagement/(.*)",prefix:"/appmanagement/",ppapiNamespace:a.Tenant},{from:"/connectivity/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/connectivity/",ppapiNamespace:a.Environment},{from:"/connectivity/tenants/:tenantId/(.*)",prefix:"/connectivity/",ppapiNamespace:a.TenantIsland},{from:"/ping/tenants/:tenantId/pingTenantEndpoint(.*)",prefix:"/gateway/cluster",ppapiNamespace:a.Tenant},{from:"/support/tenants/:tenantId/(.*)",prefix:"/support/",ppapiNamespace:a.Tenant},{from:"/powervirtualagents/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/powervirtualagents/",ppapiNamespace:a.Environment},{from:"/powervirtualagents/environments/:environmentName/(.*)",prefix:"/powervirtualagents/",ppapiNamespace:a.Environment},{from:"/connectivity/tenants/:tenantId/environments/:environmentName/discoveraiplugins(.*)",prefix:"/connectivity/discoveraiplugins",ppapiNamespace:a.Environment},{from:"/ping/tenants/:tenantId/environments/:environmentName/pingEnvironmentEndpoint(.*)",prefix:"/gateway/cluster",ppapiNamespace:a.Environment},{from:"/powerautomate/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/powerautomate/",ppapiNamespace:a.Environment},{from:"/powerautomate/tenants/:tenantId/(.*)",prefix:"/powerautomate/",ppapiNamespace:a.Tenant},{from:"/processmining/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/processmining/",ppapiNamespace:a.Environment},{from:"/processmining/tenants/:tenantId/(.*)",prefix:"/processmining/",ppapiNamespace:a.TenantIsland},{from:"/governance/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/governance/",ppapiNamespace:a.Environment},{from:"/governance/tenants/:tenantId/(.*)",prefix:"/governance/",ppapiNamespace:a.Tenant},{from:"/environmentmanagement/environments/:environmentName/(.*)",prefix:"/environmentmanagement/environments/:environmentName/",ppapiNamespace:a.Token},{from:"/copilotflows/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/copilotflows/",ppapiNamespace:a.Environment},{from:"/copilotflows/tenants/:tenantId/(.*)",prefix:"/copilotflows/",ppapiNamespace:a.TenantIsland},{from:"/copilotgovernance/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/copilotgovernance/",ppapiNamespace:a.Environment},{from:"/copilotgovernance/tenants/:tenantId/(.*)",prefix:"/copilotgovernance/",ppapiNamespace:a.TenantIsland},{from:"/intelligenceservice/tenants/:tenantId/environments/:environmentName/(.*)",prefix:"/intelligenceservice/",ppapiNamespace:a.Environment},{from:"/powerautomate/providers/:providerName/environments/:environmentName/(.*)",prefix:"/powerautomate/",ppapiNamespace:a.Environment}];function d(e,n,t){var r=e.replace("//","/"),o=r.includes("environments/")&&!r.endsWith("environments/")?a.Environment:a.Tenant;if(o===a.Environment&&""===t||o===a.Tenant&&""===n)return{converted:!1};var i=l("providers/",r);if(o===a.Environment){var s=l("environments/",i);"/"!==s&&(i=s)}return{converted:!0,newPath:"/powerautomate"+i,ppapiNamespace:o,newMethod:void 0,matchedParams:void 0,newQueryParams:{"api-version":"1"}}}function l(e,n){var t=n.indexOf(e),r=n.indexOf("/",t+e.length),o=n.substring(0,t);return-1!==r&&(o+=n.substring(r+1,n.length)),o}function v(e){var n,t=e.replace("//","/"),o=!1,i=a.Environment;for(var s of(t=t.slice(0),u)){var p=Object(r.a)(s.from,{strict:!0})(t);if(p){var c;t=s.ppapiNamespace===a.Token?t:s.prefix+(null!==(c=p.params[0])&&void 0!==c?c:""),n=p.params,o=!0,i=s.ppapiNamespace;break}}return o?{converted:o,newPath:t,ppapiNamespace:i,matchedParams:n}:{converted:o}}var m=(e,n)=>{if(!n)return e;var t=e.split("/");return(t=t.map(e=>{if(e.startsWith(":")){var t=e.substring(1);return n?n[t]:null}return e})).join("/")}},14692:function(e,n,t){"use strict";var r=t(13214);t.d(n,"a",(function(){return r.a}))},14694:function(e,n,t){"use strict";t.d(n,"b",(function(){return c})),t.d(n,"a",(function(){return d}));var r=t(14695),o=t(14691);function i(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function s(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}var c=function(e){return e.tie="tie",e.test="test",e.preprod="preprod",e.preview="preview",e.prod="prod",e.gov="gov",e.high="high",e.dod="dod",e.mooncake="mooncake",e.ex="ex",e.rx="rx",e}({}),u=Object.values(c),d=s((function e(n,t){var a=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.ppapiMiddlewareClientInstance=void 0,this.regionToClusterCategoryMap=new Map([]),this.apiDiscoveryFactory=e=>{var n=this.regionToClusterCategoryMap.get(e);return new o.d(n)},this.setShouldEnablePARPToPPAPIConversion=e=>{this.ppapiMiddlewareClientInstance instanceof r.a&&this.ppapiMiddlewareClientInstance.setShouldEnablePARPToPPAPIConversion(e)},this.setShouldEnablePARPToPPAPIConnectivityRoutes=e=>{this.ppapiMiddlewareClientInstance instanceof r.a&&this.ppapiMiddlewareClientInstance.setShouldEnablePARPToPPAPIConnectivityRoutes(e)},this.parpToPPAPIPreRequestHandler=e=>this.ppapiMiddlewareClientInstance.parpToPPAPIPreRequestHandler(e),this.PPAPIRequestHandler=e=>this.ppapiMiddlewareClientInstance.PPAPIRequestHandler(e),this.setPPAPICurrentEnvironmentName=e=>this.ppapiMiddlewareClientInstance.setPPAPICurrentEnvironmentName(e),this.setPPAPICurrentTenantId=e=>this.ppapiMiddlewareClientInstance.setPPAPICurrentTenantId(e),this.getAuthorizationEndpoint=e=>Promise.resolve(this.apiDiscoveryFactory(e).getTokenAudience()),this.getPPAPIAuthorizationEndpointConfiguration=()=>u.reduce((e,n)=>(e[n]=()=>this.getAuthorizationEndpoint(n),e),{}),this.getPPAPIEndpointConfiguration=()=>u.reduce((e,n)=>(e[n]=function(){var e,n=(e=function*(e){return a.ppapiMiddlewareClientInstance.getPPAPIEndpoint(e)},function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function s(e){i(a,r,o,s,p,"next",e)}function p(e){i(a,r,o,s,p,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}(),e),{}),this.ppapiMiddlewareClientInstance=n,this.regionToClusterCategoryMap=t}))},14695:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var r=t(14691);function o(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n,t){return(n=c(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}function u(e,n){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e})(e,n)}function d(e){var n=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var t,r=v(e);if(n){var o=v(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return l(this,t)}}function l(e,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&u(e,n)}(v,e);var n,t,i,s,c,l=d(v);function v(e,n,t,o,i){var a;if(function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,v),(a=l.call(this,n,t,o,i)).shouldEnablePARPToPPAPIConversion=void 0,a.shouldEnablePARPToPPAPIConnectivityRoutes=!1,a.parpToPpapiPathMap=void 0,!a.getIsPPAPIMiddlewareInitialized())throw Error("[PARPToPPAPIMiddleware] PPAPIMiddleware should be initialized first! You may call initializePPAPIMiddleware before initializePARPToPPAPIMiddleware");return a.shouldEnablePARPToPPAPIConversion=e,a.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/initializePARPToPPAPIMiddleware",{shouldEnablePARPToPPAPIConversion:a.shouldEnablePARPToPPAPIConversion}),a.parpToPpapiPathMap=r.a,a}return n=v,(t=[{key:"setShouldEnablePARPToPPAPIConversion",value:function(e){this.shouldEnablePARPToPPAPIConversion!==e&&(this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/updatePARPToPPAPIMiddleware",{from:this.shouldEnablePARPToPPAPIConversion,to:e}),this.shouldEnablePARPToPPAPIConversion=e)}},{key:"setShouldEnablePARPToPPAPIConnectivityRoutes",value:function(e){this.shouldEnablePARPToPPAPIConnectivityRoutes!==e&&(this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/updatePARPToPPAPIMiddleware",{from:this.shouldEnablePARPToPPAPIConnectivityRoutes,to:e}),this.shouldEnablePARPToPPAPIConnectivityRoutes=e,this.shouldEnablePARPToPPAPIConnectivityRoutes&&(this.parpToPpapiPathMap=this.parpToPpapiPathMap.concat(r.b)))}},{key:"tryConvertPARPRequestAndSetConfigContext",value:function(e){if((e=this.preConversion(e)).context&&e.context.ppapiContext)return e;var n=new URL(e.url);if(this.shouldSkipConversion(n))return e;var t=n.pathname,o=Object(r.h)(t,this.parpToPpapiPathMap);if(!o.converted)return this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/tryConvertPARPToPPAPI",{oriUrlPathname:t,message:"tryConvertPARPToPPAPI failed. oriUrlPathname '"+t+"' could miss mapping in PARPToPPAPIPathMap"}),e;var i=this.getEndpoint(t,o.ppapiNamespace,o.matchedParams?o.matchedParams.environmentName:null,o.matchedParams?o.matchedParams.tenantId:null),s=Object(r.f)(o.newPath,this.currentContext);return o.newQueryParams&&Object.keys(o.newQueryParams).forEach(e=>{n.searchParams.set(e,o.newQueryParams[e])}),n.hostname=r.e.PPAPI,e.url=n.href,n.pathname=s,e.context=a(a({},e.context),{},{ppapiContext:{endpoint:i,url:n.href,newMethod:o.newMethod}}),t.indexOf("/scopes/admin/")>0&&(e.headers=a(a({},e.headers),{},{"x-ms-api-context-type":"Admin"})),e}},{key:"shouldSkipConversion",value:function(e){return"true"===e.searchParams.get("skip-ppapi")}},{key:"parpToPPAPIPreRequestHandler",value:(s=function*(e){var n=new URL(e.url);return(e.service||n.hostname)===r.e.RP&&this.shouldEnablePARPToPPAPIConversion?(e=this.tryConvertPARPRequestAndSetConfigContext(e),Promise.resolve(e)):Promise.resolve(e)},c=function(){var e=this,n=arguments;return new Promise((function(t,r){var i=s.apply(e,n);function a(e){o(i,t,r,a,p,"next",e)}function p(e){o(i,t,r,a,p,"throw",e)}a(void 0)}))},function(e){return c.apply(this,arguments)})}])&&p(n.prototype,t),i&&p(n,i),Object.defineProperty(n,"prototype",{writable:!1}),v}(t(14696).a)},14696:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var r=t(14692),o=t(14691);function i(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function s(e){i(a,r,o,s,p,"next",e)}function p(e){i(a,r,o,s,p,"throw",e)}s(void 0)}))}}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n,t){return(n=d(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}var l=function(){function e(n,t,o,i){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.clusterCategory=void 0,this.logger=void 0,this.apiDiscovery=void 0,this.authorizationEndpoint=void 0,this.isPPAPIMiddlewareInitialized=!1,this.currentContext={tenantId:void 0,environmentName:void 0},this.clusterCategory=n,this.logger=t,this.apiDiscovery=new r.a(this.clusterCategory),this.authorizationEndpoint=this.apiDiscovery.getTokenAudience(),this.setPPAPICurrentEnvironmentName(o),this.setPPAPICurrentTenantId(i),this.isPPAPIMiddlewareInitialized=!0,this.logger("PPAPIMiddleware/initializePPAPIMiddleware",{curClusterCategory:this.clusterCategory})}var n,t,i,s,c;return n=e,(t=[{key:"getIsPPAPIMiddlewareInitialized",value:function(){return this.isPPAPIMiddlewareInitialized}},{key:"getPPAPIMiddlewareLogger",value:function(){return this.logger}},{key:"getAuthorizationEndpoint",value:function(){return this.authorizationEndpoint}},{key:"setPPAPICurrentEnvironmentName",value:function(e){this.currentContext.environmentName!==e&&(this.logger("PPAPIMiddleware/setPPAPICurrentEnvironmentName",{from:this.currentContext.environmentName,to:e}),this.currentContext.environmentName=e)}},{key:"setPPAPICurrentTenantId",value:function(e){this.currentContext.tenantId!==e&&(this.logger("PPAPIMiddleware/setPPAPICurrentTenantId",{from:this.currentContext.tenantId,to:e}),this.currentContext.tenantId=e)}},{key:"tryConvertPPAPIRequestAndSetConfigContext",value:function(e){if((e=this.preConversion(e)).context&&e.context.ppapiContext)return e;var n=new URL(e.url),t=n.pathname;if(n.hostname!==o.e.PPAPI&&n.hostname!==o.e.PPAPIPAUTO)return e;var r=Object(o.i)(n.pathname);if(!r.converted)throw Error("[PPAPIMiddleware] tryMapSwaggerToPPAPI failed. Swagger '"+n+"' could be invalid!");var i=this.getEndpoint(t,r.ppapiNamespace,r.matchedParams?r.matchedParams.environmentName:null,r.matchedParams?r.matchedParams.tenantId:null);if(r.ppapiNamespace===o.c.Token)n.pathname=t;else{var a=Object(o.f)(r.newPath,this.currentContext);n.pathname=a}return e.context=p(p({},e.context),{},{ppapiContext:{endpoint:i,url:n.href}}),e}},{key:"getEndpoint",value:function(e,n,t,r){var i;switch(n){case o.c.Environment:if(t&&!t.startsWith(":")){i=this.apiDiscovery.getEnvironmentEndpoint(t);break}if(!this.currentContext.environmentName)throw Error("[PPAPIMiddleware] Invalid request with currentEnvironmentId '"+this.currentContext.environmentName+"' for url oriUrlPathname '"+e+"'");i=this.apiDiscovery.getEnvironmentEndpoint(this.currentContext.environmentName);break;case o.c.Tenant:if(r&&!r.startsWith(":")){i=this.apiDiscovery.getTenantEndpoint(r);break}if(!this.currentContext.tenantId)throw Error("[PPAPIMiddleware] Invalid request with currentTenantId '"+this.currentContext.tenantId+"' for url oriUrlPathname '"+e+"'");i=this.apiDiscovery.getTenantEndpoint(this.currentContext.tenantId);break;case o.c.TenantIsland:if(r&&!r.startsWith(":")){i=this.apiDiscovery.getTenantIslandClusterEndpoint(r);break}if(!this.currentContext.tenantId)throw Error("[PPAPIMiddleware] Invalid request for Tenant Island Endpoint with currentTenantId 'il-"+this.currentContext.tenantId+"' for url oriUrlPathname '"+e+"'");i=this.apiDiscovery.getTenantIslandClusterEndpoint(this.currentContext.tenantId);break;case o.c.Token:i=this.apiDiscovery.getTokenAudience().replace(/(^\w+:|^)\/\//,"");break;default:throw Error("[PPAPIMiddleware] Invalid request: Unknown PPAPINamespace '"+n+"' for url oriUrlPathname '"+e+"'")}return i}},{key:"getPPAPIEndpoint",value:(c=a((function*(e){return e=this.tryConvertPPAPIRequestAndSetConfigContext(e),Promise.resolve(e.context.ppapiContext.endpoint)})),function(e){return c.apply(this,arguments)})},{key:"PPAPIRequestHandler",value:(s=a((function*(e){e=this.tryConvertPPAPIRequestAndSetConfigContext(e);var n=new URL(e.context.ppapiContext.url);return e.context.ppapiContext.newMethod&&(e.method=e.context.ppapiContext.newMethod),n.hostname=e.context.ppapiContext.endpoint,e.url=n.href,e.context.ppapiContext.url=void 0,Promise.resolve(e)})),function(e){return s.apply(this,arguments)})},{key:"preConversion",value:function(e){var n=new URL(e.url);if(n.hostname.endsWith(this.authorizationEndpoint.replace("https://",""))){var t=n.host;n.hostname=o.e.PPAPI;var r=e.context&&e.context.ppapiContext&&e.context.ppapiContext.url,i=e.context&&e.context.ppapiContext&&e.context.ppapiContext.newMethod;e.context=p(p({},e.context),{},{ppapiContext:{endpoint:t,url:r||n.href,newMethod:i}}),e.url=n.href}return e}}])&&u(n.prototype,t),i&&u(n,i),Object.defineProperty(n,"prototype",{writable:!1}),e}()},14697:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(11808),o=t(12999);function i(){return Object(o.a)().enablePARPToPPAPIConversion||!!Object(r.a)().PARPToPPAPIConversion.getConfig().isPARPToPPAPIConversionEnabled}},14698:function(e,n,t){"use strict";t.d(n,"b",(function(){return f})),t.d(n,"a",(function(){return h}));var r=t(11809),o=t(11896),i=t(12997),{enableEnvironmentRouting:a,enableEnvironmentRoutingInWidgets:s}=Object(i.a)(),p=Object(o.a)({teamName:r.a.PowerAutomateClientTeam,owners:["paadminandlifecycle","pdaniels"],description:"Enable environment routing in Power Automate portal and widgets",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1564145",createdOn:"03/07/2025",fallback:{enableEnvironmentRouting:!1,enableEnvironmentRoutingInWidgets:!1,unsupportedWidgetTypes:["flowDetails"]}}),{useFeatureValue:c,getFeatureValue:u}=Object(o.b)(p,"enableEnvironmentRouting"),{useFeatureValue:d,getFeatureValue:l}=Object(o.b)(p,"enableEnvironmentRoutingInWidgets"),{useFeatureValue:v,getFeatureValue:m}=Object(o.b)(p,"unsupportedWidgetTypes"),f=e=>{var n=d()&&s,t=v();return!(e&&(!n||t.includes(e)))&&(c()&&a)},h=e=>{var n=l()&&s,t=m();return!(e&&(!n||t.includes(e)))&&(u()&&a)}},14699:function(e,n,t){"use strict";var r=t(14700);t.d(n,"d",(function(){return r.a})),t.d(n,"f",(function(){return r.b})),t.d(n,"v",(function(){return r.d}));var o=t(14755);t.d(n,"a",(function(){return o.a})),t.d(n,"b",(function(){return o.b})),t.d(n,"h",(function(){return o.g})),t.d(n,"i",(function(){return o.h})),t.d(n,"m",(function(){return o.i})),t.d(n,"n",(function(){return o.j})),t.d(n,"D",(function(){return o.r}));t(14801),t(14802),t(14803),t(14760);var i=t(14762);t.d(n,"c",(function(){return i.a})),t.d(n,"e",(function(){return i.b})),t.d(n,"g",(function(){return i.c})),t.d(n,"j",(function(){return i.d})),t.d(n,"k",(function(){return i.e})),t.d(n,"l",(function(){return i.f})),t.d(n,"o",(function(){return i.g})),t.d(n,"p",(function(){return i.h})),t.d(n,"q",(function(){return i.j})),t.d(n,"r",(function(){return i.k})),t.d(n,"s",(function(){return i.l})),t.d(n,"t",(function(){return i.m})),t.d(n,"w",(function(){return i.n})),t.d(n,"x",(function(){return i.o})),t.d(n,"y",(function(){return i.q})),t.d(n,"z",(function(){return i.s})),t.d(n,"A",(function(){return i.v})),t.d(n,"B",(function(){return i.x}));t(14804);var a=t(14805);t.d(n,"J",(function(){return a.a}));t(14806);var s=t(14807);t.d(n,"E",(function(){return s.a})),t.d(n,"F",(function(){return s.b})),t.d(n,"G",(function(){return s.c})),t.d(n,"H",(function(){return s.d})),t.d(n,"I",(function(){return s.e}));t(14813);var p=t(14821);t.d(n,"u",(function(){return p.a})),t.d(n,"C",(function(){return p.b}))},14700:function(e,n,t){"use strict";t.d(n,"a",(function(){return q})),t.d(n,"d",(function(){return Q})),t.d(n,"c",(function(){return J})),t.d(n,"b",(function(){return Z}));var r=t(14701),o=t(14702),i=t(14705),a=t(12385),s=t(13073),p=t(11788),c=t(13163),u=t(14706),d=t(14713),l=t(12080),v=t(14714),m=t(11928),f=t.n(m),h=t(11766),g=t(12236),y=t(14756),P=t(14755),b=t(14757),w=t(14758),E=t(14759),O=t(14760),A=t(14795),j=t(11795);function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){N(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function N(e,n,t){return(n=T(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function C(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function k(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){C(i,r,o,a,s,"next",e)}function s(e){C(i,r,o,a,s,"throw",e)}a(void 0)}))}}function x(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function T(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}function M(e,n){return(M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e})(e,n)}function D(e){var n=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var t,r=F(e);if(n){var o=F(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return L(this,t)}}function L(e,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R,U,q=h.createContext({_environments:[],switchEnvironment:()=>null,forceRefreshEnvironmentsList:()=>null,addAndSetEnvironment:()=>null,addOrUpdateEnvironment:()=>null,refreshCurrentEnvironment:function(){return Promise.resolve(void 0)},currentEnvironmentType:r.f.Empty,currentEnvironmentLoadingStatus:p.a.NotLoaded,allEnvironmentsLoadingStatus:p.a.NotLoaded,environmentsFullyLoaded:!1}),_=!1;function z(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e===P.i||e===P.q)return"https://bap-rp/api/providers/Microsoft.BusinessAppPlatform/environments/".concat(e,"?api-version=").concat(P.a,"&$expand=properties.permissions&$filter=").concat(P.j);if(Object(y.a)()){var t=n?"&refreshCache=true":"";return"https://flow/providers/Microsoft.ProcessSimple/environments/".concat(e,"?api-version=").concat(P.a,"&$expand=properties/permissions").concat(t)}return _&&e!==P.q&&e!==P.i?"https://ppapi/powerapps/tenants/:tenantId/environments/".concat(e,"/environment?api-version=").concat(P.h,"&$expand=properties.permissions&$filter=").concat(P.j):"https://pa-rp/api/providers/Microsoft.PowerApps/environments/".concat(e,"?api-version=").concat(i.a,"&$expand=properties.permissions&$filter=").concat(P.j)}function B(e){var n=e.data;return n.type="Microsoft.PowerApps/environments",n.id="/providers/".concat(n.type,"/").concat(n.name),e}var G,W=new Promise((e,n)=>{R=e,U=n}),$=new Promise(e=>{G=e}),H=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&M(e,n)}(w,e);var n,t,r,i,a,c,m,y=D(w);function w(e){var n,t;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,w),(t=y.call(this,e)).timeoutId=void 0,t.getAllEnvironments=()=>t.state.allEnvironments,t.combineSingleAndAllEnvironments=(e,n)=>{var r=[...n||t.state.allEnvironments];if(!e)return r;var o=r.findIndex(n=>n.name===(null==e?void 0:e.name));return-1===o?r.push(e):f()(r[o],e)||(r[o]=t.takeLatestEnvironment(e,r[o])),r},t.getCurrentEnvironmentLoadingStatus=e=>{if(e)return p.a.Loaded;var{allEnvironmentsLoadingStatus:n,singleEnvironmentLoadingStatus:r}=t.state;return null!=r?r:n},t.handleLoadingError=e=>{if(e instanceof Error)throw e;var n=e&&e.response&&e.response.data&&e.response.data.message||"Unable to get environment data";throw new Error(n)},t.switchEnvironment=(e,n)=>{var r;if(e){if(Object(l.M)(P.r,{eventName:"switchEnvironment",eventData:{newPath:n,environmentName:e.name}},l.k.Shell),n){var o=J(n);if(o&&o!==P.c&&o!==e.name)throw new Error("Environment in path must match provided environment")}n&&n.indexOf(P.c)>-1&&(n=n.replace(P.c,e.name));var i="/environments/".concat(e.name,"/home"),a=(null===(r=t.props.redirectablePaths)||void 0===r?void 0:r.find(e=>Object(g.h)(t.props.location.pathname,{path:e,exact:!0})))||"";a&&!n?t.props.history.push({pathname:a.replace(P.d,e.name),search:location.search,hash:location.hash}):t.props.history.push(n||i),V(e)}},t.addAndSetEnvironment=(e,n)=>{t.setState({singleEnvironment:e,allEnvironments:t.combineSingleAndAllEnvironments(e)},()=>t.switchEnvironment(e,n))},t.addOrUpdateEnvironment=e=>{var n,r=t.applyEnvironmentPropertyFilter(e),o=[...t.state.allEnvironments],i=o.findIndex(e=>e.name===r.name);-1===i?o.push(r):o[i]=r;var a={allEnvironments:o};(null===(n=t.state.singleEnvironment)||void 0===n?void 0:n.name)===r.name&&(a.singleEnvironment=r),t.setState(a)},t.refreshCurrentEnvironment=k((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var n,r=J(t.props.location.pathname);if(!r)return;var o=null!==(n=t.props.getSingleEnvironmentUrl)&&void 0!==n?n:z,i=o(r,e),a=yield t.props.httpClient.get(i,{team:l.k.Shell}).then(B),s=t.state.singleEnvironment,p=t.takeLatestEnvironment(a.data,s),c=t.applyEnvironmentPropertyFilter(p);if(!f()(s,c)){var u=t.combineSingleAndAllEnvironments(c,t.state.allEnvironments);t.setState({allEnvironments:u,singleEnvironment:c})}return c}catch(d){throw new Error("An error occurred while refreshing the current environment: ".concat(d))}})),t.getStorageKey=()=>Object(v.SHA256)(t.getEnvironmentFilterExpression()+t.props.tid+(Object(E.a)()?"tip2":"")).toString(),t.saveToStorage=e=>{u.b.setItemAsync(t.getStorageKey(),e)},t.retrieveAndSetCachedEnvironments=()=>{u.b.getItemAsync(t.getStorageKey()).then(function(){var e=k((function*(e){null!=e&&e.length?t.state.allEnvironmentsLoadingStatus===p.a.NotLoaded&&(Object(l.M)(P.r,{eventName:"cachedEnvironmentsList",eventData:{allEnvironments:e.map(e=>e.name)}},l.k.Shell),G(),t.setState({allEnvironments:e,allEnvironmentsLoadingStatus:p.a.Loaded})):Object(l.M)(P.r,{eventName:"emptyEnvironmentCache",eventData:{singleEnvironmentLoadingStatus:t.state.singleEnvironmentLoadingStatus,allEnvironmentsLoadingStatus:t.state.allEnvironmentsLoadingStatus}},l.k.Shell)}));return function(n){return e.apply(this,arguments)}}())},t.refreshEnvironmentsList=k((function*(){yield t.retrieveAndSetEnvironmentList(!1)})),t.applyEnvironmentPropertyFilter=e=>b.a.enableUnknownPropertyFiltering?Object(d.a)(e,{includeOnlyProperties:Object(d.b)()}):e,t.state={singleEnvironment:void 0,allEnvironments:[],singleEnvironmentLoadingStatus:void 0,allEnvironmentsLoadingStatus:p.a.NotLoaded,singleEnvironmentLoadingError:void 0,allEnvironmentsLoadingError:void 0,environmentsFullyLoaded:!1,onGetEnvironmentByName:e.onGetEnvironmentByName},_=null!==(n=e.deprecateLegacyPARPForEssentialServices)&&void 0!==n&&n,t}return n=w,(t=[{key:"componentDidMount",value:(m=k((function*(){this.retrieveAndSetPreferredEnvironment(),this.retrieveAndSetCachedEnvironments(),yield this.retrieveAndSetEnvironmentList()})),function(){return m.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"componentDidUpdate",value:function(e,n){var t=Y(n.allEnvironments,e,n),r=Y(this.state.allEnvironments,this.props,this.state);if(t!==r){var i,a,s,p,c,u,d=null==t||null===(i=t.properties.cluster)||void 0===i?void 0:i.geoShortName,v=null==r||null===(a=r.properties.cluster)||void 0===a?void 0:a.geoShortName,m=d&&Object(j.d)(d),f=v&&Object(j.d)(v),h=J(this.props.location.pathname);m&&f&&m!==f&&("eu"===m||"eu"===f)&&window.location.reload(),Object(l.y)({puid:this.props.puid,oid:this.props.oid,tid:this.props.tid,geo:v}),r&&(null===(s=(p=this.props).onSwitchEnvironment)||void 0===s||s.call(p,I(I({},this.props.getPreferredEnvironmentConfigurationProps),{},{environment:r}))),!t&&r&&Object(l.M)(P.r,{eventName:"firstEnvironmentSelected",eventData:{environmentSpecified:!!h,isDefaultEnvironment:Object(o.p)(r),isDevEnvironment:Object(o.q)(r),isSharePointEnvironment:h===P.q,preferredEnvironmentProviderName:(null===(c=this.props.getPreferredEnvironment)||void 0===c?void 0:c.id)||(null===(u=Object(O.a)(this.props))||void 0===u?void 0:u.id)}},l.k.Shell),Object(l.M)(P.r,{eventName:"environmentPermissions",eventData:{currentEnvironmentName:null==r?void 0:r.name,currentEnvironmentPermissions:Object.keys((null==r?void 0:r.properties.permissions)||{}),isDefaultEnvironment:r&&Object(o.p)(r),isDevEnvironment:r&&Object(o.q)(r),isSharePointEnvironment:h===P.q,isDisabledEnvironment:r&&Object(o.r)(r),provisioningState:null==r?void 0:r.properties.provisioningState}},l.k.Shell)}V(r)}},{key:"render",value:function(){var{allEnvironmentsLoadingStatus:e,singleEnvironmentLoadingStatus:n,singleEnvironmentLoadingError:t,allEnvironmentsLoadingError:r,environmentsFullyLoaded:i}=this.state;if(t){var a,{EnvironmentNotFoundComponent:c}=this.props;return h.createElement(c,{descriptionText:null==t||null===(a=t.response)||void 0===a||null===(a=a.data)||void 0===a||null===(a=a.error)||void 0===a?void 0:a.message})}var{history:u,location:d}=this.props,l=J(this.props.location.pathname),v=this.state.allEnvironments,m=Y(v,this.props,this.state);if(Object(s.h)()||n!==p.a.Loaded||m||this.handleLoadingError(r),m){var f="";l===P.d?f=d.pathname:l!==P.q&&l!==P.i||(f=d.pathname.replace("/".concat(l),"/".concat(P.d))),f&&u.replace(I(I({},d),{},{pathname:Object(g.g)(f,{environmentId:m.name})}))}var y={_environments:v,currentEnvironment:m,switchEnvironment:this.switchEnvironment,forceRefreshEnvironmentsList:this.refreshEnvironmentsList,addAndSetEnvironment:this.addAndSetEnvironment,addOrUpdateEnvironment:this.addOrUpdateEnvironment,refreshCurrentEnvironment:this.refreshCurrentEnvironment,currentEnvironmentType:Object(o.l)(m),currentEnvironmentLoadingStatus:this.getCurrentEnvironmentLoadingStatus(m),allEnvironmentsLoadingStatus:e,environmentsFullyLoaded:i};return h.createElement(q.Provider,{value:y},h.createElement(h.Fragment,null,this.props.children))}},{key:"retrieveAndSetPreferredEnvironment",value:(c=k((function*(){this.setState({singleEnvironmentLoadingStatus:p.a.NotLoaded});try{var e=this.props.getPreferredEnvironment?this.props.getPreferredEnvironment:Object(O.a)(this.props),n=I(I({},this.props.getPreferredEnvironmentConfigurationProps),{},{envListLoadPromise:this.getInitialLoadEnvironmentsPromise,getEnvironmentsList:this.getAllEnvironments,userInfoContext:this.props,addOrUpdateEnvironment:this.addOrUpdateEnvironment});this.props.getSingleEnvironmentUrl&&(n.getSingleEnvironmentUrl=this.props.getSingleEnvironmentUrl);var t=yield e.fn(n);if(t){var r=this.applyEnvironmentPropertyFilter(t);this.setState({singleEnvironment:r,singleEnvironmentLoadingStatus:p.a.Loaded,allEnvironments:this.combineSingleAndAllEnvironments(r)})}else this.setState({singleEnvironmentLoadingStatus:p.a.Loaded})}catch(o){this.setState({singleEnvironmentLoadingStatus:p.a.Error,singleEnvironmentLoadingError:o})}})),function(){return c.apply(this,arguments)})},{key:"retrieveAndSetEnvironmentList",value:(a=k((function*(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{var n,{httpClient:t}=this.props,r=this.getEnvironmentFilterExpression(),o=new URL(this.props.deprecateLegacyPARPForEssentialServices?P.l:P.k);o.searchParams.append("$filter",r);var i=yield t.get(o.toString(),{page:!0,team:l.k.Shell}),a=i.data.value.filter(X),s=a.map(e=>this.applyEnvironmentPropertyFilter(e)),c=this.combineSingleAndAllEnvironments(this.state.singleEnvironment,s);if(null===(n=R)||void 0===n||n(),c){var u={environmentsFullyLoaded:!0,allEnvironmentsLoadingStatus:p.a.Loaded,allEnvironmentsLoadingError:void 0};f()(c,this.state.allEnvironments)?this.state.environmentsFullyLoaded||this.setState(u):(u=I(I({},u),{},{allEnvironments:c}),Object(l.M)(P.r,{eventName:"environmentsList",eventData:{allEnvironments:c.map(e=>e.name),filteredEnvironments:c.filter(e=>!a.includes(e)).map(e=>e.name)}},l.k.Shell),this.setState(u)),this.saveToStorage(c)}return c}catch(v){var d;return null===(d=U)||void 0===d||d(v),void(e&&this.setState({allEnvironmentsLoadingError:v,allEnvironmentsLoadingStatus:p.a.Error}))}})),function(){return a.apply(this,arguments)})},{key:"getEnvironmentFilterExpression",value:function(){if(b.a.disableLiteEnvFilter)return P.j;var{environmentFilterBehavior:e}=this.props;switch(e){case P.e.ShowOnlyCdsLiteEnvironments:return"".concat(P.j," and ").concat(P.p);case P.e.ShowOnlyNonCdsLiteEnvironments:default:return"".concat(P.j," and ").concat(P.o)}}},{key:"getInitialLoadEnvironmentsPromise",value:(i=k((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?W:Promise.race([$,W])})),function(){return i.apply(this,arguments)})},{key:"takeLatestEnvironment",value:function(e,n){return!n||new Date(e.properties.lastModifiedTime)>new Date(n.properties.lastModifiedTime)?e:n}}])&&x(n.prototype,t),r&&x(n,r),Object.defineProperty(n,"prototype",{writable:!1}),w}(h.Component);function Q(e,n,t){return K.apply(this,arguments)}function K(){return(K=k((function*(e,n,t){var r=(null!=t?t:z)(n),o=yield e.get(r).then(B);if(X(o.data))return o.data}))).apply(this,arguments)}function J(e){var n=Object(g.h)(e,{path:"/e/".concat(P.d)});return(n=n||Object(g.h)(e,{path:"/environment/".concat(P.d)})||Object(g.h)(e,{path:"/environments/".concat(P.d)})||Object(g.h)(e,{path:"/widget/environments/".concat(P.d)}))&&n.params&&n.params.environmentId||""}function V(e){var n,t,r,o;if(e){var i=e.properties.linkedEnvironmentMetadata,a=null!==(n=null==i?void 0:i.uniqueName)&&void 0!==n?n:"",s=null!==(t=null==i?void 0:i.resourceId)&&void 0!==t?t:"",p=null!==(r=e.properties.environmentSku)&&void 0!==r?r:"",c=null!==(o=e.properties.cluster)&&void 0!==o?o:"";Object(l.l)("EnvironmentMetadata",{envId:e.name,envSku:p,orgId:s,orgUniqueName:a,location:e.location,cluster:c})}else Object(l.l)("EnvironmentMetadata",{})}function Y(e,n,t){var r=J(n.location.pathname);if(r){var o=e.find(e=>Object(A.a)(e.name,r));if(o)return o}return t.singleEnvironment}function X(e){var n;if(null!=e&&null!==(n=e.properties)&&void 0!==n&&null!==(n=n.cluster)&&void 0!==n&&n.category){if((w.a.testEnvFilter||Object(E.a)())&&!Object(o.v)(e))return!1;if(w.a.preprodEnvFilter&&!Object(o.u)(e))return!1}return(!w.a.platformEnvFilter||!Object(o.w)(e))&&!Object(o.t)(e)}var Z=Object(g.m)(Object(c.l)(Object(a.d)(H)))},14701:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"g",(function(){return o})),t.d(n,"e",(function(){return i})),t.d(n,"f",(function(){return a})),t.d(n,"b",(function(){return s})),t.d(n,"c",(function(){return p})),t.d(n,"d",(function(){return c}));var r=function(e){return e.CommonDataService="CommonDataService",e.None="None",e}({}),o={CreatePowerApp:"CreatePowerApp",ReadEnvironment:"ReadEnvironment",GenerateResourceStorage:"GenerateResourceStorage",CreateGateway:"CreateGateway",CreateFlow:"CreateFlow",CreateCustomApi:"CreateCustomApi",AdminReadEnvironment:"AdminReadEnvironment",UpdateEnvironment:"UpdateEnvironment",DeleteEnvironment:"DeleteEnvironment",ExportEnvironmentPackage:"ExportEnvironmentPackage",SetDLPPolicy:"SetDLPPolicy",ListAnyPowerApp:"ListAnyPowerApp",ListAnyFlow:"ListAnyFlow",DeleteAnyPowerApp:"DeleteAnyPowerApp",DeleteAnyFlow:"DeleteAnyFlow",AddEnvironmentRoleAssignment:"AddEnvironmentRoleAssignment",ReadEnvironmentRoleInformation:"ReadEnvironmentRoleInformation",RemoveEnvironmentRoleAssignment:"RemoveEnvironmentRoleAssignment",ModifyDatabaseRoleAssignments:"ModifyDatabaseRoleAssignments",CreateDatabase:"CreateDatabase",ListDatabaseEntities:"ListDatabaseEntities",CreateDatabaseEntities:"CreateDatabaseEntities",UpdateDatabaseEntities:"UpdateDatabaseEntities",DeleteDatabaseEntities:"DeleteDatabaseEntities"},i={NotSpecified:"NotSpecified",Standard:"Standard",Premium:"Premium",Developer:"Developer",Basic:"Basic",Production:"Production",Sandbox:"Sandbox",Trial:"Trial",Default:"Default",Teams:"Teams",Platform:"Platform"},a=function(e){return e[e.CDS2=0]="CDS2",e[e.CDS1=1]="CDS1",e[e.Empty=2]="Empty",e}({}),s={NotSpecified:"NotSpecified",Legacy:"Legacy",DefaultTenant:"DefaultTenant",User:"User",CommonDataModelLegacy:"CommonDataModelLegacy"},p={global:"global",unitedStates:"unitedstates",southamerica:"southamerica",europe:"europe",canada:"canada",preview:"unitedstatesfirstrelease",asia:"asia",japan:"japan",australia:"australia",india:"india",unitedkingdom:"unitedkingdom",france:"france",germany:"germany",brazil:"brazil",usgov:"usgov",usgovhigh:"usgovhigh",uae:"unitedarabemirates",switzerland:"switzerland",mooncake:"china",korea:"korea",norway:"norway",southafrica:"southafrica",dod:"usdod",singapore:"singapore",sweden:"sweden"},c={NotSpecified:"NotSpecified",Succeeded:"Succeeded",Deleting:"Deleting",Deleted:"Deleted",FailedDeleting:"FailedDeleting",LinkedDatabaseProvisioning:"LinkedDatabaseProvisioning",LinkedDatabaseFailedProvisioning:"LinkedDatabaseFailedProvisioning",LinkedDatabaseFailedConfiguring:"LinkedDatabaseFailedConfiguring",LinkedDatabaseUnavailable:"LinkedDatabaseUnavailable",Creating:"Creating"}},14702:function(e,n,t){"use strict";t.d(n,"k",(function(){return a})),t.d(n,"m",(function(){return s})),t.d(n,"h",(function(){return p})),t.d(n,"d",(function(){return c})),t.d(n,"a",(function(){return u})),t.d(n,"i",(function(){return d})),t.d(n,"j",(function(){return l})),t.d(n,"l",(function(){return v})),t.d(n,"q",(function(){return m})),t.d(n,"x",(function(){return f})),t.d(n,"y",(function(){return h})),t.d(n,"z",(function(){return g})),t.d(n,"w",(function(){return y})),t.d(n,"A",(function(){return P})),t.d(n,"p",(function(){return b})),t.d(n,"r",(function(){return w})),t.d(n,"b",(function(){return E})),t.d(n,"o",(function(){return O})),t.d(n,"t",(function(){return A})),t.d(n,"s",(function(){return j})),t.d(n,"v",(function(){return S})),t.d(n,"u",(function(){return I})),t.d(n,"e",(function(){return N})),t.d(n,"c",(function(){return C})),t.d(n,"n",(function(){return k})),t.d(n,"f",(function(){return x})),t.d(n,"B",(function(){return M})),t.d(n,"C",(function(){return D})),t.d(n,"D",(function(){return R})),t.d(n,"E",(function(){return U})),t.d(n,"g",(function(){return q}));var r=t(14703),o=t.n(r),i=t(14701);t(14704);function a(e){var n=s(e);return n&&n.version}function s(e){return e&&e.properties&&e.properties.linkedEnvironmentMetadata}function p(e,n){return!!e&&!!e[n]}var c="00000001-0000-0000-0001-00000000009b",u="fd140aaf-4df4-11dd-bd17-0019b9312238";function d(e){return!!s(e)&&function(e){return!!e&&e.properties&&!!e.properties.provisioningState&&e.properties.provisioningState.toUpperCase()===i.d.Succeeded.toUpperCase()}(e)}function l(e){var n=s(e);if(n){var t=n.instanceUrl;return t?t.endsWith("/")?t:t+"/":""}return""}function v(e){return s(e)?i.f.CDS2:e&&e.properties&&e.properties.namespace?i.f.CDS1:i.f.Empty}function m(e){return e&&e.properties&&e.properties.environmentSku===i.e.Developer}function f(e){return e&&e.properties&&e.properties.environmentSku===i.e.Production}function h(e){return e&&e.properties&&e.properties.environmentSku===i.e.Sandbox}function g(e){return e&&e.properties&&e.properties.environmentSku===i.e.Teams}function y(e){return e&&e.properties&&e.properties.environmentSku===i.e.Platform}var P=e=>{var n;return(null===(n=e.properties)||void 0===n?void 0:n.environmentSku)===i.e.Trial};function b(e){return e&&e.properties&&(e.properties.isDefault||e.properties.creationType===i.b.DefaultTenant)}function w(e){return e&&e.properties&&!!e.properties.states&&!!e.properties.states.runtime&&"Disabled"===e.properties.states.runtime.id}function E(e){return e&&e.properties&&p(e.properties.permissions,i.g.CreateDatabase)}function O(e){return!!(e&&e.properties&&e.properties.provisioningState&&function(e,n){if(!e&&!n)return!0;if(!e||!n)return!1;return e.toUpperCase()===n.toUpperCase()}(e.properties.provisioningState,i.d.LinkedDatabaseProvisioning))}function A(e){return e&&e.properties&&(e.properties.provisioningState===i.d.Deleted||e.properties.provisioningState===i.d.Deleting||e.properties.provisioningState===i.d.FailedDeleting)}function j(e){return!!e&&!!e.properties&&!!e.properties.expirationTime&&Date.parse(e.properties.expirationTime)<Date.now()}function S(e){return!!e&&!!e.properties&&!!e.properties.cluster&&"Test"===e.properties.cluster.category}function I(e){return!!e&&!!e.properties&&!!e.properties.cluster&&"Preprod"===e.properties.cluster.category}function N(e){return function(e,n){var t=e.version;if(!t)return!1;return C(t,n)}(e,"9.1.0.8202")}function C(e,n){return!n||!!e&&o()(e,n)>=0}var k=e=>{var n;return(null===(n=e.properties)||void 0===n?void 0:n.databaseType)===i.a.CommonDataService},x=e=>{var n;return p(null===(n=e.properties)||void 0===n?void 0:n.permissions,i.g.AdminReadEnvironment)},T=e=>{var n;return p(null===(n=e.properties)||void 0===n?void 0:n.permissions,i.g.CreatePowerApp)},M=e=>!(!x(e)||!k(e))||!!T(e)&&(g(e)||L(e)),D=e=>T(e)&&!g(e)&&!L(e)&&(!x(e)||!k(e)),L=e=>[i.g.CreateDatabaseEntities,i.g.ListDatabaseEntities,i.g.UpdateDatabaseEntities,i.g.DeleteDatabaseEntities].every(n=>{var t;return p(null===(t=e.properties)||void 0===t?void 0:t.permissions,n)});var F=e=>{var n;return p(null===(n=e.properties)||void 0===n?void 0:n.permissions,i.g.CreateFlow)},R=e=>!(!x(e)||!k(e))||!!F(e)&&(g(e)||L(e)),U=e=>F(e)&&!g(e)&&!L(e)&&(!x(e)||!k(e)),q=e=>{var n,t;return!p(null===(n=e.properties)||void 0===n?void 0:n.permissions,i.g.CreateFlow)&&p(null===(t=e.properties)||void 0===t?void 0:t.permissions,i.g.ReadEnvironment)}},14704:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"e",(function(){return a})),t.d(n,"d",(function(){return s})),t.d(n,"f",(function(){return p})),t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return u})),t.d(n,"g",(function(){return l})),t.d(n,"h",(function(){return v}));t(14702);var r="https://cds-org/",o=function(e){return e.AllSolutions="11",e.AllPublishers="10",e.DevResources="05",e}(o||{});function i(e,n){return"".concat(e,"tools/systemcustomization/systemCustomization.aspx?pid=").concat(n)}function a(e){return i(e,o.AllSolutions)}function s(e){return i(e,o.AllPublishers)}function p(e){return i(e,o.DevResources)}function c(e){return d(e,"role")+"&forceUCI=0"}function u(e){return"".concat(d(e,"systemuser"),"&forceclassic=1")}function d(e,n){return"".concat(e,"main.aspx?pagetype=entitylist&etn=").concat(n)}function l(e,n){return"".concat(e,"main.aspx?appid=").concat(n)}var v="api/data/v9.0";"".concat(r,"api/data/v9.0/RetrieveOrganizationResources")},14705:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r="2020-06-01"},14706:function(e,n,t){"use strict";var r=t(14707);t.d(n,"b",(function(){return r.a}));var o=t(14712);t.d(n,"a",(function(){return o.a}))},14707:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var r=t(14708),o=t(14709),i=t(14710),a=t(14711);function s(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function p(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){s(i,r,o,a,p,"next",e)}function p(e){s(i,r,o,a,p,"throw",e)}a(void 0)}))}}function c(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}var d="shell-local-storage-cache:",l=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e);try{Object.keys(localStorage).forEach(e=>{e&&0===e.indexOf("shell-ps:")&&localStorage.removeItem(e)})}catch(n){}}var n,t,r,o,i,a,s;return n=e,(t=[{key:"setItemAsync",value:(s=p((function*(e,n){var t="".concat(d).concat(e),r=JSON.stringify(n);return localStorage.setItem(t,r),!0})),function(e,n){return s.apply(this,arguments)})},{key:"getItemAsync",value:(a=p((function*(e){var n="".concat(d).concat(e);try{var t=localStorage.getItem(n);return null!==t?JSON.parse(t):void 0}catch(r){return}})),function(e){return a.apply(this,arguments)})},{key:"removeItemAsync",value:(i=p((function*(e){var n="".concat(d).concat(e);return localStorage.removeItem(n),!0})),function(e){return i.apply(this,arguments)})},{key:"listKeysAsync",value:(o=p((function*(){return Promise.resolve(Object.keys(localStorage).filter(e=>e&&0===e.indexOf(d)).map(e=>e.replace(d,"")))})),function(){return o.apply(this,arguments)})},{key:"clearAll",value:function(){Object.keys(localStorage).forEach(e=>{!e||0!==e.indexOf("shell-ps:")&&0!==e.indexOf(d)||localStorage.removeItem(e)})}}])&&c(n.prototype,t),r&&c(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),v=r.a.enablePersistentStorage?new o.a(new a.a(new l)):new i.a},14708:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(12059),o=Object(r.c)({packageName:"persistentStorageProvider",features:{enablePersistentStorage:{owner:"prshrest",description:"Toggles usage of encrypted local storage for caching user data",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}}}})},14709:function(e,n,t){"use strict";function r(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function o(e){return function(){var n=this,t=arguments;return new Promise((function(o,i){var a=e.apply(n,t);function s(e){r(a,o,i,s,p,"next",e)}function p(e){r(a,o,i,s,p,"throw",e)}s(void 0)}))}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}t.d(n,"a",(function(){return p}));var p=function(){function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;i(this,e),this.internalCache=void 0,this.timeoutInMs=void 0,this.internalCache=n,this.timeoutInMs=t}var n,t,r,s,p,u,d;return n=e,(t=[{key:"setItemAsync",value:(d=o((function*(e,n){try{return yield c(this.internalCache.setItemAsync(e,n),this.timeoutInMs),!0}catch(t){return!1}})),function(e,n){return d.apply(this,arguments)})},{key:"getItemAsync",value:(u=o((function*(e){try{return yield c(this.internalCache.getItemAsync(e),this.timeoutInMs)}catch(n){return}})),function(e){return u.apply(this,arguments)})},{key:"removeItemAsync",value:(p=o((function*(e){try{return yield c(this.internalCache.removeItemAsync(e),this.timeoutInMs),!0}catch(n){return!1}})),function(e){return p.apply(this,arguments)})},{key:"listKeysAsync",value:(s=o((function*(){try{return yield c(this.internalCache.listKeysAsync(),this.timeoutInMs)}catch(e){return[]}})),function(){return s.apply(this,arguments)})}])&&a(n.prototype,t),r&&a(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function c(e,n){var t=new Promise((e,t)=>{var r=setTimeout(()=>{clearTimeout(r),t(new Error("Timed out in ".concat(n," ms.")))},n)});return Promise.race([e,t])}},14710:function(e,n,t){"use strict";function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}t.d(n,"a",(function(){return i}));var i=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t,o;return n=e,(t=[{key:"setItemAsync",value:function(e,n){return Promise.resolve(!1)}},{key:"getItemAsync",value:function(e){return Promise.resolve(void 0)}},{key:"removeItemAsync",value:function(e){return Promise.resolve(!1)}},{key:"listKeysAsync",value:function(){return Promise.resolve([])}}])&&r(n.prototype,t),o&&r(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}()},14711:function(e,n,t){"use strict";t.d(n,"a",(function(){return p}));var r=t(13073);function o(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function i(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function s(e){o(a,r,i,s,p,"next",e)}function p(e){o(a,r,i,s,p,"throw",e)}s(void 0)}))}}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}var p=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.internalCache=void 0,this.internalCache=n}var n,t,r,o,s,p,d;return n=e,(t=[{key:"setItemAsync",value:(d=i((function*(e,n){var t=u(e);return this.internalCache.setItemAsync(t,n)})),function(e,n){return d.apply(this,arguments)})},{key:"getItemAsync",value:(p=i((function*(e){var n=u(e);return this.internalCache.getItemAsync(n)})),function(e){return p.apply(this,arguments)})},{key:"removeItemAsync",value:(s=i((function*(e){var n=u(e);return this.internalCache.removeItemAsync(n)})),function(e){return s.apply(this,arguments)})},{key:"listKeysAsync",value:(o=i((function*(){var e=c(),n=yield this.internalCache.listKeysAsync();return e?n.filter(n=>0===n.indexOf("".concat(e,":"))).map(n=>n.replace("".concat(e,":"),"")):n})),function(){return o.apply(this,arguments)})}])&&a(n.prototype,t),r&&a(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function c(){return Object(r.g)()}function u(e){var n=c();return n?"".concat(n,":").concat(e):e}},14712:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var r=t(13209),o=t.n(r),i=t(14708),a=t(14709),s=t(14710),p=t(14711);function c(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))}}function d(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}var v=function(){function e(n,t){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.localforageInstance=void 0,this.localforageInstance=o.a.createInstance({name:t||"shell-ps:",storeName:n})}var n,t,r,i,a,s,p;return n=e,(t=[{key:"setItemAsync",value:(p=u((function*(e,n){return yield this.localforageInstance.setItem(e,n),!0})),function(e,n){return p.apply(this,arguments)})},{key:"getItemAsync",value:(s=u((function*(e){var n=yield this.localforageInstance.getItem(e);return null===n?void 0:n})),function(e){return s.apply(this,arguments)})},{key:"removeItemAsync",value:(a=u((function*(e){return yield this.localforageInstance.removeItem(e),!0})),function(e){return a.apply(this,arguments)})},{key:"listKeysAsync",value:(i=u((function*(){return this.localforageInstance.keys()})),function(){return i.apply(this,arguments)})}])&&d(n.prototype,t),r&&d(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function m(e,n){return i.a.enablePersistentStorage?new a.a(new p.a(new v(e,n))):new s.a}},14713:function(e,n,t){"use strict";t.d(n,"a",(function(){return g})),t.d(n,"b",(function(){return y}));var r=t(12080),o=t(14714),i=t(14751),a=t.n(i),s=t(14752),p=t.n(s),c=t(14754),u=t.n(c),d=t(11993),l=t.n(d),v=t(12067),m=t.n(v),f=t(14755),h=new Set;function g(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{includeOnlyProperties:[]},{includeOnlyProperties:t}=n,i=a()(e);if(t&&t.length>0){var s=l()(i.properties),c=[],d={};t.forEach(e=>{var n=u()(i.properties,e);if(void 0!==n){m()(d,e,n);var t=e.split(".")[0];c.includes(t)||c.push(t)}}),i.properties=d;var v=p()(s,c);if(v.length>0){var g=Object(o.SHA256)("".concat(e.name,"-").concat(e.id,"-").concat(s.sort().join(","))).toString();h.has(g)||(h.add(g),Object(r.M)(f.r,{eventName:"environmentPropertiesFiltered",eventData:{environmentName:e.name,originalPropertyCount:s.length,filteredPropertyCount:c.length,removedProperties:v}},r.k.Shell))}}return i}function y(){return["displayName","azureRegionHint","provisioningState","creationType","isDefault","environmentSku","environmentType","expirationTime","maxAllowedExpirationTime","createdBy","usedBy","createdTime","lastModifiedTime","lastModifiedBy","linkedEnvironmentMetadata","namespace","provisioningDetails","cdsMigrationDetails","runtimeEndpoints","permissions","updateCadence","connectedGroups","states","ongoingOperation","capacity","clientUris","databaseType","cluster","governanceConfiguration","trialScenarioType","copilotPolicies","bingChatEnabled","enableAnalyticsForMakers","copilotAuth","m365Enabled","scenarioName"]}},14716:function(e,n){},14755:function(e,n,t){"use strict";t.d(n,"e",(function(){return i})),t.d(n,"d",(function(){return a})),t.d(n,"c",(function(){return s})),t.d(n,"r",(function(){return p})),t.d(n,"a",(function(){return c})),t.d(n,"h",(function(){return u})),t.d(n,"k",(function(){return d})),t.d(n,"l",(function(){return l})),t.d(n,"m",(function(){return v})),t.d(n,"n",(function(){return m})),t.d(n,"i",(function(){return f})),t.d(n,"q",(function(){return h})),t.d(n,"j",(function(){return g})),t.d(n,"o",(function(){return y})),t.d(n,"p",(function(){return P})),t.d(n,"g",(function(){return b})),t.d(n,"f",(function(){return w})),t.d(n,"b",(function(){return E}));var r=t(14705),o=function(e){return e.CDSLite="CDSLite",e.Standard="Standard",e}({}),i=function(e){return e[e.ShowOnlyCdsLiteEnvironments=0]="ShowOnlyCdsLiteEnvironments",e[e.ShowOnlyNonCdsLiteEnvironments=1]="ShowOnlyNonCdsLiteEnvironments",e}({}),a=(o.Standard,o.CDSLite,":environmentId"),s=":environmentName",p="powerapps-environment",c="2020-06-01",u="1",d="https://pa-rp/api/providers/Microsoft.PowerApps/environments?$expand=properties.permissions&api-version=".concat(r.a,"&$top=").concat(200),l="https://ppapi/powerapps/tenants/:tenantid/environments?$expand=properties.permissions&api-version=".concat(u,"&$top=").concat(200),v="https://pa-rp/api/providers/Microsoft.PowerApps/environments?$expand=properties.permissions,properties.capacity&api-version=".concat(r.a,"&$top=").concat(200),m="https://ppapi/powerapps/tenants/:tenantid/environments?$expand=properties.permissions,properties.capacity&api-version=".concat(u,"&$top=").concat(200),f="~default",h="~sharepointform",g="minimumAppPermission eq 'CanEdit'",y="properties.environmentSku ne 'Teams'",P="properties/connectedGroups/any(group:group/resources/any(resource:resource/type eq 'Team'))",b=3e5,w=36e5,E="https://bap-rp/providers/Microsoft.BusinessAppPlatform/environments"},14756:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(13073),o=t(12973),i=()=>!Object(r.h)()&&Object(o.f)()&&(!Object(o.d)()||Object(o.d)()===o.a.PowerAutomate)},14757:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(12059),o=Object(r.c)({packageName:"powerplatform",features:{disableLiteEnvFilter:{owner:"xiaoxhua",createdDate:"06/17/2020",description:"Disable Lite environment filter",enabledFor:{}},enableOakdaleEnforcementMessaging:{owner:"nshah",description:"Enables enforcement warnings/errors when DfT environments approach/exceed their capacity limits",createdDate:"01/25/2021",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!1}},enableRoutingToDataverseEnvironment:{owner:"sergioe,jacalhou",description:"Enables routing user to a dataverse environment instead of default environment",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableUnknownPropertyFiltering:{owner:"jacalhou",description:"Enables filtering of unknown properties in environment objects",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0}}}})},14758:function(e,n,t){"use strict";var r=t(12059);n.a=Object(r.d)({packageName:"powerplatform",settings:{testEnvFilter:{description:"Filter to only cluster category test environments",allowOverrides:!0,values:{default:!1,test:!1}},preprodEnvFilter:{description:"Filter to only cluster category preprod environments",allowOverrides:!0,values:{default:!1,preprod:!0}},platformEnvFilter:{description:"Filter to exclude Platform environments from the environment provider",allowOverrides:!0,values:{default:!0}}}})},14759:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(12973),o=t(11795),i=t(13073),a=t(12059),s=(Object(a.c)({packageName:"powerappsSharedGates",features:{cdsPortalHostEnableAnalyticsActions:{owner:"netarey",description:"Enables command bar button and entity menu action for enabling analytics",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},cdsPortalHostUseTestCDNForExcel:{owner:"kucarpen",description:"When generating Excel workbooks via CDS, uses the test CDN instead of official Office Store",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},cdsPortalHostUseCdsForExcel:{owner:"kucarpen",description:"When generating Excel workbooks, attempt to use CDS if the version supports it",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}}}}),u("powerappsSharedFeatureGates.forceTip2InTest")),p=u("powerappsSharedFeatureGates.forceTip2InTestInWidgetMode");function c(){var e;if("test"!==Object(o.h)().region)return!1;if(Object(r.f)()){if(p.isDefined)return p.value}else if(s.isDefined)return s.value;var n=null===(e=window._ppux)||void 0===e?void 0:e.appName,t="make-powerapps-com"===n||"admin-powerplatform-microsoft-com"===n,a="make-powerapps-com"===n;return Object(r.f)()?a&&Object(i.h)():t}function u(e){var n,t=new URLSearchParams(null===(n=window)||void 0===n||null===(n=n.location)||void 0===n?void 0:n.search),r=null==t?void 0:t.get(e);return{isDefined:!!r,value:"true"===r}}},14760:function(e,n,t){"use strict";t(14761),t(14792);var r=t(14793);t.d(n,"a",(function(){return r.a}));t(14794),t(14796),t(14799),t(14798),t(14797)},14761:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var r=t(12080),o=t(14755),i=t(14762),a=t(14763),s=t(14764),p=t(14783),c=t(12246),u=t(13956),d=t(14784);function l(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function v(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)}))}}var m={id:"getDevEnvironment",fn:function(e){return f.apply(this,arguments)}};function f(){return(f=v((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,userInfoContext:s,previousPreferredEnvironmentProvidersPromise:p}=e,c=g("EnvironmentPicker"),d=Object(r.N)(o.r,"preferredEnvironment/getDevEnvironment",{},r.k.Shell);if(window.location.search.includes("offer=dev")){var l=!1;try{var v=(yield n(!0).then(()=>t())).find(e=>Object(i.q)(e));if(!a.a.provisionDevEnvironmentWithoutEnrollmentCall||v)return d.complete({environmentFound:!!v}),v;if(void 0!==p?yield p:void 0)return void d.complete({skipped:!0,environmentFound:!1,previousProviderUsed:!0});l=!0,d.progress({message:"Creating developer environment"});var m=(yield c)("jitEnvironment.environmentName"),f=Object(u.a)("jitEnvironment.environmentName"!==m?m:"{0}",s.name);return v=yield h(f,e),d.complete({environmentFound:!!v,provisioned:!0}),v}catch(y){if(d.failure(y),l)throw y;return}}else d.complete({skipped:!0,environmentFound:!1})}))).apply(this,arguments)}var h=function(){var e=v((function*(e,n){var{addOrUpdateEnvironment:t}=n,i=Object(r.G)(o.r,"preferredEnvironment/getDevEnvironmentProvisioning",{},r.k.Shell),a=yield Object(s.a)(e,"Developer");return Object(p.a)({environment:a,templates:["D365_CDSSampleApp"]}).then(e=>{i.progress({message:"Successfully requested database attachment"}),Object(d.a)(e,t,i,void 0,0).then(()=>{i.complete({message:"Successfully attached database to environment"})}).catch(()=>{})}).catch(e=>{i.failure(Object(r.p)({message:"Failed to request attach database to environment"},e))}),i.progress({message:"Successfully created developer environment"}),a}));return function(n,t){return e.apply(this,arguments)}}(),g=function(){var e=v((function*(e){return yield Promise.race([Object(c.j)(e),new Promise(e=>setTimeout(e,2e3))]),Object(c.e)(e)}));return function(n){return e.apply(this,arguments)}}()},14762:function(e,n,t){"use strict";var r=t(14701);t.d(n,"b",(function(){return r.c})),t.d(n,"c",(function(){return r.e})),t.d(n,"l",(function(){return r.g}));var o=t(14702);t.d(n,"a",(function(){return o.a})),t.d(n,"e",(function(){return o.b})),t.d(n,"f",(function(){return o.d})),t.d(n,"g",(function(){return o.e})),t.d(n,"h",(function(){return o.f})),t.d(n,"i",(function(){return o.g})),t.d(n,"j",(function(){return o.h})),t.d(n,"k",(function(){return o.i})),t.d(n,"m",(function(){return o.j})),t.d(n,"n",(function(){return o.n})),t.d(n,"o",(function(){return o.o})),t.d(n,"p",(function(){return o.p})),t.d(n,"q",(function(){return o.q})),t.d(n,"r",(function(){return o.s})),t.d(n,"s",(function(){return o.w})),t.d(n,"t",(function(){return o.x})),t.d(n,"u",(function(){return o.y})),t.d(n,"v",(function(){return o.z})),t.d(n,"w",(function(){return o.A})),t.d(n,"x",(function(){return o.B})),t.d(n,"y",(function(){return o.C})),t.d(n,"z",(function(){return o.D})),t.d(n,"A",(function(){return o.E}));var i=t(11788);t.d(n,"d",(function(){return i.a}))},14763:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(12059),o=Object(r.c)({packageName:"powerappsFeatureGates",features:{deprecateLegacyPARP:{owner:"xiaoxhua",description:"Deprecate legacy powerapps RP. It enables converting pa-rp api to ppapi in make.powerapps.com, it could also switch some consumers to use ppapi instead of the legacy powerapps-rp",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},deprecateLegacyPARPForPinAppToChannels:{owner:"jennietu",description:"Deprecate legacy powerapps RP for critical services. This is separate flag so we can control migration separately for pinAppToChannels calls.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},deprecateLegacyPARPForEssentialServices:{owner:"jacalhou",description:"Deprecate legacy powerapps RP for critical services. This is separate flag so we can control migration separately for essential calls.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enableNonVersionedGraphqlEndpoint:{owner:"vpareddy",description:"Enables non versioned graphql endpoints",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableGeoGraphqlEndpoint:{owner:"vpareddy",description:"Enables geo based graphql endpoints",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},showRepublishAppsMessageBar:{owner:"sbakli",description:"Shows republish apps message bar on apps list",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableModernTableModal:{owner:"mirestom",description:"Enable the modern table wizard modal",createdDate:"08/16/2023",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0}},provisionDevEnvironmentWithoutEnrollmentCall:{owner:"jacalhou",description:"If enabled, dev environments will not be provisioned during enrollment. Disabled currently in environments where developer plan signup is not supported currently.",createdDate:"07/11/2023",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1}},enableCanvasAppsInSolutionsByDefault:{owner:"suskumar",description:"Enable the creation of canvas apps in default solution context by default.",createdDate:"03/02/2022",enabledFor:{test:!0,preview:!0,preprod:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1}},enableDataWorkspace:{owner:"ellev",description:"Enables the Data workspace experience in Maker portal",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1}},showAppModuleSampleApps:{owner:"adamsiv",createdDate:"08/14/2024",description:"Displays the AppModule sample apps",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableCanvasAppShareDialog:{owner:"luzhon",createdDate:"09/30/2024",description:"Use new canvas app simplified share dialog",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enableCanvasAppShareDialogM2:{owner:"rayhong",createdDate:"10/16/2024",description:"Enables M2 features for canvas app simplified share dialog",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableMonitoringHubForCanvasApps:{owner:"shchhab",description:"Enables monitoring hub for canvas apps.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enablePlanDesignerRegistration:{owner:"PAStudioAuthEx",description:"Enables the registration logic for the plan designer in the maker portal.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableCreateFromYaml:{owner:"PAStudioAuthEx",description:"Enable create from YAML",createdDate:"09/25/2024",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1}},enableRequestGenerativeLayoutYaml:{owner:"PAStudioAuthEx",description:"Enable request generative layout YAML",createdDate:"09/25/2024",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1}},enableChatbotsPageInMakerPortal:{owner:"darrmar",description:"Controls whether EITHER the Chatbots or Agents page is available from Maker Portal entry points including left nav and Create page.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableNewAgentsPageInMakerPortal:{owner:"hesias",description:"Replaces Chatbots with Agents in Maker Portal if enableChatbotsPageInMakerPortal gate is enabled.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enableAIHubPageInMakerPortal:{owner:"darrmar",createdDate:"04/02/2025",description:"Controls availability of entry points to AI Hub, including from the Maker Portal left nav and Create page.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableWebsitesPageInMakerPortal:{owner:"darrmar",createdDate:"04/02/2025",description:"Controls availability of entry points to Websites page, including from the Maker Portal left nav and Create page.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!1,rx:!1}},enablePlanDesignerPrompt:{owner:"PAStudioAuthEx",description:"Enable plan designer prompt from maker portal",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableAppGenRoute:{owner:"PAStudioAuthEx",description:"Enables using app gen for canvas app artifact creation",createdDate:"10/09/2024",enabledFor:{test:!1}},enablePARPV2Notifications:{owner:"sbonala",description:"fallback for ECS shutoff switch for NotificationsPanelV2",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableMonitoringHubForModelDrivenApps:{owner:"paalm",description:"Enables monitoring hub for model-driven apps.",createdOn:"10/17/24",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0}},enableReactImportApp:{owner:"paauthoringfxeng",description:"Enables the new react Import app experience.",createdOn:"10/20/2024",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0}},enableReactExportApp:{owner:"paauthoringfxeng",description:"Enables the new react Export app experience.",createdOn:"10/20/2024",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0}},enableOcvNps:{owner:"xiaoxhua",description:"Enables using floodgate 2.0 to show nps dialog and save feedback data to ocv (used as kill switch to disable for fallback purpose)",createdDate:"03/13/2025",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0}},enableOcvNpsInPhases:{owner:"xiaoxhua",description:"Enables using floodgate 2.0 to show nps dialog and save feedback data to ocv in phases.(used for phased rollout plan)",createdDate:"03/13/2025",enabledFor:{}},enableOcvNpsForMSTenant:{owner:"xiaoxhua",description:"Enable OCV NPS for Microsoft internal users",createdDate:"03/13/2025",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0}},isAiBuilderMonitoringEnabled:{owner:"erellermo",description:"Enables the use of the new Ai Builder Monitoring table",createdDate:"03/31/2025",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enablePlanSharing:{owner:"dennyho",description:"Enables the sharing of plans",createdDate:"04/07/2025",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableDWEligibility:{owner:"aleyepez",createdDate:"04/16/2025",description:"Enable Data Workspace eligibility check based on privileges",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableDocumentProcessorTile:{owner:"yifeifang",description:"Enables the Document Processing Agent tile for navigation to agent installation on Copilot Studio.",createdOn:"04/24/2025",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enablePlanGenGA:{owner:"hannkim",description:"Enable PlanGen GA",createdDate:"04/24/2025",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0}},enablePrivilegeCheckForPlans:{owner:"hannkim",description:"Check PlanGen eligibility using privileges",createdDate:"05/02/2025",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1}},enableOneWorkspace:{owner:"jacalhou",description:"Enables entry points to OneWorkspace in Maker Portal",createdDate:"05/06/2025",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1}},allowOneWorkspaceTestData:{owner:"jacalhou",description:"Enables test data for OneWorkspace in Maker Portal",createdDate:"05/06/2025",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1}}}})},14764:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));t(12385),t(11766),t(14767);var r=t(14765),o=t(12080),i=t(13161),a=(t(12083),t(12247),t(14766),t(13956),t(14755));function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n,t){var r;return(n="symbol"==typeof(r=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"))?r:String(r))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)}))}}var l=function(){var e=d((function*(e,n,t){try{var s=p(p({},t&&{location:t}),{},{properties:{displayName:e,environmentSku:n}}),c="".concat(r.a,"?api-version=").concat(a.a),u=yield i.f.post(c,s).catch(e=>{var n,t=null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n||null===(n=n.error)||void 0===n?void 0:n.message;throw Object(o.L)(r.f,{eventName:r.d},t,o.k.Shell),e});if(u)return Object(o.M)(r.f,{eventName:r.b},o.k.Shell),u.data;throw new Error("Create environment api call response is null")}catch(d){throw Object(o.L)(r.f,{eventName:r.c},d,o.k.Shell),d}}));return function(n,t,r){return e.apply(this,arguments)}}()},14765:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"f",(function(){return o})),t.d(n,"e",(function(){return i})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return s})),t.d(n,"d",(function(){return p}));var r="https://bap-rp/providers/Microsoft.BusinessAppPlatform/environments",o="JITEnvironmentScope",i="JITCreateEnvironmentScenario",a="JITCreateEnvironment",s="JITCreateEnvironmentFailed",p="JITCreateEnvironmentFailedMessage"},14766:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(11766),o=t(14699);function i(){var{addAndSetEnvironment:e}=r.useContext(o.d);return{switchEnvironment:e}}},14783:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(13161),o=(t(12080),t(11766),t(14767),t(14699));t(14702);function i(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function s(e){i(a,r,o,s,p,"next",e)}function p(e){i(a,r,o,s,p,"throw",e)}s(void 0)}))}}var s=function(){var e=a((function*(e){var{environment:n,languageId:t,currencyCode:i,templates:a}=e,s={baseLanguage:t,currency:{code:i},templates:a},p="".concat(o.b,"/").concat(null==n?void 0:n.name,"/provisionInstance?api-version=").concat(o.a),c=yield r.f.post(p,s);return{status:c.status,location:c.headers.location,retryAfterInSeconds:c.headers["retry-after"],environment:c.data}}));return function(n){return e.apply(this,arguments)}}()},14784:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(13161),o=t(12080),i=(t(11766),t(14785),t(14699)),a=t(14765);function s(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function p(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){s(i,r,o,a,p,"next",e)}function p(e){s(i,r,o,a,p,"throw",e)}a(void 0)}))}}var c=10;var u=function(){var e=p((function*(e,n,t){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c,a=arguments.length>4?arguments[4]:void 0;try{if(++a>i)throw null==t||t.failure({message:"AttachingDataverseToEnvironmentFailed",pollingCount:a,reason:"MaxAttemptsReached"}),new Error("AttachingDataverseToEnvironmentFailed - MaxAttemptsReached");yield new Promise(n=>setTimeout(n,1e3*e.retryAfterInSeconds));var s=yield d(e);switch(s.status){case 200:return null==t||t.complete({message:"AttachingDataverseToEnvironmentSuccess",pollingCount:a}),n(s.environment),s;case 202:return null==t||t.progress({message:"PollingAttachDataverseToEnvironment",pollingCount:a}),u(s,n,t,i,a);default:return null==t||t.failure({message:"AttachingDataverseToEnvironmentFailed",pollingCount:a,reason:"UnexpectedStatusCode",statusCode:s.status,provisioningState:null===(r=s.environment)||void 0===r||null===(r=r.properties)||void 0===r?void 0:r.provisioningState}),s.environment&&n(s.environment),s}}catch(p){throw null==t||t.failure({message:"AttachingDataverseToEnvironmentFailed",pollingCount:a,error:Object(o.p)(void 0,p)}),p}}));return function(n,t,r){return e.apply(this,arguments)}}(),d=function(){var e=p((function*(e){var n,{location:t}=e,o=t.substring(t.indexOf("providers")),s="https://bap-rp/".concat(o),p=yield r.f.get(s);if(200===p.status&&null!==(n=p)&&void 0!==n&&null!==(n=n.data)&&void 0!==n&&n.name){var c="".concat(a.a,"/").concat(p.data.name,"?$expand=properties.permissions&api-version=").concat(i.a);p=yield r.f.get(c)}return{status:p.status,location:p.headers.location,retryAfterInSeconds:p.headers["retry-after"],environment:p.data}}));return function(n){return e.apply(this,arguments)}}()},14792:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(14762),o=t(14700),i=t(13161),a=t(14755),s=t(12080);function p(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))}}var u={id:"getDefaultEnvironment",fn:function(e){return d.apply(this,arguments)}};function d(){return(d=c((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,getSingleEnvironmentUrl:p}=e,c=Object(s.N)(a.r,"preferredEnvironment/getDefaultEnvironment",{},s.k.Shell);try{var u=Object(o.d)(i.f,a.i,p),d=n().then(()=>t()).catch(()=>[]),l=yield Promise.race([u,d]),v=(Array.isArray(l)?l:[l]).find(e=>e&&Object(r.p)(e));if(v)return c.complete({environmentFound:!!v}),v;var m=yield u;return c.complete({environmentFound:!!m,environmentFromPointQuery:!0}),m}catch(f){return void c.failure(f)}}))).apply(this,arguments)}},14793:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var r=t(13073),o=t(14792),i=t(14761),a=t(14794),s=t(14796),p=t(14797),c=t(14798),u=t(14799),d=t(14757),l=t(14800),v=e=>Object(p.a)([a.a,i.a,u.a,c.a,d.a.enableRoutingToDataverseEnvironment&&e.shouldUseNewEnvironmentLandingLogic&&l.a,!Object(r.h)()&&o.a,s.a].filter(Boolean))},14794:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(14700),o=t(13161),i=t(14755),a=t(14795),s=t(12080);function p(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))}}var u={id:"getEnvironmentFromPathname",fn:function(e){return d.apply(this,arguments)}};function d(){return(d=c((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,getSingleEnvironmentUrl:p}=e,c=Object(s.N)(i.r,"preferredEnvironment/getEnvironmentFromPathname",{},s.k.Shell),u=Object(r.c)(window.location.pathname);if(u&&l(u)&&u!==i.q)try{var d=Object(r.d)(o.f,u,p),v=n().then(()=>t()).catch(()=>[]),m=yield Promise.race([d,v]),f=(Array.isArray(m)?m:[m]).find(e=>e&&Object(a.a)(e.name,u));if(f)return c.complete({environmentFound:!!f}),f;var h=yield d;return c.complete({environmentFound:!!h,environmentFromPointQuery:!0}),h}catch(g){throw c.failure(g),g}else c.complete({skipped:!0,environmentFound:!1})}))).apply(this,arguments)}function l(e){return e&&e!==i.d&&e!==i.c}},14795:function(e,n,t){"use strict";function r(e,n){return!e&&!n||!(!e||!n)&&e.toUpperCase()===n.toUpperCase()}t.d(n,"a",(function(){return r}))},14796:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(12080),o=t(14755);function i(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function s(e){i(a,r,o,s,p,"next",e)}function p(e){i(a,r,o,s,p,"throw",e)}s(void 0)}))}}var s={id:"getFirstEnvironment",fn:function(e){return p.apply(this,arguments)}};function p(){return(p=a((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t}=e,i=Object(r.N)(o.r,"preferredEnvironment/getFirstEnvironment",{},r.k.Shell);try{var a=yield n().then(()=>t()),s=a.length>0?a[0]:void 0;return i.complete({environmentFound:!!s}),s}catch(p){return void i.failure(p)}}))).apply(this,arguments)}},14797:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(12080),o=t(14755);function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n,t){var r;return(n="symbol"==typeof(r=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"))?r:String(r))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))}}var u=e=>({id:"getFirstPreferredEnvironmentStrategy",fn:d(e)}),d=e=>function(){var n=c((function*(n){var t=Object(r.N)(o.r,"getFirstPreferredEnvironmentStrategy",void 0,r.k.Shell),i=Promise.resolve(void 0),s=e.map(e=>{var t=e.fn(a(a({},n),{},{previousPreferredEnvironmentProvidersPromise:i}));return i=Promise.all([i,t]).then(e=>{var[n,t]=e;return null!=n?n:t}),c((function*(){return t}))});for(var[p,u]of s.entries())try{var d=yield u(n);if(d)return t.complete({providerIndex:p,providerId:e[p].id}),d}catch(l){throw t.failure(l),l}t.complete({providerId:"NotFound"})}));return function(e){return n.apply(this,arguments)}}()},14798:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var r=t(14762),o=t(14706),i=t(14700),a=t(13161),s=t(14759),p=t(14755),c=t(12080),u=t(14795),d=t(12971);function l(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function v(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)}))}}var m={id:"getMruEnvironmentFromLocalStorage",fn:e=>function(e){return f.apply(this,arguments)}(e)};function f(){return(f=v((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,getSingleEnvironmentUrl:s,localStorageKey:d}=e,l=Object(c.N)(p.r,"preferredEnvironment/getMruEnvironmentFromLocalStorage",{},c.k.Shell);try{var v,m=yield o.b.getItemAsync(h(d));if(!m)return void l.complete({noCacheFound:!0});var f=Object(i.d)(a.f,m,s),g=n().then(()=>t()).catch(()=>[]),y=yield Promise.race([f,g]),P=(Array.isArray(y)?y:[y]).find(e=>e&&Object(u.a)(e.name,m)),b=null==P||null===(v=P.properties)||void 0===v?void 0:v.expirationTime,w=Object(r.r)(P);if(P&&!w)return l.complete({environmentFound:!!P,expirationTime:b,expiredEnvironment:w}),P;var E=yield f,O=Object(r.r)(E);if(l.complete({environmentFound:!O,environmentFromPointQuery:!O,environmentFromPointQueryExpired:O,environmentFromListExpired:w}),O)return;return E}catch(A){return void l.failure(A)}}))).apply(this,arguments)}function h(e){return"environment_".concat(Object(d.f)(),"_").concat(Object(s.a)().toString(),"_").concat(e)}},14799:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(14700),o=t(13161),i=t(14755),a=t(12080);function s(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function p(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){s(i,r,o,a,p,"next",e)}function p(e){s(i,r,o,a,p,"throw",e)}a(void 0)}))}}var c={id:"getSharePointEnvironment",fn:function(e){return u.apply(this,arguments)}};function u(){return(u=p((function*(e){var{getSingleEnvironmentUrl:n}=e,t=Object(a.N)(i.r,"preferredEnvironment/getSharePointEnvironment",{},a.k.Shell);try{if(Object(r.c)(window.location.pathname)!==i.q)return;var s=Object(r.d)(o.f,i.q,n),p=yield s;return t.complete({environmentFound:!!p,environmentFromPointQuery:!0}),p}catch(c){throw t.failure(c),c}}))).apply(this,arguments)}},14800:function(e,n,t){"use strict";t.d(n,"a",(function(){return p}));var r=t(12080),o=t(14755),i=t(14762);function a(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function s(e){a(i,r,o,s,p,"next",e)}function p(e){a(i,r,o,s,p,"throw",e)}s(void 0)}))}}var p={id:"getUserDataverseEnvironmentByType",fn:function(e){return c.apply(this,arguments)}};function c(){return(c=s((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,environmentTypes:a=[i.c.Sandbox,i.c.Production,i.c.Developer]}=e,s=Object(r.N)(o.r,"preferredEnvironment/getUserDataverseEnvironmentByType",{},r.k.Shell);try{var p;yield n();var c,u=t().filter(i.n).filter(e=>Object(i.h)(e)||Object(i.x)(e));a.forEach(e=>{c||(c=u.find(n=>n.properties.environmentSku===e))});var d=null!==(p=c)&&void 0!==p?p:u[0];return s.complete({environmentFound:!!d}),d}catch(l){return void s.failure(l)}}))).apply(this,arguments)}},14801:function(e,n,t){},14802:function(e,n,t){"use strict";t(11795),t(14702),t(14759),new RegExp("^/environments/([^/]+)/")},14803:function(e,n,t){"use strict";var r=t(14702),o=t(11788),i=t(13163),a=t(12080),s=t(11766),p=t(14755),c=t(14757),u=t(14763);function d(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){d(i,r,o,a,s,"next",e)}function s(e){d(i,r,o,a,s,"throw",e)}a(void 0)}))}}function v(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}function f(e,n){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e})(e,n)}function h(e){var n=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var t,r=y(e);if(n){var o=y(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return g(this,t)}}function g(e,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=s.createContext({capacityMap:void 0,environmentsCapacityLoadingStatus:o.a.NotLoaded,environmentsCapacityLoadingError:void 0}),b=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&f(e,n)}(g,e);var n,t,i,d,m=h(g);function g(e){var n;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,g),(n=m.call(this,e)).timeoutId=void 0,n.createCapacityMap=e=>{var n=new Map;return e&&e.map(e=>{var t;return n.set(e.name,null===(t=e.properties)||void 0===t?void 0:t.capacity)}),n},n.refreshEnvironmentsList=l((function*(){try{yield n.retrieveAndSetEnvironmentCapacityList()}finally{n.setupPollingForEnvironmentCapacityList()}})),n.setupPollingForEnvironmentCapacityList=()=>{n.timeoutId=window.setTimeout(n.refreshEnvironmentsList,p.f)},n.retrieveAndSetEnvironmentCapacityList=l((function*(){try{var{httpClient:e,enabled:t}=n.props;if(!t)return;if(c.a.enableOakdaleEnforcementMessaging){var i,s=new URL(u.a.deprecateLegacyPARPForEssentialServices?p.n:p.m);s.searchParams.append("$filter","".concat(p.j," and ").concat(p.p));var d=null!==(i=(yield e.get(s.toString(),{page:!0,team:a.k.Shell})).data.value.filter(e=>!Object(r.t)(e)))&&void 0!==i?i:[],l=n.createCapacityMap(d);return d&&n.setState({capacityMap:l,environmentsCapacityLoadingStatus:o.a.Loaded,environmentsCapacityLoadingError:null}),d}}catch(v){Object(a.L)(p.r,{eventName:"getEnvironmentsListExpandCapacity",eventData:v}),n.setState({environmentsCapacityLoadingStatus:o.a.Error,environmentsCapacityLoadingError:v})}})),n.state={capacityMap:void 0,environmentsCapacityLoadingStatus:o.a.NotLoaded,environmentsCapacityLoadingError:void 0},n}return n=g,(t=[{key:"componentDidMount",value:(d=l((function*(){c.a.enableOakdaleEnforcementMessaging&&(yield this.retrieveAndSetEnvironmentCapacityList())&&this.setupPollingForEnvironmentCapacityList()})),function(){return d.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){c.a.enableOakdaleEnforcementMessaging&&clearTimeout(this.timeoutId)}},{key:"render",value:function(){var{enabled:e}=this.props;if(!e)return s.createElement(s.Fragment,null,this.props.children);var{capacityMap:n,environmentsCapacityLoadingStatus:t,environmentsCapacityLoadingError:r}=this.state,o={capacityMap:n,environmentsCapacityLoadingStatus:t,environmentsCapacityLoadingError:r};return s.createElement(P.Provider,{value:o},s.createElement(s.Fragment,null,this.props.children))}}])&&v(n.prototype,t),i&&v(n,i),Object.defineProperty(n,"prototype",{writable:!1}),g}(s.Component);Object(i.l)(b),Object(o.b)(P,"environmentsCapacityLoadingStatus")},14804:function(e,n,t){"use strict";t(14699),t(11766)},14805:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(14699),o=t(11766),i=t.n(o);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function s(e,n){var t=t=>{var o=Object(r.E)();return n&&!o.isSuccess?i.a.createElement(i.a.Fragment,null):i.a.createElement(e,a({},t,o))};return t.displayName="withCurrentEnvironment(".concat(e.displayName||e.name||"Component",")"),t}},14806:function(e,n,t){"use strict";t(14699),t(11766)},14807:function(e,n,t){"use strict";t(14783),t(14764);var r=t(14808);t.d(n,"a",(function(){return r.a}));var o=t(14810);t.d(n,"b",(function(){return o.a}));var i=t(14811);t.d(n,"c",(function(){return i.a}));var a=t(14766);t.d(n,"e",(function(){return a.a}));t(14784);var s=t(14812);t.d(n,"d",(function(){return s.a}))},14808:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(11928),o=t.n(r),i=t(11766),a=t(14699),s=t(14809);function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e,n,t){var r;return(n="symbol"==typeof(r=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"))?r:String(r))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(){var{currentEnvironment:e,currentEnvironmentLoadingStatus:n,refreshCurrentEnvironment:t}=i.useContext(a.d),r=i.useRef(e),u=i.useMemo(()=>o()(e,r.current)?r.current:(r.current=e,e),[e]),d=i.useMemo(()=>{switch(n){case a.j.Loaded:return"success";case a.j.Error:return"error";default:return"loading"}},[n]),l=i.useMemo(()=>Object(s.a)(d),[d]),v=i.useMemo(()=>!!u&&Object(a.r)(u),[u]);return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({currentEnvironment:u,status:d,refetch:t,hasDataverse:v},l)}},14809:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r=e=>({isLoading:"loading"===e,isSuccess:"success"===e,isError:"error"===e})},14810:function(e,n,t){"use strict";t.d(n,"a",(function(){return p}));var r=t(11766),o=t(14699),i=t(14809);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e,n,t){var r;return(n="symbol"==typeof(r=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"))?r:String(r))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(){var{currentEnvironment:e,currentEnvironmentLoadingStatus:n}=r.useContext(o.d),t=r.useMemo(()=>{switch(n){case o.j.Loaded:return"success";case o.j.Error:return"error";default:return"loading"}},[n]),p=r.useMemo(()=>Object(i.a)(t),[t]);return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({currentEnvironmentName:null==e?void 0:e.name,status:t},p)}},14811:function(e,n,t){"use strict";t.d(n,"a",(function(){return p}));var r=t(11766),o=t(14699),i=t(14809);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e,n,t){var r;return(n="symbol"==typeof(r=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"))?r:String(r))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(){var{_environments:e,allEnvironmentsLoadingStatus:n,forceRefreshEnvironmentsList:t}=r.useContext(o.d),p=r.useMemo(()=>{switch(n){case o.j.Loaded:return"success";case o.j.Error:return"error";default:return"loading"}},[n]),c=r.useMemo(()=>Object(i.a)(p),[p]);return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({environments:e,status:p,refetch:()=>t()},c)}},14812:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var r=t(13161),o=t(12080),i=t(11766),a=t(14769),s=(t(14785),t(14700)),p=t(14755);function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){d(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e,n,t){var r;return(n="symbol"==typeof(r=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"))?r:String(r))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n,t,r,o,i,a){try{var s=e[i](a),p=s.value}catch(c){return void t(c)}s.done?n(p):Promise.resolve(p).then(r,o)}function v(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)}))}}function m(e){var{onGetEnvironmentByName:n}=Object(i.useContext)(s.a),t=Object(a.b)();return{getEnvironmentByName:Object(i.useCallback)(function(){var r=v((function*(r){return r?yield t.fetchQuery(u({queryFn:(o=v((function*(){return n?yield n({environmentName:r}):yield g(r)})),function(){return o.apply(this,arguments)}),queryKey:h({environmentName:r}),staleTime:f},e)):null;var o}));return function(e){return r.apply(this,arguments)}}(),[n,t,e])}}var f=18e4,h=e=>{var{environmentName:n}=e;return["power-platform-environment","getBapEnvironmentByName",n]},g=function(){var e=v((function*(e){var n=Object(o.N)(p.r,"getBapEnvironmentByName",void 0,o.k.Shell);try{var t=yield r.f.get(y(e));return n.complete({environmentName:e,found:!(null==t||!t.data)}),(null==t?void 0:t.data)||null}catch(i){throw n.failure(i),i}}));return function(n){return e.apply(this,arguments)}}(),y=e=>"".concat(p.b,"/").concat(e,"?api-version=").concat(p.a,"&$expand=properties.permissions")},14813:function(e,n,t){"use strict";t(14814),t(14815),t(14816),t(14817),t(14818),t(14819),t(14820)},14814:function(e,n,t){},14815:function(e,n,t){},14816:function(e,n,t){},14817:function(e,n,t){},14818:function(e,n,t){},14819:function(e,n,t){},14820:function(e,n,t){},14821:function(e,n,t){"use strict";var r=t(14822);t.d(n,"a",(function(){return r.a})),t.d(n,"b",(function(){return r.b}))},14822:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return o}));function r(e){return null!=e&&e.headers&&"x-ms-environment-name"in(null==e?void 0:e.headers)&&(null==e||delete e.headers["x-ms-environment-name"]),e}function o(e){if(null!=e&&e.headers&&"x-ms-environment-name"in e.headers){var n=null==e?void 0:e.headers["x-ms-environment-name"];if(n&&"string"==typeof n)return n.trim().toLowerCase()}}},14829:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return s}));var r=t(13192),o=t(14689),i=t(13180),a=t(13187).a.powerAutomate;function s(e,n){return t=>{var s=Object(i.a)();if(s&&t.url){var p=e.extractPPAPIEndpoint(t.url);if(p)t.baseUrl=p;else{var c=e.tryConvertFlowRPRequestUrl(t.url);c.converted&&(t.url=new URL(c.path,c.endpoint).toString(),t.baseUrl=c.endpoint,Object.keys(c.queryParams).forEach(e=>{t=Object(r.setRequestParam)(t,e,c.queryParams[e])}))}}var u=s&&e.extractPPAPIEndpoint(t.url)&&t.url.includes("/".concat(a,"/"))&&(!t.baseUrl||e.extractPPAPIEndpoint(t.baseUrl))?o.b:n.processSimpleResourceProviderApiVersionWithEnvironments;return u&&(t=Object(r.setRequestParam)(t,"api-version",u)),Promise.resolve(t)}}},14868:function(e,n,t){"use strict";t.d(n,"d",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return a})),t.d(n,"e",(function(){return s}));var r={standard:"Standard",premium:"Premium"},o={Basic:"basic",Oauth2:"oauth2",ApiKey:"apiKey",None:"none",Windows:"windows"},i={composite:"composite",tabular:"tabular",blob:"blob",gateway:"gateway",cloud:"cloud"},a={NotSpecified:"NotSpecified",Environment:"Environment",Solution:"Solution"},s=function(e){return e.Code="code",e.ClientCredentials="client_credentials",e}({})},14892:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"j",(function(){return s})),t.d(n,"d",(function(){return p})),t.d(n,"h",(function(){return c})),t.d(n,"f",(function(){return u})),t.d(n,"c",(function(){return d})),t.d(n,"i",(function(){return v})),t.d(n,"k",(function(){return m})),t.d(n,"l",(function(){return f})),t.d(n,"b",(function(){return h})),t.d(n,"g",(function(){return g})),t.d(n,"m",(function(){return y})),t.d(n,"e",(function(){return P}));var r=t(14868),o=t(11891),i=function(e){return e[e.array=0]="array",e[e.bool=1]="bool",e[e.connection=2]="connection",e[e.gatewaySetting=3]="gatewaySetting",e[e.int=4]="int",e[e.oauthSetting=5]="oauthSetting",e[e.object=6]="object",e[e.secureObject=7]="secureObject",e[e.secureString=8]="secureString",e[e.string=9]="string",e}({}),a="https://github.com/microsoft/PowerPlatformConnectors/tree/dev/independent-publisher-connectors/";function s(e){return!!e&&(!!e.properties&&(!e.properties.connectionParameters||0===Object.keys(e.properties.connectionParameters).length))}function p(e){return!!(e&&e.properties&&e.properties.scopes&&(e.properties.scopes.will&&0!==e.properties.scopes.will.length||e.properties.scopes.wont&&0!==e.properties.scopes.wont.length))}function c(e){return!function(e){return!s(e)||function(e){return!!(e&&e.properties&&e.properties.termsOfUseUrl)}(e)||p(e)}(e)}function u(e){if(!e)return!1;var n=l(e,i[i.oauthSetting]);return!!(n&&n[0]&&n[0].oAuthSettings&&n[0].oAuthSettings.properties&&Object(o.a)(n[0].oAuthSettings.properties.IsFirstParty,"true"))}function d(e){return l(e,i[i.connection]).length>0}function l(e,n){return e&&e.properties&&e.properties.connectionParameters?Object.keys(e.properties.connectionParameters).map(n=>{var t;return(null===(t=e.properties)||void 0===t?void 0:t.connectionParameters)&&e.properties.connectionParameters[n]}).filter(e=>!!e).filter(e=>Object(o.a)(e.type,n)):[]}function v(e){return Object(o.a)(r.d.premium,e.properties.tier)}function m(e){var n;return"true"===(null===(n=e.properties.metadata)||void 0===n?void 0:n.isSponsoredConnector)}function f(e){return Object(o.a)(r.d.standard,e.properties.tier)}function h(e){if(e.properties.isCustomApi)return null;if(function(e){return"shared_uiflow"===e.name}(e))return"https://docs.microsoft.com/power-automate/desktop-flows/overview";var n=y(e);return"https://docs.microsoft.com/connectors/".concat(n,"/")}function g(e){var n;return"independentpublisher"===(null===(n=e.properties.metadata)||void 0===n?void 0:n.source)}function y(e){var n=e.name;return n.startsWith("shared_")?n.substring("shared_".length):n}function P(e){return!!(e&&e.properties&&e.properties.metadata&&e.properties.metadata.source&&Object(o.a)(e.properties.metadata.source,"powerapps-user-defined"))}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/28.955a1b27.chunk.js.map