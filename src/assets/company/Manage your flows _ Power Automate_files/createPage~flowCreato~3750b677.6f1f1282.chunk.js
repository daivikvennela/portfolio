/*! For license information please see createPage~flowCreato~3750b677.6f1f1282.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{15035:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i,o=n(11766),r=n(14337),a=n(12812),s=n(13272),l=n(12706),c=n(15036);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,d(i.key),i)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var n,i=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=Object(r.c)(i=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(d,e);var t,n,i,r=f(d);function d(){var e;p(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=r.call(this,...n)).getClassNames=Object(l.a)(),e}return t=d,(n=[{key:"render",value:function(){var e=this.getClassNames(c.a),{clientResources:t}=this.props;return o.createElement("div",{className:e.root},o.createElement("div",null,o.createElement(a.a,{iconName:this.props.iconName||s.a.Connector,className:e.icon}),o.createElement("p",{className:e.label},t.FlowCreator.V2.ParametersPlaceHolder)))}}])&&u(t.prototype,n),i&&u(t,i),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.Component))||i},15036:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(12754),o=()=>{var e=Object(i.Y)();return{root:["fl-flowCreatorV2PlaceHolder",{width:"100%",textAlign:"center",minHeight:"120px",display:"flex",alignItems:"center",justifyContent:"center"}],icon:["fl-flowCreatorV2PlaceHolder-icon",{fontSize:i.k.size24,color:e.palette.themePrimary,marginBottom:"8px"}],label:["fl-flowCreatorV2PlaceHolder-label",{color:e.palette.themePrimary,fontSize:i.k.size14,fontWeight:i.l.regular,marginTop:"8px"}]}}},20813:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var i,o,r=n(11766),a=n(14337),s=n(20814),l=n(14980),c=n(20817),p=n(12706),u=n(20818),d=n(14978),g=n(15035),f=n(20103),m=n(11773),h=n(20820),C=n(20822),w=n(20830);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,v(i.key),i)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function D(e,t){return(D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var n,i=E(e);if(t){var o=E(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return F(this,n)}}function F(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,n,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var P=Object(a.c)((O((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}(a,e);var t,n,i,o=S(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).getClassNames=Object(p.a)(),t.designerContainerRef=r.createRef(),t.renderDietDesignerSection=()=>{var e,{clientResources:n,flowCreatorStore:i}=t.props,o=i,a=null!==(e=o.parameterSectionDetailsTextOverride)&&void 0!==e?e:n.FlowCreatorV2.DietDesignerParameterSectionDetails;return r.createElement(r.Fragment,null,o.shouldUseDietDesignerView&&r.createElement(r.Fragment,null,r.createElement(d.a,{title:n.FlowCreatorV2.DietDesignerParameterSectionTitle,details:a}),t.shouldRenderConnectionsPlaceholder&&t.renderConnectionLoadingPlaceholder(),t.shouldRenderDietDesignerLoading&&t.renderDietDesignerPlaceholder()),t.shouldRenderDietDesigner&&t.renderDietDesigner())},t.handleConnectionsChangedByDesigner=e=>{var{loggingService:n,flowCreatorStore:i}=t.props;n.logInfo("flowCreatorV2Form.handleConnectionsChangedByDesigner","Refreshing connections after designer connection store change detected"),i.addConnectionsToStore(e)},t.onRenderLoading=()=>{var{flowCreatorStore:{connectorIcons:e},clientResources:n}=t.props;return r.createElement(l.a,{icons:e,isLoading:!0,loadingToolTipText:n.ConnectionWizard.Spinner.AriaLabel})},t.renderConnectionLoadingPlaceholder=()=>r.createElement(g.a,{clientResources:t.props.clientResources}),t.renderDietDesignerPlaceholder=()=>r.createElement(h.a,{clientResources:t.props.clientResources}),t.renderDietDesigner=()=>{var{flowCreatorStore:e,loggingService:n}=t.props;if(!(e instanceof C.b))return n.logError("flowCreatorV2Form.renderDietDesigner",new Error("flowCreatorStore must be an instance of FlowCreatorV2Store to render diet designer in flowCreatorV2Form.")),null;var i=e;return r.createElement("div",{id:"FlowCreatorV2Form-dietDesignerContainer",style:{display:"none"},ref:t.designerContainerRef},r.createElement(f.b,b({key:i.dietDesignerInstanceKey,templateEntity:i.templateEntity,templateParameters:i.templateParametersToReplace,availableConnections:i.availableConnections,onConnectionsUpdatedByDesigner:()=>{},connectionsReady:!0,onConnectionWizardStateChange:i.handleDietDesignerConnectionWizardStateChange,onDietViewStateChange:()=>{},onError:i.setErrorMessage,onFlowCreationError:e.onFlowCreationErrorFromDietView,onFlowCreationSuccessful:i.onFlowCreatedFromDietView,onNodesDoneLoading:t.handleNodeDoneLoading,registerConnectionConfirmationCallback:i.registerDietDesignerConnectionConfirmationCallback,registerGetFlowDefinition:i.registerGetFlowDefinition,registerSaveFlowCallback:i.registerDietViewSaveFlowCallback,availableXrmConnectionReferences:i.connectionReferencesForDietDesigner,solutionId:e.getSolutionId,getFlowDisplayName:t.onGetFlowDisplayName,useFlowEntity:e.shouldCreateFromFlowEntity,flowEntity:e.flowEntityForDietDesigner,shouldNotCreateFlow:e.shouldNotCreateFlow},t.props)))},t.handleNodeDoneLoading=()=>{var{flowCreatorStore:e}=t.props;e.shouldUseDietDesignerView&&t.designerContainerRef.current&&"none"===t.designerContainerRef.current.style.display&&(t.designerContainerRef.current.style.display="block"),e.handleNodeDoneLoadingParameters()},t.renderFlowDisplayNameInput=()=>{var{clientResources:e,flowCreatorStore:n,graphService:i,loggingService:o}=t.props,a=t.getClassNames(c.a);return n.flowPropertiesInputs?r.createElement("div",{className:a.flowDisplayNameInput},r.createElement(w.a,{inputParameters:n.flowPropertiesInputs,globalResources:e,dateTimeResources:e.DateTime,sharedComponentResources:e,loggingService:o,graphService:i})):null},t.onGetFlowDisplayName=()=>{var{loggingService:e,flowCreatorStore:{getFlowDisplayName:n}}=t.props;return e.logInfo("flowCreatorV2Form.onGetFlowDisplayName","getting custom flow display name for diet designer"),n()},t}return t=a,(n=[{key:"render",value:function(){var e,{clientResources:t,flowCreatorStore:n,widgetUtilService:i}=this.props,o=this.getClassNames(c.a),a=n.connectionWizardConnectionReferences;return n instanceof C.b&&n.shouldCreateFromFlowEntity&&null!==(e=n.flowEntityForDietDesigner)&&void 0!==e&&e.connectionReferences&&(a=n.flowEntityForDietDesigner.connectionReferences),r.createElement("div",{className:o.root},this.renderFlowDisplayNameInput(),r.createElement(u.a,{clientResources:t,widgetUtilService:i}),r.createElement(s.a,b({availableConnections:n.availableConnections,connectionReferences:a,connectionsReady:!n.isLoadingConnections,onConnectionReferencesConfirmed:n.onConnectionsConfirmed,onConnectionsUpdatedByDesigner:this.handleConnectionsChangedByDesigner,onConnectionWizardStateChange:n.handleConnectionWizardStateChange,onError:n.setErrorMessage,registerConnectionConfirmationCallback:n.registerConnectionConfirmationCallback,onRenderLoading:this.onRenderLoading,hideUntilConnectionWizardLoaded:!0,shouldSkipMergeConnectionsLogic:!1,showConnectionDisplayName:!0,solutionId:n.getSolutionId},this.props)),this.renderDietDesignerSection())}},{key:"shouldRenderDietDesigner",get:function(){return this.props.flowCreatorStore.formState===C.a.LoadingDietDesigner||this.props.flowCreatorStore.formState===C.a.FlowInputs||this.props.flowCreatorStore.formState===C.a.CreatingFlow}},{key:"shouldRenderDietDesignerLoading",get:function(){return this.props.flowCreatorStore.formState===C.a.LoadingDietDesigner}},{key:"shouldRenderConnectionsPlaceholder",get:function(){return this.props.flowCreatorStore.formState===C.a.ReviewingConnections}}])&&y(t.prototype,n),i&&y(t,i),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.Component)).prototype,"shouldRenderDietDesigner",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"shouldRenderDietDesigner"),o.prototype),O(o.prototype,"shouldRenderDietDesignerLoading",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"shouldRenderDietDesignerLoading"),o.prototype),O(o.prototype,"shouldRenderConnectionsPlaceholder",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"shouldRenderConnectionsPlaceholder"),o.prototype),i=o))||i},20817:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=()=>({root:{selectors:{".msla-connection-container":{maxWidth:"none !important"},".fl-ConnectionWizard":{paddingBottom:"20px"}}},flowDisplayNameInput:{paddingBottom:"16px"}})},20820:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i,o=n(11766),r=n(14337),a=n(12706),s=n(15374),l=n(13241),c=n(20821);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,d(i.key),i)}}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var n,i=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=Object(r.c)(i=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(d,e);var t,n,i,r=f(d);function d(){var e;p(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=r.call(this,...n)).getClassNames=Object(a.a)(),e}return t=d,(n=[{key:"render",value:function(){var e=this.getClassNames(c.a),{clientResources:t}=this.props;return o.createElement("div",{className:e.root},o.createElement("div",null,o.createElement(s.a,{size:l.b.large}),o.createElement("p",{className:e.label},t.FlowCreator.V2.DietDesignerSpinner.GettingParameters)))}}])&&u(t.prototype,n),i&&u(t,i),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.Component))||i},20821:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(12754),o=()=>({root:["fl-flowCreatorV2DietDesignerSpinner",{width:"100%",textAlign:"center",minHeight:"120px",display:"flex",alignItems:"center",justifyContent:"center"}],label:["fl-flowCreatorV2DietDesignerSpinner-label",{color:Object(i.Y)().palette.themePrimary,fontSize:i.k.size12,fontWeight:i.l.regular,marginTop:"8px"}]})},20822:function(e,t,n){"use strict";n.d(t,"a",(function(){return De})),n.d(t,"b",(function(){return Se}));var i,o,r,a,s,l,c,p,u,d,g,f,m,h,C,w,b,y,v,D,S,F,E,O,P,z,T,j,k,N,R,I,V,L,U,x,W,B,_=n(11773),M=n(13009),A=n(20823),G=n(15402),H=n(13085),J=n(15378),K=n(17176),X=n(13240),Y=n(14834),q=n(14825),Q=n(20824),Z=n(15568),$=n(19789),ee=n(20825),te=n(11804),ne=n(19999),ie=n(17866),oe=n(12328),re=n.n(oe),ae=n(20808),se=n(14835),le=n(14896),ce=n(20827),pe=["templateDefinition"],ue=["templateName"];function de(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(i,o)}function ge(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){de(r,i,o,a,s,"next",e)}function s(e){de(r,i,o,a,s,"throw",e)}a(void 0)}))}}function fe(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){Ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n){return(t=ye(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ye(i.key),i)}}function ye(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function ve(e,t,n,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var De=function(e){return e[e.AwaitingConsent=0]="AwaitingConsent",e[e.Consenting=1]="Consenting",e[e.ReviewingConnections=2]="ReviewingConnections",e[e.LoadingDietDesigner=3]="LoadingDietDesigner",e[e.FlowInputs=4]="FlowInputs",e[e.CreatingFlow=5]="CreatingFlow",e[e.CreationCompleted=6]="CreationCompleted",e[e.Loading=7]="Loading",e[e.PreparingToClose=8]="PreparingToClose",e}({}),Se=(o=ve((i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props=t,we(this,"connectionConfirmationCallback",o,this),we(this,"dietDesignerConnectionConfirmationCallback",r,this),we(this,"dietDesignerInstantiationCount",a,this),we(this,"errorMessage",s,this),this.flowName=void 0,we(this,"flowPropertiesInputs",l,this),we(this,"formState",c,this),we(this,"inputParameters",p,this),this.isConnectionWizardConfirmClicked=void 0,this.isDietDesignerConnectionWizardConfirmClicked=void 0,we(this,"isLoadingConnections",u,this),we(this,"isTemplateDescriptionExpanded",d,this),this.loadConnectionWizardDesignerStylesManually=void 0,we(this,"getFlowDefinitionFromDietView",g,this),we(this,"saveFlowFromDietView",f,this),we(this,"selectedConnectionReferences",m,this),we(this,"_templateEntityFromTemplateDefinition",h,this),we(this,"templateName",C,this),we(this,"flowCreationOptions",w,this),this.addConnectionsToStore=e=>{var{connectionService:t,environmentStore:n}=this.props,i=ie.a.getCollectionType({environmentName:n.currentEnvironmentName});t.addConnectionsToStore({connections:e,collectionType:i})},this.getCallbackUrl=()=>{var e,{loggingService:t,callbackUrlService:{getCallbackUrl:n}}=this.props,i=this.flowEntity;if(void 0===i||0===(null===(e=i.properties.definitionSummary)||void 0===e||null===(e=e.triggers)||void 0===e?void 0:e.length))return Promise.reject(new Error("Flow entity is undefined or has no triggers."));if(void 0===i.name||null===i.name)return Promise.reject(new Error("Flow name is null or undefined"));var o=Object(se.y)(i);if(null===o)return Promise.reject(new Error("Trigger name is null."));var r=n(i.name,o).then(e=>e.value).catch(e=>Promise.reject(e));return Object(G.b)({loggingService:t,promise:r,eventStartName:H.a.flowCreatorV2GetCallbackUrlStart,eventEndName:H.a.flowCreatorV2GetCallbackUrlEnd})},this.getFlowDisplayName=()=>((this.flowPropertiesInputs&&this.flowPropertiesInputs.FlowDisplayName?this.flowPropertiesInputs.FlowDisplayName.fieldState.value:this.initialFlowDisplayName)||"").trim()||void 0,this.handleClose=()=>{var{onClose:e,dismiss:t}=this.props;e&&e(),t()},we(this,"handleConnectionWizardStateChange",b,this),we(this,"handleDietDesignerConnectionWizardStateChange",y,this),this.handleDietViewBackButtonClicked=()=>{this.resetDietDesigner(),this.setFormState(De.ReviewingConnections)},we(this,"handleNodeDoneLoadingParameters",v,this),we(this,"initializeFromTemplateDefinition",D,this),we(this,"initializeFromTemplateName",S,this),this.onConnectionsConfirmed=e=>this.isConnectionWizardConfirmClicked?(this.isConnectionWizardConfirmClicked=!1,this.setSelectedConnectionReferences(e),this.shouldUseDietDesignerView?this.setFormState(De.LoadingDietDesigner):this.setFormState(De.FlowInputs),Promise.resolve()):Promise.resolve(),this.onFlowCreatedFromDietView=e=>{var{loggingService:t}=this.props;t.logInfo("flowCreatorStoreV2.onFlowCreatedFromDietView","Flow successfully created from diet view",{templateName:this.templateEntity&&this.templateEntity.name}),this.flowName=e,this.handleFlowCreationCompleted(e)},this.onFlowCreationErrorFromDietView=e=>{var{loggingService:t}=this.props;t.logWarning("flowCreatorStoreV2.onFlowCreationErrorFromDietView","Error creating flow from diet view",{templateName:this.templateEntity&&this.templateEntity.name,error:e});var{onCreateFlowError:n}=this.flowCreationOptions;n&&n(e),this.setErrorMessage(e),this.setFormState(De.FlowInputs)},we(this,"onTemplateDescriptionExpandToggled",F,this),we(this,"registerConnectionConfirmationCallback",E,this),we(this,"registerDietDesignerConnectionConfirmationCallback",O,this),we(this,"registerDietViewSaveFlowCallback",P,this),we(this,"registerGetFlowDefinition",z,this),we(this,"setErrorMessage",T,this),we(this,"clearErrorMessage",j,this),this.consent=e=>{var{consentService:t,userDetailsStore:n,sessionStore:i,featureFlags:o,scenarioLoggingService:r}=this.props,a=he({consentSource:"flowCreatorStore",unconsentedMode:!!o.enableUnconsentedMode},this.getBaseProfileData());e?(r.tagEvent(K.c.UserConsentScenario,X.c.UserAutoConsented,K.d.Other,null,a),t.setIsEmailOptedIn(!1),this.setFormState(De.Loading)):(r.tagEvent(K.c.UserConsentScenario,X.c.UserConsentAcceptClicked,K.d.Resume,null,a),this.setFormState(De.Consenting));var s=Object(J.b)(n,i),l=r.profileStart(K.c.UserConsentScenario,H.a.flowCreatorV2ConsentStart,K.d.Other,a);return t.consent(s).then(()=>(r.profileEndWithSuccess(l,K.c.UserConsentScenario,H.a.flowCreatorV2ConsentEnd,K.d.End,a),o.enableReloadAfterConsentForInvokeFlowStore&&window.location.reload(),this.initializeForConsentedUser(!0))).catch(e=>{r.profileEnd(l,K.c.UserConsentScenario,H.a.flowCreatorV2ConsentEnd,K.d.End,Object(M.y)(e),e,a),this.setFormState(De.AwaitingConsent),this.setErrorMessage(e)})},this.getBaseProfileData=()=>{var{allowCustomFlowDisplayName:e}=this.props;return{templateName:this.templateName,isUsingTemplateDefinitionFromHost:!!this._templateEntityFromTemplateDefinition,allowCustomFlowName:!!e,formState:De[this.formState]}},this.handleCancelClicked=()=>{var{onCancel:e,telemetryService:t,scenarioLoggingService:n,featureFlags:i}=this.props;t.tagEvent(X.c.FlowCreatorSurfaceCloseButtonClicked,null,he({},this.getBaseProfileData())),this.formState===De.AwaitingConsent&&n.tagEvent(K.c.UserConsentScenario,X.c.UserConsentInterrupted,K.d.End,null,he(he({},this.getBaseProfileData()),{},{consentSource:"flowCreatorStore",unconsentedMode:!!i.enableUnconsentedMode})),e&&e(),this.handleClose()},we(this,"handleConnectionsReady",k,this),this.handleDietViewSaveClicked=()=>{var{telemetryService:e}=this.props;e.tagEvent(X.c.FlowCreatorSurfaceDietViewCreateButtonClicked,null,he({},this.getBaseProfileData())),re()(this.saveFlowFromDietView,"saveFlowFromDietView button should always be defined prior to enabling the diet view create button"),this.setFormState(De.CreatingFlow),this.saveFlowFromDietView&&(this.clearErrorMessage(),this.saveFlowFromDietView())},this.handleDoneClicked=()=>{var e,{onDone:t,telemetryService:n,skipClosingSurfaceOnDoneClicked:i}=this.props;(this.setFormState(De.PreparingToClose),n.tagEvent(X.c.FlowCreatorSurfaceDoneButtonClicked,null,he({},this.getBaseProfileData())),t)&&t(this.flowEntity,null===(e=this.templateTrigger)||void 0===e?void 0:e.swaggerOperationId);i||this.handleClose()},this.handleFlowCreationCompleted=e=>{var{widgetUtilService:t}=this.props,{onCreateFlowCompletion:n}=this.flowCreationOptions;n&&n(e),t.isWidgetPage()&&t.widgetCloseOnFlowSaveEnabled()?t.fireWidgetCloseEvent():(t.isWidgetPage()&&t.isExcelSDXContext(),(!t.isWidgetPage()||t.isWidgetPage()&&!t.shouldWaitAfterSavingFlow())&&this.setFormState(De.CreationCompleted))},we(this,"initialize",N,this),this.initializeConnections=()=>{var e=!this.props.skipForceRefreshOfConnections;return this.loadConnections(e).catch(e=>{})},we(this,"initializeFlowPropertiesInput",R,this),this.initializeForAuthenticatedUser=()=>{var{loggingService:e,scenarioLoggingService:t,userDetailsStore:n,widgetUtilService:i,autoConsentUser:o,sessionStore:r,featureFlags:a}=this.props;if(!n.isConsented||Object(J.c)(n,r)){var s={detectionSource:"flowCreatorStore",consentSource:"flowCreatorStore",unconsentedMode:!!a.enableUnconsentedMode};if(t.tagEvent(K.c.UserConsentScenario,X.c.UserConsentRequired,K.d.Start,null,s),!i.isWidgetPage()){var l=new M.a(M.c.flowCreatorUserNotConsented,"User must be consented if we are not in a widget page");t.logError(K.c.UserConsentScenario,"flowCreatorStore.initialize",K.d.Other,l,s)}return o?(t.logInfo(K.c.UserConsentScenario,"flowCreatorStore.initialize",K.d.Other,"Auto consenting user."),this.consent(!0)):(t.logInfo(K.c.UserConsentScenario,"flowCreatorStore.initialize",K.d.Other,"Auto consent not enabled, prompting user to consent instead."),this.initializeForNonConsentedUser())}return e.logInfo("flowCreatorStoreV2.initialize","Loading for a user that has already consented."),this.initializeForConsentedUser()},we(this,"initializeForCdsProvisioningView",I,this),we(this,"initializeForConsentedUser",V,this),this.initializeForDietView=()=>{var{loggingService:e}=this.props;e.logInfo("flowCreatorStoreV2.initializeForDietView","Initializeing FlowCreatorSurface for diet view",{templateName:this.templateEntity&&this.templateEntity.name}),this.initializeFlowPropertiesInput(),this.setStateAndLoadConnections({state:De.ReviewingConnections,eventStartName:H.a.flowCreatorV2LoadConnectionsForDietViewStart,eventEndName:H.a.flowCreatorV2LoadConnectionsForDietViewEnd})},we(this,"initializeForNonConsentedUser",L,this),this.loadConnections=e=>{var{connectionService:t,loggingService:n}=this.props,i=he(he({},this.getBaseProfileData()),{},{forceRefresh:e}),o=n.profileStart(H.a.flowCreatorV2ConnectionsLoadStart,i);return this.setIsLoadingConnections(!0),t.getConnections({forceRefresh:e}).then(()=>{n.profileEndWithSuccess(o,H.a.flowCreatorV2ConnectionsLoadEnd,i),this.setIsLoadingConnections(!1)}).catch(e=>{throw n.profileEnd(o,H.a.flowCreatorV2ConnectionsLoadEnd,Object(M.y)(e),e,i),this.setIsLoadingConnections(!1),e})},this.loadTemplate=()=>{var{loggingService:e,templateService:t,widgetUtilService:n,onLoadTemplateError:i}=this.props;if(!this.templateName)return Promise.resolve();var o=t.loadTemplate({templateName:this.templateName,forceRefresh:!0,galleryName:q.b.public}).then(()=>(n.isWidgetPage()&&n.fireTemplateLoadedEvent(),Promise.resolve())).catch(e=>(i&&i(e),Promise.reject(e)));return Object(G.b)({loggingService:e,promise:o,eventStartName:H.a.flowCreatorV2LoadTemplateStart,eventEndName:H.a.flowCreatorV2LoadTemplateEnd})},this.onConsentClicked=()=>{var{loggingService:e}=this.props;return e.logInfo("flowCreatorStoreV2.onConsentClicked","consenting user after user clicked consent"),this.consent()},we(this,"resetDietDesigner",U,this),we(this,"setFormState",x,this),we(this,"setIsLoadingConnections",W,this),we(this,"setSelectedConnectionReferences",B,this),this.setStateAndLoadConnections=e=>{var{state:t,eventStartName:n,eventEndName:i,fallbackState:o}=e,{clientResources:r,loggingService:a}=this.props,s=a.profileStart(n,this.getBaseProfileData());this.loadConnections().then(()=>{a.profileEndWithSuccess(s,i,this.getBaseProfileData())}).catch(e=>{this.setErrorMessage(r.InvokeFlowForm.ErrorMessage.FailedToLoadConnections),a.profileEnd(s,i,Object(M.y)(e),e,this.getBaseProfileData()),o&&this.setFormState(o)}),this.setFormState(t)},this.setFormState(De.Loading),Object(_.runInAction)(()=>this.dietDesignerInstantiationCount=0),this.loadConnectionWizardDesignerStylesManually=t.loadConnectionWizardDesignerStylesManually}var t,n,i;return t=e,(n=[{key:"parameterSectionDetailsTextOverride",get:function(){return this.flowCreationOptions.parameterSectionDetailsTextOverride||void 0}},{key:"shouldCreateFromFlowEntity",get:function(){return this.flowCreationOptions.shouldCreateFromFlowEntity||!1}},{key:"shouldNotCreateFlow",get:function(){return this.flowCreationOptions.shouldNotCreateFlow||!1}},{key:"flowEntityForDietDesigner",get:function(){return this.flowCreationOptions.flowEntityForDietDesigner}},{key:"availableConnections",get:function(){var{connectionStore:e,environmentStore:t}=this.props,n=ie.a.getCollectionType({environmentName:t.currentEnvironmentName}),i=e.connections.getCollection(n);return(i&&i.list||[]).map(t=>e.connections.getEntity(t).toJS())}},{key:"connectionReferencesForDietDesigner",get:function(){var e,{environmentStore:{currentEnvironmentName:t},xrmConnectionReferenceStore:n}=this.props,i=[],o=null===(e=n.xrmConnectionReferences.getCollection(ae.a.getCollectionType({environmentName:t})))||void 0===e?void 0:e.list,r=n.xrmConnectionReferences.entities,a=[];return Object.keys(this.selectedConnectionReferences||{}).map(e=>{a.push(this.selectedConnectionReferences[e].connectionName)}),null==o||o.map(e=>{var t,n=null===(t=r.getEntity(e))||void 0===t?void 0:t.toJS();n&&a.includes(n.connectionreferencelogicalname)&&i.push(n)}),i}},{key:"connectionWizardConnectionReferences",get:function(){var e,t=this.templateEntity&&this.templateEntity.connectionReferences||{};return null!==(e=this.flowCreationOptions)&&void 0!==e&&e.shouldCreateFromFlowEntity&&(t=this.flowEntityForDietDesigner&&this.flowEntityForDietDesigner.connectionReferences||{}),Object.keys(t).map(e=>this.selectedConnectionReferences&&this.selectedConnectionReferences[e]?{[e]:this.selectedConnectionReferences[e]}:{[e]:t[e]}).reduce((e,t)=>he(he({},e),t),{})}},{key:"connectorIcons",get:function(){return this.templateEntity?this.templateEntity.connectionReferenceIcons(this.props.assetService):[]}},{key:"dietDesignerInstanceKey",get:function(){return"dietDesignerInstance-".concat(this.dietDesignerInstantiationCount)}},{key:"flowEntity",get:function(){var{flowStore:e}=this.props;return e.flows.getEntity(this.flowName)}},{key:"footerButtons",get:function(){var{clientResources:e,hideCancelButton:t,widgetUtilService:n}=this.props,i=[{[De.AwaitingConsent]:{text:e.UserConsent.Continue,primary:!0,disabled:!1,onClick:this.onConsentClicked,allowDisabledFocus:!0},[De.Consenting]:{text:e.UserConsent.Consenting,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[De.ReviewingConnections]:{text:this.createFlowButtonText,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[De.LoadingDietDesigner]:{text:this.createFlowButtonText,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[De.FlowInputs]:{text:this.createFlowButtonText,primary:!0,disabled:!1,onClick:this.handleDietViewSaveClicked,allowDisabledFocus:!0},[De.CreatingFlow]:{text:e.FlowCreator.ButtonText.Creating,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[De.CreationCompleted]:{text:this.doneButtonOverrideText,primary:!0,disabled:!1,onClick:this.handleDoneClicked,allowDisabledFocus:!0},[De.PreparingToClose]:{text:e.InvokeFlowForm.ButtonText.Loading,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[De.Loading]:{text:e.InvokeFlowForm.ButtonText.Loading,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0}}[this.formState]];if(!t&&!n.isExcelOfficeScriptsSDXContext()&&this.formState!==De.CreationCompleted&&this.formState!==De.PreparingToClose){var o={text:e.Dialogs.RunFlow.Button.Cancel,onClick:this.handleCancelClicked,primary:!1,disabled:!1};i.push(o)}return i}},{key:"getSolutionId",get:function(){return this.flowCreationOptions.solutionId}},{key:"shouldUseDietDesignerView",get:function(){var{widgetUtilService:e}=this.props;return!!this.flowCreationOptions.shouldCreateFromFlowEntity||!!this.templateEntity&&!Object(le.d)(this.templateEntity,e)&&this.templateEntity.isDietTemplate(e)}},{key:"templateEntity",get:function(){var{templateStore:e}=this.props;return!!this.templateName&&e.templates.getEntity(this.templateName)||this._templateEntityFromTemplateDefinition||void 0}},{key:"templateParametersToReplace",get:function(){var e,{widgetUtilService:t}=this.props;return he(he({},t.isWidgetPage()?t.getWidgetDefaultParams():{}),null!==(e=this.flowCreationOptions.designTimeParameters)&&void 0!==e?e:{})}},{key:"templateTrigger",get:function(){return this.templateEntity&&this.templateEntity.properties&&Object(le.c)(this.templateEntity)}},{key:"templateTriggerType",get:function(){var{clientResources:e}=this.props;return Object(se.R)(this.templateTrigger)?e.Manage.Flows.Type.Scheduled:Object(se.J)(this.templateTrigger)?null:e.Manage.Flows.Type.Automated}},{key:"doneButtonOverrideText",get:function(){var{addDoneButtonText:e,clientResources:t,widgetUtilService:n}=this.props;return this.templateTriggerType===t.Manage.Flows.Type.Automated||this.templateTriggerType===t.Manage.Flows.Type.Scheduled||e?t.Common.Done:n.isWidgetPage()?n.getOverrideableString(t.Common.Done,te.b.FLOW_CREATION_DONE_BUTTON):""}},{key:"createFlowButtonText",get:function(){var{clientResources:e,widgetUtilService:t}=this.props;return t.isWidgetPage()&&t.widgetStrings&&t.widgetStrings[te.b.FLOW_CREATION_CREATE_BUTTON]?t.widgetStrings[te.b.FLOW_CREATION_CREATE_BUTTON]:e.Flow.CreateButtonLabel.Create}},{key:"flowDisplayNameLabelText",get:function(){var{clientResources:e,widgetUtilService:t}=this.props;return t.getOverrideableString(e.Flow.FlowDisplayNameLabel,te.b.FLOW_DISPLAY_NAME_LABEL)}},{key:"initialFlowDisplayName",get:function(){var{widgetUtilService:e}=this.props;return e.isWidgetPage()&&e.widgetStrings&&e.widgetStrings[te.b.FLOW_CREATION_CUSTOM_FLOW_NAME]||this.templateEntity&&this.templateEntity.displayName}},{key:"loadEnvironmentAndInitializeView",value:function(){var{environmentService:e,environmentStore:t}=this.props;return t.currentEnvironmentName||this.props.loggingService.logInfo("flowCreatorStoreV2.loadEnvironmentAndInitializeView","current environment name is not defined: ".concat(t.currentEnvironmentName)),e.loadEnvironment({forceRefresh:!0,environmentName:t.currentEnvironmentName}).then(()=>this.initializeForCdsProvisioningView())}}])&&be(t.prototype,n),i&&be(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"connectionConfirmationCallback",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=ve(i.prototype,"dietDesignerConnectionConfirmationCallback",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=ve(i.prototype,"dietDesignerInstantiationCount",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=ve(i.prototype,"errorMessage",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=ve(i.prototype,"flowPropertiesInputs",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=ve(i.prototype,"formState",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=ve(i.prototype,"inputParameters",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=ve(i.prototype,"isLoadingConnections",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=ve(i.prototype,"isTemplateDescriptionExpanded",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=ve(i.prototype,"getFlowDefinitionFromDietView",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=ve(i.prototype,"saveFlowFromDietView",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=ve(i.prototype,"selectedConnectionReferences",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=ve(i.prototype,"_templateEntityFromTemplateDefinition",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=ve(i.prototype,"templateName",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=ve(i.prototype,"flowCreationOptions",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve(i.prototype,"availableConnections",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"availableConnections"),i.prototype),ve(i.prototype,"connectionWizardConnectionReferences",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"connectionWizardConnectionReferences"),i.prototype),ve(i.prototype,"connectorIcons",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"connectorIcons"),i.prototype),ve(i.prototype,"dietDesignerInstanceKey",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"dietDesignerInstanceKey"),i.prototype),ve(i.prototype,"flowEntity",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"flowEntity"),i.prototype),ve(i.prototype,"footerButtons",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"footerButtons"),i.prototype),ve(i.prototype,"shouldUseDietDesignerView",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"shouldUseDietDesignerView"),i.prototype),ve(i.prototype,"templateEntity",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"templateEntity"),i.prototype),ve(i.prototype,"templateTrigger",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"templateTrigger"),i.prototype),ve(i.prototype,"templateTriggerType",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"templateTriggerType"),i.prototype),ve(i.prototype,"doneButtonOverrideText",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"doneButtonOverrideText"),i.prototype),ve(i.prototype,"createFlowButtonText",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"createFlowButtonText"),i.prototype),ve(i.prototype,"flowDisplayNameLabelText",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"flowDisplayNameLabelText"),i.prototype),ve(i.prototype,"initialFlowDisplayName",[_.computed],Object.getOwnPropertyDescriptor(i.prototype,"initialFlowDisplayName"),i.prototype),b=ve(i.prototype,"handleConnectionWizardStateChange",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{loggingService:t}=this.props;e===ne.a.failed&&t.logWarning("flowCreatorStoreV2.fixConnectionMessageDisplayed","Displaying message asking user to fix connections."),e!==ne.a.pending&&e!==ne.a.working||this.formState!==De.ReviewingConnections&&(this.resetDietDesigner(),this.setFormState(De.ReviewingConnections)),e!==ne.a.ready||this.isConnectionWizardConfirmClicked||(t.logInfo("flowCreatorStoreV2.handleConnectionWizardStateChange","Connection wizard state is ready, confirming connections and enabling diet designer."),this.handleConnectionsReady())}}}),y=ve(i.prototype,"handleDietDesignerConnectionWizardStateChange",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{loggingService:t}=this.props;e===ne.a.failed&&t.logWarning("flowCreatorStoreV2.handleDietDesignerConnectionWizardStateChange","Connection Wizard on Diet designer state is failed."),e!==ne.a.ready||this.isDietDesignerConnectionWizardConfirmClicked||(t.logInfo("flowCreatorStoreV2.handleDietDesignerConnectionWizardStateChange","Diet designer connections are ready, confirming and moving to inputs step."),this.isDietDesignerConnectionWizardConfirmClicked=!0,this.dietDesignerConnectionConfirmationCallback&&this.dietDesignerConnectionConfirmationCallback())}}}),v=ve(i.prototype,"handleNodeDoneLoadingParameters",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setFormState(De.FlowInputs)}}}),D=ve(i.prototype,"initializeFromTemplateDefinition",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{templateDefinition:t}=e,n=fe(e,pe),{clientResources:i,loggingService:o}=this.props,r=Object(ce.a)({templateDefinition:t,clientResources:i});return r?(o.logError("flowCreatorV2Store.initializeFromTemplateDefinition",new M.a(M.c.flowCreationWidgetInvalidCreateFromTemplateDefinitionArgs,r)),this.setErrorMessage(r),Promise.resolve()):(this._templateEntityFromTemplateDefinition=new Y.a(t),this.initialize(n))}}}),S=ve(i.prototype,"initializeFromTemplateName",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{templateName:t}=e,n=fe(e,ue),{loggingService:i}=this.props;return t?(this.templateName=t,this.initialize(n)):(i.logError("flowCreatorStoreV2.initializeFromTemplateName",new M.a(M.c.flowCreatorMissingTemplateName,"Must supply templateName when initializing from template name")),Promise.resolve())}}}),F=ve(i.prototype,"onTemplateDescriptionExpandToggled",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isTemplateDescriptionExpanded=e}}}),E=ve(i.prototype,"registerConnectionConfirmationCallback",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.connectionConfirmationCallback=e}}}),O=ve(i.prototype,"registerDietDesignerConnectionConfirmationCallback",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dietDesignerConnectionConfirmationCallback=e}}}),P=ve(i.prototype,"registerDietViewSaveFlowCallback",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFlowFromDietView=e}}}),z=ve(i.prototype,"registerGetFlowDefinition",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.getFlowDefinitionFromDietView=e}}}),T=ve(i.prototype,"setErrorMessage",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{clientResources:t}=this.props;this.errorMessage=Object(M.db)(e,t.Common.SomethingWentWrong)}}}),j=ve(i.prototype,"clearErrorMessage",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.errorMessage=void 0}}}),k=ve(i.prototype,"handleConnectionsReady",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return ge((function*(){var{loggingService:t,telemetryService:n}=e.props;if((n.tagEvent(X.c.FlowCreatorSurfaceSignInButtonClicked,null,he({},e.getBaseProfileData())),re()(e.connectionConfirmationCallback,"Connection confirmation callback is needed to jump from connection wizard view to diet view in diet designer, should be defined."),t.logInfo("flowCreatorStoreV2.handleContinueSignInClicked","Validating flow properties inputs before jumping to diet designer."),e.flowPropertiesInputs)&&!(yield Object(Z.g)({inputParameters:e.flowPropertiesInputs})))return t.logInfo("flowCreatorStoreV2.handleConnectionsReady","Flow display name inputted is invalid."),Promise.resolve();return e.connectionConfirmationCallback&&(e.isConnectionWizardConfirmClicked=!0,e.connectionConfirmationCallback()),Promise.resolve()}))}}),N=ve(i.prototype,"initialize",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{loggingService:t,sessionStore:n}=this.props;this.flowCreationOptions=e;var i=Object(A.a)(),o=!1;if(n.isAuthenticated)o=!0,i.resolve();else var r=Object(_.autorun)(()=>{n.isAuthenticated&&(i.resolve(),r())});return Object(G.b)({loggingService:t,promise:i.promise,eventStartName:H.a.flowCreatorV2WaitForUserSessionStart,eventEndName:H.a.flowCreatorV2WaitForUserSessionEnd,eventData:{alreadyAuthenticated:o}}).then(()=>this.initializeForAuthenticatedUser())}}}),R=ve(i.prototype,"initializeFlowPropertiesInput",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{allowCustomFlowDisplayName:e,clientResources:t,widgetUtilService:n}=this.props,i=new Z.a(t,t,t);e&&(this.flowPropertiesInputs={[ee.c.FlowDisplayName]:i.createInputParameter({type:Z.b.Text,label:this.flowDisplayNameLabelText,description:t.Common.Untitled,maxLength:$.a.NameMaxLength,isRequired:!1,initialValue:this.initialFlowDisplayName,singleLine:!0})},n.isWidgetPage()&&n.onFlowDisplayNameChangedByHost(this.flowPropertiesInputs[ee.c.FlowDisplayName].fieldState.onChange))}}}),I=ve(i.prototype,"initializeForCdsProvisioningView",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{environmentStore:{currentEnvironment:e},clientResources:t,loggingService:n}=this.props;null!=e&&e.isDatabaseReady?this.initializeForDietView():(n.logWarning("flowCreatorV2Store.initializeForCdsProvisioningView","Current environment database is not ready, waiting for provisioning not yet supported."),this.setErrorMessage(t.FlowCreator.CDSProvisioning.ErrorMessage))}}}),V=ve(i.prototype,"initializeForConsentedUser",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;this.setFormState(De.Loading),this.initializeConnections();var{featureFlags:n}=this.props;return(e||null!==(t=this.flowCreationOptions)&&void 0!==t&&t.shouldCreateFromFlowEntity?Promise.resolve():this.loadTemplate()).then(()=>{var e;return null!==(e=this.flowCreationOptions)&&void 0!==e&&e.shouldCreateFromFlowEntity||!n.enableAIBuilderInTeams||!Object(Q.a)(this.templateEntity.properties)?(this.initializeForDietView(),Promise.resolve()):this.loadEnvironmentAndInitializeView()}).catch(e=>{this.setErrorMessage(e)})}}}),L=ve(i.prototype,"initializeForNonConsentedUser",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{widgetUtilService:e,featureFlags:t,scenarioLoggingService:n}=this.props;this.setFormState(De.Loading);var i={consentSource:"flowCreatorStore",unconsentedMode:!!t.enableUnconsentedMode};return this.loadTemplate().then(()=>{e.isWidgetPage()&&e.fireConsentPromptLoaded(),this.setFormState(De.AwaitingConsent),n.tagEvent(K.c.UserConsentScenario,X.c.UserConsentDialogueShown,K.d.Pause,null,i)}).catch(e=>{i=he(he({},i),{},{error:e}),n.tagEvent(K.c.UserConsentScenario,X.c.UserConsentInterrupted,K.d.End,void 0,i),this.setErrorMessage(e)})}}}),U=ve(i.prototype,"resetDietDesigner",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.dietDesignerInstantiationCount++,this.dietDesignerConnectionConfirmationCallback=void 0,this.isDietDesignerConnectionWizardConfirmClicked=!1}}}),x=ve(i.prototype,"setFormState",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.formState=e}}}),W=ve(i.prototype,"setIsLoadingConnections",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isLoadingConnections=e}}}),B=ve(i.prototype,"setSelectedConnectionReferences",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedConnectionReferences=e}}}),i)}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/createPage~flowCreato~3750b677.6f1f1282.chunk.js.map