/*! For license information please see flowPage~myFlows~prot~9c2cab1f.5e3c11b8.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[196],{22765:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(11809),i=n(11897),o=Object(i.a)({teamName:r.a.PowerAutomateClientTeam,owners:["heguntert"],description:"When enabled, allows for Lightweight toggle to be visible on trigger and in flow kind section.",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1623351",createdOn:"6/15/2025",fallback:{isLightweightToggleVisible:!1}}),{getFeatureValue:a}=Object(i.b)(o,"isLightweightToggleVisible")},22939:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var r=n(20879),i=n(20882),o=n(14378),a=n(14648),c=n(17864),s=n(17289),u=n(22940),l=n(21878),p=n(12345),v=n(22943),f=n(17448),g=n(13087),d=n(15490),y=n(20968),h=n(14688),m=n(13e3),b=n(13231),w=n(13077),S=n(21017),O=n(21020),j=n(14325),P=n(21026),k=n(12999),E=n(15463),A=n(20924),C=n(22948),R=n(13202),T=n(13090),D=n(17873),F=n(17169),x=n(20915),N=n(17185),W=n(22952),I=n(15462),H=n(21018),q=n(15460),L=n(17213),K=n(22954);function V(e,t,n){var V=n?new I.a:q.b,G=n?new H.a(g.a,p.a,V,O.a):S.a,M=n?K.b:K.a,U=n?L.b:L.a;return{aiFlowsResources:e,analyticsService:T.a,apiOperationService:Object(A.a)(),apiService:Object(r.a)(),apiStore:i.a,appSettings:Object(j.b)(),assetService:o.a,cdnService:a.a,connectionStore:c.a,connectionHttpClient:D.a,consentService:F.a,copilotFlowActivityService:s.a,copilotFlowRunService:u.a,designerConnectionStore:x.a,designerCreateContext:Object(P.a)(t),dynamicListStore:l.a,environmentStore:p.a,featureFlags:Object(k.a)(),clientResources:t,generateSuggestionsService:v.a,graphService:f.a,knowledgeService:C.a,loggingService:g.a,navigationService:d.a,oAuthService:y.a,ppapiClient:W.a,ppapiService:h.a,routeCrafter:N.a,sessionStore:m.a,surfaceStore:R.a,telemetryService:b.a,tokenService:w.a,xrmConnectionReferenceService:G,xrmConnectionReferenceStore:O.a,xrmWorkflowHttpClient:E.a,flowService:U,xrmWorkflowMetadataService:M,xrmEntityHttpClient:V}}},22940:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(13087),i=n(22941),o=n(17293),a=new i.a(r.a,o.a)},22941:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(22942),i=n(17291),o=n(13009),a=n(12327);function c(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){c(o,r,i,a,s,"next",e)}function s(e){c(o,r,i,a,s,"throw",e)}a(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.copilotFlowRunHttpClient=n}var t,n,c,l,p,v,f,g,d;return t=e,(n=[{key:"startValidationRunAsync",value:(d=s((function*(e,t){return(yield this.copilotFlowRunHttpClient.startValidationRunAsync(e,t)).runId})),function(e,t){return d.apply(this,arguments)})},{key:"confirmUserActionAsync",value:(g=s((function*(e,t,n,a){var c=this.loggingService.profileStart(i.a.FlowRunService.confirmUserActionAsyncStart,{flowId:e,runId:t,actionId:n});try{var s=yield this.copilotFlowRunHttpClient.confirmUserActionAsync(e,t,n,a);return this.loggingService.profileEndWithSuccess(c,i.a.FlowRunService.confirmUserActionAsyncEnd,{flowId:e,runId:t,actionId:n}),Object(r.a)(s)}catch(u){throw this.loggingService.profileEnd(c,i.a.FlowRunService.confirmUserActionAsyncEnd,Object(o.y)(u),u,{flowId:e,runId:t,actionId:n}),u.message}})),function(e,t,n,r){return g.apply(this,arguments)})},{key:"cancelFlowRunAsync",value:(f=s((function*(e,t){try{var n=yield this.copilotFlowRunHttpClient.cancelFlowRunAsync(e,t);return Object(r.a)(n)}catch(i){throw i.message}})),function(e,t){return f.apply(this,arguments)})},{key:"getAllFlowRunActionsAsync",value:(v=s((function*(e,t,n){var r=[],i=yield this.getFlowRunActionsAsync(e,t,n);if(0===i.value.length)return r;var o=JSON.stringify(i.value);r.push(...JSON.parse(o));for(var a=i.nextLink;a&&a.length>0;){var c=this.callNextLinkForFlowRunActionsAsync(a,n);o=JSON.stringify(i.value),r.push(...JSON.parse(o)),a=(yield c).nextLink}return r})),function(e,t,n){return v.apply(this,arguments)})},{key:"getFlowRunActionsAsync",value:(p=s((function*(e,t,n){try{return yield this.copilotFlowRunHttpClient.getFlowRunActionsAsync(e,t,n)}catch(o){if(o&&(r=o,i=e=>Object(a.h)(e,{message:a.k}),Object(a.h)(r,{response:e=>Object(a.h)(e,{data:i})})))throw o.response.data.message;throw o.message}var r,i})),function(e,t,n){return p.apply(this,arguments)})},{key:"callNextLinkForFlowRunActionsAsync",value:(l=s((function*(e,t){try{return yield this.copilotFlowRunHttpClient.callNextLinkForFlowRunActionsAsync(e,t)}catch(n){throw n.message}})),function(e,t){return l.apply(this,arguments)})}])&&u(t.prototype,n),c&&u(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22942:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=e=>e>=200&&e<300},22943:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(22944),i=n(13087),o=new(n(22946).a)(i.a,r.a)},22944:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13192),i=n(13e3),o=n(13087),a=n(13077),c=n(12345),s=new(n(22945).a)(o.a,new r.HttpClient,i.a,c.a,a.a)},22945:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(13215),i=n(11795),o=n(13227),a=n(14692),c=n(17295),s=n(17296);function u(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,i)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,n,l,p,v){var f=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.httpClient=n,this.sessionStore=l,this.environmentStore=p,this.tokenService=v,this.ppapiDiscovery=void 0,this.generateSuggestionsAsync=function(){var e,t=(e=function*(e,t){var n=Object(c.a)("flows/generate",f.ppapiEnv);return(yield f.httpClient.post({url:n,headers:s.a,eventName:"PPAPI:POST/COPILOTFLOWS/GENERATESUGGESTIONS",data:JSON.stringify(e),cancelToken:t.token})).data},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){u(o,r,i,a,c,"next",e)}function c(e){u(o,r,i,a,c,"throw",e)}a(void 0)}))});return function(e,n){return t.apply(this,arguments)}}();var g,{region:d}=Object(i.h)(),y=Object(o.a)(d,this.environmentStore.currentEnvironment);this.ppapiDiscovery=new a.a(y);try{g=this.ppapiDiscovery.getTokenAudience()}catch(h){this.loggingService.logError("GenerateSuggestionsHttpClient.constructor",h,{region:d})}[Object(r.f)(t,()=>this.sessionStore.sessionId),Object(r.c)(()=>this.tokenService.getAccessToken(g))].forEach(e=>this.httpClient.addRequestInterceptor(e)),this.httpClient.addResponseInterceptor(Object(r.g)(this.loggingService,this.sessionStore),Object(r.e)(this.loggingService,this.sessionStore))}var t,n,p;return t=e,(n=[{key:"ppapiEnv",get:function(){return this.ppapiDiscovery.getEnvironmentEndpoint(this.environmentStore.currentEnvironmentName)}}])&&l(t.prototype,n),p&&l(t,p),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22946:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(22947),i=n(13009);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)}))}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=e=>e?Object.entries(e).sort((e,t)=>{var[,n]=e,[,r]=t,i=n["x-ms-isSuggested"]||!1;return i===(r["x-ms-isSuggested"]||!1)?0:i?1:-1}).reduce((e,t)=>{var[n,r]=t;return e[n]=r,e},{}):{},f=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.generateSuggestionsHttpClient=n}var t,n,o,c,s;return t=e,(n=[{key:"generateWithPromptOnlyAsync",value:(s=u((function*(e,t){var n,i={clientData:{definition:{plan:e}}};try{var o,c,s,u,l,p,f,g=yield this.generateSuggestionsHttpClient.generateSuggestionsAsync(i,t),d=Object(r.a)(this.loggingService,g);return a(a({},d),{},{name:"".concat(d.name||"","_").concat(Object(r.b)()),inputs:{schema:a(a({},null===(o=d.inputs)||void 0===o?void 0:o.schema),{},{properties:v(null===(c=d.inputs)||void 0===c||null===(c=c.schema)||void 0===c?void 0:c.properties)})},outputs:{schema:a(a({},null===(s=d.outputs)||void 0===s?void 0:s.schema),{},{properties:v(null===(u=d.outputs)||void 0===u||null===(u=u.schema)||void 0===u?void 0:u.properties)})},clientData:a(a({},d.clientData),{},{definition:a(a({},null===(l=d.clientData)||void 0===l?void 0:l.definition),{},{plan:(null===(p=d.clientData)||void 0===p||null===(p=p.definition)||void 0===p?void 0:p.plan)||"",variables:(n=null===(f=d.clientData)||void 0===f||null===(f=f.definition)||void 0===f?void 0:f.variables,n?n.sort((e,t)=>{var n=e["x-ms-isSuggested"]||!1;return n===(t["x-ms-isSuggested"]||!1)?0:n?1:-1}):[])})})})}catch(y){this.handleGenerateError(y)}})),function(e,t){return s.apply(this,arguments)})},{key:"generateAsync",value:(c=u((function*(e,t){try{return yield this.generateSuggestionsHttpClient.generateSuggestionsAsync(e,t)}catch(n){this.handleGenerateError(n)}})),function(e,t){return c.apply(this,arguments)})},{key:"handleGenerateError",value:function(e){var t,n,r,o,a=e;if((null==a||null===(t=a.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.ErrorCode)===i.c.TokenExceededLimit)throw null===(o=a.response)||void 0===o?void 0:o.data;throw null!==(n=null==a||null===(r=a.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.Message)&&void 0!==n?n:e}}])&&l(t.prototype,n),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22947:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));n(12246);var r=n(18856),i=n(17291),o=(n(18816),(e,t,n)=>(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,t),n)),a={clientData:{definition:{plan:"",variables:[]},connectionReferences:{},knowledge:[]},inputs:{schema:{type:"",properties:{}}},outputs:{schema:{type:"",properties:{}}}},c=(e,t)=>{var n=t||o(e,"Flow is missing",a);return n.clientData=n.clientData||o(e,"Client data missing",a.clientData),n.clientData.definition=n.clientData.definition||o(e,"Definition missing",a.clientData.definition),n.clientData.definition.plan=n.clientData.definition.plan||o(e,"Plan missing",a.clientData.definition.plan),n.clientData.definition.variables=s(e,n.clientData.definition.variables),n.clientData.connectionReferences=n.clientData.connectionReferences||o(e,"Connection References missing",a.clientData.connectionReferences),n.clientData.knowledge=n.clientData.knowledge||o(e,"Knowledge missing",a.clientData.knowledge),n.inputs=n.inputs||o(e,"Inputs missing",a.inputs),n.inputs.schema=n.inputs.schema||o(e,"Input schema missing",a.inputs.schema),n.inputs.schema.type=n.inputs.schema.type||o(e,"Input schema type missing",a.inputs.schema.type),n.inputs.schema.properties=u(e,n.inputs.schema.properties,r.b.inputs),n.outputs=n.outputs||o(e,"Outputs missing",a.outputs),n.outputs.schema=n.outputs.schema||o(e,"Output schema missing",a.outputs.schema),n.outputs.schema.type=n.outputs.schema.type||o(e,"Output schema type missing",a.outputs.schema.type),n.outputs.schema.properties=u(e,n.outputs.schema.properties,r.b.outputs),n},s=(e,t)=>(t||o(e,"Variables missing",a.clientData.definition.variables)).filter(t=>{var n=!0;return Object.prototype.hasOwnProperty.call(t,"name")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"Variable name missing"),n=!1),Object.prototype.hasOwnProperty.call(t,"type")?(Object.prototype.hasOwnProperty.call(t.type,"group")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"Variable type group missing"),n=!1),Object.prototype.hasOwnProperty.call(t.type,"kind")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"Variable type kind missing"),n=!1)):(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"Variable type missing"),n=!1),Object.prototype.hasOwnProperty.call(t,"value")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"Variable value missing"),n=!1),Object.prototype.hasOwnProperty.call(t,"x-ms-isSuggested")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"Variable suggested missing"),n=!1),n}),u=(e,t,n)=>{var r=t||o(e,"".concat(n," properties is missing"),a[n].schema.properties);for(var c in r)if(Object.prototype.hasOwnProperty.call(r,c)){var s=!0;Object.prototype.hasOwnProperty.call(r[c],"title")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"".concat(n," title missing")),s=!1),Object.prototype.hasOwnProperty.call(r[c],"type")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"".concat(n," type missing")),s=!1),Object.prototype.hasOwnProperty.call(r[c],"x-ms-isSuggested")||(e.logWarning(i.a.GenerateSuggestionService.generateBodyValidationError,"".concat(n," suggested missing")),s=!1),s||delete r[c]}return r},l=()=>{var e=new Date,t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),o=String(e.getUTCMinutes()).padStart(2,"0"),a=String(e.getUTCSeconds()).padStart(2,"0");return"".concat(t).concat(n).concat(r).concat(i).concat(o).concat(a)}},22948:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22949),i=n(13087),o=n(22950),a=new r.a(i.a,o.a)},22949:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(17291),i=n(13009);function o(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function c(e){o(a,r,i,c,s,"next",e)}function s(e){o(a,r,i,c,s,"throw",e)}c(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.knowledgeHttpClient=n}var t,n,o,s,u;return t=e,(n=[{key:"saveKnowledgeDocumentAsync",value:(u=a((function*(e,t){var n=this.loggingService.profileStart(r.a.KnowledgeService.saveKnowledgeDocumentAsyncStart,{workflowId:e});try{var o=yield this.knowledgeHttpClient.saveKnowledgeDocumentAsync(e,t);return this.loggingService.profileEndWithSuccess(n,r.a.KnowledgeService.saveKnowledgeDocumentAsyncEnd),o}catch(s){var a;this.loggingService.profileEnd(n,r.a.KnowledgeService.saveKnowledgeDocumentAsyncError,Object(i.y)(s),s,{flowId:e});var c=s.response.data;throw null!==(a=c.Message)&&void 0!==a?a:c}})),function(e,t){return u.apply(this,arguments)})},{key:"deleteKnowledgeDocumentAsync",value:(s=a((function*(e,t){var n=this.loggingService.profileStart(r.a.KnowledgeService.deleteKnowledgeDocumentAsyncStart,{workflowId:e});try{var o=yield this.knowledgeHttpClient.deleteKnowledgeDocumentAsync(e,t);return this.loggingService.profileEndWithSuccess(n,r.a.KnowledgeService.deleteKnowledgeDocumentAsyncEnd),o}catch(s){var a;this.loggingService.profileEnd(n,r.a.KnowledgeService.deleteKnowledgeDocumentAsyncError,Object(i.y)(s),s,{flowId:e});var c=s.response.data;throw null!==(a=c.Message)&&void 0!==a?a:c}})),function(e,t){return s.apply(this,arguments)})}])&&c(t.prototype,n),o&&c(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22950:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13192),i=n(13e3),o=n(13087),a=n(13077),c=n(12345),s=new(n(22951).a)(o.a,new r.HttpClient,i.a,c.a,a.a)},22951:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(13215),i=n(11795),o=n(13227),a=n(14692),c=n(17295),s=n(17296),u=n(22942);function l(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){l(o,r,i,a,c,"next",e)}function c(e){l(o,r,i,a,c,"throw",e)}a(void 0)}))}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g=function(){function e(t,n,l,v,f){var g=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.httpClient=n,this.sessionStore=l,this.environmentStore=v,this.tokenService=f,this.ppapiDiscovery=void 0,this.saveKnowledgeDocumentAsync=function(){var e=p((function*(e,t){var n=Object(c.a)("flows/".concat(e,"/knowledge"),g.ppapiEnv),r={Name:t.name,Data:t.data};return(yield g.httpClient.post({url:n,headers:s.a,eventName:"PPAPI:POST/COPILOTFLOWS/KNOWLEDGE",data:JSON.stringify(r)})).data}));return function(t,n){return e.apply(this,arguments)}}(),this.deleteKnowledgeDocumentAsync=function(){var e=p((function*(e,t){var n=Object(c.a)("flows/".concat(e,"/knowledge/").concat(t.name),g.ppapiEnv),r=yield g.httpClient.delete({url:n,headers:s.a,eventName:"PPAPI:DELETE/COPILOTFLOWS/KNOWLEDGE"});return Object(u.a)(r.status)}));return function(t,n){return e.apply(this,arguments)}}();var d,{region:y}=Object(i.h)(),h=Object(o.a)(y,v.currentEnvironment);this.ppapiDiscovery=new a.a(h);try{d=this.ppapiDiscovery.getTokenAudience()}catch(m){this.loggingService.logError("KnowledgeHttpClient.constructor",m,{region:y})}[Object(r.f)(t,()=>this.sessionStore.sessionId),Object(r.c)(()=>this.tokenService.getAccessToken(d))].forEach(e=>this.httpClient.addRequestInterceptor(e)),this.httpClient.addResponseInterceptor(Object(r.g)(this.loggingService,this.sessionStore),Object(r.e)(this.loggingService,this.sessionStore))}var t,n,l;return t=e,(n=[{key:"ppapiEnv",get:function(){return this.ppapiDiscovery.getEnvironmentEndpoint(this.environmentStore.currentEnvironmentName)}}])&&v(t.prototype,n),l&&v(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22952:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(22953),i=n(12339),o=n(13077),a=n(13090),c=n(14688),s=new r.a(a.a,Object(i.b)(),c.a,o.a)},22953:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(19699),i=n(14697),o=n(12375),a=n(13144),c=n(13007),s=n(20754);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t,n,u,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._client=void 0;var p=Object(o.a)(),v=Object(c.a)(Object(a.c)(n).powerAppsRP),f=()=>l.getAccessToken(n.authResource);this._client=r.e.createInstance({analytics:t,baseUrl:v,getAccessToken:f,locale:p}),Object(i.a)()&&this._client.setBeforeRequestHandler(Object(s.b)(v,t,u,f,()=>l.getAccessToken(u.getTokenAudience())))}var t,n,l;return t=e,(n=[{key:"dispose",value:function(){this._client.dispose()}},{key:"addEnvFilterToRequest",value:function(e,t){var n;t&&(e.query||(e.query={}),n=e.query.$filter?"".concat(e.query.$filter," and environment eq '").concat(t,"'"):"environment eq '".concat(t,"'")),e.query&&(e.query.$filter=n)}},{key:"tryExecutePPAPIClient",value:function(e,t){return this._client.execute(e,t)}}])&&u(t.prototype,n),l&&u(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22954:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(22955),i=n(15460),o=n(15462),a=new r.a(i.b),c=new r.a(new o.a)},22955:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(14843),i=n(13012),o=n(13010),a=n(14845),c=n(13037);function s(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)}))}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v="workflowmetadata",f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.xrmEntityHttpClient=t}var t,n,s,p,f,g,d,y;return t=e,(n=[{key:"upsertWorkflowMetadata",value:(y=u((function*(e,t,n,c){var s=Object(r.z)(e,t,n),u="".concat(t,"/").concat(n);if(c.length<=r.A){var l=yield this.xrmEntityHttpClient.updateRecord(v,s,{valuetype:r.i.SQL,value:c,name:u},void 0,!0);if(Object(a.i)(l))return l.data;throw new i.a(o.b.xrmApiRequestFailed,JSON.stringify(l.data))}return yield this.bulkSaveLargeWorkflowMetadata(e,t,n,c,{requestType:a.a.PATCH,path:"".concat(v,"(").concat(s,")"),body:{valuetype:r.i.File,name:u},useChangeSetRequestStartPattern:!0})})),function(e,t,n,r){return y.apply(this,arguments)})},{key:"createWorkflowMetadata",value:(d=u((function*(e,t,n,c){var s="".concat(t,"/").concat(n);if(c.length<=r.A){var u=yield this.xrmEntityHttpClient.createRecord(v,{"WorkflowId@odata.bind":"/workflows(".concat(e,")"),type:t,propertykey:n,valuetype:r.i.SQL,value:c,name:s},void 0,!0);if(Object(a.i)(u))return u.data;throw new i.a(o.b.xrmApiRequestFailed,JSON.stringify(u.data))}return yield this.bulkSaveLargeWorkflowMetadata(e,t,n,c,{requestType:a.a.POST,path:v,body:{"WorkflowId@odata.bind":"/workflows(".concat(e,")"),type:t,propertykey:n,valuetype:r.i.File,name:s},useChangeSetRequestStartPattern:!0})})),function(e,t,n,r){return d.apply(this,arguments)})},{key:"bulkSaveLargeWorkflowMetadata",value:(g=u((function*(e,t,n,s,u){var l,p,f=Object(r.z)(e,t,n),g=[{requests:[u,{requestType:a.a.PATCH,path:"".concat(v,"(").concat(f,")/filevalue"),body:s,useChangeSetRequestStartPattern:!0,excludePreferHeader:!0}]}],d=yield this.xrmEntityHttpClient.batchRequests(g,!1,u.requestType===a.a.POST?"CREATEWORKFLOWMETADATA":"UPSERTWORKFLOWMETADATA"),y=[u.requestType===a.a.POST?c.a.Created:[c.a.Ok,c.a.Created],c.a.NoContent],h=Object(a.n)(f,d.data,y,0);if(h.value)return h.value.filevalue=s,h.value;throw new i.a(o.b.xrmApiRequestFailed,null!==(l=null===(p=h.failureLogReason)||void 0===p?void 0:p.message)&&void 0!==l?l:"",void 0,h.error)})),function(e,t,n,r,i){return g.apply(this,arguments)})},{key:"retrieveWorkflowMetadata",value:(f=u((function*(e,t,n){var s=Object(r.z)(e,t,n),u=yield this.xrmEntityHttpClient.retrieveRecord(v,s);if(u.status!==c.a.NotFound){if(!Object(a.i)(u))throw new i.a(o.b.xrmApiRequestFailed,JSON.stringify(u.data));if(u.data.valuetype===r.i.File){var l=yield this.xrmEntityHttpClient.retrieveRecordFile(v,s,"filevalue");if(!Object(a.i)(l))throw new i.a(o.b.xrmApiRequestFailed,JSON.stringify(l.data));var p=l.data.value;u.data.filevalue=atob(p)}return u.data}})),function(e,t,n){return f.apply(this,arguments)})},{key:"deleteWorkflowMetadata",value:(p=u((function*(e,t,n){var s=Object(r.z)(e,t,n),u=yield this.xrmEntityHttpClient.deleteRecord(v,s);if(!Object(a.i)(u)&&u.status!==c.a.NotFound)throw new i.a(o.b.xrmApiRequestFailed,JSON.stringify(u.data))})),function(e,t,n){return p.apply(this,arguments)})}])&&l(t.prototype,n),s&&l(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/flowPage~myFlows~prot~9c2cab1f.5e3c11b8.chunk.js.map