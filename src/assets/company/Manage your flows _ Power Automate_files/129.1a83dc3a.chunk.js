/*! For license information please see 129.1a83dc3a.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{14980:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var n=i(11766),o=i(14982),r=i(14984),a=i(13243),s=i(13242),l=i(13262),c=i(12811),p=i(14983),u=i(14981);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,n=b(e);if(t){var o=b(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return v(this,i)}}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){return e[e.connectionTitleMin=150]="connectionTitleMin",e[e.connectionTitleMax=250]="connectionTitleMax",e[e.connectionControlsMin=70]="connectionControlsMin",e[e.connectionControlsMax=82]="connectionControlsMax",e}({}),C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(b,e);var t,i,m,v=h(b);function b(){var e;d(this,b);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=v.call(this,...i)).getColumns=()=>[{key:"connectionTitle",name:null,isRowHeader:!0,minWidth:y.connectionTitleMin,columnActionsMode:o.b.disabled,isCollapsible:!1,isPadded:!1,onRender:e.onRenderIconColumn},{key:"connectionStatus",name:null,minWidth:y.connectionControlsMin,maxWidth:y.connectionControlsMax,isCollapsible:!1,columnActionsMode:o.b.disabled,isPadded:!1,onRender:e.renderConnectionStatus}],e.onRenderIconColumn=e=>{var t=Object(u.a)();return n.createElement(n.Fragment,null,n.createElement("img",{className:t.icon,"aria-hidden":"true",role:"presentation",src:e.iconUri,alt:e.displayName}),n.createElement("div",{className:t.displayNameContainer},n.createElement("div",{className:t.displayName,title:e.displayName},e.displayName)))},e.renderConnectionStatus=()=>{var{isLoading:t,loadingToolTipText:i}=e.props,o=Object(u.a)();return t?n.createElement("div",{className:Object(c.a)(o.statusIconContainer,o.cellRoot)},n.createElement(l.a,{content:i},n.createElement(a.a,{className:o.statusIcon,size:s.a.small}))):null},e}return t=b,(i=[{key:"render",value:function(){var{icons:e}=this.props,t=Object(u.a)(),i={items:e,columns:this.getColumns(),getKey:w,isHeaderVisible:!1,indentWidth:0,selectionMode:p.d.none,layoutMode:o.e.justified};return n.createElement("div",{className:t.root},n.createElement(r.a,i))}}])&&f(t.prototype,i),m&&f(t,m),Object.defineProperty(t,"prototype",{writable:!1}),b}(n.Component),w=(e,t)=>"".concat(e.iconUri,"-").concat(t)},14981:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(12754),o=()=>Object(n.db)({root:["fl-connectionList-root",{".ms-DetailsRow:hover":{backgroundColor:"unset"},".ms-DetailsRow-cell":{display:"flex",alignItems:"center",paddingLeft:0}}],icon:["fl-connectionList-icon",{height:32,width:32,minWidth:32,boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.15)",borderRadius:3}],displayNameContainer:["fl-connectionList-displayNameContainer",{marginLeft:16,minWidth:0,overflow:"hidden"}],displayName:["fl-connectionList-displayName",{fontSize:14,fontWeight:600,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",minWidth:0}],cellRoot:["fl-connectionList-cellRoot",{display:"flex",alignItems:"center"}],statusIconContainer:["fl-connectionList-statusIconContainer",{marginLeft:"auto",paddingRight:8}],statusIcon:["fl-connectionList-statusIcon",{}]})},2e4:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e.ConnectionWizard="ConnectionWizard",e.DisplayingFlowInputs="DisplayingFlowInputs",e.CreatingFlow="CreatingFlow",e}({})},20103:function(e,t,i){"use strict";i.d(t,"c",(function(){return le})),i.d(t,"a",(function(){return ce})),i.d(t,"b",(function(){return ue}));var n,o,r,a,s,l,c,p=i(12330),u=i(12331),d=i(11766),f=i(11773),m=i(14337),g=i(12811),h=i(20104),v=i(20105),b=i(13241),y=i(20106),C=i(20107),w=i(17228),S=i(14875),O=i(20791),D=i(20803),F=i(20799),P=i(13085),x=i(13009),E=i(13240),T=i(18951),I=i(13143),k=i(17266),R=i(18950),j=i(20807),N=i(20808),A=i(14877),z=i(19997),M=i(16926),B=(i(20098),i(14867)),W=i(15478),L=i.n(W),U=i(20809),V=i(12324),_=i(18956),H=i(20811),X=i(15425),q=i(17252),K=i(15420);function G(e,t,i,n,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function J(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var r=e.apply(t,i);function a(e){G(r,n,o,a,s,"next",e)}function s(e){G(r,n,o,a,s,"throw",e)}a(void 0)}))}}function Y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function $(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,se(n.key),n)}}function Q(e,t){return(Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,n=ie(e);if(t){var o=ie(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ee(this,i)}}function ee(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return te(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e,t,i,n,o){var r={};return Object.keys(n).forEach((function(e){r[e]=n[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}function oe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function re(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(i),!0).forEach((function(t){ae(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):oe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ae(e,t,i){return(t=se(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function se(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var le=function(e){return e[e.Normal=0]="Normal",e[e.Compact=1]="Compact",e}({});var ce=Object(m.c)((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(W,e);var t,i,n,o,m,R=Z(W);function W(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,W),(t=R.call(this,e)).dietDesignerHostRef=d.createRef(),t.designerScriptDownloadPromise=void 0,t.designerScripts=void 0,t.designerOnConnectionsChangeSubscription=void 0,t.dietDesigner=void 0,t.previousConnectionWizardConnections=void 0,t.hasDesignerInitializationBegun=void 0,t.solutionIdToPass=void 0,t.defaultedToSolutionFlow=void 0,t.loadDietDesignerStylesManually=void 0,Y(t,"dietDesignerInitialized",r,te(t)),Y(t,"xrmConnectionReferencesFetched",a,te(t)),Y(t,"shouldDefaultToSolutionFlowResultFetched",s,te(t)),Y(t,"failedToLoad",l,te(t)),Y(t,"hasConnectionWizardBeenRendered",c,te(t)),t.handleConnectionsChanged=()=>{var{flowCreatorContext:{loggingService:e},onConnectionsUpdatedByDesigner:i}=t.props,n=t.getConnectionsFromDesignerConnectionStore(),o=Object(y.a)({previousConnections:t.previousConnectionWizardConnections,currentConnections:n});0!==o.length&&(e.logInfo("DietDesigner.handleConnectionsChanged","Detected change in the designer connection store"),t.previousConnectionWizardConnections=n,i(o))},t.initializeDietDesigner=()=>{var{flowCreatorContext:{loggingService:e},templateParameters:i,onError:n,templateEntity:o,flowEntity:r}=t.props;t.hasDesignerInitializationBegun=!0,t.designerScriptDownloadPromise.then(n=>{t.designerScripts=n,t.setFailedToLoad(!1),t.dietDesigner&&t.dietDesigner.dispose();var a,s,l,c=t.createDesignerConfig({connections:t.getDietDesignerConnections});if(t.dietDesigner=Object(C.a)(c),t.shouldLoadFromFlowEntity())a={definition:r.definition,properties:{sku:{name:"Consumption"}}},s=r.connectionReferences||{};else{if(Object(p.a)(o))throw Error("TemplateEntity and FlowEntity are both undefined. Please define at least one.");var d=o.toJS();a={definition:d.properties.definition,properties:{sku:{name:"Consumption"}}},s=d.properties.connectionReferences,l=d.properties.metadata&&d.properties.metadata.dietDesignerMarkup}a.definition=Object(w.f)(Object(f.toJS)(a.definition),i);var m=Object(U.a)(e,Object(V.pickBy)(s),t.isXrmConnectionReferenceMode);a.connectionReferences=Object(u.a)(s).reduce((e,t)=>{var i=re(re({},s[t]),m[t]);return m[t]&&i.connectionId&&(i.connectionId=m[t].connection.id),e[t]=i,e},{});var g={expandAllCards:!1,skipValidation:!0,dietDesignerMarkup:l,initFromTemplate:!0,collapsePopulatedParameters:!0};return t.dietDesigner.loadWorkflow(a,g)}).then(()=>{t.setDietDesignerInitialized(!0),t.dietDesigner.render(),t.previousConnectionWizardConnections=t.getConnectionsFromDesignerConnectionStore(),t.subscribeToDesignerConnectionChanges()}).catch(i=>{n(i),t.setFailedToLoad(!0),e.logError("DietDesigner.initializeDietDesigner",i)})},t.downloadDesignerScripts=()=>{var{flowCreatorContext:{appSettings:e,loggingService:i,featureFlags:n}}=t.props;return t.props.loadDesignerScripts(n,e,i)},t.createDesignerConfig=e=>{var i,n,{connections:o}=e;if(t.designerScripts&&t.dietDesignerHostRef.current){var r,{flowCreatorContext:a,flowCreatorContext:{appSettings:s,clientResources:l,designerOperationsService:c,designerOperationsStore:u,designerConnectionStore:d,designerUserPreferenceServiceFactory:f,dynamicListStore:m,graphService:g,loggingService:h,sessionStore:v,telemetryService:b,tokenService:y,oAuthService:C,ppapiService:w,featureFlags:P,environmentStore:x,apiOperationService:E,assetService:T,widgetUtilService:I,flowStore:k,xrmWorkflowHttpClient:R},size:j,registerConnectionConfirmationCallback:N,templateEntity:z,flowEntity:M,onNodesDoneLoading:B,onRenderParameterContainerLoading:W,registerSaveFlowCallback:L,showParametersInCards:U}=t.props,V=Object(p.a)(z)?void 0:z.toJS();return{appSettings:s,featureFlags:P,designercore:t.designerScripts.designercore,designerElement:t.dietDesignerHostRef.current,environment:{name:x.currentEnvironmentName,features:(null===(i=x.environmentClaim)||void 0===i?void 0:i.features)||{}},apiOperationAuthoringBehavior:t.shouldLoadFromFlowEntity()||Object(p.a)(V)?A.a.Default:Object(S.f)(V.properties.definitionSummary,!!t.solutionIdToPass),connectorV2ServiceFactory:()=>new O.a(!0,l,(null==M?void 0:M.flowName)||null,h,o,g,new H.a(R),x,y,d,m,k,()=>v.user,t.isXrmConnectionReferenceMode),operationManifestServiceFactory:()=>new D.b(E,l,x,null,h,c,u,T,y,w),getArmAccessToken:()=>y.getAccessToken(s.authResource),getFunctionsRPAccessToken:()=>y.getAccessToken(s.functionsAuthResource),getRuntimeAccessToken:()=>y.getAccessToken(s.apiHubsRuntimeResource),getConsentServerAccessToken:()=>y.getAccessToken(s.consentServerAadResourceUri),azureADServiceFactory:e=>new F.a(g,h),getPPAPIAccessToken:()=>y.getAccessToken(w.getTokenAudience()),oAuthService:C,ppapiService:w,prefetchedData:{connections:o,connectionProviders:(r=(t.shouldLoadFromFlowEntity()?null==M?void 0:M.connectionReferences:null==V?void 0:V.properties.connectionReferences)||{},Object.values(r||{}).map(e=>re({properties:{}},e.api||e.apiDefinition||e)))},canAddOperation:()=>Promise.resolve(!0),telemetryService:b,connectionWizardUIConfig:{defaultAccountDisplayName:null===(n=v.user)||void 0===n?void 0:n.displayName,forceNarrowWidth:j===le.Compact,hideConnectionWizardHeader:!0,onConnectionWizardStateChange:t.onConnectionWizardStateChange,hideConnectionDisplayName:!1,hideContinueButton:!0,registerConnectionConfirmationCallback:N,enableFabricStyle:!0,autoSignInOnLoad:!0},showViewPermissionsDialog:t.handleShowPermissionsDialog,onFirstPartyConnectionFailureCallback:t.handleFirstPartyConnectionFailure,userPreferenceServiceFactory:()=>f.createDesignerUserPreferenceService(),templateName:null==V?void 0:V.name,flowManagementServiceFactory:e=>({saveFlow:t.saveFlowFromDesignerFlowDefinition}),dietViewServiceFactory:e=>({hideEditInAdvancedModeLink:!0,onDietViewStateChange:t.handleDietViewStateChange,hideCreateButton:!0,registerSaveFlowCallback:L,enableTokenPicker:I.isExcelSDXContext(),onNodesDoneLoading:B,onRenderParameterContainerLoading:W}),enableDietDesigner:!0,useDietDesignerParameterCards:U,isXrmConnectionReferenceMode:t.isXrmConnectionReferenceMode,solutionId:t.solutionIdToPass,visibleHideKeys:[],context:pe(a)}}},t.handleDietViewStateChange=(e,i,n)=>{var o;t.props.onDietViewStateChange(e,i,n),null===(o=t.dietDesignerHostRef.current)||void 0===o||o.focus()},t.onConnectionWizardStateChange=e=>{var{onConnectionWizardStateChange:i}=t.props;i&&i(e),t.setHasConnectionWizardBeenRendered(!0)},t.saveFlowFromDesignerFlowDefinition=e=>{var i,{flowCreatorContext:{loggingService:n},getFlowDisplayName:o,templateEntity:r,onFlowCreationSuccessful:a,onError:s,shouldNotCreateFlow:l,onFlowCreationError:c}=t.props,p={fromTemplate:null==r?void 0:r.name,solutionId:t.solutionIdToPass,usingFlowEntity:t.shouldLoadFromFlowEntity(),defaultedToSolution:t.defaultedToSolutionFlow},u=n.profileStart(P.a.dietViewSaveFlowStart,p);return t.getFlowDefinitionFromDesigner(e).then(e=>{if(o){var r=o();n.logInfo("DietDesigner.saveFlowFromDesignerFlowDefinition","saving flow from diet designer using custom flow display name of length: ".concat(r&&r.length)),e.properties.displayName=r}return t.isXrmConnectionReferenceMode&&(n.logInfo("DietDesigner.saveFlowFromDesignerFlowDefinition","Copying connectionName to connectionReferenceLogicalName to use Connection references."),Object(z.f)(e.properties.connectionReferences||{})),i=e,l?Promise.resolve(e.name):t.createFlow(e).then(e=>Object(M.c)(e))}).then(e=>{n.profileEndWithSuccess(u,P.a.dietViewSaveFlowEnd,re({flowName:e},p)),a(e,i)}).catch(e=>(n.profileEnd(u,P.a.dietViewSaveFlowEnd,Object(x.y)(e),e,p),s(e),Object(x.G)(e)&&c&&c(e),Promise.reject(e)))},t.getParametersWithErrorsFromDesigner=()=>{try{return t.dietDesigner.getWorkflow({skipValidation:!1,ignoreNonCriticalErrors:!0,silentParameterValidation:!0}),t.dietDesigner.Data.Parameters.getData().filter(e=>e.errorMessages.length>0)}catch(e){return[]}},t.createFlow=function(){var e=J((function*(e){var i,n,o,r,a,s,l,{flowCreatorContext:{flowService:c,environmentStore:p,widgetUtilService:u,sessionStore:d,environmentCapabilityService:f,loggingService:m,clientResources:g},onFlowCreationError:h,defaultToSolutionFlowState:v}=t.props;if((null!=v?v:yield Object(z.d)(m,!(null===(i=p.currentEnvironment)||void 0===i||!i.hasXrmInstance),u,!(null===(n=d.user)||void 0===n||!n.isConsumerDomain),p.currentEnvironmentName,f,null!==(o=null===(r=d.user)||void 0===r?void 0:r.tenantId)&&void 0!==o?o:"",null!==(a=null===(s=p.currentEnvironment)||void 0===s?void 0:s.xrmInstanceVersion)&&void 0!==a?a:"",!0))!==z.a.BlockFlowSave||t.solutionIdToPass)return c.createFlow({solutionId:t.solutionIdToPass,flowDefinition:e,createAsMcsFlow:yield t.shouldCreateAsMcsFlow(null==e||null===(l=e.properties)||void 0===l?void 0:l.templateName)}).catch(e=>(h(e),Promise.reject(e)));throw new k.a(z.b,g.DefaultToSolution.FlowSaveBlocked)}));return function(t){return e.apply(this,arguments)}}(),t.getFlowDefinitionFromDesigner=e=>{var{flowCreatorContext:{loggingService:i,environmentStore:n},templateEntity:o}=t.props;return t.getRawWorkflowFromDesigner(e).then(e=>{var i={properties:{definition:re(re({},Object(j.b)(e.definition)),{},{description:null==o?void 0:o.description}),connectionReferences:t.getConnectionReferences(e.connectionReferences),templateName:null==o?void 0:o.name,environment:{name:n.currentEnvironmentName}}};return Promise.resolve(i)}).catch(e=>(Object(x.G)(e)||i.logError("DietDesigner.GetFlowFromDesigner",e),Promise.reject(e)))},t.handleShowPermissionsDialog=e=>{var{flowCreatorContext:{surfaceStore:i,telemetryService:n,clientResources:o,cdnService:r}}=t.props,a={apiDefinition:e,iconUri:e.properties.iconUri,brandColor:e.properties.iconBrandColor,displayName:e.properties.displayName};n.tagEvent(E.c.DietDesignerConnectionsSeePermissionClicked,void 0,{connectionProvider:e}),Object(T.a)(i,a,o,r)},t.handleFirstPartyConnectionFailure=(e,i)=>{if(!Object(x.S)(e))return Promise.reject(new k.a(I.b.ConnectionWizardFirstPartyConnectionFailure,e));var{flowCreatorContext:{oAuthService:n}}=t.props;return n.consentFirstPartyUriAfterMFA(i)},t.hasConnectionReferences=()=>{var e,i;return Object.keys((t.shouldLoadFromFlowEntity()?null===(e=t.props.flowEntity)||void 0===e?void 0:e.connectionReferences:null===(i=t.props.templateEntity)||void 0===i?void 0:i.properties.connectionReferences)||{}).length>0},t.designerScriptDownloadPromise=t.downloadDesignerScripts(),t.loadDietDesignerStylesManually=e.loadDietDesignerStylesManually||!1,t}return t=W,(i=[{key:"componentDidMount",value:(m=J((function*(){var e,t,i,n,o,r,{availableXrmConnectionReferences:a,flowCreatorContext:{clientResources:s,loggingService:l,xrmConnectionReferenceService:c,environmentStore:p,widgetUtilService:u,sessionStore:d,environmentCapabilityService:f},onError:m,connectionsReady:g,registerInternalSaveFlowCallback:h,registerGetFlowDefinition:v,registerGetParametersWithErrorsCallback:b,solutionId:y,defaultToSolutionFlowState:C}=this.props;h&&h(this.saveFlowFromDesignerFlowDefinition),v&&v(this.getFlowDefinitionFromDesigner),b&&b(this.getParametersWithErrorsFromDesigner),this.solutionIdToPass=y;var w=null!=C?C:yield Object(z.d)(l,!(null===(e=p.currentEnvironment)||void 0===e||!e.hasXrmInstance),u,!(null===(t=d.user)||void 0===t||!t.isConsumerDomain),p.currentEnvironmentName,f,null!==(i=null===(n=d.user)||void 0===n?void 0:n.tenantId)&&void 0!==i?i:"",null!==(o=null===(r=p.currentEnvironment)||void 0===r?void 0:r.xrmInstanceVersion)&&void 0!==o?o:"",!0);this.solutionIdToPass||w!==z.a.ShouldDefault?this.defaultedToSolutionFlow=!1:(this.solutionIdToPass=Object(_.a)(),this.defaultedToSolutionFlow=!0),this.setShouldDefaultToSolutionFlowResultFetched(!0),this.isXrmConnectionReferenceMode&&(a?this.setXrmConnectionReferencesFetched(!0):(l.logInfo("DietDesigner.componentDidMount","Invoking xrmConnectionReferenceService.getXrmConnectionReferences, because isXrmConnectionReferenceMode is true."),c.getXrmConnectionReferences({forceRefresh:!0}).then(()=>{this.setXrmConnectionReferencesFetched(!0)}).catch(e=>{l.logError("DietDesigner.componentDidMount",e)}))),g&&!this.hasConnectionReferences()&&(m({name:"DietDesigner.componentDidMount",message:s.ConnectionWizard.Empty.ConnectionReferences}),this.setFailedToLoad(!0))})),function(){return m.apply(this,arguments)})},{key:"render",value:function(){if(this.failedToLoad)return null;var{size:e,hideUntilConnectionWizardLoaded:t,dataAutomationId:i,isMcsHost:n}=this.props,o=!this.dietDesignerInitialized||t&&!this.hasConnectionWizardBeenRendered?this.renderConnectionListLoading():null,r=Object(g.a)({"fl-DietDesigner":!0,"msla-host-processsimple":!0,"msla-connectionwizard-canvas--narrow":e===le.Compact,[Object(h.a)(this.hasConnectionWizardBeenRendered).dietDesignerRoot]:!0,[Object(v.a)(n).dietDesignerManualRoot]:this.loadDietDesignerStylesManually});return this.shouldInit&&this.initializeDietDesigner(),d.createElement("div",{"data-automation-id":i},o,d.createElement("div",{className:r,ref:this.dietDesignerHostRef,tabIndex:-1}))}},{key:"renderConnectionListLoading",value:function(){var{flowCreatorContext:{clientResources:e},onRenderLoading:t}=this.props;return t?t():d.createElement(b.a,{size:b.b.medium,ariaLabel:e.ConnectionWizard.Spinner.AriaLabel})}},{key:"componentWillUnmount",value:function(){this.designerOnConnectionsChangeSubscription&&this.designerOnConnectionsChangeSubscription.unsubscribe(),this.dietDesigner&&this.dietDesigner.dispose()}},{key:"setDietDesignerInitialized",value:function(e){this.dietDesignerInitialized=e}},{key:"setFailedToLoad",value:function(e){this.failedToLoad=e}},{key:"setHasConnectionWizardBeenRendered",value:function(e){this.hasConnectionWizardBeenRendered=e}},{key:"setXrmConnectionReferencesFetched",value:function(e){this.xrmConnectionReferencesFetched=e}},{key:"setShouldDefaultToSolutionFlowResultFetched",value:function(e){this.shouldDefaultToSolutionFlowResultFetched=e}},{key:"isXrmConnectionReferenceMode",get:function(){return this.props.flowCreatorContext.featureFlags.enableConnectionReferenceModeForDietDesignerInSolutions&&!!this.solutionIdToPass}},{key:"shouldInit",get:function(){return!this.hasDesignerInitializationBegun&&!this.dietDesignerInitialized&&this.props.connectionsReady&&this.shouldDefaultToSolutionFlowResultFetched&&(this.xrmConnectionReferencesFetched||!this.isXrmConnectionReferenceMode)}},{key:"xrmConnectionReferences",get:function(){var e,t,{loggingService:i,xrmConnectionReferenceStore:n}=this.props.flowCreatorContext,{availableXrmConnectionReferences:o}=this.props;if(o)t=o;else{var r=this.xrmConnectionReferenceCollection.list,a=n.xrmConnectionReferences;if(!r||!a)return i.logInfo("DietDesigner.xrmConnectionReferences","xrmConnectionReferences is undefined. Returning empty list as fallback."),[];t=r.map(e=>{var t;return null===(t=a.getEntity(e))||void 0===t?void 0:t.toJS()}).filter(e=>!!e)}var s=Object(B.r)((null===(e=this.props.flowEntity)||void 0===e?void 0:e.connectionReferences)||{}).filter(e=>e.connectionid&&e.connectionreferencelogicalname);return L()([...t,...s],e=>e.connectionreferencelogicalname)}},{key:"xrmConnectionReferenceCollection",get:function(){var{environmentStore:{currentEnvironmentName:e},xrmConnectionReferenceStore:t}=this.props.flowCreatorContext;return t.xrmConnectionReferences.getCollection(N.a.getCollectionType({environmentName:e}))}},{key:"getDietDesignerConnections",get:function(){var{flowCreatorContext:{clientResources:e,loggingService:t,designerConnectionStore:i},availableConnections:n}=this.props;if(!n)return[];if(!this.isXrmConnectionReferenceMode)return n;t.logInfo("DietDesigner.getDietDesignerConnections","isXrmConnectionReferenceMode is true. Merging xrmConnectionReferences and availableConnections.");var o=this.xrmConnectionReferences;if(!o||o.length<1)return[];var r=Object(z.c)(n,o,i,e);return t.logInfo("DietDesigner.getDietDesignerConnections","Processed/merged connections with xrmConnections.",{startingConnectionCount:n.length,xrmConnectionReferencesCount:o.length,mergedConnectionsCount:r.length}),r}},{key:"shouldLoadFromFlowEntity",value:function(){var{flowEntity:e,useFlowEntity:t}=this.props;return!!t&&!Object(p.a)(e)}},{key:"shouldCreateAsMcsFlow",value:(o=J((function*(e){if(Object(q.b)(e))try{var t;return yield Object(K.e)(X.a.modernFlowTypeMinimumVersion,!(null===(t=this.props.flowCreatorContext.environmentStore.currentEnvironment)||void 0===t||!t.hasXrmInstance),this.props.flowCreatorContext.xrmEntityHttpClient)}catch(i){return this.props.flowCreatorContext.loggingService.logError("DietDesigner.shouldCreateAsMcsFlow getting org info",i),!1}return!1})),function(e){return o.apply(this,arguments)})},{key:"getRawWorkflowFromDesigner",value:function(e){try{var t=this.dietDesigner.getWorkflow(this.props.shouldNotCreateFlow&&!e?{skipValidation:!0,ignoreNonCriticalErrors:!0}:void 0);return Promise.resolve(t)}catch(i){return Promise.reject(i)}}},{key:"getConnectionReferences",value:function(e){return Object.keys(e).forEach(t=>{delete e[t].connectionId}),e}},{key:"subscribeToDesignerConnectionChanges",value:function(){this.dietDesigner&&this.dietDesigner.Data&&this.dietDesigner.Data.Connections&&this.dietDesigner.Data.Connections.onChanged||this.props.flowCreatorContext.loggingService.logError("DietDesigner.subscribeToDesignerConnectionChanges",new k.a(I.b.DietDesignerRegression,"this.dietDesigner.Data.Connections.onChanged does not exist")),this.designerOnConnectionsChangeSubscription=this.dietDesigner.Data.Connections.onChanged(this.handleConnectionsChanged)}},{key:"getConnectionsFromDesignerConnectionStore",value:function(){return this.dietDesigner&&this.dietDesigner.Data&&this.dietDesigner.Data.Connections&&this.dietDesigner.Data.Connections.getData?(this.dietDesigner.Data.Connections.getData()||[]).slice():(this.props.flowCreatorContext.loggingService.logError("DietDesigner.getConnectionsFromDesignerConnectionStore",new k.a(I.b.DietDesignerRegression,"this.dietDesigner.Data.Connections.getData does not exist")),[])}}])&&$(t.prototype,i),n&&$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),W}(d.Component),r=ne(o.prototype,"dietDesignerInitialized",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=ne(o.prototype,"xrmConnectionReferencesFetched",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=ne(o.prototype,"shouldDefaultToSolutionFlowResultFetched",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=ne(o.prototype,"failedToLoad",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=ne(o.prototype,"hasConnectionWizardBeenRendered",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne(o.prototype,"setDietDesignerInitialized",[f.action],Object.getOwnPropertyDescriptor(o.prototype,"setDietDesignerInitialized"),o.prototype),ne(o.prototype,"setFailedToLoad",[f.action],Object.getOwnPropertyDescriptor(o.prototype,"setFailedToLoad"),o.prototype),ne(o.prototype,"setHasConnectionWizardBeenRendered",[f.action],Object.getOwnPropertyDescriptor(o.prototype,"setHasConnectionWizardBeenRendered"),o.prototype),ne(o.prototype,"setXrmConnectionReferencesFetched",[f.action],Object.getOwnPropertyDescriptor(o.prototype,"setXrmConnectionReferencesFetched"),o.prototype),ne(o.prototype,"setShouldDefaultToSolutionFlowResultFetched",[f.action],Object.getOwnPropertyDescriptor(o.prototype,"setShouldDefaultToSolutionFlowResultFetched"),o.prototype),ne(o.prototype,"shouldInit",[f.computed],Object.getOwnPropertyDescriptor(o.prototype,"shouldInit"),o.prototype),ne(o.prototype,"xrmConnectionReferences",[f.computed],Object.getOwnPropertyDescriptor(o.prototype,"xrmConnectionReferences"),o.prototype),ne(o.prototype,"xrmConnectionReferenceCollection",[f.computed],Object.getOwnPropertyDescriptor(o.prototype,"xrmConnectionReferenceCollection"),o.prototype),ne(o.prototype,"getDietDesignerConnections",[f.computed],Object.getOwnPropertyDescriptor(o.prototype,"getDietDesignerConnections"),o.prototype),n=o))||n;function pe(e){return{appSettings:e.appSettings,featureFlags:e.featureFlags,designerHostContextStore:e.designerHostContextStore,sessionStore:e.sessionStore,clientResources:e.clientResources,errorHandlingResources:e.clientResources,dateTimeResources:e.clientResources.DateTime,planStore:e.planStore,analyticsService:e.analyticsService,gatewayService:e.gatewayService,gatewayStore:e.gatewayStore,xrmMachineManagementService:e.xrmMachineManagementService,machineManagementStore:e.machineManagementStore,rpaLocalService:e.rpaLocalService,surfaceStore:e.surfaceStore,assetService:e.assetService,environmentStore:e.environmentStore,widgetUtilService:e.widgetUtilService,widgetService:e.widgetUtilService,userFeaturesStore:e.userFeaturesStore,universalSearchService:e.universalSearchService,cdnService:e.cdnService,easyAutomationPanelStore:e.easyAutomationPanelStore,commentingPaneStore:e.commentingPaneStore,doNotShowAgainService:e.doNotShowAgainService,flowService:e.flowService,hostCommunicationService:e.hostCommunicationService,loggingService:e.loggingService,designerConnectionStore:e.designerConnectionStore,graphService:e.graphService,tokenService:e.tokenService,snippetService:e.snippetService,connectionService:e.connectionService,connectionStore:e.connectionStore,environmentCapabilityService:e.environmentCapabilityService,environmentCapabilityStore:e.environmentCapabilityStore,flowRunInputsOutputsService:e.flowRunInputsOutputsService,flowStore:e.flowStore,routeCrafter:e.routeCrafter,uiFlowService:e.uiFlowService,loadDesignerScripts:e.loadDesignerScripts,licenseManagementService:e.licenseManagementService,licenseManagementStore:e.licenseManagementStore,consentService:e.consentService,navigationService:e.navigationService,planService:e.planService,winAutomationService:e.winAutomationService,neptuneStore:e.neptuneStore,neptuneService:e.neptuneService,desktopFlowStore:e.desktopFlowStore,flowRunsService:e.flowRunsService,uiFlowRunService:e.uiFlowRunService,uiFlowRunStore:e.uiFlowRunStore,gptService:e.gptService,xrmConnectionReferenceStore:e.xrmConnectionReferenceStore,xrmConnectionReferenceService:e.xrmConnectionReferenceService,telemetryService:e.telemetryService,desktopFlowAIHttpClient:e.desktopFlowAIHttpClient,flowHttpClient:e.flowHttpClient,flowRpHttpClient:e.flowRpHttpClient,xrmEntityHttpClient:e.xrmEntityHttpClient,neptuneHttpClient:e.neptuneHttpClient,desktopFlowRuntimeHttpClient:e.desktopFlowRuntimeHttpClient,azureResourceGraphHttpClient:e.azureResourceGraphHttpClient}}var ue=Object(R.b)((e,t)=>re({flowCreatorContext:e},t))(ce)},20104:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(12754),o=e=>Object(n.db)({dietDesignerRoot:{visibility:e?"visible":"hidden",opacity:e?1:0,transition:"visibility 0s, opacity 0.25s linear"}})},20105:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(12754),o={margin:"0 auto",boxSizing:"border-box",position:"relative",verticalAlign:"top",width:"100%"},r={textAlign:"center"},a={display:"inline-block",minHeight:"600 px",margin:"0 auto",minWidth:"100%",img:{verticalAlign:"baseline"}},s={backgroundColor:"#f4f4f4"},l=e=>{var t=Object(n.Y)().palette;return Object(n.db)({dietDesignerManualRoot:{".msla-connection-container":{maxWidth:e?"100%":"600px",margin:"0 auto",textAlign:"left"},".msla-card-container":o,".msla-card-container-cell":o,".msla-aria-description":{position:"absolute",width:"0",height:"0",overflow:"hidden"},".msla-designer-container":r,".msla-monitor-container":r,".msla-diet-view-canvas":{minHeight:"auto",width:"100%"},".msla-designer-canvas":a,".msla-monitor-canvas":a,".msla-diet-view":{width:"100%"},".msla-diet-view .msla-card-container":{minWidth:"200px"},".msla-card-flex":{display:"flex",flexDirection:"column",height:"100%",width:"auto"},".msla-card-view-div":{height:"auto"},".msla-diet-view .msla-card-caption":{padding:"0",display:"block"},".msla-diet-view .msla-parameter-group":{padding:"0"},".msla-diet-view .msla-card-children":{display:"flex",textAlign:"left"},".msla-diet-view .msla-input-parameters-body":{margin:"0"},".msla-input-parameters-list":{width:"100%",listStyle:"none",margin:"0",padding:"0",display:"flex",flexDirection:"column"},".msla-diet-view .msla-input-parameter-item":{marginBottom:"12px",textAlign:"left"},".msla-input-parameters-list .msla-input-parameter-item":{margin:"0 0 6px"},".msla-input-parameters-list .msla-input-parameter-inline-item .msla-input-parameter":{display:"flex",flexDirection:"row",flexWrap:"wrap"},".msla-diet-view .msla-input-parameter-label":{flex:"1 1 100%",maxHeight:"100%"},".msla-input-parameter-label":{color:"#595959",margin:"0",display:"inline-block",verticalAlign:"top",paddingTop:"5.5px"},".msla-input-parameter-label .msla-label":{padding:"0",maxHeight:"3em"},".msla-host-processsimple label":{margin:"inherit"},".msla-label":{display:"block",overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px",lineHeight:"1.25em",textAlign:"left",wordWrap:"breakWord"},".msla-label-required-parameter":{color:"#e81123",paddingRight:"2px"},".msla-input-parameters-list .msla-input-parameter-item .msla-input-parameter-content-wrapper":{display:"flex",flexDirection:"column",flex:"1 1 436px",padding:"1px"},".msla-input-parameter-box":{border:"1px solid #989898",width:"100%",paddingTop:"1px",verticalAlign:"middle",boxSizing:"border-box",display:"inline-block"},".msla-input-parameter-content":{verticalAlign:"middle",boxSizing:"border-box",display:"inline-block"},".msla-combobox":{position:"relative",width:"100%"},".msla-combobox-input":{position:"relative"},".msla-combobox-input-value-full-width":{width:"100%",display:"inline-block"},".msla-button":{backgroundColor:"transparent",border:"none",fontFamily:"wf_segoe-ui_normal,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif",cursor:"pointer",fontSize:"12px",color:"#06f",lineHeight:"26px"},button:{overflow:"visible",textRendering:"auto",color:"buttontext",letterSpacing:"normal",wordSpacing:"normal",lineHeight:"normal",textTransform:"none",textIndent:"0px",textShadow:"none",display:"inline-block",textAlign:"center",alignItems:"flex-start",cursor:"default",boxSizing:"border-box",writingMode:"horizontal-tb !important",margin:"0em",paddingBlocK:"1px",paddingInline:"6px"},".msla-input-control":{backgroundColor:"#fff",color:"#000",fontSize:"12px",cursor:"text",minHeight:"26px",padding:"0 10px",position:"relative",wordWrap:"break-word",lineHeight:"24px"},".msla-input-parameter-placeholder":{width:"calc(100% - 12px)",marginTop:"5px",color:"#595959",fontFamily:"wf_segoe-ui_normal,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif",fontSize:"12px",position:"absolute",zIndex:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"initial"},".msla-input-control-value":{listStyle:"none",padding:"0",margin:"0",maxWidth:"100%",minHeight:"26px"},".msla-input-control-value .msla-input-control-token-item":{maxWidth:"100%",padding:"0 0 0 2px",position:"relative",verticalAlign:"middle",display:"inline-block"},".msla-combobox-options":{backgroundColor:"#fff",border:"1px solid #cac8c7",boxShadow:"0 5px 12px rgba(0,0,0,.35)",fontFamily:"wf_segoe-ui_normal,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif",fontSize:"12px",left:"-1px",maxHeight:"300px",overflowY:"auto",position:"absolute",top:"27px",width:"100%",zIndex:100},".msla-combobox-options-enums":{borderBottom:"1px solid hsla(0,0%,74.9%,.8)"},ol:{marginTop:"0",marginBottom:"0",padding:"0",listStyle:"none",display:"block",marginBlockStart:"1em",marginBlockEnd:"1em",marginInlineStart:"0px",marginInlineEnd:"0px",paddingInlineStart:"40px"},".msla-combobox-option-title":{fontSize:"14px"},".msla-combobox-option-description":{fontSize:"12px"},"a.msla-combobox-option-people-picker-text:active":s,"a.msla-combobox-option-people-picker-text:hover":s,"a.msla-combobox-option-people-picker-text":{padding:"5px 5px 5px 11px",border:"none",display:"inline-block",fontFamily:"wf_segoe-ui_normal,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif",position:"relative",whiteSpace:"nowrap",minHeight:"16px",width:"100%"},".msla-token":{borderWidth:"0",cursor:"pointer",fontSize:"12px",height:"24px",lineHeight:"24px",whiteSpace:"nowrap"},".msla-input-control-token-expression":{display:"flex",paddingLeft:"2px",paddingRight:"5px"},".msla-input-control-token-expression-delete":{alignSelf:"center",fontSize:"16px",verticalAlign:"top",paddingLeft:"5px",paddingRight:"0",color:"#000",lineHeight:"24px"},".msla-input-control-token-literal":{display:"inline-block",fontFamily:"wf_segoe-ui_normal,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif",position:"relative",minWidth:"5px",maxWidth:"100%",wordBreak:"break-all",whiteSpace:"pre-wrap",marginTop:"5px"},".msla-connection-container-body":{".ms-DetailsRow:hover":{backgroundColor:"unset"},".ms-DetailsRow-cell":{display:"flex",alignItems:"center",paddingLeft:0}},".msla-connection-controls":{marginLeft:"auto",display:"flex",alignItems:"center"},".msla-connection-selector-connector-container":{marginLeft:"16px",minWidth:0,overflow:"hidden"},".msla-connector-display-name":{fontSize:14,fontWeight:600,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",minWidth:0},".msla-connection-status-icon-container":{cursor:"default"},".msla-connection-status-icon-container:last-child":{paddingRight:"8px"},".msla-connection-status-icon":{fontSize:"16px",verticalAlign:"middle"},".msla-connection-status-icon--success":{color:"#107c10"},".msla-connection-status-icon--error":{color:"#d13438"},".msla-connection-switch-link":{fontSize:"16px",color:t.themePrimary,borderColor:t.themePrimary,marginLeft:"4px",i:{verticalAlign:"middle"}},".msla-connection-view-permissions-link":{fontSize:"10px",display:"block",border:"none",background:"transparent",padding:0,":hover":{textDecoration:"underline"}},".msla-connection-selector-icon":{width:"32px",height:"32px",minWidth:"32px",boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.15)",borderRadius:3},".msla-card-fixed-width":{margin:"0 auto",minWidth:"440px",width:"600px",border:"1px solid #cac8c7"},".msla-card-selected":{boxShadow:"0 0 12px rgba(0, 0, 0, 0.35)",borderWidth:"2px"},".msla-card-header":{fontFamily:"wf_segoe-ui_semilight,Segoe UI Semilight,Segoe WP Semilight,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif",fontSize:"14px",textAlign:"left",height:"44px",lineHeight:"44px",color:"#000",display:"flex",justifyContent:"space-between"},".msla-card-title-button":{height:"44px",width:"44px",float:"left",color:"#323130"},".msla-header-fixed-width":{maxWidth:"600px"},".msla-card-title-group":{display:"flex",overflow:"hidden",flex:"1 1 auto",alignItems:"center",cursor:"pointer"},".msla-card-header-logo":{width:"44px",height:"44px",display:"inline-block",verticalAlign:"top",cursor:"pointer",flex:"0 0 auto"},".msla-card-header-icon":{width:"100%",height:"100%"},".msla-checkbox":{display:"inline-flex",width:"calc(100% - 138px)",alignItems:"baseline"},".msla-checkbox-label":{display:"block",fontFamily:"wf_segoe-ui_normal,Segoe UI,Segoe WP,Tahoma,Arial,sans-serif"},".msla-card-header-title-view":{cursor:"pointer",color:"#000000",overflow:"hidden",outline:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",height:"inherit",paddingLeft:"10px",display:"flex"},".msla-card-title":{textOverflow:"ellipsis",overflow:"hidden"},".msla-card-title-button-group":{display:"flex",alignItems:"center",flex:"0 0 auto"},".msla-card-body":{padding:"5px 5px 10px 5px"},".msla-card-auth-body":{padding:"10px",textAlign:"center"},".msla-card-config-item":{margin:"6px 8px",display:"flex",textAlign:"left"},".msla-card-config-item-label":{flexBasis:"25%",marginRight:"8px"},".msla-card-config-item-label .msla-label":{marginBottom:"5",fontSize:"14px",fontWeight:"600",display:"inline-block"},".msla-card-auth-description":{margin:"0",paddingBottom:"10px",wordWrap:"break-word",fontSize:"12px"},".msla-card-button-primary":{lineHeight:"30px",padding:"0 40px",marginTop:"10px",marginRight:"10px",minWidth:"150px",color:"#fff"},".msla-card-button-secondary":{lineHeight:"30px",padding:"0 40px"},".msla-card-title-button-icon":{verticalAlign:"middle",fontSize:"22px"},".msla-dropdown-container":{width:"75%",display:"inline-block",textOverflow:"ellipsis"},".msla-textbox":{width:"calc(100% - 138px)",display:"inline-block"},"body.dark":{".msla-connection-container-body":{'[class^="ms-List-cell"]':{backgroundColor:"#323130"}},".msla-connection-status-icon--success":{color:"#19c019"},".msla-connection-status-icon--error":{color:"#e4878a"},".msla-label-required-parameter":{color:"#f4717c"}}}})}},20803:function(e,t,i){"use strict";i.d(t,"a",(function(){return _})),i.d(t,"b",(function(){return H}));var n=i(18986),o=i(14751),r=i.n(o),a=i(11773),s=i(19923),l=i(13154),c=i(13009),p=i(13143),u=i(20152),d=i(14837),f=i(19891),m=i(11891),g=i(13085),h=i(20795),v=i(20796),b=i(12366),y=i(12999),C=i(12339),w=i(20430),S=i(19692),O=i(19684),D=i(13031),F=i(14875),P=i(12381),x=i(20804),E=i(20805),T=i(20806),I=i(13144),k=i(16749),R=i(14697),j=i(14689),N=i(16744),A=i(18968);function z(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function M(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?z(Object(i),!0).forEach((function(t){B(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function B(e,t,i){return(t=V(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function W(e,t,i,n,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function L(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var r=e.apply(t,i);function a(e){W(r,n,o,a,s,"next",e)}function s(e){W(r,n,o,a,s,"throw",e)}a(void 0)}))}}function U(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V(n.key),n)}}function V(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var _={Preview:"Preview"},H=function(){function e(t,i,n,o,r,a,s,l,c,p){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.apiOperationService=t,this.clientResources=i,this.environmentStore=n,this.loggingService=r,this.designerOperationsService=a,this.designerOperationsStore=s,this.assetService=l,this.tokenService=c,this.ppapiService=p,this.operationManifests={},this.connectors={},this.loadOperationManifestsFromFlowConnectionReferences(o)}var t,i,o,z,B,W,V,H,X,q,K;return t=e,(i=[{key:"getOperationManifest",value:(K=L((function*(e,t){var i=this.getOperationManifestKey(e,t),n=this.operationManifests[i];if(n)return n;var o=yield this.fetchOperationManifest(e,t);return this.operationManifests[i]=o,o})),function(e,t){return K.apply(this,arguments)})},{key:"getSplitOnOutputs",value:function(e,t,i){var n=this.getOperationManifestKey(e,t),o=this.operationManifests[n];if(!o)throw new T.a(p.b.SplitOnOutputsRequestedBeforeOperationManifest,"Split on outputs requested before operation manifest was retrieved.");return i?this.convertOutputsForSplitOn(o.properties.outputs,i):o.properties.outputs}},{key:"isSupported",value:function(e,t){return Object(m.a)(e,l.p.openapiconnectionwebhook)||Object(m.a)(e,l.p.openapiconnection)||Object(m.a)(e,l.p.openapiconnectionnotification)||Object(m.a)(e,l.d.changeset)||this.isSupportedBuiltInOperation(e,t)}},{key:"isSupportedBuiltInOperation",value:function(e,t){return this.isRunChildFlowBuiltInOperation(e)||this.isComposeBuiltInOperation(e)||this.isFormatNumberBuiltInOperation(e,t)||this.isAiBuilderBuiltInOperation(e,t)||this.isSupportedExpressionsOperation(e,t)||this.isTeamsResponseOperation(e,t)}},{key:"isRunChildFlowBuiltInOperation",value:function(e){return Object(m.a)(e,d.a.Workflow)}},{key:"isSupportedExpressionsOperation",value:function(e,t){return this.isIndexOfBuiltInOperation(e,t)||this.isSubstringBuiltInOperation(e,t)}},{key:"isIndexOfBuiltInOperation",value:function(e,t){return Object(m.a)(e,l.d.expression)&&Object(m.a)(t,l.g.indexof)}},{key:"isSubstringBuiltInOperation",value:function(e,t){return Object(m.a)(e,l.d.expression)&&Object(m.a)(t,l.g.substring)}},{key:"isComposeBuiltInOperation",value:function(e){return Object(m.a)(e,d.a.Compose)}},{key:"isFormatNumberBuiltInOperation",value:function(e,t){return Object(m.a)(e,l.d.expression)&&Object(m.a)(t,l.g.formatnumber)}},{key:"isAiBuilderBuiltInOperation",value:function(e,t){return Object(m.a)(e,l.d.expression)&&Object(m.a)(t,l.g.aibuilderpredict)}},{key:"isTeamsResponseOperation",value:function(e,t){return Object(m.a)(e,l.d.response)&&Object(m.a)(t,l.g.teams)}},{key:"getOperationInfo",value:(q=L((function*(e){var t=e.type,i=e.kind;if(Object(m.a)(t,d.a.OpenApiConnection)||Object(m.a)(t,d.a.OpenApiConnectionWebhook)||Object(m.a)(t,d.a.OpenApiConnectionNotification)||Object(m.a)(t,d.a.Changeset))return{connectorId:e.inputs.host.apiId,operationId:e.inputs.host.operationId};if(this.isTeamsResponseOperation(t,i))return{connectorId:s.i.TEAMS,operationId:s.h.TEAMSTASKMODULERESPONSE};if(this.isRunChildFlowBuiltInOperation(t))return{connectorId:s.g.FLOWS,operationId:s.h.CHILDFLOW};if(this.isComposeBuiltInOperation(t))return{connectorId:s.g.DATAOPERATION,operationId:s.h.COMPOSE};if(this.isFormatNumberBuiltInOperation(t,i))return{connectorId:s.g.NUMBERFUNCTIONS,operationId:s.h.FORMATNUMBER};if(this.isIndexOfBuiltInOperation(t,i))return{connectorId:s.g.TEXTFUNCTIONS,operationId:s.h.INDEXOF};if(this.isSubstringBuiltInOperation(t,i))return{connectorId:s.g.TEXTFUNCTIONS,operationId:s.h.SUBSTRING};if(this.isAiBuilderBuiltInOperation(t,i))return{connectorId:s.g.AIBUILDER,operationId:s.h.AIBUILDERPREDICT};throw new T.a(p.b.NotManifestBasedOperation,"Operation info shouldn't be retrieved from operation manifest for non-manifest based operation type '".concat(t,"'."))})),function(e){return q.apply(this,arguments)})},{key:"loadOperationManifestsFromFlowConnectionReferences",value:function(e){if(e)for(var t of Object.values(e))this.loadOperationManifestsFromFlowConnectionReference(t)}},{key:"loadOperationManifestsFromFlowConnectionReference",value:function(e){var t=e.operationDefinitions;if(t)for(var i of Object.keys(t))if(!Object(m.a)(i,"ExecuteChangeset")){var n=r()(t[i]),o=n.apiPropertiesOverrides&&n.apiPropertiesOverrides.iconUri?n.apiPropertiesOverrides.iconUri:e.iconUri,a=n.apiPropertiesOverrides&&n.apiPropertiesOverrides.brandColor?n.apiPropertiesOverrides.brandColor:e.brandColor,s=this._createOperationManifest(!1,l.p.openapiconnection,n.inputsSchema,n.responsesSchema,n.trigger,n.triggerHint,n.description,n.summary,o,a,n.pageable,n.isChunkingSupported,n.externalDocs,e.apiDefinition,this._getOpenApiAlternativeOutputs(n.responsesSchema,n.operationType));if(e.apiDefinition&&e.apiDefinition.id){var c=this.getOperationManifestKey(e.apiDefinition.id,i);this.operationManifests[c]=s}}}},{key:"fetchOperationManifest",value:(X=L((function*(e,t){var i=this.loggingService.profileStart(g.a.getOperationManifestStart);try{var n=Object(a.toJS)(this.isBuiltInManifest(e,t)?yield this.fetchBuiltInOperationManifest(t):yield this.fetchOpenApiOperationManifest(e,t),{recurseEverything:!0});return this.loggingService.profileEnd(i,g.a.getOperationManifestEnd,c.e.Success),n}catch(s){var o,r=404===(null==s||null===(o=s.data)||void 0===o?void 0:o.status)?c.e.Warning:Object(c.y)(s);throw this.loggingService.profileEnd(i,g.a.getOperationManifestEnd,r,s),s}})),function(e,t){return X.apply(this,arguments)})},{key:"fetchBuiltInOperationManifest",value:function(e){if(Object(s.o)(e))return this.getComposeManifest();if(Object(s.x)(e))return this.getTeamsResponseManifest();if(Object(s.s)(e))return this.getFormatNumberManifest();if(Object(s.l)(e))return this.getAiBuilderPredictManifest(e);if(Object(s.n)(e))return this.getCDSNativeWhenAnActionIsPerformedManifest(e);var t,i=null;if(Object(s.v)(e)?i=Object(h.a)(this.clientResources,this.assetService):Object(s.p)(e)?i=Object(x.a)(this.clientResources,this.assetService):Object(s.q)(e)&&(i=Object(E.a)(this.clientResources,this.assetService)),t=i?i.properties:null)return Promise.resolve(this._createOperationManifest(!0,t.operationType,t.inputsDefinition,t.responsesDefinition,t.trigger,t.triggerHint,t.description,t.summary,t.api.iconUri,t.api.brandColor,t.pageable,t.isChunkingSupported,t.externalDocs,void 0,void 0,void 0,void 0,this._getAnnotationStatus(i),t.inputsLocation));throw new T.a(p.b.NotManifestBasedOperation,"No built-in manifest available for flows only built-in operation id '".concat(e,"'."))}},{key:"fetchOpenApiOperationManifest",value:(H=L((function*(e,t){var i,n=this.connectors[e];if(n)(i=yield this.apiOperationService.getApiOperation(Object(F.e)(e),t,!1)).properties.connector=n;else{var o=(i=yield this.apiOperationService.getApiOperation(Object(F.e)(e),t,!0)).properties.connector;o&&(this.clearDesktopFlowConnectivityVNextIfNeeded(o),this.connectors[e]=o)}var r=i.properties;return this._createOperationManifest(!1,i.properties.operationType,r.inputsDefinition,r.responsesDefinition,r.trigger,r.triggerHint,r.description,r.summary,r.api.iconUri,r.api.brandColor,r.pageable,r.isChunkingSupported,r.externalDocs,r.connector,this._getOpenApiAlternativeOutputs(r.responsesDefinition,r.operationType),this._getOperationManifestActions(i),this._getOperationManifestConnectionReference(i),this._getAnnotationStatus(i))})),function(e,t){return H.apply(this,arguments)})},{key:"_createOperationManifest",value:function(e,t,i,n,o,r,a,s,l,c,p,u,d,f,m,g,h,v,b){var y={properties:{inputs:i,outputs:this._getManifestDefaultOutputs(n),alternativeOutputs:m,inputsLocation:null!=b?b:["inputs","parameters"],trigger:o,triggerHint:r,description:a,summary:s,iconUri:l,brandColor:c,externalDocs:d,settings:this.getOperationManifestSettings(e,t,p,u),actions:g,connectionReference:h,statusBadge:{name:v}}};return f&&(y.properties.connector=f),this._convertDynamicExtensionsForOperationManifest(y),this._removeBodyTitleFromOperationManifest(y),this._deleteEmptyInputs(y),y}},{key:"_deleteEmptyInputs",value:function(e){var t=e.properties.inputs;t&&t.properties&&0===Object.keys(t.properties).length&&delete e.properties.inputs}},{key:"_removeBodyTitleFromOperationManifest",value:function(e){var t=e.properties.inputs;if(t&&t.properties)for(var i of Object.values(t.properties))i.type===n.p.Object&&i.properties&&delete i.title}},{key:"_getSuccessfulStatusCodeFromOpenApiManifest",value:function(e){return Object.keys(e)[0]}},{key:"_getManifestDefaultOutputs",value:function(e){return e[this._getSuccessfulStatusCodeFromOpenApiManifest(e)]}},{key:"_getOpenApiAlternativeOutputs",value:function(e,t){var i=e.default,o=i&&1===Object.keys(e).length,a={properties:{body:{description:this.clientResources.OperationManifest.DefaultResponse.Body.Description,title:this.clientResources.OperationManifest.DefaultResponse.Body.Title,type:n.p.Object,[v.a.Alias]:"body"},headers:{description:this.clientResources.OperationManifest.DefaultResponse.Headers.Description,title:this.clientResources.OperationManifest.DefaultResponse.Headers.Title,type:n.p.Object,[v.a.Alias]:"headers"},statusCode:{description:this.clientResources.OperationManifest.DefaultResponse.StatusCode.Description,title:this.clientResources.OperationManifest.DefaultResponse.StatusCode.Title,type:n.p.Number,[v.a.Alias]:"statusCode"}},type:n.p.Object},s={keyPath:["statusCode"],schemas:r()(e),defaultSchema:o||!i?a:i};if(o)for(var l=200;l<299;l++)s.schemas[l]=i;return Object(m.a)(t,d.a.OpenApiConnectionWebhook)?void 0:s}},{key:"_getOperationManifestActions",value:function(e){var t;if(e.properties.allowedChildOperations)return[{allowedOperations:null===(t=e.properties.allowedChildOperations)||void 0===t?void 0:t.map(O.c),executionOrder:Object(m.a)(e.properties.operationType,d.a.Changeset)?u.b.Parallel:u.b.Sequential,allowedSettings:void 0,isOptional:!0}]}},{key:"_getOperationManifestConnectionReference",value:function(e){if(Object(m.a)(e.properties.operationType,d.a.OpenApiConnection)||Object(m.a)(e.properties.operationType,d.a.OpenApiConnectionWebhook)||Object(m.a)(e.properties.operationType,d.a.OpenApiConnectionNotification)||Object(m.a)(e.properties.operationType,d.a.Changeset))return{referenceKeyFormat:u.a.OpenApi}}},{key:"getConnector",value:(V=L((function*(e){var t=this.connectors[e];if(t)return Promise.resolve(t);var i=yield this.fetchConnector(e);return this.clearDesktopFlowConnectivityVNextIfNeeded(i),this.connectors[e]=i,i})),function(e){return V.apply(this,arguments)})},{key:"clearDesktopFlowConnectivityVNextIfNeeded",value:function(e){var t;Object(A.b)(e.id)&&(Object(k.a)()||Object(y.a)().enableDesktopFlowConnectivityVNext||!e.properties.connectionParameterSets||delete e.properties.connectionParameterSets,null!==(t=e.properties.connectionParameterSets)&&void 0!==t&&t.values&&!Object(N.v)(Object(y.a)())&&(e.properties.connectionParameterSets.values=e.properties.connectionParameterSets.values.filter(e=>e.name!==b.B.connectionParametersSetName.azureRelayRunOwner)))}},{key:"fetchConnector",value:(W=L((function*(e){var t,i=Object(C.b)().powerAppsResourceProviderApiVersionWithEnvironments,n=this.getConnectorUrl(e);if(Object(R.a)()){var o=this.ppapiService.tryConvertPARPRequestUrl(n);o.converted&&(n=new URL(o.path,o.endpoint).toString(),t=yield this.tokenService.getAccessToken(this.ppapiService.getTokenAudience()),i=j.b)}else t=yield this.tokenService.getAccessToken(Object(C.b)().authResource);return Object(w.a)({data:{$filter:"environment eq '".concat(this.environmentStore.currentEnvironmentName,"'"),"api-version":i},method:"GET",url:n,headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}},this.loggingService)})),function(e){return W.apply(this,arguments)})},{key:"getOperationManifestSettings",value:function(e,t,i,n){var o={concurrency:{scopes:[u.d.Trigger]},trackedProperties:{scopes:[u.d.Action]},correlation:{scopes:[u.d.Trigger]},timeout:{scopes:[u.d.Action]},retryPolicy:{scopes:[u.d.Trigger,u.d.Action]}};i&&(o.paging={scopes:[u.d.Action]}),n&&(o.chunking={scopes:[u.d.Action]});var r=!1,a=!1;return e?(r=Object(O.p)(t),a=Object(O.q)(t)):a=r=Object(O.r)(t),(r||a)&&(o.secureData={scopes:[u.d.Action],options:a?{outputsMode:Object(O.l)(e,t)}:void 0}),o}},{key:"convertOutputsForSplitOn",value:function(e,t){var i=t.match(/triggerOutputs\(\)\??\['(.+)'\]/);if(!i||2!==i.length)throw new T.a(p.b.InvalidSplitOn,Object(D.a)(this.clientResources.Error.InvalidSplitOnFormat,t));var o=i[1].split("/"),a=e;for(var s of o)a=a.properties[s];if(a.type!==n.p.Array)throw new T.a(p.b.InvalidSplitOn,Object(D.a)(this.clientResources.Error.EvaluatedSplitOnNotArray,t));var l={properties:{body:M(M({},r()(a.items)),{[v.a.Alias]:"body"})},type:n.p.Object},c=l.properties.body.properties;if(c)for(var u of Object.keys(c)){var d=c[u];this.convertSchemaAliasesForSplitOn(d)}return Object(S.b)(l,!1),l}},{key:"getConnectorUrl",value:function(e){var t=Object(F.e)(e),i=Object(C.b)();return"".concat(Object(P.a)(Object(I.c)(i).powerAppsRP,i.powerAppsResourceProviderPath),"/apis/").concat(t)}},{key:"_convertDynamicExtensionsForOperationManifest",value:function(e){Object(S.b)(e.properties.inputs,!0),Object(S.b)(e.properties.outputs,!1)}},{key:"convertSchemaAliasesForSplitOn",value:function(e){var t=v.a.Alias,i=e[t];e[t]="body/".concat(i);var n=e.properties;if(n)for(var o of Object.values(n))this.convertSchemaAliasesForSplitOn(o)}},{key:"getOperationManifestKey",value:function(e,t){return"".concat(e.toLowerCase(),"-").concat(t.toLowerCase())}},{key:"getComposeManifest",value:function(){var e=s.g.DATAOPERATION,t=s.h.COMPOSE;return this.designerOperationsService.loadOperation({forceRefresh:!0,operationGroupName:e,operationName:t}).then(()=>{var i=this.designerOperationsStore.designerOperations.getEntity(f.a.getOperationKey(e,t)),n={properties:{inputs:i.properties.manifest.inputs,outputs:i.properties.manifest.outputs,alternativeOutputs:void 0,inputsLocation:void 0,trigger:void 0,triggerHint:void 0,description:i.properties.description,summary:i.properties.summary,iconUri:i.properties.iconUri,brandColor:i.properties.brandColor,settings:i.properties.manifest.settings,includeRootOutputs:i.properties.manifest.includeRootOutputs}};return this._convertDynamicExtensionsForOperationManifest(n),this._removeBodyTitleFromOperationManifest(n),this._deleteEmptyInputs(n),n})}},{key:"getTeamsResponseManifest",value:function(){var e=s.j.Teams,t=s.h.TEAMSTASKMODULERESPONSE;return this.designerOperationsService.loadOperation({forceRefresh:!0,operationGroupName:e,operationName:t}).then(()=>{var i,n=this.designerOperationsStore.designerOperations.getEntity(f.a.getOperationKey(e,t)),o={properties:{inputs:{type:"object",properties:{responseAdaptiveCard:(null===(i=n.properties.manifest)||void 0===i||null===(i=i.inputs)||void 0===i||null===(i=i.properties)||void 0===i?void 0:i.responseAdaptiveCard)||{}},required:["responseAdaptiveCard"]},outputs:{},alternativeOutputs:void 0,inputsLocation:["inputs","body"],trigger:void 0,triggerHint:void 0,description:n.properties.description,summary:n.properties.summary,iconUri:n.properties.iconUri,brandColor:n.properties.brandColor,settings:{secureData:{options:{outputsMode:u.c.LinkedToInputs}},trackedProperties:{scopes:[u.d.Action]}},includeRootOutputs:!0}};return this._convertDynamicExtensionsForOperationManifest(o),this._removeBodyTitleFromOperationManifest(o),this._deleteEmptyInputs(o),delete o.properties.inputs.title,o})}},{key:"getFormatNumberManifest",value:function(){var e=s.g.NUMBERFUNCTIONS,t=s.h.FORMATNUMBER;return this.designerOperationsService.loadOperation({forceRefresh:!0,operationGroupName:e,operationName:t}).then(()=>{var i=this.designerOperationsStore.designerOperations.getEntity(f.a.getOperationKey(e,t)),n={properties:{inputs:i.properties.manifest.inputs,outputs:i.properties.manifest.outputs,alternativeOutputs:void 0,inputsLocation:void 0,trigger:void 0,triggerHint:void 0,description:i.properties.description,summary:i.properties.summary,iconUri:i.properties.iconUri,brandColor:i.properties.brandColor,settings:i.properties.manifest.settings,includeRootOutputs:i.properties.manifest.includeRootOutputs}};return this._convertDynamicExtensionsForOperationManifest(n),this._removeBodyTitleFromOperationManifest(n),this._deleteEmptyInputs(n),n})}},{key:"getAiBuilderPredictManifest",value:(B=L((function*(e){var t=s.g.AIBUILDER,i=this.designerOperationsService.loadOperation({forceRefresh:!0,operationGroupName:t,operationName:e}),n=this.getConnector("/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"),[o,r]=yield Promise.all([i,n]),l=Object(a.toJS)(this.designerOperationsStore.designerOperations.getEntity(f.a.getOperationKey(t,e))),c=l.properties;return this._createOperationManifest(!1,l.type,c.manifest.inputs,c.manifest.responsesDefinition,void 0,void 0,c.description,c.summary,c.operationGroup.iconUri,c.operationGroup.brandColor,!1,!1,c.externalDocs,r,this._getOpenApiAlternativeOutputs(c.manifest.responsesDefinition,c.operationType),void 0,void 0)})),function(e){return B.apply(this,arguments)})},{key:"getCDSNativeWhenAnActionIsPerformedManifest",value:(z=L((function*(e){var t=s.g.CDSNATIVE,i=this.designerOperationsService.loadOperation({operationGroupName:t,operationName:e}),n=this.getConnector("/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"),[o,r]=yield Promise.all([i,n]),l=Object(a.toJS)(this.designerOperationsStore.designerOperations.getEntity(f.a.getOperationKey(t,e))),c=l.properties,p={referenceKeyFormat:u.a.OpenApi};return this._createOperationManifest(!1,l.type,c.manifest.inputs,c.manifest.responsesDefinition,"Single",void 0,c.description,c.summary,c.operationGroup.iconUri,c.operationGroup.brandColor,!1,!1,c.externalDocs,r,this._getOpenApiAlternativeOutputs(c.manifest.responsesDefinition,c.operationType),void 0,p)})),function(e){return z.apply(this,arguments)})},{key:"isBuiltInManifest",value:function(e,t){return Object(s.w)(e)||Object(s.o)(t)||Object(s.l)(t)||Object(s.s)(t)||Object(s.n)(t)||Object(s.x)(t)}},{key:"_getAnnotationStatus",value:function(e){var t;return null!=e&&null!==(t=e.properties)&&void 0!==t&&t.annotation&&Object(m.a)(e.properties.annotation.status,_.Preview)?this.clientResources.OperationManifest.Annotation.Status.Preview:null}}])&&U(t.prototype,i),o&&U(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20804:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(19923),o=i(14924),r=i(14837);function a(e,t){return{properties:{summary:e.IndexOf.Operation.Summary,description:e.IndexOf.Operation.Description,api:{id:n.g.TEXTFUNCTIONS,displayName:e.Connector.TextFunctions.DisplayName,iconUri:Object(n.k)(t).textFunctions,brandColor:n.b.textFunctions,tier:"NotSpecified"},inputsDefinition:{type:"object",required:["text","searchText"],properties:{text:{type:"string",title:e.IndexOf.Operation.Inputs.Text.Title,description:e.IndexOf.Operation.Inputs.Text.Description},searchText:{type:"string",title:e.IndexOf.Operation.Inputs.SearchText.Title,description:e.IndexOf.Operation.Inputs.SearchText.Description}}},responsesDefinition:{200:{type:"object",properties:{body:{type:"integer",title:e.IndexOf.Operation.Outputs.TextPosition.Title,description:e.IndexOf.Operation.Outputs.TextPosition.Description}}}},operationType:r.a.Expression,operationKind:o.a.IndexOf,inputsLocation:["inputs"]}}}},20805:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(19923),o=i(14924),r=i(14837);function a(e,t){return{properties:{summary:e.Substring.Operation.Summary,description:e.Substring.Operation.Description,api:{id:n.g.TEXTFUNCTIONS,displayName:e.Connector.TextFunctions.DisplayName,iconUri:Object(n.k)(t).textFunctions,brandColor:n.b.textFunctions,tier:"NotSpecified"},inputsDefinition:{type:"object",required:["text","startingPosition"],properties:{text:{type:"string",title:e.Substring.Operation.Inputs.Text.Title,description:e.Substring.Operation.Inputs.Text.Description},startingPosition:{type:"integer",title:e.Substring.Operation.Inputs.StartingPosition.Title,description:e.Substring.Operation.Inputs.StartingPosition.Description},length:{type:"integer",title:e.Substring.Operation.Inputs.Length.Title,description:e.Substring.Operation.Inputs.Length.Description}}},responsesDefinition:{200:{type:"object",properties:{body:{type:"string",title:e.Substring.Operation.Outputs.Substring.Title,description:e.Substring.Operation.Outputs.Substring.Description}}}},operationType:r.a.Expression,operationKind:o.a.Substring,inputsLocation:["inputs"]}}}},20806:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(16808),o=i(16809);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,n=p(e);if(t){var o=p(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return c(this,i)}}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(c,e);var t,i,n,a=l(c);function c(e,t,i,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a.call(this,o.a.Assertion,t,e,n,i)}return t=c,i&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.a)},20823:function(e,t,i){"use strict";var n=i(16708);i.d(t,"a",(function(){return n.a}))},20824:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(19923);function o(e){return e&&e.definitionSummary&&e.definitionSummary.actions&&e.definitionSummary.triggers&&e.definitionSummary.actions.concat(e.definitionSummary.triggers).find(e=>(null==e?void 0:e.swaggerOperationId)&&Object(n.l)(e.swaggerOperationId))}},20825:function(e,t,i){"use strict";i.d(t,"a",(function(){return Ve})),i.d(t,"c",(function(){return _e})),i.d(t,"b",(function(){return Xe}));var n,o,r,a,s,l,c,p,u,d,f,m,g,h,v,b,y,C,w,S,O,D,F,P,x,E,T,I,k,R,j,N,A,z,M,B,W,L,U,V,_,H,X,q,K,G,J,Y,$,Q=i(15568),Z=i(19999),ee=i(14825),te=i(14834),ie=i(17866),ne=i(13009),oe=i(20826),re=i(13085),ae=i(11773),se=i(11804),le=i(19789),ce=i(14893),pe=i(20827),ue=i(15402),de=i(12328),fe=i.n(de),me=i(13240),ge=i(2e4),he=i(14900),ve=i(14346),be=i(20828),ye=i(14835),Ce=i(20824),we=i(14902),Se=i(20823),Oe=i(14896),De=i(15412),Fe=i(20829),Pe=i(15378),xe=i(19997),Ee=i(17176),Te=i(18956),Ie=["templateDefinition"],ke=["templateName"];function Re(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}function je(e,t,i,n,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function Ne(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var r=e.apply(t,i);function a(e){je(r,n,o,a,s,"next",e)}function s(e){je(r,n,o,a,s,"throw",e)}a(void 0)}))}}function Ae(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ze(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(i),!0).forEach((function(t){Me(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ae(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Me(e,t,i){return(t=Le(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Be(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function We(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Le(n.key),n)}}function Le(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Ue(e,t,i,n,o){var r={};return Object.keys(n).forEach((function(e){r[e]=n[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Ve=function(e){return e[e.AwaitingConsent=0]="AwaitingConsent",e[e.Consenting=1]="Consenting",e[e.SigningInConnections=2]="SigningInConnections",e[e.AwaitingCreation=3]="AwaitingCreation",e[e.CreationStarted=4]="CreationStarted",e[e.CreationCompleted=5]="CreationCompleted",e[e.ReviewingConnections=6]="ReviewingConnections",e[e.Loading=7]="Loading",e[e.DietView=8]="DietView",e[e.PreparingToClose=9]="PreparingToClose",e[e.CdsProvisioning=10]="CdsProvisioning",e}({}),_e=function(e){return e.FlowDisplayName="FlowDisplayName",e}({}),He={[ge.a.ConnectionWizard]:!0,[ge.a.DisplayingFlowInputs]:!0,[ge.a.CreatingFlow]:!1},Xe=(o=Ue((n=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props=t,this.isConnectionWizardConfirmClicked=void 0,this.flowName=void 0,this.loadConnectionWizardDesignerStylesManually=void 0,Be(this,"errorMessage",o,this),Be(this,"formState",r,this),Be(this,"templateName",a,this),Be(this,"connectionConfirmationCallback",s,this),Be(this,"saveFlowFromDietView",l,this),Be(this,"flowPropertiesInputs",c,this),Be(this,"inputParameters",p,this),Be(this,"isTemplateDescriptionExpanded",u,this),Be(this,"isLoadingConnections",d,this),Be(this,"selectedConnectionReferences",f,this),Be(this,"editInAdvancedModeLink",m,this),Be(this,"renderEditInAdvancedModeLink",g,this),Be(this,"editInAdvancedModeSelectedConnectionReferences",h,this),Be(this,"dietViewState",v,this),Be(this,"cdsProvisioningState",b,this),Be(this,"showAiBuilderTrialRenewalForm",y,this),Be(this,"dietDesignerInstantiationCount",C,this),Be(this,"connectionWizardState",w,this),Be(this,"_templateEntityFromTemplateDefinition",S,this),this.flowCreationOptions=void 0,this.dietViewProfiler=void 0,this.isXrmConnectionReferenceMode=void 0,this.defaultedToSolutionFlow=void 0,Be(this,"isNextInputParametersButtonEnabled",O,this),this.handleBackClicked=()=>{var{telemetryService:e}=this.props;e.tagEvent(me.c.FlowCreatorSurfaceBackButtonClicked,null,ze({},this.getBaseProfileData())),this.connectionConfirmationCallback?(this.isConnectionWizardConfirmClicked=!0,this.connectionConfirmationCallback()):this.loadAwaitCreation()},this.handleCreateClicked=Ne((function*(){var{telemetryService:e}=i.props;e.tagEvent(me.c.FlowCreatorSurfaceCreateFlowClicked,null,ze({},i.getBaseProfileData()));var t=i.inputParameters&&(yield Object(Q.g)({inputParameters:i.inputParameters})),n=yield Object(Q.g)({inputParameters:i.flowPropertiesInputs});return t&&n?i.createFlow():Promise.resolve()})),this.handleDoneClicked=()=>{var e,{onDone:t,telemetryService:i,skipClosingSurfaceOnDoneClicked:n}=this.props;(this.setFormState(Ve.PreparingToClose),i.tagEvent(me.c.FlowCreatorSurfaceDoneButtonClicked,null,ze({},this.getBaseProfileData())),t)&&t(this.flowEntity,null===(e=this.templateTrigger)||void 0===e?void 0:e.swaggerOperationId);n||this.handleClose()},this.handleCreateInNewTab=()=>{var{dismiss:e,telemetryService:t}=this.props;t.tagEvent(me.c.TemplateOpenNewTabClicked,{templateName:this.templateName}),e()},this.kickOffDietViewForSignIn=Ne((function*(){yield i.handleContinueSignInClicked()})),Be(this,"handleDietContinueSignInClicked",D,this),Be(this,"dismissAiBuilderTrialRenewalForm",F,this),Be(this,"extendAiBuilderTrial",P,this),this.handleContinueSignInClicked=function(){var e=Ne((function*(e){var{loggingService:t,telemetryService:n,entitlementsService:o}=i.props;if(n.tagEvent(me.c.FlowCreatorSurfaceSignInButtonClicked,null,ze({},i.getBaseProfileData())),fe()(i.connectionConfirmationCallback,"connection wizard continue button should always be defined prior to enabling the continue sign in button"),t.logInfo("FlowCreatorStore.handleContinueSignInClicked","Validating flow properties inputs before signing in"),!(yield Object(Q.g)({inputParameters:i.flowPropertiesInputs})))return t.logInfo("FlowCreatorStore.handleContinueSignInClicked","Continue sign in clicked while flow display name inputted is invalid."),Promise.resolve();if(i.formState===Ve.DietView){var r=o.checkAiBuilderEntitlementsStatus();!i.hasAiBuilderInTeams||r!==De.a.NotAllowedNoTrial&&r!==De.a.NotAllowedExpiredTrial&&r!==De.a.NotAllowedExpiredTrialWithTrialRenewalForm||(n.tagEvent(me.c.AiBuilderTeamsUpsellStartOrRenewTrial,null,{aiBuilderEntitlementsStatus:r,reasonForRenewal:e}),o.startAiBuilderTrial()),i.hasAiBuilderInTeams&&n.tagEvent(me.c.AiBuilderTeamsCreatedFlowFromTemplate,null,{templateName:i.templateName}),i.dietViewProfiler.profileDietViewInputParametersLoadStart()}return i.connectionConfirmationCallback&&(i.isConnectionWizardConfirmClicked=!0,i.connectionConfirmationCallback()),Promise.resolve()}));return function(t){return e.apply(this,arguments)}}(),this.handleDietViewSaveClicked=()=>{var{telemetryService:e}=this.props;e.tagEvent(me.c.FlowCreatorSurfaceDietViewCreateButtonClicked,null,ze({},this.getBaseProfileData())),fe()(this.saveFlowFromDietView,"saveFlowFromDietView button should always be defined prior to enabling the diet view create button"),this.saveFlowFromDietView&&(this.clearErrorMessage(),this.saveFlowFromDietView())},this.handleCancelClicked=()=>{var{onCancel:e,telemetryService:t,scenarioLoggingService:i,featureFlags:n}=this.props;t.tagEvent(me.c.FlowCreatorSurfaceCloseButtonClicked,null,ze({},this.getBaseProfileData())),this.formState===Ve.AwaitingConsent&&i.tagEvent(Ee.c.UserConsentScenario,me.c.UserConsentInterrupted,Ee.d.End,null,ze(ze({},this.getBaseProfileData()),{},{consentSource:"flowCreatorStore",unconsentedMode:!!n.enableUnconsentedMode})),e&&e(),this.handleClose()},this.handleClose=()=>{var{onClose:e,dismiss:t}=this.props;e&&e(),t()},Be(this,"setFormState",x,this),Be(this,"setInputParameters",E,this),Be(this,"setErrorMessage",T,this),Be(this,"clearErrorMessage",I,this),Be(this,"setSelectedConnectionReferences",k,this),Be(this,"handleConnectionWizardStateChange",R,this),Be(this,"registerConnectionConfirmationCallback",j,this),Be(this,"registerDietViewSaveFlowCallback",N,this),Be(this,"initializeFromTemplateDefinition",A,this),Be(this,"initializeFromTemplateName",z,this),this.initialize=e=>{var{loggingService:t,sessionStore:i}=this.props;this.flowCreationOptions=e;var n=Object(Se.a)(),o=!1;if(i.isAuthenticated)o=!0,n.resolve();else var r=Object(ae.autorun)(()=>{i.isAuthenticated&&(n.resolve(),r())});return Object(ue.b)({loggingService:t,promise:n.promise,eventStartName:re.a.reactFlowCreatorWaitForUserSessionStart,eventEndName:re.a.reactFlowCreatorWaitForUserSessionEnd,eventData:{alreadyAuthenticated:o}}).then(()=>this.initializeForAuthenticatedUser())},this.initializeForAuthenticatedUser=()=>{var{loggingService:e,scenarioLoggingService:t,userDetailsStore:i,widgetUtilService:n,autoConsentUser:o,sessionStore:r,featureFlags:a}=this.props;if(!i.isConsented||Object(Pe.c)(i,r)){var s={detectionSource:"flowCreatorStore",consentSource:"flowCreatorStore",unconsentedMode:!!a.enableUnconsentedMode};if(t.tagEvent(Ee.c.UserConsentScenario,me.c.UserConsentRequired,Ee.d.Start,null,s),!n.isWidgetPage()){var l=new ne.a(ne.c.flowCreatorUserNotConsented,"User must be consented if we are not in a widget page");t.logError(Ee.c.UserConsentScenario,"flowCreatorStore.initialize",Ee.d.Other,l,s)}return o?(t.logInfo(Ee.c.UserConsentScenario,"flowCreatorStore.initialize",Ee.d.Other,"Auto consenting user."),this.consent(!0)):(t.logInfo(Ee.c.UserConsentScenario,"flowCreatorStore.initialize",Ee.d.Other,"Auto consent not enabled, prompting user to consent instead."),this.initializeForNonConsentedUser())}return e.logInfo("flowCreatorStore.initialize","Loading for a user that has already consented."),this.initializeForConsentedUser()},this.loadTemplate=()=>{var{loggingService:e,templateService:t,widgetUtilService:i,onLoadTemplateError:n}=this.props;if(!this.templateName)return Promise.resolve();var o=t.loadTemplate({templateName:this.templateName,forceRefresh:!0,galleryName:ee.b.public}).then(()=>(i.isWidgetPage()&&i.fireTemplateLoadedEvent(),Promise.resolve())).catch(e=>(n&&n(e),Promise.reject(e)));return Object(ue.b)({loggingService:e,promise:o,eventStartName:re.a.reactFlowCreatorLoadTemplateStart,eventEndName:re.a.reactFlowCreatorLoadTemplateEnd})},Be(this,"initializeForNonConsentedUser",M,this),Be(this,"initializeForConsentedUser",B,this),Be(this,"initializeFlowPropertiesInput",W,this),Be(this,"initializeInputParameters",L,this),Be(this,"provisionCds",U,this),this.pollCdsProvisioningStateForReady=()=>{var{environmentService:e,environmentStore:t}=this.props;e.pollLoadEnvironmentForInstanceReady(t.currentEnvironmentName).then(()=>this.initializeForCdsProvisioningView()).catch(this.handleCdsProvisioningCallFailure)},Be(this,"handleCdsProvisioningCallFailure",V,this),Be(this,"onTemplateDescriptionExpandToggled",_,this),this.onConnectionsConfirmed=e=>this.isConnectionWizardConfirmClicked?(this.isConnectionWizardConfirmClicked=!1,this.setSelectedConnectionReferences(e),this.requiresUserInputBeforeCreating?(this.setFormState(Ve.AwaitingCreation),Promise.resolve()):this.createFlow()):Promise.resolve(),this.onFlowCreatedFromDietView=e=>{var{loggingService:t}=this.props;t.logInfo("flowCreatorStore.onFlowCreatedFromDietView","Flow successfully created from diet view",{templateName:this.templateEntity&&this.templateEntity.name}),this.flowName=e,this.handleFlowCreationCompleted(e)},this.onFlowCreationErrorFromDietView=e=>{var{loggingService:t}=this.props;t.logWarning("flowCreatorStore.onFlowCreationErrorFromDietView","Error creating flow from diet view",{templateName:this.templateEntity&&this.templateEntity.name,error:e});var{onCreateFlowError:i}=this.flowCreationOptions;i&&i(e),this.setErrorMessage(e)},this.createFlow=()=>{var e,t,i,n,o,r,{clientResources:a,flowService:s,loggingService:l,widgetUtilService:c,environmentStore:p,sessionStore:u,environmentCapabilityService:d,featureFlags:f}=this.props,{designTimeParameters:m={},installFlowAfterCreation:g,onCreateFlowError:h}=this.flowCreationOptions;this.clearErrorMessage();var v=this.formState;this.setFormState(Ve.CreationStarted);var b,y=ze(ze(ze({},c.isWidgetPage()?c.getWidgetDefaultParams():{}),m),this.inputParameters&&Object(Q.f)({inputParameters:this.inputParameters})),C=ze(ze({},this.getBaseProfileData()),{},{installFlowAfterCreation:g,parameterKeys:Object.keys(y||{}),defaultedToSolution:this.defaultedToSolutionFlow,xrmConnectionReferenceMode:this.isXrmConnectionReferenceMode});c.isWidgetPage()&&(b=c.getAdditionalOwners());var w=Object(xe.d)(l,!(null===(e=p.currentEnvironment)||void 0===e||!e.hasXrmInstance),c,!(null===(t=u.user)||void 0===t||!t.isConsumerDomain),p.currentEnvironmentName,d,null!==(i=null===(n=u.user)||void 0===n?void 0:n.tenantId)&&void 0!==i?i:"",null!==(o=null===(r=p.currentEnvironment)||void 0===r?void 0:r.xrmInstanceVersion)&&void 0!==o?o:"",!1).then(e=>{if(e!==xe.a.BlockFlowSave||this.flowCreationOptions.solutionId){this.flowCreationOptions.solutionId||e!==xe.a.ShouldDefault||(this.flowCreationOptions.solutionId=Object(Te.a)(),this.defaultedToSolutionFlow=!0),f.enableXRMConnectionReferenceModeForFlowCreateWidget&&this.flowCreationOptions.solutionId?(this.updateConnectionReferencesForSolutionModeInFlowCreatorStore(this.selectedConnectionReferences),this.isXrmConnectionReferenceMode=!0):this.isXrmConnectionReferenceMode=!1;var t=this.isXrmConnectionReferenceMode;return this.templateName?this.createFlowFromTemplateName({parameters:y,additionalOwners:b,isXrmConnectionReferenceMode:t}):this.createFlowFromTemplateDefinition({parameters:y,isXrmConnectionReferenceMode:t})}throw new ne.a(xe.b,a.DefaultToSolution.FlowSaveBlocked)}).then(e=>(this.flowName=e,g?Object(ue.b)({loggingService:l,eventData:C,eventStartName:re.a.reactFlowCreatorInstallFlowStart,eventEndName:re.a.reactFlowCreatorInstallFlowEnd,promise:s.installFlow({flowName:e,connectionReferences:this.selectedConnectionReferences})}):Promise.resolve())).then(()=>{this.handleFlowCreationCompleted(this.flowName)}).catch(e=>{if(Object(ne.cb)(e)===ne.c.OutOfBoxTemplateInstanceNotUniqueCode&&e.data&&e.data.error&&e.data.error.extendedData&&e.data.error.extendedData.flowName)return this.handleFlowCreationCompleted(e.data.error.extendedData.flowName),Promise.resolve();h&&h(e);var t=Object(ne.db)(e,a.Widget.FlowCreation.Error.FlowCreationFailed);return this.setErrorMessage(t),this.setFormState(v),Promise.reject(e)});return Object(ue.b)({loggingService:l,eventData:C,eventStartName:g?re.a.reactFlowCreatorCreateAndInstallFlowStart:re.a.reactFlowCreatorCreateFlowStart,eventEndName:g?re.a.reactFlowCreatorCreateAndInstallFlowEnd:re.a.reactFlowCreatorCreateFlowEnd,promise:w}).catch(()=>{})},this.handleFlowCreationCompleted=e=>{var{widgetUtilService:t}=this.props,{onCreateFlowCompletion:i}=this.flowCreationOptions;i&&i(e),t.isWidgetPage()&&t.widgetCloseOnFlowSaveEnabled()?t.fireWidgetCloseEvent():t.isWidgetPage()&&t.isExcelSDXContext()?(t.fireFlowCreationSucceeded(e),this.handleClose()):(!t.isWidgetPage()||t.isWidgetPage()&&!t.shouldWaitAfterSavingFlow())&&this.setFormState(Ve.CreationCompleted)},this.getFlowDisplayName=()=>((this.flowPropertiesInputs&&this.flowPropertiesInputs.FlowDisplayName?this.flowPropertiesInputs.FlowDisplayName.fieldState.value:this.initialFlowDisplayName)||"").trim()||void 0,this.createFlowFromTemplateDefinition=e=>{var{parameters:t,isXrmConnectionReferenceMode:i}=e,{flowService:n,loggingService:o}=this.props;return Object(ue.b)({loggingService:o,eventStartName:re.a.reactFlowCreatorCreateFlowFromTemplateDefinitionStart,eventEndName:re.a.reactFlowCreatorCreateFlowFromTemplateDefinitionEnd,eventData:ze(ze({},this.getBaseProfileData()),{},{parameterKeys:Object.keys(t||{}),defaultedToSolution:this.defaultedToSolutionFlow,xrmConnectionReferenceMode:i}),promise:n.createFlowFromTemplateDefinition({flowDisplayName:this.getFlowDisplayName(),solutionId:this.flowCreationOptions.solutionId,templateDefinition:this._templateEntityFromTemplateDefinition.toJS(),connectionReferences:this.selectedConnectionReferences,parameters:t,isXrmConnectionReferenceMode:i})})},this.createFlowFromTemplateName=e=>{var{parameters:t,additionalOwners:i,isXrmConnectionReferenceMode:n}=e,{flowService:o,loggingService:r}=this.props;return Object(ue.b)({loggingService:r,eventStartName:re.a.reactFlowCreatorCreateFlowFromTemplateNameStart,eventEndName:re.a.reactFlowCreatorCreateFlowFromTemplateNameEnd,eventData:ze(ze({},this.getBaseProfileData()),{},{parameterKeys:Object.keys(t||{}),defaultedToSolution:this.defaultedToSolutionFlow,xrmConnectionReferenceMode:n}),promise:o.createFlowFromTemplateName({flowDisplayName:this.getFlowDisplayName(),templateName:this.templateName,solutionId:this.flowCreationOptions.solutionId,galleryName:ee.b.public,connectionReferences:this.selectedConnectionReferences,additionalOwners:i,parameters:t,isXrmConnectionReferenceMode:n})})},this.getBaseProfileData=()=>{var{allowCreateInNewTab:e,allowCustomFlowDisplayName:t,widgetUtilService:i}=this.props;return{templateName:this.templateName,isUsingTemplateDefinitionFromHost:!!this._templateEntityFromTemplateDefinition,isMini:i.isMiniWidget(),allowCustomFlowName:!!t,createInNewTab:e,formState:Ve[this.formState],dietViewState:ge.a[this.dietViewState],connectionWizardState:this.connectionWizardState?Z.a[this.connectionWizardState]:void 0}},Be(this,"setIsLoadingConnections",H,this),this.onConsentClicked=()=>{var{loggingService:e}=this.props;return e.logInfo("flowCreatorStore.onConsentClicked","consenting user after user clicked consent"),this.consent()},this.consent=e=>{var{consentService:t,userDetailsStore:i,sessionStore:n,featureFlags:o,scenarioLoggingService:r}=this.props,a=ze({consentSource:"flowCreatorStore",unconsentedMode:!!o.enableUnconsentedMode},this.getBaseProfileData());e?(r.tagEvent(Ee.c.UserConsentScenario,me.c.UserAutoConsented,Ee.d.Other,null,a),t.setIsEmailOptedIn(!1),this.setFormState(Ve.Loading)):(r.tagEvent(Ee.c.UserConsentScenario,me.c.UserConsentAcceptClicked,Ee.d.Resume,null,a),this.setFormState(Ve.Consenting));var s=Object(Pe.b)(i,n),l=r.profileStart(Ee.c.UserConsentScenario,re.a.reactFlowCreatorConsentStart,Ee.d.Other,a);return t.consent(s).then(()=>(r.profileEndWithSuccess(l,Ee.c.UserConsentScenario,re.a.reactFlowCreatorConsentEnd,Ee.d.End,a),o.enableReloadAfterConsentForInvokeFlowStore&&window.location.reload(),this.initializeForConsentedUser(!0))).catch(e=>{r.profileEnd(l,Ee.c.UserConsentScenario,re.a.reactFlowCreatorConsentEnd,Ee.d.End,Object(ne.y)(e),e,a),this.setFormState(Ve.AwaitingConsent),this.setErrorMessage(e)})},this.loadAwaitCreation=()=>{this.setFormState(Ve.AwaitingCreation)},this.addConnectionsToStore=e=>{var{connectionService:t,environmentStore:i}=this.props,n=ie.a.getCollectionType({environmentName:i.currentEnvironmentName});t.addConnectionsToStore({connections:e,collectionType:n})},this.initializeForDietView=()=>{var{loggingService:e}=this.props;e.logInfo("flowCreatorStore.initializeForDietView","Initializeing FlowCreatorSurface for diet view",{templateName:this.templateEntity&&this.templateEntity.name}),this.dietViewProfiler.profileInitializeStart(this.templateEntity&&this.templateEntity.name),this.initializeFlowPropertiesInput(),this.setDietViewState(ge.a.ConnectionWizard),this.setStateAndLoadConnections({state:Ve.DietView,eventStartName:re.a.reactFlowCreatorLoadConnectionsForDietViewStart,eventEndName:re.a.reactFlowCreatorLoadConnectionsForDietViewEnd})},Be(this,"initializeForCdsProvisioningView",X,this),Be(this,"onDietViewStateChange",q,this),Be(this,"handleNodeDoneLoadingParameters",K,this),Be(this,"setIsNextInputParametersButtonEnabled",G,this),this.isDeepLinkToTemplateEditorEnabled=()=>{var{widgetUtilService:e}=this.props;return e.isWidgetPage()&&e.getTeamsDeepLinkScenariosEnabled().createTabTemplateEditor},Be(this,"initializeEditInAdvancedModeLink",J,this),this.handleEditInAdvancedModeClicked=()=>{var e,{widgetUtilService:t,dismiss:i}=this.props;this.isDeepLinkToTemplateEditorEnabled()?this.handleEditInAdvancedModeDeeplink():!t.isWidgetPage()||null!==(e=t.widgetOptions)&&void 0!==e&&e.exitWidgetToEditInAdvancedMode||i()},this.handleEditInAdvancedModeDeeplink=()=>{var{loggingService:e,teamsDeepLinkService:t}=this.props;e.logInfo("FlowCreatorStore.handleEditInAdvancedModeDeeplink","executing deep link to create tab");var i={};Object.entries(this.editInAdvancedModeSelectedConnectionReferences||{}).map(e=>{var[t,n]=e;i[t]={selectedConnectionName:n.connection?Object(we.c)(n.connection.id).connections:void 0,connectionProviderId:n.api?n.api.id:""}}),t.goToCreateTabTemplateEditor({templateName:this.templateName,galleryName:ee.b.public,connectionReferences:i})},this.handleDietViewBackButtonClicked=()=>{this.resetDietDesigner()},Be(this,"resetDietDesigner",Y,this),Be(this,"setDietViewState",$,this),this.loadSignInConnections=()=>{this.dietViewProfiler.profileInitializeStart(this.templateEntity&&this.templateEntity.name),this.setStateAndLoadConnections({state:Ve.SigningInConnections,eventStartName:re.a.reactFlowCreatorLoadSignInConnectionsStart,eventEndName:re.a.reactFlowCreatorLoadSignInConnectionsEnd})},this.setStateAndLoadConnections=e=>{var{state:t,eventStartName:i,eventEndName:n,fallbackState:o}=e,{clientResources:r,loggingService:a}=this.props,s=a.profileStart(i,this.getBaseProfileData());this.loadConnections().then(()=>{a.profileEndWithSuccess(s,n,this.getBaseProfileData())}).catch(e=>{this.setErrorMessage(r.InvokeFlowForm.ErrorMessage.FailedToLoadConnections),a.profileEnd(s,n,Object(ne.y)(e),e,this.getBaseProfileData()),o&&this.setFormState(o)}),this.setFormState(t)},this.initializeConnections=()=>{var e=!this.props.skipForceRefreshOfConnections;return this.loadConnections(e).catch(e=>{})},this.loadConnections=e=>{var{connectionService:t,loggingService:i}=this.props,n=ze(ze({},this.getBaseProfileData()),{},{forceRefresh:e}),o=i.profileStart(re.a.reactFlowCreatorConnectionsLoadStart,n);return this.setIsLoadingConnections(!0),t.getConnections({forceRefresh:e}).then(()=>{i.profileEndWithSuccess(o,re.a.reactFlowCreatorConnectionsLoadEnd,n),this.setIsLoadingConnections(!1)}).catch(e=>{throw i.profileEnd(o,re.a.reactFlowCreatorConnectionsLoadEnd,Object(ne.y)(e),e,n),this.setIsLoadingConnections(!1),e})},this.getCallbackUrl=()=>{var e,{loggingService:t,callbackUrlService:{getCallbackUrl:i}}=this.props,n=this.flowEntity;if(void 0===n||0===(null===(e=n.properties.definitionSummary)||void 0===e||null===(e=e.triggers)||void 0===e?void 0:e.length))return Promise.reject(new Error("Flow entity is undefined or has no triggers."));if(void 0===n.name||null===n.name)return Promise.reject(new Error("Flow name is null or undefined"));var o=Object(ye.y)(n);if(null===o)return Promise.reject(new Error("Trigger name is null."));var r=i(n.name,o).then(e=>e.value).catch(e=>Promise.reject(e));return Object(ue.b)({loggingService:t,promise:r,eventStartName:re.a.reactFlowCreatorGetCallbackUrlStart,eventEndName:re.a.reactFlowCreatorGetCallbackUrlEnd})},this.setFormState(Ve.Loading),this.setDietViewState(ge.a.ConnectionWizard);var{loggingService:n,widgetUtilService:te}=this.props;this.dietViewProfiler=new be.a(n,te),this.setIsNextInputParametersButtonEnabled(!1),Object(ae.runInAction)(()=>this.dietDesignerInstantiationCount=0),this.loadConnectionWizardDesignerStylesManually=t.loadConnectionWizardDesignerStylesManually}var t,i,n;return t=e,(i=[{key:"templateEntity",get:function(){var{templateStore:e}=this.props;return!!this.templateName&&e.templates.getEntity(this.templateName)||this._templateEntityFromTemplateDefinition||void 0}},{key:"templateTrigger",get:function(){return this.templateEntity&&this.templateEntity.properties&&Object(Oe.c)(this.templateEntity)}},{key:"templateTriggerType",get:function(){var{clientResources:e}=this.props;return Object(ye.R)(this.templateTrigger)?e.Manage.Flows.Type.Scheduled:Object(ye.J)(this.templateTrigger)?null:e.Manage.Flows.Type.Automated}},{key:"flowEntity",get:function(){var{flowStore:e}=this.props;return e.flows.getEntity(this.flowName)}},{key:"footerButtons",get:function(){var{clientResources:e,routeCrafter:t,allowCreateInNewTab:i,templateName:n,hideCancelButton:o,widgetUtilService:r}=this.props,a=i?{href:Object(he.q)(t,{createFromTemplateInfo:{templateName:n||"",gallery:ee.b.public}}),target:ve.b.blank,onClick:this.handleCreateInNewTab}:{},s=[{[Ve.AwaitingConsent]:{text:e.UserConsent.Continue,primary:!0,disabled:!1,onClick:this.onConsentClicked,allowDisabledFocus:!0},[Ve.Consenting]:{text:e.UserConsent.Consenting,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[Ve.Loading]:{text:e.InvokeFlowForm.ButtonText.Loading,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[Ve.SigningInConnections]:ze({text:this.signInButtonText,primary:!0,disabled:!this.isContinueSignInButtonEnabled,onClick:()=>this.handleContinueSignInClicked(),allowDisabledFocus:!0},a),[Ve.CreationCompleted]:{text:this.doneButtonOverrideText,primary:!0,disabled:!1,onClick:this.handleDoneClicked,allowDisabledFocus:!0},[Ve.PreparingToClose]:{text:e.InvokeFlowForm.ButtonText.Loading,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[Ve.AwaitingCreation]:ze({text:this.createFlowButtonText,primary:!0,disabled:!this.isCreateButtonEnabled,onClick:this.handleCreateClicked,allowDisabledFocus:!0},a),[Ve.CreationStarted]:{text:e.FlowCreator.ButtonText.Creating,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0},[Ve.ReviewingConnections]:{text:e.InvokeFlowForm.ButtonText.Back,primary:!0,disabled:!this.isBackButtonEnabled,onClick:this.handleBackClicked,allowDisabledFocus:!0},[Ve.DietView]:this.dietViewFooterPrimaryButton,[Ve.CdsProvisioning]:this.cdsProvisioningViewFooterPrimaryButton}[this.formState]];if(!o&&!r.isExcelOfficeScriptsSDXContext()&&this.formState!==Ve.ReviewingConnections&&this.formState!==Ve.CreationCompleted&&this.formState!==Ve.PreparingToClose){var l={text:e.Dialogs.RunFlow.Button.Cancel,onClick:this.handleCancelClicked,primary:!1,disabled:!1};s.push(l)}return s}},{key:"dietDesignerInstanceKey",get:function(){return"dietDesignerInstance-".concat(this.dietDesignerInstantiationCount)}},{key:"connectorIcons",get:function(){return this.templateEntity?this.templateEntity.connectionReferenceIcons(this.props.assetService):[]}},{key:"aiBuilderEntitlementsStatus",get:function(){if(this.hasAiBuilderInTeams){var{entitlementsService:e}=this.props;return e.checkAiBuilderEntitlementsStatus()}}},{key:"hasAiBuilderInTeams",get:function(){var e,{featureFlags:t}=this.props;return!(this.formState!==Ve.DietView||!t.enableAIBuilderInTeams||this.dietViewState!==ge.a.ConnectionWizard||!Object(Ce.a)(null===(e=this.templateEntity)||void 0===e?void 0:e.properties))}},{key:"shouldBlockContinueNoAiBuilderCapacity",get:function(){var{entitlementsService:e}=this.props;if(!this.hasAiBuilderInTeams)return!1;var t=e.checkAiBuilderEntitlementsStatus();return t===De.a.NotAllowedTrialCountLimit||t===De.a.NotAllowedTrialCapacityLimit||t===De.a.NotAllowedToStartTrial}},{key:"dietViewFooterPrimaryButton",get:function(){var{clientResources:e}=this.props;return{[ge.a.ConnectionWizard]:{text:e.Common.Next,primary:!0,disabled:!this.isContinueSignInButtonEnabled||!Object(Q.c)({inputParameters:this.flowPropertiesInputs})||this.shouldBlockContinueNoAiBuilderCapacity,onClick:this.handleDietContinueSignInClicked,allowDisabledFocus:!0},[ge.a.DisplayingFlowInputs]:{text:this.createFlowButtonText,primary:!0,disabled:!this.isNextInputParametersButtonEnabled,onClick:this.handleDietViewSaveClicked,allowDisabledFocus:!0},[ge.a.CreatingFlow]:{text:e.FlowCreation.CreatingFlowInProgress,primary:!0,disabled:!0,onClick:void 0,allowDisabledFocus:!0}}[this.dietViewState]}},{key:"cdsProvisioningViewFooterPrimaryButton",get:function(){var{clientResources:e}=this.props;return{[Fe.a.NotProvisioned]:{text:e.UserConsent.Continue,primary:!0,disabled:!1,onClick:this.provisionCds,allowDisabledFocus:!0},[Fe.a.Provisioning]:{text:e.UserConsent.Continue,primary:!0,disabled:!0,allowDisabledFocus:!0}}[this.cdsProvisioningState]}},{key:"templateParametersToReplace",get:function(){var e,{widgetUtilService:t}=this.props;return ze(ze({},t.isWidgetPage()?t.getWidgetDefaultParams():{}),null!==(e=this.flowCreationOptions.designTimeParameters)&&void 0!==e?e:{})}},{key:"getSolutionId",get:function(){return this.flowCreationOptions.solutionId}},{key:"signInButtonText",get:function(){var{clientResources:e}=this.props;return this.requiresUserInputBeforeCreating?e.InvokeFlowForm.ButtonText.SignIn:this.createFlowButtonText}},{key:"doneButtonOverrideText",get:function(){var{addDoneButtonText:e,clientResources:t,widgetUtilService:i}=this.props;return this.templateTriggerType===t.Manage.Flows.Type.Automated||this.templateTriggerType===t.Manage.Flows.Type.Scheduled||e?t.Common.Done:i.isWidgetPage()?i.getOverrideableString(t.Common.Done,se.b.FLOW_CREATION_DONE_BUTTON):""}},{key:"createFlowButtonText",get:function(){var{allowCreateInNewTab:e,clientResources:t,widgetUtilService:i}=this.props;return i.isWidgetPage()&&i.widgetStrings&&i.widgetStrings[se.b.FLOW_CREATION_CREATE_BUTTON]?i.widgetStrings[se.b.FLOW_CREATION_CREATE_BUTTON]:e?t.ImportTemplate.NewTab:t.Flow.CreateButtonLabel.Create}},{key:"updateConnectionReferencesForSolutionModeInFlowCreatorStore",value:function(e){Object(xe.f)(e)}},{key:"isConnectionWizardVisible",get:function(){return void 0!==this.connectionWizardState}},{key:"isCreateButtonEnabled",get:function(){return Object(Q.c)({inputParameters:this.flowPropertiesInputs})&&Object(Q.c)({inputParameters:this.inputParameters})}},{key:"isContinueSignInButtonEnabled",get:function(){return this.connectionWizardState===Z.a.ready}},{key:"isConnectionWizardFaulted",get:function(){return this.connectionWizardState===Z.a.failed}},{key:"isBackButtonEnabled",get:function(){return 0===Object.keys(this.connectionWizardConnectionReferences).length||this.connectionWizardState===Z.a.ready||!this.connectionConfirmationCallback}},{key:"connectionWizardConnectionReferences",get:function(){var e=this.templateEntity&&this.templateEntity.connectionReferences||{};return Object.keys(e).map(t=>this.selectedConnectionReferences&&this.selectedConnectionReferences[t]?{[t]:this.selectedConnectionReferences[t]}:{[t]:e[t]}).reduce((e,t)=>ze(ze({},e),t),{})}},{key:"availableConnections",get:function(){var{connectionStore:e,environmentStore:t}=this.props,i=ie.a.getCollectionType({environmentName:t.currentEnvironmentName}),n=e.connections.getCollection(i);return(n&&n.list||[]).map(t=>e.connections.getEntity(t).toJS())}},{key:"shouldUseDietDesignerView",get:function(){var{widgetUtilService:e}=this.props;return!!this.templateEntity&&!Object(Oe.d)(this.templateEntity,e)&&this.templateEntity.isDietTemplate(e)}},{key:"initialFlowDisplayName",get:function(){var{widgetUtilService:e}=this.props;return e.isWidgetPage()&&e.widgetStrings&&e.widgetStrings[se.b.FLOW_CREATION_CUSTOM_FLOW_NAME]||this.templateEntity&&this.templateEntity.displayName}},{key:"requiresUserInputBeforeCreating",get:function(){return this.formState===Ve.DietView||!Object(ce.a)(this.inputParameters)}},{key:"loadEnvironmentAndInitializeView",value:function(){var{environmentService:e,environmentStore:t}=this.props;return t.currentEnvironmentName||this.props.loggingService.logInfo("flowCreatorStore.loadEnvironmentAndInitializeView","current environment name is not defined: ".concat(t.currentEnvironmentName)),e.loadEnvironment({forceRefresh:!0,environmentName:t.currentEnvironmentName}).then(()=>this.initializeForCdsProvisioningView(!0))}},{key:"flowDisplayNameLabelText",get:function(){var{clientResources:e,widgetUtilService:t}=this.props;return t.getOverrideableString(e.Flow.FlowDisplayNameLabel,se.b.FLOW_DISPLAY_NAME_LABEL)}},{key:"isXrmConnectionReferenceModeResult",get:function(){return this.isXrmConnectionReferenceMode}}])&&We(t.prototype,i),n&&We(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"errorMessage",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=Ue(n.prototype,"formState",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Ue(n.prototype,"templateName",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Ue(n.prototype,"connectionConfirmationCallback",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Ue(n.prototype,"saveFlowFromDietView",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Ue(n.prototype,"flowPropertiesInputs",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Ue(n.prototype,"inputParameters",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Ue(n.prototype,"isTemplateDescriptionExpanded",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Ue(n.prototype,"isLoadingConnections",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Ue(n.prototype,"selectedConnectionReferences",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Ue(n.prototype,"editInAdvancedModeLink",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Ue(n.prototype,"renderEditInAdvancedModeLink",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Ue(n.prototype,"editInAdvancedModeSelectedConnectionReferences",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Ue(n.prototype,"dietViewState",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Ue(n.prototype,"cdsProvisioningState",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Ue(n.prototype,"showAiBuilderTrialRenewalForm",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Ue(n.prototype,"dietDesignerInstantiationCount",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=Ue(n.prototype,"connectionWizardState",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=Ue(n.prototype,"_templateEntityFromTemplateDefinition",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Ue(n.prototype,"isNextInputParametersButtonEnabled",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ue(n.prototype,"templateEntity",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"templateEntity"),n.prototype),Ue(n.prototype,"templateTrigger",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"templateTrigger"),n.prototype),Ue(n.prototype,"templateTriggerType",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"templateTriggerType"),n.prototype),Ue(n.prototype,"flowEntity",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"flowEntity"),n.prototype),Ue(n.prototype,"footerButtons",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"footerButtons"),n.prototype),Ue(n.prototype,"dietDesignerInstanceKey",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"dietDesignerInstanceKey"),n.prototype),Ue(n.prototype,"connectorIcons",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"connectorIcons"),n.prototype),Ue(n.prototype,"aiBuilderEntitlementsStatus",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"aiBuilderEntitlementsStatus"),n.prototype),Ue(n.prototype,"hasAiBuilderInTeams",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"hasAiBuilderInTeams"),n.prototype),Ue(n.prototype,"shouldBlockContinueNoAiBuilderCapacity",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"shouldBlockContinueNoAiBuilderCapacity"),n.prototype),Ue(n.prototype,"dietViewFooterPrimaryButton",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"dietViewFooterPrimaryButton"),n.prototype),Ue(n.prototype,"cdsProvisioningViewFooterPrimaryButton",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"cdsProvisioningViewFooterPrimaryButton"),n.prototype),Ue(n.prototype,"signInButtonText",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"signInButtonText"),n.prototype),Ue(n.prototype,"doneButtonOverrideText",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"doneButtonOverrideText"),n.prototype),Ue(n.prototype,"createFlowButtonText",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"createFlowButtonText"),n.prototype),D=Ue(n.prototype,"handleDietContinueSignInClicked",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{entitlementsService:e}=this.props;if(this.formState!==Ve.DietView)return this.handleContinueSignInClicked();var t=e.checkAiBuilderEntitlementsStatus();if(!this.hasAiBuilderInTeams||t!==De.a.NotAllowedExpiredTrialWithTrialRenewalForm)return this.handleContinueSignInClicked();this.showAiBuilderTrialRenewalForm=!0}}}),F=Ue(n.prototype,"dismissAiBuilderTrialRenewalForm",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.showAiBuilderTrialRenewalForm=!1}}}),Ue(n.prototype,"updateConnectionReferencesForSolutionModeInFlowCreatorStore",[ae.action],Object.getOwnPropertyDescriptor(n.prototype,"updateConnectionReferencesForSolutionModeInFlowCreatorStore"),n.prototype),P=Ue(n.prototype,"extendAiBuilderTrial",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>(this.showAiBuilderTrialRenewalForm=!1,this.handleContinueSignInClicked(e))}}),Ue(n.prototype,"isConnectionWizardVisible",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"isConnectionWizardVisible"),n.prototype),Ue(n.prototype,"isCreateButtonEnabled",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"isCreateButtonEnabled"),n.prototype),Ue(n.prototype,"isContinueSignInButtonEnabled",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"isContinueSignInButtonEnabled"),n.prototype),Ue(n.prototype,"isConnectionWizardFaulted",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"isConnectionWizardFaulted"),n.prototype),Ue(n.prototype,"isBackButtonEnabled",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"isBackButtonEnabled"),n.prototype),Ue(n.prototype,"connectionWizardConnectionReferences",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"connectionWizardConnectionReferences"),n.prototype),Ue(n.prototype,"availableConnections",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"availableConnections"),n.prototype),x=Ue(n.prototype,"setFormState",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.connectionConfirmationCallback=void 0,this.connectionWizardState=void 0,this.formState=e}}}),E=Ue(n.prototype,"setInputParameters",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.inputParameters=e}}}),T=Ue(n.prototype,"setErrorMessage",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{clientResources:t}=this.props;this.errorMessage=Object(ne.db)(e,t.Common.SomethingWentWrong)}}}),I=Ue(n.prototype,"clearErrorMessage",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.errorMessage=void 0}}}),k=Ue(n.prototype,"setSelectedConnectionReferences",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedConnectionReferences=e}}}),R=Ue(n.prototype,"handleConnectionWizardStateChange",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{loggingService:t}=this.props;this.connectionWizardState=e,e===Z.a.failed&&t.logWarning("flowCreatorStore.fixConnectionMessageDisplayed","Displaying message asking user to fix connections."),this.dietViewProfiler.profileConnectionWizardStateChange(e),this.formState===Ve.DietView&&this.initializeEditInAdvancedModeLink({selectedConnectionReferences:void 0})}}}),j=Ue(n.prototype,"registerConnectionConfirmationCallback",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.connectionConfirmationCallback=e}}}),N=Ue(n.prototype,"registerDietViewSaveFlowCallback",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFlowFromDietView=e}}}),A=Ue(n.prototype,"initializeFromTemplateDefinition",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{templateDefinition:t}=e,i=Re(e,Ie),{clientResources:n,loggingService:o}=this.props,r=Object(pe.a)({templateDefinition:t,clientResources:n});return r?(o.logError("flowCreatorStore.initializeFromTemplateDefinition",new ne.a(ne.c.flowCreationWidgetInvalidCreateFromTemplateDefinitionArgs,r)),this.setErrorMessage(r),Promise.resolve()):(this._templateEntityFromTemplateDefinition=new te.a(t),this.initialize(i))}}}),z=Ue(n.prototype,"initializeFromTemplateName",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{templateName:t}=e,i=Re(e,ke),{loggingService:n}=this.props;return t?(this.templateName=t,this.initialize(i)):(n.logError("flowCreatorStore.initializeFromTemplateName",new ne.a(ne.c.flowCreatorMissingTemplateName,"Must supply templateName when initializing from template name")),Promise.resolve())}}}),Ue(n.prototype,"shouldUseDietDesignerView",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"shouldUseDietDesignerView"),n.prototype),M=Ue(n.prototype,"initializeForNonConsentedUser",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{widgetUtilService:e,featureFlags:t,scenarioLoggingService:i}=this.props;this.setFormState(Ve.Loading);var n={consentSource:"flowCreatorStore",unconsentedMode:!!t.enableUnconsentedMode};return this.loadTemplate().then(()=>{e.isWidgetPage()&&e.fireConsentPromptLoaded(),this.setFormState(Ve.AwaitingConsent),i.tagEvent(Ee.c.UserConsentScenario,me.c.UserConsentDialogueShown,Ee.d.Pause,null,n)}).catch(e=>{n=ze(ze({},n),{},{error:e}),i.tagEvent(Ee.c.UserConsentScenario,me.c.UserConsentInterrupted,Ee.d.End,void 0,n),this.setErrorMessage(e)})}}}),B=Ue(n.prototype,"initializeForConsentedUser",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.setFormState(Ve.Loading),this.initializeConnections();var{featureFlags:t}=this.props;return(e?Promise.resolve():this.loadTemplate()).then(()=>{if(this.shouldUseDietDesignerView){if(t.enableAIBuilderInTeams&&Object(Ce.a)(this.templateEntity.properties))return this.loadEnvironmentAndInitializeView();this.initializeForDietView()}else this.initializeFlowPropertiesInput(),this.initializeInputParameters(),this.loadSignInConnections();return Promise.resolve()}).catch(e=>{this.setErrorMessage(e)})}}}),Ue(n.prototype,"initialFlowDisplayName",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"initialFlowDisplayName"),n.prototype),Ue(n.prototype,"requiresUserInputBeforeCreating",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"requiresUserInputBeforeCreating"),n.prototype),W=Ue(n.prototype,"initializeFlowPropertiesInput",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{allowCustomFlowDisplayName:e,clientResources:t,widgetUtilService:i}=this.props,n=new Q.a(t,t,t);e&&(this.flowPropertiesInputs={[_e.FlowDisplayName]:n.createInputParameter({type:Q.b.Text,label:this.flowDisplayNameLabelText,description:t.Common.Untitled,maxLength:le.a.NameMaxLength,isRequired:!1,initialValue:this.initialFlowDisplayName,singleLine:!0})},i.isWidgetPage()&&i.onFlowDisplayNameChangedByHost(this.flowPropertiesInputs[_e.FlowDisplayName].fieldState.onChange))}}}),Ue(n.prototype,"flowDisplayNameLabelText",[ae.computed],Object.getOwnPropertyDescriptor(n.prototype,"flowDisplayNameLabelText"),n.prototype),L=Ue(n.prototype,"initializeInputParameters",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{clientResources:e}=this.props,t=Object(oe.a)({templateEntity:this.templateEntity,clientResources:e});this.setInputParameters(t)}}}),U=Ue(n.prototype,"provisionCds",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{businessAppPlatformService:e,environmentStore:t}=this.props;this.clearErrorMessage(),e.provisionInstance(t.currentEnvironmentName).then(this.pollCdsProvisioningStateForReady).catch(this.handleCdsProvisioningCallFailure),this.cdsProvisioningState=Fe.a.Provisioning}}}),V=Ue(n.prototype,"handleCdsProvisioningCallFailure",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{clientResources:t}=this.props;this.setErrorMessage(Object(ne.db)(e,t.FlowCreator.CDSProvisioning.ErrorMessage)),this.initializeForCdsProvisioningView()}}}),_=Ue(n.prototype,"onTemplateDescriptionExpandToggled",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isTemplateDescriptionExpanded=e}}}),H=Ue(n.prototype,"setIsLoadingConnections",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isLoadingConnections=e}}}),X=Ue(n.prototype,"initializeForCdsProvisioningView",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{environmentStore:{currentEnvironment:i},clientResources:n}=e.props;null!=i&&i.isDatabaseReady?e.initializeForDietView():(e.setFormState(Ve.CdsProvisioning),null!=i&&i.isDatabaseProvisioning?(e.cdsProvisioningState=Fe.a.Provisioning,e.pollCdsProvisioningStateForReady()):(null!=i&&i.isDatabaseInUnexpectedState&&!t&&e.setErrorMessage(n.FlowCreator.CDSProvisioning.ErrorMessage),e.cdsProvisioningState=Fe.a.NotProvisioned))}}}),q=Ue(n.prototype,"onDietViewStateChange",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{var{loggingService:n}=this.props;this.dietViewState=e;var o=i&&i.selectedConnectionReferences;e===ge.a.DisplayingFlowInputs&&this.dietViewProfiler.profileDietViewInputParametersLoadEnd(),n.logInfo("flowCreatorStore.onDietViewStateChange","Diet designer state changed",{newState:e,oldState:t,hasDietViewDate:!!i,hasSelectedConnectionReferences:!!o}),fe()(this.templateEntity,"Diet designer should not be rendered until there is an existing templateEntity"),this.initializeEditInAdvancedModeLink({selectedConnectionReferences:e===ge.a.ConnectionWizard?void 0:o})}}}),K=Ue(n.prototype,"handleNodeDoneLoadingParameters",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.dietViewState===ge.a.DisplayingFlowInputs&&(this.isNextInputParametersButtonEnabled=!0)}}}),G=Ue(n.prototype,"setIsNextInputParametersButtonEnabled",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isNextInputParametersButtonEnabled=e}}}),J=Ue(n.prototype,"initializeEditInAdvancedModeLink",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{selectedConnectionReferences:t}=e,{appSettings:i,routeCrafter:n,widgetUtilService:o}=this.props;if(He[this.dietViewState])if(this.renderEditInAdvancedModeLink=!0,this.isDeepLinkToTemplateEditorEnabled())this.editInAdvancedModeLink=void 0,this.editInAdvancedModeSelectedConnectionReferences=t;else{var r,a=Object(he.q)(n,{connectionReferences:t,createFromTemplateInfo:{templateName:this.templateEntity.name,gallery:ee.b.public},solutionId:this.flowCreationOptions&&this.flowCreationOptions.solutionId},{isWidgetPage:o.isWidgetPage()&&!(null!==(r=o.widgetOptions)&&void 0!==r&&r.exitWidgetToEditInAdvancedMode)});this.editInAdvancedModeLink=a}else this.renderEditInAdvancedModeLink=!1}}}),Y=Ue(n.prototype,"resetDietDesigner",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.dietDesignerInstantiationCount++,this.editInAdvancedModeLink=void 0,this.renderEditInAdvancedModeLink=!1,this.connectionConfirmationCallback=void 0,this.connectionWizardState=void 0,this.setDietViewState(ge.a.ConnectionWizard)}}}),$=Ue(n.prototype,"setDietViewState",[ae.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dietViewState=e}}}),n)},20826:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(15568),o=i(15567),r=function(e){return e.approvers="parameters.sharepoint.approvers",e}(r||{}),a=function(e){return e.remindMeIn="parameters.sharepoint.remindMeIn",e}(a||{}),s=["8cf4ac7cc4b04e41ad508978e47db6fb","21fefca900444d75b60c9c80be2e38d7","341b410713de4f5f961bf111b3b12e98","cea8b0b9fd1b4289b192d2f537d06273","598344fbd57f4e52b6f9d2de614b39a3","7af220e931944f77b5551b15c40a1467"],l=["11111111111111111111111111111111","43bc77fc753547edb52e4259f85129ba","0cc298b1c0c64fc4b21f8f1c5ad818ab","d92620c13e7d421699297ac77bbdb568"],c=["SHAREPOINT_CONTEXTUAL_APPROVAL_TIP1","SHAREPOINT_CONTEXTUAL_APPROVAL","SHAREPOINT_APPROVALS_HUBJOIN_TIP1","SHAREPOINT_APPROVALS_HUBJOIN","SPOCONTENTAPPROVAL"],p=["SHAREPOINT_CONTEXTUAL_REMINDER_TIP1","SHAREPOINT_CONTEXTUAL_REMINDER"];function u(e){var{templateEntity:t,templateNames:i=[],templateCategories:n=[]}=e;return!!t&&(i.indexOf(t.name)>-1||function(e){var{templateEntity:t,templateCategories:i}=e;if(!t||!t.categoryNames)return!1;return(i||[]).some(e=>t.categoryNames.some(t=>0===e.localeCompare(t,void 0,{sensitivity:"accent"})))}({templateCategories:n,templateEntity:t}))}function d(e){var{templateEntity:t,clientResources:i}=e;return u({templateEntity:t,templateNames:s,templateCategories:c})?function(e){var{clientResources:t}=e,i=new n.a(t,t,t);return{[r.approvers]:i.createInputParameter({type:n.b.Email,label:t.Widget.FlowCreation.SharepointApproverLabel,description:t.Widget.FlowCreation.SharepointApproverPlaceholder,isRequired:!0})}}({clientResources:i}):u({templateEntity:t,templateNames:l,templateCategories:p})?function(e){var{clientResources:t}=e,i=new n.a(t,t,t);return{[a.remindMeIn]:i.createInputParameter({type:n.b.Number,label:t.Widget.FlowCreation.SharepointRemindMeInLabel,description:t.Widget.FlowCreation.SharepointRemindMeInPlaceholder,isRequired:!0,initialValue:"1",additionalValidators:[Object(o.t)({errorHandlingResources:t,fieldDisplayName:t.Widget.FlowCreation.SharepointRemindMeInLabel})]})}}({clientResources:i}):{}}},20827:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(14893);function o(e){var{templateDefinition:t,clientResources:i}=e;if(Object(n.a)(t))return i.Widget.FlowCreation.TemplateDefinition.MissingTemplateDefinitionError;if(Object(n.a)(t.properties))return i.Widget.FlowCreation.TemplateDefinition.MissingPropertiesError;if(Object(n.a)(t.properties.definition))return i.Widget.FlowCreation.TemplateDefinition.MissingDefinitionError;if(Object(n.a)(t.properties.connectionReferences))return i.Widget.FlowCreation.TemplateDefinition.MissingConnectionReferencesError;var o=t.properties.definition;return Object(n.a)(o.triggers)?i.Widget.FlowCreation.TemplateDefinition.MissingTriggersError:Object(n.a)(o.actions)?i.Widget.FlowCreation.TemplateDefinition.MissingActionsError:void 0}},20828:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(19999),o=i(13009);function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e,t,i){return(t=c(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(e){return e.Visible="DietViewProfiler.ConnectionWizard.Visible",e.FinishedLoading="DietViewProfiler.ConnectionWizard.FinishedLoading",e}(p||{}),u=l((function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.widgetUtilService=i,this.initializationCorrelationId=void 0,this.initializationStartTime=void 0,this.connectionWizardEventsLogged={[p.Visible]:!1,[p.FinishedLoading]:!1},this.inputParametersLoadCorrelationId=void 0,this.templateName=void 0,this.profileInitializeStart=e=>{this.templateName=e,this.connectionWizardEventsLogged={[p.Visible]:!1,[p.FinishedLoading]:!1},this.initializationCorrelationId=this.loggingService.profileStart("DietViewProfiler.InitializeStart",{templateName:this.templateName}),this.initializationStartTime=this.loggingService.performanceNow()},this.profileConnectionWizardStateChange=e=>{switch(e){case n.a.pending:this.profileConnectionWizardEvent({connectionWizardProfilingEvent:p.Visible});break;case n.a.ready:case n.a.failed:this.profileConnectionWizardEvent({connectionWizardProfilingEvent:p.Visible}),this.profileConnectionWizardEvent({connectionWizardProfilingEvent:p.FinishedLoading,additionalData:{areAllConnectionsValid:e===n.a.ready}});break;case n.a.working:}},this.profileConnectionWizardEvent=e=>{var{connectionWizardProfilingEvent:t,additionalData:i}=e;if(!this.connectionWizardEventsLogged[t]&&(this.profileTimeSinceInitializeStart({eventName:t,additionalData:i}),this.widgetUtilService.isWidgetPage()))switch(t){case p.Visible:this.widgetUtilService.fireConnectionWizardVisible();break;case p.FinishedLoading:this.widgetUtilService.fireConnectionWizardFinishedLoading()}this.connectionWizardEventsLogged[t]=!0},this.profileTimeSinceInitializeStart=e=>{var{eventName:t,additionalData:i}=e;this.loggingService.profile(this.initializationCorrelationId,t,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({status:o.e.Success,templateName:this.templateName},i),this.loggingService.performanceNow()-this.initializationStartTime)},this.profileDietViewInputParametersLoadStart=()=>{this.inputParametersLoadCorrelationId=this.loggingService.profileStart("DietViewProfiler.InputParametersLoadStart",{templateName:this.templateName})},this.profileDietViewInputParametersLoadEnd=()=>{this.loggingService.profileEndWithSuccess(this.inputParametersLoadCorrelationId,"DietViewProfiler.InputParametersLoadEnd",{templateName:this.templateName})}}))},20829:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e.NotProvisioned="NotProvisioned",e.Provisioning="Provisioning",e}({})},20845:function(e,t,i){"use strict";i.d(t,"a",(function(){return D}));var n,o=i(12706),r=i(19868),a=i(16828),s=i(11804),l=i(14331),c=i.n(l),p=i(11773),u=i(11766),d=i(20846),f=i(14835);function m(e,t,i,n,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(n,o)}function g(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var r=e.apply(t,i);function a(e){m(r,n,o,a,s,"next",e)}function s(e){m(r,n,o,a,s,"throw",e)}a(void 0)}))}}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,n=w(e);if(t){var o=w(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C(this,i)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,i,n,o){var r={};return Object.keys(n).forEach((function(e){r[e]=n[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var O=function(e){return e[e.Default=0]="Default",e[e.Success=1]="Success",e[e.Error=2]="Error",e}(O||{}),D=(S((n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(m,e);var t,i,n,l,p=y(m);function m(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(t=p.call(this,e)).getClassNames=Object(o.a)(),t.getCallbackUrl=g((function*(){var{flowCreatorStore:{getCallbackUrl:e}}=t.props;return yield e()})),t.state={callbackUrl:"",callbackUrlState:O.Default},t}return t=m,(i=[{key:"componentDidMount",value:(l=g((function*(){if(this.containsTeamsWebhookTrigger)try{var e=yield this.getCallbackUrl();this.setState({callbackUrl:e,callbackUrlState:O.Success})}catch(t){this.props.loggingService.logError("FlowCreatorCreationCompleted.GetCallbackUrl",t),this.setState({callbackUrlState:O.Error})}})),function(){return l.apply(this,arguments)})},{key:"render",value:function(){var{assetService:e,cdnService:t,clientResources:i}=this.props,n=this.getClassNames(d.a),o=this.getCreationImage,s=i.Common.Success,l=i.FlowCreatorCreationCompleted.Success.DetailsHeader,c=u.createElement("div",{className:n.detailsText,dangerouslySetInnerHTML:{__html:this.getDetailsText}});return this.isFlowSuspended&&(o=e.confirmationPageDLPViolation,s=i.Common.Warning,l=i.FlowCreatorCreationCompleted.DLPViolation.DetailsHeader,c=u.createElement("div",{className:n.detailsText},u.createElement("p",null,i.FlowCreatorCreationCompleted.DLPViolation.DetailsText))),this.containsTeamsWebhookTrigger&&this.state.callbackUrlState===O.Success&&(c=u.createElement("div",null,u.createElement("div",{className:n.detailsText,dangerouslySetInnerHTML:{__html:this.getDetailsText}}),u.createElement(r.a,{placeholder:this.state.callbackUrl,value:this.state.callbackUrl,clientResources:i}))),u.createElement("div",{className:n.root,"aria-live":"polite"},u.createElement(a.b,{cdnService:t,className:this.getCreationImageClassName,alt:s,src:o,fallbackSrc:o}),u.createElement("div",{className:n.detailsContainer},u.createElement("p",{className:n.detailsHeader},l),c))}},{key:"isFlowSuspended",get:function(){var{flowCreatorStore:{flowEntity:e}}=this.props;return void 0!==e&&e.isSuspended}},{key:"getDetailsText",get:function(){var e,t,{widgetUtilService:i,clientResources:n,flowCreatorStore:o}=this.props;if(this.containsTeamsWebhookTrigger&&void 0===(null===(e=o.templateEntity)||void 0===e||null===(e=e.properties)||void 0===e?void 0:e.instantiationMessage))return this.state.callbackUrlState===O.Error?c.a.sanitize(n.FlowCreatorCreationCompleted.TeamsWebhook.GetCallbackUrlFailure):c.a.sanitize(n.FlowCreatorCreationCompleted.TeamsWebhook.Success.DetailsText);var r=null!==(t=o.templateEntity)&&void 0!==t&&null!==(t=t.properties)&&void 0!==t&&t.instantiationMessage?o.templateEntity.properties.instantiationMessage:i.getOverrideableString(n.FlowCreatorCreationCompleted.Success.DetailsText,s.b.FLOW_CREATION_DETAILS_TEXT);return c.a.sanitize(r.replace("{flowDisplayName}",this.getFlowName).replace("{workflowIcon}","https://statics.teams.cdn.office.net/evergreen-assets/apps/workflows_largeimage.png"))}},{key:"getFlowName",get:function(){var{flowCreatorStore:{flowEntity:e,getFlowDisplayName:t}}=this.props;return void 0!==e?e.properties.displayName:t()}},{key:"containsTeamsWebhookTrigger",get:function(){var{flowCreatorStore:{flowEntity:e}}=this.props;return void 0!==e&&Object(f.l)(e)}},{key:"getCreationImage",get:function(){var{assetService:e,widgetUtilService:t,clientResources:i,flowCreatorStore:{templateTrigger:n,templateTriggerType:o}}=this.props;return t.isWidgetPage()&&t.isTemplatesPageShellEnabled()&&!t.isTeamsContext()?e.flowCreated:(null==n?void 0:n.swaggerOperationId)===s.d.ForASelectedMessage||(null==n?void 0:n.swaggerOperationId)===s.d.ForASelectedMessageV2?e.confirmationPageForASelectedMessage:(null==n?void 0:n.swaggerOperationId)===s.d.ComposeAMessage||(null==n?void 0:n.swaggerOperationId)===s.d.ComposeAMessageV2?e.confirmationPageComposeAMessage:o===i.Manage.Flows.Type.Automated?e.confirmationPageAutomated:o===i.Manage.Flows.Type.Scheduled?e.confirmationPageScheduled:e.flowCreatedTeams}},{key:"getCreationImageClassName",get:function(){var{widgetUtilService:e}=this.props,t=this.getClassNames(d.a);return e.isTeamsContext()?t.imageTeams:t.image}}])&&h(t.prototype,i),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),m}(u.PureComponent)).prototype,"isFlowSuspended",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"isFlowSuspended"),n.prototype),S(n.prototype,"getDetailsText",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"getDetailsText"),n.prototype),S(n.prototype,"getFlowName",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"getFlowName"),n.prototype),S(n.prototype,"containsTeamsWebhookTrigger",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"containsTeamsWebhookTrigger"),n.prototype),S(n.prototype,"getCreationImage",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"getCreationImage"),n.prototype),S(n.prototype,"getCreationImageClassName",[p.computed],Object.getOwnPropertyDescriptor(n.prototype,"getCreationImageClassName"),n.prototype),n)},20846:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(12754),o=()=>{var e=Object(n.Y)();return{root:["fl-FlowCreatorCreationCompleted",{textAlign:"center",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",overflowX:"hidden"}],image:["fl-FlowCreatorCreationCompleted-image",{width:"200px",height:"200px"}],imageTeams:["fl-FlowCreatorCreationCompleted-imageTeams",{width:"200px",height:"200px"}],detailsHeader:["f1-FlowCreatorCreationCompleted-detailsHeader",{textAlign:"left",fontSize:n.k.size18,fontWeight:n.l.bold,lineHeight:"24px"}],detailsContainer:["fl-FlowCreatorCreationCompleted-detailsContainer",{width:"100%",paddingLeft:"16px",paddingRight:"16px",paddingTop:"24px"}],detailsContainerTeams:["fl-FlowCreatorCreationCompleted-detailsContainerTeams",{width:"100%",paddingLeft:"16px",paddingRight:"16px",overflowY:"auto"}],detailsText:["fl-FlowCreatorCreationCompleted-detailsText",{textAlign:"left",color:e.semanticColors.bodyText,fontSize:n.k.size14,lineHeight:n.k.size20,fontWeight:n.l.regular,paddingTop:0,selectors:{b:{fontWeight:700},ol:{listStyleType:"decimal",paddingLeft:"20px",paddingTop:"14px"},p:{fontSize:"14px"},li:{fontSize:"14px"},img:{height:"24px",width:"24px"}}}],detailsLink:["fl-FlowCreatorCreationCompleted-detailsLink",{color:e.semanticColors.link}],detailsLinkText:["fl-FlowCreatorCreationCompleted-detailsLinkText",{fontSize:n.k.medium,fontWeight:n.l.regular}],detailsLinkIcon:["fl-FlowCreatorCreationCompleted-detailsLinkIcon",{fontSize:n.k.xSmall,fontWeight:n.l.bold,paddingLeft:4}]}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/129.1a83dc3a.chunk.js.map