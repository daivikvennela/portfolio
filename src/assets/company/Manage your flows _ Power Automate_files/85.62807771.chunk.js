/*! For license information please see 85.62807771.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{18801:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(18802),n=i(12999),a=i(12345),s=i(13e3),o=i(18804),l=i(13087),p=i(18805),c=i(13148),m=new r.a(Object(n.a)(),a.a,l.a,p.a,o.a,c.a,s.a)},18802:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(12328),n=i.n(r),a=i(14831),s=i(14834),o=i(13146),l=i(14928),p=i(15477),c=i(13085),m=i(12364),u=i(18803);function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function g(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=g((function e(t,i,r,h,g,d,v){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureFlags=t,this.environmentStore=i,this.loggingService=r,this.templatesHttpClient=h,this.templateStore=g,this.widgetUtilService=d,this.sessionStore=v,this.runFirstPending=Object(o.a)(),this.loadTemplate=e=>{var{galleryName:t,templateName:i,forceRefresh:r=!1}=e,n=this.environmentStore.currentEnvironmentName;return Object(p.a)({constructEntity:e=>new s.a(e.data),entities:this.templateStore.templates,entityKey:i,environmentName:n,eventData:{galleryName:t,templateName:i,forceRefresh:r},eventEndName:c.a.templateServiceLoadTemplateEnd,eventStartName:c.a.templateServiceLoadTemplateStart,fetchAction:()=>this.templatesHttpClient.getTemplate({environmentName:n,templateName:i,galleryName:t}),forceRefreshPredicate:e=>r,loggingService:this.loggingService,runFirstPending:this.runFirstPending,runFirstPendingKeyPrefix:"loadTemplate"})},this.loadTemplateList=e=>{var{galleryName:t,categoryOrCategories:i,searchQuery:r,apiIds:n,orderBy:o,top:p}=e,c=a.a.getCollectionKey(t,i,r,o,p,n),h=this.environmentStore.currentEnvironmentName,g="loadTemplateList-".concat(h,"-").concat(c);return this.templateStore.templates.collections.has(c)&&!Object(m.d)(this.templateStore.templates.getCollection(c).lastFetched)?Promise.resolve():this.runFirstPending({key:g,action:()=>(this.templateStore.templates.setCollectionLoading(c),this.templatesHttpClient.getTemplates({environmentName:h,galleryName:t,categoryOrCategories:i,searchQuery:r,apiIds:n,orderBy:o||u.a.retentionRate,top:p,includeDesignerUnsupportedTemplates:this.widgetUtilService.isWidgetPage()&&this.widgetUtilService.shouldShowDesignerUnsupportedTemplates(),supportsCdsUpsellTemplates:this.widgetUtilService.isTeamsContext()&&this.featureFlags.enableAIBuilderInTeams||this.featureFlags.enableAIBuilderUpsellForTemplateDetails&&this.sessionStore.user&&!this.sessionStore.user.isConsumerDomain}).then(e=>{var{data:{value:t,nextLink:i}}=e;this.templateStore.templates.setCollectionLoaded(c,t.map(e=>new s.a(e)),{nextLink:i,resetList:!0,replaceDupe:l.a})}).catch(e=>(this.templateStore.templates.setCollectionError(c,e),Promise.reject(e))))})},this.loadTemplateListMore=e=>{var t=this.templateStore.templates.getCollection(e);n()(null==t?void 0:t.nextLink,"Cannot load more templates. Next link is empty or entity collection does not exist!");var i="loadTemplateListMore-".concat(t.nextLink);return this.runFirstPending({key:i,action:()=>(this.templateStore.templates.setCollectionLoading(e),this.templatesHttpClient.getMoreTemplates({nextLink:t.nextLink,supportsCdsUpsellTemplates:this.widgetUtilService.isTeamsContext()&&this.featureFlags.enableAIBuilderInTeams||this.featureFlags.enableAIBuilderUpsellForTemplateDetails&&this.sessionStore.user&&!this.sessionStore.user.isConsumerDomain}).then(t=>{var{data:{value:i,nextLink:r}}=t;this.templateStore.templates.setCollectionLoaded(e,i.map(e=>new s.a(e)),{nextLink:r,resetList:!1,replaceDupe:l.a})}).catch(t=>(this.templateStore.templates.setCollectionError(e,t),Promise.reject(t))))})},this.loadTemplateListUsingStoreFilterOptions=()=>this.loadTemplateList({galleryName:this.templateStore.templatesFilterOptions.galleryName,categoryOrCategories:this.templateStore.templatesFilterOptions.category,searchQuery:this.templateStore.templatesFilterOptions.searchQuery}),this.loadTemplateListUsingStoreFilterOptionsWithMultipleApis=()=>this.loadTemplateList({galleryName:this.templateStore.templatesFilterOptions.galleryName,searchQuery:this.templateStore.templatesFilterOptions.searchQuery,apiIds:this.templateStore.templatesFilterOptions.apiIds.slice()})}))},18803:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){return e.name="name",e.instantiations="instantiations",e.publishedDate="publishedDate",e.relevance="relevance",e.retentionRate="retentionRate",e}({})},18804:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=new(i(14831).a)},18805:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(13192),n=i(18806),a=i(12339),s=i(12999),o=i(13e3),l=i(13077),p=i(13087),c=i(13198),m=i(13206),u=i(14688),h=new n.a(Object(a.b)(),Object(s.a)(),p.a,new r.HttpClient,new r.HttpClient,u.a,o.a,l.a,c.a,m.a)},18806:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(13215),n=i(12381),a=i(11891),s=i(14827),o=i(14825),l=i(14685),p=i(13083),c=i(12375),m=i(13144),u=i(14829);function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function g(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){d(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function d(e,t,i){return(t=f(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function S(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var y=S((function e(t,i,h,d,v,S,f,y,b,O){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.featureFlags=i,this.loggingService=h,this.authenticatedHttpClient=d,this.unauthenticatedHttpClient=v,this.ppapiService=S,this.sessionStore=f,this.tokenService=y,this.userContextChangeMonitoringService=b,this.userContextStore=O,this.addInterceptors=(e,t)=>{[Object(r.f)(this.loggingService,()=>this.sessionStore.sessionId),t?Object(r.c)(()=>this.tokenService.getAccessToken(this.appSettings.flowAudience)):void 0,Object(r.d)(c.a),Object(r.j)(this.featureFlags.enableB2BLogin,this.userContextStore,this.userContextChangeMonitoringService,this.loggingService),Object(r.i)(this.loggingService,this.sessionStore),Object(u.b)(this.ppapiService,this.appSettings)].forEach(t=>t?e.addRequestInterceptor(t):null),e.addResponseInterceptor(Object(r.g)(this.loggingService,this.sessionStore),Object(r.e)(this.loggingService,this.sessionStore))},this.getTemplate=e=>{var{environmentName:t,galleryName:i,templateName:r,cancelToken:n}=e;return this.authenticatedHttpClient.get({eventName:"PROCESSSIMPLE:GET/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/GALLERIES/TEMPLATES/",url:this.getTemplateEndpoint({environmentName:t,galleryName:i,templateName:r}),params:{$expand:"definition,connectionReferences.api.properties"},cancelToken:n})},this.getTemplates=e=>{var t,i,{environmentName:r,galleryName:n,categoryOrCategories:o,searchQuery:c,apiIds:m,cancelToken:u,orderBy:h,top:d,includeDesignerUnsupportedTemplates:v,supportsCdsUpsellTemplates:S}=e,f=v?void 0:"properties/categoryNames/all(x:x ne 'designerUnsupported')";if(Array.isArray(o))if(o.length>0){var y=[];o.forEach(e=>{Object(p.a)(e)||Object(a.a)(e,l.a.all)||Object(a.a)(e,l.a.sharedWithMe)||y.push("properties/categoryNames/any(x:x eq '".concat(Object(s.a)(e),"')"))}),t=y.join(" and ")}else t=void 0;else t=Object(p.a)(o)||Object(a.a)(o,l.a.all)||Object(a.a)(o,l.a.sharedWithMe)?void 0:"properties/categoryNames/any(x:x eq '".concat(Object(s.a)(o),"')");if(m&&m.length>0){var b=[];m.forEach(e=>{Object(p.a)(e)||b.push("properties/connectionReferences/any(x:x/id eq '".concat(e,"')"))}),i=b.join(" and ")}var O=[t,f,i].filter(Boolean).join(" and ")||void 0,T=g(g({},O&&{$filter:O}),{},{$orderby:h,$expand:"definition,connectionReferences.api.properties"});return S&&(T.supportsCdsUpsell="true"),d&&(T.$top=d),c&&(T.$search=c),(r?this.authenticatedHttpClient:this.unauthenticatedHttpClient).get({eventName:"PROCESSSIMPLE:GET/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/GALLERIES/TEMPLATES",url:this.getTemplatesEndpoint({environmentName:r,galleryName:n}),params:T,cancelToken:u})},this.getMoreTemplates=e=>{var{nextLink:t,cancelToken:i,supportsCdsUpsellTemplates:r}=e,n={eventName:"PROCESSSIMPLE:GET/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/GALLERIES/TEMPLATES",url:t,cancelToken:i};return r&&(n.params={supportsCdsUpsell:"true"}),this.authenticatedHttpClient.get(n)},this.getTemplatesEndpoint=e=>{var{environmentName:t,galleryName:i}=e;this.featureFlags.enablePendingTemplatesGallery&&(i=o.b.pending);var r=t?"environments/".concat(t,"/"):"";return Object(n.a)(Object(m.b)(t,this.appSettings).flowRP,"".concat(this.appSettings.processSimpleResourceProviderPath,"/").concat(r,"galleries/").concat(i,"/templates"))},this.getTemplateEndpoint=e=>{var{environmentName:t,galleryName:i,templateName:r}=e;return Object(n.a)(this.getTemplatesEndpoint({environmentName:t,galleryName:i}),r)},this.addInterceptors(this.authenticatedHttpClient,!0),this.addInterceptors(this.unauthenticatedHttpClient,!1)}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/85.62807771.chunk.js.map