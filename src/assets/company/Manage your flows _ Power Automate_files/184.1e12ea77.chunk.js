/*! For license information please see 184.1e12ea77.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{22357:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(22358),o=n(22360),i=n(15460),a=n(13087),c=new r.a(i.b,o.a,a.a)},22358:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(17509),o=n(12364),i=n(15427),a=n(22359),c=n(13146),u=n(12366);function l(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.xrmEntityHttpClient=t,this.solutionStore=n,this.loggingService=r,this.runFirstPending=Object(c.a)()}var t,n,f,v,d;return t=e,(n=[{key:"getSolutionReferences",value:function(e){var{objectId:t,forceRefresh:n}=e,i=a.a.getSolutionCollectionType({objectId:t}),c=this.solutionStore.solutions.getCollection(i),u=c&&c.lastFetched;return n||Object(o.d)(u)?this.runFirstPending({key:"getSolutionReferences/flow/".concat(t,"/"),action:()=>(this.solutionStore.solutions.setCollectionLoading(i),this.xrmEntityHttpClient.retrieveMultiple("solutions",{$filter:"solution_solutioncomponent/any(ps: ps/objectid eq '".concat(t,"') and uniquename ne 'Default'\n              and uniquename ne 'active'"),$select:"solutionid,uniquename,friendlyname,ismanaged,version,createdon,modifiedon,installedon"}).then(e=>{var{data:{value:t}}=e;this.loggingService.logInfo("SolutionService.getSolutionReferencesSuccess","Successfully retreived solution references"),this.solutionStore.solutions.setCollectionLoaded(i,t.map(e=>new r.a(e)),{resetList:!0,replaceDupe:()=>!0})}).catch(e=>(this.solutionStore.solutions.setCollectionError(t,e),this.loggingService.logError("SolutionService.getSolutionReferencesFailure",e),Promise.reject(e))))}):Promise.resolve()}},{key:"checkIfActiveLayerExistsForFlow",value:function(e){var{workflowId:t}=e;return this.xrmEntityHttpClient.retrieveSolutionMetadataForComponent("Workflow",["workflowid"],[t]).then(e=>{var{data:{value:t}}=e;for(var n of(this.loggingService.logInfo("SolutionService.checkIfActiveLayerExistsForFlow","Successfully retreived solution metadata components"),t))if(n.solutionid===u.b)return!0;return!1}).catch(e=>(this.solutionStore.solutions.setCollectionError(t,e),this.loggingService.logError("SolutionService.checkIfActiveLayerExistsForFlow",e),Promise.reject(e)))}},{key:"checkIfUserCanAccessSolution",value:(v=function*(e){var{userId:t}=e;try{var n,r,o=(yield this.xrmEntityHttpClient.retrieveUserPrivilegesByName(t,i.m.Solution.ReadPrivilege)).data;if((null==o||null===(n=o.RolePrivileges)||void 0===n?void 0:n.length)>0)return(null===(r=o.RolePrivileges[0])||void 0===r?void 0:r.Depth)===i.n.Global}catch(a){this.loggingService.logWarning("SolutionService.checkIfUserCanAccessSolution","Failed to check if user can access solution for remove layer button. Assuming false.",{error:a})}return!1},d=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=v.apply(e,t);function i(e){l(o,n,r,i,a,"next",e)}function a(e){l(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e){return d.apply(this,arguments)})},{key:"getSolutionIdForFlowWithActiveLayer",value:function(e){var{workflowId:t}=e;return this.xrmEntityHttpClient.retrieveSolutionMetadataForComponent("Workflow",["workflowid"],[t]).then(e=>{var{data:{value:t}}=e;for(var n of(this.loggingService.logInfo("SolutionService.getSolutionIdForFlowWithActiveLayer","Successfully retreived solution metadata components"),t))if(n.solutionid!==u.b)return null==n?void 0:n.solutionid}).catch(e=>(this.solutionStore.solutions.setCollectionError(t,e),this.loggingService.logError("SolutionService.getSolutionIdForFlowWithActiveLayer",e),Promise.reject(e)))}}])&&s(t.prototype,n),f&&s(t,f),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22359:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,o,i=n(11773),a=n(12347);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l,s,f,v,d,m,p=(r=function(){function e(){var t,n,r,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n="solutions",c=this,(r=o)&&Object.defineProperty(t,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(c):void 0}),Object(i.runInAction)(()=>{this.solutions=new a.a({getKey:t=>e.getSolutionEntityKey({solutionId:t.solutionid})})})}var t,n,r;return t=e,r=[{key:"getSolutionEntityKey",value:function(e){var{solutionId:t}=e;return t}},{key:"getSolutionCollectionType",value:function(e){var{objectId:t}=e;return t}}],(n=null)&&c(t.prototype,n),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),l=r.prototype,s="solutions",f=[i.observable],v={configurable:!0,enumerable:!0,writable:!0,initializer:null},m={},Object.keys(v).forEach((function(e){m[e]=v[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=f.slice().reverse().reduce((function(e,t){return t(l,s,e)||e}),m),d&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(d):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(l,s,m),m=null),o=m,r)},22360:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=new(n(22359).a)},22361:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22362),o=n(15408),i=n(13087),a=new r.a(i.a,o.a)},22362:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}n.d(t,"a",(function(){return u}));var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.safeLocalStorage=n}var t,n,r;return t=e,(n=[{key:"updateSavedColumnHeaders",value:function(e,t,n){var r={[e]:t},i={};n&&(i=o(o({},n),r));try{return this.safeLocalStorage.set("powerautomate-run-history-column-views",JSON.stringify(i))?t:void 0}catch(a){return void this.loggingService.logWarning("FlowRunHistoryService.updateSavedColumnHeaders","Failed to stringify columnHeadersToSave: ".concat(a))}}},{key:"getAllColumnViewPreferences",value:function(){var e=this.safeLocalStorage.get("powerautomate-run-history-column-views");try{return e?JSON.parse(e):void 0}catch(t){return void this.loggingService.logWarning("FlowRunHistoryService.getAllColumnViewPreferences","Failed to parse columnHeaderViewsJson: ".concat(t))}}}])&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22363:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12345),o=n(20033),i=n(22364),a=n(13087),c=n(17213),u=n(22366),l=n(15460),s=new o.a(r.a,i.a,a.a,c.a,new u.a(a.a,l.b))},22364:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13192),o=n(22365),i=n(13e3),a=n(12339),c=n(13077),u=n(13087),l=n(14688),s=new o.a(Object(a.b)(),new r.HttpClient,l.a,u.a,c.a,i.a)},22365:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13215),o=n(12381),i=n(13151),a=n(13083),c=n(14829);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,n,o,i,a,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.httpClient=n,this.ppapiService=o,this.loggingService=i,this.tokenService=a,this.sessionStore=u,[Object(r.f)(i,()=>this.sessionStore.sessionId),Object(r.c)(()=>this.tokenService.getAccessToken(this.appSettings.flowAudience)),Object(c.b)(this.ppapiService,this.appSettings)].forEach(e=>this.httpClient.addRequestInterceptor(e)),this.httpClient.addResponseInterceptor(Object(r.g)(this.loggingService,this.sessionStore),Object(r.e)(this.loggingService,this.sessionStore))}var t,n,l;return t=e,(n=[{key:"checkFlowSupport",value:function(e){var{environmentName:t,flow:n,flowName:r}=e,c=Object(a.a)(r)?"new":r,u=Object(o.a)(Object(i.a)({appSettings:this.appSettings,environmentName:t}),"/flows/".concat(c,"/checkFlowSupport"));return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/CHECKFLOWSUPPORT",url:u,data:n,responseType:"json"})}}])&&u(t.prototype,n),l&&u(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22366:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(22367),o=n(16926),i=n(12327);function a(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){a(i,r,o,c,u,"next",e)}function u(e){a(i,r,o,c,u,"throw",e)}c(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s="commentid",f="artifactid",v="artifacttype",d="statecode",m="Container",p=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.xrmEntityHttpClient=n,this.expandUserInfo="createdby($select=fullname,azureactivedirectoryobjectid),Comment_Container_Comment"}var t,n,a,l,p;return t=e,(n=[{key:"getHasActiveComment",value:(p=c((function*(e){var t=Object(o.c)(e),n=Object(o.g)(e),i=!1;try{var a=yield this.getContainerId(e,t,n);if(void 0===a)return i;var c="".concat(m,"/").concat(s," eq ").concat(a),u="".concat(d," eq ").concat(r.b.active),l=yield this.xrmEntityHttpClient.retrieveMultiple("comments",{$filter:"".concat(c," and ").concat(u),$top:"1",$expand:this.expandUserInfo});l&&l.data&&l.data.value&&l.data.value.length>0&&(i=!0)}catch(f){this.loggingService.logWarning("flowSupportCommentService.Errors","Error while checking for active comments",{error:f,flowName:t,workflowEntityId:n})}return i})),function(e){return p.apply(this,arguments)})},{key:"getContainerId",value:(l=c((function*(e,t,n){var o,a=this.getArtifactIdForContainer(e);try{var c=yield this.xrmEntityHttpClient.retrieveRecord("comments","".concat(f,"='").concat(a,"',").concat(v,"=").concat(r.a.flow));c&&c.data&&(o=c.data.commentid)}catch(u){Object(i.h)(u,i.m)&&Object(i.j)(i.k,i.m)(u)&&Object(i.k)(u.message)&&u.message.includes("404")?this.loggingService.logInfo("flowSupportCommentService.commentEnsureContainer","No active comments found for the flow",{error:u,flowName:t,workflowEntityId:n}):this.loggingService.logWarning("flowSupportCommentService.commentEnsureContainer","Error while getting container for active comments",{error:u,flowName:t,workflowEntityId:n})}return o})),function(e,t,n){return l.apply(this,arguments)})},{key:"getArtifactIdForContainer",value:function(e){return Object(o.y)(e)?Object(o.g)(e):Object(o.c)(e)}}])&&u(t.prototype,n),a&&u(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22367:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return d}));var r,o=n(11773),i=n(13093),a=n.n(i),c=n(22368);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=function(e){return e[e.flow=0]="flow",e[e.app=1]="app",e[e.bot=2]="bot",e}({}),v=function(e){return e[e.open=0]="open",e[e.resolved=1]="resolved",e}({}),d=function(e){return e[e.active=0]="active",e[e.inactive=1]="inactive",e}({});s((r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.date=void 0,this.parentId=void 0,this.anchorHintText=void 0,this.commentFlags=void 0,this.author=void 0,this.commentBody=void 0,this.commentId=void 0,this.anchorId=void 0,Object(o.extendObservable)(this,t)}var t,n,r;return t=e,(n=[{key:"toJS",value:function(){return a()(Object(o.toJS)(this),"toJS")}},{key:"setCommentBody",value:function(e){this.commentBody=e}},{key:"setCommentFlags",value:function(e){var t=e===v.resolved?c.c.Resolved:c.c.None;this.commentFlags=t}}])&&u(t.prototype,n),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"setCommentBody",[o.action],Object.getOwnPropertyDescriptor(r.prototype,"setCommentBody"),r.prototype),s(r.prototype,"setCommentFlags",[o.action],Object.getOwnPropertyDescriptor(r.prototype,"setCommentFlags"),r.prototype)},22368:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c}));n(22369);var r=n(22370);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c}));var o=n(22383);n.d(t,"f",(function(){return o.a}));var i=n(22384);n.d(t,"g",(function(){return i.a})),n.d(t,"h",(function(){return i.b}));n(22385);var a=function(e){return e.PaneReady="PaneReady",e.GetAllComments="GetAllComments",e}({}),c=function(e){return e.BeginPolling="BeginPolling",e.SuspendPolling="SuspendPolling",e.ChangePollingInterval="ChangePollingInterval",e}({})},22369:function(e,t,n){},22370:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(22371);n.d(t,"c",(function(){return r.f}));var o=function(e){return e.CommentAdded="CommentAdded",e.CommentEdited="CommentEdited",e.CommentDeleted="CommentDeleted",e.ThreadSelected="ThreadSelected",e.GetCurrentlySelectedAnchorId="GetCurrentlySelectedAnchorId",e}({}),i=function(e){return e.SetInitialViewData="SetInitialViewData",e.LoadComments="LoadComments",e.GetOrphanedComments="GetOrphanedComments",e.GetUnresolvedThreadCountsForAnchors="GetUnresolvedThreadCountsForAnchors",e.SelectFirstThreadRelatedToAnchor="SelectFirstThreadRelatedToAnchor",e.SelectComment="SelectComment",e.DeselectThread="DeselectThread",e.CreateThread="CreateThread",e.ContextViewDataChanged="ContextViewDataChanged",e.InsertComments="InsertComments",e.EditComment="EditComment",e.DeleteReply="DeleteReply",e}({})},22383:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.GetAuthToken="GetAuthToken",e.CheckMentions="CheckMentions",e}({})},22384:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=function(e){return e.OpenPane="OpenPane",e.ClosePane="ClosePane",e.RefreshPane="RefreshPane",e}({}),o=function(e){return e.PaneClosed="PaneClosed",e}({})},22385:function(e,t,n){}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/184.1e12ea77.chunk.js.map