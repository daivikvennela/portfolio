/*! For license information please see desktop-flows~flowPag~4c102bbe.7930ddaf.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{22405:function(e,t,i){"use strict";i.d(t,"a",(function(){return ce}));var o,r,n,s,a,l,c,p,u,d,f,m,y,b,g,w,h,v,S,A,P,C,O,E,k,I,F,j,T,N,D,R,L,U,x,z,M,W,q,B,H,V,_,K,Z,J,G,$,Y,Q,X,ee,te,ie=i(11773),oe=i(12347),re=i(14873);function ne(e,t,i,o){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(o):void 0})}function se(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ae(o.key),o)}}function ae(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function le(e,t,i,o,r){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var ce=(r=le((o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ne(this,"flowEntity",r,this),ne(this,"licenseEntitledByValue",n,this),ne(this,"isOnProcessPlan",s,this),ne(this,"isOnMachineLicense",a,this),ne(this,"licensee",l,this),ne(this,"licenseePlanSectionName",c,this),ne(this,"flowCapacityAssignmentCount",p,this),ne(this,"workflowId",u,this),ne(this,"environmentName",d,this),ne(this,"workflowUniqueId",f,this),ne(this,"associatedApps",m,this),ne(this,"associatedFlows",y,this),ne(this,"powerApps",b,this),ne(this,"dynamicsApps",g,this),ne(this,"associableFlows",w,this),ne(this,"billingContextItems",h,this),ne(this,"numberEntitiesVisible",v,this),ne(this,"numberEntitiesVisiblePerSection",S,this),ne(this,"readOnly",A,this),ne(this,"powerAppsToAdd",P,this),ne(this,"dynamicsAppsToAdd",C,this),ne(this,"associateFlowsToAdd",O,this),ne(this,"searchFilter",E,this),ne(this,"appCollectionItems",k,this),ne(this,"flowCollectionItems",I,this),ne(this,"messageBarProps",F,this),ne(this,"setFlowEntity",j,this),ne(this,"setLicenseEntitledByValue",T,this),ne(this,"setIsOnProcessPlan",N,this),ne(this,"setLicensee",D,this),ne(this,"setLicenseePlanSectionName",R,this),ne(this,"setFlowCapacityAssignmentCount",L,this),ne(this,"setWorkflowId",U,this),ne(this,"setEnvironmentName",x,this),ne(this,"setWorkflowUniqueId",z,this),ne(this,"setPowerApps",M,this),ne(this,"setDynamicsApps",W,this),ne(this,"setAssociableFlows",q,this),ne(this,"setBillingContextItems",B,this),ne(this,"setReadOnly",H,this),ne(this,"setNumberEntitiesVisible",V,this),ne(this,"setNumberEntitiesVisiblePerSection",_,this),ne(this,"setPowerAppsToAdd",K,this),ne(this,"setDynamicsAppsToAdd",Z,this),ne(this,"setAssociateFlowsToAdd",J,this),ne(this,"setSearchFilter",G,this),ne(this,"setAppCollectionItems",$,this),ne(this,"setFlowCollectionItems",Y,this),ne(this,"setMessageBarProps",Q,this),ne(this,"dismissMessageBar",X,this),ne(this,"setEntityCollectionItems",ee,this),ne(this,"entityCollectionItems",te,this),this.setSearchFilter(""),Object(ie.runInAction)(()=>{this.associatedApps=new oe.a({getKey:t=>e.getAssociatedAppsEntityKey({uniqueid:t.uniqueid})}),this.associatedFlows=new oe.a({getKey:t=>e.getAssociatedFlowsEntityKey({uniqueid:t.workflowid})})})}var t,i,o;return t=e,o=[{key:"getAssociatedAppsEntityKey",value:function(e){var{uniqueid:t}=e;return t}},{key:"getAssociatedFlowsEntityKey",value:function(e){var{uniqueid:t}=e;return t}},{key:"getAssociatedAppsCollectionType",value:function(e){var{objectId:t}=e;return t}},{key:"getAssociatedFlowsCollectionType",value:function(e){var{objectId:t}=e;return t}}],(i=[{key:"appEntityList",get:function(){var e;return null===(e=this.associatedApps)||void 0===e?void 0:e.getCollection(this.workflowUniqueId)}},{key:"flowEntityList",get:function(){var e;return this.workflowId?null===(e=this.associatedFlows)||void 0===e?void 0:e.getCollection(this.workflowId):void 0}},{key:"associatedAppsCollectionItems",get:function(){var e=this.appEntityList;return e?e.list.map(e=>this.associatedApps.getEntity(e)):[]}},{key:"associatedFlowsCollectionItems",get:function(){var e=this.flowEntityList;return e?e.list.map(e=>this.associatedFlows.getEntity(e)):[]}},{key:"filterPowerApps",get:function(){if(this.powerApps){var e=this.powerApps.slice();return this.appCollectionItems.forEach(t=>{var i=e.findIndex(e=>t.uniqueid===e.uniqueid);-1!==i&&e.splice(i,1)}),e}return this.powerApps}},{key:"filterDynamicsApps",get:function(){if(this.dynamicsApps){var e=this.dynamicsApps.slice();return this.appCollectionItems.forEach(t=>{var i=e.findIndex(e=>t.uniqueid===e.uniqueid);-1!==i&&e.splice(i,1)}),e}return this.dynamicsApps}},{key:"filterAssociateFlows",get:function(){return this.associableFlows?this.associableFlows.slice():this.associableFlows}},{key:"powerAppsWithSearchFilter",get:function(){return this.powerAppsToAdd?this.powerAppsToAdd.filter(e=>e&&this.isFilterMatched(e.displayName?e.displayName:e.appname)):[]}},{key:"dynamicsAppsWithSearchFilter",get:function(){return this.dynamicsAppsToAdd?this.dynamicsAppsToAdd.filter(e=>e&&this.isFilterMatched(e.displayName?e.displayName:e.appname)):[]}},{key:"associateFlowsWithSearchFilter",get:function(){return this.associateFlowsToAdd?this.associateFlowsToAdd.filter(e=>e&&this.isFilterMatched(e.flowname)):[]}},{key:"isFilterMatched",value:function(e){return 0===this.searchFilter.length||!!e&&this.searchFilter.toLocaleLowerCase().split(" ").every(t=>e.toLocaleLowerCase().includes(t))}}])&&se(t.prototype,i),o&&se(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"flowEntity",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n=le(o.prototype,"licenseEntitledByValue",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=le(o.prototype,"isOnProcessPlan",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=le(o.prototype,"isOnMachineLicense",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=le(o.prototype,"licensee",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=le(o.prototype,"licenseePlanSectionName",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=le(o.prototype,"flowCapacityAssignmentCount",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=le(o.prototype,"workflowId",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=le(o.prototype,"environmentName",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=le(o.prototype,"workflowUniqueId",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=le(o.prototype,"associatedApps",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=le(o.prototype,"associatedFlows",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=le(o.prototype,"powerApps",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=le(o.prototype,"dynamicsApps",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=le(o.prototype,"associableFlows",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=le(o.prototype,"billingContextItems",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=le(o.prototype,"numberEntitiesVisible",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=le(o.prototype,"numberEntitiesVisiblePerSection",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=le(o.prototype,"readOnly",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=le(o.prototype,"powerAppsToAdd",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=le(o.prototype,"dynamicsAppsToAdd",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=le(o.prototype,"associateFlowsToAdd",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=le(o.prototype,"searchFilter",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=le(o.prototype,"appCollectionItems",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=le(o.prototype,"flowCollectionItems",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=le(o.prototype,"messageBarProps",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=le(o.prototype,"setFlowEntity",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.flowEntity=e,this.flowEntity&&(this.isOnMachineLicense=Object(re.h)(this.flowEntity.toJS()))}}}),T=le(o.prototype,"setLicenseEntitledByValue",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.licenseEntitledByValue=e}}}),N=le(o.prototype,"setIsOnProcessPlan",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isOnProcessPlan=e}}}),D=le(o.prototype,"setLicensee",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.licensee=e}}}),R=le(o.prototype,"setLicenseePlanSectionName",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.licenseePlanSectionName=e}}}),L=le(o.prototype,"setFlowCapacityAssignmentCount",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.flowCapacityAssignmentCount=e}}}),U=le(o.prototype,"setWorkflowId",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.workflowId=e}}}),x=le(o.prototype,"setEnvironmentName",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.environmentName=e}}}),z=le(o.prototype,"setWorkflowUniqueId",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.workflowUniqueId=e}}}),M=le(o.prototype,"setPowerApps",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.powerApps=e}}}),W=le(o.prototype,"setDynamicsApps",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dynamicsApps=e}}}),q=le(o.prototype,"setAssociableFlows",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.associableFlows=e}}}),B=le(o.prototype,"setBillingContextItems",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.billingContextItems=e}}}),H=le(o.prototype,"setReadOnly",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.readOnly=e}}}),V=le(o.prototype,"setNumberEntitiesVisible",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberEntitiesVisible=e}}}),_=le(o.prototype,"setNumberEntitiesVisiblePerSection",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberEntitiesVisiblePerSection=e}}}),K=le(o.prototype,"setPowerAppsToAdd",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.powerAppsToAdd=this.filterPowerApps}}}),Z=le(o.prototype,"setDynamicsAppsToAdd",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.dynamicsAppsToAdd=this.filterDynamicsApps}}}),J=le(o.prototype,"setAssociateFlowsToAdd",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.associateFlowsToAdd=this.filterAssociateFlows}}}),G=le(o.prototype,"setSearchFilter",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.searchFilter=e}}}),$=le(o.prototype,"setAppCollectionItems",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.appCollectionItems=this.associatedAppsCollectionItems}}}),Y=le(o.prototype,"setFlowCollectionItems",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.flowCollectionItems=this.associatedFlowsCollectionItems}}}),Q=le(o.prototype,"setMessageBarProps",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.messageBarProps=e}}}),X=le(o.prototype,"dismissMessageBar",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setMessageBarProps(void 0)}}}),ee=le(o.prototype,"setEntityCollectionItems",[ie.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.flowCollectionItems&&this.appCollectionItems?this.entityCollectionItems=[...this.flowCollectionItems,...this.appCollectionItems]:this.flowCollectionItems?this.entityCollectionItems=this.flowCollectionItems:this.appCollectionItems&&(this.entityCollectionItems=this.appCollectionItems)}}}),te=le(o.prototype,"entityCollectionItems",[ie.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le(o.prototype,"appEntityList",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"appEntityList"),o.prototype),le(o.prototype,"flowEntityList",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"flowEntityList"),o.prototype),le(o.prototype,"associatedAppsCollectionItems",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"associatedAppsCollectionItems"),o.prototype),le(o.prototype,"associatedFlowsCollectionItems",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"associatedFlowsCollectionItems"),o.prototype),le(o.prototype,"filterPowerApps",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"filterPowerApps"),o.prototype),le(o.prototype,"filterDynamicsApps",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"filterDynamicsApps"),o.prototype),le(o.prototype,"filterAssociateFlows",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"filterAssociateFlows"),o.prototype),le(o.prototype,"powerAppsWithSearchFilter",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"powerAppsWithSearchFilter"),o.prototype),le(o.prototype,"dynamicsAppsWithSearchFilter",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"dynamicsAppsWithSearchFilter"),o.prototype),le(o.prototype,"associateFlowsWithSearchFilter",[ie.computed],Object.getOwnPropertyDescriptor(o.prototype,"associateFlowsWithSearchFilter"),o.prototype),o)},22738:function(e,t,i){"use strict";i.d(t,"b",(function(){return B})),i.d(t,"a",(function(){return V}));var o,r,n,s,a=i(11766),l=i(14337),c=i(19778),p=i(11773),u=i(12706),d=i(22150),f=i(18935),m=i(14346),y=i(13272),b=i(13259),g=i(14900),w=i(16845),h=i(19781),v=i(19782),S=i(14982),A=i(19777),P=i(19783),C=i(13031),O=i(22405),E=i(15941),k=i(13240),I=i(19785),F=i(16811);function j(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function T(e,t,i){return(t=L(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function N(){return(N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}function D(e,t,i,o){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(o):void 0})}function R(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,L(o.key),o)}}function L(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function U(e,t){return(U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,o=W(e);if(t){var r=W(this).constructor;i=Reflect.construct(o,arguments,r)}else i=o.apply(this,arguments);return z(this,i)}}function z(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e,t,i,o,r){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var B=function(e){return e.icon="icon",e.displayName="displayName",e.status="status",e}({}),H=Object(l.c)((r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(l,e);var t,i,o,r=x(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).getClassNames=Object(u.a)(),t.workflowUniqueId=void 0,D(t,"associatedAppsCollection",n,M(t)),D(t,"associatedFlowsCollection",s,M(t)),t.onRenderIcon=e=>"uniqueid"in e?a.createElement(v.a,{item:e}):a.createElement(v.b,{item:e}),t.onRenderName=e=>"uniqueid"in e?a.createElement(A.a,{item:e}):a.createElement(A.d,{item:e}),t.onRenderStatus=e=>a.createElement(P.a,{item:e,includeName:!1,clientResources:t.props.clientResources}),t.renderTitle=()=>a.createElement(a.Fragment,null,t.cardTitleText,a.createElement(b.a,{iconName:y.a.Info,title:t.props.clientResources.FlowPropertyTile.AssociatedAppsTile.Tooltip})),t.renderTitleLink=()=>{var{clientResources:e,telemetryService:i}=t.props;return a.createElement(m.a,{onClick:()=>i.tagEvent(k.c.AssociatedAppsEditClicked,{flowName:t.workflowUniqueId}),href:t.flowAssociatedAppsRoute},e.Flow.Commands.Edit)},t.renderBody=()=>!t.isLoading&&t.renderDetailsList(),t.loadAssociatedEntities=()=>{var{loadAssociatedApps:e,associatedAppsService:i,associatedAppsStore:o,processMinSolutionVersion:r}=t.props;return i.getInstalledDynamicsApps({workflowUniqueId:t.workflowUniqueId}).then(()=>i.getInstalledPowerApps({workflowUniqueId:t.workflowUniqueId})).then(()=>o.setFlowCollectionItems()).then(()=>{o.workflowId&&r&&i.getAssociableFlows({workflowId:o.workflowId})}).then(()=>e(t.workflowUniqueId)).then(()=>{t.setAssociatedAppsCollection(t.getAssociatedAppsCollection(t.workflowUniqueId))}).then(()=>{var e=o.workflowId;e&&r&&i.getAssociatedFlows({entitledWorklowId:e}).then(()=>{t.setAssociatedFlowsCollection(t.getAssociatedFlowsCollection(e))})}).then(()=>o.setEntityCollectionItems())},t.getAssociatedAppsCollection=e=>{var i;return null===(i=t.props.associatedAppsStore.associatedApps)||void 0===i?void 0:i.getCollection(O.a.getAssociatedAppsCollectionType({objectId:e}))},t.getAssociatedFlowsCollection=e=>{var i;return null===(i=t.props.associatedAppsStore.associatedFlows)||void 0===i?void 0:i.getCollection(O.a.getAssociatedFlowsCollectionType({objectId:e}))},t.props.associatedAppsStore.setNumberEntitiesVisible(4),t.props.associatedAppsStore.setNumberEntitiesVisiblePerSection(2);var i=t.props.flowPropertiesPageStore.environmentStore.currentEnvironmentName;return t.props.associatedAppsStore.setEnvironmentName(i),t.state={flowCollectionItems:[],appCollectionItems:[]},t.workflowUniqueId=t.props.flowPropertiesPageStore.flowName,t}return t=l,(i=[{key:"componentDidMount",value:function(){var{flowService:e,flowStore:t,associatedAppsStore:i,associatedAppsService:o,processMinSolutionVersion:r}=this.props;e.loadFlow(this.workflowUniqueId,!0,void 0,void 0,!1,!0).then(()=>{var e,o=null===(e=t.getFlowEntityWithFallbackBehavior(this.workflowUniqueId))||void 0===e?void 0:e.xrmWorkflowId;o?i.setWorkflowId(o):i.setWorkflowId(null)}).then(()=>{r&&o.updateIsOnProcessPlan({workflowId:i.workflowId})}).then(()=>{i.setWorkflowUniqueId(this.workflowUniqueId)}).then(()=>this.loadAssociatedEntities())}},{key:"render",value:function(){var{clientResources:e,widgetUtilService:t}=this.props,i=this.getClassNames(c.a);return a.createElement(d.a,{ariaLabelLoading:e.Common.Loading,className:i.root,isLoading:this.isLoading,renderTitle:this.renderTitle,renderTitleLink:this.renderTitleLink,renderBody:this.renderBody,renderFooter:void 0,widgetUtilService:t})}},{key:"setAssociatedAppsCollection",value:function(e){this.associatedAppsCollection=e}},{key:"setAssociatedFlowsCollection",value:function(e){this.associatedFlowsCollection=e}},{key:"cardTitleText",get:function(){var{clientResources:e}=this.props;return e.FlowPropertyTile.AssociatedAppsTile.Title}},{key:"isLoading",get:function(){var{processMinSolutionVersion:e,flowPropertiesPageStore:t,associatedAppsStore:i}=this.props;return e?t.isFetchingFlow||!this.associatedAppsCollection||this.associatedAppsCollection.isCollectionLoading||null!==i.workflowId&&(!this.associatedFlowsCollection||this.associatedFlowsCollection.isCollectionLoading):t.isFetchingFlow||!this.associatedAppsCollection||this.associatedAppsCollection.isCollectionLoading}},{key:"flowAssociatedAppsRoute",get:function(){var{flowPropertiesPageStore:{flowName:e,solutionId:t},routeCrafter:i}=this.props;return Object(g.j)(i,{flowName:e,solutionId:t})}},{key:"manageCapacityRoute",get:function(){var{routeCrafter:e}=this.props;return e.craftRoute("manage",F.pb)}},{key:"columns",get:function(){var{clientResources:e}=this.props;return[{key:B.icon,name:e.ListHeader.Icon,fieldName:B.icon,minWidth:h.a.iconColumn,maxWidth:h.a.iconColumn,isRowHeader:!0,columnActionsMode:S.b.disabled,onRender:this.onRenderIcon},{key:B.displayName,name:e.ListHeader.Name,fieldName:B.displayName,minWidth:h.a.displayNameColumnMin,maxWidth:h.a.displayNameColumnMax,isRowHeader:!0,columnActionsMode:S.b.disabled,onRender:this.onRenderName},{key:B.status,name:e.ListHeader.Status,fieldName:B.status,minWidth:h.a.status,maxWidth:h.a.status,columnActionsMode:S.b.disabled,onRender:this.onRenderStatus}]}},{key:"flowsDetailsListProps",get:function(){return{columns:this.columns,isLoading:!1,items:this.props.associatedAppsStore.associatedFlowsCollectionItems.slice(0,this.props.associatedAppsStore.numberEntitiesVisible),getKey:e=>e.uniqueid}}},{key:"appsDetailsListProps",get:function(){return{columns:this.columns,isLoading:!1,items:this.props.associatedAppsStore.appCollectionItems.slice(0,this.props.associatedAppsStore.numberEntitiesVisible),getKey:e=>e.uniqueid}}},{key:"renderDetailsList",value:function(){var{associatedAppsStore:e}=this.props;return e.appCollectionItems.length>0&&e.flowCollectionItems.length>0?(e.setNumberEntitiesVisible(2),a.createElement(a.Fragment,null,this.renderAppsDetailsList(),this.renderFlowsDetailsList())):e.appCollectionItems.length>0?(e.setNumberEntitiesVisible(4),this.renderAppsDetailsList()):e.associatedFlowsCollectionItems.length>0?(e.setNumberEntitiesVisible(4),this.renderFlowsDetailsList()):a.createElement("div",null,this.renderZeroAssociatedEntitiesContent())}},{key:"renderAppsDetailsList",value:function(){var{clientResources:e}=this.props,t=this.getClassNames(c.a),i=Object(C.a)(e.FlowPropertyTile.AssociatedAppsTile.AppDescription,this.props.associatedAppsStore.appCollectionItems.length.toString());return a.createElement("div",null,a.createElement("div",{className:t.cardDetailsList},i),a.createElement(w.a,N({isHeaderVisible:!0},this.appsDetailsListProps)))}},{key:"renderFlowsDetailsList",value:function(){var{clientResources:e}=this.props,t=this.getClassNames(c.a),i=Object(C.a)(e.FlowPropertyTile.AssociatedAppsTile.FlowDescription,this.props.associatedAppsStore.flowCollectionItems.length.toString());return a.createElement("div",null,a.createElement("div",{className:t.cardDetailsList},i),a.createElement(w.a,N({isHeaderVisible:!0},this.flowsDetailsListProps)))}},{key:"renderZeroAssociatedEntitiesContent",value:function(){var{clientResources:e}=this.props,t=e.FlowPropertyTile.ZeroAssociatedApp.Text;return a.createElement(E.b,{interpolatedString:t,links:[{text:this.props.clientResources.Common.LearnMore,href:I.a.learnMoreAssociatedApps,isUnderlinedStyle:!0,target:m.b.blank}]})}}])&&R(t.prototype,i),o&&R(t,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(a.Component),n=q(r.prototype,"associatedAppsCollection",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=q(r.prototype,"associatedFlowsCollection",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q(r.prototype,"setAssociatedAppsCollection",[p.action],Object.getOwnPropertyDescriptor(r.prototype,"setAssociatedAppsCollection"),r.prototype),q(r.prototype,"setAssociatedFlowsCollection",[p.action],Object.getOwnPropertyDescriptor(r.prototype,"setAssociatedFlowsCollection"),r.prototype),q(r.prototype,"cardTitleText",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"cardTitleText"),r.prototype),q(r.prototype,"isLoading",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLoading"),r.prototype),q(r.prototype,"flowAssociatedAppsRoute",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"flowAssociatedAppsRoute"),r.prototype),q(r.prototype,"manageCapacityRoute",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"manageCapacityRoute"),r.prototype),q(r.prototype,"columns",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"columns"),r.prototype),q(r.prototype,"flowsDetailsListProps",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"flowsDetailsListProps"),r.prototype),q(r.prototype,"appsDetailsListProps",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"appsDetailsListProps"),r.prototype),o=r))||o;var V=Object(f.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?j(Object(i),!0).forEach((function(t){T(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({featureFlags:e.featureFlags,clientResources:e.clientResources,flowService:e.flowService,flowStore:e.flowStore,environmentStore:e.environmentStore,loggingService:e.loggingService,telemetryService:e.telemetryService,routeCrafter:e.routeCrafter,widgetUtilService:e.widgetUtilService,associatedAppsStore:e.associatedAppsStore,associatedAppsService:e.associatedAppsService},t))(H)},22831:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i(11809),r=i(11896),n=Object(r.a)({teamName:o.a.PowerAutomateClientTeam,owners:["flowmoney@microsoft.com"],description:"Enables the process license flow associations feature",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1231260",createdOn:"2/14/2024",fallback:{isProcessLicenseAssociationsEnabled:!1}}),{getFeatureValue:s}=Object(r.b)(n,e=>!!e.isProcessLicenseAssociationsEnabled)},22841:function(e,t,i){"use strict";i.d(t,"a",(function(){return Ne}));var o=i(12339),r=i(12999),n=i(15459),s=i(12345),a=i(17258),l=i(15339),c=i(13e3),p=i(13202),u=i(18804),d=i(15332),f=i(17159),m=i(21064),y=i(17278),b=i(15463),g=i(14378),w=i(14648),h=i(17869),v=i(20893),S=i(17761),A=i(15417),P=i(15474),C=i(22200),O=i(17213),E=i(20953),k=i(17448),I=i(13081),F=i(13087),j=i(21859),T=i(15490),N=i(16924),D=i(22842),R=i(22071),L=i(17374),U=i(17185),x=i(13231),z=i(18801),M=i(20901),W=i(20988),q=i(13148),B=i(17864),H=i(20891),V=i(21875),_=i(20961),K=i(20943),Z=i(22357),J=i(15493),G=i(20948),$=i(22360),Y=i(17283),Q=i(15330),X=i(17281),ee=i(21017),te=i(21020),ie=i(17169),oe=i(22847),re=i(20968),ne=i(21026),se=i(22853),ae=i(20964),le=i(20920),ce=i(22361),pe=i(20984),ue=i(22855),de=i(22186),fe=i(20949),me=i(22858),ye=i(22862),be=i(20915),ge=i(14688),we=i(20918),he=i(22863),ve=i(21878),Se=i(22363),Ae=i(17284),Pe=i(17150),Ce=i(17174),Oe=i(21856),Ee=i(15460),ke=i(17289),Ie=i(13077),Fe=i(18814),je=i(17901),Te=i(20926);function Ne(e){var t=new m.a(Object(r.a)(),e,y.a,s.a,F.a,V.a,U.a);return{aiHostedModelsService:Fe.a,appSettings:Object(o.b)(),assetService:g.a,associatedAppsPageStore:he.a,associatedAppsService:me.a,associatedAppsStore:ye.a,cdnService:w.a,clientResources:e,consentService:ie.a,connectionService:h.a,connectionStore:B.a,copilotFlowActivityService:ke.a,designerConnectionStore:be.a,designerCreateContext:Object(ne.a)(e),designerOperationsService:v.a,designerOperationsStore:H.a,desktopFlowStore:we.a,diagnosticService:t,diagnosticStore:V.a,doNotShowAgainService:S.a,desktopFlowAIHttpClient:je.a,dynamicListStore:ve.a,environmentCapabilityService:A.a,environmentCapabilityStore:n.a,environmentService:P.a,environmentStore:s.a,featureFlags:Object(r.a)(),flowRoleService:C.a,flowRoleStore:X.a,flowRunsExportService:Oe.a,flowRunsService:K.a,flowRunsStore:G.a,flowRunsTriggerOutputsStore:fe.a,flowRunHistoryService:ce.a,flowService:O.a,callbackUrlService:Object(Te.a)(e),flowStore:a.a,flowSupportCheckerService:Se.a,flowsSuspensionStatusStore:Ae.a,flowTriggersStore:Y.a,flowUsageService:ue.a,flowUsageStore:de.a,gatewayClusterStore:_.a,gatewayService:E.a,geocodeService:se.a,graphService:k.a,graphStore:Q.a,hostCommunicationService:I.a,invokeFlowService:oe.a,legacyFeatureFlags:Object(o.b)(),licenseManagementService:ae.a,licenseManagementStore:le.a,loggingService:F.a,markdownService:j.a,navigationService:T.a,neptuneService:L.a,neptuneStore:Pe.a,oAuthService:re.a,planService:J.a,planStore:l.a,policyService:N.a,ppapiService:ge.a,routeCrafter:U.a,scenarioLoggingService:Ce.a,sessionStore:c.a,solutionService:Z.a,solutionStore:$.a,surfaceStore:p.a,teamsDeepLinkService:pe.a,templateService:z.a,templateStore:u.a,telemetryService:x.a,tokenService:Ie.a,triggerService:M.a,uiFlowService:W.a,userDetailsStore:d.a,userFeaturesStore:f.a,userEntitlementsService:D.a,widgetUtilService:q.a,xrmConnectionReferenceService:ee.a,xrmConnectionReferenceStore:te.a,xrmEntityHttpClient:Ee.b,xrmUserService:R.a,xrmWorkflowHttpClient:b.a}}},22842:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i(22843),r=i(12345),n=i(22845),s=i(13087),a=i(17162),l=new o.a(s.a,n.a,a.a,r.a)},22843:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i(22844),r=i(12364),n=i(13009),s=i(17163),a=i(13085);function l(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,p(o.key),o)}}function c(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=c((function e(t,i,l,c){var p=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.userEntitlementHttpClient=i,this.userEntitlementsStore=l,this.environmentStore=c,this.getUserEntitlements=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=p.environmentStore.currentEnvironmentName,l=s.a.getUserEntitlementsKey(i,e),c=p.userEntitlementsStore.getUserEntitlements(i,e),u=p.userEntitlementsStore.getEntityStatus(l),d=u&&u.lastFetched;if(t||!c||Object(r.d)(d)){var f=p.loggingService.profileStart(a.a.userEntitlementsLoadStart);return p.userEntitlementsStore.userEntitlements.entities.setEntityFetching(l),p.userEntitlementHttpClient.getUserEntitlements(i,e).then(t=>(p.userEntitlementsStore.addUserEntitlementsEntity(new o.a(t.data,i,e)),p.userEntitlementsStore.userEntitlements.entities.setEntitySuccess(l),p.loggingService.profileEndWithSuccess(f,a.a.userEntitlementsLoadEnd),t.data)).catch(e=>{var t=Object(n.db)(e),i=t&&t.includes("MissingUserDetails")?n.e.Warning:Object(n.y)(e);throw p.userEntitlementsStore.userEntitlements.entities.setEntityError(l,e),p.loggingService.profileEnd(f,a.a.userEntitlementsLoadEnd,i,e),e})}return Promise.resolve(c)}}))},22844:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o,r=i(11773);function n(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,s(o.key),o)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t,i,o,r){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var l=(a((o=function(){function e(t,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userId=void 0,this.environmentName=void 0,this.accessPremiumApis=void 0,this.rpaAttendedAllowed=void 0,this.additionalAllowedPremiumApis=void 0,Object(r.extendObservable)(this,t),this.setUserId(o),this.setEnvironmentName(i)}var t,i,o;return t=e,(i=[{key:"setUserId",value:function(e){this.userId=e}},{key:"setEnvironmentName",value:function(e){this.environmentName=e}}])&&n(t.prototype,i),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"setUserId",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"setUserId"),o.prototype),a(o.prototype,"setEnvironmentName",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"setEnvironmentName"),o.prototype),o)},22845:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var o=i(13192),r=i(13077),n=i(13e3),s=i(13087),a=i(12339),l=i(22846),c=i(14688),p=new l.a(Object(a.b)(),new o.HttpClient,c.a,r.a,s.a,n.a)},22846:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var o=i(13215),r=i(12381),n=i(13144),s=i(14829);function a(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,i,r,n,a,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.httpClient=i,this.ppapiService=r,this.tokenService=n,this.loggingService=a,this.sessionStore=l,[Object(o.f)(a,()=>this.sessionStore.sessionId),Object(o.c)(()=>this.tokenService.getAccessToken(this.appSettings.flowAudience)),Object(s.b)(this.ppapiService,this.appSettings)].forEach(e=>this.httpClient.addRequestInterceptor(e)),this.httpClient.addResponseInterceptor(Object(o.g)(this.loggingService,this.sessionStore),Object(o.e)(this.loggingService,this.sessionStore))}var t,i,l;return t=e,(i=[{key:"getUserEntitlements",value:function(e,t){return this.getUserEntitlementsUrl(e,t),this.httpClient.get({eventName:"PROCESSSIMPLE:GET/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/USERS/USERENTITLEMENTS",url:this.getUserEntitlementsUrl(e,t)})}},{key:"getUserEntitlementsUrl",value:function(e,t){return Object(r.a)(Object(n.b)(e,this.appSettings).flowRP,"".concat(this.appSettings.processSimpleResourceProviderPath,"/environments/").concat(e,"/users/").concat(t,"/userEntitlements"))}}])&&a(t.prototype,i),l&&a(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22847:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var o=i(22848),r=i(13087),n=new o.a(r.a)},22848:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var o=i(15568),r=i(12366),n=i(13009),s=i(22849),a=i(22851),l=i(14835),c=i(13083),p=i(11806),u=i(22852);function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){m(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function m(e,t,i){return(t=b(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,b(o.key),o)}}function b(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g={[u.a.Boolean]:o.b.Boolean,[u.a.Date]:o.b.Date,[u.a.Email]:o.b.Email,[u.a.Enum]:o.b.Enum,[u.a.File]:o.b.File,[u.a.MultiSelect]:o.b.MultiSelect,[u.a.Number]:o.b.Number,[u.a.Text]:o.b.Text,[u.a.Integer]:o.b.Integer,[u.a.ComplexSchema]:o.b.ComplexSchema},w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t}var t,i,d;return t=e,(i=[{key:"getRequestBody",value:function(e){var{flowEntity:t,inputParameters:i,entityData:o}=e,r=this.constructRequestBodyParameters(i);return t.containsRequestApiConnectionTrigger?this.getRequestBodyForHybridTrigger(r,o):r}},{key:"getInputParametersForFlow",value:function(e){var{flowEntity:t,location:i,clientResources:a}=e,c={},d=t.userInputParameterSchema,m=Object(s.a)(a),y=this.isComplexSchemaInputAllowed(t),b=new o.a(a,a,a),w={},h=window.location.search,v=Object(p.c)(h);for(var S in v)S.startsWith("parameters.")&&(w[S.substring("parameters.".length)]=v[S]);return Object.entries(d&&d.properties||{}).filter(e=>{var[t]=e;return!Object(u.e)(t)}).forEach(e=>{var[s,a]=e,p={type:g[Object(u.d)(a,y)],label:Object(u.c)(a,s),description:Object(u.b)(a),isRequired:Object(l.H)(s,t)};if(w[s]&&(p.type===o.b.Text&&(p.initialValue=w[s]),(p.type===o.b.Number||p.type===o.b.Boolean||p.type===o.b.Date||p.type===o.b.Email)&&p.label)){var d=!1,h=w[s];switch(p.type){case o.b.Number:d=null!==Object(o.d)(h)&&void 0!==Object(o.d)(h);break;case o.b.Boolean:d="true"===h||"false"===h;break;case o.b.Date:d=/^\d{4}-\d{2}-\d{2}$/.test(h)&&!isNaN(Date.parse(h));break;case o.b.Email:d=/^[\w.%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(h);break;default:d=!1}d?p.type===o.b.Boolean?p.initialValue="true"===h:p.type===o.b.Number?p.initialValue=Object(o.d)(h):p.initialValue=h:this.loggingService.logError("InvokeFlowService.getInputParametersForFlow",new n.a(n.c.InvokeFlowServiceEntityDataWrongFormat,"initialParam value does not match the expected type"))}if(Object(l.I)(s)){var v=f(f({},p),{},{type:o.b.ImplicitLocation,initialValue:i&&i.latitude});c[r.q.latitude]=b.createInputParameter(v);var S=f(f({},p),{},{type:o.b.ImplicitLocation,initialValue:i&&i.longitude});c[r.q.longitude]=b.createInputParameter(S)}else Object(u.f)(s)?c[r.g]=b.createInputParameter(f(f({},p),{},{type:o.b.ImplicitDate})):(p.type===o.b.Text&&(p.maxLength=a.maxLength),p.type===o.b.Enum&&(p.options=a.enum),p.type===o.b.MultiSelect&&(p.options=a.items.enum),p.type===o.b.File&&(p.fileReader=m),c[s]=b.createInputParameter(p))}),c}},{key:"isComplexSchemaInputAllowed",value:function(e){return Object(a.a)()&&Object(l.k)(e.toJS())}},{key:"getRequestBodyForHybridTrigger",value:function(e,t){var i=[];return t&&t.length>0?t.forEach(t=>{Array.isArray(t)?this.loggingService.logError("InvokeFlowService.getRequestBodyForHybridTrigger",new n.a(n.c.InvokeFlowServiceEntityDataWrongFormat,"entityDataObject must be an array")):i.push(f(f({},e),{},{entity:t}))}):i.push(e),{rows:i}}},{key:"constructRequestBodyParameters",value:function(e){var t={};return Object.keys(e).forEach(i=>{var r=i.split("."),n=e[i],s=n.fieldProps.type===o.b.Number||n.fieldProps.type===o.b.Integer?Object(o.d)(n.fieldState.value):n.fieldProps.type===o.b.ComplexSchema?Object(o.e)(n.fieldState.value):n.fieldState.value;Object(c.a)(s)||(t=this.constructRequestBodyFormat(t,r,s))}),t}},{key:"constructRequestBodyFormat",value:function(e,t,i){return 1===t.length?e[t[0]]=i:(e[t[0]]=e[t[0]]||{},e[t[0]]=this.constructRequestBodyFormat(e[t[0]],t.slice(1),i)),e}}])&&y(t.prototype,i),d&&y(t,d),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22849:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var o=i(22850),r=e=>(t,i)=>new o.b(e.Services,t,i)},22851:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i(11896),r=i(11809),n=Object(o.a)({teamName:r.a.PowerAutomateClientTeam,owners:["luisedmundog","bnarayanared"],description:"Enables usage of complex schema inputs in flow run panel for skills trigger flows.",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1393627",createdOn:"08/12/2024",fallback:{enableComplexSchemaInputForSkillsTriggerRunPanel:!1}}),{getFeatureValue:s}=Object(o.b)(n,"enableComplexSchemaInputForSkillsTriggerRunPanel")},22853:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var o=i(12250),r=i(12247),n=i(13087),s=i(12335);var a=new(i(22854).a)((function(){return Object(r.d)(s.e).then(()=>o.a.t("strings",{ns:s.e,returnObjects:!0}))}),n.a)},22854:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var o=i(13009),r=i(13085);function n(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,s(o.key),o)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getFlowServiceResources=t,this.loggingService=i}var t,i,s;return t=e,(i=[{key:"get",value:function(){var e=this.loggingService.profileStart(r.a.geocodeGetStart);return navigator.geolocation?this.getFlowServiceResources().then(t=>new Promise((i,n)=>{navigator.geolocation.getCurrentPosition(t=>{this.loggingService.profileEndWithSuccess(e,r.a.geocodeGetEnd),i(t)},i=>{this.loggingService.profileEnd(e,r.a.geocodeGetEnd,o.e.Warning,i),n(new o.b(o.c.geocodeServiceGeolocationDisabled,t.Geolocation.Disabled,null))},{timeout:5e3})})):this.getFlowServiceResources().then(t=>{var i=new o.b(o.c.geocodeServiceGeolocationUnsupported,t.Geolocation.Unsupported.Message);throw this.loggingService.profileEnd(e,r.a.geocodeGetEnd,o.e.Warning,i),i})}},{key:"getCoordinates",value:function(){return this.get().then(e=>({latitude:e.coords.latitude,longitude:e.coords.longitude}))}}])&&n(t.prototype,i),s&&n(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22855:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i(22856),r=i(12345),n=i(22186),s=i(17278),a=i(13087),l=new o.a(a.a,s.a,n.a,r.a)},22856:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var o=i(13146),r=i(12364),n=i(15402),s=i(13085),a=i(22857);function l(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,c(o.key),o)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p=function(){function e(t,i,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.flowHttpClient=i,this.flowUsageStore=r,this.environmentStore=n,this.runFirstPending=Object(o.a)()}var t,i,c;return t=e,(i=[{key:"getFlowRunOverCapUsage",value:function(e){var{flowName:t,forceRefresh:i=!1}=e,o=this.environmentStore.currentEnvironmentName,l=this.flowUsageStore.runOverCapUsages.getEntityStatus(t),c=l&&l.lastFetched;return i||Object(r.d)(c)?this.runFirstPending({key:"loadFlowRunOverCapUsage",action:()=>{this.flowUsageStore.runOverCapUsages.setEntityFetching(t);var e=this.flowHttpClient.getFlowRunOverCapUsage({environmentName:o,flowName:t}).then(e=>{this.flowUsageStore.addRunOverCapUsageEntity(t,Object(a.b)(null==e?void 0:e.data)),this.flowUsageStore.runOverCapUsages.setEntitySuccess(t)}).catch(e=>{var i;if(404===(null==e||null===(i=e.response)||void 0===i?void 0:i.status))return this.flowUsageStore.addRunOverCapUsageEntity(t,null),void this.flowUsageStore.runOverCapUsages.setEntitySuccess(t);throw this.flowUsageStore.runOverCapUsages.setEntityError(t,e),e});return Object(n.b)({loggingService:this.loggingService,promise:e,eventStartName:s.a.getFlowRunOverCapUsageStart,eventEndName:s.a.getFlowRunOverCapUsageEnd})}}):Promise.resolve()}},{key:"getFlowRunOverCapUsages",value:function(){var e=this.environmentStore.currentEnvironmentName,t=this.flowUsageStore.runsOverCapUsagesByEnvironment.getEntityStatus(e),i=t&&t.lastFetched;return Object(r.d)(i)?(this.flowUsageStore.runsOverCapUsagesByEnvironment.setEntityFetching(e),this.runFirstPending({key:"loadFlowRunOverCapUsages",action:()=>{var t=this.flowHttpClient.getFlowRunOverCapUsages(e).then(t=>{var i=null!=t&&t.data&&t.data.length?t.data:[];this.flowUsageStore.addRunsOverCapUsagesByEnvironment(e,Object(a.a)(i)),this.flowUsageStore.runsOverCapUsagesByEnvironment.setEntitySuccess(e),t.data.forEach(e=>{e.properties.runUsage?this.flowUsageStore.addRunOverCapUsageEntity(e.name,Object(a.b)(e.properties.runUsage)):this.flowUsageStore.addRunOverCapUsageEntity(e.name,null),this.flowUsageStore.runOverCapUsages.setEntitySuccess(e.name)})}).catch(t=>{this.flowUsageStore.runsOverCapUsagesByEnvironment.setEntityError(e,t)});return Object(n.b)({loggingService:this.loggingService,promise:t,eventStartName:s.a.getFlowRunOverCapUsagesStart,eventEndName:s.a.getFlowRunOverCapUsagesEnd})}})):Promise.resolve()}}])&&l(t.prototype,i),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22857:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n}));var o=i(14918);function r(e){if(null!=e&&e.consumedDate){var t=new Date(Date.now()),i=new Date(e.consumedDate);return i<t&&Object(o.p)(i,t)>7?null:e}return null}function n(e){var t=[];return e.forEach(e=>{if(e.properties.runUsage){var i=new Date(Date.now()),r=new Date(e.properties.runUsage.consumedDate);r<i&&Object(o.p)(r,i)<7&&t.push({flowName:e.name,overCapUsage:e.properties.runUsage})}}),t}},22858:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var o=i(22859),r=i(22862),n=i(17258),s=i(17278),a=i(15460),l=i(13087),c=i(17946),p=new o.a(a.b,r.a,n.a,l.a,s.a,c.a);new o.a(a.a,r.a,n.a,l.a,s.a,c.a)},22859:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var o=i(12330),r=i(22860),n=i(15427),s=i(22405),a=i(13146),l=i(13085),c=i(13009),p=i(15990),u=i(22861);function d(e,t,i,o,r,n,s){try{var a=e[n](s),l=a.value}catch(c){return void i(c)}a.done?t(l):Promise.resolve(l).then(o,r)}function f(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var n=e.apply(t,i);function s(e){d(n,o,r,s,a,"next",e)}function a(e){d(n,o,r,s,a,"throw",e)}s(void 0)}))}}function m(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,y(o.key),o)}}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var b=function(){function e(t,i,o,r,n,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.xrmEntityHttpClient=t,this.associatedAppsStore=i,this.flowStore=o,this.loggingService=r,this.flowHttpClient=n,this.powerAppsHttpClient=s,this.runFirstPending=Object(a.a)()}var t,i,d,y;return t=e,(i=[{key:"getAssociatedApps",value:function(e){var{workflowUniqueId:t}=e,i=this.loggingService.profileStart(l.a.loadAssociatedAppsStartProfilingEventName),a=s.a.getAssociatedAppsCollectionType({objectId:t}),p=this.flowStore.getFlowEntityWithFallbackBehavior(t),u=p?p.billingContext:null;Object(o.a)(p)&&this.loggingService.logInfo("getAssociatedApps.flowEntity","flowEntity is null or undefined.");var d=u||[];this.associatedAppsStore.setBillingContextItems(d),this.associatedAppsStore.associatedApps.setCollectionLoading(a);var f=d.map(e=>this.getAssociatedAppsStatus({appId:e.linkId,platform:e.linkType}).then(i=>{var o=t+"-"+e.linkId;return new r.a({uniqueid:o,appname:e.linkId,status:i,platform:e.linkType===n.a.dynamics?n.a.dynamics:n.a.powerapps,displayName:this.getDisplayName(o,e),associationType:n.d.associatedapp})}));return this.loggingService.logInfo(l.a.associatedAppLoaded,"Associated apps loaded",{numberOfAssociatedApps:f.length,flowName:t}),Promise.all(f).then(e=>{this.associatedAppsStore.associatedApps.setCollectionLoaded(a,e,{resetList:!0,replaceDupe:()=>!0})}).then(()=>{this.loggingService.profileEndWithSuccess(i,l.a.loadAssociatedAppsEndProfilingEventName,{flowName:t})}).catch(e=>{this.loggingService.profileEnd(i,l.a.loadAssociatedAppsEndProfilingEventName,Object(c.y)(e),e,{flowName:t})}).then(()=>this.associatedAppsStore.setAppCollectionItems()).then(()=>this.associatedAppsStore.setEntityCollectionItems())}},{key:"putAssociatedApps",value:function(e){var t=this,{apps:i,workflowUniqueId:o}=e,a=this.loggingService.profileStart(l.a.putAssociatedAppsStartProfilingEventName),u=s.a.getAssociatedAppsCollectionType({objectId:o}),d=i.map(e=>({contextLinkId:e.linkId,contextLinkType:e.linkType,metadata:e.metadata&&{displayName:e.metadata.displayName}}));return this.runFirstPending({key:"putAssociatedApps/flow/".concat(o,"/"),action:()=>(this.associatedAppsStore.associatedApps.setCollectionLoading(u),this.associatedAppsStore.setReadOnly(!0),this.flowHttpClient.updateBillingContext({payload:d,environmentName:this.associatedAppsStore.environmentName,flowName:o}).catch(e=>{throw this.associatedAppsStore.associatedApps.setCollectionError(o,e),this.loggingService.logError("AssociatedAppsService.putAssociatedApps",e,{workflowUniqueId:o}),Object(p.a)(e)?this.loggingService.profileEndWithSuccess(a,l.a.putAssociatedAppsEndProfilingEventName,{errorStatus:Object(c.y)(e),error:e,flowName:o}):this.loggingService.profileEnd(a,l.a.putAssociatedAppsEndProfilingEventName,Object(c.y)(e),e,{flowName:o}),this.associatedAppsStore.setReadOnly(!1),e}).then(function(){var e=f((function*(e){t.loggingService.logInfo("AssociatedAppsService.putAssociatedApps","Successfully updated associated apps");var s=i.map(e=>t.getAssociatedAppsStatus({appId:e.linkId,platform:e.linkType}).then(t=>new r.a({uniqueid:o+"-"+e.linkId,appname:e.linkId,status:t,platform:e.linkType,displayName:e.metadata&&e.metadata.displayName,associationType:n.d.associatedapp})));yield Promise.all(s).then(e=>{t.associatedAppsStore.associatedApps.setCollectionLoaded(u,e,{resetList:!0,replaceDupe:()=>!0})}),t.associatedAppsStore.setBillingContextItems(i)}));return function(t){return e.apply(this,arguments)}}()).then(()=>this.associatedAppsStore.setAppCollectionItems()).then(()=>this.associatedAppsStore.setEntityCollectionItems()).then(()=>this.associatedAppsStore.setReadOnly(!1)).then(()=>this.associatedAppsStore.setPowerAppsToAdd()).then(()=>this.associatedAppsStore.setDynamicsAppsToAdd()).then(()=>this.loggingService.profileEndWithSuccess(a,l.a.putAssociatedAppsEndProfilingEventName,{flowName:o})))})}},{key:"patchAssociatedApps",value:function(e){var t=this,{apps:i,workflowUniqueId:o,workflowId:a}=e,u=this.loggingService.profileStart(l.a.patchAssociatedAppsStartProfilingEventName),d=s.a.getAssociatedAppsCollectionType({objectId:o}),m=i.map(e=>({id:e.linkId,type:e.linkType,metadata:e.metadata&&{displayName:e.metadata.displayName}})),y={billingcontext:JSON.stringify(m)};return this.runFirstPending({key:"patchAssociatedApps/flow/".concat(o,"/"),action:()=>(this.associatedAppsStore.associatedApps.setCollectionLoading(d),this.associatedAppsStore.setReadOnly(!0),this.xrmEntityHttpClient.updateRecord("workflows",a,y).catch(e=>{throw this.associatedAppsStore.associatedApps.setCollectionError(o,e),this.loggingService.logError("AssociatedAppsService.patchAssociatedApps",e,{workflowUniqueId:o}),Object(p.a)(e)?this.loggingService.profileEndWithSuccess(u,l.a.patchAssociatedAppsEndProfilingEventName,{errorStatus:Object(c.y)(e),error:e,flowName:o}):this.loggingService.profileEnd(u,l.a.patchAssociatedAppsEndProfilingEventName,Object(c.y)(e),e,{flowName:o}),this.associatedAppsStore.setReadOnly(!1),e}).then(function(){var e=f((function*(e){t.loggingService.logInfo("AssociatedAppsService.patchAssociatedApps","Successfully updated associated apps");var s=i.map(e=>t.getAssociatedAppsStatus({appId:e.linkId,platform:e.linkType}).then(t=>new r.a({uniqueid:o+"-"+e.linkId,appname:e.linkId,status:t,platform:e.linkType,displayName:e.metadata&&e.metadata.displayName,associationType:n.d.associatedapp})));yield Promise.all(s).then(e=>{t.associatedAppsStore.associatedApps.setCollectionLoaded(d,e,{resetList:!0,replaceDupe:()=>!0})}),t.associatedAppsStore.setBillingContextItems(i)}));return function(t){return e.apply(this,arguments)}}()).then(()=>this.associatedAppsStore.setAppCollectionItems()).then(()=>this.associatedAppsStore.setEntityCollectionItems()).then(()=>this.associatedAppsStore.setReadOnly(!1)).then(()=>this.associatedAppsStore.setPowerAppsToAdd()).then(()=>this.associatedAppsStore.setDynamicsAppsToAdd()).then(()=>this.loggingService.profileEndWithSuccess(u,l.a.patchAssociatedAppsEndProfilingEventName,{flowName:o})))})}},{key:"addAssociatedFlows",value:function(e){var t,i=this,{updatedCollection:o,workflowsToAssociate:r,entitledWorklowId:n}=e,a=this.loggingService.profileStart(l.a.addAssociatedFlowsStartProfilingEventName),p=s.a.getAssociatedFlowsCollectionType({objectId:n}),u={"licenseentitledby_workflowid@odata.bind":"/workflows(".concat(n,")")};return this.runFirstPending({key:"updateAssociatedFlowCollection/flow/".concat(n,"/"),action:(t=f((function*(){i.associatedAppsStore.associatedFlows.setCollectionLoading(p),i.associatedAppsStore.setReadOnly(!0);var e=i.associatedAppsStore.associableFlows.filter(e=>!r.includes(e));i.associatedAppsStore.setAssociableFlows(e),r.map(e=>i.xrmEntityHttpClient.updateRecord("workflows",e.workflowid,u).then(()=>{i.loggingService.logInfo("AssociatedAppsService.addAssociatedFlows","Successfully updated associated flow",{workflowId:e.workflowid})})),yield Promise.all(r).catch(e=>{throw i.associatedAppsStore.associatedFlows.setCollectionError(p,e),i.loggingService.logError("AssociatedAppsService.addAssociatedFlows",e,{entitledWorklowId:n}),i.associatedAppsStore.setReadOnly(!1),i.loggingService.profileEnd(a,l.a.addAssociatedFlowsEndProfilingEventName,Object(c.y)(e),e,{workflowId:n}),e}).then(()=>{i.associatedAppsStore.associatedFlows.setCollectionLoaded(p,o,{resetList:!0,replaceDupe:()=>!0})}).then(()=>i.associatedAppsStore.setFlowCollectionItems()).then(()=>i.associatedAppsStore.setEntityCollectionItems()).then(()=>i.associatedAppsStore.setReadOnly(!1)).then(()=>i.loggingService.profileEndWithSuccess(a,l.a.addAssociatedFlowsEndProfilingEventName,{workflowId:n}))})),function(){return t.apply(this,arguments)})})}},{key:"deleteAssociatedFlows",value:function(e){var t,i,o=this,{updatedCollection:r,workflowsToDeleteEntitlements:n,entitledWorklowId:a}=e,p=this.loggingService.profileStart(l.a.deleteAssociatedFlowsStartProfilingEventName),u=s.a.getAssociatedFlowsCollectionType({objectId:a}),d={"licenseentitledby_workflowid@odata.bind":null};return this.runFirstPending({key:"updateAssociatedFlowCollection/flow/".concat(a,"/"),action:(i=f((function*(){o.associatedAppsStore.associatedFlows.setCollectionLoading(u),o.associatedAppsStore.setReadOnly(!0);var e=o.associatedAppsStore.associableFlows.slice();o.associatedAppsStore.licenseEntitledByValue?t=[o.xrmEntityHttpClient.updateRecord("workflows",a,d).then(()=>{o.loggingService.logInfo("AssociatedAppsService.deleteAssociatedFlows","Successfully deleted flow association from associated flow",{workflowId:a})})]:(e.push(...n),o.associatedAppsStore.setAssociableFlows(e),t=n.map(e=>o.xrmEntityHttpClient.updateRecord("workflows",e.workflowid,d).then(()=>{o.loggingService.logInfo("AssociatedAppsService.deleteAssociatedFlows","Successfully deleted flow assocation from process licensed flow",{workflowId:e.workflowid})}))),yield Promise.all(t).catch(e=>{throw o.associatedAppsStore.associatedFlows.setCollectionError(u,e),o.loggingService.logError("AssociatedAppsService.deleteAssociatedFlows",e,{entitledWorklowId:a}),o.associatedAppsStore.setReadOnly(!1),o.loggingService.profileEnd(p,l.a.deleteAssociatedFlowsEndProfilingEventName,Object(c.y)(e),e,{workflowId:a}),e}).then(()=>{o.associatedAppsStore.associatedFlows.setCollectionLoaded(u,r,{resetList:!0,replaceDupe:()=>!0})}).then(()=>o.associatedAppsStore.setFlowCollectionItems()).then(()=>o.associatedAppsStore.setEntityCollectionItems()).then(()=>o.associatedAppsStore.setReadOnly(!1)).then(()=>o.loggingService.profileEndWithSuccess(p,l.a.deleteAssociatedFlowsEndProfilingEventName,{workflowId:a}))})),function(){return i.apply(this,arguments)})})}},{key:"getAssociatedFlows",value:function(e){var t=this,{entitledWorklowId:i}=e,o=this.loggingService.profileStart(l.a.loadAssociatedFlowsStartProfilingEventName),r=s.a.getAssociatedFlowsCollectionType({objectId:i}),a=[];return this.runFirstPending({key:"getAssociatedFlows/flow/".concat(i,"/"),action:()=>(this.associatedAppsStore.associatedFlows.setCollectionLoading(r),this.xrmEntityHttpClient.retrieveRecord("workflows",i,{$select:"workflowid,name,_licenseentitledby_value"},{"mscrm.AsUnpublished":"true","If-Match":"*"}).then(function(){var e=f((function*(e){t.loggingService.logInfo("AssociatedAppsService.getAssociatedFlows","Successfully retrieved entitled workflow");var o=e.data._licenseentitledby_value;if(null!==e.data._licenseentitledby_value){t.associatedAppsStore.setLicenseEntitledByValue(o);var r={workflowid:o,flowname:(yield t.xrmEntityHttpClient.retrieveRecord("workflows",o,{$select:"name"},{"mscrm.AsUnpublished":"true","If-Match":"*"})).data.name,status:n.b.connected,platform:n.c.powerautomate,associationType:n.d.processflow};a.push(r)}else t.associatedAppsStore.setLicenseEntitledByValue(null),yield t.xrmEntityHttpClient.retrieveMultiple("workflows",{$filter:"_licenseentitledby_value eq '".concat(i,"'"),$select:"workflowid,name"}).then(e=>{t.loggingService.logInfo("AssociatedAppsService.getAssociatedFlows","Successfully retrieved associated flows"),e.data.value.length>0&&e.data.value.forEach(e=>{var t={workflowid:e.workflowid,flowname:e.name,status:n.b.connected,platform:n.c.powerautomate,associationType:n.d.associatedflow};a.push(t)})})}));return function(t){return e.apply(this,arguments)}}()).catch(e=>{this.associatedAppsStore.associatedFlows.setCollectionError(r,e),this.loggingService.logError("AssociatedAppsService.getAssociatedFlows",e,{entitledWorklowId:i}),this.loggingService.profileEnd(o,l.a.loadAssociatedFlowsEndProfilingEventName,Object(c.y)(e),e,{workflowId:i})}).then(()=>{this.associatedAppsStore.associatedFlows.setCollectionLoaded(r,a,{resetList:!0,replaceDupe:()=>!0})}).then(()=>this.associatedAppsStore.setFlowCollectionItems()).then(()=>this.associatedAppsStore.setEntityCollectionItems()).then(()=>{this.loggingService.profileEndWithSuccess(o,l.a.loadAssociatedFlowsEndProfilingEventName,{workflowId:i})}))})}},{key:"getInstalledDynamicsApps",value:function(e){var{workflowUniqueId:t}=e,i=this.associatedAppsStore.environmentName,o=this.loggingService.profileStart(l.a.loadInstalledDynamicsAppsStartProfilingEventName);return this.runFirstPending({key:"getInstalledDynamicsApps/flow/".concat(t,"/"),action:()=>this.flowHttpClient.getInstalledDynamicsApps({environmentName:i}).then(e=>{var i=[];e.data.value.map(e=>i.push(new r.a({uniqueid:t+"-"+e.name,appname:e.name,status:n.b.error,platform:n.a.dynamics,displayName:e.displayName,associationType:n.d.associatedapp}))),this.loggingService.logInfo("AssociatedAppsService.getInstalledDynamicsApps","Successfully retrieved installed dynamics apps",{numberOfInstalledApps:i.length}),this.associatedAppsStore.setDynamicsApps(i)}).then(()=>{this.loggingService.profileEndWithSuccess(o,l.a.loadInstalledDynamicsAppsEndProfilingEventName,{flowName:t})}).catch(e=>{this.checkEnvironmentAccessDenied(e)?this.loggingService.profileEndWithSuccess(o,l.a.loadInstalledDynamicsAppsEndProfilingEventName,{errorStatus:Object(c.y)(e),error:e,flowName:t}):(this.loggingService.logError("AssociatedAppsService.getInstalledDynamicsApps",e,{workflowUniqueId:t}),this.loggingService.profileEnd(o,l.a.loadInstalledDynamicsAppsEndProfilingEventName,Object(c.y)(e),e,{flowName:t}))})})}},{key:"getInstalledPowerApps",value:function(e){var t=this,{workflowUniqueId:i}=e,o=this.associatedAppsStore.environmentName,s=this.loggingService.profileStart(l.a.loadInstalledPowerAppsStartProfilingEventName);return this.runFirstPending({key:"getInstalledPowerApps/flow/".concat(i,"/"),action:()=>this.powerAppsHttpClient.getUnifiedApps({environmentName:o}).then(function(){var e=f((function*(e){var o=[],s=e.data.value,a=e.data.nextLink;for(s.map(e=>o.push(new r.a({uniqueid:i+"-"+e.name,appname:e.properties.logicalName?e.properties.logicalName:e.name,status:n.b.error,platform:n.a.powerapps,displayName:e.properties.displayName,associationType:n.d.associatedapp})));a&&o.length<200;)yield t.powerAppsHttpClient.getMoreUnifiedApps(a).then(e=>{a=e.data.nextLink,e.data.value.map(e=>o.push(new r.a({uniqueid:i+"-"+e.name,appname:e.properties.logicalName?e.properties.logicalName:e.name,status:n.b.error,platform:n.a.powerapps,displayName:e.properties.displayName,associationType:n.d.associatedapp})))});t.loggingService.logInfo("AssociatedAppsService.getInstalledPowerApps","Successfully retrieved installed power apps",{numberOfInstalledApps:o.length}),t.associatedAppsStore.setPowerApps(o)}));return function(t){return e.apply(this,arguments)}}()).then(()=>{this.loggingService.profileEndWithSuccess(s,l.a.loadInstalledPowerAppsEndProfilingEventName,{flowName:i})}).catch(e=>{this.checkEnvironmentAccessDenied(e)?this.loggingService.profileEndWithSuccess(s,l.a.loadInstalledPowerAppsEndProfilingEventName,{errorStatus:Object(c.y)(e),error:e,flowName:i}):(this.loggingService.logError("AssociatedAppsService.getInstalledPowerApps",e,{workflowUniqueId:i}),this.loggingService.profileEnd(s,l.a.loadInstalledPowerAppsEndProfilingEventName,Object(c.y)(e),e,{flowName:i}))})})}},{key:"getAssociableFlows",value:function(e){var{workflowId:t}=e,i=this.loggingService.profileStart(l.a.getAssociableFlowsStartEventName),o=this.associatedAppsStore.environmentName;return this.flowHttpClient.getAssociableFlows(o,t).then(e=>{var t=[];(e.data||[]).map(e=>t.push(new u.a({workflowid:e.workflowId,flowname:e.displayName,status:n.b.connected,platform:n.c.powerautomate,associationType:n.d.associatedflow}))),this.loggingService.logInfo("AssociatedAppsService.getAssociableFlows","Successfully retrieved associable flows",{numberOfAssociableFlows:t.length}),this.associatedAppsStore.setAssociableFlows(t)}).then(()=>{this.loggingService.profileEndWithSuccess(i,l.a.getAssociableFlowsEndEventName,{workflowId:t,solutionVersionSupported:!0})}).catch(e=>{this.checkSolutionVersionSupported(e)?this.loggingService.profileEndWithSuccess(i,l.a.getAssociableFlowsEndEventName,{workflowId:t,solutionVersionSupported:!1}):(this.loggingService.logError("AssociatedAppsService.getAssociableFlows",e,{workflowId:t}),this.loggingService.profileEnd(i,l.a.getAssociableFlowsEndEventName,Object(c.y)(e),e,{workflowId:t}))})}},{key:"getWorkflowId",value:function(e){var{workflowUniqueId:t,forceRefresh:i}=e;return this.runFirstPending({key:"getWorkflowId/flow/".concat(t,"/"),action:()=>this.xrmEntityHttpClient.retrieveMultiple("workflows",{$filter:"workflowidunique eq '".concat(t,"'"),$select:"workflowid,name"}).then(e=>{this.loggingService.logInfo("AssociatedAppsService.getWorkflowId","Successfully retrieved workflow id"),e.data.value.length>0&&this.associatedAppsStore.setWorkflowId(e.data.value[0].workflowid)}).catch(e=>(this.loggingService.logError("AssociatedAppsService.getWorkflowId",e,{workflowUniqueId:t}),Promise.reject(e)))})}},{key:"getAssociatedAppsStatus",value:function(e){var{appId:t,platform:i}=e;return i===n.a.dynamics?this.associatedAppsStore.dynamicsApps&&-1!==this.associatedAppsStore.dynamicsApps.findIndex(e=>e.appname===t)?Promise.resolve(n.b.connected):Promise.resolve(n.b.error):this.powerAppsHttpClient.getUnifiedApp({environmentName:this.associatedAppsStore.environmentName,appIdentifier:t}).then(e=>(this.loggingService.logInfo("AssociatedAppsService.getAssociatedAppsStatus","Successfully retrieved PowerApps status"),200===e.status?n.b.connected:n.b.error)).catch(e=>(this.loggingService.logError("AssociatedAppsService.getAssociatedAppsStatus",e),n.b.error))}},{key:"getFlowCapacityAssignmentId",value:function(e){var{workflowId:t}=e,i=this.loggingService.profileStart(l.a.getFlowCapacityAsssignmentIdStartEventName);return this.xrmEntityHttpClient.retrieveMultiple("flowcapacityassignments",{$filter:"_regarding_value eq '".concat(t,"'")}).then(e=>{var o;return this.associatedAppsStore.setFlowCapacityAssignmentCount((null===(o=e.data)||void 0===o||null===(o=o.value)||void 0===o?void 0:o.length)>0?parseInt(e.data.value[0].count,10):null),this.loggingService.logInfo("AssociatedAppsService.getFlowCapacityAssignmentId","Successfully retrieved flowCapacityAssignmentId"),this.loggingService.profileEndWithSuccess(i,l.a.getFlowCapacityAsssignmentIdEndEventName,{workflowId:t}),e.data.value.length>0?(this.associatedAppsStore.setIsOnProcessPlan(!0),Promise.resolve(e.data.value[0].flowcapacityassignmentid)):(this.associatedAppsStore.setIsOnProcessPlan(!1),Promise.resolve(null))}).catch(e=>(this.loggingService.logError("AssociatedAppsService.getFlowCapacityAssignmentId",e,{workflowId:t}),this.loggingService.profileEnd(i,l.a.getFlowCapacityAsssignmentIdEndEventName,Object(c.y)(e),e,{workflowId:t}),Promise.resolve(null)))}},{key:"updateIsOnProcessPlan",value:function(e){var{workflowId:t}=e,i=this.associatedAppsStore;t?this.getFlowCapacityAssignmentId({workflowId:t}).then(e=>{null!==e?i.setIsOnProcessPlan(!0):i.setIsOnProcessPlan(!1)}):i.setIsOnProcessPlan(!1)}},{key:"deleteFlowCapacityAssignments",value:function(e){var{flowCapacityAssignmentId:t}=e,i=this.loggingService.profileStart(l.a.deleteFlowCapacityAsssignmentsStartEventName);return this.xrmEntityHttpClient.deleteRecord("flowcapacityassignments",t).then(()=>{this.associatedAppsStore.setFlowCapacityAssignmentCount(null),this.loggingService.profileEndWithSuccess(i,l.a.deleteFlowCapacityAsssignmentsEndEventName,{flowCapacityAssignmentId:t})}).catch(e=>{throw this.loggingService.logError("AssociatedAppsService.deleteFlowCapacityAssignments",e,{flowCapacityAssignmentId:t}),this.loggingService.profileEnd(i,l.a.deleteFlowCapacityAsssignmentsEndEventName,Object(c.y)(e),e,{flowCapacityAssignmentId:t}),e})}},{key:"updateFlowCapacityAssignments",value:(y=f((function*(e){var{count:t,workflowId:i}=e,o=this.loggingService.profileStart(l.a.updateFlowCapacityAssignmentsStartEventName),r={count:t,capacitytype:1,"regarding_workflow@odata.bind":"/workflows(".concat(i,")")},n=yield this.getFlowCapacityAssignmentId({workflowId:i});return null!==n?this.xrmEntityHttpClient.updateRecord("flowcapacityassignments",n,r).then(e=>{this.loggingService.profileEndWithSuccess(o,l.a.updateFlowCapacityAssignmentsEndEventName,{workflowId:i,count:t})}).then(()=>{this.associatedAppsStore&&this.associatedAppsStore.setIsOnProcessPlan(!0)}).catch(e=>{throw this.loggingService.logError("EditFlowDetailsSurface.updateFlowCapacityAssignments",e,{workflowId:i}),e}):this.xrmEntityHttpClient.createRecord("flowcapacityassignments",r).then(e=>{this.loggingService.profileEndWithSuccess(o,l.a.updateFlowCapacityAssignmentsEndEventName,{workflowId:i,count:t})}).then(()=>{this.associatedAppsStore&&this.associatedAppsStore.setIsOnProcessPlan(!0)}).catch(e=>{throw this.loggingService.logError("EditFlowDetailsSurface.updateFlowCapacityAssignments",e,{workflowId:i}),this.loggingService.profileEnd(o,l.a.updateFlowCapacityAssignmentsEndEventName,Object(c.y)(e),e,{workflowId:i,count:t}),e})})),function(e){return y.apply(this,arguments)})},{key:"updateLicensee",value:function(e){var{workflowId:t,xrmSystemUserId:i}=e,o=this.loggingService.profileStart(l.a.updateLicenseeStartEventName),r={"licensee_systemuserid@odata.bind":"/systemusers(".concat(i,")")};return this.xrmEntityHttpClient.updateRecord("workflows",t,r).then(e=>{this.loggingService.profileEndWithSuccess(o,l.a.updateLicenseeEndEventName,{workflowId:t,xrmSystemUserId:i})}).then(()=>{this.associatedAppsStore.setLicensee(i)}).catch(e=>{throw this.loggingService.logError("EditFlowDetailsSurface.updateLicensee",e,{workflowId:t,xrmSystemUserId:i}),e})}},{key:"deleteLicensee",value:function(e){var{workflowId:t}=e,i=this.loggingService.profileStart(l.a.deleteLicenseeStartEventName),o={"licensee_systemuserid@odata.bind":null};return this.xrmEntityHttpClient.updateRecord("workflows",t,o).then(e=>{this.loggingService.profileEndWithSuccess(i,l.a.deleteLicenseeEndEventName,{workflowId:t})}).then(()=>{this.associatedAppsStore.setLicensee(null),this.associatedAppsStore.setLicenseePlanSectionName(null)}).catch(e=>{throw this.loggingService.logError("EditFlowDetailsSurface.deleteLicensee",e,{workflowId:t}),e})}},{key:"checkEnvironmentAccessDenied",value:function(e){var t=Object(c.cb)(e);return!!t&&t.includes("EnvironmentAccessDenied")}},{key:"checkSolutionVersionSupported",value:function(e){var t=Object(c.cb)(e);return!!t&&t.includes("GetAssociableFlowsNotSupported")}},{key:"getDisplayName",value:function(e,t){var i,o,r=t.metadata&&t.metadata.displayName;return t.linkType===n.a.dynamics?null!==(i=this.findDisplayName(e,this.associatedAppsStore.dynamicsApps))&&void 0!==i?i:r:t.linkType===n.a.powerapps&&null!==(o=this.findDisplayName(e,this.associatedAppsStore.powerApps))&&void 0!==o?o:r}},{key:"findDisplayName",value:function(e,t){var i=t.findIndex(t=>e===t.uniqueid);if(-1!==i){var o=t[i].displayName;return null!=o?o:null}return null}}])&&m(t.prototype,i),d&&m(t,d),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22860:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i(13093),r=i.n(o),n=i(11773);function s(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a(o.key),o)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uniqueid=void 0,this.appname=void 0,this.status=void 0,this.platform=void 0,this.associationType=void 0,this.displayName=void 0,Object(n.extendObservable)(this,t)}var t,i,o;return t=e,(i=[{key:"toJS",value:function(){return r()(Object(n.toJS)(this),"toJS")}}])&&s(t.prototype,i),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22861:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i(13093),r=i.n(o),n=i(11773);function s(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a(o.key),o)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workflowid=void 0,this.flowname=void 0,this.status=void 0,this.platform=void 0,this.associationType=void 0,Object(n.extendObservable)(this,t)}var t,i,o;return t=e,(i=[{key:"toJS",value:function(){return r()(Object(n.toJS)(this),"toJS")}}])&&s(t.prototype,i),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22862:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var o=new(i(22405).a)},22863:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var o=new(i(22864).a)},22864:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var o,r,n,s,a,l,c,p,u,d,f,m=i(11773),y=i(22865);function b(e,t,i,o){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(o):void 0})}function g(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,w(o.key),o)}}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function h(e,t,i,o,r){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var v=(r=h((o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"powerApps",r,this),b(this,"dynamicsApps",n,this),b(this,"numberOfAppsVisible",s,this),b(this,"selectedTabType",a,this),b(this,"searchFilter",l,this),b(this,"setPowerApps",c,this),b(this,"setDynamicsApps",p,this),b(this,"setNumberOfAppsVisible",u,this),b(this,"setSearchFilter",d,this),b(this,"setTabType",f,this),this.setDefaultTab()}var t,i,o;return t=e,(i=[{key:"powerAppsWithSearchFilter",get:function(){return this.powerApps.filter(e=>e&&this.isFilterMatched(e.appname))||[]}},{key:"dynamicsAppsWithSearchFilter",get:function(){return this.dynamicsApps.filter(e=>e&&this.isFilterMatched(e.appname))||[]}},{key:"isFilterMatched",value:function(e){return 0===this.searchFilter.length||!!e&&this.searchFilter.toLocaleLowerCase().split(" ").every(t=>e.toLocaleLowerCase().includes(t))}},{key:"setDefaultTab",value:function(){void 0===this.selectedTabType&&this.setTabType(y.b.PowerApps)}}])&&g(t.prototype,i),o&&g(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"powerApps",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n=h(o.prototype,"dynamicsApps",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=h(o.prototype,"numberOfAppsVisible",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=h(o.prototype,"selectedTabType",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(o.prototype,"searchFilter",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"setPowerApps",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.powerApps=e}}}),p=h(o.prototype,"setDynamicsApps",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dynamicsApps=e}}}),u=h(o.prototype,"setNumberOfAppsVisible",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberOfAppsVisible=e}}}),d=h(o.prototype,"setSearchFilter",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.searchFilter=e}}}),f=h(o.prototype,"setTabType",[m.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTabType=e}}}),h(o.prototype,"powerAppsWithSearchFilter",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"powerAppsWithSearchFilter"),o.prototype),h(o.prototype,"dynamicsAppsWithSearchFilter",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"dynamicsAppsWithSearchFilter"),o.prototype),o)},22865:function(e,t,i){"use strict";i.d(t,"b",(function(){return M})),i.d(t,"a",(function(){return q}));var o,r,n=i(11766),s=i(14337),a=(i(12728),i(14947)),l=i(18935),c=i(19782),p=i(14982),u=i(19777),d=i(16845),f=i(14681),m=i(19968),y=i(11773),b=i(15021),g=i(15941),w=i(22866),h=i(15995),v=i(15990),S=i(14346),A=i(19785),P=i(22870),C=i(12328),O=i.n(C),E=i(13016),k=i(22871),I=i(13031);function F(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function j(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?F(Object(i),!0).forEach((function(t){T(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):F(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function T(e,t,i){return(t=D(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function N(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,D(o.key),o)}}function D(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function R(e,t){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function L(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,o=x(e);if(t){var r=x(this).constructor;i=Reflect.construct(o,arguments,r)}else i=o.apply(this,arguments);return U(this,i)}}function U(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t,i,o,r){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var M=function(e){return e.PowerApps="Power Apps",e.Dynamics365="Dynamics 365",e.Flows="Flows",e}({}),W=function(e){return e[e.iconColumn=32]="iconColumn",e[e.displayNameColumnMin=400]="displayNameColumnMin",e[e.displayNameColumnMax=500]="displayNameColumnMax",e[e.status=16]="status",e}(W||{}),q=Object(s.c)((z((r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(s,e);var t,i,o,r=L(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=r.call(this,e)).selection=void 0,t.performUserSearchTimeout=void 0,t.onSelectionChanged=()=>{},t.onSaveConfirm=()=>{var{associatedAppsPageStore:{selectedTabType:e},clientResources:i,associatedAppsStore:o}=t.props;if(e!==M.Flows){var r=t.selection.getSelection();if(r.length>0){var s,a=t.props.associatedAppsStore.billingContextItems.slice();r.forEach(e=>{var t={linkId:null==e?void 0:e.appname,linkType:null==e?void 0:e.platform,metadata:{displayName:null==e?void 0:e.displayName}};-1===a.findIndex(t=>t.linkId===e.appname)&&a.push(t)}),null!==(s=t.props.associatedAppsStore.flowEntity)&&void 0!==s&&s.isSolutionFlow?t.props.associatedAppsService.patchAssociatedApps({apps:a,workflowUniqueId:t.props.associatedAppsStore.workflowUniqueId,workflowId:t.props.associatedAppsStore.workflowId||t.props.associatedAppsStore.flowEntity&&t.props.associatedAppsStore.flowEntity.xrmWorkflowId||""}).catch(e=>{t.setMessageBarProps(e)}).then(()=>t.props.dismiss()):t.props.associatedAppsService.putAssociatedApps({apps:a,workflowUniqueId:t.props.associatedAppsStore.workflowUniqueId}).catch(e=>{t.setMessageBarProps(e)}).then(()=>t.props.dismiss())}}else{var l=Object(k.a)(),c=t.selection.getSelection();if(c.length>0){var p=t.props.associatedAppsStore.associatedFlowsCollectionItems;if(p.length+c.length<=l)c.forEach(e=>{var t={workflowid:e.workflowid,flowname:e.flowname,status:e.status,platform:e.platform,associationType:e.associationType};-1===p.findIndex(t=>t.workflowid===e.workflowid)&&p.push(t)}),t.props.associatedAppsService.addAssociatedFlows({updatedCollection:p,workflowsToAssociate:c,entitledWorklowId:t.props.associatedAppsStore.workflowId||t.props.associatedAppsStore.flowEntity&&t.props.associatedAppsStore.flowEntity.xrmWorkflowId||""}).catch(e=>{t.setMessageBarProps(e)}).then(()=>t.props.dismiss());else{var u=Object(I.a)(i.FlowPropertyTile.AssociatedAppsTile.MessageBar.MaxFlowAssociations,l.toString());o.setMessageBarProps({ariaLabel:i.Common.Error,type:E.c.error,onRenderBody:()=>n.createElement(g.b,{interpolatedString:u,links:[{text:t.props.clientResources.Common.LearnMore,href:A.a.learnMoreProcessLicense,isUnderlinedStyle:!0,target:S.b.blank}]}),onDismiss:o.dismissMessageBar}),t.props.dismiss()}}}},t.setMessageBarProps=e=>{var{clientResources:i,associatedAppsStore:o}=t.props;o.setMessageBarProps(j(j({},Object(v.b)(e,i)),{},{onDismiss:o.dismissMessageBar}))},t.renderSegmentHandler=(e,t)=>{switch(e.type){case h.b.LITERAL:return n.createElement("span",{key:t},e.value);case h.b.PLACEHOLDER:return n.createElement("span",{key:t},n.createElement("b",null,e.value));default:return null}},t.onSearch=e=>{t.clearSearchDebounce(),setTimeout(()=>t.setState({isSearching:!1}),10),t.props.associatedAppsStore.setSearchFilter(e);var i=t.getTabDetailsForTab(t.state.currentTab);t.setState({currentTab:i.tabType,items:i.items,columns:i.columns})},t.queueOnSearch=e=>{t.clearSearchDebounce(),t.setState({isSearching:!0}),t.performUserSearchTimeout=setTimeout(()=>t.onSearch(e),10)},t.clearSearchDebounce=()=>{t.performUserSearchTimeout&&(clearTimeout(t.performUserSearchTimeout),t.performUserSearchTimeout=void 0)},t.renderDescription=()=>{var{flowAssociationCapability:e}=t.props;return n.createElement("div",null,n.createElement("span",null,n.createElement(g.b,{interpolatedString:e?t.props.clientResources.FlowPropertyTile.AddAppsTile.Description:t.props.clientResources.FlowPropertyTile.AddAppsTile.DescriptionWithoutFlows,links:[{text:t.props.clientResources.FlowPropertyTile.AddAppsTile.Documentation,href:A.a.learnMoreAssociatedApps,target:S.b.blank}]})),t.renderNavTabs())},t.onClickTab=e=>{var{associatedAppsPageStore:i}=t.props,o=t.getTabDetailsForTab(e.key);t.setState({currentTab:o.tabType,items:o.items,columns:o.columns}),i.setTabType(o.tabType)},t.onColumnClick=(e,i)=>{var{columns:o,items:r}=t.state,n=o,s=n.find(e=>i.key===e.key);O()(s,"Invalid state: currColumn was not defined."),n.forEach(e=>{e===s?(s.isSortedDescending=!s.isSortedDescending,s.isSorted=!0):(e.isSorted=!1,e.isSortedDescending=!0)});var a=function(e,t,i){var o=t;return e.slice(0).sort((e,t)=>(i?-1:1)*e[o].localeCompare(t[o]))}(r,s.fieldName,s.isSortedDescending);t.setState({columns:n,items:a})},t.state={currentTab:t.props.associatedAppsPageStore.selectedTabType,appsVisible:10,isSearching:!1,items:[],columns:[]},t.selection=new b.a({onSelectionChanged:t.onSelectionChanged}),t}return t=s,(i=[{key:"componentDidMount",value:function(){this.props.associatedAppsStore.setDynamicsAppsToAdd(),this.props.associatedAppsStore.setPowerAppsToAdd(),this.props.associatedAppsStore.setAssociateFlowsToAdd(),this.setDefaultTab();var e=this.getTabDetailsForTab(this.props.associatedAppsPageStore.selectedTabType);this.setState({currentTab:e.tabType,items:e.items,columns:e.columns})}},{key:"render",value:function(){var{clientResources:e,associatedAppsStore:t,flowAssociationCapability:i}=this.props;return n.createElement(a.a,{isOpen:!0,title:i?e.FlowPropertyTile.AddAppsTile.Title:e.FlowPropertyTile.AddAppsTile.TitleWithoutFlows,onDismissed:this.props.dismiss,onRenderSubHeader:this.renderDescription,footerButtons:[this.saveButtonProps,this.cancelButtonProps]},n.createElement(f.a,{placeholder:this.state.currentTab===M.Flows?e.FlowPropertyTile.AddAppsTile.SearchFlowsPlaceholder:e.FlowPropertyTile.AddAppsTile.SearchPlaceholder,value:t.searchFilter,onSearch:this.onSearch,onChange:this.queueOnSearch,onClear:()=>{this.onSearch(""),this.setState({isSearching:!1,appsVisible:10})}}),this.renderContent())}},{key:"saveButtonProps",get:function(){return{disabled:this.props.associatedAppsStore.readOnly,dismissableOnClick:this.onSaveConfirm,primary:!0,text:this.props.clientResources.Common.Save}}},{key:"cancelButtonProps",get:function(){return{disabled:this.props.associatedAppsStore.readOnly,dismissableOnClick:this.props.dismiss,primary:!1,text:this.props.clientResources.Common.Cancel}}},{key:"renderZeroAssociatedEntitiesContent",value:function(){var{clientResources:e,associatedAppsPageStore:t}=this.props,i=t.selectedTabType===M.Flows?e.FlowPropertyTile.ZeroFlowsToAssociate.Text:e.FlowPropertyTile.ZeroInstalledApps.Text;return n.createElement(h.a,{formatText:i,onRenderSegment:this.renderSegmentHandler})}},{key:"renderNotProcessFlowContent",value:function(){var{clientResources:e}=this.props,t=e.FlowPropertyTile.ZeroFlowsToAssociate.NotProcessFlow;return n.createElement(g.b,{interpolatedString:t,links:[{text:this.props.clientResources.Common.LearnMore,href:A.a.learnMoreProcessCapacityAllocation,isUnderlinedStyle:!0,target:S.b.blank}]})}},{key:"renderContent",value:function(){var e=j({},this.getDetailsListProps());return e.items?this.props.associatedAppsPageStore.selectedTabType!==M.Flows||this.props.associatedAppsStore.isOnProcessPlan||this.props.associatedAppsStore.isOnMachineLicense?e.items.length>0?n.createElement(d.a,e):this.renderZeroAssociatedEntitiesContent():this.renderNotProcessFlowContent():n.createElement(n.Fragment,null)}},{key:"getDetailsListProps",value:function(){var{columns:e,items:t}=this.state;return{columns:e,items:t,selection:this.selection,singleSelectionMode:!1}}},{key:"renderNavTabs",value:function(){return n.createElement("div",null,n.createElement(m.a,this.pageTabProps))}},{key:"setDefaultTab",value:function(){var{associatedAppsPageStore:e}=this.props;void 0===e.selectedTabType&&e.setTabType(M.PowerApps)}},{key:"pageTabProps",get:function(){var{clientResources:e,associatedAppsPageStore:t,associatedAppsStore:i,processMinSolutionVersion:o,flowAssociationCapability:r}=this.props,n=t.selectedTabType,s=n||M.PowerApps;return o&&i.workflowId&&r?{selectedTabKey:s,tabs:[{key:M.PowerApps,text:"".concat(e.FlowPropertyTile.AddAppsTile.PowerApps),onClick:this.onClickTab},{key:M.Dynamics365,text:"".concat(e.FlowPropertyTile.AddAppsTile.Dynamics365),onClick:this.onClickTab},{key:M.Flows,text:"".concat(e.FlowPropertyTile.AddAppsTile.Flows),onClick:this.onClickTab}]}:{selectedTabKey:s,tabs:[{key:M.PowerApps,text:"".concat(e.FlowPropertyTile.AddAppsTile.PowerApps),onClick:this.onClickTab},{key:M.Dynamics365,text:"".concat(e.FlowPropertyTile.AddAppsTile.Dynamics365),onClick:this.onClickTab}]}}},{key:"getTabDetailsForTab",value:function(e){var{associatedAppsStore:{powerAppsWithSearchFilter:t,dynamicsAppsWithSearchFilter:i,associateFlowsWithSearchFilter:o}}=this.props;switch(e){case M.PowerApps:return{columns:this.getColumns(),items:t,tabType:M.PowerApps};case M.Dynamics365:return{columns:this.getColumns(),items:i,tabType:M.Dynamics365};case M.Flows:return{columns:this.getFlowColumns(),items:o,tabType:M.Flows};default:return{columns:this.getColumns(),items:t,tabType:M.PowerApps}}}},{key:"getColumns",value:function(){var{clientResources:e}=this.props;return[{key:w.a.icon,name:"",fieldName:w.a.icon,minWidth:W.iconColumn,maxWidth:W.iconColumn,isRowHeader:!0,columnActionsMode:p.b.disabled,onRender:e=>n.createElement(c.a,{item:e})},{key:w.a.displayName,name:e.ListHeader.Name,fieldName:w.a.displayName,minWidth:W.displayNameColumnMin,maxWidth:W.displayNameColumnMax,isRowHeader:!0,onRender:e=>n.createElement(u.b,{item:e,addAppsSurface:!0}),onColumnClick:this.onColumnClick}]}},{key:"getFlowColumns",value:function(){var{clientResources:e}=this.props;return[{key:w.a.icon,name:"",fieldName:w.a.icon,minWidth:W.iconColumn,maxWidth:W.iconColumn,isRowHeader:!0,columnActionsMode:p.b.disabled,onRender:e=>n.createElement(c.b,{item:e})},{key:w.a.displayName,name:e.ListHeader.Name,fieldName:w.a.flowname,minWidth:W.displayNameColumnMin,maxWidth:W.displayNameColumnMax,isRowHeader:!0,onRender:e=>n.createElement(P.a,{item:e,addAppsSurface:!0}),onColumnClick:this.onColumnClick}]}}])&&N(t.prototype,i),o&&N(t,o),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.Component)).prototype,"saveButtonProps",[y.computed],Object.getOwnPropertyDescriptor(r.prototype,"saveButtonProps"),r.prototype),z(r.prototype,"cancelButtonProps",[y.computed],Object.getOwnPropertyDescriptor(r.prototype,"cancelButtonProps"),r.prototype),z(r.prototype,"pageTabProps",[y.computed],Object.getOwnPropertyDescriptor(r.prototype,"pageTabProps"),r.prototype),o=r))||o;Object(l.b)((e,t)=>j({clientResources:e.clientResources,associatedAppsPageStore:e.associatedAppsPageStore,associatedAppsStore:e.associatedAppsStore,associatedAppsService:e.associatedAppsService},t))(q)},22866:function(e,t,i){"use strict";i.d(t,"a",(function(){return Q})),i.d(t,"b",(function(){return oe}));var o,r,n,s,a,l,c=i(11773),p=i(14337),u=i(11766),d=i(12706),f=i(12728),m=i(21946),y=i(14900),b=i(18935),g=i(13272),w=i(22405),h=i(14657),v=i(19878),S=i(15021),A=i(22865),P=i(19779),C=i(14982),O=i(12754),E=i(19777),k=i(22738),I=i(19782),F=i(19783),j=i(16845),T=i(19778),N=i(22867),D=i(22868),R=i(19785),L=i(14346),U=i(13120),x=i(22831),z=i(22869);function M(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function W(e,t,i){return(t=_(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function q(e,t,i,o,r,n,s){try{var a=e[n](s),l=a.value}catch(c){return void i(c)}a.done?t(l):Promise.resolve(l).then(o,r)}function B(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var n=e.apply(t,i);function s(e){q(n,o,r,s,a,"next",e)}function a(e){q(n,o,r,s,a,"throw",e)}s(void 0)}))}}function H(e,t,i,o){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(o):void 0})}function V(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_(o.key),o)}}function _(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function K(e,t){return(K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,o=$(e);if(t){var r=$(this).constructor;i=Reflect.construct(o,arguments,r)}else i=o.apply(this,arguments);return J(this,i)}}function J(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return G(e)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t,i,o,r){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var Q=function(e){return e.icon="icon",e.displayName="displayName",e.platform="platform",e.status="status",e.flowname="flowname",e}({}),X=function(e){return e[e.rowHeaderMax=480]="rowHeaderMax",e[e.rowHeaderMin=220]="rowHeaderMin",e[e.commonMax=204]="commonMax",e[e.commonMin=48]="commonMin",e}({}),ee=function(e){return e.addApps="Add apps",e.deleteApps="Delete apps",e}({}),te=function(e){return e.flowDisplayName="flowDisplayName",e.associatedAppsText="associatedAppsText",e}({}),ie=Object(p.c)((r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(c,e);var t,i,o,r=Z(c);function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this,e)).getPageClassNames=Object(d.a)(),t.getClassNames=Object(d.a)(),t.pageClassNames=t.getPageClassNames(N.a),t.classNames=t.getClassNames(T.a),t.workflowUniqueId=void 0,t.environmentName=void 0,t.solutionId=void 0,t.selection=void 0,H(t,"associatedAppsCollection",n,G(t)),H(t,"associatedFlowsCollection",s,G(t)),H(t,"selectedColumn",a,G(t)),t.loadAssociatedEntities=()=>{var{associatedAppsStore:e,associatedAppsService:i}=t.props;return i.getInstalledDynamicsApps({workflowUniqueId:t.workflowUniqueId}).then(()=>i.getInstalledPowerApps({workflowUniqueId:t.workflowUniqueId})).then(()=>{e.workflowId&&t.state.processLicenseAssignmentSolutionCapability&&i.getAssociableFlows({workflowId:e.workflowId})}).then(()=>t.loadAssociatedApps(t.workflowUniqueId)).then(()=>{t.setAssociatedAppsCollection(t.getAssociatedAppsCollection(t.workflowUniqueId))}).then(()=>{var o=e.workflowId;o&&t.state.processLicenseAssignmentSolutionCapability&&i.getAssociatedFlows({entitledWorklowId:o}).then(()=>{t.setAssociatedFlowsCollection(t.getAssociatedFlowsCollection(o))})}).then(()=>e.setEntityCollectionItems())},t.loadAssociatedApps=e=>t.props.associatedAppsService.getAssociatedApps({workflowUniqueId:e}),H(t,"setSelectedColumn",l,G(t)),t.processLicenseMinSolutionCapability=B((function*(){var{environmentStore:e,environmentCapabilityStore:i,environmentCapabilityService:o}=t.props;return yield o.getProcessLicenseAssignmentSolutionCapability().then(()=>{var o=e.currentEnvironmentName,r=i.isCapabilitySupported(o,U.b.isProcessLicenseAssignmentSolutionAvailable),n=Object(x.a)(),s=Object(z.a)();t.setState({processLicenseAssignmentSolutionCapability:r&&n,flowAssociationCapability:s})})})),t.onRenderIcon=e=>"uniqueid"in e?u.createElement(I.a,{item:e}):u.createElement(I.b,{item:e}),t.onRenderName=e=>"uniqueid"in e?u.createElement(E.a,{item:e,addAppsSurface:!1,onDeleteSuccess:t.onDeleteSuccess}):u.createElement(E.e,{item:e,addAppsSurface:!1,onDeleteSuccess:t.onDeleteSuccess}),t.onRenderPlatform=e=>"uniqueid"in e?u.createElement(E.c,{item:e}):u.createElement(E.f,{item:e}),t.onRenderStatus=e=>u.createElement(F.a,{item:e,includeName:!0,clientResources:t.props.clientResources,learnWhy:t.props.clientResources.Common.LearnWhy}),t.onSelectionChanged=()=>{var e=t.selection.getSelection();t.setState({currentSelections:e})},t.renderDetailsList=()=>u.createElement("div",{className:t.classNames.detailsList},u.createElement(j.a,t.detailsListProps)),t.getAssociatedAppsCollection=e=>{var i;return null===(i=t.props.associatedAppsStore.associatedApps)||void 0===i?void 0:i.getCollection(w.a.getAssociatedAppsCollectionType({objectId:e}))},t.getAssociatedFlowsCollection=e=>{var i;return null===(i=t.props.associatedAppsStore.associatedFlows)||void 0===i?void 0:i.getCollection(w.a.getAssociatedFlowsCollectionType({objectId:e}))},t.renderPageHeader=()=>u.createElement(v.a,t.getPageHeaderProps()),t.getPageHeaderProps=()=>{var e,i,{clientResources:o}=t.props;return{breadcrumbProps:{items:[{key:te.flowDisplayName,text:null!==(e=null===(i=t.props.associatedAppsStore.flowEntity)||void 0===i?void 0:i.displayName)&&void 0!==e?e:"",href:Object(y.m)(t.props.routeCrafter,{flowName:t.workflowUniqueId,solutionId:t.solutionId,isLegacyShared:!1}),onClick:()=>t.navigateToFlowDetails()},{key:te.associatedAppsText,text:o.FlowPropertyTile.AssociatedAppsTile.Title,href:Object(y.j)(t.props.routeCrafter,{flowName:t.workflowUniqueId,solutionId:t.solutionId}),isCurrentItem:!0}]}}},t.renderMessageBar=()=>u.createElement(D.a,{associatedAppsStore:t.props.associatedAppsStore}),t.navigateToFlowDetails=()=>{t.props.navigationService.navigate(Object(y.m)(t.props.routeCrafter,{flowName:t.workflowUniqueId,solutionId:t.solutionId,isLegacyShared:!1}))},t.getSidePanel=()=>{var{isAddAppsPanelOpen:e}=t.state;return e?u.createElement(A.a,{clientResources:t.props.clientResources,dismiss:t.onDismiss,items:t.props.associatedAppsStore.appCollectionItems,surfaceKey:Object(f.a)("associated-apps-list-surface"),environmentName:t.environmentName,associatedAppsStore:t.props.associatedAppsStore,associatedAppsPageStore:t.props.associatedAppsPageStore,associatedAppsService:t.props.associatedAppsService,processMinSolutionVersion:t.state.processLicenseAssignmentSolutionCapability,flowAssociationCapability:t.state.flowAssociationCapability}):u.createElement(u.Fragment,null)},t.onDismiss=()=>{t.setState({isAddAppsPanelOpen:!1})},t.getCommandBarProps=()=>{var{clientResources:e}=t.props,i=[];return i=[{iconProps:{iconName:g.a.Add},key:ee.addApps,name:e.FlowPropertyTile.AssociatedAppsTile.Commands.Add,onClick:()=>{t.setState({isAddAppsPanelOpen:!0})}}],t.state.currentSelections.length>0&&i.push({iconProps:{iconName:g.a.Delete},key:ee.deleteApps,name:e.FlowPropertyTile.AssociatedAppsTile.Commands.Remove,onClick:()=>{t.setState({isDeleteBoxOpen:!0}),Object(P.a)(t.props.surfaceStore,t.onDeleteSuccess,t.selection.getSelection())}}),{items:i}},t.renderAssociatedAppsCommandBar=()=>u.createElement(h.a,t.getCommandBarProps()),t.onDeleteSuccess=()=>{t.setState({isDeleteBoxOpen:!1}),t.setState({currentSelections:[]})};var{match:{params:{environmentName:i,flowName:o,solutionId:p}}}=e;return t.state={isAddAppsPanelOpen:!1,isDeleteBoxOpen:!1,currentSelections:[],collectionItems:[],columns:t.detailListColumns,sort:new Map([[Q.icon,!1],[Q.displayName,!1],[Q.platform,!1]]),processLicenseAssignmentSolutionCapability:!1,flowAssociationCapability:!1},t.selection=new S.a({onSelectionChanged:t.onSelectionChanged}),t.workflowUniqueId=null!=o?o:"",t.solutionId=null!=p?p:"",t.environmentName=null!=i?i:"",t.props.associatedAppsPageStore.setNumberOfAppsVisible(5),t.props.associatedAppsStore.dismissMessageBar(),t.environmentName&&t.props.associatedAppsStore.setEnvironmentName(t.environmentName),t}return t=c,(i=[{key:"componentDidMount",value:function(){var{flowStore:e,associatedAppsStore:t,associatedAppsService:i}=this.props;this.props.flowService.loadFlow(this.workflowUniqueId,!0,void 0,void 0,!1,!0).then(()=>this.processLicenseMinSolutionCapability()).then(()=>this.props.associatedAppsStore.setAppCollectionItems()).then(()=>{t.setFlowEntity(e.getFlowEntityWithFallbackBehavior(this.workflowUniqueId))}).then(()=>{var i,o=null===(i=e.getFlowEntityWithFallbackBehavior(this.workflowUniqueId))||void 0===i?void 0:i.xrmWorkflowId;o?t.setWorkflowId(o):t.setWorkflowId(null)}).then(()=>{this.state.processLicenseAssignmentSolutionCapability&&i.updateIsOnProcessPlan({workflowId:t.workflowId})}).then(()=>{t.setWorkflowUniqueId(this.workflowUniqueId)}).then(()=>{this.loadAssociatedEntities()})}},{key:"render",value:function(){return u.createElement(m.a,{className:this.classNames.detailsList,isLoading:this.isLoading,renderCommandBar:this.renderAssociatedAppsCommandBar,renderDetailsList:this.renderDetailsList,renderPageHeader:this.renderPageHeader,onRenderSidePane:this.getSidePanel,renderMessageBar:this.renderMessageBar})}},{key:"setAssociatedAppsCollection",value:function(e){this.associatedAppsCollection=e}},{key:"setAssociatedFlowsCollection",value:function(e){this.associatedFlowsCollection=e}},{key:"detailListColumns",get:function(){var{clientResources:e}=this.props;return[{className:"fl-IconCell",columnActionsMode:C.b.disabled,fieldName:k.b.icon,isIconOnly:!0,iconClassName:"fl-IconCellHeaderIcon",iconName:g.a.Flow,key:Q.icon,minWidth:40,maxWidth:40,name:e.ListHeader.Icon,onRender:this.onRenderIcon},{className:j.b.reset,columnActionsMode:C.b.disabled,fieldName:Q.displayName,key:Q.displayName,minWidth:X.rowHeaderMin,maxWidth:X.rowHeaderMax,name:e.ListHeader.Name,onRender:this.onRenderName},{columnActionsMode:C.b.disabled,fieldName:Q.platform,key:Q.platform,minWidth:X.commonMin,maxWidth:X.commonMax,name:e.ListHeader.Platform,onRender:this.onRenderPlatform},{columnActionsMode:C.b.disabled,fieldName:Q.status,key:Q.status,minWidth:X.commonMin,maxWidth:X.commonMax,name:e.ListHeader.Status,onRender:this.onRenderStatus}]}},{key:"detailsListProps",get:function(){var{clientResources:e,associatedAppsStore:t}=this.props;return{checkButtonAriaLabel:e.Common.RowSelectionAriaLabel,columns:this.state.columns,emptyProps:this.emptyProps,isLoading:!1,items:t.entityCollectionItems,selection:this.selection,singleSelectionMode:!1,getKey:e=>"uniqueid"in e?e.uniqueid:e.workflowid}}},{key:"emptyProps",get:function(){var{clientResources:e}=this.props;return{message:this.state.flowAssociationCapability?e.FlowPropertyTile.ZeroAssociatedAppOrFlow.Text:e.FlowPropertyTile.ZeroAssociatedApp.Text,learnMoreAriaLabel:this.props.clientResources.Common.LearnMore,learnMoreProps:{text:this.props.clientResources.Common.LearnMore,href:R.a.learnMoreAssociatedApps,style:{color:Object(O.Y)().palette.themePrimary,textDecoration:"underline"},target:L.b.blank},buttonText:e.FlowPropertyTile.AssociatedAppsTile.Commands.Add,buttonProps:{iconProps:{iconName:g.a.Add},key:ee.addApps,name:e.FlowPropertyTile.AssociatedAppsTile.Commands.Add,onClick:()=>{this.setState({isAddAppsPanelOpen:!0})}},styles:this.pageClassNames}}},{key:"isLoading",get:function(){return this.state.processLicenseAssignmentSolutionCapability?!(this.associatedAppsCollection&&!this.associatedAppsCollection.isCollectionLoading&&(null===this.props.associatedAppsStore.workflowId||this.associatedFlowsCollection&&!this.associatedFlowsCollection.isCollectionLoading)):!this.associatedAppsCollection||!!this.associatedAppsCollection.isCollectionLoading}}])&&V(t.prototype,i),o&&V(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(u.Component),n=Y(r.prototype,"associatedAppsCollection",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Y(r.prototype,"associatedFlowsCollection",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Y(r.prototype,"selectedColumn",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Y(r.prototype,"setSelectedColumn",[c.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedColumn=e}}}),Y(r.prototype,"setAssociatedAppsCollection",[c.action],Object.getOwnPropertyDescriptor(r.prototype,"setAssociatedAppsCollection"),r.prototype),Y(r.prototype,"setAssociatedFlowsCollection",[c.action],Object.getOwnPropertyDescriptor(r.prototype,"setAssociatedFlowsCollection"),r.prototype),Y(r.prototype,"detailListColumns",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"detailListColumns"),r.prototype),Y(r.prototype,"detailsListProps",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"detailsListProps"),r.prototype),Y(r.prototype,"emptyProps",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"emptyProps"),r.prototype),Y(r.prototype,"isLoading",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLoading"),r.prototype),o=r))||o,oe=Object(b.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?M(Object(i),!0).forEach((function(t){W(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):M(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({appSettings:e.appSettings,clientResources:e.clientResources,featureFlags:e.featureFlags,loggingService:e.loggingService,routeCrafter:e.routeCrafter,surfaceStore:e.surfaceStore,telemetryService:e.telemetryService,associatedAppsService:e.associatedAppsService,associatedAppsStore:e.associatedAppsStore,flowService:e.flowService,flowStore:e.flowStore,navigationService:e.navigationService,associatedAppsPageStore:e.associatedAppsPageStore,environmentCapabilityStore:e.environmentCapabilityStore,environmentStore:e.environmentStore,environmentCapabilityService:e.environmentCapabilityService},t))(ie)},22867:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var o=e=>({primaryMessage:["ba-EmptyState-PrimaryMessage",{fontSize:20,fontWeight:600,textAlign:"center",margin:0,marginBottom:16,width:"200%"}]})},22868:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var o,r=i(14337),n=i(11766),s=i.n(n),a=i(13016);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,p(o.key),o)}}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,o=m(e);if(t){var r=m(this).constructor;i=Reflect.construct(o,arguments,r)}else i=o.apply(this,arguments);return f(this,i)}}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=Object(r.c)(o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(n,e);var t,i,o,r=d(n);function n(){return l(this,n),r.apply(this,arguments)}return t=n,(i=[{key:"render",value:function(){var{associatedAppsStore:{messageBarProps:e}}=this.props;return e?s.a.createElement(a.a,e):null}}])&&c(t.prototype,i),o&&c(t,o),Object.defineProperty(t,"prototype",{writable:!1}),n}(s.a.Component))||o},22869:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i(11809),r=i(11896),n=Object(r.a)({teamName:o.a.PowerAutomateClientTeam,owners:["flowmoney@microsoft.com"],description:"Enables the per process flow association",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1463221",createdOn:"10/29/2024",fallback:{FlowAssociationPanelEnabled:!1}}),{getFeatureValue:s}=Object(r.b)(n,e=>!!e.FlowAssociationPanelEnabled)},22870:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var o,r,n=i(11766),s=i(14337),a=i(18935),l=i(12706),c=i(12728),p=i(19778),u=i(16889),d=i(13272),f=i(11773),m=i(14682),y=i(13260);function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function g(e,t,i){return(t=v(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,v(o.key),o)}}function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var i,o=C(e);if(t){var r=C(this).constructor;i=Reflect.construct(o,arguments,r)}else i=o.apply(this,arguments);return P(this,i)}}function P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,i,o,r){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,o){return o(e,t,i)||i}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var E=function(e){return e.delete="delete",e}({}),k=Object(s.c)((O((r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(s,e);var t,i,o,r=A(s);function s(){var e;w(this,s);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return(e=r.call(this,...i)).getClassNames=Object(l.a)(),e.tooltipId=Object(c.a)("fl-AddAssociatedFlowNameCell-tooltip"),e.renderContent=()=>{var t=e.getClassNames(p.a),i=e.props.item.flowname;return n.createElement(y.b,{id:e.tooltipId,text:e.props.item.flowname},n.createElement("div",{className:t.nameCell},i?n.createElement("span",{title:i},i):n.createElement("span",{title:e.props.item.flowname},e.props.item.flowname)))},e}return t=s,(i=[{key:"render",value:function(){var e=this.getClassNames(p.a),t={actions:this.actionMenuItems,globallyUniquePrefix:this.props.item.workflowid,overflowActions:void 0};return n.createElement("div",{className:e.contentWithActionMenuCell},this.renderContent(),!this.props.addAppsSurface&&n.createElement(u.a,t))}},{key:"actionMenuItems",get:function(){return[this.deleteCommand]}},{key:"deleteCommand",get:function(){return{iconProps:{iconName:d.a.Delete},key:E.delete,name:this.props.clientResources.Flow.Commands.Delete,[m.a]:"".concat(E.delete)}}}])&&h(t.prototype,i),o&&h(t,o),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.Component)).prototype,"actionMenuItems",[f.computed],Object.getOwnPropertyDescriptor(r.prototype,"actionMenuItems"),r.prototype),O(r.prototype,"deleteCommand",[f.computed],Object.getOwnPropertyDescriptor(r.prototype,"deleteCommand"),r.prototype),o=r))||o,I=Object(a.b)((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({telemetryService:e.telemetryService,routeCrafter:e.routeCrafter,clientResources:e.clientResources,surfaceStore:e.surfaceStore,associatedAppsPageStore:e.associatedAppsPageStore},t))(k)},22871:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i(11809),r=i(11896),n=Object(r.a)({teamName:o.a.PowerAutomateClientTeam,owners:["flowmoney@microsoft.com"],description:"Sets the maximum number of flows that can be associated to a process flow",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1451396",createdOn:"10/9/2024",fallback:{maxFlowAssociationsAmount:35}}),{getFeatureValue:s}=Object(r.b)(n,"maxFlowAssociationsAmount")}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/desktop-flows~flowPag~4c102bbe.7930ddaf.chunk.js.map