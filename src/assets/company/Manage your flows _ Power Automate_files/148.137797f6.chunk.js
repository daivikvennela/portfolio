/*! For license information please see 148.137797f6.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{14258:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n=r(11804);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function c(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=function(e){return e.approvalsAppApprovalsTab="approvalsAppApprovalsTab",e.createTabFullEditor="createTabFullEditor",e.createTabNL2FlowFullDesigner="createTabNL2FlowFullDesigner",e.createTabTemplateEditor="createTabTemplateEditor",e.createTabTemplatesList="createTabTemplatesList",e.homeTabFlowDetails="homeTabFlowDetails",e.homeTabFlowRunDetails="homeTabFlowRunDetails",e.homeTabFlowsList="homeTabFlowsList",e}({}),l=c((function e(t,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hostCommunicationService=t,this.loggingService=r,this.widgetUtilService=i,this.goToApprovalsAppApprovalsTab=()=>{this.loggingService.logInfo("TeamsDeepLinkService.goToApprovalsAppApprovalsTab",'Initiating deep link to the "approvals" tab in the Approvals app');var e={scenario:u.approvalsAppApprovalsTab};this.hostCommunicationService.triggerHostEvent(n.e.EXECUTE_TEAMS_DEEP_LINK,e)},this.goToHomeTabFlowsList=()=>{this.loggingService.logInfo("TeamsDeepLinkService.goToHomeTabFlowsList",'Initiating deep link to the "home" tab flows list');var e={scenario:u.homeTabFlowsList};this.hostCommunicationService.triggerHostEvent(n.e.EXECUTE_TEAMS_DEEP_LINK,e)},this.goToHomeTabFlowDetails=e=>{this.loggingService.logInfo("TeamsDeepLinkService.goToHomeTabFlowDetails",'Initiating deep link to the "home" tab flow details page');var t=o({scenario:u.homeTabFlowDetails},e);this.hostCommunicationService.triggerHostEvent(n.e.EXECUTE_TEAMS_DEEP_LINK,t)},this.goToCreateTabFullEditor=()=>{this.loggingService.logInfo("TeamsDeepLinkService.goToCreateTabFullEditor",'Initiating deep link to the "create" tab flow editor page');var e={scenario:u.createTabFullEditor};this.hostCommunicationService.triggerHostEvent(n.e.EXECUTE_TEAMS_DEEP_LINK,e)},this.goToCreateTabNL2FlowFullDesigner=()=>{this.loggingService.logInfo("TeamsDeepLinkService.goToCreateTabNL2FlowFullDesigner",'Initiating deep link to the "create" tab NL2Flow full designer page');var e={scenario:u.createTabNL2FlowFullDesigner};this.widgetUtilService.isWidgetPage()&&(e.sessionId=this.widgetUtilService.widgetInfo.sessionId,e.campaign=this.widgetUtilService.widgetInfo.campaign),this.hostCommunicationService.triggerHostEvent(n.e.EXECUTE_TEAMS_DEEP_LINK,e)},this.goToCreateTabTemplateEditor=e=>{this.loggingService.logInfo("TeamsDeepLinkService.goToCreateTabTemplateEditor",'Initiating deep link to the "create" tab template editor page');var t=o({scenario:u.createTabTemplateEditor},e);this.hostCommunicationService.triggerHostEvent(n.e.EXECUTE_TEAMS_DEEP_LINK,t)},this.goToCreateTabTemplatesList=()=>{this.loggingService.logInfo("TeamsDeepLinkService.goToCreateTabTemplatesList",'Initiating deep link to the "create" tab template list');var e={scenario:u.createTabTemplatesList};this.hostCommunicationService.triggerHostEvent(n.e.EXECUTE_TEAMS_DEEP_LINK,e)}}))},18814:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(12345),i=r(18815),o=r(18826),a=r(13087),s=r(18834),c=new i.a(n.a,o.a,a.a,s.a)},18826:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(13192),i=r(18827),o=r(13e3),a=r(12339),s=r(13077),c=r(13087),p=r(14688),u=new i.AiHostedModelsHttpClient(Object(a.b)(),new n.HttpClient,p.a,c.a,s.a,o.a)},18834:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(13192),i=r(13e3),o=r(13087),a=r(13077),s=r(12345),c=new(r(18835).a)(o.a,new n.HttpClient,i.a,s.a,a.a)},19891:function(e,t,r){"use strict";r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return b}));var n,i,o=r(11773),a=r(12347);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var p,u,l,g,f,d,m=function(e){return e.all="all",e.automated="automated",e.instant="instant",e}({}),b=(n=function(){function e(){var t,r,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,r="designerOperations",s=this,(n=i)&&Object.defineProperty(t,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(s):void 0}),Object(o.runInAction)(()=>{this.designerOperations=new a.a({getKey:t=>e.getOperationKey(t.operationGroupName,t.name),defaultCollectionTypes:[e.getTriggerCollectionKey(m.all),e.getTriggerCollectionKey(m.automated),e.getTriggerCollectionKey(m.instant),e.getTriggerSearchCollectionKey(m.all),e.getTriggerSearchCollectionKey(m.automated),e.getTriggerSearchCollectionKey(m.instant),e.getActionCollectionKey(),e.getActionSearchCollectionKey()]})})}var t,r,n;return t=e,n=[{key:"getActionCollectionKey",value:function(){return"actions"}},{key:"getActionSearchCollectionKey",value:function(){return"actionSearch"}},{key:"getTriggerCollectionKey",value:function(e){return"triggers-".concat(e)}},{key:"getTriggerSearchCollectionKey",value:function(e){return"triggerSearch-".concat(e)}},{key:"getOperationKey",value:function(e,t){return"".concat(e,"-").concat(t).toUpperCase()}}],(r=null)&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),p=n.prototype,u="designerOperations",l=[o.observable],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(g).forEach((function(e){d[e]=g[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(p,u,e)||e}),d),f&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(f):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(p,u,d),d=null),i=d,n)},19906:function(e,t,r){"use strict";r.d(t,"b",(function(){return C})),r.d(t,"a",(function(){return L}));var n=r(19907),i=r(14751),o=r.n(i),a=r(19908),s=r(19909),c=r(19910),p=r(19911),u=r(19912),l=r(19913),g=r(19914),f=r(19915),d=r(19916),m=r(19917),b=r(19918),h=r(19919),v=r(19920),y=r(19921),O=r(12339),T=r(14875),w=r(19922),j=r(19929);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C=n.b.triggerIds.recurrence,N=n.b.triggerIds.request,D={[n.b.triggerIds.flowButton]:a,[n.b.triggerIds.http]:s,[n.b.triggerIds.httpWebhook]:c,[n.b.triggerIds.powerAppsButton]:p,[n.b.triggerIds.powerAppsButtonV2]:u,[n.b.triggerIds.recurrence]:l,[n.b.triggerIds.request]:g,[n.b.triggerIds.virtualAgent]:f,[n.b.triggerIds.skillsButton]:m,[n.b.triggerIds.teamsIncomingWebhookTrigger]:b},A={[n.b.triggerIds.flowButton]:h,[n.b.triggerIds.powerAppsButtonV2]:y,[n.b.triggerIds.teamsIncomingWebhookTrigger]:v,[n.b.triggerIds.skillsButton]:m,[n.b.triggerIds.virtualAgent]:d},L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.recurrenceOptions=void 0,this.setRecurrenceTriggerOptions=e=>{this.recurrenceOptions=e}}var t,r,n;return t=e,n=[{key:"requiresDefinition",value:function(e){return e in D}}],(r=[{key:"getDefinitionForTrigger",value:function(e,t){if(e===N)return this.getRequestDefinition();var r=t?A:{},n=P(P({},D),r);return e===C?this.getRecurrenceDefinition(this.recurrenceOptions):o()(n[e])}},{key:"getFlowWorkflowDataWithTrigger",value:function(e,t){if(Object(w.c)(t))return this.getFlowWorkflowDataWithHybridTrigger(e,t);var r=t.properties.summary.replace(/ /g,"_"),n=t.properties.operationGroup;return{definition:{$schema:Object(O.l)(e).definitionSchemaUri,contentVersion:"1.0.0.0",actions:{},triggers:{[r]:{type:t.properties.operationType,kind:"NotSpecified"===t.properties.operationKind?void 0:t.properties.operationKind,inputs:{host:{apiId:Object(T.b)(e,n.id),connectionName:n.name,operationId:t.name}},splitOn:"@autoload()"}},parameters:{},outputs:{}},connectionReferences:{[n.name]:{id:Object(T.b)(e,n.id)}}}}},{key:"getFlowWorkflowDataWithHybridTrigger",value:function(e,t){var r,n,i,o=t.properties.summary.replace(/ /g,"_"),a=t.properties.operationGroup,s=(null===(r=t.properties.manifest)||void 0===r||null===(r=r.inputs)||void 0===r||null===(r=r.properties)||void 0===r||null===(r=r.operationId)||void 0===r?void 0:r.default)||j.d[t.id.toUpperCase()],c={definition:{$schema:Object(O.l)(e).definitionSchemaUri,contentVersion:"1.0.0.0",actions:{},triggers:{[o]:{type:t.properties.operationType,kind:t.properties.operationKind,inputs:{operationId:s,parameters:{},schema:{rows:{type:"array",items:{type:"object",properties:{},required:[]}}},host:{connection:{name:"@parameters('$connections')['".concat(a.name,"']['connectionId']")}}}}},parameters:{},outputs:{}},connectionReferences:{[a.name]:{id:Object(T.b)(e,a.id)}}},p=null!==(n=null===(i=t.properties.manifest)||void 0===i||null===(i=i.inputs)||void 0===i||null===(i=i.properties)||void 0===i||null===(i=i.parameters)||void 0===i?void 0:i.properties)&&void 0!==n?n:{};return Object.keys(p).forEach(e=>{var t=p[e];c.definition.triggers[o].inputs.parameters[e]=t.default?t.default:""}),a.id.includes(j.a.SHARED_TEAMS)&&Object.keys(j.e).includes(s.toUpperCase())||(c.definition.triggers[o].splitOn="@triggerBody()['rows']"),c}},{key:"getRequestDefinition",value:function(){var e=o()(D[N]);return e.definition.triggers.manual.inputs={triggerAuthenticationType:"Tenant"},e}},{key:"getRecurrenceDefinition",value:function(e){var t=o()(D[C]);return e&&(t.definition.triggers.Recurrence.recurrence={frequency:e.frequency,interval:e.interval,startTime:e.startDateTime,schedule:"Week"===e.frequency?{weekDays:e.weekDays}:void 0}),t}}])&&k(t.prototype,r),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},19908:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"Button"}}}}')},19909:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"HTTP":{"type":"Http"}}}}')},19910:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"HTTP_Webhook":{"inputs":{"subscribe":{"method":"","uri":""},"unsubscribe":{}},"type":"HttpWebhook"}}}}')},19911:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"PowerApp"}}}}')},19912:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"PowerAppV2"}}}}')},19913:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"Recurrence":{"type":"Recurrence","recurrence":{"frequency":"Minute","interval":1}}}}}')},19914:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"Http"}}}}')},19915:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"VirtualAgent"}}}}')},19916:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"VirtualAgent","inputs":{"schema":{"type":"object","properties":{},"required":[]}}}}}}')},19917:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"Skills","inputs":{"schema":{"type":"object","properties":{},"required":[]}}}}}}')},19918:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"TeamsWebhook"}}}}')},19919:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"Button","inputs":{"schema":{"type":"object","properties":{},"required":[]}}}}}}')},19920:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"TeamsWebhook","inputs":{"schema":{"type":"object","properties":{"type":{"type":"string"},"attachments":{"type":"array","items":{"type":"object","properties":{"contentType":{"type":"string"},"content":{"type":"object","properties":{"$schema":{"type":"string"},"type":{"type":"string"},"version":{"type":"string"},"body":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string"}},"required":["type"]}}}}},"required":["contentType","content"]}}}}}}}}}')},19921:function(e){e.exports=JSON.parse('{"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","triggers":{"manual":{"type":"Request","kind":"PowerAppV2","inputs":{"schema":{"type":"object","properties":{},"required":[]}}}}}}')},19922:function(e,t,r){"use strict";r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return g})),r.d(t,"a",(function(){return f}));var n=r(14868),i=r(19923),o=r(14924),a=r(14837),s=r(19931),c=r(15375),p=r(11891),u=r(19690);function l(e){return Object(p.a)(e.properties.api.tier,n.d.premium)}function g(e){var t=Object(p.a)(e.type,a.a.Manual)&&Object(p.a)(e.kind,o.a.Http),r=Object(p.a)(e.type,a.a.Response)&&Object(p.a)(e.kind,o.a.Http);return Object(p.a)(e.type,a.a.Http)||Object(p.a)(e.type,a.a.HttpWebhook)||t||r}function f(e){return e.name!==i.h.AIBUILDERPREDICT_GPTPROMPTENGINEERING&&e.name!==i.h.AIBUILDERPREDICT_CUSTOMPROMPT||!Object(s.a)()&&Object(c.a)()}r.d(t,"c",(function(){return u.c}))},20891:function(e,t,r){"use strict";var n=r(20892);r.d(t,"a",(function(){return n.a}))},20892:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(19891).a)},20893:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(20894),i=r(12999),o=r(20898),a=r(20891),s=r(12345),c=r(13087),p=new n.a(Object(i.a)(),s.a,c.a,o.a,a.a)},20894:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(20895),i=r(12328),o=r.n(i),a=r(13146),s=r(15477),c=r(13085),p=r(14940),u=r(19891),l=r(20897),g=r(12364),f=r(19906),d=r(19931),m=r(15375),b=r(13119);function h(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(p){return void r(p)}s.done?t(c):Promise.resolve(c).then(n,i)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){h(o,n,i,a,s,"next",e)}function s(e){h(o,n,i,a,s,"throw",e)}a(void 0)}))}}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function O(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var w=O((function e(t,r,i,h,y){var O=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureFlags=t,this.environmentStore=r,this.loggingService=i,this.designerOperationsHttpClient=h,this.designerOperationsStore=y,this.runFirstPending=Object(a.a)(),this.loadActions=e=>{var t,{cancelToken:r,customOnly:i,loadAllPages:o,top:a}=e,s=r||Object(p.a)().token,c=a||250,l=()=>this.designerOperationsHttpClient.listOperations({cancelToken:s,options:Object(n.a)({customOnly:i,isOpenApiEnabled:Object(b.f)(this.featureFlags)}),top:c});return this.runFirstPending({key:"loadActions-top:".concat(c,"-custom:").concat(i),action:(t=v((function*(){var e=u.a.getActionCollectionKey();if(yield O.loadOperations({collectionName:e,listOperationsFn:l,resetList:!0,loadOnlyIfExpired:!1}),o)for(;O.hasMoreOperations(e);)yield O.loadOperationsMore(e,s)})),function(){return t.apply(this,arguments)})})},this.loadTriggers=(e,t)=>{var r,{cancelToken:i,customOnly:o,loadAllPages:a,top:s}=t,c=i||Object(p.a)().token,l=()=>{var t=e===u.b.instant?n.c:e===u.b.automated?n.b:n.e,r=this.designerOperationsHttpClient.listOperations({cancelToken:Object(p.a)().token,options:t({customOnly:o,isOpenApiEnabled:Object(b.f)(this.featureFlags)}),top:s});return e===u.b.instant?r.then(e=>(e&&e.data&&e.data.value&&(e.data.value=e.data.value.filter(e=>f.a.requiresDefinition(e.id)||e.properties&&e.properties.operationGroup&&e.properties.operationGroup.isHybrid)),e)):r};return this.runFirstPending({key:"loadTriggers-".concat(e,"-top:").concat(s,"-custom:").concat(o),action:(r=v((function*(){var t=u.a.getTriggerCollectionKey(e);if(yield O.loadOperations({collectionName:t,listOperationsFn:l,resetList:!0,loadOnlyIfExpired:!1}),a)for(;O.hasMoreOperations(t);)yield O.loadOperationsMore(t,c)})),function(){return r.apply(this,arguments)})})},this.loadAutomatedTriggers=e=>this.loadTriggers(u.b.automated,e),this.loadInstantTriggers=e=>this.loadTriggers(u.b.instant,e),this.loadOperationsMore=(e,t)=>{var r=this.designerOperationsStore.designerOperations.getCollection(e);return o()(this.hasMoreOperations(e),"Cannot load more operations. Next link is empty or entity collection does not exist!"),this.loadOperations({collectionName:e,listOperationsFn:()=>this.designerOperationsHttpClient.getMoreListOperationsResults({nextLink:r.nextLink,cancelToken:t}),resetList:!1,loadOnlyIfExpired:!1})},this.loadOperation=e=>{var{operationGroupName:t,operationName:r,forceRefresh:n=!1}=e,i=this.environmentStore.currentEnvironmentName;return Object(s.a)({constructEntity:e=>new l.a(e.data),entities:this.designerOperationsStore.designerOperations,entityKey:u.a.getOperationKey(t,r),environmentName:i,eventData:{operationGroupName:t,operationName:r,forceRefresh:n},eventEndName:c.a.designerOperationsServiceGetOperationEnd,eventStartName:c.a.designerOperationsServiceGetOperationStart,fetchAction:()=>this.designerOperationsHttpClient.getOperation({cancelToken:Object(p.a)().token,operationGroupName:t,operationName:r}),forceRefreshPredicate:e=>n,loggingService:this.loggingService,runFirstPending:this.runFirstPending,runFirstPendingKeyPrefix:"loadOperation"})},this.getOperationGroups=()=>this.designerOperationsHttpClient.listOperationGroups({cancelToken:Object(p.a)().token}),this.searchActions=e=>{var{cancelToken:t,customOnly:r,searchText:i,top:o}=e;return this.loadOperations({collectionName:u.a.getActionSearchCollectionKey(),listOperationsFn:()=>this.designerOperationsHttpClient.listOperations({cancelToken:t,options:Object(n.a)({customOnly:r,isOpenApiEnabled:Object(b.f)(this.featureFlags),searchText:i}),top:o}),resetList:!0,loadOnlyIfExpired:!1})},this.searchAutomatedTriggers=e=>{var{cancelToken:t,customOnly:r,searchText:i,top:o}=e;return this.loadOperations({collectionName:u.a.getTriggerSearchCollectionKey(u.b.automated),listOperationsFn:()=>this.designerOperationsHttpClient.listOperations({cancelToken:t,options:Object(n.b)({customOnly:r,isOpenApiEnabled:Object(b.f)(this.featureFlags),searchText:i}),top:o}),resetList:!0,loadOnlyIfExpired:!1})},this.searchInstantTriggers=e=>{var{cancelToken:t,customOnly:r,searchText:i,top:o}=e;return this.loadOperations({collectionName:u.a.getTriggerSearchCollectionKey(u.b.instant),listOperationsFn:()=>this.designerOperationsHttpClient.listOperations({cancelToken:t,options:Object(n.c)({customOnly:r,isOpenApiEnabled:Object(b.f)(this.featureFlags),searchText:i}),top:o}).then(e=>(e&&e.data&&e.data.value&&(e.data.value=e.data.value.filter(e=>f.a.requiresDefinition(e.id)||e.properties&&e.properties.operationGroup&&e.properties.operationGroup.isHybrid)),e)),resetList:!0,loadOnlyIfExpired:!1})},this.searchOperationGroups=e=>this.designerOperationsHttpClient.listOperationGroups({cancelToken:Object(p.a)().token,options:e}),this.hasMoreOperations=e=>{var t=this.designerOperationsStore.designerOperations.getCollection(e);return!(null==t||!t.nextLink)},this.loadOperations=e=>{var{collectionName:t,listOperationsFn:r,resetList:n,loadOnlyIfExpired:i}=e,o=this.designerOperationsStore.designerOperations.getCollection(t);return i&&o&&!o.error&&!Object(g.d)(o.lastFetched)?Promise.resolve():(this.designerOperationsStore.designerOperations.setCollectionLoading(t),r().then(e=>{var{data:{value:t}}=e;if(t.findIndex(e=>"aibuilderpredict_gptpromptengineering"===e.name||"aibuilderpredict_customprompt"===e.name)>-1&&!(!Object(d.a)()&&Object(m.a)())){var r=t.findIndex(e=>"aibuilderpredict_gptpromptengineering"===e.name);r>-1&&t.splice(r,1);var n=t.findIndex(e=>"aibuilderpredict_customprompt"===e.name);n>-1&&t.splice(n,1)}return e}).then(e=>{var{data:{value:r,nextLink:i}}=e;this.designerOperationsStore.designerOperations.setCollectionLoaded(t,r.map(e=>new l.a(e)),{nextLink:i,resetList:n,replaceDupe:this.replaceDupeDesignerOperationsPredicate})}).catch(e=>(this.designerOperationsStore.designerOperations.setCollectionError(t,e),Promise.reject(e))))},this.replaceDupeDesignerOperationsPredicate=(e,t)=>!0}))},20895:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"e",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return f}));var n=r(20896),i=r(13183),o=r(20780);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p=e=>{var{customOnly:t,isOpenApiEnabled:r,searchText:n}=null!=e?e:{},i=[o.a.Action],a=[o.a.Deprecated,o.a.Trigger];return t?i.push(o.a.Custom):a.push(o.a.Custom),r||a.push(o.a.OpenApi),n||i.push(o.a.Important),{searchText:n,allTagsToInclude:i,anyTagsToExclude:a}},u=e=>{var{customOnly:t,isOpenApiEnabled:r,searchText:n}=null!=e?e:{},i=[o.a.Trigger],a=[o.a.Deprecated];return t?i.push(o.a.Custom):a.push(o.a.Custom),r||a.push(o.a.OpenApi),n||i.push(o.a.Important),{searchText:n,allTagsToInclude:i,anyTagsToExclude:a}},l=e=>{var t,r=u(e);return s(s({},r),{},{allTagsToInclude:[o.a.Automated,...null!==(t=r.allTagsToInclude)&&void 0!==t?t:[]]})},g=e=>{var t,r=u(e);return s(s({},r),{},{allTagsToInclude:[o.a.Instant,...null!==(t=r.allTagsToInclude)&&void 0!==t?t:[]]})},f=(e,t,r)=>{var{isPpapiEnabled:o}=r,a=new URL(e);if(o){var s=a.pathname.split("/").slice(2).join("/");return"".concat(Object(i.b)(t,s)).concat(a.search)}return Object(n.a)(e,t)}},20896:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(13183),i=(e,t)=>{var r=new URL(e);return"".concat(Object(n.b)(t,r.pathname)).concat(r.search)}},20897:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return f}));var n,i=r(11773),o=r(13093),a=r.n(o),s=r(20779),c=r(14884);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function l(e,t,r,n,i){var o={};return Object.keys(n).forEach((function(e){o[e]=n[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var g=(l((n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=void 0,this.name=void 0,this.type=void 0,this.properties=void 0,Object(i.extendObservable)(this,t)}var t,r,n;return t=e,(r=[{key:"toJS",value:function(){return a()(Object(i.toJS)(this),"toJS")}},{key:"summary",get:function(){return Object(s.g)(this)}},{key:"description",get:function(){return Object(s.b)(this)}},{key:"operationGroupName",get:function(){return Object(s.f)(this)}},{key:"operationGroupDisplayName",get:function(){return Object(s.d)(this)}},{key:"operationGroupBrandColor",get:function(){return Object(s.c)(this)}},{key:"operationGroupIconUri",get:function(){return Object(s.e)(this)}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"summary",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"summary"),n.prototype),l(n.prototype,"description",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"description"),n.prototype),l(n.prototype,"operationGroupName",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"operationGroupName"),n.prototype),l(n.prototype,"operationGroupDisplayName",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"operationGroupDisplayName"),n.prototype),l(n.prototype,"operationGroupBrandColor",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"operationGroupBrandColor"),n.prototype),l(n.prototype,"operationGroupIconUri",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"operationGroupIconUri"),n.prototype),n),f=e=>Object(c.c)(Object(i.toJS)(e))},20898:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,i=r(20899),o=r(12339),a=r(13180),s=r(12345),c=r(13e3),p=r(13087),u=Object(o.b)(),l=new i.a({environmentName:s.a.currentEnvironmentName,flowRpApiVersion:u.processSimpleResourceProviderApiVersionWithEnvironments,getIsPpapiEnabled:a.a,loggingService:p.a,tenantId:null===(n=c.a.minimalUserInfo)||void 0===n?void 0:n.tenantId})},20899:function(e,t,r){"use strict";var n=r(20900);r.d(t,"a",(function(){return n.a}))},20900:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n=r(12369),i=r(13034),o=r(13182),a=r(13183),s=r(13006),c=r(17218),p=r(20886),u=r(20895);function l(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(p){return void r(p)}s.done?t(c):Promise.resolve(c).then(n,i)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){l(o,n,i,a,s,"next",e)}function s(e){l(o,n,i,a,s,"throw",e)}a(void 0)}))}}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=w(e);if(t){var i=w(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return T(this,r)}}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j="SearchOperationsAllStart",E="SearchOperationsAllEnd",P="SearchOperationsQueryStart",S="SearchOperationsQueryEnd",k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(f,e);var t,r,p,l=O(f);function f(){var e;v(this,f);for(var t=arguments.length,r=new Array(t),p=0;p<t;p++)r[p]=arguments[p];return(e=l.call(this,...r)).getMoreListOperationsResults=t=>{var{cancelToken:r,nextLink:n}=t,i=e.getNextLinkEndpoint(n),o=e.httpClient.post(i,null,{cancelToken:r,operationName:"".concat(e.getEventNamePrefix(c.a.Post),"/OPERATIONS")});return e.withClientTelemetry(o,{isGroups:!1,queryType:"skipToken"})},e.getMoreListOperationGroupsResults=t=>{var{cancelToken:r,nextLink:n}=t,i=e.getNextLinkEndpoint(n),o=e.httpClient.post(i,null,{cancelToken:r,operationName:"".concat(e.getEventNamePrefix(c.a.Get),"/OPERATIONGROUPS")});return e.withClientTelemetry(o,{isGroups:!0,queryType:"skipToken"})},e.getOperation=t=>{var{cancelToken:r,operationGroupName:n,operationName:i}=t;return e.httpClient.get(e.getGetOperationApiEndpoint(n,i),{cancelToken:r,operationName:"".concat(e.getEventNamePrefix(c.a.Get),"/OPERATIONGROUPS/OPERATIONS/"),params:d(d({},e.getDefaultParams()),{},{$expand:"manifest"})})},e.listOperations=t=>{var{cancelToken:r,options:n,top:i}=t,o=e.getDefaultParams();i&&(o.$top=i);var a=e.httpClient.post(e.getListOperationsApiEndpoint(),n,{cancelToken:r,operationName:"".concat(e.getEventNamePrefix(c.a.Post),"/OPERATIONS"),params:o});return e.withClientTelemetry(a,{isGroups:!1,queryType:null!=n&&n.searchText?"searchText":"list"})},e.listOperationGroups=t=>{var{cancelToken:r,options:n,top:i}=t,o=e.getDefaultParams();i&&(o.$top=i);var a=e.httpClient.post(e.getListOperationGroupsApiEndpoint(),n,{cancelToken:r,operationName:"".concat(e.getEventNamePrefix(c.a.Get),"/OPERATIONGROUPS"),params:o});return e.withClientTelemetry(a,{isGroups:!0,queryType:null!=n&&n.searchText?"searchText":"list"})},e.getDesignerOperationsRootApiEndpoint=()=>{var{environmentName:t}=e.options,r=e.isPpapiEnabled()?e.getPpapiEndpoint():Object(a.b)("https://".concat(o.a.Flow),Object(s.a)(n.d));return Object(a.b)(r,"environments",t)},e.getEventNamePrefix=e=>"PROCESSSIMPLE:".concat(e.toUpperCase(),"/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS"),e.getGetOperationApiEndpoint=(t,r)=>Object(a.b)(e.getListOperationGroupsApiEndpoint(),t,"operations",r),e.getListOperationsApiEndpoint=()=>Object(a.b)(e.getDesignerOperationsRootApiEndpoint(),"operations"),e.getListOperationGroupsApiEndpoint=()=>Object(a.b)(e.getDesignerOperationsRootApiEndpoint(),"operationGroups"),e.getNextLinkEndpoint=t=>{var r=e.isPpapiEnabled(),n=r?e.getDesignerOperationsRootApiEndpoint():"https://".concat(o.a.Flow);return Object(u.d)(t,n,{isPpapiEnabled:r})},e.withClientTelemetry=function(){var t=g((function*(t,r){var{loggingService:n}=e.options,o=d(d({},r),{},{context:"DesignerOperationsHttpClient"}),a=n.profileStart("searchText"===r.queryType?P:j,o);try{var s=yield t;return n.profileEndWithSuccess(a,"searchText"===r.queryType?S:E,d(d({},o),{},{success:!0})),s}catch(c){throw n.profileEnd(a,"searchText"===r.queryType?S:E,Object(i.j)(c),c,d(d({},o),{},{success:!1})),c}}));return function(e,r){return t.apply(this,arguments)}}(),e}return t=f,r&&b(t.prototype,r),p&&b(t,p),Object.defineProperty(t,"prototype",{writable:!1}),t}(p.a)},20901:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(19906).a)},20984:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(14258),i=r(13081),o=r(13087),a=r(13148),s=new n.b(i.a,o.a,a.a)}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/148.137797f6.chunk.js.map