/*! For license information please see 180.52cdba6d.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{22200:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var o=r(22201),i=r(12345),n=r(17281),a=r(17258),l=r(15463),s=r(22206),c=r(17213),p=r(13087),d=r(12999),u=r(13230),f=r(15417),m=new o.a(s.a,n.a,c.a,a.a,p.a,i.a,l.a,Object(d.a)(),u.a,f.a);new o.a(s.a,n.a,c.b,a.a,p.a,i.a,l.a,Object(d.a)(),u.a,f.b)},22201:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var o=r(17239),i=r(17237),n=r(22202),a=r(12364),l=r(13009),s=r(12367),c=r(17451),p=r(14843),d=r(17240),u=r(17282),f=r(17219),m=r(15402),w=r(22203),v=r(13146),h=r(11891),y=r(13085),g=r(22205);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return(t=j(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e,t,r,o,i,n,a){try{var l=e[n](a),s=l.value}catch(c){return void r(c)}l.done?t(s):Promise.resolve(s).then(o,i)}function R(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var n=e.apply(t,r);function a(e){E(n,o,i,a,l,"next",e)}function l(e){E(n,o,i,a,l,"throw",e)}a(void 0)}))}}function P(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,j(o.key),o)}}function j(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var C=function(){function e(t,r,S,O,E,P,j,C,I,F){var N=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.flowRoleHttpClient=t,this.flowRoleStore=r,this.flowService=S,this.flowStore=O,this.loggingService=E,this.environmentStore=P,this.xrmWorkflowHttpClient=j,this.featureFlags=C,this.getFlowServiceClientResources=I,this.environmentCapabilityService=F,this.runFirstPending=Object(v.a)(),this.addFlowRole=function(){var e=R((function*(e){var{flowName:t,flowPrincipal:r,flowRole:o,workflowEntityId:i}=e,n=Object(g.a)(r,{isSolutionFlow:!!i});if(i){var{endProfiling:a}=Object(w.a)("FlowRoleService.addFlowRole.solutionPath",{loggingService:N.loggingService});try{return yield N.syncFlowAccess(i,[b({id:u.a.getRoleKeyWithFlow(i,r.id),type:o},n)]),void a()}catch(p){throw a({error:p}),p}}var{endProfiling:s}=Object(w.a)("FlowRoleService.addFlowRole.nonSolutionPath",{loggingService:N.loggingService});try{var c=yield N.flowRoleHttpClient.addFlowRole({environmentName:N.environmentStore.currentEnvironmentName,flowName:t,newFlowRole:n,roleType:o});if(c.status!==f.a.Ok)throw new l.a("NonSuccessStatusCode","Call to add flow role returned a response with status ".concat(c.status,"."),{flowName:t,flowRole:o,workflowEntityId:i});s()}catch(p){throw s({error:p}),p}}));return function(t){return e.apply(this,arguments)}}(),this.loadFlowRoles=e=>{var{flowName:t,flowRole:r,parseAndCatchError:o,forceRefresh:i=!1}=e,n=u.a.getCollectionKey(t,r),s=this.flowRoleStore.flowRoles.getCollection(n),{currentEnvironmentName:c}=this.environmentStore,p=s&&s.lastFetched;if(i||Object(a.d)(p)){var d="loadFlow".concat(r,"-").concat(c,"-").concat(n);return this.runFirstPending({key:d,action:()=>{var e,i={collectionName:n,roleType:r,flowName:t},a=this.loggingService.profileStart(y.a.loadFlowOwnersStart,i);return this.flowService.loadFlow(t,void 0,void 0,void 0,!0).then(()=>{var i=this.flowStore.flows.getEntity(t);return(e=!!i&&i.isSolutionFlow)?this.loadEntityFlowRoles({collectionName:n,roleType:r,workflowEntityId:i.properties.workflowEntityId,parseAndCatchError:o}):this.loadNonEntityFlowRoles({collectionName:n,environmentName:c,flowName:t,roleType:r})}).then(()=>{this.loggingService.profileEndWithSuccess(a,y.a.loadFlowOwnersEnd,b({isSolutionFlow:e},i))}).catch(t=>{throw this.loggingService.profileEnd(a,y.a.loadFlowOwnersEnd,Object(l.y)(t),t,b({isSolutionFlow:e},i)),t})}})}return Promise.resolve()},this.syncFlowAccess=(e,t)=>Promise.all(t.map(t=>{var r=t.properties.principal;if(!r)return Promise.resolve();var o,i,a,s={principalType:r.type,uniqueId:r.xrmUniqueId,aadObjectId:r.aadObjectId,workflowId:e,access:t.type},c=this.flowRoleStore.flowRoles.getEntity(t.id);this.featureFlags.enableShareSolutionFlowWithAADUsers&&this.dvInstanceSupportsAutoJIT()&&!c&&!r.xrmUniqueId&&r.aadObjectId?i=Object(h.a)(r.type,"user")?Object(m.b)({loggingService:this.loggingService,promise:this.xrmWorkflowHttpClient.jitIfNeededAndGetAADUser(r.aadObjectId).then(e=>{r.xrmUniqueId=e.data.systemuserid}).catch(e=>{var t=Object(l.cb)(e);return t===l.c.recordNotFoundByEntityKey||"404"===t?this.getFlowServiceClientResources().then(e=>Promise.reject({code:l.c.recordNotFoundByEntityKey,message:e.Dialogs.ShareFlow.UnableToShareFlowUserJitFailure})):Promise.reject(e)}),eventStartName:y.a.jitIfNeededAndGetAADUserStart,eventEndName:y.a.jitIfNeededAndGetAADUserEnd,eventData:s}):Object(m.b)({loggingService:this.loggingService,promise:this.xrmWorkflowHttpClient.jitIfNeededAndGetAADGroup(r.aadObjectId).then(e=>{r.xrmUniqueId=e.data.teamid}).catch(e=>Object(l.cb)(e)===l.c.recordNotFoundByEntityKey?this.getFlowServiceClientResources().then(e=>Promise.reject({code:l.c.recordNotFoundByEntityKey,message:e.Dialogs.ShareFlow.UnableToShareFlowGroupJitFailure})):Promise.reject(e)),eventStartName:y.a.jitIfNeededAndGetAADGroupStart,eventEndName:y.a.jitIfNeededAndGetAADGroupEnd,eventData:s}):(i=Promise.resolve(),r.xrmUniqueId||(r.xrmUniqueId=null==c||null===(a=c.properties.principal)||void 0===a?void 0:a.xrmUniqueId));return i.then(()=>{var i={workflowEntityId:e,uniqueId:r.xrmUniqueId,sharingType:this.convertToXrmSharingPrincipalType(r.type),roleType:t.type},a=this.flowStore.flows.getEntity(e);if(a&&a.creatorId===t.name)return Promise.resolve();if(t.type)if(c&&c.type){if(c.type===t.type)return Promise.resolve();o=this.xrmWorkflowHttpClient.modifyWorkflowAccess(i)}else o=this.xrmWorkflowHttpClient.grantWorkflowAccess(i);else o=this.xrmWorkflowHttpClient.revokeWorkflowAccess(i);var p=this.loggingService.profileStart(y.a.xrmGrantWorkflowAccessStart,s);return o.then(()=>{this.loggingService.profileEndWithSuccess(p,y.a.xrmGrantWorkflowAccessEnd,s);var r=u.a.getCollectionKey(e,t.type);c&&this.flowRoleStore.flowRoles.removeKeyFromCollection(u.a.getCollectionKey(e,c.type),t.id),this.flowRoleStore.flowRoles.addEntityToCollection({collectionType:r,entity:new n.a(t),replaceDupe:()=>!0})}).catch(e=>{var t=Object(l.db)(e);this.loggingService.profileEnd(p,y.a.xrmGrantWorkflowAccessEnd,Object(l.y)(e),e,s);var r=new l.a(Object(l.cb)(e),t,e,s);return this.loggingService.logError(y.a.xrmGrantWorkflowAccessEnd,r),Promise.reject(r)})})})).then(),this.dvInstanceSupportsAutoJIT=()=>{var e,t=null===(e=this.environmentStore.environmentClaim)||void 0===e?void 0:e.xrmInstanceVersion;return!!t&&t.localeCompare("9.2.22013.00000")>=0},this.loadNonEntityFlowRoles=e=>{var{collectionName:t,environmentName:r,flowName:o,roleType:i}=e,a={environmentName:r,flowName:o,roleType:i};return this.flowRoleStore.flowRoles.setCollectionLoading(t),this.flowRoleHttpClient.getFlowRoles(a).then(e=>{var{data:{value:r,nextLink:o}}=e;this.flowRoleStore.flowRoles.setCollectionLoaded(t,r.map(e=>new n.a(e)),{nextLink:o,resetList:!0})}).catch(e=>{this.flowRoleStore.flowRoles.setCollectionError(t,e),Promise.reject(e)})},this.loadEntityFlowRoles=e=>{var{collectionName:t,roleType:r,workflowEntityId:o,parseAndCatchError:i}=e;return this.flowRoleStore.flowRoles.setCollectionLoading(t),r===s.g.owners?this.loadEntityFlowOwners({collectionName:t,workflowEntityId:o,parseAndCatchError:i}):this.loadEntityFlowUsers({collectionName:t,workflowEntityId:o,parseAndCatchError:i})},this.loadEntityFlowOwners=e=>{var{collectionName:t,workflowEntityId:r,parseAndCatchError:o}=e;return Promise.all([this.getWorkflowEntityOwner(r),this.getSharedEntityPrincipals(r,s.g.owners)]).then(e=>{var[r,o]=e,i=r?[r].concat(o.filter(e=>e.id!==r.id)):o;this.flowRoleStore.flowRoles.setCollectionLoaded(t,i.map(e=>new n.a(e)),{nextLink:void 0,resetList:!0})}).catch(e=>{if(void 0===o||!o(e))throw this.flowRoleStore.flowRoles.setCollectionError(t,e),e;this.loggingService.logWarning("flowRoleService.loadEntityFlowOwners","Not throwing warning as error was successfully parsed.")})},this.getWorkflowEntityOwner=function(){var e=R((function*(e){var t,r,n=N.flowStore.flows.getEntity(e),a=(null==n?void 0:n.owner)||(null==n?void 0:n.properties.owner);if(a)return Promise.resolve(N.transformFlowOwnerToFlowRole({xrmSystemUser:a,roleType:s.g.owners,xrmWorkflowId:e}));var l=yield Object(i.b)(N.environmentStore.currentEnvironmentName,N.environmentCapabilityService,N.loggingService),c=yield Object(o.c)(N.loggingService,N.environmentCapabilityService,N.environmentStore.currentEnvironmentName,!(null===(t=N.environmentStore.environmentClaim)||void 0===t||!t.hasXrmInstance),null===(r=N.environmentStore.environmentClaim)||void 0===r||null===(r=r.protectionStatus)||void 0===r?void 0:r.keyManagedBy),u=Object(d.a)(),f=l?{$select:p.u.selectParams,DelegatedAuthorization:"*"}:{$select:p.u.selectParams};return N.xrmWorkflowHttpClient.getWorkflow(e,f,c||u).then(t=>N.transformOwningUserToFlowRole({owningUser:t.data.owninguser,roleType:s.g.owners,xrmWorkflowId:e}))}));return function(t){return e.apply(this,arguments)}}(),this.getSharedEntityPrincipals=function(){var e=R((function*(e,t){var r=(yield Object(i.b)(N.environmentStore.currentEnvironmentName,N.environmentCapabilityService,N.loggingService))?{DelegatedAuthorization:"*"}:void 0;return N.xrmWorkflowHttpClient.getPrincipalsWithFlowAccess(e,r).then(r=>{var o=r.data.PrincipalAccesses,i=[],n=[];o.forEach(e=>{var r=e.Principal["@odata.type"].toLowerCase();N.isXrmAccessMaskMatch(e.AccessMask,t)&&(r==="#".concat("Microsoft.Dynamics.CRM.systemuser".toLowerCase())?i.push(e.Principal.ownerid):r==="#".concat("Microsoft.Dynamics.CRM.team".toLowerCase())&&n.push(e.Principal.ownerid))});var a=i.length?N.xrmWorkflowHttpClient.getXrmSystemUsers(i).then(e=>e.data?e.data.value:[]):Promise.resolve([]),l=n.length?N.xrmWorkflowHttpClient.getXrmTeams(n).then(e=>e.data?e.data.value:[]):Promise.resolve([]);return Promise.all([a,l]).then(r=>{var[o,a]=r;return i.map(r=>{var i=o.find(e=>e.systemuserid===r);return i&&N.transformXrmUserToFlowRole({xrmSystemUser:i,roleType:t,xrmWorkflowId:e})}).concat(n.map(r=>{var o=a.find(e=>e.teamid===r);return o&&N.transformXrmTeamToFlowRole({xrmTeam:o,roleType:t,xrmWorkflowId:e})})).filter(e=>e)})})}));return function(t,r){return e.apply(this,arguments)}}(),this.isXrmAccessMaskMatch=(e,t)=>{var r=e.toLowerCase(),o=r.indexOf("writeaccess")>=0;return t===s.g.owners?o:r.indexOf("readaccess")>=0&&!o},this.transformXrmUserToFlowRole=e=>{var{xrmSystemUser:t,roleType:r,xrmWorkflowId:o}=e;if(t){var i=t.azureactivedirectoryobjectid||"",n=t.systemuserid;return{id:u.a.getRoleKeyWithFlow(o,n),name:i,properties:{principal:{id:i,xrmUniqueId:n,aadObjectId:i,displayName:t.fullname,email:t.internalemailaddress,type:"user",isDisabled:t.isdisabled&&!t.islicensed,applicationId:t.applicationid},permissionType:c.c.Principal},type:r}}},this.transformOwningUserToFlowRole=e=>{var{owningUser:t,roleType:r,xrmWorkflowId:o}=e,i=t?{azureactivedirectoryobjectid:t.azureactivedirectoryobjectid,fullname:t.fullname,internalemailaddress:t.internalemailaddress,systemuserid:t.systemuserid,applicationid:t.applicationid}:void 0;return i&&i.azureactivedirectoryobjectid?{id:u.a.getRoleKeyWithFlow(o,i.systemuserid),name:i.azureactivedirectoryobjectid,properties:{principal:{id:i.azureactivedirectoryobjectid,xrmUniqueId:i.systemuserid,aadObjectId:i.azureactivedirectoryobjectid,displayName:i.fullname,email:i.internalemailaddress,type:"user",isDisabled:!!t&&(t.isdisabled&&!t.islicensed),applicationId:i.applicationid},permissionType:c.c.Principal},type:r}:void 0},this.transformFlowOwnerToFlowRole=e=>{var{xrmSystemUser:t,roleType:r,xrmWorkflowId:o}=e;return t?{id:u.a.getRoleKeyWithFlow(o,t.xrmSystemUserId),name:t.objectId,properties:{principal:{id:t.objectId,xrmUniqueId:t.xrmSystemUserId,aadObjectId:t.objectId,displayName:t.fullName,email:t.internalEmailAddress,type:"user",isDisabled:t.isDisabled&&!t.isLicensed},permissionType:c.c.Principal},type:r}:void 0},this.transformXrmTeamToFlowRole=e=>{var{xrmTeam:t,roleType:r,xrmWorkflowId:o}=e;if(t){var i=t.teamid;return{id:u.a.getRoleKeyWithFlow(o,i),name:t.azureactivedirectoryobjectid||"",properties:{principal:{id:i,xrmUniqueId:i,displayName:t.name,email:t.emailaddress||"",type:"group",isDisabled:!1},permissionType:c.c.Principal},type:r}}},this.loadEntityFlowUsers=e=>{var{collectionName:t,workflowEntityId:r,parseAndCatchError:o}=e;return this.getSharedEntityPrincipals(r,s.g.users).then(e=>{this.flowRoleStore.flowRoles.setCollectionLoaded(t,e.map(e=>new n.a(e)),{nextLink:void 0,resetList:!0})}).catch(e=>{if(!o||!o(e))throw this.flowRoleStore.flowRoles.setCollectionError(t,e),e;this.loggingService.logWarning("flowRoleService.loadEntityFlowUsers","Not throwing warning as error was successfully parsed.")})}}var t,r,S;return t=e,(r=[{key:"convertToXrmSharingPrincipalType",value:function(e){return Object(h.a)(e,"user")?c.b.SystemUser:c.b.Team}}])&&P(t.prototype,r),S&&P(t,S),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22202:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o,i=r(11773),n=r(17451);function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t,r,o,i){var n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=r.slice().reverse().reduce((function(r,o){return o(e,t,r)||r}),n),i&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(i):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}var c=(s((o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=void 0,this.name=void 0,this.properties=void 0,this.type=void 0,Object(i.extendObservable)(this,t)}var t,r,o;return t=e,(r=[{key:"isPrincipal",get:function(){return!!this.properties&&!!this.properties.permissionType&&this.properties.permissionType===n.c.Principal}},{key:"displayName",get:function(){return this.properties&&this.properties.principal&&this.properties.principal.displayName||void 0}}])&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"isPrincipal",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"isPrincipal"),o.prototype),s(o.prototype,"displayName",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"displayName"),o.prototype),o)},22203:function(e,t,r){"use strict";var o=r(22204);r.d(t,"a",(function(){return o.a}))},22204:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var o=r(13034),i=r(12324);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){var o;return(t="symbol"==typeof(o=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=(e,t)=>{var{eventData:r,loggingService:n,separator:l=""}=t,s="".concat(e).concat(l).concat("Start"),c="".concat(e).concat(l).concat("End"),p=n.profileStart(s,r);return{endProfiling:Object(i.once)(e=>{var{endData:t,error:i,status:l}=null!=e?e:{},s=a(a({},r),t);if(l||i){var d=null!=l?l:Object(o.j)(i);n.profileEnd(p,c,d,i,s)}else n.profileEndWithSuccess(p,c,s)})}}},22205:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var o=r(14842),i=(e,t)=>{var{isSolutionFlow:r}=null!=t?t:{},i={displayName:e.displayName,email:e.email,id:e.id,isDisabled:!1,type:n(e.type)};return r&&(i.aadObjectId=e.id),{name:e.id,properties:{permissionType:o.c.Principal,principal:i}}},n=e=>{if(e===o.b.User)return"User";if(e===o.b.Group)return"Group";throw new Error("Cannot get graph object type for flow sharing principal type '".concat(e,"'."))}},22206:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var o=r(13192),i=r(13e3),n=r(12339),a=r(22207),l=r(12999),s=r(13077),c=r(13087),p=r(13198),d=r(13206),u=r(14688),f=new a.a(Object(n.b)(),Object(l.a)(),c.a,new o.HttpClient,u.a,i.a,s.a,p.a,d.a)},22207:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var o=r(13215),i=r(14829),n=r(12367),a=r(12375),l=r(13144),s=r(12381),c=r(22208);function p(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function d(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f=d((function e(t,r,p,d,u,f,m,w,v){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.featureFlags=r,this.loggingService=p,this.httpClient=d,this.ppapiService=u,this.sessionStore=f,this.tokenService=m,this.userContextChangeMonitoringService=w,this.userContextStore=v,this.getFlowRoles=e=>{var{environmentName:t,flowName:r,roleType:o}=e;return this.httpClient.get({eventName:"PROCESSSIMPLE:GET/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/".concat(o.toUpperCase()),url:"".concat(this.getFlowRoleApiBaseEndpoint(t),"/").concat(r,"/").concat(o)})},this.getMoreFlowRoles=e=>this.httpClient.get({eventName:"PROCESSSIMPLE:GET/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/"+"".concat((e.includes(n.g.owners)?n.g.owners:n.g.users).toUpperCase()),url:e}),this.getFlowRole=e=>{var{environmentName:t,flowName:r,roleType:o,roleId:i}=e;return this.httpClient.get({eventName:"PROCESSSIMPLE:GET/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/".concat(o.toUpperCase(),"/"),url:"".concat(this.getFlowRoleApiBaseEndpoint(t),"/").concat(r,"/").concat(o,"/").concat(i)})},this.requestAccessToFlow=e=>{var{environmentName:t,flowName:r}=e;return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/REQUESTUSERACCESS",responseType:"text",url:"".concat(this.getFlowRoleApiBaseEndpoint(t),"/").concat(r,"/requestUserAccess")})},this.deleteFlowRole=e=>{var{environmentName:t,flowName:r,roleType:o,roleId:i}=e;return this.httpClient.delete({eventName:"PROCESSSIMPLE:DELETE/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/".concat(o.toUpperCase(),"/"),responseType:"text",url:"".concat(this.getFlowRoleApiBaseEndpoint(t),"/").concat(r,"/").concat(o,"/").concat(i)})},this.addFlowRole=e=>{var{environmentName:t,flowName:r,newFlowRole:o,roleType:i}=e,n=Object(s.b)(this.getFlowRoleApiBaseEndpoint(t),r,"modify".concat(i.toLowerCase())),a=new URLSearchParams({cascadeoperation:"true"}),l="".concat(n,"?").concat(a);return this.httpClient.post({data:{put:[Object(c.a)(o)]},eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/".concat(i.toUpperCase()),responseType:"text",url:l})},this.getFlowRoleApiBaseEndpoint=e=>Object(s.a)(Object(l.b)(e,this.appSettings).flowRP,"".concat(this.appSettings.processSimpleResourceProviderPath,"/environments/").concat(e,"/flows")),this.httpClient.addRequestInterceptor(Object(o.f)(p,()=>this.sessionStore.sessionId)),this.httpClient.addRequestInterceptor(Object(o.c)(()=>this.tokenService.getAccessToken(this.appSettings.flowAudience))),this.httpClient.addRequestInterceptor(Object(o.d)(()=>Object(a.a)())),this.httpClient.addRequestInterceptor(Object(o.j)(this.featureFlags.enableB2BLogin,this.userContextStore,this.userContextChangeMonitoringService,this.loggingService)),this.httpClient.addRequestInterceptor(Object(o.i)(p,f)),this.httpClient.addRequestInterceptor(Object(i.b)(this.ppapiService,this.appSettings)),this.httpClient.addResponseInterceptor(Object(o.g)(this.loggingService,this.sessionStore),Object(o.e)(this.loggingService,this.sessionStore))}))},22208:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r(12324),i=e=>{var t,r=Object(o.cloneDeep)(e);return null!==(t=r.properties)&&void 0!==t&&t.principal&&delete r.properties.principal.isDisabled,r}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/180.52cdba6d.chunk.js.map