(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{23048:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(11766),i=s(a),c=s(n(12237));function s(e){return e&&e.__esModule?e:{default:e}}var d={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},u=["extraWidth","injectStyles","inputClassName","inputRef","inputStyle","minWidth","onAutosize","placeholderIsMinWidth"],l=function(e,t){t.style.fontSize=e.fontSize,t.style.fontFamily=e.fontFamily,t.style.fontWeight=e.fontWeight,t.style.fontStyle=e.fontStyle,t.style.letterSpacing=e.letterSpacing,t.style.textTransform=e.textTransform},f=!("undefined"==typeof window||!window.navigator)&&/MSIE |Trident\/|Edge\//.test(window.navigator.userAgent),m=function(){return f?"_"+Math.random().toString(36).substr(2,12):void 0},p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputRef=function(e){n.input=e,"function"==typeof n.props.inputRef&&n.props.inputRef(e)},n.placeHolderSizerRef=function(e){n.placeHolderSizer=e},n.sizerRef=function(e){n.sizer=e},n.state={inputWidth:e.minWidth,inputId:e.id||m()},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()}},{key:"componentWillReceiveProps",value:function(e){var t=e.id;t!==this.props.id&&this.setState({inputId:t||m()})}},{key:"componentDidUpdate",value:function(e,t){t.inputWidth!==this.state.inputWidth&&"function"==typeof this.props.onAutosize&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"copyInputStyles",value:function(){if(this.mounted&&window.getComputedStyle){var e=this.input&&window.getComputedStyle(this.input);e&&(l(e,this.sizer),this.placeHolderSizer&&l(e,this.placeHolderSizer))}}},{key:"updateInputWidth",value:function(){if(this.mounted&&this.sizer&&void 0!==this.sizer.scrollWidth){var e=void 0;e=this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:this.sizer.scrollWidth+2,(e+="number"===this.props.type&&void 0===this.props.extraWidth?16:parseInt(this.props.extraWidth)||0)<this.props.minWidth&&(e=this.props.minWidth),e!==this.state.inputWidth&&this.setState({inputWidth:e})}}},{key:"getInput",value:function(){return this.input}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"select",value:function(){this.input.select()}},{key:"renderStyles",value:function(){var e=this.props.injectStyles;return f&&e?i.default.createElement("style",{dangerouslySetInnerHTML:{__html:"input#"+this.state.inputId+"::-ms-clear {display: none;}"}}):null}},{key:"render",value:function(){var e=[this.props.defaultValue,this.props.value,""].reduce((function(e,t){return null!=e?e:t})),t=r({},this.props.style);t.display||(t.display="inline-block");var n=r({boxSizing:"content-box",width:this.state.inputWidth+"px"},this.props.inputStyle),o=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(this.props,[]);return function(e){u.forEach((function(t){return delete e[t]}))}(o),o.className=this.props.inputClassName,o.id=this.state.inputId,o.style=n,i.default.createElement("div",{className:this.props.className,style:t},this.renderStyles(),i.default.createElement("input",r({},o,{ref:this.inputRef})),i.default.createElement("div",{ref:this.sizerRef,style:d},e),this.props.placeholder?i.default.createElement("div",{ref:this.placeHolderSizerRef,style:d},this.props.placeholder):null)}}]),t}(a.Component);p.propTypes={className:c.default.string,defaultValue:c.default.any,extraWidth:c.default.oneOfType([c.default.number,c.default.string]),id:c.default.string,injectStyles:c.default.bool,inputClassName:c.default.string,inputRef:c.default.func,inputStyle:c.default.object,minWidth:c.default.oneOfType([c.default.number,c.default.string]),onAutosize:c.default.func,onChange:c.default.func,placeholder:c.default.string,placeholderIsMinWidth:c.default.bool,style:c.default.object,value:c.default.any},p.defaultProps={minWidth:1,injectStyles:!0},t.default=p},23053:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11766),o=n(23057),a=n(23054),i=n(12732),c=r.forwardRef((function(e,t){var n=Object(i.a)(t,r.useRef(null)),c=Object(a.a)(e,{ref:n,as:"div",applyTo:"element"}),s=c.render,d=c.state;return Object(o.a)(d),s(d)}));c.displayName="ThemeProvider"},23054:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(23056),o=n(23055),a=n(12731),i=function(e,t){var n=Object(a.a)(t,e);return Object(o.a)(n),{state:n,render:r.a}}},23055:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12776),o=n(11766),a=n(16873),i=n(12728),c=new Map,s=function(e){var t=e.theme,n=Object(a.a)(),s=e.theme=o.useMemo((function(){var e=Object(r.a)(n,t);return e.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,o=e;r<o.length;r++){var a=o[r];if(a){var s=a.id||c.get(a);s||(s=Object(i.a)(""),c.set(a,s)),n.push(s)}}return n.join("-")}(n,t),e}),[n,t]);e.customizerContext=o.useMemo((function(){return{customizations:{inCustomizerContext:!0,settings:{theme:s},scopedSettings:s.components||{}}}}),[s]),e.theme.rtl!==n.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")}},23056:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12708),o=n(11766),a=n(14993),i=n(12736),c=n(12722),s=n(12830),d=n(16874),u=function(e){var t=e.customizerContext,n=e.ref,u=e.theme,l=e.as||"div",f="string"==typeof e.as?Object(a.a)(e.as,e):e.as===o.Fragment?{children:e.children}:Object(i.d)(e,["as"]);return o.createElement(d.a.Provider,{value:u},o.createElement(c.a.Provider,{value:t},o.createElement(s.a,{providerRef:n},o.createElement(l,Object(r.__assign)({},f)))))}},23057:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11766),o=n(12811),a=n(12739),i=n(23058),c=Object(i.a)((function(e){var t=e.semanticColors,n=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,MozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,WebkitFontSmoothing:n.medium.WebkitFontSmoothing}]}}));function s(e){var t=c(e),n=e.className,i=e.applyTo;!function(e,t){var n,o="body"===e.applyTo,i=null===(n=Object(a.c)())||void 0===n?void 0:n.body;r.useEffect((function(){if(o&&i){for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&i.classList.add(r)}return function(){if(o&&i)for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&i.classList.remove(r)}}}}),[o,i,t])}(e,[t.root,t.body]),e.className=Object(o.a)(n,t.root,"element"===i&&t.body)}},23058:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(16873),o=n(12728),a=n(12739),i=n(23059),c=n(11766);function s(e){var t=new Map,n=new Set,s=function(e){var r=e.currentTarget,o=r.__id__;t.delete(o),r.removeEventListener("unload",s),n.delete(o)};return function(d){void 0===d&&(d={});var u,l=d.theme,f=Object(a.d)();f&&(f.__id__=f.__id__||Object(o.a)(),u=f.__id__,n.has(u)||(n.add(u),f.addEventListener("unload",s)));var m=Object(r.a)();l=l||m;var p=i.a.getId(),g=[u,p,l],v=function(e,t){var n,r,o,a=t[0],i=t[1],c=t[2];return null===(o=null===(r=null===(n=e.get(a))||void 0===n?void 0:n.get(i))||void 0===r?void 0:r.get(c))||void 0===o?void 0:o.classMap}(t,g);if(Object(c.useEffect)((function(){return function(e,t){var n,r,o=t[0],a=t[1],i=t[2],c=null===(r=null===(n=e.get(o))||void 0===n?void 0:n.get(a))||void 0===r?void 0:r.get(i);c&&c.refCount++}(t,[u,p,l]),function(){return function(e,t){var n,r,o,a,i,c,s,d,u=t[0],l=t[1],f=t[2],m=null===(r=null===(n=e.get(u))||void 0===n?void 0:n.get(l))||void 0===r?void 0:r.get(f);m&&(m.refCount--,0===m.refCount&&(null===(a=null===(o=e.get(u))||void 0===o?void 0:o.get(l))||void 0===a||a.delete(f),0===(null===(c=null===(i=e.get(u))||void 0===i?void 0:i.get(l))||void 0===c?void 0:c.size)&&(null===(s=e.get(u))||void 0===s||s.delete(l),0===(null===(d=e.get(u))||void 0===d?void 0:d.size)&&e.delete(u))))}(t,[u,p,l])}}),[u,p,l]),!v){var h=function(e){return"function"==typeof e}(e)?e(l):e;v=i.a.renderStyles(h,{targetWindow:f,rtl:!!l.rtl}),function(e,t,n){var r,o,a=t[0],i=t[1],c=t[2],s=null!==(r=e.get(a))&&void 0!==r?r:new Map;e.set(a,s);var d=null!==(o=s.get(i))&&void 0!==o?o:new Map;s.set(i,d),d.set(c,{classMap:n,refCount:0})}(t,g,v)}return v}}},23059:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12707),o=n(12709),a=n(12766),i=n(12759),c=0,s={reset:function(){r.b.getInstance().onReset((function(){return c++}))},getId:function(){return c},renderStyles:function(e,t){return Object(o.a)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return Object(a.a)(e)},renderKeyframes:function(e){return Object(i.a)(e)}}},28056:function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return x}));var r=n(28057),o=n(28062),a=n(28195),i=n(28079),c=n(28091),s=n(12299),d=n(28146),u=n(28147),l=n(28170),f=(n(28212),n(28247),n(28259)),m=n(28270),p=n(28274),g=n(28275),v=n(28290),h=n(28301),b=n(28360),C=n(28362),y=n(28369),T=n(28310),O=n(28271),I=n(28371),S=n(28280),j=n(28374),_=n(28398),k=n(28401),E=n(28312),D=n(28402),A=n(28403);function P(e,t,n,d,u,f,P,x,w){try{try{if(Object(k.a)())return void Object(c.k)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(N){if(!Object(O.b)(N))throw N}Object(E.c)(A.a);var R=[];Object(i.d)()?R.push([!P,"App settings should not be passed in when feature gate API is already initialized. Please inspect feature gate initialization on host.",o.d.reserveTag(527754333)]):(R.push([!!P,"Must initialize feature gate API but no appSettings passed to instantiate.",o.d.reserveTag(527754332)]),Object(i.c)({appSettings:null!=P?P:{},mapping:I.a})),Object(c.k)().hasBeenInitialized()?Object(c.k)().assertConditionTag(!t,"Telemetry details should not be passed in if telemetry API is already initialized. Please inspect telemetry API initialization on host.",527754334):Object(c.m)(_.a,t),R.forEach((function(e){Object(c.k)().assertConditionTag(e[0],e[1],e[2])})),Object(c.k)().assertConditionTag(!!P,"appSettings should not be undefined",595616278);var F=function(){var t=Object(m.c)(u);Object(s.c)(t.getLocaleInfo().isRightToLeft),Object(j.a)();var o=Object(h.a)(r.a,d);E.a.ensureViewManager({apiContext:r.a,displayMode:v.b.FullPane,foldableLayoutState:v.a.Indeterminate,initializationReason:f||b.a.PaneOpen,correlationId:Object(a.a)(),viewContainerProvider:o,peopleAPI:n,hostCommentAPI:e,paneVisible:!1,initializeImmediately:!1}),Object(p.c)(x),S.P()&&w&&g.a.setThemeAPI(w),Object(C.b)(),Object(l.g)().onExtensionFirstRequested.subscribe((function(e){e.contentType===l.b.CommentThread&&e.instanceId===l.c&&Object(D.a)()}))};S.R()?Object(y.b)().then((function(){F()})).catch((function(e){return Object(T.a)(o.d.reserveTag(526254819))(e)})):F()}catch(N){throw Object(T.a)(o.d.reserveTag(594367139))(N),N}}function x(){try{try{Object(k.a)()}catch(e){if(!Object(O.b)(e))throw e;return}Object(E.b)(),Object(f.a)(),Object(u.c)(),Object(l.f)(),Object(C.a)(),Object(d.c)(),Object(p.b)(),S.P()&&(g.a.resetThemeAPI(),Object(g.f)()),E.a.disposeViewManager(),Object(j.b)(),Object(m.a)(),Object(c.i)(),Object(i.a)()}catch(e){throw e}}},28057:function(e,t,n){"use strict";n(28058);var r=n(28061);n.d(t,"a",(function(){return r.a}))},28058:function(e,t,n){"use strict";n(28059)},28059:function(e,t,n){"use strict";n(28060)},28060:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="Default_7210d794-9f0f-4d0a-805c-964303b2676b"},28061:function(e,t,n){"use strict";var r=n(28060);n.d(t,"a",(function(){return r.a}))},28062:function(e,t,n){"use strict";n(28063),n(28064);var r=n(28065);n.d(t,"h",(function(){return r.a})),n.d(t,"i",(function(){return r.b})),n.d(t,"j",(function(){return r.c}));var o=n(28067);n.d(t,"b",(function(){return o.a})),n.d(t,"k",(function(){return o.b}));var a=n(28066);n.d(t,"a",(function(){return a.a}));var i=n(28069);n.d(t,"f",(function(){return i.a}));var c=n(28070);n.d(t,"c",(function(){return c.a})),n.d(t,"e",(function(){return c.b})),n.d(t,"g",(function(){return c.c})),n.d(t,"l",(function(){return c.d}));var s=n(28075);n.d(t,"d",(function(){return s.a}));var d=n(28077);n.d(t,"m",(function(){return d.a}));var u=n(28078);n.d(t,"n",(function(){return u.a}))},28063:function(e,t,n){"use strict";(function(e){}).call(this,n(11774))},28064:function(e,t,n){"use strict";n(28065)},28065:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));var r=n(28066),o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.a&&console.log.apply(console,e)},a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.a&&console.error.apply(console,e)},i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r.a&&console.warn.apply(console,e)}},28066:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=!1},28067:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r,o;n(28068);!function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"}(r||(r={}));function a(e,t){if(o){var n=null===window||void 0===window?void 0:window.performance;if(n&&"function"==typeof n.measure&&"function"==typeof n.mark)return new o(e,t,n)}}},28068:function(e,t,n){"use strict";function r(e){var t;if(null===(t=null===window||void 0===window?void 0:window.crypto)||void 0===t?void 0:t.getRandomValues){var n=window.crypto.getRandomValues(new Uint32Array(1))[0];return e?n%e:n}var r=Math.random();return e?Math.floor(r*e):r}n.d(t,"a",(function(){return r}))},28069:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(28066);function o(e,t){return void 0===t&&(t=0),e?e.split("\n").slice(1+t,r.a?void 0:2+t).join("\n"):"<unable to get stack>"}function a(){try{throw new Error}catch(e){return e instanceof Error?o(e.stack,1):""}}},28070:function(e,t,n){"use strict";var r=n(28071);n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c}));var o=n(28072);n.d(t,"b",(function(){return o.a}))},28071:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(28066),o=n(28069),a=n(28072),i=n(28074),c=function e(t,n,r){var o=Object(i.a)(t,n,r);return o.name="StructuredError",o.innerException=r,o.tag=n,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,e),o};function s(e,t){return!(!e||!(e instanceof c||void 0!==e.isStructuredError)||t&&e.name!==t)}function d(e){if(s(e))return e.stringify();if(e instanceof Error){var t=c.enableUnknownMessageLogging&&e.message?" - ".concat(e.message):"";return"".concat(e.name).concat(t,":\n").concat(c.enableStackLogging?Object(o.b)(e.stack):"")}return c.enableUnknownMessageLogging&&"string"==typeof e?e:"Unknown error"}c.enableStackLogging=r.a,c.enableMessageLogging=r.a,c.enableUnknownMessageLogging=r.a,c.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0},stringify:{value:function(){return Object(a.a)(this.tag,this.stack,void 0,this.innerException)},enumerable:!1,writable:!0,configurable:!0},isStructuredError:{value:!0,enumerable:!1,writable:!1,configurable:!1}}),Object.setPrototypeOf?Object.setPrototypeOf(c,Error):c.__proto__=Error},28072:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28073),o=n(28071);function a(e,t,n,a){return[o.a.enableMessageLogging&&n?n:void 0,"Tag: ".concat(e),o.a.enableStackLogging?t:void 0,a?"----------\nInner exception: ".concat(Object(o.c)(a)):void 0].filter(r.a).join("\n")}},28073:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=Boolean},28074:function(e,t,n){"use strict";function r(e,t,n){return new Error(e)}n.d(t,"a",(function(){return r}))},28075:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28076),o=Object(r.a)(0),a={reserve:function(){return o},reserveTag:r.a}},28076:function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},28077:function(e,t,n){"use strict";function r(e){throw new Error("Unreachable throw hit! Passed in value is ".concat(e,"."))}n.d(t,"a",(function(){return r}))},28078:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28070);function o(e,t,n){if(!e)throw new r.a(t,n)}},28079:function(e,t,n){"use strict";n(28080);var r=n(28085);n.d(t,"e",(function(){return r.a}));var o=n(28090);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"c",(function(){return o.c})),n.d(t,"d",(function(){return o.d}))},28080:function(e,t,n){"use strict";var r=n(28081);n.d(t,"a",(function(){return r.a}))},28081:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28082),o=n(28084),a=new r.a("FeatureGate",o.a)},28082:function(e,t,n){"use strict";var r=n(28083);n.d(t,"a",(function(){return r.a}))},28083:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(12708),o=n(28062),a=function(){function e(e,t){var n=this;this.apiName=e,this.DefaultCtor=t,this.reset=function(){n.instance=void 0,n.ctorStack=void 0,n.injectionStack=void 0}}return e.prototype.getAndInitialize=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.instance)throw new o.c("'".concat(this.apiName,"' singleton is already initialized"),o.d.reserveTag(538035215));if(!this.DefaultCtor)throw new o.c("'".concat(this.apiName,"' not initialized but no default constructor exists"),o.d.reserveTag(538035216));return this.ctorStack=Object(o.f)(),this.instance=new((e=this.DefaultCtor).bind.apply(e,Object(r.__spreadArray)([void 0],t,!1)))},e.prototype.getInstanceOrThrow=function(){var e=this.instance;if(!e)throw new o.c("'".concat(this.apiName,"' singleton has not been initialized"),o.d.reserveTag(538035217));return e},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(e){if(this.getInstance())throw new o.c("API has already been initialized.\nFirst initialization: ".concat(this.ctorStack),o.d.reserveTag(538035218));this.DefaultCtor=e},e.prototype.injectInstance=function(e){if(this.getInstance())throw new o.c("API has already been initialized or injected.\nInitialize or Inject Callstack: ".concat(this.getInjectOrInitializeStack()),o.d.reserveTag(538035219));this.injectionStack=Object(o.f)(),this.instance=e},e.prototype.getInjectOrInitializeStack=function(){var e,t;return null!==(t=null!==(e=this.ctorStack)&&void 0!==e?e:this.injectionStack)&&void 0!==t?t:"Callstack Not Retrieved"},e}()},28084:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28062),o=function(){function e(e){if(!e)throw new r.c("Missing required arguments in FeatureGateAPIImpl!",r.d.reserveTag(589103760));this.appSettings=e.appSettings,this.gateMapping=e.mapping}return e.prototype.isTrue=function(e){return!!this.appSettings[e]&&"true"===this.appSettings[e]},e.prototype.isFeatureEnabled=function(e){if(!this.appSettings||!this.gateMapping)throw new r.c("FeatureGate API not initialized!",r.d.reserveTag(589103761));var t=this.gateMapping[e].webSettingName;return!!t&&this.isTrue(t)},e.prototype.isChangeGateEnabled=function(e,t){if(!this.appSettings||!this.gateMapping)throw new r.c("FeatureGate API not initialized!",r.d.reserveTag(589103762));var n=this.disabledChangeGates;return!n||n.split(",").indexOf(e)<0},Object.defineProperty(e.prototype,"disabledChangeGates",{get:function(){return this.appSettings.DisabledChangeGates},enumerable:!1,configurable:!0}),e}()},28085:function(e,t,n){"use strict";n(28086),n(28087),n(28088);var r=n(28089);n.d(t,"a",(function(){return r.a}))},28086:function(e,t,n){"use strict"},28087:function(e,t,n){},28088:function(e,t,n){},28089:function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},28090:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return c}));var r=n(28080);function o(e){return r.a.getAndInitialize(e)}function a(){r.a.reset()}function i(){return r.a.getInstanceOrThrow()}function c(){return void 0!==r.a.getInstance()}},28091:function(e,t,n){"use strict";var r=n(28092);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),n.d(t,"e",(function(){return r.e})),n.d(t,"f",(function(){return r.f})),n.d(t,"g",(function(){return r.g})),n.d(t,"h",(function(){return r.h})),n.d(t,"i",(function(){return r.i})),n.d(t,"j",(function(){return r.j})),n.d(t,"k",(function(){return r.k})),n.d(t,"l",(function(){return r.l})),n.d(t,"m",(function(){return r.m})),n.d(t,"n",(function(){return r.n})),n.d(t,"o",(function(){return r.o}))},28092:function(e,t,n){"use strict";n(28093);var r=n(28094);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),n.d(t,"f",(function(){return r.e})),n.d(t,"h",(function(){return r.f}));var o=n(28103);n.d(t,"g",(function(){return o.a})),n.d(t,"l",(function(){return o.b}));var a=n(28104);n.d(t,"e",(function(){return a.a})),n.d(t,"o",(function(){return a.b}));var i=n(28115);n.d(t,"i",(function(){return i.a})),n.d(t,"k",(function(){return i.b})),n.d(t,"m",(function(){return i.c}));var c=n(28120);n.d(t,"j",(function(){return c.a}));n(28119);var s=n(28145);n.d(t,"n",(function(){return s.a}))},28093:function(e,t,n){"use strict";function r(e,t){return void 0===e?t:{visit:function(n){e.visit(n),t.visit(n)}}}n.d(t,"a",(function(){return r}))},28094:function(e,t,n){"use strict";var r=n(28095);n.d(t,"a",(function(){return r.a}));var o=n(28096);n.d(t,"b",(function(){return o.a}));n(28097),n(28098);var a=n(28099);n.d(t,"c",(function(){return a.a}));var i=n(28100);n.d(t,"e",(function(){return i.a}));var c=n(28101);n.d(t,"f",(function(){return c.a}));var s=n(28102);n.d(t,"d",(function(){return s.a}))},28095:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess",e[e.AggregateSubtree=3]="AggregateSubtree",e[e.NotSet=999]="NotSet"}(r||(r={}))},28096:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent"}(r||(r={}))},28097:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.EventExportability_NotSet=0]="EventExportability_NotSet",e[e.EventExportability_NotExported=1]="EventExportability_NotExported"}(r||(r={}))},28098:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact"}(r||(r={}))},28099:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotSet=0]="NotSet",e[e.ProductServiceUsage=2]="ProductServiceUsage"}(r||(r={}))},28100:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Required=1]="Required",e[e.Basic=2]="Basic",e[e.All=3]="All"}(r||(r={}))},28101:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose",e[e.Spam=5]="Spam"}(r||(r={}))},28102:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(r||(r={}))},28103:function(e,t,n){"use strict";var r;function o(e,t){return{visit:function(){}}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.GlobalAPI=1]="GlobalAPI",e[e.ReviewedAsNotNecessary=2]="ReviewedAsNotNecessary",e[e.Test=3]="Test",e[e.Todo=4]="Todo"}(r||(r={}))},28104:function(e,t,n){"use strict";n(28105),n(28106),n(28107);var r=n(28108);n.d(t,"b",(function(){return r.a}));n(28109);var o=n(28110);n.d(t,"a",(function(){return o.a}));n(28111),n(28112),n(28113),n(28114)},28105:function(e,t,n){},28106:function(e,t,n){},28107:function(e,t,n){},28108:function(e,t,n){"use strict";function r(e,t,n){return{key:e,value:t,dataClassification:n}}n.d(t,"a",(function(){return r}))},28109:function(e,t,n){},28110:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Normal=0]="Normal",e[e.Critical=1]="Critical"}(r||(r={}))},28111:function(e,t,n){},28112:function(e,t,n){},28113:function(e,t,n){},28114:function(e,t,n){},28115:function(e,t,n){"use strict";var r=n(28116);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var o=n(28121);n.d(t,"c",(function(){return o.a}))},28116:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r,o,a=n(28062),i=n(28117),c=n(28118),s=void 0;function d(e){return!0===e.testOnly}function u(){if(r||(r=Object(a.f)()),!s){var e=new c.a;return function(e){if(s){if(d(s))return void(d(e)&&(s=e));if(r)throw new a.c(["'getTelemetryAPI' was called before a stub API was injected.","First call to getTelemetryAPI originated from:",r].join("\n"),i.h);throw new a.c("ClientTelemetryAPI cannot be re-initialized.\nFirst initialized from ".concat(o),i.a)}o||(o=Object(a.f)()),s=e}(e),e}return s}function l(){s=void 0,r=void 0,o=void 0}},28117:function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"a",(function(){return m}));var r=n(28062),o=r.d.reserveTag(590899029),a=r.d.reserveTag(590899030),i=r.d.reserveTag(590899031),c=r.d.reserveTag(590899032),s=r.d.reserveTag(590899033),d=r.d.reserveTag(578937436),u=r.d.reserveTag(578937437),l=r.d.reserveTag(578937438),f=(r.d.reserveTag(576717443),r.d.reserveTag(576717444)),m=r.d.reserveTag(576717445);r.d.reserveTag(523891986),r.d.reserveTag(523891987),r.d.reserveTag(523629772),r.d.reserveTag(523629773)},28118:function(e,t,n){"use strict";var r=n(28062),o=n(28117),a=n(28119),i=function(){function e(){this.isInitialized=!1,this.deferredInitializationCallbacks=[]}return e.prototype.init=function(e){var t,n=this;this.isInitialized?this.assertConditionTag(!1,"ClientTelemetryAPI init called twice!",595644941):(this.hostAPI=e,this.isInitialized=!0,this.deferredInitializationCallbacks.map((function(e){return e(n)})),this.deferredInitializationCallbacks=[],this.logDiagnosticTrace=null===(t=this.hostAPI.logDiagnosticTrace)||void 0===t?void 0:t.bind(this.hostAPI))},e.prototype.hasBeenInitialized=function(){return this.isInitialized},e.prototype.onInitialized=function(e){this.isInitialized?e(this):this.deferredInitializationCallbacks.push(e)},e.prototype.createActivityObject=function(e,t,n,i){this.checkIsInitialized(),Object(r.n)(e[0]>="A"&&e[0]<="Z","Activity name should start with a capital letter.",o.g),Object(r.n)(this.hostAPI,"Host API must be defined",o.f);var c=Object(a.a)(n);return this.hostAPI.createActivityObject(e,t,c,i)},e.prototype.assertCondition=function(e,t){this.checkIsInitialized(),this.assertConditionTag(e,t,o.c)},e.prototype.assertConditionTag=function(e,t,n){this.checkIsInitialized(),e||(Object(r.j)("*ASSERT* 0x".concat(n.toString(16)," : ").concat(t)),Object(r.n)(this.hostAPI,"Host API must be defined",o.f),this.hostAPI.logErrorData(n,t))},e.prototype.getMetadata=function(){return Object(r.n)(this.hostAPI,"Host API must be defined",o.f),this.hostAPI.getMetadata()},e.prototype.checkIsInitialized=function(){if(!this.isInitialized||!this.hostAPI)throw new r.c("ClientTelemetryAPI is not initialized",o.b)},e.prototype.logFloodgateActivity=function(e){this.checkIsInitialized(),Object(r.n)(this.hostAPI,"Host API must be defined",o.f),this.hostAPI.logFloodgateActivity&&this.hostAPI.logFloodgateActivity(e)},e}();t.a=i},28119:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12708),o=n(28120),a=Object(o.a)();function i(e){var t,n;return Object(r.__assign)(Object(r.__assign)({},a),{diagnosticLevel:null!==(t=e.diagnosticLevel)&&void 0!==t?t:a.diagnosticLevel,samplingPolicy:null!==(n=e.samplingPolicy)&&void 0!==n?n:a.samplingPolicy})}},28120:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(28095),o=n(28096),a=n(28097),i=n(28098),c=n(28099);function s(){return{aggregationMode:r.a.NotSet,diagnosticLevel:o.a.NecessaryServiceDataEvent,dataCategories:c.a.ProductServiceUsage,samplingPolicy:i.a.Measure,exportability:a.a.EventExportability_NotSet}}},28121:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28122),o=n(28116);function a(e,t){Object(o.b)().init(new r.a(e,t))}},28122:function(e,t,n){"use strict";var r=n(28123);n.d(t,"a",(function(){return r.a}))},28123:function(e,t,n){"use strict";var r=n(28124);n.d(t,"a",(function(){return r.a}))},28124:function(e,t,n){"use strict";var r=n(28125);n.d(t,"a",(function(){return r.a}))},28125:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n(12708),o=n(28062),a=n(28135),i=n(28140),c=n(28138),s=n(28117),d=n(28093),u=n(28094),l=n(28103),f=n(28116),m=n(28120),p=n(28126),g=n(28127),v=n(28129),h=n(28133),b=n(28131),C=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.sdxMetadata=t,r.namespaceString="Office.Docs.SharedComments",r.ariaTenantToken="c274b3e05ac5448dae8fbb7466da6acb-fd6dc8de-18b7-409c-a696-4bd66f7a5322-7902",r.disableUpload=o.a,r.telemetryLogger=new a.a,r.isFloodgateServiceEnabled=!1,r.logDiagnosticTrace=function(e,t,n,a,i){for(var c=[],s=5;s<arguments.length;s++)c[s-5]=arguments[s];if(r.hostTelemetrySupport.sendULSTrace){var d=b.c,l=b.a.Spam;switch(n){case u.f.Spam:break;case u.f.Verbose:l=b.a.Verbose;break;case u.f.Info:l=b.a.Info;break;case u.f.Warning:l=b.a.Warning,d=b.b;break;case u.f.Error:l=b.a.Error,d=b.b;break;default:Object(o.m)(n)}r.hostTelemetrySupport.sendULSTrace(t,d,l,r.formatDetails(e,c))}},r.initialize(),r}return Object(r.__extends)(t,e),t.prototype.initialize=function(){var e=this;void 0!==this.hostTelemetrySupport.disableUpload&&(this.disableUpload=this.hostTelemetrySupport.disableUpload),this.disableUpload||(Object(i.c)().addListener((function(t){void 0===e.hostTelemetrySupport.sendULSTrace||0!==t.level&&1!==t.level||e.hostTelemetrySupport.sendULSTrace(s.i,b.b,b.a.Error,"OTel Notification - Level: ".concat(t.level,", Category: ").concat(t.category,", Message: ").concat(t.message()))})),this.telemetryLogger.setTenantToken(this.namespaceString,this.ariaTenantToken,c.b),h.a(this.telemetryLogger,this.sdxMetadata,this.hostTelemetrySupport))},t.prototype.createActivityObject=function(e,t,n){return this.disableUpload?new p.a:Object(v.a)(this.namespaceString,e,this.telemetryLogger,this.hostTelemetrySupport,Object(d.a)(t,this),n)},t.prototype.logErrorData=function(e,t){this.disableUpload||(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,b.b,b.a.Error,t),this.createActivityObject("LogError",Object(l.b)(l.a.ReviewedAsNotNecessary),Object(m.a)()).failTag(e,-2130957533))},t.prototype.logFloodgateActivity=function(e){!this.disableUpload&&window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&this.ensureFloodgateServiceEnabled().then((function(){var t=OfficeBrowserFeedback.floodgate.getEngine();if(t){var n=t.getActivityListener();n&&n.logActivity(e)}return Promise.resolve()})).catch((function(){}))},t.prototype.ensureFloodgateServiceEnabled=function(){var e=this;return this.isFloodgateServiceEnabled?Promise.resolve():window.OfficeBrowserFeedback.floodgate.initialize().then((function(){return window.OfficeBrowserFeedback.floodgate.start().then((function(){return e.isFloodgateServiceEnabled=!0,Promise.resolve()})).catch((function(e){return Object(f.b)().assertConditionTag(!1,"floodgate.start() failed: ".concat(e.message),s.e),Promise.reject()}))})).catch((function(e){return Object(f.b)().assertConditionTag(!1,"floodgate.initialize() failed: ".concat(e.message),s.d),Promise.reject()}))},t.prototype.visit=function(e){},t.prototype.formatDetails=function(e,t){return"".concat(e,"\n").concat(t.map(this.transformDataField).join(""))},t.prototype.transformDataField=function(e){return"{ ".concat(e.key,": ").concat(e.value,", DataFieldClassification: ").concat(e.dataClassification," }\n")},t}(g.a)},28126:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){this.EMPTY_IMPL=!0}return e.prototype.success=function(){},e.prototype.successTag=function(e){},e.prototype.fail=function(e){},e.prototype.failTag=function(e,t){},e.prototype.addDataField=function(e,t,n){},e.prototype.addDocumentMetadata=function(e){},e.prototype.attachContext=function(e){},e.prototype.isEnded=function(){return!1},e}()},28127:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28128),o=function(){function e(e,t){void 0===t&&(t=Object(r.a)()),this.sdxMetadata=e,this.hostTelemetrySupport=t,this.logDiagnosticTrace=void 0}return e.prototype.getMetadata=function(){var e=this.hostTelemetrySupport;return{appName:e.appName,appVersion:e.appVersion,dataCenter:e.dataCenter,releaseAudience:e.releaseAudience,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,ring:e.ring,sessionId:e.sessionId,sovereignEnvironmentName:e.sovereignEnvironmentName}},e}()},28128:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r={appName:"TestHost",appVersion:"1.0",releaseAudience:"Internal",releaseChannel:"Insiders",sessionId:"D9430514-C886-445F-891C-6C0E7F774EF7"};function o(){return r}},28129:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12708),o=n(28132),a=n(28096),i=n(28098),c=n(28099),s=n(28102),d=n(28130),u=n(28131);function l(e,t,n,r,o,a){return new f(e,t,n,o,r,a)}var f=function(e){function t(t,n,r,o,a,i){var c=e.call(this,o)||this;return c.activityNamespace=t,c.activityName=n,c.fullActivityName="".concat(c.activityNamespace,".").concat(c.activityName),c.activityScope=r.createActivity({eventName:c.fullActivityName,eventFlags:{dataCategories:p(i.dataCategories),diagnosticLevel:m(i.diagnosticLevel),samplingPolicy:g(i.samplingPolicy)}}),c.hostTelemetrySupport=a,c}return Object(r.__extends)(t,e),t.prototype.successTag=function(e){this.finalize()&&(this.activityScope.success=!0,this.activityScope.setResult(0,void 0,e),this.activityScope.endNow(),this.hostTelemetrySupport.recordActivity&&this.hostTelemetrySupport.recordActivity(this.activityName))},t.prototype.failTag=function(e,t){this.finalize()&&(this.activityScope.success=!1,this.activityScope.setResult(t,void 0,e),void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,u.b,u.a.Error,"".concat(this.fullActivityName," Failed")),this.activityScope.endNow())},t.prototype.addDataField=function(e,t,n,r){if(!this.isEnded()&&n===s.a.SystemMetadata){var a,i,c,d=n||4;switch(typeof t){case"boolean":(a=Object(o.a)(e,t)).classification=d;break;case"number":(a=Object(o.b)(e,t)).classification=d;break;case"string":(a=Object(o.d)(e,t)).classification=d;break;default:throw new Error("Unknown type")}this.activityScope.dataFields.push(a),r&&(i=a,(c=this.hostTelemetrySupport).recordActivity&&c.recordActivity(i.name))}},t.prototype.attachContext=function(e){},t.prototype.addDocumentMetadata=function(e){},t}(d.a);function m(e){switch(e){case a.a.BasicEvent:return 10;case a.a.FullEvent:return 100;case a.a.NecessaryServiceDataEvent:return 110;default:throw new Error("UnSupported ActivityDiagnosticLevel")}}function p(e){switch(e){case c.a.NotSet:case c.a.ProductServiceUsage:return 2;default:throw new Error("UnSupported DataCategories")}}function g(e){switch(e){case i.a.NotSet:case i.a.Measure:return 1;case i.a.CriticalBusinessImpact:return 191;default:throw new Error("UnSupported ActivitySamplingPolicy")}}},28130:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28062),o=function(){function e(e){this._visitor=e,this._ended=!1}return e.prototype.finalize=function(){return this._ended?(Object(r.h)("ActivityObject has already been ended"),!1):(this._visitor&&this._visitor.visit(this),this._ended=!0,!0)},e.prototype.success=function(){this.successTag(0)},e.prototype.fail=function(e){this.failTag(0,e)},e.prototype.isEnded=function(){return this._ended},e}()},28131:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r}));var r,o=201,a=327;!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam",e[e.ShiftFactor=1e3]="ShiftFactor"}(r||(r={}))},28132:function(e,t,n){"use strict";function r(e,t,n){return c(e,1,t,n)}function o(e,t,n){return c(e,2,t,n)}function a(e,t,n){return c(e,3,t,n)}function i(e,t,n){return c(e,0,t,n)}function c(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i}))},28133:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28132),o=n(28134);function a(e,t,n){e.persistentDataFields=function(e,t){var n=[];return n.push(Object(r.d)("SDX.Name",e.name)),n.push(Object(r.d)("SDX.Version",e.version)),n}(t),e.addSink(new o.a(n))}},28134:function(e,t,n){"use strict";var r=n(28062),o=n(28117),a=n(28131),i=function(){function e(e){this.hostTelemetrySupport=e}return e.prototype.sendTelemetryEvent=function(e,t){var n;if(void 0!==this.hostTelemetrySupport.sendOtelEvent){this.hostTelemetrySupport.sendOtelEvent({otelEvent:e});try{if(this.hostTelemetrySupport.recordPerfData&&e.eventContract&&e.dataFields){if("Activity.Duration"!==e.eventContract.dataFields[1].name)return;var i=+e.eventContract.dataFields[1].value;if(isNaN(i))return;var c=i/1e3;if("Office.Docs.SharedComments.RenderPaneIntoView"===e.eventName)this.hostTelemetrySupport.recordPerfData("RenderPaneIntoView",c);else if("Office.Docs.SharedComments.E2EPerfTracker"===e.eventName&&"OperationType"===e.dataFields[0].name)switch(e.dataFields[0].value){case"REPLY":this.hostTelemetrySupport.recordPerfData("SharedCommentsCommentReply",c);break;case"CREATE":this.hostTelemetrySupport.recordPerfData("SharedCommentsCreateThread",c);break;case"EDIT":this.hostTelemetrySupport.recordPerfData("SharedCommentsEditComment",c)}}}catch(s){return void(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(o.j,a.b,a.a.Error,"Error recording performance data: ".concat(null!==(n=null==s?void 0:s.message)&&void 0!==n?n:Object(r.l)(s))))}}else void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(o.j,a.b,a.a.Error,"sendOtelEvent API undefined")},e}();t.a=i},28135:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(12708),o=n(28138),a=n(28137),i=n(28144),c=n(28143),s=n(28136),d=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.baseCv=Object(s.a)(),o}return Object(r.__extends)(t,e),t.prototype.createActivity=function(e){return Object(a.a)({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:c.a.contractName,dataFields:c.a.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=i.a.getFields(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return Object(a.a)({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(o.a)},28136:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return a}));var o=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();function a(){if(!r){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));r=new o(t.join(""))}return r}},28137:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12708),o=n(28143),a=n(28140),i=n(28138),c=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(c=function(){return 1e3*Math.floor(window.performance.now())});var s=function(e){var t,n=c(),d=Object(i.c)(e.telemetryEvent);return Object(r.__assign)(Object(r.__assign)({cv:e.parentCv.getNext()},d),{createChildActivity:function(t){return s({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var r,i,s=this;if(!t){void 0===this.success&&void 0===this.result&&Object(a.b)(1,0,(function(){return"Activity does not have success or result set"}));var d=c();t=!0;var u={duration:d-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},l=null!==(i=null===(r=this.eventContract)||void 0===r?void 0:r.dataFields)&&void 0!==i?i:[];return l.push.apply(l,o.a.getFields(u)),this.eventContract={name:o.a.contractName,dataFields:l},e.sendTelemetryEvent(this)}Object(a.b)(0,0,(function(){return"'".concat(s.eventName,"' already ended")}))}})}},28138:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(12708),o=n(28139),a=n(28142),i=n(28140),c=n(28141),s=n(28132),d=-1;function u(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(r.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var l=function(){function e(e,t,n){var o,a,i;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(o=this.persistentDataFields).push.apply(o,e.persistentDataFields),this.config=Object(r.__assign)(Object(r.__assign)({},e.getConfig()),this.config),(a=this.partAFields).push.apply(a,e.partAFields)),t&&(i=this.persistentDataFields).push.apply(i,t)}return e.prototype.addEventContentType=function(e,t){e.push(Object(s.c)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=u(e),n=t.telemetryProperties;n.nexusTenantToken=d;var r=n.ariaTenantToken;if(!r&&(!Object(o.a)(t.eventName,n)&&!r))return void Object(i.b)(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var n=u(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=u(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=u(e),n=t.telemetryProperties;if(!n.dnmToken&&(!Object(o.a)(t.eventName,n)&&!n.dnmToken))return void Object(i.b)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):Object(i.b)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(n){return void Object(i.a)(0,"SendTelemetryEvent",n)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(r){}}))}else Object(i.b)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,o;if(e.dataFields&&(null===(o=e.dataFields)||void 0===o||o.unshift(Object(s.d)("OTelJS.Version",c.a)),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(r=i.dataFields).push.apply(r,this.partAFields),e.eventContract=i}this.config.disableValidation||Object(a.a)(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],o=r[0],a=r[1];this.sendTelemetryEventInternal(o,a)}},e.prototype.setTenantToken=function(e,t,n){Object(o.b)(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){Object(o.b)(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return u(e)},e.prototype.getConfig=function(){return this.config},e}()},28139:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(28140),o={};function a(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?o[e]?(t.ariaTenantToken&&(o[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(o[e].dnmToken=t.dnmToken)):o[e]=t:Object(r.b)(0,0,(function(){return"Namespace: ".concat(e)}))}function i(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(o[r]){var a=o[r];return t.ariaTenantToken=a.ariaTenantToken,t.dnmToken=a.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}},28140:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r,o=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function a(){return o}function i(e,t,n){o.fireEvent({level:e,category:t,message:n})}function c(e,t,n){i(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}},28141:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="4.20.30"},28142:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,o=/^[a-zA-Z0-9_\.]{1,95}$/;function a(e){if(!function(e){if(!e||e.length>98)return!1;return r.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!i(t.name))throw new Error("Invalid eventContract");c(t.dataFields)}c(e.dataFields)}function i(e){return o.test(e)}function c(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!i(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}},28143:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(28132);function o(e,t){return e?e+"."+t:t}function a(e,t,n,a,i){void 0===i&&(i=4),a&&e.push(Object(r.d)("".concat(o(t,n)),a,i))}function i(e,t,n,a){"boolean"==typeof a&&e.push(Object(r.a)("".concat(o(t,n)),a))}function c(e,t,n,a){"number"==typeof a&&e.push(Object(r.c)("".concat(o(t,n)),a))}var s,d=function(e){var t=[];return c(t,"Activity.Result","Code",e.code),a(t,"Activity.Result","Type",e.type),c(t,"Activity.Result","Tag",e.tag),i(t,"Activity.Result","IsExpected",e.isExpected),t.push(Object(r.d)("zC.Activity.Result","Office.System.Result")),t},u={contractName:"Office.System.Activity",getFields:function(e){var t=[];return a(t,"Activity","CV",e.cV),c(t,"Activity","Duration",e.duration),c(t,"Activity","Count",e.count),c(t,"Activity","AggMode",e.aggMode),i(t,"Activity","Success",e.success),e.result&&t.push.apply(t,d(e.result)),t.push(Object(r.d)("zC.Activity",this.contractName)),t}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(s||(s={}));var l;!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(l||(l={}));var f,m;!function(e){!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),e.getFields=function(e){var t=[];return a(t,"Copilot","FeatureActionType",e.featureActionType),i(t,"Copilot","IsUserInitiated",e.isUserInitiated),a(t,"Copilot","FeatureName",e.featureName),a(t,"Copilot","SubFeatureName",e.subFeatureName),a(t,"Copilot","Capability",e.capability),i(t,"Copilot","IsThumbsUp",e.isThumbsUp),a(t,"Copilot","EntryPoint",e.entryPoint),a(t,"Copilot","Verb",e.verb),a(t,"Copilot","InteractionId",e.interactionId),a(t,"Copilot","ConversationId",e.conversationId),t.push(Object(r.d)("zC.".concat("Copilot"),"Office.System.Copilot")),t}}(f||(f={})),function(e){!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var t=[];return a(t,"Asha","EventType",e.eventType),a(t,"Asha","Pillar",e.pillar),a(t,"Asha","Scenario",e.scenario),a(t,"Asha","Veto",e.veto),a(t,"Asha","Error",e.error),i(t,"Asha","InStaging",e.inStaging),i(t,"Asha","IsSessionEndingError",e.isSessionEndingError),i(t,"Asha","IsIntentional",e.isIntentional),i(t,"Asha","IsInternal",e.isInternal),t.push(Object(r.d)("zC.".concat("Asha"),"Office.System.Asha")),t}}(m||(m={}))},28144:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28132),o={getFields:function(e){var t=[];return t.push(Object(r.d)("".concat("Error",".ErrorGroup"),e.errorGroup)),t.push(Object(r.c)("".concat("Error",".Tag"),e.tag)),void 0!==e.code&&t.push(Object(r.c)("".concat("Error",".Code"),e.code)),void 0!==e.id&&t.push(Object(r.c)("".concat("Error",".Id"),e.id)),void 0!==e.count&&t.push(Object(r.c)("".concat("Error",".Count"),e.count)),t}}},28145:function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},28146:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r,o=n(28091);function a(e){r=e}function i(){r=void 0}function c(e){r?r.announceToScreenReader(e):Object(o.k)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&a(e)},e}(),d=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},28147:function(e,t,n){"use strict";var r=n(28148);n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return r.b}));var o=n(28164);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b}))},28148:function(e,t,n){"use strict";var r=n(28149);n.d(t,"b",(function(){return r.b})),n.d(t,"a",(function(){return r.a}));n(28163)},28149:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r,o=n(28150);function a(){r=void 0}function i(){if(void 0===r){var e=new o.a;e.initialize(),r=e}return r}},28150:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12708),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t}(n(28151).a)},28151:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12708),o=n(28152),a=n(28160),i=n(28161),c=n(28162),s=function(){function e(){this.componentMap={},this.onComponentStateChanged=new o.EventImpl((function(){})),this.onComponentCommand=new o.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return this.componentMap[e]=t,this.onComponentStateChanged.trigger({componentName:e,state:a.a.Registered}),new i.a(e,this)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],this.onComponentStateChanged.trigger({componentName:e,state:a.a.Unregistered})},e.prototype.getComponent=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,new c.a(e,this)]}))}))},e}()},28152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataServiceRegistry=t.DataServiceManager=t.EventImpl=t.registerClasses=t.RekaServiceRegistry=t.RekaInstance=t.CustomTypeRegistry=void 0;var r=n(28153);Object.defineProperty(t,"CustomTypeRegistry",{enumerable:!0,get:function(){return r.CustomTypeRegistry}});var o=n(28156);Object.defineProperty(t,"RekaInstance",{enumerable:!0,get:function(){return o.RekaInstance}}),Object.defineProperty(t,"RekaServiceRegistry",{enumerable:!0,get:function(){return o.RekaServiceRegistry}}),Object.defineProperty(t,"registerClasses",{enumerable:!0,get:function(){return o.registerClasses}});var a=n(28159);Object.defineProperty(t,"EventImpl",{enumerable:!0,get:function(){return a.EventImpl}});var i=n(28156);Object.defineProperty(t,"DataServiceManager",{enumerable:!0,get:function(){return i.RekaInstance}}),Object.defineProperty(t,"DataServiceRegistry",{enumerable:!0,get:function(){return i.RekaServiceRegistry}})},28153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTypeRegistry=void 0;var r=n(28154),o=function(){function e(){this.typeInfos={},this.typeInfosCache=[],this.externalTypes={}}return e.prototype.constuctor=function(e){void 0===e&&(e=!1),this.throwOnError=e},e.prototype.registerTypeInfos=function(e){if(-1===this.typeInfosCache.indexOf(e)){this.typeInfosCache.push(e);for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],o=this.typeInfos[r];o?o!==e[r]&&this.handleError("There are two definitions of the same namespace and interface: ".concat(r)):this.typeInfos[r]=e[r]}}},e.prototype.getTypeInfo=function(e){var t=this.typeInfos[e];if(t)return t;this.handleError('CustomTypeInfo "'.concat(e,'" not registered as a custom types.'))},e.prototype.registerExternalTypeInfos=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];this.externalTypes[r]?this.handleError('The external type "'.concat(r,'" is already defined.')):this.externalTypes[r]=e[r]}},e.prototype.getExternalType=function(e){return this.externalTypes[e]},e.prototype.getExternalTypeInfos=function(){return this.externalTypes},e.prototype.validateParsedObj=function(e,t){for(var n=0,o=Object.keys(t);n<o.length;n++){var a=o[n];e[a]=(0,r.verifyType)(this,e[a],t[a])}return e},e.prototype.setThrowOnError=function(e){this.throwOnError=e},e.prototype.handleError=function(e){if(this.throwOnError)throw new Error(e)},e}();t.CustomTypeRegistry=new o},28154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyType=void 0;var r=n(28155);function o(e,t){t&&e.handleError("Type of property does not match type in CustomTypes definition.")}function a(e,t,n,o){for(var a=0,i=Object.keys(t);a<i.length;a++){var c=i[a],s=n[c];if(s){var u=(0,r.readPropertyInfo)(s)[1];t[c]=d(e,t[c],u,o)}else c.startsWith("$")||e.handleError('Property "'.concat(c,'" does not exist in CustomType definition.'))}return t}function i(e,t,n){for(var r=0,o=Object.keys(t);r<o.length;r++){var a=o[r];t[a]=d(e,t[a],n)}return t}function c(e,t,n,o){if(!n)return e.handleError("Unable to generate default value for unregistered type."),t;for(var a=0,i=Object.keys(n);a<i.length;a++){var c=i[a],d=(0,r.readPropertyInfo)(n[c]),u=d[0],l=d[1];if((t.hasOwnProperty(c)||!u)&&void 0===t[c]){var f=s(e,void 0,l,o);void 0!==f&&(t[c]=f)}}return t}function s(e,t,n,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!1),!r&&!o&&null==t)if("string"==typeof n)switch(n){case"$string":return"";case"$number":return 0;case"$boolean":return!1;case"$any":return;default:return c(e,t={},e.getTypeInfo(n),r)}else{var a=n[0],i=n[1];switch(a){case"$array":return[];case"$indexer":return{};case"$union":return c(e,t={},e.getTypeInfo(i[0]),r)}}return null!=t?t:void 0}function d(e,t,n,r){if(void 0===r&&(r=!1),null!=t)if("string"==typeof n)switch(n){case"$string":o(e,"string"!=typeof t);break;case"$number":o(e,"number"!=typeof t);break;case"$boolean":o(e,"boolean"!=typeof t);break;case"$any":if("object"==typeof t)for(var u=0,l=Object.keys(t);u<l.length;u++){var f=l[u];t[f]=d(e,t[f],n,r)}break;default:var m=e.getTypeInfo(n);return m?(a(e,t,m,r),c(e,t,m,r)):t}else{var p=n[0],g=n[1];switch(p){case"$array":var v=Array.isArray(t);return o(e,!v),v?i(e,t,g):t;case"$indexer":var h=!("object"==typeof t&&Array.isArray(t)||"object"!=typeof t);return o(e,!h),h?i(e,t,g):t;case"$union":var b=function(e,t,n,r){for(var o=0,a=Object.keys(n);o<a.length;o++){var i=a[o],c=!0,s=e.getTypeInfo(n[i]);if(s){for(var d=0,u=Object.keys(t);d<u.length;d++){if(!s[u[d]]){c=!1;break}}if(c)return s}}}(e,t,g);return b?(a(e,t,b,r),c(e,t,b,r)):(e.handleError("Json object is not assignable to any custom type in union."),t);case"$optional":return d(e,t,g),s(e,t,n,r,!0);case"$external":if("object"==typeof t){t=d(e,t,"$any",r);var C=e.getExternalType(g);if(C&&C.parse)return C.parse(t)}}}else t=s(e,t,n,r);return t}t.verifyType=d},28155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readPropertyInfo=void 0,t.readPropertyInfo=function(e){return Array.isArray(e)&&2===e.length&&"opt-field"===e[0]?[!0,e[1]]:[!1,e]}},28156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerClasses=t.registerServiceInstance=t.registerClass=t.RekaServiceRegistry=t.RekaInstance=void 0;var r=n(28157),o=n(28158);function a(e){t.RekaServiceRegistry.registerService({serviceInfo:e.ServiceInfo,factory:function(){return new e}})}function i(e){t.RekaServiceRegistry.registerService({serviceInfo:e.ServiceInfo,factory:function(){return e}})}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach((function(e){return a(e)}))}t.RekaInstance=new r.CRekaInstance(c,i),t.RekaServiceRegistry=new o.CRekaServiceRegistry(t.RekaInstance),t.registerClass=a,t.registerServiceInstance=i,t.registerClasses=c},28157:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CRekaInstance=void 0;var r=function(){function e(e,t){this.services={},this.factories={},this.nextNativePromiseId=0,this.nativePromises={},this.nativeBridge=void 0,this.registerClasses=e,this.registerServiceInstanceImpl=t}return e.prototype.initBridge=function(e,t){this.nativeBridge=e,this.registerClasses.apply(this,t),this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:"init",value:"",promiseId:0})},e.prototype.getConstantJson=function(e,t){this.verifyNativeBridgePresent();var n=this.nativeBridge.RekaConstants;if(void 0!==n){var r=n[e];if(void 0!==r){var o=r[t];if(void 0!==o)return o}}throw new Error('Reka native service "'.concat(e,'" must be registered before accessing it\'s constant property "').concat(t,'".')+" This error also happens when the service implementation does not use the generated code from the correct (usually the latest) version of Reka service definition.")},e.prototype.InvokeNative=function(e,t,n){this.verifyNativeBridgePresent(),this.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:0})},e.prototype.InvokeNativeAndReturn=function(e,t,n){var r=this;return new Promise((function(o,a){var i=++r.nextNativePromiseId;r.nativePromises[i]={onSuccess:function(e){return o(e)},onFailure:function(e){return a(e)}},r.nativeBridge?r.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:i}):a("Native bridge is not initialized.")}))},e.prototype.RegisterService=function(e,t){this.factories[e]=t},e.prototype.registerServiceInstance=function(e){this.registerServiceInstanceImpl(e)},e.prototype.invokeJavaScript=function(e){var t=this,n=e.serviceName,r=void 0===n?"":n,o=e.methodName,a=void 0===o?"":o,i=e.value,c=void 0===i?"":i,s=e.promiseId,d=void 0===s?0:s;if("$RekaBridge"===r)return this.invokeJavaScriptBridge(a,c,d);var u=(this.services[r]||(this.services[r]=this.factories[r]())).Invoke(a,c);this.nativeBridge&&u&&u.then&&u.then((function(e){return t.invokeNativeBridge("onSuccess",e,d)}),(function(e){return t.invokeNativeBridge("onFailure",e,d)}))},e.prototype.invokeNativeBridge=function(e,t,n){this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:e,value:t,promiseId:n})},e.prototype.invokeJavaScriptBridge=function(e,t,n){var r=this.nativePromises[n];r&&(delete this.nativePromises[n],r[e](t))},e.prototype.verifyNativeBridgePresent=function(){if(!this.nativeBridge)throw new Error("Native bridge is not initialized.")},e}();t.CRekaInstance=r},28158:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CRekaServiceRegistry=t.stringifyJson=t.parseJson=void 0;var r=n(28153),o=n(28159);function a(e,t){var n=e?JSON.parse(e):[];if(Array.isArray(n))return t?r.CustomTypeRegistry.validateParsedObj(n,t):n;throw new Error("Everything should be an array")}function i(e,t){if("object"==typeof t)for(var n=r.CustomTypeRegistry.getExternalTypeInfos(),o=0,a=Object.keys(n);o<a.length;o++){var i=n[a[o]];if(t instanceof i.typeConstructor){i.stringify&&(t=i.stringify(t));break}}return t}function c(e){if(Array.isArray(e))return 0===e.length?"":JSON.stringify(e,i);throw new Error("Everything should be an array")}function s(e){var t,n,r;if("string"!=typeof e){switch(e[0]){case"FireAndForgetMethod":return[(t=e)[0],void 0,t[1]];case"ReturnsPromiseMethod":return[(n=e)[0],[n[1]],n[2]];case"Event":case"Constant":return[(r=e)[0],[r[1]],void 0]}}return[e,void 0,void 0]}t.parseJson=a,t.stringifyJson=c;var d=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n,r,o=s(this.methodInfos[e])[2];try{r=a(t,o)}catch(d){throw new Error("Reka service invocation failed: JSON payload (length=".concat(t.length,") for ").concat(e," is invalid.\nInner exception: ").concat(d.stack))}var i=(n=this.service)[e].apply(n,r);if(i&&i.then)return i.then((function(e){return c([e])}))},e}(),u=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n,r=s(this.methodInfos[e])[1];try{n=a(t,r)}catch(o){throw new Error("Reka native service invocation failed: JSON payload (length=".concat(t.length,") for ").concat(e," is invalid.\nInner exception: ").concat(o.stack))}this.service[e].trigger(n[0])},e}(),l=function(){function e(e){this.nativeServices={},this.rekaInstance=e}return e.prototype.registerService=function(e){var t=e.serviceInfo,n=t[0],r=t[1],o=e.factory;this.rekaInstance.RegisterService(n,(function(){return new d(o(),r)}))},e.prototype.getNativeService=function(e){var t=this,n=e[0],r=e[1],i=this.nativeServices[n];if(!i){this.nativeServices[n]=i={};for(var d=!1,l={},f=function(e){var u=s(r[e]),f=u[0],m=u[1];switch(f){case"ReturnsPromiseMethod":i[e]=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t.rekaInstance.InvokeNativeAndReturn(n,e,c(r)).then((function(e){return a(e,m)[0]}))};break;case"FireAndForgetMethod":i[e]=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t.rekaInstance.InvokeNative(n,e,c(r))};break;case"Event":i[e]=new o.EventImpl((function(t){t&&i.eventSubscribed(e)})),d=!0;break;case"Constant":Object.defineProperty(i,e,{configurable:!1,enumerable:!0,get:function(){return void 0===l[e]&&(l[e]=a(t.rekaInstance.getConstantJson(n,e),m)[0]),l[e]}})}},m=0,p=Object.keys(r);m<p.length;m++){f(p[m])}d&&(i.eventSubscribed=function(e){t.rekaInstance.InvokeNative("$RekaBridge","createService",n)},this.rekaInstance.RegisterService(n,(function(){return new u(i,r)})))}return i},e}();t.CRekaServiceRegistry=l},28159:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventImpl=void 0;var r=function(){function e(e){this.event=e}return e.prototype.unsubscribe=function(){this.event.unsubscribe(this)},e}(),o=function(){function e(e){this.listenerUpdate=e,this.handlers=new Map,this.hasListener=!1}return e.prototype.subscribe=function(e){var t=new r(this);return this.handlers.set(t,e),this.hasListener||this.sendUpdate(!0),t},e.prototype.unsubscribe=function(e){this.handlers.delete(e),this.hasListener&&0===this.handlers.size&&this.sendUpdate(!1)},e.prototype.unsubscribeAll=function(){this.handlers.clear(),this.hasListener&&this.sendUpdate(!1)},e.prototype.trigger=function(e){this.handlers.forEach((function(t,n){return t(e,n)}))},e.prototype.sendUpdate=function(e){this.hasListener=e,this.listenerUpdate(e)},e}();t.EventImpl=o},28160:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"}(r||(r={}))},28161:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28152),o=function(){function e(e,t){var n=this;this.componentName=e,this._registryInstance=t,this.onComponentCommand=new r.EventImpl((function(){})),this._registryInstance.onComponentCommand.subscribe((function(e){e.details.componentKey===n.componentName&&n.onComponentCommand.trigger(e)}))}return e.prototype.unregister=function(){this.onComponentCommand.unsubscribeAll(),this._registryInstance.unregisterComponent(this.componentName)},e}()},28162:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28152),o=function(){function e(e,t){var n=this;this._componentName=e,this._registryInstance=t,this.onStateChanged=new r.EventImpl((function(){})),this._registryInstance.onComponentStateChanged.subscribe((function(e){e.componentName===n._componentName&&n.onStateChanged.trigger(e.state)}))}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!1,configurable:!0}),e}()},28163:function(e,t,n){},28164:function(e,t,n){"use strict";var r=n(28165);n.d(t,"b",(function(){return r.a}));var o=n(28160);n.d(t,"a",(function(){return o.a}));n(28166),n(28167),n(28168),n(28169)},28165:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Trap=1]="Trap",e[e.DoNotTrap=2]="DoNotTrap"}(r||(r={}))},28166:function(e,t,n){},28167:function(e,t,n){},28168:function(e,t,n){},28169:function(e,t,n){},28170:function(e,t,n){"use strict";n.d(t,"f",(function(){return c}));var r=n(28171),o=n(28178),a=n(28209);n.d(t,"g",(function(){return a.a}));var i=n(28181);function c(){Object(r.b)(),Object(o.a)()}n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return i.b})),n.d(t,"c",(function(){return i.c})),n.d(t,"d",(function(){return i.d})),n.d(t,"e",(function(){return i.e})),n.d(t,"h",(function(){return i.f}))},28171:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r,o=n(28172);function a(){r=void 0}function i(){return void 0===r&&(r=new o.a),r}},28172:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(12708),o=n(28062),a=n(28152),i=n(28173),c=n(28177),s=n(28184),d=n(28202),u=n(28208),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.onAfterSubscribe=n,r}return Object(r.__extends)(t,e),t.prototype.subscribe=function(t){var n=e.prototype.subscribe.call(this,t);return this.onAfterSubscribe(t,n),n},t}(a.EventImpl),f=function(){function e(){var e=this;this.contentTypeRegistrationInfo=new Map,this.extensions={},this.onAfterSubscribe=function(t,n){e.contentTypeRegistrationInfo.forEach((function(e,r){r!==s.a.Empty&&Object.keys(e).forEach((function(o){e[o]&&t({instanceId:o,contentType:r},n)}))}))},this.onExtensionFirstRequested=new l((function(){}),this.onAfterSubscribe),Object(i.b)().onExtensionUpdated.subscribe((function(t){switch(t.updateType){case c.a.ReQuery:break;case c.a.Remove:delete e.extensions[t.extension.id];break;case c.a.Add:case c.a.Modify:e.ensureExtensionCached(t.extension.id,t.extension.state);break;default:Object(o.m)(t.updateType)}}))}return e.prototype.registerExtension=function(e,t,n){var r=Object(i.b)().registerExtension(e,t,n);return this.ensureExtensionCached(r.id,r.state),Promise.resolve(this.extensions[r.id])},e.prototype.getExtensions=function(e,t){var n=this,r=new u.a(e,this);return e.forEach((function(e){var r;Object(i.b)().getExtensions(e,t).forEach((function(e){n.ensureExtensionCached(e.id,e.state)}));var o=n.contentTypeRegistrationInfo.get(e);if(void 0!==o){if(o[t])return;o[t]=!0}else n.contentTypeRegistrationInfo.set(e,((r={})[t]=!0,r));n.onExtensionFirstRequested.trigger({contentType:e,instanceId:t})})),r},e.prototype.ensureExtensionCached=function(e,t){void 0===this.extensions[e]&&(this.extensions[e]=new d.a({id:e,state:t}))},e}()},28173:function(e,t,n){"use strict";var r=n(28174);n.d(t,"a",(function(){return r.a}));var o=n(28178);n.d(t,"b",(function(){return o.b}));n(28199)},28174:function(e,t,n){"use strict";n(28175),n(28176);var r=n(28177);n.d(t,"a",(function(){return r.a}))},28175:function(e,t,n){},28176:function(e,t,n){},28177:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Modify=1]="Modify",e[e.Remove=2]="Remove",e[e.Add=3]="Add",e[e.ReQuery=4]="ReQuery"}(r||(r={}))},28178:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r,o=n(28179);function a(){if(void 0===r){var e=new o.a;e.initialize(),r=e}return r}function i(){r=void 0}},28179:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12708),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.initialize=function(){},t}(n(28180).a)},28180:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(28195),o=n(28152),a=n(28181),i=n(28174),c=n(28194),s=function(){function e(){this.onExtensionUpdated=new o.EventImpl((function(){})),this.extensionStore=new c.a}return e.prototype.triggerExtensionUpdated=function(e,t){this.onExtensionUpdated.trigger({extension:e,updateType:t})},e.prototype.registerExtension=function(e,t,n){var o,c=Object(r.a)(),s=null!==(o=n.priority)&&void 0!==o?o:a.d.Primary,d={extensionKey:c},u=n.renderMode===a.e.Isolated?{componentKey:t,contentType:e,priority:s,isContentAvailable:n.isContentAvailable,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions}:{componentKey:t,contentType:e,priority:s,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions};this.extensionStore.insertExtension(d,u);var l={id:c,state:u};return this.triggerExtensionUpdated(l,i.a.Add),l},e.prototype.unregisterExtension=function(e){var t=this.extensionStore.removeExtension(e);t&&this.triggerExtensionUpdated({id:e,state:t},i.a.Remove)},e.prototype.updateExtension=function(e,t){var n=this,r=function(t,r){t&&n.triggerExtensionUpdated({id:e,state:t},r)};t?r(this.extensionStore.updateExtension(e,t),i.a.Modify):r(this.extensionStore.getExtension(e),i.a.ReQuery)},e.prototype.getExtensions=function(e,t){var n=this.extensionStore.getExtensionsByInstance(t);if(!n)return[];var r=[];return n.forEach((function(t,n){t.contentType===e&&r.push({state:t,id:n})})),r},e.prototype.getExtension=function(e){var t=this.extensionStore.getExtension(e);if(void 0!==t)return{id:e,state:t}},e}()},28181:function(e,t,n){"use strict";var r=n(28182);n.d(t,"c",(function(){return r.a}));var o=n(28183);n.d(t,"a",(function(){return o.a}));var a=n(28184);n.d(t,"b",(function(){return a.a}));var i=n(28185);n.d(t,"d",(function(){return i.a}));var c=n(28186);n.d(t,"e",(function(){return c.a}));n(28187),n(28188),n(28189),n(28190),n(28191);var s=n(28192);n.d(t,"f",(function(){return s.a}))},28182:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="Default_7210d794-9f0f-4d0a-805c-964303b2676b"},28183:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Invalid=0]="Invalid",e[e.Disabled=1]="Disabled",e[e.Enabled_Default=2]="Enabled_Default",e[e.Enabled_ForcePrimary=3]="Enabled_ForcePrimary"}(r||(r={}))},28184:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Empty=0]="Empty",e[e.CommentThread=1]="CommentThread",e[e.TrackedChange=2]="TrackedChange"}(r||(r={}))},28185:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Disabled=0]="Disabled",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary"}(r||(r={}))},28186:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Integrated=0]="Integrated",e[e.Isolated=1]="Isolated",e[e.TaskPane=2]="TaskPane",e[e.TaskPaneItem=3]="TaskPaneItem"}(r||(r={}))},28187:function(e,t,n){},28188:function(e,t,n){"use strict";n(28186)},28189:function(e,t,n){},28190:function(e,t,n){},28191:function(e,t,n){},28192:function(e,t,n){"use strict";var r=n(28193);n.d(t,"a",(function(){return r.a}))},28193:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28183);function o(e){return e===r.a.Enabled_Default||e===r.a.Enabled_ForcePrimary}},28194:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(12708),o=n(28062),a=function(){function e(){this.store=new Map}return e.prototype.getInstanceIdForExtensionKey=function(e){var t;return this.store.forEach((function(n,r){if(n.has(e)){if(t)throw new o.c("Double registration across instances for an extension key.",o.d.reserveTag(589103766));t=r}})),t},e.prototype.insertExtension=function(e,t){var n=t.instanceId;this.store.has(n)||this.store.set(n,new Map);var r=this.store.get(n);if(r.has(e.extensionKey))throw new o.c("Duplicate Registration in same instance.",o.d.reserveTag(589103767));this.store.forEach((function(t,r){if(r!==n&&t.has(e.extensionKey))throw new o.c("Duplicate Registration in different instance.",o.d.reserveTag(589103768))})),r.set(e.extensionKey,t)},e.prototype.updateExtension=function(e,t){var n=this.getInstanceIdForExtensionKey(e);if(n){var o=this.store.get(n);if(o){var a=o.get(e);if(a)return a=Object(r.__assign)(Object(r.__assign)({},a),t),o.set(e,a),a}}},e.prototype.removeExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n){var r=n.get(e);return n.delete(e),r}}},e.prototype.getExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n)return n.get(e)}},e.prototype.getExtensionsByInstance=function(e){return this.store.get(e)},e}()},28195:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28196),o=n.n(r).a},28196:function(e,t,n){var r=n(28197),o=n(28198);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var c=0;c<16;++c)t[a+c]=i[c];return t||o(i)}},28197:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},28198:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},28199:function(e,t,n){"use strict";n(28200)},28200:function(e,t,n){"use strict";var r=n(28201);!function(){function e(){}e.prototype.initializeExtensionModule=function(){},e.prototype.onExtensionUpdate=function(e){},e.ServiceInfo=r.a.ContentExtensionHostModule}()},28201:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28152),o={ContentExtensionHostModule:["SDX::ContentExtension::ContentExtensionHostModule",{initializeExtensionModule:["FireAndForgetMethod",[]],onExtensionUpdate:["FireAndForgetMethod",[["$union",["SDX::ContentExtension::ExtensionRemovedEventArgs","SDX::ContentExtension::ExtensionModifiedEventArgs","SDX::ContentExtension::ExtensionAddedEventArgs"]]]]}]};r.RekaServiceRegistry.getNativeService(o.ContentExtensionHostModule)},28202:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(28062),o=n(28091),a=n(28173),i=n(28181),c=n(28203),s=n(28204),d=n(28206),u=n(28207),l=function(){function e(e){this._detached=!1,this._id=e.id;var t={contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId};switch(e.state.renderMode){case i.e.TaskPane:this._extensionProvider=new d.a(this._id,t);break;case i.e.TaskPaneItem:this._extensionProvider=new u.a(this._id,t);break;case i.e.Isolated:this._extensionProvider=new s.a(this._id,t);break;case i.e.Integrated:this._extensionProvider=new c.a(this._id,t)}}return e.prototype.triggerUpdate=function(){Object(a.b)().updateExtension(this._id,void 0)},e.prototype.unregisterExtension=function(){this._detached=!0,Object(a.b)().unregisterExtension(this._id)},e.prototype.updateState=function(e){var t=Object(a.b)().getExtension(this._id);if(void 0===t)throw Object(o.k)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005410),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));1===Object.keys(e).length&&void 0!==e.priority&&t.state.priority===e.priority?this.triggerUpdate():Object(a.b)().updateExtension(this._id,e)},Object.defineProperty(e.prototype,"priority",{get:function(){var e=Object(a.b)().getExtension(this._id);if(void 0===e)throw Object(o.k)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620259),new r.c("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"),r.d.reserveTag(589103770));return e.state.priority},set:function(e){this._detached||this.updateState({priority:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentDimensions",{get:function(){var e=Object(a.b)().getExtension(this._id);if(void 0===e)throw Object(o.k)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005411),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));return e.state.componentDimensions},set:function(e){this._detached||this.updateState({componentDimensions:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"detached",{get:function(){return this._detached},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"provider",{get:function(){return this._extensionProvider},enumerable:!1,configurable:!0}),e}()},28203:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28091),o=n(28173),a=n(28181),i=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=Object(o.b)().getExtension(this.extensionKey);if(!e||e.state.renderMode!==a.e.Integrated)throw Object(r.k)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",592316051),Object(r.k)().assertConditionTag((null==e?void 0:e.state.renderMode)===a.e.Integrated,"Extension data is not for the Integrated Render Mode.",592316052),new Error("Unable to query extension data within provider.");return{contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId,componentKey:e.state.componentKey,priority:e.state.priority,componentDimensions:e.state.componentDimensions,type:"Integrated"}},e}()},28204:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(12708),o=n(28091),a=n(28152),i=n(28173),c=n(28205),s=n(28181),d=function(){function e(e,t){var n=this;this.extensionKey=e,this.scope=t,this.cachedExtensions={},this.onExtensionUpdate=function(e){e.updateType!==i.a.Remove?e.extension.id===n.extensionKey&&n.updateCachedExtensions():n.teardown()},this.teardown=function(){n.cachedExtensions={},n.subscription.unsubscribe()},this.subscription=Object(i.b)().onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.prototype.getExtension=function(e){var t=this,n=this.cachedExtensions[e];if(n)return n.extension;var d=Object(i.b)().getExtension(this.extensionKey);if(!d||d.state.renderMode!==s.e.Isolated)throw Object(o.k)().assertConditionTag(!!d,"No extension data in provider. Querying a removed extension.",592316053),Object(o.k)().assertConditionTag((null==d?void 0:d.state.renderMode)===s.e.Isolated,"Extension data is not for the Isolated Render Mode.",592316054),new Error("Unable to query extension data within provider.");var u=Object(c.a)(d.state,e),l=Object(r.__assign)(Object(r.__assign)({},u),{onUpdated:new a.EventImpl((function(n){var r=t.cachedExtensions[e];r&&(n?r.hasListener=!0:delete t.cachedExtensions[e])}))});return this.cachedExtensions[e]={extension:l,hasListener:!1},l},e.prototype.updateCachedExtensions=function(){var e=this,t=Object(i.b)().getExtension(this.extensionKey);if(!t||t.state.renderMode!==s.e.Isolated)return Object(o.k)().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",592314635),void Object(o.k)().assertConditionTag((null==t?void 0:t.state.renderMode)===s.e.Isolated,"Extension data is not for the Isolated Render Mode.",592314636);var n=t.state;Object.keys(this.cachedExtensions).forEach((function(t){var r=e.cachedExtensions[t],a=null==r?void 0:r.extension;if(a&&r){var i=Object(c.a)(n,t);(a.priority!==i.priority||a.isContentIdValid!==i.isContentIdValid)&&(a.priority=i.priority,a.isContentIdValid=i.isContentIdValid,a.onUpdated.trigger({})),r.hasListener||i.isContentIdValid||delete e.cachedExtensions[t]}else Object(o.k)().assertConditionTag(!1,"Trying to access extension before it has been cached.",591152983)}))},e}()},28205:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28181);function o(e,t){var n=e.isContentAvailable(t),o=function(e,t){switch(e){case r.d.Primary:case r.d.Secondary:switch(t){case r.a.Invalid:case r.a.Disabled:return r.d.Disabled;case r.a.Enabled_Default:return e;case r.a.Enabled_ForcePrimary:return r.d.Primary}case r.d.Disabled:return e}}(e.priority,n),a=n!==r.a.Invalid;return{contentType:e.contentType,renderMode:e.renderMode,instanceId:e.instanceId,componentKey:e.componentKey,componentDimensions:e.componentDimensions,priority:o,contentId:t,isContentIdValid:a,type:"Isolated"}}},28206:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12708),o=n(28062),a=n(28091),i=n(28173),c=n(28181),s=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=Object(i.b)().getExtension(this.extensionKey);if(!e||e.state.renderMode!==c.e.TaskPane)throw Object(a.k)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",573384475),Object(a.k)().assertConditionTag(!e||e.state.renderMode===c.e.TaskPane,"Extension data is not for the TaskPane Render Mode.",573384476),new o.c("Unable to query extension data within provider.",o.d.reserveTag(573384477));return Object(r.__assign)(Object(r.__assign)({},e.state),{type:"TaskPane"})},e}()},28207:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12708),o=n(28062),a=n(28091),i=n(28173),c=n(28181),s=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=Object(i.b)().getExtension(this.extensionKey);if(!e||e.state.renderMode!==c.e.TaskPaneItem)throw Object(a.k)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",546174347),Object(a.k)().assertConditionTag(!e||e.state.renderMode===c.e.TaskPaneItem,"Extension data is not for the TaskPaneItem Render Mode.",546174348),new o.c("Unable to query extension data within provider.",o.d.reserveTag(546174349));return Object(r.__assign)(Object(r.__assign)({},e.state),{type:"TaskPaneItem"})},e}()},28208:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28152),o=n(28173),a=n(28181),i=function(){function e(e,t){var n=this;this.contentTypes=e,this.host=t,this.onUpdated=new r.EventImpl((function(){})),Object(o.b)().onExtensionUpdated.subscribe((function(t){e.find((function(e){return e===t.extension.state.contentType}))&&t.updateType!==o.a.ReQuery&&n.onUpdated.trigger({})}))}return Object.defineProperty(e.prototype,"providers",{get:function(){var e=[],t=function(t){var r=n.host.extensions[t];r.priority!==a.d.Disabled&&n.contentTypes.find((function(e){return e===r.provider.scope.contentType}))&&e.push(r.provider)},n=this;for(var r in this.host.extensions)t(r);return e},enumerable:!1,configurable:!0}),e}()},28209:function(e,t,n){"use strict";var r=n(28171);n.d(t,"a",(function(){return r.a}));n(28210)},28210:function(e,t,n){"use strict";n(28211)},28211:function(e,t,n){},28212:function(e,t,n){n(28213),e.exports=n(28216).Array.findIndex},28213:function(e,t,n){"use strict";var r=n(28214),o=n(28235)(6),a="findIndex",i=!0;a in[]&&Array(1)[a]((function(){i=!1})),r(r.P+r.F*i,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(28246)(a)},28214:function(e,t,n){var r=n(28215),o=n(28216),a=n(28217),i=n(28227),c=n(28233),s=function(e,t,n){var d,u,l,f,m=e&s.F,p=e&s.G,g=e&s.S,v=e&s.P,h=e&s.B,b=p?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,C=p?o:o[t]||(o[t]={}),y=C.prototype||(C.prototype={});for(d in p&&(n=t),n)l=((u=!m&&b&&void 0!==b[d])?b:n)[d],f=h&&u?c(l,r):v&&"function"==typeof l?c(Function.call,l):l,b&&i(b,d,l,e&s.U),C[d]!=l&&a(C,d,f),v&&y[d]!=l&&(y[d]=l)};r.core=o,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},28215:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},28216:function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},28217:function(e,t,n){var r=n(28218),o=n(28226);e.exports=n(28222)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},28218:function(e,t,n){var r=n(28219),o=n(28221),a=n(28225),i=Object.defineProperty;t.f=n(28222)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),o)try{return i(e,t,n)}catch(c){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},28219:function(e,t,n){var r=n(28220);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},28220:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},28221:function(e,t,n){e.exports=!n(28222)&&!n(28223)((function(){return 7!=Object.defineProperty(n(28224)("div"),"a",{get:function(){return 7}}).a}))},28222:function(e,t,n){e.exports=!n(28223)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},28223:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},28224:function(e,t,n){var r=n(28220),o=n(28215).document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},28225:function(e,t,n){var r=n(28220);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},28226:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},28227:function(e,t,n){var r=n(28215),o=n(28217),a=n(28228),i=n(28229)("src"),c=n(28230),s=(""+c).split("toString");n(28216).inspectSource=function(e){return c.call(e)},(e.exports=function(e,t,n,c){var d="function"==typeof n;d&&(a(n,"name")||o(n,"name",t)),e[t]!==n&&(d&&(a(n,i)||o(n,i,e[t]?""+e[t]:s.join(String(t)))),e===r?e[t]=n:c?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[i]||c.call(this)}))},28228:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},28229:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},28230:function(e,t,n){e.exports=n(28231)("native-function-to-string",Function.toString)},28231:function(e,t,n){var r=n(28216),o=n(28215),a=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(28232)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},28232:function(e,t){e.exports=!1},28233:function(e,t,n){var r=n(28234);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},28234:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},28235:function(e,t,n){var r=n(28233),o=n(28236),a=n(28238),i=n(28240),c=n(28242);e.exports=function(e,t){var n=1==e,s=2==e,d=3==e,u=4==e,l=6==e,f=5==e||l,m=t||c;return function(t,c,p){for(var g,v,h=a(t),b=o(h),C=r(c,p,3),y=i(b.length),T=0,O=n?m(t,y):s?m(t,0):void 0;y>T;T++)if((f||T in b)&&(v=C(g=b[T],T,h),e))if(n)O[T]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return T;case 2:O.push(g)}else if(u)return!1;return l?-1:d||u?u:O}}},28236:function(e,t,n){var r=n(28237);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},28237:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},28238:function(e,t,n){var r=n(28239);e.exports=function(e){return Object(r(e))}},28239:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},28240:function(e,t,n){var r=n(28241),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},28241:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},28242:function(e,t,n){var r=n(28243);e.exports=function(e,t){return new(r(e))(t)}},28243:function(e,t,n){var r=n(28220),o=n(28244),a=n(28245)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},28244:function(e,t,n){var r=n(28237);e.exports=Array.isArray||function(e){return"Array"==r(e)}},28245:function(e,t,n){var r=n(28231)("wks"),o=n(28229),a=n(28215).Symbol,i="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=i&&a[e]||(i?a:o)("Symbol."+e))}).store=r},28246:function(e,t,n){var r=n(28245)("unscopables"),o=Array.prototype;null==o[r]&&n(28217)(o,r,{}),e.exports=function(e){o[r][e]=!0}},28247:function(e,t,n){n(28248),e.exports=n(28216).Object.assign},28248:function(e,t,n){var r=n(28214);r(r.S+r.F,"Object",{assign:n(28249)})},28249:function(e,t,n){"use strict";var r=n(28222),o=n(28250),a=n(28257),i=n(28258),c=n(28238),s=n(28236),d=Object.assign;e.exports=!d||n(28223)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=r}))?function(e,t){for(var n=c(e),d=arguments.length,u=1,l=a.f,f=i.f;d>u;)for(var m,p=s(arguments[u++]),g=l?o(p).concat(l(p)):o(p),v=g.length,h=0;v>h;)m=g[h++],r&&!f.call(p,m)||(n[m]=p[m]);return n}:d},28250:function(e,t,n){var r=n(28251),o=n(28256);e.exports=Object.keys||function(e){return r(e,o)}},28251:function(e,t,n){var r=n(28228),o=n(28252),a=n(28253)(!1),i=n(28255)("IE_PROTO");e.exports=function(e,t){var n,c=o(e),s=0,d=[];for(n in c)n!=i&&r(c,n)&&d.push(n);for(;t.length>s;)r(c,n=t[s++])&&(~a(d,n)||d.push(n));return d}},28252:function(e,t,n){var r=n(28236),o=n(28239);e.exports=function(e){return r(o(e))}},28253:function(e,t,n){var r=n(28252),o=n(28240),a=n(28254);e.exports=function(e){return function(t,n,i){var c,s=r(t),d=o(s.length),u=a(i,d);if(e&&n!=n){for(;d>u;)if((c=s[u++])!=c)return!0}else for(;d>u;u++)if((e||u in s)&&s[u]===n)return e||u||0;return!e&&-1}}},28254:function(e,t,n){var r=n(28241),o=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):a(e,t)}},28255:function(e,t,n){var r=n(28231)("keys"),o=n(28229);e.exports=function(e){return r[e]||(r[e]=o(e))}},28256:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},28257:function(e,t){t.f=Object.getOwnPropertySymbols},28258:function(e,t){t.f={}.propertyIsEnumerable},28259:function(e,t,n){"use strict";n(28260);var r=n(28264);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));n(28267),n(28268)},28260:function(e,t,n){"use strict";n(28261),n(28263)},28261:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,o,a=n(28262);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(o||(o={}));var i=((r={})[0]=a.DeltaFormattingType.Weight,r[1]=a.DeltaFormattingType.Highlight,r[2]=a.DeltaFormattingType.Hyperlink,r[3]=a.DeltaFormattingType.Italic,r[4]=a.DeltaFormattingType.Strikethrough,r[5]=a.DeltaFormattingType.Underline,r[6]=a.DeltaFormattingType.Color,r[7]=a.DeltaFormattingType.Image,r)},28262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.Language=65536]="Language",e[e.SubscriptAndSuperscript=131072]="SubscriptAndSuperscript",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=262143]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},28263:function(e,t,n){},28264:function(e,t,n){"use strict";var r=n(28265);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}))},28265:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r,o=n(28266);function a(){return void 0===r&&(r=new o.a),r}function i(){r=void 0}},28266:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28091),o=n(28262),a=n(28261),i=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,a,i,c,s;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var d=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=d.bold;break;case 3:n.italic=d.italic;break;case 5:n.underline=d.underline;break;case 4:n.strikethrough=d.strikethrough;break;case 1:n.highlight=d.highlight;break;case 6:n.fontColor=d.fontColor}return 2}var u=void 0,l=void 0;switch(e){case 0:u={type:o.DeltaFormattingType.Weight};break;case 3:u={type:o.DeltaFormattingType.Italic};break;case 5:u={type:o.DeltaFormattingType.Underline};break;case 4:u={type:o.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var f=null===(a=null==n?void 0:n.hyperlinkData)||void 0===a?void 0:a.link,m=null!==(c=null===(i=null==n?void 0:n.hyperlinkData)||void 0===i?void 0:i.text)&&void 0!==c?c:f;l={type:o.DeltaFormattingType.Hyperlink,data:{text:m,link:f}}}break;case 7:(null===(s=null==n?void 0:n.imageData)||void 0===s?void 0:s.base64)&&(l={type:o.DeltaFormattingType.Image,data:{src:n.imageData.base64}});break;case 1:(null==n?void 0:n.highlight)&&(u={type:o.DeltaFormattingType.Highlight,data:{color:n.highlight.color}});break;case 6:(null==n?void 0:n.fontColor)&&(u={type:o.DeltaFormattingType.Color,data:{fontColor:n.fontColor.color}})}return u&&this.richContentEditorActor.applyFormattingToCurrentSelection(u),l&&this.richContentEditorActor.addContent(l),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){Object(r.k)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(a.a[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}()},28267:function(e,t,n){},28268:function(e,t,n){"use strict";new(n(28269).a)},28269:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28264),o=function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return Object(r.b)()},e}()},28270:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(28062),o=n(28091),a=n(28271),i=n(28272),c=n(28273),s=void 0;function d(){if(!s)throw new a.a(i.g,r.d.reserveTag(589103748),-2130957552);return s}function u(e){return Object(o.k)().assertConditionTag(void 0===s,"LocalizationAPI has already been initialized",589103749),void 0===s&&(s=new c.a(e)),s}function l(){s=void 0}},28271:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(12708),o=n(28062),a=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.tag=n,o.errorCode=r,o.name="CommentError",o}return Object(r.__extends)(t,e),t.prototype.stringify=function(){return Object(o.e)(this.tag,this.stack,"Error ".concat((e=this.errorCode)>4294967295||e<-4294967296?"dword_out_of_range(".concat(e,")"):"0x".concat((e<0?4294967295+e+1:e).toString(16))),this.innerException);var e},t}(o.c);function i(e){return Object(o.g)(e,"CommentError")}},28272:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g}));var r="Selected comment not found",o="Selected thread index out of bounds",a="Invalid number of posts for display more replies string",i="Unrecognized post display mode",c="Method not implemented",s="StringId is invalid",d="LocalizationModule NativeModule not valid",u="Store state unexpected",l="Editor reference is invalid",f="Invalid arguments",m="Comment ID value is invalid in the current operation",p="Attempting to perform an operation on an inactive draft",g="CommentModel not found in a thread of RenderableItems"},28273:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(28062),o=n(28091),a=n(28271),i=n(28272),c=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,uiCulture:this.localizationDetails.uiCulture||"en-us",dataCulture:this.localizationDetails.dataCulture||"en-us"}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new a.a(i.j,r.d.reserveTag(589103688),-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 55:return this.isMac()?CommentPaneStrings.ReplyBoxA11yDescription_Mac:CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.CommentPostedA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 230:return CommentPaneStrings.FocusMovedToUnpostedDraftA11yUpdate;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 134:return CommentPaneStrings.FailedToCommitMentionText;case 234:return CommentPaneStrings.FailedToCommitMentionShareCanceledText;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;case 203:return CommentPaneStrings.SmartReplyPickerHeader;case 204:return CommentPaneStrings.TaskUnassignedHistoryString;case 202:return CommentPaneStrings.TaskHeaderResolved;case 197:return CommentPaneStrings.ResolvedCommentCardLabel;case 206:return CommentPaneStrings.DeleteTaskButtonText;case 207:return CommentPaneStrings.LinkToCommentButtonText;case 227:return CommentPaneStrings.PeoplePickerSuggestionSelectedA11yUpdate;case 229:return CommentPaneStrings.TruncationUIReadMoreText;case 231:return CommentPaneStrings.CommentLikeA11yLabel;case 232:return CommentPaneStrings.TaskHistoryItemA11yLabelDesktop;case 223:return CommentPaneStrings.DraftCardA11yLabelDesktop;case 225:return CommentPaneStrings.LoadingCardA11yLabelDesktop;case 216:return CommentPaneStrings.CardA11yLabelDesktopUnassignedTask;case 217:return CommentPaneStrings.CardA11yLabelDesktopUnassignedCompletedTask;case 219:return CommentPaneStrings.CardA11yLabelDesktopOneReplyModifier;case 221:return CommentPaneStrings.CardA11yLabelDesktopLoadingModifier;case 222:return CommentPaneStrings.CardA11yLabelDesktopDraftModifier;case 226:return CommentPaneStrings.A11yLabelSubstringDelimiterDesktop;case 224:return CommentPaneStrings.DraftCardA11yLabelDesktopHintText;case 209:return CommentPaneStrings.NewPostA11yLabelDesktop;case 208:return CommentPaneStrings.PostA11yLabelDesktop;case 210:return CommentPaneStrings.PendingPostA11yLabelDesktop;case 214:return CommentPaneStrings.CardA11yLabelDesktopAssignedTask;case 215:return CommentPaneStrings.CardA11yLabelDesktopAssignedCompletedTask;case 211:return CommentPaneStrings.CardA11yLabelDesktopBaseThread;case 212:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadWithTask;case 213:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadResolved;case 218:return CommentPaneStrings.CardA11yLabelDesktopAnchorHintModifier;case 220:return CommentPaneStrings.CardA11yLabelDesktopMultipleRepliesModifier;case 239:return CommentPaneStrings.CommentLikePluralA11yLabel;case 240:return CommentPaneStrings.CommentLikeDescriptionA11yLabel;case 233:return this.isMac()?CommentPaneStrings.CtrlEnterHint_Mac:CommentPaneStrings.CtrlEnterHint;case 241:return CommentPaneStrings.AtMentionsInfoCommentNotificationUber;case 242:return CommentPaneStrings.AtMentionsInfoCommentMentionsTwoPeopleModifier;case 243:return CommentPaneStrings.AtMentionsInfoCommentMentionsThreePeopleModifier;case 244:return CommentPaneStrings.AtMentionsInfoCommentMentionsMoreThanThreePeopleModifier;case 245:return CommentPaneStrings.FilterShowAllResolutions;case 246:return CommentPaneStrings.FilterShowResolvedOnly;case 247:return CommentPaneStrings.FilterShowActiveOnly;case 248:return CommentPaneStrings.FilterNewestFirst;case 249:return CommentPaneStrings.FilterAtMentionsToMe;case 250:return CommentPaneStrings.TaskHeaderAssignedToYouAndOthersText;case 251:return CommentPaneStrings.TaskHeaderAssignedToMultipleText;case 252:return CommentPaneStrings.TaskItemUnassignedFromText;case 256:return CommentPaneStrings.FilterItemCount;case 257:return CommentPaneStrings.FilterItemCountPlural;case 258:return CommentPaneStrings.FilterOldestFirst;case 260:return CommentPaneStrings.FilterSortBy;case 261:return CommentPaneStrings.FilterFilterBy;case 259:return CommentPaneStrings.FilterCollaborators;case 262:return CommentPaneStrings.FilterResetAll;case 254:return CommentPaneStrings.FilterButtonAccessibilityLabel;case 255:return CommentPaneStrings.FilterMenuAccessibilityLabel;case 265:return CommentPaneStrings.NewCardA11yLabelDesktopBaseThread;case 266:return CommentPaneStrings.NewCardA11yLabelDesktopBaseThreadWithTask;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(this.getString(e),t)},e.prototype.toFormattedString=function(e,t){for(var n="",r=0;;){var a=e.indexOf("{",r),i=e.indexOf("}",r);if(a<0&&i<0){n+=e.slice(r);break}if(i>0&&(i<a||a<0))n+=e.slice(r,i+1),r=i+2;else if(n+=e.slice(r,a),r=a+1,"{"!==e.charAt(r)){if(i<0)break;var c=e.substring(r,i),s=c.indexOf(":"),d=t[parseInt(s<0?c:c.substring(0,s),10)];null==d&&(Object(o.k)().assertConditionTag(!1,"Incorrect substitution provided to string",562937946),d=""),n+=d,r=i+1}else n+="{",r++}return n},e}()},28274:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r,o=n(28062),a=n(28091),i=n(28271);function c(e){if(r)throw Object(a.k)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",578647955),new i.a("WebAppColors cannot be re-initialized.",o.d.reserveTag(577610271),-2130957508);r=e}function s(){r=void 0}function d(){if(!r)throw Object(a.k)().assertConditionTag(!1,"WebAppColors is not initialized",578647956),new i.a("WebAppColors is not initialized",o.d.reserveTag(577610272),-2130957509);return r}},28275:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return j})),n.d(t,"c",(function(){return _})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return E}));var r,o=n(28284),a=n(28091),i=n(18847),c=n(12786),s=n(28285),d=n(28286),u=n(13540),l=n(28276),f=n(28277),m=n(28278),p=n(28279),g=n(28280),v=function(e){return Object(a.k)().assertConditionTag(T(),"Should not retrieve dark mode semantic colors if dark theme is not set.",545067039),{AtMentionHighlight:i.b.gray140,AtMentionMessageBackground:i.b.gray140,AtMentionMessageText:i.b.gray40,AtMentionText:i.b.gray40,AtMentionToMeHighlight:e.palette.themeTertiary,AtMentionToMeText:e.palette.black,BlueDot:"#5099FF",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:i.b.gray180,CardBorder:i.b.gray120,CardBorderEmphasis:"#C480CB",CardTopperContainerBorder:i.b.gray140,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:e.palette.themePrimary,CheckBoxBackgroundCheckedHovered:"#3D7CE8",CheckBoxBackgroundHovered:i.b.gray190,CheckBoxBackgroundPressed:e.palette.white,CheckBoxBorder:i.b.gray80,CheckBoxBorderCheckedHovered:"#3D7CE8",CheckBoxBorderDisabled:i.b.gray130,CheckBoxBorderHovered:i.b.gray80,CheckBoxCheckMark:i.b.gray80,CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:i.b.gray160,ClosePaneButtonPressed:i.b.gray150,ClosePaneButtonIcon:i.b.gray20,ClosePaneButtonIconHovered:i.b.gray20,ClosePaneButtonIconPressed:i.b.gray20,CommentLikeEmptyBorder:"#FEFEFE",CommentLikeSolidBorder:"#83BEEC",CommentLikeSolidCenter:"#0063B1",CommonControlBorder:i.b.gray120,CtrlEnterTip:i.b.gray80,DefaultButton:"transparent",DefaultButtonHovered:i.b.gray160,DefaultButtonIcon:i.b.gray20,DefaultButtonIconDisabled:i.b.gray130,DefaultButtonPressed:e.palette.white,DefaultFilterButtonBackground:"transparent",DraftWarning:"#F1BBBD",ExpandButtonTextResolved:i.b.gray80,ExpandButtonTextResolvedHovered:i.b.gray50,ExpandButtonTextResolvedPressed:i.b.gray30,FilterButtonBackground:i.b.black,FilterButtonIconAndTextColor:i.b.gray90,FilterMenuSectionHeaderText:i.b.gray40,Hyperlink:"#7DB0FF",HyperlinkActive:"#FF0000",MenuIcon:e.palette.black,MenuIconDisabled:i.b.gray130,MenuIconHoveredPressed:e.palette.black,MoreRepliesColor:e.palette.themeDark,NewCommentButton:"transparent",NewCommentButtonBorderFocused:i.b.gray20,NewCommentButtonDisabled:i.b.gray130,NewCommentButtonHovered:i.b.gray180,NewCommentButtonLabel:i.b.gray20,NewCommentButtonLabelHovered:i.b.gray20,NewCommentButtonPressed:i.b.gray160,NewCommentButtonIconHoveredPressed:"#3D7CE8",PaneBackground:i.b.gray200,PersonaColorResolved:i.b.gray80,PersonaInitialsTextColor:e.palette.black,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themePrimary,PrimaryButtonHovered:"#3D7CE8",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:e.palette.themeDarker,ResetFilterButtonBackground:"transparent",ResetFilterButtonBackgroundDisabled:"transparent",ResetFilterButtonText:i.b.white,ResetFilterButtonTextDisabled:i.b.gray130,ResolvedCardBackground:e.palette.white,ResolvedCardText:i.b.gray80,ResolvedCardTitle:i.b.gray50,SmartRepliesText:i.b.gray20,SubText:i.b.gray80,SuggestedItem:i.b.gray140,SuggestedItemHovered:i.b.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:e.palette.black,TaskAssignerText:i.b.gray20,TaskBorder:e.palette.black,TaskPickerButton:e.palette.black,Text:i.b.gray20}},h=function(e){return Object(a.k)().assertConditionTag(O(),"Should not retrieve light mode semantic colors if light theme is not set.",545067040),{AtMentionHighlight:i.b.gray20,AtMentionMessageBackground:"#F0F0F0",AtMentionMessageText:i.b.gray160,AtMentionText:i.b.gray180,AtMentionToMeHighlight:e.palette.themeLighter,AtMentionToMeText:e.palette.themeDarkAlt,BlueDot:"#006bFF",CancelDraftButtonIcon:l.a.GRAY_E,CancelDraftButtonIconFocused:l.a.GRAY_J,CancelDraftButtonIconHovered:l.a.GRAY_J,CancelDraftButtonIconPressed:l.a.GRAY_J,CardBackground:e.palette.white,CardBorder:l.a.COMMENTS_GRAY,CardBorderEmphasis:l.a.COMMENTS_PURPLE,CardTopperContainerBorder:l.a.GRAY_B,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:m.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundCheckedHovered:m.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundHovered:"transparent",CheckBoxBackgroundPressed:"transparent",CheckBoxBorder:m.b.TASK_BORDER,CheckBoxBorderCheckedHovered:m.b.TASK_BORDER,CheckBoxBorderDisabled:m.b.TASK_DISABLED,CheckBoxBorderHovered:m.b.TASK_CHECKBOX_COLOR,CheckBoxCheckMark:m.b.TASK_TEXT,CheckBoxCheckMarkChecked:e.palette.white,ClosePaneButtonFocused:l.a.ACTIVE_COMMENT_TEXT,ClosePaneButtonHovered:i.b.gray40,ClosePaneButtonPressed:i.b.gray70,ClosePaneButtonIcon:l.a.GRAY_F,ClosePaneButtonIconHovered:l.a.GRAY_J,ClosePaneButtonIconPressed:l.a.GRAY_J,CommentLikeEmptyBorder:"#3A3A38",CommentLikeSolidBorder:"#0063B1",CommentLikeSolidCenter:"#83BEEC",CommonControlBorder:i.b.gray110,CtrlEnterTip:i.b.gray120,DefaultButton:"transparent",DefaultButtonHovered:void 0,DefaultButtonIcon:i.b.gray200,DefaultButtonIconDisabled:i.b.gray100,DefaultButtonPressed:void 0,DefaultFilterButtonBackground:i.b.gray30,DraftWarning:i.c.red10,ExpandButtonTextResolved:i.b.gray130,ExpandButtonTextResolvedHovered:l.a.GRAY_H,ExpandButtonTextResolvedPressed:l.a.GRAY_H,FilterButtonBackground:"transparent",FilterButtonIconAndTextColor:"#313131",FilterMenuSectionHeaderText:i.b.gray130,Hyperlink:"#0000EE",HyperlinkActive:"#FF0000",MenuIcon:l.a.GRAY_F,MenuIconDisabled:l.a.GRAY_C,MenuIconHoveredPressed:l.a.GRAY_J,MoreRepliesColor:e.palette.themePrimary,NewCommentButton:e.palette.white,NewCommentButtonBorderFocused:e.palette.black,NewCommentButtonDisabled:f.b.BUTTON_DISABLED,NewCommentButtonHovered:void 0,NewCommentButtonLabel:i.b.gray180,NewCommentButtonLabelHovered:l.a.GRAY_J,NewCommentButtonPressed:void 0,NewCommentButtonIconHoveredPressed:l.a.GRAY_J,PaneBackground:i.b.gray30,PersonaColorResolved:i.b.gray130,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themeDarkAlt,PrimaryButtonHovered:e.palette.themeDarkAlt,PrimaryButtonIcon:e.palette.white,PrimaryButtonPressed:e.palette.themeDark,ResetFilterButtonBackground:i.b.white,ResetFilterButtonBackgroundDisabled:i.b.white,ResetFilterButtonText:i.c.cyanBlue10,ResetFilterButtonTextDisabled:i.b.gray70,ResolvedCardBackground:i.b.gray20,ResolvedCardText:i.b.gray130,ResolvedCardTitle:i.b.gray160,SmartRepliesText:i.b.gray140,SubText:l.a.GRAY_E,SuggestedItem:l.a.SUGGESTED_PICKER_ITEM,SuggestedItemHovered:l.a.SUGGESTED_PICKER_ITEM_HOVER,SuggestedItemPressed:l.a.SUGGESTED_PICKER_ITEM_HOVER,TaskAssignerFocus:m.b.TASK_BORDER_FOCUS,TaskAssignerText:e.palette.black,TaskBorder:m.b.TASK_BORDER,TaskPickerButton:m.b.TASK_BORDER,Text:l.a.ACTIVE_COMMENT_TEXT}},b=function(e){return Object(a.k)().assertConditionTag(T(),"Should not retrieve dark mode semantic styles if dark theme is not set.",545067041),{BoxShadowLevel1:"0px 1px 4px 0px rgba(0,0,0,0.2)",BoxShadowLevel2:"0px 1px 8px 8px rgba(0,0,0,0.2)",BoxShadowLevel3:"0px 1px 16px 8px rgba(0,0,0,0.2)",BoxShadowLevel4:"0px 1px 32px 8px rgba(0,0,0,0.2)",BoxShadowLevel5:"0px 1px 48px 8px rgba(0,0,0,0.2)",CalloutBoxShadow:"0px 1px 16px 8px rgba(0,0,0,0.2)",CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(255, 255, 255, 0.2)",DefaultButtonFocusedBorder:"1px solid ".concat(e.palette.black),DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #323130",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px black",PostOverlay:"rgba(0,0,0,0.5)"}},C=function(e){return Object(a.k)().assertConditionTag(O(),"Should not retrieve light mode semantic styles if light theme is not set.",545067042),{BoxShadowLevel1:"0px 1px 2px 0px rgba(0,0,0,0.1)",BoxShadowLevel2:"0px 1px 4px 0px rgba(0,0,0,0.1)",BoxShadowLevel3:"0px 1px 8px 0px rgba(0,0,0,0.1)",BoxShadowLevel4:"0px 1px 16px 0px rgba(0,0,0,0.1)",BoxShadowLevel5:"0px 1px 24px 0px rgba(0,0,0,0.1)",CalloutBoxShadow:void 0,CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(0,0,0,0.1)",DefaultButtonFocusedBorder:"1px solid",DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #F3F2F1",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px white",PostOverlay:"rgba(255,255,255,0.5)"}},y=(r=new p.a,{setThemeAPI:function(e){r=e},getThemeAPI:function(){return r},resetThemeAPI:function(){r=new p.a}});function T(){return!!g.P()&&1===y.getThemeAPI().getThemeMode()}function O(){return!g.P()||0===y.getThemeAPI().getThemeMode()}function I(){return!!g.P()&&99999===y.getThemeAPI().getThemeMode()}var S=Object(c.c)((function(e){return Object(a.k)().assertConditionTag(g.P(),"Semantic color map should not be used if web theme integration is disabled.",553710797),g.a()?T()?v(e):I()?function(e){return Object(a.k)().assertConditionTag(I(),"Should not retrieve Teams high contrast semantic colors if Teams high contrast theme is not set.",508938275),{AtMentionHighlight:i.b.gray140,AtMentionMessageBackground:e.palette.red,AtMentionMessageText:"#1aebff",AtMentionText:"#1aebff",AtMentionToMeHighlight:"#1aebff",AtMentionToMeText:e.palette.black,BlueDot:"#1aebff",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:e.palette.black,CardBorder:"#1aebff",CardBorderEmphasis:"#1aebff",CardTopperContainerBorder:e.palette.white,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:"#1aebff",CheckBoxBackgroundCheckedHovered:"#1aebff",CheckBoxBackgroundHovered:e.palette.black,CheckBoxBackgroundPressed:"#1aebff",CheckBoxBorder:e.palette.white,CheckBoxBorderCheckedHovered:e.palette.white,CheckBoxBorderDisabled:i.b.gray130,CheckBoxBorderHovered:"#1aebff",CheckBoxCheckMark:"#1aebff",CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:i.b.gray160,ClosePaneButtonPressed:i.b.gray150,ClosePaneButtonIcon:i.b.gray20,ClosePaneButtonIconHovered:i.b.gray20,ClosePaneButtonIconPressed:i.b.gray20,CommentLikeEmptyBorder:"#FFFFFF",CommentLikeSolidBorder:"#1aebff",CommentLikeSolidCenter:"#1aebff",CommonControlBorder:e.palette.white,CtrlEnterTip:e.palette.white,DefaultButton:e.palette.black,DefaultButtonHovered:i.b.gray50,DefaultButtonIcon:e.palette.white,DefaultButtonIconDisabled:e.palette.white,DefaultButtonPressed:i.b.gray50,DefaultFilterButtonBackground:"transparent",DraftWarning:"#FFFF00",ExpandButtonTextResolved:i.b.gray80,ExpandButtonTextResolvedHovered:i.b.gray50,ExpandButtonTextResolvedPressed:i.b.gray30,FilterButtonBackground:i.b.black,FilterButtonIconAndTextColor:i.b.gray90,FilterMenuSectionHeaderText:i.b.gray40,Hyperlink:"#1aebff",HyperlinkActive:"#1aebff",MenuIcon:e.palette.white,MenuIconDisabled:i.b.gray130,MenuIconHoveredPressed:e.palette.black,MoreRepliesColor:e.palette.white,NewCommentButton:"transparent",NewCommentButtonBorderFocused:i.b.gray20,NewCommentButtonDisabled:i.b.gray130,NewCommentButtonHovered:i.b.gray180,NewCommentButtonLabel:i.b.gray20,NewCommentButtonLabelHovered:i.b.gray20,NewCommentButtonPressed:i.b.gray160,NewCommentButtonIconHoveredPressed:"#1aebff",PaneBackground:i.b.gray200,PersonaColorResolved:i.b.gray80,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.white,PrimaryButtonFocused:e.palette.white,PrimaryButtonHovered:"#1aebff",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:"#1aebff",ResetFilterButtonBackground:"transparent",ResetFilterButtonBackgroundDisabled:"transparent",ResetFilterButtonText:i.b.white,ResetFilterButtonTextDisabled:i.b.gray130,ResolvedCardBackground:e.palette.black,ResolvedCardText:i.b.white,ResolvedCardTitle:i.b.white,SmartRepliesText:e.palette.red,SubText:e.palette.white,SuggestedItem:i.b.gray140,SuggestedItemHovered:i.b.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:"#1aebff",TaskAssignerText:"#1aebff",TaskBorder:e.palette.white,TaskPickerButton:e.palette.white,Text:e.palette.white}}(e):h(e):T()?v(e):h(e)}));function j(){Object(c.d)()}var _=Object(c.c)((function(e){return Object(a.k)().assertConditionTag(g.P(),"Semantic style map should not be used if web theme integration is disabled",545067043),g.a()?T()?b(e):I()?(Object(a.k)().assertConditionTag(I(),"Should not retrieve Teams high contrast mode semantic styles if Teams high contrast theme is not set.",508938274),{BoxShadowLevel1:"none",BoxShadowLevel2:"none",BoxShadowLevel3:"none",BoxShadowLevel4:"none",BoxShadowLevel5:"none",CalloutBoxShadow:"none",CardBorder:"1px solid",DefaultButtonBoxShadow:"none",DefaultButtonFocusedBorder:"none",DisabledButtonBoxShadow:"none",FocusedButtonBoxShadow:"none",PostOverlay:"rgba(255,255,255,0.5)"}):C():T()?b(e):C()})),k=Object(o.a)((function(){return!!g.P()&&!!y.getThemeAPI().convertColorForTheme})),E=function(){return T()?s.a:I()?d.a:u.a}},28276:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12708),o={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},a={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",REST_RESOLVED_BODY:o.GRAY_20,RESOLVED_CARD_TEXT:o.GRAY_130,ACTIVE_COMMENT_TEXT:o.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},i=Object(r.__assign)(Object(r.__assign)({},o),a)},28277:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return C})),n.d(t,"o",(function(){return O})),n.d(t,"j",(function(){return I})),n.d(t,"a",(function(){return S})),n.d(t,"g",(function(){return j})),n.d(t,"i",(function(){return _})),n.d(t,"h",(function(){return k})),n.d(t,"n",(function(){return E}));var r,o,a,i,c,s=n(12754),d=n(28276),u=1e3,l="2px",f="4px",m="@media screen and (-ms-high-contrast: active), (forced-colors: active)",p={content:'""',position:"absolute",left:-1,top:-1,bottom:-1,right:-1,border:0,outline:"none",zIndex:1},g={BUTTON_HOVER:"#F3F2F1",BUTTON_SELECT:"#E1DFDD",BUTTON_DOWN:"#D2D0CE",BUTTON_DISABLED:"#FAF9F8",HIGH_CONTRAST:{BUTTON_FOCUS:"highlight"}},v=((r={forcedColorAdjust:"auto",MsHighContrastAdjust:"auto",svg:{forcedColorAdjust:"auto"}})[m]={color:"revert",stroke:"revert"},r);function h(e){return Object(s.eb)(e,v)}var b={selectors:(o={},o[s.m]={backgroundColor:"Highlight",color:"HighlightText",borderColor:"WindowText",MsHighContrastAdjust:"none",selectors:{"svg > path":{fill:"HighlightText"}}},o)},C=Object(s.eb)(b,{selectors:(a={},a[s.m]={outline:"2px",outlineOffset:"-2px"},a)}),y=Object(s.eb)({selectors:(i={},i[s.m]={outline:"2px",outlineOffset:"-2px"},i)}),T=Object(s.eb)(((c={})[m]={color:"ButtonText"},c)),O=function(e){void 0===e&&(e={});var t={rootHovered:h(C),rootFocused:h(b),rootDisabled:h(y),icon:h(T)};return Object(s.db)(e,t)};function I(e){var t;return Object(s.db)(e,{root:(t={},t[s.m]={color:"ButtonText"},t)})}var S={LEVEL1:"0px 1px 2px 0px rgba(0,0,0,0.10)",LEVEL2:"0px 2px 4px 0px rgba(0,0,0,0.10)",LEVEL3:"0px 4px 8px 0px rgba(0,0,0,0.10)",LEVEL4:"0px 8px 16px 0px rgba(0,0,0,0.10)",LEVEL5:"0px 16px 24px 0px rgba(0,0,0,0.10)"},j='"Segoe UI"',_='"Segoe UI Web"',k='"Segoe UI Semibold"';function E(e,t,n){var r,o;return!e||t?null!==(r=null==n?void 0:n.CardBackground)&&void 0!==r?r:d.a.WHITE:null!==(o=null==n?void 0:n.ResolvedCardBackground)&&void 0!==o?o:d.a.REST_RESOLVED_BODY}},28278:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(12786),o=n(12754),a=n(12780),i=n(28274),c=n(28277),s={TASK_ASSIGNER_CHECKED_BOX:"#605E5C",TASK_BORDER_FOCUS:"#797775",TASK_BORDER:"#252423",TASK_CHECKBOX_COLOR:"#31752F",TASK_CHECKBOX_COLOR_COMPLETED_HOVER:"#255924",TASK_CHECKMARK_COLOR:"#31752F",TASK_DISABLED:"#A19F9D",TASK_TEXT:"#252423"},d="10px",u=Object(r.c)((function(e,t){var n,r,d,u=Object(o.eb)(!t&&{color:s.TASK_TEXT,selectors:{":hover":{selectors:{".ms-Checkbox-text":Object(o.eb)({color:s.TASK_TEXT,selectors:(n={},n[o.m]={color:"HighlightText"},n)},e&&{color:Object(i.a)().primary})}}}}),l={alignItems:"center",border:"1px solid transparent",borderRadius:"3px",borderSpacing:"2px",height:"16px",overflow:"hidden",padding:"3px",selectors:(r={":hover":c.l},r[o.m]={color:"ButtonText"},r)},f=Object(o.eb)({borderRadius:c.c,boxSizing:"content-box",height:"14px",textAlign:"center",width:"14px"},t&&{borderColor:s.TASK_DISABLED}),m={selectors:(d={},d[".".concat(a.a," &:focus + .ms-Checkbox-label:before")]={outline:"none"},d[".".concat(a.a," &:focus + .ms-Checkbox-label")]={borderColor:s.TASK_BORDER_FOCUS},d[".".concat(a.a," &:focus + label")]=c.k,d[".".concat(a.a," &:focus + label .ms-Checkbox-text")]=c.k,d)};return Object(o.db)({root:u,label:l,checkbox:f,input:m})})),l=Object(r.c)((function(){return{CHECKMARK_ICON_TOPPER:{iconName:"TaskStatusCircleCheckmark",style:{height:"7px",width:"10px",transform:"translateY(-7.5px)"}},CHECKMARK_ICON_ASSIGNER:{iconName:"TaskStatusCircleCheckmark",style:{height:"10px",transform:"translateY(-1px)",width:"14px"}}}}))},28279:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.prototype.getThemeMode=function(){return 0},e.prototype.registerOnThemeChanged=function(e){},e.prototype.convertColorForTheme=function(e,t){return e},e}()},28280:function(e,t,n){"use strict";n.d(t,"z",(function(){return i})),n.d(t,"G",(function(){return c})),n.d(t,"E",(function(){return s})),n.d(t,"r",(function(){return d})),n.d(t,"n",(function(){return u})),n.d(t,"U",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"F",(function(){return m})),n.d(t,"L",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"v",(function(){return v})),n.d(t,"e",(function(){return h})),n.d(t,"k",(function(){return b})),n.d(t,"t",(function(){return C})),n.d(t,"K",(function(){return y})),n.d(t,"C",(function(){return T})),n.d(t,"J",(function(){return O})),n.d(t,"g",(function(){return I})),n.d(t,"X",(function(){return S})),n.d(t,"b",(function(){return j})),n.d(t,"x",(function(){return _})),n.d(t,"A",(function(){return k})),n.d(t,"P",(function(){return E})),n.d(t,"M",(function(){return D})),n.d(t,"I",(function(){return A})),n.d(t,"p",(function(){return P})),n.d(t,"w",(function(){return x})),n.d(t,"q",(function(){return w})),n.d(t,"V",(function(){return R})),n.d(t,"l",(function(){return F})),n.d(t,"B",(function(){return N})),n.d(t,"W",(function(){return M})),n.d(t,"m",(function(){return L})),n.d(t,"s",(function(){return B})),n.d(t,"o",(function(){return V})),n.d(t,"D",(function(){return U})),n.d(t,"R",(function(){return H})),n.d(t,"f",(function(){return q})),n.d(t,"S",(function(){return G})),n.d(t,"Y",(function(){return z})),n.d(t,"i",(function(){return W})),n.d(t,"h",(function(){return Y})),n.d(t,"a",(function(){return K})),n.d(t,"y",(function(){return X})),n.d(t,"H",(function(){return Q})),n.d(t,"u",(function(){return J})),n.d(t,"j",(function(){return $})),n.d(t,"T",(function(){return Z})),n.d(t,"Q",(function(){return ee})),n.d(t,"O",(function(){return te})),n.d(t,"N",(function(){return ne}));var r=n(28079),o=n(28281),a=n(28282);function i(){return Object(a.a)("LivePersonaPicker")}function c(){return Object(a.a)("PersonaFeature")}function s(){return Object(a.a)("NewCommentButton")}function d(){return Object(a.a)("DiscreteHostedComments")}function u(){return Object(a.a)("CommentsFluentUI")}function l(){return Object(a.a)("RenderDHCInPane")}function f(){return Object(a.a)("CommentTasks")}function m(){return Object(a.a)("NewDraftingUI")}function p(){return Object(a.a)("TaskPaneWithNewInfrastructure")}function g(){return Object(a.a)("CommentTasksFromReply")}function v(){return Object(a.a)("HeadlessBoot")}function h(){return Object(a.a)("HyperlinksInComments")}function b(){return Object(a.a)("AtMentionFloodgateSurvey")}function C(){return Object(a.a)("ExtendedDrafting")}function y(){return Object(a.a)("RichTextFormattingInWeb")}function T(){return Object(a.a)("LogDraftCommentIdPair")}function O(){return Object(a.a)("RichContentEditIntegrationInWeb")}function I(){return Object(a.a)("SmartReplies")}function S(){return Object(a.a)("NewSelectionInteractions")}function j(){return Object(a.a)("CommentReactions")}function _(){return Object(a.a)("HyperlinksWithDisplayText")}function k(){return Object(a.a)("LinkToComment")}function E(){return Object(a.a)("WebThemeIntegration")}function D(){return Object(a.a)("TruncationUIWithReadMoreText")}function A(){return Object(a.a)("QuickEdit")}function P(){return Object(a.a)("CtrlEnterTip")}function x(){return Object(a.a)("HighlightsAndFontColorInWebComments")}function w(){return Object(a.a)("DiagnosticHeartbeat")}function R(){return Object(a.a)("TaskHistoryRecordIDs")}function F(){return Object(a.a)("AtMentionHintMessage")}function N(){return Object(a.a)("LivePersonaCardForWeb")}function M(){return Object(a.a)("MapBasedStore")}function L(){return Object(a.a)("CommentTasksMultiAssignCreation")}function B(){return Object(a.a)("DraftSessionRehydration")}function V(){return Object(a.a)("ConsumerEmailLPPEnabled")}function U(){return!1}function H(){return Object(o.a)().isChangeGateEnabled("DelayLoadImmerES5",Object(r.e)(6051195))}function q(){return Object(o.a)().isChangeGateEnabled("AlignPlaceholderAndA11yLabelValuesV2",Object(r.e)(7522018))}function G(){return Object(o.a)().isChangeGateEnabled("ContentFilterPaneDraftFixes",Object(r.e)(7595190))}function z(){return Object(o.a)().isChangeGateEnabled("UseSharedIconRegistrationList",Object(r.e)(7773867))}function W(){return Object(o.a)().isChangeGateEnabled("FilterCountNewColor",Object(r.e)(7717507))}function Y(){return Object(o.a)().isChangeGateEnabled("TaskAssigneeAriaDescendant",Object(r.e)(7809576))}function K(){return Object(o.a)().isChangeGateEnabled("TeamsHighContrastTheme",Object(r.e)(7805339))}function X(){return Object(o.a)().isChangeGateEnabled("KeyboardShortcutForStrikethrough",Object(r.e)(7825471))}function Q(){return Object(o.a)().isChangeGateEnabled("PreventReactionInViewMode",Object(r.e)(7974645))}function J(){return Object(o.a)().isChangeGateEnabled("FixMultipleGetFilteredRangeCalls",Object(r.e)(7991826))}function $(){return Object(o.a)().isChangeGateEnabled("SetSupportsFilterUpdatesToTrue",Object(r.e)(7988779))}function Z(){return Object(o.a)().isChangeGateEnabled("MoveNewCommentButton",Object(r.e)(7991302))}function ee(){return Q()&&Object(o.a)().isChangeGateEnabled("PreventReactionForResolvedThread",Object(r.e)(7991344))}function te(){return Object(o.a)().isChangeGateEnabled("V9FilterMenu",Object(r.e)(8027278))}function ne(){return Object(o.a)().isChangeGateEnabled("UrlSanitizing",Object(r.e)(8141725))}},28281:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,o=n(28062),a=n(28079),i=n(28271);function c(){if(!r)try{r=Object(a.b)()}catch(e){throw new i.a("FeatureGateAPI not initialized",o.d.reserveTag(589103629),-2130957531)}return r}},28282:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28091),o=n(28281),a=n(28283);function i(e,t){return void 0===t&&(t=new Set),!!Object(o.a)().isFeatureEnabled(e)&&(t.add(e),a.a[e].dependencies.every((function(n){var o=t.has(n)||i(n,t);return Object(r.k)().assertConditionTag(o,"Gate ".concat(e," enabled without dependency gate ").concat(n),544482649),o})))}},28283:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={LivePersonaPicker:{webSettingName:"LivePersonaPicker",dependencies:[]},PersonaFeature:{webSettingName:"PersonaColor",dependencies:[]},NewCommentButton:{webSettingName:"NewCommentButton",dependencies:[]},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments",dependencies:["NewDraftingUI"]},CommentsFluentUI:{webSettingName:"CommentsFluentUI",dependencies:[]},RenderDHCInPane:{dependencies:[]},CommentTasks:{webSettingName:"CommentTasks",dependencies:["CommentsFluentUI"]},NewDraftingUI:{webSettingName:"DiscreteHostedComments",dependencies:[]},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure",dependencies:[]},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},HeadlessBoot:{dependencies:[]},HyperlinksInComments:{webSettingName:"HyperlinksInComments",dependencies:[]},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText",dependencies:[]},ContentNavigation:{webSettingName:"ContentNavigation",dependencies:[]},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey",dependencies:[]},ExtendedDrafting:{webSettingName:"ExtendedDrafting",dependencies:["NewDraftingUI"]},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb",dependencies:[]},SmartReplies:{webSettingName:"SmartReplies",dependencies:[]},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",dependencies:[]},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration",dependencies:[]},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions",dependencies:[]},CommentReactions:{webSettingName:"CommentReactions",dependencies:[]},LinkToComment:{webSettingName:"LinkToComment",dependencies:[]},WebThemeIntegration:{webSettingName:"WebThemeIntegration",dependencies:[]},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText",dependencies:[]},QuickEdit:{dependencies:[]},CtrlEnterTip:{webSettingName:"CtrlEnterTip",dependencies:["CommentsFluentUI"]},FluentSVRefreshWin32:{dependencies:[]},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},DiagnosticHeartbeat:{dependencies:[]},TaskHistoryRecordIDs:{webSettingName:"TaskHistoryRecordIDs",dependencies:[]},AtMentionHintMessage:{webSettingName:"AtMentionHintMessage",dependencies:[]},LivePersonaCardForWeb:{webSettingName:"LivePersonaCardForWeb",dependencies:[]},MapBasedStore:{webSettingName:"MapBasedStore",dependencies:[]},ContentFiltering:{dependencies:[]},CommentTasksMultiAssignCreation:{webSettingName:"CommentTasksMultiAssignCreation",dependencies:["CommentTasks","CommentTasksFromReply"]},DraftSessionRehydration:{webSettingName:"DraftSessionRehydration",dependencies:[]},ConsumerEmailLPPEnabled:{webSettingName:"ConsumerEmailLPPEnabled",dependencies:[]}}},28284:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r=n(12708);function o(e){var t,n=[{}];return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n.every((function(e,t){return e===o[t]}))?t:(n=o,t=e.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(o),!1)))}}function a(e,t){var n=o(e);return function(){return n.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(t()),!1))}}function i(e,t,n){var a=o(t);return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.apply(void 0,Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(e),!1),Object(r.__read)(n()),!1))}}},28285:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17800),o=n(13555);const a=Object(r.a)(o.a)},28286:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28287);const o=Object(r.a)()},28287:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(28289),o=n(28288),a=n(13544),i=n(13545),c=n(13546),s=n(13554),d=n(13548),u=n(13549),l=n(13547);const f=()=>{const e=Object(o.a)();return{...a.a,...i.b,...i.d,...i.a,...i.c,...c.a,...l.a,...l.b,...d.a,...u.a,...e,...r.a,...r.b,...Object(s.a)(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...Object(s.a)(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}}},28288:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(13543);const o=()=>({colorNeutralForeground1:r.y,colorNeutralForeground1Hover:r.B,colorNeutralForeground1Pressed:r.B,colorNeutralForeground1Selected:r.B,colorNeutralForeground2:r.y,colorNeutralForeground2Hover:r.B,colorNeutralForeground2Pressed:r.B,colorNeutralForeground2Selected:r.B,colorNeutralForeground2BrandHover:r.B,colorNeutralForeground2BrandPressed:r.B,colorNeutralForeground2BrandSelected:r.B,colorNeutralForeground3:r.y,colorNeutralForeground3Hover:r.B,colorNeutralForeground3Pressed:r.B,colorNeutralForeground3Selected:r.B,colorNeutralForeground3BrandHover:r.B,colorNeutralForeground3BrandPressed:r.B,colorNeutralForeground3BrandSelected:r.B,colorNeutralForeground4:r.y,colorNeutralForegroundDisabled:r.z,colorNeutralForegroundInvertedDisabled:r.z,colorBrandForegroundLink:r.C,colorBrandForegroundLinkHover:r.C,colorBrandForegroundLinkPressed:r.C,colorBrandForegroundLinkSelected:r.C,colorNeutralForeground2Link:r.C,colorNeutralForeground2LinkHover:r.C,colorNeutralForeground2LinkPressed:r.C,colorNeutralForeground2LinkSelected:r.C,colorCompoundBrandForeground1:r.A,colorCompoundBrandForeground1Hover:r.A,colorCompoundBrandForeground1Pressed:r.A,colorBrandForeground1:r.y,colorBrandForeground2:r.y,colorBrandForeground2Hover:r.y,colorBrandForeground2Pressed:r.y,colorNeutralForeground1Static:r.x,colorNeutralForegroundStaticInverted:r.y,colorNeutralForegroundInverted:r.B,colorNeutralForegroundInvertedHover:r.B,colorNeutralForegroundInvertedPressed:r.B,colorNeutralForegroundInvertedSelected:r.B,colorNeutralForegroundInverted2:r.y,colorNeutralForegroundOnBrand:r.w,colorNeutralForegroundInvertedLink:r.C,colorNeutralForegroundInvertedLinkHover:r.C,colorNeutralForegroundInvertedLinkPressed:r.C,colorNeutralForegroundInvertedLinkSelected:r.C,colorBrandForegroundInverted:r.y,colorBrandForegroundInvertedHover:r.B,colorBrandForegroundInvertedPressed:r.B,colorBrandForegroundOnLight:r.w,colorBrandForegroundOnLightHover:r.B,colorBrandForegroundOnLightPressed:r.B,colorBrandForegroundOnLightSelected:r.B,colorNeutralBackground1:r.x,colorNeutralBackground1Hover:r.A,colorNeutralBackground1Pressed:r.A,colorNeutralBackground1Selected:r.A,colorNeutralBackground2:r.x,colorNeutralBackground2Hover:r.A,colorNeutralBackground2Pressed:r.A,colorNeutralBackground2Selected:r.A,colorNeutralBackground3:r.x,colorNeutralBackground3Hover:r.A,colorNeutralBackground3Pressed:r.A,colorNeutralBackground3Selected:r.A,colorNeutralBackground4:r.x,colorNeutralBackground4Hover:r.A,colorNeutralBackground4Pressed:r.A,colorNeutralBackground4Selected:r.A,colorNeutralBackground5:r.x,colorNeutralBackground5Hover:r.A,colorNeutralBackground5Pressed:r.A,colorNeutralBackground5Selected:r.A,colorNeutralBackground6:r.x,colorNeutralBackgroundInverted:r.x,colorNeutralBackgroundStatic:r.x,colorNeutralBackgroundAlpha:r.x,colorNeutralBackgroundAlpha2:r.x,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:r.A,colorSubtleBackgroundPressed:r.A,colorSubtleBackgroundSelected:r.A,colorSubtleBackgroundLightAlphaHover:r.A,colorSubtleBackgroundLightAlphaPressed:r.A,colorSubtleBackgroundLightAlphaSelected:r.A,colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:r.A,colorSubtleBackgroundInvertedPressed:r.A,colorSubtleBackgroundInvertedSelected:r.A,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:r.A,colorTransparentBackgroundPressed:r.A,colorTransparentBackgroundSelected:r.A,colorNeutralBackgroundDisabled:r.x,colorNeutralBackgroundInvertedDisabled:r.x,colorNeutralStencil1:r.y,colorNeutralStencil2:r.y,colorNeutralStencil1Alpha:r.y,colorNeutralStencil2Alpha:r.y,colorBackgroundOverlay:r.e[50],colorScrollbarOverlay:r.v,colorBrandBackground:r.v,colorBrandBackgroundHover:r.A,colorBrandBackgroundPressed:r.A,colorBrandBackgroundSelected:r.A,colorCompoundBrandBackground:r.A,colorCompoundBrandBackgroundHover:r.A,colorCompoundBrandBackgroundPressed:r.A,colorBrandBackgroundStatic:r.x,colorBrandBackground2:r.x,colorBrandBackground2Hover:r.x,colorBrandBackground2Pressed:r.x,colorBrandBackground3Static:r.x,colorBrandBackground4Static:r.x,colorBrandBackgroundInverted:r.v,colorBrandBackgroundInvertedHover:r.A,colorBrandBackgroundInvertedPressed:r.A,colorBrandBackgroundInvertedSelected:r.A,colorNeutralCardBackground:r.x,colorNeutralCardBackgroundHover:r.A,colorNeutralCardBackgroundPressed:r.A,colorNeutralCardBackgroundSelected:r.A,colorNeutralCardBackgroundDisabled:r.x,colorNeutralStrokeAccessible:r.y,colorNeutralStrokeAccessibleHover:r.A,colorNeutralStrokeAccessiblePressed:r.A,colorNeutralStrokeAccessibleSelected:r.A,colorNeutralStroke1:r.y,colorNeutralStroke1Hover:r.A,colorNeutralStroke1Pressed:r.A,colorNeutralStroke1Selected:r.A,colorNeutralStroke2:r.y,colorNeutralStroke3:r.y,colorNeutralStrokeSubtle:r.y,colorNeutralStrokeOnBrand:r.x,colorNeutralStrokeOnBrand2:r.y,colorNeutralStrokeOnBrand2Hover:r.y,colorNeutralStrokeOnBrand2Pressed:r.y,colorNeutralStrokeOnBrand2Selected:r.y,colorBrandStroke1:r.y,colorBrandStroke2:r.y,colorBrandStroke2Hover:r.A,colorBrandStroke2Pressed:r.A,colorBrandStroke2Contrast:r.x,colorCompoundBrandStroke:r.A,colorCompoundBrandStrokeHover:r.A,colorCompoundBrandStrokePressed:r.A,colorNeutralStrokeDisabled:r.z,colorNeutralStrokeInvertedDisabled:r.z,colorTransparentStroke:r.y,colorTransparentStrokeInteractive:r.A,colorTransparentStrokeDisabled:r.z,colorNeutralStrokeAlpha:r.y,colorNeutralStrokeAlpha2:r.x,colorStrokeFocus1:r.x,colorStrokeFocus2:r.A,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"})},28289:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(13543),o=n(13551),a=n(13553);const i=o.b.reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorPalette${n}Background1`]:r.x,[`colorPalette${n}Background2`]:r.x,[`colorPalette${n}Background3`]:r.y,[`colorPalette${n}Foreground1`]:r.y,[`colorPalette${n}Foreground2`]:r.y,[`colorPalette${n}Foreground3`]:r.y,[`colorPalette${n}BorderActive`]:r.A,[`colorPalette${n}Border1`]:r.y,[`colorPalette${n}Border2`]:r.y};return Object.assign(e,o)},{});i.colorPaletteRedForegroundInverted=r.y,i.colorPaletteGreenForegroundInverted=r.y,i.colorPaletteYellowForegroundInverted=r.y;const c=o.a.reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorPalette${n}Background2`]:r.x,[`colorPalette${n}Foreground2`]:r.y,[`colorPalette${n}BorderActive`]:r.A};return Object.assign(e,o)},{}),s={...i,...c},d=Object.entries(a.a).reduce((e,[t,n])=>{const o=t.slice(0,1).toUpperCase()+t.slice(1),a={[`colorStatus${o}Background1`]:r.x,[`colorStatus${o}Background2`]:r.x,[`colorStatus${o}Background3`]:r.y,[`colorStatus${o}Foreground1`]:r.y,[`colorStatus${o}Foreground2`]:r.y,[`colorStatus${o}Foreground3`]:r.y,[`colorStatus${o}BorderActive`]:r.A,[`colorStatus${o}ForegroundInverted`]:r.y,[`colorStatus${o}Border1`]:r.y,[`colorStatus${o}Border2`]:r.y};return Object.assign(e,a)},{});d.colorStatusDangerBackground3Hover=r.A,d.colorStatusDangerBackground3Pressed=r.A},28290:function(e,t,n){"use strict";var r=n(28291);n.d(t,"a",(function(){return r.a}));n(28293),n(28295);var o=n(28296);n.d(t,"b",(function(){return o.b}))},28291:function(e,t,n){"use strict";var r=n(28292);n.d(t,"a",(function(){return r.a}))},28292:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},28293:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28294);function o(e){return e.containerType===r.b.HalfPane}},28294:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={})),t.b=r},28295:function(e,t,n){},28296:function(e,t,n){"use strict";n(28297),n(28298);var r=n(28299);n.d(t,"a",(function(){return r.a}));n(28300);var o=n(28294);n.d(t,"b",(function(){return o.a}))},28297:function(e,t,n){},28298:function(e,t,n){"use strict";var r;function o(e){if(!e)return!1;var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},28299:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},28300:function(e,t,n){},28301:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28302);function o(e,t){return new r.a(e,t)}},28302:function(e,t,n){"use strict";var r=n(12708),o=n(28280),a=n(28303),i=n(28305),c=n(28306),s=function(e){function t(t,n){var r=e.call(this)||this;return r.viewContainerProvider=n,r.apiContext=t,n.registerForViewContainerEvents(r.fireEvent),r}return Object(r.__extends)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(o.L()?this.currentContainer=new i.a(this.viewContainerProvider.getViewContainer(),this.apiContext,this):this.currentContainer=new c.a(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(a.a);t.a=s},28303:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28304),o=function(){function e(){var e=this;this.changedEvent=new r.a,this.fireEvent=function(t){e.changedEvent.invoke(t)}}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e}()},28304:function(e,t,n){"use strict";var r=n(12708),o=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(t),!1))}))}},enumerable:!1,configurable:!0}),e}();t.a=o},28305:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t,n){this.viewContainerBase=e,this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.identifier=e.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}()},28306:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(28062),o=n(28091),a=n(28147),i=n(11766),c=n(11769),s=n(28307),d=n(28310),u=n(28311),l=n(28312),f=n(28361),m=n(28299),p=function(){function e(e,t,n){var i=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.rootNode=null,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case f.a.Visible:i.viewContainerBase.identifier?i.rootNode=document.getElementById(i.viewContainerBase.identifier):Object(o.k)().assertConditionTag(!1,"View container base identifier expected",558401364),i.providerPromise.then((function(e){i.renderIntoView(e)})).catch(Object(d.a)(r.d.reserveTag(558401365)));break;case f.a.Closed:i.viewContainerBase.identifier&&i.rootNode&&(Object(c.unmountComponentAtNode)(i.rootNode),i.rootNode=null);break;case f.a.Hidden:Object(o.k)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",558401366);break;default:Object(r.m)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var s=Object(u.e)(u.a,t);this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(a.d)().getComponent(s),this.providerPromise.then((function(e){e.onStateChanged.subscribe(i.onProviderStateChange)})).catch(Object(d.a)(r.d.reserveTag(558401359))))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,r=Object(o.k)().createActivityObject("RenderPaneIntoView",l.a.getTelemetryVisitor(this.context),Object(o.j)());if(!n)return this.lastRenderFailed&&r.failTag(558401360,-2130957502),void(this.lastRenderFailed=!0);Object(c.render)(i.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(s.z());e&&e.focus(),t.lastRenderFailed=!1})),r.successTag(558401361)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===a.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(o.k)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",558401362)})):e===a.a.Unregistered&&Object(c.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case m.a.VisibilityChanged:this.processVisibilityEvent(e);break;case m.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case m.a.FoldableLayoutStateChanged:case m.a.FocusTriggered:break;default:Object(r.m)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}()},28307:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"G",(function(){return a})),n.d(t,"x",(function(){return i})),n.d(t,"I",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"A",(function(){return d})),n.d(t,"R",(function(){return u})),n.d(t,"v",(function(){return l})),n.d(t,"S",(function(){return f})),n.d(t,"Q",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"H",(function(){return g})),n.d(t,"O",(function(){return v})),n.d(t,"a",(function(){return h})),n.d(t,"w",(function(){return b})),n.d(t,"t",(function(){return C})),n.d(t,"h",(function(){return y})),n.d(t,"z",(function(){return T})),n.d(t,"l",(function(){return O})),n.d(t,"ab",(function(){return I})),n.d(t,"J",(function(){return S})),n.d(t,"r",(function(){return j})),n.d(t,"d",(function(){return _})),n.d(t,"b",(function(){return k})),n.d(t,"C",(function(){return E})),n.d(t,"p",(function(){return D})),n.d(t,"q",(function(){return A})),n.d(t,"y",(function(){return P})),n.d(t,"D",(function(){return x})),n.d(t,"U",(function(){return w})),n.d(t,"X",(function(){return R})),n.d(t,"W",(function(){return F})),n.d(t,"j",(function(){return N})),n.d(t,"k",(function(){return M})),n.d(t,"V",(function(){return L})),n.d(t,"Y",(function(){return B})),n.d(t,"K",(function(){return V})),n.d(t,"u",(function(){return U})),n.d(t,"L",(function(){return H})),n.d(t,"Z",(function(){return q})),n.d(t,"E",(function(){return G})),n.d(t,"M",(function(){return z})),n.d(t,"g",(function(){return W})),n.d(t,"s",(function(){return Y})),n.d(t,"c",(function(){return K})),n.d(t,"P",(function(){return X})),n.d(t,"F",(function(){return Q})),n.d(t,"B",(function(){return J})),n.d(t,"T",(function(){return $})),n.d(t,"N",(function(){return Z})),n.d(t,"o",(function(){return ee})),n.d(t,"m",(function(){return te})),n.d(t,"n",(function(){return ne}));n(28062),n(28091),n(28308),n(28309);function r(e){return"_".concat(e.renderContextType,"_").concat(e.id)}function o(e){return"cardEditor".concat(r(e))}function a(e){return"postEditor".concat(r(e))}function i(e){return"editorRoot_".concat(e)}function c(e){return"postRoot".concat(r(e))}function s(e,t){return t?"draftCardRoot".concat(r(e)):"cardRoot".concat(r(e))}function d(){return"GhostCard"}function u(e){return"replyBoxDescription".concat(r(e))}function l(e){return"editorBoxDescription".concat(r(e))}function f(e){return"sendReplyButton".concat(r(e))}function m(e){return"cancelReplyButton".concat(r(e))}function p(e){return"cardContextMenu".concat(r(e))}function g(e){return"postContextMenu".concat(r(e))}function v(e){return"renderableItemList".concat(r(e))}function h(e,t){return"actionBarButton_".concat(t).concat(r(e))}function b(e){return"editorFocusContainer_".concat(e)}function C(e){return"draftCancelButton".concat(r(e))}function y(e){return"innerReplyBoxContainer".concat(r(e))}function T(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function O(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function I(e){return"viewMoreReply".concat(r(e))}function S(e){return"postTimeStamp".concat(r(e))}function j(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function _(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function k(e){return"anchorHintText".concat(r(e))}function E(e){return"lowFidelityWarning".concat(r(e))}function D(){return"CommentsListScrollView"}function A(){return"CommentsList"}function P(){return"EmptyCreatedCommentLie"}function x(){return"NewCommentButton"}function w(e){return"taskAssignerCheckbox".concat(r(e))}function R(e){return"cardTaskFooterPickerButton".concat(r(e))}function F(e){return"taskAssignerLabel".concat(r(e))}function N(e){return"cardTaskTopperCheckbox".concat(r(e))}function M(e){return"cardTaskTopperDiv".concat(r(e))}function L(e){return"taskAssignerDiv".concat(r(e))}function B(){return"TaskChevronIcon"}function V(e){return"postWarning".concat(r(e))}function U(e){return"draftWarning".concat(r(e))}function H(e){return"postingTip".concat(r(e),";")}function q(e){return"truncationOverlay".concat(e)}function G(){return"next-thread-button"}function z(){return"previous-thread-button"}function W(e){return"loadingPlaceholder".concat(r(e))}function Y(e){return"DiscreteHostedCommentRoot".concat(r(e))}function K(e){return"AtMentionExtraInfoButton".concat(r(e))}function X(){return"ReopenThread"}function Q(){return"suggestion-list"}function J(){return"lppSuggestionListId"}function $(e){return"smartReplyHeader_".concat(e)}function Z(e){return"reactionButtonDescription_".concat(e)}function ee(e){return"reactionButtonUserList_".concat(e)}function te(e,t){return"".concat(e,"_").concat(t)}function ne(e){return"commentReactionButton".concat(r(e))}},28308:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));var r="SharedComments_Pane_ThreadAnnotation_Id:(.*)_Context:(.*)",o="SharedComments_Pane_DraftThreadAnnotation_Id:(.*)_Context:(.*)",a="SharedComments_DHCIsolated_ThreadAnnotation_Id:(.*)_Context:(.*)",i="SharedComments_DHCIsolated_DraftThreadAnnotation_Id:(.*)_Context:(.*)",c="SharedComments_DHCIntegrated_ThreadAnnotation_Id:(.*)_Context:(.*)",s="SharedComments_DHCIntegrated_DraftThreadAnnotation_Id:(.*)_Context:(.*)",d="unk://SharedCommentsCanvas/(.*)",u="(.*)"},28309:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={})),t.a=r},28310:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28062),o=n(28091),a=n(28271),i=function(e){return function(t){Object(a.b)(t)?Object(o.k)().assertConditionTag(!1,t.message,e):Object(o.k)().assertConditionTag(!1,"Unknown error ".concat(Object(r.l)(t)),e)}}},28311:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return c}));var r="SharedCommentPane",o="TaskPaneItemCommentCard",a="DiscreteIntegratedCommentCard",i="DiscreteIsolatedCommentCard";function c(e,t){return"".concat(e,"-").concat(t)}},28312:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return C}));var r=n(28313),o=n(28062),a=n(28091),i=n(28340),c=n(28354),s=n(28359),d=n(28292),u=n(28294),l=n(28360),f=n(28271),m=n(28280),p=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField("InstanceCorrelationId",n.correlationId,a.d.SystemMetadata)}};function g(e){return new p(h(e),e.correlationId)}var v=function(){throw new Error("ViewManagerFactory not set")},h=v;function b(e){h=e}function C(){h=v}var y=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this;return this.instanceMap.get(e)||{visit:function(n){var r=t.instanceMap.get(e);if(!r)return n.attachContext(e),void n.addDataField("MissingInstanceTelemetry",!0,a.d.SystemMetadata);r.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.disposeViewManager=function(){var e=this;this.instanceMap.forEach((function(t,n){Object(i.e)(n),e.closeViewManager(n)}))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,r=e.contentNavigationAPIMockSettings,o=e.contentFilteredRangeHostAPIMockSettings;this.initialized||this.ensureInitialized();var a=this.instanceMap.get(t);return a?this.updateInstanceObject(a,n):(this.initializeContentNavigationAPI(t,r),this.initializeContentFilteredRangeAPI(t,o),a=g(e),this.instanceMap.set(t,a)),a.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new f.a("Instance is not initialized",o.d.reserveTag(589103622),-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new f.a("Instance is not initialized",o.d.reserveTag(589103623),-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;m.v()&&c.a.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeContentFilteredRangeAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),c.a.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(i.e)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var r=this.instanceMap.get(e);if(r)r.correlationId=t;else{var o=void 0;n&&m.r()&&(Object(a.k)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),Object(a.n)({diagnosticLevel:a.b.FullEvent})).successTag(592511450),o=new s.a(e)),this.instanceMap.set(e,g({apiContext:e,correlationId:t,initializationReason:l.a.PaneOpen,displayMode:u.b.FullPane,foldableLayoutState:d.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:o}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){if(!Object(i.g)(e)){if(t)return void(t.useMock&&Object(i.h)(t.mock,e));var n=new i.b(e);n.isAPIEnabled()&&Object(i.h)(n,e)}},e.prototype.initializeContentFilteredRangeAPI=function(e,t){if(!Object(r.e)(e)){if(t)return void(t.useMock&&Object(r.f)(e,t.mock));Object(r.f)(e,new r.b(e))}},e}());t.a=y},28313:function(e,t,n){"use strict";var r=n(28314);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c}));var o=n(28329);n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"f",(function(){return o.c}));n(28338)},28314:function(e,t,n){"use strict";var r=n(28315);n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return r.b}));var o=n(28327);n.d(t,"b",(function(){return o.a}))},28315:function(e,t,n){"use strict";var r=n(28316);n.d(t,"b",(function(){return r.a}));var o=n(28317);n.d(t,"c",(function(){return o.a}));n(28318),n(28319);var a=n(28320);n.d(t,"a",(function(){return a.a}));n(28322),n(28323),n(28324),n(28325),n(28326)},28316:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.HostDefaultOrder=0]="HostDefaultOrder",e[e.NewestFirst=1]="NewestFirst"}(r||(r={}))},28317:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.UnableToReconcile=1]="UnableToReconcile",e[e.DivergentChange=2]="DivergentChange"}(r||(r={}))},28318:function(e,t,n){},28319:function(e,t,n){},28320:function(e,t,n){"use strict";var r=n(28321);n.d(t,"a",(function(){return r.a}))},28321:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.All=0]="All",e[e.ResolvedOnly=1]="ResolvedOnly",e[e.ActiveOnly=2]="ActiveOnly"}(r||(r={}))},28322:function(e,t,n){},28323:function(e,t,n){},28324:function(e,t,n){},28325:function(e,t,n){},28326:function(e,t,n){},28327:function(e,t,n){"use strict";var r=n(28328);n.d(t,"a",(function(){return r.a}))},28328:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28062),o=n(28152),a=function(){function e(e){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new r.c("Method not implemented.",r.d.reserveTag(537743701))},this.getExistingFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537743702))},this.updateFilterForFilteredRangeId=function(e,t){throw new r.c("Method not implemented.",r.d.reserveTag(537743703))},this.setActiveFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537743704))},this.getActiveFilteredRangeId=function(){throw new r.c("Method not implemented.",r.d.reserveTag(537743705))},this.onFilteredRangeUpdated=new o.EventImpl((function(){})),this.onUserFilterManagerEvent=new o.EventImpl((function(){})),this.onActiveFilterUpdated=new o.EventImpl((function(){}))}return e.prototype.getFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537743697))},e.prototype.teardownFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537743698))},e.prototype.getOrder=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537743699))},e.prototype.getFilterUsers=function(){throw new r.c("Method not implemented.",r.d.reserveTag(537743706))},e}()},28329:function(e,t,n){"use strict";var r=n(28330);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c}))},28330:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f}));var r=n(28057),o=n(28062),a=n(28082),i=n(28091),c=n(28331),s=n(28337),d=new Map;function u(e,t){Object(i.k)().assertConditionTag(!Object(s.a)()||e===r.a,"Received unexpected API Context for Web. This is not fully supported for all APIs.",538035220);var n=d.get(e);n||(n=new a.a("ContentFilteredRange"),d.set(e,n)),n.injectInstance(new c.a(t))}function l(e){var t=d.get(e);if(!t)throw new o.c("ContentFilteredRangeAPI not initialized for current apiContenxt ".concat(e,"."),o.d.reserveTag(538035221));return t.getInstanceOrThrow()}function f(e){var t;return void 0!==(null===(t=d.get(e))||void 0===t?void 0:t.getInstance())}},28331:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28332),o=n(28333),a=function(e){var t=this;this.contentFilteredRangeHostAPI=e,this.filteredRanges=new Map,this.createFilteredRange=function(e){return t.contentFilteredRangeHostAPI.getFilteredRange({contentTypes:e.contentTypes,hostFilter:e.filters,supportsFilterUpdates:e.supportsFilterUpdates}).then((function(e){var n=e.filterId,o=new r.a(n,e.filter,e.content,t.contentFilteredRangeHostAPI,e.supportsFilterUpdates,(function(){return t.onFilterTearDown(n)}));return t.filteredRanges.set(n,o),o}))},this.getFilteredRange=function(e){return t.filteredRanges.has(e)?Promise.resolve(t.filteredRanges.get(e)):t.contentFilteredRangeHostAPI.getExistingFilteredRange(e).then((function(n){if(n){var o=new r.a(n.filterId,n.filter,n.content,t.contentFilteredRangeHostAPI,n.supportsFilterUpdates,(function(){return t.onFilterTearDown(e)}));return t.filteredRanges.has(e)||t.filteredRanges.set(e,o),o}}))},this.setActiveFilteredRange=function(e){t.contentFilteredRangeHostAPI.setActiveFilteredRange(e)},this.getActiveFilteredRangeId=function(){return t.contentFilteredRangeHostAPI.getActiveFilteredRangeId()},this.onEventReceived=function(e){var n=t.filteredRanges.get(e.filterId);n&&n.onChangeEventReceived(e.payload)},this.onFilterTearDown=function(e){t.filteredRanges.delete(e)},this.getCapabilities=function(){return t.contentFilteredRangeHostAPI.getCapabilities()},this.getHostSpecificLabels=function(){return t.contentFilteredRangeHostAPI.getHostSpecificLabels()},this.getUserFilterManager=function(){return t.userFilterManager},this.onActiveFilterUpdated=this.contentFilteredRangeHostAPI.onActiveFilterUpdated,this.contentFilteredRangeHostAPI.onFilteredRangeUpdated.subscribe(this.onEventReceived),this.userFilterManager=new o.a(e)}},28332:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12708),o=n(28091),a=n(28152),i=n(28315),c=function(){function e(e,t,n,r,o,i){this.id=e,this.filter=t,this.order=n,this.hostAPI=r,this.supportsUpdates=o,this.onTeardown=i,this.active=!0,this.onRangeUpdated=new a.EventImpl((function(){}))}return e.prototype.getFilter=function(){return this.filter},e.prototype.getOrder=function(){return this.order},e.prototype.isActive=function(){return this.active},e.prototype.teardown=function(){this.active=!1,this.hostAPI.teardownFilteredRange(this.id),this.onTeardown()},e.prototype.canBeUpdated=function(){return this.supportsUpdates},e.prototype.updateFilter=function(e){return!!this.supportsUpdates&&(this.filter=e,this.hostAPI.updateFilterForFilteredRangeId(this.id,Object(r.__assign)({},e)),!0)},e.prototype.onChangeEventReceived=function(e){if(this.active){for(var t=0,n=e.changes;t<n.length;t++){var a=n[t];if(this.active)switch(a.type){case"FilterUpdate":this.filter=a.updatedFilter;break;case"Insert":this.order=Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)([],this.order.slice(0,a.index),!0),[a.content],!1),this.order.slice(a.index),!0);break;case"Remove":this.order=Object(r.__spreadArray)(Object(r.__spreadArray)([],this.order.slice(0,a.index),!0),this.order.slice(a.index+1),!0);break;case"Reload":this.order=a.fullContent,Object(o.k)().assertConditionTag(a.reason===i.c.DivergentChange,"Received a full reload for an error reason.",537743690);break;case"Teardown":this.active=!1}}this.onRangeUpdated.trigger(e)}},e}()},28333:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12708),o=n(28062),a=n(28334),i=function(e){var t=this;this.hostApi=e,this.getFilterUsers=function(){return void 0!==t.cachedUsers?Promise.resolve(t.cachedUsers):t.hostApi.getFilterUsers().then((function(e){return t.cachedUsers=e,e}))},this.onUserFilterManagerEventReceived=function(e){if(t.cachedUsers){var n=e.payload.type;switch(n){case"UserAdded":t.cachedUsers=Object(r.__spreadArray)(Object(r.__spreadArray)([],t.cachedUsers,!0),[e.payload.user],!1);break;case"UserRemoved":t.cachedUsers=Object(a.a)()?t.cachedUsers.filter((function(t){return t.Provider!==e.payload.user.Provider||t.UserId!==e.payload.user.UserId})):t.cachedUsers.filter((function(t){return t.Provider===e.payload.user.Provider&&t.UserId===e.payload.user.UserId}));break;default:Object(o.m)(n)}}},this.onUserFilterManagerEvent=this.hostApi.onUserFilterManagerEvent,this.hostApi.onUserFilterManagerEvent.subscribe(this.onUserFilterManagerEventReceived)}},28334:function(e,t,n){"use strict";n(28335);var r=n(28336);n.d(t,"a",(function(){return r.a}))},28335:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r,o=n(28079);function a(){return r||(r=Object(o.b)())}},28336:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28079),o=n(28335);function a(){return Object(o.a)().isChangeGateEnabled("FixUserRemovedEvent",Object(r.e)(7593842))}},28337:function(e,t,n){"use strict";function r(){return!0}n.d(t,"a",(function(){return r}))},28338:function(e,t,n){"use strict";n(28339)},28339:function(e,t,n){"use strict";var r=n(28062),o=n(28152);!function(){function e(){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new r.c("Method not implemented.",r.d.reserveTag(537421141))},this.getExistingFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537421142))},this.updateFilterForFilteredRangeId=function(e,t){throw new r.c("Method not implemented.",r.d.reserveTag(537421143))},this.setActiveFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537421144))},this.getActiveFilteredRangeId=function(){throw new r.c("Method not implemented.",r.d.reserveTag(537421145))},this.onFilteredRangeUpdated=new o.EventImpl((function(){})),this.onUserFilterManagerEvent=new o.EventImpl((function(){})),this.onActiveFilterUpdated=new o.EventImpl((function(){}))}e.prototype.getFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537421138))},e.prototype.teardownFilteredRange=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537421139))},e.prototype.getOrder=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(537421140))},e.prototype.getFilterUsers=function(){throw new r.c("Method not implemented.",r.d.reserveTag(537421146))}}()},28340:function(e,t,n){"use strict";var r=n(28341);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),n.d(t,"e",(function(){return r.e})),n.d(t,"f",(function(){return r.f})),n.d(t,"g",(function(){return r.g})),n.d(t,"h",(function(){return r.h}));n(28353)},28341:function(e,t,n){"use strict";var r=n(28342);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),n.d(t,"e",(function(){return r.e})),n.d(t,"f",(function(){return r.f})),n.d(t,"g",(function(){return r.g})),n.d(t,"h",(function(){return r.h}))},28342:function(e,t,n){"use strict";n(28343);var r=n(28344);n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c}));var o=n(28348);n.d(t,"b",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"f",(function(){return o.c})),n.d(t,"g",(function(){return o.d})),n.d(t,"h",(function(){return o.e}));n(28352)},28343:function(e,t,n){},28344:function(e,t,n){"use strict";var r=n(28345);n.d(t,"a",(function(){return r.a}));var o=n(28346);n.d(t,"b",(function(){return o.a}));var a=n(28347);n.d(t,"c",(function(){return a.a}))},28345:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={}))},28346:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"}(r||(r={}))},28347:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(r||(r={}))},28348:function(e,t,n){"use strict";var r=n(28349);n.d(t,"a",(function(){return r.a}));var o=n(28350);n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return o.b})),n.d(t,"d",(function(){return o.c})),n.d(t,"e",(function(){return o.d}))},28349:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28062),o=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(523633811))},e.prototype.moveFocus=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(523633812))},e.prototype.bringContentIntoView=function(e){throw new r.c("Method not implemented.",r.d.reserveTag(523633813))},e.prototype.isAPIEnabled=function(){return!1},e}()},28350:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s}));var r,o=n(28351);function a(e,t){r=e}function i(e){return void 0===r&&(r=new o.a),r}function c(e){return void 0!==r}function s(e){r=void 0}},28351:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}()},28352:function(e,t,n){},28353:function(e,t,n){"use strict";n(28351)},28354:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28159),o=(n(28355),n(28357));n.d(t,"b",(function(){return o.a}));var a={sendCodeMarker:function(e){},onStartEvent:new r.EventImpl((function(){})),onStopEvent:new r.EventImpl((function(){}))}},28355:function(e,t,n){"use strict";n(28356)},28356:function(e,t,n){},28357:function(e,t,n){"use strict";var r=n(28358);n.d(t,"a",(function(){return r.a}))},28358:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(r||(r={}))},28359:function(e,t,n){"use strict";var r=n(28159),o=function(e){this.onMockUIAction=new r.EventImpl((function(){}))};t.a=o},28360:function(e,t,n){"use strict";var r;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={})),t.a=r},28361:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},28362:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(28368),o=n(28363),a=n(11766),i=n(11769),c=n(28280),s=n(28366),d=void 0;function u(){if(c.Y())d=document.createElement("div"),document.body.appendChild(d),i.render(a.createElement(s.a,{ref:m}),d);else{var e=document.createElement("div");document.body.appendChild(e),i.render(a.createElement(s.a,{ref:m}),e)}Object(o.b)({announceToScreenReader:function(e){var t=f;t&&Object(r.a)(e)&&t.appendLiveRegionUpdate(e)}})}function l(){c.Y()&&(void 0!==d&&document.body.removeChild(d),d=void 0),m(null)}var f=void 0;function m(e){f=e}},28363:function(e,t,n){"use strict";n(28364);var r=n(28146);n.d(t,"a",(function(){return r.b})),n.d(t,"b",(function(){return r.d}))},28364:function(e,t,n){"use strict";n(28365)},28365:function(e,t,n){"use strict";new(n(28146).a)},28366:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12708),o=n(11766),a=n(28367),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(r.__extends)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=Object(a.a)();return o.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(o.PureComponent)},28367:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12786),o=Object(r.c)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:0,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:0}}}))},28368:function(e,t,n){"use strict";function r(e){return!function(e){return null==e}(e)}n.d(t,"a",(function(){return r}))},28369:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(28062),o=n(28091),a=n(28370),i=!1,c=!1;function s(){var e=void 0;return c||(e=Object(o.k)().createActivityObject("LPPLazyLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)()),c=!0),f((function(){return Promise.all([n.e(83),n.e(192),n.e(246),n.e(273),n.e(254),n.e(371)]).then(n.bind(null,34665))}),e).then((function(t){return e&&e.successTag(528282444),t}),(function(t){e&&e.failTag(528282445,-2130957488),c=!1}))}function d(){var e;return i||(e=Object(o.k)().createActivityObject("AtMentionLazyLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)()),i=!0),Promise.all([n.e(246),n.e(374),n.e(373)]).then(n.bind(null,34769)).then((function(t){return e&&e.successTag(591677089),t})).catch((function(t){e&&e.failTag(595895121,-2130957515),i=!1}))}function u(e){var t,a=Object(o.k)().createActivityObject("SharedCommentsUILazyLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)());switch(a.addDataField("ContainerName",e,o.d.SystemMetadata),e){case"ExtensionAwareCommentPaneContainer":t=f((function(){return Promise.all([n.e(246),n.e(374),n.e(217),n.e(372)]).then(n.bind(null,34781))}),a);break;case"HostableCommentCardRendererContainer":t=f((function(){return Promise.all([n.e(246),n.e(374),n.e(217),n.e(372)]).then(n.bind(null,35116))}),a);break;default:Object(r.m)(e)}return t.then((function(e){return a.successTag(595731075),e}),(function(e){a.failTag(595734544,-2130957504)}))}function l(){var e=Object(o.k)().createActivityObject("ImmerEs5PluginDelayLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)());return"undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect?(e.successTag(526254848),Promise.resolve(void 0)):(Object(o.k)().assertConditionTag("web"===Object(a.a)(),"Native should not need to support the ES5 fallback and Immer reducers will fail",526254849),f((function(){return n.e(375).then(n.bind(null,35119))}),e).then((function(t){return e&&e.successTag(526254850),t}),(function(t){e&&e.failTag(526254851,-2130957484)})))}function f(e,t,n){void 0===n&&(n=3);return new Promise((function(r,a){e().then((function(e){t&&t.addDataField("DelayLoadRetryCount",n,o.d.SystemMetadata),r(e)}),(function(o){setTimeout((function(){1!==n?f(e,t,n-1).then(r,a):a(o)}),500)}))}))}},28370:function(e,t,n){"use strict";function r(){return"web"}n.d(t,"a",(function(){return r}))},28371:function(e,t,n){"use strict";n(28372),n(28373),n(28281);var r=n(28283);n.d(t,"a",(function(){return r.a}))},28372:function(e,t,n){},28373:function(e,t,n){},28374:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(12299),o=n(12754),a=n(11766),i=n(28280);function c(e){var t=n(28375),o=n(28376),c=Object(r.a)()?n(28377):n(28378),s=n(28379),d=n(28380),u=n(28381),l=n(28382),f=n(28383),m=n(28384),p=n(28385),g=n(28386),v=n(28387),h=n(28388),b={HintBarEllipses_16:a.createElement(t,null),CancelGlyph:a.createElement(o,null),NewComment:a.createElement(c,null),CancelGlyph_TaskPane:a.createElement(s,null),Send2_Fluent:a.createElement(d,null),Delete_Fluent:a.createElement(u,null),Edit_Fluent:a.createElement(l,null),Checkmark_Fluent:a.createElement(f,null),CommentReopen_Fluent:a.createElement(m,null),Error:a.createElement(p,null),ReopenThread:a.createElement(g,null),DeleteFilter:a.createElement(v,null),DeleteFilterDefault:a.createElement(h,null)};if(e||i.c()){var C=n(28389),y=n(28390),T=n(28391),O=n(28392),I=n(28386),S=n(28393),j=n(28394);b.TaskAssign=a.createElement(C,null),b.TaskComplete=a.createElement(y,null),b.TaskDelete=a.createElement(T,null),b.TaskEdit=a.createElement(O,null),b.TaskReopen=a.createElement(I,null),b.TaskStatusCircleCheckmark=a.createElement(S,null),b.ChevronDown12=a.createElement(j,null)}if(e||i.b()){var _=n(28395),k=n(28396);b.CommentLikeEmpty=a.createElement(_,null),b.CommentLikeSolid=a.createElement(k,null)}if(e||i.A()){var E=n(28397);b.LinkToComment=a.createElement(E,null)}return{icons:b}}function s(e){if(i.Y())Object(o.ib)(c(e));else{var t=n(28375),s=n(28376),d=Object(r.a)()?n(28377):n(28378),u=n(28379),l=n(28380),f=n(28381),m=n(28382),p=n(28383),g=n(28384),v=n(28385),h=n(28386),b=n(28387),C=n(28388),y={HintBarEllipses_16:a.createElement(t,null),CancelGlyph:a.createElement(s,null),NewComment:a.createElement(d,null),CancelGlyph_TaskPane:a.createElement(u,null),Send2_Fluent:a.createElement(l,null),Delete_Fluent:a.createElement(f,null),Edit_Fluent:a.createElement(m,null),Checkmark_Fluent:a.createElement(p,null),CommentReopen_Fluent:a.createElement(g,null),Error:a.createElement(v,null),ReopenThread:a.createElement(h,null),DeleteFilter:a.createElement(b,null),DeleteFilterDefault:a.createElement(C,null)};if(e||i.c()){var T=n(28389),O=n(28390),I=n(28391),S=n(28392),j=n(28386),_=n(28393),k=n(28394);y.TaskAssign=a.createElement(T,null),y.TaskComplete=a.createElement(O,null),y.TaskDelete=a.createElement(I,null),y.TaskEdit=a.createElement(S,null),y.TaskReopen=a.createElement(j,null),y.TaskStatusCircleCheckmark=a.createElement(_,null),y.ChevronDown12=a.createElement(k,null)}if(e||i.b()){var E=n(28395),D=n(28396);y.CommentLikeEmpty=a.createElement(E,null),y.CommentLikeSolid=a.createElement(D,null)}if(e||i.A()){var A=n(28397);y.LinkToComment=a.createElement(A,null)}Object(o.ib)({icons:y})}}function d(e){var t=c(e),n=[];for(var r in t.icons)void 0!==r&&n.push(r);n.length&&Object(o.mb)(n)}},28375:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},28376:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:0}),r.createElement("path",{className:"OfficeIconColors_m22",fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:1})])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},28377:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},28378:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},28379:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),r.createElement("path",{type:"path",fill:"currentColor",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},28380:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}o.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},28381:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}o.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},28382:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}o.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},28383:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}o.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},28384:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),r.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),r.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),r.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}o.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},28385:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}o.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},28386:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},28387:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#F9F9F9",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#3A3A38",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#ED3D3B",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}o.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=o,o.default=o},28388:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#FCFCFC",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#919190",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#FF9091",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}o.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=o,o.default=o},28389:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},28390:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=o,o.default=o},28391:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=o,o.default=o},28392:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},28393:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}o.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=o,o.default=o},28394:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),r.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}o.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},28395:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,r.createElement("path",{className:"LikeEmptyBorder",d:"M 1600 1792 h -512 q -163 0 -345 -76 q -123 -52 -295 -52 h -448 v -896 h 384 q 33 0 77 -9 q 43 -9 87 -24 q 44 -15 83 -35 q 38 -19 60 -41 l 509 -574 q 6 -7 20 -21 q 13 -14 35 -29 q 22 -14 52 -25 q 30 -10 69 -10 q 36 0 66 17 q 29 17 50 44 q 21 27 33 61 q 11 35 11 70 q 0 75 -16 142 q -17 67 -55 142 q -23 45 -35 84 q -13 40 -18 80 h 380 q 40 0 86 10 q 46 11 85 32 q 38 21 64 53 q 25 32 25 76 q 0 10 -2 20 q -2 10 -5 21 l -263 802 q -10 30 -28 55 q -19 26 -43 44 q -24 19 -52 29 q -29 10 -59 10 m -1472 -256 h 320 q 197 0 345 62 q 159 66 295 66 h 512 q 19 0 36 -15 q 17 -14 25 -36 l 262 -801 q -2 -6 -13 -14 q -12 -7 -30 -14 q -18 -6 -40 -11 q -23 -5 -48 -5 h -512 v -64 q 0 -74 17 -141 q 16 -67 54 -143 q 30 -62 44 -115 q 13 -53 13 -113 q 0 -11 -3 -23 q -3 -11 -8 -20 q -5 -9 -10 -15 q -6 -6 -11 -6 q -31 0 -48 12 q -18 13 -31 29 l -513 577 q -33 33 -83 60 q -50 28 -105 48 q -56 20 -112 31 q -56 11 -100 11 h -256 z"}))}o.defaultProps={width:"16px",height:"16px",viewBox:"0,0,2048,2048",focusable:"false",version:"1.1"},e.exports=o,o.default=o},28396:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"LikeSolidCenter",d:"M 1721 1633 q -13 40 -46 67 q -33 28 -75 28 h -512 q -86 0 -166 -20 q -80 -20 -154 -51 q -74 -31 -154 -44 q -80 -13 -166 -13 h -384 v -768 h 320 q 38 0 88 -10 q 50 -10 100 -27 q 49 -17 93 -41 q 44 -23 71 -50 l 512 -576 q 6 -7 16 -18 q 10 -11 26 -22 q 15 -10 37 -17 q 21 -7 49 -7 q 23 0 41 12 q 18 13 30 32 q 12 19 19 41 q 6 23 6 43 q 0 73 -16 133 q -17 60 -48 123 q -31 63 -47 123 q -17 60 -17 133 h 448 q 30 0 64 7 q 34 7 64 20 q 29 14 49 33 q 19 20 19 46 q 0 5 -1 10 q -1 6 -3 12 z",key:0}),r.createElement("path",{className:"LikeSolidBorder",d:"M 1600 1792 h -512 q -163 0 -345 -76 q -123 -52 -295 -52 h -448 v -896 h 384 q 33 0 77 -9 q 43 -9 87 -24 q 44 -15 83 -35 q 38 -19 60 -41 l 509 -574 q 6 -7 20 -21 q 13 -14 35 -29 q 22 -14 52 -25 q 30 -10 69 -10 q 36 0 66 17 q 29 17 50 44 q 21 27 33 61 q 11 35 11 70 q 0 75 -16 142 q -17 67 -55 142 q -23 45 -35 84 q -13 40 -18 80 h 380 q 40 0 86 10 q 46 11 85 32 q 38 21 64 53 q 25 32 25 76 q 0 10 -2 20 q -2 10 -5 21 l -263 802 q -10 30 -28 55 q -19 26 -43 44 q -24 19 -52 29 q -29 10 -59 10 m -1472 -256 h 320 q 197 0 345 62 q 159 66 295 66 h 512 q 19 0 36 -15 q 17 -14 25 -36 l 262 -801 q -2 -6 -13 -14 q -12 -7 -30 -14 q -18 -6 -40 -11 q -23 -5 -48 -5 h -512 v -64 q 0 -74 17 -141 q 16 -67 54 -143 q 30 -62 44 -115 q 13 -53 13 -113 q 0 -11 -3 -23 q -3 -11 -8 -20 q -5 -9 -10 -15 q -6 -6 -11 -6 q -31 0 -48 12 q -18 13 -31 29 l -513 577 q -33 33 -83 60 q -50 28 -105 48 q -56 20 -112 31 q -56 11 -100 11 h -256 z",key:1})])}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048"},e.exports=o,o.default=o},28397:function(e,t,n){var r=n(11766);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M 2048 1216 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -512 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 64 v 128 h -64 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -64 v -128 h 64 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 m -640 -384 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -512 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 512 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 z"})))])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},28398:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={name:"OfficeSharedComments",version:n(28399).a}},28399:function(e,t,n){"use strict";var r=n(28400).SharedCommentsVersion;t.a=r},28400:function(e){e.exports=JSON.parse('{"SharedCommentsVersion":"3.70.10"}')},28401:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28057),o=n(28312);function a(){return o.a.getViewManager(r.a)}},28402:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28401);function o(){Object(r.a)().beginInitialization()}},28403:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(28313),o=n(28062),a=n(28340),i=n(28404),c=n(28270),s=n(28449),d=n(28451),u=n(28631),l=n(28651),f=n(28271),m=n(28280),p=n(28681),g=n(28312),v=n(28752),h=n(28753);function b(e){if(void 0===e.hostCommentAPI)throw new f.a("'hostCommentAPI' was not supplied",o.d.reserveTag(589103634),-2130957511);if(void 0===e.peopleAPI)throw new f.a("'peopleAPI' was not supplied",o.d.reserveTag(589103635),-2130957511);if(void 0===e.viewContainerProvider)throw new f.a("'viewContainerProvider' was not supplied",o.d.reserveTag(589103636),-2130957511);var t=Object(a.g)(e.apiContext)?Object(a.f)(e.apiContext):void 0,n=Object(r.e)(e.apiContext)?Object(r.d)(e.apiContext):void 0,b=Object(c.b)(),C=e.themeAPI||new s.a,y=new i.a(e.hostCommentAPI),T=g.a.getTelemetryVisitor(e.apiContext),O=new d.a(b.getLocaleInfo().isRightToLeft,T),I=new v.a(e.peopleAPI,T,e.correlationId||"");m.z()&&I.initializeController(!1);var S=Object(u.a)(y,e.viewContainerProvider,Object(l.b)(e.viewContainerProvider.getViewContainer(),e.paneVisible,b.getLocaleInfo(),e.apiContext),g.a.getTelemetryVisitor(e.apiContext),t,b,O,I,n);return new p.a({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:y,peopleAPI:e.peopleAPI,localizationAPI:b,themeAPI:C,focusManager:O,lppManager:I,initializationReason:e.initializationReason,commentStore:S,viewStrategyFactory:new h.a,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver,contentNavigationAPI:t,contentFilteredRangeAPI:n})}},28404:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12708),o=n(28062),a=n(28195),i=n(28271),c=n(28280),s=n(28405),d=n(28418),u=function(){function e(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),e.getCommentReactionData&&(this.getCommentReactionData=e.getCommentReactionData.bind(e)),c.A()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e)),e.onClickableTextClicked&&(this.onClickableTextClicked=e.onClickableTextClicked.bind(e)),c.q()&&e.diagnosticHeartbeat&&setInterval((function(){var t;null===(t=e.diagnosticHeartbeat)||void 0===t||t.call(e)}),1e3)}return e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new i.a("Drafting APIs are undefined on Host Comment API",o.d.reserveTag(589103700),-2130957527);var n=Object(a.a)(),c=Object(r.__assign)(Object(r.__assign)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(c).then((function(e){return new d.a(t.hostCommentAPI,Object(s.e)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||c,e.insertIndex)}))},e}()},28405:function(e,t,n){"use strict";n.d(t,"l",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"o",(function(){return h})),n.d(t,"m",(function(){return b})),n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return y})),n.d(t,"n",(function(){return T})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return I}));var r=n(28062),o=n(28406),a=n(28091),i=n(28370),c=n(28271),s=n(28280);function d(e,t){return!(!e||!t)&&(e.UserId===t.UserId&&e.Provider===t.Provider)}function u(e){return e?Object(o.e)(e)?e.Name:e.DisplayName:""}function l(e){if(!e)return"";if(!Object(o.e)(e))return Object(a.k)().assertConditionTag(!s.z()||"android"===Object(i.a)(),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(a.k)().assertConditionTag("win32"===Object(i.a)(),"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new c.a("UserPrincipalName and EmailAddresses, both not available",r.d.reserveTag(589103706),-2130957499)}function f(e){if(!e)return"";if(Object(o.d)(e)){var t=e.Email||e.UserId;return Object(a.k)().assertConditionTag(!!t,"Email and UserId are both not available on IUser object",529024399),t}return l(e)}function m(e){return e.UserId?e.UserId:p(e)}function p(e){return void 0!==e.DisplayName?e.DisplayName:(Object(a.k)().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function g(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function v(e){return 0===Object.keys(e).length&&Object(a.k)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function h(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function b(e,t){t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]}))}function C(e,t){return t.forEach((function(t){e[f(t)]={assignee:t}})),e}function y(e,t){Object.keys(t).forEach((function(n){e[n]={assignee:t[n].mentionee}}))}function T(e,t){var n=f(t);e[n]?delete e[n]:e[n]={assignee:t}}function O(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}function I(e){return e.some((function(e){return e.IsCurrentUser}))}},28406:function(e,t,n){"use strict";var r=n(28407);n.d(t,"c",(function(){return r.a}));var o=n(28408);n.d(t,"b",(function(){return o.a}));var a=n(28410);n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b}));var i=n(28412);n.d(t,"a",(function(){return i.a}))},28407:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={}))},28408:function(e,t,n){"use strict";var r=n(28409);n.d(t,"a",(function(){return r.a}))},28409:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"}(r||(r={}))},28410:function(e,t,n){"use strict";var r=n(28411);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}))},28411:function(e,t,n){"use strict";function r(e){return!!e&&void 0!==e.Id&&void 0!==e.Name&&void 0!==e.UserPrincipalName&&void 0!==e.EmailAddresses&&void 0!==e.SuggestionType&&void 0!==e.SuggestionSubtype&&void 0!==e.HostAppSuggestion&&void 0!==e.Source&&void 0!==e.SuggestionOrigin}function o(e){return!!e&&void 0!==e.UserId&&void 0!==e.Provider}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},28412:function(e,t,n){"use strict";var r=n(28413);n.d(t,"a",(function(){return r.a}));n(28414),n(28415),n(28416),n(28417)},28413:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(r||(r={}))},28414:function(e,t,n){},28415:function(e,t,n){},28416:function(e,t,n){},28417:function(e,t,n){},28418:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12708),o=n(28062),a=n(28271),i=n(28272),c=n(28280),s=n(22371),d=n(28419),u=function(){function e(e,t,n,r,o){var a=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===a.sessionConfiguration.draftId&&(e.anchorHintText&&(a._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(a._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){e===s.e.CommentContextChanged&&Object(d.b)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return a.updateDraft(e)})):e===s.e.UpdateDraftThread&&Object(d.d)(t)&&a.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(r.__assign)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new a.a(i.h,o.d.reserveTag(589103689),-2130957526);if(!this._active)throw new a.a(i.b,o.d.reserveTag(589103690),-2130957525);var t=c.c()||c.b(),n=t&&this.sessionConfiguration.sessionType===s.i;if(void 0===e&&!n||n&&void 0!==e)throw new a.a(i.c,o.d.reserveTag(589103691),-2130957507);return t?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}()},28419:function(e,t,n){"use strict";n(28420),n(28421),n(28422),n(28423),n(28424),n(28425),n(28426),n(28427),n(28428),n(28429);var r=n(28430);n.d(t,"b",(function(){return r.b})),n.d(t,"d",(function(){return r.n}));n(28431);var o=n(28432);n.d(t,"a",(function(){return o.b}));n(28433),n(28434),n(28435),n(28436);var a=n(28437);n.d(t,"c",(function(){return a.a}));n(28438),n(28439),n(28440),n(28447),n(28448)},28420:function(e,t,n){},28421:function(e,t,n){},28422:function(e,t,n){},28423:function(e,t,n){},28424:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return r}));var r,o=n(22372);function a(e){return e===o.a.CheckEnabled}function i(e){return e===o.a.CheckToggled}function c(e){return e===o.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},28425:function(e,t,n){},28426:function(e,t,n){},28427:function(e,t,n){"use strict"},28428:function(e,t,n){},28429:function(e,t,n){},28430:function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function o(e){return void 0!==e.comments||void 0!==e.threads}function a(e){return void 0!==e.threads&&void 0===e.comments}var i;function c(e){return void 0!==e.comments||void 0!==e.commentIds}function s(e){return void 0!==e.commentIds}function d(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function f(e){return void 0!==e.contextDetails}function m(e){return void 0!==e.modelCapabilityFlags}function p(e){return void 0!==e.errorType}function g(e){return void 0!==e.draftId}function v(e){return void 0!==e.draftId}function h(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,"b",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"o",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"n",(function(){return v})),n.d(t,"m",(function(){return h})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(i||(i={}))},28431:function(e,t,n){},28432:function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function o(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},28433:function(e,t,n){},28434:function(e,t,n){},28435:function(e,t,n){},28436:function(e,t,n){},28437:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(22378);function o(e){return e.sessionType===r.a}function a(e){return e.sessionType===r.d&&void 0!==e.threadId}function i(e){return e.sessionType===r.b&&void 0!==e.commentId}},28438:function(e,t,n){},28439:function(e,t,n){},28440:function(e,t,n){"use strict";n(28441),n(28442),n(28443),n(28444),n(28445),n(28446)},28441:function(e,t,n){},28442:function(e,t,n){},28443:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},28444:function(e,t,n){},28445:function(e,t,n){},28446:function(e,t,n){},28447:function(e,t,n){},28448:function(e,t,n){},28449:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28091),o=n(28450),a=function(){function e(){}return e.prototype.getTheme=function(){return Object(r.k)().assertConditionTag(!1,"Should not be called",592986821),o.a},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}()},28450:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28276),o={themeId:1,palette:{ButtonBorder:r.a.GRAY_B,CardAccent:r.a.GRAY_B,CardBackground:r.a.WHITE,CardHoveredBackground:r.a.GRAY_20,CardDraftBoxBackgroundHovered:r.a.WHITE,CardDraftBoxBorderHovered:r.a.GRAY_160,CardDraftBoxBorder:r.a.GRAY_110,CardDraftBoxBackground_HalfPane:r.a.WHITE,CardDraftBoxBackground:r.a.GRAY_A,CardExpandButtonBorder:r.a.GRAY_B,CardHeroBarBackground_HalfPane:r.a.GRAY_A,CardHeroBarBackground:r.a.WHITE,CardReplyBackground_HalfPane:r.a.GRAY_A,CardReplyBackground:r.a.GRAY_A,CardReplyTopBorder:r.a.GRAY_B,CardSelectionColor:r.a.COMMENTS_PURPLE,CardShadowColor:r.a.BLACK,CardBorder:r.a.GRAY_B,CardBorderEmphasis:r.a.COMMENTS_PURPLE,CommandBarBorder:r.a.GRAY_B,CommandBarTopBorder:r.a.GRAY_B,IconButtonDisabledTint:r.a.GRAY_C,IconButtonFocusedTint:r.a.GRAY_I,NavigationBarBackground:r.a.WHITE,NavigationBarBorder:r.a.GRAY_B,PaneBackground_HalfPane:r.a.WHITE,PaneBackground:r.a.GRAY_A,UnreadDotColor:r.a.DOT_BLUE,UnreadDotBorderColor:r.a.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:r.a.GRAY_150,CardPlaceholderColor:r.a.GRAY_130,ResolvedCardBackground:r.a.GRAY_20}}},28451:function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var r,o=n(12708),a=n(28062),i=n(28630),c=n(28091),s=n(28170),d=n(28340),u=n(28452),l=n(28298),f=n(28479),m=n(28271),p=n(28280),g=n(28480),v=n(28556),h=n(28557),b=n(28559),C=n(28560),y=n(28597),T=n(28598),O=n(28589),I=n(28603),S=n(28558),j=n(28607),_=n(28582),k=n(28608),E=n(28591),D=n(28609),A=n(28309),P=n(28610),x=n(28370),w=n(28596),R=n(28611),F=n(28613),N=n(28614),M=n(28618),L=n(28619),B=n(28620),V=n(28621),U=n(28622),H=n(28616),q=n(28612),G=n(28626),z=n(28627),W=function(){function e(e,t){var n=this;this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=Object(N.b)(N.a,[q.a.FocusComponent]),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(e){var t=e?Object(M.d)(e):"";!n.pendingOnComponentFocusedRequest||""!==t&&t===Object(M.d)(n.pendingOnComponentFocusedRequest.targetedComponent)||(f.a&&Object(a.i)("Pending component focused request cleared."),clearTimeout(n.pendingOnComponentFocusedRequest.token),n.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=function(e){n.clearPendingOnComponentFocusedRequest(e)},this.commandExecuteCallback=function(e,t){e&&Object(F.b)(e)&&(t===D.a.ShouldRetry?n.focusToRetry={command:e,timestamp:Date.now()}:t===D.a.Handled&&(n.focusToRetry=void 0))},this.commentContentsKeyDown=Object(U.b)((function(){return n.commentStore}),this.isRTL,(function(e){var t=I.h(n.commentStore.getState());if(p.X()){var r=Object(C.I)(t);if(r&&e.isFocusOnOrWithin({componentType:H.a.CardEditor,id:r,renderContextType:t.drafts[t.cardIdToDraftIdMap[r]].renderContextType}))return!1;var o=Object(C.J)(t);if(o&&e.isFocusOnOrWithin({componentType:H.a.PostEditor,id:o,renderContextType:t.drafts[t.postIdToDraftIdMap[o]].renderContextType}))return!1}else if(Object(T.c)(t))return!1;return!e.isFocusOn({componentType:H.a.GhostCard})}),{ArrowDown:{handler:function(e,t,r){var o=n.onDownKey(e,t,r?r():void 0);return o&&(o.stopPropagation=!0,o.preventDefault=!0),o},phase:u.a.Bubbling},ArrowUp:{handler:function(e,t,r){var o=n.onUpKey(e,t,r?r():void 0);return o&&(o.stopPropagation=!0,o.preventDefault=!0),o},phase:u.a.Bubbling},ArrowRight:{handler:function(e,t){if(t.componentTreeId.renderContextType!==A.a.HalfPane){var r=n.onRightKey(e,t);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:u.a.Bubbling},ArrowLeft:{handler:function(e,t){if(t.componentTreeId.renderContextType!==A.a.HalfPane){var r=n.onLeftKey(e,t.componentTreeId.renderContextType);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:u.a.Bubbling},Home:{handler:function(e,t){if(t.componentTreeId.renderContextType===A.a.FullPane){var r=n.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,v.a.SharedComments,t.componentTreeId.renderContextType,!1);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:u.a.Capturing},End:{handler:function(e,t){if(t.componentTreeId.renderContextType===A.a.FullPane){var r=n.selectionCommandFactory.selectLastThreadInCurrentContext(e,!0,v.a.SharedComments,t.componentTreeId.renderContextType,!1);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:u.a.Capturing},F12:{handler:function(e,t){var r=e.altKey?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:u.a.None},Escape:{handler:function(e,t){var r="win32"===Object(x.a)()?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:u.a.None}},this.commandExecutor),this.focusCommentCardCommand=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r=I.h(n.commentStore.getState()),o=Object(C.K)(r),a=void 0;return(a=n.checkForRetryOfEditorFocus(e,r))||!p.X()&&(null==o?void 0:o.threadId)===t&&(a=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,r))?a:Object(F.a)(void 0,{componentType:Object(M.c)(t,r),id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:e.componentTreeId.renderContextType===A.a.DiscreteIntegrated})}),this.commandExecutor),this.focusCommentPostCommand=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r=I.h(n.commentStore.getState());if(!p.X()&&r.postIdToDraftIdMap[t]){var o=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,r);if(o)return o}return Object(F.a)(void 0,{componentType:H.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})}),this.commandExecutor),this.focusCommentPaneCommand=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e){if(Object(w.b)(e.componentTreeId.renderContextType)){var t=I.h(n.commentStore.getState()),r=I.t(n.commentStore.getState()),o=void 0;if(o=n.checkForRetryOfEditorFocus(e,t))return o;if(!e.isFocusWithinPane()||e.isFocusOn({componentType:H.a.PaneRoot})){if(!p.X()&&(o=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t)))return o;if(o=n.checkForCommentSelectionFocus(e.componentTreeId.renderContextType,r,t))return o;if(!p.E()&&!e.getComponent(H.a.ClosePaneButton)){var a=I.k(n.commentStore.getState());return a.length>0?n.focusCommentCardCommand.processCommand(e,Object(_.f)(a)?a[0]:a[0].commentId):void Object(c.k)().assertConditionTag("win32"===Object(x.a)(),"Shouldn't be reached on current config",575239243)}return Object(B.a)(e,n.commentStore)}}else Object(c.k)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242)}),this.commandExecutor),this.commentCardMounted=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r,o=I.h(n.commentStore.getState()),a={componentType:Object(M.c)(t.id,o),id:t.id,renderContextType:e.componentTreeId.renderContextType};if(r=n.handleFocusRetry(e,a,o,1))return r;if(t.selected&&!e.isFocusWithin(a)){var i=Object(w.b)(e.componentTreeId.renderContextType);if((!i||e.isFocusWithinPane())&&(i||e.isFocusWithinAny(H.a.Card)||e.isFocusWithinAny(H.a.DraftCard)))return n.focusCommentCardCommand.processCommand(e,t.id)}}),this.commandExecutor),this.commentCardEditorMounted=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:H.a.CardEditor,id:t,renderContextType:e.componentTreeId.renderContextType},I.h(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPostMounted=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:H.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},I.h(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPostEditorMounted=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:H.a.PostEditor,id:t,renderContextType:e.componentTreeId.renderContextType},I.h(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPanePropsUpdated=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,r){var o=void 0;if(o=n.checkForRetryCommandOnPropsUpdated(e,r.draftState,!1))return o;var a=t.draftState,i=r.draftState,c=t.selectedComment,s=r.selectedComment;return(o=n.checkForDiscard(e,a,i,c,s))||(o=n.checkForHalfPaneFullTransition(e,t,r))?o:e.isFocusWithinPane()?(o=n.checkForLowFidelityWarning(e,c,s))||(o=n.checkForSelectionChange(e,i,c,s))||(o=n.checkForCardPendingChange(e,t.cardViewStates,r.cardViewStates,i))||(o=n.checkForReplyFinished(e,s,t.draftState,r.draftState,s&&r.cardViewStates[s.selectedCardId]))?o:n.checkForLowFidelityWarning(e,c,s):void 0}),this.commandExecutor),this.discreteCommentCardRootRefMounted=function(e){Object(V.a)(e)},this.discreteCommentCardPropsUpdated=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,r){var o=void 0;return(o=n.checkForRetryCommandOnDiscreteCardPropsUpdated(e,r))||(o=n.checkForDiscard(e,t.draftState,r.draftState,t.selectedState,r.selectedState))?o:e.isFocusWithinAny(H.a.Card)||e.isFocusWithinAny(H.a.DraftCard)?n.shouldFocusFromCardPendingStateChange(t.cardState,r.cardState)?Object(F.a)(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(M.b)(r.isDraftThread),id:r.threadId}):(o=n.checkForLowFidelityWarning(e,t.selectedState,r.selectedState))||(o=n.checkForSelectionChange(e,r.draftState,t.selectedState,r.selectedState))||(o=n.checkForReplyFinished(e,r.selectedState,t.draftState,r.draftState,r.cardState))?o:n.checkForLowFidelityWarning(e,t.selectedState,r.selectedState):void 0}),this.commandExecutor),this.paneContainerKeyDown=Object(U.b)((function(){return n.commentStore}),this.isRTL,(function(e){return!!Object(w.b)(e.componentTreeId.renderContextType)||(Object(c.k)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)}),{Escape:{handler:function(e,t){return Object(R.a)(e,g.requestClosePane({renderContextType:t.componentTreeId.renderContextType,trackback:a.d.reserveTag(575239245),telemetryVisitor:n.telemetryVisitor}))},phase:u.a.Capturing},Tab:{handler:function(e,t){return n.paneContainerTabHandling(e,t)},phase:u.a.None}},this.commandExecutor),this.commentEditorKeyDown=Object(U.b)((function(){return n.commentStore}),this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var r=e.altKey?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:u.a.None}},this.commandExecutor),this.onUserAction=Object(U.a)((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r;switch(t.userAction){case G.a.RequestNewCommentFromHost:if(!Object(w.b)(e.componentTreeId.renderContextType))return;return Object(B.a)(e,n.commentStore);case G.a.CancelReplyDraft:return Object(F.a)(void 0,{componentType:H.a.Card,id:t.cardId,renderContextType:e.componentTreeId.renderContextType});case G.a.DeleteThread:case G.a.CancelNewThreadDraft:if(!Object(w.b)(e.componentTreeId.renderContextType))return;if(e.componentTreeId.renderContextType===A.a.HalfPane&&t.userAction===G.a.CancelNewThreadDraft)return;return null!==(r=Object(B.a)(e,n.commentStore,{priority:3,phase:0}))&&void 0!==r?r:n.selectionCommandFactory.focusAndSelectSiblingThread(e.componentTreeId.renderContextType,t.threadIndex);case G.a.ResolveThread:if("android"!==Object(x.a)())return;return Object(F.a)(void 0,{componentType:H.a.ReopenThreadButton,id:t.cardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:3}});default:Object(a.m)(t)}}),this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(e,t){this.clearPendingOnComponentFocusedRequest();var n=setTimeout(t,500);this.pendingOnComponentFocusedRequest={callback:t,token:n,targetedComponent:e},f.a&&Object(a.i)("Pending component focused request added for ".concat(Object(M.d)(e),"."))},e.prototype.initialize=function(e,t,n){if(this._commentStore)throw new m.a("FocusManager already initialized",a.d.reserveTag(575239239),-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=n?n:new z.a(e,this.telemetryVisitor,t)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new m.a("FocusManager not initialized",a.d.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(e,t,n,r){var o;if(o=this.checkForRetryOfEditorFocus(e,n))return o;if(this.focusToRetry&&t){var a=this.focusToRetry.command.component,i=Date.now()-this.focusToRetry.timestamp;if(i>15e3)return Object(c.k)().assertConditionTag(!1,"Took too long to mount component type ".concat(a.componentType," for focus retry: ").concat(i," ms"),575239241),void(this.focusToRetry=void 0);if(this.shouldRetryFocusForPhase(this.focusToRetry,r)&&Object(H.b)(a,t)){var s=this.focusToRetry.command;return this.focusToRetry=void 0,s}}},e.prototype.shouldArrowNavigatePosts=function(e,t,n){return Object(P.a)(e.selectedCardId,t,n.componentTreeId.renderContextType)!==k.a.Collapsed&&(e.selectedCardId!==Object(C.G)(I.h(this.commentStore.getState()))&&n.isFocusWithinAny(H.a.Post))},e.prototype.onDownKey=function(e,t,n){var r=p.r()&&!j.a(this.commentStore.getState()),o=I.t(this.commentStore.getState()),a=I.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===A.a.DiscreteIsolated)return;var i={direction:d.d.Next,source:v.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,d.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==A.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,v.a.SharedComments,t.componentTreeId.renderContextType,r);Object(c.k)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)},e.prototype.onUpKey=function(e,t,n){var r=p.r()&&!j.a(this.commentStore.getState()),o=I.t(this.commentStore.getState()),a=I.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===A.a.DiscreteIsolated)return;var i={direction:d.d.Previous,source:v.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,d.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==A.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,v.a.SharedComments,t.componentTreeId.renderContextType,r);Object(c.k)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)},e.prototype.onRightKey=function(e,t){var n=I.t(this.commentStore.getState());if(!p.X()||!n||n.selectedCardId!==Object(C.G)(I.h(this.commentStore.getState()))){var r=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t.componentTreeId.renderContextType);return r||(n&&Object(O.j)(n.selectionDetails)&&t.isFocusOn({componentType:H.a.Card,id:n.selectedCardId,renderContextType:t.componentTreeId.renderContextType})&&(r=this.focusCommentPostCommand.processCommand(t,n.selectionDetails.selectedPostId)),r||void 0)}},e.prototype.onLeftKey=function(e,t){return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,t)},e.prototype.onTabKeyInPane=function(e,t){var n=I.t(this.commentStore.getState());return void 0!==n&&Object(h.b)(this.commentStore.getState(),n.selectedCardId)||!I.m(this.commentStore.getState())?p.X()?void 0:this.checkForActiveEditorFocus(e,t,I.h(this.commentStore.getState())):this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,v.a.SharedComments,t,!1)},e.prototype.isDraftInOtherContext=function(){var e=I.v(this.commentStore.getState());return!!e&&!e.isInCurrentContext},e.prototype.logEditorRetryError=function(e,t,n,a){var s,d,u;null===(d=(s=Object(c.k)()).logDiagnosticTrace)||void 0===d||d.call(s,Object(i.a)(r||(r=Object(o.__makeTemplateObject)(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),a,c.h.Info,c.c.ProductServiceUsage,this.telemetryVisitor,Object(c.o)("RenderContextType",t.componentTreeId.renderContextType,c.d.SystemMetadata),Object(c.o)("IsDraftInCurrentContext",!!e&&e.isInCurrentContext,c.d.SystemMetadata),Object(c.o)("DraftRenderContextType",null!==(u=null==e?void 0:e.renderContextType)&&void 0!==u?u:A.a.None,c.d.SystemMetadata),Object(c.o)("ComponentType",null!=n?n:0,c.d.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(e,t){var n=this;if(void 0!==this.draftToFocus){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:q.a.PreserveFocus,priorityArgs:{priority:1}};var r=t.drafts[this.draftToFocus.draftId],i=Date.now()-this.draftToFocus.timestamp;if(i>15e3)return Object(c.k)().assertConditionTag(!1,"Took too long to focus draft editor: ".concat(i," ms, expected draft still exists: ").concat(!!r),575239251),this.draftToFocus=void 0,void this.logEditorRetryError(r,e,void 0,a.d.reserveTag(556607431));if(r&&r.renderContextType===e.componentTreeId.renderContextType){var s=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t,{priority:2,phase:0});if(s&&Object(L.a)(e,s.component))return this.draftToFocus=Object(o.__assign)(Object(o.__assign)({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout((function(){return n.draftToFocus=void 0})),this.clearPendingOnComponentFocusedRequest(),s;this.logEditorRetryError(r,e,null==s?void 0:s.component.componentType,a.d.reserveTag(556794947))}else this.logEditorRetryError(r,e,void 0,a.d.reserveTag(556794945))}},e.prototype.checkForActiveEditorFocus=function(e,t,n,r){if(void 0===r&&(r={priority:1}),!this.isDraftInOtherContext()){var o=Object(C.J)(n);if(o)return Object(F.a)(e,{componentType:H.a.PostEditor,id:o,renderContextType:t},{priorityArgs:r});var a=Object(C.I)(n);return a?Object(F.a)(e,{componentType:H.a.CardEditor,id:a,renderContextType:t},{priorityArgs:r}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){var n=I.t(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:s.b.CommentThread}:void 0;return Object(R.a)(e,g.moveFocusToCanvas({renderContextType:t.componentTreeId.renderContextType,trackback:a.d.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},r))},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(p.X()||!this.isDraftInOtherContext())return t&&t.selectedCardId?Object(F.a)(void 0,{componentType:Object(M.c)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{priorityArgs:{priority:2,phase:1}}):void 0},e.prototype.checkForDiscard=function(e,t,n,r,o){if("web"!==Object(x.a)()&&r&&o){var a=r.selectionDetails,i=o.selectionDetails;if(Object(T.j)(t)&&!Object(T.c)(n))return this.focusCommentCardCommand.processCommand(e,o.selectedCardId);if(Object(O.j)(a)===Object(O.j)(i)&&r.selectedCardId===o.selectedCardId&&Object(T.m)(t,n)){if(!Object(O.j)(a)||!Object(O.j)(i))return Object(F.a)(void 0,{componentType:H.a.CardEditor,id:o.selectedCardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(a.selectedPostId===i.selectedPostId)return Object(F.a)(void 0,{componentType:H.a.PostEditor,id:i.selectedPostId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(e,t){if("win32"!==Object(x.a)()){var n=this.commentStore.getState(),r=I.p(n).virtualized;if(!Object(b.a)(I.q(n),r,!!S.g(n)))return(d=Object(F.a)(e,{componentType:H.a.ClosePaneButton})).stopPropagation=!0,d.preventDefault=!0,d;var o=t.getComponent(H.a.ClosePaneButton),a=t.getComponent(H.a.NewCommentButton),i=!I.p(n).newThread||!a?o:a;if(p.n()){var c=I.t(n),s=I.h(n),d=void 0;return c&&Object(h.b)(n,c.selectedCardId)?p.X()||t.isFocusWithin({componentType:Object(M.c)(c.selectedCardId,s),id:c.selectedCardId,renderContextType:t.componentTreeId.renderContextType})||(d=this.checkForActiveEditorFocus(e,t.componentTreeId.renderContextType,s)):i&&e.isEventTarget(i)&&!e.shiftKey&&(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType)),d&&(d.stopPropagation=!0,d.preventDefault=!0),d}if(o&&e.isEventTarget(o)&&e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d;if(i&&e.isEventTarget(i)&&!e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d}},e.prototype.checkForSelectionChange=function(e,t,n,r){if(r&&((!n||Object(O.b)(n)!==Object(O.b)(r)||Object(O.j)(n.selectionDetails)!==Object(O.j)(r.selectionDetails))&&(this.clearPendingOnComponentFocusedRequest(),(p.X()||!Object(T.d)(t))&&!e.isFocusOn({componentType:H.a.NextCommentButton})&&!e.isFocusOn({componentType:H.a.PreviousCommentButton})))){if(!Object(O.j)(r.selectionDetails)){if(e.isFocusOnOrWithin({componentType:r.selectedCardId!==(null==n?void 0:n.selectedCardId)?Object(M.c)(r.selectedCardId,t):H.a.CardEditor,id:r.selectedCardId,renderContextType:e.componentTreeId.renderContextType},!0))return;return this.focusCommentCardCommand.processCommand(e,r.selectedCardId)}if(!e.isFocusOnOrWithin({componentType:H.a.Post,id:r.selectionDetails.selectedPostId,renderContextType:e.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)}},e.prototype.checkForReplyFinished=function(e,t,n,r,o){var a=Object(C.I)(n),i=Object(C.I)(r);if(o&&o.pending!==y.a.Editor)return a&&!i&&(null==t?void 0:t.selectedCardId)===a&&e.isFocusWithin({componentType:H.a.Card,id:a,renderContextType:e.componentTreeId.renderContextType})?this.focusCommentCardCommand.processCommand(e,a):void 0},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(e.componentTreeId.renderContextType===A.a.HalfPane&&Object(l.b)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===l.a.Normal&&(!Object(l.b)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===l.a.Variable))return Object(F.a)(void 0,{componentType:H.a.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==y.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,r){var o=this,a=Object.entries(n).find((function(e){var n=t[e[0]];return o.shouldFocusFromCardPendingStateChange(n,e[1])}));if(a)return Object(F.a)(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(M.c)(a[0],r),id:a[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(e,t,n){var r=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&Object(L.a)(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,r,t,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Object(H.c)(this.focusToRetry.command.component)||!Object(H.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),r=this.draftToFocus&&(t.cardRelativeDraftingState===E.a.InCard||t.cardRelativeDraftingState===E.a.InChildPost);if(n||r)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&(p.n()?Object(O.h)(n):Object(O.g)(n))){var r=t?Object(O.b)(t):void 0,o=Object(O.b)(n);if(o!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return Object(F.a)(void 0,{componentType:H.a.Post,renderContextType:e.componentTreeId.renderContextType,id:o})}},e.prototype.shouldRetryFocusForPhase=function(e,t){return 1!==e.command.priorityArgs.priority&&0!=(e.command.priorityArgs.phase&t)},e}()},28452:function(e,t,n){"use strict";var r=n(28453);n.d(t,"e",(function(){return r.a}));var o=n(28459);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.c})),n.d(t,"c",(function(){return o.d}));var a=n(28464);n.d(t,"d",(function(){return a.a})),n.d(t,"f",(function(){return a.b}));n(28472),n(28474),n(28475),n(28476),n(28477),n(28478),n(28473)},28453:function(e,t,n){"use strict";n(28454),n(28455),n(28456);var r=n(28457);n.d(t,"a",(function(){return r.c}));n(28458)},28454:function(e,t,n){"use strict";function r(e){return!!e&&void 0!==e.focus&&void 0!==e.blur}n.d(t,"a",(function(){return r}))},28455:function(e,t,n){"use strict"},28456:function(e,t,n){},28457:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c}));var r,o=n(11766),a=n(28454),i=o.createContext(void 0);function c(e){return!!e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&Object(a.a)(e)}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(r||(r={}))},28458:function(e,t,n){},28459:function(e,t,n){"use strict";var r=n(28460);n.d(t,"a",(function(){return r.a}));var o=n(28461);n.d(t,"b",(function(){return o.a}));var a=n(28462);n.d(t,"c",(function(){return a.a}));var i=n(28463);n.d(t,"d",(function(){return i.a}))},28460:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(r||(r={}))},28461:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},28462:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12",e.Space=" "}(r||(r={}))},28463:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(r||(r={}))},28464:function(e,t,n){"use strict";var r=n(28465);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));n(28466),n(28467),n(28468)},28465:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(28459);function o(e,t){if(!t)return e;switch(e){case r.c.ArrowLeft:return r.c.ArrowRight;case r.c.ArrowRight:return r.c.ArrowLeft;default:return e}}function a(e){switch(e){case"Down":return r.c.ArrowDown;case"Up":return r.c.ArrowUp;case"Left":return r.c.ArrowLeft;case"Right":return r.c.ArrowRight;case"OS":return r.c.Meta;case"Del":return r.c.Delete;case"Spacebar":return" ";case"Esc":return r.c.Escape;case"Ctrl":case"Ctl":return r.c.Control;case"F6":return r.c.F6;case"F12":return r.c.F12;default:return e}}},28466:function(e,t,n){"use strict";n(12708);var r=n(28459);r.c.Tab,r.a.AtTarget,r.c.Tab,r.a.AtTarget},28467:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28461);function o(e){return e.isFocusOn?r.a.FocusOn:e.isFocusWithin?r.a.FocusWithin:r.a.Unfocused}},28468:function(e,t,n){"use strict";var r=n(12708),o=(n(28469),n(11766)),a=n(28461),i=n(28467);!function(){function e(e,t,n,r,a){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=a,this.registrationRef=o.createRef(),this.innerComponentRef=o.createRef()}e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var o=this.focusState;this.focusState=r,Object(i.a)(o)!==Object(i.a)(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return Object(i.a)(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===a.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}()},28469:function(e,t,n){"use strict";var r=n(28470);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}))},28470:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(11766),o=n(28471),a=(Object(o.b)(r.useMemo),Object(o.b)(r.useEffect)),i=(Object(o.b)(r.useLayoutEffect),Object(o.a)(r.useCallback),function(e,t,n){return e()&&n?n(t):null})},28471:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r,o=n(12708);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(void 0,Object(o.__spreadArray)(Object(o.__spreadArray)([],n,!1),t,!1))}),t)}function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var o=a.apply(void 0,t);return r=void 0,o}}function s(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var o=i.apply(void 0,t);return r=void 0,o}}},28472:function(e,t,n){"use strict";n(28459),n(28457),n(28473)},28473:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r={logFocusDebugInfo:function(){}};function o(){return r}},28474:function(e,t,n){"use strict";var r=n(12708),o=n(28475);!function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.updateIdForViewTree=function(e,t){var n=this.viewTreeMap.get(e);return!!n&&(this.viewTreeMap.set(t,n),this.viewTreeMap.delete(e),!0)},e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new o.a,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,o;try{for(var a=Object(r.__values)(this.viewTreeMap.values()),i=a.next();!i.done;i=a.next()){var c=null===(o=i.value.getRoot())||void 0===o?void 0:o.getDescendantById(e);if(c)return c}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}}()},28475:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}}},28476:function(e,t,n){"use strict";n(12708)},28477:function(e,t,n){"use strict";var r=n(11766),o=n(28459);!function(){function e(){var e=this;this.ref=r.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():o.b.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0})}()},28478:function(e,t,n){"use strict";var r=n(12708),o=n(11766),a=n(28457),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return o.Children.only(this.props.children)},t}(o.PureComponent);!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=o.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}Object(r.__extends)(t,e),t.prototype.render=function(){var e=this;return o.createElement(a.b.Consumer,null,(function(t){return o.createElement(i,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(o.PureComponent)},28479:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));n(28370);var r="sharedcommentsdemo"===Object({NODE_ENV:"production",PUBLIC_URL:"",CI:!0,APP:"powerautomate-microsoft-com",PREBUILT_ID:"25",LOCALES_HASH:"3k53VrU1-R25",AAD_INSTANCE:{high:"https://login.microsoftonline.us/",dod:"https://login.microsoftonline.us/",mooncake:"https://login.chinacloudapi.cn/",ex:"https://login.microsoftonline.eaglex.ic.gov/",rx:"https://login.microsoftonline.microsoft.scloud/"},SETTINGS_FALLBACK_REGION:{},BUILD_COMMIT_ID:"beafaf28f48e4b83781c35937489c9fc4a8d4d2e",BUILD_NAME:"0.0.20250723.2-2507.3-prod",BUILD_BRANCH:"2507.3",BUILD_DATE_TIME:"Wed, 23 Jul 2025 22:20:14 GMT",BUILD_SHELL_VERSION:"1.0.0",_UNSAFE_DONT_USE_BUILD_MODULE_TYPE:"module"}).TEST_PAGE,o=!1},28480:function(e,t,n){"use strict";n.r(t);var r=n(28481);n.d(t,"chainActionDetails",(function(){return r.a})),n.d(t,"createAction",(function(){return r.b}));n(28482);var o=n(28483);n.d(t,"addContentExtension",(function(){return o.a}));var a=n(28484);n.d(t,"addToCurrentMentionees",(function(){return a.a}));var i=n(28485);n.d(t,"applyCommentChanges",(function(){return i.a}));var c=n(28486);n.d(t,"beginDraftingFailure",(function(){return c.a}));var s=n(28487);n.d(t,"beginDraftingSuccess",(function(){return s.a}));var d=n(28488);n.d(t,"beginProcessingCommit",(function(){return d.a}));var u=n(28489);n.d(t,"beginProcessingDiscard",(function(){return u.a}));var l=n(28490);n.d(t,"beginViewInitialization",(function(){return l.a}));var f=n(28491);n.d(t,"cancelCommentCreateThread",(function(){return f.a}));var m=n(28492);n.d(t,"cancelCommentPostEdit",(function(){return m.a}));var p=n(28493);n.d(t,"cancelCommentReply",(function(){return p.a}));var g=n(28494);n.d(t,"cancelDiscard",(function(){return g.a}));var v=n(28495);n.d(t,"clearCommentHighlight",(function(){return v.a}));var h=n(28496);n.d(t,"clearCommentSelection",(function(){return h.a}));var b=n(28497);n.d(t,"clearLowFidelityWarning",(function(){return b.a}));var C=n(28498);n.d(t,"clearPostErrorUI",(function(){return C.a}));var y=n(28499);n.d(t,"collapseCard",(function(){return y.a}));var T=n(28500);n.d(t,"commentContextChanged",(function(){return T.a}));var O=n(28501);n.d(t,"commitDraft",(function(){return O.a})),n.d(t,"getCommitDraftSessionType",(function(){return O.b}));var I=n(28502);n.d(t,"commitFailure",(function(){return I.a}));var S=n(28503);n.d(t,"dispatchLoadThreads",(function(){return S.a}));var j=n(28504);n.d(t,"displayDraftWarning",(function(){return j.a}));var _=n(28505);n.d(t,"draftEmptinessChanged",(function(){return _.a}));var k=n(28506);n.d(t,"emptyAction",(function(){return k.b})),n.d(t,"EMPTY_ACTION",(function(){return k.a}));var E=n(28507);n.d(t,"endViewInitialization",(function(){return E.a}));var D=n(28508);n.d(t,"highlightComment",(function(){return D.a}));var A=n(28509);n.d(t,"loadComment",(function(){return A.a}));var P=n(28510);n.d(t,"loadDefaultFilter",(function(){return P.a}));var x=n(28511);n.d(t,"loadFilter",(function(){return x.a}));var w=n(28512);n.d(t,"loadPersonaIconProperties",(function(){return w.a}));var R=n(28513);n.d(t,"loadVirtualizedComments",(function(){return R.a}));var F=n(28514);n.d(t,"moveFocusToCanvas",(function(){return F.a}));var N=n(28515);n.d(t,"nextPopulatedContextDetailsUpdated",(function(){return N.a}));var M=n(28516);n.d(t,"onInitialRender",(function(){return M.a}));var L=n(28517);n.d(t,"populateSmartReply",(function(){return L.a}));var B=n(28518);n.d(t,"requestPresentLinkToComment",(function(){return B.a}));var V=n(28519);n.d(t,"queueLoadThreads",(function(){return V.a}));var U=n(28520);n.d(t,"readyToRender",(function(){return U.a}));var H=n(28521);n.d(t,"reloadComments",(function(){return H.a}));var q=n(28522);n.d(t,"removeContentExtensions",(function(){return q.a}));var G=n(28523);n.d(t,"requestClosePane",(function(){return G.a}));var z=n(28524);n.d(t,"requestDeletePost",(function(){return z.a}));var W=n(28525);n.d(t,"requestDeleteThread",(function(){return W.a}));var Y=n(28526);n.d(t,"requestModalConfirmation",(function(){return Y.a}));var K=n(28527);n.d(t,"requestReopenThread",(function(){return K.a}));var X=n(28528);n.d(t,"requestShowPane",(function(){return X.a}));var Q=n(28529);n.d(t,"requestThreadResolve",(function(){return Q.a}));var J=n(28530);n.d(t,"resolveAtMentionCapability",(function(){return J.a}));var $=n(28531);n.d(t,"saveDraft",(function(){return $.a}));var Z=n(28532);n.d(t,"SelectActionType",(function(){return Z.a})),n.d(t,"shouldSelectActionExpandCard",(function(){return Z.c})),n.d(t,"selectComment",(function(){return Z.b}));var ee=n(28533);n.d(t,"selectContent",(function(){return ee.a}));var te=n(28534);n.d(t,"selectFirstThreadInNextCommentContext",(function(){return te.a}));var ne=n(28535);n.d(t,"selectLastThreadInPreviousCommentContext",(function(){return ne.a}));var re=n(28536);n.d(t,"sessionRequestStartedAndLockSelection",(function(){return re.a}));var oe=n(28537);n.d(t,"setContentNavigationEnablement",(function(){return oe.a}));var ae=n(28538);n.d(t,"setFilteringCapabilities",(function(){return ae.a}));var ie=n(28539);n.d(t,"showLowFidelityWarning",(function(){return ie.a}));var ce=n(28540);n.d(t,"showPostErrorUI",(function(){return ce.a}));var se=n(28541);n.d(t,"toggleTaskAssigner",(function(){return se.a}));var de=n(28542);n.d(t,"topVisibleThreadChanged",(function(){return de.a}));var ue=n(28543);n.d(t,"updateContextState",(function(){return ue.a}));var le=n(28544);n.d(t,"updateDraftRenderContext",(function(){return le.a}));var fe=n(28545);n.d(t,"updateDraftThread",(function(){return fe.a}));var me=n(28546);n.d(t,"updateExtensionPriority",(function(){return me.a}));var pe=n(28547);n.d(t,"updateFilterRange",(function(){return pe.a}));var ge=n(28548);n.d(t,"updateMentioneesStillInDraft",(function(){return ge.a}));var ve=n(28549);n.d(t,"updateModelCapabilities",(function(){return ve.a}));var he=n(28550);n.d(t,"updateSelectedTaskAssignee",(function(){return he.a}));var be=n(28551);n.d(t,"updateSelectedTaskAssignees",(function(){return be.a}));var Ce=n(28552);n.d(t,"updateSuggestionsDetails",(function(){return Ce.a}));var ye=n(28553);n.d(t,"viewContainerChanged",(function(){return ye.a}));var Te=n(28554);n.d(t,"viewContainerFoldableLayoutStateChanged",(function(){return Te.a}));var Oe=n(28555);n.d(t,"viewContainerVisibilityChanged",(function(){return Oe.a}))},28481:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(12708);function o(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{trackback:t})}function a(e,t,n){return{type:e,payload:t,actionDetail:n}}},28482:function(e,t,n){},28483:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("ADD_CONTENT_EXTENSION",{extension:t},e)}},28484:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}},28485:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("APPLY_COMMENT_CHANGES",{changes:t},e)}},28486:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:n},e)}},28487:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n,o){return Object(r.b)("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:n,rehydratedDraftParams:o},e)}},28488:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("BEGIN_PROCESSING_COMMIT",{},e)}},28489:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("BEGIN_PROCESSING_DISCARD",{},e)}},28490:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("BEGIN_VIEW_INIT",{},e)}},28491:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}},28492:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:n},e)}},28493:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:n},e)}},28494:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("CANCEL_DISCARD",{},e)}},28495:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:n},e)}},28496:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("CLEAR_COMMENT_SELECTION",{},e)}},28497:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}},28498:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("CLEAR_POST_ERROR_STATE",{commentId:t},e)}},28499:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("COLLAPSE_CARD",{cardId:t},e)}},28500:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("COMMENT_CONTEXT_CHANGED",t,e)}},28501:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(28481);function o(e,t){return Object(r.b)("COMMIT_DRAFT",t,e)}function a(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},28502:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("COMMIT_FAILURE",{commitText:t},e)}},28503:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("DISPATCH_LOAD_THREADS",t,e)}},28504:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("DISPLAY_DRAFT_WARNING",e,t)}},28505:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:n},e)}},28506:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(28062),o=n(28091),a=n(28309),i=n(28481);function c(e){return Object(i.b)("",{},e)}var s=c({renderContextType:a.a.None,telemetryVisitor:Object(o.l)(o.g.ReviewedAsNotNecessary),trackback:r.d.reserveTag(595735680)})},28507:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("END_VIEW_INIT",{},e)}},28508:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("HIGHLIGHT_COMMENT",{commentId:t,actionSource:n},e)}},28509:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("LOAD_COMMENT",{commentData:t,tasks:n},e)}},28510:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("LOAD_DEFAULT_FILTER",t,e)}},28511:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("LOAD_FILTER",t,e)}},28512:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}},28513:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}},28514:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}},28515:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}},28516:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("ON_INITIAL_RENDER",t,e)}},28517:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("POPULATE_SMART_REPLY",t,e)}},28518:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}},28519:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("QUEUE_LOAD_THREADS",t,e)}},28520:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("READY_TO_RENDER",{},e)}},28521:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("RELOAD_COMMENTS",t,e)}},28522:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.b)("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}},28523:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("REQUEST_CLOSE_PANE",{},e)}},28524:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("REQUEST_DELETE_POST",{commentId:t},e)}},28525:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("REQUEST_DELETE_THREAD",{commentId:t,isTask:n},e)}},28526:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n,o){return Object(r.b)("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:n,displayStrings:o},e)}},28527:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("REQUEST_REOPEN_THREAD",{commentId:t,isTask:n},e)}},28528:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("REQUEST_SHOW_PANE",{},e)}},28529:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:n},e)}},28530:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}},28531:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("SAVE_DRAFT",t,e)}},28532:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r,o=n(28481);function a(e){switch(e){case r.SelectCard:case r.Polite:return!1;case r.ExpandCard:case r.SelectPost:return!0}}function i(e,t,n,r,a){return Object(o.b)("SELECT_COMMENT",{selectedCard:t,selectedPost:n,selectType:r,source:a},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"}(r||(r={}))},28533:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n,o,a,i,c){return Object(r.b)("SELECT_CONTENT",{selectDirection:t,from:i,reason:c,iterableContentTypes:n,restrictToCurrentContext:o,preventLooping:a},e)}},28534:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}},28535:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}},28536:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:n},e)}},28537:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("SET_CONTENT_NAVIGATION_ENABLEMENT",{isEnabled:t},e)}},28538:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("SET_FILTERING_CAPABILITIES",t,e)}},28539:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:n},e)}},28540:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("SHOW_POST_ERROR_STATE",{commentId:t},e)}},28541:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e){return Object(r.b)("TOGGLE_TASK_ASSIGNER_TYPE",{},e)}},28542:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}},28543:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}},28544:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:n},e)}},28545:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_DRAFT_THREAD",t,e)}},28546:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}},28547:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_FILTER_RANGE",t,e)}},28548:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}},28549:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t,n){return Object(r.b)("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}},28550:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}},28551:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEES",{selectedAssignee:t},e)}},28552:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}},28553:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}},28554:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}},28555:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}},28556:function(e,t,n){"use strict";var r;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={})),t.a=r},28557:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(28313),o=n(28091),a=n(28558);function i(e){if(function(e){var t=a.a(e);if(!t||t===a.e(e))return!1;var n=a.f(e,t);return!!n&&n.canUpdateFilter}(e))return a.a(e)}function c(e,t){return!a.g(e)||void 0!==a.d(e).find((function(e){return e.contentId===t}))}function s(e,t){t.addDataField("HasFiltereringCapabilities",!!e.filterState.filteringCapabilities,o.d.SystemMetadata),t.addDataField("IsFilterApplied",!!e.filterState.activeFilterId&&e.filterState.activeFilterId!==a.e(e),o.d.SystemMetadata)}var d=[r.a.ActiveOnly,r.a.ResolvedOnly]},28558:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l}));var r=function(e){return e.filterState.activeFilterId},o=function(e){return e.filterState.defaultFilterId},a=function(e){var t,n=e.filterState.activeFilterId;if(n)return null===(t=e.filterState.filteredRanges[n])||void 0===t?void 0:t.filter},i=function(e,t){return e.filterState.filteredRanges[t]},c=[],s=function(e){var t,n,r=e.filterState.activeFilterId;return r&&null!==(n=null===(t=e.filterState.filteredRanges[r])||void 0===t?void 0:t.order)&&void 0!==n?n:c},d=function(e){return s(e).length},u=function(e){return e.filterState.filteringCapabilities},l=function(e){return e.filterState.requestDefaultFilter}},28559:function(e,t,n){"use strict";function r(e,t,n){return!e||!!t&&(!n&&(0!==e.numberOfLoadedComments&&(void 0===e.selectedThreadIndex||e.selectedThreadIndex<e.numberOfLoadedThreads)))}n.d(t,"a",(function(){return r}))},28560:function(e,t,n){"use strict";n.d(t,"P",(function(){return R})),n.d(t,"Z",(function(){return F})),n.d(t,"Y",(function(){return N})),n.d(t,"O",(function(){return M})),n.d(t,"z",(function(){return L})),n.d(t,"e",(function(){return B})),n.d(t,"L",(function(){return V})),n.d(t,"y",(function(){return U})),n.d(t,"k",(function(){return H})),n.d(t,"t",(function(){return q})),n.d(t,"o",(function(){return G})),n.d(t,"g",(function(){return z})),n.d(t,"f",(function(){return W})),n.d(t,"j",(function(){return Y})),n.d(t,"i",(function(){return K})),n.d(t,"N",(function(){return X})),n.d(t,"v",(function(){return Q})),n.d(t,"x",(function(){return J})),n.d(t,"w",(function(){return $})),n.d(t,"a",(function(){return Z})),n.d(t,"U",(function(){return ee})),n.d(t,"R",(function(){return te})),n.d(t,"V",(function(){return ne})),n.d(t,"m",(function(){return re})),n.d(t,"l",(function(){return oe})),n.d(t,"A",(function(){return ae})),n.d(t,"C",(function(){return ce})),n.d(t,"E",(function(){return se})),n.d(t,"D",(function(){return de})),n.d(t,"gb",(function(){return ue})),n.d(t,"F",(function(){return fe})),n.d(t,"bb",(function(){return me})),n.d(t,"p",(function(){return pe})),n.d(t,"q",(function(){return ge})),n.d(t,"B",(function(){return ve})),n.d(t,"G",(function(){return he})),n.d(t,"fb",(function(){return be})),n.d(t,"b",(function(){return Ce})),n.d(t,"M",(function(){return Te})),n.d(t,"u",(function(){return Oe})),n.d(t,"n",(function(){return Ie})),n.d(t,"W",(function(){return je})),n.d(t,"db",(function(){return _e})),n.d(t,"eb",(function(){return ke})),n.d(t,"cb",(function(){return Ee})),n.d(t,"H",(function(){return De})),n.d(t,"I",(function(){return Pe})),n.d(t,"J",(function(){return xe})),n.d(t,"K",(function(){return we})),n.d(t,"X",(function(){return Re})),n.d(t,"T",(function(){return Fe})),n.d(t,"ab",(function(){return Ne})),n.d(t,"S",(function(){return Me})),n.d(t,"c",(function(){return Le})),n.d(t,"Q",(function(){return Be})),n.d(t,"h",(function(){return Ve})),n.d(t,"d",(function(){return Ue})),n.d(t,"s",(function(){return He})),n.d(t,"r",(function(){return qe}));var r=n(12708),o=n(28062),a=n(28602),i=n(28091),c=n(28561),s=n(22377),d=n(28563),u=n(28564),l=n(28583),f=n(28432),m=n(28585),p=n(28361),g=n(28586),v=n(28309),h=n(28587),b=n(28307),C=n(28594),y=n(28370),T=n(28596),O=n(28271),I=n(28272),S=n(28280),j=n(28532),_=n(28597),k=n(28598),E=n(28599),D=n(28600),A=n(28589),P=n(28582),x=n(28601),w=n(28559);function R(e){return""===e||null===e?void 0:e}function F(e,t){if(!e[t])return e;var n=Object(r.__assign)({},e);return delete n[t],n}function N(e,t,n){var o=void 0!==n&&e[n]===t?n:-1;if(o<0&&(o=e.findIndex((function(e){return e===t}))),o<0)return e;var a=Object(r.__spreadArray)([],Object(r.__read)(e),!1);return a.splice(o,1),a}function M(e){return e.state===E.a.Placeholder||e.state===E.a.Loading}function L(e,t,n){var r,o;return Object(P.c)(e)?null!==(o=null===(r=t[n])||void 0===r?void 0:r.map((function(t){return e[t]})))&&void 0!==o?o:[]:e.filter((function(e){return Object(f.b)(e)===n}))}function B(e){return{commentId:e,commentBody:C.a,author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function V(e,t,n,r){if(n<0)return-1;for(var o=0,a=-1,i=0;i<e.length;i++)if(e[i]!==r){if(o===n)return i;if(o>n)return a===i-1?i-2:i-1;o+=t[e[i]].length}else a=i;return o===n?e.length:-1}function U(e,t,n){for(var r={},o=0;o<e.length;++o)r[e[o].commentId]=H(!S.W()&&t.includes(Object(f.b)(e[o]))?G(e[o].date,e[o].displayDate,n.dataCulture):e[o].displayDate);return r}function H(e){return{displayDate:e,displayingErrorUI:!1,pending:D.a.None}}function q(e){return{displayDate:e}}function G(e,t,n){return t||(!e||isNaN(e.getDate())?"":h.a(e,n))}function z(e,t,n,o){for(var a,c=void 0,s=!1,d=0;d<n.length;d++)if(Object(f.b)(n[d])===e){s=!0,Object(i.k)().assertConditionTag(!!t[n[d].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);var u=null!==(a=t[n[d].commentId])&&void 0!==a?a:H(void 0);u.displayDate||(c||(c=Object(r.__assign)({},t)),c[n[d].commentId]=Object(r.__assign)(Object(r.__assign)({},u),{displayDate:G(n[d].date,n[d].displayDate,o.dataCulture)}))}else if(s)break;return c}function W(e,t,n,o){var a=void 0;return e.forEach((function(e){var c;if(n[e]){Object(i.k)().assertConditionTag(!!t[e],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",538035351);var s=null!==(c=t[e])&&void 0!==c?c:H(void 0);s.displayDate||(a||(a=Object(r.__assign)({},t)),a[e]=Object(r.__assign)(Object(r.__assign)({},s),{displayDate:G(n[e].date,n[e].displayDate,o.dataCulture)}))}})),a}function Y(e,t){for(var n={},r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=K(void 0,t));return n}function K(e,t){return Q(e,t===E.a.Loading||t===E.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:E.a.Loaded})}function X(e){var t,n,o={};try{for(var a=Object(r.__values)(e),i=a.next();!i.done;i=a.next()){var c=i.value;o[c.threadId]=Q(void 0,{state:E.a.Placeholder,initialItemCount:c.itemCount})}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}function Q(e,t){return{loadState:null!=t?t:{state:E.a.Loaded},pending:_.a.None,alternateId:e}}function J(e){var t={};return t[e]={pending:D.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function $(e){var t={};return t[e]={pending:_.a.Card,loadState:{state:E.a.Loaded},alternateId:e},t}function Z(e,t,n){var r=te(e,t,n),o=we(n);if(S.s()){var a=null==o?void 0:o.commentDraft.sessionConfiguration;"EDIT"===(null==a?void 0:a.sessionType)&&o&&!r.some((function(e){return e===o.threadId}))&&r.push(o.threadId)}return!t||r.includes(t.selectedCardId)?r:o&&o.threadId===t.selectedCardId?[o.threadId]:o&&r.includes(o.threadId)?[t.selectedCardId,o.threadId]:[t.selectedCardId]}function ee(e,t,n,r){if(!t.includes(e))return t;var o=we(n);return o&&o.threadId===e?t:r&&Object(A.j)(r.selectionDetails)?(Object(i.k)().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):o&&t.includes(o.threadId)?[o.threadId]:[]}function te(e,t,n){var r=we(n);return Object(a.a)(e,(function(e){return e===(null==t?void 0:t.selectedCardId)||e===(null==r?void 0:r.threadId)}))}function ne(e,t,n){var r=we(n);return Object(a.a)(e,(function(e){return t[e]||e===(null==r?void 0:r.threadId)}))}function re(e){return{selectedCardId:e,selectionDetails:oe()}}function oe(){return{lowFidelityWarningType:void 0}}function ae(e,t){var n,r=e.draftState.postIdToDraftIdMap[t];if(!r)return e.selectedComment;var a=e.draftState.drafts[r];if(!a.isInCurrentContext)return(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)===a.threadId?void 0:e.selectedComment;var i=Object(P.b)(Object(P.a)(e),t);if(!i)throw new O.a(I.i,o.d.reserveTag(589103587),-2130957563);return re(Object(f.b)(i))}function ie(e,t){return{selectedCardId:e,selectionDetails:{selectedPostId:t,lowFidelityWarningType:void 0}}}function ce(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return re(t.sessionConfiguration.draftId);case"EDIT":return function(e,t){var n=Object(P.b)(e,t);if(n)return ie(Object(f.b)(n),t);throw new O.a(I.d,o.d.reserveTag(589103616),-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=Object(P.b)(e,t);if(n&&""===n.parentId)return re(t);throw new O.a(I.d,o.d.reserveTag(589103617),-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new O.a(I.c,o.d.reserveTag(589103618),-2130957532)}}function se(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return re(e.threadId);case"EDIT":return ie(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new O.a(I.c,o.d.reserveTag(577610274),-2130957532)}}function de(e,t,n){return(null==t?void 0:t.selectedCardId)===e&&Object(A.j)(t.selectionDetails)&&!Object(k.l)(n)?re(e):t}function ue(e,t){var n=t.payload;return{selectedCardId:n.selectedCard,selectionDetails:le(e,n)}}function le(e,t){return t.selectType===j.a.SelectPost?e&&Object(A.j)(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0}:{lowFidelityWarningType:e&&!Object(A.j)(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0}}function fe(e,t,n){var r,o=t.payload.params;return Object(l.f)(o)?re(n):Object(l.e)(o)?{selectedCardId:n,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:o.commentId}}:re(null!==(r=null==e?void 0:e.selectedCardId)&&void 0!==r?r:n)}function me(e,t,n){if("CLEAR_COMMENT_SELECTION"===n.type)return!!t&&!Object(k.l)(e);if(!t)return!0;if(Object(k.l)(e))return n.payload.selectedCard===t.selectedCardId&&!Object(A.j)(t.selectionDetails)&&n.payload.selectType===j.a.ExpandCard;if(n.payload.selectedCard===t.selectedCardId)switch(n.payload.selectType){case j.a.SelectCard:return Object(A.j)(t.selectionDetails);case j.a.Polite:return!1;case j.a.SelectPost:case j.a.ExpandCard:return!0;default:Object(o.m)(n.payload)}return!0}function pe(e){var t={};return e.commentId&&(t[e.commentId]={pending:_.a.None,loadState:{state:E.a.Loaded},alternateId:e.commentId}),t}function ge(e){var t={};return e.commentId&&(t[e.commentId]={pending:D.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function ve(e,t){return e&&e.selectedCardId===t.payload.commentId?re(t.payload.commentId):e}function he(e,t,n){if(e.pendingDraft&&"CREATE"===e.pendingDraft.sessionType)return Object(b.y)();if(e.committedLieId)return e.committedLieId;var r=we(e);return!r||"CREATE"!==r.commentDraft.sessionConfiguration.sessionType||t&&!r.isInCurrentContext||n&&r.renderContextType!==n&&r.renderContextType!==v.a.None?void 0:r.commentDraft.sessionConfiguration.draftId}function be(e,t,n,r){var o=N(e,n);if(o.length<e.length){var a=V(o,t,r.flatIndex);a>=0&&o.splice(a,0,n)}return o}function Ce(e,t,n,o){if(!he(o,!0))return e;var a=he(o);if(e&&a&&n[a]&&n[a].pending===_.a.None){var i=Object(r.__assign)({},e),c=t.length;if(i.flatIndex>=c)i.flatIndex=c;else if(i.flatIndex>=0&&t[i.flatIndex].parentId){var s=new u.a(t,i.flatIndex);s.next().done?i.flatIndex=c:i.flatIndex=s.currentIndex()}return i}}function ye(e,t,n){if(!t)return-1;var r=n?t.selectedCardId:Object(A.b)(t);return e.findIndex((function(e){return e.commentId===r}))}function Te(e,t){return Object(P.f)(e)?t?e.findIndex((function(e){return e===t.selectedCardId})):-1:ye(e,t,!0)}function Oe(e,t,n){if(Object(P.c)(e)){if(!n||!t[n.selectedCardId])return-1;var r=Object(A.b)(n);return t[n.selectedCardId].findIndex((function(e){return e===r}))}return ye(e,n,!1)}function Ie(e){if(!Object(k.c)(e))return g.a.NoDraft;if(!function(e){var t=Pe(e),n=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(null==n?void 0:n.isDraftEmpty)}(e))return g.a.CannotAutoDiscard;var t=we(e);return t&&Object(c.k)(t.commentDraft.sessionConfiguration)?g.a.CannotAutoDiscard:g.a.CanAutoDiscard}function Se(e,t){if(void 0===t)return Object(i.k)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;var n=t.sessionConfiguration.draftId;return Object(i.k)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(i.k)().assertConditionTag(!!e[n],"Draft is not in map",593762518),S.s()&&n&&Object(m.a)().removeItem(n),F(e,n)}function je(e){return Ie(e)===g.a.CanAutoDiscard?Object(k.h)():e}function _e(e,t,n,r,a,i){var c,s;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(!t[c=e.pendingDraft.threadId])return e;break;case"EDIT":if(!r[s=e.pendingDraft.commentId])return e;break;default:return e}else{var d=we(e);if(!d||!d.isInCurrentContext)return e;switch(d.commentDraft.sessionConfiguration.sessionType){case"REPLY":c=d.threadId;break;case"EDIT":s=d.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(c&&!n[c]){var u=Fe(e,c);return Object(x.b)(e,u,3,i,o.d.reserveTag(539297118)),u}if(s&&!a[s]){u=Ne(e,s);return Object(x.b)(e,u,2,i,o.d.reserveTag(539297119)),u}return e}function ke(e,t){var n=Object(r.__assign)({},e.drafts),o=!1;return Object.keys(n).forEach((function(e){var a=t(e);a!==n[e].renderContextType&&(n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{renderContextType:a}),o=!0)})),o?Object(r.__assign)(Object(r.__assign)({},e),{drafts:n}):e}function Ee(e,t){if(t===p.a.Closed){if(Object(T.b)(e))return v.a.None}else if(e===v.a.DiscreteIntegrated)return v.a.FullPane;return e}function De(e){var t=we(e);return t?t.commentDraft:void 0}function Ae(e){var t=Object.keys(e);if(t.length>1)throw Object(i.k)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new O.a("Only a single draft is supported at this time.",o.d.reserveTag(589103619),-2130957551);if(0!==t.length)return t[0]}function Pe(e){return Ae(e.cardIdToDraftIdMap)}function xe(e){return Ae(e.postIdToDraftIdMap)}function we(e){var t=e.drafts,n=Ae(t);return n?t[n]:void 0}function Re(e){var t,n,a=e.drafts,c=Object.keys(a).filter((function(e){var t;return null===(t=a[e])||void 0===t?void 0:t.isInCurrentContext})).map((function(e){return a[e]}));if(0===c.length)return e;var s=Object(r.__assign)({},e);try{for(var d=Object(r.__values)(c),u=d.next();!u.done;u=d.next()){var l=u.value;switch(l.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":Object(i.k)().assertConditionTag("METADATA"!==l.commentDraft.sessionConfiguration.sessionType,"Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),s=Fe(s,l.threadId);break;case"EDIT":s=Ne(s,l.commentDraft.sessionConfiguration.commentId);break;default:Object(o.m)(l.commentDraft.sessionConfiguration)}}}catch(f){t={error:f}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return s}function Fe(e,t){var n,o=e.pendingDraft&&Object(l.f)(e.pendingDraft)&&e.pendingDraft.threadId===t,a=e.cardIdToDraftIdMap[t];return a?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Se(e.drafts,null===(n=e.drafts[a])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:F(e.cardIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function Ne(e,t){var n,o=e.pendingDraft&&Object(l.e)(e.pendingDraft)&&e.pendingDraft.commentId===t,a=e.postIdToDraftIdMap[t];return a?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Se(e.drafts,null===(n=e.drafts[a])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:F(e.postIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function Me(e,t,n){var o=Fe(e,t),a=xe(o);if(a){var i=o.postIdToDraftIdMap[a],c=o.drafts[i];c&&c.threadId===t&&(o=Ne(o,a))}if(o.pendingDraft&&Object(l.e)(o.pendingDraft)){var s=o.pendingDraft.commentId,d=n.find((function(e){return e.commentId===s}));d&&Object(f.b)(d)===t&&(o=Object(r.__assign)(Object(r.__assign)({},o),{pendingDraft:void 0}))}return o}function Le(e){if("web"===Object(y.a)()||"win32"===Object(y.a)()){if(e.tasks===d.a.Unknown){if("win32"===Object(y.a)())return S.c();Object(i.k)().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===d.a.Enabled&&S.c()}return S.c()}function Be(e,t,n,a){var c,s=e.pendingCommentLoad,d=void 0,u=e.expandedComments,l=function(e,t){var n=t?Object(P.e)(t)?{commentThreadIds:Object(r.__spreadArray)([],Object(r.__read)(t.commentThreadIds),!1),cardPostIds:Object(r.__assign)({},t.cardPostIds),postData:Object(r.__assign)({},t.postData)}:{commentData:Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t.commentData),!1),Object(r.__read)(e),!1)}:S.W()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:e};if(!Object(P.d)(n))return n;var o=void 0;return e.forEach((function(e){if(Object(f.a)(e))n.commentThreadIds.push(e.commentId),n.cardPostIds[e.commentId]=[e.commentId],o=e.commentId;else if(o===e.parentId)n.cardPostIds[e.parentId].push(e.commentId);else{if(!n.cardPostIds[e.parentId])return void Object(i.k)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",528773920);n.cardPostIds[e.parentId]=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(n.cardPostIds[e.parentId]),!1),[e.commentId],!1),o=e.parentId}n.postData[e.commentId]=e})),n}(t,e);if(s){var m=s.numberOfLoadedComments+t.length,p=s.numberOfLoadedThreads+t.filter(f.a).length;m>=s.numberOfTotalComments?(Object(i.k)().assertConditionTag(m===s.numberOfTotalComments,"Loaded more comments than expected",525693528),s=void 0):s=Object(r.__assign)(Object(r.__assign)({},s),{numberOfLoadedComments:m,numberOfLoadedThreads:p})}if(e.pendingCommentLoad){var g=e.pendingCommentLoad.selectedThreadIndex,v=void 0!==g&&Object(w.a)(s,n,a);if(Object(P.d)(l)&&e.createdCommentLie){var h=he(e.draftState,!0);if(h&&(!l.cardPostIds[h]||v)){var b=V(l.commentThreadIds,l.cardPostIds,e.createdCommentLie.flatIndex);l.cardPostIds[h]||(b<0&&!s&&(Object(i.k)().assertConditionTag(!1,"Draft thread index too large after loading all data, inserting at end",526262789),b=l.commentThreadIds.length),b>=0&&(l.commentThreadIds.splice(b,0,h),l.cardPostIds[h]=[h])),b>=0&&void 0!==g&&b<=g&&(g+=1)}}if(void 0!==g&&v){var C=Object(P.d)(l)?l.commentThreadIds:l.commentData.filter(f.a);if(!(g>=0&&g<C.length))throw Object(o.i)("selectedThreadIndex out of bounds"),new O.a(I.k,o.d.reserveTag(589103620),-2130957565);u=Z(u,d=re(Object(P.f)(C)?C[g]:C[g].commentId),e.draftState)}}if(e.selectedComment)if(S.X()){var y=we(e.draftState);(null!==(c=null==y?void 0:y.threadId)&&void 0!==c?c:he(e.draftState))===e.selectedComment.selectedCardId&&(d=e.selectedComment,u=e.expandedComments)}else Object(k.d)(e.draftState)&&(d=e.selectedComment,u=e.expandedComments);return Object(r.__assign)(Object(r.__assign)({},l),{pendingCommentLoad:s,selectedComment:d,expandedComments:u})}function Ve(e,t){var n=Object(P.b)(e,t);return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function Ue(e,t,n){return Object(P.f)(e)?n?Object(P.c)(t)?e.some((function(e){return!(t[e].commentFlags&s.a.Resolved)})):t.some((function(t){return""===t.parentId&&!(t.commentFlags&s.a.Resolved)&&e.find((function(e){return e===t.parentId}))})):e.length>0:Object(P.c)(t)?(Object(o.n)(!1,"ThreadData and CommentData must align if Map-Based",o.d.reserveTag(526402327)),!1):n?t.filter((function(e){return""===e.parentId&&!(e.commentFlags&s.a.Resolved)})).length>0:t.length>0}function He(){return{atMention:c.b.Unknown,newThread:!1,resolve:!1,richTextCapabilities:0,tasks:d.a.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1,ContentExtensionHostingDisabled:!1}}function qe(e,t){var n,o=e.cardIdToDraftIdMap[t.commentId],a=o?e.drafts[o].commentDraft:void 0;if(void 0===a)return Object(i.k)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;var c=t.smartReplies,s=a.sessionConfiguration.sessionType,d=c.length;return"REPLY"===s&&(d<=3&&d>0)?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Object(r.__assign)(Object(r.__assign)({},e.drafts),(n={},n[o]=Object(r.__assign)(Object(r.__assign)({},e.drafts[o]),{smartReplies:c}),n))}):e}},28561:function(e,t,n){"use strict";n(28562);var r=n(28419);n.d(t,"j",(function(){return r.a})),n.d(t,"k",(function(){return r.c}));var o=n(22371);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"c",(function(){return o.c})),n.d(t,"d",(function(){return o.d})),n.d(t,"e",(function(){return o.f})),n.d(t,"f",(function(){return o.g})),n.d(t,"g",(function(){return o.h})),n.d(t,"h",(function(){return o.k})),n.d(t,"i",(function(){return o.l}))},28562:function(e,t,n){},28563:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},28564:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(28565),o=n(28582),a=n(22371),i=function(){function e(e,t,n){this.threadIds=e,this.commentData=t,this.pointer=0,this.pointer=Math.max(-1,Math.min(n,e.length))}return e.prototype.next=function(){var e=this.pointer,t=this.threadIds.length-1;if(this.pointer<t)do{++this.pointer}while(this.pointer<=t&&Object(r.a)(Object(o.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer<t||this.pointer===t&&e<t?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&Object(r.a)(Object(o.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.currentIndex=function(){return this.pointer},e}(),c=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&a.f.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&a.f.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},28565:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return u}));var r=n(28091),o=n(28566),a=n(28480),i=n(28556);function c(e){return void 0!==e&&0!=(e.commentFlags&o.c.Resolved)}function s(e){return e!==i.a.Canvas}function d(e){return Object(a.shouldSelectActionExpandCard)(e)}function u(e,t){e.addDataField("IsCommentResolved",t,r.d.SystemMetadata)}},28566:function(e,t,n){"use strict";var r=n(28561);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.e})),n.d(t,"d",(function(){return r.f})),n.d(t,"e",(function(){return r.g})),n.d(t,"f",(function(){return r.h})),n.d(t,"g",(function(){return r.i})),n.d(t,"h",(function(){return r.j}));n(28567),n(28573),n(28574),n(28290)},28567:function(e,t,n){"use strict";n(28568),n(28569),n(28571)},28568:function(e,t,n){},28569:function(e,t,n){"use strict";n(28570)},28570:function(e,t,n){},28571:function(e,t,n){"use strict";n(28572)},28572:function(e,t,n){},28573:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=!1;function o(){r=!0}function a(){return r}},28574:function(e,t,n){"use strict";n(28575),n(28576),n(28580)},28575:function(e,t,n){},28576:function(e,t,n){"use strict";n(28577),n(28578),n(28579)},28577:function(e,t,n){},28578:function(e,t,n){},28579:function(e,t,n){},28580:function(e,t,n){"use strict";n(28581)},28581:function(e,t,n){},28582:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(28280);function o(e){return r.W()}function a(e){return r.W()}function i(e){return r.W()||0===e.length||"string"==typeof e[0]}function c(e){return r.W()}function s(e){return c()?e.postData:e.commentData}function d(e,t){return a()?e[t]:e.find((function(e){return e.commentId===t}))}},28583:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(28584),o=n(22374),a=n(22378);function i(e){return e.sessionType===a.a}function c(e){return e.sessionType===a.d&&void 0!==e.threadId}function s(e){return e.sessionType===a.b&&void 0!==e.commentId}var d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:o.a.Insert,REPLY:o.a.Insert,EDIT:o.a.Modify,METADATA:o.a.Modify};function l(e){return i(e)?r.a.InitCreateCommentSession:c(e)?r.a.InitReplyCommentSession:s(e)?r.a.InitEditCommentSession:r.a.Unknown}},28584:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},28585:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,o=n(12708),a=n(28062),i=n(28310),c=n(28280),s=function(){function e(){}return e.prototype.getItem=function(e){return Object(c.s)()?sessionStorage.getItem(e):null},e.prototype.setItem=function(e,t){Object(c.s)()&&sessionStorage.setItem(e,t)},e.prototype.removeItem=function(e){Object(c.s)()&&e&&sessionStorage.removeItem(e)},e.prototype.storeEditorContentFromDraftSave=function(e,t){if(Object(c.s)()){var n=e.draftContent.editorContent,r=e.draftContent.editorCursorPosition;Promise.all([n,r]).then((function(n){var r=Object(o.__read)(n,2),a={draftContent:{content:r[0],cursorPosition:r[1]},draftingParams:t};sessionStorage.setItem(e.draftId,JSON.stringify(a))})).catch(Object(i.a)(a.d.reserveTag(523362974)))}},e}();function d(){return r||(r=new s)}},28586:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},28587:function(e,t,n){"use strict";n.d(t,"v",(function(){return h})),n.d(t,"j",(function(){return b})),n.d(t,"h",(function(){return C})),n.d(t,"g",(function(){return y})),n.d(t,"p",(function(){return T})),n.d(t,"k",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"f",(function(){return j})),n.d(t,"c",(function(){return _})),n.d(t,"m",(function(){return k})),n.d(t,"q",(function(){return E})),n.d(t,"r",(function(){return D})),n.d(t,"u",(function(){return A})),n.d(t,"t",(function(){return P})),n.d(t,"d",(function(){return x})),n.d(t,"l",(function(){return w})),n.d(t,"b",(function(){return R})),n.d(t,"o",(function(){return F})),n.d(t,"s",(function(){return N})),n.d(t,"n",(function(){return M})),n.d(t,"e",(function(){return L})),n.d(t,"i",(function(){return B}));var r=n(28313),o=n(28062),a=n(28284),i=n(28091),c=n(22381),s=n(28405),d=n(28271),u=n(28272),l=n(28280),f=n(28588),m=n(28589),p=n(28590),g=n(28591),v=(n(28592),n(28309),n(28593));function h(e,t,n){var r=n&&l.n()?t-1:t-2;if(r<1)throw new d.a(u.f,o.d.reserveTag(589103692),-2130957559);var a=l.n();return 1===r?a?e.getString(106):e.getString(9):a?e.formatString(107,String(r)):e.formatString(10,String(r))}function b(e,t){switch(t){case c.a.AtFinishNextCommentIsFirst:return e.getString(8);case c.a.AtStartNextCommentIsFirst:return e.getString(6);case c.a.MoreCommentsUpcoming:case c.a.DocumentHasComments:return e.getString(7);case c.a.OnlyCommentsInCurrent:case c.a.NoComments:case c.a.Unknown:return"";default:Object(o.m)(t)}}function C(e,t,n,r){return n?t?e.getString(16):e.getString(17):l.F()&&void 0!==r&&r!==g.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function y(e,t){switch(t){case f.a.ReturnToDraft:return e.getString(110);case f.a.GrantAccessFailedSilently:return e.getString(134);case f.a.GrantAccessCanceled:return e.getString(234);case f.a.CommitFailed:return e.getString(135);case f.a.None:return Object(i.k)().assertConditionTag(!1,"Invalid DraftWarningType: ".concat(t),595686755),""}}function T(e,t){return void 0===t&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function O(e,t){return t?Object(m.f)(t)?e.getString(35):Object(m.c)(t)?e.getString(36):"":""}var I=Object(a.a)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return e instanceof Error&&"RangeError"===e.name}return!1}));function S(e,t){var n=!!t&&I();try{if(n){var r={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:Object(v.a)()};return e.toLocaleDateString(t,r)}return Object(i.k)().assertConditionTag(!1,"The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: ".concat(I(),", locale Exists: ").concat(!!t),595882385),e.toLocaleDateString()}catch(o){return Object(i.k)().assertConditionTag(!1,"LocaleDateString conversion failed: ".concat(o instanceof Error?o.name:"",", locale Exists: ").concat(!!t,", doesToLocaleDateStringSupportsLocales: ").concat(I(),", Date: ").concat(e.toString()),595953050),""}}function j(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function _(e,t){switch(e){case p.a.Draft:case p.a.DraftPreCommitPending:return t.getString(16);default:return t.getString(89)}}function k(e){return e.getString(122)}function E(e,t){return 0===e.length?A(t):1===e.length?function(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(s.k)(e))}(e[0],t):Object(s.c)(e)?t.getString(250):t.getString(251)}function D(e,t,n){if(0===e.length)return P(t,n);var r=e.map((function(e){return Object(s.k)(e)})).join(", ");return t?n.formatString(130,r):n.formatString(129,r)}function A(e){return e.formatString(111,e.getString(133))}function P(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function x(e,t,n,r){var o,a=t===p.a.Draft||t===p.a.DraftPreCommitPending;return null!==(o=R(e,n,r))&&void 0!==o?o:a?e.getString(173):e.getString(174)}function w(e,t,n){var r="";switch(n.length){case 0:r=e.getString(133);break;case 1:r=n[0];break;case 2:r=e.formatString(242,n[0],n[1]);break;case 3:r=e.formatString(243,n[0],n[1],n[2]);break;default:r=e.formatString(244,n[0],(n.length-1).toString())}var o=t?114:252;return e.formatString(o,r)}function R(e,t,n){var r=Object(s.g)(n);if(r)return e.formatString(t?179:178,r)}function F(e,t){return e?t.getString(176):t.getString(126)}function N(e,t){return 0===e.length?t.getString(181):t.formatString(114,e.map((function(e){return Object(s.k)(e)})).join(", "))}function M(e,t){switch(t){case r.a.ActiveOnly:return e.getString(247);case r.a.ResolvedOnly:return e.getString(246);case r.a.All:return e.getString(245);default:Object(o.m)(t)}}function L(e,t){switch(t){case r.c.HostDefaultOrder:return"";case r.c.NewestFirst:return e.getString(248);default:Object(o.m)(t)}}function B(e,t){switch(t){case void 0:return;case 1:return e.getString(256);default:return e.formatString(257,t.toString())}}},28588:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"}(r||(r={}))},28589:function(e,t,n){"use strict";var r;function o(e){return e.selectionDetails.lowFidelityWarningType===r.Edit}function a(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteReply}function i(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteThread}function c(e){return a(e)||i(e)}function s(e){return!!e&&(o(e)||a(e))}function d(e){return!!e&&(c(e)||o(e))}function u(e){return void 0!==e.selectedPostId}function l(e){return u(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function f(e,t){return!!t&&u(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&d(t)}n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return f})),function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={}))},28590:function(e,t,n){"use strict";var r;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={})),t.a=r},28591:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},28592:function(e,t,n){"use strict";var r;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={})),t.a=r},28593:function(e,t,n){"use strict";function r(){}n.d(t,"a",(function(){return r}))},28594:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28595),o=(new r.a).insert("").toJSON();(new r.a).toJSON()},28595:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return s}));n(28062),n(28271);var r,o=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function a(e,t,n){return{fullName:e,email:t,resolveState:n}}function i(e){return{atmention:{contentId:e.contentId,isCurrentUser:e.isCurrentUser,directoryId:e.directoryId}}}function c(e){return s(JSON.parse(e))}function s(e){return e.ops?e.ops.map((function(e){return e.insert})).join(""):""}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(r||(r={}))},28596:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(28309);function o(e){return e===r.a.FullPane||e===r.a.HalfPane}function a(e){return e===r.a.DiscreteIntegrated||e===r.a.DiscreteIsolated}},28597:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},28598:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return h})),n.d(t,"m",(function(){return b}));var r,o=n(12708),a=n(28280);function i(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,selectedTaskAssignees:e.selectedTaskAssignees,smartReplies:e.smartReplies}}function c(e){return Object.keys(e.drafts)}function s(e){var t=0;for(var n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function d(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function u(e){return s(e)>0}function l(e){return u(e)||m(e)}function f(e){return!a.X()&&l(e)}function m(e){return void 0!==e.pendingDraft}function p(e,t){var n,r;try{for(var a=Object(o.__values)(c(e)),i=a.next();!i.done;i=a.next()){var s=i.value;if(e.drafts[s].pendingState===t)return!0}}catch(d){n={error:d}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}function g(e){return p(e,r.None)}function v(e){return p(e,r.Commit)}function h(e){return p(e,r.Discard)}function b(e,t){return h(e)&&g(t)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},28599:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.NeedsReload=3]="NeedsReload"}(r||(r={}))},28600:function(e,t,n){"use strict";var r;function o(e){return void 0!==e.pending||void 0!==e.displayingErrorUI}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},28601:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(28091),o=n(28280),a=n(28598);function i(e,t,n,o,i){if(-1!==n&&Object(a.e)(t)<Object(a.e)(e)){var c=Object(r.k)().createActivityObject("SilentDraftDiscard",Object(r.l)(r.g.GlobalAPI),Object(r.j)());c.addDataField("DiscardReason",null!=n?n:0,r.d.SystemMetadata),c.addDataField("Source",o,r.d.SystemMetadata),c.successTag(i)}}function c(e){if(o.C()){var t=Object(r.k)().createActivityObject("MarkCommentCreation",e,Object(r.j)());t.addDocumentMetadata(r.f.Basic),t.successTag(591152859)}}},28602:function(e,t,n){"use strict";function r(e,t){var n=e.filter(t);return n.length===e.length?e:n}n.d(t,"a",(function(){return r}))},28603:function(e,t,n){"use strict";n.d(t,"o",(function(){return u})),n.d(t,"x",(function(){return l})),n.d(t,"r",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return v})),n.d(t,"k",(function(){return h})),n.d(t,"b",(function(){return C})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return T})),n.d(t,"s",(function(){return O})),n.d(t,"h",(function(){return I})),n.d(t,"v",(function(){return S})),n.d(t,"t",(function(){return j})),n.d(t,"j",(function(){return _})),n.d(t,"q",(function(){return k})),n.d(t,"u",(function(){return E})),n.d(t,"f",(function(){return D})),n.d(t,"i",(function(){return A})),n.d(t,"g",(function(){return P})),n.d(t,"y",(function(){return x})),n.d(t,"p",(function(){return w})),n.d(t,"w",(function(){return R})),n.d(t,"e",(function(){return F}));var r=n(28170),o=n(13055),a=n(28604),i=n(28560),c=n(28582),s=n(28558),d=n(28606),u=function(e){return e.commentState.contextState.isReadOnly},l=function(e){return e.commentState.topVisibleThreadId},f=function(e){return e.commentState.personaIconPropertiesMap},m=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},g=function(e){return Object(c.e)(e.commentState)?e.commentState.postData:e.commentState.commentData},v=function(e){return Object(c.e)(e.commentState)?e.commentState.commentThreadIds:e.commentState.commentData},h=function(e){var t=s.g(e);if(t){if(s.a(e)){var n=s.d(e);return t.supportedContentTypes!==r.b.CommentThread&&(n=n.filter((function(e){return e.contentType===r.b.CommentThread}))),n.map((function(e){return e.contentId}))}return[]}return v(e)},b={},C=function(e){return Object(c.e)(e.commentState)?e.commentState.cardPostIds:b},y=function(e){return v(e).length>0},T=function(e){return h(e).length>0},O=function(e){return e.commentState.postViewState},I=function(e){return e.commentState.draftState},S=function(e){return Object(i.K)(I(e))},j=function(e){return e.commentState.selectedComment},_=function(e){return e.commentState.expandedComments},k=function(e){return e.commentState.pendingCommentLoad},E=function(e){return e.commentState.selectedThreadIdBeforeCommentSession},D=function(e){return e.commentState.contextState},A=function(e,t,n){return Object(i.G)(I(e),t,n)},P=function(e,t,n){return e.commentState.createdCommentLie&&A(e,t,n)?e.commentState.createdCommentLie:void 0},x=function(){return Object(o.a)([v,s.d,C,g,P,I,d.b,s.g],(function(e,t,n,r,o,i,c,s){return s?a.k(t,n,r,c,o,i):a.m(e,n,r,c)}))},w=function(e){return e.commentState.modelCapabilities},R=function(e){return e.commentState.suggestionsDetails},F=function(e,t){return t?Object(c.b)(g(e),t):void 0}},28604:function(e,t,n){"use strict";n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return T})),n.d(t,"k",(function(){return O})),n.d(t,"b",(function(){return I})),n.d(t,"h",(function(){return S})),n.d(t,"g",(function(){return j})),n.d(t,"a",(function(){return _})),n.d(t,"e",(function(){return k})),n.d(t,"i",(function(){return E})),n.d(t,"d",(function(){return D})),n.d(t,"f",(function(){return A})),n.d(t,"j",(function(){return P})),n.d(t,"c",(function(){return x}));var r=n(12708),o=n(28062),a=n(28091),i=n(22371),c=n(28432),s=n(28443),d=n(28405),u=n(28271),l=n(28272),f=n(28280),m=n(28560),p=n(28597),g=n(28582),v=n(28605),h=n(28587);function b(e,t,n){for(var r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function C(e,t,n,r,o,i){for(var c=[],s=t,d=o;s<=n&&d<=i;){var u=e[s].date;Object(a.k)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=r.history[d].records[0].time?(Object(a.k)().assertConditionTag(e[s].parentId===r.commentId,"comments must belong to the same thread",595719173),c.push({commentModel:e[s]}),++s):(Object(a.k)().assertConditionTag(!r.history[d].commentId,"Unanchored history item should not have commentId",595719178),c.push({historyItem:r.history[d],parentThreadId:r.commentId}),++d)}for(;s<=n;++s)c.push({commentModel:e[s]});for(;d<=i;++d)Object(a.k)().assertConditionTag(!r.history[d].commentId,"Unanchored history item should not have commentId",595719179),c.push({historyItem:r.history[d],parentThreadId:r.commentId});return c}function y(e,t){if(!f.c()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(f.d()||t.commentId===t.history[0].commentId||(Object(a.k)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(a.k)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var o=[];f.d()||o.push({commentModel:e[0],historyItem:t.history[0]});for(var i=f.d()?0:1,c=f.d()?0:1,s=f.d()?0:1;i<e.length&&s<t.history.length;){var d=b(e,i,t.history[s]);d>=0&&(o.push.apply(o,Object(r.__spreadArray)([],Object(r.__read)(C(e,i,d-1,t,c,s-1)),!1)),Object(a.k)().assertConditionTag(0===d||e[d].parentId===t.commentId,"comments must belong to the same thread",595719175),o.push({commentModel:e[d],historyItem:t.history[s]}),i=d+1,c=s+1),++s}return o.push.apply(o,Object(r.__spreadArray)([],Object(r.__read)(C(e,i,e.length-1,t,c,t.history.length-1)),!1)),o}function T(e,t,n,o){var i=[];if(Object(g.c)(n))Object(g.f)(e)?e.forEach((function(e){i.push.apply(i,Object(r.__spreadArray)([],Object(r.__read)(y(Object(m.z)(n,t,e),o[e])),!1))})):Object(a.k)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515151);else for(var s=0,d=1;d<=n.length;d++)(d===n.length||Object(c.a)(n[d]))&&(i.push.apply(i,Object(r.__spreadArray)([],Object(r.__read)(y(n.slice(s,d),o[n[s].commentId])),!1)),s=d);return i}function O(e,t,n,o,a,i){var s=[];if(0===e.length)return s;if(Object(g.c)(n))e.forEach((function(e){s.push.apply(s,Object(r.__spreadArray)([],Object(r.__read)(y(Object(m.z)(n,t,e.contentId),o[e.contentId])),!1))}));else for(var d=0,u=0,l=function(e,t,n,r){return e<t.length&&!!Object(c.a)(t[e])&&-1===n&&t[e].commentId===r};d<e.length&&!((null==a?void 0:a.newComment_deprecated)&&e[d].contentId===Object(m.G)(i,!0)&&(s.push({commentModel:a.newComment_deprecated}),++d>=e.length));){for(var f=-1,p=0;p<=n.length;p++)if(l(p,n,f,e[d].contentId))f=p;else if(-1!==f&&(p===n.length||Object(c.a)(n[p]))){if(s.push.apply(s,Object(r.__spreadArray)([],Object(r.__read)(y(n.slice(f,p),o[n[f].commentId])),!1)),++d>=e.length)break;l(p,n,f=-1,e[d].contentId)&&(f=p)}u===d&&d++,u=d}return s}function I(e,t){var n=e.find((function(e){return Object(v.a)(e)&&e.commentModel.commentId===t}));if(Object(v.a)(n))return n.commentModel}function S(e){var t=e[0];if(Object(v.a)(t))return t.commentModel;throw new u.a(l.a,o.d.reserveTag(589103627),2130957505)}function j(e){return Object(v.a)(e)?e.commentModel.parentId:e.parentThreadId}function _(e,t){return f.V()?"".concat(e,"__").concat(t):t}function k(e){return Object(v.a)(e)?e.commentModel.commentId:_(e.historyItem.taskId,e.historyItem.records[0].recordId)}function E(e){return Object(v.a)(e)?Object(c.b)(e.commentModel):e.parentThreadId}function D(e,t){var n=[],r=e.records[0];switch(r.type){case s.a.Create:case s.a.UnassignAll:for(var o=[],i=1;i<e.records.length;i++){(u=e.records[i]).type===s.a.Assign&&o.push(Object(d.k)(u.assignee))}n.push({icon:13,description:Object(h.l)(t,!0,o)});break;case s.a.Assign:case s.a.Unassign:o=[];var c=[];for(i=0;i<e.records.length;i++){var u;if((u=e.records[i]).type!==s.a.Assign&&u.type!==s.a.Unassign)return Object(a.k)().assertConditionTag(!1,"Unexpected HistoryRecordType.",528064847),[{icon:0,description:t.getString(119)}];u.type===s.a.Assign?o.push(Object(d.k)(u.assignee)):c.push(Object(d.k)(u.assignee))}o.length>0&&n.push({icon:13,description:Object(h.l)(t,!0,o)}),c.length>0&&n.push({icon:13,description:Object(h.l)(t,!1,c)});break;case s.a.Progress:return 100===r.completion?[{icon:15,description:t.getString(116)}]:[{icon:21,description:t.getString(117)}];case s.a.Schedule:return[{icon:17,description:t.getString(118)}];default:return Object(a.k)().assertConditionTag(!1,"Unexpected HistoryRecordType",527759317),[{icon:0,description:t.getString(119)}]}return 0===n.length&&n.push({icon:0,description:t.getString(119)}),n}function A(e,t){return e.findIndex((function(e){return e.length>0&&E(e[0])===t}))}function P(e,t){return e.some((function(e){return Object(v.a)(e)&&!!(e.commentModel.commentFlags&i.f.LowFidelity)&&(void 0===t||t===Object(c.b)(e.commentModel))}))}function x(e,t,n,r,o){for(var i=[],c=!f.W()&&!o&&void 0!==n,s=-1,d=-1,u=0;u<e.length;u+=1){var l=e[u],m=Object(v.a)(l)?l:void 0;if(m&&void 0!==t[m.commentModel.commentId])if(t[m.commentModel.commentId].pending===p.a.Delete&&r)for(Object(v.a)(l)&&++d;!(u+1>=e.length||""===j(e[u+1]));)++u,Object(v.a)(e[u])&&++d;else{++d,i.push([m]),c&&d===(null==n?void 0:n.flatIndex)&&(s=i.length-1);for(var g=u+1;g<e.length;g+=1){if(l=e[g],Object(v.a)(l)){var h=j(l);if(h!==m.commentModel.commentId){Object(a.k)().assertConditionTag(!h,"Orphaned reply",593085889);break}i[i.length-1].push(l),++d}else i[i.length-1].push(l);++u}}else for(Object(a.k)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: ".concat(e.length," | cardViewStateLength: ").concat(Object.keys(t).length," | insertingThreadLie: ").concat(c),593085888),Object(v.a)(l)&&++d;!(u+1>=e.length||""===j(e[u+1]));)++u,Object(v.a)(e[u])&&++d}return c&&n&&(-1!==s?i.splice(s,0,[{commentModel:n.newComment_deprecated}]):(Object(a.k)().assertConditionTag(n.flatIndex>d,"Failed to find insertion point for lie in getAllRenderableItemThreads",529094429),n.flatIndex===d+1&&i.push([{commentModel:n.newComment_deprecated}]))),i}},28605:function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function o(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},28606:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(28280),o={},a=function(e){return Object(r.c)()?e.commentState.tasks:o},i=function(e){return e.commentState.historyRecordViewState}},28607:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s}));var r=n(28361),o=function(e){return e.paneState.visibilityState===r.a.Visible},a=function(e){return e.paneState.visibilityState!==r.a.Closed},i=function(e){return e.paneState.visibilityState},c=function(e){return e.paneState.componentTree},s=function(e){return e.paneState.viewContainer}},28608:function(e,t,n){"use strict";var r;!function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"}(r||(r={})),t.a=r},28609:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}(r||(r={}))},28610:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28608),o=n(28309);function a(e,t,n){return n===o.a.HalfPane||t.includes(e)?r.a.Expanded:r.a.Collapsed}},28611:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(28612);function o(e){return e.type===r.a.DispatchAction&&void 0!==e.action}function a(e,t){return{type:r.a.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}},28612:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(r||(r={}))},28613:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(12708),o=n(28612);function a(e){return e.type===o.a.FocusComponent&&void 0!==e.component}function i(e,t,n){return void 0===n&&(n={priorityArgs:{priority:1}}),Object(r.__assign)({type:o.a.FocusComponent,component:t,causedBy:e},n)}},28614:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(28062),o=n(28479),a=n(28612),i=n(28615),c=50;function s(e,t){var n=function(c,s,d,u,l){if(!t||!c||-1===t.indexOf(c.type)||3===c.priorityArgs.priority)return c&&-1!==(null==t?void 0:t.indexOf(c.type))&&(o.a&&(null==c?void 0:c.type)===a.a.FocusComponent&&Object(r.i)("Executing non-debounced focus command ".concat(JSON.stringify(c))),void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),n.pendingCommand=void 0),void u(c,Object(i.a)(c,s,d,l));void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),o.a&&c.type===a.a.FocusComponent&&Object(r.i)("Caching debounced command ".concat(JSON.stringify(c))),n.pendingCommand=setTimeout((function(){o.a&&c.type===a.a.FocusComponent&&Object(r.i)("Executing debounced command ".concat(JSON.stringify(c))),u(c,Object(i.a)(c,s,d,l)),n.pendingCommand=void 0}),e)};return n.pendingCommand=void 0,n}},28615:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(28062),o=n(28091),a=n(28479),i=n(28609),c=n(28616),s=n(28617),d=n(28611),u=n(28613);function l(e,t,n,f){if(!e)return i.a.NoCommand;var m=i.a.Handled;if(Object(u.b)(e)){var p=e.component;m=function(e,t,n){return t?(a.a&&Object(r.i)("Calling focus for componentType: ".concat(e.component.componentType)),n(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),i.a.Handled):function(e){return 1!==e.priorityArgs.priority&&0!==e.priorityArgs.phase}(e)?i.a.ShouldRetry:i.a.ComponentNotFound}(e,Object(c.c)(p)?t.getComponentById(p):t.getComponent(p.componentType),f)}else if(Object(d.b)(e))n.dispatch(e.action);else if(Object(s.b)(e)){var g=l(e.first,t,n,f),v=l(e.then,t,n,f);Object(o.k)().assertConditionTag(g!==i.a.ShouldRetry&&v!==i.a.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),m}},28616:function(e,t,n){"use strict";var r;function o(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot||e===r.CommentsList}function a(e){return(t=e.componentType)===r.CardEditor||t===r.PostEditor||t===r.Card||t===r.Post||t===r.DraftCard||t===r.DiscreteHostedCommentRoot||t===r.ReopenThreadButton;var t}function i(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function c(e,t){return a(e)&&a(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return c})),function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList"}(r||(r={}))},28617:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(28612);function o(e,t,n){return t?n?{type:r.a.Compound,priorityArgs:{priority:1},first:t,then:n,causedBy:e}:t:n}function a(e){return e.type===r.a.Compound&&void 0!==e.first&&void 0!==e.then}},28618:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u}));n(12708),n(28452);var r=n(28560),o=n(28307),a=n(28616);function i(e){var t="";return Object(a.e)(e.componentType)?t=c(e.componentType):Object(a.c)(e)&&(t=s(e)),t}function c(e){switch(e){case a.a.ClosePaneButton:return o.l();case a.a.NextCommentButton:return o.E();case a.a.PreviousCommentButton:return o.M();case a.a.GhostCard:return o.A();case a.a.NewCommentButton:return o.D();case a.a.PaneRoot:return o.z();case a.a.CommentsList:return o.q()}}function s(e){switch(e.componentType){case a.a.Card:return o.i(e,!1);case a.a.DraftCard:return o.i(e,!0);case a.a.PostEditor:return o.w(o.G(e));case a.a.CardEditor:return o.w(o.f(e));case a.a.Post:return o.I(e);case a.a.DiscreteHostedCommentRoot:return o.s(e);case a.a.ReopenThreadButton:return o.d(e,o.P())}}function d(e){return e?a.a.DraftCard:a.a.Card}function u(e,t){return d(Object(r.G)(t)===e)}},28619:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28616);function o(e,t){return!!(Object(r.c)(t)?e.getComponentById(t):e.getComponent(t.componentType))}},28620:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(28091),o=n(28280),a=n(28603),i=n(28309),c=n(28370),s=n(28596),d=n(28613),u=n(28616);function l(e,t){if(n=e.componentTreeId.renderContextType,!("win32"===Object(c.a)()||"web"===Object(c.a)()&&o.L())&&Object(s.b)(n)){var n;if(e.getComponent(u.a.ClosePaneButton))return Object(d.a)(void 0,{componentType:u.a.ClosePaneButton},{priorityArgs:t});Object(r.k)().assertConditionTag(!1,"cant find close button on platform where we should be able to find it",579086371)}}function f(e,t,n){var f,m;if(void 0===n&&(n={priority:1}),Object(s.b)(e.componentTreeId.renderContextType)){var p=null!==(m=null!==(f=function(e,t,n){if(o.E()&&e.componentTreeId.renderContextType===i.a.FullPane){var c=t.getState();if(a.p(c).newThread){if(e.getComponent(u.a.NewCommentButton))return Object(d.a)(void 0,{componentType:u.a.NewCommentButton},{priorityArgs:n});Object(r.k)().assertConditionTag(!1,"cant find new comment button, but its enabled",579086400)}}}(e,t,n))&&void 0!==f?f:l(e,n))&&void 0!==m?m:function(e){if("web"!==Object(c.a)())return Object(d.a)(void 0,{componentType:u.a.CommentsList},{priorityArgs:e})}(n);if(p)return p;Object(r.k)().assertConditionTag(!1,"Couldn't find a focus target",576337158)}else Object(r.k)().assertConditionTag(!1,"Shouldn't be called with renderContextType: ".concat(e.componentTreeId.renderContextType),576337157)}},28621:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(28062),n(28271);function r(e){}},28622:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var r=n(12708),o=n(28452),a=n(28623);function i(e,t,n,o,a){var i=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.apply(void 0,Object(r.__spreadArray)([e],Object(r.__read)(t),!1))},c=function(o){for(var c=[],s=1;s<arguments.length;s++)c[s-1]=arguments[s];var d=i.apply(void 0,Object(r.__spreadArray)([o],Object(r.__read)(c),!1));a(d,o,e(),t,n)};return c.processCommand=i,c}function c(e,t,n,i,c){var s=function(t,n){var o=Object(r.__read)(n),i=o[0],s=o.slice(1),u=i();c(d.apply(void 0,Object(r.__spreadArray)([Object(a.a)(t),u],Object(r.__read)(s),!1)),u,e(),(function(){}),(function(){}))},d=function(e,a){for(var c=[],s=2;s<arguments.length;s++)c[s-2]=arguments[s];if(n(a)){var d=Object(o.d)(Object(o.f)(e.key),t),u=i[o.b[d]];return u?u.handler.apply(u,Object(r.__spreadArray)([e,a],Object(r.__read)(c),!1)):void 0}},u=Object.keys(i).map((function(e){return{key:e,eventPhase:i[e].phase}})),l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return s(t,e)},getKeyDownEvents:function(){return u}}};return l.processEvent=d,l}},28623:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28624);function o(e){return new r.a(e)}},28624:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(12708),o=n(28452),a=function(e){function t(t){var n=e.call(this,t)||this,r=t.nativeEvent,a=r.altKey,i=r.shiftKey,c=r.ctrlKey,s=r.metaKey,d=r.key;return n.altKey=a,n.shiftKey=i,n.ctrlKey=c,n.metaKey=s,n.key=Object(o.f)(d),n}return Object(r.__extends)(t,e),t}(n(28625).a)},28625:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}()},28626:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},28627:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n(28062),o=n(28091),a=n(28170),i=n(28340),c=n(22381),s=n(28628),d=n(28564),u=n(28432),l=n(28361),f=n(28280),m=n(28480),p=n(28556),g=n(28557),v=n(28560),h=n(28589),b=n(28603),C=n(28607),y=n(28582),T=n(28608),O=n(28309),I=n(28610),S=n(28604),j=n(28629),_=n(28605),k=n(28617),E=n(28611),D=n(28613),A=n(28616),P=function(){function e(e,t,n){this.commentStore=e,this.telemetryVisitor=t,this.useContentNavigationAPI=n}return e.prototype.selectThreadInCurrentContext=function(e,t,n,r,o){return Object(E.a)(e,m.selectComment(t,n,void 0,r?m.SelectActionType.ExpandCard:m.SelectActionType.SelectCard,o))},e.prototype.collapseThreadInCurrentContext=function(e,t,n){return Object(E.a)(e,m.collapseCard(t,n))},e.prototype.selectPost=function(e,t,n,r,o){return Object(E.a)(e,m.selectComment(t,n,r,m.SelectActionType.SelectPost,o))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,o,a){if(!f.W()&&f.X()){var i=b.g(this.commentStore.getState(),!0,o),c=Object(v.G)(b.h(this.commentStore.getState()),!0,o);if(c&&i&&0===i.flatIndex)return this.selectThreadInCurrentContext(e,{renderContextType:o,trackback:r.d.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},c,!1,n)}var s=void 0,u=a?b.a(this.commentStore.getState()):b.k(this.commentStore.getState());if(Object(y.f)(u))s=a?new d.b(u,b.d(this.commentStore.getState()),-1).next().value:u[0];else{var l=void 0;if(a)l=new d.a(u,-1,a).next().value;else l=u[0];s=null==l?void 0:l.commentId}if(s)return this.selectThreadInCurrentContext(e,{renderContextType:o,trackback:r.d.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},s,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,a,i){var c=b.d(this.commentStore.getState());if(!Object(y.c)(c)&&f.X()){var s=b.g(this.commentStore.getState(),!0,a),u=Object(v.G)(b.h(this.commentStore.getState()),!0,a);if(u&&s&&s.flatIndex===c.length)return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:r.d.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},u,!1,n)}var l=i?b.a(this.commentStore.getState()):b.k(this.commentStore.getState());if(Object(v.d)(l,c,i)){var m=void 0;if(Object(y.f)(l))m=i?new d.b(l,c,l.length).previous().value:l[l.length-1];else{var p=new d.a(l,l.length,i).previous().value;m=null==p?void 0:p.commentId}if(m)return this.selectThreadInCurrentContext(e,{renderContextType:a,trackback:r.d.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},m,t,n);Object(o.k)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.focusAndCollapseSelectedThread=function(e,t){var n=b.t(this.commentStore.getState());if(n){if(f.X()&&Object(v.G)(b.h(this.commentStore.getState()))===n.selectedCardId)return;var o=b.j(this.commentStore.getState());if(Object(I.a)(n.selectedCardId,o,t)===T.a.Expanded)return Object(k.a)(e,Object(D.a)(e,{componentType:A.a.Card,id:n.selectedCardId,renderContextType:t}),this.collapseThreadInCurrentContext(e,{renderContextType:t,trackback:r.d.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}},e.prototype.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated=function(e,t,n,o,a,c,s,d){var u,l=t.direction===i.d.Next?e.next():e.previous();if(f.X()&&n&&o&&a.selectedCardId!==n&&(t.direction===i.d.Next?c<o.flatIndex&&(l.done||e.currentIndex()>=o.flatIndex):c>=o.flatIndex&&(l.done||e.currentIndex()<o.flatIndex)))return this.selectThreadInCurrentContext(s,{renderContextType:d,trackback:r.d.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},n,!1,t.source);return l.done||(u=l.value.commentId),u},e.prototype.selectNextOrPreviousThread=function(e,t,n,s,u){var p=this.commentStore.getState(),h=b.t(p);if(this.useContentNavigationAPI&&(!h||s===O.a.DiscreteIntegrated||s===O.a.None&&C.e(p)!==l.a.Visible)){if(void 0!==n)return Object(E.a)(e,m.selectContent({renderContextType:s,trackback:r.d.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,h?{contentId:h.selectedCardId,contentType:a.b.CommentThread}:void 0,n));Object(o.k)().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var T=u?b.a(this.commentStore.getState()):b.k(this.commentStore.getState()),I=b.f(p).nextPopulatedContextDetails,S=t.direction===i.d.Next,j=b.g(p,!0,s);if(void 0!==h&&(u||Object(g.b)(this.commentStore.getState(),h.selectedCardId))){var _=Object(v.G)(b.h(p),!0,s),k=void 0;k=!Object(y.f)(T)&&f.X()&&j&&h.selectedCardId===_?j.flatIndex+(S?-1:0):this.getSelectedThreadIndex(T);var D=void 0;if(Object(y.f)(T))if(u){var A=new d.b(T,b.d(p),k);D=S?A.next().value:A.previous().value}else D=T[k+(S?1:-1)];else{A=new d.a(T,k,u);var P=this.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated(A,t,_,j,h,k,e,s);if(P&&"string"!=typeof P)return P;D=P}if(D)return this.selectThreadInCurrentContext(e,{renderContextType:s,trackback:r.d.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},D,t.expandCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t,s,I,u)}else{if(Object(v.d)(u?b.a(this.commentStore.getState()):b.k(this.commentStore.getState()),b.d(p),u)||!f.W()&&f.X()&&j)return this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,s,u);if(!t.restrictToCurrentContext&&I!==c.a.NoComments)return this.selectAcrossContexts(e,t,s,I,u)}},e.prototype.selectAcrossContexts=function(e,t,n,a,s){return this.useContentNavigationAPI&&!C.a(this.commentStore.getState())&&Object(o.k)().assertConditionTag(!1,"This method should not be used for DHC iteration across contexts when the content navigation API is being used.",560551957),t.direction===i.d.Next?a===c.a.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,n,s):Object(E.a)(e,m.selectFirstThreadInNextCommentContext({renderContextType:n,trackback:r.d.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):a===c.a.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(e,t.expandCard,t.source,n,s):Object(E.a)(e,m.selectLastThreadInPreviousCommentContext({renderContextType:n,trackback:r.d.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPostWithinCard=function(e,t,n){var a=b.t(this.commentStore.getState());if(void 0!==a){if(!f.c()){var i=b.d(this.commentStore.getState()),c=this.getSelectedIndex(),d=void 0,l=void 0;if(Object(y.c)(i)){var m=b.b(this.commentStore.getState())[a.selectedCardId];m&&c<m.length-1&&(d=a.selectedCardId,l=m[c+1])}else{var g=new s.a(i,c).next(),v=i[c];!g.done&&g.value.parentId&&g.value.parentId===Object(u.b)(v)&&(d=g.value.parentId,l=g.value.commentId)}return d&&l?this.selectPost(e,{renderContextType:t,trackback:r.d.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},d,l,p.a.SharedComments):void 0}if(n){var h=this.getSelectedIndexFromRenderableItems(n);if(!(h<0)){var C=new j.a(n,h).next(),T=n[h],O=S.i(T);return C.done||S.i(C.value)!==O?void 0:this.selectPost(e,{renderContextType:t,trackback:r.d.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},S.i(C.value),S.e(C.value),p.a.SharedComments)}Object(o.k)().assertConditionTag(!1,"Selection not found in renderableItems",571777352)}else Object(o.k)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(o.k)().assertConditionTag(!1,"Expected selectedComment",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){var a=b.t(this.commentStore.getState());if(void 0!==a){if(!f.c()){var i=b.d(this.commentStore.getState()),c=this.getSelectedIndex(),d=void 0,l=void 0;if(Object(y.c)(i)){var m=b.b(this.commentStore.getState())[a.selectedCardId];m&&c>0&&(d=a.selectedCardId,l=m[c-1])}else{var g=i[c];if(g.parentId)(h=new s.a(i,c).previous()).done||Object(u.b)(h.value)!==g.parentId||(d=Object(u.b)(h.value),l=h.value.commentId)}return d&&l?this.selectPost(e,{renderContextType:t,trackback:r.d.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},d,l,p.a.SharedComments):void 0}if(n){var v=this.getSelectedIndexFromRenderableItems(n);if(v<0)Object(o.k)().assertConditionTag(!1,"Selection not found in renderableItems",571777353);else{var h,C=n[v],T=S.g(C);if(T)if(!(h=new j.a(n,v).previous()).done&&S.i(h.value)===T)return this.selectPost(e,{renderContextType:t,trackback:r.d.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},S.i(h.value),S.e(h.value),p.a.SharedComments)}}else Object(o.k)().assertConditionTag(!1,"renderableItems must not be undefined",593278859)}else Object(o.k)().assertConditionTag(!1,"Expected selectedComment",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=b.t(this.commentStore.getState());if(n&&!Object(h.j)(n.selectionDetails))return this.selectPost(e,{renderContextType:t,trackback:r.d.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},n.selectedCardId,n.selectedCardId,p.a.SharedComments)},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n=b.k(this.commentStore.getState()),a=Object(y.f)(n)?n:n.filter((function(e){return!e.parentId}));if(0!==a.length&&(0!==t||1!==a.length)){var i;t>a.length?(Object(o.k)().assertConditionTag(!1,"Passed in threadIndex too large.",526660886),i=a.length-1):i=t>=1?t-1:t+1;var c=Object(y.f)(a)?a[i]:a[i].commentId;return Object(k.a)(void 0,Object(D.a)(void 0,{componentType:A.a.Card,id:c,renderContextType:e}),Object(E.a)(void 0,m.selectComment({renderContextType:e,trackback:r.d.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},c,void 0,m.SelectActionType.SelectCard,p.a.SharedComments)))}}},e.prototype.getSelectedIndex=function(){var e=this.commentStore.getState();return Object(v.u)(b.d(e),b.b(e),b.t(e))},e.prototype.getSelectedThreadIndex=function(e){return Object(v.M)(e,b.t(this.commentStore.getState()))},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=b.t(this.commentStore.getState());if(!t)return-1;var n=Object(h.b)(t);return f.V()?e.findIndex((function(e){return S.e(e)===n})):e.findIndex((function(e){return Object(_.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}()},28628:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22371),o=n(28432),a=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object(o.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&r.f.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&r.f.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},28629:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(22377),o=n(28605),a=n(28604),i=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=a.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var r=this.items[n];if(Object(o.a)(r)&&r.commentModel.commentId===t)return r.commentModel}for(n=this.pointer+1;n<this.items.length;++n){r=this.items[n];if(Object(o.a)(r)&&r.commentModel.commentId===t)return r.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&r.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&r.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},28630:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(12708),o=n(28076);function a(e){var t=Object(r.__read)(e,1)[0];return Object(o.a)(t)}},28631:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(12708),o=n(28634),a=n(28632),i=n(28633),c=n(28637),s=n(28639),d=n(28640),u=n(28657),l=n(28661),f=n(28662),m=n(28663),p=n(28664),g=n(28668),v=n(28670),h=n(28671),b=n(28672),C=n(28678);function y(e,t,n,y,T,O,I,S,j){var _=j?[Object(g.b)(j,y)]:[],k=Object(i.a)(o.a.apply(void 0,Object(r.__spreadArray)([s.a,c.a,a.a,p.a,Object(b.a)(y),Object(u.a)(e,y),Object(m.a)(y),Object(v.a)(I),Object(C.a)(t,S),Object(h.a)(O),Object(l.a)(y),Object(f.a)(T)],Object(r.__read)(_),!1))),E=Object(o.d)(d.a,n,k);return I.initialize(E,!!T),E}},28632:function(e,t,n){"use strict";function r(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}var o=r();o.withExtraArgument=r,t.a=o},28633:function(e,t,n){"use strict";var r=n(28634);n.d(t,"a",(function(){return r.c}))},28634:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return c}));var r=n(28635),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},a={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function i(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function c(e,t,n){var o;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(c)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var s=e,d=t,u=[],l=u,f=!1;function m(){l===u&&(l=u.slice())}function p(){if(f)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return d}function g(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(f)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return m(),l.push(e),function(){if(t){if(f)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,m();var n=l.indexOf(e);l.splice(n,1),u=null}}}function v(e){if(!i(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(f)throw new Error("Reducers may not dispatch actions.");try{f=!0,d=s(d,e)}finally{f=!1}for(var t=u=l,n=0;n<t.length;n++){(0,t[n])()}return e}function h(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");s=e,v({type:a.REPLACE})}function b(){var e,t=g;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(p())}return n(),{unsubscribe:t(n)}}})[r.a]=function(){return this},e}return v({type:a.INIT}),(o={dispatch:v,subscribe:g,getState:p,replaceReducer:h})[r.a]=b,o}function s(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function d(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];0,"function"==typeof e[o]&&(n[o]=e[o])}var i,c=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:a.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:a.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+a.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(d){i=d}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,o={},a=0;a<c.length;a++){var d=c[a],u=n[d],l=e[d],f=u(l,t);if(void 0===f){var m=s(d,t);throw new Error(m)}o[d]=f,r=r||f!==l}return(r=r||c.length!==Object.keys(e).length)?o:e}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(o)}));return f({},n,{dispatch:r=m.apply(void 0,a)(n.dispatch)})}}}},28635:function(e,t,n){"use strict";(function(e){var r,o=n(28636);r="undefined"!=typeof self?self:"undefined"!=typeof window||"undefined"!=typeof window?window:e;var a=Object(o.a)(r);t.a=a}).call(this,n(12057)(e))},28636:function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return r}))},28637:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28638),o=function(){return function(e){return function(t){return Object(r.a)((function(){return e(t)}))}}}},28638:function(e,t,n){"use strict";var r=n(11769);n.d(t,"a",(function(){return r.unstable_batchedUpdates}))},28639:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28062),o=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",o=Object(r.k)(r.b.Redux,n),a=e(t);return null==o||o.end(),a}}}},28640:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n(28062);var r=n(28634),o=n(28506),a=n(28641),i=n(28654),c=n(28655),s=n(28656),d=void 0;function u(e,t){void 0===t&&(t=o.a),d||(d=Object(r.b)({paneState:s.a,contentExtensions:i.a,commentState:a.a,filterState:c.a}));var n=d(e,t);return n}},28641:function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var r,o=n(12708),a=n(28062),i=n(28630),c=n(28091),s=n(13057),d=n(28561),u=n(22374),l=n(22377),f=n(22381),m=n(28563),p=n(28583),g=n(28432),v=n(28437),h=n(28642),b=n(28405),C=n(28361),y=n(28309),T=n(28307),O=n(28370),I=n(28643),S=n(28596),j=n(28644),_=n(28595),k=n(28645),E=n(28271),D=n(28272),A=n(28280),P=n(28480),x=n(28506),w=n(28646),R=n(28601),F=n(28647),N=n(28648),M=n(28560),L=n(28649),B=n(28597),V=n(28650),U=n(28598),H=n(28599),q=n(28600),G=n(28589),z=n(28582),W=n(28651),Y=k.a;function K(e,t){void 0===e&&(e=Object(W.a)(Y)),void 0===t&&(t=x.a);var n=function(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return function(e,t){var n=M.P(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object(o.__assign)(Object(o.__assign)({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return Object(z.e)(e)?Object(s.b)((function(e){!function(e,t){var n,r;if(!t.payload.changes.length)return;var i,c=M.G(e.draftState,!0);try{for(var s=Object(o.__values)(t.payload.changes),d=s.next();!d.done;d=s.next())switch((i=d.value).type===u.b.Load&&(i=void 0!==e.postViewState[i.model.commentId]?Object(o.__assign)(Object(o.__assign)({},i),{type:u.b.Modify}):Object(o.__assign)(Object(o.__assign)({},i),{type:u.b.Insert})),i.type){case u.b.Insert:w.b(e,i,c),void 0===e.createdCommentLie&&(c=void 0);break;case u.b.Modify:w.c(e,i);break;case u.b.Delete:w.a(e,i,c)}}catch(m){n={error:m}}finally{try{d&&!d.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}F.d(e,2),e.selectedComment&&!Object(U.l)(e.draftState)&&(e.cardViewState[e.selectedComment.selectedCardId]?Object(G.j)(e.selectedComment.selectionDetails)&&!e.postViewState[e.selectedComment.selectionDetails.selectedPostId]&&(e.selectedComment=M.m(e.selectedComment.selectedCardId)):e.selectedComment=void 0);e.expandedComments=M.V(e.expandedComments,e.cardViewState,e.draftState);var l=F.b(e,a.d.reserveTag(520646682));if(!l)return;var f=L.a(l.tasks,l.historyRecordViewState,t.payload,l.localizationDetails);(null==f?void 0:f.updatedTasks)&&(e.tasks=f.updatedTasks);(null==f?void 0:f.updatedHistoryRecordViewState)&&(e.historyRecordViewState=f.updatedHistoryRecordViewState)}(e,t)}))(e):function(e,t){var n,s,d,f,m,p,v;if(!t.payload.changes.length)return e;var h,b={commentData:Object(o.__spreadArray)([],Object(o.__read)(e.commentData),!1),cardViewState:Object(o.__assign)({},e.cardViewState),postViewState:Object(o.__assign)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},C=e.createdCommentLie,y=!!M.G(e.draftState,!0),T=null==C?void 0:C.flatIndex,O=e.modelCapabilities.virtualized;try{for(var I=Object(o.__values)(t.payload.changes),S=I.next();!S.done;S=I.next())if((h=S.value).type===u.b.Load&&(h=void 0!==b.postViewState[h.model.commentId]?Object(o.__assign)(Object(o.__assign)({},h),{type:u.b.Modify}):Object(o.__assign)(Object(o.__assign)({},h),{type:u.b.Insert})),h.type===u.b.Insert){if((_=h.model.parentId)&&(b.cardViewState[_]?b.cardViewState[_]=Object(o.__assign)(Object(o.__assign)({},b.cardViewState[_]),{pending:B.a.None}):null===(m=null===(f=Object(c.k)())||void 0===f?void 0:f.logDiagnosticTrace)||void 0===m||m.call(f,Object(i.a)(r||(r=Object(o.__makeTemplateObject)(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),a.d.reserveTag(526960065),c.h.Warning,c.c.ProductServiceUsage,Object(c.l)(c.g.ReviewedAsNotNecessary))),b.commentData.splice(h.index,0,h.model),h.tempId){if(!_)(j={})[h.model.commentId]=M.i(h.tempId),b.cardViewState=Object(o.__assign)(Object(o.__assign)({},M.Z(b.cardViewState,h.tempId)),j);b.postViewState=Object(o.__assign)(Object(o.__assign)({},M.Z(b.postViewState,h.tempId)),M.y([h.model],b.expandedComments,e.localizationDetails)),b.draftState.committedLieId===h.tempId&&(b.draftState=Object(o.__assign)(Object(o.__assign)({},b.draftState),{committedLieId:void 0}),T=void 0),b.selectedComment&&b.selectedComment.selectedCardId===h.tempId&&(b.selectedComment=M.m(Object(g.b)(h.model)),h.model.parentId||(b.expandedComments=M.a(b.expandedComments,b.selectedComment,b.draftState)))}else{var j;if(Object(c.k)().assertConditionTag(!b.postViewState[h.model.commentId],"Received insert for existing comment",594122589),!_)(j={})[h.model.commentId]=M.i(void 0),b.cardViewState=Object(o.__assign)(Object(o.__assign)({},b.cardViewState),j);b.postViewState=Object(o.__assign)(Object(o.__assign)({},b.postViewState),M.y([h.model],b.expandedComments,e.localizationDetails))}y&&void 0!==T&&h.index<=T&&T++}else if(h.type===u.b.Modify){if((A=b.commentData[h.index]).commentId===h.model.commentId){b.commentData[h.index]=h.model;var _=Object(g.b)(h.model),k=b.cardViewState[_];k?b.cardViewState[_]=Object(o.__assign)(Object(o.__assign)({},k),{pending:B.a.None,loadState:k.loadState.state!==H.a.Loading&&O?k.loadState:{state:H.a.Loaded}}):(Object(c.k)().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",527962186),b.cardViewState[_]=M.i(void 0,O?H.a.Placeholder:void 0));var E=A.displayDate===h.model.displayDate&&A.date===h.model.date?b.postViewState[h.model.commentId].displayDate:M.o(h.model.date,h.model.displayDate,e.localizationDetails.dataCulture);if(b.postViewState=Object(o.__assign)(Object(o.__assign)({},b.postViewState),((d={})[h.model.commentId]=Object(o.__assign)(Object(o.__assign)({},b.postViewState[h.model.commentId]),{pending:q.a.None,displayDate:E}),d)),h.model.commentFlags&l.a.Resolved&&!(A.commentFlags&l.a.Resolved)){var D=b.draftState;b.selectedComment&&b.selectedComment.selectedCardId===h.model.commentId&&(b.selectedComment=M.m(b.selectedComment.selectedCardId)),b.draftState=M.S(b.draftState,h.model.commentId,b.commentData),Object(R.b)(D,b.draftState,1,2,a.d.reserveTag(539297114)),(null==k?void 0:k.loadState.state)===H.a.Loaded&&(b.expandedComments=M.U(h.model.commentId,b.expandedComments,b.draftState,b.selectedComment))}}else Object(c.k)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(a.i)("changeIndex did not match comment for ".concat(h.model.commentId))}else if(h.type===u.b.Delete){var A;if((A=b.commentData[h.index]).commentId===h.model.commentId&&b.commentData.splice(h.index,1),b.highlightedCommentId===h.model.commentId&&(b.highlightedCommentId=void 0),b.topVisibleThreadId===h.model.commentId&&(b.topVisibleThreadId=void 0),b.cardViewState=M.Z(b.cardViewState,h.model.commentId),b.postViewState=M.Z(b.postViewState,h.model.commentId),h.model.commentId===b.selectedThreadIdBeforeCommentSession){var P=h.index;b.commentData.length?(P>=b.commentData.length&&(P=b.commentData.length-1),b.selectedThreadIdBeforeCommentSession=Object(g.b)(b.commentData[P])):b.selectedThreadIdBeforeCommentSession=void 0}y&&void 0!==T&&h.index<T&&T--}}catch(w){n={error:w}}finally{try{S&&!S.done&&(s=I.return)&&s.call(I)}finally{if(n)throw n.error}}y&&(void 0===T?C=void 0:C&&T!==C.flatIndex&&(C=Object(o.__assign)(Object(o.__assign)({},C),{flatIndex:T})));b.draftState=M.db(b.draftState,e.cardViewState,b.cardViewState,e.postViewState,b.postViewState,2),b.selectedComment&&!Object(U.l)(b.draftState)&&(b.cardViewState[b.selectedComment.selectedCardId]?Object(G.j)(b.selectedComment.selectionDetails)&&!b.postViewState[b.selectedComment.selectionDetails.selectedPostId]&&(b.selectedComment=M.m(b.selectedComment.selectedCardId)):b.selectedComment=void 0);var x=L.a(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(o.__assign)(Object(o.__assign)({},e),{createdCommentLie:C,draftState:b.draftState,selectedComment:b.selectedComment,expandedComments:M.V(b.expandedComments,b.cardViewState,b.draftState),commentData:b.commentData,cardViewState:b.cardViewState,postViewState:b.postViewState,highlightedCommentId:b.highlightedCommentId,topVisibleThreadId:b.topVisibleThreadId,selectedThreadIdBeforeCommentSession:b.selectedThreadIdBeforeCommentSession,tasks:null!==(p=null==x?void 0:x.updatedTasks)&&void 0!==p?p:e.tasks,historyRecordViewState:null!==(v=null==x?void 0:x.updatedHistoryRecordViewState)&&void 0!==v?v:e.historyRecordViewState})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,r,a,i=e.modelCapabilities.virtualized,c=M.Q(e,t.payload.commentData,i,!!t.payload.filteringEnabled);a=M.j(t.payload.commentData,i?H.a.Placeholder:H.a.Loaded);var s=L.b(t.payload.tasks,e.localizationDetails);return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},e),c),{cardViewState:Object(o.__assign)(Object(o.__assign)({},e.cardViewState),a),postViewState:Object(o.__assign)(Object(o.__assign)({},e.postViewState),M.y(t.payload.commentData,c.expandedComments,e.localizationDetails)),tasks:null!==(n=null==s?void 0:s.updatedTasks)&&void 0!==n?n:e.tasks,historyRecordViewState:null!==(r=null==s?void 0:s.updatedHistoryRecordViewState)&&void 0!==r?r:e.historyRecordViewState})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){if(!e.modelCapabilities.virtualized)throw new E.a("virtualizeCommentsReducer requires virtualization",a.d.reserveTag(589103643),-2130957500);var n=Object(j.b)(t.payload.threadInfo.map((function(e){return e.threadId}))),r=M.Q(e,n,!0,!!t.payload.filteringEnabled);return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},e),r),{cardViewState:Object(o.__assign)(Object(o.__assign)({},e.cardViewState),M.N(t.payload.threadInfo)),postViewState:Object(o.__assign)(Object(o.__assign)({},e.postViewState),M.y(n,r.expandedComments,e.localizationDetails))})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){var n;if(!Object(U.c)(e.draftState))return e;var r,a=M.G(e.draftState);if(!a)return e;var i=!1;(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==a?r=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(r={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},i=!0);var c=M.T(e.draftState,a);return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},e),Object(z.e)(e)?{commentThreadIds:M.Y(e.commentThreadIds,a),cardPostIds:M.Z(e.cardPostIds,a),postData:M.Z(e.postData,a)}:{}),{createdCommentLie:void 0,selectedComment:r,expandedComments:r&&i?M.a(e.expandedComments,r,c):M.R(e.expandedComments,r,c),cardViewState:M.Z(e.cardViewState,a),postViewState:M.Z(e.postViewState,a),selectedThreadIdBeforeCommentSession:void 0,draftState:c})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){var n=M.A(e,t.payload.commentId),r=M.ab(e.draftState,t.payload.commentId);return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:n,expandedComments:M.R(e.expandedComments,n,r),selectedThreadIdBeforeCommentSession:void 0,draftState:r})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){var n=M.T(e.draftState,t.payload.commentId);return Object(o.__assign)(Object(o.__assign)({},e),{expandedComments:M.R(e.expandedComments,e.selectedComment,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"COLLAPSE_CARD":return function(e,t){var n=M.K(e.draftState);if((null==n?void 0:n.threadId)===t.payload.cardId)return e;var r=M.D(t.payload.cardId,e.selectedComment,e.draftState);return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:r,expandedComments:M.U(t.payload.cardId,e.expandedComments,e.draftState,r)})}(e,t);case"SELECT_COMMENT":return function(e,t){var n=e.selectedComment;if(!M.bb(e.draftState,n,t))return e;if(!t.payload.selectedCard)throw new E.a(D.d,a.d.reserveTag(589103644),-2130957536);var r=M.gb(e.selectedComment,t),i=Object(P.shouldSelectActionExpandCard)(t.payload.selectType)?M.a(e.expandedComments,r,e.draftState):M.R(e.expandedComments,r,e.draftState);return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:r,expandedComments:i})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){var n;return Object(o.__assign)(Object(o.__assign)({},e),{cardViewState:Object(o.__assign)(Object(o.__assign)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(o.__assign)(Object(o.__assign)({},e.cardViewState[t.payload.commentId]),{pending:B.a.Card,loadState:{state:H.a.Loaded}}),n)),selectedComment:M.B(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return Object(z.e)(e)?Object(s.b)((function(e){!function(e,t){var n=F.b(e,a.d.reserveTag(524031011));if(!n)return;var r=!1,o=!1,i=!1,c=!1,s=n.selectedComment&&Object(G.j)(n.selectedComment.selectionDetails),d=!1;e.commentThreadIds=[],e.cardPostIds={},e.postData={},e.cardViewState={},e.postViewState={},t.payload.comments.forEach((function(t){if(t.commentId===n.highlightedCommentId&&(r=!0),t.commentId===n.topVisibleThreadId&&(o=!0),n.selectedComment&&(t.commentId===n.selectedComment.selectedCardId&&(i=!0),n.selectedComment.selectedCardId===Object(g.b)(t)&&Object(G.j)(n.selectedComment.selectionDetails)&&n.selectedComment.selectionDetails.selectedPostId===t.commentId&&(c=!0)),t.commentId in n.postData)Object(g.a)(t)&&N.b(e,t.commentId),N.c(e,t.commentId),F.c(e,t,n.postData[t.commentId],1),n.selectedThreadIdBeforeCommentSession&&n.selectedThreadIdBeforeCommentSession===t.commentId&&(d=!0);else{if(Object(g.a)(t)){var a=t.commentId,s=n.modelCapabilities.virtualized?{state:H.a.Placeholder,initialItemCount:1}:{state:H.a.Loaded};e.cardViewState[t.commentId]=M.v(a,s)}e.postViewState[t.commentId]=M.k(t.displayDate)}F.a(e,t)})),r||(e.highlightedCommentId=void 0);o||(e.topVisibleThreadId=void 0);!d&&n.selectedThreadIdBeforeCommentSession&&N.d(e);N.a(e),e.draftState.committedLieId=void 0;var u=M.G(e.draftState);u&&e.selectedComment&&u===e.selectedComment.selectedCardId&&(i=!0);F.d(e,1),Object(U.l)(e.draftState)||(i?s&&!c&&e.selectedComment&&!n.modelCapabilities.virtualized&&(e.selectedComment.selectionDetails=M.l()):e.selectedComment=void 0);e.pendingCommentLoad=void 0;var l=L.c(n.tasks,n.historyRecordViewState,t.payload,n.localizationDetails);(null==l?void 0:l.updatedTasks)&&(e.tasks=l.updatedTasks);(null==l?void 0:l.updatedHistoryRecordViewState)&&(e.historyRecordViewState=l.updatedHistoryRecordViewState);var f=M.V(e.expandedComments,e.cardViewState,e.draftState);f!==e.expandedComments&&(e.expandedComments=f)}(e,t)}))(e):function(e,t){var n,r,i,s,d={},u={},f=e.selectedComment,m=e.expandedComments,p=f&&Object(G.j)(f.selectionDetails),v=!1,h=!1,b=!1,C=e.selectedThreadIdBeforeCommentSession,y=e.draftState,T=e.modelCapabilities.virtualized,O=null===(n=M.K(y))||void 0===n?void 0:n.threadId,I={};e.commentData.forEach((function(e){I[e.commentId]=e}));var S=!1,j=!1;t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(S=!0),n.commentId===e.topVisibleThreadId&&(j=!0),f&&(n.commentId===f.selectedCardId&&(h=!0),f.selectedCardId===Object(g.b)(n)&&Object(G.j)(f.selectionDetails)&&f.selectionDetails.selectedPostId===n.commentId&&(v=!0)),n.commentId in I){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(c.k)().assertConditionTag(e.cardViewState[n.commentId].pending!==B.a.Delete,"Card pending delete remained after a reload.",593762527);var r=e.cardViewState[n.commentId];if(r)if(r.pending!==B.a.None||T){var i=r.loadState;u[n.commentId]=Object(o.__assign)(Object(o.__assign)({},r),{pending:B.a.None,loadState:i.state===H.a.Placeholder?i:{state:T?H.a.NeedsReload:H.a.Loaded}})}else u[n.commentId]=r;else Object(c.k)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default.",527958879),u[n.commentId]=M.i(void 0,T?H.a.NeedsReload:H.a.Loaded)}if(Object(c.k)().assertConditionTag(!e.postViewState[n.commentId]||e.postViewState[n.commentId].pending!==q.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]?e.postViewState[n.commentId].pending!==q.a.None?d[n.commentId]=Object(o.__assign)(Object(o.__assign)({},e.postViewState[n.commentId]),{pending:q.a.None}):d[n.commentId]=e.postViewState[n.commentId]:d[n.commentId]=M.k(void 0),n.commentFlags&l.a.Resolved&&(!I[n.commentId]||!(I[n.commentId].commentFlags&l.a.Resolved))){if(f&&f.selectedCardId===n.commentId&&(f=M.m(f.selectedCardId)),n.commentId===O){var s=y;y=M.S(y,n.commentId,t.payload.comments),Object(R.b)(s,y,1,1,a.d.reserveTag(539297115))}m=M.U(n.commentId,m,y,f)}C&&C===n.commentId&&(b=!0)}else{if(""===n.parentId){var p=n.commentId,_=T?{state:H.a.Placeholder,initialItemCount:1}:{state:H.a.Loaded};u[n.commentId]=M.v(p,_)}d[n.commentId]=M.k(m.includes(Object(g.b)(n))?M.o(n.date,n.displayDate,e.localizationDetails.dataCulture):n.displayDate)}})),s=M.b(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),y=Object(o.__assign)(Object(o.__assign)({},y),{committedLieId:void 0});var _=M.G(y);_&&(f&&_===f.selectedCardId&&(h=!0),u[_]=e.cardViewState[_],d[_]=e.postViewState[_]);y=M.db(y,e.cardViewState,u,e.postViewState,d,1),Object(U.l)(y)||(h?p&&!v&&f&&!T&&(f={selectedCardId:f.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):f=void 0);if(!b&&C){var k=e.commentData.findIndex((function(e){return e.commentId===C}));if(k<0&&(Object(c.k)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),k=0),t.payload.comments.length){k>=t.payload.comments.length&&(k=t.payload.comments.length-1);var E=t.payload.comments[k];C=Object(g.b)(E)}else C=void 0}var D=L.c(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(o.__assign)(Object(o.__assign)({},e),{draftState:y,commentData:Object(o.__spreadArray)([],Object(o.__read)(t.payload.comments),!1),cardViewState:u,postViewState:d,selectedComment:f,expandedComments:M.V(m,u,y),pendingCommentLoad:void 0,highlightedCommentId:S?e.highlightedCommentId:void 0,topVisibleThreadId:j?e.topVisibleThreadId:void 0,createdCommentLie:s,selectedThreadIdBeforeCommentSession:C,tasks:null!==(r=null==D?void 0:D.updatedTasks)&&void 0!==r?r:e.tasks,historyRecordViewState:null!==(i=null==D?void 0:D.updatedHistoryRecordViewState)&&void 0!==i?i:e.historyRecordViewState})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){var n,r=Object(o.__assign)(Object(o.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(o.__assign)(Object(o.__assign)({},e.cardViewState[t.payload.commentId]),{pending:B.a.Card}),n));return Object(o.__assign)(Object(o.__assign)({},e),{cardViewState:r})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){var n,r=Object(o.__assign)(Object(o.__assign)({},e.postViewState),((n={})[t.payload.commentId]=Object(o.__assign)(Object(o.__assign)({},e.postViewState[t.payload.commentId]),{pending:q.a.Delete}),n));return Object(o.__assign)(Object(o.__assign)({},e),{postViewState:r})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){var n,r=Object(o.__assign)(Object(o.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(o.__assign)(Object(o.__assign)({},e.cardViewState[t.payload.commentId]),{pending:B.a.Delete}),n));return Object(o.__assign)(Object(o.__assign)({},e),{cardViewState:r})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){var n=Object(o.__assign)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){if(n[e]){var t=n[e].loadState;n[e]=Object(o.__assign)(Object(o.__assign)({},n[e]),{loadState:{state:H.a.Loading,initialItemCount:M.O(t)?t.initialItemCount:1}})}else Object(c.k)().assertConditionTag(!1,"Loading an unexpected thread?",528021317)})),Object(o.__assign)(Object(o.__assign)({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){var n,r,i,s,d,u,l,f,m,h,b;if(M.H(e.draftState))throw new E.a("Draft already active!",a.d.reserveTag(589103640),-2130957551);var C=e.selectedThreadIdBeforeCommentSession,y=t.payload.draftDetails,T=null===(m=null===(f=t.payload.rehydratedDraftParams)||void 0===f?void 0:f.inCurrentContext)||void 0===m||m,I=null===(b=null===(h=t.payload.rehydratedDraftParams)||void 0===h?void 0:h.isDraftEmpty)||void 0===b||b;switch(y.sessionConfiguration.sessionType){case"CREATE":var S=y.sessionConfiguration.draftId,j=Object(o.__assign)(Object(o.__assign)({},M.e(S)),{author:y.author,anchorHintText:y.anchorHintText}),k=T?M.C(Object(z.a)(e),y):e.selectedComment,A=Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts),(n={},n[S]={commentDraft:y,isDraftEmpty:I,isInCurrentContext:T,pendingState:U.a.None,renderContextType:t.payload.draftRenderContextType,threadId:S},n)),cardIdToDraftIdMap:Object(o.__assign)(Object(o.__assign)({},e.draftState.cardIdToDraftIdMap),(r={},r[S]=S,r)),pendingDraft:void 0}),P={};if(Object(z.e)(e)){var x=M.L(e.commentThreadIds,e.cardPostIds,y.insertIndex),w=e.commentThreadIds,R=e.cardPostIds;x>=0&&(w=Object(o.__spreadArray)(Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(w.slice(0,x)),!1),[S],!1),Object(o.__read)(w.slice(x)),!1),R=Object(o.__assign)(Object(o.__assign)({},e.cardPostIds),((i={})[S]=[S],i))),P={commentThreadIds:w,cardPostIds:R,postData:Object(o.__assign)(Object(o.__assign)({},e.postData),(s={},s[S]=j,s))}}return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},e),P),{createdCommentLie:{flatIndex:y.insertIndex,newComment_deprecated:j},cardViewState:Object(o.__assign)(Object(o.__assign)({},e.cardViewState),M.p(j)),postViewState:Object(o.__assign)(Object(o.__assign)({},e.postViewState),M.q(j)),selectedComment:k,expandedComments:M.a(e.expandedComments,k,A),selectedThreadIdBeforeCommentSession:C,draftState:A});case"EDIT":case"REPLY":if(!Object(v.b)(y.sessionConfiguration)&&!Object(v.c)(y.sessionConfiguration))throw Object(c.k)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new E.a(D.c,a.d.reserveTag(589103642),-2130957532);var F=void 0,N=Object(v.c)(y.sessionConfiguration)&&(!e.selectedComment||y.sessionConfiguration.threadId!==e.selectedComment.selectedCardId),L=p.e(y.sessionConfiguration)&&(!e.selectedComment||!Object(G.j)(e.selectedComment.selectionDetails)||y.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId);F=T?!e.selectedComment||N||L?M.C(Object(z.a)(e),y):Object(o.__assign)(Object(o.__assign)({},e.selectedComment),{selectionDetails:Object(o.__assign)(Object(o.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedComment;var B=e.draftState.cardIdToDraftIdMap,V=e.draftState.postIdToDraftIdMap,H="",q=!1,W=!1;if(p.f(y.sessionConfiguration))B=Object(o.__assign)(Object(o.__assign)({},B),((d={})[y.sessionConfiguration.threadId]=y.sessionConfiguration.draftId,d)),H=y.sessionConfiguration.threadId,W=I;else if(p.e(y.sessionConfiguration)){var Y=y.sessionConfiguration.commentId;if(V=Object(o.__assign)(Object(o.__assign)({},V),((u={})[Y]=y.sessionConfiguration.draftId,u)),q=!0,Object(z.e)(e)){var K=e.postData[Y],X=Object(_.e)(K.commentBody);W=0===X.length||"web"===Object(O.a)()&&"\n"===X,H=Object(g.b)(K)}else e.commentData.some((function(e){if(e.commentId===Y){var t=Object(_.e)(e.commentBody);return W=0===t.length||"web"===Object(O.a)()&&"\n"===t,H=Object(g.b)(e),!0}return!1}));!H&&y.sessionConfiguration.rootCommentId&&(H=y.sessionConfiguration.rootCommentId)}else Object(a.m)(y.sessionConfiguration);var Q=Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts),(l={},l[y.sessionConfiguration.draftId]={commentDraft:y,isDraftEmpty:W,isInCurrentContext:T,pendingState:U.a.None,renderContextType:t.payload.draftRenderContextType,threadId:H},l)),cardIdToDraftIdMap:B,postIdToDraftIdMap:V,pendingDraft:void 0});return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:F,expandedComments:q?M.a(e.expandedComments,F,Q):M.R(e.expandedComments,F,Q),selectedThreadIdBeforeCommentSession:C,draftState:Q,createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return Object(c.k)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(o.__assign)(Object(o.__assign)({},e.selectedComment),{selectionDetails:Object(o.__assign)(Object(o.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});var r=Object(o.__assign)(Object(o.__assign)({},e.draftState),{pendingDraft:void 0});return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:n,expandedComments:M.R(e.expandedComments,n,r),selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:r})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){var n;if(e.createdCommentLie)return Object(c.k)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(p.f(t.payload.params))n=t.payload.params.threadId;else if(p.e(t.payload.params)){var r=t.payload.params.commentId,a=Object(z.b)(Object(z.a)(e),r);if(!a)return Object(c.k)().assertConditionTag(!1,"Could not lock selection on missing comment",593764357),e;n=Object(g.b)(a)}else n=Object(T.y)();var i=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(i=e.selectedComment.selectedCardId);var s=Object(o.__assign)(Object(o.__assign)({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),d=M.F(e.selectedComment,t,n),u=Object(G.j)(d.selectionDetails)?M.a(e.expandedComments,d,s):e.expandedComments;return Object(o.__assign)(Object(o.__assign)({},e),{selectedThreadIdBeforeCommentSession:i,selectedComment:d,expandedComments:u,draftState:s})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){var n,r,i,s=Object(U.h)(),d={},u={},l=void 0,m=void 0,p=void 0,g=void 0,v=M.G(e.draftState),h=!!e.createdCommentLie;i=t.payload.contextDetails?Object(o.__assign)(Object(o.__assign)({},Object(V.a)(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:f.a.Unknown,isReadOnly:A.E()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var b,C=t.payload.contextDrafts;if(C){var y=M.W(e.draftState);if(Object(U.e)(y)>0){var T={},O=void 0,I=void 0,S=!A.X();if(Object(U.f)(y).forEach((function(n){var r,a,i=C.find((function(e){return e.draftId===n}));T[n]=Object(o.__assign)(Object(o.__assign)({},y.drafts[n]),{isInCurrentContext:!!i}),v===n&&(h=!!i,i&&(O=i.insertIndex,I=i.anchorHintText,(null===(r=t.payload.contextDetails)||void 0===r?void 0:r.selectedCommentId)===v&&(l=M.m(v)))),S||l||!i||T[n].threadId!==(null===(a=e.selectedComment)||void 0===a?void 0:a.selectedCardId)||(S=!0)})),s=Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:T}),m=e.createdCommentLie,p=v?Object(z.e)(e)?e.postData[v]:null==m?void 0:m.newComment_deprecated:void 0,S&&(l=e.selectedComment),m&&v&&h){Object(c.k)().assertConditionTag(void 0!==O,"Index unknown for lie in latest context",587309136);var j=null!=O?O:0;j!==m.flatIndex&&(m=Object(o.__assign)(Object(o.__assign)({},m),{flatIndex:j})),p&&void 0!==I&&I!==m.newComment_deprecated.anchorHintText&&(p=Object(o.__assign)(Object(o.__assign)({},p),{anchorHintText:I}),m=Object(o.__assign)(Object(o.__assign)({},m),{newComment_deprecated:p})),d=M.w(v),u=M.x(v),m.flatIndex>-1&&(d[v].pending=B.a.None,u[v].pending=q.a.None)}}else g=null!=g?g:-1}else g=null!=g?g:4;i.isReadOnly&&(h&&(m=void 0),s=M.X(s),g=null!=g?g:5);if(Object(R.b)(e.draftState,s,g,4,a.d.reserveTag(539297116)),Object(z.e)(e)){var _=[],k={},E={};m&&v&&p&&((n={})[v]=p,E=n,h&&!m.flatIndex&&(_=[v],(r={})[v]=[v],k=r)),b={commentThreadIds:_,cardPostIds:k,postData:E}}else b={commentData:[]};return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},e),b),{cardViewState:d,postViewState:u,selectedComment:l,expandedComments:M.R(e.expandedComments,l,s),pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfLoadedComments:0,numberOfLoadedThreads:0,numberOfTotalComments:t.payload.numberOfComments,numberOfTotalThreads:t.payload.numberOfThreads,selectedThreadIndex:void 0!==t.payload.selectedThreadIndex&&t.payload.selectedThreadIndex<t.payload.numberOfThreads?t.payload.selectedThreadIndex:void 0},contextState:i,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?M.P(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:m,selectedThreadIdBeforeCommentSession:void 0,draftState:s,tasks:{},historyRecordViewState:{}})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){var n,r=t.payload,a=r.commentId,i=r.lowFidelityWarningType,s=Object(z.b)(Object(z.a)(e),a);if(!s)return Object(c.k)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(U.d)(e.draftState))return Object(c.k)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var d=e.expandedComments;i===G.a.DeleteThread?n={selectedCardId:a,selectionDetails:{lowFidelityWarningType:i}}:(n={selectedCardId:Object(g.b)(s),selectionDetails:{selectedPostId:a,lowFidelityWarningType:i}},d=M.a(d,n,e.draftState));return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:n,expandedComments:d})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){var n=e.selectedComment;if(!n||void 0===n.selectionDetails.lowFidelityWarningType)return e;return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:Object(o.__assign)(Object(o.__assign)({},n),{selectionDetails:{lowFidelityWarningType:void 0}})})}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){if(!M.bb(e.draftState,e.selectedComment,t))return e;return Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:void 0})}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object(o.__assign)(Object(o.__assign)({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){var n=!1,r=Object(o.__assign)({},e.contextState),i=e.createdCommentLie,c=e.draftState,s=void 0;void 0!==t.payload.contextState.commentThreadCounts&&(n=!0,r.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n=!0,r.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n=!0,r.isReadOnly=t.payload.contextState.isReadOnly,r.isReadOnly&&(c=M.X(e.draftState),s=null!=s?s:5,M.G(e.draftState,!0)&&(i=void 0)));if(!n)return e;return Object(R.b)(e.draftState,c,s,5,a.d.reserveTag(539297117)),Object(o.__assign)(Object(o.__assign)({},e),{draftState:c,contextState:r,createdCommentLie:i})}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){var n;if(!Object(U.b)(e.draftState))return Object(c.k)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var r=e.draftState,a=M.K(e.draftState);a&&(r=Object(o.__assign)(Object(o.__assign)({},r),{drafts:Object(o.__assign)(Object(o.__assign)({},r.drafts),(n={},n[a.commentDraft.sessionConfiguration.draftId]=Object(o.__assign)(Object(o.__assign)({},a),{pendingState:U.a.Commit}),n))}));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:r})}(e);case"COMMIT_FAILURE":return function(e,t){var n;if(!Object(U.i)(e.draftState))return Object(c.k)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var r=e.draftState,a=M.K(e.draftState);a&&(r=Object(o.__assign)(Object(o.__assign)({},r),{drafts:Object(o.__assign)(Object(o.__assign)({},r.drafts),(n={},n[a.commentDraft.sessionConfiguration.draftId]=Object(o.__assign)(Object(o.__assign)({},a),{pendingState:U.a.None,savedDraftContent:void 0!==t.payload.commitText?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:a.savedDraftContent}),n))}));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:r})}(e,t);case"BEGIN_PROCESSING_DISCARD":return function(e){var t;if(!Object(U.b)(e.draftState)&&!Object(G.g)(e.selectedComment))return Object(c.k)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.draftState,r=M.K(e.draftState);r&&(n=Object(o.__assign)(Object(o.__assign)({},n),{drafts:Object(o.__assign)(Object(o.__assign)({},n.drafts),(t={},t[r.commentDraft.sessionConfiguration.draftId]=Object(o.__assign)(Object(o.__assign)({},r),{pendingState:U.a.Discard}),t))}));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:n})}(e);case"CANCEL_DISCARD":return function(e){var t;if(!Object(U.j)(e.draftState))return Object(c.k)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.draftState,r=M.K(e.draftState);r&&(n=Object(o.__assign)(Object(o.__assign)({},n),{drafts:Object(o.__assign)(Object(o.__assign)({},n.drafts),(t={},t[r.commentDraft.sessionConfiguration.draftId]=Object(o.__assign)(Object(o.__assign)({},r),{pendingState:U.a.None}),t))}));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:n})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(o.__assign)(Object(o.__assign)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object(o.__assign)(Object(o.__assign)({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){var n=M.H(e.draftState);if(void 0===n)return Object(c.k)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){var n;if(!e.createdCommentLie)return e;var r=M.G(e.draftState);if(!r)return e;var i=t.temporaryCommentId;if(!i)throw Object(c.k)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new E.a(D.c,a.d.reserveTag(589103637),-2130957545);var s=Object(z.e)(e)?e.postData[r]:e.createdCommentLie.newComment_deprecated;if(Object(z.e)(e)&&!s)return Object(c.k)().assertConditionTag(!1,"Did not find model for draft thread on commit",527251200),e;var d=Object(o.__assign)(Object(o.__assign)({},s),{commentId:i,commentBody:t.commentBody}),u=Object(o.__assign)(Object(o.__assign)({},e.cardViewState),M.w(i)),l=Object(o.__assign)(Object(o.__assign)({},e.postViewState),M.x(i)),f=e.selectedComment&&{selectedCardId:i,selectionDetails:{lowFidelityWarningType:void 0}},m=M.T(e.draftState,r);return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:f,expandedComments:M.a(e.expandedComments,f,m)}),Object(z.e)(e)?{postData:Object(o.__assign)(Object(o.__assign)({},e.postData),(n={},n[r]=d,n))}:{createdCommentLie:Object(o.__assign)(Object(o.__assign)({},e.createdCommentLie),{newComment_deprecated:d})}),{cardViewState:u,postViewState:l,selectedThreadIdBeforeCommentSession:void 0,draftState:Object(o.__assign)(Object(o.__assign)({},m),{committedLieId:i})})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new E.a(D.d,a.d.reserveTag(589103638),-2130957536);var r=Object(o.__assign)(Object(o.__assign)({},e.cardViewState),((n={})[t.parentId]=Object(o.__assign)(Object(o.__assign)({},e.cardViewState[t.parentId]),{pending:B.a.Editor,loadState:{state:H.a.Loaded}}),n)),i=M.m(t.parentId),c=M.T(e.draftState,t.parentId);return Object(o.__assign)(Object(o.__assign)({},e),{cardViewState:r,selectedComment:i,expandedComments:M.R(e.expandedComments,i,c),selectedThreadIdBeforeCommentSession:void 0,draftState:c})}(e,t.payload.data);case"EDIT":return function(e,t){var n,r=M.A(e,t.commentId),a=Object(o.__assign)(Object(o.__assign)({},e.postViewState[t.commentId]),{pending:q.a.Post}),i=M.ab(e.draftState,t.commentId);return Object(o.__assign)(Object(o.__assign)({},e),{postViewState:Object(o.__assign)(Object(o.__assign)({},e.postViewState),(n={},n[t.commentId]=a,n)),selectedComment:r,expandedComments:M.R(e.expandedComments,r,i),selectedThreadIdBeforeCommentSession:void 0,draftState:i})}(e,t.payload.data);default:throw new E.a("Unexpected session type for commit",a.d.reserveTag(589103639),-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{modelCapabilities:Object(o.__assign)(Object(o.__assign)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){var n,r=e.draftState.drafts;if(void 0===r[t.payload.draftId])return Object(c.k)().assertConditionTag(!Object(U.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var a=Object(o.__assign)(Object(o.__assign)({},r),((n={})[t.payload.draftId]=Object(o.__assign)(Object(o.__assign)({},r[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:a})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){var n,r=e.draftState.drafts;if(void 0===r[t.payload.draftId])return Object(c.k)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var a=Object(o.__assign)(Object(o.__assign)({},r),((n={})[t.payload.draftId]=Object(o.__assign)(Object(o.__assign)({},r[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:a})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){var n=M.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===y.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:y.a.None}));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=M.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return Object(S.b)(r.renderContextType)?Object(I.a)(t.payload.viewContainer.containerType):r.renderContextType}));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n,r,a=M.H(e.draftState);if(void 0===a)return Object(c.k)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var i=a.sessionConfiguration.draftId,s=e.draftState.drafts;if(!s[i])return Object(c.k)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var d=s[i].draftWarningState,u=Object(o.__assign)(Object(o.__assign)({},s[i]),{draftWarningState:{warningCounter:d?d.warningCounter+1:0,type:t.payload.draftWarningType}}),l=Object(o.__assign)(Object(o.__assign)({},s),((n={})[i]=u,n)),f=A.X()&&(Object(v.b)(u.commentDraft.sessionConfiguration)||(null===(r=e.selectedComment)||void 0===r?void 0:r.selectedCardId)!==u.threadId)?M.E(u):e.selectedComment,m=Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:l});return Object(o.__assign)(Object(o.__assign)({},e),{draftState:m,selectedComment:f,expandedComments:M.R(e.expandedComments,f,m)})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&h.a.AtMentionKnown?t.payload.modelCapabilityFlags&h.a.AtMentionEnabled?d.b.Enabled:d.b.Disabled:d.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&h.a.NewThread),resolve:!!(t.payload.modelCapabilityFlags&h.a.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&h.a.Virtualized),tasks:t.payload.modelCapabilityFlags&h.a.TasksKnown?t.payload.modelCapabilityFlags&h.a.TasksEnabled?m.a.Enabled:m.a.Disabled:m.a.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&h.a.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&h.a.UIAAnnotationPattern),ContentExtensionHostingDisabled:!!(t.payload.modelCapabilityFlags&h.a.ContentExtensionHostingDisabled)};return Object(o.__assign)(Object(o.__assign)({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){var n,r=M.H(e.draftState);if(void 0===r)return Object(c.k)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var a=r.sessionConfiguration;if(Object(v.b)(a))return e;var i=e.draftState.drafts[a.draftId];if(!i)return Object(c.k)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var s=i.currentMentionees,d={};for(var u in s)d[u]={mentionee:Object(o.__assign)({},s[u].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(u)};var l=i.selectedTaskAssignee;if(l){var f=Object(b.h)(l);d[f]&&d[f].stillInDraft||(l=void 0)}var m=Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts),(n={},n[a.draftId]=Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts[a.draftId]),{currentMentionees:d,selectedTaskAssignee:l}),n))});return Object(o.__assign)(Object(o.__assign)({},e),{draftState:m})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){var n,r,a=M.H(e.draftState);if(void 0===a)return Object(c.k)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var i=a.sessionConfiguration;if(Object(v.b)(i))return e;var s=e.draftState.drafts[i.draftId];if(!s)return Object(c.k)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var d=s.currentMentionees,u=Object(b.h)(t.payload.mentionee);if(d&&d[u])return e;var l={};for(var f in d)l[f]={mentionee:Object(o.__assign)({},d[f].mentionee),stillInDraft:d[f].stillInDraft};l[u]={mentionee:Object(o.__assign)({},t.payload.mentionee),stillInDraft:!0};var m=void 0;e.draftState.drafts[i.draftId].selectedTaskAssignees&&(m=Object(o.__assign)({},e.draftState.drafts[i.draftId].selectedTaskAssignees),Object(b.b)(m,((n={})[u]={mentionee:Object(o.__assign)({},t.payload.mentionee),stillInDraft:!0},n)));var p=Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts),(r={},r[i.draftId]=Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts[i.draftId]),{currentMentionees:l,selectedTaskAssignees:m}),r))});return Object(o.__assign)(Object(o.__assign)({},e),{draftState:p})}(e,t);case"TOGGLE_TASK_ASSIGNER_TYPE":return function(e){var t;if(!A.m())return Object(c.k)().assertConditionTag(!1,"toggleTaskAssigner should not be called unless CommentTasksWithMultiAssign is enabled.",529143576),e;var n=M.K(e.draftState);if(void 0===n)return Object(c.k)().assertConditionTag(!1,"No draft available while initializing selected task assignees.",529143577),e;var r=n.commentDraft,a=n.selectedTaskAssignees,i={};if(void 0===a){if(Object(v.c)(r.sessionConfiguration)){var s=e.tasks[r.sessionConfiguration.threadId];Object(c.k)().assertConditionTag(!!s,"Task not found.",529143616),Object(b.a)(i,s.currentState.assignees)}void 0!==n.currentMentionees&&Object(b.b)(i,n.currentMentionees)}else i=void 0;var d=r.sessionConfiguration.draftId,u=Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts),(t={},t[d]=Object(o.__assign)(Object(o.__assign)({},e.draftState.drafts[d]),{selectedTaskAssignees:i}),t))});return Object(o.__assign)(Object(o.__assign)({},e),{draftState:u})}(e);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){var n;if(A.m())return Object(c.k)().assertConditionTag(!1,"Should not update selectedTaskAssignee if CommentTasksWithMultiAssign is on.",529096909),e;var r=M.H(e.draftState);if(void 0===r)return Object(c.k)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var a=r.sessionConfiguration;if(Object(v.b)(a))return e;var i=a.draftId,s=e.draftState.drafts;if(!s[i])return Object(c.k)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var d=Object(o.__assign)(Object(o.__assign)({},s),((n={})[i]=Object(o.__assign)(Object(o.__assign)({},s[i]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:d})})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEES":return function(e,t){var n,r;if(!A.m())return Object(c.k)().assertConditionTag(!1,"Should not update selectedTaskAssignees if CommentTasksWithMultiAssign is off.",529096910),e;var a=M.H(e.draftState);if(void 0===a)return Object(c.k)().assertConditionTag(!1,"Expected active draft to be present",529143574),e;var i=a.sessionConfiguration;if(Object(v.b)(i))return e;var s=i.draftId,d=e.draftState.drafts;if(!d[s])return Object(c.k)().assertConditionTag(!1,"Expected draft to be present on update selected task assignees",529143575),e;var u=null!==(r=d[s].selectedTaskAssignees)&&void 0!==r?r:{},l=Object(o.__assign)({},u);Object(b.n)(l,t.payload.selectedAssignee);var f=Object(o.__assign)(Object(o.__assign)({},d),((n={})[s]=Object(o.__assign)(Object(o.__assign)({},d[s]),{selectedTaskAssignees:l}),n));return Object(o.__assign)(Object(o.__assign)({},e),{draftState:Object(o.__assign)(Object(o.__assign)({},e.draftState),{drafts:f})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{draftState:M.r(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){var n=Object(o.__assign)(Object(o.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),r=Object(o.__assign)({},e.postViewState);return r[t.payload.commentId]=n,Object(o.__assign)(Object(o.__assign)({},e),{postViewState:r})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){var n=Object(o.__assign)(Object(o.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),r=Object(o.__assign)({},e.postViewState);return r[t.payload.commentId]=n,Object(o.__assign)(Object(o.__assign)({},e),{postViewState:r})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){var n;if(!e.createdCommentLie)return e;if(M.G(e.draftState)!==t.payload.draftId)return Object(c.k)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var r=Object(z.e)(e)?e.postData[t.payload.draftId]:e.createdCommentLie.newComment_deprecated;if(Object(z.e)(e)&&!r)return Object(c.k)().assertConditionTag(!1,"Did not find model for draft thread on update",527251201),e;var a=e.createdCommentLie,i={};if(void 0!==t.payload.insertIndex&&t.payload.insertIndex!==a.flatIndex&&(a=Object(o.__assign)(Object(o.__assign)({},a),{flatIndex:t.payload.insertIndex}),Object(z.e)(e))){var s=M.fb(e.commentThreadIds,e.cardPostIds,t.payload.draftId,a);i=Object(o.__assign)(Object(o.__assign)({},i),{commentThreadIds:s})}if(void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==r.anchorHintText){var d=Object(o.__assign)(Object(o.__assign)({},r),{anchorHintText:t.payload.anchorHintText});if(Object(z.e)(e)){var u=Object(o.__assign)(Object(o.__assign)({},e.postData),((n={})[t.payload.draftId]=d,n));i=Object(o.__assign)(Object(o.__assign)({},i),{postData:u})}else a=Object(o.__assign)(Object(o.__assign)({},a),{newComment_deprecated:d})}return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},e),i),{createdCommentLie:a})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){var n=e.draftState,r=e.selectedComment,a=e.expandedComments;if(t.payload.visibilityState!==C.a.Visible&&!A.r()&&(n=M.W(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var i=M.I(e.draftState);i&&(r=M.m(i),a=M.R(e.expandedComments,r,n))}return n=M.eb(n,(function(n){var r=e.draftState.drafts[n];return M.cb(r.renderContextType,t.payload.visibilityState)})),Object(o.__assign)(Object(o.__assign)({},e),{selectedComment:r,expandedComments:a,draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}(e,t);return function(e,t){var n,r,a=t,i="android"===Object(O.a)(),c=null===(n=a.selectedComment)||void 0===n?void 0:n.selectedCardId,s=M.G(a.draftState);if(Object(z.e)(a)){var d=i&&c&&!a.expandedComments.includes(c)?Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(a.expandedComments),!1),[c],!1):a.expandedComments,u=a.cardPostIds,l=a.postData,f=void 0;d.forEach((function(e){e!==s&&u[e]&&(f=M.f(u[e],null!=f?f:a.postViewState,l,a.localizationDetails))})),f&&(a=Object(o.__assign)(Object(o.__assign)({},a),{postViewState:f}))}else{if(c&&c!==s&&(i?c!==(null===(r=e.selectedComment)||void 0===r?void 0:r.selectedCardId):a.expandedComments.includes(c)&&!e.expandedComments.includes(c)))(m=M.g(c,a.postViewState,a.commentData,a.localizationDetails))&&(a=Object(o.__assign)(Object(o.__assign)({},a),{postViewState:m}));var m,p=M.G(e.draftState);if(p&&p!==s&&(i||a.expandedComments.includes(p)))(m=M.g(p,a.postViewState,a.commentData,a.localizationDetails))&&(a=Object(o.__assign)(Object(o.__assign)({},a),{postViewState:m}))}return a}(e,n)}},28642:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern",e[e.ContentExtensionHostingDisabled=512]="ContentExtensionHostingDisabled"}(r||(r={}))},28643:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28062),o=n(28294),a=n(28309);function i(e){switch(e){case o.b.HalfPane:return a.a.HalfPane;case o.b.FullPane:return a.a.FullPane;default:Object(r.m)(e)}}},28644:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(12708),o=n(28430),a=n(28560),i=n(28582);function c(e,t){for(var n=null==t?void 0:t(),r=[],a=0,i=void 0;a<e.length;){if(e[a].type===o.a.Thread){var c=e[a].id;i=c,r.push(d(c,void 0,n))}else r.push(d(e[a].id,i,n));a++}return r}function s(e){return e.map((function(e){return d(e,void 0,void 0)}))}function d(e,t,n){var o=void 0;return n&&(o=Object(i.b)(Object(i.a)(n),e)),o||Object(r.__assign)(Object(r.__assign)({},Object(a.e)(e)),{parentId:null!=t?t:""})}},28645:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={isRightToLeft:!1,dataCulture:"",uiCulture:""}},28646:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return v}));var r,o=n(12708),a=n(28062),i=n(28630),c=n(28091),s=n(28432),d=n(28597),u=n(28599),l=n(28600),f=n(28560),m=n(28647);function p(e,t,n){var u,l,p=n,g=t.model.parentId;if(g&&(e.cardViewState[g]?e.cardViewState[g].pending=d.a.None:null===(l=null===(u=Object(c.k)())||void 0===u?void 0:u.logDiagnosticTrace)||void 0===l||l.call(u,Object(i.a)(r||(r=Object(o.__makeTemplateObject)(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),a.d.reserveTag(520646684),c.h.Warning,c.c.ProductServiceUsage,Object(c.l)(c.g.ReviewedAsNotNecessary))),t.tempId){if(delete e.cardViewState[t.tempId],delete e.postViewState[t.tempId],e.draftState.committedLieId===t.tempId){var v=e.commentThreadIds.findIndex((function(e){return t.tempId===e}));v<0?Object(c.k)().assertConditionTag(!1,"ThreadId to delete not found",520646688):(e.commentThreadIds.splice(v,1),delete e.cardPostIds[t.tempId]),delete e.postData[t.tempId],e.createdCommentLie=void 0,e.draftState.committedLieId=void 0,p=void 0}if(e.selectedComment&&e.selectedComment.selectedCardId===t.tempId)if(e.selectedComment=f.m(Object(s.b)(t.model)),t.model.parentId)e.expandedComments.findIndex((function(e){return t.tempId===e}))>=0&&(e.expandedComments=f.U(t.tempId,e.expandedComments,e.draftState,e.selectedComment));else e.expandedComments=f.a(e.expandedComments,e.selectedComment,e.draftState)}Object(c.k)().assertConditionTag(!e.postViewState[t.model.commentId],"Received insert for existing comment",522856031),g||(e.cardViewState[t.model.commentId]=f.i(t.tempId||void 0)),e.postViewState[t.model.commentId]=f.k(t.model.displayDate),m.a(e,t.model,{insertFlatIndex:t.index,draftIdToSkip:p})}function g(e,t){var n=m.b(e,a.d.reserveTag(522856032));if(n){var r=e.postData[t.model.commentId],o=n.modelCapabilities.virtualized;if(r){e.postData[t.model.commentId]=t.model;var i=Object(s.b)(t.model),p=e.cardViewState[i];p?(e.cardViewState[i].pending=d.a.None,p.loadState.state!==u.a.Loading&&o||(e.cardViewState[i].loadState={state:u.a.Loaded})):(Object(c.k)().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",522856033),e.cardViewState[i]=f.i(void 0,o?u.a.Placeholder:void 0)),e.postViewState[t.model.commentId]?r.displayDate===t.model.displayDate&&r.date===t.model.date||(e.postViewState[t.model.commentId].displayDate=f.o(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture),e.postViewState[t.model.commentId].pending=l.a.None):e.postViewState[t.model.commentId]=f.k(f.o(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture)),m.c(e,e.postData[t.model.commentId],r,2)}else Object(c.k)().assertConditionTag(!1,"change commentId not found in postData",522856034),Object(a.i)("change commentId not found in postData ".concat(t.model.commentId))}}function v(e,t,n){var r,o,a,i=e.postData[t.model.commentId];if(i){var d=-1,u=0;if(Object(s.a)(i))(d=e.commentThreadIds.findIndex((function(e){return i.commentId===e})))<0?Object(c.k)().assertConditionTag(!1,"ThreadId to delete not found",520646687):e.commentThreadIds.splice(d,1),u=null!==(o=null===(r=e.cardPostIds[i.commentId])||void 0===r?void 0:r.length)&&void 0!==o?o:0,e.cardPostIds[i.commentId].forEach((function(t){delete e.postData[t]})),delete e.cardPostIds[i.commentId];else{if(Object(c.k)().assertConditionTag(void 0!==e.cardPostIds[i.parentId],"Orphaned reply delete received",520646686),d=e.commentThreadIds.findIndex((function(e){return i.parentId===e})),e.cardPostIds[i.parentId]){var l=e.cardPostIds[i.parentId].findIndex((function(e){return i.commentId===e}));l<0?Object(c.k)().assertConditionTag(!1,"PostID to delete not found",520646685):(u=1,e.cardPostIds[i.parentId].splice(l,1))}delete e.postData[t.model.commentId]}if(n&&void 0!==(null===(a=e.createdCommentLie)||void 0===a?void 0:a.flatIndex)&&d>=0)d<e.commentThreadIds.findIndex((function(e){return e===n}))&&(e.createdCommentLie.flatIndex-=u)}if(e.highlightedCommentId===t.model.commentId&&(e.highlightedCommentId=void 0),e.topVisibleThreadId===t.model.commentId&&(e.topVisibleThreadId=void 0),delete e.cardViewState[t.model.commentId],delete e.postViewState[t.model.commentId],t.model.commentId===e.selectedThreadIdBeforeCommentSession&&i){var f=e.commentThreadIds.length;f?t.index>=e.commentThreadIds.length?e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[f-1]:e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[t.index]:e.selectedThreadIdBeforeCommentSession=void 0}}},28647:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return v}));var r=n(28062),o=n(28091),a=n(13057),i=n(22377),c=n(28583),s=n(28432),d=n(28599),u=n(28589),l=n(28560),f=n(28601);function m(e,t){var n=Object(a.f)(e);if(n)return n;Object(o.k)().assertConditionTag(!1,"immerDraft does not have original state",t)}function p(e,t,n){var r=!1;if(Object(s.a)(t)){var a=void 0===n;if(n){var i=function(e,t,n){if(n.insertFlatIndex<0)return{insertThreadIndex:-1};for(var r=!!(null==n?void 0:n.draftIdToSkip)||void 0,o=0,a=0;a<e.length;a++){if(o===n.insertFlatIndex)return{insertThreadIndex:a,beforeDraft:r};if(e[a]!==n.draftIdToSkip){if(o+=t[e[a]].length,n.insertFlatIndex<=o)return{insertThreadIndex:a+1,beforeDraft:r}}else r=!1}if(o===n.insertFlatIndex)return{insertThreadIndex:e.length,beforeDraft:r};return{insertThreadIndex:-1}}(e.commentThreadIds,e.cardPostIds,n);r=!!i.beforeDraft,i.insertThreadIndex>=0?e.commentThreadIds.splice(i.insertThreadIndex,0,t.commentId):(Object(o.k)().assertConditionTag(!1,"Invalid thread insert flat index.",512508103),a=!0)}a&&e.commentThreadIds.push(t.commentId),e.cardPostIds[t.commentId]=[t.commentId]}else{if(!e.cardPostIds[t.parentId])return void Object(o.k)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",526242826);if(n){var c=function(e,t,n,r){for(var o=!!r||void 0,a=0,i=0;i<t.length;i++){if(t[i]===e)return{flatIndex:a,beforeDraft:o};t[i]!==r?a+=n[t[i]].length:o=!1}return{flatIndex:-1}}(t.parentId,e.commentThreadIds,e.cardPostIds,n.draftIdToSkip);r=!!c.beforeDraft;var d=n.insertFlatIndex-c.flatIndex;Object(o.k)().assertConditionTag(d>=1&&d<=e.cardPostIds[t.parentId].length,"Invalid insert post index.",520646683),d=Math.max(Math.min(d,e.cardPostIds[t.parentId].length),1),e.cardPostIds[t.parentId].splice(d,0,t.commentId)}else e.cardPostIds[t.parentId].push(t.commentId)}e.postData[t.commentId]=t,(null==n?void 0:n.draftIdToSkip)&&e.createdCommentLie&&r&&e.createdCommentLie.flatIndex++}function g(e,t){var n=m(e,r.d.reserveTag(524031042));if(n){var o,a;if(e.draftState.pendingDraft)switch(e.draftState.pendingDraft.sessionType){case"REPLY":if(o=e.draftState.pendingDraft.threadId,!n.cardViewState[o])return;break;case"EDIT":if(a=e.draftState.pendingDraft.commentId,!n.postViewState[a])return;break;default:return}else{var i=l.K(e.draftState);if(!i||!i.isInCurrentContext)return;switch(i.commentDraft.sessionConfiguration.sessionType){case"REPLY":o=i.threadId;break;case"EDIT":a=i.commentDraft.sessionConfiguration.commentId;break;default:return}}o&&!e.cardViewState[o]?(h(e.draftState,o),Object(f.b)(n.draftState,e.draftState,3,t,r.d.reserveTag(526242828))):a&&!e.postViewState[a]&&(b(e.draftState,a),Object(f.b)(n.draftState,e.draftState,2,t,r.d.reserveTag(526242829)))}}function v(e,t,n,o){var a,p,g=m(e,r.d.reserveTag(524031047));if(g&&function(e,t){return!(!(e&&e.commentFlags&i.a.Resolved&&t)||t.commentFlags&i.a.Resolved)}(t,n)&&(e.selectedComment&&e.selectedComment.selectedCardId===t.commentId&&(Object(u.j)(e.selectedComment.selectionDetails)||void 0!==e.selectedComment.selectionDetails.lowFidelityWarningType)&&(e.selectedComment.selectionDetails=l.l()),t.commentId===(null===(a=l.K(e.draftState))||void 0===a?void 0:a.threadId)&&(!function(e,t,n){h(e,n);var r=l.J(e);if(r){var o=e.postIdToDraftIdMap[r],a=e.drafts[o];a&&a.threadId===n&&b(e,r)}if(e.pendingDraft&&Object(c.e)(e.pendingDraft)){var i=e.pendingDraft.commentId,d=t[i];d&&Object(s.b)(d)===n&&(e.pendingDraft=void 0)}}(e.draftState,e.postData,t.commentId),Object(f.b)(g.draftState,e.draftState,1,o,r.d.reserveTag(526242836))),(null===(p=g.cardViewState[t.commentId])||void 0===p?void 0:p.loadState.state)===d.a.Loaded)){var v=l.U(t.commentId,e.expandedComments,e.draftState,e.selectedComment);v!==e.expandedComments&&(e.expandedComments=v)}}function h(e,t){e.pendingDraft&&Object(c.f)(e.pendingDraft)&&e.pendingDraft.threadId===t&&(e.pendingDraft=void 0);var n=e.cardIdToDraftIdMap[t];n&&(C(e,n),delete e.cardIdToDraftIdMap[t])}function b(e,t){e.pendingDraft&&Object(c.e)(e.pendingDraft)&&e.pendingDraft.commentId===t&&(e.pendingDraft=void 0);var n=e.postIdToDraftIdMap[t];n&&(C(e,n),delete e.postIdToDraftIdMap[t])}function C(e,t){e.drafts[t]?(Object(o.k)().assertConditionTag(1===Object.keys(e.drafts).length,"Invalid number of drafts",526131555),delete e.drafts[t]):Object(o.k)().assertConditionTag(0===Object.keys(e.drafts).length,"Invalid draftId",526131554)}},28648:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return p}));var r=n(12708),o=n(28062),a=n(28091),i=n(28597),c=n(28599),s=n(28600),d=n(28647),u=n(28560);function l(e,t){var n=d.b(e,o.d.reserveTag(523604707));if(n){var s=n.cardViewState[t];Object(a.k)().assertConditionTag(!s||s.pending!==i.a.Delete,"Card pending delete remained after a reload.",523604736);var l=n.modelCapabilities.virtualized?c.a.NeedsReload:c.a.Loaded;if(s){var f=s.pending!==i.a.None,m=(f||n.modelCapabilities.virtualized)&&s.loadState.state!==c.a.Placeholder&&s.loadState.state!==l;e.cardViewState[t]=f||m?Object(r.__assign)(Object(r.__assign)({},s),{pending:i.a.None}):s,m&&(e.cardViewState[t].loadState=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t].loadState),{state:l}))}else Object(a.k)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default",523604737),e.cardViewState[t]=u.i(void 0,l)}}function f(e,t){var n=d.b(e,o.d.reserveTag(523604738));if(n){var i=n.postViewState[t];Object(a.k)().assertConditionTag(!i||i.pending!==s.a.Delete,"Post pending delete remained after a reload.",523604739),i?e.postViewState[t]=i.pending!==s.a.None?Object(r.__assign)(Object(r.__assign)({},i),{pending:s.a.None}):i:(Object(a.k)().assertConditionTag(!1,"Post state missing for existing post on reload. Creating default",523604740),e.postViewState[t]=u.k(void 0))}}function m(e){var t=d.b(e,o.d.reserveTag(523604741));if(null==t?void 0:t.selectedThreadIdBeforeCommentSession){var n=t.commentThreadIds.indexOf(t.selectedThreadIdBeforeCommentSession);n<0&&(Object(a.k)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in original commentThreadIds. Falling back to first comment",523604742),n=0);var r=e.commentThreadIds.length-1;e.commentThreadIds.length?(n>=e.commentThreadIds.length&&(n=r),e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[n]):e.selectedThreadIdBeforeCommentSession=void 0}}function p(e){var t=d.b(e,o.d.reserveTag(523604706));if(t&&e.createdCommentLie){var n=u.G(e.draftState,!0);if(n&&t.createdCommentLie&&t.cardViewState[n]&&t.cardViewState[n].pending===i.a.None){var r=Object.keys(e.postData).length;e.createdCommentLie&&e.createdCommentLie.flatIndex>r&&(e.createdCommentLie.flatIndex=r);var c=u.L(e.commentThreadIds,e.cardPostIds,e.createdCommentLie.flatIndex);c>=0?(e.commentThreadIds.splice(c,0,n),e.cardPostIds[n]=[n],e.postData[n]=t.postData[n],e.cardViewState[n]=t.cardViewState[n],e.postViewState[n]=t.postViewState[n]):Object(a.k)().assertConditionTag(!1,"getThreadIndexFromFlatIndex unexpected failure to get threadIndex",523100547)}else e.createdCommentLie=void 0}}},28649:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f}));var r=n(12708),o=n(28091),a=n(28561),i=n(28405),c=n(28604),s=n(28280),d=n(28560);function u(e,t,n,o){var a,i,c,d,u;if(s.c()&&n.tasks){var l=!1,f={},p={},v=new Set,h=Object.keys(e);n.comments.forEach((function(e){""===e.parentId&&v.add(e.commentId)}));try{for(var b=Object(r.__values)(h),C=b.next();!C.done;C=b.next()){var y=C.value;if(!v.has(y)){l=!0;break}}}catch(S){a={error:S}}finally{try{C&&!C.done&&(i=b.return)&&i.call(b)}finally{if(a)throw a.error}}h.length!==(null===(u=n.tasks)||void 0===u?void 0:u.length)&&(l=!0);try{for(var T=Object(r.__values)(n.tasks),O=T.next();!O.done;O=T.next()){var I=O.value;l=m(t,p,I,o)||l,f[I.commentId]=g(I)}}catch(j){c={error:j}}finally{try{O&&!O.done&&(d=T.return)&&d.call(T)}finally{if(c)throw c.error}}if(l)return{updatedTasks:f,updatedHistoryRecordViewState:p}}}function l(e,t,n,c){if(s.c()){var d=Object(r.__assign)({},e),u=Object(r.__assign)({},t),l=!1;if(n.changes.forEach((function(n){if(n.type!==a.d.Unknown){var r=n.model.commentId;switch(n.type){case a.d.Delete:if(delete d[r],void 0!==e[r])Object.keys(e).includes(r)&&(p(u,e[r],void 0),l=!0);break;case a.d.Load:case a.d.Insert:case a.d.Modify:Object(o.k)().assertConditionTag(n.type===a.d.Modify||!d[r],"Task should not already be populated on initial load",554836097);var s=n.task;if(s)l=m(t,u,s,c)||l||!d[r]||!function(e,t){if(e.completion!==t.completion||e.title!==t.title||e.isLossy!==t.isLossy||e.priority!==t.priority||e.schedule.dueDate!==t.schedule.dueDate||e.schedule.startDate!==t.schedule.startDate||e.assignees.length!==t.assignees.length)return!1;for(var n=0;n<e.assignees.length;n++)if(!Object(i.l)(e.assignees[n],t.assignees[n]))return!1;return!0}(d[r].currentState,s.currentState),d[r]=g(s);else if(""===n.model.parentId&&d[r]){var f=d[r];p(u,f,void 0),delete d[r],l=!0}}}else Object(o.k)().assertConditionTag(!1,"Unknown change type",554836096)})),l)return{updatedTasks:d,updatedHistoryRecordViewState:u}}}function f(e,t){var n,o;if(e&&s.c()){var a={},i={};try{for(var c=Object(r.__values)(e),d=c.next();!d.done;d=c.next()){var u=d.value;m({},i,u,t),a[u.commentId]=g(u)}}catch(l){n={error:l}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return{updatedTasks:a,updatedHistoryRecordViewState:i}}}function m(e,t,n,o){var a,i,s,u;if(0===n.history.length)return!0;var l=!1,f=e&&Object.keys(e).length>0,m=f?new Set:void 0;try{for(var g=Object(r.__values)(n.history),v=g.next();!v.done;v=g.next()){var h=v.value;try{for(var b=(s=void 0,Object(r.__values)(h.records)),C=b.next();!C.done;C=b.next()){var y=C.value;null==m||m.add(y.recordId);var T=c.a(n.id,y.recordId);e[T]?t[T]=e[T]:(l=!0,t[T]=Object(d.t)(Object(d.o)(y.time,y.displayTime,o.dataCulture)))}}catch(I){s={error:I}}finally{try{C&&!C.done&&(u=b.return)&&u.call(b)}finally{if(s)throw s.error}}}}catch(S){a={error:S}}finally{try{v&&!v.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}if(f){var O=p(t,n,m);l=l||O}return l}function p(e,t,n){var o,a,i,s,d=!1;try{for(var u=Object(r.__values)(t.history),l=u.next();!l.done;l=u.next()){var f=l.value;try{for(var m=(i=void 0,Object(r.__values)(f.records)),p=m.next();!p.done;p=m.next()){var g=p.value;n&&n.has(g.recordId)||(delete e[c.a(t.id,g.recordId)],d=!0)}}catch(v){i={error:v}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}}}catch(h){o={error:h}}finally{try{l&&!l.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}return d}function g(e){var t,n,o,a,i=Object(r.__assign)({},e),c=[];try{for(var d=Object(r.__values)(e.history),u=d.next();!u.done;u=d.next()){var l=u.value,f=Object(r.__assign)({},l);s.V()&&!f.taskId&&(f.taskId=e.id);var m=[];try{for(var p=(o=void 0,Object(r.__values)(l.records)),g=p.next();!g.done;g=p.next()){var v=g.value;m.push(Object(r.__assign)({},v))}}catch(h){o={error:h}}finally{try{g&&!g.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}f.records=m,c.push(f)}}catch(b){t={error:b}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return i.history=c,i}},28650:function(e,t,n){"use strict";function r(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}n.d(t,"a",(function(){return r}))},28651:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n(12708),o=n(22381),a=n(28361),i=n(28652),c=n(28653),s=n(28643),d=n(28280),u=n(28560),l=n(28654),f=n(28655),m=n(28598);function p(e){return Object(r.__assign)(Object(r.__assign)({},d.W()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:[]}),{cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:o.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(m.h)(),modelCapabilities:Object(u.s)(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}})}function g(e,t,n,r){return function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new c.a(Object(s.a)(e.containerType),r),visibilityState:t?a.a.Visible:a.a.Closed,initializationStatus:i.a.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:Object(l.b)(),commentState:p(n),filterState:Object(f.b)()}}(e,t,n,r)}},28652:function(e,t,n){"use strict";var r;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={})),t.a=r},28653:function(e,t,n){"use strict";var r=n(28307),o=n(28618),a=n(28616),i=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t};function c(e){return u(Object(a.c)(e)?Object(o.a)(e):Object(o.e)(e.componentType))}function s(e){var t=document.activeElement;return!!e&&t===e}function d(e,t,n){var r=document.activeElement,o=t!==a.a.CardEditor&&t!==a.a.PostEditor&&!n;return!!e&&(r&&e.contains(r)||o&&function(e){return e===document.body||null===e||0===Object.keys(e).length}(r))}function u(e){var t=document.getElementById(e);return null!=t?t:void 0}var l=function(){function e(e,t,n){this.componentTreeId={renderContextType:e,contextIdentifier:t}}return e.prototype.getComponent=function(e){return u(Object(o.e)(e))},e.prototype.getComponentById=function(e){return u(Object(o.a)(e))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(e){return s(c(e))},e.prototype.isFocusWithin=function(e){return d(c(e),e.componentType)},e.prototype.isFocusOnOrWithin=function(e,t){var n=c(e);return s(n)||d(n,e.componentType,t)},e.prototype.isFocusWithinAny=function(e){var t=void 0;switch(e){case a.a.Card:t=i(document.querySelectorAll("[id*='".concat(r.i({id:"",renderContextType:this.componentTreeId.renderContextType},!1),"']")));break;case a.a.DraftCard:t=i(document.querySelectorAll("[id*='".concat(r.i({id:"",renderContextType:this.componentTreeId.renderContextType},!0),"']")));break;case a.a.PostEditor:t=i(document.querySelectorAll("[id*='".concat(r.w(r.G({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case a.a.CardEditor:t=i(document.querySelectorAll("[id*='".concat(r.w(r.f({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case a.a.Post:t=i(document.querySelectorAll("[id*='".concat(r.I({id:"",renderContextType:this.componentTreeId.renderContextType}),"']")))}if(t)for(var n=0;n<t.length;++n){if(d(t[n],e))return!0}return!1},e.prototype.isFocusWithinPane=function(){return d(document.getElementById(r.z()),a.a.PaneRoot)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e}();t.a=l},28654:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(12708),o=n(28091),a=n(28480);function i(){return{extensions:{},contentNavigationSupported:!1}}function c(e,t){switch(void 0===e&&(e={extensions:{},contentNavigationSupported:!1}),void 0===t&&(t=a.EMPTY_ACTION),t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){var n;Object(o.k)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var a=t.payload.extension;return Object(r.__assign)(Object(r.__assign)({},e),{extensions:Object(r.__assign)(Object(r.__assign)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:a,priority:a.priority},n))})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){var n,o,a=Object(r.__assign)({},e.extensions);try{for(var i=Object(r.__values)(t.payload.renderModes),c=i.next();!c.done;c=i.next()){var s=c.value;delete a[s]}}catch(d){n={error:d}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{extensions:a})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){var n=Object(r.__assign)({},e.extensions);for(var o in t.payload.updates)n[o]&&(n[o]=Object(r.__assign)(Object(r.__assign)({},n[o]),{priority:t.payload.updates[o]}));return Object(r.__assign)(Object(r.__assign)({},e),{extensions:n})}(e,t);case"SET_CONTENT_NAVIGATION_ENABLEMENT":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{contentNavigationSupported:t.payload.isEnabled})}(e,t);default:return e}}},28655:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(12708),o=n(28091),a=n(13057),i=n(28361),c=n(28480);function s(e,t){return void 0===e&&(e=d()),void 0===t&&(t=c.EMPTY_ACTION),Object(a.b)(e,(function(n){switch(t.type){case"VIEW_CONTAINER_VISIBILITY_CHANGED":return void function(e,t){void 0===e.defaultFilterId&&t.payload.visibilityState!==i.a.Closed&&(e.requestDefaultFilter=!0)}(n,t);case"LOAD_DEFAULT_FILTER":return void function(e,t){u(e,t.payload.filteredRange,!0)&&(e.defaultFilterId=t.payload.filteredRange.id);e.requestDefaultFilter=!1}(n,t);case"LOAD_FILTER":return void function(e,t){Object(o.k)().assertConditionTag(!!e.defaultFilterId,"Default filter should be loaded before new filters are loaded",528779299),u(e,t.payload.filteredRange,t.payload.shouldSetActive)}(n,t);case"SET_FILTERING_CAPABILITIES":return void function(e,t){e.filteringCapabilities=t.payload.capabilities}(n,t);case"UPDATE_FILTER_RANGE":return void function(e,t){if(Object(o.k)().assertConditionTag(t.payload.filterId.length>0,"FilterId must not be empty string",529138905),0===t.payload.changes.length||!t.payload.filterId)return;var n=e.filteredRanges[t.payload.filterId];if(!n)return void Object(o.k)().assertConditionTag(!1,"Processing update for a filter that is not found?",529138910);t.payload.changes.forEach((function(a){switch(a.type){case"FilterUpdate":if(t.payload.filterId===e.defaultFilterId){Object(o.k)().assertConditionTag(!1,"Should not attempt to update the default filter",528532106);break}Object(o.k)().assertConditionTag(n.canUpdateFilter,"Should not get into FilterUpdate if canUpdateFilter is false",528749965),n.filter=a.updatedFilter;break;case"Insert":if(a.index<0||a.index>n.order.length){Object(o.k)().assertConditionTag(!1,"Insert index out of bounds?",529138908);break}n.order=Object(r.__spreadArray)(Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(n.order.slice(0,a.index)),!1),[a.content],!1),Object(r.__read)(n.order.slice(a.index)),!1);break;case"Reload":n.order=a.fullContent;break;case"Remove":if(a.index<0||a.index>=n.order.length){Object(o.k)().assertConditionTag(!1,"Processing Remove with index out of bounds?",529138911);break}n.order.splice(a.index,1);break;case"Teardown":t.payload.filterId===e.defaultFilterId&&(Object(o.k)().assertConditionTag(!1,"Is tearing down default filter expected?",528779328),e.defaultFilterId=void 0),t.payload.filterId===e.activeFilterId&&(Object(o.k)().assertConditionTag(!!e.defaultFilterId,"Active was removed, but no default to fallback on",528779329),e.activeFilterId=e.defaultFilterId),delete e.filteredRanges[t.payload.filterId]}}))}(n,t);default:return e}}))}function d(){return{filteredRanges:{},filteringCapabilities:void 0,requestDefaultFilter:!1}}function u(e,t,n){return void 0!==e.filteredRanges[t.id]?(Object(o.k)().assertConditionTag(!1,"Should not load a filter with the same id as a previously loaded filter",528527825),!1):(n&&(e.activeFilterId=t.id),e.filteredRanges[t.id]={filter:t.getFilter(),order:t.getOrder(),canUpdateFilter:e.defaultFilterId!==t.id&&t.canBeUpdated()},!0)}},28656:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(12708),o=n(28057),a=n(28091),i=n(28361),c=n(28294),s=n(28652),d=n(28309),u=n(28653),l=n(28643),f=n(28280),m=n(28480);function p(){Object(a.k)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function g(e,t){switch(void 0===e&&(e={viewContainer:{closeView:p,openView:p,containerType:c.b.FullPane,moveFocusToCanvas_donotuse:p},componentTree:new u.a(d.a.FullPane,o.a),visibilityState:i.a.Closed,initializationStatus:s.a.NotInitialized,viewContainerDisplayConfiguration:void 0}),void 0===t&&(t=m.EMPTY_ACTION),t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new u.a(Object(l.a)(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:t.payload.visibilityState!==i.a.Closed||f.v()?e.initializationStatus:s.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:s.a.Initializing})}(e);case"END_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:s.a.Initialized})}(e);default:return e}}},28657:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(28062),o=n(28091),a=n(22378),i=n(28307),c=n(28310),s=n(28280),d=n(28556),u=n(28658),l=n(28598),f=n(28603),m=n(28660),p=n(28606),g=function(e,t){return function(n){var g=Object(u.a)(n,t);return function(t){return function(u){var v=n.getState();switch(u.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":g.reset();break;case"COMMIT_DRAFT":var h=p.b(v),b=f.v(v);if(void 0!==b){var C=b.commentDraft;if(u.payload.metadataUpdates&&u.payload.metadataUpdates.Task){var y=void 0;C.sessionConfiguration.sessionType!==a.a&&C.sessionConfiguration.sessionType!==a.b&&(y=h[C.sessionConfiguration.threadId]&&h[C.sessionConfiguration.threadId].id),u.payload.metadataUpdates.Task.taskId=y,C.updateProperties("Task",u.payload.metadataUpdates.Task)}u.payload.data.temporaryCommentId=C.commit(u.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":return f.p(v).virtualized?void g(u.payload.threadIds):void Object(o.k)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":if(!f.p(v).virtualized)return;e.loadThreads(u.payload.threadIds);break;case"HIGHLIGHT_COMMENT":u.payload.actionSource===d.a.SharedComments&&e.highlightComment(u.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var T=f.h(v);if(Object(l.d)(T))return;e.deleteComment(u.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":s.c()?e.beginDraftingAsync({sessionType:"METADATA",threadId:u.payload.commentId}).then((function(e){var t=p.b(v)[u.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch(Object(c.a)(r.d.reserveTag(593768922))):e.setThreadResolvedState(u.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":s.c()?e.beginDraftingAsync({sessionType:"METADATA",threadId:u.payload.commentId}).then((function(e){var t=p.b(v)[u.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch(Object(c.a)(r.d.reserveTag(593768924))):e.setThreadResolvedState(u.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(u.payload.commentId)}var O=t(u),I=n.getState(),S=f.t(v),j=f.t(I),_=void 0;switch("LOAD_COMMENT"===u.type||"VIRTUALIZE_COMMENTS"===u.type||"SELECT_COMMENT"===u.type&&u.payload.source!==d.a.SharedComments||!j||j.selectedCardId===(null==S?void 0:S.selectedCardId)||j.selectedCardId===Object(i.y)()||(_=j.selectedCardId),u.type){case"CLEAR_COMMENT_HIGHLIGHT":u.payload.actionSource===d.a.SharedComments&&void 0!==v.commentState.highlightedCommentId&&void 0===I.commentState.highlightedCommentId&&e.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(s.F()&&!m.b(n.getState())){var k=f.v(I);k&&(_=k.threadId)}}return _&&e.selectComment(_),O}}}}},28658:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(12708),o=n(28062),a=n(28659),i=n(28309),c=n(28480),s=n(28599),d=n(28603),u=function(){return{threadIdRequests:new Map,sequenceId:0}};function l(e){return e&&(e.loadState.state===s.a.Placeholder||e.loadState.state===s.a.NeedsReload)}var f=function(e,t,n){return void 0===n&&(n=20),Object(a.a)(function(e){return function(t,n){var o,a,i=d.c(e.getState());try{for(var c=Object(r.__values)(n),s=c.next();!s.done;s=c.next()){var u=s.value;l(i[u])&&t.threadIdRequests.set(u,t.sequenceId++)}}catch(f){o={error:f}}finally{try{s&&!s.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return t}}(e),function(e,t,n){return function(a){for(var s=Array.from(a.threadIdRequests.entries()).sort((function(e,t){var n=Object(r.__read)(e,2),o=(n[0],n[1]),a=Object(r.__read)(t,2);a[0];return o-a[1]})),u=[],f=d.c(e.getState()),m=s.pop();m&&u.length<n;m=s.pop()){var p=Object(r.__read)(m,1)[0];a.threadIdRequests.delete(p),l(f[p])&&u.push(p)}if(u.length&&e.dispatch(Object(c.dispatchLoadThreads)({renderContextType:i.a.None,telemetryVisitor:t,trackback:o.d.reserveTag(594888212)},{threadIds:u})),a.threadIdRequests.size>0)return a}}(e,t,n),u,500)}},28659:function(e,t,n){"use strict";function r(e,t,n,r,o){var a,i=n(),c=function(){var e=t(i);e?(i=e,a=setTimeout(c,r)):(i=n(),a=void 0)},s=function(t){i=e(i,t),a||o||(a=setTimeout(c,0)),a||(a=setTimeout(c,o||r))};return s.reset=function(){void 0!==a&&(clearTimeout(a),i=n(),a=void 0)},s}n.d(t,"a",(function(){return r}))},28660:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(28062),o=n(28170),a=function(e){return e.contentExtensions.extensions},i=function(e,t){var n=a(e)[t];return void 0!==n&&n.priority!==o.d.Disabled},c=function(e,t){if(!t)return!1;switch(t.renderMode){case o.e.Integrated:case o.e.TaskPaneItem:return void 0!==(n=a(e)[t.renderMode])&&n.priority!==o.d.Disabled;case o.e.Isolated:var n;return void 0!==(n=a(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==o.d.Disabled;default:Object(r.m)(t)}},s=function(e){return e.contentExtensions.contentNavigationSupported}},28661:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(12708),o=n(28062),a=n(28170),i=n(28309),c=n(28480),s=n(28603),d=n(28660),u=n(28607);function l(e,t,n){var r=e.getState(),o=d.a(r)[a.e.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function f(e,t,n,r){return"CREATE"===r&&l(e,t,n)}function m(e,t){return 0===s.f(t).lastContextChangeIncrement?a.d.Disabled:e===a.e.TaskPane||e===a.e.TaskPaneItem?u.a(t)?a.d.Primary:a.d.Disabled:s.q(t)?a.d.Disabled:m(a.e.TaskPane,t)!==a.d.Primary?a.d.Primary:e===a.e.Integrated?a.d.Disabled:a.d.Secondary}function p(e,t){var n=d.a(e)[t];n&&(n.controller.priority=n.priority)}var g=function(e){return function(t){return function(n){return function(u){var g,v,h;switch(u.type){case"ADD_CONTENT_EXTENSION":u.payload.extension.priority=m(u.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":try{for(var b=Object(r.__values)(u.payload.renderModes),C=b.next();!C.done;C=b.next()){var y=C.value,T=d.a(t.getState())[y];T&&T.controller.unregisterExtension()}}catch(I){g={error:I}}finally{try{C&&!C.done&&(v=b.return)&&v.call(b)}finally{if(g)throw g.error}}break;case"UPDATE_EXTENSION_PRIORITY":n(u),p(t.getState(),a.e.TaskPane),p(t.getState(),a.e.TaskPaneItem),p(t.getState(),a.e.Integrated),p(t.getState(),a.e.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(l(t,u,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(u),void t.dispatch(Object(c.updateExtensionPriority)({renderContextType:i.a.None,telemetryVisitor:e,trackback:o.d.reserveTag(594834319)},(h={},h[a.e.TaskPane]=m(a.e.TaskPane,t.getState()),h[a.e.TaskPaneItem]=m(a.e.TaskPaneItem,t.getState()),h[a.e.Integrated]=m(a.e.Integrated,t.getState()),h[a.e.Isolated]=m(a.e.Isolated,t.getState()),h)));case"BEGIN_DRAFTING_SUCCESS":if(f(t,u,n,u.payload.draftDetails.sessionConfiguration.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if(f(t,u,n,u.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":if(u.payload.isClaimingLock||u.actionDetail.renderContextType===i.a.DiscreteIsolated)break;var O=s.v(t.getState());if(O&&f(t,u,n,O.commentDraft.sessionConfiguration.sessionType))return}return n(u)}}}}},28662:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(28170),o=n(28340),a=n(28596),i=n(28280),c=n(28480),s=n(28556),d=n(28603),u=n(28660),l=n(28607),f=function(e){return function(t){return function(n){return function(f){var m;if(!e||!u.b(t.getState()))return n(f);var p=t.getState(),g=n(f),v=t.getState();switch(f.type){case"DISPLAY_DRAFT_WARNING":var h=d.t(p),b=d.t(v),C=!b||b.selectedCardId===(null==h?void 0:h.selectedCardId);if(i.F()&&C){var y=d.v(v);y&&e.bringContentIntoView({contentIdentifier:{contentId:y.threadId,contentType:r.b.CommentThread}})}break;case"SELECT_COMMENT":var T=d.t(v);f.payload.source===s.a.SharedComments&&f.payload.selectType!==c.SelectActionType.Polite&&Object(a.b)(f.actionDetail.renderContextType)&&T&&e.bringContentIntoView({contentIdentifier:{contentId:T.selectedCardId,contentType:r.b.CommentThread}});break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(l.a(v))break;var O=d.v(v),I=O&&O.isInCurrentContext&&(null===(m=d.t(v))||void 0===m?void 0:m.selectedCardId)===O.threadId?O.threadId:void 0;I&&e.bringContentIntoView({contentIdentifier:{contentId:I,contentType:r.b.CommentThread}});break;case"SELECT_CONTENT":e.selectNextOrPreviousContent(f.payload);break;case"MOVE_FOCUS_TO_CANVAS":e.moveFocus({region:o.a.Canvas,resource:f.payload.resource})}return g}}}}},28663:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28091),o=n(28585),a=n(28280),i=function(e){return function(t){return function(n){return function(i){var c=t.getState().commentState.draftState.drafts;n(i);var s=t.getState().commentState.draftState.drafts;if(Object.keys(c).forEach((function(t){if(void 0===s[t]){var n=Object(r.k)().createActivityObject("EndDraftingCalledOnAction",e,Object(r.j)());n.addDataField("ActionName",i.type,r.d.SystemMetadata),n.successTag(539313865),c[t].commentDraft.endDrafting()}})),Object(a.s)()&&"SAVE_DRAFT"===i.type){var d=s[i.payload.draftId];d&&Object(o.a)().storeEditorContentFromDraftSave(i.payload,d.commentDraft.sessionConfiguration)}}}}}},28664:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(28062),o=n(28091),a=n(28271),i=n(28665),c=n(28666),s=n(28667),d=function(){return function(e){return function(t){try{return e(t)}catch(d){if(void 0===Object(s.b)(t)){var n=Object(o.k)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,Object(o.j)());n.addDataField("OperationType",t.type,o.d.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,o.d.SystemMetadata),n.failTag(593278723,Object(i.a)(d))}!function(e){if(Object(c.a)(e))throw e;if(!Object(a.b)(e))throw Object(o.k)().assertConditionTag(!1,"Unknown error encountered, rethrowing: ".concat(Object(r.l)(e)),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(o.k)().assertConditionTag(!1,"Unexpected error: Name: ".concat(e.name," errorCode: ").concat(e.errorCode," Tag: ").concat(e.tag," internalDetails: ").concat(Object(r.l)(e)),e.tag)}}(d)}}}}},28665:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28271),o=n(28666);function a(e,t){return Object(r.b)(e)?e.errorCode:Object(o.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},28666:function(e,t,n){"use strict";function r(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return r}))},28667:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(28091),o=n(28501),a=Object(r.j)();function i(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",activityConfig:Object(r.n)({aggregationMode:r.a.OnSuccess})};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",activityConfig:a};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",activityConfig:a};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",activityConfig:a};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",activityConfig:a};case"COLLAPSE_CARD":return{name:"CollapseCardAction",activityConfig:a};case"COMMIT_DRAFT":return{name:"CommitDraftAction",activityConfig:a};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",activityConfig:a};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",activityConfig:Object(r.n)({aggregationMode:r.a.OnSuccess})};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",activityConfig:a};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",activityConfig:a,logDocumentMetadata:r.f.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",activityConfig:Object(r.n)({aggregationMode:r.a.OnSuccess})};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",activityConfig:a};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",activityConfig:a,logDocumentMetadata:r.f.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",activityConfig:a};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",activityConfig:a};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",activityConfig:a};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",activityConfig:a};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",activityConfig:a};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",activityConfig:a};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",activityConfig:a};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",activityConfig:a};case"CLEAR_COMMENT_SELECTION":default:return}}function c(e){if("COMMIT_DRAFT"===e.type)return{name:"CommitDraft".concat(Object(o.b)(e.payload),"Action"),activityConfig:a}}},28668:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n(28313),o=n(28062),a=n(28091),i=n(28170),c=n(28309),s=n(28310),d=n(28280),u=n(28480),l=n(28558),f=n(28669),m=!1,p={mentionsToCurrentUser:!1,CommentThread:{resolutionStatus:r.a.All},TrackedChange:{stubField:""},contentOrder:r.c.HostDefaultOrder,includeAllDocumentContexts:!1,userFilter:void 0},g=function(e,t){return function(n){var r=new Map;return function(i){return function(c){if(!l.g(n.getState()))return i(c);var s,p=Object(f.b)(Object(f.c)(c.type),t,n.getState()),g=l.a(n.getState());switch(c.type){case"LOAD_DEFAULT_FILTER":case"LOAD_FILTER":s=l.f(n.getState(),c.payload.filteredRange.id);break;case"UPDATE_FILTER_RANGE":s=l.f(n.getState(),c.payload.filterId);break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":c.payload.filteringEnabled=!0}var b=i(c),C=function(e,r){if(!p){Object(a.k)().assertConditionTag(!1,"Activity should not be undefined",e);var i=Object(f.c)(r);p=Object(f.b)(i!==f.a.None?i:f.a.Error,t,n.getState())}return Object(o.n)(p,"Perf activity not defined in error fallback case.",o.d.reserveTag(520168332)),p};switch(c.type){case"LOAD_DEFAULT_FILTER":d.u()&&m&&!l.h(n.getState())&&(m=!1);case"LOAD_FILTER":!function(e,t,n,r,i,c,s,d){void 0===s&&l.f(n.getState(),r.payload.filteredRange.id)&&(i.set(r.payload.filteredRange.id,{filter:r.payload.filteredRange,changeToken:r.payload.filteredRange.onRangeUpdated.subscribe((function(e){!function(e,t,n,r,i,c){i.get(n)?t(u.updateFilterRange({renderContextType:r,telemetryVisitor:e,trackback:o.d.reserveTag(528779331)},{filterId:n,changes:c.changes})):Object(a.k)().assertConditionTag(!1,"How did we receive an update, when we aren't tracking a filter? Did you forget to teardown an old filter?",528779330)}(t,n.dispatch,r.payload.filteredRange.id,r.actionDetail.renderContextType,i,e)}))}),"LOAD_DEFAULT_FILTER"!==r.type&&!r.payload.shouldSetActive||l.a(n.getState())!==r.payload.filteredRange.id||(e.setActiveFilteredRange(r.payload.filteredRange.id),d&&d!==l.a(n.getState())&&d!==l.e(n.getState())&&n.dispatch(u.updateFilterRange({renderContextType:r.actionDetail.renderContextType,telemetryVisitor:t,trackback:o.d.reserveTag(528779332)},{filterId:d,changes:[{type:"Teardown"}]}))));c.successTag(o.d.reserveTag(520198023))}(e,t,n,c,r,C(o.d.reserveTag(520198025),c.type),s,g);break;case"UPDATE_FILTER_RANGE":!function(e,t,n,r,o,i,c,s){l.a(n.getState())!==s&&e.setActiveFilteredRange(l.a(n.getState()));var u=l.f(n.getState(),r.payload.filterId);if(c&&u&&c.filter!==u.filter){var f=o.get(r.payload.filterId);f&&f.filter.canBeUpdated()?f.filter.updateFilter(u.filter)?i.successTag(520198022):(Object(a.k)().assertConditionTag(!1,"The filter should have been able to update",528527826),v(e,t,i,n,u.filter,s===r.payload.filterId)):v(e,t,i,n,u.filter,s===r.payload.filterId)}var p=function(){return r.payload.changes.findIndex((function(e){return"Teardown"===e.type}))>=0};if(!l.f(n.getState(),r.payload.filterId)){Object(a.k)().assertConditionTag(p(),"Range should not be removed unless there was a Teardown",528749966);var g=o.get(r.payload.filterId);g&&(g.filter.teardown(),g.changeToken.unsubscribe(),o.delete(r.payload.filterId))}d.u()&&m||l.e(n.getState())||(Object(a.k)().assertConditionTag(p(),"Default filter should not be removed unless there was a Teardown",528749967),h(e,t,i,n));i.isEnded()||i.successTag(520198021)}(e,t,n,c,r,C(o.d.reserveTag(520198024),c.type),s,g)}return d.u()&&m||!l.h(n.getState())||(p=Object(f.b)(f.a.RequestDefaultFilter,t,n.getState()),h(e,t,C(o.d.reserveTag(520168331),c.type),n),m=!0),b}}}};var v=function(e,t,n,r,a,d){var l,f,m;e.createFilteredRange({contentTypes:[i.b.CommentThread],filters:a,supportsFilterUpdates:!1}).then((function(e){r.dispatch(u.loadFilter({renderContextType:c.a.None,telemetryVisitor:t,trackback:o.d.reserveTag(528532107)},{filteredRange:e,shouldSetActive:d})),n.successTag(520198020)})).catch((l=n,f=o.d.reserveTag(520198019),m=o.d.reserveTag(528532108),null==l||l.failTag(f,-2147467259),Object(s.a)(m)))},h=function(e,t,n,r){e.createFilteredRange({contentTypes:[i.b.CommentThread],filters:p,supportsFilterUpdates:d.j()}).then((function(e){r.dispatch(u.loadDefaultFilter({renderContextType:c.a.None,telemetryVisitor:t,trackback:o.d.reserveTag(528779333)},{filteredRange:e})),n.successTag(520198018),m=!1})).catch((function(e){Object(a.k)().assertConditionTag(!1,"Error creating new filter: ".concat(Object(o.l)(e)),528779334),n.failTag(o.d.reserveTag(520198017),-2147467259),m=!1}))}},28669:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c}));var r,o=n(28091),a=n(28557);!function(e){e[e.None=1]="None",e[e.Error=2]="Error",e[e.RequestDefaultFilter=3]="RequestDefaultFilter",e[e.LoadDefaultFilter=4]="LoadDefaultFilter",e[e.LoadFilter=5]="LoadFilter",e[e.UpdateFilter=6]="UpdateFilter"}(r||(r={}));var i=function(e,t,n){if(e!==r.None){var i=Object(o.k)().createActivityObject("FilterPerfScenario",t,Object(o.j)());return i.addDataField("FilterScenario",e,o.d.SystemMetadata),Object(a.c)(n,i),i}},c=function(e){switch(e){case"LOAD_DEFAULT_FILTER":return r.LoadDefaultFilter;case"LOAD_FILTER":return r.LoadFilter;case"UPDATE_FILTER_RANGE":return r.UpdateFilter;default:return r.None}}},28670:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28560),o=n(28588),a=n(28603),i=function(e){return function(t){return function(n){return function(i){var c,s,d=t.getState(),u=n(i),l=t.getState();switch(i.type){case"BEGIN_DRAFTING_SUCCESS":var f=a.h(l),m=i.payload.draftDetails.sessionConfiguration.draftId;(p=f.drafts[m])&&e.setDeferredActiveEditorFocusCommand(m);break;case"DISPLAY_DRAFT_WARNING":if(i.payload.draftWarningType===o.a.CommitFailed)break;var p;f=a.h(l);(p=Object(r.H)(f))&&e.setDeferredActiveEditorFocusCommand(p.sessionConfiguration.draftId)}return(null===(c=a.t(l))||void 0===c?void 0:c.selectedCardId)===(null===(s=a.t(d))||void 0===s?void 0:s.selectedCardId)&&a.h(l)===a.h(d)||e.clearPendingOnComponentFocusedRequest(),u}}}}},28671:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(28363),o=n(28587),a=n(28280),i=n(28588),c=function(e){return function(t){return function(t){return function(n){switch(n.type){case"DISPLAY_DRAFT_WARNING":if(!a.F())break;var c=o.g(e,n.payload.draftWarningType);Object(r.a)(n.payload.draftWarningType===i.a.ReturnToDraft?e.formatString(230,c):c)}return t(n)}}}}},28672:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n(12708),o=n(28062),a=n(28677),i=n(28091),c=n(28561),s=n(22374),d=n(28583),u=n(28361),l=n(28565),f=n(28665),m=n(28667),p=n(28480),g=n(28556),v=n(28673),h=n(28601),b=n(28557),C=n(28560),y=n(28603),T=n(28606),O=n(28582),I=n(28674),S=n(28676),j=n(28675);function _(e,t){t?e.addDataField("AffectingTaskMetadata",!0,i.d.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,i.d.SystemMetadata)}function k(e,t,n,r){var o=Object(O.b)(t,r);if(o){var a,s=Object(c.j)(o);(a=Object(O.c)(t)?n[s].some((function(e){return 0!=(t[e].commentFlags&c.e.IsNew)})):t.some((function(e){return(e.commentId===s||e.parentId===s)&&0!=(e.commentFlags&c.e.IsNew)})))&&e.addDataField("HasNewComment",a,i.d.SystemMetadata)}}var E=function(e){var t=new I.a(e),n=new S.a(e),O=Object(a.a)((function(e){Object(i.k)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,Object(i.j)()).successTag(573687565)}));return function(e){return function(a){return function(I){var S,E,D=function(){var t,n,r,o,c,s,u=Object(m.b)(I);if(!u)return Object(i.k)().assertConditionTag(!1,"Event name not defined for action type: ".concat(I.type),595616738),a(I);var v=Object(i.k)().createActivityObject(u.name,I.actionDetail.telemetryVisitor,u.activityConfig);v.addDataField("Trackback",I.actionDetail.trackback,i.d.SystemMetadata),v.addDataField("RenderContextType",I.actionDetail.renderContextType,i.d.SystemMetadata),u.logDocumentMetadata&&v.addDocumentMetadata(u.logDocumentMetadata);var h=function(e,t,n){var r=Object(C.h)(e,n);r.valid&&(v.addDataField("MatchesCommentAuthor",r.matchesCurrentUser,i.d.SystemMetadata),v.addDataField("ThreadCreationDeltaMs",r.timeElapsed,i.d.SystemMetadata)),k(v,e,t,n)},O=e.getState(),S=T.b(O);switch(Object(b.c)(O,v),I.type){case"COMMIT_DRAFT":var j=Object(m.a)(I);if(!j)return Object(i.k)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),a(I);var E=Object(i.k)().createActivityObject(j.name,I.actionDetail.telemetryVisitor,Object(i.j)());E.addDataField("RenderContextType",I.actionDetail.renderContextType,i.d.SystemMetadata),E.successTag(595903074);var D=d.b[I.payload.sessionType];v.addDataField("SessionType",D,i.d.SystemMetadata),"REPLY"===I.payload.sessionType&&k(v,y.d(O),y.b(O),I.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":v.addDataField("DraftWarningType",I.payload.draftWarningType,i.d.SystemMetadata),v.addDataField("DraftWarningReason",I.payload.draftWarningReason,i.d.SystemMetadata);var A=Object(C.K)(O.commentState.draftState);A&&v.addDataField("IsDraftInCurrentContext",A.isInCurrentContext,i.d.SystemMetadata);break;case"UPDATE_DRAFT_RENDER_CONTEXT":v.addDataField("IsClaimingDraftLock",I.payload.isClaimingLock,i.d.SystemMetadata),v.addDataField("IsUpdatingAllDraftLocks",!I.payload.draftId,i.d.SystemMetadata);break;case"SELECT_COMMENT":v.addDataField("SelectType",p.SelectActionType[I.payload.selectType],i.d.SystemMetadata),v.addDataField("ActionSource",g.a[I.payload.source],i.d.SystemMetadata);var P=y.t(O),x=!(!P||P.selectedCardId!==I.payload.selectedCard);v.addDataField("IsCurrentCard",x,i.d.SystemMetadata),x||k(v,y.d(O),y.b(O),I.payload.selectedCard),Object(l.b)(I.payload.source)&&Object(l.c)(I.payload.selectType)&&Object(l.d)(v,Object(l.a)(y.e(O,I.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":_(v,I.payload.isTask),h(y.d(O),y.b(O),I.payload.commentId);var w=void 0;if(I.payload.isTask){w="REQUEST_THREAD_RESOLVE"===I.type?"ResolveThreadWithTask":"ReopenThreadWithTask",v.addDataField(w,!0,i.d.SystemMetadata,i.e.Critical);var R=null===(r=null===(n=null===(t=S[I.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===r?void 0:r.time;v.addDataField("TaskCreationTimeDeltaMs",R?Date.now()-R.getTime():0,i.d.SystemMetadata,i.e.Critical)}Object(l.d)(v,Object(l.a)(y.e(O,I.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(_(v,I.payload.isTask),I.payload.isTask){v.addDataField("DeleteThreadWithTask",!0,i.d.SystemMetadata,i.e.Critical);R=null===(s=null===(c=null===(o=S[I.payload.commentId])||void 0===o?void 0:o.history[0])||void 0===c?void 0:c.records[0])||void 0===s?void 0:s.time;v.addDataField("TaskCreationTimeDeltaMs",R?Date.now()-R.getTime():0,i.d.SystemMetadata,i.e.Critical)}Object(l.d)(v,Object(l.a)(y.e(O,I.payload.commentId))),h(y.d(O),y.b(O),I.payload.commentId);break;case"REQUEST_DELETE_POST":h(y.d(O),y.b(O),I.payload.commentId)}try{var F=e.getState(),N=a(I),M=e.getState(),L=y.h(F),B=y.h(M);switch(I.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var V=I.payload.draftId?L.drafts[I.payload.draftId]:Object(C.K)(L),U=I.payload.draftId?B.drafts[I.payload.draftId]:Object(C.K)(B),H=void 0!==V&&void 0!==U&&V.renderContextType!==U.renderContextType;v.addDataField("DidDraftLockUpdate",H,i.d.SystemMetadata)}return v.successTag(595616739),N}catch(q){throw v.failTag(595616768,Object(f.a)(q,-2130957541)),q}};switch(I.type){case"BEGIN_PROCESSING_COMMIT":var A=Object(i.k)().createActivityObject(t.trackerActivityName,I.actionDetail.telemetryVisitor,Object(i.j)());try{D()}catch(G){throw A.failTag(595687567,Object(f.a)(G,-2130957541)),G}if(!(x=y.v(e.getState()))){A.failTag(595687569,-2130957541);break}var P=x.commentDraft.sessionConfiguration;t.beginTracking(P.draftId,d.a[P.sessionType],P.sessionType,A);break;case"COMMIT_FAILURE":var x=y.v(e.getState());Object(i.k)().assertConditionTag(!!x,"Draft should exist when failing a commit.",595132701),x&&t.failTracker(x.commentDraft.sessionConfiguration.draftId,o.d.reserveTag(595132702)),a(I);break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(I.payload.commentId,s.a.Modify,I.type);try{D()}catch(G){throw t.failTracker(I.payload.commentId,o.d.reserveTag(595907670),Object(f.a)(G,-2130957541)),G}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(I.payload.commentId,s.a.Delete,I.type);try{D()}catch(G){throw t.failTracker(I.payload.commentId,o.d.reserveTag(595907671),Object(f.a)(G,-2130957541)),G}break;case"COMMENT_CONTEXT_CHANGED":try{a(I)}catch(G){throw t.failAllTrackers(o.d.reserveTag(595731294),Object(f.a)(G,-2130957541)),G}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":if(("LOAD_COMMENT"===I.type?I.payload.commentData:I.payload.threadInfo).length>0&&!t.getTracker("LoadCommentTracker",s.a.Load)){A=Object(i.k)().createActivityObject(t.trackerActivityName,I.actionDetail.telemetryVisitor,Object(i.j)());t.beginTracking("LoadCommentTracker",s.a.Load,I.type,A,{timeout:j.b,failOnTimeout:!1})}a(I);break;case"RELOAD_COMMENTS":try{D()}catch(G){throw t.failAllTrackers(o.d.reserveTag(595907672),Object(f.a)(G,-2130957541)),G}t.endAllTrackers(o.d.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var w=t.getTracker("LoadCommentTracker",s.a.Load);w&&(w.activity.addDataField("RenderContextType",I.payload.renderContextType,i.d.SystemMetadata),t.endTracker("LoadCommentTracker",s.a.Load,o.d.reserveTag(595646476))),a(I);break;case"APPLY_COMMENT_CHANGES":try{D()}catch(G){throw t.failAllTrackers(o.d.reserveTag(595907674),Object(f.a)(G,-2130957541)),G}try{for(var R=Object(r.__values)(I.payload.changes),F=R.next();!F.done;F=R.next()){var N=F.value;if(N.type===s.a.Load||N.type===s.a.Unknown)break;if(N.type!==s.a.Delete&&N.type!==s.a.Modify){if(N.type===s.a.Insert){void 0!==N.tempId&&""===N.model.parentId&&Object(h.a)(I.actionDetail.telemetryVisitor);var M=N.tempId||N.model.parentId;void 0!==M&&t.endTracker(M,N.type,o.d.reserveTag(595857620))}}else t.endTracker(N.model.commentId,N.type,o.d.reserveTag(595907675))}}catch(z){S={error:z}}finally{try{F&&!F.done&&(E=R.return)&&E.call(R)}finally{if(S)throw S.error}}break;case"COMMIT_DRAFT":x=y.v(e.getState());if(D(),I.payload.data.temporaryCommentId&&x){var L=void 0;switch((P=x.commentDraft.sessionConfiguration).sessionType){case"CREATE":Object(v.a)(I.actionDetail.telemetryVisitor),L=I.payload.data.temporaryCommentId;break;case"REPLY":L=I.payload.data.temporaryCommentId;break;case"EDIT":L=P.commentId;break;case"METADATA":L=P.threadId;break;default:Object(o.m)(P)}L&&t.updateTrackerId(P.draftId,L)}break;case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":D();break;case"SHOW_LOW_FIDELITY_WARNING":D();var B=y.t(e.getState());B&&n.beginTracking(B);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":var V="";switch(I.payload.visibilityState){case u.a.Closed:V="ViewContainerClosed";break;case u.a.Hidden:V="ViewContainerHidden";break;case u.a.Visible:V="ViewContainerVisible";break;default:Object(o.m)(I.payload.visibilityState)}var U=Object(i.k)().createActivityObject(V,I.actionDetail.telemetryVisitor,Object(i.n)({aggregationMode:i.a.Always}));a(I),U.successTag(592241220);break;case"DRAFT_EMPTINESS_CHANGED":var H=y.h(e.getState()).drafts[I.payload.draftId].commentDraft.sessionConfiguration.sessionType;H!==c.c&&H!==c.h||O(I),a(I);break;case"CLEAR_COMMENT_SELECTION":default:a(I)}var q=y.t(e.getState());q&&n.endTrackingIfWarningDismissed(I,q)}}}}},28673:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28601);function o(e){Object(r.a)(e)}},28674:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,o=n(28062),a=n(28091),i=n(28675);function c(e){e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(r||(r={}));var s=function(){function e(e){var t=this;this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(o.activity.failTag(n,null!=r?r:-2130957541),c(o),delete t.performanceActivities[e])},this.timeoutTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(c(o),o.activity.addDataField("Timeout",!0,a.d.SystemMetadata),n.failOnTimeout?o.activity.failTag(r,-2130957491):o.activity.successTag(r),delete t.performanceActivities[e])}}return e.prototype.beginTracking=function(e,t,n,r,c){var s=this;void 0===c&&(c={timeout:i.a,failOnTimeout:!0});var d=r||Object(a.k)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,Object(a.j)());d.addDataField("OperationType",n,a.d.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(a.k)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,o.d.reserveTag(595907678)));var u={activity:d,expectedChangeType:t};u.timerHandle=setTimeout((function(){return s.timeoutTracker(e,c,o.d.reserveTag(575484417))}),c.timeout),this.performanceActivities[e]=u},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(a.k)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,o.d.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(r){var o=n.performanceActivities[r];c(o),o.activity.failTag(e,null!=t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var o=this.performanceActivities[e];o&&(c(o),o.activity.addDataField("ExpectedChangeArrived",o.expectedChangeType===t?r.Yes:r.No,a.d.SystemMetadata),o.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];c(n),n.activity.addDataField("ExpectedChangeArrived",r.Unknown,a.d.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}()},28675:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=5e3,o=1e6},28676:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28091),o=n(28589),a=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(o.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",r.d.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(r.k)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,Object(r.j)()),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(o.b)(t);!this.activity||n===this.selectedCommentId&&Object(o.h)(t)||(this.activity.addDataField("OperationType",e.type,r.d.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}()},28677:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12708);function o(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(e),!1)),t=void 0}}},28678:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(28062),o=n(28091),a=n(22373),i=n(28361),c=n(28298),s=n(28293),d=n(28310),u=n(28280),l=n(28679),f=n(28560),m=n(28598),p=n(28603),g=n(28660),v=n(28607),h=function(e,t){return function(e){return function(n){return function(r){switch(r.type){case"REQUEST_SHOW_PANE":(d=v.d(e.getState())).openView();break;case"REQUEST_CLOSE_PANE":(d=v.d(e.getState())).closeView();break;case"MOVE_FOCUS_TO_CANVAS":if(!g.b(e.getState()))(d=v.d(e.getState())).moveFocusToCanvas_donotuse();break;case"REQUEST_MODAL_CONFIRMATION":(d=v.d(e.getState())).invokeModalConfirmationDialog?d.invokeModalConfirmationDialog(r.payload.onConfirm,r.payload.onCancel,r.payload.displayStrings):(Object(o.k)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),d.closeView());break;case"READY_TO_RENDER":(d=v.d(e.getState())).onReadyToRender&&d.onReadyToRender();break;case"RESOLVE_ATMENTION_CAPABILITY":if(u.z()){var i=r.payload.capability===a.a.Enabled;t.initializeController(i)}break;case"BEGIN_DRAFTING_SUCCESS":var d=v.d(e.getState());Object(s.a)(d)&&"CREATE"===r.payload.draftDetails.sessionConfiguration.sessionType&&C(e.dispatch,r.actionDetail,{displayMode:c.a.Variable,desiredHeight:0}),b(e.getState(),d);break;case"DISPLAY_DRAFT_WARNING":b(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(r.payload.closeOnDiscard){d=v.d(e.getState());return n(r),void d.closeView()}}var l=e.getState(),h=n(r),y=e.getState();return function(e,t,n,r){var o=v.d(r);if(!Object(s.a)(o))return;var a=p.h(r),i=p.h(n),d=Object(m.c)(a),u=Object(m.c)(i),l=!!Object(f.G)(a),g=!!Object(f.G)(i);if(d!==u||!Object(s.a)(v.d(n))||!l&&g){if(!d)return l?void C(e,t,{displayMode:c.a.Variable,desiredHeight:0}):void C(e,t,{displayMode:c.a.Normal});var h=p.t(r);if(h&&h.selectedCardId===Object(f.G)(a))return;C(e,t,{displayMode:c.a.FullScreen})}}(e.dispatch,r.actionDetail,l,y),h}}}};function b(e,t){(function(e){var t=v.e(e);return u.v()&&(u.r()?t===i.a.Hidden:t!==i.a.Visible)})(e)&&(t||v.d(e)).openView()}function C(e,t,n){e(Object(l.a)(t,n)).catch(Object(d.a)(r.d.reserveTag(578426776)))}},28679:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(28062),o=n(28298),a=n(28293),i=n(28310),c=n(28271),s=n(28607),d=n(28680);function u(e,t){return function(n,u){var l=s.d(u());return Object(a.a)(l)&&Object(o.b)(t)?l.setDisplayConfiguration(t).then((function(t){return n(Object(d.a)(e,t)),Promise.resolve(t)})).catch((function(e){return function(e){return Object(i.a)(r.d.reserveTag(578426816))(e),Promise.resolve(void 0)}(e)})):Promise.reject(new c.a("Not half pane or half pane configuration",r.d.reserveTag(577610273),-2130957557))}}},28680:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28481);function o(e,t){return Object(r.b)("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}},28681:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12708),o=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(r.__extends)(t,e),t}(n(28682).a)},28682:function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var r=n(12708),o=n(28062),a=n(28677),i=n(28195),c=n(28406),s=n(28091),d=n(28147),u=n(28170),l=n(28354),f=n(22372),m=n(22376),p=n(22379),g=n(22380),v=n(28424),h=n(28430),b=n(28299),C=n(28309),y=n(28653),T=n(28683),O=n(28684),I=n(28685),S=n(28596),j=n(28686),_=n(28689),k=n(28690),E=n(28716),D=n(28480),A=n(28748),P=n(28749),x=n(28750),w=n(28557),R=n(28560),F=n(28603),N=n(28558),M=n(28607),L=n(28369),B=n(28310),V=n(28280),U=n(28311),H=n(28312),q=n(28751),G=function(){function e(e){var t=e.apiContext,n=e.viewProvider,r=e.commentAPI,c=e.peopleAPI,d=e.localizationAPI,f=e.themeAPI,m=e.focusManager,p=e.lppManager,g=e.initializationReason,v=e.commentStore,h=e.viewStrategyFactory,b=e.mockUIDriver,O=e.contentFilteredRangeAPI,I=e.contentNavigationAPI,j=this;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){j.commentStore.dispatch(D.onInitialRender({renderContextType:C.a.None,trackback:o.d.reserveTag(595646478),telemetryVisitor:j.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(S.b)(e.renderContextType)&&j.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(a.a)((function(){l.a.sendCodeMarker({context:j.apiContext,type:l.b.DataReceived,assertTag:o.d.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case C.a.None:Object(o.n)(!1,"Unexpected render context type:".concat(e),o.d.reserveTag(589088338));case C.a.FullPane:case C.a.HalfPane:return j.getComponentTreeForRenderMode(u.e.TaskPaneItem);case C.a.DiscreteIntegrated:return j.getComponentTreeForRenderMode(u.e.Integrated);case C.a.DiscreteIsolated:return j.getComponentTreeForRenderMode(u.e.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:j.commentAPI,localizationAPI:j.localizationAPI,peopleAPI:j.peopleAPI,focusManager:j.focusManager,telemetryVisitor:j.telemetryVisitor,onInitialRender:j.onInitialRender,correlationId:j.correlationId,lppManager:j.lppManager}},this.setComponentRef=function(e,t,n){j.viewManagerRefRegistry.registerComponent(e,t,n)},this.onSuggestionsDetailsChange=function(e){j.commentStore.dispatch(D.updateSuggestionsDetails({renderContextType:C.a.None,trackback:o.d.reserveTag(592492758),telemetryVisitor:j.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return j.activeViewStrategy.handleCommentInterruptableCommand(e,j.commentStore.dispatch,j.commentStore.getState)},this.createOrUpdateFilter=function(e){var t=j.contentFilteredRangeAPI;if(t&&Object(N.g)(j.commentStore.getState())){var n=N.h(j.commentStore.getState());if(Object(s.k)().assertConditionTag(n||!!Object(N.e)(j.commentStore.getState()),"We should have a default filter already or a default filter request should be in flight.",528779339),!n){var r=Object(w.a)(j.commentStore.getState());r?j.updateFilter(r,e):j.createFilter(t,e)}}else Object(s.k)().assertConditionTag(!1,"Should not request new filter with gate off",528779338)},this.updateFilter=function(e,t){j.commentStore.dispatch(D.updateFilterRange({renderContextType:C.a.FullPane,telemetryVisitor:j.telemetryVisitor,trackback:o.d.reserveTag(528779344)},{filterId:e,changes:[{type:"FilterUpdate",updatedFilter:t}]}))},this.createFilter=function(e,t){e.createFilteredRange({contentTypes:[u.b.CommentThread],filters:t,supportsFilterUpdates:!0}).then((function(e){j.commentStore.dispatch(D.loadFilter({renderContextType:C.a.FullPane,telemetryVisitor:j.telemetryVisitor,trackback:o.d.reserveTag(528779340)},{filteredRange:e,shouldSetActive:!0}))})).catch(Object(B.a)(o.d.reserveTag(528779341)))},this.apiContext=t,this.viewProvider=n,this.commentAPI=r,this.peopleAPI=c,this.localizationAPI=d,this.themeAPI=f,this.focusManager=m,this.contentFilteredRangeAPI=O,this.contentNavigationAPI=I,this.lastInitializationReason=g,this.viewStrategyFactory=h,this.mockUIDriver=b,this.telemetryVisitor=H.a.getTelemetryVisitor(this.apiContext),this.correlationId=H.a.getCorrelationId(this.apiContext)||Object(i.a)(),this.lppManager=p,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new T.a(v,this.telemetryVisitor,!!this.contentNavigationAPI);var _=v.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(_.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=v,this.discreteIntegratedComponentTree=new y.a(C.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new y.a(C.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new q.a,this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new E.a(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){(0,this.commentStore.dispatch)(Object(x.a)({renderContextType:C.a.None,trackback:o.d.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},this.commentAPI)).catch(Object(B.a)(o.d.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t=this;this.initialized||(this.contentNavigationAPI&&(this.commentStore.dispatch(D.setContentNavigationEnablement({renderContextType:C.a.None,trackback:o.d.reserveTag(526405722),telemetryVisitor:this.telemetryVisitor},!0)),null===(e=this.contentFilteredRangeAPI)||void 0===e||e.getCapabilities().then((function(e){t.commentStore.dispatch(D.setFilteringCapabilities({renderContextType:C.a.None,trackback:o.d.reserveTag(537421135),telemetryVisitor:t.telemetryVisitor},{capabilities:e}))})).catch(Object(B.a)(o.d.reserveTag(528779335)))),this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),V.r()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.peopleAPI.capabilities&c.b.GetSuggestionsDetails&&(this.commentStore.dispatch(Object(A.a)({renderContextType:C.a.None,trackback:o.d.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},this.peopleAPI)).catch(Object(B.a)(o.d.reserveTag(592492754))),Object(s.k)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===F.q(e)&&F.l(e)&&this.onFirstLoadComplete()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var r=e.getState(),o=F.q(r);o!==t&&(t=o,n.onChange(r))}))},e.prototype.onFirstLoadComplete=function(){var e=this;Object(s.k)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(p.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case u.e.Integrated:return this.discreteIntegratedComponentTree;case u.e.Isolated:return this.discreteIsolatedComponentTree;case u.e.TaskPane:case u.e.TaskPaneItem:return M.c(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId,createOrUpdateFilter:this.createOrUpdateFilter})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,r){t.setComponentRef(e,n,r)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(e,t,n){var o=this,a=Object(_.a)(n.HostableCommentCardRendererContainer,Object(r.__assign)({},this.getHostableCommentCardRendererProps(e))),i=Object(k.a)(a,this.commentStore),c=Object(U.e)(t,this.apiContext),s=Object(d.d)().registerComponent(c,i);return s.onComponentCommand.subscribe((function(t){o.processHostableComponentCommand(t,e)})),{componentController:s,contextAwareName:c}},e.prototype.initializeContentExtensions=function(){var e=this;Object(L.d)("ExtensionAwareCommentPaneContainer").then((function(t){var n,a=t;if(void 0!==a){var i=Object(_.a)(a.ExtensionAwareCommentPane,Object(r.__assign)(Object(r.__assign)({},e.getPaneOwnProps()),{extensionRenderMode:u.e.Integrated,themeAPI:e.themeAPI})),c=Object(k.a)(i,e.commentStore),s=Object(U.e)(U.a,e.apiContext);e.commentPaneComponentController=Object(d.d)().registerComponent(s,c),V.L()&&e.commentStore.dispatch(Object(P.a)({renderContextType:C.a.None,trackback:o.d.reserveTag(573384478),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,s,{renderMode:u.e.TaskPane,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:void 0})).catch(Object(B.a)(o.d.reserveTag(573384479)))}Object(L.d)("HostableCommentCardRendererContainer").then((function(t){if(void 0!==(n=t)){var r=e.registerCommentCardHostableComponent(u.e.Integrated,U.b,n),a=r.componentController,i=r.contextAwareName;e.discreteIntegratedComponentController=a;var c=e.registerCommentCardHostableComponent(u.e.Isolated,U.c,n),s=c.componentController,d=c.contextAwareName;e.discreteIsolatedComponentController=s;var l=e.registerCommentCardHostableComponent(u.e.TaskPaneItem,U.d,n),f=l.componentController,m=l.contextAwareName;e.commentPaneItemComponentController=f,e.commentStore.dispatch(Object(P.a)({renderContextType:C.a.None,trackback:o.d.reserveTag(574428426),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,i,{renderMode:u.e.Integrated,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(B.a)(o.d.reserveTag(595645980))),e.commentStore.dispatch(Object(P.a)({renderContextType:C.a.None,trackback:o.d.reserveTag(595616916),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,d,{renderMode:u.e.Isolated,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize(),isContentAvailable:function(t){var n=e.commentStore.getState(),r=Object(I.d)(t,F.a(n),F.c(n)),o=F.h(n);return Object(I.a)(t,Object(I.c)(t,F.d(n),F.b(n),r,F.g(n,!0),o.drafts[t],Object(R.G)(o)),o,C.a.DiscreteIsolated,Object(O.a)(t,C.a.DiscreteIsolated,o))}})).catch(Object(B.a)(o.d.reserveTag(595645982))),e.commentStore.dispatch(Object(P.a)({renderContextType:C.a.None,trackback:o.d.reserveTag(546174344),telemetryVisitor:e.telemetryVisitor},u.b.CommentThread,m,{renderMode:u.e.TaskPaneItem,priority:u.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(B.a)(o.d.reserveTag(546174345)))}})).catch(Object(B.a)(o.d.reserveTag(595645984)))})).catch(Object(B.a)(o.d.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:j.a,height:Object(j.b)({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n=this;switch(e.command){case"Focus":return void setTimeout((function(){var r;return null===(r=n.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===r?void 0:r.focus()}));case"UpdateComponentDataProps":break;default:return void Object(s.k)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){var e,t,n,a,i=[u.e.Integrated,u.e.Isolated,u.e.TaskPaneItem];V.L()&&i.push(u.e.TaskPane),this.commentStore.dispatch(D.removeContentExtensions.apply(D,Object(r.__spreadArray)([{renderContextType:C.a.None,trackback:o.d.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],Object(r.__read)(i),!1))),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.commentPaneItemComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIntegratedComponentController)||void 0===n||n.unregister(),null===(a=this.discreteIsolatedComponentController)||void 0===a||a.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(p.a.AddComment),this.commentAPI.unregisterForAction(p.a.NextThread),this.commentAPI.unregisterForAction(p.a.PreviousThread),this.commentAPI.unregisterForAction(p.a.DeleteThread),this.commentAPI.unregisterForAction(p.a.BackKeyPressed),this.commentAPI.unregisterForAction(p.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&c.b.GetSuggestionsDetails&&(Object(s.k)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),V.r()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(V.r()&&e.actionBehavior===f.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var o=Object(r.__values)(this.commentUIActionListeners),a=o.next();!a.done;a=o.next()){var i=(0,a.value)(e);if(i!==v.a.NotHandled)return i===v.a.Success}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===v.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n=Object(o.k)(o.b.Comments,m.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),V.r()&&!this.initialLoadComplete&&e===m.a.CommentContextChanged&&h.b(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(g.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==g.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case b.a.VisibilityChanged:return void n(D.viewContainerVisibilityChanged({renderContextType:C.a.None,trackback:o.d.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case b.a.ViewContainerChanged:return n(D.viewContainerChanged({renderContextType:C.a.None,trackback:o.d.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case b.a.FocusTriggered:return void(V.L()?setTimeout((function(){t.focusManager.focusCommentPaneCommand(M.c(t.commentStore.getState()))})):this.focusManager.focusCommentPaneCommand(M.c(this.commentStore.getState())));case b.a.FoldableLayoutStateChanged:n(D.viewContainerFoldableLayoutStateChanged({renderContextType:C.a.None,trackback:o.d.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}()},28683:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(28280),o=n(28556),a=n(28603),i=n(28607),c=n(28609),s=n(28615),d=n(28627),u=function(){function e(e,t,n){this.commentStore=e,this.commandFactory=new d.a(this.commentStore,t,n)}return e.prototype.selectNextOrPreviousThread=function(e,t,n){var o=r.r()&&!i.a(this.commentStore.getState()),a=i.c(this.commentStore.getState());return s.a(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,n,o),a,this.commentStore,(function(){}))===c.a.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=i.c(this.commentStore.getState()),c=a.f(this.commentStore.getState()),d=r.r()&&!i.a(this.commentStore.getState());s.a(this.commandFactory.selectAcrossContexts(void 0,{direction:e,source:o.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},t,c.nextPopulatedContextDetails,d),n,this.commentStore,(function(){}))},e}()},28684:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28280),o=n(28560),a=n(28591);function i(e,t,n){var i=Object(o.K)(n);if(i)return i.threadId!==e?a.a.InOtherCard:r.r()&&i.renderContextType!==t?a.a.InOtherContextOfThisCard:"EDIT"===i.commentDraft.sessionConfiguration.sessionType?a.a.InChildPost:a.a.InCard}},28685:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return C})),n.d(t,"a",(function(){return y}));var r,o=n(12708),a=n(28062),i=n(28630),c=n(28091),s=n(28170),d=n(28564),u=n(28432),l=n(28280),f=n(28560),m=n(28598),p=n(28582),g=n(28591),v=n(28309);function h(e,t,n){var r;if(Object(p.f)(t))return t.find((function(t){var r;return t===e||(null===(r=n[t])||void 0===r?void 0:r.alternateId)===e}));for(var o,a=new d.a(t,-1);!(o=a.next()).done;){var i=o.value.commentId,c=n[i];if((null==c?void 0:c.alternateId)===e||i===e)break}return null===(r=o.value)||void 0===r?void 0:r.commentId}function b(e,t,n){var r=Object(p.b)(t,e);return r?Object(f.z)(t,n,Object(u.b)(r)):[]}function C(e,t,n,s,d,m,p){var g,v;if(!l.W()){if(d&&p===e)return{thread:[d.newComment_deprecated],isDraftThread:!0,draftThreadState:m};Object(c.k)().assertConditionTag(!m||!m.isInCurrentContext||"CREATE"!==m.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370)}var h=s||e,b=Object(f.z)(t,n,h);b.length>0&&void 0===Object(u.a)(b[0])&&(null===(v=(g=Object(c.k)()).logDiagnosticTrace)||void 0===v||v.call(g,Object(i.a)(r||(r=Object(o.__makeTemplateObject)(["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."],["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."]))),a.d.reserveTag(540575834),c.h.Info,c.c.ProductServiceUsage,Object(c.l)(c.g.ReviewedAsNotNecessary)),b=[]);var C=l.W()&&p===h;return{thread:b,isDraftThread:C,draftThreadState:C?m:void 0}}function y(e,t,n,r,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===v.a.None||t.draftThreadState.renderContextType===r?s.a.Enabled_ForcePrimary:s.a.Disabled;if(t.isDraftThread||t.thread.length>0)return o===g.a.InCard||o===g.a.InChildPost?s.a.Enabled_ForcePrimary:s.a.Enabled_Default;if(Object(m.k)(n))return s.a.Disabled;var a=Object(f.K)(n);return a&&a.threadId===e?s.a.Disabled:s.a.Invalid}},28686:function(e,t,n){"use strict";var r=n(28687);n.d(t,"a",(function(){return r.b}));var o=n(28688);n.d(t,"b",(function(){return o.a}))},28687:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r=0,o=259,a={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function i(){return a}},28688:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28687);function o(e){var t=e.itemCount,n=e.readOnly,o=e.isTask,a=Object(r.c)(),i=a.PostHeight;return t>1&&(i+=a.PostHeight+r.a),t>2&&(i+=a.ExpandButtonHeight+r.a),n||(i+=a.ReplyDraftHeight+r.a),o&&(i+=a.TaskTopper),i}},28689:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(12708),o=n(11766);function a(e,t){return function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(a,n),a.prototype.render=function(){var n=Object(r.__assign)(Object(r.__assign)({},t),this.props);return o.createElement(e,n)},a}(o.PureComponent)}},28690:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12708),o=n(11766),a=n(28691);function i(e,t){return function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(i,n),i.prototype.render=function(){return o.createElement(a.Provider,{store:t},o.createElement(e,Object(r.__assign)({},this.props)))},i}(o.PureComponent)}},28691:function(e,t,n){"use strict";n.r(t);var r=n(28692);n.d(t,"Provider",(function(){return r.a})),n.d(t,"connectAdvanced",(function(){return r.d})),n.d(t,"ReactReduxContext",(function(){return r.b})),n.d(t,"connect",(function(){return r.c})),n.d(t,"useDispatch",(function(){return r.i})),n.d(t,"createDispatchHook",(function(){return r.e})),n.d(t,"useSelector",(function(){return r.j})),n.d(t,"createSelectorHook",(function(){return r.f})),n.d(t,"useStore",(function(){return r.k})),n.d(t,"createStoreHook",(function(){return r.g})),n.d(t,"shallowEqual",(function(){return r.h}));var o=n(28715);n.d(t,"batch",(function(){return o.a}));var a=n(28696);Object(a.b)(o.a)},28692:function(e,t,n){"use strict";var r=n(28693);n.d(t,"a",(function(){return r.a}));var o=n(28698);n.d(t,"d",(function(){return o.a}));var a=n(28694);n.d(t,"b",(function(){return a.a}));var i=n(28699);n.d(t,"c",(function(){return i.a}));var c=n(28711);n.d(t,"i",(function(){return c.b})),n.d(t,"e",(function(){return c.a}));var s=n(28714);n.d(t,"j",(function(){return s.b})),n.d(t,"f",(function(){return s.a}));var d=n(28712);n.d(t,"k",(function(){return d.b})),n.d(t,"g",(function(){return d.a}));var u=n(28700);n.d(t,"h",(function(){return u.a}))},28693:function(e,t,n){"use strict";var r=n(11766),o=n.n(r),a=(n(12237),n(28694)),i=n(28695),c=n(28697);t.a=function(e){var t=e.store,n=e.context,s=e.children,d=Object(r.useMemo)((function(){var e=Object(i.a)(t);return{store:t,subscription:e}}),[t]),u=Object(r.useMemo)((function(){return t.getState()}),[t]);Object(c.a)((function(){var e=d.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),u!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[d,u]);var l=n||a.a;return o.a.createElement(l.Provider,{value:d},s)}},28694:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11766),o=n.n(r).a.createContext(null)},28695:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28696);var o={notify:function(){},get:function(){return[]}};function a(e,t){var n,a=o;function i(){s.onStateChange&&s.onStateChange()}function c(){var o,c,s;n||(n=t?t.addNestedSub(i):e.subscribe(i),o=Object(r.a)(),c=null,s=null,a={clear:function(){c=null,s=null},notify:function(){o((function(){for(var e=c;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],t=c;t;)e.push(t),t=t.next;return e},subscribe:function(e){var t=!0,n=s={callback:e,next:null,prev:s};return n.prev?n.prev.next=n:c=n,function(){t&&null!==c&&(t=!1,n.next?n.next.prev=n.prev:s=n.prev,n.prev?n.prev.next=n.next:c=n.next)}}})}var s={addNestedSub:function(e){return c(),a.subscribe(e)},notifyNestedSubs:function(){a.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:c,tryUnsubscribe:function(){n&&(n(),n=void 0,a.clear(),a=o)},getListeners:function(){return a}};return s}},28696:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=function(e){e()},o=function(e){return r=e},a=function(){return r}},28697:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11766),o="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect},28698:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(11778),o=n(11777),a=n(11784),i=n.n(a),c=n(11766),s=n.n(c),d=n(13612),u=n(28695),l=n(28697),f=n(28694),m=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],p=["reactReduxForwardedRef"],g=[],v=[null,null];function h(e,t){var n=e[1];return[t.payload,n+1]}function b(e,t,n){Object(l.a)((function(){return e.apply(void 0,t)}),n)}function C(e,t,n,r,o,a,i){e.current=r,t.current=o,n.current=!1,a.current&&(a.current=null,i())}function y(e,t,n,r,o,a,i,c,s,d){if(e){var u=!1,l=null,f=function(){if(!u){var e,n,f=t.getState();try{e=r(f,o.current)}catch(m){n=m,l=m}n||(l=null),e===a.current?i.current||s():(a.current=e,c.current=e,i.current=!0,d({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=f,n.trySubscribe(),f();return function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,l)throw l}}}var T=function(){return[null,0]};function O(e,t){void 0===t&&(t={});var n=t,a=n.getDisplayName,l=void 0===a?function(e){return"ConnectAdvanced("+e+")"}:a,O=n.methodName,I=void 0===O?"connectAdvanced":O,S=n.renderCountProp,j=void 0===S?void 0:S,_=n.shouldHandleStateChanges,k=void 0===_||_,E=n.storeKey,D=void 0===E?"store":E,A=(n.withRef,n.forwardRef),P=void 0!==A&&A,x=n.context,w=void 0===x?f.a:x,R=Object(o.a)(n,m),F=w;return function(t){var n=t.displayName||t.name||"Component",a=l(n),f=Object(r.a)({},R,{getDisplayName:l,methodName:I,renderCountProp:j,shouldHandleStateChanges:k,storeKey:D,displayName:a,wrappedComponentName:n,WrappedComponent:t}),m=R.pure;var O=m?c.useMemo:function(e){return e()};function S(n){var a=Object(c.useMemo)((function(){var e=n.reactReduxForwardedRef,t=Object(o.a)(n,p);return[n.context,e,t]}),[n]),i=a[0],l=a[1],m=a[2],I=Object(c.useMemo)((function(){return i&&i.Consumer&&Object(d.isContextConsumer)(s.a.createElement(i.Consumer,null))?i:F}),[i,F]),S=Object(c.useContext)(I),j=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(S)&&Boolean(S.store);var _=j?n.store:S.store,E=Object(c.useMemo)((function(){return function(t){return e(t.dispatch,f)}(_)}),[_]),D=Object(c.useMemo)((function(){if(!k)return v;var e=Object(u.a)(_,j?null:S.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[_,j,S]),A=D[0],P=D[1],x=Object(c.useMemo)((function(){return j?S:Object(r.a)({},S,{subscription:A})}),[j,S,A]),w=Object(c.useReducer)(h,g,T),R=w[0][0],N=w[1];if(R&&R.error)throw R.error;var M=Object(c.useRef)(),L=Object(c.useRef)(m),B=Object(c.useRef)(),V=Object(c.useRef)(!1),U=O((function(){return B.current&&m===L.current?B.current:E(_.getState(),m)}),[_,R,m]);b(C,[L,M,V,m,U,B,P]),b(y,[k,_,A,E,L,M,V,B,P,N],[_,A,E]);var H=Object(c.useMemo)((function(){return s.a.createElement(t,Object(r.a)({},U,{ref:l}))}),[l,t,U]);return Object(c.useMemo)((function(){return k?s.a.createElement(I.Provider,{value:x},H):H}),[I,H,x])}var _=m?s.a.memo(S):S;if(_.WrappedComponent=t,_.displayName=S.displayName=a,P){var E=s.a.forwardRef((function(e,t){return s.a.createElement(_,Object(r.a)({},e,{reactReduxForwardedRef:t}))}));return E.displayName=a,E.WrappedComponent=t,i()(E,t)}return i()(_,t)}}},28699:function(e,t,n){"use strict";var r=n(11778),o=n(11777),a=n(28698),i=n(28700),c=n(28701),s=n(28707),d=n(28708),u=n(28709),l=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function f(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function m(e,t){return e===t}function p(e){var t=void 0===e?{}:e,n=t.connectHOC,p=void 0===n?a.a:n,g=t.mapStateToPropsFactories,v=void 0===g?s.a:g,h=t.mapDispatchToPropsFactories,b=void 0===h?c.a:h,C=t.mergePropsFactories,y=void 0===C?d.a:C,T=t.selectorFactory,O=void 0===T?u.a:T;return function(e,t,n,a){void 0===a&&(a={});var c=a,s=c.pure,d=void 0===s||s,u=c.areStatesEqual,g=void 0===u?m:u,h=c.areOwnPropsEqual,C=void 0===h?i.a:h,T=c.areStatePropsEqual,I=void 0===T?i.a:T,S=c.areMergedPropsEqual,j=void 0===S?i.a:S,_=Object(o.a)(c,l),k=f(e,v,"mapStateToProps"),E=f(t,b,"mapDispatchToProps"),D=f(n,y,"mergeProps");return p(O,Object(r.a)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:k,initMapDispatchToProps:E,initMergeProps:D,pure:d,areStatesEqual:g,areOwnPropsEqual:C,areStatePropsEqual:I,areMergedPropsEqual:j},_))}}t.a=p()},28700:function(e,t,n){"use strict";function r(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function o(e,t){if(r(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(var a=0;a<n.length;a++)if(!Object.prototype.hasOwnProperty.call(t,n[a])||!r(e[n[a]],t[n[a]]))return!1;return!0}n.d(t,"a",(function(){return o}))},28701:function(e,t,n){"use strict";var r=n(28702),o=n(28703);t.a=[function(e){return"function"==typeof e?Object(o.b)(e,"mapDispatchToProps"):void 0},function(e){return e?void 0:Object(o.a)((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?Object(o.a)((function(t){return Object(r.a)(e,t)})):void 0}]},28702:function(e,t,n){"use strict";function r(e,t){var n={},r=function(r){var o=e[r];"function"==typeof o&&(n[r]=function(){return t(o.apply(void 0,arguments))})};for(var o in e)r(o);return n}n.d(t,"a",(function(){return r}))},28703:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));n(28704);function r(e){return function(t,n){var r=e(t,n);function o(){return r}return o.dependsOnOwnProps=!1,o}}function o(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function a(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=o(e);var a=r(t,n);return"function"==typeof a&&(r.mapToProps=a,r.dependsOnOwnProps=o(a),a=r(t,n)),a},r}}},28704:function(e,t,n){"use strict";n(28705),n(28706)},28705:function(e,t,n){"use strict";function r(e){if("object"!=typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}n.d(t,"a",(function(){return r}))},28706:function(e,t,n){"use strict";function r(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(t){}}n.d(t,"a",(function(){return r}))},28707:function(e,t,n){"use strict";var r=n(28703);t.a=[function(e){return"function"==typeof e?Object(r.b)(e,"mapStateToProps"):void 0},function(e){return e?void 0:Object(r.a)((function(){return{}}))}]},28708:function(e,t,n){"use strict";var r=n(11778);n(28704);function o(e,t,n){return Object(r.a)({},n,e,t)}t.a=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var r,o=n.pure,a=n.areMergedPropsEqual,i=!1;return function(t,n,c){var s=e(t,n,c);return i?o&&a(s,r)||(r=s):(i=!0,r=s),r}}}(e):void 0},function(e){return e?void 0:function(){return o}}]},28709:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11777),o=(n(28710),["initMapStateToProps","initMapDispatchToProps","initMergeProps"]);function a(e,t,n,r){return function(o,a){return n(e(o,a),t(r,a),a)}}function i(e,t,n,r,o){var a,i,c,s,d,u=o.areStatesEqual,l=o.areOwnPropsEqual,f=o.areStatePropsEqual,m=!1;function p(o,m){var p,g,v=!l(m,i),h=!u(o,a,m,i);return a=o,i=m,v&&h?(c=e(a,i),t.dependsOnOwnProps&&(s=t(r,i)),d=n(c,s,i)):v?(e.dependsOnOwnProps&&(c=e(a,i)),t.dependsOnOwnProps&&(s=t(r,i)),d=n(c,s,i)):h?(p=e(a,i),g=!f(p,c),c=p,g&&(d=n(c,s,i)),d):d}return function(o,u){return m?p(o,u):(c=e(a=o,i=u),s=t(r,i),d=n(c,s,i),m=!0,d)}}function c(e,t){var n=t.initMapStateToProps,c=t.initMapDispatchToProps,s=t.initMergeProps,d=Object(r.a)(t,o),u=n(e,d),l=c(e,d),f=s(e,d);return(d.pure?i:a)(u,l,f,e,d)}},28710:function(e,t,n){"use strict";n(28706)},28711:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(28694),o=n(28712);function a(e){void 0===e&&(e=r.a);var t=e===r.a?o.b:Object(o.a)(e);return function(){return t().dispatch}}var i=a()},28712:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var r=n(11766),o=n(28694),a=n(28713);function i(e){void 0===e&&(e=o.a);var t=e===o.a?a.a:function(){return Object(r.useContext)(e)};return function(){return t().store}}var c=i()},28713:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(11766),o=n(28694);function a(){return Object(r.useContext)(o.a)}},28714:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var r=n(11766),o=n(28713),a=n(28695),i=n(28697),c=n(28694),s=function(e,t){return e===t};function d(e){void 0===e&&(e=c.a);var t=e===c.a?o.a:function(){return Object(r.useContext)(e)};return function(e,n){void 0===n&&(n=s);var o=t(),c=function(e,t,n,o){var c,s=Object(r.useReducer)((function(e){return e+1}),0)[1],d=Object(r.useMemo)((function(){return Object(a.a)(n,o)}),[n,o]),u=Object(r.useRef)(),l=Object(r.useRef)(),f=Object(r.useRef)(),m=Object(r.useRef)(),p=n.getState();try{if(e!==l.current||p!==f.current||u.current){var g=e(p);c=void 0!==m.current&&t(g,m.current)?m.current:g}else c=m.current}catch(v){throw u.current&&(v.message+="\nThe error may be correlated with this previous error:\n"+u.current.stack+"\n\n"),v}return Object(i.a)((function(){l.current=e,f.current=p,m.current=c,u.current=void 0})),Object(i.a)((function(){function e(){try{var e=n.getState();if(e===f.current)return;var r=l.current(e);if(t(r,m.current))return;m.current=r,f.current=e}catch(v){u.current=v}s()}return d.onStateChange=e,d.trySubscribe(),e(),function(){return d.tryUnsubscribe()}}),[n,d]),c}(e,n,o.store,o.subscription);return Object(r.useDebugValue)(c),c}}var u=d()},28715:function(e,t,n){"use strict";var r=n(11769);n.d(t,"a",(function(){return r.unstable_batchedUpdates}))},28716:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var r=n(12708),o=n(28062),a=n(28195),i=n(28747),c=n(28091),s=n(28170),d=n(28340),u=n(13055),l=n(28566),f=n(22380),m=n(28717),p=n(28718),g=n(28592),v=n(28309),h=n(28610),b=n(28734),C=n(28740),y=n(28737),T=n(28604),O=n(28605),I=n(28310),S=n(28665),j=n(28280),_=n(28741),k=n(28556),E=n(28742),D=n(28560),A=n(28598),P=n(28603),x=n(28607),w=n(28606),R=n(28582),F=n(28743),N=n(28744),M=n(28745),L=n(28746),B=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=M.a.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(e){return x.a(e)?x.c(e):n.viewManager.getComponentTreeForRenderMode(s.e.Integrated)},this.makeGetRenderableItemThreads=function(e){return Object(u.a)([P.h,P.g,P.c,e,n.getActiveComponentTree],(function(e,t,n,r,o){return T.c(r,n,t,o.componentTreeId.renderContextType!==v.a.HalfPane,Object(C.a)(e,o.componentTreeId.renderContextType))}))},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getHostableCommentCardRendererProps(s.e.Integrated)),{resource:{id:e},componentInstanceId:Object(a.a)()})},this.getCompletePaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),r=n.commentStore.dispatch;return x.a(t)?Object(p.b)(r,n.getCompletePaneOwnProps()):Object(p.a)(r,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){return Object(D.G)(P.h(n.commentStore.getState()),!0)},this.getParentId=function(e){var t=n.commentStore.getState(),r=P.d(t),o=Object(R.b)(r,e);return o?Object(l.h)(o):void 0},this.invokeModalDialog=function(e,t,r){var a=n.commentStore.getState(),i={renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,trackback:o.d.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},c=n.commentStore.dispatch,s=n.getCompletePaneOwnProps(),d=Object(p.b)(c,s),u=P.t(a);switch(e){case g.a.CancelNewDraft:case g.a.CancelReplyDraft:case g.a.CancelPostEdit:return d.discardDraftAsync(i,k.a.SharedComments,!1);case g.a.DeleteThread:return u&&d.requestDeleteThread(i,u.selectedCardId),Promise.resolve(f.a.Handled);case g.a.ClosePaneDraft:return b.p({ownProps:s,dispatchProps:d,componentTree:n.getActiveComponentTree(a),draftState:P.h(a),invokeModalDialog:n.invokeModalDialog}),Promise.resolve(f.a.Handled);default:Object(o.m)(e)}},this.updateEventProcessingState=function(e){var t=P.q(n.previousStoreState),r=P.q(e);!t&&r&&n.pauseProcessing(),t&&!r&&n.beginProcessing()},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=P.h(e),r=P.h(n.previousStoreState);!Object(A.d)(t)&&n.pendingActionReason===M.a.NeedNotDrafting&&n.pendingAction&&(Object(c.k)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent})).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=M.a.None);var o=Object(A.b)(t),a=Object(A.b)(r);o&&!a&&n.pendingActionReason===M.a.NeedDrafting&&n.pendingAction&&(Object(c.k)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent})).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=M.a.None),n.updateEventProcessingState(e),n.previousStoreState=e},this.onDrafting=function(e){var t=Object(c.k)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent}));Object(A.b)(P.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!1,c.d.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,c.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=M.a.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(c.k)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent}));Object(A.d)(P.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!0,c.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=M.a.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,c.d.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case M.a.NeedDrafting:return n.onDrafting(t);case M.a.NeedNotDrafting:return n.onNotDrafting(t);case M.a.None:return t()}},this.onMockUIAction=new i.a((function(e){var t=Object(c.k)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent}));t.addDataField("MockUIActionType",e.actionType,c.d.SystemMetadata);try{switch(e.actionType){case m.a.CreateThread:m.f(e)?n.runAction(M.a.NeedDrafting,(function(){return n.onCreateOrReply(new F.a(n.getNewThreadDraftId(),e.content))})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464);break;case m.a.CancelCreateThread:m.b(e)?n.runAction(M.a.NeedDrafting,(function(){return n.onCancelCreateThread(new F.a(n.getNewThreadDraftId()))})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465);break;case m.a.StartReplySession:m.o(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onStartReplySession(new F.a(e.threadId))})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466);break;case m.a.CancelReplySession:m.d(e)?n.runAction(M.a.NeedDrafting,(function(){return n.onCancelReplySession(new F.a(e.threadId))})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467);break;case m.a.PostReply:m.j(e)?n.runAction(M.a.NeedDrafting,(function(){return n.onCreateOrReply(new F.a(e.threadId,e.content))})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468);break;case m.a.DeleteComment:m.g(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469);break;case m.a.DeleteThread:m.h(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470);break;case m.a.ResolveThread:m.l(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471);break;case m.a.ReopenThread:m.k(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472);break;case m.a.StartEditSession:m.n(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473);break;case m.a.CancelEditSession:m.c(e)?n.runAction(M.a.NeedDrafting,(function(){return n.onCancelEditSession(new N.a(e.commentId))})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474);break;case m.a.PostEdit:if(m.i(e)){var r=new N.a(e.commentId);r.setContents(e.content),n.runAction(M.a.NeedDrafting,(function(){return n.onPostEdit(r)}))}else Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case m.a.SelectComment:m.m(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onSelectComment(new L.a(e.commentId))})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504);break;case m.a.ClosePane:n.onClosePane();break;case m.a.ClickGhostCard:m.e(e)?n.runAction(M.a.NeedNotDrafting,(function(){return n.onGhostCommentClicked()})):Object(c.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505);break;default:Object(o.m)(e.actionType)}}catch(a){return void t.failTag(592269507,Object(S.a)(a))}t.successTag(592269508)})),this.onStartEditSession=function(e){var t=n.commentStore.getState();b.E({trackback:o.d.reserveTag(592269509),id:e,data:n.getFilteredRenderableItems(t),selectedComment:P.t(t),renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){var r=n.commentStore.getState();b.m({componentTree:n.getActiveComponentTree(r),focusManager:n.viewManager.getFocusManager(),trackback:o.d.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree(r).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(x.b(e)){var t=n.commentStore.dispatch;Object(p.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:v.a.None,trackback:o.d.reserveTag(592269511)})}else Object(c.k)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),r=n.commentStore.getState(),a=P.h(r),i=Object(D.K)(a),c=i&&"CREATE"===i.commentDraft.sessionConfiguration.sessionType?{type:"CREATE"}:{type:"REPLY",parentId:t};b.c({trackback:o.d.reserveTag(592269513),commentCardRef:e,draftState:a,areMentionsEnabled:P.p(r).atMention===l.b.Enabled,session:c,componentTree:n.getActiveComponentTree(r),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:E.a.Programmatic}).catch(Object(I.a)(o.d.reserveTag(592269514)))},this.onCancelCreateThread=function(e){var t=e.getId(),r=n.getDispatchProps(t),a=n.commentStore.getState(),i=P.t(a),c=P.h(a),s=x.b(a),d=n.getActiveComponentTree(a).componentTreeId.renderContextType,u=P.u(a),l=(null==i?void 0:i.selectedCardId)===e.getId()&&Object(y.b)(s,d,c,i,u),f=T.f(n.getRenderableItemThreads(a),t);b.e({trackback:o.d.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(a),dispatchProps:r,closeOnDiscard:l,cardId:t,draftState:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:f})},this.onGhostCommentClicked=function(){var e=n.commentStore.getState();x.b(e)||Object(c.k)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(d.d.Next,n.getActiveComponentTree(e).componentTreeId.renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),r=n.getParentId(e.getId());r&&b.C({trackback:o.d.reserveTag(592269518),id:e.getId(),data:n.getFilteredRenderableItems(t),draftState:P.h(t),contentPromise:e.getContentsAsync(),atMentionsEnabled:P.p(t).atMention===l.b.Enabled,componentTree:n.getActiveComponentTree(t),actionDispatchers:n.getDispatchProps(r),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:E.a.Programmatic}).catch(Object(I.a)(o.d.reserveTag(592269519)))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),r=P.h(t),a=P.t(t),i=x.b(t),c=P.u(t),s=Object(y.b)(i,n.getActiveComponentTree(t).componentTreeId.renderContextType,r,a,c),d=n.getFilteredRenderableItems(t),u=n.getParentId(e.getId());if(u){var l=n.getDispatchProps(u);b.z({trackback:o.d.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:d,draftState:r,shouldClosePaneAfterDiscardDraft:s,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),r=P.t(t),a=P.h(t),i=e.getId(),c=n.getDispatchProps(i),s=x.b(t),d=n.getActiveComponentTree(t).componentTreeId.renderContextType,u=P.u(n.commentStore.getState()),l=(null==r?void 0:r.selectedCardId)===e.getId()&&Object(y.b)(s,d,a,r,u);b.e({trackback:o.d.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(t),dispatchProps:c,closeOnDiscard:l,cardId:e.getId(),draftState:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),r=P.t(t),a=n.getDispatchProps(e);b.d({trackback:o.d.reserveTag(592269523),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,componentTree:n.getActiveComponentTree(t),invokeModalDialog:n.invokeModalDialog,dispatchProps:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!w.b(t)[e],threadIndex:T.f(n.getRenderableItemThreads(t),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),r=P.t(t),a=n.getParentId(e);if(a){var i=n.getDispatchProps(a);b.D({trackback:o.d.reserveTag(592269524),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:i,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onSelectComment=function(e){var t,r=n.commentStore.getState(),a=P.g(r,!0),i=n.getNewThreadDraftId(),s=n.getFilteredRenderableItems(r),d=e.getId(),u=j.W()||d!==i?s.find((function(e){return T.e(e)===d})):a&&{commentModel:a.newComment_deprecated};if(u&&Object(O.a)(u)){var l=u,f=n.getDispatchProps(null!==(t=l.commentModel.parentId)&&void 0!==t?t:l.commentModel.commentId),m=P.t(r),p=P.h(r),g=n.getActiveComponentTree(r),v=Object(h.a)(T.i(u),P.j(r),g.componentTreeId.renderContextType);b.J({trackback:o.d.reserveTag(592269526),renderableItem:u,selectedComment:m,cardCollapsedState:v,dispatchProps:f,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:g,draftState_deprecated:p}).catch(Object(I.a)(o.d.reserveTag(590123734)))}else Object(c.k)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){b.a({trackback:o.d.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree(n.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getFilteredRenderableItems=P.y(),this.getRenderableItemThreads=this.makeGetRenderableItemThreads(this.getFilteredRenderableItems)}return e.prototype.initialize=function(){var e=Object(c.k)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent}));this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(_.a)},e.prototype.teardown=function(){var e,t=Object(c.k)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent}));null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(_.d)},e.prototype.beginProcessing=function(){var e=this,t=Object(c.k)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent}));this.startProcessingActionsPending=setTimeout((function(){e.onMockUIAction.startProcessing(),e.startProcessingActionsPending=void 0,t.successTag(_.b)}),100)},e.prototype.pauseProcessing=function(){var e=Object(c.k)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),Object(c.n)({diagnosticLevel:c.b.FullEvent}));this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(_.c)},e.prototype.onReopenThread=function(e,t){b.l({trackback:o.d.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}()},28717:function(e,t,n){"use strict";var r;function o(e){return e.actionType===r.CreateThread&&void 0!==e.content}function a(e){return e.actionType===r.CancelCreateThread}function i(e){return e.actionType===r.StartReplySession&&void 0!==e.threadId}function c(e){return e.actionType===r.CancelReplySession&&void 0!==e.threadId}function s(e){return e.actionType===r.PostReply&&void 0!==e.threadId&&void 0!==e.content}function d(e){return e.actionType===r.DeleteComment&&void 0!==e.commentId}function u(e){return e.actionType===r.DeleteThread&&void 0!==e.threadId}function l(e){return e.actionType===r.ResolveThread&&void 0!==e.threadId}function f(e){return e.actionType===r.ReopenThread&&void 0!==e.threadId}function m(e){return e.actionType===r.StartEditSession&&void 0!==e.commentId}function p(e){return e.actionType===r.CancelEditSession&&void 0!==e.commentId}function g(e){return e.actionType===r.PostEdit&&void 0!==e.commentId&&void 0!==e.content}function v(e){return e.actionType===r.SelectComment&&void 0!==e.commentId}function h(e){return e.actionType===r.ClickGhostCard}n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"o",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"j",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"n",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"m",(function(){return v})),n.d(t,"e",(function(){return h})),function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(r||(r={}))},28718:function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return O}));var r=n(12708),o=n(28062),a=n(28310),i=n(28280),c=n(28480),s=n(28556),d=n(28719),u=n(28725),l=n(28726),f=n(28720),m=n(28721),p=n(28731),g=n(28679),v=n(28732),h=n(28733),b=n(28730),C=n(28309);function y(e,t){return{requestDeleteComment:function(t,n){e(c.requestDeletePost(t,n))},requestDeleteThread:function(t,n,r){e(c.requestDeleteThread(t,n,r))},requestReopenThread:function(t,n,r){e(c.requestReopenThread(t,n,r))},requestResolveThread:function(t,n,r){e(c.requestThreadResolve(t,n,r))},requestEditCommentSession:function(n,r,c){e(Object(d.a)(n,t.commentAPI,{sessionType:"EDIT",commentId:r,rootCommentId:Object(i.s)()?c:void 0},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(574362624)))},requestReplyCommentSession:function(n,r){e(Object(d.a)(n,t.commentAPI,{sessionType:"REPLY",threadId:r},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(574362625)))},commitCommentAndFocus:function(n,r,o,a,i,c,s){return e(Object(l.a)(n,t.peopleAPI,a,r,o,s)).then((function(e){return e===b.a.Success&&t.focusManager.focusCommentCardCommand(i,c),e}))},discardDraftAsync:function(t,n,r,o){return e(Object(m.a)(t,n,r,o))},discardDraftIfEmpty:function(t,n,r){return e(Object(f.a)(t,n,r))},showLowFidelityWarning:function(t,n,r){e(c.showLowFidelityWarning(t,n,r))},clearLowFidelityWarning:function(t){e(c.clearLowFidelityWarning(t))},saveDraft:function(t,n,r){e(c.saveDraft(t,{draftId:n,draftContent:r}))},clearCommentHighlight:function(t,n){e(c.clearCommentHighlight(t,s.a.SharedComments,n))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateMentioneesStillInDraft:function(t,n){e(c.updateMentioneesStillInDraft(t,n))},addToCurrentMentionees:function(t,n){e(c.addToCurrentMentionees(t,n))},updateSelectedTaskAssignee:function(t,n){e(c.updateSelectedTaskAssignee(t,n))},updateSelectedTaskAssignees:function(t,n){e(c.updateSelectedTaskAssignees(t,n))},toggleTaskAssigner:function(t){e(c.toggleTaskAssigner(t))},displayDraftWarning:function(t,n,r){e(c.displayDraftWarning({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:function(t,n){e(c.showPostErrorUI(t,n))},clearPostErrorUI:function(t,n){e(c.clearPostErrorUI(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,r){e(Object(v.a)(t,n,r))},draftEmptinessChanged:function(t,n,r){e(c.draftEmptinessChanged(t,r,n))},selectComment:function(t,n,r,o){return e(Object(h.b)(t,n,r,o))},collapseCard:function(t,n){e(c.collapseCard(t,n))},requestUpdateCommentReactions:function(n,r,o,a){e(Object(u.a)(n,t.commentAPI,{sessionType:"METADATA",threadId:r},o,a))},requestPresentLinkToComment:function(t,n){e(c.requestPresentLinkToComment(t,n))},onClickableTextClicked:function(e){var n,r;null===(r=(n=t.commentAPI).onClickableTextClicked)||void 0===r||r.call(n,e)}}}function T(e,t){return Object(r.__assign)(Object(r.__assign)({},y(e,t)),{highlightComment:function(t,n){e(c.highlightComment(t,n,s.a.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e(Object(d.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(592314377)))},queueLoadThreads:function(t,n){e(c.queueLoadThreads(t,{threadIds:n}))},requestClosePane:function(t){e(c.requestClosePane(t))},requestDisplayConfiguration:function(t,n){return e(Object(g.a)(t,n))},readyToRender:function(t){e(c.readyToRender(t))},requestModalConfirmation:function(t,n,r,o){e(c.requestModalConfirmation(t,n,r,o))},initializeView:function(n){e(Object(p.a)(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:function(t,n){e(c.updateDraftRenderContext(t,n))}})}function O(e,t){return Object(r.__assign)(Object(r.__assign)({},y(e,t)),{updateRenderLockForDraft:function(t,n,r){e(c.updateDraftRenderContext(t,n,r))},highlightComment:function(n){e(c.highlightComment(n,t.resource.id,s.a.SharedComments))},requestDisplayConfiguration:function(n,r){return t.componentTree.componentTreeId.renderContextType!==C.a.HalfPane?Promise.resolve(void 0):e(Object(g.a)(n,r))},queueLoadThread:function(n){return e(c.queueLoadThreads(n,{threadIds:[t.resource.id]}))}})}},28719:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n(28062),o=n(28091),a=n(28561),i=n(22378),c=n(28583),s=n(28361),d=n(28586),u=n(28309),l=n(28643),f=n(28596),m=n(28369),p=n(28310),g=n(28271),v=n(28665),h=n(28272),b=n(28280),C=n(28560),y=n(28598),T=n(28603),O=n(28607),I=n(28481),S=n(28556),j=n(28486),_=n(28487),k=n(28506),E=n(28536),D=n(28720),A=n(28722);function P(e,t,n,P,x,w){return function(R,F){var N=F(),M=Object(o.k)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,Object(o.j)()),L=c.b[n.sessionType];return M.addDataField("SessionType",L,o.d.SystemMetadata),M.addDataField("Trackback",e.trackback,o.d.SystemMetadata),M.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),M.addDataField("PaneVisibilityState",O.e(N),o.d.SystemMetadata),b.c()||n.sessionType!==i.c?(T.p(N).atMention===a.b.Enabled&&Object(m.a)().catch(Object(p.a)(r.d.reserveTag(591397600))),R(Object(D.a)(e,S.a.SharedComments,c.c(n))).catch((function(e){return Object(p.a)(r.d.reserveTag(591397602))(e),{draftDiscardResult:a.g.Unhandled,draftDiscardBehavior:d.a.CannotAutoDiscard}})).then((function(a){var i,d;M.addDataField("DraftDiscardBehavior",a.draftDiscardBehavior,o.d.SystemMetadata);var m=F(),p=T.h(m);return Object(y.d)(p)||!b.W()&&T.g(m)&&c.d(n)?(M.addDataField("SessionAlreadyRequested",!0,o.d.SystemMetadata),M.addDataField("DraftRenderContextType",null!==(d=null===(i=Object(C.K)(p))||void 0===i?void 0:i.renderContextType)&&void 0!==d?d:u.a.None,o.d.SystemMetadata),M.successTag(591397633),Promise.resolve(R(k.a))):(M.addDataField("SessionAlreadyRequested",!1,o.d.SystemMetadata),w||R(Object(E.a)(Object(I.a)(e,r.d.reserveTag(591397634)),n,P)),t.beginDraftingAsync(n).then((function(t){if(void 0===t.sessionConfiguration)throw new g.a(h.c,r.d.reserveTag(589103630),-2130957532);c.d(n)&&b.G()&&R(Object(A.a)(Object(I.a)(e,r.d.reserveTag(591397635)),[],[],x,t.author));var a=F(),i=function(e,t,n){if(t!==s.a.Closed&&e!==u.a.DiscreteIsolated)return Object(l.a)(n);if(!Object(f.b)(e))return e;if(t===s.a.Closed)return u.a.None;return Object(l.a)(n)}(e.renderContextType,O.e(a),O.d(a).containerType);return M.addDataField("DraftRenderContextType",i,o.d.SystemMetadata),Object(o.k)().assertConditionTag(i===e.renderContextType||e.renderContextType===u.a.None,"Requested starting a draft in RenderContextType:".concat(e.renderContextType," but had to lock to RenderContextType:").concat(i," based on pane state"),554714642),M.successTag(591397640),R(Object(_.a)(Object(I.a)(e,r.d.reserveTag(591397641)),t,i,w))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?M.successTag(591397643):M.failTag(591397642,Object(v.a)(t)),R(Object(j.a)(Object(I.a)(e,r.d.reserveTag(591397644)),n,t))})))}))):(M.failTag(591397599,-2130957513),Promise.resolve(R(k.a)))}}},28720:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(28062),o=n(28091),a=n(22380),i=n(28586),c=n(28560),s=n(28598),d=n(28588),u=n(28603),l=n(28481),f=n(28504),m=n(28721);function p(e,t,n){return function(p,g){var v=g(),h=u.h(v),b=Object(o.k)().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,Object(o.j)()),C=Object(s.i)(h);b.addDataField("Trackback",e.trackback,o.d.SystemMetadata),b.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),b.addDataField("CommitPendingAttemptedCancel",C,o.d.SystemMetadata),b.addDataField("ActionSource",t,o.d.SystemMetadata);var y=Object(c.n)(h);return b.addDataField("DraftDiscardBehavior",y,o.d.SystemMetadata),y===i.a.CanAutoDiscard?p(Object(m.a)(e,t,!1)).then((function(e){return b.successTag(539754957),{draftDiscardResult:e,draftDiscardBehavior:y}})):(void 0!==n&&y===i.a.CannotAutoDiscard&&(b.addDataField("DraftWarningReason",n,o.d.SystemMetadata),p(Object(f.a)({draftWarningType:d.a.ReturnToDraft,draftWarningReason:n},Object(l.a)(e,r.d.reserveTag(591728722))))),b.successTag(539754958),Promise.resolve({draftDiscardResult:a.a.Canceled,draftDiscardBehavior:y}))}}},28721:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(28062),o=n(28091),a=n(28480),i=n(22378),c=n(22380),s=n(28598),d=n(28589),u=n(28603),l=n(28481),f=n(28489),m=n(28494);function p(e,t,n,p){return function(g,v){var h=v(),b=Object(o.k)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,Object(o.j)()),C=u.h(h),y=u.t(h),T=Object(s.i)(C);b.addDataField("Trackback",e.trackback,o.d.SystemMetadata),b.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),b.addDataField("CommitPendingAttemptedCancel",T,o.d.SystemMetadata),b.addDataField("ActionSource",t,o.d.SystemMetadata);var O=function(e,t,n){var c=u.v(e),s=u.t(e);if(!c)return s&&Object(d.j)(s.selectionDetails)&&Object(d.h)(s)?{cancelAction:a.cancelCommentPostEdit(Object(l.a)(n,r.d.reserveTag(593278744)),s.selectionDetails.selectedPostId,t),sessionType:i.b}:-2130957522;var f=c.commentDraft.sessionConfiguration.sessionType;switch(c.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:a.cancelCommentCreateThread(Object(l.a)(n,r.d.reserveTag(593278745)),t),sessionType:f};case"REPLY":return{cancelAction:a.cancelCommentReply(Object(l.a)(n,r.d.reserveTag(593278746)),c.commentDraft.sessionConfiguration.threadId,t),sessionType:f};case"EDIT":return{cancelAction:a.cancelCommentPostEdit(Object(l.a)(n,r.d.reserveTag(593278747)),c.commentDraft.sessionConfiguration.commentId,t),sessionType:f};default:return Object(o.k)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(h,n,e);if("number"==typeof O)return b.failTag(r.d.reserveTag(593278749),O),Promise.resolve(c.a.Handled);var I=O.sessionType,S=O.cancelAction;return b.addDataField("ActiveSessionType",I,o.d.SystemMetadata),T||!Object(s.b)(C)&&!Object(d.g)(y)?(b.addDataField("DiscardUnnecessary",!0,o.d.SystemMetadata),b.successTag(593278755),Promise.resolve(c.a.Unhandled)):(b.addDataField("DiscardUnnecessary",!1,o.d.SystemMetadata),g(Object(f.a)(Object(l.a)(e,r.d.reserveTag(593278750)))),p?p((function(){return g(S),b.addDataField("CancelledByUser",!1,o.d.SystemMetadata),b.successTag(593278751),c.a.Handled}),(function(){return b.addDataField("CancelledByUser",!0,o.d.SystemMetadata),b.successTag(593278752),g(Object(m.a)(Object(l.a)(e,r.d.reserveTag(593278753)))),c.a.Canceled})):(g(S),b.successTag(593278754),Promise.resolve(c.a.Handled)))}}},28722:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(28062),o=n(28310),a=n(28723),i=n(28603),c=n(28512);function s(e,t,n,s,d){return function(u,l){var f=Object(a.c)(t,n,i.r(l()),d);if(0===f.length)return Promise.resolve();if(s.getPersonaIconPropertiesArray)s.getPersonaIconPropertiesArray(f).then((function(t){u(Object(c.a)(e,Object(a.b)(t)))})).catch(Object(o.a)(r.d.reserveTag(595645964)));else{var m=Object(a.a)(f);u(Object(c.a)(e,Object(a.b)(m)))}return Promise.resolve()}}},28723:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(28724),o=n(28405),a=n(28276);function i(e,t,n,a){var i,c=e.map((function(e){return e.author})),s=null!==(i=null==t?void 0:t.map((function(e){return e.history.map((function(e){return e.records[0].user}))})))&&void 0!==i?i:[];return function(e,t){var n={};return e.filter((function(e){var r=Object(o.j)(e);return!(!r||n[r]||d(t,e))&&(n[r]=!0)}))}(Object(r.a)([c,s,null!=a?a:[]]),n)}function c(e){return e.reduce((function(e,t){var n=function(e){if(!e.authorID&&!e.authorName)return;return e.authorID||e.authorName}(t);return n?(e[n]=t,e):e}),{})}function s(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorID:e.UserId,authorColor:a.a.COMMENTS_PURPLE,authorImageURL:""})})),t}function d(e,t){var n=Object(o.j)(t);if(n){var r=e[n];return void 0!==r?r:t.DisplayName&&e[t.DisplayName]?e[t.DisplayName]:void 0}}},28724:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12708);function o(e){return e.reduce((function(e,t){return Array.isArray(t)?e.push.apply(e,Object(r.__spreadArray)([],Object(r.__read)(o(t)),!1)):e.push(t),e}),[])}},28725:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(28091),o=n(22378),a=n(28665),i=n(28557),c=n(28560),s=n(28603);function d(e,t,n,d,u){return function(l,f){var m=Object(r.k)().createActivityObject("CommentReaction",e.telemetryVisitor,Object(r.j)());m.addDataField("UserReactionAction",u,r.d.SystemMetadata);var p=f();if(n.sessionType===o.c){var g=Object(c.h)(s.d(p),n.threadId);g.valid&&(m.addDataField("MatchesCommentAuthor",g.matchesCurrentUser,r.d.SystemMetadata),m.addDataField("ThreadCreationDeltaMs",g.timeElapsed,r.d.SystemMetadata))}Object(i.c)(p,m),t.beginDraftingAsync(n).then((function(e){e.updateProperties("Reaction",{type:"Reaction",reactionType:d,isActive:u}),e.commit(),e.endDrafting(),m.successTag(587317280)})).catch((function(e){m.failTag(587317281,Object(a.a)(e))}))}}},28726:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r,o=n(12708),a=n(28062),i=n(28630),c=n(28406),s=n(28091),d=n(28480),u=n(22378),l=n(28583),f=n(28437),m=n(28608),p=n(28610),g=n(28727),v=n(28728),h=n(28271),b=n(28665),C=n(28666),y=n(28280),T=n(28730),O=n(28560),I=n(28598),S=n(28584),j=n(28588),_=n(28603),k=n(28606),E=n(28488),D=n(28502),A=n(28504);function P(e,t,n,h,b,C){return function(P,R){var F,N,M=Object(s.k)().createActivityObject("CommitComment",e.telemetryVisitor,Object(s.j)());M.addDocumentMetadata(s.f.Basic);var L=l.b[b.type],B=R(),V=k.b(B),U=_.v(B);if(void 0===U||U.commentDraft.sessionConfiguration.sessionType!==b.type)return M.failTag(593278784,-2130957522),Promise.resolve(T.a.CommitFailed);var H="",q=!1;switch(b.type){case u.b:H=b.commentId;break;case u.d:H=b.parentId,q=!0;break;case u.a:U&&(H=U.commentDraft.sessionConfiguration.draftId||"")}var G=_.j(B),z=!q||Object(p.a)(H,G,e.renderContextType)===m.a.Expanded;M.addDataField("IsCardExpanded",z,s.d.SystemMetadata);var W=function(e,t){var n;if(!t||Object(f.b)(t.commentDraft.sessionConfiguration)||!y.c())return;var r=void 0,o=y.m()?Object(g.b)(null!==(n=null==e?void 0:e.currentState.assignees)&&void 0!==n?n:[],t.selectedTaskAssignees):void 0;if(o)r={Task:{type:"Task",assigneeUpdate:o}};else{var a=t.selectedTaskAssignee;r=a?{Task:{type:"Task",assignee:a}}:void 0}return r}(V[H],U);if((null==W?void 0:W.Task)&&!Object(O.c)(B.commentState.modelCapabilities)&&(Object(s.k)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),W.Task=void 0),(y.c()&&b.type===u.a||y.d()&&b.type===u.d)&&(M.addDataField("IsPreExistingTask",!!V[H],s.d.SystemMetadata,s.e.Critical),M.addDataField("AffectingTaskMetadata",!!(null==W?void 0:W.Task),s.d.SystemMetadata,s.e.Critical)),M.addDataField("SessionType",L,s.d.SystemMetadata),b.type!==u.a){var Y=Object(O.h)(_.d(B),H);Y.valid&&(M.addDataField("MatchesCommentAuthor",Y.matchesCurrentUser,s.d.SystemMetadata),M.addDataField("ThreadCreationDeltaMs",Y.timeElapsed,s.d.SystemMetadata))}M.addDataField("AtMentionsEnabled",n,s.d.SystemMetadata),M.addDataField("Trackback",e.trackback,s.d.SystemMetadata),M.addDataField("RenderContextType",e.renderContextType,s.d.SystemMetadata),M.addDataField("CommitSource",C,s.d.SystemMetadata);var K=_.h(B);return Object(I.i)(K)?(null===(N=(F=Object(s.k)()).logDiagnosticTrace)||void 0===N||N.call(F,Object(i.a)(r||(r=Object(o.__makeTemplateObject)(["NoCommitDueToCommitPending"],["NoCommitDueToCommitPending"]))),a.d.reserveTag(556827598),s.h.Info,s.c.ProductServiceUsage,e.telemetryVisitor),Promise.resolve(T.a.CommitPending)):(P(Object(E.a)(d.chainActionDetails(e,a.d.reserveTag(593278785)))),h().then((function(r){if(!n){var o=w(P,b,r,0,M,a.d.reserveTag(593278786),a.d.reserveTag(593278787),e,W);return Promise.resolve(o)}var i=new v.a(r),d=i.Mentions,u=Object(s.k)();if(y.k()&&d.length>0&&u.logFloodgateActivity&&u.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),M.addDataField("CreateCommentWithRichFormatting",i.HasRichTextFormatting,s.d.SystemMetadata),!d.length){o=w(P,b,r,0,M,a.d.reserveTag(593278788),a.d.reserveTag(593278789),e,W);return Promise.resolve(o)}return t.grantUsersAccess(d).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===c.a.Success}(t),o=function(e){return!!e.Details&&e.Details.Canceled}(t);if(M.addDataField("AllUsersGrantedAccess",n,s.d.SystemMetadata),M.addDataField("ShareDialogCanceled",o,s.d.SystemMetadata),t.OperationResult===c.a.FailedSilently)return Object(a.i)("Check Access Phase failed - share dialog not shown"),M.failTag(593278790,-2130957561),x(P,r,j.a.GrantAccessFailedSilently,a.d.reserveTag(593278791),a.d.reserveTag(593278792),e),Promise.resolve(T.a.ShareFailed);if(o)return Object(a.i)("Share dialog was canceled by user"),M.successTag(593278793),x(P,r,j.a.GrantAccessCanceled,a.d.reserveTag(593278794),a.d.reserveTag(554801174),e),Promise.resolve(T.a.ShareFailed);if(!n)return Object(a.i)("Not all users have been granted access - going back to initial state"),M.successTag(593278795),x(P,r,j.a.GrantAccessCanceled,a.d.reserveTag(593278796),a.d.reserveTag(554784648),e),Promise.resolve(T.a.ShareFailed);var i=w(P,b,r,d.length,M,a.d.reserveTag(593278797),a.d.reserveTag(593278798),e,W);return Promise.resolve(i)}),(function(t){return M.failTag(593278799,-2130957561),Object(a.i)("Grant Users Access has failed",Object(a.l)(t)),x(P,r,j.a.GrantAccessFailedSilently,a.d.reserveTag(593278800),a.d.reserveTag(554784393),e),Promise.resolve(T.a.ShareFailed)}))}),(function(t){return M.failTag(593278801,-2130957539),P(Object(D.a)(d.chainActionDetails(e,a.d.reserveTag(593278802)),void 0)),Object(a.i)("getCommentBody failed",Object(a.l)(t)),y.F()&&P(Object(A.a)({draftWarningReason:S.a.CommitFailure,draftWarningType:j.a.CommitFailed},d.chainActionDetails(e,a.d.reserveTag(593278803)))),Promise.resolve(T.a.CommitFailed)})))}}function x(e,t,n,r,o,a){e(Object(D.a)(d.chainActionDetails(a,r),t)),e(Object(A.a)({draftWarningType:n,draftWarningReason:S.a.GrantUsersAccessFailure},d.chainActionDetails(a,o)))}function w(e,t,n,r,o,i,c,l,f){var m=function(e,t,n,r,o){try{switch(t.type){case"CREATE":e(d.commitDraft(d.chainActionDetails(r,a.d.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:o}));break;case"EDIT":e(d.commitDraft(d.chainActionDetails(r,a.d.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(d.commitDraft(d.chainActionDetails(r,a.d.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:o}));break;default:return Object(s.k)().assertConditionTag(!1,"Unexpected session type '".concat(t.type,"'"),593278807),e(Object(D.a)(d.chainActionDetails(r,a.d.reserveTag(593278808)),n)),-2130957532}}catch(m){if(!Object(h.b)(m)&&!Object(C.a)(m))throw m;return e(Object(D.a)(d.chainActionDetails(r,a.d.reserveTag(593278809)),n)),y.F()&&e(Object(A.a)({draftWarningReason:S.a.CommitFailure,draftWarningType:j.a.CommitFailed},d.chainActionDetails(r,a.d.reserveTag(593278810)))),Object(b.a)(m)}return}(e,t,n,l,f);return m?(o.failTag(c,m),T.a.CommitFailed):r?(t.type===u.a?(o.addDataField("CreateThreadWithMentions",!0,s.d.SystemMetadata,s.e.Critical),f&&f.Task&&o.addDataField("CreateThreadWithTaskAssigned",!0,s.d.SystemMetadata,s.e.Critical)):t.type===u.d&&(o.addDataField("CreateReplyWithMentions",!0,s.d.SystemMetadata,s.e.Critical),f&&f.Task&&o.addDataField("CreateReplyWithTaskAssigned",!0,s.d.SystemMetadata,s.e.Critical)),o.successTag(i),T.a.Success):(o.successTag(i),T.a.Success)}},28727:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(12708),o=n(28406),a=n(28405),i=100;function c(e){return e===i}function s(e,t){var n=Object(r.__assign)({},t);Object(a.m)(n,e);var i=[];Object.keys(n).forEach((function(e){var t=n[e].assignee;Object(o.d)(t)||i.push(t)}));var c=t?e.filter((function(e){return void 0===t[Object(a.i)(e)]})):Object(r.__spreadArray)([],Object(r.__read)(e),!1);if(0!==i.length||0!==c.length)return{assigneesToAdd:i,assigneesToRemove:c}}},28728:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28729),o=function(){function e(e,t){void 0===t&&(t=!0),this.rawDelta=e,this.onlyNewMentions=t,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t,o;if(null==e?void 0:e.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var a=e.attributes.atmention,i=e.optional;!a||n.onlyNewMentions&&void 0!==(null===(t=null==i?void 0:i.atmention)||void 0===t?void 0:t.contentId)||null===(o=n._users)||void 0===o||o.push({UserId:a.email,Provider:r.b}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(n._hasRichTextFormatting=!0)}}))},e}()},28729:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r="O365",o="@"},28730:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={})),t.a=r},28731:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(28062),o=n(28298),a=n(28360),i=n(28309),c=n(28310),s=n(28490),d=n(28507),u=n(28719),l=n(28679);function f(e,t,n,f,m){return function(p){return p(Object(s.a)({renderContextType:e,trackback:r.d.reserveTag(595899542),telemetryVisitor:m})),t===a.a.NewThread?(e===i.a.HalfPane&&p(Object(l.a)({renderContextType:e,trackback:r.d.reserveTag(595899543),telemetryVisitor:m},{displayMode:o.a.Variable,desiredHeight:0})).catch(Object(c.a)(r.d.reserveTag(595645966))),p(Object(u.a)({renderContextType:e,trackback:r.d.reserveTag(595898586),telemetryVisitor:m},n,{sessionType:"CREATE"},!1,f)).then((function(){p(Object(d.a)({renderContextType:e,trackback:r.d.reserveTag(595899545),telemetryVisitor:m}))}))):p(Object(d.a)({renderContextType:e,trackback:r.d.reserveTag(595899546),telemetryVisitor:m}))}}},28732:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(28603),o=n(28556),a=n(28532),i=n(28539);function c(e,t,n){return function(c,s){var d,u=s();(null===(d=r.t(u))||void 0===d?void 0:d.selectedCardId)!==t&&c(Object(a.b)(e,t,void 0,a.a.ExpandCard,o.a.SharedComments)),c(Object(i.a)(e,t,n))}}},28733:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p}));var r=n(12708),o=n(28062),a=n(28091),i=n(28618),c=n(28616),s=n(28479),d=n(28589),u=n(28603),l=n(28481),f=n(28532);function m(e,t,n,r){return function(m,p){m(Object(l.b)("SELECT_COMMENT",n,t));var g=p(),v=Object(u.t)(g);return r&&v&&v.selectedCardId===n.selectedCard&&(n.selectType!==f.a.SelectPost||Object(d.j)(v.selectionDetails)&&v.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise((function(n){return setTimeout((function(){var r;if(Object(d.j)(v.selectionDetails))r={componentType:c.a.Post,id:v.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{var l=Object(u.h)(g).drafts[v.selectedCardId],f=!!l&&"CREATE"===l.commentDraft.sessionConfiguration.sessionType;r={componentType:Object(i.b)(f),id:v.selectedCardId,renderContextType:t.renderContextType}}var m=e.getComponentById(r);m?(s.a&&Object(o.i)("Focusing comment ".concat(r.id," with render context type ").concat(r.renderContextType," after selection.")),m.focus()):Object(a.k)().assertConditionTag(!1,"Couldn't find focus target after select: ".concat(JSON.stringify(r)),590104655),n()}))})):(Object(a.k)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function p(e,t,n){return Object(r.__assign)({selectedCard:e,source:t},n)}},28734:function(e,t,n){"use strict";n.d(t,"K",(function(){return L})),n.d(t,"D",(function(){return V})),n.d(t,"G",(function(){return U})),n.d(t,"A",(function(){return H})),n.d(t,"E",(function(){return q})),n.d(t,"C",(function(){return G})),n.d(t,"J",(function(){return z})),n.d(t,"z",(function(){return W})),n.d(t,"k",(function(){return Y})),n.d(t,"h",(function(){return K})),n.d(t,"I",(function(){return X})),n.d(t,"F",(function(){return Q})),n.d(t,"a",(function(){return J})),n.d(t,"b",(function(){return $})),n.d(t,"i",(function(){return Z})),n.d(t,"n",(function(){return ee})),n.d(t,"j",(function(){return te})),n.d(t,"f",(function(){return ne})),n.d(t,"g",(function(){return re})),n.d(t,"e",(function(){return oe})),n.d(t,"c",(function(){return ae})),n.d(t,"l",(function(){return ie})),n.d(t,"m",(function(){return ce})),n.d(t,"d",(function(){return se})),n.d(t,"o",(function(){return de})),n.d(t,"t",(function(){return ue})),n.d(t,"q",(function(){return le})),n.d(t,"x",(function(){return fe})),n.d(t,"u",(function(){return me})),n.d(t,"y",(function(){return pe})),n.d(t,"r",(function(){return ge})),n.d(t,"s",(function(){return ve})),n.d(t,"p",(function(){return he})),n.d(t,"B",(function(){return be})),n.d(t,"H",(function(){return Ce})),n.d(t,"w",(function(){return ye})),n.d(t,"v",(function(){return Te}));var r=n(28062),o=n(28091),a=n(28363),i=n(28566),c=n(22377),s=n(22380),d=n(28432),u=n(28405),l=n(28298),f=n(28479),m=n(28310),p=n(28271),g=n(28280),v=n(28735),h=n(28480),b=n(28556),C=n(28733),y=n(28730),T=n(28560),O=n(28598),I=n(28589),S=n(28608),j=n(28591),_=n(28736),k=n(28586),E=n(28592),D=n(28309),A=n(28618),P=n(28626),x=n(28729),w=n(28737),R=n(28739),F=n(28370),N=n(28596),M=n(28604);function L(e){var t=e.comment,n=e.threads,r=e.selectedComment,o=e.warningType,a=!t.parentId,i=!!(t.commentFlags&c.a.LowFidelity);if(!r)return!(!a||o!==I.a.DeleteThread||!i&&!M.j(n,t.commentId))||g.n()&&i&&a;var s=i||a&&(o===I.a.DeleteReply||o===I.a.DeleteThread)&&M.j(n,t.commentId),d=Object(I.j)(r.selectionDetails)?r.selectionDetails.selectedPostId:r.selectedCardId;return!(!s||d===t.commentId&&r.selectionDetails.lowFidelityWarningType===o)}function B(e){var t=e.result,n=e.localizationAPI;t===y.a.Success&&Object(a.a)(n.getString(67))}function V(e){var t=e.trackback,n=e.id,i=e.data,c=e.selectedComment,s=e.renderContextType,d=e.actionDispatchers,u=e.telemetryVisitor,l=e.localizationAPI,f=M.b(i,n);f?L({comment:f,threads:i,selectedComment:c,warningType:I.a.DeleteReply})?d.showLowFidelityWarning({renderContextType:s,telemetryVisitor:u,trackback:r.d.reserveTag(593826118)},n,I.a.DeleteReply):(Object(a.a)(l.getString(65)),d.requestDeleteComment({renderContextType:s,telemetryVisitor:u,trackback:t},n)):Object(o.k)().assertConditionTag(!1,"Comment not found",593826117)}function U(e){var t=e.trackback,n=e.id,r=e.data,a=e.renderContextType,i=e.actionDispatchers,c=e.telemetryVisitor,s=M.b(r,n);s?i.showPostErrorUI({renderContextType:a,telemetryVisitor:c,trackback:t},s.commentId):Object(o.k)().assertConditionTag(!1,"Comment not found",593875075)}function H(e){var t=e.trackback,n=e.id,r=e.data,a=e.renderContextType,i=e.actionDispatchers,c=e.telemetryVisitor,s=M.b(r,n);s?i.clearPostErrorUI({renderContextType:a,telemetryVisitor:c,trackback:t},s.commentId):Object(o.k)().assertConditionTag(!1,"Comment not found",593875076)}function q(e){var t=e.trackback,n=e.id,a=e.data,i=e.selectedComment,c=e.renderContextType,s=e.actionDispatchers,d=e.telemetryVisitor,u=M.b(a,n);u?L({comment:u,threads:a,selectedComment:i,warningType:I.a.Edit})?s.showLowFidelityWarning({renderContextType:c,telemetryVisitor:d,trackback:r.d.reserveTag(593826120)},n,I.a.Edit):s.requestEditCommentSession({renderContextType:c,telemetryVisitor:d,trackback:t},n,u.parentId||u.commentId):Object(o.k)().assertConditionTag(!1,"Comment not found",593826119)}function G(e){var t=e.trackback,n=e.id,a=e.data,i=e.draftState,c=e.contentPromise,s=e.atMentionsEnabled,u=e.componentTree,l=e.actionDispatchers,f=e.telemetryVisitor,g=e.localizationAPI,v=e.commitSource;if(Object(O.i)(i))return Promise.resolve();if(!i.postIdToDraftIdMap[n])return Object(o.k)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new p.a("Post draft to commit not found",r.d.reserveTag(587850403),-2130957492));var h=M.b(a,n);return h?l.commitCommentAndFocus({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:f,trackback:t},(function(){return c}),{commentId:n,type:"EDIT",previousCommentBody:h.commentBody},s,u,Object(d.b)(h),v).then((function(e){B({result:e,localizationAPI:g})})).catch(Object(m.a)(r.d.reserveTag(593826122))):(Object(o.k)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new p.a("Comment not found in model",r.d.reserveTag(587850432),2130957505)))}function z(e){var t=e.trackback,n=e.renderableItem,o=e.selectedComment,a=e.cardCollapsedState,i=e.dispatchProps,c=e.telemetryVisitor,s=e.componentTree,d=e.draftState_deprecated,u=e.shouldFocusAfter,l=M.i(n),f=M.e(n);return i.discardDraftIfEmpty({renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:c,trackback:r.d.reserveTag(593237586)},b.a.SharedComments,void 0).then((function(e){if(g.X()||e.draftDiscardBehavior!==k.a.CannotAutoDiscard||o&&Object(I.j)(o.selectionDetails)&&o.selectionDetails.selectedPostId===f){var n=a===S.a.Collapsed;i.selectComment(s,{renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:c,trackback:t},Object(C.a)(l,b.a.SharedComments,n?{selectType:h.SelectActionType.ExpandCard}:{selectType:h.SelectActionType.SelectPost,selectedPost:f}),u||n).catch(Object(m.a)(r.d.reserveTag(590104649)))}else{var p=Object(T.K)(d);p&&Object(v.a)(2,p,c,r.d.reserveTag(590206683),s.componentTreeId.renderContextType)}}),Object(m.a)(r.d.reserveTag(593032901)))}function W(e){var t=e.trackback,n=e.commentId,i=e.setContents,c=e.data,d=e.draftState,u=e.shouldClosePaneAfterDiscardDraft,l=e.onWillDiscardCallback,f=e.renderContextType,p=e.dispatchProps,g=e.telemetryVisitor,v=e.localizationAPI,h=M.b(c,n);d.postIdToDraftIdMap[n]&&h?(Object(a.a)(v.getString(66)),p.discardDraftAsync({renderContextType:f,telemetryVisitor:g,trackback:t},b.a.SharedComments,u,l).then((function(e){e===s.a.Handled&&h&&i&&i(h.commentBody)})).catch(Object(m.a)(r.d.reserveTag(593826127)))):Object(o.k)().assertConditionTag(!1,"Cannot find comment post to cancel",593826126)}function Y(e){var t=e.cardProps,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardMounted(n,t)}))}function K(e){var t=e.cardId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardEditorMounted(n,t)}))}function X(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostMounted(n,t)}))}function Q(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostEditorMounted(n,t)}))}function J(e){var t=e.trackback,n=e.threadId,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.requestReplyCommentSession({renderContextType:r,telemetryVisitor:a,trackback:t},n)}function $(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.collapseCard({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId())}function Z(e){var t=e.trackback,n=e.commentCardRef,o=e.dispatchProps,a=e.telemetryVisitor,i=e.componentTree,c=e.options,s=e.focusManager,d=e.isDraftThread,u={componentType:Object(A.b)(d),id:n.getId(),renderContextType:i.componentTreeId.renderContextType};s.postOnComponentFocusedRequest(u,(function(){f.a&&Object(r.i)("Handling card focus with polite selection on ".concat(n.getId())),i.isFocusOnOrWithin(u)&&ee({trackback:t,commentCardRef:n,dispatchProps:o,telemetryVisitor:a,componentTree:i,options:c})}))}function ee(e){var t,n=e.trackback,o=e.commentCardRef,a=e.dispatchProps,i=e.telemetryVisitor,c=e.componentTree,s=e.options,d=!1,u=s.selectActionType;switch(u){case h.SelectActionType.ExpandCard:var l=s,f=l.selectRootPost&&(g.X()||!l.relativeDraftingState);d=l.shouldFocusAfter,t=f?{selectType:h.SelectActionType.SelectPost,selectedPost:o.getId()}:{selectType:h.SelectActionType.ExpandCard};break;case h.SelectActionType.SelectCard:case h.SelectActionType.Polite:t={selectType:u};break;default:Object(r.m)(u)}var p=Object(C.a)(o.getId(),b.a.SharedComments,t);s.selectActionType===h.SelectActionType.ExpandCard&&a.discardDraftIfEmpty({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(571281760)},b.a.SharedComments,void 0).then((function(e){if(!g.X()&&e.draftDiscardBehavior===k.a.CannotAutoDiscard&&s.relativeDraftingState===j.a.InOtherCard){var t=Object(T.K)(s.draftState);t&&Object(v.a)(1,t,i,r.d.reserveTag(571281761),c.componentTreeId.renderContextType)}})).catch(Object(m.a)(r.d.reserveTag(571281762))),a.selectComment(c,{renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:i,trackback:n},p,d).catch(Object(m.a)(r.d.reserveTag(571340118)))}function te(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;e.shouldHighlightCard?o.highlightComment({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId()):o.clearCommentHighlight({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId())}function ne(e){var t=e.trackback,n=e.focusManager,a=e.componentTree,i=e.cardId,c=e.isCardLie,s=e.newHeight,d=e.renderContextType,u=e.selectedComment,f=e.dispatchProps,p=e.telemetryVisitor;if(d===D.a.HalfPane){if(void 0===s)return Object(o.k)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);c&&u&&u.selectedCardId===i&&f.requestDisplayConfiguration({renderContextType:d,telemetryVisitor:p,trackback:t},{displayMode:l.a.Variable,desiredHeight:s}).then((function(){n.focusCommentPaneCommand(a)})).catch(Object(m.a)(r.d.reserveTag(593826130)))}}function re(e){var t=e.trackback,n=e.id,r=e.draftState,o=e.renderContextType,a=e.dispatchProps,c=e.telemetryVisitor;if("android"===Object(F.a)()){var s=r.drafts[r.cardIdToDraftIdMap[n]];s&&s.isDraftEmpty&&s.commentDraft.sessionConfiguration.sessionType===i.f&&a.discardDraftAsync({renderContextType:o,telemetryVisitor:c,trackback:t},b.a.SharedComments,!1)}}function oe(e){var t,n=e.trackback,c=e.showDiscardDialog,d=e.invokeModalDialog,u=e.componentTree,l=e.dispatchProps,f=e.closeOnDiscard,p=e.cardId,g=e.draftState,v=e.telemetryVisitor,h=e.localizationAPI,C=e.focusManager,y=e.lieIndex,T=g.cardIdToDraftIdMap[p];if(T){var O=void 0;c&&(O=Object(w.a)(g,u,d));var I=(null===(t=g.drafts[T])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===i.f,S=function(e){var t=e.componentTree,n=e.focusManager,r=e.lieIndex,o=e.cardId,a=e.isReplyDraft,i=e.discardCallback;return function(e,c){if(i){return i((function(){return n.onUserAction(t,{userAction:P.a.CancelNewThreadDraft,threadIndex:r}),e?e():s.a.Unhandled}),c)}return e?(a?n.onUserAction(t,{userAction:P.a.CancelReplyDraft,cardId:o}):n.onUserAction(t,{userAction:P.a.CancelNewThreadDraft,threadIndex:r}),Promise.resolve(e())):Promise.resolve(s.a.Unhandled)}}({componentTree:u,focusManager:C,lieIndex:y,cardId:p,isReplyDraft:I,discardCallback:O});Object(a.a)(h.getString(I?64:103)),l.discardDraftAsync({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:v,trackback:n},b.a.SharedComments,f,S).then((function(e){e===s.a.Handled&&(I?C.onUserAction(u,{userAction:P.a.CancelReplyDraft,cardId:p}):C.onUserAction(u,{userAction:P.a.CancelNewThreadDraft,threadIndex:y}))}),Object(m.a)(r.d.reserveTag(592840735)))}else Object(o.k)().assertConditionTag(!1,"Card draft to cancel not found",588853382)}function ae(e){var t=e.trackback,n=e.commentCardRef,a=e.draftState,i=e.areMentionsEnabled,c=e.session,s=e.componentTree,d=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,f=e.commitSource;if(Object(O.i)(a))return Promise.resolve();var g=n.getId();return a.cardIdToDraftIdMap[g]?d.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:s.componentTreeId.renderContextType},n.getContentsAsync,c,i,s,g,f).then((function(e){B({result:e,localizationAPI:l})})).catch(Object(m.a)(r.d.reserveTag(593826134))):(Object(o.k)().assertConditionTag(!1,"Card draft to commit not found",588853383),Promise.reject(new p.a("Card draft to commit not found",r.d.reserveTag(587850433),-2130957492)))}function ie(e){var t=e.trackback,n=e.id,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor,c=e.localizationAPI,s=e.isTask;Object(a.a)(c.getString(125)),o.requestReopenThread({renderContextType:r,telemetryVisitor:i,trackback:t},n,s)}function ce(e){var t=e.componentTree,n=e.focusManager,r=e.trackback,o=e.id,i=e.renderContextType,c=e.dispatchProps,s=e.telemetryVisitor,d=e.localizationAPI,u=e.isTask;Object(a.a)(d.getString(124)),n.onUserAction(t,{userAction:P.a.ResolveThread,cardId:o}),c.requestResolveThread({renderContextType:i,telemetryVisitor:s,trackback:r},o,u)}function se(e){var t=e.trackback,n=e.id,i=e.data,c=e.selectedComment,d=e.componentTree,u=e.invokeModalDialog,l=e.dispatchProps,f=e.telemetryVisitor,p=e.localizationAPI,g=e.focusManager,v=e.isTask,h=e.threadIndex;if(e.shouldCheckForLowFidelity){var b=M.b(i,n);if(!b)return void Object(o.k)().assertConditionTag(!1,"Comment not found",593605342);if(L({comment:b,threads:i,selectedComment:c,warningType:I.a.DeleteThread}))return void l.selectCommentCardAndShowLowFidelityWarning({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:f,trackback:r.d.reserveTag(593605343)},b.commentId,I.a.DeleteThread)}if(d.componentTreeId.renderContextType===D.a.HalfPane&&u){u(E.a.DeleteThread,(function(){return function(e){var t=e.dispatchProps,n=e.componentTree,a=e.selectedComment,i=e.telemetryVisitor;if(a)return t.requestDeleteThread({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(592840775)},a.selectedCardId),s.a.Handled;return Object(o.k)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),s.a.Unhandled}({dispatchProps:l,componentTree:d,selectedComment:c,telemetryVisitor:f})}),(function(){return s.a.Canceled})).then((function(e){e===s.a.Handled&&g.onUserAction(d,{userAction:P.a.DeleteThread,threadIndex:h})})).catch(Object(m.a)(r.d.reserveTag(595632546)))}else Object(a.a)(p.getString(63)),g.onUserAction(d,{userAction:P.a.DeleteThread,threadIndex:h}),Object(N.a)(d.componentTreeId.renderContextType)?setTimeout((function(){l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:f,trackback:t},n,v)}),100):l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:f,trackback:t},n,v)}function de(e){ce({componentTree:e.componentTree,focusManager:e.focusManager,trackback:e.trackback,id:e.id,renderContextType:e.renderContextType,dispatchProps:e.dispatchProps,telemetryVisitor:e.telemetryVisitor,localizationAPI:e.localizationAPI,isTask:!0})}function ue(e){var t=e.failTag,n=e.successTag,r=e.person,a=e.dispatchProps,i=e.telemetryVisitor,c=e.renderContextType,s=e.trackback,d=Object(o.k)().createActivityObject("CheckUserAccess",i,Object(o.j)()),l={UserId:Object(u.h)(r),Provider:x.b,DisplayName:Object(u.g)(r),Email:Object(u.h)(r)};a.checkUserAccess(l).then((function(e){var t;d.addDataField("UserCanWrite",e.UserCanWrite,o.d.SystemMetadata),d.addDataField("UserCanReview",null!==(t=null==e?void 0:e.UserCanReview)&&void 0!==t&&t,o.d.SystemMetadata),d.successTag(n)}),(function(e){d.failTag(t,-2130957562)})),a.addToCurrentMentionees({telemetryVisitor:i,trackback:s,renderContextType:c},r)}function le(e){var t=e.trackback,n=e.contentId,r=e.isEmpty,o=e.renderContextType,a=e.draftIdMap,i=e.actionDispatchers,c=e.telemetryVisitor,s=a[n];s&&i.draftEmptinessChanged({renderContextType:o,telemetryVisitor:c,trackback:t},s,r)}function fe(e){var t=e.trackback,n=e.id,o=e.editor,a=e.renderContextType,i=e.draftIdMap,c=e.draftMap,s=e.actionDispatchers,d=e.telemetryVisitor,u=i[n];if(u){var l=c[u];Object(r.n)(l,"Draft should be defined if draftId exists!",r.d.reserveTag(587850434)),l.pendingState===O.a.None&&s.saveDraft({renderContextType:a,telemetryVisitor:d,trackback:t},u,{editorContent:o.getContentsAsync(),editorCursorPosition:o.getCursorPositionAsync()})}}function me(e){var t=e.trackback,n=e.emailsStillInDraft,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:r,telemetryVisitor:a,trackback:t},n)}function pe(e){var t=e.trackback,n=e.renderContextType,r=e.dispatchProps,o=e.telemetryVisitor,a=e.selectedAssignee;r.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:o,trackback:t},a)}function ge(e){var t=e.selectedState,n=e.renderContextType,a=e.dispatchProps,i=e.telemetryVisitor;t&&Object(I.h)(t)?a.clearLowFidelityWarning({renderContextType:n,telemetryVisitor:i,trackback:r.d.reserveTag(573612046)}):Object(o.k)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function ve(e){var t=e.selectedState,n=e.onCardDelete,r=e.onPostDelete,a=e.onPostEdit;if(t)if(!Object(I.j)(t.selectionDetails)||Object(I.d)(t)){if(Object(I.e)(t))return void n(i=t.selectedCardId);if(Object(I.f)(t))return void Object(o.k)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var i=t.selectionDetails.selectedPostId;if(Object(I.c)(t))return void r(i);if(Object(I.f)(t))return void a(i)}else Object(o.k)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function he(e){var t=e.ownProps,n=e.dispatchProps,a=e.componentTree,i=e.draftState,c=e.invokeModalDialog;if(a.componentTreeId.renderContextType!==D.a.HalfPane&&Object(O.b)(i)&&!g.r()){n.discardDraftAsync({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:r.d.reserveTag(592840770)},b.a.SharedComments,!0,Object(w.a)(i,a,c,E.a.ClosePaneDraft)).then((function(e){e===s.a.Canceled?Object(R.b)():e===s.a.Unhandled&&Object(o.k)().assertConditionTag(e!==s.a.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch(Object(m.a)(r.d.reserveTag(592840771)))}else!function(e){var t=e.dispatchProps,n=e.componentTree,a=e.telemetryVisitor,i=Object(o.k)().createActivityObject("ClosePane",a,Object(o.j)());i.addDataField("PaneCloseResult",_.a.NoDialog,o.d.SystemMetadata),i.successTag(592840773),t.requestClosePane({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:a,trackback:r.d.reserveTag(592840774)})}({dispatchProps:n,componentTree:a,telemetryVisitor:t.telemetryVisitor})}function be(e,t,n,r,o){n.collapseCard({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:r,trackback:e},M.i(t))}function Ce(e,t,n,r){if(!Object(O.d)(r)||g.X()||"win32"===Object(F.a)()){var o=M.i(e);n.focusCommentCardCommand(t,o)}}function ye(e,t,n,r,o,a,i){o.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:a,trackback:e},t,i,n)}function Te(e,t,n,r,o){r.requestPresentLinkToComment({renderContextType:n,telemetryVisitor:o,trackback:e},t)}},28735:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28091),o=n(28280);function a(e,t,n,a,i){if(!o.X()){var c=Object(r.k)().createActivityObject("SelectionAttemptWhileDrafting",n,Object(r.j)());c.addDataField("Trackback",a,r.d.SystemMetadata),c.addDataField("RenderContextType",i,r.d.SystemMetadata),c.addDataField("SelectionAttemptType",e,r.d.SystemMetadata),c.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,r.d.SystemMetadata),c.successTag(590206682)}}},28736:function(e,t,n){"use strict";var r;!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(r||(r={})),t.a=r},28737:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(28560),o=n(28586),a=n(28309),i=n(28738),c=function(e,t,n,o,i){return e&&t===a.a.HalfPane&&void 0===i&&(!o||o.selectedCardId===Object(r.G)(n,!0,t))},s=function(e,t,n,a){if(n&&Object(r.n)(e)===o.a.CannotAutoDiscard){var c=null!=a?a:Object(i.a)(e,t.componentTreeId.renderContextType);return function(e,t){return n(c,e,t)}}}},28738:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(28091),o=n(28560),a=n(28592),i=n(28596);function c(e,t){var n=Object(o.K)(e);if(!n)return Object(r.k)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(i.b)(t)?a.a.ClosePaneDraft:a.a.CancelNewDraft;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return a.a.CancelNewDraft;case"EDIT":return a.a.CancelPostEdit;case"REPLY":return a.a.CancelReplyDraft;case"METADATA":return Object(r.k)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),a.a.CancelNewDraft}}},28739:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(28307);function o(){var e=document.getElementById(r.z());e&&e.focus()}function a(e){if(e&&e.target){var t=e.target.closest(".ql-editor");null!==t&&"true"===t.contentEditable||e.preventDefault()}}},28740:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22378),o=n(28560);function a(e,t){var n=Object(o.K)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.a}},28741:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c}));var r=n(28062),o=(r.d.reserveTag(595723983),r.d.reserveTag(595723984),r.d.reserveTag(574456150)),a=r.d.reserveTag(574456151),i=r.d.reserveTag(574456152),c=r.d.reserveTag(574456153)},28742:function(e,t,n){"use strict";var r;!function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"}(r||(r={})),t.a=r},28743:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}()},28744:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}()},28745:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(r||(r={}))},28746:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}()},28747:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12708),o=function(){function e(e){var t=this;this.internalHandler=e,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isProcessingEvents?t.internalHandler.apply(t,Object(r.__spreadArray)([],Object(r.__read)(e),!1)):t.eventQueue.push(e)}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var e,t;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=Object(r.__values)(this.eventQueue),o=n.next();!o.done;o=n.next()){var a=o.value;this.handler.apply(this,Object(r.__spreadArray)([],Object(r.__read)(a),!1))}}catch(i){e={error:i}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.eventQueue=[]}},e}()},28748:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(28406),o=n(28091),a=n(28552);function i(e,t){return function(n){if(!(t.capabilities&r.b.GetSuggestionsDetails))return Promise.resolve();var i=Object(o.k)().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,Object(o.n)({aggregationMode:o.a.OnSuccess}));return t.getSuggestionsDetails?t.getSuggestionsDetails().then((function(t){i.successTag(592492760),n(Object(a.a)(e,t))}),(function(e){i.failTag(592492761,-2130957495)})):(i.failTag(592492759,-2130957494),Promise.resolve())}}},28749:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(28170),o=n(28483);function a(e,t,n,a){return function(i){return Object(r.g)().registerExtension(t,n,a).then((function(t){return i(Object(o.a)(e,t)),t}))}}},28750:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(28091),o=n(28561),a=n(28665),i=n(28530);function c(e,t){return function(n){var c=Object(r.k)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,Object(r.j)());return t.checkAtMentionCapability().then((function(t){c.addDataField("AtMentionsEnabled",t,r.d.SystemMetadata),c.successTag(595903522),n(Object(i.a)(e,t?o.b.Enabled:o.b.Disabled))}),(function(t){c.failTag(595903523,Object(a.a)(t,-2130957528)),n(Object(i.a)(e,o.b.Disabled))}))}}},28751:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}()},28752:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t,n){}return e.prototype.getAccountID=function(){return""},e.prototype.getLPPController=function(){},e.prototype.ensureLPPController=function(){throw new Error("ensureLPPController not supported in Web")},e.prototype.initializeController=function(e){},e.prototype.isInitialized=function(){return!1},e.prototype.isOnline=function(){return!1},e.prototype.refreshLPPController=function(){},e}()},28753:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(28294),o=n(28754),a=n(28760),i=n(28764),c=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,c,s,d,u,l){var f=new o.a(t,n,c,s,l);switch(e.containerType){case r.a.HalfPane:return new i.a(f,n,u,l);case r.a.FullPane:return new a.a(f,n,d,l)}},e}()},28754:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var r=n(28062),o=n(28091),a=n(28170),i=n(28340),c=n(28566),s=n(22376),d=n(22379),u=n(28755),l=n(28424),f=n(28430),m=n(28756),p=n(28361),g=n(28586),v=n(28309),h=n(28734),b=n(28737),C=n(28685),y=n(28643),T=n(28604),O=n(28480),I=n(28556),S=n(28719),j=n(28720),_=n(28721),k=n(28757),E=n(28733),D=n(28560),A=n(28584),P=n(28588),x=n(28589),w=n(28603),R=n(28607),F=n(28582),N=n(28310),M=n(28280),L=n(28759),B=function(){function e(e,t,n,r,o){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=o}return e.prototype.processCommentEvent=function(e,t,n,a){var c,d=this,u=a();switch(e){case s.a.CommentContextChanged:if(!f.b(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912090);t.rehydrationDrafts&&t.rehydrationDrafts.forEach((function(e){n(Object(k.a)({renderContextType:v.a.None,trackback:r.d.reserveTag(595912089),telemetryVisitor:d.telemetryVisitor},e.draftId,t.contextDrafts,d.commentAPI,d.peopleAPI)).catch(Object(N.a)(r.d.reserveTag(523362973)))})),n(O.commentContextChanged({renderContextType:v.a.None,trackback:r.d.reserveTag(512361622),telemetryVisitor:this.telemetryVisitor},t));break;case s.a.CommentsChanged:if(!f.h(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case s.a.LoadComments:if(!f.i(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case s.a.CommentSelected:if(!f.g(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){var l=void 0;if(void 0!==w.c(u)[t.commentId])l=Object(E.a)(t.commentId,I.a.Canvas,{selectType:t.selectionReason&&"ContentNavigation"===t.selectionReason.type&&t.selectionReason.contentNavigationReason===i.c.Keyboarding?O.SelectActionType.SelectCard:O.SelectActionType.ExpandCard});else{var p=Object(F.b)(w.d(u),t.commentId);if(void 0===p)return;l=Object(E.a)(p.parentId,I.a.Canvas,{selectType:O.SelectActionType.SelectPost,selectedPost:t.commentId})}n(Object(E.b)(void 0,{renderContextType:v.a.None,trackback:r.d.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},l,!1)).catch(Object(N.a)(r.d.reserveTag(579744150)))}else n(O.clearCommentSelection({renderContextType:v.a.None,trackback:r.d.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case s.a.CommentContextReload:if(!f.d(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case s.a.CommentHighlighted:if(!f.f(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(O.highlightComment({renderContextType:v.a.None,trackback:r.d.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,I.a.Canvas)):n(O.clearCommentHighlight({renderContextType:v.a.None,trackback:r.d.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},I.a.Canvas,void 0));break;case s.a.NextPopulatedContextDetailsUpdated:if(!f.k(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(O.nextPopulatedContextDetailsUpdated({renderContextType:v.a.None,trackback:r.d.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case s.a.ModelCapabilitiesChanged:f.j(t)?n(O.updateModelCapabilities({renderContextType:v.a.None,trackback:r.d.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case s.a.CommentError:if(!f.e(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case s.a.ReturnToDraftRequested:f.l(t)&&n(O.displayDraftWarning({draftWarningType:P.a.ReturnToDraft,draftWarningReason:A.a.HostRequest},{renderContextType:v.a.None,trackback:r.d.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case s.a.UpdateDraftThread:f.n(t)?n(O.updateDraftThread({renderContextType:v.a.None,trackback:r.d.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(o.k)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case s.a.SmartReplyPopulated:if(!f.m(t))return void Object(o.k)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(O.populateSmartReply({renderContextType:v.a.None,trackback:r.d.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;case s.a.NativeHeartbeat:this.heartbeatHelper||(this.heartbeatHelper=new m.a),null===(c=this.heartbeatHelper)||void 0===c||c.heartbeatReceived();break;default:return void Object(o.k)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,c){var s=this,u=n();switch(e.actionType){case d.a.ShowHideCommentPane:return l.c(e.actionBehavior)?R.b(u)?l.a.Success:l.a.Fail:(l.d(e.actionBehavior)&&(R.b(u)?t(O.requestClosePane({renderContextType:v.a.None,trackback:r.d.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(O.requestShowPane({renderContextType:v.a.None,trackback:r.d.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),l.a.Success);case d.a.AddComment:if(l.b(e.actionBehavior)){if(!Object(L.a)(w.h(u)))return l.a.Fail}else if(l.d(e.actionBehavior)){var f={renderContextType:v.a.None,trackback:r.d.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t(Object(S.a)(f,this.commentAPI,{sessionType:"CREATE"},!(!c||!c.retainSelectionOnAddComment),this.peopleAPI)).catch(Object(N.a)(r.d.reserveTag(592314376))),l.a.Success}return l.a.Success;case d.a.NextThread:if(Object(o.k)().assertConditionTag(!l.c(e.actionBehavior),"This action type does not support toggled status",595899713),l.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return s.selectionManager.selectNextOrPreviousThread({direction:i.d.Next,source:I.a.SharedComments,expandCard:!0,iterableContentTypes:[a.b.CommentThread]},i.c.HostAction,v.a.None)}),t,M.X()?void 0:A.a.NextThread,r.d.reserveTag(591729749));else if(l.b(e.actionBehavior))return Object(L.c)(u)?l.a.Success:l.a.Fail;return l.a.Success;case d.a.PreviousThread:if(Object(o.k)().assertConditionTag(!l.c(e.actionBehavior),"This action type does not support toggled status",595899714),l.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return s.selectionManager.selectNextOrPreviousThread({direction:i.d.Previous,source:I.a.SharedComments,expandCard:!0,iterableContentTypes:[a.b.CommentThread]},i.c.HostAction,v.a.None)}),t,M.X()?void 0:A.a.PreviousThread,r.d.reserveTag(591729750));else if(l.b(e.actionBehavior))return Object(L.c)(u)?l.a.Success:l.a.Fail;return l.a.Success;case d.a.DeleteThread:if(Object(o.k)().assertConditionTag(!l.c(e.actionBehavior),"This action type does not support toggled status",595899715),l.b(e.actionBehavior)){if(!Object(L.b)(u.commentState))return l.a.Fail}else l.d(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=w.t(u);e&&t(O.requestDeleteThread({renderContextType:v.a.None,trackback:r.d.reserveTag(591738706),telemetryVisitor:s.telemetryVisitor},e.selectedCardId))}),t,A.a.DeleteThread,r.d.reserveTag(591729751));return l.a.Success}return l.a.NotHandled},e.prototype.beginDraftingHelper=function(e,t,n,r){return e(Object(S.a)({renderContextType:v.a.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI)).catch(Object(N.a)(r)).then((function(){return c.e.Handled}))},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},r.d.reserveTag(574371082),r.d.reserveTag(574371083));case"EditComment":var a,i=n(),s=w.t(i);a=Object(T.l)(Object(C.b)(e.commentId,w.d(i),w.b(i)),void 0);var d=Object(T.b)(a,e.commentId);return d?Object(h.K)({comment:d,threads:a,selectedComment:s,warningType:x.a.Edit})?(t(O.showLowFidelityWarning({renderContextType:v.a.None,telemetryVisitor:this.telemetryVisitor,trackback:r.d.reserveTag(593000206)},e.commentId,x.a.Edit)),Promise.resolve(c.e.Handled)):this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},r.d.reserveTag(593000207),r.d.reserveTag(593000208)):(Object(o.k)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(c.e.Handled));case"ReplyComment":return this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},r.d.reserveTag(593000209),r.d.reserveTag(593000210));case"DiscardDraft":var l=n();if(e.mode===u.a.TryAutoDiscard)return t(Object(j.a)({renderContextType:v.a.None,telemetryVisitor:this.telemetryVisitor,trackback:r.d.reserveTag(575411521)},I.a.Canvas)).then((function(e){return e.draftDiscardResult}));s=w.t(l);if(e.mode===u.a.Dialog&&Object(D.n)(w.h(l))===g.a.CannotAutoDiscard)return R.a(l)?Promise.resolve(c.e.Unhandled):Promise.resolve(c.e.Canceled);var f=Object(b.b)(R.e(l)===p.a.Visible,Object(y.a)(R.d(l).containerType),w.h(l),s,w.u(l));return t(Object(_.a)({renderContextType:v.a.None,telemetryVisitor:this.telemetryVisitor,trackback:r.d.reserveTag(575411522)},I.a.Canvas,f,void 0));default:return Promise.resolve(c.e.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,o){t(Object(j.a)({renderContextType:v.a.None,trackback:o,telemetryVisitor:this.telemetryVisitor},I.a.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==g.a.NoDraft&&t.draftDiscardResult!==c.e.Handled||e()})).catch(Object(N.a)(r.d.reserveTag(591738704)))},e}()},28755:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"}(r||(r={}))},28756:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,o=n(12708),a=n(28062),i=n(28630),c=n(28091),s=function(){function e(){this.maxAcceptableInterval=3e3,this.lastHeartbeatReceived=0,this.timerStarted=!1}return e.prototype.heartbeatReceived=function(){var e,t,n=this;this.lastHeartbeatReceived=Date.now(),null===(t=(e=Object(c.k)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(i.a)(r||(r=Object(o.__makeTemplateObject)(["Native HeartbeatReceived"],["Native HeartbeatReceived"]))),a.d.reserveTag(540361865),c.h.Info,c.c.ProductServiceUsage,Object(c.l)(c.g.ReviewedAsNotNecessary),Object(c.o)("HeartbeatTimestamp",this.lastHeartbeatReceived,c.d.SystemMetadata)),this.timerStarted||(this.timerStarted=!0,setInterval((function(){n.checkHeartbeatInterval()}),this.maxAcceptableInterval))},e.prototype.checkHeartbeatInterval=function(){var e=Date.now()-this.lastHeartbeatReceived;e>this.maxAcceptableInterval&&Object(c.k)().assertConditionTag(!1,"Max heartbeat interval exceeded: ".concat(e),561071552)},e}()},28757:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(28091),o=n(28758),a=n(28585),i=n(28603),c=n(28506),s=n(28531),d=n(28719);function u(e,t,n,u,l){return function(f,m){var p=Object(a.a)().getItem(t);if(!p)return Object(r.k)().assertConditionTag(!1,"no saved sessionStorage data for provided draft id",523510273),Promise.resolve(f(c.a));var g=JSON.parse(p);if(!Object(o.a)(g))return Object(r.k)().assertConditionTag(!1,"sessionStorage information is the wrong format",523510274),Promise.resolve(f(c.a));Object(a.a)().removeItem(t);var v={inCurrentContext:!!(null==n?void 0:n.some((function(e){return e.draftId===g.draftingParams.draftId}))),isDraftEmpty:""===g.draftContent.content};return f(Object(d.a)(e,u,g.draftingParams,!1,l,v)).then((function(){var t=i.v(m());if(!t)return Object(r.k)().assertConditionTag(!1,"no active draft to save to session",520136543),f(c.a);var n={draftId:t.commentDraft.sessionConfiguration.draftId,draftContent:{editorContent:Promise.resolve(g.draftContent.content),editorCursorPosition:Promise.resolve(g.draftContent.cursorPosition)}};return f(Object(s.a)(e,n))}))}}},28758:function(e,t,n){"use strict";function r(e){return void 0!==e.draftContent&&void 0!==e.draftContent.content&&void 0!==e.draftingParams&&void 0!==e.draftingParams.sessionType&&void 0!==e.draftingParams.draftId}n.d(t,"a",(function(){return r}))},28759:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(22381),o=n(28560),a=n(28598),i=n(28603),c=n(28607),s=n(28280);function d(e){return!!s.F()||!Object(a.d)(e)&&!e.committedLieId}function u(e){return!!e.selectedComment&&f(e.draftState)}function l(e){return function(e){var t=s.r()&&!c.b(e);return i.f(e).nextPopulatedContextDetails!==r.a.NoComments||Object(o.d)(t?i.a(e):i.k(e),i.d(e),t)}(e)&&f(i.h(e))}function f(e){return s.F()||!Object(a.d)(e)}},28760:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(28062),o=n(28566),a=n(22376),i=n(28430),c=n(28309),s=n(28626),d=n(28480),u=n(28761),l=n(28762),f=n(28763),m=n(28607),p=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,o){switch(e){case a.a.CommentsChanged:i.h(t)&&n(Object(u.a)(c.a.None,this.telemetryVisitor,t.contextDetails,Object(d.applyCommentChanges)({renderContextType:c.a.None,trackback:r.d.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case a.a.LoadComments:i.i(t)&&n(Object(f.a)({renderContextType:c.a.None,trackback:r.d.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case a.a.CommentContextReload:i.d(t)&&n(Object(l.a)({renderContextType:c.a.None,trackback:r.d.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI,this.telemetryVisitor))}this.commonViewStrategy.processCommentEvent(e,t,n,o)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===o.d.AddComment&&e.actionBehavior!==o.a.CheckEnabled){var r=n();m.b(r)&&this.focusManager.onUserAction(r.paneState.componentTree,{userAction:s.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}()},28761:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(28062),o=n(28650),a=n(28589),i=n(28603),c=n(28582),s=n(28556),d=n(28495),u=n(28496),l=n(28508),f=n(28532),m=n(28542),p=n(28543);function g(e,t,n,g){return function(v,h){var b=h();g&&v(g);var C=g?g.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&v(Object(m.a)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId){var y=i.t(b);if(n.selectedCommentId)if(y&&y.selectedCardId===n.selectedCommentId)if(Object(a.j)(y.selectionDetails)){var T=y.selectionDetails.selectedPostId,O=h();Object(c.b)(i.d(O),T)?v(Object(f.b)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953698)},n.selectedCommentId,T,f.a.SelectPost,s.a.Canvas)):v(Object(f.b)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953699)},n.selectedCommentId,void 0,f.a.ExpandCard,s.a.Canvas))}else v(Object(f.b)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953697)},n.selectedCommentId,void 0,f.a.SelectCard,s.a.Canvas));else v(Object(f.b)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953728)},n.selectedCommentId,void 0,f.a.ExpandCard,s.a.Canvas));else if(y){var I=i.h(b),S=I.cardIdToDraftIdMap[y.selectedCardId];S&&"CREATE"===I.drafts[S].commentDraft.sessionConfiguration.sessionType||v(Object(u.a)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953729)}))}}void 0!==n.highlightedCommentId&&(n.highlightedCommentId?v(Object(l.a)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953730)},n.highlightedCommentId,s.a.Canvas)):v(Object(d.a)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(578586722)},s.a.Canvas,void 0)));var j=Object(o.a)(n);j&&v(Object(p.a)({renderContextType:e,telemetryVisitor:C,trackback:r.d.reserveTag(595953732)},j))}}}},28762:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(28062),o=n(28091),a=n(28430),i=n(28644),c=n(28310),s=n(28280),d=n(28603),u=n(28481),l=n(28480),f=n(28761),m=n(28722);function p(e,t,n,p){return function(g,v){var h=[];Object(a.c)(t)?(Object(o.k)().assertConditionTag(!v||d.p(v()).virtualized,"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),h=Object(i.a)(t.commentIds,(function(){return v().commentState}))):h=t.comments;var b=Object(a.c)(t)?[]:t.tasks;g(Object(f.a)(e.renderContextType,p,t.contextDetails,Object(l.reloadComments)(Object(u.a)(e,r.d.reserveTag(595953694)),{comments:h,tasks:b}))),s.G()&&g(Object(m.a)(Object(u.a)(e,r.d.reserveTag(595932895)),h,b,n)).catch(Object(c.a)(r.d.reserveTag(595645974)))}}},28763:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(28062),o=n(28430),a=n(28280),i=n(28481),c=n(28509),s=n(28513),d=n(28722);function u(e,t,n){return function(u){o.o(t)?u(Object(s.a)(Object(i.a)(e,r.d.reserveTag(595137280)),t.threads)):(a.G()&&u(Object(d.a)(Object(i.a)(e,r.d.reserveTag(595137282)),t.comments,t.tasks,n)),u(Object(c.a)(Object(i.a)(e,r.d.reserveTag(595137283)),t.comments,t.tasks)))}}},28764:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(28062),o=n(22376),a=n(28430),i=n(28360),c=n(28652),s=n(28309),d=n(28765),u=n(28766),l=n(28763),f=n(28767),m=n(28607),p=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,p){switch(e){case o.a.CommentsChanged:a.h(t)&&n(Object(d.a)(t,this.telemetryVisitor));break;case o.a.LoadComments:a.i(t)&&(p().paneState.initializationStatus!==c.a.Initialized&&this.lastInitializationReason===i.a.NewThread||!m.b(p())?n(Object(l.a)({renderContextType:s.a.None,trackback:r.d.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)):n(Object(u.a)(s.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)));break;case o.a.CommentContextReload:a.d(t)&&n(Object(f.a)(s.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}this.commonViewStrategy.processCommentEvent(e,t,n,p)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}()},28765:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(12708),o=n(28062),a=n(28091),i=n(22374),c=n(28432),s=n(28309),d=n(28271),u=n(28272),l=n(28603),f=n(28558),m=n(28582),p=n(28556),g=n(28532),v=n(28480),h=n(28761);function b(e,t){return function(n,b){var C,y,T,O,I,S=b(),j=!1,_=e.contextDetails;if(""===(null==_?void 0:_.selectedCommentId)&&(_=Object(r.__assign)(Object(r.__assign)({},_),{selectedCommentId:void 0})),n(Object(h.a)(s.a.None,t,_,Object(v.applyCommentChanges)({renderContextType:s.a.None,trackback:o.d.reserveTag(595953743),telemetryVisitor:t},e.changes))),!e.contextDetails||!e.contextDetails.selectedCommentId){var k=l.t(S),E=k?k.selectedCardId:void 0,D=b(),A=l.t(D);Object(a.k)().assertConditionTag(!Object(f.g)(S),"applyCommentChangesAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402329);var P=l.a(S),x=l.a(D);if(E){if(E&&e.changes.some((function(e){return e.type===i.a.Delete&&e.model.commentId===E}))){var w=void 0;if(Object(m.f)(P)){var R=l.b(S),F=[],N=0;w=-1;for(var M=0;M<P.length;M++)F.push(N),N+=R[P[M]].length,P[M]===E&&(w=M);try{for(var L=Object(r.__values)(e.changes),B=L.next();!B.done;B=L.next()){switch((G=B.value).type){case i.a.Insert:var V=void 0;for(V=F.length-1;V>=0&&G.index<=F[V];V--)F[V]+=1;Object(c.a)(G.model)&&(V<w&&++w,F.splice(V+1,0,G.index));break;case i.a.Delete:var U=void 0;for(U=F.length-1;U>=0;U--){if(!(G.index<F[U])){G.index===F[U]&&(U<w&&--w,F.splice(U,1));break}F[U]-=1}break;case i.a.Modify:case i.a.Unknown:case i.a.Load:break;default:Object(o.m)(G)}}}catch(Y){C={error:Y}}finally{try{B&&!B.done&&(y=L.return)&&y.call(L)}finally{if(C)throw C.error}}}else{w=P.findIndex((function(e){return e.commentId===E}));try{for(var H=Object(r.__values)(e.changes),q=H.next();!q.done;q=H.next()){var G;switch((G=q.value).type){case i.a.Insert:G.index<=w&&++w;break;case i.a.Delete:G.index<w&&--w;break;case i.a.Modify:case i.a.Unknown:case i.a.Load:break;default:Object(o.m)(G)}}}catch(K){T={error:K}}finally{try{q&&!q.done&&(O=H.return)&&O.call(H)}finally{if(T)throw T.error}}}if(A)throw new d.a(u.l,o.d.reserveTag(589103626),-2130957551);if(x.length){var z=w;z===x.length&&(z-=1);var W=Object(m.f)(x)?x[z]:Object(c.b)(x[z]);n(Object(v.selectComment)({renderContextType:s.a.None,trackback:o.d.reserveTag(595953744),telemetryVisitor:t},W,void 0,g.a.ExpandCard,p.a.SharedComments)),j=!0}}}else!P.length&&x.length&&(n(Object(v.selectComment)({renderContextType:s.a.None,trackback:o.d.reserveTag(595947723),telemetryVisitor:t},Object(m.f)(x)?x[0]:x[0].commentId,void 0,g.a.ExpandCard,p.a.SharedComments)),j=!0);Object(a.k)().assertConditionTag(j||0===x.length||""!==(null===(I=e.contextDetails)||void 0===I?void 0:I.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}}},28766:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(28062),o=n(28091),a=n(28557),i=n(28559),c=n(28603),s=n(28558),d=n(28582),u=n(28556),l=n(28532),f=n(28480),m=n(28763);function p(e,t,n,p){return function(g,v){g(Object(m.a)({renderContextType:e,trackback:r.d.reserveTag(595899530),telemetryVisitor:p},t,n));var h=v();Object(o.k)().assertConditionTag(void 0===Object(s.g)(h),"Half pane specific logic should not run with filtering enabled.",523866629);var b=c.p(h).virtualized,C=c.t(h),y=c.k(h);!Object(i.a)(c.q(h),b,!!Object(s.g)(v()))||!y.length||C&&Object(a.b)(h,C.selectedCardId)||g(Object(f.selectComment)({renderContextType:e,trackback:r.d.reserveTag(595953680),telemetryVisitor:p},Object(d.f)(y)?y[0]:y[0].commentId,void 0,l.a.ExpandCard,u.a.SharedComments))}}},28767:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(12708),o=n(28062),a=n(28091),i=n(28430),c=n(28432),s=n(28644),d=n(28310),u=n(28280),l=n(28603),f=n(28558),m=n(28582),p=n(28556),g=n(28521),v=n(28532),h=n(28480),b=n(28761),C=n(28722);function y(e,t,n,y){return function(T,O){var I,S,j=O(),_=!1,k=[];Object(i.c)(t)?(Object(a.k)().assertConditionTag(l.p(j).virtualized,"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),k=Object(s.a)(t.commentIds)):k=t.comments;var E=t.contextDetails;""===(null==E?void 0:E.selectedCommentId)&&(E=Object(r.__assign)(Object(r.__assign)({},E),{selectedCommentId:void 0}));var D=Object(i.c)(t)?[]:t.tasks;T(Object(b.a)(e,y,E,Object(g.a)({renderContextType:e,telemetryVisitor:y,trackback:o.d.reserveTag(595953677)},{comments:k,tasks:D}))),u.G()&&T(Object(C.a)({renderContextType:e,telemetryVisitor:y,trackback:o.d.reserveTag(595162892)},k,D,n)).catch(Object(d.a)(o.d.reserveTag(595645962))),Object(a.k)().assertConditionTag(!Object(f.g)(j),"reloadCommentsAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402328);var A=null===(I=l.t(j))||void 0===I?void 0:I.selectedCardId,P=l.a(j),x=O(),w=l.a(x);if(A){if(!l.t(x)){var R=Object(m.f)(P)?P.findIndex((function(e){return e===A})):P.findIndex((function(e){return e.commentId===A}));if(R<0)return;if(w.length){var F=R;F===w.length&&(F-=1);var N=Object(m.f)(w)?w[F]:Object(c.b)(w[F]);T(Object(h.selectComment)({renderContextType:e,telemetryVisitor:y,trackback:o.d.reserveTag(595953678)},N,void 0,v.a.ExpandCard,p.a.SharedComments)),_=!0}}}else!P.length&&w.length&&(T(Object(h.selectComment)({renderContextType:e,telemetryVisitor:y,trackback:o.d.reserveTag(595947722)},Object(m.f)(w)?w[0]:w[0].commentId,void 0,v.a.ExpandCard,p.a.SharedComments)),_=!0);Object(a.k)().assertConditionTag(_||0===w.length||""!==(null===(S=t.contextDetails)||void 0===S?void 0:S.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}},28775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.Language=65536]="Language",e[e.SubscriptAndSuperscript=131072]="SubscriptAndSuperscript",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=262143]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},28782:function(e,t,n){"use strict";n(28783);var r=n(28784);n.d(t,"a",(function(){return r.a}));n(28786),n(28788)},28783:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={}))},28784:function(e,t,n){"use strict";var r=n(28785);n.d(t,"a",(function(){return r.a}))},28785:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"}(r||(r={}))},28786:function(e,t,n){"use strict";n(28787)},28787:function(e,t,n){"use strict"},28788:function(e,t,n){"use strict";n(28789),n(28790),n(28791),n(28792),n(28793)},28789:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(r||(r={}))},28790:function(e,t,n){},28791:function(e,t,n){},28792:function(e,t,n){},28793:function(e,t,n){},28797:function(e,t,n){var r=n(11991),o=n(12043),a=n(28798),i=n(12033),c=o((function(e){return a(r(e,i))}));e.exports=c},28798:function(e,t,n){var r=n(14753),o=n(12351),a=n(12353);e.exports=function(e,t,n){var i=e.length;if(i<2)return i?a(e[0]):[];for(var c=-1,s=Array(i);++c<i;)for(var d=e[c],u=-1;++u<i;)u!=c&&(s[c]=r(s[c]||d,e[u],t,n));return a(o(s,1),t,n)}}}]);