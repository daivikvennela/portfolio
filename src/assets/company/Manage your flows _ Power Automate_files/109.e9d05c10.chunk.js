/*! For license information please see 109.e9d05c10.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{19958:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(11808);function o(){return!!Object(i.a)().copilotGraduated.getConfig().copilotGraduated}},22675:function(e,t,n){"use strict";var i=n(22676);n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return i.b}))},22676:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var i=n(19691);function o(e,t){for(var n=r(e,t),o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];if(a){var l=a.map(e=>e.toString());return l.unshift(t.toString()),Object(i.b)(n,...l)}return Object(i.b)(n,t.toString())}function r(e,t){for(var n=/\((.*?)\){(.*?)};/g,i=n.exec(e);i;){if(a(i[1],t))return i[2];i=n.exec(e)}return e}function a(e,t){var n=/^\d+$/g.exec(e);return n?t===parseInt(n[0],10):(n=/^(\d+)-(\d+)$/g.exec(e))?t>=parseInt(n[1],10)&&t<=parseInt(n[2],10):!!(n=/^(\d+)-inf$/g.exec(e))&&t>=parseInt(n[1],10)}},29266:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(11766),o=n.n(i),r=n(12754),a=n(12961),s=n(12960),l=n(13031);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var u=e=>{var{steps:t,stepperFormat:n,isLoopingSteps:u,nextButtonProps:p,previousButtonProps:g,closeButtonProps:m,styles:b,dataAutomationId:f}=e,[h,v]=Object(i.useState)(0),w=u||h!==t.length-1?e=>{v((h+1)%t.length),null!=p&&p.onClick&&p.onClick(e)}:void 0,y=u||0!==h?e=>{v((h-1+t.length)%t.length),null!=g&&g.onClick&&g.onClick(e)}:void 0,O=d(1===t.length),S=Object(r.eb)(O.root,null==b?void 0:b.root),C=Object(r.eb)(O.illustration,null==b?void 0:b.illustration),I=Object(r.eb)(O.stepContent,null==b?void 0:b.stepContent),F=Object(r.eb)(O.stepTitle,null==b?void 0:b.stepTitle),E=Object(r.eb)(O.stepDescription,null==b?void 0:b.stepDescription),j=Object(r.eb)(O.footer,null==b?void 0:b.footer),R=t[h];return o.a.createElement("div",{className:S,"data-automation-id":f},o.a.createElement("div",{className:C},o.a.createElement("img",{src:R.illustration,alt:R.title})),o.a.createElement("div",{className:I},o.a.createElement("div",{className:F},R.title),o.a.createElement("div",{className:E},R.description)),t.length>1&&o.a.createElement("div",{className:j},o.a.createElement("div",null,Object(l.a)(n,h+1,t.length)),o.a.createElement("div",null,g&&(0!==h||u)&&o.a.createElement(a.a,c({onClick:y},g,{disabled:!y})),p&&(h!==t.length-1||u)&&o.a.createElement(s.a,c({onClick:w},p,{disabled:!w})),m&&m.onClick&&h===t.length-1&&o.a.createElement(s.a,c({},m,{disabled:!m.onClick})))))},d=e=>{var t=Object(r.Y)();return{root:{borderRadius:8,boxShadow:t.effects.elevation4,display:"flex",flexDirection:"column"},illustration:{backgroundColor:t.palette.neutralLighter,width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"inherit"},stepContent:{padding:"32px 32px 0 32px",backgroundColor:t.palette.white,width:"100%",borderRadius:"inherit",paddingBottom:e?32:12},stepTitle:{color:t.palette.themePrimary,fontSize:r.k.mediumPlus,fontWeight:r.l.semibold,marginBottom:5},stepDescription:{fontSize:r.k.medium},footer:{padding:"0px 32px 32px 32px",backgroundColor:t.palette.white,width:"100%",height:55,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"inherit"}}}},30224:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(12754),n(16873);var i=n(24369);n(11766);function o(e,t){var n;if(e.startsWith("#"))return null!==(n=Object(i.a)(e,t))&&void 0!==n?n:e;if(e.startsWith("rgb(")){var o=e.match(/\(([^\)]+)\)/g);return o&&o.length?"rgba(".concat(o[0],", ").concat(t,")"):e}return e}},34585:function(e,t,n){"use strict";n.r(t),n.d(t,"ChatbotPane",(function(){return J}));var i=n(12811),o=n(12754),r=n(12801),a=n(15356),s=n(12746),l=n(18865),c=n(14337),u=n(11766),d=n.n(u),p=n(13259),g=n(29266),m=n(15941),b=n(20852),f=n(13272),h=n(13029),v=n(13240),w=n(12345),y=n(13e3),O=n(34586),S=n(34599),C=n(34600),I=n(34658),F=n(23079),E=n(20080),j=n(34587),R=n(34659),k=n(20083),D=n(24351),M=n(12376),N=n(20091),x=n(12324),A=n(20848),P=n(19958),T=n(15524),z=n(20861),W=n(20062),U=n(34660),G=n(20862),B=n(28026),L=n(18816),Z=n(17777),V=n(18821);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(i,o)}function X(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){Q(r,i,o,a,s,"next",e)}function s(e){Q(r,i,o,a,s,"throw",e)}a(void 0)}))}}var J=Object(c.c)(e=>{var{isOpen:t,onClose:n,onTroubleshootingCopilotStarted:c,chatbotService:k,chatbotDesigner:L,className:Y,loggingService:_,assetService:Q,cdnService:J,flowName:ie,solutionId:oe,defaultToSolutionFlowState:re,doNotShowAgainService:ae,flowOrigin:se,flowRun:le,resources:ce,telemetryService:ue,remediationService:de,flowMonitorService:pe,designerConnectionStore:ge,clientSource:me}=e,[be]=d.a.useState(()=>new O.a(y.a,w.a,k,L,_,Q,J,ce,ae,ue,ie,oe,re,le,de,pe,ge,se,me));Object(r.a)(()=>be.dispose()),Object(u.useEffect)(()=>be.setChatBotDesigner(L),[be,L]);var fe=Object(F.b)(t);!function(e,t){Object(u.useEffect)(()=>{if(t){var n=(new Date).valueOf();return e.logEvent(v.c.CopilotPaneVisibilityChanged,H({isOpen:!0},e.getDataForTelemetry())),()=>e.logEvent(v.c.CopilotPaneVisibilityChanged,H({isOpen:!1,durationSeconds:Math.round(((new Date).getTime()-n)/1e3)},e.getDataForTelemetry()))}},[t,e])}(be,t);var{initializeConversation:he,clearConversation:ve,inputQuery:we,isGeneratingAnswer:ye,isBlockingOperationInProgress:Oe,isChatInputSubmitDisabled:Se,setInputQuery:Ce,QUERY_MAX_LENGTH:Ie,onSubmitInputQuery:Fe,debugStore:Ee,stopAnswerGeneration:je,doNotShowAgainFRE:Re,showFRE:ke,onFeedbackPanelDismiss:De,feedbackPanelItem:Me,getFeedbackSurveyUserContext:Ne,selectedPromptGuideItemKey:xe,inputTextFieldRef:Ae,isSavingFlowFromCopilot:Pe,ocvRawRequest:Te,ocvCopilotResponse:ze,ocvFeedbackType:We,onOcvFeedbackDismiss:Ue,onOcvFeedbackError:Ge,onOcvFeedbackSuccess:Be}=be,[Le,Ze]=d.a.useState(!1),Ve=[];Le&&(Ve=B.a.conversation),Object(a.a)(()=>{function e(){return(e=X((function*(){yield he(),Ze(!0)}))).apply(this,arguments)}Le||function(){e.apply(this,arguments)}()}),d.a.useEffect(()=>{t&&Object(b.b)()},[t]);var Ye=d.a.useRef(void 0);d.a.useEffect(()=>{var e;null!=le&&le.name&&le.name!==Ye.current&&(Ye.current=le.name,be.resetTroubleshootingData(),Object(Z.a)()&&(be.setFlowRun(le),null!==(e=le.properties)&&void 0!==e&&e.error&&(be.onFlowRunFailure(),null==c||c())))},[le,c,be]),d.a.useEffect(()=>{Object(G.a)(_)},[_]);var He=d.a.useRef(Object(x.once)(()=>be.logEvent(v.c.CopilotUserClickedInChatbox))),_e=d.a.useRef(Object(x.once)(()=>be.logEvent(v.c.CopilotUserTypedInChatbox))),[Qe,{toggle:Xe,setFalse:Je}]=Object(s.a)(!1),qe=d.a.useRef(null);Object(U.a)();var Ke=$(),$e=te(),et=te(!0),tt=Object(A.a)(),nt=Object(W.a)();return Object(z.a)({type:We,__rawRequest:Te,__copilotResponse:ze,callbackFunctions:{onDismiss:Ue,onError:Ge,onSuccess:Be}}),fe?(he(),d.a.createElement(F.a,{isOpen:t,className:Y,isResizable:!0},d.a.createElement(R.a,{store:Ee,clearConversation:ve}),d.a.createElement("div",{className:ne.container,"data-automation-id":D.a.copilotPane},d.a.createElement("div",{className:ne.header,onClick:Ee.openModal},d.a.createElement(l.a,{className:ne.headerIcon}),d.a.createElement("div",{className:ne.headerTitle},ce.Title,!Object(P.a)()||Ee.isUsingDebugOptions?d.a.createElement("div",{className:ne.headerModePill},Ee.isUsingDebugOptions?ce.DevMode.DevPill:ce.PreviewPill):null),d.a.createElement("div",{"data-automation-id":D.a.closeChatbotPane},d.a.createElement(p.a,{title:ce.Close,iconProps:{iconName:f.a.DismissF9},onClick:e=>{null==n||n(),e.stopPropagation()},className:ne.closeButton}))),d.a.createElement("div",{className:Object(i.a)(ne.content)},ye&&d.a.createElement(E.a,{progressState:ce.ChatProgressCard.Working,onStopButtonClick:je,stopButtonLabel:ce.ChatProgressCard.StopGenerating}),Pe&&d.a.createElement(E.a,{progressState:ce.ChatProgressCard.Saving}),Ve.map(e=>d.a.createElement(C.a,{key:e.id,item:e,store:be,resources:ce,loggingService:_})),ke&&d.a.createElement(g.a,{dataAutomationId:D.a.firstRunExperience,stepperFormat:ce.FirstRunExperience.StepperFormat,previousButtonProps:{text:ce.FirstRunExperience.Back,styles:$e},nextButtonProps:{text:ce.FirstRunExperience.Next,styles:et},closeButtonProps:{text:ce.FirstRunExperience.GetStarted,onClick:Re,styles:et},steps:K(Q,ce,me),styles:ee()})),d.a.createElement("div",{className:ne.footer},xe&&d.a.createElement(j.a,{itemKey:xe,resources:ce.PromptGuide}),Object(V.c)(le)?d.a.createElement(d.a.Fragment,null,d.a.createElement(S.b,null,be.canSaveCurrentFlow&&d.a.createElement(S.a,{text:ce.Save,iconName:f.a.SaveF9,onClick:be.saveFlow}),be.canTestCurrentFlow&&d.a.createElement(S.a,{text:ce.Test,iconName:f.a.TestF9,onClick:be.testFlow})),d.a.createElement("div",{"data-automation-id":D.a.chatInput,onKeyPress:_e.current},d.a.createElement(N.a,{query:we,placeholder:ce.InputPlaceholder,disabled:Oe,isMultiline:!0,showCharCount:!0,maxQueryLength:Ie,submitButtonProps:{title:ce.Submit,disabled:Se,iconName:f.a.SendF9,iconButtonStyles:Ke,onClick:Fe},footerActionsProps:[{iconName:f.a.SparkleF9,title:ce.Actions,iconButtonStyles:Ke,onClick:Xe,elementRef:qe,toggle:!0,checked:Qe}],onQueryChange:(e,t)=>Ce(null!=t?t:""),onRenderPrefix:Ee.isUsingDebugOptions?()=>d.a.createElement(q,{debugStore:Ee}):void 0,textFieldRef:Ae,styles:{textField:{prefix:{backgroundColor:"transparent",width:10,padding:0,margin:5,position:"relative",top:-20,left:-5}}},onFocus:He.current}))):null,d.a.createElement(j.b,{isOpen:Qe,onDismiss:Je,target:qe,initialMenu:be.promptGuideMenu,onMenuItemClick:be.onPromptGuideItemClicked,resources:ce.PromptGuide.Menu}),Object(P.a)()?d.a.createElement(T.a,{className:ne.aINoticeShipped,text:ce.AINoticeShipped}):d.a.createElement(m.b,{className:ne.aINotice,textColor:Object(o.Y)().palette.neutralSecondary,interpolatedString:ce.AINoticeFormat,links:[{text:ce.SeePreviewTerms,href:M.a,target:h.a.blank,isUnderlinedStyle:!0}]}),tt?d.a.createElement(m.b,{className:ne.aINotice,textColor:Object(o.Y)().palette.neutralSecondary,interpolatedString:ce.AIEnglishOnlyDisclaimer,links:[{text:ce.AIEnglishOnlyDisclaimerLearnMore,href:"https://go.microsoft.com/fwlink/?linkid=2247163",target:h.a.blank,isUnderlinedStyle:!0,telemetryService:ue,telemetryData:{name:"AIEnglishOnlyDisclaimerLearnMore.ChatBotPane"}}]}):void 0)),nt?null:d.a.createElement(I.a,{item:Me,onDismiss:De,resources:ce,getUserContext:Ne}))):null}),q=Object(c.c)(e=>{var t,{debugStore:n}=e;return d.a.createElement("span",{style:{marginLeft:6,marginTop:10},onClick:n.openModal},null!==(t=n.emoji)&&void 0!==t?t:"ðŸš§")});function K(e,t,n){return[{title:n===L.d.MCS?t.FirstRunExperience.FirstStep.MCSTitle:t.FirstRunExperience.FirstStep.Title,illustration:e.copilot.copilotFREIllustration,description:d.a.createElement(d.a.Fragment,null,t.FirstRunExperience.FirstStep.Description)},{title:t.FirstRunExperience.SecondStep.Title,illustration:e.copilot.copilotFREIllustration,description:d.a.createElement(d.a.Fragment,null,d.a.createElement("li",null,t.FirstRunExperience.SecondStep.Description.Item1),d.a.createElement("li",null,t.FirstRunExperience.SecondStep.Description.Item2),d.a.createElement("li",null,t.FirstRunExperience.SecondStep.Description.Item3))},{title:t.FirstRunExperience.ThirdStep.Title,illustration:e.copilot.copilotFREIllustration,description:d.a.createElement(d.a.Fragment,null,d.a.createElement("li",null,t.FirstRunExperience.ThirdStep.Description.Item1),d.a.createElement("li",null,t.FirstRunExperience.ThirdStep.Description.Item2),d.a.createElement("li",null,t.FirstRunExperience.ThirdStep.Description.Item3))}]}var $=()=>({root:{color:Object(o.Y)().palette.neutralPrimary,backgroundColor:"transparent !important"},rootDisabled:{backgroundColor:"transparent !important"}}),ee=()=>{var e=Object(o.Y)();return{root:{marginTop:16,backgroundColor:e.palette.white},illustration:{backgroundColor:"transparent",img:{height:"95%"}},stepContent:{backgroundColor:"transparent",padding:"0px 16px"},stepTitle:{color:e.palette.neutralPrimary,fontSize:o.k.large,textAlign:"center",lineHeight:"25px"},stepDescription:{lineHeight:"20px",padding:"11px 0px 24px 0px",color:e.palette.neutralPrimaryAlt},footer:{backgroundColor:"transparent"}}},te=e=>{var t=Object(o.Y)();return Object(k.a)({root:{borderRadius:4,minWidth:"fit-content",padding:"16px 8px",marginRight:e?0:6,background:e?"linear-gradient(91.7deg, #0066FF 0%, #A45ED0 100%)":"unset",border:e?"none":"1px solid ".concat(t.palette.neutralLight)},rootHovered:{border:e?"none":"1px solid ".concat(t.palette.neutralLight)},rootPressed:{border:e?"none":"1px solid ".concat(t.palette.neutralLight)}})},ne=Object(o.db)({container:{height:"100%",width:"100%",minWidth:"100%",overflow:"hidden",display:"flex",flexDirection:"column",background:Object(o.Y)().palette.neutralLighterAlt},header:{height:50,display:"flex",flexDirection:"row",padding:16,alignItems:"center",fontSize:"large",fontWeight:"bold",boxShadow:Object(o.Y)().effects.elevation4,zIndex:1},headerIcon:{color:Object(o.Y)().palette.themePrimary},headerTitle:{display:"flex",flexGrow:2,paddingLeft:8},headerModePill:{marginLeft:4,width:"fit-content",fontSize:o.k.small,fontWeight:600,textTransform:"uppercase",color:Object(o.Y)().palette.neutralSecondary,backgroundColor:Object(o.Y)().palette.neutralLight,borderRadius:20,padding:"2px 8px",lineHeight:15},closeButton:{color:"unset"},content:{flexGrow:2,display:"flex",flexDirection:"column-reverse",rowGap:12,overflowY:"auto",padding:15,"::-webkit-scrollbar":{width:6,height:10,backgroundColor:Object(o.Y)().palette.neutralPrimary,borderRadius:3},"::-webkit-scrollbar-thumb":{borderRadius:5,backgroundColor:Object(o.Y)().palette.neutralLight},"::-webkit-scrollbar-track":{backgroundColor:Object(o.Y)().palette.neutralLighter}},footer:{padding:15,display:"flex",flexDirection:"column"},aINotice:{fontSize:o.k.xSmall,marginTop:8,lineHeight:14},aINoticeShipped:{fontSize:o.k.xSmall,marginTop:8,lineHeight:14,color:Object(o.Y)().palette.neutralSecondary,fontWeight:"regular"}});t.default=J},34586:function(e,t,n){"use strict";n.d(t,"b",(function(){return qe})),n.d(t,"a",(function(){return Ke}));var i,o,r,a,s,l,c,u,d,p,g,m,b,f,h,v,w,y,O,S,C,I,F,E,j,R,k,D,M,N,x,A,P,T,z,W,U,G,B,L,Z,V,Y,H,_,Q,X,J,q,K=n(11795),$=n(12324),ee=n(11773),te=n(11766),ne=n.n(te),ie=n(22979),oe=n(13009),re=n(18816),ae=n(17758),se=n(13085),le=n(13240),ce=n(20032),ue=n(14904),de=n(12343),pe=n(12375),ge=n(20020),me=n(20039),be=n(15212),fe=n(13031),he=n(13051),ve=n(13223),we=n(34587),ye=n(18822),Oe=n(20040),Se=n(34588),Ce=n(22980),Ie=n(34589),Fe=n(34590),Ee=n(34592),je=n(25054),Re=n(28026),ke=n(20874),De=n(20064),Me=n(17777),Ne=n(34593),xe=n(17190),Ae=n(34594),Pe=n(34595),Te=n(34596),ze=n(18821),We=n(20065),Ue=n(34597),Ge=n(34598);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){Ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ze(e,t,n){return(t=Xe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ve(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(i,o)}function Ye(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){Ve(r,i,o,a,s,"next",e)}function s(e){Ve(r,i,o,a,s,"throw",e)}a(void 0)}))}}function He(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function _e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Xe(i.key),i)}}function Xe(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Je(e,t,n,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var qe=function(e){return e.DiffPreview="diffPreview",e.InvalidParameters="invalidParameters",e.FlowRunError="flowRunError",e}({}),Ke=(o=Je((i=function(){function e(t,n,i,te,ae,ce,ue,ge,be,fe,we,Se,Ce,Ee,ke,De,Me,Ne){var xe=this,Ae=arguments.length>18&&void 0!==arguments[18]?arguments[18]:re.d.PowerAutomate;_e(this,e),this.sessionStore=t,this.environmentStore=n,this.chatbotService=i,this.chatbotDesigner=te,this.loggingService=ae,this.assetService=ce,this.cdnService=ue,this.resources=ge,this.doNotShowAgainService=be,this.telemetryService=fe,this.flowName=we,this.solutionId=Se,this.defaultToSolutionFlowState=Ce,this.flowRun=Ee,this.remediationService=ke,this.flowMonitorService=De,this.designerConnectionStore=Me,this.flowOrigin=Ne,this.clientSource=Ae,this.QUERY_MAX_LENGTH=2e3,this.GREETING_AFTER_FRE_DELAY=1e3,this.SUCCESSIVE_MESSAGES_DELAY=400,this.DO_NOT_SHOW_AGAIN_TIMEOUT=2e3,this.isConnectionsUpdateOnly=!1,this.debugStore=void 0,this.inputTextFieldRef=ne.a.createRef(),this.dispose=()=>{var e;this.designerReadonlyReactionDisposer(),this.designerCurrentFlowReactionDisposer(),this.designerInterfaceStateReactionDisposer(),null===(e=this.logSessionEnd)||void 0===e||e.call(this)},this.designerReadonlyReactionDisposer=void 0,this.designerCurrentFlowReactionDisposer=void 0,this.designerInterfaceStateReactionDisposer=void 0,this.previousDesignerInterfaceState=void 0,He(this,"setChatBotDesigner",o,this),He(this,"setFlowRun",r,this),He(this,"inputQuery",a,this),He(this,"chatHistoryForCopilotAssistantEndpoint",s,this),He(this,"initializeOperation",l,this),He(this,"answerGenerationOperation",c,this),this._isTroubleshootingResponseGenerated=!1,this._flowError=void 0,He(this,"stopAnswerGeneration",u,this),He(this,"setInputQuery",d,this),He(this,"addMessageToConversation",p,this),He(this,"addResponseChatHistoryToCopilotAssistantChatHistory",g,this),He(this,"initializeConversation",m,this),He(this,"initializeConversationInternal",b,this),He(this,"addConnectionMessageToConversationIfNeededAsync",f,this),this.addOperationsNeedingAttentionMessageToConversationIfNeededAsync=function(){var e=Ye((function*(e){var{operationsWithValidationErrors:t,currentFlow:n}=xe.chatbotDesigner;if(n&&t.length){yield Object(me.a)(xe.SUCCESSIVE_MESSAGES_DELAY);var i=Object(ee.toJS)(n);return xe.addMessageToConversation({type:ye.b.OperationsNeedingAttention,connectionReferences:i.connectionReferences,operationsNeedingAttention:Object(Fe.c)(i.definition,t),userAction:e,id:Object(ve.a)(),date:new Date,reaction:void 0,askFeedback:!1}),!0}return!1}));return function(t){return e.apply(this,arguments)}}(),He(this,"onAllOperationsNeedingAttentionFixed",h,this),this.addGreetingMessageToConversation=e=>{this.addMessageToConversation({type:ye.b.Greeting,origin:null!=e?e:je.a.Default,id:Object(ve.a)(),date:new Date,reaction:void 0,askFeedback:!1})},this.addNL2FlowFillParametersSuggestionToConversation=e=>{this.addMessageToConversation({type:ye.b.ReplyWithNL2FlowParametersSuggestionMessage,origin:null!=e?e:je.a.FromNL2Flow,id:Object(ve.a)(),date:new Date,reaction:void 0,askFeedback:!1})},this.addNL2FlowHistoryToConversation=e=>{if(e&&e.length>0)for(var t of e.reverse())t.type===ye.b.Query?this.addMessageToConversation({type:ye.b.Query,text:t.text,id:t.id,date:t.date}):t.type===ye.b.ReplyWithNL2FlowResponse&&this.addMessageToConversation({type:ye.b.Reply,id:t.id,date:t.date,text:t.text,isMarkdownText:t.isMarkdownText,correlationId:t.correlationId,__rawRequest:t.__rawRequest,__rawResponse:t.__rawResponse,reaction:t.reaction,askFeedback:t.askFeedback,intent:void 0,summary:t.state.thought,flow:void 0})},He(this,"clearConversation",v,this),He(this,"showFRE",w,this),He(this,"doNotShowAgainFRE",y,this),He(this,"setShowFRE",O,this),He(this,"onUndoOperationRequested",S,this),He(this,"onSubmitInputQuery",C,this),He(this,"onFlowRunFailure",I,this),He(this,"onFlowRunDebuggingRequest",F,this),He(this,"generateQueryAnswerAsync",E,this),this.handleThinkDeeperQuery=function(){var e=Ye((function*(e,t){e.resolvedConnectionReferences=Object(ze.b)(e.connectionReference,xe.designerConnectionStore),e.featureSource=re.f.streamingChat;var n=yield xe.chatbotService.getAuthoringAgentStreamAsync(e,t),i=Object(ve.a)(),{response:o,steps:r}=yield new Promise((t,o)=>{xe.addMessageToConversation({type:ye.b.DeepReasoningMessage,id:i,date:new Date,askFeedback:!1,reaction:void 0,stream:n,connectionReferences:e.connectionReference,onSuccess:t,onError:o,textDecoderImpl:TextDecoder,deepReasoningSteps:void 0})}),a=Re.a.conversation.findIndex(e=>e.type===ye.b.DeepReasoningMessage&&e.id===i);return Object(ee.runInAction)(()=>{Re.a.conversation[a].deepReasoningSteps=r}),o}));return function(t,n){return e.apply(this,arguments)}}(),this.triggerTroubleshootingCopilot=function(){var e=Ye((function*(e,t,n,i,o,r){var a,s,l,c,{profileEnd:u,profileEndWithSuccess:d}=xe.profileStart({start:se.a.copilotFlowRunDebuggingStart,end:se.a.copilotFlowRunDebuggingEnd},xe.getDataForTelemetry()),p=ye.b.ReplyWithDebuggingSuggestions,{currentFlow:g}=xe.chatbotDesigner;if(g){var m=Object(Fe.c)(null==g?void 0:g.definition,[n]);if(null!=m&&m.length){xe.logEvent(le.c.CopilotFlowRunDebuggingOperationFailureClicked,{flowId:e,flowRunId:t,errorCode:null===(a=i.error)||void 0===a?void 0:a.code,operationType:null===(s=m[0])||void 0===s?void 0:s.operationType,operationId:null===(l=m[0])||void 0===l?void 0:l.operationId,apiId:null===(c=m[0])||void 0===c?void 0:c.apiId});var b=Le({type:p,flowId:e,flowRunId:t},xe.getDataForTelemetry());try{var f,h,v,w=yield xe.chatbotService.getFlowRunDebuggingSuggestionsResponseAsync(i,o),y=null!==(f=null===(h=w.answer)||void 0===h?void 0:h.message)&&void 0!==f?f:xe.resources.FlowRunDebugging.FailedRequestGuidanceMessage.Description;xe.addFlowRunDebuggingMessageToConversation(g,n,i,w,y,e,t,i,void 0,r,(null===(v=w.answer)||void 0===v?void 0:v.format)===re.b.markdown),xe._isTroubleshootingResponseGenerated=!0,xe.logEvent(le.c.Copilot_viewer_of_valuable_LLM_info,Le({hasSuggestedFlows:!!w.flows,flowId:e},xe.getDataForTelemetry())),d(b)}catch(O){xe.addFlowRunDebuggingMessageToConversation(g,n,i,O,xe.resources.FlowRunDebugging.FailedRequestGuidanceMessage.Description,e,t,i,xe.resources.FlowRunDebugging.FailedRequestGuidanceMessage.Title,r),u(oe.e.Failure,Le(Le({},b),{},{reason:"failedCallToFlowRunDebuggingEndpoint"}),O)}}else u(oe.e.Warning,Le({type:p,reason:"noOperationInfo",hasOperationInfo:!(null==m||!m.length)},xe.getDataForTelemetry()))}else u(oe.e.Warning,Le({type:p,reason:"noCurrentFlow",hasFlowId:!!e,hasCurrentFlow:!!g},xe.getDataForTelemetry()))}));return function(t,n,i,o,r,a){return e.apply(this,arguments)}}(),this.handleFlowUpdate=function(){var e=Ye((function*(e,t,n,i,o){var r,a,s,l,{currentFlow:c}=xe.chatbotDesigner;xe.makeUndoUnavailableInConversation();var u=Object(ee.toJS)(c),d=ye.b.ReplyWithFlow;xe.addMessageToConversation({type:d,id:Object(ve.a)(),date:new Date,previousFlow:u,suggestedFlow:e,undoStatus:ye.d.UndoAvailable,text:null!==(r=null==n||null===(a=n.answer)||void 0===a?void 0:a.message)&&void 0!==r?r:"",flowDiff:Object(Fe.b)(e)&&u?Object(Fe.a)(u,e,xe.resources.UpdatingFlowCard):void 0,correlationId:null==n?void 0:n.correlationId,__rawRequest:i,__rawResponse:n,reaction:void 0,askFeedback:!1,intent:Object(ye.i)(null==n?void 0:n.category)?null==n?void 0:n.category:ye.a.Unknown,flow:null==n||null===(s=n.answer)||void 0===s?void 0:s.flow,summary:null==n||null===(l=n.answer)||void 0===l?void 0:l.summary}),t(Le({intent:o,type:d},xe.getDataForTelemetry())),yield xe.addConnectionMessageToConversationIfNeededAsync(e,null==n?void 0:n.correlationId),xe.applyFlowUpdate(e)}));return function(t,n,i,o,r){return e.apply(this,arguments)}}(),this.replyWithErrorAfterException=(e,t)=>{this.addMessageToConversation({type:ye.b.ReplyError,id:Object(ve.a)(),date:new Date,error:e,chatSessionId:Re.a.chatSessionId,__rawRequest:t,__rawResponse:e,reaction:void 0,askFeedback:!1})},this.addFlowRunDebuggingMessageToConversation=function(e,t,n,i,o,r,a,s,l,c){var u=arguments.length>10&&void 0!==arguments[10]&&arguments[10],d=arguments.length>11&&void 0!==arguments[11]&&arguments[11],p=[{guidance:o,isMarkdownText:u}],g=Object(Fe.c)(null==e?void 0:e.definition,[t]);if(c){var m=Re.a.conversation.findIndex(e=>e.type===ye.b.ReplyWithDebuggingSuggestions&&e.id===c);-1!==m&&Object(ee.runInAction)(()=>{var t=Re.a.conversation[m];t.text=null!=l?l:xe.resources.FlowRunDebugging.IFoundTheFollowingError,t.suggestedFlows=p,t.connectionReferences=e.connectionReferences,t.operationWithError=g[0],t.__rawRequest=n,t.__rawResponse=i,t.showAssistMeButton=!1})}else xe.addMessageToConversation({type:ye.b.ReplyWithDebuggingSuggestions,id:Object(ve.a)(),date:new Date,text:null!=l?l:xe.resources.FlowRunDebugging.IFoundTheFollowingError,suggestedFlows:p,connectionReferences:e.connectionReferences,operationWithError:g[0],reaction:void 0,askFeedback:!1,undoStatus:ye.d.Unavailable,flowId:r,flowRunId:a,brokenOperationName:t,troubleshootingRequest:s,__rawRequest:n,__rawResponse:i,showAssistMeButton:d})},He(this,"deactivateAskFeedbackInConversation",j,this),He(this,"onMessageReactionClicked",R,this),He(this,"feedbackPanelItem",k,this),this.endFeedbackPanelProfile=void 0,He(this,"openFeedbackPanel",D,this),He(this,"onFeedbackPanelDismiss",M,this),He(this,"ocvFeedbackType",N,this),He(this,"ocvRawRequest",x,this),He(this,"ocvCopilotResponse",A,this),He(this,"onOcvFeedbackDismiss",P,this),He(this,"onOcvFeedbackSuccess",T,this),He(this,"onOcvFeedbackError",z,this),this.getFeedbackSurveyUserContext=()=>{var e,t,n,i;return{UserId:null!==(e=null===(t=this.sessionStore.minimalUserInfo)||void 0===t?void 0:t.uniqueId)&&void 0!==e?e:"",TenantId:null!==(n=null===(i=this.sessionStore.minimalUserInfo)||void 0===i?void 0:i.tenantId)&&void 0!==n?n:"",SessionId:this.sessionStore.sessionId,Location:Object(K.h)().location,Region:Object(K.h)().region,EnvironmentId:this.environmentStore.currentEnvironmentName,locale:Object(pe.a)()}},He(this,"onConnectionReferencesSetupComplete",W,this),He(this,"getUpdatedFlow",U,this),this.applyFlowUpdate=(e,t)=>{this.updateFlowInDesigner(e,{isConnectionsUpdateOnly:null!=t&&t,markAsDirty:!0})},He(this,"makeUndoUnavailableInConversation",G,this),He(this,"forceSkipConnectionSetup",B,this),this.isLatestMessageFromCopilot=e=>{var t;return(null===(t=Re.a.conversation[0])||void 0===t?void 0:t.id)===e},He(this,"selectOperationInDesigner",L,this),this.logEvent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};xe.loggingService.logInfo(e,"",xe.telemetryData(t),Re.a.chatSessionId)},this.logError=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};xe.loggingService.logError(e,t,xe.telemetryData(n),Re.a.chatSessionId)},this.profileStart=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(he.k)(e)?e:e.start,i=Object(he.k)(e)?e:e.end,o=xe.loggingService.profileStart(n,xe.telemetryData(t)),r=Object($.once)(e=>xe.loggingService.profileEndWithSuccess(o,i,xe.telemetryData(e))),a=Object($.once)((e,t,n)=>xe.loggingService.profileEnd(o,i,e,n,xe.telemetryData(t)));return{scenarioCorrelationId:o,profileEnd:a,profileEndWithSuccess:r}},this.logPageLoadEnd=e=>this.chatbotDesigner.logPageLoadEnd(e),this.telemetryData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Le({chatSessionId:Re.a.chatSessionId,flowOrigin:xe.flowOrigin},e)},this.logSessionStart=()=>{var{profileEnd:e}=this.profileStart(le.c.CopilotPaneSession);this.logSessionEnd=()=>e(oe.e.Success,{})},this.logSessionEnd=void 0,He(this,"selectedPromptGuideItemKey",Z,this),He(this,"onPromptGuideItemClicked",V,this),this.focusOnInput=()=>{setTimeout(()=>{var e;null===(e=this.inputTextFieldRef.current)||void 0===e||e.focus()},300)},He(this,"makeUndoUnavailableOnFlowUpdate",Y,this),He(this,"saveFlowOperation",H,this),He(this,"saveFlow",_,this),He(this,"handleNavigateToEditFlow",Q,this),He(this,"testFlowOperation",X,this),He(this,"testFlow",J,this),this.currentFlowContainsOperation=e=>Object(Ie.a)(this.chatbotDesigner.currentFlow,e),He(this,"nl2FlowFillParametersWithCopilot",q,this),this.debugStore=new Oe.a(te),de.a.isDebugCopilotEnabled&&(this.chatbotService={getChatResponseAsync:(e,t)=>this.debugStore.traced(i.getChatResponseAsync,"chatbotService.getChatResponseAsync")(Le(Le({},e),{},{debugOptions:this.debugStore.options}),t),getFlowRunDebuggingSuggestionsResponseAsync:(e,t)=>this.debugStore.traced(i.getFlowRunDebuggingSuggestionsResponseAsync,"chatbotService.getFlowRunDebuggingSuggestionsResponseAsync")(Le(Le({},e),{},{debugOptions:this.debugStore.options}),t),getAuthoringAgentStreamAsync:(e,t)=>this.debugStore.traced(i.getAuthoringAgentStreamAsync,"chatbotService.getAuthoringAgentStreamAsync")(Le(Le({},e),{},{debugOptions:this.debugStore.options}),t)}),this.designerReadonlyReactionDisposer=Object(ee.reaction)(()=>this.isGeneratingAnswer,e=>this.chatbotDesigner.setReadonly(e)),this.designerCurrentFlowReactionDisposer=Object(ee.reaction)(()=>this.chatbotDesigner.currentFlow,e=>e&&this.makeUndoUnavailableOnFlowUpdate(e)),this.previousDesignerInterfaceState=this.chatbotDesigner.designerInterfaceState,this.designerInterfaceStateReactionDisposer=Object(ee.reaction)(()=>this.chatbotDesigner.designerInterfaceState,e=>{if(e===ie.a.EditingFlow){var t=this.previousDesignerInterfaceState===ie.a.CopilotUpdate?ye.c.editing:void 0;t&&Object(me.a)(500).then(()=>this.addOperationsNeedingAttentionMessageToConversationIfNeededAsync(t))}this.previousDesignerInterfaceState=e})}var t,n,i;return t=e,(n=[{key:"promptGuideMenu",get:function(){var e=this.chatbotDesigner.currentFlow;return Object(Ee.a)(e)?we.d.FromBlank:this.chatbotDesigner.selectedOperation?we.d.FlowWithAction:we.d.DefaultFlow}},{key:"setMessageBarProps",value:function(e){this.chatbotDesigner.setMessageBarProps(e)}},{key:"resetTroubleshootingData",value:function(){this._isTroubleshootingResponseGenerated=!1,this._flowError=void 0}},{key:"isBlockingOperationInProgress",get:function(){return this.initializeOperation.isRunning||this.isGeneratingAnswer||this.isTestingFlow||this.isSaveInProgress}},{key:"isGeneratingAnswer",get:function(){return this.answerGenerationOperation.isRunning}},{key:"isConnectionSetupPending",get:function(){return Re.a.conversation.some(e=>e.type===ye.b.ConnectionsSetup&&!e.isSetupComplete)}},{key:"isChatInputSubmitDisabled",get:function(){return this.isBlockingOperationInProgress||this.inputQuery.length<We.a||this.QUERY_MAX_LENGTH<this.inputQuery.length}},{key:"isTroubleshootingCopilot",get:function(){var e;return!(null===(e=this.flowRun)||void 0===e||null===(e=e.properties)||void 0===e||!e.error)}},{key:"updateConversationContextOnLoad",value:function(){var e=!1,t=this.flowName,n=Re.a.flowId;Object(Me.a)()&&this.flowName&&""!==this.flowName.trim()&&Re.a.flowId===this.flowName?(Re.a.filterOutConversationMessages(ye.b.ConnectionsSetup),e=!0):this.clearConversation(),this.logEvent(le.c.CopilotGlobalContext,Le({isGlobalContext:e,newFlowId:t,currentFlowId:n},this.getDataForTelemetry()))}},{key:"getDataForTelemetry",value:function(){return{isCopilotAssistantEnabled:Object(Me.a)(),isCopilotTroubleshootingV2Enabled:Object(Me.a)(),isTroubleshootingCopilot:this.isTroubleshootingCopilot,isTroubleshootingResponseGenerated:this._isTroubleshootingResponseGenerated,clientSource:this.clientSource,flowOrigin:this.flowOrigin}}},{key:"lastReplyWithFlowMessageId",get:function(){var e;return null===(e=Re.a.conversation.find(e=>e.type===ye.b.ReplyWithFlow))||void 0===e?void 0:e.id}},{key:"lastOperationsNeedAttentionMessageId",get:function(){var e;return null===(e=Re.a.conversation.find(e=>e.type===ye.b.OperationsNeedingAttention))||void 0===e?void 0:e.id}},{key:"operationsWithValidationErrors",get:function(){return this.chatbotDesigner.operationsWithValidationErrors}},{key:"isCurrentFlowValid",get:function(){return!!this.chatbotDesigner.currentFlow&&!this.chatbotDesigner.operationsWithValidationErrors.length}},{key:"isSavingFlowFromCopilot",get:function(){return this.saveFlowOperation.isRunning}},{key:"isSaveInProgress",get:function(){return this.chatbotDesigner.designerInterfaceState===ie.a.SavingFlow}},{key:"canSaveCurrentFlow",get:function(){return this.isCurrentFlowValid&&this.chatbotDesigner.hasUnsavedChanges&&!this.isBlockingOperationInProgress&&!this.isConnectionSetupPending&&!this.isTroubleshootingCopilot}},{key:"isTestingFlow",get:function(){return this.testFlowOperation.isRunning}},{key:"canTestCurrentFlow",get:function(){return this.isCurrentFlowValid&&!this.chatbotDesigner.hasUnsavedChanges&&!this.isBlockingOperationInProgress&&!this.isConnectionSetupPending&&!this.chatbotDesigner.isInDraftState&&!this.isTroubleshootingCopilot}},{key:"updateFlowInDesigner",value:function(e,t){var{profileEnd:n,profileEndWithSuccess:i}=this.profileStart({start:se.a.copilotUpdateFlowDesignerStart,end:se.a.copilotUpdateFlowDesignerEnd},this.getDataForTelemetry());try{this.chatbotDesigner.updateFlow(Object(ee.toJS)(e),t),i(),this.logEvent(le.c.CopilotUpdateFlowDesignerCompleted)}catch(o){throw n(oe.e.Failure,{},o),this.logError(le.c.CopilotUpdateFlowDesignerError,o),o}}}])&&Qe(t.prototype,n),i&&Qe(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"setChatBotDesigner",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chatbotDesigner!==e&&(this.chatbotDesigner=e,de.a.isDebugCopilotEnabled&&(this.debugStore.chatbotDesigner=e))}}}),r=Je(i.prototype,"setFlowRun",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{Object(Me.a)()&&(this.flowRun=e)}}}),a=Je(i.prototype,"inputQuery",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=Je(i.prototype,"chatHistoryForCopilotAssistantEndpoint",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=Je(i.prototype,"initializeOperation",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return be.b.NotStarted()}}),c=Je(i.prototype,"answerGenerationOperation",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return be.a.NotStarted()}}),Je(i.prototype,"isBlockingOperationInProgress",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"isBlockingOperationInProgress"),i.prototype),Je(i.prototype,"isGeneratingAnswer",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"isGeneratingAnswer"),i.prototype),Je(i.prototype,"isConnectionSetupPending",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"isConnectionSetupPending"),i.prototype),u=Je(i.prototype,"stopAnswerGeneration",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.answerGenerationOperation.abort()}}}),Je(i.prototype,"isChatInputSubmitDisabled",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"isChatInputSubmitDisabled"),i.prototype),d=Je(i.prototype,"setInputQuery",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{0===e.length&&(this.selectedPromptGuideItemKey=void 0),this.inputQuery=e}}}),p=Je(i.prototype,"addMessageToConversation",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{Re.a.conversation=[Object(ee.observable)(e),...Re.a.conversation],this.logEvent(le.c.CopilotMessageAdded,{conversationItem:Object(Ae.a)(e)})}}}),g=Je(i.prototype,"addResponseChatHistoryToCopilotAssistantChatHistory",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chatHistoryForCopilotAssistantEndpoint=e}}}),m=Je(i.prototype,"initializeConversation",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Object($.once)(Ye((function*(){e.logSessionStart(),e.initializeOperation=Object(be.d)(e.initializeConversationInternal()),yield e.initializeOperation.promise})))}}),b=Je(i.prototype,"initializeConversationInternal",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Ye((function*(){var t=yield e.doNotShowAgainService.isDoNotShowAgain(ae.a.CopilotChatFRE,e.DO_NOT_SHOW_AGAIN_TIMEOUT).then(t=>(e.telemetryService.tagEvent(le.c.CopilotChatFREDoNotShowAgainCheckSucceeded),t)).catch(t=>(e.telemetryService.tagEvent(le.c.CopilotChatFREDoNotShowAgainCheckFailed,null,{error:t}),!1));e.setShowFRE(!t&&e.flowOrigin!==je.a.FromFlowRunDetails),e.updateConversationContextOnLoad(),e.flowOrigin===je.a.FromNL2Flow&&ge.a.naturalLanguagePrompt?(yield Object(me.a)(e.SUCCESSIVE_MESSAGES_DELAY),e.addMessageToConversation({type:ye.b.Query,id:Object(ve.a)(),date:new Date,text:ge.a.naturalLanguagePrompt}),Object(Te.a)()&&Object(Ue.a)()&&e.addNL2FlowFillParametersSuggestionToConversation(e.flowOrigin)):e.flowOrigin===je.a.FromMultiTurnNL2Flow&&(ge.a.flowDescription&&(yield Object(me.a)(e.SUCCESSIVE_MESSAGES_DELAY),e.addGreetingMessageToConversation(e.flowOrigin)),Object(ke.a)()&&ge.a.conversation.length>0&&e.addNL2FlowHistoryToConversation(ge.a.conversation)),0!==Re.a.conversation.length||e.flowOrigin===je.a.FromFlowRunDetails||e.flowOrigin===je.a.FromMultiTurnNL2Flow&&ge.a.flowDescription||(yield Object(me.a)(e.showFRE?e.GREETING_AFTER_FRE_DELAY:e.SUCCESSIVE_MESSAGES_DELAY),e.addGreetingMessageToConversation(e.flowOrigin));var{currentFlow:n}=e.chatbotDesigner;n&&e.flowOrigin!==je.a.FromFlowRunDetails&&(e.isConnectionsUpdateOnly=!0,yield e.addConnectionMessageToConversationIfNeededAsync(n,void 0,!0)),e.flowOrigin!==je.a.FromNL2Flow&&e.flowOrigin!==je.a.FromMultiTurnNL2Flow&&e.flowOrigin!==je.a.FromTemplate||e.addOperationsNeedingAttentionMessageToConversationIfNeededAsync(ye.c.editing)}))}}),f=Je(i.prototype,"addConnectionMessageToConversationIfNeededAsync",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Ye((function*(t,n,i){var{currentFlow:o}=e.chatbotDesigner,r=i?Object.keys(t.connectionReferences):Object(Ce.d)(o?o.connectionReferences:{},t.connectionReferences);return null!=r&&r.length?(yield Object(me.a)(e.SUCCESSIVE_MESSAGES_DELAY),e.addMessageToConversation({type:ye.b.ConnectionsSetup,id:Object(ve.a)(),date:new Date,flowDefinition:t.definition,connectionReferences:t.connectionReferences,connectionReferencesNeedingSetup:r,isSetupComplete:!1,correlationId:n,reaction:void 0,askFeedback:!1}),!0):(e.isConnectionsUpdateOnly=!1,!1)}));return function(e,n,i){return t.apply(this,arguments)}}()}}),h=Je(i.prototype,"onAllOperationsNeedingAttentionFixed",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logEvent(le.c.CopilotAllOperationsNeedingAttentionFixed,{conversationItem:Object(Ae.a)(e)}),e.operationsNeedingAttention=[]}}}),v=Je(i.prototype,"clearConversation",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e;Re.a.resetConversation(null!==(e=this.flowName)&&void 0!==e?e:"")}}}),w=Je(i.prototype,"showFRE",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=Je(i.prototype,"doNotShowAgainFRE",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.showFRE=!1,this.doNotShowAgainService.markDoNotShowAgain(ae.a.CopilotChatFRE,this.DO_NOT_SHOW_AGAIN_TIMEOUT).catch(()=>{}),this.logEvent(le.c.CopilotFirstRunExperienceEnded)}}}),O=Je(i.prototype,"setShowFRE",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.showFRE=e}}}),S=Je(i.prototype,"onUndoOperationRequested",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.updateFlowInDesigner(e.previousFlow,{isConnectionsUpdateOnly:!1}),this.logEvent(le.c.CopilotFlowUpdateUndone,{conversationItem:Object(Ae.a)(e)}),this.forceSkipConnectionSetup(e),this.makeUndoUnavailableInConversation(),e.undoStatus=ye.d.Undone}}}),C=Je(i.prototype,"onSubmitInputQuery",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.answerGenerationOperation=Object(be.c)(e=>this.generateQueryAnswerAsync(e),this.loggingService,le.c.CopilotAnswerGenerationOperation,this.telemetryData)}}}),I=Je(i.prototype,"onFlowRunFailure",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Ye((function*(){var t,n,i,o,r,a,s,l,c,u,d,p,g;if(e.flowRun&&Object(Me.a)()&&e.flowRun.properties.error){var{profileEnd:m,profileEndWithSuccess:b}=e.profileStart({start:se.a.copilotFlowRunFailureStart,end:se.a.copilotFlowRunFailureEnd},e.getDataForTelemetry()),{currentFlow:f}=e.chatbotDesigner,h=Object(Pe.b)(e.flowRun),v=ye.b.ReplyWithDebuggingSuggestions;if(h&&f){var w,y=e.flowRun.name,O=Le({type:v,flowId:h,flowRunId:y},e.getDataForTelemetry());try{w=yield e.remediationService.getFlowFailureRemediationMetadata(h,y)}catch(j){return void m(oe.e.Warning,Le(Le({},O),{},{reason:"failedCallToGetFlowFailureRemediationMetadata"}),j)}if(null!==(t=w)&&void 0!==t&&t.data){var S=w.data,C=Object(Pe.a)(S.operationOutputs,e.flowRun);e.logEvent(le.c.CopilotFlowRunDebuggingRemediationData,{flowId:h,flowRunId:y,errorCode:null==C?void 0:C.code,hasErrorDescription:Object(Ne.b)(S.errorDescription),hasErrorSubject:Object(Ne.b)(S.errorSubject),hasRemediation:Object(Ne.b)(S.remediation),remediationType:S.remediationType,troubleshootingTipsSize:null===(n=S.troubleshootingTips)||void 0===n?void 0:n.length,universalSearchResultsBlogSize:null===(i=S.universalSearchResults)||void 0===i||null===(i=i[xe.a.blog])||void 0===i?void 0:i.length,universalSearchResultsCommunitySize:null===(o=S.universalSearchResults)||void 0===o||null===(o=o[xe.a.community])||void 0===o?void 0:o.length,universalSearchResultsArticleSize:null===(r=S.universalSearchResults)||void 0===r||null===(r=r[xe.a.article])||void 0===r?void 0:r.length,documentationLinkId:null===(a=S.documentationLink)||void 0===a?void 0:a.id,documentationLinkUrl:null===(s=S.documentationLink)||void 0===s||null===(s=s.properties)||void 0===s?void 0:s.url,additionalDocumentationLinksSize:null===(l=S.additionalDocumentationLinks)||void 0===l?void 0:l.length,hasOperationOutputs:void 0!==S.operationOutputs});var I=Object(Ne.a)(S.errorSubject,e.flowRun.properties,e.loggingService);if(I){var F=Object(Fe.c)(null==f?void 0:f.definition,[I]);if(null!=F&&F.length){e.logEvent(le.c.CopilotFlowRunDebuggingOperationFailureData,{flowId:h,flowRunId:y,errorCode:null==C?void 0:C.code,operationType:null===(c=F[0])||void 0===c?void 0:c.operationType,operationId:null===(u=F[0])||void 0===u?void 0:u.operationId,apiId:null===(d=F[0])||void 0===d?void 0:d.apiId}),e._flowError={brokenOperationName:I,documentationURL:null===(p=S.documentationLink)||void 0===p||null===(p=p.properties)||void 0===p?void 0:p.url,errorDescription:S.errorDescription,errorSubject:S.errorSubject,remediation:S.remediation,error:C};var E={definition:null==f?void 0:f.definition,errorDescription:S.errorDescription,errorSubject:S.errorSubject,remediation:S.remediation,documentationURL:null===(g=S.documentationLink)||void 0===g||null===(g=g.properties)||void 0===g?void 0:g.url,error:C,brokenOperationName:I,chatEntries:Re.a.conversation.reverse().filter(Object(he.i)(ye.k,ye.e,ye.g)).map(ye.l),chatHistory:e.chatHistoryForCopilotAssistantEndpoint,isQAndAOnly:!0,featureSource:re.f.troubleShooting,clientSource:e.clientSource,troubleshootingType:re.g.runtime};Object(Me.b)()?e.addFlowRunDebuggingMessageToConversation(f,I,E,void 0,"",h,y,E,void 0,void 0,!1,!0):e.onFlowRunDebuggingRequest(h,y,I,E),b(O)}else m(oe.e.Warning,Le(Le({},O),{},{reason:"noOperationInfo",hasOperationInfo:!(null==F||!F.length)}))}else m(oe.e.Warning,Le(Le({},O),{},{reason:"noBrokenOperationFound",hasBrokenOperationName:!1}))}else m(oe.e.Warning,Le(Le({},O),{},{reason:"noRemediationData"}))}else m(oe.e.Warning,Le({type:v,reason:"noFlowIdOrCurrentFlow",hasFlowId:!!h,hasCurrentFlow:!!f},e.getDataForTelemetry()))}}))}}),F=Je(i.prototype,"onFlowRunDebuggingRequest",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,n,i,o)=>{var r=Object(be.c)(r=>this.triggerTroubleshootingCopilot(e,t,n,i,r,o),this.loggingService,le.c.CopilotFlowRunDebuggingOperation,this.telemetryData);Object(Me.b)()||(this.answerGenerationOperation=r)}}}),E=Je(i.prototype,"generateQueryAnswerAsync",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Ye((function*(t){var n,i,o,r,a,s,l=Object(Me.a)(),{profileEnd:c,profileEndWithSuccess:u}=e.profileStart({start:l?se.a.CopilotChatAssistantResponseStart:se.a.copilotSendMessageStart,end:l?se.a.CopilotChatAssistantResponseEnd:se.a.copilotSendMessageEnd},e.getDataForTelemetry());e.logEvent(le.c.CopilotFlowRunDebuggingChatInput,Le({},e.getDataForTelemetry()));var d=e.inputQuery.trim(),p=e.selectedPromptGuideItemKey;e.addMessageToConversation({type:ye.b.Query,id:Object(ve.a)(),date:new Date,text:d}),e.setInputQuery(""),e.selectedPromptGuideItemKey=void 0;var g=ye.b.ReplyError,{currentFlow:m}=e.chatbotDesigner,b=e.isTroubleshootingCopilot&&e._isTroubleshootingResponseGenerated?re.f.troubleShooting:re.f.chat,f={chatSessionId:Re.a.chatSessionId,chatEntries:Re.a.conversation.reverse().filter(Object(he.i)(ye.k,ye.e,ye.g)).map(ye.l),definition:null==m?void 0:m.definition,checkHallucinatedActions:Object(ce.a)(),isDesignerCopilotMultiturnEnabled:Object(ke.a)(),flowId:e.flowName,connectionReference:null==m?void 0:m.connectionReferences,resolvedConnectionReferences:Object(ze.b)(null==m?void 0:m.connectionReferences,e.designerConnectionStore),chatHistory:e.chatHistoryForCopilotAssistantEndpoint,brokenOperationName:null===(n=e._flowError)||void 0===n?void 0:n.brokenOperationName,documentationURL:null===(i=e._flowError)||void 0===i?void 0:i.documentationURL,error:null===(o=e._flowError)||void 0===o?void 0:o.error,errorDescription:null===(r=e._flowError)||void 0===r?void 0:r.errorDescription,errorSubject:null===(a=e._flowError)||void 0===a?void 0:a.errorSubject,remediation:null===(s=e._flowError)||void 0===s?void 0:s.remediation,isQAndAOnly:!!e.flowRun,featureSource:b,clientSource:e.clientSource,troubleshootingType:b===re.f.troubleShooting?re.g.runtime:void 0},h=ye.a.Unknown;try{var v,w,y={};if(Object(Te.a)()){var O=Re.a.conversation;Re.a.conversation=O.filter(t=>!(t.type===ye.b.Query&&t.text===e.resources.Nl2FlowChatInput.FillParametersWithCopilotPrompt))}if(null!==(v=y=Object(Ue.a)()?yield e.handleThinkDeeperQuery(f,t):yield e.chatbotService.getChatResponseAsync(f,t))&&void 0!==v&&v.chatHistory)e.addResponseChatHistoryToCopilotAssistantChatHistory(null===(w=y)||void 0===w?void 0:w.chatHistory);h=Object(ye.i)(y.category)?y.category:"".concat(ye.a.Unknown,":").concat(y.category);var S,C,I,F,E,j,R=e.getUpdatedFlow(y.flows,m);if(R)e.handleFlowUpdate(R,u,y,f);else g=ye.b.Reply,e.addMessageToConversation({type:ye.b.Reply,id:Object(ve.a)(),date:new Date,text:null!==(S=null===(C=y.answer)||void 0===C?void 0:C.message)&&void 0!==S?S:e.resources.DefaultMessages.NoAnswer,isMarkdownText:(null===(I=y.answer)||void 0===I?void 0:I.format)===re.b.markdown,correlationId:y.correlationId,__rawRequest:f,__rawResponse:y,reaction:void 0,askFeedback:!1,intent:null===(F=y.answer)||void 0===F?void 0:F.intent,flow:null===(E=y.answer)||void 0===E?void 0:E.flow,summary:null===(j=y.answer)||void 0===j?void 0:j.summary}),u(Le({intent:h,type:g},e.getDataForTelemetry()))}catch(k){Object(ee.runInAction)(()=>{e.setInputQuery(d),e.selectedPromptGuideItemKey=p}),e.answerGenerationOperation.aborted||e.answerGenerationOperation.aborting?Object(ee.runInAction)(()=>{e.answerGenerationOperation=be.a.NotStarted(),Re.a.conversation.shift()}):e.replyWithErrorAfterException(k,f),c(oe.e.Failure,Le({intent:h,type:g},e.getDataForTelemetry()),k)}}));return function(e){return t.apply(this,arguments)}}()}}),j=Je(i.prototype,"deactivateAskFeedbackInConversation",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{Re.a.conversation.forEach(e=>{Object(ye.j)(e)&&(e.askFeedback=!1)})}}}),R=Je(i.prototype,"onMessageReactionClicked",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,n,i)=>{e.reaction===t?(e.reaction=void 0,e.askFeedback=!1,this.logEvent(n,Le({conversationItem:Object(Ae.a)(e)},this.getDataForTelemetry()))):(this.deactivateAskFeedbackInConversation(),e.reaction=t,e.askFeedback=!1,this.ocvCopilotResponse=Object(Ge.a)(e.__rawResponse),this.ocvRawRequest=JSON.stringify(e.__rawRequest),this.openFeedbackPanel(e,i),this.logEvent(i,Le({conversationItem:Object(Ae.a)(e)},this.getDataForTelemetry())))}}}),k=Je(i.prototype,"feedbackPanelItem",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Je(i.prototype,"openFeedbackPanel",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.ocvFeedbackType=Object(Ge.b)(e.reaction,Object(De.c)({isTroubleshootingCopilot:this.isTroubleshootingCopilot,isCopilotAssistantEnabled:Object(Me.a)(),isDesignTimeTroubleshootingCopilot:Object(ye.f)(e)}),this.ocvRawRequest,this.ocvCopilotResponse,this.loggingService),this.feedbackPanelItem=e;var{profileEnd:n}=this.profileStart(t,{conversationItem:Object(Ae.a)(e)});this.endFeedbackPanelProfile=()=>n(oe.e.Success,{conversationItem:Object(Ae.a)(e)})}}}),M=Je(i.prototype,"onFeedbackPanelDismiss",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.feedbackPanelItem&&(this.feedbackPanelItem.askFeedback=!1),this.feedbackPanelItem=void 0,this.endFeedbackPanelProfile()}}}),N=Je(i.prototype,"ocvFeedbackType",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=Je(i.prototype,"ocvRawRequest",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Je(i.prototype,"ocvCopilotResponse",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Je(i.prototype,"onOcvFeedbackDismiss",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.feedbackPanelItem&&(this.feedbackPanelItem.askFeedback=!1),this.ocvFeedbackType=void 0,this.feedbackPanelItem=void 0,this.endFeedbackPanelProfile()}}}),T=Je(i.prototype,"onOcvFeedbackSuccess",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.loggingService.logInfo(le.c.CopilotFeedbackPanelSessionSuccess,"Feedback sent successfully"),this.onOcvFeedbackDismiss()}}}),z=Je(i.prototype,"onOcvFeedbackError",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.loggingService.logError(le.c.CopilotFeedbackPanelSessionError,{name:le.c.CopilotFeedbackPanelSessionError,message:null!=e?e:"Unknown error sending feedback"}),this.onOcvFeedbackDismiss()}}}),W=Je(i.prototype,"onConnectionReferencesSetupComplete",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Ye((function*(t,n,i,o){var r,{isSkipped:a}=null!=o?o:{},s={definition:Object(ee.toJS)(t.flowDefinition),connectionReferences:Object(Ce.a)(Object(ee.toJS)(t.connectionReferences),Object(Ce.f)(n,t.connectionReferencesNeedingSetup),!!e.solutionId)};if(a)r=!1;else{var l=Object(ee.toJS)(s.connectionReferences),c=Object(ee.toJS)(t.connectionReferences);r=!Object(Se.a)(c,l)}if(t.isSetupComplete=!0,e.setMessageBarProps(void 0),r){t.connectionReferences=s.connectionReferences;var u=e.flowOrigin===je.a.FromBlankWithTrigger&&Object(ue.b)();yield e.chatbotDesigner.refreshConnections({clearTriggerConnectionErrorInDesigner:u}),(null==i?void 0:i.length)>0&&(e.isConnectionsUpdateOnly=!0),e.applyFlowUpdate(s,e.isConnectionsUpdateOnly)}e.isConnectionsUpdateOnly=!1}));return function(e,n,i,o){return t.apply(this,arguments)}}()}}),U=Je(i.prototype,"getUpdatedFlow",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var n=null==e?void 0:e[0];return n&&t&&(n=Object(Ce.g)(n,t)),n}}}),G=Je(i.prototype,"makeUndoUnavailableInConversation",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{Re.a.conversation.forEach(e=>{"replyWithFlow"===e.type&&(e.undoStatus=ye.d.Unavailable)})}}}),B=Je(i.prototype,"forceSkipConnectionSetup",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{for(var t=Re.a.conversation.indexOf(e)-1;t>=0;t--){var n=Re.a.conversation[t];if(Object(ye.k)(n))break;n.type===ye.b.ConnectionsSetup&&(n.isSetupComplete=!0)}}}}),Je(i.prototype,"lastReplyWithFlowMessageId",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"lastReplyWithFlowMessageId"),i.prototype),Je(i.prototype,"lastOperationsNeedAttentionMessageId",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"lastOperationsNeedAttentionMessageId"),i.prototype),L=Je(i.prototype,"selectOperationInDesigner",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.currentFlowContainsOperation(e)&&(this.chatbotDesigner.selectOperation(e,t),this.logEvent(le.c.CopilotOperationSelectedFromDiff,t))}}}),Z=Je(i.prototype,"selectedPromptGuideItemKey",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Je(i.prototype,"onPromptGuideItemClicked",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;this.logEvent(le.c.CopilotPromptGuideItemSelected,{promptGuideItem:e.itemKey,promptGuideMenu:this.promptGuideMenu}),this.selectedPromptGuideItemKey=e.itemKey;var n=e=>{this.setInputQuery(e),this.focusOnInput()},i=this.resources.PromptGuide.QueryTemplates,o=null===(t=this.chatbotDesigner.selectedOperation)||void 0===t?void 0:t.displayName;switch(e.itemKey){case we.c.ReplaceAction:o&&n(Object(fe.a)(i.ReplaceActionSentenceStartFormat,o));break;case we.c.AddAction:n(i.AddActionSentenceStart);break;case we.c.ExplainAction:o&&(n(Object(fe.a)(i.ExplainActionSentenceFormat,o)),this.onSubmitInputQuery());break;case we.c.ExplainFlow:n(i.ExplainFlowSentence),this.onSubmitInputQuery();break;case we.c.CreateFlowExample1:n(i.CreateFlow1SentenceStart);break;case we.c.CreateFlowExample2:n(i.CreateFlow2SentenceStart);break;case we.c.CreateFlowExample3:n(i.CreateFlow3SentenceStart);break;case we.c.Question:n(i.QuestionSentenceStart);break;case we.c.EditFlow:n(i.EditFlowSentenceStart);break;case we.c.CreateFlow:}}}}),Y=Je(i.prototype,"makeUndoUnavailableOnFlowUpdate",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{}}}),Je(i.prototype,"isCurrentFlowValid",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"isCurrentFlowValid"),i.prototype),H=Je(i.prototype,"saveFlowOperation",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return be.b.NotStarted()}}),Je(i.prototype,"canSaveCurrentFlow",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"canSaveCurrentFlow"),i.prototype),_=Je(i.prototype,"saveFlow",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveFlowOperation=Object(be.e)(this.chatbotDesigner.saveFlow(),this.loggingService,le.c.CopilotSaveFlow,()=>this.telemetryData())}}}),Q=Je(i.prototype,"handleNavigateToEditFlow",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.logEvent(le.c.CopilotFlowRunDebuggingNavigateToDesigner),this.flowMonitorService.navigateToEditMode(),this.chatbotDesigner.handleNavigateToEditFlow&&this.chatbotDesigner.handleNavigateToEditFlow()}}}),X=Je(i.prototype,"testFlowOperation",[ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return be.b.NotStarted()}}),Je(i.prototype,"canTestCurrentFlow",[ee.computed],Object.getOwnPropertyDescriptor(i.prototype,"canTestCurrentFlow"),i.prototype),J=Je(i.prototype,"testFlow",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.testFlowOperation=Object(be.e)(this.chatbotDesigner.testFlow(),this.loggingService,le.c.CopilotTestFlow,()=>this.telemetryData())}}}),q=Je(i.prototype,"nl2FlowFillParametersWithCopilot",[ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var{profileEnd:e,profileEndWithSuccess:t}=this.profileStart({start:se.a.copilotFillParametersWithCopilotStart,end:se.a.copilotFillParametersWithCopilotEnd},this.getDataForTelemetry());try{this.inputQuery=this.resources.Nl2FlowChatInput.FillParametersWithCopilotPrompt,this.onSubmitInputQuery(),t()}catch(n){this.replyWithErrorAfterException(n),e(oe.e.Failure,{},n)}}}}),i)},34587:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return I}));var i=n(12862),o=n(12860),r=n(12821),a=n(12754),s=n(12816),l=n(11766),c=n.n(l),u=n(13259),d=n(13272),p=["navigation"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var h=function(e){return e.FromBlank="FromBlank",e.CreateFlow="CreateFlow",e.FlowWithAction="FlowWithAction",e.DefaultFlow="DefaultFlow",e}({}),v=function(e){return e.CreateFlow="CreateFlow",e.CreateFlowExample1="CreateFlowExample1",e.CreateFlowExample2="CreateFlowExample2",e.CreateFlowExample3="CreateFlowExample3",e.Question="Question",e.AddAction="AddAction",e.ReplaceAction="ReplaceAction",e.ExplainAction="ExplainAction",e.EditFlow="EditFlow",e.ExplainFlow="ExplainFlow",e}({}),w=(e,t,n)=>[e,t,n].filter(Boolean).join("-"),y=e=>{var{isOpen:t,onDismiss:n,target:a,onMenuItemClick:s,initialMenu:l=h.FromBlank,resources:u}=e,{Title:g,CreateFlow:b,AddAction:y,EditFlow:C,ExplainFlow:I,ExplainAction:F,ReplaceAction:E,AskQuestion:j,CreateFlowSubMenuItems:R}=u,k=function(e){var[t,n]=c.a.useState([e]),i=c.a.useMemo(()=>({goTo:e=>n(t=>[...t,e]),goBack:()=>n(e=>e.slice(0,-1)),reset:e=>n(t=>[null!=e?e:t[0]])}),[]),o=t[t.length-1],r=t.length>1;return{menuKey:o,isSubMenu:r,navigation:i}}(l),{navigation:D}=k,M=f(k,p);c.a.useEffect(()=>{t?D.reset(l):D.reset()},[t,D,l]);var N,x,A,P,T=(e,t)=>({key:w(e,"header"),text:t,itemType:i.a.Header,onRenderIcon:M.isSubMenu?()=>c.a.createElement(S,{onClick:D.goBack,resources:u}):void 0,hasIcons:M.isSubMenu,iconProps:M.isSubMenu?{iconName:"ChevronLeft"}:{styles:{root:{display:"none"}}}}),z=(e,t,n)=>({key:w(e,t),text:n.text,itemType:i.a.Normal,iconProps:n.iconName?{iconName:n.iconName,styles:{root:{display:"flex"}}}:void 0,onClick:n=>{null==s||s({menuKey:e,itemKey:t})}}),W=[T(h.CreateFlow,b),z(h.CreateFlow,v.CreateFlowExample1,{text:R.Example1}),z(h.CreateFlow,v.CreateFlowExample2,{text:R.Example2}),z(h.CreateFlow,v.CreateFlowExample3,{text:R.Example3})],U=[T(h.FromBlank,g),(N=h.FromBlank,x=v.CreateFlow,A=h.CreateFlow,P={text:b,iconName:"Add"},m(m({},z(N,x,P)),{},{onClick:e=>{D.goTo(A),null==e||e.preventDefault(),null==e||e.stopPropagation()}})),z(h.FromBlank,v.Question,{text:j,iconName:d.a.UnknownF9})],G=[T(h.FlowWithAction,g),z(h.FlowWithAction,v.AddAction,{text:y,iconName:"Add"}),z(h.FlowWithAction,v.ReplaceAction,{text:E,iconName:"Refresh"}),z(h.FlowWithAction,v.ExplainAction,{text:F,iconName:"AlignJustify"}),z(h.FlowWithAction,v.Question,{text:j,iconName:d.a.UnknownF9})],B=[T(h.DefaultFlow,g),z(h.DefaultFlow,v.AddAction,{text:y,iconName:"Add"}),z(h.DefaultFlow,v.EditFlow,{text:C,iconName:"Refresh"}),z(h.DefaultFlow,v.ExplainFlow,{text:I,iconName:"AlignJustify"}),z(h.DefaultFlow,v.Question,{text:j,iconName:d.a.UnknownF9})],L={[h.FromBlank]:U,[h.CreateFlow]:W,[h.FlowWithAction]:G,[h.DefaultFlow]:B};return c.a.createElement(o.a,{hidden:!t,onDismiss:n,target:a,isSubMenu:M.isSubMenu,items:L[M.menuKey],styles:O,directionalHint:r.a.topLeftEdge})};var O={container:{borderRadius:8,width:288},root:{borderRadius:8},subComponentStyles:{callout:{container:{borderRadius:8},root:{borderRadius:8},calloutMain:{borderRadius:8}}},header:{color:Object(a.Y)().palette.neutralSecondary},list:{color:Object(a.Y)().palette.black,padding:4,".ms-ContextualMenu-icon":{color:Object(a.Y)().palette.neutralSecondary},".ms-ContextualMenu-link":{borderRadius:4}}},S=e=>{var{onClick:t,resources:n}=e,{Back:i}=n;return c.a.createElement(u.a,{title:i,iconName:d.a.ChevronLeft,onClick:t,iconButtonStyles:C})},C={root:{color:Object(a.Y)().palette.neutralPrimary,marginTop:6}},I=e=>{var t,n,{itemKey:i,resources:o}=e,{Cards:r}=o;switch(i){case v.AddAction:t="Add",n=r.AddAction;break;case v.ReplaceAction:t="Refresh",n=r.ReplaceAction;break;case v.EditFlow:t="Refresh",n=r.EditFlow;break;case v.Question:t=d.a.UnknownF9,n=r.Question}return n?c.a.createElement("div",{className:F.container},c.a.createElement("div",{className:F.header},t&&c.a.createElement(s.a,{iconName:t}),c.a.createElement("div",null,n.Title)),c.a.createElement("div",{className:F.description},n.Description)):null},F=Object(a.db)({container:{width:"100%",backgroundColor:Object(a.Y)().palette.white,border:"1px solid ".concat(Object(a.Y)().palette.themePrimary),borderRadius:8,display:"flex",flexDirection:"column",rowGap:8,padding:"8px 12px 8px 12px",marginBottom:16},header:{display:"flex",flexDirection:"row",columnGap:8,alignItems:"center",fontWeight:a.l.semibold,".ms-Icon":{color:Object(a.Y)().palette.themePrimary}},description:{color:Object(a.Y)().palette.neutralSecondary,fontSize:a.k.small}})},34588:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(12330),o=n(12324),r=n(13051),a=e=>Object(i.a)(e),s=(e,t)=>{var n=l(e).sort(),i=l(t).sort();if(!Object(o.isEqual)(n,i))return!1;var c=new Set([...n,...i]);for(var u of c){var d=e[u],p=t[u];if(a(d)||a(p))return!1;if(Object(r.j)(r.k,r.m)(d)&&Object(r.j)(r.k,r.m)(p)){if(!s(d,p))return!1}else if(!Object(o.isEqual)(d,p))return!1}return!0},l=e=>Object.keys(e).filter(t=>!a(e[t])),c=(e,t)=>s(e,t)},34589:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(20858),o=(e,t)=>!(!e||!Object(i.a)(e.definition.triggers,e=>e.operationName===t)&&!Object(i.a)(e.definition.actions,e=>e.operationName===t))},34590:function(e,t,n){"use strict";var i=n(34591);n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return i.b})),n.d(t,"c",(function(){return i.c}))},34591:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d}));var i=n(20859),o=n(20022),r=n(15432),a=n(22676),s=n(19691);function l(e){return!!e.diffResult}function c(e,t,n){var{addedSentence:i,removedSentence:o,changedSentence:r}=function(e,t,n,i){var o=e=>e.some(e=>e===t||e===n),{addedOperationNames:r,removedOperationNames:a,changedOperationNames:s}=e;return{addedSentence:u(i.AddedOperationSentenceFormat,o(r),r.length,i),removedSentence:u(i.RemovedOperationSentenceFormat,o(a),a.length,i),changedSentence:u(i.ChangedOperationSentenceFormat,o(s),s.length,i)}}(t.diffResult,Object.keys(e.definition.triggers)[0],Object.keys(t.definition.triggers)[0],n),{addedOperations:a,removedOperations:s,changedOperations:l}=function(e,t){var{addedOperationNames:n,removedOperationNames:i,changedOperationNames:o}=t.diffResult;return{addedOperations:d(t.definition,n),removedOperations:d(e.definition,i),changedOperations:d(t.definition,o)}}(e,t);return{added:i&&a?{sentence:i,operations:a}:void 0,removed:o&&s?{sentence:o,operations:s}:void 0,changed:r&&l?{sentence:r,operations:l}:void 0}}function u(e,t,n,i){if(0!==n){var o=n-(t?1:0);return t?Object(s.b)(e,Object(a.b)(i.Operations.TriggerWithAction_plural,o)):Object(s.b)(e,Object(a.b)(i.Operations.Action_plural,o))}}function d(e,t){var{triggers:n={},actions:a={}}=e;return Object(r.c)(t.map(e=>{var t;return null!==(t=Object(i.a)(n,t=>t.operationName===e))&&void 0!==t?t:Object(i.a)(a,t=>t.operationName===e)})).map(e=>Object(o.a)(e.operationName,e.operation))}},34592:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=e=>{var t,n,i=(null==e||null===(t=e.definition)||void 0===t?void 0:t.actions)&&Object.keys(e.definition.actions).length>0,o=(null==e||null===(n=e.definition)||void 0===n?void 0:n.triggers)&&Object.keys(e.definition.triggers).length>0;return!e||!e.definition||!i&&!o}},34593:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var i=n(17777);function o(e,t,n){if(t){if(Object(i.a)()){var o,a=!0;if("failed"===(null===(o=t.trigger)||void 0===o?void 0:o.status.toLocaleLowerCase())){var s,l;if(r(null===(s=t.trigger)||void 0===s?void 0:s.name))return n.logInfo("TroubleshootingCopilot_FailedTrigger","Found failure on trigger"),null===(l=t.trigger)||void 0===l?void 0:l.name;n.logWarning("TroubleshootingCopilot_FailedTrigger","Trigger run failed but trigger name was not found"),a=!1}if(a&&t.actions&&Object.keys(t.actions).length>0){var c=Object.entries(t.actions).map(e=>{var[t,n]=e;return{key:t,value:n}}).filter(e=>"failed"===e.value.status.toLocaleLowerCase());if(c.length>0)return c=c.sort((e,t)=>e.value.startTime>t.value.startTime?-1:0),n.logInfo("TroubleshootingCopilot_FailedAction","Found failure on action"),c[0].key}n.logWarning("TroubleshootingCopilot_NoFailedOperation","Did not find failed trigger or action in flow run data")}return function(e,t){if(!t||!e)return;var n=e.split("'");if(n.length<=1)return;var i=n[1],o=t.actions&&i in t.actions,r=t.trigger&&i===t.trigger.name;if(!o&&!r)return;return i}(e,t)}}function r(e){return!(null==e||!e.trim())}},34594:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(18822),o=n(22980),r=e=>{if(e.type===i.b.ReplyWithNL2FlowResponse)throw new Error("Conversation item type ".concat(i.b.ReplyWithNL2FlowResponse," is only supported in Create With Natural Language page."));var t={type:e.type,itemId:e.id,date:e.date.toISOString()};return"reaction"in e&&(t.reaction=e.reaction),"text"in e?t.messageLength=e.text.length:"messageToExplain"in e&&(t.messageLength=e.messageToExplain.length),"undoStatus"in e&&(t.undoStatus=e.undoStatus),"intent"in e&&(t.intent=e.intent),"origin"in e&&(t.origin=e.origin),"operationsNeedingAttention"in e&&(t.operationsNeedingAttentionCount=e.operationsNeedingAttention.length),"connectionReferences"in e&&e.connectionReferences&&(t.connectionReferences=a(e.connectionReferences)),t},a=e=>Object.entries(e).map(e=>{var t,n,i,r,[a,s]=e;return{isConnected:Object(o.e)(s),apiId:null!==(t=null!==(n=null===(i=s.apiDefinition)||void 0===i?void 0:i.id)&&void 0!==n?n:null===(r=s.api)||void 0===r?void 0:r.id)&&void 0!==t?t:s.id,key:a}})},34595:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var i=n(13051),o=n(18816);function r(e){var t=e.id.split("/");return"flows"===t[5]&&"runs"===t[7]?t[6]:void 0}function a(e,t){return Object(i.h)(e,{body:e=>Object(i.h)(e,{error:o.h})})?e.body.error:Object(i.h)(e,{error:o.h})?e.error:Object(o.h)(e)?e:Object(o.i)(e)&&e.errors.length>0?e.errors[0]:t.properties.error}},34596:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(11809),o=n(11896),r=Object(o.a)({teamName:i.a.PowerAutomateClientTeam,owners:["SDEEPALA"],description:"Enables NL2Flow Fill Parameters With Copilot",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1584711",createdOn:"04/14/2025",fallback:{isFillparametersWithCopilotEnabled:!1}}),{getFeatureValue:a}=Object(o.b)(r,e=>!!e.isFillparametersWithCopilotEnabled)},34597:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(11809),o=n(11897),r=Object(o.a)({teamName:i.a.PowerAutomateClientTeam,owners:["aiflows"],description:"The think deeper feature which utilizes the streaming endpoint for flow authoring.",ecsURL:"https://ecs.skype.com/PowerAutomate/PowerAutomateClientTeam/configurations/1586046",createdOn:"04/16/2025",fallback:{isThinkDeeperEnabled:!1}}),{getFeatureValue:a,useFeatureValue:s}=Object(o.b)(r,"isThinkDeeperEnabled")},34598:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var i=n(18816),o=n(20062),r=n(20063),a=n(17145),s=n(17102),l=n(17144),c=e=>{if(e){var t,n=JSON.parse(JSON.stringify(e));if(n.answer)return n.answer;if(n.flows&&n.flows.length>0)return null!==(t=n.flows[0])&&void 0!==t&&null!==(t=t.definition)&&void 0!==t&&t.parameters&&(n.flows[0].definition.parameters=void 0),n.flows}},u=(e,t,n,c,u)=>{var d=Object(o.a)(),p=Object(r.a)();if(d){var g=Object(a.a)(n,c),{handleFeedbackSmileClick:m,handleFeedbackFrownClick:b}=Object(s.c)(Object(a.c)({loggingService:u,featureArea:t,stringifiedMetadata:g}));if(e===i.c.thumbsDown)return p&&b(g),l.a.ThumbsDown;if(e===i.c.thumbsUp)return p&&m(g),l.a.ThumbsUp}}},34599:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var i=n(12754),o=n(15539),r=n(11766),a=n(15431),s=n(30224),l=n(20083),c=e=>{var{children:t}=e,n=u(),o=Object(i.eb)(n.root);return Object(a.c)(r.Children.toArray(t)).length?r.createElement("div",{className:o},t):null},u=()=>({root:{display:"flex",justifyContent:"flex-end",gap:8,marginBottom:8}}),d=e=>{var{text:t,iconName:n,onClick:i}=e,a=p(),s=g();return r.createElement(o.a,{text:t,iconProps:{iconName:n,styles:a},onClick:i,styles:s})},p=()=>{var e=Object(i.Y)();return Object(l.a)({root:{color:e.palette.neutralPrimaryAlt,display:"flex",alignItems:"center"}})},g=()=>{var e=Object(i.Y)();return Object(l.a)({root:{color:e.palette.neutralPrimaryAlt,border:"1px solid ".concat(e.palette.themeTertiary),borderRadius:8,height:24,backgroundColor:"transparent",fontSize:i.k.smallPlus},rootHovered:{color:e.palette.neutralPrimary,backgroundColor:e.palette.themeLighter,borderColor:Object(s.a)(e.palette.themeSecondary,.7)},rootPressed:{color:e.palette.neutralPrimary,borderColor:Object(s.a)(e.palette.themeSecondary,.9)},iconHovered:{color:e.palette.neutralPrimary},iconPressed:{color:e.palette.neutralPrimary}})}},34600:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n(14337),o=n(11766),r=n.n(o),a=n(13272),s=n(13240),l=n(18822),c=n(34601),u=n(34603),d=n(34604),p=n(34607),g=n(34609),m=n(34610),b=n(20850),f=n(34612),h=n(34615),v=n(34602),w=n(34657),y=e=>{var{item:t,store:n,resources:i,loggingService:o}=e;switch(t.type){case l.b.Query:return r.a.createElement(O,{item:t,resources:i});case l.b.Reply:return r.a.createElement(S,{item:t,resources:i,store:n});case l.b.ExplainError:return r.a.createElement(d.a,{item:t,resources:i,store:n});case l.b.ReplyWithFlow:return r.a.createElement(p.a,{item:t,resources:i,store:n});case l.b.ReplyWithDebuggingSuggestions:return r.a.createElement(g.a,{item:t,resources:i,store:n});case l.b.ReplyError:return r.a.createElement(c.a,{item:t,resources:i,store:n});case l.b.Greeting:return r.a.createElement(u.a,{item:t,resources:i,store:n});case l.b.ConnectionsSetup:return r.a.createElement(f.a,{item:t,store:n,resources:i});case l.b.OperationsNeedingAttention:return r.a.createElement(w.a,{item:t,store:n,resources:i});case l.b.ReplyWithNL2FlowParametersSuggestionMessage:return r.a.createElement(m.a,{item:t,resources:i,store:n});case l.b.DeepReasoningMessage:return r.a.createElement(h.a,{item:t,loggingService:o});default:return null}},O=e=>{var{item:t,resources:n}=e;return r.a.createElement(b.a,{key:t.id,isUserMessage:!0,isAIGenerated:!1,date:t.date,isMarkdownMessage:!1,resources:n},t.text)},S=Object(i.c)(e=>{var{item:t,resources:n,store:i}=e;return r.a.createElement("div",{key:t.id},r.a.createElement(b.a,{isUserMessage:!1,isAIGenerated:!0,date:t.date,isMarkdownMessage:t.isMarkdownText,selectedReaction:t.reaction,onThumbsReactionClicked:e=>i.onMessageReactionClicked(t,e,s.c.CopilotMessageVoteRemoved,s.c.CopilotMessageVoteSelected),disabled:i.isBlockingOperationInProgress,footerActions:i.debugStore.isUsingDebugOptions?[{text:n.DevMode.ReportABug,onClick:()=>i.debugStore.onReportBugClick(t),iconProps:{iconName:a.a.Bug}}]:void 0,resources:n},t.text),r.a.createElement(v.a,{item:t,store:i,resources:n,feedbackPanelTelemetryEventName:s.c.CopilotFeedbackPanelSession}))})},34601:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n(12754),o=n(14337),r=n(11766),a=n.n(r),s=n(13272),l=n(17219),c=n(20850),u=n(34602),d=n(13240),p=n(28026),g=Object(o.c)(e=>{var t,n,i,{item:o,resources:r,store:g}=e,b=[];g.debugStore.isUsingDebugOptions&&b.push({text:r.DevMode.ReportABug,onClick:()=>g.debugStore.onReportBugClick(o),iconProps:{iconName:s.a.Bug}});var f=o.error,h=null==f||null===(t=f.response)||void 0===t?void 0:t.data,v=(null==f||null===(n=f.response)||void 0===n?void 0:n.status)===l.a.TooManyRequests;v||b.push({text:r.Copy,onClick:()=>navigator.clipboard.writeText("chatSessionId: ".concat(o.chatSessionId)),iconProps:{iconName:s.a.CopyF9}});var w=v?r.DefaultMessages.ThrottlingError:a.a.createElement(m,{message:null!==(i=h.Message)&&void 0!==i?i:r.DefaultMessages.TechnicalError,chatSessionId:p.a.chatSessionId});return a.a.createElement("div",null,a.a.createElement(c.a,{key:o.id,isUserMessage:!1,isAIGenerated:!1,date:o.date,isMarkdownMessage:!1,selectedReaction:o.reaction,onThumbsReactionClicked:e=>g.onMessageReactionClicked(o,e,d.c.CopilotMessageVoteRemoved,d.c.CopilotMessageVoteSelected),disabled:g.isGeneratingAnswer,footerActions:b,resources:r},w),a.a.createElement(u.a,{item:o,store:g,resources:r,feedbackPanelTelemetryEventName:d.c.CopilotFeedbackPanelSession}))}),m=e=>{var{message:t,chatSessionId:n}=e;return a.a.createElement(a.a.Fragment,null,t,a.a.createElement("pre",{className:b.container},a.a.createElement("div",{className:b.sessionIdContainer},a.a.createElement("span",{className:b.sessionId},"chat-session-id:"),n)))},b=Object(i.db)({container:{border:"1px solid ".concat(Object(i.Y)().palette.neutralLight),borderRadius:10,background:Object(i.Y)().palette.neutralLighterAlt,padding:12,marginTop:12,whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:i.k.medium,lineHeight:"1.5",display:"flex",flexDirection:"row",alignItems:"center"},sessionIdContainer:{flex:"1 1 auto"},sessionId:{marginRight:"5px",fontWeight:i.l.semibold}})},34602:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(14337),o=n(11766),r=n.n(o),a=n(20850),s=n(18816),l=n(14346),c=n(12754),u=n(14678),d=Object(i.c)(e=>{var{item:t,resources:n,store:i,feedbackPanelTelemetryEventName:o}=e;return t.askFeedback?r.a.createElement(a.a,{key:t.id,isUserMessage:!1,isAIGenerated:!1,date:t.date,isMarkdownMessage:!1,className:Object(c.eb)({marginTop:8}),resources:n},r.a.createElement(r.a.Fragment,null,t.reaction===s.c.thumbsUp&&r.a.createElement(l.a,{onClick:()=>i.openFeedbackPanel(t,o),text:n.FeedbackCard.ThumbsUpLinkText,isUnderlinedStyle:!0,dataAutomationId:u.a.buttons.chatButtons.provideFeedbackButton}),t.reaction===s.c.thumbsDown&&r.a.createElement(l.a,{onClick:()=>i.openFeedbackPanel(t,o),text:n.FeedbackCard.ThumbsDownLinkText,isUnderlinedStyle:!0,dataAutomationId:u.a.buttons.chatButtons.provideFeedbackButton}))):null})},34603:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(14337),o=n(20850),r=n(11766),a=n.n(r),s=n(34602),l=n(25054),c=n(24351),u=n(13240),d=Object(i.c)(e=>{var{item:t,resources:n,store:i}=e,r=n.GreetingMessage;return a.a.createElement("div",{"data-automation-id":c.a.greetingMessage},a.a.createElement(o.a,{key:t.id,isUserMessage:!1,isAIGenerated:!0,date:t.date,selectedReaction:t.reaction,onThumbsReactionClicked:e=>i.onMessageReactionClicked(t,e,u.c.CopilotMessageVoteRemoved,u.c.CopilotMessageVoteSelected),disabled:i.isBlockingOperationInProgress,resources:n,isEmphasized:!0},a.a.createElement("div",{style:{marginBottom:12}},p(t.origin,r)),a.a.createElement("ul",null,a.a.createElement("li",null,r.SuggestedPrompts.FirstItem),a.a.createElement("li",null,r.SuggestedPrompts.SecondItem),a.a.createElement("li",null,r.SuggestedPrompts.ThirdItem)),a.a.createElement("div",{style:{marginTop:12}},r.SaveYourFlow)),a.a.createElement(s.a,{item:t,store:i,resources:n,feedbackPanelTelemetryEventName:u.c.CopilotFeedbackPanelSession}))}),p=(e,t)=>{switch(e){case l.a.FromNL2Flow:return t.FromNL2Flow;case l.a.Default:default:return t.FromOpenedFlow}}},34604:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(24351),o=n(13234),r=n(34605),a=n(14337),s=n(11766),l=n.n(s),c=n(20850),u=n(34602);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var p=Object(a.c)(e=>{var{item:t,resources:n,store:a}=e;return l.a.createElement("div",{"data-automation-id":i.a.explainErrorMessage},l.a.createElement(c.a,{date:t.date,disabled:a.isBlockingOperationInProgress,isAIGenerated:!0,isEmphasized:!0,isUserMessage:!1,onThumbsReactionClicked:e=>a.onMessageReactionClicked(t,e,o.c.CopilotMessageVoteRemoved,o.c.CopilotMessageVoteSelected),resources:n,selectedReaction:t.reaction},l.a.createElement(r.a,d({},t,{resources:{copy:n.ExplainError.CopyButton,copyOriginalError:n.ExplainError.CopyOriginal,copySummary:n.ExplainError.CopySummary,couldNotGetErrorExplanation:n.ExplainError.CouldNotGetErrorExplanation,header:n.ExplainError.Header}}))),l.a.createElement(u.a,{feedbackPanelTelemetryEventName:o.c.CopilotFeedbackPanelSession,item:t,resources:n,store:a}))})},34605:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n(16189),o=n(16362),r=n(13787),a=n(18817),s=n(13047),l=n(12327),c=n(16e3),u=n(14785),d=n(11766),p=n.n(d),g=n(20851),m=n(28019),b=n(34606);function f(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(i,o)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){f(r,i,o,a,s,"next",e)}function s(e){f(r,i,o,a,s,"throw",e)}a(void 0)}))}}var v=Object(o.a)(r.G,r.H),w=e=>{var{messageToExplain:t,onQueryAiHostedModelChat:n,resources:o,workflowData:r}=e,d=Object(b.a)(),{data:f,error:w,isError:y,isFetching:O}=Object(u.a)(["explainErrorCard",t],h((function*(){var e={chatEntries:[],chatHistory:[],chatSessionId:"",connectionReference:null==r?void 0:r.connectionReferences,definition:null==r?void 0:r.definition,isQAndAOnly:!0,featureSource:a.f.troubleShooting,clientSource:a.d.PowerAutomate,troubleshootingType:a.g.authoring,errorDescription:Object(m.a)(String(t))};return yield n(e)}))),S=null,C="";if(y)C=Object(s.a)(w).message;else if(O)S=p.a.createElement(c.ib,{className:d.loadingSkeleton},p.a.createElement(c.jb,null),p.a.createElement(c.jb,null));else{var I,F=null==f||null===(I=f.answer)||void 0===I?void 0:I.message;F&&(S=p.a.createElement(g.a,null,F))}S||(S=o.couldNotGetErrorExplanation);var E=function(){var e=h((function*(e){yield navigator.clipboard.writeText(e)}));return function(t){return e.apply(this,arguments)}}();return p.a.createElement("div",{"aria-busy":O,className:d.root},p.a.createElement(c.mb,{as:"h3",className:d.header},p.a.createElement("div",null,o.header)),S,C?p.a.createElement("div",{className:d.footerContent},C):null,p.a.createElement("div",{className:d.footerButtons},p.a.createElement(c.O,{positioning:"below-end"},p.a.createElement(c.T,{disableButtonEnhancement:!0},e=>p.a.createElement(i.a,{icon:p.a.createElement(v,null),menuButton:e,primaryActionButton:{onClick:()=>E(t)},size:"small"},o.copy)),p.a.createElement(c.S,null,p.a.createElement(c.R,null,p.a.createElement(c.Q,{onClick:()=>E(t)},o.copyOriginalError),Object(l.k)(S)?p.a.createElement(c.Q,{onClick:()=>E(String(S))},o.copySummary):null)))))}},34606:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(13859),o=n(13680),r=Object(i.a)({root:{display:"flex",flexDirection:"column",gap:o.a.spacingVerticalS},loadingSkeleton:{display:"flex",flexDirection:"column",gap:o.a.spacingVerticalXS,"& :last-child":{width:"50%"}},header:{alignItems:"center",display:"flex",gap:o.a.spacingHorizontalS,"& i":{lineHeight:0}},footerContent:{alignItems:"center",display:"flex",fontSize:o.a.fontSizeBase200,gap:o.a.spacingVerticalS,justifyContent:"space-between"},footerButtons:{display:"flex",gap:o.a.spacingVerticalXS}})},34607:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var i=n(12811),o=n(12754),r=n(14337),a=n(24351),s=n(11766),l=n.n(s),c=n(18822),u=n(20850),d=n(13272),p=n(15941),g=n(13029),m=n(20851),b=n(14678),f=n(15497),h=n(34608),v=n(34586),w=n(34602),y=n(13240),O=Object(r.c)(e=>{var{item:t,resources:n,store:o}=e,{onUndoOperationRequested:r,onMessageReactionClicked:s,debugStore:{isUsingDebugOptions:O,onReportBugClick:C},assetService:I,cdnService:F}=o,[E,j]=l.a.useState(!1),R=l.a.useCallback(()=>{r(t),j(!1)},[t,r]),k=[];return t.undoStatus===c.d.UndoAvailable?k.push({text:n.Undo,onClick:()=>j(!0),iconProps:{iconName:d.a.Undo},disabled:o.isBlockingOperationInProgress||o.isTroubleshootingCopilot}):t.undoStatus===c.d.Undone&&k.push({text:n.ActionUndone,disabled:!0}),O&&k.push({text:n.DevMode.ReportABug,onClick:()=>C(t),iconProps:{iconName:d.a.Bug},disabled:o.isBlockingOperationInProgress}),l.a.createElement("div",null,l.a.createElement(u.a,{key:t.id,isUserMessage:!1,isAIGenerated:!0,date:t.date,selectedReaction:t.reaction,onThumbsReactionClicked:e=>s(t,e,y.c.CopilotMessageVoteRemoved,y.c.CopilotMessageVoteSelected),footerActions:k,resources:n,isEmphasized:!!t.flowDiff},l.a.createElement(m.a,{className:Object(i.a)(t.undoStatus===c.d.Undone&&S.undone)},t.text),""!==t.text&&l.a.createElement("br",null),t.previousFlow&&t.flowDiff&&(0!==Object.values(t.flowDiff).length?l.a.createElement(h.a,{previousFlow:t.previousFlow,suggestedFlow:t.suggestedFlow,flowDiff:t.flowDiff,assetService:I,cdnService:F,resources:n.UpdatingFlowCard,onOperationClick:e=>{t.id===o.lastReplyWithFlowMessageId&&t.undoStatus!==c.d.Undone&&o.selectOperationInDesigner(e,{scenario:v.b.DiffPreview})}}):l.a.createElement(l.a.Fragment,null,n.DefaultMessages.FlowUpdatedWithNoDiff)),l.a.createElement(f.b,{hidden:!E,title:n.UndoDialog.Title,primaryButtonProps:{text:n.UndoDialog.PrimaryButtonActionText,onClick:R,dataAutomationId:b.a.buttons.confirmDialogButton},secondaryButtonProps:{text:n.UndoDialog.SecondaryButtonActionText,onClick:()=>j(!1),dataAutomationId:b.a.buttons.cancelDialogButton},onDismiss:()=>j(!1),automationId:a.a.undoDialog},l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a,{interpolatedString:n.UndoDialog.SubTextFormat,linkProps:{ariaLabel:n.UndoDialog.LearnMoreAriaLabel,href:"https://go.microsoft.com/fwlink/?linkid=2230043",target:g.a.blank}}),l.a.createElement("div",{className:S.warningMessage},n.UndoDialog.WarningMessage)))),l.a.createElement(w.a,{item:t,store:o,resources:n,feedbackPanelTelemetryEventName:y.c.CopilotFeedbackPanelSession}))}),S=Object(o.db)({undone:{color:Object(o.Y)().palette.neutralSecondary},warningMessage:{paddingTop:"20px"}})},34608:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(11766),o=n.n(i),r=n(20073),a=n(12754),s=n(15918),l=e=>{var{previousFlow:t,suggestedFlow:n,flowDiff:i,assetService:l,cdnService:u,onOperationClick:d,resources:p}=e,{added:g,changed:m,removed:b}=i,f=c(),h=Object(a.eb)(f.operationList),v=Object(a.eb)(f.description),w=Object(s.a)();return o.a.createElement("div",null,(null==b?void 0:b.sentence)&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:v},b.sentence),o.a.createElement(r.c,{operations:b.operations.map(e=>({info:e})),connectionReferences:t.connectionReferences,assetService:l,cdnService:u,flowServiceClientResources:w,className:h})),(null==m?void 0:m.sentence)&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:v},m.sentence),o.a.createElement(r.c,{operations:m.operations.map(e=>({info:e,onClick:d&&(()=>d(e.operationName))})),connectionReferences:n.connectionReferences,assetService:l,cdnService:u,flowServiceClientResources:w,className:h})),(null==g?void 0:g.sentence)&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:v},g.sentence),o.a.createElement(r.c,{operations:g.operations.map(e=>({info:e,onClick:d&&(()=>d(e.operationName))})),connectionReferences:n.connectionReferences,assetService:l,cdnService:u,flowServiceClientResources:w,className:h})),((null==m?void 0:m.sentence)||(null==g?void 0:g.sentence))&&o.a.createElement("div",null,p.CheckActions))},c=()=>({root:{},description:{marginBottom:8},operationList:{width:"100%",listStyle:"none",padding:0}})},34609:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n(12754),o=n(14337),r=n(11766),a=n.n(r),s=n(20850),l=n(13272),c=n(20851),u=n(34586),d=n(20073),p=n(34602),g=n(15918),m=n(12854),b=n(14346),f=n(13240),h=n(24351),v=n(20082),w=Object(o.c)(e=>{var t,{item:n,resources:i,store:o}=e,[w,F]=Object(r.useState)(0),[E,j]=Object(r.useState)(!1),[R,k]=Object(r.useState)(!!o.flowRun);Object(r.useEffect)(()=>{k(!!o.flowRun)},[o.flowRun]);var{onMessageReactionClicked:D,debugStore:{isUsingDebugOptions:M,onReportBugClick:N},assetService:x,cdnService:A}=o,P=n.suggestedFlows.length,[T,z]=Object(r.useState)(!1),W=Object(g.a)(),U=()=>0!==w,G=()=>w!==n.suggestedFlows.length-1,B=()=>{G()&&F(w+1)},L=[];n.showAssistMeButton?E||L.push({text:i.FlowRunDebugging.AssistMe,onClick:()=>{o.onFlowRunDebuggingRequest(n.flowId,n.flowRunId,n.brokenOperationName,n.troubleshootingRequest,n.id),j(!0)},iconProps:{iconName:l.a.SparkleF9CustomColor},disabled:o.isBlockingOperationInProgress}):(0===w&&G()&&!T&&L.push({text:i.FlowRunDebugging.ViewAnotherSuggestion,onClick:()=>{B(),z(!0)}}),R&&L.push({text:i.FlowRunDebugging.EditTheFlow,onClick:()=>{k(!1),o.handleNavigateToEditFlow()},iconProps:{iconName:l.a.Edit},dataAutomationId:h.a.editFlowButton}),M&&L.push({text:i.DevMode.ReportABug,onClick:()=>N(n),iconProps:{iconName:l.a.Bug},disabled:o.isBlockingOperationInProgress}));return a.a.createElement("div",null,a.a.createElement(s.a,{key:n.id,isUserMessage:!1,isAIGenerated:!0,date:n.date,selectedReaction:n.reaction,onThumbsReactionClicked:e=>D(n,e,f.c.CopilotFlowRunDebuggingVoteRemoved,f.c.CopilotFlowRunDebuggingVoteSelected),footerActions:L,resources:i},a.a.createElement(c.a,{className:y.header},n.text),a.a.createElement(d.b,{operation:n.operationWithError,connectionReferences:n.connectionReferences,assetService:x,cdnService:A,flowServiceClientResources:W,onClick:()=>o.selectOperationInDesigner(n.operationWithError.operationName,{scenario:u.b.FlowRunError}),statusIcon:{iconName:l.a.Error2.valueOf(),className:O.failedIcon}}),n.showAssistMeButton?a.a.createElement("div",{className:C.section},E?a.a.createElement("div",{className:C.section},i.ChatProgressCard.Working,a.a.createElement(v.b,{styles:void 0})):a.a.createElement("div",null,i.FlowRunDebugging.NeedTroubleshootingAssistance)):a.a.createElement("div",null,a.a.createElement("div",{className:C.section},!0===n.suggestedFlows[w].isMarkdownText?a.a.createElement(c.a,null,n.suggestedFlows[w].guidance):n.suggestedFlows[w].guidance),n.suggestedFlows[w].additionalLinks?null===(t=n.suggestedFlows[w].additionalLinks)||void 0===t?void 0:t.map((e,t)=>{return i=t,void 0!==(n=e)?a.a.createElement("div",{key:i,className:C.section},a.a.createElement("div",null,n.title,":"),a.a.createElement(m.a,{iconProps:{iconName:n.iconName.valueOf(),className:S.icon},href:n.url}),a.a.createElement(b.a,{text:n.text,href:n.url,isUnderlinedStyle:!0})):null;var n,i}):null,T||P>1&&0!==w?a.a.createElement("div",{className:I.suggestionNavigator},a.a.createElement(m.a,{iconProps:{iconName:l.a.ChevronLeft},disabled:!U(),onClick:()=>{U()&&F(w-1)}}),a.a.createElement("span",null,"".concat((null!=w?w:0)+1," of ").concat(P)),a.a.createElement(m.a,{iconProps:{iconName:l.a.ChevronRight},disabled:!G(),onClick:B})):null)),a.a.createElement(p.a,{item:n,store:o,resources:i,feedbackPanelTelemetryEventName:f.c.CopilotFlowRunDebuggingFeedbackPanelSession}))}),y=Object(i.db)({header:{fontWeight:"bold",marginBottom:12}}),O=Object(i.db)({failedIcon:{color:Object(i.Y)().semanticColors.errorIcon}}),S=Object(i.db)({icon:{color:Object(i.Y)().semanticColors.link}}),C=Object(i.db)({section:{marginBottom:12}}),I=Object(i.db)({suggestionNavigator:{display:"flex",alignItems:"center",marginTop:16,button:{margin:0},span:{lineHeight:"0"}}})},34610:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n(14337),o=n(13778),r=n(13875),a=n(14021),s=n(20850),l=n(11766),c=n.n(l),u=n(24351),d=n(13240),p=n(34611),g=Object(i.c)(e=>{var{item:t,resources:n,store:i}=e,[g,m]=Object(l.useState)(!0),b=Object(p.a)();return g?c.a.createElement("div",{"data-automation-id":u.a.nl2FlowFillParametersDialog},c.a.createElement(s.a,{key:t.id,isUserMessage:!1,isAIGenerated:!1,date:t.date,resources:n,isEmphasized:!0},c.a.createElement("div",null,n.GreetingMessage.NL2FlowFillParametersMessage),c.a.createElement("div",{className:b.buttonDiv},c.a.createElement(o.a,{"data-automation-id":u.a.nl2FlowFillParametersButton,icon:{children:c.a.createElement("span",{className:b.icon},c.a.createElement(r.f,null))},className:b.root,shape:"rounded",iconPosition:"before",onClick:()=>{i.nl2FlowFillParametersWithCopilot()}},c.a.createElement("span",{className:b.text},n.GreetingMessage.NL2FlowFillParametersAction)),c.a.createElement(o.a,{"data-automation-id":u.a.nl2FlowFillParametersNoThanksButton,icon:{children:c.a.createElement("span",{className:b.icon},c.a.createElement(a.z,null))},className:b.root,onClick:()=>m(!1),iconPosition:"before",shape:"rounded"},c.a.createElement("span",{className:b.text},n.GreetingMessage.NL2FlowFillParametersNoThanksAction))))):(i.logEvent(d.c.CopilotNL2FlowFillParametersSuggestionMessageDismissed),null)})},34611:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(13859),o=Object(i.a)({root:{border:"1px solid #ccc",alignItems:"center",display:"flex"},icon:{fontSize:"16px",fontWeight:"normal !important",alignItems:"center"},text:{fontWeight:"normal !important",fontSize:"14px"},buttonDiv:{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"start",alignItems:"center",marginTop:"8px"}})},34612:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n(12754),o=n(11766),r=n.n(o),a=n(19714),s=n(19696),l=n(18950),c=n(13272),u=n(13240),d=n(34613),p=n(22980),g=n(20850),m=n(19710),b=n(34614),f=n(34602);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=e=>{var{item:t,resources:n,store:i}=e,l=Object(a.c)(),{fixReferencedConnections:c,getConnectionFetchState:u,getConnectionLoadState:d,referencedApisNotSetUp:g,registerReferencedConnectionsUpdateCallback:m,unregisterReferencedConnectionsUpdateCallback:f}=l,h=Object(o.useRef)(!1),[w,y]=Object(o.useState)(!1),[S,C]=Object(o.useState)(t.connectionReferences),[I,F]=Object(o.useState)([""]),E=u(),j=d();return Object(o.useEffect)(()=>{var e=(e,t)=>(C(e),Promise.resolve());return m(e),()=>{f(e)}},[m,f]),E===s.a.LoadStarted?r.a.createElement(b.b,{resources:n.ConnectionsSetupCard}):(t.correlationId&&t.connectionReferencesNeedingSetup.length>0&&!h.current&&E===s.a.LoadCompleted&&(h.current=!0,c(t.connectionReferences).then(e=>{var n=v(v({},e.connectionsBeforeFixing),e.fixedConnections),o=e.apiNamesNotFixed;C(n),F(o),i.onConnectionReferencesSetupComplete(t,n,I)})),t.isSetupComplete||w||0===I.length||E===s.a.Error||j===s.b.Completed?r.a.createElement(b.a,{connectionStatuses:Object.entries(S).filter(e=>{var[n]=e;return t.connectionReferencesNeedingSetup.includes(n)}).map(e=>{var[t,i]=e;return{apiName:Object(p.b)(t,i),connectionId:i.connectionId,isConnected:!g.has(t),resources:n.ConnectionsSetupCard}})}):r.a.createElement(O,{item:t,onSkip:()=>{l.complete(),y(!0)},connections:S,resources:n,store:i}))},O=e=>{var{item:t,onSkip:n,connections:i,resources:s,store:p}=e,b=Object(l.c)(),h=Object(a.c)(),{connections:v,getConnectionLoadState:w,getIsXrmConnectionReferenceMode:y,updateReferencedConnections:O}=h,C=y(),I=Object(o.useCallback)(()=>{p.onConnectionReferencesSetupComplete(t,i,[],{isSkipped:!0}),n()},[i,t,n,p]);return r.a.createElement("div",null,r.a.createElement(g.a,{date:t.date,disabled:p.isBlockingOperationInProgress,footerActions:[{iconProps:{iconName:c.a.Forward},onClick:I,text:s.ConnectionsSetupCard.Skip}],isAIGenerated:!0,isMarkdownMessage:!1,isUserMessage:!1,key:t.id,onThumbsReactionClicked:e=>p.onMessageReactionClicked(t,e,u.c.CopilotMessageVoteRemoved,u.c.CopilotMessageVoteSelected),resources:s,selectedReaction:t.reaction},r.a.createElement("div",{className:S.message},s.ConnectionsSetupCard.Description),r.a.createElement(d.a,{context:b,displayMode:"compact",items:Object.entries(i).map(e=>{var t,n,[i,o]=e,r=(null===(t=o.api)||void 0===t?void 0:t.id)||(null===(n=o.apiDefinition)||void 0===n?void 0:n.id)||o.id,s=Object(m.a)(v,r,o,C),l=w();return{connectionDetails:a.a.includes(l)?null!=s?s:null:null!=s?s:"loading",referencedConnectionName:i,connectorFallback:r,existingConnections:v.filter(e=>e.properties.api.id===r),isXrmConnectionReferenceMode:C}}),onReferencedConnectionsUpdate:O})),r.a.createElement(f.a,{feedbackPanelTelemetryEventName:u.c.CopilotFeedbackPanelSession,item:t,resources:s,store:p}))},S=Object(i.db)({message:{paddingBottom:8}})},34613:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(13275),o=n(11766),r=n.n(o),a=n(18951),s=n(13051),l=n(19704),c=n(19714),u=e=>{var{context:t,displayMode:n,items:o,onReferencedConnectionsUpdate:u}=e,{designerConnectionService:d}=Object(c.c)();return r.a.createElement(i.a,null,o.map(e=>{var{connectionDetails:i,connectorFallback:o}=e,c=Object(s.k)(o)?o:null==o?void 0:o.id,p=Object(s.k)(i)?i:null==i?void 0:i.id;return r.a.createElement(l.a,{context:t,displayMode:n,item:e,key:"DietConnectionsStack.".concat(c,".").concat(p),onPermissionsClick:e=>{var{cdnService:n,clientResources:i,surfaceStore:o}=t;Object(a.a)(o,e,i,n)},onReferencedConnectionsUpdate:u,connectionService:d})}))}},34614:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var i=n(11766),o=n.n(i),r=n(12816),a=n(12811),s=n(12754),l=n(15995),c=n(13241);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var d=e=>{var{apiName:t,isConnected:n,resources:i}=e,s=n?i.ConnectedFormat:i.NotConnectedFormat;return o.a.createElement("span",{className:b.status},o.a.createElement(r.a,{iconName:n?"Completed":"Error",className:Object(a.a)(b.icon,n&&m)}),o.a.createElement("span",{className:b.text},o.a.createElement(l.a,{formatText:s,onRenderSegment:Object(l.c)({ApiName:t})})))},p=e=>{var{connectionStatuses:t}=e;return o.a.createElement("div",{className:b.root},t.map(e=>o.a.createElement(d,u({key:"ConnectionStatusList.".concat(e.connectionId||e.apiName)},e))))},g=e=>{var{resources:t}=e;return o.a.createElement("div",{className:b.root},o.a.createElement("span",{className:b.status},o.a.createElement(c.a,{className:b.spinner,size:c.b.small,ariaLabel:t.ConnectionsLoading}),o.a.createElement("span",{className:b.text},t.ConnectionsLoading)))},m="is-connected",b=Object(s.db)({root:{display:"flex",flexDirection:"column",rowGap:"16px",paddingLeft:8},status:{display:"flex",alignItems:"center"},text:{display:"flex",whiteSpace:"pre-wrap",flexWrap:"wrap"},spinner:{paddingRight:8},icon:{paddingRight:8,color:"red",["&.".concat(m)]:{color:"green"}}})},34615:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(14337),o=n(24351),r=n(34620),a=n(11766),s=n.n(a),l=n(34616),c=n(13223),u=n(18821),d=n(34618),p=n(12706),g=n(34619);function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function b(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(i,o)}var f=Object(i.c)(e=>{var t,n,{item:i,loggingService:f,copilotHeader:h,clientResources:v,isThinking:w=!1}=e,y=Object(d.a)(),O=Object(p.a)()(y),[S,C]=Object(a.useState)(null!==(t=i.deepReasoningSteps)&&void 0!==t?t:[]),I=Object(a.useRef)(!1);return Object(a.useEffect)(()=>{(function(){var e,t=(e=function*(){if(!I.current&&!i.deepReasoningSteps){I.current=!0;var e,{stream:t,connectionReferences:n,onSuccess:o,onError:r}=i;try{e=yield Object(u.d)(t,i.textDecoderImpl,e=>{if(e.reasoningTitle&&e.reasoningText){var t={id:Object(c.a)(),reasoningTitle:e.reasoningTitle,reasoningText:e.reasoningText,isComplete:!1};C(e=>(e.length>0&&(e[e.length-1].isComplete=!0),[...e,t]))}i.onAddMessage&&i.onAddMessage(e)},n,f)}catch(a){r(a)}C(t=>{t.length>0&&(t[t.length-1].isComplete=!0);var n=[...t];return o({response:e,steps:n}),n})}},function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){b(r,i,o,a,s,"next",e)}function s(e){b(r,i,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}})()()},[i,f,S]),s.a.createElement("div",{"data-automation-id":o.a.deepReasoningMessageCard,className:O.root},(w||S.length>0)&&s.a.createElement("div",{className:O.headerSection},null==h?void 0:h()),w&&s.a.createElement("div",{className:O.typingSection},s.a.createElement(g.a,null)),S.length>0&&s.a.createElement("div",{className:O.contentSection},S.some(e=>!1===e.isComplete)&&s.a.createElement("span",{className:O.workingText},null==v||null===(n=v.Nl2AISteps)||void 0===n||null===(n=n.CopilotChat)||void 0===n?void 0:n.Working),s.a.createElement(r.a,{mode:"sidecar"},S.map(e=>s.a.createElement(l.a,m({key:e.id},e))))))})},34616:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(11766),o=n.n(i),r=n(13680),a=n(14035),s=n(13875),l=n(34617),c=e=>{var{reasoningTitle:t,reasoningText:n,isComplete:i}=e,c=Object(l.a)();return o.a.createElement("div",{className:c.stepContainer},o.a.createElement("div",{className:c.columnContainer},o.a.createElement("div",{className:c.iconContainer},i?o.a.createElement(s.m,{primaryFill:r.a.colorPaletteGreenForeground1}):o.a.createElement(a.a,{size:"tiny"})),i&&o.a.createElement("div",{className:c.verticalLine})),o.a.createElement("div",{className:c.textContainer},o.a.createElement("div",{className:c.title},t),o.a.createElement("div",{className:c.text},n)))}},34617:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(13859),o=n(13680),r=Object(i.a)({stepContainer:{display:"flex",flexDirection:"row",gap:o.a.spacingHorizontalM,alignItems:"stretch",":not(:last-child)":{paddingBottom:o.a.spacingVerticalM}},columnContainer:{display:"flex",alignItems:"center",flexDirection:"column"},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:"20px",height:"20px"},verticalLine:{width:"2px",height:"100%",backgroundColor:o.a.colorNeutralStroke3,marginTop:o.a.spacingVerticalXXS},textContainer:{display:"flex",flexDirection:"column"},title:{fontWeight:o.a.fontWeightSemibold,fontSize:o.a.fontSizeBase300},text:{fontSize:o.a.fontSizeBase200,color:o.a.colorNeutralForeground3}})},34618:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=()=>({root:["fl-deep-reasoning-message-root",{display:"flex",flexDirection:"column",alignItems:"stretch"}],headerSection:["fl-deep-reasoning-header-section",{display:"block"}],typingSection:["fl-deep-reasoning-typing-section",{display:"block"}],contentSection:["fl-deep-reasoning-content-section",{display:"block"}],workingText:["fl-deep-reasoning-working-text",{color:"#A6A4A4",fontSize:"14px",fontWeight:400,lineHeight:"13.5px",display:"block",marginBottom:"8px"}]})},34619:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(11766),o=n.n(i),r=n(13859),a=n(13680),s=n(13574),l=n(18849),c=Object(r.a)({typingIndicator:{alignSelf:"start",display:"flex",flex:"none",height:a.a.spacingVerticalL,margin:"auto ".concat(a.a.spacingHorizontalMNudge)},typingIndicatorAnimation:{height:a.a.spacingVerticalSNudge,width:"auto"}}),u=Object(i.memo)(e=>{var{className:t}=e,n=c(),{clientResources:i}=Object(l.b)();return o.a.createElement("div",{className:Object(s.a)(n.typingIndicator,t),"data-testid":"typing-indicator-container"},o.a.createElement("img",{alt:i.Nl2AISteps.TypingIndicator,className:n.typingIndicatorAnimation,src:"".concat("data:image/svg+xml;base64,").concat("PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCA0MDAgMjAiPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9IjAiIHgyPSIxMDAlIiB5MT0iMCIgeTI9IjAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAlIj48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJzdG9wLWNvbG9yIiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iI2FkNWFlMTsjYWQ1YWUxOyMwRTk0RTE7IzBFOTRFMTsjNjY5ZmMyOyM2NjlmYzI7I2FkNWFlMSIvPjwvc3RvcD48c3RvcCBvZmZzZXQ9IjUwJSI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ic3RvcC1jb2xvciIgZHVyPSIycyIga2V5VGltZXM9IjA7MC4yOzAuMzM7MC41OzAuNjY7MC44OzEiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiB2YWx1ZXM9IiNlOTYxOGQ7I2U5NjE4ZDsjNTdBQjgyOyM1N0FCODI7IzYzNzdlMDsjNjM3N2UwOyNlOTYxOGQiLz48L3N0b3A+PHN0b3Agb2Zmc2V0PSIxMDAlIj48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJzdG9wLWNvbG9yIiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iI2ZkOWU1ZjsjZmQ5ZTVmOyNDNkMyMjU7I0M2QzIyNTsjOWI4MGVjOyM5YjgwZWM7I2ZkOWU1ZiIvPjwvc3RvcD48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48ZyBmaWxsPSJ1cmwoI2EpIj48cmVjdCBoZWlnaHQ9IjIwIiByeD0iMTAiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IngiIGR1cj0iMnMiIGtleVRpbWVzPSIwOzAuNTswLjY2OzEiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiB2YWx1ZXM9IjI2OzI2OzA7MCIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IndpZHRoIiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIyMDsyMDszMDszMDsyMDsyMCIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIGR1cj0iMnMiIGtleVRpbWVzPSIwOzAuNTswLjY2OzEiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiB2YWx1ZXM9IjE7MTswOzAiLz48L3JlY3Q+PHJlY3QgaGVpZ2h0PSIyMCIgcng9IjEwIj48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJ4IiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iNjI7NjI7NzI7NzI7MjY7MjY7MCIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IndpZHRoIiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iMTA0OzEwNDsyMDsyMDs3MDs3MDsyMCIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIGR1cj0iMnMiIGtleVRpbWVzPSIwOzAuODsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIxOzE7MCIvPjwvcmVjdD48cmVjdCBoZWlnaHQ9IjIwIiByeD0iMTAiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IngiIGR1cj0iMnMiIGtleVRpbWVzPSIwOzAuMjswLjMzOzAuNTswLjY2OzAuODsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIxODI7MTgyOzEwODsxMDg7MTEyOzExMjsyNiIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IndpZHRoIiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIyMDsyMDs2MDs2MDsyMDsyMCIvPjwvcmVjdD48cmVjdCBoZWlnaHQ9IjIwIiByeD0iMTAiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IngiIGR1cj0iMnMiIGtleVRpbWVzPSIwOzAuMjswLjMzOzAuNTswLjY2OzAuODsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIyMTg7MjE4OzE4NDsxODQ7MTQ4OzE0ODs2MiIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IndpZHRoIiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iNjA7NjA7ODA7ODA7NDA7NDA7MTA0Ii8+PC9yZWN0PjxyZWN0IGhlaWdodD0iMjAiIHJ4PSIxMCI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ieCIgZHVyPSIycyIga2V5VGltZXM9IjA7MC4yOzAuMzM7MC41OzAuNjY7MC44OzEiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiB2YWx1ZXM9IjI5NDsyOTQ7MjgwOzI4MDsyMDQ7MjA0OzE4MiIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IndpZHRoIiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iNDA7NDA7MjA7MjA7ODA7ODA7MjAiLz48L3JlY3Q+PHJlY3QgaGVpZ2h0PSIyMCIgcng9IjEwIj48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJ4IiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iMzUwOzM1MDszMTY7MzE2OzMwMDszMDA7MjE4Ii8+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0id2lkdGgiIGR1cj0iMnMiIGtleVRpbWVzPSIwOzAuMjswLjMzOzAuNTswLjY2OzAuODsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIyMDsyMDs2MDs2MDsyMDsyMDs2MCIvPjwvcmVjdD48cmVjdCBoZWlnaHQ9IjIwIiByeD0iMTAiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9IngiIGR1cj0iMnMiIGtleVRpbWVzPSIwOzAuMjswLjMzOzAuNTswLjY2OzAuODsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIzODY7Mzg2OzM5MjszOTI7MzM2OzMzNjsyOTQiLz48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJ3aWR0aCIgZHVyPSIycyIga2V5VGltZXM9IjA7MC41OzAuNjY7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iMjA7MjA7NDA7NDAiLz48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjU7MC42NjsxIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdmFsdWVzPSIwOzA7MTsxIi8+PC9yZWN0PjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgcng9IjEwIj48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJ4IiBkdXI9IjJzIiBrZXlUaW1lcz0iMDswLjI7MC4zMzswLjU7MC42NjswLjg7MSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIHZhbHVlcz0iNDIyOzQyMjs0Mjg7NDI4OzM5MjszOTI7MzUwIi8+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgZHVyPSIycyIga2V5VGltZXM9IjA7MC44OzEiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiB2YWx1ZXM9IjA7MDsxIi8+PC9yZWN0PjwvZz48L3N2Zz4=")}))});u.displayName="TypingIndicator"},34657:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n(11766),o=n.n(i),r=n(14337),a=n(18822),s=n(34586),l=n(20850),c=n(20073),u=n(12816),d=n(12754),p=n(15918),g=n(22675),m=n(13272),b=n(24351),f=Object(r.c)(e=>{var{item:t,resources:n,store:i}=e,{assetService:r,cdnService:u}=i,d=Object(p.a)();if(0===t.operationsNeedingAttention.length)return o.a.createElement(h,{resources:n});var m=Object(g.b)(t.userAction===a.c.saving?n.OperationsNeedingAttentionMessage.SavingDescription_plural:n.OperationsNeedingAttentionMessage.EditingDescription_plural,t.operationsNeedingAttention.length),f=t.operationsNeedingAttention.map(e=>{var t=!i.currentFlowContainsOperation(e.operationName),n=!i.operationsWithValidationErrors.includes(e.operationName);return{info:e,isComplete:n,disabled:t,statusIcon:t?S:n?O:y,onClick:()=>i.selectOperationInDesigner(e.operationName,{scenario:s.b.InvalidParameters})}});return f.every(e=>e.disabled||e.isComplete)&&i.onAllOperationsNeedingAttentionFixed(t),o.a.createElement("div",{"data-automation-id":b.a.operationsNeedingAttentionMessage},o.a.createElement(l.a,{key:t.id,isUserMessage:!1,isAIGenerated:!0,date:t.date,selectedReaction:t.reaction,resources:n},o.a.createElement("div",{className:w.description},m),o.a.createElement(c.c,{operations:f,connectionReferences:t.connectionReferences,assetService:r,cdnService:u,flowServiceClientResources:d,className:w.operationList})))}),h=e=>{var{resources:t}=e;return o.a.createElement("div",{className:v.root},o.a.createElement("span",{className:v.status},o.a.createElement(u.a,{iconName:"Completed",className:v.icon}),o.a.createElement("span",{className:v.text},t.OperationsNeedingAttentionMessage.AllRequiredParametersWereSetMessage)))},v=Object(d.db)({root:{display:"flex",flexDirection:"column",rowGap:"16px",paddingLeft:8,paddingTop:4},status:{display:"flex",alignItems:"center"},text:{display:"flex",whiteSpace:"pre-wrap",flexWrap:"wrap"},icon:{paddingRight:8,color:"green"}}),w=Object(d.db)({description:{marginBottom:8},operationList:{width:"100%",listStyle:"none",padding:0},needAttentionIcon:{color:Object(d.Y)().semanticColors.errorIcon},noAttentionIcon:{color:Object(d.Y)().semanticColors.successIcon},disabledIcon:{color:Object(d.Y)().semanticColors.inputIconDisabled}}),y={iconName:m.a.Error2,className:w.needAttentionIcon},O={iconName:m.a.Connected,className:w.noAttentionIcon},S={iconName:m.a.Connected,className:w.disabledIcon}},34658:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(11766),o=n.n(i),r=n(24351),a=n(20008),s=n(18816),l=n(23043),c=e=>{var{item:t,resources:n,onDismiss:i,getUserContext:c}=e,u=void 0!==t,d=(null==t?void 0:t.reaction)===s.c.thumbsDown||(null==t?void 0:t.reaction)===s.c.thumbsUp?l.b:null;return d?o.a.createElement(a.a,{dataAutomationId:r.a.feedbackPanelRoot,isOpen:u,onDismiss:i,surveyId:d,getUserContext:c,title:n.FeedbackCard.PanelTitle,closeButtonAriaLabel:n.Close}):null}},34659:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(11766),o=n.n(i),r=n(12999),a=n(14906),s=o.a.lazy(()=>n.e(144).then(n.bind(null,20855))),l=e=>Object(a.a)()&&Object(r.a)().isDebugCopilotEnabled?o.a.createElement(i.Suspense,{fallback:null},o.a.createElement(s,e)):null},34660:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(11766),o=n(22979),r=n(19714),a=n(19716),s=()=>{var e=Object(a.b)(),{chatResources:t,designerHostContextStore:{setMessageBarProps:n}}=e,{complete:s,isSkipAvailable:l}=Object(r.c)();Object(i.useEffect)(()=>{n(o.c.Chatbot,void 0)},[t.ConnectionsSetupCard,s,l,n])}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/109.e9d05c10.chunk.js.map