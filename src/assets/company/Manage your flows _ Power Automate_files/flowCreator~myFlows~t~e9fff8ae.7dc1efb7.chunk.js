/*! For license information please see flowCreator~myFlows~t~e9fff8ae.7dc1efb7.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[203],{22913:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var o,n,i=r(11766),a=r(14337),c=r(18950),s=r(21029),l=r(12706),p=r(12811),u=r(12728),f=r(11773),v=r(11804),d=r(22911),S=r(20381),m=r(22895),g=r(12328),C=r.n(g),w=r(13240),y=r(22889),b=r(20845),h=r(20813),O=r(22914),P=r(20822),k=r(13016);function F(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,N(o.key),o)}}function R(e,t){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,o=B(e);if(t){var n=B(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return D(this,r)}}function D(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,r,o,n){var i={};return Object.keys(o).forEach((function(e){i[e]=o[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(e,t,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){V(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e,t,r){return(t=N(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var L={[P.a.AwaitingConsent]:null,[P.a.Consenting]:y.a,[P.a.ReviewingConnections]:h.a,[P.a.LoadingDietDesigner]:h.a,[P.a.FlowInputs]:h.a,[P.a.CreatingFlow]:h.a,[P.a.Loading]:y.a,[P.a.PreparingToClose]:b.a,[P.a.CreationCompleted]:b.a},U=Object(a.c)((x((n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(a,e);var t,r,o,n=j(a);function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.call(this,e)).flowCreatorV2Store=void 0,t.getClassNames=Object(l.a)(),t.onRenderFooterContent=()=>{var{surfaceType:e}=t.props,r={appSettings:t.props.appSettings,assetService:t.props.assetService,callbackUrlService:t.props.callbackUrlService,cdnService:t.props.cdnService,clientResources:t.props.clientResources,consentService:t.props.consentService,designerCreateContext:t.props.designerCreateContext,featureFlags:t.props.featureFlags,flowCreatorStore:t.flowCreatorV2Store,graphService:t.props.graphService,loadDesignerScripts:t.props.loadDesignerScripts,loggingService:t.props.loggingService,oAuthService:t.props.oAuthService,ppapiService:t.props.ppapiService,routeCrafter:t.props.routeCrafter,sessionStore:t.props.sessionStore,surfaceType:e,teamsDeepLinkService:t.props.teamsDeepLinkService,telemetryService:t.props.telemetryService,userDetailsStore:t.props.userDetailsStore,widgetUtilService:t.props.widgetUtilService,xrmConnectionReferenceStore:t.props.xrmConnectionReferenceStore,xrmConnectionReferenceService:t.props.xrmConnectionReferenceService,dynamicListStore:t.props.dynamicListStore};return i.createElement(O.a,r)},t.onRenderPrimarySection=()=>{var e={appSettings:t.props.appSettings,assetService:t.props.assetService,cdnService:t.props.cdnService,callbackUrlService:t.props.callbackUrlService,clientResources:t.props.clientResources,designerCreateContext:t.props.designerCreateContext,featureFlags:t.props.featureFlags,flowCreatorStore:t.flowCreatorV2Store,graphService:t.props.graphService,loadDesignerScripts:t.props.loadDesignerScripts,loggingService:t.props.loggingService,oAuthService:t.props.oAuthService,ppapiService:t.props.ppapiService,routeCrafter:t.props.routeCrafter,teamsDeepLinkService:t.props.teamsDeepLinkService,telemetryService:t.props.telemetryService,widgetUtilService:t.props.widgetUtilService,xrmConnectionReferenceStore:t.props.xrmConnectionReferenceStore,xrmConnectionReferenceService:t.props.xrmConnectionReferenceService,dynamicListStore:t.props.dynamicListStore},r=L[t.flowCreatorV2Store.formState];return r&&i.createElement(r,e)},t.onRenderSecondarySection=()=>{var e={appSettings:t.props.appSettings,assetService:t.props.assetService,callbackUrlService:t.props.callbackUrlService,cdnService:t.props.cdnService,clientResources:t.props.clientResources,designerCreateContext:t.props.designerCreateContext,featureFlags:t.props.featureFlags,flowCreatorStore:t.flowCreatorV2Store,graphService:t.props.graphService,loadDesignerScripts:t.props.loadDesignerScripts,loggingService:t.props.loggingService,oAuthService:t.props.oAuthService,ppapiService:t.props.ppapiService,teamsDeepLinkService:t.props.teamsDeepLinkService,telemetryService:t.props.telemetryService,routeCrafter:t.props.routeCrafter,surfaceType:t.props.surfaceType,widgetUtilService:t.props.widgetUtilService,xrmConnectionReferenceStore:t.props.xrmConnectionReferenceStore,xrmConnectionReferenceService:t.props.xrmConnectionReferenceService,dynamicListStore:t.props.dynamicListStore};return t.flowCreatorV2Store.formState===P.a.CreationCompleted||t.flowCreatorV2Store.formState===P.a.PreparingToClose?null:i.createElement(m.a,e)};var{designTimeParameters:r,flowCreationMode:o,installFlowAfterCreation:c,onCreateFlowCompletion:s,onCreateFlowError:p,onContentFirstRendered:u,solutionId:f,surfaceType:v,templateDefinition:d,telemetryService:g,templateName:y}=t.props,b={flowCreationMode:o,templateName:y,hasInlineTemplateDefinition:!!d,surfaceType:v};return t.flowCreatorV2Store=new P.b(E({loadConnectionWizardDesignerStylesManually:!0},t.props)),g.tagEvent(w.c.FlowCreatorV2SurfaceOpened,b),o===S.a.fromTemplateName?(C()(!!y,"Must initialize FlowCreationSurface with templateName if creation mode is fromTemplateName"),y&&t.flowCreatorV2Store.initializeFromTemplateName({templateName:y,designTimeParameters:r,installFlowAfterCreation:c,onCreateFlowCompletion:s,onCreateFlowError:p,solutionId:f}).then(()=>{g.tagEvent(w.c.FlowCreatorV2SurfaceInitializedFromTemplateName,b),u&&u()})):o===S.a.fromTemplateDefinition&&(C()(!!d,"Must initialize FlowCreationSurface with templateDefinition if creation mode is fromTemplateDefintion"),d&&t.flowCreatorV2Store.initializeFromTemplateDefinition({templateDefinition:d,designTimeParameters:r,installFlowAfterCreation:c,onCreateFlowCompletion:s,onCreateFlowError:p,solutionId:f}).then(()=>{g.tagEvent(w.c.FlowCreatorV2SurfaceInitializedFromTemplateDefinition,b),u&&u()})),t}return t=a,(r=[{key:"render",value:function(){var{clientResources:e,dismiss:t,featureFlags:r,hasCloseButton:o,horizontalSplitPercentage:n=60,onClose:a,surfaceKey:c,surfaceStore:l,surfaceType:p,widgetUtilService:u}=this.props,f=u.isWidgetPage()&&u.isTeamsContext()&&r.enableFlowCreationV2InTeams;return i.createElement(s.a,{className:this.getSurfaceViewClassName,clientResources:e,dismiss:t,hasCloseButton:o,horizontalSplitPercentage:n,onClosed:a,onRenderFooterContent:this.onRenderFooterContent,onRenderPrimarySection:this.onRenderPrimarySection,onRenderSecondarySection:this.onRenderSecondarySection,surfaceKey:c,surfaceStore:l,surfaceType:p,title:this.panelTitle,padContent:!0,textMessageBarProps:this.textMessageBarProps,forceModalVerticalLayout:f})}},{key:"panelTitle",get:function(){var{clientResources:e,widgetUtilService:t,surfaceTitle:r}=this.props;if(t.isWidgetPage()){var o;if(null!==(o=t.widgetOptions)&&void 0!==o&&o.hideFlowCreationHeader)return;if(t.widgetStrings&&t.widgetStrings[v.b.FLOW_CREATION_HEADER])return t.widgetStrings[v.b.FLOW_CREATION_HEADER]}return r||e.Widget.FlowCreation.Header}},{key:"getSurfaceViewClassName",get:function(){var{widgetUtilService:e,featureFlags:t}=this.props;return Object(p.a)({[this.getClassNames(d.a,this.props).flowCreatorSurfaceV2]:!0,[this.getClassNames(d.a,this.props).excelSdxFlowCreatorSurface]:e.isExcelSDXContext(),[S.b]:!0,[this.getClassNames(d.a).flowCreationV2InTeamsCreatorSurface]:e.isWidgetPage()&&e.isTeamsContext()&&t.enableFlowCreationV2InTeams})}},{key:"textMessageBarProps",get:function(){var e=this.flowCreatorV2Store.errorMessage;if(e)return{ariaLabel:e,type:k.c.error,message:e,styles:{root:{overflow:"auto",whiteSpace:"pre-wrap"}}}}}])&&F(t.prototype,r),o&&F(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.Component)).prototype,"panelTitle",[f.computed],Object.getOwnPropertyDescriptor(n.prototype,"panelTitle"),n.prototype),x(n.prototype,"getSurfaceViewClassName",[f.computed],Object.getOwnPropertyDescriptor(n.prototype,"getSurfaceViewClassName"),n.prototype),x(n.prototype,"textMessageBarProps",[f.computed],Object.getOwnPropertyDescriptor(n.prototype,"textMessageBarProps"),n.prototype),o=n))||o,W=Object(c.b)((e,t)=>E({appSettings:e.appSettings,assetService:e.assetService,businessAppPlatformService:e.businessAppPlatformService,callbackUrlService:e.callbackUrlService,cdnService:e.cdnService,clientResources:e.clientResources,connectionService:e.connectionService,connectionStore:e.connectionStore,consentService:e.consentService,designerCreateContext:e.designerCreateContext,entitlementsService:e.entitlementsService,environmentService:e.environmentService,environmentCapabilityService:e.environmentCapabilityService,environmentStore:e.environmentStore,featureFlags:e.featureFlags,flowService:e.flowService,flowStore:e.flowStore,graphService:e.graphService,loggingService:e.loggingService,oAuthService:e.oAuthService,ppapiService:e.ppapiService,routeCrafter:e.routeCrafter,scenarioLoggingService:e.scenarioLoggingService,sessionStore:e.sessionStore,surfaceStore:e.surfaceStore,teamsDeepLinkService:e.teamsDeepLinkService,telemetryService:e.telemetryService,templateService:e.templateService,templateStore:e.templateStore,userDetailsStore:e.userDetailsStore,widgetUtilService:e.widgetUtilService,xrmConnectionReferenceStore:e.xrmConnectionReferenceStore,xrmConnectionReferenceService:e.xrmConnectionReferenceService,dynamicListStore:e.dynamicListStore},t))(U);function A(e){var{surfaceStore:t,flowCreatorV2Props:r}=e;return t.spawn({key:Object(u.a)("flow-creator-surface-v2"),render:e=>i.createElement(W,E(E({},e),r))})}},22914:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var o,n,i=r(11766),a=r(14337),c=r(11773),s=r(17442),l=r(13152),p=r(20353),u=r(13272),f=r(13240),v=r(14972),d=r(12706),S=r(22915),m=r(20822),g=r(12999),C=r(22910);function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,h(o.key),o)}}function h(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,o=F(e);if(t){var n=F(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return k(this,r)}}function k(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,r,o,n){var i={};return Object.keys(o).forEach((function(e){i[e]=o[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,o){return o(e,t,r)||r}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var j=Object(a.c)((R((n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(a,e);var t,r,o,n=P(a);function a(){var e;y(this,a);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=n.call(this,...r)).getClassNames=Object(d.a)(),e.renderConsent=()=>{var{appSettings:t,consentService:r,clientResources:o,sessionStore:n,userDetailsStore:a,telemetryService:c}=e.props,l=e.getClassNames(S.a,e.props);return i.createElement("div",{className:l.consentContainer},i.createElement(s.a,{telemetryService:c,appSettings:t,consentServiceResources:o,consentService:r,consentOnActionName:o.UserConsent.Continue,sessionStore:n,userDetailsStore:a}))},e.renderDietViewBackButton=()=>{var{clientResources:t,flowCreatorStore:{formState:r,handleDietViewBackButtonClicked:o}}=e.props;return i.createElement("div",null,i.createElement(p.a,{text:t.Common.Back,onClick:o,telemetryData:{name:f.c.FlowCreatorDietViewBackButtonClicked},iconName:u.a.ChevronLeft,disabled:r===m.a.CreatingFlow}))},e.renderTemplateWidgetBackButton=()=>{var{clientResources:t,flowCreatorStore:{handleClose:r}}=e.props;return i.createElement("div",null,i.createElement(p.a,{text:t.Common.Back,onClick:r,telemetryData:{name:f.c.FlowCreatorDietViewTemplateWidgetBackButtonClicked},iconName:u.a.ChevronLeft}))},e.renderButtonGroup=()=>{var{flowCreatorStore:{footerButtons:t}}=e.props;return i.createElement("div",null,i.createElement(v.a,{buttons:t,isRightAligned:e.isModal}))},e.renderFooterButtons=()=>{var t,{widgetUtilService:r}=e.props,o=r.isWidgetPage()&&r.isTeamsContext()&&Object(g.a)().enableFlowCreationV2InTeams;o||(t=e.isModal?e.renderDietViewBackButton():e.shouldRenderTemplateWidgetBackButton?e.renderTemplateWidgetBackButton():null),t=e.shouldRenderViewWorkflowButton?e.renderViewWorkflowButton():null;var n=o?e.getClassNames(S.a):void 0;return i.createElement("div",{className:null==n?void 0:n.footerContainer},t&&i.createElement("div",{className:null==n?void 0:n.leftButtonGroupContainer},t),i.createElement("div",{className:null==n?void 0:n.buttonGroupContainer},e.renderButtonGroup()))},e.renderViewWorkflowButton=()=>{var{clientResources:t}=e.props,r=e.getClassNames(S.a,e.props);return i.createElement("div",{className:r.workflowButtonContainer},i.createElement("div",{className:r.workflowButtonDescription},t.FlowCreatorCreationCompleted.Success.WorkflowRedirectPrompt),i.createElement(C.a,w({className:r.workflowButton},e.props)))},e}return t=a,(r=[{key:"render",value:function(){var e=this.getClassNames(S.a,this.props);return i.createElement("div",{className:e.root},this.shouldRenderConsent?this.renderConsent():null,this.renderFooterButtons())}},{key:"shouldRenderConsent",get:function(){var{flowCreatorStore:{formState:e}}=this.props;return e===m.a.AwaitingConsent||e===m.a.Consenting}},{key:"isModal",get:function(){var{surfaceType:e}=this.props;return e===l.a.Modal||e===l.a.FullPageModal}},{key:"isFullPagePanel",get:function(){var{surfaceType:e}=this.props;return e===l.a.FullPagePanel}},{key:"shouldRenderTemplateWidgetBackButton",get:function(){var{widgetUtilService:e}=this.props;return this.isModal&&e.isWidgetPage()&&e.shouldShowGoBack()}},{key:"shouldRenderViewWorkflowButton",get:function(){var{flowCreatorStore:e,widgetUtilService:t}=this.props;return(this.isModal||t.isTeamsContext()&&this.isFullPagePanel)&&e.formState===m.a.CreationCompleted&&!t.isExcelSDXContext()}}])&&b(t.prototype,r),o&&b(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.Component)).prototype,"shouldRenderConsent",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"shouldRenderConsent"),n.prototype),R(n.prototype,"isModal",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"isModal"),n.prototype),R(n.prototype,"isFullPagePanel",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"isFullPagePanel"),n.prototype),R(n.prototype,"shouldRenderTemplateWidgetBackButton",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"shouldRenderTemplateWidgetBackButton"),n.prototype),R(n.prototype,"shouldRenderViewWorkflowButton",[c.computed],Object.getOwnPropertyDescriptor(n.prototype,"shouldRenderViewWorkflowButton"),n.prototype),o=n))||o},22915:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(12754),n=()=>({root:["fl-FlowCreatorV2Footer",{width:"100%"}],consentContainer:["fl-FlowCreatorV2Footer-consentContainer",{paddingBottom:16}],buttonGroupContainer:["fl-FlowCreatorV2Footer-buttonGroupContainer",{display:"flex",justifyContent:"flex-end",marginLeft:"auto",marginRight:0}],footerContainer:["fl-FlowCreatorV2Footer-footerContainer",{display:"flex"}],leftButtonGroupContainer:["fl-FlowCreatorV2Footer-leftButtonGroupContainer",{flexGrow:1}],workflowButtonContainer:["fl-FlowCreatorFooter-workflowButtonContainer",{display:"flex",selectors:{".ms-Link":{color:Object(o.Y)().palette.blue,textDecoration:"underline"}}}],workflowButtonDescription:["fl-FlowCreatorFooter-workflowButtonDescription",{display:"flex",flexDirection:"column",justifyContent:"center",paddingRight:"4px"}],workflowButton:["f1-FlowCreatorFooter-workflowButton",{display:"flex",flexDirection:"column",justifyContent:"center"}]})}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/flowCreator~myFlows~t~e9fff8ae.7dc1efb7.chunk.js.map