/*! For license information please see 182.a67ff9c6.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[182],{20910:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(13209),o=r.n(n),i=r(12366);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.environmentStore=t,this.store=void 0;var r=i.p.designerUserPreferenceStorageInstanceName;this.store=o.a.createInstance({description:"Local storage for ".concat(r),name:r,storeName:r,version:1})}var t,r,n;return t=e,(r=[{key:"createDesignerUserPreferenceService",value:function(){return{getMostRecentlyUsedConnectionId:e=>this.getMostRecentlyUsedConnection(e),setMostRecentlyUsedConnectionId:(e,t)=>this.setMostRecentlyUsedConnectionId(e,t)}}},{key:"getMostRecentlyUsedConnection",value:function(e){return this.store.getItem(this.getConnectionCacheKey(e))}},{key:"setMostRecentlyUsedConnectionId",value:function(e,t){return this.store.setItem(this.getConnectionCacheKey(e),t)}},{key:"getConnectionCacheKey",value:function(e){return this.environmentStore.currentEnvironmentName+e}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},20924:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,o=r(20925),i=r(20884),a=!1,s=()=>(a||(n=new o.a(Object(i.a)()),a=!0),n)},20925:function(e,t,r){"use strict";function n(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}r.d(t,"a",(function(){return s}));var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.apisHttpClient=t}var t,r,n,a,s;return t=e,(r=[{key:"getApiOperations",value:(s=o((function*(e){return(yield this.apisHttpClient.getApiOperations(e)).data.value})),function(e){return s.apply(this,arguments)})},{key:"getApiOperation",value:(a=o((function*(e,t,r){return(yield this.apisHttpClient.getApiOperation(e,t,{expandConnector:r})).data})),function(e,t,r){return a.apply(this,arguments)})}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22325:function(e,t,r){"use strict";r.r(t),r.d(t,"PowerAutomateAngularReactHost",(function(){return xe})),r.d(t,"PowerAutomateAngularReactHostWithResources",(function(){return Me}));var n=r(11766),o=(r(18837),r(22326)),i=r(13087),a=r(13077),s=r(15490),c=r(13148),u=r(16924),l=r(21859),p=r(14378),f=r(13081),d=r(13231),v=r(13230),h=r(17185),m=r(17188),y=r(14648),b=r(13078),S=r(13090),g=r(20924),O=r(20893),w=r(20910),P=r(12345),j=r(17761),C=r(15417),E=r(20937),R=r(17213),k=r(20953),N=r(17448),I=r(20978),T=r(20988),D=r(21021),U=r(20934),L=r(12999),x=r(22329),F=r(15460),M=r(22200),_=r(20901),z=r(15463),A=r(17279),H=r(22330),B=r(22334),V=r(22336),q=r(15493),W=r(22071),J=r(20943),K=r(22355),X=r(17869),G=r(20964),$=r(17281),Q=r(15339),Y=r(18814),Z=r(21069),ee=r(15383),te=r(15474),re=r(22357),ne=r(12236),oe=r(22361),ie=r(20968),ae=r(21010),se=r(17374),ce=r(20949),ue=r(20918),le=r(21017),pe=r(21020),fe=r(20915),de=r(14688),ve=r(20985),he=r(20922),me=r(21877),ye=r(17169),be=r(15332),Se=r(22363),ge=r(17901),Oe=r(17899),we=r(17278),Pe=r(17907),je=r(17377),Ce=r(17903),Ee=r(20984);function Re(){return(Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ie(n.key),n)}}function Ie(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Te(e,t){return(Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function De(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=Le(e);if(t){var o=Le(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ue(this,r)}}function Ue(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Te(e,t)}(ne,e);var t,r,o,v=De(ne);function ne(){return ke(this,ne),v.apply(this,arguments)}return t=ne,(r=[{key:"render",value:function(){return n.createElement(Fe,{assetService:p.a,hostCommunicationService:f.a,loggingService:i.a,telemetryService:d.a,tokenService:a.a,navigationService:s.a,policyService:u.a,markdownService:l.a,flowServiceClientResources:this.props.flowServiceClientResources,widgetUtilService:c.a,routeCrafter:h.a,universalSearchService:m.a,cdnService:y.a,storageService:new b.a,analyticsService:S.a,apiOperationService:Object(g.a)(),codeSnippetService:U.a,designerCoreLoaderFn:Z.a,designerDocumentationLinkService:new x.a(Object(L.a)(),this.props.flowServiceClientResources),designerOperationsService:O.a,designerUserPreferenceFactory:new w.a(P.a),doNotShowAgainService:j.a,environmentCapabilityService:C.a,flowRoleService:M.a,flowRunInputsOutputsService:E.a,flowService:R.a,flowRunsService:J.a,gatewayService:k.a,graphService:N.a,rpaLocalService:I.a,uiFlowService:T.a,uiFlowRunService:ve.a,uiFlowRunStore:he.a,xrmEntityHttpClient:F.b,xrmMachineManagementService:D.a,triggerService:_.a,xrmWorkflowClient:z.a,flowDraftClient:A.a,presenceService:H.a,presenceStore:B.a,flowUndoService:V.a,planService:q.a,xrmUserService:W.a,xrmConnectionReferenceService:le.a,xrmConnectionReferenceStore:pe.a,designerConnectionStore:fe.a,xrmRecommendation:K.a,connectionService:X.a,licenseManagementService:G.a,userDetailsStore:be.a,consentService:ye.a,flowRoleStore:$.a,planStore:Q.a,environmentService:te.a,businessAppPlatformService:ee.a,oAuthService:ie.a,aiHostedModelsService:Y.a,solutionService:re.a,flowRunHistoryService:oe.a,winAutomationService:ae.a,neptuneService:se.a,flowRunsTriggerOutputsStore:ce.a,desktopFlowStore:ue.a,ppapiService:de.a,flowSupportChecker:Se.a,gptService:me.a,desktopFlowAIHttpClient:ge.a,flowHttpClient:we.a,flowRpHttpClient:Pe.a,neptuneHttpClient:je.a,teamsDeepLinkService:Ee.a,desktopFlowRuntimeHttpClient:Ce.a,azureResourceGraphHttpClient:Oe.a})}}])&&Ne(t.prototype,r),o&&Ne(t,o),Object.defineProperty(t,"prototype",{writable:!1}),ne}(n.Component);function Fe(e){var t=Object(ne.j)();return n.createElement(o.a,Re({},e,{location:t.pathname}))}var Me=Object(v.c)(xe)},22326:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(11766),o=r(22327),i=r(22328);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var t,r,c,p=l(f);function f(){return a(this,f),p.apply(this,arguments)}return t=f,(r=[{key:"componentDidMount",value:function(){Object(o.b)()}},{key:"render",value:function(){return n.createElement(i.a,this.props)}}])&&s(t.prototype,r),c&&s(t,c),Object.defineProperty(t,"prototype",{writable:!1}),f}(n.Component)},22327:function(e,t,r){"use strict";var n;r.d(t,"d",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return u}));var o,i=new Promise((e,t)=>{n=e});new Promise((e,t)=>{o=e});function a(){return i}function s(){n()}function c(){o()}function u(){new Promise((e,t)=>{o=e})}},22328:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(11776),o=r(22327),i=Object(n.a)(()=>Object(o.d)().then(()=>Promise.all([r.e(134),r.e(10),r.e(137),r.e(119),r.e(104),r.e(37),r.e(138),r.e(20),r.e(83),r.e(233),r.e(208),r.e(128),r.e(273),r.e(93),r.e(135),r.e(136),r.e(30),r.e(130),r.e(139),r.e(131),r.e(111),r.e(122),r.e(141),r.e(34),r.e(106),r.e(91),r.e(163),r.e(142),r.e(129),r.e(200),r.e(234),r.e(202),r.e(176),r.e(201),r.e(199),r.e(250),r.e(197),r.e(80),r.e(251),r.e(253),r.e(116),r.e(19)]).then(r.bind(null,33278))))},22329:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(12375),o=r(14875),i=r(13031);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureFlags=t,this.clientResources=r}var t,r,s;return t=e,(r=[{key:"getDocumentationLink",value:function(e){var t=Object(o.e)(e);if(t&&-1!==t.indexOf("shared_")){var r=t.substring("shared_".length);return{description:this.clientResources.Common.LearnMore,url:Object(i.a)("https://docs.microsoft.com/{0}/connectors/{1}/",Object(n.a)(),r)}}return null}},{key:"getDocumentationLinkForConnector",value:function(e){var t=Object(o.e)(e);if(t&&-1!==t.indexOf("shared_")){var r=t.substring("shared_".length);return{description:this.clientResources.Common.LearnMore,url:Object(i.a)("https://docs.microsoft.com/{0}/connectors/{1}/",Object(n.a)(),r)}}return null}},{key:"getDocumentationLinkForOperation",value:function(e,t){var r=this.featureFlags.useOperationsV2InDesigner?Object(o.c)(e):Object(o.e)(e);if(r&&-1!==r.indexOf("shared_")&&t){var a=r.substring("shared_".length),s="qps-ploc"===Object(n.a)()?"":Object(n.a)();return{description:this.clientResources.Common.LearnMore,url:Object(i.a)("https://docs.microsoft.com/{0}/connectors/{1}/#{2}",s,a,t.toLowerCase())}}return null}},{key:"getDocumentationLinkForOperationByLongOperationId",value:function(e){var t=e.split("/").slice(-1)[0],r=e.indexOf("apiOperations");if(!t||r<0)return null;var n=e.substring(0,r);return this.getDocumentationLinkForOperation(n,t)}},{key:"getODataDocumentationLink",value:function(){return{description:this.clientResources.Common.LearnMore,url:"https://make.powerautomate.com/blog/advanced-flow-of-the-week-filtering-with-odata/"}}}])&&a(t.prototype,r),s&&a(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()},22330:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(22331),o=r(12339),i=r(22332),a=r(22334),s=r(17448),c=r(13087),u=new n.a(c.a,i.a,a.a,s.a,Object(o.b)())},22331:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(13009),o=r(15402),i=r(13085);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return(t=d(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){u(i,n,o,a,s,"next",e)}function s(e){u(i,n,o,a,s,"throw",e)}a(void 0)}))}}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function f(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=f((function e(t,r,a,c,u){var p=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.presenceHttpClient=r,this.presenceStore=a,this.graphService=c,this.appSettings=u,this.shouldPoll=!1,this.numFailures=0,this.timeoutId=void 0,this.becomePresent=e=>(this.shouldPoll=!0,this.numFailures=0,this.addPresence(e,!0)),this.becomeAbsent=e=>(this.shouldPoll=!1,this.timeoutId&&window.clearTimeout(this.timeoutId),this.removePresence(e)),this.addPresence=function(){var e=l((function*(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(p.shouldPoll){var r=p.appSettings.presenceTtlSec,o={flowName:e,ttl:r,firstLoad:t,numUsers:-1},a=p.loggingService.profileStart(i.a.presenceLoadStart,o);try{var c=yield p.presenceHttpClient.addPresence({flowName:e,ttl:r}),u=c.data.map(e=>e.userObjectId);yield p.graphService.getObjectsByObjectIds(u),yield Promise.all(u.map(e=>p.graphService.getThumbnailPhoto(e))),p.presenceStore.setUsers(c.data),p.numFailures=0,o.numUsers=c.data.length,p.loggingService.profileEndWithSuccess(a,i.a.presenceLoadEnd,o)}catch(l){p.numFailures++,p.numFailures>=3&&(p.shouldPoll=!1,p.presenceStore.clear()),p.loggingService.profileEnd(a,i.a.presenceLoadEnd,Object(n.y)(l),l,s({numFailures:p.numFailures},o))}p.timeoutId&&window.clearTimeout(p.timeoutId),p.timeoutId=window.setTimeout(p.addPresence,1e3*(r-30),e)}}));return function(t){return e.apply(this,arguments)}}(),this.removePresence=function(){var e=l((function*(e){yield Object(o.b)({loggingService:p.loggingService,promise:p.presenceHttpClient.removePresence({flowName:e}),eventStartName:i.a.presenceDeleteStart,eventEndName:i.a.presenceDeleteEnd,eventData:{flowName:e}}),p.presenceStore.clear()}));return function(t){return e.apply(this,arguments)}}()}))},22332:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(13192),o=r(22333),i=r(12345),a=r(13e3),s=r(12339),c=r(13077),u=r(13087),l=r(14688),p=new o.a(Object(s.b)(),u.a,new n.HttpClient,l.a,a.a,c.a,i.a)},22333:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(13217),o=r(13220),i=r(13221),a=r(13224),s=r(12375),c=r(13144),u=r(12381),l=r(14829);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function f(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var v=f((function e(t,r,p,f,d,v,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appSettings=t,this.loggingService=r,this.httpClient=p,this.ppapiService=f,this.sessionStore=d,this.tokenService=v,this.environmentStore=h,this.addPresence=e=>{var{flowName:t,ttl:r}=e,n={ttl:r,activity:{}};return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/ADDPRESENCE",url:"".concat(this.getPresenceBaseEndpoint(t),"/addPresence"),data:n})},this.listPresence=e=>{var{flowName:t}=e;return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/LISTPRESENCE",url:"".concat(this.getPresenceBaseEndpoint(t),"/listPresence")})},this.removePresence=e=>{var{flowName:t}=e;return this.httpClient.post({eventName:"PROCESSSIMPLE:POST/PROVIDERS/MICROSOFT.PROCESSSIMPLE/ENVIRONMENTS/FLOWS/REMOVEPRESENCE",url:"".concat(this.getPresenceBaseEndpoint(t),"/removePresence")})},this.getPresenceBaseEndpoint=e=>Object(u.a)(Object(c.c)(this.appSettings).flowRP,"".concat(this.appSettings.processSimpleResourceProviderPath,"/environments/").concat(this.environmentStore.currentEnvironmentName,"/flows/").concat(e)),this.httpClient.addRequestInterceptor(Object(i.c)(r,()=>this.sessionStore.sessionId)),this.httpClient.addRequestInterceptor(Object(n.a)(()=>this.tokenService.getAccessToken(this.appSettings.authResource))),this.httpClient.addRequestInterceptor(Object(o.a)(()=>Object(s.a)())),this.httpClient.addRequestInterceptor(Object(a.a)(r,this.sessionStore)),this.httpClient.addRequestInterceptor(Object(l.b)(this.ppapiService,this.appSettings)),this.httpClient.addResponseInterceptor(Object(i.d)(this.loggingService,this.sessionStore),Object(i.b)(this.loggingService,this.sessionStore))}))},22334:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(15330),o=r(22335),i=r(13e3),a=r(14378),s=new o.a(n.a,i.a,a.a)},22335:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o,i=r(11773),a=r(15331);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function u(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var l=(o=u((n=function(){function e(t,r,n){var i,a,s,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graphStore=t,this.sessionStore=r,this.assetService=n,i=this,a="users",c=this,(s=o)&&Object.defineProperty(i,a,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(c):void 0})}var t,r,n;return t=e,(r=[{key:"personas",get:function(){var e,t;return null!==(e=null===(t=this.users)||void 0===t||null===(t=t.filter(e=>e.userObjectId!==this.sessionStore.user.uniqueId))||void 0===t?void 0:t.map(e=>{var t=a.a.getDirectoryObjectKey(this.sessionStore.user.tenantId,e.userObjectId),r=this.graphStore.directoryObjects.getEntity(t),n=this.graphStore.thumbnailPhotos.getEntity(t),o=n&&n.thumbnailPhoto!==this.assetService.userPlaceholder?n.thumbnailPhoto:null;return{personaName:r.displayName,imageUrl:o}}))&&void 0!==e?e:[]}},{key:"me",get:function(){var e;return null===(e=this.users)||void 0===e?void 0:e.find(e=>{var t;return e.userObjectId===(null===(t=this.sessionStore.user)||void 0===t?void 0:t.uniqueId)})}},{key:"setUsers",value:function(e){this.users=e}},{key:"clear",value:function(){this.users=[]}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"users",[i.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u(n.prototype,"personas",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"personas"),n.prototype),u(n.prototype,"me",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"me"),n.prototype),u(n.prototype,"setUsers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setUsers"),n.prototype),u(n.prototype,"clear",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clear"),n.prototype),n)},22336:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(22337),o=r(13087),i=new(r(22339).a)(o.a,n.a)},22337:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(22338).a)},22338:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o=r(12330),i=r(11773),a=r(17266),s=r(13143);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(p((n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;c(this,e),this.maxNumSnapshots=t,this.undoState=void 0,this.undoSnapshots=void 0,this.resetState()}var t,r,n;return t=e,(r=[{key:"isUndoPossible",get:function(){return!Object(o.a)(this.undoState)&&this.undoState.current!==this.undoState.oldest}},{key:"isRedoPossible",get:function(){return!Object(o.a)(this.undoState)&&this.undoState.current!==this.undoState.newest}},{key:"resetState",value:function(){this.undoState=void 0,this.undoSnapshots=[]}},{key:"addSnapshot",value:function(e,t){return Object(o.a)(this.undoState)?this.undoState={current:0,oldest:0,newest:0,size:1,previousSelectedCard:[]}:(this.undoState.current!==this.undoState.newest&&(this.undoState.size-=this.undoState.newest-this.undoState.current+(this.undoState.newest<this.undoState.current?this.maxNumSnapshots:0)),this.undoState.size===this.maxNumSnapshots?this.undoState.oldest=(this.undoState.oldest+1)%this.maxNumSnapshots:this.undoState.size++,this.undoState.current=(this.undoState.current+1)%this.maxNumSnapshots,this.undoState.newest=this.undoState.current),this.undoSnapshots[this.undoState.current]=e,this.undoState.previousSelectedCard[this.undoState.current]=t,Promise.resolve()}},{key:"getSnapshotOnUndoOrRedo",value:function(e){return Object(o.a)(this.undoState)?Promise.reject(new a.a(s.b.undefinedUndoState,"Undo state does not exist")):this.undoState.current===(e?this.undoState.oldest:this.undoState.newest)?Promise.reject(new a.a(s.b.undoStateAtOldestOrNewest,"Already at oldest or newest flow state")):(this.undoState.current=e?(this.undoState.current+this.maxNumSnapshots-1)%this.maxNumSnapshots:(this.undoState.current+1)%this.maxNumSnapshots,Promise.resolve(this.undoSnapshots[this.undoState.current]))}},{key:"getPreviousSelectedCardOnUndoOrRedo",value:function(e){return Object(o.a)(this.undoState)?Promise.resolve(null):Promise.resolve(this.undoState.previousSelectedCard[e?this.undoState.current+1%this.maxNumSnapshots:this.undoState.current])}}])&&u(t.prototype,r),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()).prototype,"isUndoPossible",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"isUndoPossible"),n.prototype),p(n.prototype,"isRedoPossible",[i.computed],Object.getOwnPropertyDescriptor(n.prototype,"isRedoPossible"),n.prototype),p(n.prototype,"resetState",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"resetState"),n.prototype),p(n.prototype,"addSnapshot",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addSnapshot"),n.prototype),p(n.prototype,"getSnapshotOnUndoOrRedo",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"getSnapshotOnUndoOrRedo"),n.prototype),p(n.prototype,"getPreviousSelectedCardOnUndoOrRedo",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"getPreviousSelectedCardOnUndoOrRedo"),n.prototype),n)},22339:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return a}));var n=r(22340);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.loggingService=e,this.flowUndoStore=r}var r,i,a;return r=t,(i=[{key:"saveSnapshot",value:function(t,r){var o=JSON.stringify(t);return Object(n.gzip)(o).then(t=>(this.loggingService.logInfo("FlowUndoService.saveSnapshot","Size in bytes",{flowSnapshotSize:e.from(o).byteLength,compressedSnapshotSize:t.byteLength}),this.flowUndoStore.addSnapshot(t,r)))}},{key:"getSnapshotOnUndoOrRedo",value:function(e){return this.flowUndoStore.getSnapshotOnUndoOrRedo(e).then(e=>Object(n.ungzip)(e)).then(e=>JSON.parse(e.toString()))}},{key:"getPreviousSelectedCardOnUndoOrRedo",value:function(e){return this.flowUndoStore.getPreviousSelectedCardOnUndoOrRedo(e)}}])&&o(r.prototype,i),a&&o(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}()}).call(this,r(12664).Buffer)},22355:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(13e3),o=r(13087),i=r(22356),a=r(15460),s=new i.a(o.a,n.a,a.b)},22356:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(12328),o=r.n(n),i=r(13009),a=r(13146),s=r(13085);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggingService=t,this.sessionStore=r,this.xrmEntityHttpClient=n,this.runFirstPending=Object(a.a)(),this.processEntityPluralName="msdyn_pminferredtasks",this.processNameAttributeName="msdyn_name",this.automationDataAttributeName="msdyn_automationdata",this.attributes=[this.processNameAttributeName,this.automationDataAttributeName]}var t,r,n;return t=e,(r=[{key:"retrieveProcessRecommendations",value:function(e){o()(this.sessionStore.user,"Cannot get xrm process recommendations for unauthenticated user. Missing user object"),o()(this.sessionStore.user.uniqueId||this.sessionStore.user.puid,"Cannot get xrm process recommendations for unauthenticated user");var t=this.loggingService.profileStart(s.a.getXrmRecommendationsLoadStart),r={$select:this.attributes.join(",")};return this.runFirstPending({key:"retrieveProcessRecommendations/".concat(e),action:()=>this.xrmEntityHttpClient.retrieveRecord(this.processEntityPluralName,e,r).then(r=>{var n=r.data.msdyn_name,o=JSON.parse(r.data.msdyn_automationdata);return this.loggingService.profileEndWithSuccess(t,s.a.getXrmRecommendationsLoadEnd,{processId:e,recommenderType:null==o?void 0:o.RecommenderType,recommenderVersion:null==o?void 0:o.RecommenderVersion}),{processName:n,recommendationModel:o}}).catch(e=>{throw this.loggingService.profileEnd(t,s.a.getXrmRecommendationsLoadEnd,Object(i.cb)(e),e),e})})}}])&&c(t.prototype,r),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/182.a67ff9c6.chunk.js.map